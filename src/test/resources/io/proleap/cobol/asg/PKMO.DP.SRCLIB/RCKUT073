000100*----------------------------*                                    00010015
000200 IDENTIFICATION DIVISION.                                         00020000
000300*----------------------------*                                    00030015
000400 PROGRAM-ID.    RCKUT073.                                         00040000
000500 AUTHOR.        JOHN HUTCHINSON.                                  00050000
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060000
000700 DATE-WRITTEN.  4/21/2003.                                        00070001
000800*--------------------------------------------------------------- *00080001
000900*    THIS PROGRAM WILL CREATE AN EXTRACT FILE FROM THE RECEIVING *00090014
001000*    TABLE(TRECEIV) AND PURCHASE ORDER HEADER TABLE(TPURCHS).    *00100014
001100*                                                                *00110031
001200*    THE SELECTION IS BASED ON THE DATE RANGE ENTERED IN THE     *00120014
001300*    CONTROL CARD AND THE TIMEFRAME DESIRED.                     *00130014
001400*                                                                *00140031
001500*    VALID TIMEFRAMES ARE: M=MONTHLY S=SEASONAL  F=FISCAL        *00150064
001600*                                                                *00160031
001700*    IF THE DATES IN THE CONTROL CARD = DEFAULT (9999-09-09)     *00170014
001800*    THE PROGRAM WILL CALCULATE THE BEGINNING AND ENDING DATES.  *00180031
001900*--------------------------------------------------------------- *00190001
002000*----------------------------*                                    00200015
002100 ENVIRONMENT DIVISION.                                            00210000
002200*----------------------------*                                    00220015
002300 INPUT-OUTPUT SECTION.                                            00230000
002400                                                                  00240014
002500 FILE-CONTROL.                                                    00250000
002600     SELECT DATE-FILE      ASSIGN TO UT-S-OUT01.                  00260000
002700     SELECT EXTRACT-FILE   ASSIGN TO UT-S-OUT02.                  00270000
002800                                                                  00280000
002900*----------------------------*                                    00290015
003000 DATA DIVISION.                                                   00300000
003100*----------------------------*                                    00310015
003200 FILE SECTION.                                                    00320000
003300                                                                  00330000
003400 FD  DATE-FILE                                                    00340000
003500     RECORDING MODE IS F                                          00350000
003600     LABEL RECORDS ARE STANDARD                                   00360000
003700     BLOCK CONTAINS 0 RECORDS.                                    00370001
003800 01  DATE-RECORD                 PIC X(80).                       00380000
003900                                                                  00390015
004000* ------------------------------------------- *                   00400015
004100 FD  EXTRACT-FILE                                                 00410000
004200     RECORDING MODE IS F                                          00420000
004300     LABEL RECORDS ARE STANDARD                                   00430000
004400     BLOCK CONTAINS 0 RECORDS.                                    00440001
004500 01  EXTRACT-RECORD              PIC X(400).                      00450036
004600                                                                  00460000
004700*----------------------------*                                    00470015
004800 WORKING-STORAGE SECTION.                                         00480000
004900*----------------------------*                                    00490015
005000 01  PS-PROGRAM-SWITCHES.                                         00500000
005100     05  PS-NORMAL-RUN-SW        PIC  X(01)  VALUE 'S'.           00510031
005200         88  PS-NORMAL-RUN                   VALUE 'N'.           00520031
005300         88  PS-SPECIAL-RUN                  VALUE 'S'.           00530031
005400     05  PS-TRECEIV-CURSOR-SW    PIC  X(01)  VALUE 'N'.           00540001
005500         88  PS-TRECEIV-CSR-EOF              VALUE 'Y'.           00550031
005600         88  PS-TRECEIV-CSR-START            VALUE 'Y'.           00560031
005700     05  PS-TRECITM-CURSOR-SW    PIC  X(01)  VALUE 'N'.           00570031
005800         88  PS-TRECITM-CSR-EOF              VALUE 'Y'.           00580031
005900         88  PS-TRECITM-CSR-START            VALUE 'N'.           00590031
006000                                                                  00600031
006100 01  PC-PRROGRAM-CONSTANTS.                                       00610034
006200     05  PC-A                    PIC  X(01) VALUE 'A'.            00620050
006300     05  PC-AC                   PIC  X(02) VALUE 'AC'.           00630050
006400     05  PC-DE                   PIC  X(02) VALUE 'DE'.           00640050
006500     05  PC-FALL                 PIC  X(06) VALUE '  FALL'.       00650050
006600     05  PC-SPRING               PIC  X(06) VALUE 'SPRING'.       00660050
006700     05  PC-PROGRAM-NAME         PIC  X(08) VALUE 'RCKUT073'.     00670031
006800     05  PC-DEFAULT-CC-DATE      PIC  X(10) VALUE '9999-09-09'.   00680050
006900                                                                  00690050
007000     05  PC-ONE                  PIC  9(01) VALUE 1.              00700031
007100     05  PC-SEVEN                PIC  9(02) VALUE 7.              00710031
007200     05  PC-TWENTY-EIGHT         PIC  9(02) VALUE 28.             00720031
007300     05  PC-SYSTEM-DATE          PIC  9(06) VALUE ZERO.           00730050
007400     05  PC-MAX-RETRIES          PIC S9(04) VALUE +3 COMP.        00740050
007500     05  PC-1                    PIC S9(04) VALUE +1 COMP.        00750050
007600                                                                  00760011
007700* -------------------------------------------------------------- *00770007
007800*    PROGRAM VARIABLES                                            00780007
007900* -------------------------------------------------------------- *00790007
008000 01  PV-PROGRAM-VARIABLES.                                        00800034
008100     05  PV-DISPL-COUNT          PIC  ZZZ,ZZZ,ZZ9.                00810051
008200     05  PV-SEASON-DESC          PIC  X(06)  VALUE SPACES.        00820051
008300     05  PV-CURRENT-DB2-DATE     PIC  X(10).                      00830051
008400     05  PV-CURRENT-DB2-DATE-ONE PIC  X(10).                      00840051
008500     05  PV-PARAGRAPH-NAME       PIC  X(30)  VALUE SPACES.        00850034
008600     05  PV-SQLCODE              PIC  9(09)  VALUE ZERO.          00860034
008700     05  PV-RETRY-COUNT          PIC S9(04)  VALUE +0 COMP.       00870034
008800     05  PV-TRECEIV-COUNT        PIC S9(09)  VALUE +0 COMP.       00880034
008900     05  PV-TRECITM-COUNT        PIC S9(09)  VALUE +0 COMP.       00890034
009000     05  PV-EXPTED-ITEM-QTY      PIC S9(09)  VALUE +0 COMP.       00900034
009100     05  PV-VERIFY-ITEM-QTY      PIC S9(09)  VALUE +0 COMP.       00910034
009200                                                                  00920007
009300 01  PV-END-DATE-PLUS-7          PIC  X(10).                      00930064
009400 01  FILLER REDEFINES PV-END-DATE-PLUS-7.                         00940064
009500     05  PV-DATE-PLUS-7-MM       PIC  9(02).                      00950064
009600     05  FILLER                  PIC  X(01).                      00960064
009700     05  PV-DATE-PLUS-7-DD       PIC  9(02).                      00970064
009800     05  FILLER                  PIC  X(01).                      00980064
009900     05  PV-DATE-PLUS-7-CC       PIC  9(02).                      00990064
010000     05  PV-DATE-PLUS-7-YY       PIC  9(02).                      01000064
010100                                                                  01010064
010200 01  PV-BEG-PERIOD               PIC  X(06).                      01020064
010300 01  FILLER REDEFINES PV-BEG-PERIOD.                              01030059
010400     05  PV-BEG-PERIOD-CC        PIC  9(02).                      01040059
010500     05  PV-BEG-PERIOD-YY        PIC  9(02).                      01050059
010600     05  PV-BEG-PERIOD-PP        PIC  9(02).                      01060059
010700                                                                  01070057
010800 01  PV-END-PERIOD               PIC  X(06).                      01080059
010900 01  FILLER REDEFINES PV-END-PERIOD.                              01090059
011000     05  PV-END-PERIOD-CC        PIC  9(02).                      01100059
011100     05  PV-END-PERIOD-YY        PIC  9(02).                      01110059
011200     05  PV-END-PERIOD-PP        PIC  9(02).                      01120059
011300                                                                  01130057
011400 01  PV-DATE-AREA.                                                01140057
011500     05  PV-DATE-AREA-MM         PIC  9(02)  VALUE ZEROS.         01150057
011600     05  FILLER                  PIC  X(01)  VALUE '/'.           01160007
011700     05  PV-DATE-AREA-DD         PIC  9(02)  VALUE ZEROS.         01170007
011800     05  FILLER                  PIC  X(01)  VALUE '/'.           01180007
011900     05  PV-DATE-AREA-YY         PIC  9(02)  VALUE ZEROS.         01190007
012000                                                                  01200007
012100                                                                  01210007
012200 01  PV-CURRENT-DB2-DATE-ONEYR   PIC  X(10)  VALUE SPACES.        01220007
012300 01  FILLER                      REDEFINES                        01230007
012400     PV-CURRENT-DB2-DATE-ONEYR.                                   01240007
012500     05  PV-CDD-ONEYR-CCYY       PIC  9(04).                      01250007
012600     05  FILLER                  PIC  X(06).                      01260007
012700                                                                  01270007
012800 01  PV-CURR-DATE.                                                01280007
012900     05  PV-CURRENT-DB2-CCYY.                                     01290007
013000         10  PV-CURRENT-DB2-CC   PIC  9(02)  VALUE ZERO.          01300007
013100         10  PV-CURRENT-DB2-YY   PIC  9(02)  VALUE ZERO.          01310007
013200     05  FILLER                  PIC  X(01)  VALUE '-'.           01320007
013300     05  PV-CURRENT-DB2-MM       PIC  9(02)  VALUE ZERO.          01330007
013400     05  FILLER                  PIC  X(01)  VALUE '-'.           01340007
013500     05  PV-CURRENT-DB2-DD       PIC  9(02)  VALUE ZERO.          01350007
013600                                                                  01360007
013700 01  PV-CURRENT-DATE.                                             01370007
013800     05  PV-CURRENT-CCYY.                                         01380007
013900         10  PV-CURRENT-CC       PIC  9(02)  VALUE ZERO.          01390007
014000         10  PV-CURRENT-YY       PIC  9(02)  VALUE ZERO.          01400007
014100     05  PV-CURRENT-MM           PIC  9(02)  VALUE ZERO.          01410007
014200     05  PV-CURRENT-DD           PIC  9(02)  VALUE ZERO.          01420007
014300                                                                  01430007
014400 01  PV-CURRENT-YYMMDD-DATE.                                      01440007
014500     05  PV-CURRENT-YYMMDD-YY    PIC  9(02)  VALUE ZERO.          01450007
014600     05  PV-CURRENT-YYMMDD-MM    PIC  9(02)  VALUE ZERO.          01460007
014700     05  PV-CURRENT-YYMMDD-DD    PIC  9(02)  VALUE ZERO.          01470007
014800                                                                  01480007
014900 01  PV-BEG-DATE-CYMD.                                            01490007
015000     05  PV-BEG-YMD-CC           PIC  9(02)  VALUE ZERO.          01500034
015100     05  PV-BEG-YMD-YY           PIC  9(02)  VALUE ZERO.          01510034
015200     05  PV-BEG-YMD-MM           PIC  9(02)  VALUE ZERO.          01520034
015300     05  PV-BEG-YMD-DD           PIC  9(02)  VALUE ZERO.          01530034
015400                                                                  01540007
015500 01  PV-END-DATE-CYMD.                                            01550007
015600     05  PV-END-YMD-CC           PIC  9(02)  VALUE ZERO.          01560034
015700     05  PV-END-YMD-YY           PIC  9(02)  VALUE ZERO.          01570034
015800     05  PV-END-YMD-MM           PIC  9(02)  VALUE ZERO.          01580034
015900     05  PV-END-YMD-DD           PIC  9(02)  VALUE ZERO.          01590034
016000                                                                  01600007
016100 01  PV-BEG-DATE.                                                 01610007
016200     05  PV-BEG-MM               PIC  9(02)  VALUE ZERO.          01620034
016300     05  FILLER                  PIC  X(01)  VALUE '/'.           01630007
016400     05  PV-BEG-DD               PIC  9(02)  VALUE ZERO.          01640034
016500     05  FILLER                  PIC  X(01)  VALUE '/'.           01650007
016600     05  PV-BEG-YY               PIC  9(02)  VALUE ZERO.          01660034
016700                                                                  01670007
016800 01  PV-END-DATE.                                                 01680007
016900     05  PV-END-MM               PIC  9(02)  VALUE ZERO.          01690034
017000     05  FILLER                  PIC  X(01)  VALUE '/'.           01700007
017100     05  PV-END-DD               PIC  9(02)  VALUE ZERO.          01710034
017200     05  FILLER                  PIC  X(01)  VALUE '/'.           01720007
017300     05  PV-END-YY               PIC  9(02)  VALUE ZERO.          01730034
017400                                                                  01740007
017500 01  PV-START-EXTRACT            PIC  X(26)  VALUE SPACE.         01750007
017600 01  FILLER                      REDEFINES                        01760007
017700     PV-START-EXTRACT.                                            01770007
017800     05  PV-START-EXTRACT-YYYY   PIC 9(04).                       01780007
017900     05  PV-START-EXTRACT-1ST    PIC X(01).                       01790007
018000     05  PV-START-EXTRACT-MM     PIC 9(02).                       01800007
018100     05  PV-START-EXTRACT-2ND    PIC X(01).                       01810007
018200     05  PV-START-EXTRACT-DD     PIC 9(02).                       01820007
018300     05  PV-START-EXTRACT-3RD    PIC X(01).                       01830007
018400     05  PV-START-TIMESTAMP      PIC X(15).                       01840007
018500                                                                  01850007
018600 01  PV-END-EXTRACT              PIC  X(26) VALUE SPACE.          01860066
018700 01  FILLER        REDEFINES PV-END-EXTRACT.                      01870066
018800     05  PV-END-EXTRACT-YYYY     PIC  9(04).                      01880066
018900     05  PV-END-EXTRACT-YYYY-RE  REDEFINES                        01890007
019000         PV-END-EXTRACT-YYYY.                                     01900007
019100         10  PV-END-EXTRACT-CC   PIC  9(02).                      01910007
019200         10  PV-END-EXTRACT-YY   PIC  9(02).                      01920007
019300     05  PV-END-EXTRACT-1ST      PIC  X(01).                      01930007
019400     05  PV-END-EXTRACT-MM       PIC  9(02).                      01940007
019500     05  PV-END-EXTRACT-2ND      PIC  X(01).                      01950007
019600     05  PV-END-EXTRACT-DD       PIC  9(02).                      01960007
019700     05  PV-END-EXTRACT-3RD      PIC  X(01).                      01970007
019800     05  PV-END-TIMESTAMP        PIC  X(15).                      01980007
019900 01  PV-END-EXTRACT-CSR          PIC  X(26).                      01990066
020000 01  FILLER    REDEFINES PV-END-EXTRACT-CSR.                      02000066
020100     05  PV-CSR-EXTRACT-CC       PIC  9(02).                      02010066
020200     05  PV-CSR-EXTRACT-YY       PIC  9(02).                      02020066
020300     05  FILLER                  PIC  X(01).                      02030066
020400     05  PV-CSR-EXTRACT-MM       PIC  9(02).                      02040066
020500     05  FILLER                  PIC  X(01).                      02050066
020600     05  PV-CSR-EXTRACT-DD       PIC  9(02).                      02060066
020700     05  FILLER                  PIC  X(01).                      02070066
020800     05  PV-CSR-TIMESTAMP        PIC  X(15).                      02080066
020900                                                                  02090025
021000 01  PV-ENDING-DATE-REFORMAT.                                     02100025
021100     05  PV-EDR-CCYY             PIC  X(04)  VALUE SPACE.         02110025
021200     05  FILLER                  PIC  X(01)  VALUE '-'.           02120025
021300     05  PV-EDR-MM               PIC  X(02)  VALUE SPACE.         02130025
021400     05  FILLER                  PIC  X(01)  VALUE '-'.           02140025
021500     05  PV-EDR-DD               PIC  X(02)  VALUE SPACE.         02150025
021600                                                                  02160007
021700                                                                  02170007
021800 01  PV-YEAR-FORMAT.                                              02180007
021900     05  PV-YEAR-FORMAT-CC       PIC  9(02) VALUE ZERO.           02190007
022000     05  PV-YEAR-FORMAT-YY       PIC  9(02) VALUE ZERO.           02200007
022100                                                                  02210001
022200 01  PV-DATETIME-WORK.                                            02220000
022300     05  PV-DATETIME-CC          PIC  9(02).                      02230001
022400     05  PV-DATETIME-YY          PIC  9(02).                      02240001
022500     05  FILLER                  PIC  X(01)  VALUE '-'.           02250001
022600     05  PV-DATETIME-MM          PIC  9(02).                      02260001
022700     05  FILLER                  PIC  X(01)  VALUE '-'.           02270001
022800     05  PV-DATETIME-DD          PIC  9(02).                      02280001
022900     05  FILLER                  PIC  X(01)  VALUE '-'.           02290001
023000     05  PV-DATETIME-HO          PIC  9(02).                      02300001
023100     05  FILLER                  PIC  X(01)  VALUE '.'.           02310001
023200     05  PV-DATETIME-MI          PIC  9(02).                      02320001
023300     05  FILLER                  PIC  X(01)  VALUE '.'.           02330001
023400     05  PV-DATETIME-SS          PIC  9(02).                      02340001
023500     05  FILLER                  PIC  X(01)  VALUE '.'.           02350001
023600     05  PV-DATETIME-MSEC        PIC  9(06).                      02360001
023700                                                                  02370000
023800*    -----------                                                  02380047
023900*    DATE RECORD                                                  02390047
024000*    -----------                                                  02400047
024100     COPY RCRD067.                                                02410047
024200                                                                  02420011
024300 01  CONTROL-CARD-FIELDS.                                         02430018
024400     05  CC-BEG-DATE.                                             02440001
024500         10  CC-BEG-CC           PIC  9(02) VALUE ZERO.           02450034
024600         10  CC-BEG-YY           PIC  9(02) VALUE ZERO.           02460034
024700         10  FILLER              PIC  X(01) VALUE SPACE.          02470001
024800         10  CC-BEG-MM           PIC  9(02) VALUE ZERO.           02480034
024900         10  FILLER              PIC  X(01) VALUE SPACE.          02490001
025000         10  CC-BEG-DD           PIC  9(02) VALUE ZERO.           02500034
025100     05  FILLER                  PIC  X(01) VALUE SPACE.          02510001
025200     05  CC-END-DATE.                                             02520001
025300         10  CC-END-CC           PIC  9(02) VALUE ZERO.           02530034
025400         10  CC-END-YY           PIC  9(02) VALUE ZERO.           02540034
025500         10  FILLER              PIC  X(01) VALUE SPACE.          02550001
025600         10  CC-END-MM           PIC  9(02) VALUE ZERO.           02560034
025700         10  FILLER              PIC  X(01) VALUE SPACE.          02570001
025800         10  CC-END-DD           PIC  9(02) VALUE ZERO.           02580034
025900     05  FILLER                  PIC  X(01) VALUE SPACE.          02590001
026000     05  CC-MODE-IND             PIC  X(01) VALUE SPACE.          02600001
026100         88  CC-VALID-MODE-IND        VALUE 'W' 'M' 'F' 'C' 'S'.  02610001
026200         88  CC-WEEKLY-EXTRACT        VALUE 'W'.                  02620001
026300         88  CC-MONTHLY-EXTRACT       VALUE 'M'.                  02630001
026400         88  CC-FISCAL-EXTRACT        VALUE 'F'.                  02640001
026500         88  CC-CALENDAR-EXTRACT      VALUE 'C'.                  02650001
026600         88  CC-SEASONAL-EXTRACT      VALUE 'S'.                  02660001
026700     05  FILLER                  PIC  X(57) VALUE SPACE.          02670001
026800                                                                  02680000
026900 01  PV-ABEND-FIELDS.                                             02690000
027000     05  PV-ABEND-CODE           PIC S9(04) VALUE +0 COMP.        02700001
027100     05  PV-ABEND-PROGRAM        PIC  X(08) VALUE 'RCKUT073'.     02710001
027200     05  PV-ABEND-PARAGRAPH      PIC  X(50) VALUE SPACES.         02720001
027300     05  PV-ABEND-OPERATION      PIC  X(50) VALUE SPACES.         02730001
027400     05  PV-ABEND-STRUCT-1       PIC  X(08) VALUE SPACES.         02740001
027500     05  PV-ABEND-STRUCT-2       PIC  X(08) VALUE SPACES.         02750001
027600     05  PV-DB2-OPER-MESS-1      PIC  X(79) VALUE SPACES.         02760001
027700     05  PV-DB2-OPER-MESS-2      PIC  X(79) VALUE SPACES.         02770001
027800     05  PV-DB2-OPER-MESS-3      PIC  X(79) VALUE SPACES.         02780001
027900     05  PV-DB2-TABLE-NAME       PIC  X(08) VALUE SPACES.         02790001
028000                                                                  02800000
028100 01  WS-WORKING-STORAGE-HOLD-FIELDS.                              02810000
028200     05  WS-FISCAL-PER-NBR            PIC  9(02) VALUE ZERO.      02820015
028300     05  WS-FISCAL-PER-WK             PIC  9(02) VALUE ZERO.      02830015
028400     05  WS-FISCAL-QTR-NBR            PIC  9(01) VALUE ZERO.      02840000
028500     05  WS-FISCAL-WK-NBR             PIC  9(02) VALUE ZERO.      02850015
028600     05  WS-FISCAL-YEAR               PIC  9(02) VALUE ZERO.      02860071
028700                                                                  02870000
028800     05  WS-DEPT-ARRIVE-PER-NBR       PIC  9(02) VALUE ZERO.      02880015
028900     05  WS-DEPT-ARRIVE-PER-WK        PIC  9(02) VALUE ZERO.      02890015
029000     05  WS-DEPT-ARRIVE-QTR-NBR       PIC  9(01) VALUE ZERO.      02900000
029100     05  WS-DEPT-ARRIVE-FISCAL-WK     PIC  9(02) VALUE ZERO.      02910015
029200                                                                  02920000
029300     05  WS-DEPT-VERFYD-PER-NBR       PIC  9(02) VALUE ZERO.      02930015
029400     05  WS-DEPT-VERFYD-PER-WK        PIC  9(02) VALUE ZERO.      02940015
029500     05  WS-DEPT-VERFYD-QTR-NBR       PIC  9(01) VALUE ZERO.      02950000
029600     05  WS-DEPT-VERFYD-FISCAL-WK     PIC  9(02) VALUE ZERO.      02960015
029700                                                                  02970000
029800     05  WS-EXPTED-ITEM-QTY           PIC S9(09) VALUE +0 COMP.   02980001
029900     05  WS-VERIFY-ITEM-QTY           PIC S9(09) VALUE +0 COMP.   02990001
030000     05  WS-PREV-ARRIVE-DATE          PIC  X(10) VALUE SPACES.    03000015
030100                                                                  03010000
030200     05  WS-ARRIVE-DATE-WORK.                                     03020000
030300         10  WS-WORK-ARRIVE-MM        PIC  9(02) VALUE ZERO.      03030007
030400         10  FILLER                   PIC  X(01) VALUE '/'.       03040001
030500         10  WS-WORK-ARRIVE-DD        PIC  9(02) VALUE ZERO.      03050007
030600         10  FILLER                   PIC  X(01) VALUE '/'.       03060001
030700         10  WS-WORK-ARRIVE-CC        PIC  9(02) VALUE ZERO.      03070007
030800         10  WS-WORK-ARRIVE-YY        PIC  9(02) VALUE ZERO.      03080007
030900                                                                  03090000
031000     05  WS-ARRIVE-DATE.                                          03100000
031100         10  WS-ARRIVE-CC             PIC  9(02) VALUE ZERO.      03110007
031200         10  WS-ARRIVE-YY             PIC  9(02) VALUE ZERO.      03120007
031300         10  FILLER                   PIC  X(01) VALUE '-'.       03130001
031400         10  WS-ARRIVE-MM             PIC  9(02) VALUE ZERO.      03140007
031500         10  FILLER                   PIC  X(01) VALUE '-'.       03150001
031600         10  WS-ARRIVE-DD             PIC  9(02) VALUE ZERO.      03160007
031700                                                                  03170000
031800     05  WS-PREV-VERFYD-DATE          PIC  X(10) VALUE SPACES.    03180015
031900                                                                  03190000
032000     05  WS-VERFYD-DATE-WORK.                                     03200000
032100         10  WS-WORK-VERFYD-MM        PIC  9(02) VALUE ZERO.      03210007
032200         10  FILLER                   PIC  X(01) VALUE '/'.       03220001
032300         10  WS-WORK-VERFYD-DD        PIC  9(02) VALUE ZERO.      03230007
032400         10  FILLER                   PIC  X(01) VALUE '/'.       03240001
032500         10  WS-WORK-VERFYD-CC        PIC  9(02) VALUE ZERO.      03250007
032600         10  WS-WORK-VERFYD-YY        PIC  9(02) VALUE ZERO.      03260007
032700                                                                  03270000
032800     05  WS-VERFYD-DATE.                                          03280000
032900         10  WS-VERFYD-CC             PIC  9(02) VALUE ZERO.      03290007
033000         10  WS-VERFYD-YY             PIC  9(02) VALUE ZERO.      03300007
033100         10  FILLER                   PIC  X(01) VALUE '-'.       03310001
033200         10  WS-VERFYD-MM             PIC  9(02) VALUE ZERO.      03320007
033300         10  FILLER                   PIC  X(01) VALUE '-'.       03330001
033400         10  WS-VERFYD-DD             PIC  9(02) VALUE ZERO.      03340007
033500                                                                  03350000
033600     05  WS-RECORDS-READ              PIC  9(09) VALUE ZERO.      03360007
033700     05  WS-RECORDS-WRITTEN           PIC  9(09) VALUE ZERO.      03370007
033800                                                                  03380000
033900     05  WS-START-EXTRACT.                                        03390001
034000         10  WS-START-EXTRACT-YYYY    PIC  9(04).                 03400001
034100         10  WS-START-EXTRACT-MM      PIC  9(02).                 03410001
034200         10  WS-START-EXTRACT-DD      PIC  9(02).                 03420001
034300                                                                  03430000
034400     05  WS-END-EXTRACT.                                          03440001
034500         10  WS-END-EXTRACT-YYYY      PIC  9(04).                 03450001
034600         10  WS-END-EXTRACT-MM        PIC  9(02).                 03460001
034700         10  WS-END-EXTRACT-DD        PIC  9(02).                 03470001
034800                                                                  03480001
034900* -------------------------------------------------------------- *03490001
035000*    COPYBOOK USED BY CALENDAR ROUTINE                           *03500001
035100* -------------------------------------------------------------- *03510001
035200     COPY DPWS500.                                                03520001
035300                                                                  03530001
035400* -------------------------------------------------------------- *03540001
035500*    COPYBOOK USED IN CREATING EXTRACT FILE.                     *03550001
035600* -------------------------------------------------------------- *03560001
035700     COPY RCRD065.                                                03570001
035800                                                                  03580001
035900* -------------------------------------------------------------- *03590001
036000*    USED FOR DB2 ERROR MESSAGE BUILDING                         *03600001
036100* -------------------------------------------------------------- *03610001
036200     COPY DPWS004.                                                03620001
036300                                                                  03630001
036400* -------------------------------------------------------------- *03640001
036500*    DB2 SQL COMMUNICATION AREA                                  *03650031
036600* -------------------------------------------------------------- *03660001
036700     EXEC SQL                                                     03670000
036800          INCLUDE SQLCA                                           03680000
036900     END-EXEC.                                                    03690000
037000                                                                  03700000
037100* -------------------------------------------------------------- *03710001
037200*    DB2 DCLGEN FOR RECEIVER TABLE                               *03720001
037300* -------------------------------------------------------------- *03730001
037400     EXEC SQL                                                     03740000
037500          INCLUDE TRECEIV                                         03750000
037600     END-EXEC.                                                    03760000
037700                                                                  03770000
037800* -------------------------------------------------------------- *03780001
037900*    DB2 DCLGEN FOR RECEIVER DISTRIBUTION TABLE                  *03790001
038000* -------------------------------------------------------------- *03800001
038100     EXEC SQL                                                     03810000
038200          INCLUDE TRECDIS                                         03820000
038300     END-EXEC.                                                    03830000
038400                                                                  03840001
038500* -------------------------------------------------------------- *03850001
038600*    DB2 DCLGEN FOR RECEIVER ITEM DATA                           *03860001
038700* -------------------------------------------------------------- *03870001
038800     EXEC SQL                                                     03880001
038900          INCLUDE TRECITM                                         03890001
039000     END-EXEC.                                                    03900001
039100                                                                  03910001
039200* -------------------------------------------------------------- *03920001
039300*    DCLGEN FOR THE DB2 PURCHASE ORDER TABLE                     *03930001
039400* -------------------------------------------------------------- *03940001
039500     EXEC SQL                                                     03950000
039600         INCLUDE TPURCHS                                          03960000
039700     END-EXEC.                                                    03970000
039800                                                                  03980001
039900* -------------------------------------------------------------- *03990001
040000*    DCLGEN FOR THE COMPANY CONTROL TABLE                        *04000001
040100* -------------------------------------------------------------- *04010001
040200     EXEC SQL                                                     04020000
040300         INCLUDE TCOCNTL                                          04030000
040400     END-EXEC.                                                    04040000
040500                                                                  04050036
040600* -------------------------------------------------------------- *04060036
040700*    DCLGEN FOR THE TALLPLN TABLE                                *04070036
040800* -------------------------------------------------------------- *04080036
040900     EXEC SQL                                                     04090036
041000         INCLUDE TALLPLN                                          04100036
041100     END-EXEC.                                                    04110036
041200                                                                  04120001
041300* -------------------------------------------------------------- *04130001
041400*    TRECEIV CURSOR                                              *04140001
041500* -------------------------------------------------------------- *04150001
041600     EXEC SQL                                                     04160000
041700                                                                  04170001
041800        DECLARE TRECEIV-CSR CURSOR WITH HOLD FOR                  04180044
041900                                                                  04190001
042000          SELECT A.ORD_NBR                                        04200010
042100               , A.REC_SEQ_NBR                                    04210010
042200               , A.OPER_UNT_ID                                    04220010
042300               , A.FCLTY_ID                                       04230010
042400               , A.STATUS_CDE                                     04240010
042500               , A.REC_TMST                                       04250010
042600               , A.VERFYD_TMST                                    04260010
042700               , A.CURR_OPER_UNT_ID                               04270010
042800               , A.CURR_FCLTY_ID                                  04280010
042900               , A.VRFD_USR_ID                                    04290010
043000               , B.DEPT_NBR                                       04300031
043100               , B.PO_TYP_CDE                                     04310010
043200               , B.ENT_ID                                         04320010
043300               , B.IMPRT_VEND_NAME                                04330010
043400               , B.IMPRT_FCTRY_NAME                               04340010
043500                                                                  04350001
043600            FROM  TRECEIV A                                       04360044
043700                , TPURCHS B                                       04370044
043800                                                                  04380001
043900          WHERE ((DATE(A.REC_TMST)     >=  :PV-START-EXTRACT AND  04390000
044000                  DATE(A.REC_TMST)     <=  :PV-END-EXTRACT-CSR)   04400066
044100          OR     (DATE(A.VERFYD_TMST)  >=  :PV-START-EXTRACT AND  04410000
044200                  DATE(A.VERFYD_TMST)  <=  :PV-END-EXTRACT-CSR))  04420066
044300          AND   B.OTB_PER_NBR          BETWEEN :PV-BEG-PERIOD     04430056
044400                                           AND :PV-END-PERIOD     04440056
044500          AND   A.STATUS_CDE           ^=  :PC-DE                 04450056
044600          AND   A.ORD_NBR               =   B.PO_NBR              04460014
044700          AND   B.VER_STATUS_CDE        =  :PC-A                  04470014
044800                                                                  04480001
044900     END-EXEC.                                                    04490000
045000                                                                  04500001
045100* -------------------------------------------------------------- *04510001
045200*    RECEIVER ITEM CURSOR                                        *04520001
045300* -------------------------------------------------------------- *04530001
045400     EXEC SQL                                                     04540001
045500                                                                  04550001
045600       DECLARE TRECITM-CSR CURSOR WITH HOLD FOR                   04560002
045700                                                                  04570001
045800         SELECT ORD_NBR                                           04580003
045900              , REC_SEQ_NBR                                       04590003
046000              , OPER_UNT_ID                                       04600003
046100              , FCLTY_ID                                          04610003
046200              , ORD_LNE_NBR                                       04620003
046300              , ITM_NBR                                           04630001
046400                                                                  04640001
046500            FROM TRECITM                                          04650001
046600                                                                  04660001
046700         WHERE ORD_NBR      =  :RECEIV-ORD-NBR                    04670010
046800           AND REC_SEQ_NBR  =  :RECEIV-REC-SEQ-NBR                04680010
046900           AND OPER_UNT_ID  =  :RECEIV-OPER-UNT-ID                04690010
047000                                                                  04700001
047100         WITH UR                                                  04710010
047200                                                                  04720001
047300     END-EXEC.                                                    04730001
047400                                                                  04740000
047500                                                                  04750000
047600*----------------------------*                                    04760015
047700 PROCEDURE DIVISION.                                              04770000
047800*----------------------------*                                    04780015
047900                                                                  04790000
048000     OPEN OUTPUT DATE-FILE                                        04800015
048100                 EXTRACT-FILE.                                    04810015
048200                                                                  04820015
048300     PERFORM 1000-INITIALIZATION.                                 04830000
048400                                                                  04840000
048500     PERFORM 2000-PROCESS-EXTRACTS                                04850000
048600       UNTIL PS-TRECEIV-CSR-EOF.                                  04860031
048700                                                                  04870000
048800     PERFORM 7200-CLOSE-TRECEIV-CSR.                              04880000
048900                                                                  04890000
049000     CLOSE DATE-FILE                                              04900000
049100           EXTRACT-FILE.                                          04910000
049200                                                                  04920000
049300     MOVE PV-TRECEIV-COUNT   TO PV-DISPL-COUNT.                   04930014
049400                                                                  04940001
049500     DISPLAY ' '.                                                 04950054
049600     DISPLAY 'NBR OF TRECEIV ROWS EXTRACTED  : ' PV-DISPL-COUNT.  04960018
049700                                                                  04970001
049800     MOVE WS-RECORDS-WRITTEN TO PV-DISPL-COUNT.                   04980014
049900                                                                  04990001
050000     DISPLAY 'NBR OF EXTRACT RECORDS WRITTEN : ' PV-DISPL-COUNT.  05000018
050100     DISPLAY ' '.                                                 05010015
050200     DISPLAY '*-----------------------------------------------*'. 05020015
050300                                                                  05030000
050400                                                                  05040034
050500 PROGRAM-EXIT.                                                    05050034
050600     GOBACK.                                                      05060000
050700                                                                  05070000
050800* ----------------------------------------------------------------05080011
050900* ----------------------------------------------------------------05090011
051000 1000-INITIALIZATION.                                             05100000
051100     MOVE '1000-INITIALIZATION  ' TO PV-ABEND-PARAGRAPH.          05110014
051200                                                                  05120000
051300     ACCEPT PC-SYSTEM-DATE FROM DATE.                             05130000
051400                                                                  05140000
051500     EXEC SQL                                                     05150000
051600                                                                  05160001
051700         SELECT  (CURRENT DATE - 1 DAY)                           05170015
051800               ,  CURRENT DATE                                    05180015
051900               , (CURRENT DATE - 1 YEAR)                          05190000
052000                                                                  05200001
052100         INTO  :PV-CURRENT-DB2-DATE-ONE                           05210015
052200             , :PV-CURRENT-DB2-DATE                               05220015
052300             , :PV-CURRENT-DB2-DATE-ONEYR                         05230015
052400                                                                  05240001
052500           FROM  TCOCNTL                                          05250000
052600                                                                  05260001
052700         WHERE  OPER_UNT_ID = 90                                  05270015
052800                                                                  05280001
052900     END-EXEC.                                                    05290000
053000                                                                  05300000
053100                                                                  05310011
053200     EVALUATE SQLCODE                                             05320019
053300                                                                  05330001
053400       WHEN +0                                                    05340019
053500           MOVE PV-CURRENT-DB2-DATE TO PV-CURR-DATE               05350015
053600           MOVE PV-CURRENT-DB2-CC   TO PV-CURRENT-CC              05360015
053700           MOVE PV-CURRENT-DB2-YY   TO PV-CURRENT-YY              05370015
053800                                       PV-CURRENT-YYMMDD-YY       05380015
053900           MOVE PV-CURRENT-DB2-MM   TO PV-CURRENT-MM              05390015
054000                                       PV-CURRENT-YYMMDD-MM       05400015
054100           MOVE PV-CURRENT-DB2-DD   TO PV-CURRENT-DD              05410015
054200                                       PV-CURRENT-YYMMDD-DD       05420015
054300                                                                  05430001
054400       WHEN OTHER                                                 05440015
054500           MOVE '1100-INITIALIZATION' TO PV-ABEND-PARAGRAPH       05450015
054600           MOVE 'SET DATE   '         TO PV-DB2-OPER-MESS-1       05460015
054700           MOVE 'NONE   '             TO PV-DB2-TABLE-NAME        05470015
054800           PERFORM 9900-DB2-ABEND                                 05480015
054900                                                                  05490001
055000     END-EVALUATE.                                                05500015
055100                                                                  05510000
055200     ACCEPT CONTROL-CARD-FIELDS FROM SYSIN.                       05520018
055300                                                                  05530000
055400     DISPLAY '*-----------------------------------------------*'. 05540015
055500     DISPLAY '*              PROGRAM - RCKUT073               *'. 05550067
055600     DISPLAY '*-----------------------------------------------*'. 05560031
055700     DISPLAY ' '.                                                 05570031
055800     DISPLAY ' CONTROL CARD SET-UP IS : ' CONTROL-CARD-FIELDS.    05580054
055900                                                                  05590000
056000     PERFORM 1100-CHECK-CC-FIELDS.                                05600018
056100                                                                  05610001
056200     PERFORM 1200-SET-DATABASE-KEYS.                              05620000
056300                                                                  05630001
056400     PERFORM 7000-OPEN-TRECEIV-CSR.                               05640001
056500                                                                  05650001
056600     PERFORM 7100-FETCH-TRECEIV-CSR.                              05660000
056700                                                                  05670011
056800* -------------------------------------------------------------- *05680011
056900*    CHECK THAT A VALID TIME FRAME HAS BEEN REQUESTED.           *05690011
057000* -------------------------------------------------------------- *05700011
057100 1100-CHECK-CC-FIELDS.                                            05710018
057200                                                                  05720000
057300     IF NOT CC-VALID-MODE-IND                                     05730000
057400         MOVE '1100-CHECK-CC-FIELDS' TO PV-PARAGRAPH-NAME         05740046
057500         DISPLAY '*---------------------------------------*'      05750015
057600         DISPLAY '**              ABEND                  **'      05760015
057700         DISPLAY '**         IN PROGRAM RCKUT073         **'      05770015
057800         DISPLAY '*---------------------------------------*'      05780015
057900         DISPLAY '** PARAGRAPH          = ' PV-PARAGRAPH-NAME     05790015
058000         DISPLAY '**   ERROR            = '                       05800015
058100                 'MODE INDICATOR "' CC-MODE-IND '"' ' IS INVALID' 05810018
058200         DISPLAY '*---------------------------------------*'      05820015
058300         DISPLAY '** CONTROL PARAMETERS = ' CONTROL-CARD-FIELDS   05830018
058400         DISPLAY 'RUN ABORTED'                                    05840000
058500         DISPLAY '*---------------------------------------*'      05850015
058600         MOVE 4003  TO PV-ABEND-CODE                              05860000
058700         DISPLAY 'PV-ABEND-CODE = ' PV-ABEND-CODE                 05870000
058800         CALL 'ILBOABN0'   USING PV-ABEND-CODE                    05880000
058900     END-IF.                                                      05890000
059000                                                                  05900000
059100     IF CC-BEG-DATE  =  PC-DEFAULT-CC-DATE AND                    05910045
059200        CC-END-DATE  =  PC-DEFAULT-CC-DATE                        05920045
059300         SET PS-NORMAL-RUN  TO TRUE                               05930045
059400     ELSE                                                         05940000
059500         PERFORM 1110-SET-DATE-CONTROLS                           05950045
059600     END-IF.                                                      05960013
059700     DISPLAY ' TYPE OF RUN = ' PS-NORMAL-RUN-SW.                  05970054
059800                                                                  05980000
059900     IF PS-SPECIAL-RUN                                            05990070
060000       AND CC-SEASONAL-EXTRACT                                    06000070
060100         IF DPG56-FISCAL-PERIOD-NBR < 7                           06010070
060200             MOVE PC-SPRING TO PV-SEASON-DESC                     06020070
060300         ELSE                                                     06030070
060400             MOVE PC-FALL  TO  PV-SEASON-DESC                     06040031
060500         END-IF                                                   06050045
060600     END-IF.                                                      06060045
060700                                                                  06070045
060800* -------------------------------------------------------------- *06080045
060900* -------------------------------------------------------------- *06090045
061000 1110-SET-DATE-CONTROLS.                                          06100045
061100***  DISPLAY '  1110-SET-DATE-CONTROLS'.                          06110067
061200                                                                  06120045
061300     SET PS-SPECIAL-RUN  TO TRUE.                                 06130045
061400                                                                  06140045
061500     MOVE CC-BEG-CC  TO PV-BEG-YMD-CC.                            06150045
061600     MOVE CC-BEG-YY  TO PV-BEG-YY.                                06160045
061700     MOVE CC-BEG-YY  TO PV-BEG-YMD-YY.                            06170045
061800     MOVE CC-BEG-MM  TO PV-BEG-MM.                                06180045
061900     MOVE CC-BEG-MM  TO PV-BEG-YMD-MM.                            06190045
062000     MOVE CC-BEG-DD  TO PV-BEG-DD.                                06200045
062100     MOVE CC-BEG-DD  TO PV-BEG-YMD-DD.                            06210045
062200     MOVE CC-END-CC  TO PV-END-YMD-CC.                            06220045
062300     MOVE CC-END-YY  TO PV-END-YY.                                06230045
062400     MOVE CC-END-YY  TO PV-END-YMD-YY.                            06240045
062500     MOVE CC-END-MM  TO PV-END-MM.                                06250045
062600     MOVE CC-END-MM  TO PV-END-YMD-MM.                            06260045
062700     MOVE CC-END-DD  TO PV-END-DD.                                06270045
062800     MOVE CC-END-DD  TO PV-END-YMD-DD.                            06280045
062900                                                                  06290045
063000     IF PV-BEG-DATE-CYMD NOT < PV-END-DATE-CYMD  AND              06300045
063100        PV-BEG-DATE-CYMD NOT = PV-END-DATE-CYMD                   06310045
063200         DISPLAY '*---------------------------------------*'      06320045
063300         DISPLAY 'CONTROL PARAMETERS: ' CONTROL-CARD-FIELDS       06330045
063400         DISPLAY 'THE BEGINNING DATE MUST BE LESS THAN '          06340045
063500                 'OR EQUAL TO THE ENDING DATE'                    06350045
063600         DISPLAY 'PV-BEG-DATE - ' PV-BEG-DATE                     06360045
063700         DISPLAY 'PV-END-DATE - ' PV-BEG-DATE                     06370045
063800         DISPLAY 'PV-BEG-DATE-CYMD - ' PV-BEG-DATE-CYMD           06380045
063900         DISPLAY 'PV-END-DATE-CYMD - ' PV-BEG-DATE-CYMD           06390045
064000         DISPLAY 'RUN ABORTED'                                    06400045
064100         DISPLAY '*---------------------------------------*'      06410045
064200         MOVE 4003  TO PV-ABEND-CODE                              06420045
064300         DISPLAY 'PV-ABEND-CODE = ' PV-ABEND-CODE                 06430045
064400         CALL 'ILBOABN0'   USING PV-ABEND-CODE                    06440045
064500     END-IF.                                                      06450045
064600                                                                  06460045
064700     INITIALIZE DPG51                                             06470052
064800                DPG52                                             06480052
064900                DPG53                                             06490052
065000                DPG54                                             06500052
065100                DPG55                                             06510052
065200                DPG56.                                            06520052
065300                                                                  06530045
065400     SET DPG51-FISCAL-454-CALENDAR                                06540045
065500         DPG51-DO-NOT-INCR-DECR-DATE                              06550045
065600         DPG52-LK-DTE-GREG-FMT      TO TRUE.                      06560052
065700                                                                  06570045
065800     MOVE PV-BEG-DATE  TO  DPG52-LK-DATE-INPUT.                   06580045
065900                                                                  06590045
066000     PERFORM 9100-CALL-DATE-MODULE.                               06600045
066100                                                                  06610045
066200     IF DPG54-DATE-INVALID                                        06620045
066300         DISPLAY '*---------------------------------------*'      06630045
066400         DISPLAY 'CONTROL PARAMETERS: ' CONTROL-CARD-FIELDS       06640045
066500         DISPLAY 'BEGINNING DATE  ' CC-BEG-DATE ' IS INVALID.'    06650045
066600         DISPLAY 'RUN ABORTED'                                    06660045
066700         DISPLAY '*---------------------------------------*'      06670045
066800         MOVE 4003  TO PV-ABEND-CODE                              06680045
066900         DISPLAY 'PV-ABEND-CODE = ' PV-ABEND-CODE                 06690045
067000         CALL 'ILBOABN0'   USING PV-ABEND-CODE                    06700045
067100     END-IF.                                                      06710045
067200                                                                  06720045
067300     INITIALIZE DPG51                                             06730052
067400                DPG52                                             06740052
067500                DPG53                                             06750052
067600                DPG54                                             06760052
067700                DPG55                                             06770052
067800                DPG56.                                            06780052
067900                                                                  06790045
068000     SET DPG51-FISCAL-454-CALENDAR                                06800045
068100         DPG51-DO-NOT-INCR-DECR-DATE                              06810045
068200         DPG52-LK-DTE-GREG-FMT    TO TRUE.                        06820045
068300                                                                  06830045
068400     MOVE PV-END-DATE  TO  DPG52-LK-DATE-INPUT.                   06840045
068500                                                                  06850045
068600     PERFORM 9100-CALL-DATE-MODULE.                               06860045
068700                                                                  06870045
068800     IF DPG54-DATE-INVALID                                        06880045
068900         DISPLAY '*---------------------------------------*'      06890045
069000         DISPLAY 'CONTROL FIELDS: ' CONTROL-CARD-FIELDS           06900045
069100         DISPLAY 'ENDING DATE ' CC-END-DATE ' IS INVALID.'        06910045
069200         DISPLAY 'RUN ABORTED'                                    06920045
069300         DISPLAY '*---------------------------------------*'      06930045
069400         MOVE 4003  TO PV-ABEND-CODE                              06940045
069500         DISPLAY 'PV-ABEND-CODE = ' PV-ABEND-CODE                 06950045
069600         CALL 'ILBOABN0'   USING PV-ABEND-CODE                    06960045
069700     END-IF.                                                      06970045
069800                                                                  06980045
069900* -------------------------------------------------------------- *06990045
070000* -------------------------------------------------------------- *07000045
070100 1200-SET-DATABASE-KEYS.                                          07010000
070200     MOVE '1200-SET-DATABASE-KEYS  ' TO PV-ABEND-PARAGRAPH.       07020011
070300                                                                  07030000
070400     IF PS-NORMAL-RUN                                             07040000
070500         PERFORM 1300-DETERMINE-DATE-RANGE                        07050015
070600     ELSE                                                         07060000
070700         MOVE CC-BEG-DATE  TO  PV-START-EXTRACT                   07070045
070800         MOVE CC-END-DATE  TO  PV-END-EXTRACT                     07080045
070900     END-IF.                                                      07090000
071000                                                                  07100066
071100     MOVE PV-START-EXTRACT-YYYY    TO  WS-START-EXTRACT-YYYY.     07110001
071200     MOVE PV-START-EXTRACT-MM      TO  WS-START-EXTRACT-MM.       07120001
071300     MOVE PV-START-EXTRACT-DD      TO  WS-START-EXTRACT-DD.       07130001
071400     MOVE PV-END-EXTRACT-YYYY      TO  WS-END-EXTRACT-YYYY.       07140001
071500     MOVE PV-END-EXTRACT-MM        TO  WS-END-EXTRACT-MM.         07150001
071600     MOVE PV-END-EXTRACT-DD        TO  WS-END-EXTRACT-DD.         07160001
071700                                                                  07170000
071800     MOVE DPG56-FISCAL-PERIOD-NBR  TO  WS-FISCAL-PER-NBR.         07180015
071900     MOVE DPG56-FISCAL-PERIOD-WEEK TO  WS-FISCAL-PER-WK.          07190015
072000     MOVE DPG56-FISCAL-QTR-NBR     TO  WS-FISCAL-QTR-NBR.         07200001
072100     MOVE DPG56-FISCAL-WEEK-NBR    TO  WS-FISCAL-WK-NBR.          07210015
072200     MOVE DPG56-FISCAL-YEAR-NBR    TO  WS-FISCAL-YEAR.            07220071
072300                                                                  07230000
072400     MOVE PV-START-EXTRACT-MM      TO  RC067-DATE-STA-MM.         07240049
072500     MOVE PV-START-EXTRACT-DD      TO  RC067-DATE-STA-DD.         07250049
072600     MOVE PV-START-EXTRACT-YYYY    TO  RC067-DATE-STA-CCYY.       07260049
072700     MOVE PV-END-EXTRACT-MM        TO  RC067-DATE-END-MM          07270048
072800                                       PV-EDR-MM.                 07280026
072900     MOVE PV-END-EXTRACT-DD        TO  RC067-DATE-END-DD          07290048
073000                                       PV-EDR-DD.                 07300026
073100     MOVE PV-END-EXTRACT-YYYY      TO  RC067-DATE-END-CCYY        07310048
073200                                       PV-EDR-CCYY.               07320026
073300     MOVE WS-FISCAL-PER-NBR        TO  RC067-DATE-FISCAL-PERIOD.  07330049
073400     MOVE WS-FISCAL-QTR-NBR        TO  RC067-DATE-FISCAL-QUARTER. 07340049
073500     MOVE PV-SEASON-DESC           TO  RC067-DATE-SEASON.         07350048
073600                                                                  07360000
073700     DISPLAY ' DATE RANGE SET-UP IS   : ' RC067-DATE-RECORD.      07370054
073800                                                                  07380000
073900     WRITE DATE-RECORD FROM RC067-DATE-RECORD.                    07390048
074000                                                                  07400067
074100*SET ENDING EXTRACT DATE ON CURSOR.                               07410067
074200     MOVE PV-END-EXTRACT TO PV-END-EXTRACT-CSR.                   07420067
074300     PERFORM 1210-ADD-SEVEN-DAYS.                                 07430067
074400                                                                  07440067
074500*SET EXTRACT BEGINNING/ENDING PERIODS.                            07450067
074600     MOVE PV-CURRENT-DB2-CC        TO  PV-BEG-PERIOD-CC           07460058
074700                                       PV-END-PERIOD-CC.          07470058
074800*JPL MOVE PV-CURRENT-DB2-YY                                       07480071
074900     MOVE WS-FISCAL-YEAR           TO  PV-BEG-PERIOD-YY           07490071
075000                                       PV-END-PERIOD-YY.          07500058
075100     IF CC-MODE-IND = 'M'                                         07510062
075200         MOVE WS-FISCAL-PER-NBR    TO  PV-BEG-PERIOD-PP           07520061
075300                                       PV-END-PERIOD-PP           07530061
075400     END-IF.                                                      07540061
075500     IF CC-MODE-IND = 'S'                                         07550062
075600         IF WS-FISCAL-PER-NBR < 7                                 07560062
075700             MOVE 01               TO  PV-BEG-PERIOD-PP           07570062
075800             MOVE 06               TO  PV-END-PERIOD-PP           07580062
075900         ELSE                                                     07590062
076000             MOVE 07               TO  PV-BEG-PERIOD-PP           07600062
076100             MOVE 12               TO  PV-END-PERIOD-PP           07610062
076200     END-IF.                                                      07620062
076300                                                                  07630061
076400     DISPLAY ' BEG/END PERIOD: ' PV-BEG-PERIOD                    07640059
076500                           ' / ' PV-END-PERIOD.                   07650059
076600                                                                  07660011
076700* -------------------------------------------------------------- *07670066
076800* 9/24/03 - ADD 7 DAYS TO END-DATE.                               07680069
076900* -------------------------------------------------------------- *07690066
077000 1210-ADD-SEVEN-DAYS.                                             07700066
077100     MOVE '1210-ADD-SEVEN-DAYS'  TO PV-ABEND-PARAGRAPH.           07710066
077200                                                                  07720066
077300     MOVE PV-END-EXTRACT-YY      TO PV-DATE-AREA-YY.              07730066
077400     MOVE PV-END-EXTRACT-MM      TO PV-DATE-AREA-MM.              07740066
077500     MOVE PV-END-EXTRACT-DD      TO PV-DATE-AREA-DD.              07750066
077600     MOVE PV-DATE-AREA           TO DPG52-LK-DATE-INPUT.          07760066
077700     MOVE PC-SEVEN               TO DPG51-INCR-DECR-DAYS-9.       07770066
077800                                                                  07780066
077900     SET DPG51-ACTUAL-CALENDAR-ONLY                               07790066
078000         DPG51-INCREMENT-DATE                                     07800066
078100         DPG52-LK-DTE-GREG-FMT   TO TRUE.                         07810066
078200                                                                  07820066
078300     PERFORM 9100-CALL-DATE-MODULE.                               07830066
078400                                                                  07840066
078500     MOVE DPG55-GREG-CC-DATE-FMT TO PV-END-DATE-PLUS-7.           07850066
078600     DISPLAY ' '.                                                 07860067
078700     DISPLAY ' PV-END-DATE-PLUS-7 = ' PV-END-DATE-PLUS-7.         07870067
078800     DISPLAY ' '.                                                 07880067
078900                                                                  07890066
079000     MOVE PV-DATE-PLUS-7-MM      TO PV-CSR-EXTRACT-MM.            07900066
079100     MOVE PV-DATE-PLUS-7-DD      TO PV-CSR-EXTRACT-DD.            07910066
079200     MOVE PV-DATE-PLUS-7-CC      TO PV-CSR-EXTRACT-CC.            07920066
079300     MOVE PV-DATE-PLUS-7-YY      TO PV-CSR-EXTRACT-YY.            07930066
079400                                                                  07940066
079500* -------------------------------------------------------------- *07950066
079600* -------------------------------------------------------------- *07960011
079700 1300-DETERMINE-DATE-RANGE.                                       07970015
079800     MOVE '1300-DETERMINE-DATE-RANGE'  TO PV-ABEND-PARAGRAPH.     07980015
079900                                                                  07990000
080000     EVALUATE TRUE                                                08000000
080100                                                                  08010001
080200       WHEN CC-MONTHLY-EXTRACT                                    08020000
080300           PERFORM 1320-MONTHLY-RPT-DTE-RANGE                     08030015
080400                                                                  08040000
080500       WHEN CC-FISCAL-EXTRACT                                     08050000
080600           PERFORM 1330-FISCAL-RPT-DTE-RANGE                      08060015
080700                                                                  08070000
080800       WHEN CC-CALENDAR-EXTRACT                                   08080000
080900           PERFORM 1340-CALENDAR-RPT-DTE-RANGE                    08090015
081000                                                                  08100000
081100       WHEN CC-SEASONAL-EXTRACT                                   08110000
081200           PERFORM 1350-SEASONAL-RPT-DTE-RANGE                    08120015
081300                                                                  08130000
081400     END-EVALUATE.                                                08140000
081500                                                                  08150000
081600                                                                  08160001
081700*--------------------------------------------------------------   08170001
081800*    GET START/END DATES OF THE PREVIOUS MONTH.                   08180015
081900*--------------------------------------------------------------   08190001
082000 1320-MONTHLY-RPT-DTE-RANGE.                                      08200015
082100     MOVE '1320-MONTHLY-RPT-DTE-RANGE' TO PV-ABEND-PARAGRAPH.     08210015
082200                                                                  08220001
082300     INITIALIZE DPG51                                             08230052
082400                DPG52                                             08240052
082500                DPG53                                             08250052
082600                DPG54                                             08260052
082700                DPG55                                             08270052
082800                DPG56.                                            08280052
082900                                                                  08290001
083000     MOVE PV-CURRENT-YY   TO  PV-DATE-AREA-YY.                    08300001
083100     MOVE PV-CURRENT-MM   TO  PV-DATE-AREA-MM.                    08310001
083200     MOVE PV-CURRENT-DD   TO  PV-DATE-AREA-DD.                    08320001
083300     MOVE PV-DATE-AREA    TO  DPG52-LK-DATE-INPUT.                08330001
083400     MOVE PC-TWENTY-EIGHT TO  DPG51-INCR-DECR-DAYS-9.             08340001
083500                                                                  08350000
083600     SET DPG51-FISCAL-454-CALENDAR                                08360001
083700         DPG51-DECREMENT-DATE                                     08370001
083800         DPG52-LK-DTE-GREG-FMT      TO TRUE.                      08380001
083900                                                                  08390000
084000     PERFORM 9100-CALL-DATE-MODULE.                               08400001
084100                                                                  08410000
084200     MOVE DPG56-FIRST-FP-DB2-ISO-FMT  TO  PV-START-EXTRACT        08420001
084300     MOVE DPG56-LAST-FP-DB2-ISO-FMT   TO  PV-END-EXTRACT.         08430001
084400                                                                  08440064
084500*-------------------------------------------------------------    08450001
084600*    GET START/END DATES OF THE FISCAL PERIOD.                    08460015
084700*-------------------------------------------------------------    08470001
084800 1330-FISCAL-RPT-DTE-RANGE.                                       08480015
084900     MOVE '1330-FISCAL-RPT-DTE-RANGE ' TO PV-ABEND-PARAGRAPH.     08490015
085000                                                                  08500001
085100     INITIALIZE DPG51                                             08510052
085200                DPG52                                             08520052
085300                DPG53                                             08530052
085400                DPG54                                             08540052
085500                DPG55                                             08550052
085600                DPG56.                                            08560052
085700                                                                  08570001
085800     MOVE PV-CURRENT-YY    TO  PV-DATE-AREA-YY.                   08580001
085900     MOVE PV-CURRENT-MM    TO  PV-DATE-AREA-MM.                   08590001
086000     MOVE PV-CURRENT-DD    TO  PV-DATE-AREA-DD.                   08600001
086100     MOVE PV-DATE-AREA     TO  DPG52-LK-DATE-INPUT.               08610001
086200     MOVE PC-TWENTY-EIGHT  TO DPG51-INCR-DECR-DAYS-9.             08620001
086300                                                                  08630000
086400     SET DPG51-FISCAL-454-CALENDAR                                08640001
086500         DPG51-DECREMENT-DATE                                     08650001
086600         DPG52-LK-DTE-GREG-FMT      TO TRUE.                      08660001
086700                                                                  08670000
086800     PERFORM 9100-CALL-DATE-MODULE.                               08680001
086900                                                                  08690000
087000     IF DPG56-FISCAL-PERIOD-NBR = 12                              08700001
087100         MOVE DPG56-FIRST-FD-DB2-ISO-FMT TO PV-START-EXTRACT      08710001
087200         MOVE DPG56-LAST-FD-DB2-ISO-FMT  TO PV-END-EXTRACT        08720001
087300     ELSE                                                         08730000
087400         MOVE DPG56-FIRST-FD-DB2-ISO-FMT TO PV-START-EXTRACT      08740001
087500         INITIALIZE DPG51                                         08750052
087600                    DPG52                                         08760052
087700                    DPG53                                         08770052
087800                    DPG54                                         08780052
087900                    DPG55                                         08790052
088000                    DPG56                                         08800052
088100         MOVE PC-ONE                     TO DPG51-INCR-DECR-DAYS-908810011
088200         MOVE PV-DATE-AREA               TO DPG52-LK-DATE-INPUT   08820011
088300         SET DPG51-FISCAL-454-CALENDAR                            08830001
088400             DPG51-DECREMENT-DATE                                 08840001
088500             DPG52-LK-DTE-GREG-FMT    TO TRUE                     08850045
088600         PERFORM 9100-CALL-DATE-MODULE                            08860000
088700         MOVE DPG55-DB2-ISO-DATE-FMT  TO  PV-END-EXTRACT          08870045
088800     END-IF.                                                      08880000
088900                                                                  08890000
089000                                                                  08900001
089100*-------------------------------------------------------------- * 08910015
089200*    GET START/END DATES OF THE CALENDAR PERIOD.                  08920015
089300*    IF JANUARY WANT TO CREATE REPORT FOR PREV. CALENDAR YEAR     08930015
089400*-------------------------------------------------------------- * 08940015
089500 1340-CALENDAR-RPT-DTE-RANGE.                                     08950015
089600     MOVE '1340-CALENDAR-RPT-DTE-RANGE' TO PV-ABEND-PARAGRAPH.    08960015
089700                                                                  08970001
089800     IF PV-CURRENT-MM = 1                                         08980015
089900         MOVE PV-CDD-ONEYR-CCYY  TO  PV-START-EXTRACT-YYYY        08990001
090000                                     PV-END-EXTRACT-YYYY          09000001
090100         MOVE  '-'               TO  PV-START-EXTRACT-1ST         09010001
090200         MOVE  01                TO  PV-START-EXTRACT-MM          09020001
090300         MOVE  '-'               TO  PV-START-EXTRACT-2ND         09030001
090400         MOVE  01                TO  PV-START-EXTRACT-DD          09040001
090500         MOVE  '-'               TO  PV-END-EXTRACT-1ST           09050001
090600         MOVE   12               TO  PV-END-EXTRACT-MM            09060001
090700         MOVE  '-'               TO  PV-END-EXTRACT-2ND           09070001
090800         MOVE   31               TO  PV-END-EXTRACT-DD            09080001
090900     ELSE                                                         09090000
091000*-----------------------------------------------------------------09100001
091100*        CURRENT MONTH > 01                                       09110000
091200*           BEGINNING DATE = CURRENT YEAR, 01, 01                 09120001
091300*           ENDING DATE    = CURRENT DATE - 1                     09130001
091400*-----------------------------------------------------------------09140001
091500         MOVE PV-CURRENT-CCYY         TO  PV-START-EXTRACT-YYYY   09150001
091600         MOVE  '-'                    TO  PV-START-EXTRACT-1ST    09160001
091700         MOVE  01                     TO  PV-START-EXTRACT-MM     09170001
091800         MOVE  '-'                    TO  PV-START-EXTRACT-2ND    09180001
091900         MOVE  01                     TO  PV-START-EXTRACT-DD     09190001
092000         MOVE PV-CURRENT-DB2-DATE-ONE TO  PV-END-EXTRACT          09200001
092100     END-IF.                                                      09210000
092200                                                                  09220000
092300                                                                  09230011
092400*-----------------------------------------------------------------09240000
092500*    DETERMINE FISCAL-PERIOD-NUMBER, FISCAL-PERIOD-WEEK,          09250011
092600*              FISCAL-WEEK-NUMBER,   FISCAL-QUARTER-NUMBER        09260011
092700*    FROM PV-END-EXTRACT DATE.                                    09270011
092800*-----------------------------------------------------------------09280000
092900                                                                  09290000
093000     MOVE PV-END-EXTRACT-MM  TO  WS-WORK-ARRIVE-MM.               09300001
093100     MOVE PV-END-EXTRACT-DD  TO  WS-WORK-ARRIVE-DD.               09310001
093200     MOVE PV-END-EXTRACT-CC  TO  WS-WORK-ARRIVE-CC.               09320001
093300     MOVE PV-END-EXTRACT-YY  TO  WS-WORK-ARRIVE-YY.               09330001
093400                                                                  09340001
093500     INITIALIZE DPG51                                             09350052
093600                DPG52                                             09360052
093700                DPG53                                             09370052
093800                DPG54                                             09380052
093900                DPG55                                             09390052
094000                DPG56.                                            09400052
094100                                                                  09410001
094200     MOVE WS-ARRIVE-DATE-WORK  TO  DPG52-LK-DATE-INPUT.           09420015
094300                                                                  09430001
094400     SET  DPG51-FISCAL-454-CALENDAR                               09440001
094500          DPG51-DO-NOT-INCR-DECR-DATE                             09450001
094600          DPG52-LK-DTE-GREG-CC-FMT   TO TRUE.                     09460034
094700                                                                  09470000
094800     PERFORM 9100-CALL-DATE-MODULE.                               09480000
094900                                                                  09490000
095000                                                                  09500001
095100*-------------------------------------------------------------    09510001
095200*    GET START/END DATES SEASONAL                                 09520015
095300*-------------------------------------------------------------    09530001
095400 1350-SEASONAL-RPT-DTE-RANGE.                                     09540015
095500     MOVE '1350-SEASONAL-RPT-DTE-RANGE' TO PV-ABEND-PARAGRAPH.    09550015
095600                                                                  09560001
095700     INITIALIZE DPG51                                             09570052
095800                DPG52                                             09580052
095900                DPG53                                             09590052
096000                DPG54                                             09600052
096100                DPG55                                             09610052
096200                DPG56.                                            09620052
096300                                                                  09630001
096400     MOVE PV-CURRENT-YY    TO  PV-DATE-AREA-YY.                   09640001
096500     MOVE PV-CURRENT-MM    TO  PV-DATE-AREA-MM.                   09650001
096600     MOVE PV-CURRENT-DD    TO  PV-DATE-AREA-DD.                   09660001
096700     MOVE PV-DATE-AREA     TO  DPG52-LK-DATE-INPUT.               09670001
096800     MOVE PC-TWENTY-EIGHT  TO  DPG51-INCR-DECR-DAYS-9.            09680001
096900                                                                  09690000
097000     SET DPG51-FISCAL-454-CALENDAR                                09700001
097100         DPG51-DECREMENT-DATE                                     09710001
097200         DPG52-LK-DTE-GREG-FMT   TO TRUE.                         09720018
097300                                                                  09730000
097400     PERFORM 9100-CALL-DATE-MODULE.                               09740011
097500                                                                  09750000
097600     IF DPG56-FISCAL-PERIOD-NBR < 7                               09760000
097700         MOVE PC-SPRING TO PV-SEASON-DESC                         09770015
097800     ELSE                                                         09780000
097900         MOVE PC-FALL   TO PV-SEASON-DESC                         09790015
098000     END-IF.                                                      09800000
098100                                                                  09810001
098200     IF DPG56-FISCAL-PERIOD-NBR < 6                               09820001
098300         MOVE DPG56-FIRST-FD-DB2-ISO-FMT TO  PV-START-EXTRACT     09830001
098400         MOVE PV-CURRENT-DB2-DATE-ONE    TO  PV-END-EXTRACT       09840001
098500     END-IF.                                                      09850000
098600                                                                  09860001
098700     IF DPG56-FISCAL-PERIOD-NBR = 6                               09870001
098800         MOVE DPG56-FIRST-FD-DB2-ISO-FMT TO PV-START-EXTRACT      09880001
098900         MOVE DPG56-LAST-FD-DB2-ISO-FMT  TO PV-END-EXTRACT        09890001
099000     END-IF.                                                      09900000
099100                                                                  09910001
099200     IF DPG56-FISCAL-PERIOD-NBR = 7                               09920001
099300         MOVE DPG56-FIRST-FD-DB2-ISO-FMT TO PV-START-EXTRACT      09930001
099400         MOVE PV-CURRENT-DB2-DATE-ONE    TO PV-END-EXTRACT        09940001
099500     END-IF.                                                      09950000
099600                                                                  09960001
099700     IF DPG56-FISCAL-PERIOD-NBR > 7                               09970001
099800         MOVE PV-CURRENT-DB2-DATE-ONE TO PV-END-EXTRACT           09980001
099900     END-IF.                                                      09990000
100000                                                                  10000001
100100     IF DPG56-FISCAL-PERIOD-NBR = 12                              10010001
100200         MOVE DPG56-LAST-FD-DB2-ISO-FMT  TO PV-END-EXTRACT        10020001
100300     END-IF.                                                      10030000
100400                                                                  10040001
100500     IF DPG56-FISCAL-PERIOD-NBR > 7                               10050001
100600         MOVE DPG56-FIRST-FD-DB2-ISO-FMT-YR TO  PV-YEAR-FORMAT    10060001
100700         MOVE PV-YEAR-FORMAT-YY             TO  PV-DATE-AREA-YY   10070001
100800         MOVE 01  TO  PV-DATE-AREA-MM                             10080045
100900                      PV-DATE-AREA-DD                             10090045
101000         INITIALIZE DPG51                                         10100052
101100                    DPG52                                         10110052
101200                    DPG53                                         10120052
101300                    DPG54                                         10130052
101400                    DPG55                                         10140052
101500                    DPG56                                         10150052
101600         MOVE PV-DATE-AREA  TO  DPG52-LK-DATE-INPUT               10160052
101700         MOVE 220           TO  DPG51-INCR-DECR-DAYS-9            10170052
101800         SET DPG51-FISCAL-454-CALENDAR                            10180001
101900             DPG51-INCREMENT-DATE                                 10190001
102000             DPG52-LK-DTE-GREG-FMT  TO TRUE                       10200045
102100         PERFORM 9100-CALL-DATE-MODULE                            10210000
102200         MOVE DPG56-FIRST-FP-DB2-ISO-FMT TO PV-START-EXTRACT      10220001
102300     END-IF.                                                      10230000
102400                                                                  10240000
102500*----------------------------------------------------------------*10250044
102600*    DETERMINE FISCAL-PERIOD-NUMBER, FISCAL-PERIOD-WEEK,         *10260044
102700*              FISCAL-WEEK-NUMBER,   FISCAL-QUARTER-NUMBER       *10270044
102800*    FROM PV-END-EXTRACT DATE.                                   *10280044
102900*----------------------------------------------------------------*10290044
103000                                                                  10300000
103100     MOVE PV-END-EXTRACT-MM  TO  WS-WORK-ARRIVE-MM.               10310045
103200     MOVE PV-END-EXTRACT-DD  TO  WS-WORK-ARRIVE-DD.               10320045
103300     MOVE PV-END-EXTRACT-CC  TO  WS-WORK-ARRIVE-CC.               10330045
103400     MOVE PV-END-EXTRACT-YY  TO  WS-WORK-ARRIVE-YY.               10340045
103500                                                                  10350001
103600     INITIALIZE DPG51                                             10360052
103700                DPG52                                             10370052
103800                DPG53                                             10380052
103900                DPG54                                             10390052
104000                DPG55                                             10400052
104100                DPG56.                                            10410052
104200                                                                  10420001
104300     MOVE WS-ARRIVE-DATE-WORK  TO  DPG52-LK-DATE-INPUT.           10430001
104400     MOVE ZEROES               TO  DPG51-INCR-DECR-DAYS-9.        10440001
104500                                                                  10450001
104600     SET  DPG51-FISCAL-454-CALENDAR                               10460001
104700          DPG51-DO-NOT-INCR-DECR-DATE                             10470001
104800          DPG52-LK-DTE-GREG-CC-FMT   TO TRUE.                     10480052
104900                                                                  10490000
105000     PERFORM 9100-CALL-DATE-MODULE.                               10500000
105100                                                                  10510000
105200                                                                  10520011
105300*----------------------------------------------------------------*10530044
105400*    FROM THE RECIEPT DISTRIBUTION TABLE(TRECDIS) GET THE        *10540044
105500*    SUM OF THE EXPECTED & VERIFIED QUANTITIES FOR ALL LINES     *10550044
105600*    OF A GIVEN RECEIVER                                         *10560044
105700*----------------------------------------------------------------*10570044
105800                                                                  10580001
105900 2000-PROCESS-EXTRACTS.                                           10590000
106000                                                                  10600001
106100     PERFORM 6000-OPEN-TRECITM-CSR.                               10610001
106200                                                                  10620001
106300     PERFORM 6100-FETCH-TRECITM-CSR                               10630045
106400       UNTIL PS-TRECITM-CSR-EOF.                                  10640045
106500                                                                  10650003
106600     PERFORM 6300-CLOSE-TRECITM-CSR.                              10660044
106700                                                                  10670002
106800     PERFORM 7100-FETCH-TRECEIV-CSR.                              10680002
106900                                                                  10690033
107000                                                                  10700011
107100*-----------------------------------------------------------------10710011
107200*    DETERMINE FISCAL-PERIOD-NUMBER, FISCAL-PERIOD-WEEK,          10720011
107300*              FISCAL-WEEK-NUMBER,   FISCAL-QUARTER-NUMBER        10730011
107400*    FROM ARRIVED DATE.                                           10740011
107500*-----------------------------------------------------------------10750011
107600                                                                  10760000
107700 4000-ARRIVE-DATE-PERIOD.                                         10770000
107800                                                                  10780001
107900     MOVE '4000-ARRIVE-DATE-PERIOD ' TO PV-ABEND-PARAGRAPH.       10790000
108000                                                                  10800000
108100     MOVE WS-ARRIVE-MM         TO  WS-WORK-ARRIVE-MM.             10810001
108200     MOVE WS-ARRIVE-DD         TO  WS-WORK-ARRIVE-DD.             10820001
108300     MOVE WS-ARRIVE-CC         TO  WS-WORK-ARRIVE-CC.             10830001
108400     MOVE WS-ARRIVE-YY         TO  WS-WORK-ARRIVE-YY.             10840001
108500     MOVE WS-ARRIVE-DATE-WORK  TO  DPG52-LK-DATE-INPUT.           10850001
108600                                                                  10860001
108700     SET  DPG51-FISCAL-454-CALENDAR                               10870001
108800          DPG51-DO-NOT-INCR-DECR-DATE                             10880001
108900          DPG52-LK-DTE-GREG-CC-FMT   TO  TRUE.                    10890001
109000                                                                  10900000
109100     PERFORM 9100-CALL-DATE-MODULE.                               10910000
109200                                                                  10920000
109300     IF DPG54-DATE-VALID                                          10930000
109400         MOVE DPG56-FISCAL-PERIOD-NBR  TO WS-DEPT-ARRIVE-PER-NBR  10940015
109500         MOVE DPG56-FISCAL-QTR-NBR     TO WS-DEPT-ARRIVE-QTR-NBR  10950015
109600         MOVE DPG56-FISCAL-PERIOD-WEEK TO WS-DEPT-ARRIVE-PER-WK   10960015
109700         MOVE DPG56-FISCAL-WEEK-NBR    TO WS-DEPT-ARRIVE-FISCAL-WK10970015
109800     END-IF.                                                      10980000
109900                                                                  10990000
110000                                                                  11000007
110100*-----------------------------------------------------------------11010007
110200*    DETERMINE FISCAL-PERIOD-NUMBER, FISCAL-PERIOD-WEEK,          11020007
110300*              FISCAL-WEEK-NUMBER,   FISCAL-QUARTER-NUMBER        11030007
110400*    FROM VERIFIED DATE.                                          11040007
110500*-----------------------------------------------------------------11050007
110600                                                                  11060001
110700 4100-VERFYD-DATE-PERIOD.                                         11070000
110800                                                                  11080001
110900     MOVE '4100-VERFYD-DATE-PERIOD ' TO PV-ABEND-PARAGRAPH.       11090000
111000                                                                  11100000
111100     MOVE WS-VERFYD-MM         TO  WS-WORK-VERFYD-MM.             11110001
111200     MOVE WS-VERFYD-DD         TO  WS-WORK-VERFYD-DD.             11120001
111300     MOVE WS-VERFYD-CC         TO  WS-WORK-VERFYD-CC.             11130001
111400     MOVE WS-VERFYD-YY         TO  WS-WORK-VERFYD-YY.             11140001
111500     MOVE WS-VERFYD-DATE-WORK  TO  DPG52-LK-DATE-INPUT.           11150001
111600                                                                  11160001
111700     SET  DPG51-FISCAL-454-CALENDAR                               11170001
111800          DPG51-DO-NOT-INCR-DECR-DATE                             11180001
111900          DPG52-LK-DTE-GREG-CC-FMT   TO TRUE.                     11190044
112000                                                                  11200000
112100     PERFORM 9100-CALL-DATE-MODULE.                               11210000
112200*JPL                                                              11220069
112300     IF DPG54-DATE-VALID                                          11230000
112400         MOVE DPG56-FISCAL-PERIOD-NBR  TO WS-DEPT-VERFYD-PER-NBR  11240069
112500         MOVE DPG56-FISCAL-QTR-NBR     TO WS-DEPT-VERFYD-QTR-NBR  11250015
112600         MOVE DPG56-FISCAL-PERIOD-WEEK TO WS-DEPT-VERFYD-PER-WK   11260015
112700         MOVE DPG56-FISCAL-WEEK-NBR    TO WS-DEPT-VERFYD-FISCAL-WK11270015
112800     END-IF.                                                      11280000
112900                                                                  11290001
113000                                                                  11300001
113100* -------------------------------------------------------------- *11310001
113200* -------------------------------------------------------------- *11320001
113300                                                                  11330001
113400 6000-OPEN-TRECITM-CSR.                                           11340001
113500                                                                  11350052
113600     MOVE '6000-OPEN-TRECITM-CSR' TO PV-ABEND-PARAGRAPH.          11360052
113700                                                                  11370001
113800     PERFORM WITH TEST AFTER                                      11380001
113900       VARYING PV-RETRY-COUNT FROM 1 BY 1                         11390001
114000         UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 11400001
114100            OR  (SQLCODE = +0))                                   11410001
114200                                                                  11420001
114300         EXEC SQL                                                 11430001
114400             OPEN TRECITM-CSR                                     11440001
114500         END-EXEC                                                 11450001
114600                                                                  11460001
114700                                                                  11470014
114800         EVALUATE SQLCODE                                         11480019
114900                                                                  11490014
115000           WHEN +0                                                11500020
115100           WHEN -904                                              11510020
115200           WHEN -913                                              11520020
115300               SET PS-TRECITM-CSR-START TO TRUE                   11530014
115400                                                                  11540014
115500           WHEN OTHER                                             11550019
115600               MOVE 'OPEN TRECITM CURSOR'   TO PV-ABEND-OPERATION 11560001
115700               MOVE 'TRECITM'               TO PV-ABEND-STRUCT-1  11570001
115800               MOVE SPACES                  TO PV-ABEND-STRUCT-2  11580001
115900               PERFORM 9900-DB2-ABEND                             11590001
116000                                                                  11600001
116100         END-EVALUATE                                             11610001
116200                                                                  11620011
116300     END-PERFORM.                                                 11630001
116400                                                                  11640001
116500                                                                  11650001
116600* ----------------------------------------------------------------11660011
116700* ----------------------------------------------------------------11670011
116800                                                                  11680011
116900 6100-FETCH-TRECITM-CSR.                                          11690001
117000                                                                  11700001
117100     MOVE '6100-FETCH-TRECEIV-CSR' TO PV-ABEND-PARAGRAPH.         11710052
117200                                                                  11720052
117300     EXEC SQL                                                     11730001
117400                                                                  11740001
117500          FETCH TRECITM-CSR                                       11750001
117600                                                                  11760001
117700           INTO  :RECITM-ORD-NBR                                  11770003
117800               , :RECITM-REC-SEQ-NBR                              11780003
117900               , :RECITM-OPER-UNT-ID                              11790003
118000               , :RECITM-FCLTY-ID                                 11800003
118100               , :RECITM-ORD-LNE-NBR                              11810003
118200               , :RECITM-ITM-NBR                                  11820003
118300                                                                  11830001
118400     END-EXEC.                                                    11840001
118500                                                                  11850001
118600                                                                  11860001
118700     EVALUATE SQLCODE                                             11870019
118800                                                                  11880001
118900       WHEN +0                                                    11890019
119000           INITIALIZE RC065-RCVR-EXTRACT-RECORD                   11900019
119100                                                                  11910019
119200           PERFORM 8000-GET-RECEIPT-SUM                           11920033
119300                                                                  11930033
119400           PERFORM 6200-POPULATE-RC065-RECORD                     11940044
119500           ADD +1 TO WS-RECORDS-WRITTEN                           11950019
119600                                                                  11960019
119700           WRITE EXTRACT-RECORD FROM RC065-RCVR-EXTRACT-RECORD    11970019
119800                                                                  11980001
119900       WHEN +100                                                  11990019
120000           SET PS-TRECITM-CSR-EOF TO TRUE                         12000001
120100                                                                  12010001
120200       WHEN OTHER                                                 12020019
120300           MOVE 'FETCH TRECITM CURSOR'   TO PV-ABEND-OPERATION    12030001
120400           MOVE 'TRECITM'                TO PV-ABEND-STRUCT-1     12040001
120500           MOVE SPACES                   TO PV-ABEND-STRUCT-2     12050001
120600           PERFORM 9900-DB2-ABEND                                 12060001
120700                                                                  12070001
120800     END-EVALUATE.                                                12080001
120900                                                                  12090044
121000                                                                  12100044
121100* -------------------------------------------------------------- *12110044
121200*    DETERMINE ARRIVE DATE PERIOD & FISCAL INFORMATION           *12120044
121300*    DETERMINE VERIFIED DATE PERIOD & FISCAL INFORMATION         *12130044
121400*    POPULATE EXTRACT RECORD FIELDS                              *12140044
121500* -------------------------------------------------------------- *12150044
121600                                                                  12160044
121700 6200-POPULATE-RC065-RECORD.                                      12170044
121800                                                                  12180045
121900     ADD +1 TO WS-RECORDS-READ.                                   12190045
122000                                                                  12200044
122100     MOVE RECEIV-REC-TMST  TO  PV-DATETIME-WORK.                  12210044
122200     MOVE PV-DATETIME-CC   TO  WS-ARRIVE-CC.                      12220044
122300     MOVE PV-DATETIME-YY   TO  WS-ARRIVE-YY.                      12230044
122400     MOVE PV-DATETIME-MM   TO  WS-ARRIVE-MM.                      12240044
122500     MOVE PV-DATETIME-DD   TO  WS-ARRIVE-DD.                      12250044
122600                                                                  12260044
122700     IF WS-PREV-ARRIVE-DATE  =  WS-ARRIVE-DATE                    12270044
122800         CONTINUE                                                 12280044
122900     ELSE                                                         12290044
123000         PERFORM 4000-ARRIVE-DATE-PERIOD                          12300044
123100         MOVE WS-ARRIVE-DATE  TO  WS-PREV-ARRIVE-DATE             12310045
123200     END-IF.                                                      12320044
123300                                                                  12330044
123400     MOVE RECEIV-VERFYD-TMST  TO  PV-DATETIME-WORK.               12340044
123500     MOVE PV-DATETIME-CC      TO  WS-VERFYD-CC.                   12350044
123600     MOVE PV-DATETIME-YY      TO  WS-VERFYD-YY.                   12360044
123700     MOVE PV-DATETIME-MM      TO  WS-VERFYD-MM.                   12370044
123800     MOVE PV-DATETIME-DD      TO  WS-VERFYD-DD.                   12380044
123900                                                                  12390044
124000     IF WS-PREV-VERFYD-DATE  =  WS-VERFYD-DATE                    12400044
124100         CONTINUE                                                 12410044
124200     ELSE                                                         12420044
124300         IF WS-VERFYD-DATE  =  '9999-09-09'                       12430044
124400             INITIALIZE  WS-DEPT-VERFYD-PER-NBR                   12440044
124500                         WS-DEPT-VERFYD-PER-WK                    12450044
124600                         WS-DEPT-VERFYD-QTR-NBR                   12460044
124700                         WS-DEPT-VERFYD-FISCAL-WK                 12470044
124800             MOVE WS-VERFYD-DATE  TO  WS-PREV-VERFYD-DATE         12480044
124900         ELSE                                                     12490044
125000             PERFORM 4100-VERFYD-DATE-PERIOD                      12500044
125100             MOVE  WS-VERFYD-DATE TO  WS-PREV-VERFYD-DATE         12510044
125200         END-IF                                                   12520044
125300     END-IF.                                                      12530044
125400                                                                  12540044
125500     MOVE RECEIV-ORD-NBR             TO  RC065-ORD-NBR.           12550044
125600     MOVE RECEIV-OPER-UNT-ID         TO  RC065-OPER-UNT-ID.       12560044
125700     MOVE RECEIV-FCLTY-ID            TO  RC065-FCLTY-ID.          12570044
125800     MOVE RECEIV-REC-SEQ-NBR         TO  RC065-REC-SEQ-NBR.       12580044
125900     MOVE RECEIV-STATUS-CDE          TO  RC065-STATUS-CDE.        12590044
126000     MOVE RECITM-ORD-LNE-NBR         TO  RC065-ORD-LNE-NBR.       12600044
126100     MOVE RECITM-ITM-NBR             TO  RC065-ITM-NBR.           12610044
126200     MOVE PURCHS-DEPT-NBR            TO  RC065-DEPT-NBR.          12620044
126300     MOVE PURCHS-PO-TYP-CDE          TO  RC065-PO-TYP-CDE.        12630044
126400     MOVE PURCHS-ENT-ID              TO  RC065-ENT-ID.            12640044
126500     MOVE PURCHS-IMPRT-VEND-NAME     TO  RC065-IMPRT-VEND-NAME.   12650044
126600     MOVE PURCHS-IMPRT-FCTRY-NAME    TO  RC065-IMPRT-FCTRY-NAME.  12660044
126700     MOVE WS-ARRIVE-DATE             TO  RC065-ARRIVE-DTE.        12670044
126800     MOVE WS-DEPT-ARRIVE-PER-NBR     TO  RC065-ARRIVE-PERIOD-NBR. 12680044
126900     MOVE WS-DEPT-ARRIVE-PER-WK      TO  RC065-ARRIVE-PERIOD-WEEK.12690044
127000     MOVE WS-DEPT-ARRIVE-FISCAL-WK   TO  RC065-ARRIVE-FISCAL-WEEK.12700044
127100     MOVE WS-DEPT-ARRIVE-QTR-NBR     TO  RC065-ARRIVE-QTR-NBR.    12710044
127200     MOVE WS-VERFYD-DATE             TO  RC065-VRFYD-DTE.         12720044
127300     MOVE WS-DEPT-VERFYD-PER-NBR     TO  RC065-VRFYD-PERIOD-NBR.  12730044
127400     MOVE WS-DEPT-VERFYD-PER-WK      TO  RC065-VRFYD-PERIOD-WEEK. 12740044
127500     MOVE WS-DEPT-VERFYD-QTR-NBR     TO  RC065-VRFYD-QTR-NBR.     12750044
127600     MOVE WS-DEPT-VERFYD-FISCAL-WK   TO  RC065-VRFYD-FISCAL-WEEK. 12760044
127700     MOVE RECEIV-VRFD-USR-ID         TO  RC065-VRFYD-USR-ID.      12770044
127800     MOVE RECEIV-CURR-OPER-UNT-ID    TO  RC065-CURR-OPER-UNT-ID.  12780044
127900     MOVE RECEIV-CURR-FCLTY-ID       TO  RC065-CURR-FCLTY-ID.     12790044
128000     MOVE PV-ENDING-DATE-REFORMAT    TO  RC065-MONTH-END-DATE.    12800044
128100     MOVE SPACES                     TO  RC065-FILLER.            12810044
128200                                                                  12820001
128300                                                                  12830011
128400* ----------------------------------------------------------------12840011
128500* ----------------------------------------------------------------12850011
128600                                                                  12860011
128700 6300-CLOSE-TRECITM-CSR.                                          12870044
128800                                                                  12880011
128900     MOVE '6300-CLOSE-TRECITM-CSR' TO PV-ABEND-PARAGRAPH.         12890052
129000                                                                  12900052
129100     PERFORM WITH TEST AFTER                                      12910011
129200       VARYING PV-RETRY-COUNT FROM 1 BY 1                         12920011
129300         UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 12930011
129400            OR  (SQLCODE = +0))                                   12940011
129500                                                                  12950011
129600         EXEC SQL                                                 12960011
129700             CLOSE TRECITM-CSR                                    12970011
129800         END-EXEC                                                 12980011
129900                                                                  12990011
130000                                                                  13000014
130100         EVALUATE SQLCODE                                         13010019
130200                                                                  13020014
130300           WHEN +0                                                13030020
130400           WHEN -904                                              13040020
130500           WHEN -911                                              13050020
130600               CONTINUE                                           13060014
130700                                                                  13070014
130800           WHEN OTHER                                             13080019
130900               MOVE 'CLOSE TRECITM CURSOR'   TO PV-ABEND-OPERATION13090014
131000               MOVE 'TRECITM'                TO PV-ABEND-STRUCT-1 13100014
131100               MOVE SPACES                   TO PV-ABEND-STRUCT-2 13110014
131200               PERFORM 9900-DB2-ABEND                             13120014
131300                                                                  13130014
131400         END-EVALUATE                                             13140014
131500                                                                  13150014
131600     END-PERFORM.                                                 13160014
131700                                                                  13170014
131800     IF PV-RETRY-COUNT > PC-MAX-RETRIES                           13180014
131900         MOVE 'MAX RETRIES EXCEEDED'   TO PV-ABEND-OPERATION      13190014
132000         PERFORM 9900-DB2-ABEND                                   13200014
132100     END-IF.                                                      13210014
132200                                                                  13220016
132300* -------------------------------------------------------------- *13230016
132400* -------------------------------------------------------------- *13240016
132500 7000-OPEN-TRECEIV-CSR.                                           13250001
132600     MOVE '7000-OPEN-TRECEIV-CSR' TO PV-ABEND-PARAGRAPH.          13260052
132700                                                                  13270052
132800     PERFORM WITH TEST AFTER                                      13280001
132900       VARYING PV-RETRY-COUNT FROM 1 BY 1                         13290001
133000         UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 13300000
133100            OR  (SQLCODE = +0))                                   13310000
133200                                                                  13320000
133300         EXEC SQL                                                 13330000
133400             OPEN TRECEIV-CSR                                     13340000
133500         END-EXEC                                                 13350000
133600                                                                  13360000
133700                                                                  13370014
133800         EVALUATE SQLCODE                                         13380019
133900                                                                  13390001
134000           WHEN +0                                                13400020
134100           WHEN -904                                              13410020
134200           WHEN -913                                              13420020
134300               CONTINUE                                           13430001
134400                                                                  13440001
134500           WHEN OTHER                                             13450019
134600               MOVE 'OPEN TRECEIV CURSOR'   TO PV-ABEND-OPERATION 13460001
134700               MOVE 'TRECEIV'               TO PV-ABEND-STRUCT-1  13470002
134800               MOVE SPACES                  TO PV-ABEND-STRUCT-2  13480001
134900               PERFORM 9900-DB2-ABEND                             13490001
135000                                                                  13500001
135100         END-EVALUATE                                             13510000
135200                                                                  13520001
135300     END-PERFORM.                                                 13530000
135400                                                                  13540000
135500     IF PV-RETRY-COUNT > PC-MAX-RETRIES                           13550001
135600         MOVE 'MAX RETRIES EXCEEDED'  TO PV-ABEND-OPERATION       13560001
135700         PERFORM 9900-DB2-ABEND                                   13570000
135800     END-IF.                                                      13580000
135900                                                                  13590000
136000* -------------------------------------------------------------- *13600011
136100* -------------------------------------------------------------- *13610011
136200 7100-FETCH-TRECEIV-CSR.                                          13620000
136300     MOVE '7100-FETCH-TRECEIV-CSR' TO PV-ABEND-PARAGRAPH.         13630052
136400                                                                  13640000
136500     EXEC SQL                                                     13650000
136600                                                                  13660001
136700         FETCH TRECEIV-CSR                                        13670044
136800                                                                  13680001
136900           INTO  :RECEIV-ORD-NBR                                  13690009
137000               , :RECEIV-REC-SEQ-NBR                              13700010
137100               , :RECEIV-OPER-UNT-ID                              13710010
137200               , :RECEIV-FCLTY-ID                                 13720010
137300               , :RECEIV-STATUS-CDE                               13730010
137400               , :RECEIV-REC-TMST                                 13740010
137500               , :RECEIV-VERFYD-TMST                              13750010
137600               , :RECEIV-CURR-OPER-UNT-ID                         13760010
137700               , :RECEIV-CURR-FCLTY-ID                            13770010
137800               , :RECEIV-VRFD-USR-ID                              13780010
137900               , :PURCHS-DEPT-NBR                                 13790031
138000               , :PURCHS-PO-TYP-CDE                               13800010
138100               , :PURCHS-ENT-ID                                   13810010
138200               , :PURCHS-IMPRT-VEND-NAME                          13820010
138300               , :PURCHS-IMPRT-FCTRY-NAME                         13830010
138400                                                                  13840001
138500     END-EXEC.                                                    13850000
138600                                                                  13860000
138700                                                                  13870011
138800     EVALUATE SQLCODE                                             13880019
138900                                                                  13890003
139000       WHEN +0                                                    13900019
139100           ADD +1 TO PV-TRECEIV-COUNT                             13910001
139200                                                                  13920001
139300       WHEN +100                                                  13930019
139400           SET PS-TRECEIV-CSR-EOF TO TRUE                         13940031
139500                                                                  13950001
139600       WHEN OTHER                                                 13960019
139700           MOVE 'FETCH TRECEIV CURSOR'   TO PV-ABEND-OPERATION    13970001
139800           MOVE 'TRECEIV'                TO PV-ABEND-STRUCT-1     13980001
139900           MOVE SPACES                   TO PV-ABEND-STRUCT-2     13990001
140000           PERFORM 9900-DB2-ABEND                                 14000001
140100                                                                  14010001
140200     END-EVALUATE.                                                14020000
140300                                                                  14030000
140400* -------------------------------------------------------------- *14040011
140500* -------------------------------------------------------------- *14050011
140600 7200-CLOSE-TRECEIV-CSR.                                          14060000
140700     MOVE '7200-CLOSE-TRECEIV-CSR' TO PV-ABEND-PARAGRAPH.         14070052
140800                                                                  14080052
140900     PERFORM WITH TEST AFTER                                      14090001
141000       VARYING PV-RETRY-COUNT FROM 1 BY 1                         14100001
141100         UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 14110000
141200            OR  (SQLCODE = +0))                                   14120000
141300                                                                  14130000
141400        EXEC SQL                                                  14140001
141500            CLOSE TRECEIV-CSR                                     14150001
141600        END-EXEC                                                  14160001
141700                                                                  14170000
141800                                                                  14180014
141900        EVALUATE SQLCODE                                          14190019
142000                                                                  14200001
142100          WHEN +0                                                 14210020
142200          WHEN -904                                               14220020
142300          WHEN -913                                               14230020
142400              CONTINUE                                            14240001
142500                                                                  14250001
142600          WHEN OTHER                                              14260019
142700              MOVE 'CLOSE TRECEIV CURSOR'   TO PV-ABEND-OPERATION 14270001
142800              MOVE 'TRECEIV'                TO PV-ABEND-STRUCT-1  14280002
142900              MOVE SPACES                   TO PV-ABEND-STRUCT-2  14290001
143000              PERFORM 9900-DB2-ABEND                              14300001
143100                                                                  14310001
143200        END-EVALUATE                                              14320001
143300                                                                  14330000
143400     END-PERFORM.                                                 14340000
143500                                                                  14350000
143600     IF PV-RETRY-COUNT > PC-MAX-RETRIES                           14360001
143700         MOVE 'MAX RETRIES EXCEEDED'   TO PV-ABEND-OPERATION      14370001
143800         PERFORM 9900-DB2-ABEND                                   14380000
143900     END-IF.                                                      14390000
144000                                                                  14400033
144100                                                                  14410033
144200*-----------------------------------------------------------------14420033
144300*    FROM THE RECIEPT DISTRIBUTION TABLE(TRECDIS) GET THE         14430033
144400*    SUM OF THE EXPECTED & VERIFIED QUANTITIES FOR ALL LINES      14440033
144500*    OF A GIVEN RECEIVER                                          14450033
144600*-----------------------------------------------------------------14460033
144700 8000-GET-RECEIPT-SUM.                                            14470033
144800     MOVE '8000-GET-RECIEPT-SUM ' TO PV-ABEND-PARAGRAPH.          14480052
144900                                                                  14490052
145000     EXEC SQL                                                     14500033
145100                                                                  14510033
145200          SELECT SUM(VERIFY_ITM_QTY)                              14520033
145300               , SUM(AP_VERIFY_ITM_QTY)                           14530033
145400                                                                  14540033
145500            INTO   :PV-EXPTED-ITEM-QTY                            14550033
145600                 , :PV-VERIFY-ITEM-QTY                            14560033
145700                                                                  14570033
145800          FROM   TRECDIS                                          14580033
145900                                                                  14590033
146000          WHERE  ORD_NBR     = :RECITM-ORD-NBR                    14600033
146100            AND  ORD_LNE_NBR = :RECITM-ORD-LNE-NBR                14610033
146200            AND  REC_SEQ_NBR = :RECITM-REC-SEQ-NBR                14620035
146300            AND  OPER_UNT_ID = :RECITM-OPER-UNT-ID                14630035
146400            AND  FCLTY_ID    = :PC-1                              14640035
146500                                                                  14650035
146600     END-EXEC.                                                    14660035
146700                                                                  14670035
146800                                                                  14680035
146900     EVALUATE SQLCODE                                             14690035
147000                                                                  14700035
147100       WHEN +0                                                    14710035
147200           MOVE PV-EXPTED-ITEM-QTY  TO  RC065-EXPTED-ITM-QTY      14720035
147300           MOVE PV-VERIFY-ITEM-QTY  TO  RC065-VERIFY-ITM-QTY      14730035
147400                                                                  14740035
147500       WHEN -305                                                  14750035
147600           MOVE ZEROES  TO PV-EXPTED-ITEM-QTY                     14760035
147700                           PV-VERIFY-ITEM-QTY                     14770035
147800                                                                  14780035
147900       WHEN OTHER                                                 14790035
148000           MOVE 'SELECT TRECDIS       ' TO PV-ABEND-OPERATION     14800035
148100           MOVE 'TRECDIS'               TO PV-ABEND-STRUCT-1      14810035
148200           MOVE RC065-ORD-NBR           TO PV-ABEND-STRUCT-2      14820035
148300           PERFORM 9900-DB2-ABEND                                 14830035
148400                                                                  14840035
148500     END-EVALUATE.                                                14850035
148600                                                                  14860035
148700* -------------------------------------------------------------- *14870035
148800* -------------------------------------------------------------- *14880011
148900 9100-CALL-DATE-MODULE.                                           14890014
149000                                                                  14900000
149100     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51                14910001
149200                                             DPG52                14920001
149300                                             DPG53                14930001
149400                                             DPG54                14940001
149500                                             DPG55                14950001
149600                                             DPG56.               14960001
149700                                                                  14970001
149800     EVALUATE TRUE                                                14980000
149900                                                                  14990001
150000       WHEN DPG54-SEVERE-ERROR                                    15000014
150100           DISPLAY 'ORDER NUMBER       ' RECEIV-ORD-NBR           15010018
150200           DISPLAY 'REC SEQ NBR        ' RECEIV-REC-SEQ-NBR       15020018
150300           DISPLAY 'INPUT DATE IS      ' DPG52-LK-DATE-INPUT      15030018
150400           DISPLAY '** ABEND **        '                          15040018
150500           DISPLAY '** PGM = RCKUT073  '                          15050018
150600           DISPLAY '** EXECUTE PARAGRAPH ' PV-ABEND-PARAGRAPH     15060018
150700           DISPLAY '** ABEND PARAGRAPH - 9100-CALL-DATE-MODULE'   15070018
150800           DISPLAY '** INVALID RETURN FROM CALENDAR ROUTINE.  '   15080018
150900           DISPLAY '** ERROR MESSAGE = ' DPG54-ERROR-MESSAGE      15090014
151000           DISPLAY '** DPG51    = ' DPG51                         15100018
151100           DISPLAY '** DPG52    = ' DPG52                         15110018
151200           DISPLAY '** DPG53    = ' DPG53                         15120018
151300           DISPLAY '** DPG54    = ' DPG54                         15130018
151400           MOVE +4003 TO PV-ABEND-CODE                            15140014
151500           CALL 'ILBOABN0' USING PV-ABEND-CODE                    15150014
151600                                                                  15160001
151700       WHEN OTHER                                                 15170014
151800           CONTINUE                                               15180014
151900                                                                  15190001
152000     END-EVALUATE.                                                15200000
152100                                                                  15210000
152200* -------------------------------------------------------------- *15220018
152300* -------------------------------------------------------------- *15230018
152400 9900-DB2-ABEND.                                                  15240000
152500                                                                  15250000
152600     MOVE SQLCODE TO PV-SQLCODE.                                  15260000
152700                                                                  15270001
152800     DISPLAY '*** DB2 ERROR   '.                                  15280018
152900     DISPLAY '*** SQLCODE   = ' PV-SQLCODE.                       15290000
153000     DISPLAY '*** PROGRAM   = ' PV-ABEND-PROGRAM.                 15300000
153100     DISPLAY '*** PARAGRAPH = ' PV-ABEND-PARAGRAPH.               15310000
153200     DISPLAY '*** OPERATION = ' PV-ABEND-OPERATION.               15320000
153300     DISPLAY '*** MESSAGE   = ' PV-DB2-OPER-MESS-1.               15330001
153400     DISPLAY '***           = ' PV-DB2-OPER-MESS-2.               15340001
153500     DISPLAY '***           = ' PV-DB2-OPER-MESS-3.               15350001
153600     DISPLAY '*** TABLE 1   = ' PV-ABEND-STRUCT-1.                15360001
153700                                                                  15370000
153800     IF PV-ABEND-STRUCT-2 > SPACES                                15380001
153900         DISPLAY '*** TABLE 2   = ' PV-ABEND-STRUCT-2             15390001
154000     END-IF.                                                      15400000
154100                                                                  15410000
154200     COPY DPPD004.                                                15420001
154300                                                                  15430000
154400     MOVE +4013 TO PV-ABEND-CODE.                                 15440001
154500                                                                  15450001
154600     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         15460000
154700                                                                  15470001
154800* -------------------------------------------------------------- *15480001
154900* -------------------------------------------------------------- *15490001
