000010******************************************************************00001017
000020 IDENTIFICATION DIVISION.                                         00002018
000030******************************************************************00003018
000040*  I M P O R T A N T --- WHEN COMPILING THIS PROGRAM THE SOCKET  *00004018
000050* SWITCH ON THE 2ND COMPILE SCREEN NEEDS TO BE SET TO 'Y'.  THIS *00005018
000060* PROGRAM IS USING "EZASOKET".                                   *00006018
000070******************************************************************00007018
000080 PROGRAM-ID.             PCKCS707.                                00008018
000090 AUTHOR.                 BUDDY BARNES.                            00009018
000100 INSTALLATION.           KOHLS.                                   00010018
000110 DATE-WRITTEN            AUG, 1999.                               00011018
000120 DATE-COMPILED.                                                   00012018
000130                                                                  00013018
000140******************************************************************00014018
000150* THIS PROGRAM PRINTS THE APPROPRIATE LABEL REQUESTED FROM THE   *00015018
000160* LABEL CREATION MENU SCREEN USING THE TCP/IP SOCKET INTERFACE.  *00016018
000170* THE LABEL PRINTING IS DONE USING BOTH FORM AND DATA LAYOUTS IN *00017018
000180* ORDER TO SPEED THE TRANSMISSION PROCESS IN THE 'PTMS' SYSTEM.  *00018018
000190***************************************************************** 00019018
000200* THE LABEL TYPES THAT ARE PRINTED WITH THIS MODULE INCLUDE:     *00020018
000210*                                                                *00021018
000220*       HEADER LABEL         -    PC140-LABEL-FORMAT-NBR = 001   *00022018
000230*       CARTON LABEL         -    PC140-LABEL-FORMAT-NBR = 002   *00023018
000240*       SHIPPING LABEL       -    PC140-LABEL-FORMAT-NBR = 003   *00024018
000250*       MANIFEST LABEL       -    PC140-LABEL-FORMAT-NBR = 004   *00025018
000260* (N/A) DESTINATION LABEL    -    PC140-LABEL-FORMAT-NBR = 005   *00026018
000270*       USERID LABEL         -    PC140-LABEL-FORMAT-NBR = 006   *00027018
000280*       MISC LABEL           -    PC140-LABEL-FORMAT-NBR = 007   *00028018
000290* 12/00 BLIND RECEIPT LABEL  -    PC140-LABEL-FORMAT-NBR = 010   *00029018
000300* 01/01 TRAILER SERIAL #     -    PC140-LABEL-FORMAT-NBR = 011   *00030018
000310* 02/01 FAST TRANSFER LABEL  -    PC140-LABEL-FORMAT-NBR = 012   *00031018
000320* 03/01 RF CARTON STATUS LBL -    PC140-LABEL-FORMAT-NBR = 013   *00032018
000330******************************************************************00033018
000340******************************************************************00034018
000350*  CHANGED 04/23/13 BY C. PARMLEY          PR#5148B              *00035018
000360*  CHECK FOR RFID IN 3960- PARA                                  *00036018
000370*  TAGGED BY PR5148B - CLP - 04/23/2013                          *00037018
000380*                                          CRQ#0055296           *00038018
000390*  CHANGED 07/23/13 BY SHOBHIT BAIJAL      PR#5148B              *00039018
000400*  ADDED CARTON LABEL FOR RFID                                  * 00040018
000410*  TAGGED BY PR5148B - SB - 07/23/2013 START/END                 *00041018
000420*                                          CRQ#0055296           *00042018
000430******************************************************************00043018
000440* 06/22/2015  Cheri Parmley           CHG0120422                 *00044018
000450*             RETIRING THE XLT_MDSE_PGM TABLE AND REPLACING IT   *00045018
000460*             WITH XLT_BRND FOR BRAND DESCRIPTION                *00046018
000470******************************************************************00047018
000480* 02/24/2016  Denise Hahn                                        *00048018
000490*             allow print of generic sml in P2L store order      *00049018
000500*             allow display of door # on generic sml             *00050018
000510******************************************************************00051018
000520* 07/12/2017  JIM ARENDT              CHG0176459                 *00052018
000530*             Added code to program for the "RFID TAG YOUR STORE/*00053018
000540*             SHORT-TERM SOLUTION" project.                      *00054018
000550******************************************************************00055018
000520* 02/14/2023  Jean Kurk               CHG0281369                 *00055135
000530*             Removed copybook for UPC Check Digit routine       *00055235
000550******************************************************************00055435
000560 ENVIRONMENT DIVISION.                                            00056018
000570 DATA DIVISION.                                                   00057018
000580******************************************************************00058018
000590 WORKING-STORAGE SECTION.                                         00059018
000600                                                                  00060018
000610 01  DK-DB2-KEYS.                                                 00061018
000620     05  DK-OPER-UNT-ID-NUM-4     PIC S9(04) COMP.                00062018
000630     05  DK-OPER-UNT-ID.                                          00063018
000640         10 FILLER                PIC X(01).                      00064018
000650         10 DK-OPER-UNT-ID-3      PIC X(03).                      00065018
000660     05  DK-OPER-UNT-ID-4.                                        00066018
000670         10 FILLER                PIC X(02).                      00067018
000680         10 DK-OPER-UNT-ID-2      PIC X(02).                      00068018
000690     05  DK-OPER-UNT-ID-DC.                                       00069018
000700         10 FILLER                PIC X(01).                      00070018
000710         10 DK-OPER-UNT-ID-DC2    PIC X(02).                      00071018
000720     05  DK-DC-ORIGIN.                                            00072018
000730         10  FILLER               PIC X(01).                      00073018
000740         10  DK-DC-ORIGIN-3       PIC X(03).                      00074018
000750     05  DK-DEPT-CL-SKU-NBR.                                      00075018
000760         10  DK-DEPT-NBR          PIC 9(03).                      00076018
000770         10  DK-CL-NBR            PIC 9(02).                      00077018
000780         10  DK-SKU-NBR           PIC 9(03).                      00078018
000790     05  DK-PO-NBR-Z              PIC Z(08).                      00079018
000800     05  DK-RCVR-NBR              PIC X(03).                      00080018
000810     05  DK-RF-SERIAL-NBR.                                        00081018
000820         10  FILLER               PIC 9(01).                      00082018
000830         10  DK-RF-SERIAL         PIC 9(07).                      00083018
000840     05  DK-WORK-PRC-FUNC-CDE.                                    00084018
000850         10  FILLER                   PIC X(03) VALUE 'LBL'.      00085018
000860         10  DK-WORK-LABEL-NBR        PIC 9(03) VALUE ZERO.       00086018
000870     05  DK-SYS-PRC-FUNC-CDE REDEFINES DK-WORK-PRC-FUNC-CDE       00087018
000880                                      PIC X(06).                  00088018
000890                                                                  00089018
000900*----------------------------------------------------------------*00090018
000910* COMMAREA USED WHEN LINKING FROM A LABEL PRINT PROGRAM          *00091018
000920*----------------------------------------------------------------*00092018
000930     COPY PCWS140.                                                00093018
000940                                                                  00094018
000950*----------------------------------------------------------------*00095018
000960* TEXT FORMAT FOR TUPLDER                                        *00096018
000970*----------------------------------------------------------------*00097018
000980     COPY PCWS263.                                                00098018
000990                                                                  00099018
001010*----------------------------------------------------------------*00101018
001020*  BATCH LABEL - RFID CARTON LABEL (FORM AND DATA)               *00102018
001030*----------------------------------------------------------------*00103018
001040     COPY PCWS266.                                                00104018
001060                                                                  00106018
001070*----------------------------------------------------------------*00107018
001080*SOCKET COMMANDS CODES NEED FOR THE TCP/IP SOCKET CALLS-EZASOKET *00108018
001090*----------------------------------------------------------------*00109018
001100     COPY DPWS081.                                                00110018
001110                                                                  00111018
001170 01  TCP-BUF2.                                                    00117018
001180     05 TCP-BUF                          PIC  X(50)  VALUE SPACE. 00118018
001190     05 TCP-BUF-DATA                     PIC X(254)  VALUE SPACE. 00119018
001200                                                                  00120018
001210*----------------------------------------------------------------*00121018
001220*  PROGRAM CONSTANTS                                             *00122018
001230*----------------------------------------------------------------*00123018
001240 01  PC-PROGRAM-CONSTANTS.                                        00124018
001250     05  PC-OP-CO-NBR             PIC  X(02)  VALUE '03'.         00125018
001260     05  PC-OPER-UNT-ID           PIC S9(04)  VALUE +0 COMP.      00126018
001270     05  PC-CURRENT-PROGRAM-NAME  PIC  X(08)  VALUE 'PCKCS707'.   00127018
001280     05  PC-RANDOM-PGM            PIC  X(08)  VALUE 'DPKUT902'.   00128018
001290     05  PC-MAX-RETRIES           PIC S9(04)  VALUE +5 COMP.      00129018
001300     05  PC-A                     PIC  X(01)  VALUE 'A'.          00130018
001310     05  PC-C                     PIC  X(01)  VALUE 'C'.          00131018
001320     05  PC-S                     PIC  X(01)  VALUE 'S'.          00132018
001330     05  PC-MSC                   PIC  X(03)  VALUE 'MSC'.        00133018
001340     05  PC-PCKCS717              PIC  X(08)  VALUE 'PCKCS717'.   00134018
001350     05  PC-CSSL                  PIC  X(04)  VALUE 'CSSL'.       00135018
001360     05  PC-OF                    PIC  X(02)  VALUE 'OF'.         00136018
001370     05  PC-01                    PIC  X(02)  VALUE '01'.         00137018
001380     05  PC-0001                  PIC  X(04)  VALUE '0001'.       00138018
001390     05  PC-02                    PIC  X(02)  VALUE '02'.         00139018
001400     05  PC-03                    PIC  X(02)  VALUE '03'.         00140018
001410     05  PC-04                    PIC  X(02)  VALUE '04'.         00141018
001420     05  PC-05                    PIC  X(02)  VALUE '05'.         00142018
001430     05  PC-06                    PIC  X(02)  VALUE '06'.         00143018
001440     05  PC-07                    PIC  X(02)  VALUE '07'.         00144018
001450     05  PC-08                    PIC  X(02)  VALUE '08'.         00145018
001460     05  PC-09                    PIC  X(02)  VALUE '09'.         00146018
001470     05  PC-10                    PIC  X(02)  VALUE '10'.         00147018
001480     05  PC-11                    PIC  X(02)  VALUE '11'.         00148018
001490     05  PC-12                    PIC  X(02)  VALUE '12'.         00149018
001500     05  PC-13                    PIC  X(02)  VALUE '13'.         00150018
001510     05  PC-14                    PIC  X(02)  VALUE '14'.         00151018
001520     05  PC-15                    PIC  X(02)  VALUE '15'.         00152018
001530     05  PC-16                    PIC  X(02)  VALUE '16'.         00153018
001540     05  PC-17                    PIC  X(02)  VALUE '17'.         00154018
001550     05  PC-SHD                   PIC  X(03)  VALUE 'SHD'.        00155018
001560     05  PC-SHS                   PIC  X(03)  VALUE 'SHS'.        00156018
001570     05  PC-SMD                   PIC  X(03)  VALUE 'SMD'.        00157018
001580     05  PC-SMS                   PIC  X(03)  VALUE 'SMS'.        00158018
001590     05  PC-UID                   PIC  X(03)  VALUE 'UID'.        00159018
001600     05  PC-HDR                   PIC  X(03)  VALUE 'HDR'.        00160018
001610     05  PC-CRT                   PIC  X(03)  VALUE 'CRT'.        00161018
001620     05  PC-BRC                   PIC  X(03)  VALUE 'BRC'.        00162018
001630     05  PC-SRL                   PIC  X(03)  VALUE 'SRL'.        00163018
001640     05  PC-8                     PIC S9(04)  VALUE +8     COMP.  00164018
001650     05  PC-EOD                   PIC  X(01)  VALUE ''.          00165018
001660     05  PC-SPACE                 PIC  X(01)  VALUE ' '.          00166018
001670     05  PC-1                     PIC S9(04)  VALUE +1     COMP.  00167018
001680     05  PC-17-SIGNED             PIC S9(04)  VALUE +17    COMP.  00168018
001690     05  PC-25                    PIC S9(04)  VALUE +25    COMP.  00169018
001700     05  PC-NEG-803               PIC S9(03)  VALUE -803   COMP-3.00170018
001710     05  PC-NEG-904               PIC S9(03)  VALUE -904   COMP-3.00171018
001720     05  PC-NEG-911               PIC S9(03)  VALUE -911   COMP-3.00172018
001730     05  PC-NEG-913               PIC S9(03)  VALUE -913   COMP-3.00173018
001740     05  PC-ERROR                 PIC X(35)   VALUE               00174018
001750                           '@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@'. 00175018
001760     05  PC-MSG-TABLE-SIZE            PIC S9(03) COMP-3 VALUE 200.00176018
001770                                                                  00177018
001780*----------------------------------------------------------------*00178018
001790*  PROGRAM SWITCHES                                              *00179018
001800*----------------------------------------------------------------*00180018
001810 01  PS-PROGRAM-SWITCHES.                                         00181018
001820     05  PS-SOCKET-ERROR-SW              PIC  X(01)  VALUE 'N'.   00182018
001830         88  PS-SOCKET-ERROR                         VALUE 'Y'.   00183018
001840         88  PS-NO-SOCKET-ERROR                      VALUE 'N'.   00184018
001850     05  PS-VALID-INPUT-SW               PIC  X(01)  VALUE 'Y'.   00185018
001860         88  PS-VALID-INPUT                          VALUE 'Y'.   00186018
001870         88  PS-INVALID-INPUT                        VALUE 'N'.   00187018
001880     05  PS-END-OF-OPEN-STORE-SW         PIC  X(01)  VALUE 'N'.   00188018
001890         88  PS-END-OF-STORE-CSR                     VALUE 'Y'.   00189018
001900     05  PS-XREF-DONE-SW                 PIC  X(01)  VALUE 'N'.   00190018
001910         88  PS-XREF-DONE                            VALUE 'Y'.   00191018
001920     05  PS-FIRST-PASS-SW                PIC  X(01)  VALUE 'Y'.   00192018
001930         88  PS-FIRST-PASS                           VALUE 'Y'.   00193018
001940         88  PS-NOT-FIRST-PASS                       VALUE 'N'.   00194018
001950     05  PS-RANGE-REQUESTED-SW           PIC  X(01)  VALUE 'Y'.   00195018
001960         88  PS-RANGE-REQUESTED                      VALUE 'Y'.   00196018
001970         88  PS-RANGE-REQUESTED-NO                   VALUE 'N'.   00197018
001980     05  PS-SHOW-DEBUG-SW             PIC X(01) VALUE 'N'.        00198018
001990         88  PS-DONT-SHOW-DEBUG-INFO            VALUE 'N'.        00199018
002000         88  PS-SHOW-DEBUG-INFO                 VALUE 'Y'.        00200018
002010     05  PS-DUMP-TO-LOG-SW               PIC X(01) VALUE 'N'.     00201018
002020         88  PS-DONT-DUMP-TO-LOG                   VALUE 'N'.     00202018
002030         88  PS-DUMP-TO-LOG                        VALUE 'Y'.     00203018
002040     05  PS-HANG-FOLD-CSR-SW             PIC  X(01)  VALUE 'N'.   00204018
002050         88  PS-EO-HANG-FOLD-CSR                     VALUE 'Y'.   00205018
002060         88  PS-NOT-EO-HANG-FOLD-CSR                 VALUE 'N'.   00206018
002070     05  PS-HANG-FOLD-MIXED-SW           PIC  X(01)  VALUE 'N'.   00207018
002080         88  PS-HANG-FOLD-MIXED                      VALUE 'Y'.   00208018
002090         88  PS-NOT-HANG-FOLD-MIXED                  VALUE 'N'.   00209018
002100     05  PS-FIRST-UPC-CALL-SW            PIC  X(01)  VALUE 'N'.   00210018
002110         88  PS-FIRST-UPC-CALL                       VALUE 'Y'.   00211018
002120         88  PS-NOT-FIRST-UPC-CALL                   VALUE 'N'.   00212018
002130     05  PS-AUDIT-IND            PIC X(01)    VALUE  ' '.         00213018
002140         88  PS-AUDIT-COMPLETE                VALUE  ' '.         00214018
002150         88  PS-AUDIT-UNKNOWN                 VALUE  'U'.         00215018
002160         88  PS-REWORK                        VALUE  'R'.         00216018
002170         88  PS-100-PERCENT                   VALUE  '%'.         00217018
002190     05  PS-BRAND-FOUND-SW               PIC  X(01)  VALUE 'N'.   00219018
002200         88  PS-BRAND-FOUND-YES                      VALUE 'Y'.   00220018
002210         88  PS-BRAND-FOUND-NO                       VALUE 'N'.   00221018
002230     05  PS-MERCH-PRESENTATION-FND-SW    PIC  X(01)  VALUE 'N'.   00223018
002240         88  PS-MERCH-PRES-FND-YES                   VALUE 'Y'.   00224018
002250         88  PS-MERCH-PRES-FND-NO                    VALUE 'N'.   00225018
002260     05  PS-P2L-LABEL-DISPLAY-SW         PIC  X(01)  VALUE 'N'.   00226018
002270         88  PS-TRIP-ARRIVE-DATE-ON-LABEL            VALUE 'Y'.   00227018
002280         88  PS-P2L-MOD-ON-LABEL                     VALUE 'N'.   00228018
002281     05  PS-USE-LAST-4-FROM-TMST-SW      PIC  X(01)  VALUE 'N'.   00228120
002282         88  PS-USE-LAST-4-FROM-TMST                 VALUE 'Y'.   00228220
002283         88  PS-USE-LAST-4-ZEROS                     VALUE 'N'.   00228320
002290                                                                  00229018
002300*----------------------------------------------------------------*00230018
002310*  PROGRAM VARIABLES                                             *00231018
002320*----------------------------------------------------------------*00232018
002330 01  PV-PROGRAM-VARIABLES.                                        00233018
002340     05  PV-COMMAREA-LENGTH              PIC S9(4) COMP           00234018
002350                                                    VALUE ZERO.   00235018
002370     05  PV-RFID-STORE-TXT-4     PIC X(12) VALUE '***@RFID@***'.  00237018
002390     05  PV-EAS-TXT-4            PIC X(12) VALUE '***@EAS@@***'.  00239018
002400     05  PV-RFIDEAS-TXT-4        PIC X(12) VALUE '*@EAS/RFID@*'.  00240018
002410     05  PV-RECEIVER-NBR-X               PIC X(11).               00241018
002420     05  PV-BEGIN-RANGE-NBR-N            PIC 9(04)  VALUE ZEROES. 00242018
002430     05  PV-END-RANGE-NBR-N              PIC 9(04)  VALUE ZEROES. 00243018
002440     05  PV-BEGIN-SLOT-NBR-N             PIC 9(03)  VALUE ZEROES. 00244018
002450     05  PV-END-SLOT-NBR-N               PIC 9(03)  VALUE ZEROES. 00245018
002460     05  PV-TOT-LABELS-IN-RANGE          PIC 9(04)  VALUE ZEROES. 00246018
002470     05  PV-SETS-SUB                     PIC 9(04)  VALUE ZEROES. 00247018
002480     05  PV-RANGE-SUB                    PIC 9(04)  VALUE ZEROES. 00248018
002490     05  PV-PRC-MSG-CDE                  PIC  X(02)  VALUE SPACES.00249018
002500     05  PV-DC-SML-COUNT                 PIC S9(09) COMP.         00250018
002510     05  PV-DC-SML-COUNT-EXTENDED        PIC  9(09) VALUE ZEROES. 00251018
002530     05  PV-BUS-AREA-BRAND               PIC  X(35) VALUE SPACES. 00253018
002540     05  PV-DESC-LEN              PIC S9(04) VALUE +0             00254018
002550                                                COMP.             00255018
002560     05  PV-BUS-AREA-DESC-9       PIC  X(09)    VALUE SPACES.     00256018
002580     05  PV-CURRENT-DB2-DATE             PIC X(10)  VALUE SPACES. 00258018
002590     05  PV-CURRENT-DB2-DATE-R REDEFINES PV-CURRENT-DB2-DATE.     00259018
002600         10 PV-CURRENT-CC                PIC  9(02).              00260018
002610         10 PV-CURRENT-YY                PIC  9(02).              00261018
002620         10 FILLER                       PIC  X(01).              00262018
002630         10 PV-CURRENT-MM                PIC  9(02).              00263018
002640         10 FILLER                       PIC  X(01).              00264018
002650         10 PV-CURRENT-DD                PIC  9(02).              00265018
002660     05 PV-LBL-DATE                      PIC  X(08)  VALUE SPACES.00266018
002670     05 PV-LBL-DATE-R REDEFINES PV-LBL-DATE.                      00267018
002680        10  PV-LBL-DATE-MM               PIC  X(02).              00268018
002690        10  PV-LBL-DASH1                 PIC  X(01).              00269018
002700        10  PV-LBL-DATE-DD               PIC  X(02).              00270018
002710        10  PV-LBL-DASH2                 PIC  X(01).              00271018
002720        10  PV-LBL-DATE-YY               PIC  X(02).              00272018
002730     05  PV-CURRENT-DB2-TIME             PIC X(08)  VALUE SPACES. 00273018
002740     05  PV-CURRENT-DB2-TIME-R REDEFINES PV-CURRENT-DB2-TIME.     00274018
002750         10 PV-CURRENT-HR                PIC  9(02).              00275018
002760         10 FILLER                       PIC  X(01).              00276018
002770         10 PV-CURRENT-MN                PIC  9(02).              00277018
002780         10 FILLER                       PIC  X(03).              00278018
002790                                                                  00279018
002800     05  PV-LBL-PRT-DATE.                                         00280018
002810         10  PV-LBL-PRT-MM            PIC 9(02)      VALUE ZEROES.00281018
002820         10  FILLER                   PIC X(01)      VALUE '-'.   00282018
002830         10  PV-LBL-PRT-DD            PIC 9(02)      VALUE ZEROES.00283018
002840         10  FILLER                   PIC X(01)      VALUE '-'.   00284018
002850         10  PV-LBL-PRT-YY            PIC 9(02)      VALUE ZEROES.00285018
002860     05  PV-LBL-PRT-TIME.                                         00286018
002870         10  PV-LBL-PRT-HR            PIC 9(02)      VALUE ZEROES.00287018
002880         10  FILLER                   PIC X(01)      VALUE ':'.   00288018
002890         10  PV-LBL-PRT-MN            PIC 9(02)      VALUE ZEROES.00289018
002900     05  PV-NO-OF-LBLS-COMP           PIC S9(04)     VALUE +0     00290018
002910                                                     COMP.        00291018
002920     05  PV-RETRY-COUNTER             PIC S9(04)     VALUE +0     00292018
002930                                                     COMP SYNC.   00293018
002940     05  PV-RETRY-CNT                 PIC S9(04)     VALUE +0     00294018
002950                                                     COMP SYNC.   00295018
002960     05  PV-RETRY-CNT-9               PIC 9(04)      VALUE ZERO.  00296018
002970     05  PV-TRAILER-COUNT                PIC  9(07)  VALUE ZERO.  00297018
002980     05  PV-DONE-PROCESSING-SW   PIC X(01)    VALUE 'N'.          00298018
002990         88  PV-DONE-PROCESSING               VALUE 'Y'.          00299018
003000     05  PV-CICS-MSG-AREA                PIC  X(100) VALUE SPACES.00300018
003010     05  PV-TASK-X.                                               00301018
003020         10  PV-TASK                     PIC 9(07)   VALUE ZERO.  00302018
003030     05  PV-SQL-CODE                     PIC  9(09)- VALUE ZERO.  00303018
003040     05  PV-RETCODE                      PIC  9(08)- VALUE ZERO.  00304018
003050     05  PV-ERRNO                        PIC  9(08)- VALUE ZERO.  00305018
003060     05  PV-SOCK-ID                      PIC  9(04)  VALUE ZERO.  00306018
003070     05  PV-TCPLENG                      PIC  9(08)  VALUE ZERO.  00307018
003080     05  PV-FLAG                         PIC  9(08)  VALUE ZERO.  00308018
003090     05  PV-IP-ADDR                      PIC  9(08)  VALUE ZERO.  00309018
003100                                                                  00310018
003110     05  PV-PCKCS721                  PIC X(08)  VALUE 'PCKCS721'.00311018
003120     05  PV-SUKCS583                  PIC X(08)  VALUE 'SUKCS583'.00312018
003130                                                                  00313018
003140     05  PV-BARCODE.                                              00314018
003150         10  PV-SML-BC-CONTAINER-CD    PIC 9(02) VALUE ZEROES.    00315018
003160         10  PV-SML-BC-PCKGNG-TYPE     PIC 9(01) VALUE 4.         00316018
003170         10  PV-SML-BC-SFTWRE-SRCE     PIC 9(01) VALUE 1.         00317018
003180         10  PV-SML-BC-DIVERT-CDE.                                00318018
003190             15  PV-SML-BC-DIVERT-PFX  PIC 9(02) VALUE  ZEROES.   00319018
003200             15  PV-SML-BC-STR-NBR-3   PIC 9(03) VALUE  ZEROES.   00320018
003210         10  PV-SML-BC-ORIGIN          PIC 9(03) VALUE  ZEROES.   00321018
003220         10  PV-SML-BC-MNFST-NBR       PIC 9(08) VALUE  ZEROES.   00322018
003230         10  FILLER                    PIC X(02) VALUE  SPACES.   00323018
003240                                                                  00324018
003250     05  PV-SHIPT-UNT-X-22.                                       00325018
003260         10  FILLER                    PIC X(02).                 00326018
003270         10  PV-SHIPT-UNT-9-18         PIC 9(18).                 00327018
003280         10  FILLER                    PIC X(02).                 00328018
003290     05  PV-ORIGIN.                                               00329018
003300         10  FILLER                    PIC 9(01) VALUE  ZEROES.   00330018
003310         10  PV-BC-ORIGIN              PIC 9(03) VALUE  ZEROES.   00331018
003320                                                                  00332018
003330     05  PV-RANDOM-NUMBER                PIC  9(09)  VALUE ZEROES.00333018
003340     05  PV-RANDOM-NUMBER-R REDEFINES  PV-RANDOM-NUMBER.          00334018
003350         10  PV-RANDOM-1-8               PIC  9(08).              00335018
003360         10  FILLER                      PIC  9(01).              00336018
003370     05  PV-LPMS-TRANS-ID                PIC  9(08)  VALUE ZEROES.00337018
003380     05  PV-CICS-RESPONSE                PIC S9(08)  VALUE ZEROS  00338018
003390                                                     COMP SYNC.   00339018
003400     05  PV-IP-ADDRESS.                                           00340018
003410         10  PV-IP-ADDR-NUM1             PIC 9(03).               00341018
003420             88  PV-IP-ADDR-NUM1-VALID              VALUE 1 THRU  00342018
003430                                                          255.    00343018
003440         10  PV-IP-ADDR-DOT1             PIC X(01).               00344018
003450             88  PV-IP-ADDR-DOT1-VALID              VALUE '.'.    00345018
003460         10  PV-IP-ADDR-NUM2             PIC 9(03).               00346018
003470             88  PV-IP-ADDR-NUM2-VALID              VALUE 1 THRU  00347018
003480                                                          255.    00348018
003490         10  PV-IP-ADDR-DOT2             PIC X(01).               00349018
003500             88  PV-IP-ADDR-DOT2-VALID              VALUE '.'.    00350018
003510         10  PV-IP-ADDR-NUM3             PIC 9(03).               00351018
003520             88  PV-IP-ADDR-NUM3-VALID              VALUE 1 THRU  00352018
003530                                                          255.    00353018
003540         10  PV-IP-ADDR-DOT3             PIC X(01).               00354018
003550             88  PV-IP-ADDR-DOT3-VALID              VALUE '.'.    00355018
003560         10  PV-IP-ADDR-NUM4             PIC 9(03).               00356018
003570             88  PV-IP-ADDR-NUM4-VALID              VALUE 1 THRU  00357018
003580                                                          255.    00358018
003590     05  PV-HEX-FIELD.                                            00359018
003600         10  PV-HEX-FIELD-1              PIC X(01).               00360018
003610         10  PV-HEX-FIELD-2              PIC X(01).               00361018
003620         10  PV-HEX-FIELD-3              PIC X(01).               00362018
003630         10  PV-HEX-FIELD-4              PIC X(01).               00363018
003640     05  PV-HEX-FIELD-NUMBER REDEFINES PV-HEX-FIELD               00364018
003650                                         PIC 9(08)  COMP.         00365018
003660     05  PV-HEX-NUMERIC                  PIC 9(04) BINARY.        00366018
003670     05  PV-HEX-CHAR REDEFINES PV-HEX-NUMERIC.                    00367018
003680         10  PV-HEX-CHAR-1               PIC X(01).               00368018
003690         10  PV-HEX-CHAR-2               PIC X(01).               00369018
003700     05  PV-XMIT-STAT-CDE                PIC  X(01)  VALUE SPACES.00370018
003710                                                                  00371018
003720     05  PV-DISPLAY-DOWNLOAD.                                     00372018
003730         10  PV-DISPLAY-DOWNLOAD-1       PIC  X(80)  VALUE SPACE. 00373018
003740         10  PV-DISPLAY-DOWNLOAD-2       PIC  X(80)  VALUE SPACE. 00374018
003750         10  PV-DISPLAY-DOWNLOAD-3       PIC  X(80)  VALUE SPACE. 00375018
003760     05  PV-CICS-MESSAGE-AREA            PIC  X(80)  VALUE SPACES.00376018
003770     05  PV-SQLCODE                      PIC -9(5) VALUE ZEROES.  00377018
003780     05  PV-TKT-DEPT-CL-SUB.                                      00378018
003790         10  PV-TKT-DEPT              PIC 9(03) VALUE ZEROS.      00379018
003800         10  FILLER                   PIC X(01) VALUE SPACE.      00380018
003810         10  PV-TKT-MAJ-CL            PIC 9(02) VALUE ZEROS.      00381018
003820         10  FILLER                   PIC X(01) VALUE SPACE.      00382018
003830         10  PV-TKT-SUB-CL            PIC 9(02) VALUE ZEROS.      00383018
003840                                                                  00384018
003860     05  PV-22-DIGIT-BARCODE.                                     00386018
003870         10  PV-22-CRTN-TYPE-IND              PIC 9(01).          00387018
003880         10  PV-22-CRTN-DIVERT-CDE            PIC 9(04).          00388018
003890         10  PV-22-CRTN-PO-NBR                PIC 9(08).          00389018
003900         10  PV-22-CTRN-RCVR-SEQ-NBR          PIC 9(02).          00390018
003910         10  PV-22-CRTN-PO-LNE-NBR            PIC 9(03).          00391018
003920         10  PV-22-CRTN-CART-NBR              PIC 9(04).          00392018
003930     05  PV-RFID-DIVERT-CDE              PIC X(4).                00393018
003940     05  PV-RFID-DIVERT-CDE-N REDEFINES PV-RFID-DIVERT-CDE        00394018
003950                                         PIC 9(4).                00395018
003970     05  PV-SHIPT-UNT-ID-NUM             PIC  9(18)  VALUE ZEROES.00397018
003980     05  PV-SHIPT-UNT-ID-NUM-R REDEFINES PV-SHIPT-UNT-ID-NUM.     00398018
003990         10  FILLER                      PIC  9(13).              00399018
004000         10  PV-SHIPT-UNT-14-18          PIC  9(05).              00400018
004010                                                                  00401029
004020     05  PV-RCVR-NBR                     PIC  X(09)  VALUE SPACES.00402018
004030     05  PV-RCVR-NBR-R REDEFINES PV-RCVR-NBR.                     00403018
004040         10  FILLER                      PIC  9(06).              00404018
004050         10  PV-RCVR-NBR-3POS            PIC  9(03).              00405018
004060                                                                  00406029
004070     05  PV-LINE-NBR                     PIC  X(09)  VALUE SPACES.00407018
004080     05  PV-LINE-NBR-R REDEFINES PV-LINE-NBR.                     00408018
004090         10  FILLER                      PIC  9(06).              00409018
004100         10  PV-PO-LINE-NBR              PIC  9(03).              00410018
004110     05  DK-BARCODE-NBR                  PIC  X(22).              00411018
004120                                                                  00412029
004140     05  PV-TCP-BUF-DATA-FORMAT.                                  00414018
004150         10  PV-TCP-BUF-DATA-FORMAT1     PIC  X(126) VALUE SPACE. 00415018
004160         10  PV-TCP-BUF-DATA-FORMAT2     PIC  X(126) VALUE SPACE. 00416018
004161                                                                  00416129
004170     05  PV-TOT-NBR-OF-DIGIT     PIC 9(02)    VALUE ZEROS.        00417018
004180     05  PV-X                    PIC 9(03)    VALUE ZEROS.        00418018
004190     05  PV-Q                    PIC 9(03)    VALUE ZEROS.        00419018
004200     05  PV-R                    PIC 9(01)    VALUE ZEROS.        00420018
004210     05  PV-MOD-10-CK-DGT        PIC 9(01)    VALUE ZEROS.        00421018
004220     05  PV-STORE-NBR-4.                                          00422018
004230         10  PV-STORE-NBR-3      PIC X(03).                       00423018
004240         10  PV-STORE-NBR-CHK    PIC X(01).                       00424018
004250     05  PV-9999                 PIC 9999     VALUE 0.            00425018
004260     05  PV-999                  PIC 999      VALUE 0.            00426018
004270     05  PV-PIC911               PIC 9(11)    VALUE 0.            00427018
004280     05  PV-PIC907               PIC 9(07)    VALUE 0.            00428018
004290     05  PV-PIC908               PIC 9(08)    VALUE 0.            00429018
004300     05  PV-Z999                 PIC Z999.                        00430018
004310     05  PV-ZZZ9                 PIC ZZZ9.                        00431018
004320     05  PV-ZZZZZZZ9             PIC ZZZZZZZ9.                    00432018
004330     05  PV-ZZZZZZZZZZ9          PIC ZZZZZZZZZZ9.                 00433018
004340     05  PV-ZZ9                  PIC ZZ9.                         00434018
004350     05  PV-STR-NBR4             PIC X(4).                        00435018
004360     05  PV-STR-NBR4-RDF REDEFINES                                00436018
004370         PV-STR-NBR4             PIC 9(04).                       00437018
004380     05  PV-STR-NBR3             PIC X(03).                       00438018
004390     05  PV-STR-NBR3-RDF REDEFINES                                00439018
004400         PV-STR-NBR3             PIC 9(03).                       00440018
004410     05  PV-99-N                 PIC 9(02).                       00441018
004420     05  PV-9999-X               PIC X(04).                       00442018
004430     05  PV-9999-N REDEFINES                                      00443018
004440         PV-9999-X               PIC 9(04).                       00444018
004450     05  PV-3-DIGIT-PRT-ID.                                       00445018
004460         10  PV-CLUSTER-CD       PIC X(01)    VALUE SPACES.       00446018
004470         10  PV-2-DIGIT-PRT-ID   PIC X(02)    VALUE SPACES.       00447018
004480     05  PV-3-DIGIT-PRT-ID-NBR REDEFINES                          00448018
004490         PV-3-DIGIT-PRT-ID       PIC 9(3).                        00449018
004500                                                                  00450018
004510     05  PV-AD-DATE.                                              00451018
004520         10  PV-MONTH            PIC X(02)    VALUE SPACES.       00452018
004530         10  FILLER              PIC X(01)    VALUE '/'.          00453018
004540         10  PV-YEAR             PIC X(02)    VALUE SPACES.       00454018
004550                                                                  00455018
004560     05  PV-DATE-TIME.                                            00456018
004570         10  PV-DATE             PIC X(10)    VALUE SPACES.       00457018
004580         10  FILLER              PIC X(01)    VALUE SPACES.       00458018
004590         10  PV-TIME             PIC X(08)    VALUE SPACES.       00459018
004600                                                                  00460018
004610     05  PV-DATE-MM-DD-YY.                                        00461018
004620         10  PV-DATE-MM          PIC X(02)    VALUE SPACES.       00462018
004630         10  FILLER              PIC X(01)    VALUE SPACES.       00463018
004640         10  PV-DATE-DD          PIC X(02)    VALUE SPACES.       00464018
004650         10  FILLER              PIC X(01)    VALUE SPACES.       00465018
004660         10  PV-DATE-YY          PIC X(02)    VALUE SPACES.       00466018
004670                                                                  00467018
004680     05  PV-DATE-PRINT-MM-DD.                                     00468018
004690         10  PV-DATE-PRINT-MM    PIC X(02)    VALUE SPACES.       00469018
004700         10  FILLER              PIC X(01)    VALUE '-'.          00470018
004710         10  PV-DATE-PRINT-DD    PIC X(02)    VALUE SPACES.       00471018
004720                                                                  00472018
004730     05  PV-DATE-PRINT-MM-DD-YY.                                  00473018
004740         10  PV-DATE-PRINT-MM2   PIC X(02)    VALUE SPACES.       00474018
004750         10  FILLER              PIC X(01)    VALUE '-'.          00475018
004760         10  PV-DATE-PRINT-DD2   PIC X(02)    VALUE SPACES.       00476018
004770         10  FILLER              PIC X(01)    VALUE '-'.          00477018
004780         10  PV-DATE-PRINT-YY2   PIC X(02)    VALUE SPACES.       00478018
004790                                                                  00479018
004800     05  PV-DATE-CCYY-MM-DD              PIC  X(10)  VALUE SPACES.00480018
004810     05  PV-DATE-CCYY-MM-DD-R REDEFINES PV-DATE-CCYY-MM-DD.       00481018
004820         10  PV-DATE-CCYY-R.                                      00482018
004830             15  PV-DATE-CC-R            PIC  X(02).              00483018
004840             15  PV-DATE-YY-R            PIC  X(02).              00484018
004850         10  FILLER                      PIC  X(01).              00485018
004860         10  PV-DATE-MM-R                PIC  X(02).              00486018
004870         10  FILLER                      PIC  X(01).              00487018
004880         10  PV-DATE-DD-R                PIC  X(02).              00488018
004890     05  PV-ARVD-DATE                    PIC  X(08)  VALUE SPACES.00489018
004900     05  PV-ARVD-DATE-R REDEFINES PV-ARVD-DATE.                   00490018
004910         10  PV-ARVD-DATE-MM             PIC  X(02).              00491018
004920         10  PV-ARVD-DASH1               PIC  X(01).              00492018
004930         10  PV-ARVD-DATE-DD             PIC  X(02).              00493018
004940         10  PV-ARVD-DASH2               PIC  X(01).              00494018
004950         10  PV-ARVD-DATE-YY             PIC  X(02).              00495018
004960     05  PV-4-DGT-STR-NBR        PIC  9(04)  VALUE ZEROS.         00496018
004970                                                                  00497018
004980     05  PV-PO-LNE-NBR-X         PIC X(04)    VALUE SPACES.       00498018
004990     05  PV-PO-LNE-NBR.                                           00499018
005000         10  FILLER              PIC X(01)    VALUE SPACES.       00500018
005010         10  PV-3-DGT-PO-LNE-NBR PIC X(03)    VALUE SPACES.       00501018
005020     05  PV-RCVR-SEQ-NBR.                                         00502018
005030         10  FILLER              PIC X(01)    VALUE SPACES.       00503018
005040         10  PV-2-DGT-RCVR-SEQ-NBR                                00504018
005050                                 PIC X(02)    VALUE SPACES.       00505018
005060     05  PV-PO-RCVR.                                              00506018
005070         10  PV-PO-NUMBER                PIC  9(08)  VALUE ZEROES.00507018
005080         10  FILLER                      PIC  X(01)  VALUE '-'.   00508018
005090         10  PV-PO-RECEIVER              PIC  9(03)  VALUE ZEROES.00509018
005100     05  PV-SML-SKU-NUMBER.                                       00510018
005110         10  FILLER                      PIC  X(01)  VALUE '('.   00511018
005120         10  PV-SML-DEPT1                PIC  X(03)  VALUE SPACES.00512018
005130         10  FILLER                      PIC  X(01)  VALUE '-'.   00513018
005140         10  PV-SML-CLASS-NBR1           PIC  X(02)  VALUE SPACES.00514018
005150         10  FILLER                      PIC  X(01)  VALUE ')'.   00515018
005160         10  PV-SML-DEPT2                PIC  X(03)  VALUE SPACES.00516018
005170         10  PV-SML-CLASS-NBR2           PIC  X(02)  VALUE SPACES.00517018
005180         10  PV-SML-SEQ-NBR              PIC  X(08)  VALUE SPACES.00518018
005190     05  PV-RF-SKU-NUMBER.                                        00519018
005200         10  PV-RF-DEPT                  PIC  X(03).              00520018
005210         10  PV-RF-CLASS                 PIC  X(02).              00521018
005220         10  PV-RF-SEQ-NBR               PIC  X(03).              00522018
005230     05  PV-RF-DPT-CLS.                                           00523018
005240         10  PV-RF-DEST-DEPT             PIC  X(03).              00524018
005250         10  PV-RF-DEST-DASH             PIC  X(01).              00525018
005260         10  PV-RF-DEST-CLASS            PIC  X(02).              00526018
005270     05  PV-RF-SKU-NBR.                                           00527018
005280         10  PV-RF-DEPT1                 PIC  X(03)  VALUE SPACE. 00528018
005290         10  FILLER                      PIC  X(01)  VALUE SPACE. 00529018
005300         10  PV-RF-CLASS1                PIC  X(02)  VALUE SPACE. 00530018
005310         10  FILLER                      PIC  X(01)  VALUE SPACE. 00531018
005320         10  PV-RF-SKU1                  PIC  X(03)  VALUE SPACE. 00532018
005330     05  PV-DISTHD-MOD.                                           00533018
005340         10  FILLER                      PIC  X(01)  VALUE SPACE. 00534018
005350         10  PV-DISTHD-MOD-2             PIC  X(02)  VALUE SPACE. 00535018
005360     05  PV-RF-DEST-BARCODE.                                      00536018
005370         10  FILLER                      PIC  X(03)  VALUE SPACE. 00537018
005380         10  PV-RF-MOD                   PIC  X(02)  VALUE SPACE. 00538018
005390         10  PV-RF-PO                    PIC  9(08)  VALUE ZEROES.00539018
005400         10  PV-RF-RCVR                  PIC  9(02)  VALUE ZEROES.00540018
005410         10  PV-RF-LINE                  PIC  9(03)  VALUE ZEROES.00541018
005420         10  PV-RF-LBL-SEQ               PIC  9(04)  VALUE ZEROES.00542018
005430     05  PV-RF-DEST-SKU-NBR-A.                                    00543018
005440         10  FILLER                      PIC  X(01)  VALUE SPACE. 00544018
005450         10  PV-RF-DEST-DEPT-A           PIC  X(03)  VALUE SPACE. 00545018
005460         10  FILLER                      PIC  X(01)  VALUE SPACE. 00546018
005470         10  PV-RF-DEST-CLASS-A          PIC  X(02)  VALUE SPACE. 00547018
005480         10  FILLER                      PIC  X(01)  VALUE SPACE. 00548018
005490         10  PV-RF-DEST-SKU-A            PIC  X(03)  VALUE SPACE. 00549018
005500         10  FILLER                      PIC  X(01)  VALUE SPACE. 00550018
005510     05  PV-RF-DEST-PACK-RATIO.                                   00551018
005520         10  FILLER                      PIC  X(01)  VALUE SPACE. 00552018
005530         10  PV-RF-DEST-RATIO            PIC  X(03)  VALUE SPACE. 00553018
005540                                                                  00554029
005550     05  PV-LBL-DEPT-CLASS.                                       00555018
005560         10  PV-LBL-DEPT              PIC X(03) VALUE ZEROS.      00556018
005570         10  FILLER                   PIC X(01) VALUE '-'.        00557018
005580         10  PV-LBL-CLASS             PIC X(02) VALUE ZEROS.      00558018
005590                                                                  00559018
005600     05  PV-GP-RTL-AMT-PRINT.                                     00560018
005610         10   PV-GP-QTY               PIC  Z9        VALUE ZEROS. 00561018
005620         10   FILLER                  PIC  X(01)     VALUE '/'.   00562018
005630         10   PV-GP-RTL-AMT-X         PIC  X(06)     VALUE SPACES.00563018
005640     05  PV-GP-RTL-AMT                PIC  $$$.99    VALUE ZEROS. 00564018
005650     05  PV-RTL-PR-AMT                PIC  $$,$$$.99 VALUE ZEROS. 00565018
005660     05  PV-PO-NBR-DB2                PIC  S9(9) COMP.            00566018
005670     05  PV-PO-NBR                    PIC   9(9).                 00567018
005680     05  PV-PO-NBR-X REDEFINES PV-PO-NBR.                         00568018
005690         10 PO-NBR-X                  PIC   X(9).                 00569018
005700     05  PV-PO-NBR-R REDEFINES PV-PO-NBR.                         00570018
005710         10  FILLER                      PIC  9(01).              00571018
005720         10  PV-PO-NBR-7POS              PIC  9(08).              00572018
005730     05  PV-PO-RCVR-DB2               PIC  S9(9) COMP.            00573018
005740     05  PV-LNE-NBR-DB2               PIC  S9(9) COMP.            00574018
005750     05    PV-UPC-CODE-12-DIGIT          PIC 9(12) VALUE ZEROES.  00575018
005760     05    PV-UPC-CODE                   PIC 9(12) VALUE ZEROES.  00576018
005770     05    PV-UPC-CODE-X  REDEFINES PV-UPC-CODE.                  00577018
005780           10   PV-UPC-CODE-1            PIC X(01).               00578018
005790           10   PV-UPC-CODE-2-6          PIC X(05).               00579018
005800           10   PV-UPC-CODE-7-11         PIC X(05).               00580018
005810           10   PV-UPC-CODE-12           PIC X(01).               00581018
005820     05    PV-UPC-CODE-X2 REDEFINES PV-UPC-CODE.                  00582018
005830           10   PV-UPC-CODE-1-11         PIC 9(11).               00583018
005840           10   FILLER                   PIC X(01).               00584018
005850     05    PV-UPC-CODE-PRT.                                       00585018
005860           10   PV-UPC-CODE-PRT-1        PIC X(01) VALUE SPACES.  00586018
005870           10   FILLER                   PIC X(01) VALUE SPACES.  00587018
005880           10   PV-UPC-CODE-PRT-2-6      PIC X(05) VALUE SPACES.  00588018
005890           10   FILLER                   PIC X(01) VALUE SPACES.  00589018
005900           10   PV-UPC-CODE-PRT-7-11     PIC X(05) VALUE SPACES.  00590018
005910           10   FILLER                   PIC X(01) VALUE SPACES.  00591018
005920           10   PV-UPC-CODE-PRT-12       PIC X(01) VALUE SPACES.  00592018
005930     05  PV-PGYBK-TICKET-QTY             PIC 9(04) VALUE ZEROES.  00593018
005940                                                                  00594029
005950     05  PV-HNG-FOLD-SEQ-NBR             PIC  S9(4) COMP.         00595018
005960     05  PV-PREV-HANG-FOLD-IND           PIC  X(01) VALUE SPACE.  00596018
005970     05  PV-HANG-FOLD-IND                PIC  X(01) VALUE SPACE.  00597018
005980     05  PV-RF-BARCODE.                                           00598018
005990         10  PV-RF-BARCODE-FIRST2        PIC  X(2).               00599018
006000         10  PV-RF-BARCODE-NEXT18        PIC  X(18).              00600018
006010         10  PV-RF-BARCODE-LAST2         PIC  X(2).               00601018
006030     05  PV-DSPLY-PRTR                   PIC  X(07)  VALUE SPACES.00603018
006040     05  PV-DSPLY-PRTR-R REDEFINES PV-DSPLY-PRTR.                 00604018
006050         10  PV-DSPLY-NBR-SIGN           PIC  X(01).              00605018
006060         10  PV-DSPLY-DC                 PIC  X(02).              00606018
006070         10  PV-DSPLY-DASH               PIC  X(01).              00607018
006080         10  PV-DSPLY-PRTR-ID            PIC  X(03).              00608018
006090     05  PV-EDIT-PREPK-ID.                                        00609018
006100         10  FILLER                   PIC X(05) VALUE 'PACK-'.    00610018
006110         10  PV-EDIT-PREPK-NBR        PIC 9(04) VALUE ZEROS.      00611018
006120     05  PV-PACK-RATIO                PIC 9(04) VALUE ZERO.       00612018
006130     05  PV-PACK-RATIO-R REDEFINES PV-PACK-RATIO.                 00613018
006140         10  FILLER                   PIC X(01).                  00614018
006150         10  PV-PACK-RATIO-3          PIC 9(03).                  00615018
006160     05  PV-XL-DEPT-NBR               PIC  9(4).                  00616018
006190     05  PV-FIRST-STORE-RCPT.                                     00619018
006200         10 PV-FIRST-STORE-RCPT-TXT-1 PIC X(12) VALUE             00620018
006210                                       '@@@@NEW@@@@@'.            00621018
006220         10 PV-FIRST-STORE-RCPT-TXT-2 PIC X(12) VALUE             00622018
006230                                       '@@@@@TO@@@@@'.            00623018
006240         10 PV-FIRST-STORE-RCPT-TXT-3 PIC X(12) VALUE             00624018
006250                                       '@@@STORE@@@@'.            00625018
006260     05  PV-MOD-DATE.                                             00626018
006270         10  PV-MOD                  PIC   99     VALUE ZEROES.   00627018
006280         10  PV-DASH                 PIC   X      VALUE SPACE.    00628018
006290         10  PV-ARRIVE-MM            PIC   XX     VALUE ZEROES.   00629018
006300         10  PV-ARRIVE-DD            PIC   XX     VALUE ZEROES.   00630018
006310                                                                  00631018
006311     05  PV-CURRENT-TMST                 PIC X(26)  VALUE SPACES. 00631120
006312     05  PV-CURRENT-TMST-R.                                       00631220
006313         10 FILLER                       PIC  X(22) VALUE SPACES. 00631320
006314         10 PV-CURRENT-TMST-R-LAST-4     PIC  9(04) VALUE ZEROS.  00631420
006315                                                                  00631520
006350     05  PV-LABEL-BREAK-QTY       pic S9(09) COMP value zeroes.   00635018
006360     05  PV-STORES-PROCESSED      PIC  9(09)      VALUE ZEROES.   00636018
006410                                                                  00641029
006420     05  PV-GENERIC-SML-UNION     pic  X(01)      value SPACE.    00642018
006430     05  PV-GENERIC-SML-SEQ       pic S9(09) COMP value zeroes.   00643018
006470                                                                  00647018
006520 01  SELECT-PARMS.                                                00652018
006530     02  SELECT-NUMFDS          PIC 9(8) COMP VALUE 2.            00653018
006540     02  SELECT-TIMEOUT.                                          00654018
006550         03  SELECT-SECS        PIC 9(8) COMP VALUE 05.           00655018
006560         03  SELECT-MILLSECS    PIC 9(8) COMP VALUE 0.            00656018
006570     02  SELECT-RD-MASK         PIC X(16).                        00657018
006580     02  SELECT-WR-MASK         PIC X(16).                        00658018
006590     02  SELECT-EX-MASK         PIC X(16).                        00659018
006600     02  SELECT-RR-MASK         PIC X(16).                        00660018
006610     02  SELECT-RW-MASK         PIC X(16).                        00661018
006620     02  SELECT-RE-MASK         PIC X(16).                        00662018
006630                                                                  00663018
006640 01  CHAR-MASK.                                                   00664018
006650     02 CHAR-STRING             PIC  X(100).                      00665018
006660                                                                  00666018
006670 01  CHAR-ARRAY REDEFINES CHAR-MASK.                              00667018
006680     02  CHAR-ENTRY-TABLE OCCURS 100 TIMES.                       00668018
006690       03  CHAR-ENTRY         PIC  X.                             00669018
006700                                                                  00670018
006710 01  BIT-MASK.                                                    00671018
006720     02  BIT-ARRAY            PIC  X(16).                         00672018
006730                                                                  00673018
006740 01  BIT-FUNCTION-CODES.                                          00674018
006750     02  CTOB                 PIC  X(4) VALUE 'CTOB'.             00675018
006760     02  BTOC                 PIC  X(4) VALUE 'BTOC'.             00676018
006770                                                                  00677018
006780 01  BIT-MASK-LENGTH          PIC  9(8) COMP VALUE 100.           00678018
006790                                                                  00679018
006800 01  BITMASK-TOKEN            PIC X(16) VALUE 'TCPIPBITMASKCOBL'. 00680018
006810 01  SOCKETS                  PIC  9(8) COMP VALUE 100.           00681018
006820 01  SOCKNO                   PIC S9(8) BINARY.                   00682018
006830 01  EZRETC                   PIC S9(8) COMP.                     00683018
006840                                                                  00684018
006850 01  SOCKET-SELECT-ERR.                                           00685018
006860     05  FILLER                       PIC X(10)                   00686018
006870         VALUE ' PCKCS707-'.                                      00687018
006880     05  FILLER                       PIC X(14)                   00688018
006890         VALUE 'SOCKET SELECT-'.                                  00689018
006900     05  FILLER                       PIC X(7)                    00690018
006910         VALUE '-RETCD='.                                         00691018
006920     05  SOCKET-RETCODE               PIC 9(10)-.                 00692018
006930     05  FILLER                       PIC X(2) VALUE SPACES.      00693018
006940     05  SOCKET-ERRNO                 PIC 9(8).                   00694018
006950     05  FILLER                       PIC X(2) VALUE SPACES.      00695018
006960     05  SOCKET-RECEIVER              PIC 9(8).                   00696018
006970     05  FILLER                       PIC X(1) VALUE '-'.         00697018
006980     05  SOCKET-SEQ                   PIC 9(3).                   00698018
006990     05  FILLER                       PIC X(1) VALUE '-'.         00699018
007000     05  SOCKET-LINE                  PIC 9(4).                   00700018
007010     05  FILLER                       PIC X(1) VALUE '-'.         00701018
007020     05  SOCKET-DESCR                 PIC X(20).                  00702018
007070                                                                  00707018
007080 01  WS-USERID                    PIC X(09).                      00708018
007090 01  XWS-USERID  REDEFINES WS-USERID.                             00709018
007100     05  WS-CHAR1                 PIC X.                          00710018
007110     05  WS-CHAR2                 PIC X.                          00711018
007120     05  WS-CHAR3                 PIC X.                          00712018
007130     05  WS-CHAR4                 PIC X.                          00713018
007140     05  WS-CHAR5                 PIC X.                          00714018
007150     05  WS-CHAR6                 PIC X.                          00715018
007160     05  WS-CHAR7                 PIC X.                          00716018
007170     05  WS-CHAR8                 PIC X.                          00717018
007180     05  FILLER                   PIC X.                          00718018
007190                                                                  00719018
007200 01  WS-MISC                      PIC X(13).                      00720018
007210 01  XWS-MISC    REDEFINES WS-MISC.                               00721018
007220     05  WS-MISC1                 PIC X.                          00722018
007230     05  WS-MISC2                 PIC X.                          00723018
007240     05  WS-MISC3                 PIC X.                          00724018
007250     05  WS-MISC4                 PIC X.                          00725018
007260     05  WS-MISC5                 PIC X.                          00726018
007270     05  WS-MISC6                 PIC X.                          00727018
007280     05  WS-MISC7                 PIC X.                          00728018
007290     05  WS-MISC8                 PIC X.                          00729018
007300     05  WS-MISC9                 PIC X.                          00730018
007310     05  WS-MISC10                PIC X.                          00731018
007320     05  WS-MISC11                PIC X.                          00732018
007330     05  WS-MISC12                PIC X.                          00733018
007340     05  FILLER                   PIC X.                          00734018
007350                                                                  00735018
007360****** NOTE : THE 1 CORRESPONDS TO THE BEGIN RANGE POSITION       00736018
007370******        BEING PASSED IN PCWS140...AND SO ON                 00737018
007380 01  PV-ML-HR-1.                                                  00738018
007390     05  PV-HR-1-RANGE-VALUE      PIC 9(04) VALUE ZEROES.         00739018
007400     05  PV-HR-1-RANGE-VALUE-X  REDEFINES                         00740018
007410         PV-HR-1-RANGE-VALUE      PIC X(04).                      00741018
007420     05  PV-HR-1-TEXT-AFT         PIC X(16) VALUE SPACES.         00742018
007430                                                                  00743018
007440***** NOTE : IF RANGE POSITION BEGINS AT 2, THERE CAN ONLY BE     00744018
007450*****        ONE BYTE OF FREE FORM TEXT ENTERED BEFORE THE 4 CHAR 00745018
007460*****        RANGE, THEN THE REST COULD BE UP TO 15 MORE CHARS ETC00746018
007470 01  PV-ML-HR-2.                                                  00747018
007480     05  PV-HR-2-TEXT-BEF         PIC X(01) VALUE SPACES.         00748018
007490     05  PV-HR-2-RANGE-VALUE      PIC 9(04) VALUE ZEROES.         00749018
007500     05  PV-HR-2-RANGE-VALUE-X  REDEFINES                         00750018
007510         PV-HR-2-RANGE-VALUE      PIC X(04).                      00751018
007520     05  PV-HR-2-TEXT-AFT         PIC X(15) VALUE SPACES.         00752018
007530                                                                  00753018
007540 01  PV-ML-HR-3.                                                  00754018
007550     05  PV-HR-3-TEXT-BEF         PIC X(02) VALUE SPACES.         00755018
007560     05  PV-HR-3-RANGE-VALUE      PIC 9(04) VALUE ZEROES.         00756018
007570     05  PV-HR-3-RANGE-VALUE-X  REDEFINES                         00757018
007580         PV-HR-3-RANGE-VALUE      PIC X(04).                      00758018
007590     05  PV-HR-3-TEXT-AFT         PIC X(14) VALUE SPACES.         00759018
007600                                                                  00760018
007610 01  PV-ML-HR-4.                                                  00761018
007620     05  PV-HR-4-TEXT-BEF         PIC X(03) VALUE SPACES.         00762018
007630     05  PV-HR-4-RANGE-VALUE      PIC 9(04) VALUE ZEROES.         00763018
007640     05  PV-HR-4-RANGE-VALUE-X  REDEFINES                         00764018
007650         PV-HR-4-RANGE-VALUE      PIC X(04).                      00765018
007660     05  PV-HR-4-TEXT-AFT         PIC X(13) VALUE SPACES.         00766018
007670                                                                  00767018
007680 01  PV-ML-HR-5.                                                  00768018
007690     05  PV-HR-5-TEXT-BEF         PIC X(04) VALUE SPACES.         00769018
007700     05  PV-HR-5-RANGE-VALUE      PIC 9(04) VALUE ZEROES.         00770018
007710     05  PV-HR-5-RANGE-VALUE-X  REDEFINES                         00771018
007720         PV-HR-5-RANGE-VALUE      PIC X(04).                      00772018
007730     05  PV-HR-5-TEXT-AFT         PIC X(12) VALUE SPACES.         00773018
007740                                                                  00774018
007750 01  PV-ML-HR-6.                                                  00775018
007760     05  PV-HR-6-TEXT-BEF         PIC X(05) VALUE SPACES.         00776018
007770     05  PV-HR-6-RANGE-VALUE      PIC 9(04) VALUE ZEROES.         00777018
007780     05  PV-HR-6-RANGE-VALUE-X  REDEFINES                         00778018
007790         PV-HR-6-RANGE-VALUE      PIC X(04).                      00779018
007800     05  PV-HR-6-TEXT-AFT         PIC X(11) VALUE SPACES.         00780018
007810                                                                  00781018
007820 01  PV-ML-HR-7.                                                  00782018
007830     05  PV-HR-7-TEXT-BEF         PIC X(06) VALUE SPACES.         00783018
007840     05  PV-HR-7-RANGE-VALUE      PIC 9(04) VALUE ZEROES.         00784018
007850     05  PV-HR-7-RANGE-VALUE-X  REDEFINES                         00785018
007860         PV-HR-7-RANGE-VALUE      PIC X(04).                      00786018
007870     05  PV-HR-7-TEXT-AFT         PIC X(10) VALUE SPACES.         00787018
007880                                                                  00788018
007890 01  PV-ML-HR-8.                                                  00789018
007900     05  PV-HR-8-TEXT-BEF         PIC X(07) VALUE SPACES.         00790018
007910     05  PV-HR-8-RANGE-VALUE      PIC 9(04) VALUE ZEROES.         00791018
007920     05  PV-HR-8-RANGE-VALUE-X  REDEFINES                         00792018
007930         PV-HR-8-RANGE-VALUE      PIC X(04).                      00793018
007940     05  PV-HR-8-TEXT-AFT         PIC X(09) VALUE SPACES.         00794018
007950                                                                  00795018
007960 01  PV-ML-HR-9.                                                  00796018
007970     05  PV-HR-9-TEXT-BEF         PIC X(08) VALUE SPACES.         00797018
007980     05  PV-HR-9-RANGE-VALUE      PIC 9(04) VALUE ZEROES.         00798018
007990     05  PV-HR-9-RANGE-VALUE-X  REDEFINES                         00799018
008000         PV-HR-9-RANGE-VALUE      PIC X(04).                      00800018
008010     05  PV-HR-9-TEXT-AFT         PIC X(08) VALUE SPACES.         00801018
008020                                                                  00802018
008030 01  PV-ML-HR-10.                                                 00803018
008040     05  PV-HR-10-TEXT-BEF        PIC X(09) VALUE SPACES.         00804018
008050     05  PV-HR-10-RANGE-VALUE     PIC 9(04) VALUE ZEROES.         00805018
008060     05  PV-HR-10-RANGE-VALUE-X REDEFINES                         00806018
008070         PV-HR-10-RANGE-VALUE     PIC X(04).                      00807018
008080     05  PV-HR-10-TEXT-AFT        PIC X(07) VALUE SPACES.         00808018
008090                                                                  00809018
008100 01  PV-ML-HR-11.                                                 00810018
008110     05  PV-HR-11-TEXT-BEF        PIC X(10) VALUE SPACES.         00811018
008120     05  PV-HR-11-RANGE-VALUE     PIC 9(04) VALUE ZEROES.         00812018
008130     05  PV-HR-11-RANGE-VALUE-X REDEFINES                         00813018
008140         PV-HR-11-RANGE-VALUE     PIC X(04).                      00814018
008150     05  PV-HR-11-TEXT-AFT        PIC X(06) VALUE SPACES.         00815018
008160                                                                  00816018
008170 01  PV-ML-HR-12.                                                 00817018
008180     05  PV-HR-12-TEXT-BEF        PIC X(11) VALUE SPACES.         00818018
008190     05  PV-HR-12-RANGE-VALUE     PIC 9(04) VALUE ZEROES.         00819018
008200     05  PV-HR-12-RANGE-VALUE-X REDEFINES                         00820018
008210         PV-HR-12-RANGE-VALUE     PIC X(04).                      00821018
008220     05  PV-HR-12-TEXT-AFT        PIC X(05) VALUE SPACES.         00822018
008230                                                                  00823018
008240 01  PV-ML-HR-13.                                                 00824018
008250     05  PV-HR-13-TEXT-BEF        PIC X(12) VALUE SPACES.         00825018
008260     05  PV-HR-13-RANGE-VALUE     PIC 9(04) VALUE ZEROES.         00826018
008270     05  PV-HR-13-RANGE-VALUE-X REDEFINES                         00827018
008280         PV-HR-13-RANGE-VALUE     PIC X(04).                      00828018
008290     05  PV-HR-13-TEXT-AFT        PIC X(04) VALUE SPACES.         00829018
008300                                                                  00830018
008310 01  PV-ML-HR-14.                                                 00831018
008320     05  PV-HR-14-TEXT-BEF        PIC X(13) VALUE SPACES.         00832018
008330     05  PV-HR-14-RANGE-VALUE     PIC 9(04) VALUE ZEROES.         00833018
008340     05  PV-HR-14-RANGE-VALUE-X REDEFINES                         00834018
008350         PV-HR-14-RANGE-VALUE     PIC X(04).                      00835018
008360     05  PV-HR-14-TEXT-AFT        PIC X(03) VALUE SPACES.         00836018
008370                                                                  00837018
008380 01  PV-ML-HR-15.                                                 00838018
008390     05  PV-HR-15-TEXT-BEF        PIC X(14) VALUE SPACES.         00839018
008400     05  PV-HR-15-RANGE-VALUE     PIC 9(04) VALUE ZEROES.         00840018
008410     05  PV-HR-15-RANGE-VALUE-X REDEFINES                         00841018
008420         PV-HR-15-RANGE-VALUE     PIC X(04).                      00842018
008430     05  PV-HR-15-TEXT-AFT        PIC X(02) VALUE SPACES.         00843018
008440                                                                  00844018
008450 01  PV-ML-HR-16.                                                 00845018
008460     05  PV-HR-16-TEXT-BEF        PIC X(15) VALUE SPACES.         00846018
008470     05  PV-HR-16-RANGE-VALUE     PIC 9(04) VALUE ZEROES.         00847018
008480     05  PV-HR-16-RANGE-VALUE-X REDEFINES                         00848018
008490         PV-HR-16-RANGE-VALUE     PIC X(04).                      00849018
008500     05  PV-HR-16-TEXT-AFT        PIC X(01) VALUE SPACES.         00850018
008510                                                                  00851018
008520 01  PV-ML-HR-17.                                                 00852018
008530     05  PV-HR-17-TEXT-BEF        PIC X(16) VALUE SPACES.         00853018
008540     05  PV-HR-17-RANGE-VALUE     PIC 9(04) VALUE ZEROES.         00854018
008550     05  PV-HR-17-RANGE-VALUE-X REDEFINES                         00855018
008560         PV-HR-17-RANGE-VALUE     PIC X(04).                      00856018
008570                                                                  00857018
008580****** NOTE : THE 1 CORRESPONDS TO THE BEGIN RANGE POSITION       00858018
008590******        BEING PASSED IN PCWS140...AND SO ON                 00859018
008600 01  PV-ML-BC-1.                                                  00860018
008610     05  PV-BC-1-RANGE-VALUE      PIC 9(04) VALUE ZEROES.         00861018
008620     05  PV-BC-1-RANGE-VALUE-X  REDEFINES                         00862018
008630         PV-BC-1-RANGE-VALUE      PIC X(04).                      00863018
008640     05  PV-BC-1-TEXT-AFT         PIC X(08) VALUE SPACES.         00864018
008650                                                                  00865018
008660***** NOTE : IF RANGE POSITION BEGINS AT 2, THERE CAN ONLY BE     00866018
008670*****        ONE BYTE OF FREE FORM TEXT ENTERED BEFORE THE 4 CHAR 00867018
008680*****        RANGE, THEN THE REST COULD BE UP TO 7 MORE CHARS ETC 00868018
008690 01  PV-ML-BC-2.                                                  00869018
008700     05  PV-BC-2-TEXT-BEF         PIC X(01) VALUE SPACES.         00870018
008710     05  PV-BC-2-RANGE-VALUE      PIC 9(04) VALUE ZEROES.         00871018
008720     05  PV-BC-2-RANGE-VALUE-X  REDEFINES                         00872018
008730         PV-BC-2-RANGE-VALUE      PIC X(04).                      00873018
008740     05  PV-BC-2-TEXT-AFT         PIC X(07) VALUE SPACES.         00874018
008750                                                                  00875018
008760 01  PV-ML-BC-3.                                                  00876018
008770     05  PV-BC-3-TEXT-BEF         PIC X(02) VALUE SPACES.         00877018
008780     05  PV-BC-3-RANGE-VALUE      PIC 9(04) VALUE ZEROES.         00878018
008790     05  PV-BC-3-RANGE-VALUE-X  REDEFINES                         00879018
008800         PV-BC-3-RANGE-VALUE      PIC X(04).                      00880018
008810     05  PV-BC-3-TEXT-AFT         PIC X(06) VALUE SPACES.         00881018
008820                                                                  00882018
008830 01  PV-ML-BC-4.                                                  00883018
008840     05  PV-BC-4-TEXT-BEF         PIC X(03) VALUE SPACES.         00884018
008850     05  PV-BC-4-RANGE-VALUE      PIC 9(04) VALUE ZEROES.         00885018
008860     05  PV-BC-4-RANGE-VALUE-X  REDEFINES                         00886018
008870         PV-BC-4-RANGE-VALUE      PIC X(04).                      00887018
008880     05  PV-BC-4-TEXT-AFT         PIC X(05) VALUE SPACES.         00888018
008890                                                                  00889018
008900 01  PV-ML-BC-5.                                                  00890018
008910     05  PV-BC-5-TEXT-BEF         PIC X(04) VALUE SPACES.         00891018
008920     05  PV-BC-5-RANGE-VALUE      PIC 9(04) VALUE ZEROES.         00892018
008930     05  PV-BC-5-RANGE-VALUE-X  REDEFINES                         00893018
008940         PV-BC-5-RANGE-VALUE      PIC X(04).                      00894018
008950     05  PV-BC-5-TEXT-AFT         PIC X(04) VALUE SPACES.         00895018
008960                                                                  00896018
008970 01  PV-ML-BC-6.                                                  00897018
008980     05  PV-BC-6-TEXT-BEF         PIC X(05) VALUE SPACES.         00898018
008990     05  PV-BC-6-RANGE-VALUE      PIC 9(04) VALUE ZEROES.         00899018
009000     05  PV-BC-6-RANGE-VALUE-X  REDEFINES                         00900018
009010         PV-BC-6-RANGE-VALUE      PIC X(04).                      00901018
009020     05  PV-BC-6-TEXT-AFT         PIC X(03) VALUE SPACES.         00902018
009030                                                                  00903018
009040 01  PV-ML-BC-7.                                                  00904018
009050     05  PV-BC-7-TEXT-BEF         PIC X(06) VALUE SPACES.         00905018
009060     05  PV-BC-7-RANGE-VALUE      PIC 9(04) VALUE ZEROES.         00906018
009070     05  PV-BC-7-RANGE-VALUE-X  REDEFINES                         00907018
009080         PV-BC-7-RANGE-VALUE      PIC X(04).                      00908018
009090     05  PV-BC-7-TEXT-AFT         PIC X(02) VALUE SPACES.         00909018
009100                                                                  00910018
009110 01  PV-ML-BC-8.                                                  00911018
009120     05  PV-BC-8-TEXT-BEF         PIC X(07) VALUE SPACES.         00912018
009130     05  PV-BC-8-RANGE-VALUE      PIC 9(04) VALUE ZEROES.         00913018
009140     05  PV-BC-8-RANGE-VALUE-X  REDEFINES                         00914018
009150         PV-BC-8-RANGE-VALUE      PIC X(04).                      00915018
009160     05  PV-BC-8-TEXT-AFT         PIC X(01) VALUE SPACES.         00916018
009170                                                                  00917018
009180 01  PV-ML-BC-9.                                                  00918018
009190     05  PV-BC-9-TEXT-BEF         PIC X(08) VALUE SPACES.         00919018
009200     05  PV-BC-9-RANGE-VALUE      PIC 9(04) VALUE ZEROES.         00920018
009210     05  PV-BC-9-RANGE-VALUE-X  REDEFINES                         00921018
009220         PV-BC-9-RANGE-VALUE      PIC X(04).                      00922018
009230                                                                  00923018
009240**** THESE ARE USED FOR RACK LABELS (HUMAN READABLE)              00924018
009250 01  PV-RL-HR.                                                    00925018
009260     05  PV-RL-HR-TEXT-BEF        PIC X(07) VALUE SPACES.         00926018
009270     05  PV-RL-HR-SLOT-VALUE      PIC 9(03) VALUE ZEROES.         00927018
009280     05  PV-RL-HR-SLOT-VALUE-X  REDEFINES                         00928018
009290         PV-RL-HR-SLOT-VALUE      PIC X(03).                      00929018
009300     05  PV-RL-HR-TEXT-AFT        PIC X(10) VALUE SPACES.         00930018
009310                                                                  00931018
009320 01  PV-RL-BC.                                                    00932018
009330     05  PV-RL-BC-TEXT-BEF        PIC X(05) VALUE SPACES.         00933018
009340     05  PV-RL-BC-SLOT-VALUE      PIC 9(03) VALUE ZEROES.         00934018
009350     05  PV-RL-BC-SLOT-VALUE-X  REDEFINES                         00935018
009360         PV-RL-BC-SLOT-VALUE      PIC X(03).                      00936018
009370     05  PV-RL-BC-TEXT-AFT        PIC X(04) VALUE SPACES.         00937018
009380                                                                  00938029
009390 01  PV-DEBUG-DISPLAY-STUFF.                                      00939018
009400     05  PV-DISP-NUMBER               PIC 9(07) VALUE ZERO.       00940021
009401     05  PV-DISP-DC                   PIC 9(03) VALUE ZERO.       00940121
009410     05  PV-DISP-SQLCODE              PIC -999  VALUE ZERO.       00941018
009420     05  PV-DISP-NBR                  PIC 9(05) VALUE ZERO.       00942018
009430     05  PV-DISP-TASK                 PIC 9(04) VALUE ZERO.       00943018
009440     05  PV-DISP-PACKS                PIC 9(05) VALUE ZERO.       00944018
009450     05  PV-DISP-ODD-UNITS            PIC 9(05) VALUE ZERO.       00945018
009460     05  PV-DISP-RETCODE              PIC -9(07) VALUE ZERO.      00946018
009470     05  PV-DISP-OPER-UNT-ID          PIC 9(04) VALUE ZERO.       00947018
009480     05  PV-DISP-LOC                  PIC 9(04) VALUE ZERO.       00948018
009490     05  PV-DISP-PO                   PIC 9(08) VALUE ZERO.       00949018
009500     05  PV-DISP-LINE                 PIC 9(04) VALUE ZERO.       00950018
009510     05  PV-DISP-REC-SEQ-NBR          PIC 9(04) VALUE ZERO.       00951018
009520     05  PV-DISP-PREPK-ID             PIC 9(04) VALUE ZERO.       00952018
009530     05  PV-DISP-UPC                  PIC 9(15) VALUE ZERO.       00953018
009540     05  PV-DISP-SHPUNT               PIC 9(18) VALUE ZERO.       00954018
009550     05  PV-DISP-MSG-NBR              PIC 9(03) VALUE ZERO.       00955018
009560     05  PV-DISP-SYSTEM-TMST          PIC X(26) VALUE SPACES.     00956018
009570     05  PV-DISP-TABLE-1              PIC X(08) VALUE SPACES.     00957018
009580     05  PV-DISP-TABLE-2              PIC X(08) VALUE SPACES.     00958018
009590     05  PV-DISP-TABLE-3              PIC X(08) VALUE SPACES.     00959018
009600     05  PV-PREV-SEQUENCE             PIC S9(05) COMP-3           00960018
009610                                                     VALUE ZERO.  00961018
009620     05  PV-NEXT-SEQUENCE             PIC S9(05) COMP-3           00962018
009630                                                     VALUE ZERO.  00963018
009640 01  PT-MSG-TABLE.                                                00964018
009650     05  PT-MSG-LINES OCCURS 200 TIMES                            00965018
009660                              INDEXED BY PT-MSG-IDX.              00966018
009670         10  PT-MSG-SEQ                  PIC S9(05) COMP-3.       00967018
009680         10  PT-MSG-LINE                 PIC X(69).               00968018
009690                                                                  00969018
009700* DSNTIAR OUTPUT LINES                                            00970018
009710     COPY DPWS004.                                                00971018
009720                                                                  00972029
009730*----------------------------------------------------------------*00973018
009740*  RANDOM NUMBER AREA                                            *00974018
009750*----------------------------------------------------------------*00975018
009760     COPY DPWS902.                                                00976018
009770                                                                  00977018
009780*----------------------------------------------------------------*00978018
009790*  RECORD LAYOUTS FOR LABEL PRINT MGMT SYSTEM (LPMS)             *00979018
009800*----------------------------------------------------------------*00980018
009810     COPY PCWS133.                                                00981018
009820                                                                  00982018
009830*----------------------------------------------------------------*00983018
009840*  LABEL PRINT MANAGEMENT SYSTEM - 'EZASOKET' ERROR MESSAGES     *00984018
009850*----------------------------------------------------------------*00985018
009860     COPY PCWS138.                                                00986018
009870                                                                  00987018
009980*----------------------------------------------------------------*00998018
009990*    SHIPPING MANIFEST LABEL FORM LAYOUT - SOCKETS                00999018
010000*----------------------------------------------------------------*01000018
010010     COPY PCWS253.                                                01001018
010020                                                                  01002018
010030*----------------------------------------------------------------*01003018
010040*    SHIPPING MANIFEST LABEL DATA LAYOUT - SOCKETS                01004018
010050*----------------------------------------------------------------*01005018
010060     COPY PCWS254.                                                01006018
010070                                                                  01007018
010080*----------------------------------------------------------------*01008018
010090*  SML LABEL FORM LAYOUT                                         *01009018
010100*----------------------------------------------------------------*01010018
010110     COPY PCWS151.                                                01011018
010120                                                                  01012018
010130*----------------------------------------------------------------*01013018
010140*  SML LABEL DATA LAYOUT                                         *01014018
010150*----------------------------------------------------------------*01015018
010160     COPY PCWS152.                                                01016018
010170                                                                  01017018
010180*----------------------------------------------------------------*01018018
010190*  HDR LABEL FORM LAYOUT                                         *01019018
010200*----------------------------------------------------------------*01020018
010210     COPY PCWS153.                                                01021018
010220                                                                  01022018
010230*----------------------------------------------------------------*01023018
010240*  HDR LABEL DATA LAYOUT                                         *01024018
010250*----------------------------------------------------------------*01025018
010260     COPY PCWS154.                                                01026018
010270                                                                  01027018
010280*----------------------------------------------------------------*01028018
010290*  MISC LABEL FORM LAYOUT                                        *01029018
010300*----------------------------------------------------------------*01030018
010310     COPY PCWS164.                                                01031018
010320                                                                  01032018
010330*----------------------------------------------------------------*01033018
010340*  MISC LABEL DATA LAYOUT                                        *01034018
010350*----------------------------------------------------------------*01035018
010360     COPY PCWS165.                                                01036018
010370                                                                  01037018
010380*----------------------------------------------------------------*01038018
010390*  RACK LABEL FORM LAYOUT                                        *01039018
010400*----------------------------------------------------------------*01040018
010410     COPY PCWS167.                                                01041018
010420                                                                  01042018
010430*----------------------------------------------------------------*01043018
010440*  RACK LABEL DATA LAYOUT                                        *01044018
010450*----------------------------------------------------------------*01045018
010460     COPY PCWS168.                                                01046018
010470                                                                  01047018
010480*----------------------------------------------------------------*01048018
010490*  USER LABEL FORM LAYOUT                                        *01049018
010500*----------------------------------------------------------------*01050018
010510     COPY PCWS155.                                                01051018
010520                                                                  01052018
010530*----------------------------------------------------------------*01053018
010540*  USER LABEL DATA LAYOUT                                        *01054018
010550*----------------------------------------------------------------*01055018
010560     COPY PCWS156.                                                01056018
010570                                                                  01057018
010580*----------------------------------------------------------------*01058018
010590*  BLIND RECEIPT LABEL FORM LAYOUT                                01059018
010600*----------------------------------------------------------------*01060018
010610     COPY PCWS158.                                                01061018
010620                                                                  01062018
010630*----------------------------------------------------------------*01063018
010640*  BLIND RECEIPT LABEL DATA LAYOUT                                01064018
010650*----------------------------------------------------------------*01065018
010660     COPY PCWS189.                                                01066018
010670                                                                  01067018
010680*----------------------------------------------------------------*01068018
010690*  DEST LABEL - P2L LABEL                                        *01069018
010700*----------------------------------------------------------------*01070018
010710     COPY PCWS169.                                                01071018
010720                                                                  01072018
010730*----------------------------------------------------------------*01073018
010740*  TRAILER SERIAL # LABEL FORM LAYOUT                             01074018
010750*----------------------------------------------------------------*01075018
010760     COPY PCWS196.                                                01076018
010770                                                                  01077018
010780*----------------------------------------------------------------*01078018
010790*  TRAILER SERIAL # LABEL DATA LAYOUT                             01079018
010800*----------------------------------------------------------------*01080018
010810     COPY PCWS197.                                                01081018
010820                                                                  01082018
010830*----------------------------------------------------------------*01083018
010840*  RF SML LABEL FORM LAYOUT                                       01084018
010850*----------------------------------------------------------------*01085018
010860     COPY PCWS255.                                                01086018
010870                                                                  01087018
010880*----------------------------------------------------------------*01088018
010890*  RF SML LABEL DATA LAYOUT                                       01089018
010900*----------------------------------------------------------------*01090018
010910     COPY PCWS256.                                                01091018
010920                                                                  01092018
010930*----------------------------------------------------------------*01093018
010940*  CARTON LABEL FORM AND DATA LAYOUT                             *01094018
010950*----------------------------------------------------------------*01095018
010960     COPY PCWS157.                                                01096018
010970                                                                  01097018
010980*----------------------------------------------------------------*01098018
010990*    20 & 22 DIGIT BARCODE LAYOUT                                *01099018
011000*----------------------------------------------------------------*01100018
011010     COPY PCWS160.                                                01101018
011020                                                                  01102018
011030*----------------------------------------------------------------*01103018
011040*    STORE MANIFEST LAYOUT.                                      *01104018
011050*----------------------------------------------------------------*01105018
011060     COPY PCWS187.                                                01106018
011070                                                                  01107018
011080*----------------------------------------------------------------*01108018
011090*  MISC LABEL FORM LAYOUT -MESSAGE ONLY NO BARCODE               *01109018
011100*----------------------------------------------------------------*01110018
011110     COPY PCWS190.                                                01111018
011120                                                                  01112018
011130*----------------------------------------------------------------*01113018
011140*  MISC LABEL DATA LAYOUT - MESSAGE ONLY NO BARCODE              *01114018
011150*----------------------------------------------------------------*01115018
011160     COPY PCWS191.                                                01116018
011170                                                                  01117029
011180*----------------------------------------------------------------*01118018
011190*  COPYBOOK FOR CALLED MODULE TO RETURN business area id          01119018
011200*  VSM INTERFACE                                                  01120018
011210*----------------------------------------------------------------*01121018
011220     COPY XLWS073.                                                01122018
011230                                                                  01123029
011240*    DOMAIN ITEM MODULE                                           01124018
011250     COPY XLWS001.                                                01125018
011260                                                                  01126029
011270*----------------------------------------------------------------*01127018
011280*  COPYBOOK FOR CALLED MODULE TO RETURN THE STORE BALANCE ON HAND 01128018
011290*----------------------------------------------------------------*01129018
011300     COPY XLWS088.                                                01130018
011310                                                                  01131029
011320*---------------------------------------------------------------* 01132018
011330******************************************************************01133018
011340*  SENDING/RECEIVING AREA FOR THE NUMERIC EDIT ROUTINE (DPKUT100) 01134018
011350******************************************************************01135018
011360     COPY DPWS010I.                                               01136018
011370                                                                  01137018
011380******************************************************************01138018
011390*  DB2 CONTROL TABLE                                              01139018
011400******************************************************************01140018
011410     EXEC SQL                                                     01141018
011420          INCLUDE TCOCNTL                                         01142018
011430     END-EXEC.                                                    01143018
011440                                                                  01144018
011450*  PARM TABLE                                                     01145018
011460     EXEC SQL                                                     01146018
011470          INCLUDE TKRPRPM                                         01147018
011480     END-EXEC.                                                    01148018
011490                                                                  01149018
011500*  UPLOAD ERROR TABLE                                             01150018
011510     EXEC SQL                                                     01151018
011520          INCLUDE TUPLDER                                         01152018
011530     END-EXEC.                                                    01153018
011540                                                                  01154018
011550*----------------------------------------------------------------*01155018
011560*  DCLGEN LAYOUT AND COBOL DECLARATION  PROCESS MESSAGE CONTROL  *01156018
011570*  TABLE, SUT_PRC_MSG_CNTL                                       *01157018
011580*----------------------------------------------------------------*01158018
011590     EXEC SQL                                                     01159018
011600         INCLUDE SUT00094                                         01160018
011610     END-EXEC.                                                    01161018
011620                                                                  01162018
011630******************************************************************01163018
011640*  DB2 TABLE FOR STORE INFORMATION - XLT_LOC                      01164018
011650******************************************************************01165018
011660     EXEC SQL                                                     01166018
011670          INCLUDE XLT00010                                        01167018
011680     END-EXEC.                                                    01168018
011690                                                                  01169018
011700******************************************************************01170018
011710*  DB2 TABLE FOR STORE DC information xlt_dc_loc_asgmt            01171018
011720******************************************************************01172018
011730     EXEC SQL                                                     01173018
011740          INCLUDE XLT00014                                        01174018
011750     END-EXEC.                                                    01175018
011760                                                                  01176018
011770******************************************************************01177018
011780*  DB2 TABLE FOR LABEL TRACKING HISTORY                           01178018
011790******************************************************************01179018
011800     EXEC SQL                                                     01180018
011810          INCLUDE TLBTKHS                                         01181018
011820     END-EXEC.                                                    01182018
011830                                                                  01183018
011840******************************************************************01184018
011850*  DB2 TABLE FOR LABEL TRACKING INSTRUCTIONS                      01185018
011860******************************************************************01186018
011870     EXEC SQL                                                     01187018
011880          INCLUDE TLBTKIN                                         01188018
011890     END-EXEC.                                                    01189018
011900                                                                  01190018
011910******************************************************************01191018
011920*  DB2 TABLE FOR LABEL TRACKING ID LABELS                         01192018
011930******************************************************************01193018
011940     EXEC SQL                                                     01194018
011950          INCLUDE TLBTKID                                         01195018
011960     END-EXEC.                                                    01196018
011970                                                                  01197018
011980******************************************************************01198018
011990*  DB2 TABLE                                                      01199018
012000******************************************************************01200018
012010     EXEC SQL                                                     01201018
012020          INCLUDE TRECITM                                         01202018
012030     END-EXEC.                                                    01203018
012040                                                                  01204018
012050******************************************************************01205018
012060*  DB2 TABLE                                                      01206018
012070******************************************************************01207018
012080     EXEC SQL                                                     01208018
012090          INCLUDE TPURITM                                         01209018
012100     END-EXEC.                                                    01210018
012110                                                                  01211018
012120******************************************************************01212018
012130*  DB2 TABLE FOR OTBND CART UPC (SUT_OTBND_CART)                  01213018
012140******************************************************************01214018
012150     EXEC SQL                                                     01215018
012160          INCLUDE SUT00024                                        01216018
012170     END-EXEC.                                                    01217018
012180                                                                  01218018
012190******************************************************************01219018
012200*  DB2 TABLE FOR OTBND CART UPC (SUT_OTBND_UPC)                   01220018
012210******************************************************************01221018
012220     EXEC SQL                                                     01222018
012230          INCLUDE SUT00028                                        01223018
012240     END-EXEC.                                                    01224018
012250                                                                  01225018
012260******************************************************************01226018
012270*  DB2 TABLE UCC128 CROSS REF TABLE                               01227018
012280******************************************************************01228018
012290     EXEC SQL                                                     01229018
012300          INCLUDE TSULBXF                                         01230018
012310     END-EXEC.                                                    01231018
012320                                                                  01232018
012330******************************************************************01233018
012340*  DB2 TABLE PO AUDIT REQUEST TABLE (SUT_PO_AUD_REQ)              01234018
012350******************************************************************01235018
012360     EXEC SQL                                                     01236018
012370          INCLUDE SUT00015                                        01237018
012380     END-EXEC.                                                    01238018
012390                                                                  01239018
012400******************************************************************01240018
012410*  DB2 AREA FOR THE SHIPPING UNIT AUDIT TRANSACTION TABLE         01241018
012420******************************************************************01242018
012430     EXEC SQL                                                     01243018
012440          INCLUDE TSUATRN                                         01244018
012450     END-EXEC.                                                    01245018
012460******************************************************************01246018
012470** DB2 AREA FOR THE DC DOOR TABLE                                *01247018
012480******************************************************************01248018
012490     EXEC SQL                                                     01249018
012500          INCLUDE TCNDCDR                                         01250018
012510     END-EXEC.                                                    01251018
012520******************************************************************01252018
012530** DB2 AREA FOR THE DC DOOR TO STORE TABLE                       *01253018
012540******************************************************************01254018
012550     EXEC SQL                                                     01255018
012560          INCLUDE TCNDRST                                         01256018
012570     END-EXEC.                                                    01257018
012580                                                                  01258018
012600*----------------------------------------------------------------*01260018
012610* SKU TABLE (XLT_SKU)                                             01261018
012620*----------------------------------------------------------------*01262018
012630     EXEC SQL                                                     01263018
012640          INCLUDE XLT00003                                        01264018
012650     END-EXEC.                                                    01265018
012660                                                                  01266018
012670*----------------------------------------------------------------*01267018
012680* VENDOR STYLE TABLE (XLT_VND_STYL)                               01268018
012690*----------------------------------------------------------------*01269018
012700     EXEC SQL                                                     01270018
012710          INCLUDE XLT00004                                        01271018
012720     END-EXEC.                                                    01272018
012730                                                                  01273018
012740*================================================================*01274018
012750* BRAND TABLE (XLT_BRND)                                          01275018
012760*================================================================*01276018
012770     EXEC SQL                                                     01277018
012780          INCLUDE XLT00043                                        01278018
012790     END-EXEC.                                                    01279018
012810                                                                  01281018
012820*================================================================*01282018
012830* DISTRIBUTION HEADER  (TDISTHD)                                  01283018
012840*================================================================*01284018
012850     EXEC SQL                                                     01285018
012860          INCLUDE TDISTHD                                         01286018
012870     END-EXEC.                                                    01287018
012880                                                                  01288018
012890*---------------------------------------------------------------* 01289018
012900*    DB2 AREA FOR RECEIVER TABLE                                * 01290018
012910*---------------------------------------------------------------* 01291018
012920     EXEC SQL                                                     01292018
012930          INCLUDE TRECEIV                                         01293018
012940     END-EXEC.                                                    01294018
012950                                                                  01295018
012960*---------------------------------------------------------------* 01296018
012970*    wst_intgrtn_typ                                            * 01297029
012980*---------------------------------------------------------------* 01298018
012990     EXEC SQL                                                     01299018
013000          INCLUDE wst00008                                        01300018
013010     END-EXEC.                                                    01301018
013020                                                                  01302018
013030*---------------------------------------------------------------* 01303018
013040*    wst_attr_defn                                              * 01304029
013050*---------------------------------------------------------------* 01305018
013060     EXEC SQL                                                     01306018
013070          INCLUDE wst00009                                        01307018
013080     END-EXEC.                                                    01308018
013090                                                                  01309018
013100*---------------------------------------------------------------* 01310018
013110*    wst_attr_elem                                              * 01311029
013120*---------------------------------------------------------------* 01312018
013130     EXEC SQL                                                     01313018
013140          INCLUDE wst00010                                        01314018
013150     END-EXEC.                                                    01315018
013160                                                                  01316018
013170*----------------------------------------------------------------*01317018
013180*  COMMUNICATIONS AREA FOR DB2                                   *01318018
013190*----------------------------------------------------------------*01319018
013200     EXEC SQL                                                     01320018
013210         INCLUDE SQLCA                                            01321018
013220     END-EXEC.                                                    01322018
013230                                                                  01323018
013240*----------------------------------------------------------------*01324018
013250*    CURSOR FOR SELECTING ALL STORES OPEN FOR RECEIVING - SML     01325018
013260*----------------------------------------------------------------*01326018
013270     EXEC SQL                                                     01327018
013280         DECLARE  OPEN-SML-STR-CSR CURSOR WITH HOLD FOR           01328018
013290          SELECT  A.LOC_NBR                                       01329018
013300                , A.LOC_10_ABBR_NM                                01330018
013310            FROM  XLT_LOC A                                       01331018
013320                 ,XLT_DC_LOC_ASGMT B                              01332018
013330           WHERE  A.LOC_NBR        =  B.LOC_NBR                   01333018
013340             AND  A.LOC_TYP_CDE    =  'DS'                        01334018
013350             AND  CURRENT DATE     <  A.CLO_DTE                   01335018
013360             AND  (B.DC_NBR        =  :DK-OPER-UNT-ID-NUM-4 and   01336018
013370                   B.EFF_BEG_DTE  <=  CURRENT DATE AND            01337018
013380                   B.EFF_BEG_DTE  IN                              01338018
013390                   (SELECT MAX(C.EFF_BEG_DTE)                     01339018
013400                      FROM XLT_DC_LOC_ASGMT C                     01340018
013410                     WHERE C.EFF_BEG_DTE  <=  CURRENT DATE        01341018
013420                       AND C.LOC_NBR       = B.LOC_NBR))          01342018
013430        ORDER BY  A.LOC_NBR                                       01343018
013440        WITH UR                                                   01344018
013450     END-EXEC.                                                    01345018
013460                                                                  01346018
013470*----------------------------------------------------------------*01347018
013480*    CURSOR FOR SELECTING ALL STORES - p2l store order - sml      01348018
013490*    A - are defined in the P2LSTORORD Parm                       01349018
013500*    B - assigned to DC but no order set up for them              01350018
013510*----------------------------------------------------------------*01351018
013520     EXEC SQL                                                     01352018
013530         DECLARE  OPEN-SML-P2L-CSR CURSOR WITH HOLD FOR           01353018
013540          SELECT 'A'                                              01354018
013550               , G.ATTR_ELEM_NBR  AS SEQ_IN_MOD                   01355018
013560               , I.LOC_NBR                                        01356018
013570               , I.LOC_10_ABBR_NM                                 01357018
013580            FROM                                                  01358018
013581                 XLT_LOC          I                               01358132
013582               , XLT_DC_LOC_ASGMT J                               01358232
013590               , WST_INTGRTN_TYP  A                               01359032
013600               , WST_ATTR_DEFN    B                               01360018
013610               , WST_ATTR_ELEM    C                               01361018
013620               , WST_ATTR_ELEM    D                               01362018
013630               , WST_ATTR_ELEM    E                               01363018
013640               , WST_ATTR_ELEM    F                               01364018
013650               , WST_ATTR_ELEM    G                               01365018
013660               , WST_ATTR_ELEM    H                               01366018
013690           WHERE                                                  01369018
013700                 A.INTGRTN_TYP_CDE   = 'P2LSTORORD'               01370018
013710             AND A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE          01371018
013720             AND B.ATTR_DEFN_SEQ_NBR = 1                          01372018
013730             AND B.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE          01373018
013740             AND C.ATTR_DEFN_SEQ_NBR = 1                          01374018
013750             AND B.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE          01375018
013760             AND D.ATTR_DEFN_SEQ_NBR = 2                          01376018
013770             AND B.INTGRTN_TYP_CDE   = E.INTGRTN_TYP_CDE          01377018
013780             AND E.ATTR_DEFN_SEQ_NBR = 3                          01378018
013790             AND B.INTGRTN_TYP_CDE   = F.INTGRTN_TYP_CDE          01379018
013800             AND F.ATTR_DEFN_SEQ_NBR = 4                          01380018
013810             AND B.INTGRTN_TYP_CDE   = G.INTGRTN_TYP_CDE          01381018
013820             AND G.ATTR_DEFN_SEQ_NBR = 5                          01382018
013830             AND B.INTGRTN_TYP_CDE   = H.INTGRTN_TYP_CDE          01383018
013840             AND H.ATTR_DEFN_SEQ_NBR = 6                          01384018
013850             AND C.ATTR_ELEM_SEQ_NBR = D.ATTR_ELEM_SEQ_NBR        01385018
013860             AND C.ATTR_ELEM_SEQ_NBR = E.ATTR_ELEM_SEQ_NBR        01386018
013870             AND C.ATTR_ELEM_SEQ_NBR = F.ATTR_ELEM_SEQ_NBR        01387018
013880             AND C.ATTR_ELEM_SEQ_NBR = G.ATTR_ELEM_SEQ_NBR        01388018
013890             AND C.ATTR_ELEM_SEQ_NBR = H.ATTR_ELEM_SEQ_NBR        01389018
013900             AND C.ATTR_ELEM_NBR     = :DK-OPER-UNT-ID-NUM-4      01390018
013910             AND D.ATTR_ELEM_TXT     = 'AC'                       01391018
013920             AND E.ATTR_ELEM_TMST   <= CURRENT TIMESTAMP          01392018
013930             AND F.ATTR_ELEM_TMST   >= CURRENT TIMESTAMP          01393018
013940             AND h.ATTR_ELEM_NBR     = i.LOC_NBR                  01394018
013950             AND I.LOC_TYP_CDE       = 'DS'                       01395018
013960             AND I.CLO_DTE           >  CURRENT DATE              01396018
013970             AND I.LOC_NBR           = J.LOC_NBR                  01397018
013980             AND C.ATTR_ELEM_NBR     = J.DC_NBR                   01398018
013990             AND J.EFF_BEG_DTE      <= CURRENT DATE               01399018
014000             AND J.EFF_BEG_DTE IN                                 01400018
014010                 (SELECT MAX(K.EFF_BEG_DTE)                       01401018
014020                    FROM XLT_DC_LOC_ASGMT K                       01402018
014030                   WHERE K.EFF_BEG_DTE <= CURRENT DATE            01403018
014040                     AND K.LOC_NBR  =  J.LOC_NBR)                 01404018
014050          UNION                                                   01405018
014060          SELECT 'B'                                              01406018
014070               , 9999                                             01407018
014080               , P.LOC_NBR                                        01408018
014090               , P.LOC_10_ABBR_NM                                 01409018
014100            FROM XLT_LOC P                                        01410018
014110               , XLT_DC_LOC_ASGMT Q                               01411018
014120           WHERE P.LOC_NBR        =  Q.LOC_NBR                    01412018
014130             AND P.LOC_TYP_CDE    =  'DS'                         01413018
014140             AND P.CLO_DTE        >  CURRENT DATE                 01414018
014150             AND Q.DC_NBR         = :DK-OPER-UNT-ID-NUM-4         01415034
014170             AND Q.EFF_BEG_DTE  IN                                01417034
014180                 (SELECT MAX(R.EFF_BEG_DTE)                       01418018
014190                    FROM XLT_DC_LOC_ASGMT R                       01419018
014191                       , TKRPRPM SS                               01419134
014200                   WHERE SS.LOC_ID  = :DK-OPER-UNT-ID-NUM-4       01420034
014201                     AND SS.INTFC_SYS_CDE     = 'KHL'             01420134
014202                     AND SS.SYS_PRC_FUNC_CDE  = 'DCSTDY'          01420234
014203                     AND SS.FUNC_PRC_STAT_CDE = 'AC'              01420334
014204                     AND R.EFF_BEG_DTE  <= (CURRENT DATE          01420434
014205                                            + SS.FUNC_QTY DAYS)   01420534
014210                     AND R.LOC_NBR       = Q.LOC_NBR)             01421034
014220              AND NOT P.LOC_NBR IN                                01422034
014230               (SELECT                                            01423018
014240                        Z.ATTR_ELEM_NBR                           01424018
014250                  FROM                                            01425018
014251                       XLT_LOC  I                                 01425132
014252                     , XLT_DC_LOC_ASGMT J                         01425233
014260                     , WST_INTGRTN_TYP  S                         01426032
014270                     , WST_ATTR_DEFN    T                         01427018
014280                     , WST_ATTR_ELEM    U                         01428018
014290                     , WST_ATTR_ELEM    V                         01429018
014300                     , WST_ATTR_ELEM    W                         01430018
014310                     , WST_ATTR_ELEM    X                         01431018
014320                     , WST_ATTR_ELEM    Y                         01432018
014330                     , WST_ATTR_ELEM    Z                         01433018
014360                WHERE                                             01436018
014370                      S.INTGRTN_TYP_CDE   = 'P2LSTORORD'          01437018
014380                  AND S.INTGRTN_TYP_CDE   = T.INTGRTN_TYP_CDE     01438018
014390                  AND T.ATTR_DEFN_SEQ_NBR = 1                     01439018
014400                  AND T.INTGRTN_TYP_CDE   = U.INTGRTN_TYP_CDE     01440018
014410                  AND U.ATTR_DEFN_SEQ_NBR = 1                     01441018
014420                  AND T.INTGRTN_TYP_CDE   = V.INTGRTN_TYP_CDE     01442018
014430                  AND V.ATTR_DEFN_SEQ_NBR = 2                     01443018
014440                  AND T.INTGRTN_TYP_CDE   = W.INTGRTN_TYP_CDE     01444018
014450                  AND W.ATTR_DEFN_SEQ_NBR = 3                     01445018
014460                  AND T.INTGRTN_TYP_CDE   = X.INTGRTN_TYP_CDE     01446018
014470                  AND X.ATTR_DEFN_SEQ_NBR = 4                     01447018
014480                  AND T.INTGRTN_TYP_CDE   = Y.INTGRTN_TYP_CDE     01448018
014490                  AND Y.ATTR_DEFN_SEQ_NBR = 5                     01449018
014500                  AND T.INTGRTN_TYP_CDE   = Z.INTGRTN_TYP_CDE     01450018
014510                  AND Z.ATTR_DEFN_SEQ_NBR = 6                     01451018
014520                  AND U.ATTR_ELEM_SEQ_NBR = V.ATTR_ELEM_SEQ_NBR   01452018
014530                  AND U.ATTR_ELEM_SEQ_NBR = W.ATTR_ELEM_SEQ_NBR   01453018
014540                  AND U.ATTR_ELEM_SEQ_NBR = X.ATTR_ELEM_SEQ_NBR   01454018
014550                  AND U.ATTR_ELEM_SEQ_NBR = Y.ATTR_ELEM_SEQ_NBR   01455018
014560                  AND U.ATTR_ELEM_SEQ_NBR = Z.ATTR_ELEM_SEQ_NBR   01456018
014570                  AND U.ATTR_ELEM_NBR   = :DK-OPER-UNT-ID-NUM-4   01457018
014580                  AND V.ATTR_ELEM_TXT     = 'AC'                  01458018
014590                  AND W.ATTR_ELEM_TMST   <= CURRENT TIMESTAMP     01459018
014600                  AND X.ATTR_ELEM_TMST   >= CURRENT TIMESTAMP     01460018
014601                                                                  01460134
014602                  AND Z.ATTR_ELEM_NBR     = I.LOC_NBR             01460234
014603                  AND I.LOC_TYP_CDE       = 'DS'                  01460334
014604                  AND I.CLO_DTE           >  CURRENT DATE         01460434
014605                  AND I.LOC_NBR           = J.LOC_NBR             01460534
014606                  AND U.ATTR_ELEM_NBR     = J.DC_NBR              01460634
014607                  AND J.EFF_BEG_DTE      <= CURRENT DATE          01460734
014608                  AND J.EFF_BEG_DTE IN                            01460834
014609                      (SELECT MAX(KK.EFF_BEG_DTE)                 01460934
014610                         FROM XLT_DC_LOC_ASGMT KK                 01461034
014611                        WHERE KK.EFF_BEG_DTE <= CURRENT DATE      01461134
014612                          AND KK.LOC_NBR  =  J.LOC_NBR)           01461234
014613               )                                                  01461334
014620         ORDER BY 2,3                                             01462018
014630        WITH UR                                                   01463018
014640     END-EXEC.                                                    01464018
014650                                                                  01465018
014651*----------------------------------------------------------------*01465127
014652*    CURSOR FOR SELECTING ALL STORES - P2L SEPHORA store order    01465227
014653*      - are defined in the P2LSEPHORD Parm                       01465327
014655*----------------------------------------------------------------*01465527
014656     EXEC SQL                                                     01465627
014657         DECLARE  OPEN-P2L-SEPH-CSR CURSOR WITH HOLD FOR          01465727
014658          SELECT 'A'                                              01465827
014659               , G.ATTR_ELEM_NBR  AS SEQ_IN_MOD                   01465927
014660               , I.LOC_NBR                                        01466027
014661               , I.LOC_10_ABBR_NM                                 01466127
014662            FROM                                                  01466227
014663                 WST_INTGRTN_TYP  A                               01466327
014664               , WST_ATTR_DEFN    B                               01466427
014665               , WST_ATTR_ELEM    C                               01466527
014666               , WST_ATTR_ELEM    D                               01466627
014667               , WST_ATTR_ELEM    E                               01466727
014668               , WST_ATTR_ELEM    F                               01466827
014669               , WST_ATTR_ELEM    G                               01466927
014670               , WST_ATTR_ELEM    H                               01467027
014671               , XLT_LOC          I                               01467127
014673           WHERE                                                  01467327
014674                 A.INTGRTN_TYP_CDE   = 'P2LSEPHORD'               01467427
014675             AND A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE          01467527
014676             AND B.ATTR_DEFN_SEQ_NBR = 1                          01467627
014677             AND B.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE          01467727
014678             AND C.ATTR_DEFN_SEQ_NBR = 1                          01467827
014679             AND B.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE          01467927
014680             AND D.ATTR_DEFN_SEQ_NBR = 2                          01468027
014681             AND B.INTGRTN_TYP_CDE   = E.INTGRTN_TYP_CDE          01468127
014682             AND E.ATTR_DEFN_SEQ_NBR = 3                          01468227
014683             AND B.INTGRTN_TYP_CDE   = F.INTGRTN_TYP_CDE          01468327
014684             AND F.ATTR_DEFN_SEQ_NBR = 4                          01468427
014685             AND B.INTGRTN_TYP_CDE   = G.INTGRTN_TYP_CDE          01468527
014686             AND G.ATTR_DEFN_SEQ_NBR = 5                          01468627
014687             AND B.INTGRTN_TYP_CDE   = H.INTGRTN_TYP_CDE          01468727
014688             AND H.ATTR_DEFN_SEQ_NBR = 6                          01468827
014689             AND C.ATTR_ELEM_SEQ_NBR = D.ATTR_ELEM_SEQ_NBR        01468927
014690             AND C.ATTR_ELEM_SEQ_NBR = E.ATTR_ELEM_SEQ_NBR        01469027
014691             AND C.ATTR_ELEM_SEQ_NBR = F.ATTR_ELEM_SEQ_NBR        01469127
014692             AND C.ATTR_ELEM_SEQ_NBR = G.ATTR_ELEM_SEQ_NBR        01469227
014693             AND C.ATTR_ELEM_SEQ_NBR = H.ATTR_ELEM_SEQ_NBR        01469327
014694             AND C.ATTR_ELEM_NBR     = :DK-OPER-UNT-ID-NUM-4      01469427
014695             AND D.ATTR_ELEM_TXT     = 'AC'                       01469527
014696             AND E.ATTR_ELEM_TMST   <= CURRENT TIMESTAMP          01469627
014697             AND F.ATTR_ELEM_TMST   >= CURRENT TIMESTAMP          01469727
014698             AND h.ATTR_ELEM_NBR     = i.LOC_NBR                  01469827
014699             AND I.LOC_TYP_CDE       = 'DS'                       01469927
014700             AND I.CLO_DTE           >  CURRENT DATE              01470027
014766         ORDER BY 2,3                                             01476628
014767        WITH UR                                                   01476727
014768     END-EXEC.                                                    01476827
014769                                                                  01476927
014770*----------------------------------------------------------------*01477018
014771*    CURSOR FOR SELECTING ALL STORES - Shipping Door order        01477118
014772*    A - Stores only assigned to 1 shipping door  (door sequence) 01477218
014773*        -first part of the select brings back the stores that are01477318
014774*         currently assigned to the DC (tables a & b)             01477418
014775*        -the lowest subselect counts the number of shipping doors01477518
014776*         that the store is assigned - returning only the ones    01477618
014777*         that are assigned to 1 shipping door (tables G & H)     01477718
014778*        -the first subselect brings back just the store numbers  01477818
014779*         for the stores that are assigned to (table T1)          01477918
014780*        - then the first part of the select now selects the      01478018
014781*         doors for the stores that are only assigned at one      01478118
014782*         shipping door (table C & D)                             01478218
014790*    B - stores serviced by the dc - but are assigned to multiple 01479018
014800*        or no shipping doors (Store Sequence)                    01480018
014810*        -first part of the select brings back the stores that are01481018
014820*         currently assigned to the DC (tables L & M)             01482018
014830*        -the lowest subselect counts the number of shipping doors01483018
014840*         that the store is assigned - returning only the ones    01484018
014850*         that are assigned to 1 shipping door (tables O & P)     01485018
014860*        -the first subselect brings back just the store numbers  01486018
014870*         for the stores that are assigned to (table T2)          01487018
014880*        - then the first part of the select now selects the      01488018
014890*          the stores that are assigned to multiple doors or      01489018
014900*          no shipping doors at all (not in subselect that        01490018
014910*          has stores that are only at 1 door)                    01491018
014920*----------------------------------------------------------------*01492018
014930     EXEC SQL                                                     01493018
014940         DECLARE  OPEN-SML-DOOR-CSR cURSOR WITH HOLD FOR          01494018
014950          Select 'A'                                              01495018
014960               , a.LOC_NBR                                        01496018
014970               , a.LOC_10_ABBR_NM                                 01497018
014980               , c.DOOR_ID                                        01498018
014990               , d.DOOR_LBL_SEQ_NBR                               01499018
015000            from xlt_loc a                                        01500018
015010               , xlt_dc_loc_asgmt b                               01501018
015020               , tcndrst c                                        01502018
015030               , tcndcdr d                                        01503018
015040           where a.loc_nbr         =  b.loc_nbr                   01504018
015050             AND a.LOC_TYP_CDE     =  'DS'                        01505018
015060             AND a.CLO_DTE         >  current date                01506018
015070             and b.dc_NBR          = :DK-OPER-UNT-ID-NUM-4        01507018
015080             and b.EFF_BEG_DTE    <=  CURRENT DATE                01508018
015090             and b.EFF_BEG_DTE    IN                              01509018
015100                 (SELECT MAX(j.EFF_BEG_DTE)                       01510018
015110                    FROM XLT_DC_LOC_ASGMT j                       01511018
015120                   WHERE j.EFF_BEG_DTE  <=  CURRENT DATE          01512018
015130                     and j.LOC_NBR       = b.LOC_NBR)             01513018
015140             and a.loc_nbr         =  c.str_nbr                   01514018
015150             and b.dc_nbr          =  c.oper_unt_id               01515018
015160             and c.OPER_UNT_ID     =  d.oper_unt_id               01516018
015170             and c.door_id         =  d.door_id                   01517018
015180             and c.STRT_TMST      <=  current timestamp           01518018
015190             and c.END_TMST       >=  current timestamp           01519018
015200             AND d.DOOR_LOC_DESC NOT LIKE '%RE-OPEN%'             01520018
015210             AND d.DOOR_LOC_DESC NOT LIKE '%UPS%'                 01521018
015220             AND d.DOOR_LOC_DESC NOT LIKE '%VIRTUAL%'             01522018
015230             AND C.STR_NBR  IN                                    01523018
015240                 (SELECT t1.STR_NBR                               01524018
015250                    FROM                                          01525018
015260                     (Select                                      01526018
015270                             G.str_nbr                            01527018
015280                           , count(*)  as  door_count             01528018
015290                        from tcndrst g                            01529018
015300                           , tcndcdr h                            01530018
015310                       where g.OPER_UNT_ID =                      01531018
015320                                          :DK-OPER-UNT-ID-NUM-4   01532018
015330                         and g.OPER_UNT_ID = h.oper_unt_id        01533018
015340                         and g.door_id     =  h.door_id           01534018
015350                         and g.STRT_TMST  <=  current timestamp   01535018
015360                         and g.END_TMST   >=  current timestamp   01536018
015370                         AND h.DOOR_LOC_DESC NOT LIKE '%RE-OPEN%' 01537018
015380                         AND h.DOOR_LOC_DESC NOT LIKE '%UPS%'     01538018
015390                         AND h.DOOR_LOC_DESC NOT LIKE '%VIRTUAL%' 01539018
015400                       group by g.str_nbr                         01540018
015410                       having count(*) = 1                        01541018
015420                     ) AS T1                                      01542018
015430                 )                                                01543018
015440           union                                                  01544018
015450          Select 'B'                                              01545018
015460               , L.LOC_NBR                                        01546018
015470               , L.LOC_10_ABBR_NM                                 01547018
015480               , ' '                                              01548018
015490               , 9999                                             01549018
015500            FROM XLT_LOC L                                        01550018
015510               , XLT_DC_LOC_ASGMT M                               01551018
015520           WHERE  L.LOC_NBR        =  M.LOC_NBR                   01552018
015530             AND  L.LOC_TYP_CDE    =  'DS'                        01553018
015540             AND  L.CLO_DTE        >  current date                01554018
015550             AND  M.DC_NBR         = :DK-OPER-UNT-ID-NUM-4        01555018
015560             and  M.EFF_BEG_DTE   <=  CURRENT DATE                01556018
015570             and  M.EFF_BEG_DTE   IN                              01557018
015580                  (SELECT MAX(N.EFF_BEG_DTE)                      01558018
015590                     FROM XLT_DC_LOC_ASGMT N                      01559018
015600                     WHERE N.EFF_BEG_DTE  <=  CURRENT DATE        01560018
015610                       anD N.LOC_NBR       = L.LOC_NBR)           01561018
015620             AND NOT L.LOC_NBR  IN                                01562018
015630                 (SELECT t2.STR_NBR                               01563018
015640                    FROM                                          01564018
015650                     (Select                                      01565018
015660                             O.str_nbr                            01566018
015670                           , count(*)  as  door_count             01567018
015680                        from tcndrst O                            01568018
015690                           , tcndcdr P                            01569018
015700                       where O.OPER_UNT_ID =                      01570018
015710                                          :DK-OPER-UNT-ID-NUM-4   01571018
015720                         and O.OPER_UNT_ID = P.oper_unt_id        01572018
015730                         and O.door_id     = P.door_id            01573018
015740                         and O.STRT_TMST  <= current timestamp    01574018
015750                         and O.END_TMST   >= current timestamp    01575018
015760                         AND P.DOOR_LOC_DESC NOT LIKE '%RE-OPEN%' 01576018
015770                         AND P.DOOR_LOC_DESC NOT LIKE '%UPS%'     01577018
015780                         AND P.DOOR_LOC_DESC NOT LIKE '%VIRTUAL%' 01578018
015790                       group by O.str_nbr                         01579018
015800                       having count(*) = 1                        01580018
015810                     ) AS T2                                      01581018
015820                 )                                                01582018
015830           ORDER BY 1,5,2                                         01583018
015840     END-EXEC.                                                    01584018
015850                                                                  01585018
015860                                                                  01586018
015870*---------------------------------------------------------------* 01587018
015880*  CURSOR TO DETERMINE MERCHANDISE PRESENTATION                 * 01588018
015890*  HANG, FOLD OR MIXED                                          * 01589018
015900*---------------------------------------------------------------* 01590018
015910     EXEC SQL                                                     01591018
015920          DECLARE HANG_FOLD_CSR CURSOR FOR                        01592018
015930           SELECT DISTINCT(A.UPC_NBR)                             01593018
015940           FROM SUT_OTBND_UPC A                                   01594018
015950           WHERE A.SHIPT_UNT_ID = :SUT00028-SHIPT-UNT-ID          01595018
015960     END-EXEC.                                                    01596018
015970******************************************************************01597018
015980 LINKAGE SECTION.                                                 01598018
015990******************************************************************01599018
016000 01  DFHCOMMAREA                         PIC  X(400).             01600018
016010                                                                  01601018
016020******************************************************************01602018
016030 PROCEDURE DIVISION.                                              01603018
016040******************************************************************01604018
016050 0000-PROGRAM-MAINLINE.                                           01605018
016060     MOVE DFHCOMMAREA                TO PC140-LABELMST.           01606018
016070                                                                  01607018
016080     PERFORM 0010-STARTUP.                                        01608018
016090                                                                  01609018
016100     PERFORM 0100-GET-CURRENT-DATE.                               01610018
016110                                                                  01611018
016120     IF PV-DONE-PROCESSING                                        01612018
016130         PERFORM 0750-RETURN                                      01613018
016140     ELSE                                                         01614018
016150         PERFORM 0500-HOUSEKEEPING                                01615018
016160     END-IF.                                                      01616018
016170                                                                  01617018
016180     IF PV-DONE-PROCESSING                                        01618018
016190         PERFORM 0750-RETURN                                      01619018
016200     ELSE                                                         01620018
016210         PERFORM 0600-INSERT-TLBTKHS                              01621018
016220         IF (PC140-CRA-SPC-INSTR       OR                         01622018
016230             PC140-COMMON-MISC-LBL-NBR OR                         01623018
016240             PC140-COMMON-MISC-LBL-MSG)                           01624018
016250                                 AND NOT PV-DONE-PROCESSING       01625018
016260             PERFORM 0650-INSERT-TLBTKIN                          01626018
016270         END-IF                                                   01627018
016280         IF  PC140-COMMON-HDR-LBL-NBR  OR                         01628018
016290             PC140-COMMON-CART-LBL-NBR                            01629018
016300             PERFORM 0675-INSERT-TLBTKID                          01630018
016310         END-IF                                                   01631018
016320     END-IF.                                                      01632018
016330                                                                  01633018
016340     IF PV-DONE-PROCESSING                                        01634018
016350         PERFORM 0750-RETURN                                      01635018
016360     ELSE                                                         01636018
016370         PERFORM 1000-MAIN-PROCESS                                01637018
016380     END-IF.                                                      01638018
016390                                                                  01639018
016400     IF PV-DONE-PROCESSING                                        01640018
016410         PERFORM 0750-RETURN                                      01641018
016420     END-IF.                                                      01642018
016430                                                                  01643018
016440     IF  PC140-COMMON-MFST-LBL-NBR  AND                           01644018
016450         PC140-ALL-STORES           AND                           01645018
016460         PV-LABEL-BREAK-QTY  >  0                                 01646018
016470         PERFORM 4100-SML-MFST-LABEL-ROUTINE                      01647018
016480     ELSE                                                         01648018
016490         PERFORM 4000-LABEL-ROUTINE                               01649018
016500     END-IF.                                                      01650018
016510                                                                  01651018
016520     IF NOT PC133-SEND-SUCCESSFUL                                 01652018
016530         PERFORM 0700-GET-XREF-CODE                               01653018
016540           VARYING PC138-IDX FROM 1 BY 1                          01654018
016550             UNTIL PC138-IDX > PC138-XREF-MAX-ENTRIES             01655018
016560               OR PS-XREF-DONE                                    01656018
016570         PERFORM 0710-UPDATE-TLBTKHS                              01657018
016580     END-IF.                                                      01658018
016590                                                                  01659018
016600     PERFORM 0750-RETURN.                                         01660018
016610                                                                  01661018
016620 0010-STARTUP.                                                    01662018
016640                                                                  01664029
016650     MOVE EIBTASKN                    TO PV-TASK                  01665018
016660     INITIALIZE PT-MSG-TABLE.                                     01666018
016670     MOVE 1                           TO PT-MSG-SEQ (PT-MSG-IDX). 01667018
016680     SET PT-MSG-IDX UP BY 1                                       01668018
016690     PERFORM 0011-GET-SYSTEM-TIMESTAMP                            01669018
016700     STRING ' PCKCS707 STARTED - TASK = ' PV-TASK-X               01670018
016710         '  '  PV-DISP-SYSTEM-TMST                                01671018
016720         '  ' 'CALLED BY= ' EIBTRNID '    '                       01672018
016730         DELIMITED BY SIZE INTO PV-CICS-MSG-AREA                  01673018
016750     PERFORM 9990-WRITE-CICS                                      01675018
016760                                                                  01676018
016770     MOVE SPACES                      TO PV-CICS-MSG-AREA         01677018
016800                                                                  01680018
016810     MOVE PC140-LABEL-FORMAT-NBR      TO DK-WORK-LABEL-NBR        01681018
016820     MOVE PC140-CRA-OPER-UNT-ID       TO KRPRPM-LOC-ID            01682018
016830     PERFORM 7100-SELECT-TKRPRPM.                                 01683018
016840                                                                  01684018
016850     MOVE PC140-CRA-OPER-UNT-ID  TO  PV-DISP-DC                   01685018
016860                                                                  01686018
016870     STRING ' PS-SHOW-DEBUG-SW= ' PS-SHOW-DEBUG-SW                01687018
016880            ' - ' PV-DISP-DC                                      01688018
016890            ' - ' PC140-LABEL-FORMAT-NBR                          01689018
016900         DELIMITED BY SIZE INTO PV-CICS-MSG-AREA                  01690018
016910     PERFORM 9990-WRITE-CICS.                                     01691018
016920                                                                  01692018
016930* RESERVE THE LOG QUEUE FOR THE EXCLUSIVE USE OF THIS TRANSACTION 01693018
016940* TO KEEP OTHER TRANSACTIONS FROM INTERUPTING THE DISPLAY.        01694018
016950* THIS IS DONE ONLY IF THE DEBUGGING FLAG FOR THE DC IS           01695018
016960* SWITCHED ON.  IF AN ERROR OCCURS WHEN THE FLAG IS OFF,          01696018
016970* WE WILL ENQ THE LOG BEFORE DUMPING THE MESSAGE TABLE.           01697018
016980                                                                  01698018
016990     IF PS-SHOW-DEBUG-INFO                                        01699018
017000         EXEC CICS ENQ                                            01700018
017010             RESOURCE(PC-CSSL)                                    01701018
017020         END-EXEC                                                 01702018
017030     END-IF.                                                      01703018
017040                                                                  01704018
017050     PERFORM 0025-GET-SOCKET-TIMEOUT.                             01705018
017060                                                                  01706018
017070                                                                  01707018
017080 0011-GET-SYSTEM-TIMESTAMP.                                       01708018
017090     EXEC SQL                                                     01709018
017100         SELECT                                                   01710018
017110             CURRENT TIMESTAMP                                    01711018
017120         INTO :PV-DISP-SYSTEM-TMST                                01712018
017130         FROM SYSIBM.SYSDUMMY1                                    01713018
017140     END-EXEC.                                                    01714018
017150                                                                  01715018
017160                                                                  01716018
017170*----------------------------------------------------------------*01717018
017180* SELECT SOCKET TIMEOUT FROM PARAMETER DATABASE                  *01718018
017190* DMH - 10/06/04 - BEGIN                                          01719018
017200*----------------------------------------------------------------*01720018
017210 0025-GET-SOCKET-TIMEOUT.                                         01721018
017220                                                                  01722018
017230     EXEC SQL                                                     01723018
017240          SELECT  FUNC_QTY                                        01724018
017250            INTO :KRPRPM-FUNC-QTY                                 01725018
017260            FROM  TKRPRPM                                         01726018
017270           WHERE  LOC_ID            =  90                         01727018
017280             AND  SYS_PRC_FUNC_CDE  = 'SCKTM3'                    01728018
017290             AND  FUNC_PRC_STAT_CDE = 'AC'                        01729018
017300             AND  INTFC_SYS_CDE     = 'KHL'                       01730018
017310     END-EXEC.                                                    01731018
017320                                                                  01732018
017330     EVALUATE TRUE                                                01733018
017340                                                                  01734018
017350         WHEN SQLCODE = +0                                        01735018
017360              MOVE KRPRPM-FUNC-QTY  TO  SELECT-SECS               01736018
017370                                                                  01737018
017380         WHEN SQLCODE = +100                                      01738018
017390              CONTINUE                                            01739018
017400                                                                  01740018
017410         WHEN SQLCODE = -811                                      01741018
017420         WHEN SQLCODE = -904                                      01742018
017430         WHEN SQLCODE = -913                                      01743018
017440             MOVE 'TKRPRPM'           TO PV-DISP-TABLE-1          01744018
017450             PERFORM 9955-SQL-ERROR                               01745018
017460             SET  PS-SOCKET-ERROR         TO TRUE                 01746018
017470             SET  PC140-CRA-SOCKET-COMM-ERROR  TO TRUE            01747018
017480             SET PS-DUMP-TO-LOG       TO TRUE                     01748018
017490             PERFORM 9990-WRITE-CICS                              01749018
017500                                                                  01750018
017510         WHEN SQLWARN0 NOT = SPACES                               01751018
017520         WHEN SQLCODE < +0                                        01752018
017530         WHEN SQLCODE > +0                                        01753018
017540             MOVE 'TKRPRPM'           TO PV-DISP-TABLE-1          01754018
017550             PERFORM 9955-SQL-ERROR                               01755018
017560     END-EVALUATE.                                                01756018
017580                                                                  01758018
017590                                                                  01759029
017600*-----------------------------------------------------------------01760018
017610*  GET CURRENT DATE TO PRINT ON LABEL                             01761018
017620*-----------------------------------------------------------------01762018
017630 0100-GET-CURRENT-DATE.                                           01763018
017640                                                                  01764018
017650     EXEC SQL                                                     01765018
017660         SELECT  CURRENT DATE                                     01766018
017670                ,CURRENT TIME                                     01767018
017680           INTO  :PV-CURRENT-DB2-DATE                             01768018
017690                ,:PV-CURRENT-DB2-TIME                             01769018
017700           FROM  TCOCNTL                                          01770018
017710          WHERE  OPER_UNT_ID = 90                                 01771018
017720     END-EXEC.                                                    01772018
017730                                                                  01773018
017740     EVALUATE TRUE                                                01774018
017750         WHEN SQLCODE = ZERO                                      01775018
017760              MOVE  PV-CURRENT-MM  TO  PV-LBL-PRT-MM              01776018
017770              MOVE  PV-CURRENT-DD  TO  PV-LBL-PRT-DD              01777018
017780              MOVE  PV-CURRENT-YY  TO  PV-LBL-PRT-YY              01778018
017790              MOVE  PV-CURRENT-HR  TO  PV-LBL-PRT-HR              01779018
017800              MOVE  PV-CURRENT-MN  TO  PV-LBL-PRT-MN              01780018
017810                                                                  01781018
017820         WHEN OTHER                                               01782018
017830             SET PV-DONE-PROCESSING          TO TRUE              01783018
017840             SET PC140-CRA-SOCKET-COMM-ERROR TO TRUE              01784018
017850             MOVE SQLCODE                    TO PV-SQL-CODE       01785018
017860             STRING ' PCKCS707 - '          DELIMITED BY SIZE     01786018
017870                    '0100-GET-CURRENT-DATE' DELIMITED BY SIZE     01787018
017880                    ' SQL ERROR = '         DELIMITED BY SIZE     01788018
017890                    PV-SQL-CODE             DELIMITED BY SIZE     01789018
017900                                       INTO PV-CICS-MSG-AREA      01790018
017910             SET PS-DUMP-TO-LOG       TO TRUE                     01791018
017920             PERFORM 9990-WRITE-CICS                              01792018
017930      END-EVALUATE.                                               01793018
017940                                                                  01794018
017950*-----------------------------------------------------------------01795018
017960*  HOUSEKEEPING ROUTINE                                           01796018
017970*-----------------------------------------------------------------01797018
017980 0500-HOUSEKEEPING.                                               01798018
017990     STRING                                                       01799018
018000            ' 0500-HOUSEKEEPING'                                  01800018
018010     DELIMITED BY SIZE                                            01801018
018020     INTO PV-CICS-MSG-AREA                                        01802018
018030     PERFORM 9990-WRITE-CICS                                      01803018
018040                                                                  01804018
018050     MOVE SPACES                  TO PC140-CRA-RET-MSG.           01805018
018060     SET  PC140-CRA-SUCCESSFUL    TO TRUE.                        01806018
018070                                                                  01807018
018080     PERFORM 4370-CREATE-TRANS-ID.                                01808018
018090                                                                  01809018
018100     IF  PS-INVALID-INPUT                                         01810018
018110         SET PV-DONE-PROCESSING      TO TRUE                      01811018
018120         SET PC140-CRA-SOCKET-COMM-ERROR TO TRUE                  01812018
018130     END-IF.                                                      01813018
018140                                                                  01814018
018150     MOVE PC140-CRA-USERID           TO LBTKHS-CRED-BY-USR-ID.    01815018
018160     MOVE PC140-CRA-OPER-UNT-ID      TO LBTKHS-PRTR-OPER-UNT-ID.  01816018
018170     MOVE PC140-CRA-FACLTY-ID        TO LBTKHS-PRTR-FCLTY-ID.     01817018
018180     MOVE PC140-CRA-LOC-ID           TO LBTKHS-LOC-ID.            01818018
018190                                                                  01819018
018200     IF  PC140-COMMON-MFST-LBL-NBR                                01820018
018210         MOVE PC140-SML-PRTR-ID      TO LBTKHS-PRTR-ID            01821018
018220         IF  PC140-ALL-STORES                                     01822018
018230             MOVE PC-SMD             TO lBTKHS-LBL-TYP-CDE        01823018
018240             PERFORM 0520-COUNT-SML-ALL                           01824018
018250             PERFORM 0550-GET-LABEL-BREAK                         01825018
018260             MOVE PV-DC-SML-COUNT-EXTENDED                        01826018
018270                                     TO LBTKHS-LBL-PRT-QTY        01827018
018280         ELSE                                                     01828018
018290             MOVE PC-SMS             TO LBTKHS-LBL-TYP-CDE        01829018
018300             MOVE PC140-SML-TOT-CART TO LBTKHS-LBL-PRT-QTY        01830018
018310         END-IF                                                   01831018
018320     ELSE                                                         01832018
018330     IF PC140-COMMON-USERID-LBL-NBR                               01833018
018340        MOVE PC140-UL-PRTR-ID        TO LBTKHS-PRTR-ID            01834018
018350        MOVE PC-UID                  TO LBTKHS-LBL-TYP-CDE        01835018
018360        MOVE PC140-UL-USERID         TO LBTKHS-USR-LBL-ID-TEXT    01836018
018370        MOVE PC-8                    TO LBTKHS-USR-LBL-ID-LEN     01837018
018380        MOVE 1                       TO PC156-USR-TOT-LBL         01838018
018390        MOVE PC156-USR-TOT-LBL       TO LBTKHS-LBL-PRT-QTY        01839018
018400     ELSE                                                         01840018
018410     IF PC140-COMMON-HDR-LBL-NBR                                  01841018
018420        MOVE PC140-HL-PRTR-ID        TO LBTKHS-PRTR-ID            01842018
018430        MOVE PC-HDR                  TO LBTKHS-LBL-TYP-CDE        01843018
018440        MOVE 2                       TO LBTKHS-LBL-PRT-QTY        01844018
018450        MOVE PC-HDR                  TO LBTKID-LBL-TYP-CDE        01845018
018460        MOVE PC140-HL-PO-NBR         TO LBTKID-PO-NBR             01846018
018470        MOVE PC140-HL-RCVR-SEQ-NBR-TX TO LBTKID-RCVR-SEQ-NBR      01847018
018480        MOVE PC140-HL-TRIP-ID        TO LBTKID-TRIP-ID            01848018
018490        MOVE 2                       TO LBTKID-LBL-PRT-QTY        01849018
018500     ELSE                                                         01850018
018510     IF PC140-COMMON-CART-LBL-NBR                                 01851018
018520        MOVE PC140-CL-PRTR-ID        TO LBTKHS-PRTR-ID            01852018
018530        MOVE PC-CRT                  TO LBTKHS-LBL-TYP-CDE        01853018
018540        MOVE PC140-CL-TOT-LBLS       TO LBTKHS-LBL-PRT-QTY        01854018
018550        MOVE PC-CRT                  TO LBTKID-LBL-TYP-CDE        01855018
018560        MOVE PC140-CL-PO-NBR         TO LBTKID-PO-NBR             01856018
018570        MOVE PC140-CL-RCVR-SEQ-NBR   TO LBTKID-RCVR-SEQ-NBR       01857018
018580        MOVE PC140-CL-PO-LINE-NBR    TO LBTKID-PO-LNE-NBR         01858018
018590        MOVE PC140-CL-TOT-LBLS       TO LBTKID-LBL-PRT-QTY        01859018
018600     ELSE                                                         01860018
018610     IF PC140-COMMON-MISC-LBL-NBR OR                              01861018
018620         PC140-COMMON-MISC-LBL-MSG                                01862018
018630        MOVE PC140-ML-PRTR-ID        TO LBTKHS-PRTR-ID            01863018
018640        MOVE PC-MSC                  TO LBTKHS-LBL-TYP-CDE        01864018
018650        MOVE PC140-ML-TOT-LBLS       TO LBTKHS-LBL-PRT-QTY        01865018
018660        MOVE PC-PCKCS717             TO LBTKHS-REQ-PGM-NM         01866018
018670        MOVE PC-S                    TO LBTKHS-XMIT-INTFC-CDE     01867018
018680        MOVE PC140-ML-START-LABEL-ID TO LBTKHS-RDM-STK-LOC-ID     01868018
018690     ELSE                                                         01869018
018700     IF PC140-BLIND-RECEIPT-LBL-NBR                               01870018
018710        MOVE PC140-BR-PRTR-ID        TO LBTKHS-PRTR-ID            01871018
018720        MOVE PC-BRC                  TO LBTKHS-LBL-TYP-CDE        01872018
018730        MOVE PC140-BR-USERID         TO LBTKHS-USR-LBL-ID-TEXT    01873018
018740                                        LBTKHS-CRED-BY-USR-ID     01874018
018750        MOVE PC-8                    TO LBTKHS-USR-LBL-ID-LEN     01875018
018760        MOVE 1                       TO PC156-USR-TOT-LBL         01876018
018770        MOVE PC156-USR-TOT-LBL       TO LBTKHS-LBL-PRT-QTY        01877018
018780        MOVE PC140-CURR-OPER-UNT-ID  TO LBTKHS-PRTR-OPER-UNT-ID   01878018
018790        MOVE PC140-CURR-FCLTY-ID     TO LBTKHS-PRTR-FCLTY-ID      01879018
018800        MOVE PC140-CS-EC-LOC-N       TO LBTKHS-LOC-ID             01880018
018810     ELSE                                                         01881018
018820     IF PC140-TRAILER-SERIAL-LBL-NBR                              01882018
018830        MOVE PC140-TSN-PRTR-ID        TO LBTKHS-PRTR-ID           01883018
018840        MOVE PC-SRL                   TO LBTKHS-LBL-TYP-CDE       01884018
018850        MOVE PC140-TSN-USERID         TO LBTKHS-USR-LBL-ID-TEXT   01885018
018860                                         LBTKHS-CRED-BY-USR-ID    01886018
018870        MOVE PC-8                     TO LBTKHS-USR-LBL-ID-LEN    01887018
018880        MOVE 1                        TO PC156-USR-TOT-LBL        01888018
018890        MOVE PC156-USR-TOT-LBL        TO LBTKHS-LBL-PRT-QTY       01889018
018900     ELSE                                                         01890018
018910     IF PC140-RF-CRTN-STAT-APPL                                   01891018
018920        MOVE PC140-RF-PRTR-ID        TO LBTKHS-PRTR-ID            01892018
018930        MOVE PC140-RF-LBL-FORMAT     TO LBTKHS-LBL-TYP-CDE        01893018
018940        MOVE PC140-RF-USERID         TO LBTKHS-USR-LBL-ID-TEXT    01894018
018950                                        LBTKHS-CRED-BY-USR-ID     01895018
018960        MOVE PC-8                    TO LBTKHS-USR-LBL-ID-LEN     01896018
018970        MOVE 1                       TO PC156-USR-TOT-LBL         01897018
018980        MOVE PC156-USR-TOT-LBL       TO LBTKHS-LBL-PRT-QTY        01898018
018990        MOVE PC140-RF-STR-NBR        TO LBTKHS-PRTR-OPER-UNT-ID   01899018
019000        MOVE 1                       TO LBTKHS-PRTR-FCLTY-ID      01900018
019010     END-IF.                                                      01901018
019020                                                                  01902018
019030     IF (PC140-CRA-SPC-INSTR OR                                   01903018
019040          PC140-COMMON-MISC-LBL-NBR OR                            01904018
019050          PC140-COMMON-MISC-LBL-MSG)                              01905018
019060         IF  PC140-COMMON-MFST-LBL-NBR                            01906018
019070             MOVE PC140-SML-ZNE-LINE-1                            01907018
019080                                 TO LBTKIN-LBL-1ST-LNE-TXT-TEXT   01908018
019090             MOVE PC-17-SIGNED                                    01909018
019100                                 TO LBTKIN-LBL-1ST-LNE-TXT-LEN    01910018
019110             MOVE PC140-SML-ZNE-LINE-2                            01911018
019120                                 TO LBTKIN-LBL-2ND-LNE-TXT-TEXT   01912018
019130             MOVE PC-17-SIGNED                                    01913018
019140                                 TO LBTKIN-LBL-2ND-LNE-TXT-LEN    01914018
019150             MOVE PC140-SML-ZNE-LINE-3                            01915018
019160                                 TO LBTKIN-LBL-3RD-LNE-TXT-TEXT   01916018
019170             MOVE PC-17-SIGNED                                    01917018
019180                                 TO LBTKIN-LBL-3RD-LNE-TXT-LEN    01918018
019190         ELSE                                                     01919018
019200         IF  PC140-COMMON-HDR-LBL-NBR                             01920018
019210             MOVE PC140-HL-SPECIAL-TX                             01921018
019220                                 TO LBTKIN-LBL-1ST-LNE-TXT-TEXT   01922018
019230             MOVE PC-25                                           01923018
019240                                 TO LBTKIN-LBL-1ST-LNE-TXT-LEN    01924018
019250             MOVE SPACES                                          01925018
019260                                 TO LBTKIN-LBL-2ND-LNE-TXT-TEXT   01926018
019270             MOVE PC-1                                            01927018
019280                                 TO LBTKIN-LBL-2ND-LNE-TXT-LEN    01928018
019290             MOVE SPACES                                          01929018
019300                                 TO LBTKIN-LBL-3RD-LNE-TXT-TEXT   01930018
019310             MOVE PC-1                                            01931018
019320                                 TO LBTKIN-LBL-3RD-LNE-TXT-LEN    01932018
019330         ELSE                                                     01933018
019340         IF  PC140-COMMON-MISC-LBL-NBR OR                         01934018
019350               PC140-COMMON-MISC-LBL-MSG                          01935018
019360             MOVE PC-25          TO LBTKIN-LBL-1ST-LNE-TXT-LEN    01936018
019370             MOVE PC140-ML-DESC1 TO LBTKIN-LBL-1ST-LNE-TXT-TEXT   01937018
019380             MOVE PC-25          TO LBTKIN-LBL-2ND-LNE-TXT-LEN    01938018
019390             MOVE PC140-ML-DESC2 TO LBTKIN-LBL-2ND-LNE-TXT-TEXT   01939018
019400             MOVE PC-25          TO LBTKIN-LBL-3RD-LNE-TXT-LEN    01940018
019410             MOVE PC140-ML-DESC3 TO LBTKIN-LBL-3RD-LNE-TXT-TEXT   01941018
019420         END-IF                                                   01942018
019430     END-IF.                                                      01943018
019440                                                                  01944018
019450                                                                  01945018
019460*----------------------------------------------------------------*01946018
019470* DETERMINE NUMBER OF LABELS TO BE GENERATED FOR SML "ALL" OPTION*01947018
019480*----------------------------------------------------------------*01948018
019490 0520-COUNT-SML-ALL.                                              01949018
019500                                                                  01950018
019510     STRING                                                       01951018
019520            ' 0520-COUNT-SML-ALL'                                 01952018
019530     DELIMITED BY SIZE                                            01953018
019540     INTO PV-CICS-MSG-AREA                                        01954018
019550     PERFORM 9990-WRITE-CICS                                      01955018
019560                                                                  01956018
019570     MOVE  ZEROES               TO PV-DC-SML-COUNT                01957018
019580                                   PV-DC-SML-COUNT-EXTENDED.      01958018
019590     MOVE PC140-CRA-LOC-ID      TO DK-OPER-UNT-ID-NUM-4.          01959018
019600                                                                  01960018
019610     EXEC SQL                                                     01961018
019620         SELECT COUNT(*)                                          01962018
019630           INTO :PV-DC-SML-COUNT                                  01963018
019640            FROM  XLT_LOC A                                       01964018
019650                 ,XLT_DC_LOC_ASGMT B                              01965018
019660           WHERE  A.LOC_TYP_CDE IN ('DS', 'DC', 'CS', 'RV')       01966018
019670             AND  CURRENT DATE     <  A.CLO_DTE                   01967018
019680             AND  (B.DC_NBR        = :DK-OPER-UNT-ID-NUM-4 AND    01968018
019690                   B.EFF_BEG_DTE  <=  CURRENT DATE AND            01969018
019700                   B.EFF_BEG_DTE  IN                              01970018
019710                   (SELECT MAX(C.EFF_BEG_DTE)                     01971018
019720                      FROM XLT_DC_LOC_ASGMT C                     01972018
019730                     WHERE C.EFF_BEG_DTE  <=  CURRENT DATE        01973018
019740                       AND C.LOC_NBR       = B.LOC_NBR))          01974018
019750     END-EXEC                                                     01975018
019760                                                                  01976018
019770     EVALUATE TRUE                                                01977018
019780         WHEN SQLCODE = +0                                        01978018
019790             MULTIPLY  PV-DC-SML-COUNT                            01979018
019800                   BY  PC140-SML-TOT-CART                         01980018
019810               GIVING  PV-DC-SML-COUNT-EXTENDED                   01981018
019820           WHEN SQLCODE = -904                                    01982018
019830           WHEN SQLCODE = -911                                    01983018
019840           WHEN SQLCODE = -913                                    01984018
019850               CONTINUE                                           01985018
019860           WHEN OTHER                                             01986018
019870                SET PV-DONE-PROCESSING          TO TRUE           01987018
019880                SET PC140-CRA-SOCKET-COMM-ERROR TO TRUE           01988018
019890                MOVE SQLCODE                    TO PV-SQL-CODE    01989018
019900                STRING ' PCKCS707 - '        DELIMITED BY SIZE    01990018
019910                       '0520-COUNT-SML-ALL ' DELIMITED BY SIZE    01991018
019920                       ' SQL ERROR = '       DELIMITED BY SIZE    01992018
019930                       PV-SQL-CODE           DELIMITED BY SIZE    01993018
019940                                         INTO PV-CICS-MSG-AREA    01994018
019950                SET PS-DUMP-TO-LOG       TO TRUE                  01995018
019960                PERFORM 9990-WRITE-CICS                           01996018
019970     END-EVALUATE.                                                01997018
019980                                                                  01998018
019990                                                                  01999018
020000*----------------------------------------------------------------*02000018
020010*  for generic common Shipping Manifest Labels - get the number  *02001018
020020*  of stores that will be included in each label batch           *02002018
020030*  dmh added - 4/20/12                                           *02003018
020040*----------------------------------------------------------------*02004018
020050 0550-GET-LABEL-BREAK.                                            02005018
020060                                                                  02006018
020070     MOVE  PC140-CRA-OPER-UNT-ID  TO  KRPRPM-LOC-ID               02007018
020080                                                                  02008018
020090     EXEC SQL                                                     02009018
020100          SELECT  FUNC_QTY                                        02010018
020110            INTO :PV-LABEL-BREAK-QTY                              02011018
020120            FROM  TKRPRPM                                         02012018
020130           WHERE  LOC_ID            = :KRPRPM-LOC-ID              02013018
020140             AND  SYS_PRC_FUNC_CDE  = 'LBLBRK'                    02014018
020150             AND  FUNC_PRC_STAT_CDE = 'AC'                        02015018
020160             AND  INTFC_SYS_CDE     = 'KHL'                       02016018
020170     END-EXEC.                                                    02017018
020180                                                                  02018018
020190     EVALUATE TRUE                                                02019018
020200                                                                  02020018
020210         WHEN SQLCODE = +0                                        02021018
020220              CONTINUE                                            02022018
020230                                                                  02023018
020240         WHEN SQLCODE = +100                                      02024018
020250              perform 0555-GET-LABEL-BREAK-CORP                   02025018
020260                                                                  02026018
020270         WHEN SQLWARN0 NOT = SPACES                               02027018
020280         WHEN SQLCODE < +0                                        02028018
020290         WHEN SQLCODE > +0                                        02029018
020300                                                                  02030018
020310              MOVE  SQLCODE                TO  PV-DISP-SQLCODE    02031018
020320              MOVE  PC140-CRA-OPER-UNT-ID  TO  PV-DISP-DC         02032018
020330              INITIALIZE PV-CICS-MSG-AREA                         02033018
020340              STRING ' PCKCS707-SML ALL-'                         02034018
020350                     ' 0550-SET-LBL-BREAK-'                       02035018
020360                      PV-DISP-DC '  '                             02036018
020370                      PV-DISP-SQLCODE DELIMITED BY SIZE           02037018
020380                                INTO PV-CICS-MSG-AREA             02038018
020390                                                                  02039018
020400              PERFORM 9991-WRITEQ                                 02040018
020410              EXEC CICS                                           02041018
020420                   WRITEQ TD                                      02042018
020430                   QUEUE(PC-CSSL)                                 02043018
020440                   FROM(PV-CICS-MSG-AREA)                         02044018
020450                   RESP(PV-CICS-RESPONSE)                         02045018
020460              END-EXEC                                            02046018
020470     END-EVALUATE.                                                02047018
020480                                                                  02048018
020490                                                                  02049018
020500*----------------------------------------------------------------*02050018
020510*  for generic common Shipping Manifest Labels - get the number  *02051018
020520*  of stores that will be included in each label batch           *02052018
020530*  corporate level                                               *02053018
020540*  dmh added - 4/20/12                                           *02054018
020550*----------------------------------------------------------------*02055018
020560 0555-GET-LABEL-BREAK-CORP.                                       02056018
020570                                                                  02057018
020580     EXEC SQL                                                     02058018
020590          SELECT  FUNC_QTY                                        02059018
020600            INTO :PV-LABEL-BREAK-QTY                              02060018
020610            FROM  TKRPRPM                                         02061018
020620           WHERE  LOC_ID            =  90                         02062018
020630             AND  SYS_PRC_FUNC_CDE  = 'LBLBRK'                    02063018
020640             AND  FUNC_PRC_STAT_CDE = 'AC'                        02064018
020650             AND  INTFC_SYS_CDE     = 'KHL'                       02065018
020660     END-EXEC.                                                    02066018
020670                                                                  02067018
020680     EVALUATE TRUE                                                02068018
020690                                                                  02069018
020700         WHEN SQLCODE = +0                                        02070018
020710              CONTINUE                                            02071018
020720                                                                  02072018
020730         WHEN SQLWARN0 NOT = SPACES                               02073018
020740         WHEN SQLCODE < +0                                        02074018
020750         WHEN SQLCODE > +0                                        02075018
020760                                                                  02076018
020770              MOVE  SQLCODE                TO  PV-DISP-SQLCODE    02077018
020780              MOVE  PC140-CRA-OPER-UNT-ID  TO  PV-DISP-DC         02078018
020790              INITIALIZE PV-CICS-MSG-AREA                         02079018
020800              STRING ' PCKCS707-SML ALL-'                         02080018
020810                     ' 0555-GET-LABEL-BREAK-CORP'                 02081018
020820                      PV-DISP-DC '  '                             02082018
020830                      PV-DISP-SQLCODE DELIMITED BY SIZE           02083018
020840                                INTO PV-CICS-MSG-AREA             02084018
020850                                                                  02085018
020860              PERFORM 9991-WRITEQ                                 02086018
020870              EXEC CICS                                           02087018
020880                   WRITEQ TD                                      02088018
020890                   QUEUE(PC-CSSL)                                 02089018
020900                   FROM(PV-CICS-MSG-AREA)                         02090018
020910                   RESP(PV-CICS-RESPONSE)                         02091018
020920              END-EXEC                                            02092018
020930     END-EVALUATE.                                                02093018
020940                                                                  02094018
020950                                                                  02095018
020960*-----------------------------------------------------------------02096018
020970*  INSERT TO LABEL TRACKING HISTORY TABLE                         02097018
020980*-----------------------------------------------------------------02098018
020990 0600-INSERT-TLBTKHS.                                             02099018
021000     PERFORM                                                      02100018
021010       WITH TEST AFTER                                            02101018
021020       VARYING PV-RETRY-COUNTER FROM 1 BY 1                       02102018
021030       UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)                 02103018
021040           OR (SQLCODE = ZERO) OR (PV-DONE-PROCESSING)            02104018
021050           OR (PS-INVALID-INPUT))                                 02105018
021060                                                                  02106018
021070         EXEC SQL                                                 02107018
021080         INSERT INTO TLBTKHS                                      02108018
021090          (LBL_REQ_TRN_ID                                         02109018
021100         , LBL_TYP_CDE                                            02110018
021110         , CRE_TMST                                               02111018
021120         , CRED_BY_USR_ID                                         02112018
021130         , REQ_PGM_NM                                             02113018
021140         , LOC_ID                                                 02114018
021150         , LBL_PRT_QTY                                            02115018
021160         , PRTR_ID                                                02116018
021170         , PRTR_OPER_UNT_ID                                       02117018
021180         , PRTR_FCLTY_ID                                          02118018
021190         , XMIT_INTFC_CDE                                         02119018
021200         , XMIT_STAT_CDE                                          02120018
021210         , USR_LBL_ID                                             02121018
021220         , RDM_STK_LOC_ID)                                        02122018
021230          VALUES                                                  02123018
021240         (  :LBTKHS-LBL-REQ-TRN-ID                                02124018
021250         ,  :LBTKHS-LBL-TYP-CDE                                   02125018
021260         ,   CURRENT TIMESTAMP                                    02126018
021270         ,  :LBTKHS-CRED-BY-USR-ID                                02127018
021280         ,  :PC-CURRENT-PROGRAM-NAME                              02128018
021290         ,  :LBTKHS-LOC-ID                                        02129018
021300         ,  :LBTKHS-LBL-PRT-QTY                                   02130018
021310         ,  :LBTKHS-PRTR-ID                                       02131018
021320         ,  :LBTKHS-PRTR-OPER-UNT-ID                              02132018
021330         ,  :LBTKHS-PRTR-FCLTY-ID                                 02133018
021340         ,  :PC-S                                                 02134018
021350         ,  :PC-A                                                 02135018
021360         ,  :LBTKHS-USR-LBL-ID                                    02136018
021370         ,  :LBTKHS-RDM-STK-LOC-ID)                               02137018
021380      END-EXEC                                                    02138018
021390                                                                  02139018
021400         EVALUATE TRUE                                            02140018
021410           WHEN SQLCODE = ZERO                                    02141018
021420           WHEN SQLCODE = PC-NEG-904                              02142018
021430           WHEN SQLCODE = PC-NEG-911                              02143018
021440           WHEN SQLCODE = PC-NEG-913                              02144018
021450               CONTINUE                                           02145018
021460           WHEN SQLCODE = PC-NEG-803                              02146018
021470               PERFORM 4370-CREATE-TRANS-ID                       02147018
021480                                                                  02148018
021490           WHEN OTHER                                             02149018
021500               SET PV-DONE-PROCESSING          TO TRUE            02150018
021510                SET PS-DUMP-TO-LOG       TO TRUE                  02151018
021520         END-EVALUATE                                             02152018
021530     END-PERFORM.                                                 02153018
021540                                                                  02154018
021550     IF (PV-RETRY-COUNTER > PC-MAX-RETRIES                        02155018
021560       OR PV-DONE-PROCESSING                                      02156018
021570       OR PS-INVALID-INPUT)                                       02157018
021580       AND SQLCODE NOT = ZERO                                     02158018
021590         SET PV-DONE-PROCESSING          TO TRUE                  02159018
021600         SET PC140-CRA-SOCKET-COMM-ERROR TO TRUE                  02160018
021610         MOVE SQLCODE                    TO PV-SQL-CODE           02161018
021620         STRING ' PCKCS707 - '        DELIMITED BY SIZE           02162018
021630                '0600-INSERT-TLBTKHS' DELIMITED BY SIZE           02163018
021640                ' SQL ERROR = '       DELIMITED BY SIZE           02164018
021650                PV-SQL-CODE           DELIMITED BY SIZE           02165018
021660                                     INTO PV-CICS-MSG-AREA        02166018
021670         SET PS-DUMP-TO-LOG       TO TRUE                         02167018
021680         PERFORM 9990-WRITE-CICS                                  02168018
021690     END-IF.                                                      02169018
021700                                                                  02170018
021710*-----------------------------------------------------------------02171018
021720*  INSERT TO LABEL TRACKING INSTRUCTIONS TABLE                    02172018
021730*-----------------------------------------------------------------02173018
021740 0650-INSERT-TLBTKIN.                                             02174018
021750     MOVE LBTKHS-LBL-REQ-TRN-ID      TO LBTKIN-LBL-REQ-TRN-ID.    02175018
021760                                                                  02176018
021770     PERFORM                                                      02177018
021780       WITH TEST AFTER                                            02178018
021790       VARYING PV-RETRY-COUNTER FROM 1 BY 1                       02179018
021800       UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)                 02180018
021810           OR (SQLCODE = ZERO) OR (PV-DONE-PROCESSING))           02181018
021820                                                                  02182018
021830         EXEC SQL                                                 02183018
021840         INSERT INTO TLBTKIN                                      02184018
021850          (LBL_REQ_TRN_ID                                         02185018
021860         , LBL_1ST_LNE_TXT                                        02186018
021870         , LBL_2ND_LNE_TXT                                        02187018
021880         , LBL_3RD_LNE_TXT)                                       02188018
021890          VALUES                                                  02189018
021900         (  :LBTKIN-LBL-REQ-TRN-ID                                02190018
021910         ,  :LBTKIN-LBL-1ST-LNE-TXT                               02191018
021920         ,  :LBTKIN-LBL-2ND-LNE-TXT                               02192018
021930         ,  :LBTKIN-LBL-3RD-LNE-TXT)                              02193018
021940      END-EXEC                                                    02194018
021950                                                                  02195018
021960         EVALUATE TRUE                                            02196018
021970           WHEN SQLCODE = ZERO                                    02197018
021980           WHEN SQLCODE = PC-NEG-904                              02198018
021990           WHEN SQLCODE = PC-NEG-911                              02199018
022000           WHEN SQLCODE = PC-NEG-913                              02200018
022010               CONTINUE                                           02201018
022020                                                                  02202018
022030           WHEN OTHER                                             02203018
022040               SET PV-DONE-PROCESSING          TO TRUE            02204018
022050         END-EVALUATE                                             02205018
022060     END-PERFORM.                                                 02206018
022070                                                                  02207018
022080     IF (PV-RETRY-COUNTER > PC-MAX-RETRIES                        02208018
022090       OR PV-DONE-PROCESSING)                                     02209018
022100       AND SQLCODE NOT = ZERO                                     02210018
022110         SET PV-DONE-PROCESSING          TO TRUE                  02211018
022120         SET PC140-CRA-SOCKET-COMM-ERROR TO TRUE                  02212018
022130         MOVE SQLCODE                    TO PV-SQL-CODE           02213018
022140         STRING ' PCKCS707 - '        DELIMITED BY SIZE           02214018
022150                '0650-INSERT-TLBTKIN' DELIMITED BY SIZE           02215018
022160                ' SQL ERROR = '       DELIMITED BY SIZE           02216018
022170                PV-SQL-CODE           DELIMITED BY SIZE           02217018
022180                                     INTO PV-CICS-MSG-AREA        02218018
022190         SET PS-DUMP-TO-LOG       TO TRUE                         02219018
022200         PERFORM 9990-WRITE-CICS                                  02220018
022210     END-IF.                                                      02221018
022220                                                                  02222018
022230*-----------------------------------------------------------------02223018
022240*  INSERT TO LABEL TRACKING ID LABELS TABLE                       02224018
022250*-----------------------------------------------------------------02225018
022260 0675-INSERT-TLBTKID.                                             02226018
022270     MOVE LBTKHS-LBL-REQ-TRN-ID      TO LBTKID-LBL-REQ-TRN-ID.    02227018
022280                                                                  02228018
022290     PERFORM                                                      02229018
022300       WITH TEST AFTER                                            02230018
022310       VARYING PV-RETRY-COUNTER FROM 1 BY 1                       02231018
022320       UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)                 02232018
022330           OR (SQLCODE = ZERO) OR (PV-DONE-PROCESSING))           02233018
022340                                                                  02234018
022350         EXEC SQL                                                 02235018
022360         INSERT INTO TLBTKID                                      02236018
022370          (LBL_REQ_TRN_ID                                         02237018
022380         , LBL_TYP_CDE                                            02238018
022390         , PO_NBR                                                 02239018
022400         , RCVR_SEQ_NBR                                           02240018
022410         , PO_LNE_NBR                                             02241018
022420         , TRIP_ID                                                02242018
022430         , LBL_PRT_BTCH_ID                                        02243018
022440         , LBL_PRT_QTY                                            02244018
022450         , SEPOR_LBL_PRT_QTY)                                     02245018
022460          VALUES                                                  02246018
022470         (  :LBTKID-LBL-REQ-TRN-ID                                02247018
022480         ,  :LBTKID-LBL-TYP-CDE                                   02248018
022490         ,  :LBTKID-PO-NBR                                        02249018
022500         ,  :LBTKID-RCVR-SEQ-NBR                                  02250018
022510         ,  :LBTKID-PO-LNE-NBR                                    02251018
022520         ,  :LBTKID-TRIP-ID                                       02252018
022530         ,  :LBTKID-LBL-PRT-BTCH-ID                               02253018
022540         ,  :LBTKID-LBL-PRT-QTY                                   02254018
022550         ,  :LBTKID-SEPOR-LBL-PRT-QTY)                            02255018
022560      END-EXEC                                                    02256018
022570                                                                  02257018
022580         EVALUATE TRUE                                            02258018
022590           WHEN SQLCODE = ZERO                                    02259018
022600           WHEN SQLCODE = PC-NEG-904                              02260018
022610           WHEN SQLCODE = PC-NEG-911                              02261018
022620           WHEN SQLCODE = PC-NEG-913                              02262018
022630               CONTINUE                                           02263018
022640                                                                  02264018
022650           WHEN OTHER                                             02265018
022660               SET PV-DONE-PROCESSING          TO TRUE            02266018
022670         END-EVALUATE                                             02267018
022680     END-PERFORM.                                                 02268018
022690                                                                  02269018
022700     IF (PV-RETRY-COUNTER > PC-MAX-RETRIES                        02270018
022710       OR PV-DONE-PROCESSING)                                     02271018
022720       AND SQLCODE NOT = ZERO                                     02272018
022730         SET PV-DONE-PROCESSING          TO TRUE                  02273018
022740         SET PC140-CRA-SOCKET-COMM-ERROR TO TRUE                  02274018
022750         MOVE SQLCODE                    TO PV-SQL-CODE           02275018
022760         STRING ' PCKCS707 - '        DELIMITED BY SIZE           02276018
022770                '0675-INSERT-TLBTKID' DELIMITED BY SIZE           02277018
022780                ' SQL ERROR = '       DELIMITED BY SIZE           02278018
022790                PV-SQL-CODE           DELIMITED BY SIZE           02279018
022800                                     INTO PV-CICS-MSG-AREA        02280018
022810         SET PS-DUMP-TO-LOG       TO TRUE                         02281018
022820         PERFORM 9990-WRITE-CICS                                  02282018
022830     END-IF.                                                      02283018
022840                                                                  02284018
022850*----------------------------------------------------------------*02285018
022860* GET  XREF CODE FROM LPMS CONFIRM CODE                          *02286018
022870*----------------------------------------------------------------*02287018
022880 0700-GET-XREF-CODE.                                              02288018
022890     STRING                                                       02289018
022900            ' 0700-GET-XREF-CODE'                                 02290018
022910     DELIMITED BY SIZE                                            02291018
022920     INTO PV-CICS-MSG-AREA                                        02292018
022930     PERFORM 9990-WRITE-CICS                                      02293018
022940                                                                  02294018
022950     IF PC138-CONFIRM-CODE (PC138-IDX) = PC133-CONFIRM-CODE       02295018
022960         MOVE PC138-XREF-CODE (PC138-IDX) TO  PV-XMIT-STAT-CDE    02296018
022970         SET  PS-XREF-DONE                TO TRUE                 02297018
022980     ELSE                                                         02298018
022990         MOVE '?'                         TO  PV-XMIT-STAT-CDE    02299018
023000     END-IF.                                                      02300018
023010                                                                  02301018
023020*-----------------------------------------------------------------02302018
023030*  UPDATE TO LABEL TRACKING HISTORY TABLE                         02303018
023040*-----------------------------------------------------------------02304018
023050 0710-UPDATE-TLBTKHS.                                             02305018
023060     PERFORM                                                      02306018
023070       WITH TEST AFTER                                            02307018
023080       VARYING PV-RETRY-COUNTER FROM 1 BY 1                       02308018
023090       UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)                 02309018
023100           OR (SQLCODE = ZERO) OR (PV-DONE-PROCESSING))           02310018
023110                                                                  02311018
023120         EXEC SQL                                                 02312018
023130         UPDATE TLBTKHS                                           02313018
023140           SET XMIT_STAT_CDE  = :PV-XMIT-STAT-CDE                 02314018
023150         WHERE LBL_REQ_TRN_ID = :LBTKHS-LBL-REQ-TRN-ID            02315018
023160      END-EXEC                                                    02316018
023170                                                                  02317018
023180         EVALUATE TRUE                                            02318018
023190           WHEN SQLCODE = ZERO                                    02319018
023200           WHEN SQLCODE = PC-NEG-904                              02320018
023210           WHEN SQLCODE = PC-NEG-911                              02321018
023220           WHEN SQLCODE = PC-NEG-913                              02322018
023230               CONTINUE                                           02323018
023240                                                                  02324018
023250           WHEN OTHER                                             02325018
023260               SET PV-DONE-PROCESSING          TO TRUE            02326018
023270         END-EVALUATE                                             02327018
023280     END-PERFORM.                                                 02328018
023290                                                                  02329018
023300     IF (PV-RETRY-COUNTER > PC-MAX-RETRIES)                       02330018
023310       AND SQLCODE NOT = ZERO                                     02331018
023320         SET PV-DONE-PROCESSING          TO TRUE                  02332018
023330         SET PC140-CRA-SOCKET-COMM-ERROR TO TRUE                  02333018
023340         MOVE SQLCODE                    TO PV-SQL-CODE           02334018
023350         STRING ' PCKCS707 - '        DELIMITED BY SIZE           02335018
023360                '0710-UPDATE-TLBTKHS' DELIMITED BY SIZE           02336018
023370                ' SQL ERROR = '       DELIMITED BY SIZE           02337018
023380                PV-SQL-CODE           DELIMITED BY SIZE           02338018
023390                                  INTO PV-CICS-MSG-AREA           02339018
023400         SET PS-DUMP-TO-LOG       TO TRUE                         02340018
023410         PERFORM 9990-WRITE-CICS                                  02341018
023420     END-IF.                                                      02342018
023430                                                                  02343018
023440*-----------------------------------------------------------------02344018
023450*  RETURN TO CALLING PROGRAM                                      02345018
023460*-----------------------------------------------------------------02346018
023470 0750-RETURN.                                                     02347018
023480                                                                  02348018
023490     STRING                                                       02349018
023500            ' 0750-RETURN'                                        02350018
023510     DELIMITED BY SIZE                                            02351018
023520     INTO PV-CICS-MSG-AREA                                        02352018
023530     PERFORM 9990-WRITE-CICS                                      02353018
023540                                                                  02354018
023550*    RELEASE EXCLUSIVE USE OF THE LOG QUEUE                       02355018
023560     IF PS-SHOW-DEBUG-INFO                                        02356018
023570         EXEC CICS DEQ                                            02357018
023580             RESOURCE(PC-CSSL)                                    02358018
023590         END-EXEC                                                 02359018
023600     END-IF                                                       02360018
023610                                                                  02361018
023620     PERFORM 0011-GET-SYSTEM-TIMESTAMP                            02362018
023630                                                                  02363018
023640     IF PS-DUMP-TO-LOG                                            02364018
023650         PERFORM 9999-FINAL-DUMP                                  02365018
023660     END-IF                                                       02366018
023670                                                                  02367018
023680     STRING ' PCKCS707 ENDED   - TASK = ' PV-TASK-X               02368018
023690         '  ' PV-DISP-SYSTEM-TMST                                 02369018
023700         DELIMITED BY SIZE INTO PV-CICS-MSG-AREA                  02370018
023710     PERFORM 9990-WRITE-CICS                                      02371018
023750                                                                  02375018
023760     IF PV-DONE-PROCESSING                                        02376018
023770         EXEC CICS SYNCPOINT ROLLBACK                             02377018
023780             END-EXEC                                             02378018
023790     ELSE                                                         02379018
023800         EXEC CICS SYNCPOINT                                      02380018
023810             END-EXEC                                             02381018
023820     END-IF.                                                      02382018
023830                                                                  02383018
023840     MOVE PC140-LABELMST             TO DFHCOMMAREA.              02384018
023850     GOBACK.                                                      02385018
023860                                                                  02386018
023870*-----------------------------------------------------------------02387018
023880*  MAIN PROCESSING ROUTINE                                        02388018
023890*-----------------------------------------------------------------02389018
023900 1000-MAIN-PROCESS.                                               02390018
023910     STRING                                                       02391018
023920            ' 1000-MAIN-PROCESS'                                  02392018
023930     DELIMITED BY SIZE                                            02393018
023940     INTO PV-CICS-MSG-AREA                                        02394018
023950     PERFORM 9990-WRITE-CICS                                      02395018
023960                                                                  02396018
023970      EVALUATE PC140-LABEL-FORMAT-NBR                             02397018
023980        WHEN 001                                                  02398018
023990            PERFORM 4270-SEL-KRPRPM-FUNC-QTY                      02399018
024000            PERFORM 3400-FMAT-COM-HEADER-LABEL                    02400018
024010        WHEN 002                                                  02401018
024020            PERFORM 3500-FMAT-COM-CARTON-LABEL                    02402018
024030        WHEN 004                                                  02403018
024040            PERFORM 3100-FMAT-COM-SHP-MNFST-LABEL                 02404018
024050        WHEN 006                                                  02405018
024060            PERFORM 3300-FMAT-USERID-LABEL                        02406018
024070        WHEN 007                                                  02407018
024080        WHEN 009                                                  02408018
024090            PERFORM 3600-FMAT-COM-MISC-LABEL                      02409018
024100        WHEN 008                                                  02410018
024110            PERFORM 3700-FMAT-COM-RACK-LABEL                      02411018
024120        WHEN 010                                                  02412018
024130            PERFORM 3800-FMAT-BLIND-RECEIPT-LABEL                 02413018
024140        WHEN 011                                                  02414018
024150            PERFORM 3900-FMAT-TRAILER-SERIAL-LABEL                02415018
024160        WHEN 013                                                  02416018
024170            EVALUATE TRUE                                         02417018
024180                WHEN PC140-RF-CENTRAL-STK                         02418018
024190                WHEN PC140-RF-E-COMMERCE                          02419018
024200                    PERFORM 3920-FMAT-RF-BLIND-RCPT-LABEL         02420018
024210                WHEN PC140-RF-DEST-LBL                            02421018
024230                    PERFORM 6390-GET-LABEL-CODES                  02423018
024240                    PERFORM 3960-FMAT-RF-CHECKIN-P2L-LABEL        02424018
024260                WHEN PC140-RF-PCK-2-LIT                           02426018
024270                WHEN PC140-RF-CRTN-BULD                           02427018
024280                WHEN PC140-RF-GENERIC-SML                         02428018
024290                    PERFORM 3930-FMAT-RF-GENERIC-SML-LABEL        02429018
024300                WHEN PC140-RF-CSEPK-SML                           02430018
024310                    PERFORM 6390-GET-LABEL-CODES                  02431018
024320                    EVALUATE TRUE                                 02432018
024330                        WHEN PC140-RF-4-BY-4-LBL                  02433018
024340                            PERFORM 6850-CALL-STORE-ON-HAND-MOD   02434018
024350                            PERFORM 3940-FMAT-RF-CSEPK-SML-LABEL  02435018
024380                    END-EVALUATE                                  02438018
024390                WHEN PC140-RF-CHECKIN-SML                         02439018
024400                WHEN PC140-RF-SMOOTHING                           02440018
024410                    PERFORM 6390-GET-LABEL-CODES                  02441018
024420                    PERFORM 6850-CALL-STORE-ON-HAND-MOD           02442018
024430                    PERFORM 3950-FMAT-RF-CHECKIN-SML-LABEL        02443018
024450                WHEN PC140-RF-CRTN-LBL                            02445018
024470                     PERFORM 3301-COUNT-MSG-RD                    02447018
024480                     PERFORM 3807-DETERMINE-CRTN-LBL              02448018
024500                     PERFORM 3990-BUILD-CRTN-LBL-FORM             02450018
024520            END-EVALUATE                                          02452018
024530        WHEN OTHER                                                02453018
024540            STRING 'INVALID LABEL TYPE   ' DELIMITED BY SIZE      02454018
024550                       INTO PC140-CRA-RET-MSG                     02455018
024560            SET PV-DONE-PROCESSING          TO TRUE               02456018
024570            SET PC140-CRA-INVALID-PRT-FMT   TO TRUE               02457018
024580      END-EVALUATE.                                               02458018
024590                                                                  02459018
024600*-----------------------------------------------------------------02460018
024610*       FORMAT THE COMMON SHIP MANIFEST LABEL                     02461018
024620*-----------------------------------------------------------------02462018
024630 3100-FMAT-COM-SHP-MNFST-LABEL.                                   02463018
024640     STRING                                                       02464018
024650            ' 3100-FMAT-COM-SHP-MNFST-LABEL'                      02465018
024660     DELIMITED BY SIZE                                            02466018
024670     INTO PV-CICS-MSG-AREA                                        02467018
024680     PERFORM 9990-WRITE-CICS                                      02468018
024690                                                                  02469018
024700     IF  PC140-SML-REPRINT                                        02470018
024710         MOVE PC151-FORM-REPRT-FLD     TO PC151-REPRINT-TEXT      02471018
024720         MOVE PC151-FORM-REPRT-BOX     TO PC151-REPRINT-BOX       02472018
024730     ELSE                                                         02473018
024740         MOVE PC151-FORM-NO-RPRT-FLD   TO PC151-REPRINT-TEXT      02474018
024750         MOVE PC151-FORM-NO-RPRT-BOX   TO PC151-REPRINT-BOX       02475018
024760     END-IF.                                                      02476018
024770                                                                  02477018
024780     IF  PC140-LOSS-PREVENTION                                    02478018
024790         MOVE 'LOSS PREV '         TO PC151-SML-LBL-DESC          02479018
024800     ELSE                                                         02480018
024801     IF  PC140-3WD-LABEL                                          02480131
024802         MOVE '3WD LBL'            TO PC151-SML-LBL-DESC          02480231
024803     ELSE                                                         02480331
024810         STRING PC140-SML-TYPE 'SML LBL'                          02481018
024820             DELIMITED BY SIZE                                    02482018
024830             INTO PC151-SML-LBL-DESC                              02483018
024850     END-IF                                                       02485031
024851     END-IF.                                                      02485131
024860                                                                  02486018
024870     MOVE PV-LBL-PRT-DATE          TO PC151-LBL-PRT-DATE.         02487018
024880     MOVE PV-LBL-PRT-TIME          TO PC151-LBL-PRT-TIME.         02488018
024890                                                                  02489018
024900     STRING PC140-CRA-DC-ID           DELIMITED BY SIZE           02490018
024910            '-'                       DELIMITED BY SIZE           02491018
024920            PC140-SML-PRTR-ID         DELIMITED BY SIZE           02492018
024930                                 INTO PC151-SML-PRTR-NBR.         02493018
024940                                                                  02494018
024950     MOVE PC140-SML-TOT-CART       TO PC152-SML-TOT-LBL.          02495018
024960                                                                  02496018
024970     MOVE PC140-SML-ZNE-LINE-1     TO PC151-STR-ZONE-LINE-1.      02497018
024980     MOVE PC140-SML-ZNE-LINE-2     TO PC151-STR-ZONE-LINE-2.      02498018
024990     MOVE PC140-SML-ZNE-LINE-3     TO PC151-STR-ZONE-LINE-3.      02499018
025000                                                                  02500018
025010* BUILD BARCODE & NUMBER ABOVE BARCODE FOR SML LABELS             02501018
025020                                                                  02502018
025030     MOVE PC140-CRA-USERID      TO PC151-USER-ID.                 02503018
025040                                                                  02504018
025050     MOVE PC140-SML-STR-NAME    TO PC152-SML-DATA-STR-NME.        02505018
025060                                                                  02506018
025070     IF  PC140-LOSS-PREVENTION                                    02507018
025080         MOVE  ZEROES           TO PV-9999-X                      02508018
025090     ELSE                                                         02509018
025100         MOVE PC140-SML-STR-NBR TO PV-9999-X                      02510018
025110     END-IF.                                                      02511018
025120                                                                  02512018
025130     MOVE PV-9999-N             TO PC160-20-SML-NBR-BC-DIVERT-CDE 02513018
025140                                   PC160-20-SML-BC-DIVERT-CDE     02514018
025150                                                                  02515018
025160     MOVE PC140-SML-DIVERT-PFX  TO PC160-20-SML-NBR-BC-DIVERT-PFX 02516018
025170                                   PC160-20-SML-BC-DIVERT-PFX     02517018
025180                                                                  02518018
025190     MOVE PC140-SML-STRT-MFST-NBR                                 02519018
025200                                TO PV-PIC911.                     02520018
025210     MOVE PV-PIC911             TO PV-PIC907.                     02521018
025220     MOVE PV-PIC911             TO PV-PIC908.                     02522018
025230     MOVE PV-PIC908             TO PC160-20-SML-BC-MNFST-NBR      02523018
025240                                   PC160-20-SML-NBR-BC-MNFST-NBR. 02524018
025250                                                                  02525018
025270     MOVE PC140-SML-ORIGIN-DC   TO PC160-20-SML-BC-DC-ORIGIN      02527018
025280                                   PC160-20-SML-NBR-BC-DC-ORIGIN. 02528018
025300                                                                  02530018
025310     MOVE PV-9999-X             TO PC152-SML-DATA-STR-NBR.        02531018
025320                                                                  02532018
025330     SET PC160-20-SML-NBR-INTERNAL-LBL                            02533018
025340         PC160-20-SML-NBR-FROM-KOHLS                              02534018
025350         PC160-20-SML-INTERNAL-LBL                                02535018
025360         PC160-20-SML-FROM-KOHLS      to  true.                   02536018
025370     MOVE ZEROES             TO PC160-20-SML-NBR-CONTAINER-CDE.   02537018
025380     MOVE PC160-20-DIGIT-BARCODE      TO  PC152-SML-DATA-BC.      02538018
025390                                                                  02539018
025400     MOVE PC160-20-DIGIT-BARCODE-NBR  TO  PC152-SML-DATA-BC-NBR.  02540018
025410                                                                  02541018
025430     move '@@@@'    to  pc152-sml-data-door-id                    02543018
025440     IF  PC140-ALL-STORES  OR                                     02544018
025450         PC140-LOSS-PREVENTION                                    02545018
025460         CONTINUE                                                 02546018
025470     ELSE                                                         02547018
025480         if  PC140-DOOR-NOT-ON-LABEL                              02548018
025490             continue                                             02549018
025500         else                                                     02550018
025510             if  PC140-SML-SHIP-DOOR-ORDER                        02551018
025520                 move CNDRST-DOOR-ID                              02552018
025530                              to  pc152-sml-data-door-id          02553018
025540             else                                                 02554018
025550                 MOVE  PV-9999-N                                  02555018
025560                              TO  cndrst-str-nbr                  02556018
025570                 MOVE  PC140-CRA-OPER-UNT-ID                      02557018
025580                              to  CNDRST-OPER-UNT-ID              02558018
025590                 perform 4667-get-door-id                         02559018
025600                 move CNDRST-DOOR-ID                              02560018
025610                             to  pc152-sml-data-door-id           02561018
025620             end-if                                               02562018
025630         end-if                                                   02563018
025640     END-IF.                                                      02564018
025660                                                                  02566018
025670*-----------------------------------------------------------------02567018
025680*       FORMAT THE USERID LABEL                                   02568018
025690*-----------------------------------------------------------------02569018
025700 3300-FMAT-USERID-LABEL.                                          02570018
025710     STRING                                                       02571018
025720            ' 3300-FMAT-USERID-LABEL'                             02572018
025730     DELIMITED BY SIZE                                            02573018
025740     INTO PV-CICS-MSG-AREA                                        02574018
025750     PERFORM 9990-WRITE-CICS                                      02575018
025760                                                                  02576018
025770      MOVE 'CICSP1'              TO PC156-USR-CICS-BC.            02577018
025780      MOVE '*CICSP1*'            TO PC156-USR-CICS.               02578018
025790      STRING '*'                 DELIMITED BY SIZE                02579018
025800             PC140-UL-USERID     DELIMITED BY SIZE                02580018
025810             '*'                 DELIMITED BY SIZE                02581018
025820                     INTO PC156-USR-USERID.                       02582018
025830      MOVE PC140-UL-USERID       TO WS-USERID.                    02583018
025840      PERFORM 3305-FORMAT-BARCODE.                                02584018
025850                                                                  02585018
025860 3305-FORMAT-BARCODE.                                             02586018
025870     STRING                                                       02587018
025880            ' 3305-FORMAT-BARCODE'                                02588018
025890     DELIMITED BY SIZE                                            02589018
025900     INTO PV-CICS-MSG-AREA                                        02590018
025910     PERFORM 9990-WRITE-CICS                                      02591018
025920                                                                  02592018
025930      IF WS-CHAR8 NOT = SPACE AND WS-CHAR8 NOT = LOW-VALUES       02593018
025940          STRING WS-USERID(1:8)       DELIMITED BY SIZE           02594018
025950                 PC-EOD               DELIMITED BY SIZE           02595018
025960                               INTO PC156-USR-USERID-BC           02596018
025970          STRING 'XXXXXXXX'        DELIMITED BY SIZE              02597018
025980                 PC-EOD               DELIMITED BY SIZE           02598018
025990                               INTO PC155-USR-USERID-BC           02599018
026000      ELSE                                                        02600018
026010      IF WS-CHAR7 NOT = SPACE AND WS-CHAR7 NOT = LOW-VALUES       02601018
026020          STRING WS-USERID(1:7)       DELIMITED BY SIZE           02602018
026030                 PC-EOD               DELIMITED BY SIZE           02603018
026040                               INTO PC156-USR-USERID-BC           02604018
026050          STRING 'XXXXXXX'         DELIMITED BY SIZE              02605018
026060                 PC-EOD               DELIMITED BY SIZE           02606018
026070                               INTO PC155-USR-USERID-BC           02607018
026080      ELSE                                                        02608018
026090      IF WS-CHAR6 NOT = SPACE AND WS-CHAR6 NOT = LOW-VALUES       02609018
026100          STRING WS-USERID(1:6)       DELIMITED BY SIZE           02610018
026110                 PC-EOD               DELIMITED BY SIZE           02611018
026120                               INTO PC156-USR-USERID-BC           02612018
026130          STRING 'XXXXXX'          DELIMITED BY SIZE              02613018
026140                 PC-EOD               DELIMITED BY SIZE           02614018
026150                               INTO PC155-USR-USERID-BC           02615018
026160      ELSE                                                        02616018
026170      IF WS-CHAR5 NOT = SPACE AND WS-CHAR5 NOT = LOW-VALUES       02617018
026180          STRING WS-USERID(1:5)       DELIMITED BY SIZE           02618018
026190                 PC-EOD               DELIMITED BY SIZE           02619018
026200                               INTO PC156-USR-USERID-BC           02620018
026210          STRING 'XXXXX'           DELIMITED BY SIZE              02621018
026220                 PC-EOD               DELIMITED BY SIZE           02622018
026230                               INTO PC155-USR-USERID-BC           02623018
026240      ELSE                                                        02624018
026250      IF WS-CHAR4 NOT = SPACE AND WS-CHAR4 NOT = LOW-VALUES       02625018
026260          STRING WS-USERID(1:4)       DELIMITED BY SIZE           02626018
026270                 PC-EOD               DELIMITED BY SIZE           02627018
026280                               INTO PC156-USR-USERID-BC           02628018
026290          STRING 'XXXX'            DELIMITED BY SIZE              02629018
026300                 PC-EOD               DELIMITED BY SIZE           02630018
026310                               INTO PC155-USR-USERID-BC           02631018
026320      ELSE                                                        02632018
026330      IF WS-CHAR3 NOT = SPACE AND WS-CHAR3 NOT = LOW-VALUES       02633018
026340          STRING WS-USERID(1:3)       DELIMITED BY SIZE           02634018
026350                 PC-EOD               DELIMITED BY SIZE           02635018
026360                               INTO PC156-USR-USERID-BC           02636018
026370          STRING 'XXX'             DELIMITED BY SIZE              02637018
026380                 PC-EOD               DELIMITED BY SIZE           02638018
026390                               INTO PC155-USR-USERID-BC           02639018
026400      ELSE                                                        02640018
026410      IF WS-CHAR2 NOT = SPACE AND WS-CHAR2 NOT = LOW-VALUES       02641018
026420          STRING WS-USERID(1:2)       DELIMITED BY SIZE           02642018
026430                 PC-EOD               DELIMITED BY SIZE           02643018
026440                               INTO PC156-USR-USERID-BC           02644018
026450          STRING 'XX'              DELIMITED BY SIZE              02645018
026460                 PC-EOD               DELIMITED BY SIZE           02646018
026470                               INTO PC155-USR-USERID-BC           02647018
026480      ELSE                                                        02648018
026490          STRING WS-USERID(1:1)       DELIMITED BY SIZE           02649018
026500                 PC-EOD               DELIMITED BY SIZE           02650018
026510                               INTO PC156-USR-USERID-BC           02651018
026520          STRING 'X'               DELIMITED BY SIZE              02652018
026530                 PC-EOD               DELIMITED BY SIZE           02653018
026540                               INTO PC155-USR-USERID-BC           02654018
026550      END-IF.                                                     02655018
026560                                                                  02656018
026570*----------------------------------------------------------------*02657018
026580* COUNT PROCESS MESSAGES THAT ARE OF A CODE TYPE 'RD' TO         *02658018
026590* DETERMINE IF '*** RF ID ****' SHOULD BE PRINTED ON THE LABEL   *02659018
026600*----------------------------------------------------------------*02660018
026610 3301-COUNT-MSG-RD.                                               02661018
026620                                                                  02662018
026622     MOVE PC140-RF-KOHLS-BARCODE TO PV-SHIPT-UNT-X-22.            02662219
026623     MOVE PV-SHIPT-UNT-9-18      TO SUT00094-SHIPT-UNT-ID.        02662319
026640                                                                  02664018
026650     EXEC SQL                                                     02665018
026660          SELECT  PRC_MSG_CDE                                     02666018
026670            INTO :PV-PRC-MSG-CDE                                  02667018
026680            FROM SUT_PRC_MSG_CNTL                                 02668018
026690           WHERE SHIPT_UNT_ID = :SUT00094-SHIPT-UNT-ID            02669018
026700             AND PRC_MSG_CDE  IN ('RD', 'EA', 'RE')               02670018
026710           FETCH FIRST 1 ROW ONLY                                 02671018
026720     END-EXEC.                                                    02672018
026730                                                                  02673018
026740     EVALUATE TRUE                                                02674018
026750         WHEN SQLCODE = ZERO                                      02675018
026760         WHEN SQLCODE = -811                                      02676018
026770              CONTINUE                                            02677018
026780                                                                  02678018
026790         WHEN SQLCODE = +100                                      02679018
026800              CONTINUE                                            02680018
026810                                                                  02681018
026820         WHEN OTHER                                               02682018
026830             STRING ' PCKCS707 - '                                02683018
026840             '3301-COUNT-MSG-RD'                                  02684018
026850             'SQL CODE IS - '                                     02685018
026860             SQLCA                 DELIMITED BY SIZE              02686018
026870                                      INTO PV-CICS-MSG-AREA       02687018
026880             SET PS-DUMP-TO-LOG       TO TRUE                     02688018
026890             PERFORM 9990-WRITE-CICS                              02689018
026900         END-EVALUATE.                                            02690018
026910                                                                  02691018
026920*----------------------------------------------------------------*02692018
026930*  DETERMINE CARTON LABEL                                         02693018
026940*----------------------------------------------------------------*02694018
026950 3807-DETERMINE-CRTN-LBL.                                         02695018
026960                                                                  02696018
026970     IF PV-PRC-MSG-CDE = 'RD'                                     02697018
026980        PERFORM 3980-TKRPRPM-RFID-LBL-INFO                        02698018
026990     ELSE                                                         02699018
027000        IF PV-PRC-MSG-CDE = 'EA'                                  02700018
027010           PERFORM 3809-TKRPRPM-EAS-LBL-INFO                      02701018
027020        ELSE                                                      02702018
027030           PERFORM 3810-TKRPRPM-RFEACR-LBL-INFO                   02703018
027040        END-IF                                                    02704018
027050     END-IF.                                                      02705018
027060                                                                  02706018
027070*----------------------------------------------------------------*02707018
027080*  GET PARM THAT PROVIDES TEXT AND DIVERT CODE FOR EAS LABELS     02708018
027090*----------------------------------------------------------------*02709018
027100 3809-TKRPRPM-EAS-LBL-INFO.                                       02710018
027110                                                                  02711018
027120     EXEC SQL                                                     02712018
027130          SELECT FUNC_TXT                                         02713018
027140          INTO  :KRPRPM-FUNC-TXT                                  02714018
027150          FROM   TKRPRPM                                          02715018
027160          WHERE  SYS_PRC_FUNC_CDE  = 'EASCRT'                     02716018
027170            AND  INTFC_SYS_CDE     = 'KHL'                        02717018
027180            AND  FUNC_PRC_STAT_CDE = 'AC'                         02718018
027190            AND  LOC_ID            =  :KRPRPM-LOC-ID              02719018
027200     END-EXEC.                                                    02720018
027210                                                                  02721018
027220     EVALUATE TRUE                                                02722018
027230         WHEN SQLCODE = ZERO                                      02723018
027240            MOVE KRPRPM-FUNC-TXT (7:4) TO PV-RFID-DIVERT-CDE      02724018
027250            MOVE PV-RFID-DIVERT-CDE-N  TO PV-22-CRTN-DIVERT-CDE   02725018
027260            MOVE 0                     TO PV-22-CRTN-TYPE-IND     02726018
027270            MOVE PC140-RF-PO-NBR       TO PV-22-CRTN-PO-NBR       02727018
027280            MOVE PC140-RF-PO-RCVR      TO PV-22-CTRN-RCVR-SEQ-NBR 02728018
027290            MOVE PC140-RF-LNE-NBR      TO PV-22-CRTN-PO-LNE-NBR   02729018
027291            PERFORM 3812-LAST-4-OF-BARCODE-PARM                   02729120
027295            IF  PS-USE-LAST-4-FROM-TMST                           02729520
027296                PERFORM 3811-GET-LAST-4-OF-BARCODE                02729620
027299                MOVE PV-CURRENT-TMST-R-LAST-4                     02729920
027300                                    TO PV-22-CRTN-CART-NBR        02730020
027301            ELSE                                                  02730120
027303                MOVE 0000 TO PV-22-CRTN-CART-NBR                  02730320
027304            END-IF                                                02730420
027310            MOVE PV-22-DIGIT-BARCODE   TO DK-BARCODE-NBR          02731018
027320                                                                  02732018
027330         WHEN SQLCODE = +100                                      02733018
027340            MOVE 'XXXX'                TO PV-RFID-DIVERT-CDE      02734018
027350                                                                  02735018
027360         WHEN SQLWARN0 NOT = SPACES                               02736018
027370         WHEN SQLCODE < ZERO                                      02737018
027380         WHEN SQLCODE > ZERO                                      02738018
027390             MOVE 'TKRPRPM'           TO PV-DISP-TABLE-1          02739018
027400             PERFORM 9955-SQL-ERROR                               02740018
027410     END-EVALUATE.                                                02741018
027420                                                                  02742018
027430*----------------------------------------------------------------*02743018
027440*  GET PARM THAT PROVIDES TEXT AND DIVERT CODE FOR RF & EAS LABELS02744018
027450*----------------------------------------------------------------*02745018
027460 3810-TKRPRPM-RFEACR-LBL-INFO.                                    02746018
027470                                                                  02747018
027480     EXEC SQL                                                     02748018
027490          SELECT FUNC_TXT                                         02749018
027500          INTO  :KRPRPM-FUNC-TXT                                  02750018
027510          FROM   TKRPRPM                                          02751018
027520          WHERE  SYS_PRC_FUNC_CDE  = 'RFEACR'                     02752018
027530            AND  INTFC_SYS_CDE     = 'KHL'                        02753018
027540            AND  FUNC_PRC_STAT_CDE = 'AC'                         02754018
027550            AND  LOC_ID            =  :KRPRPM-LOC-ID              02755018
027560     END-EXEC.                                                    02756018
027570                                                                  02757018
027580     EVALUATE TRUE                                                02758018
027590         WHEN SQLCODE = ZERO                                      02759018
027600            MOVE KRPRPM-FUNC-TXT (7:4) TO PV-RFID-DIVERT-CDE      02760018
027610            MOVE PV-RFID-DIVERT-CDE-N  TO PV-22-CRTN-DIVERT-CDE   02761018
027620            MOVE 0                     TO PV-22-CRTN-TYPE-IND     02762018
027630            MOVE PC140-RF-PO-NBR       TO PV-22-CRTN-PO-NBR       02763018
027640            MOVE PC140-RF-PO-RCVR      TO PV-22-CTRN-RCVR-SEQ-NBR 02764018
027650            MOVE PC140-RF-LNE-NBR      TO PV-22-CRTN-PO-LNE-NBR   02765018
027651            PERFORM 3812-LAST-4-OF-BARCODE-PARM                   02765120
027655            IF  PS-USE-LAST-4-FROM-TMST                           02765520
027656                PERFORM 3811-GET-LAST-4-OF-BARCODE                02765620
027659                MOVE PV-CURRENT-TMST-R-LAST-4                     02765920
027660                                    TO PV-22-CRTN-CART-NBR        02766020
027661            ELSE                                                  02766120
027663                MOVE 0000 TO PV-22-CRTN-CART-NBR                  02766320
027664            END-IF                                                02766420
027670            MOVE PV-22-DIGIT-BARCODE   TO DK-BARCODE-NBR          02767018
027680                                                                  02768018
027690         WHEN SQLCODE = +100                                      02769018
027700            MOVE 'XXXX'                TO PV-RFID-DIVERT-CDE      02770018
027710                                                                  02771018
027720         WHEN SQLWARN0 NOT = SPACES                               02772018
027730         WHEN SQLCODE < ZERO                                      02773018
027740         WHEN SQLCODE > ZERO                                      02774018
027750             MOVE 'TKRPRPM'            TO PV-DISP-TABLE-1         02775018
027760             PERFORM 9955-SQL-ERROR                               02776018
027770     END-EVALUATE.                                                02777018
027780                                                                  02778018
027790*-----------------------------------------------------------------02779018
027800*  FORMAT HEADER LABEL.                                           02780018
027810*-----------------------------------------------------------------02781018
027820 3400-FMAT-COM-HEADER-LABEL.                                      02782018
027830     STRING                                                       02783018
027840            ' 3400-FMAT-COM-HEADER-LABEL'                         02784018
027850     DELIMITED BY SIZE                                            02785018
027860     INTO PV-CICS-MSG-AREA                                        02786018
027870     PERFORM 9990-WRITE-CICS                                      02787018
027880                                                                  02788018
027890     STRING ' PCKCS707 - '        DELIMITED BY SIZE               02789018
027900            'RETURN CODE - '      DELIMITED BY SIZE               02790018
027910            PV-RETCODE            DELIMITED BY SIZE               02791018
027920            'ERROR NUMBER - '     DELIMITED BY SIZE               02792018
027930            PV-RETCODE            DELIMITED BY SIZE               02793018
027940                                  INTO PV-CICS-MSG-AREA.          02794018
027950     PERFORM 9990-WRITE-CICS.                                     02795018
027960                                                                  02796018
027970      MOVE KRPRPM-FUNC-QTY       TO PC154-HEAD-COM-TOT-LBL.       02797018
027990      STRING PC140-CRA-DC-ID       DELIMITED BY SIZE              02799018
028000             '-'                   DELIMITED BY SIZE              02800018
028010             PC140-HL-PRTR-ID      DELIMITED BY SIZE              02801018
028020                               INTO PC154-HEAD-COM-PRINTER-ID.    02802018
028030      STRING PC140-HL-PO-NBR         DELIMITED BY SIZE            02803018
028040             PC140-HL-RCVR-SEQ-NBR-TX                             02804018
028050                                     DELIMITED BY SIZE            02805018
028060                                   INTO  PV-RECEIVER-NBR-X.       02806018
028070      MOVE PV-RECEIVER-NBR-X     TO PC154-HEAD-COM-RCVR-BC1       02807018
028080                                    PC154-HEAD-COM-RCVR.          02808018
028090      MOVE PC140-HL-CART-CT      TO PC154-HEAD-COM-TOT-LBLS.      02809018
028100      MOVE PC140-HL-VEND-NAME    TO PC154-HEAD-COM-VENDOR-NAME.   02810018
028110                                                                  02811018
028120      MOVE PC140-HL-RCVD-MM-DD-YY      TO PV-DATE-MM-DD-YY.       02812018
028130      IF  PC140-HL-RCVD-MM-DD-YY = 'ENROUTE '                     02813018
028140          STRING 'RCVD ENROUTE'          DELIMITED BY SIZE        02814018
028150                    INTO PC154-HEAD-COM-RCVD-DATE                 02815018
028160      ELSE                                                        02816018
028170      IF  PV-DATE-MM > SPACES                                     02817018
028180          MOVE PV-DATE-YY              TO PV-DATE-PRINT-YY2       02818018
028190          MOVE PV-DATE-MM              TO PV-DATE-PRINT-MM2       02819018
028200          MOVE PV-DATE-DD              TO PV-DATE-PRINT-DD2       02820018
028210          STRING 'RCVD '                 DELIMITED BY SIZE        02821018
028220                 PV-DATE-PRINT-MM-DD-YY  DELIMITED BY SIZE        02822018
028230                    INTO PC154-HEAD-COM-RCVD-DATE                 02823018
028240      ELSE                                                        02824018
028250          MOVE SPACES                  TO                         02825018
028260                         PC154-HEAD-COM-RCVD-DATE                 02826018
028270      END-IF.                                                     02827018
028280                                                                  02828018
028290      MOVE PC140-HL-AD-MM-DD-YY        TO PV-DATE-MM-DD-YY.       02829018
028300      IF  PV-DATE-MM > SPACES                                     02830018
028310          MOVE PV-DATE-YY              TO PV-DATE-PRINT-YY2       02831018
028320          MOVE PV-DATE-MM              TO PV-DATE-PRINT-MM2       02832018
028330          MOVE PV-DATE-DD              TO PV-DATE-PRINT-DD2       02833018
028340          STRING 'AD DT '                DELIMITED BY SIZE        02834018
028350                 PV-DATE-PRINT-MM-DD-YY  DELIMITED BY SIZE        02835018
028360                    INTO PC154-HEAD-COM-AD-DATE                   02836018
028370      ELSE                                                        02837018
028380          MOVE SPACES                  TO PC154-HEAD-COM-AD-DATE  02838018
028390      END-IF.                                                     02839018
028400                                                                  02840018
028410      MOVE PC140-HL-PIC-TX       TO PC154-HEAD-COM-PICTURED.      02841018
028420      MOVE PC140-HL-PRE-TKT-TX   TO PC154-HEAD-COM-PRETICKETED.   02842018
028430      MOVE PC140-HL-PACKED-BY-TX TO PC154-HEAD-COM-PACKED-BY.     02843018
028440      MOVE PC140-HL-ON-HANGER-TX TO PC154-HEAD-COM-ON-HANGER.     02844018
028450      MOVE PC140-HL-PRC-AREA-TX  TO PC154-HEAD-COM-PROCESS-AREA.  02845018
028460      MOVE PC140-HL-TRIP-ID      TO PC154-HEAD-COM-TRIP-ID.       02846018
028470      MOVE PC140-HL-MULT-SHIPMENTS-TX TO                          02847018
028480                                    PC154-HEAD-COM-MULT-SHIPMENTS.02848018
028490      MOVE PC140-HL-SPECIAL-TX   TO PC154-HEAD-COM-SPECIAL-INSTR. 02849018
028500      STRING PC140-HL-PO-NBR       DELIMITED BY SIZE              02850018
028510             '-'                   DELIMITED BY SIZE              02851018
028520             PC140-HL-RCVR-SEQ-NBR-TX     DELIMITED BY SIZE       02852018
028530                               INTO PC154-HEAD-COM-PO-RCVR-SEQ.   02853018
028540      MOVE PC140-HL-DETAIL-CHECK TO PC154-HEAD-COM-DETAIL-CHECK.  02854018
028550      MOVE PC140-HL-TICKET-TYPE  TO PC154-HEAD-COM-TICKET-TYPE.   02855018
028560      STRING PC140-HL-DEPT         DELIMITED BY SIZE              02856018
028570             '-'                   DELIMITED BY SIZE              02857018
028580             PC140-HL-CLASS        DELIMITED BY SIZE              02858018
028590                               INTO PC154-HEAD-COM-DEPT-CLASS.    02859018
028600                                                                  02860018
028610*-----------------------------------------------------------------02861018
028620*  FORMAT CARTON LABEL.                                           02862018
028630*-----------------------------------------------------------------02863018
028640 3500-FMAT-COM-CARTON-LABEL.                                      02864018
028650     STRING                                                       02865018
028660            ' 3500-FMAT-COM-CARTON-LABEL'                         02866018
028670     DELIMITED BY SIZE                                            02867018
028680     INTO PV-CICS-MSG-AREA                                        02868018
028690     PERFORM 9990-WRITE-CICS                                      02869018
028700                                                                  02870018
028710     STRING ' PCKCS707 - '        DELIMITED BY SIZE               02871018
028720            'RETURN CODE - '      DELIMITED BY SIZE               02872018
028730            PV-RETCODE            DELIMITED BY SIZE               02873018
028740            'ERROR NUMBER - '     DELIMITED BY SIZE               02874018
028750            PV-RETCODE            DELIMITED BY SIZE               02875018
028760                                  INTO PV-CICS-MSG-AREA.          02876018
028770     PERFORM 9990-WRITE-CICS.                                     02877018
028780                                                                  02878018
028790     MOVE PV-LBL-PRT-DATE          TO PC157-LBL-PRT-DATE.         02879018
028800     MOVE PV-LBL-PRT-TIME          TO PC157-LBL-PRT-TIME.         02880018
028810                                                                  02881018
028820      STRING PC140-CRA-DC-ID       DELIMITED BY SIZE              02882018
028830             '-'                   DELIMITED BY SIZE              02883018
028840             PC140-CL-PRTR-ID      DELIMITED BY SIZE              02884018
028850                               INTO PC157-PRINTER-NBR.            02885018
028860      MOVE PC140-CL-STRT-VALUE   TO PV-ZZZ9.                      02886018
028870      MOVE PV-ZZZ9               TO PC157-START-CNTN-NBR.         02887018
028880      MOVE PC140-CL-TOT-LBLS     TO PC157-QTY-TOT-LBLS.           02888018
028890                                                                  02889018
028900      MOVE PC140-CL-RCVD-MM-DD-YY      TO PV-DATE-MM-DD-YY.       02890018
028910      IF  PV-DATE-MM > SPACES                                     02891018
028920          MOVE PV-DATE-YY              TO PV-DATE-PRINT-YY2       02892018
028930          MOVE PV-DATE-MM              TO PV-DATE-PRINT-MM2       02893018
028940          MOVE PV-DATE-DD              TO PV-DATE-PRINT-DD2       02894018
028950          STRING PV-DATE-PRINT-MM-DD-YY  DELIMITED BY SIZE        02895018
028960                    INTO PC157-RCVD-DTE                           02896018
028970      ELSE                                                        02897018
028980          MOVE SPACES                  TO                         02898018
028990                         PC157-RCVD-DTE                           02899018
029000      END-IF.                                                     02900018
029010                                                                  02901018
029020      MOVE PC140-CL-PO-NBR       TO PC157-PO-NBR.                 02902018
029030      MOVE PC140-CL-RCVR-SEQ-NBR TO PC157-RECV-SEQ-NBR.           02903018
029040      MOVE PC140-CL-PO-LINE-NBR  TO PC157-PO-LNE-NBR.             02904018
029050      MOVE PC140-CL-PRC-AREA     TO PC157-PROCESS-AREA.           02905018
029060      MOVE PC140-CL-OF-TOT-LBLS  TO PV-ZZZ9.                      02906018
029070      MOVE PV-ZZZ9               TO PC157-END-CNTN-NBR.           02907018
029080      STRING '('                                                  02908018
029090            PC140-CL-DEPT                                         02909018
029100             '-'                                                  02910018
029110            PC140-CL-CLASS                                        02911018
029120             ')'                                                  02912018
029130             PC140-CL-SKU DELIMITED BY SIZE                       02913018
029140                                 INTO PC157-SKU                   02914018
029160                                                                  02916018
029190      MOVE PC140-CL-DIVERT-CDE   TO PC157-BC-DIVERT-CODE          02919018
029200                                    PC157-DIVERT-CODE.            02920018
029210      MOVE PC140-CL-PO-NBR       TO PC157-BC-PO-NBR               02921018
029220                                    PC157-PO-NBR-X.               02922018
029230      MOVE PC140-CL-RCVR-SEQ-NBR TO PV-RCVR-SEQ-NBR.              02923018
029240      MOVE PV-2-DGT-RCVR-SEQ-NBR TO PC157-BC-RECV-SEQ-NBR         02924018
029250                                    PC157-RECV-SEQ-NBR-X.         02925018
029260      MOVE PC140-CL-PO-LINE-NBR  TO PV-PO-LNE-NBR.                02926018
029270      MOVE PV-3-DGT-PO-LNE-NBR   TO PC157-BC-PO-LNE-NBR           02927018
029280                                    PC157-PO-LNE-NBR-X.           02928018
029290      MOVE PC140-CL-STRT-VALUE   TO PC157-BC-START-CARTON-CNT     02929018
029300                                    PC157-START-CARTON-CNT.       02930018
029310                                                                  02931018
029320                                                                  02932018
029330*-----------------------------------------------------------------02933018
029340*       FORMAT THE COMMON MISCELLANEOUS LABEL                     02934018
029350*-----------------------------------------------------------------02935018
029360 3600-FMAT-COM-MISC-LABEL.                                        02936018
029370                                                                  02937018
029380     STRING                                                       02938018
029390            ' 3600-FMAT-COM-MISC-LABEL'                           02939018
029400     DELIMITED BY SIZE                                            02940018
029410     INTO PV-CICS-MSG-AREA                                        02941018
029420     PERFORM 9990-WRITE-CICS                                      02942018
029430                                                                  02943018
029440     STRING ' PCKCS707 - '         DELIMITED BY SIZE              02944018
029450            'RETURN CODE - '       DELIMITED BY SIZE              02945018
029460            PV-RETCODE             DELIMITED BY SIZE              02946018
029470            'ERROR NUMBER - '      DELIMITED BY SIZE              02947018
029480            PV-RETCODE             DELIMITED BY SIZE              02948018
029490                                   INTO PV-CICS-MSG-AREA.         02949018
029500     PERFORM 9990-WRITE-CICS.                                     02950018
029510                                                                  02951018
029520     STRING PC140-CRA-DC-ID           DELIMITED BY SIZE           02952018
029530            '-'                       DELIMITED BY SIZE           02953018
029540            PC140-ML-PRTR-ID          DELIMITED BY SIZE           02954018
029550                                 INTO PC164-PRTR-NBR.             02955018
029560                                                                  02956018
029570     MOVE PC164-PRTR-NBR           TO PC190-PRTR-NBR.             02957018
029580                                                                  02958018
029590     MOVE PC140-CRA-USERID         TO PC164-USER-ID               02959018
029600                                      PC190-USER-ID.              02960018
029610                                                                  02961018
029620     MOVE PV-LBL-PRT-DATE          TO PC164-LBL-PRT-DATE          02962018
029630                                      PC190-LBL-PRT-DATE.         02963018
029640     MOVE PV-LBL-PRT-TIME          TO PC164-LBL-PRT-TIME          02964018
029650                                      PC190-LBL-PRT-TIME.         02965018
029660     MOVE PC140-ML-DESC1           TO PC165-DESC-LNE-1            02966018
029670                                      PC191-DESC-LNE-1.           02967018
029680     MOVE PC140-ML-DESC2           TO PC165-DESC-LNE-2            02968018
029690                                      PC191-DESC-LNE-2.           02969018
029700     MOVE PC140-ML-DESC3           TO PC165-DESC-LNE-3            02970018
029710                                      PC191-DESC-LNE-3.           02971018
029720     SET PS-RANGE-REQUESTED-NO     TO TRUE.                       02972018
029730     PERFORM 3605-DETERMINE-RANGE.                                02973018
029740     MOVE +1                TO                                    02974018
029750                                PC165-MISC-TOT-LABELS             02975018
029760                                PC191-MISC-TOT-LABELS             02976018
029770     IF PS-RANGE-REQUESTED-NO                                     02977018
029780        MOVE PC140-ML-START-LABEL-ID-HR  TO                       02978018
029790                                   PC165-3OF9-BC-NBR              02979018
029800                                   PC191-3OF9-BC-NBR              02980018
029850     END-IF.                                                      02985018
029851                                                                  02985129
029860*****THIS IS FOR A VARIABLE LENGTH BARCODE - SEND THE LENGTH TO   02986018
029870*****THE FORM WHETHER OR NOT THERE IS A RANGE REQUESTED.          02987018
029880     MOVE PC140-ML-START-LABEL-ID        TO WS-MISC.              02988018
029890     PERFORM 3636-FORMAT-BARCODE.                                 02989018
029900                                                                  02990018
029910*-----------------------------------------------------------------02991018
029920*       DETERMINE IF A RANGE WAS REQUESTED AND ALSO WHERE THE     02992018
029930*       VARIABLE PORTIONS OF THE HR AND BARCODE WILL BE.          02993018
029940*-----------------------------------------------------------------02994018
029950 3605-DETERMINE-RANGE.                                            02995018
029960                                                                  02996018
029970     STRING                                                       02997018
029980            ' 3605-DETERMINE-RANGE'                               02998018
029990     DELIMITED BY SIZE                                            02999018
030000     INTO PV-CICS-MSG-AREA                                        03000018
030010     PERFORM 9990-WRITE-CICS                                      03001018
030020                                                                  03002018
030030      IF PC140-ML-BEGIN-RANGE-NBR > SPACES                        03003018
030040         SET PS-RANGE-REQUESTED     TO TRUE                       03004018
030050      END-IF.                                                     03005018
030060                                                                  03006018
030070      IF PS-RANGE-REQUESTED                                       03007018
030080         EVALUATE PC140-ML-BEGIN-RANGE-POSN-HR                    03008018
030090             WHEN PC-01                                           03009018
030100                  MOVE PC140-ML-START-LABEL-ID-HR TO              03010018
030110                       PV-ML-HR-1                                 03011018
030120             WHEN PC-02                                           03012018
030130                  MOVE PC140-ML-START-LABEL-ID-HR TO              03013018
030140                       PV-ML-HR-2                                 03014018
030150             WHEN PC-03                                           03015018
030160                  MOVE PC140-ML-START-LABEL-ID-HR TO              03016018
030170                       PV-ML-HR-3                                 03017018
030180             WHEN PC-04                                           03018018
030190                  MOVE PC140-ML-START-LABEL-ID-HR TO              03019018
030200                       PV-ML-HR-4                                 03020018
030210             WHEN PC-05                                           03021018
030220                  MOVE PC140-ML-START-LABEL-ID-HR TO              03022018
030230                       PV-ML-HR-5                                 03023018
030240             WHEN PC-06                                           03024018
030250                  MOVE PC140-ML-START-LABEL-ID-HR TO              03025018
030260                       PV-ML-HR-6                                 03026018
030270             WHEN PC-07                                           03027018
030280                  MOVE PC140-ML-START-LABEL-ID-HR TO              03028018
030290                       PV-ML-HR-7                                 03029018
030300             WHEN PC-08                                           03030018
030310                  MOVE PC140-ML-START-LABEL-ID-HR TO              03031018
030320                       PV-ML-HR-8                                 03032018
030330             WHEN PC-09                                           03033018
030340                  MOVE PC140-ML-START-LABEL-ID-HR TO              03034018
030350                       PV-ML-HR-9                                 03035018
030360             WHEN PC-10                                           03036018
030370                  MOVE PC140-ML-START-LABEL-ID-HR TO              03037018
030380                       PV-ML-HR-10                                03038018
030390             WHEN PC-11                                           03039018
030400                  MOVE PC140-ML-START-LABEL-ID-HR TO              03040018
030410                       PV-ML-HR-11                                03041018
030420             WHEN PC-12                                           03042018
030430                  MOVE PC140-ML-START-LABEL-ID-HR TO              03043018
030440                       PV-ML-HR-12                                03044018
030450             WHEN PC-13                                           03045018
030460                  MOVE PC140-ML-START-LABEL-ID-HR TO              03046018
030470                       PV-ML-HR-13                                03047018
030480             WHEN PC-14                                           03048018
030490                  MOVE PC140-ML-START-LABEL-ID-HR TO              03049018
030500                       PV-ML-HR-14                                03050018
030510             WHEN PC-15                                           03051018
030520                  MOVE PC140-ML-START-LABEL-ID-HR TO              03052018
030530                       PV-ML-HR-15                                03053018
030540             WHEN PC-16                                           03054018
030550                  MOVE PC140-ML-START-LABEL-ID-HR TO              03055018
030560                       PV-ML-HR-16                                03056018
030570             WHEN PC-17                                           03057018
030580                  MOVE PC140-ML-START-LABEL-ID-HR TO              03058018
030590                       PV-ML-HR-17                                03059018
030640         END-EVALUATE                                             03064018
030650                                                                  03065018
030660         EVALUATE PC140-ML-BEGIN-RANGE-POSN-BC                    03066018
030670             WHEN PC-01                                           03067018
030680                  MOVE PC140-ML-START-LABEL-ID TO                 03068018
030690                       PV-ML-BC-1                                 03069018
030700             WHEN PC-02                                           03070018
030710                  MOVE PC140-ML-START-LABEL-ID TO                 03071018
030720                       PV-ML-BC-2                                 03072018
030730             WHEN PC-03                                           03073018
030740                  MOVE PC140-ML-START-LABEL-ID TO                 03074018
030750                       PV-ML-BC-3                                 03075018
030760             WHEN PC-04                                           03076018
030770                  MOVE PC140-ML-START-LABEL-ID TO                 03077018
030780                       PV-ML-BC-4                                 03078018
030790             WHEN PC-05                                           03079018
030800                  MOVE PC140-ML-START-LABEL-ID TO                 03080018
030810                       PV-ML-BC-5                                 03081018
030820             WHEN PC-06                                           03082018
030830                  MOVE PC140-ML-START-LABEL-ID TO                 03083018
030840                       PV-ML-BC-6                                 03084018
030850             WHEN PC-07                                           03085018
030860                  MOVE PC140-ML-START-LABEL-ID TO                 03086018
030870                       PV-ML-BC-7                                 03087018
030880             WHEN PC-08                                           03088018
030890                  MOVE PC140-ML-START-LABEL-ID TO                 03089018
030900                       PV-ML-BC-8                                 03090018
030910             WHEN PC-09                                           03091018
030920                  MOVE PC140-ML-START-LABEL-ID TO                 03092018
030930                       PV-ML-BC-9                                 03093018
030980         END-EVALUATE                                             03098018
030990      END-IF.                                                     03099018
031000                                                                  03100018
031010      IF PS-RANGE-REQUESTED                                       03101018
031020         INITIALIZE PV-TOT-LABELS-IN-RANGE                        03102018
031030         MOVE PC140-ML-BEGIN-RANGE-NBR TO PV-BEGIN-RANGE-NBR-N    03103018
031040         MOVE PC140-ML-END-RANGE-NBR   TO PV-END-RANGE-NBR-N      03104018
031050         COMPUTE  PV-TOT-LABELS-IN-RANGE  =                       03105018
031060         (PV-END-RANGE-NBR-N  - PV-BEGIN-RANGE-NBR-N)             03106018
031070         ADD 1   TO PV-TOT-LABELS-IN-RANGE                        03107018
031080      END-IF.                                                     03108018
031090                                                                  03109018
031100*-----------------------------------------------------------------03110018
031110*       DETERMINE WHAT RANGE WAS REQUESTED. MOVE THE INPUT TO     03111018
031120*       THE APPROPRIATE RACK LABEL WS LAYOUT FOR HR AND BC.       03112018
031130*-----------------------------------------------------------------03113018
031140 3610-DETERMINE-RANGE-RL.                                         03114018
031150                                                                  03115018
031160     STRING                                                       03116018
031170            ' 3610-DETERMINE-RANGE-RL'                            03117018
031180     DELIMITED BY SIZE                                            03118018
031190     INTO PV-CICS-MSG-AREA                                        03119018
031200     PERFORM 9990-WRITE-CICS                                      03120018
031210                                                                  03121018
031220      IF PC140-RL-BEGIN-RANGE-NBR > SPACES                        03122018
031230         SET PS-RANGE-REQUESTED     TO TRUE                       03123018
031240      END-IF.                                                     03124018
031250                                                                  03125018
031260      IF PS-RANGE-REQUESTED                                       03126018
031270         MOVE PC140-RL-START-LABEL-ID-HR TO PV-RL-HR              03127018
031280         MOVE PC140-RL-START-LABEL-ID    TO PV-RL-BC              03128018
031290      END-IF.                                                     03129018
031300                                                                  03130018
031310      IF PS-RANGE-REQUESTED                                       03131018
031320         INITIALIZE PV-TOT-LABELS-IN-RANGE                        03132018
031330                    PV-BEGIN-SLOT-NBR-N                           03133018
031340                    PV-END-SLOT-NBR-N                             03134018
031350         MOVE PC140-RL-BEGIN-RANGE-NBR TO PV-BEGIN-SLOT-NBR-N     03135018
031360         MOVE PC140-RL-END-RANGE-NBR   TO PV-END-SLOT-NBR-N       03136018
031370         COMPUTE  PV-TOT-LABELS-IN-RANGE  =                       03137018
031380         (PV-END-SLOT-NBR-N   - PV-BEGIN-SLOT-NBR-N)              03138018
031390         ADD 1   TO PV-TOT-LABELS-IN-RANGE                        03139018
031400      END-IF.                                                     03140018
031410                                                                  03141018
031420*-----------------------------------------------------------------03142018
031430* THIS NEEDS TO BE DONE TO SEND TO THE SOCKET A BARCODE LESS THAN 03143018
031440* 12 CHARS. THE BARCODE WILL BE AS LONG AS THE DATA SENT FOR THE  03144018
031450* REQUESTED LABEL, NOT PADDED WITH TRAILING SPACES. THE DUMMY LINE03145018
031460* IN THE COPYBOOKS IS A PLACE HOLDER. THE VARIABLE BARCODE LENGTH 03146018
031470* WILL NOT BE SENT PROPERLY TO THE SOCKET IF THE VARIABLE FIELD   03147018
031480* IS AT THE END OF A LINE (1 OF THE "STATEMENTS" READ BY THE      03148018
031490* SYSTEC SOFTWARE). NOTICE THAT THE SML AND USR LABELS ARE NOT    03149018
031500* AT THE END OF A TRANSMISSION LINE. BEFORE THE ADDITON OF THE    03150018
031510* DUMMY FIELD, THE VARIABLE BARCODE WAS STILL SHOWING TRAILING    03151018
031520* SPACES OR THERE WAS A VARIETY OF LENGTH ERROR (502) PROBLEMS.   03152018
031530*-----------------------------------------------------------------03153018
031540 3636-FORMAT-BARCODE.                                             03154018
031550     STRING                                                       03155018
031560            ' 3636-FORMAT-BARCODE'                                03156018
031570     DELIMITED BY SIZE                                            03157018
031580     INTO PV-CICS-MSG-AREA                                        03158018
031590     PERFORM 9990-WRITE-CICS                                      03159018
031600                                                                  03160018
031610      IF WS-MISC12 NOT = SPACE AND WS-MISC12 NOT = LOW-VALUES     03161018
031620          STRING WS-MISC(1:12)        DELIMITED BY SIZE           03162018
031630                 PC-EOD               DELIMITED BY SIZE           03163018
031640                               INTO PC165-3OF9-BC                 03164018
031650          STRING 'XXXXXXXXXXXX'    DELIMITED BY SIZE              03165018
031660                 PC-EOD               DELIMITED BY SIZE           03166018
031670                               INTO PC164-3OF9-BC                 03167018
031680      ELSE                                                        03168018
031690      IF WS-MISC11 NOT = SPACE AND WS-MISC11 NOT = LOW-VALUES     03169018
031700          STRING WS-MISC(1:11)        DELIMITED BY SIZE           03170018
031710                 PC-EOD               DELIMITED BY SIZE           03171018
031720                               INTO PC165-3OF9-BC                 03172018
031730          STRING 'XXXXXXXXXXX'     DELIMITED BY SIZE              03173018
031740                 PC-EOD               DELIMITED BY SIZE           03174018
031750                               INTO PC164-3OF9-BC                 03175018
031760      ELSE                                                        03176018
031770      IF WS-MISC10 NOT = SPACE AND WS-MISC10 NOT = LOW-VALUES     03177018
031780          STRING WS-MISC(1:10)        DELIMITED BY SIZE           03178018
031790                 PC-EOD               DELIMITED BY SIZE           03179018
031800                               INTO PC165-3OF9-BC                 03180018
031810          STRING 'XXXXXXXXXX'      DELIMITED BY SIZE              03181018
031820                 PC-EOD               DELIMITED BY SIZE           03182018
031830                               INTO PC164-3OF9-BC                 03183018
031840      ELSE                                                        03184018
031850      IF WS-MISC9 NOT = SPACE AND WS-MISC9 NOT = LOW-VALUES       03185018
031860          STRING WS-MISC(1:9)         DELIMITED BY SIZE           03186018
031870                 PC-EOD               DELIMITED BY SIZE           03187018
031880                               INTO PC165-3OF9-BC                 03188018
031890          STRING 'XXXXXXXXX'       DELIMITED BY SIZE              03189018
031900                 PC-EOD               DELIMITED BY SIZE           03190018
031910                               INTO PC164-3OF9-BC                 03191018
031920      ELSE                                                        03192018
031930      IF WS-MISC8 NOT = SPACE AND WS-MISC8 NOT = LOW-VALUES       03193018
031940          STRING WS-MISC(1:8)         DELIMITED BY SIZE           03194018
031950                 PC-EOD               DELIMITED BY SIZE           03195018
031960                               INTO PC165-3OF9-BC                 03196018
031970          STRING 'XXXXXXXX'        DELIMITED BY SIZE              03197018
031980                 PC-EOD               DELIMITED BY SIZE           03198018
031990                               INTO PC164-3OF9-BC                 03199018
032000      ELSE                                                        03200018
032010      IF WS-MISC7 NOT = SPACE AND WS-MISC7 NOT = LOW-VALUES       03201018
032020          STRING WS-MISC(1:7)         DELIMITED BY SIZE           03202018
032030                 PC-EOD               DELIMITED BY SIZE           03203018
032040                               INTO PC165-3OF9-BC                 03204018
032050          STRING 'XXXXXXX'         DELIMITED BY SIZE              03205018
032060                 PC-EOD               DELIMITED BY SIZE           03206018
032070                               INTO PC164-3OF9-BC                 03207018
032080      ELSE                                                        03208018
032090      IF WS-MISC6 NOT = SPACE AND WS-MISC6 NOT = LOW-VALUES       03209018
032100          STRING WS-MISC(1:6)         DELIMITED BY SIZE           03210018
032110                 PC-EOD               DELIMITED BY SIZE           03211018
032120                               INTO PC165-3OF9-BC                 03212018
032130          STRING 'XXXXXX'          DELIMITED BY SIZE              03213018
032140                 PC-EOD               DELIMITED BY SIZE           03214018
032150                               INTO PC164-3OF9-BC                 03215018
032160      ELSE                                                        03216018
032170      IF WS-MISC5 NOT = SPACE AND WS-MISC5 NOT = LOW-VALUES       03217018
032180          STRING WS-MISC(1:5)         DELIMITED BY SIZE           03218018
032190                 PC-EOD               DELIMITED BY SIZE           03219018
032200                               INTO PC165-3OF9-BC                 03220018
032210          STRING 'XXXXX'           DELIMITED BY SIZE              03221018
032220                 PC-EOD               DELIMITED BY SIZE           03222018
032230                               INTO PC164-3OF9-BC                 03223018
032240      ELSE                                                        03224018
032250      IF WS-MISC4 NOT = SPACE AND WS-MISC4 NOT = LOW-VALUES       03225018
032260          STRING WS-MISC(1:4)         DELIMITED BY SIZE           03226018
032270                 PC-EOD               DELIMITED BY SIZE           03227018
032280                               INTO PC165-3OF9-BC                 03228018
032290          STRING 'XXXX'            DELIMITED BY SIZE              03229018
032300                 PC-EOD               DELIMITED BY SIZE           03230018
032310                               INTO PC164-3OF9-BC                 03231018
032320      ELSE                                                        03232018
032330      IF WS-MISC3 NOT = SPACE AND WS-MISC3 NOT = LOW-VALUES       03233018
032340          STRING WS-MISC(1:3)         DELIMITED BY SIZE           03234018
032350                 PC-EOD               DELIMITED BY SIZE           03235018
032360                               INTO PC165-3OF9-BC                 03236018
032370          STRING 'XXX'             DELIMITED BY SIZE              03237018
032380                 PC-EOD               DELIMITED BY SIZE           03238018
032390                               INTO PC164-3OF9-BC                 03239018
032400      ELSE                                                        03240018
032410      IF WS-MISC2 NOT = SPACE AND WS-MISC2 NOT = LOW-VALUES       03241018
032420          STRING WS-MISC(1:2)         DELIMITED BY SIZE           03242018
032430                 PC-EOD               DELIMITED BY SIZE           03243018
032440                               INTO PC165-3OF9-BC                 03244018
032450          STRING 'XX'              DELIMITED BY SIZE              03245018
032460                 PC-EOD               DELIMITED BY SIZE           03246018
032470                               INTO PC164-3OF9-BC                 03247018
032480      ELSE                                                        03248018
032490          STRING WS-MISC(1:1)         DELIMITED BY SIZE           03249018
032500                 PC-EOD               DELIMITED BY SIZE           03250018
032510                               INTO PC165-3OF9-BC                 03251018
032520          STRING 'X'               DELIMITED BY SIZE              03252018
032530                 PC-EOD               DELIMITED BY SIZE           03253018
032540                               INTO PC164-3OF9-BC                 03254018
032550      END-IF.                                                     03255018
032560                                                                  03256018
032570*-----------------------------------------------------------------03257018
032580*       FORMAT THE COMMON RACK LOCATION LABEL                     03258018
032590*-----------------------------------------------------------------03259018
032600 3700-FMAT-COM-RACK-LABEL.                                        03260018
032610                                                                  03261018
032620     STRING                                                       03262018
032630            ' 3700-FMAT-COM-RACK-LABEL'                           03263018
032640     DELIMITED BY SIZE                                            03264018
032650     INTO PV-CICS-MSG-AREA                                        03265018
032660     PERFORM 9990-WRITE-CICS                                      03266018
032670                                                                  03267018
032680     STRING ' PCKCS707 - '         DELIMITED BY SIZE              03268018
032690            'RETURN CODE - '       DELIMITED BY SIZE              03269018
032700            PV-RETCODE             DELIMITED BY SIZE              03270018
032710            'ERROR NUMBER - '      DELIMITED BY SIZE              03271018
032720            PV-RETCODE             DELIMITED BY SIZE              03272018
032730                                   INTO PV-CICS-MSG-AREA.         03273018
032740     PERFORM 9990-WRITE-CICS.                                     03274018
032750                                                                  03275018
032760     STRING PC140-CRA-DC-ID           DELIMITED BY SIZE           03276018
032770            '-'                       DELIMITED BY SIZE           03277018
032780            PC140-RL-PRTR-ID          DELIMITED BY SIZE           03278018
032790                                 INTO PC167-PRTR-NBR.             03279018
032800                                                                  03280018
032810     MOVE PC140-CRA-USERID         TO PC167-USER-ID.              03281018
032820                                                                  03282018
032830     MOVE PV-LBL-PRT-DATE          TO PC167-LBL-PRT-DATE.         03283018
032840     MOVE PV-LBL-PRT-TIME          TO PC167-LBL-PRT-TIME.         03284018
032850     SET PS-RANGE-REQUESTED-NO     TO TRUE.                       03285018
032860     PERFORM 3610-DETERMINE-RANGE-RL.                             03286018
032870     IF PS-RANGE-REQUESTED-NO                                     03287018
032880        MOVE PC140-RL-START-LABEL-ID-HR  TO                       03288018
032890                                   PC168-3OF9-BC-NBR              03289018
032900        MOVE PC140-RL-START-LABEL-ID     TO PC168-3OF9-BC         03290018
032910                                   PC168-3OF9-BC                  03291018
032920     END-IF.                                                      03292018
032930     MOVE PC140-RL-TOT-LBLS        TO PC168-RACK-TOT-LABELS.      03293018
032940                                                                  03294018
032950                                                                  03295018
032960*----------------------------------------------------------------*03296018
032970* FORMAT BLIND RECEIPT LABEL ROUTINE                              03297018
032980*----------------------------------------------------------------*03298018
032990 3800-FMAT-BLIND-RECEIPT-LABEL.                                   03299018
033000                                                                  03300018
033010     STRING                                                       03301018
033020            ' 3800-FMAT-BLIND-RECEIPT-LABEL'                      03302018
033030     DELIMITED BY SIZE                                            03303018
033040     INTO PV-CICS-MSG-AREA                                        03304018
033050     PERFORM 9990-WRITE-CICS                                      03305018
033060                                                                  03306018
033070     MOVE PC140-BR-STORE-NAME          TO PC189-SML-STR-NME.      03307018
033080     MOVE PC140-CS-EC-LOC              TO PC189-SML-STR-NBR.      03308018
033090                                                                  03309018
033100     MOVE PC140-20-SML-CONTAINER-CDE TO                           03310018
033110                                   PC160-20-SML-NBR-CONTAINER-CDE.03311018
033120                                                                  03312018
033130     SET PC160-20-SML-NBR-INTERNAL-LBL                            03313018
033140         PC160-20-SML-NBR-FROM-KOHLS                              03314018
033150         PC160-20-SML-INTERNAL-LBL                                03315018
033160         PC160-20-SML-FROM-KOHLS                                  03316018
033170         PC189-AUDIT-COMPLETE             TO TRUE.                03317018
033200                                                                  03320018
033210     MOVE PC140-20-SML-BC-DIVERT-PFX TO                           03321018
033220                                   PC160-20-SML-NBR-BC-DIVERT-PFX.03322018
033230     MOVE PC140-20-SML-BC-DIVERT-CDE TO                           03323018
033240                                   PC160-20-SML-NBR-BC-DIVERT-CDE.03324018
033250     MOVE PC140-20-SML-BC-DC-ORIGIN  TO                           03325018
033260                                    PC160-20-SML-NBR-BC-DC-ORIGIN.03326018
033270     MOVE PC140-20-SML-BC-MNFST-NBR  TO                           03327018
033280                                    PC160-20-SML-NBR-BC-MNFST-NBR.03328018
033290     MOVE PC160-20-DIGIT-BARCODE-NBR TO PC189-SML-BC-NBR.         03329018
033300     MOVE PC140-STARTING-BARCODE     TO PC189-SML-BC.             03330018
033310     MOVE +1                           TO PC189-LABEL-NUMBER-N.   03331018
033320     MOVE PC140-LBL-CNT-N              TO PC189-TOT-LBL-CNT       03332018
033330                                          PC189-SML-TOT-LBLS      03333018
033340                                          PC158-TOT-LBL-CNT.      03334018
033350     MOVE PC158-FORM-OF                TO PC158-LABEL-CNT.        03335018
033360                                                                  03336018
033370     IF  PC140-CS-EC-LOC-TYPE  = PC-C                             03337018
033380         MOVE 'BR-CTL STK'             TO PC189-SML-LBL-DESC      03338018
033390         MOVE PC189-ZONE-HDG-VALUE     TO PC189-ZONE-STRG-HDG     03339018
033400         IF  PC140-STORE-ZONE  >  SPACES                          03340018
033410             MOVE PC140-STORE-ZONE     TO PC189-ZONE-STRG-DESC    03341018
033420                                          PC158-STR-ZN-ID         03342018
033430         ELSE                                                     03343018
033440             MOVE '@@@@@'              TO PC189-ZONE-STRG-DESC    03344018
033450                                          PC158-STR-ZN-ID         03345018
033460         END-IF                                                   03346018
033470     ELSE                                                         03347018
033480         MOVE 'BR-E COMM '             TO PC189-SML-LBL-DESC      03348018
033490         MOVE PC189-STORAGE-HDG-VALUE  TO PC189-ZONE-STRG-HDG     03349018
033500         IF  PC140-STORAGE-CODE  >  SPACES                        03350018
033510             MOVE PC140-STORAGE-CODE   TO PC189-ZONE-STRG-DESC    03351018
033520                                          PC158-STR-ZN-ID         03352018
033530         ELSE                                                     03353018
033540             MOVE '@@@@@'              TO PC189-ZONE-STRG-DESC    03354018
033550                                          PC158-STR-ZN-ID         03355018
033560         END-IF                                                   03356018
033570     END-IF.                                                      03357018
033580                                                                  03358018
033590     MOVE PC140-PO-NBR-N              TO DK-PO-NBR-Z.             03359018
033600     IF PC140-RCVR-SEQ  = ZEROES                                  03360018
033610         MOVE DK-PO-NBR-Z            TO PC158-PO-RCVR-NBR         03361018
033620     ELSE                                                         03362018
033630         MOVE PC140-RCVR-SEQ         TO DK-RCVR-NBR               03363018
033640         STRING DK-PO-NBR-Z              DELIMITED BY SIZE        03364018
033650                '-'                      DELIMITED BY SIZE        03365018
033660                DK-RCVR-NBR              DELIMITED BY SIZE        03366018
033670                                   INTO PC158-PO-RCVR-NBR         03367018
033680     END-IF.                                                      03368018
033690     MOVE PC158-PO-RCVR-NBR           TO PC189-PO-RCVR.           03369018
033700                                                                  03370018
033710     MOVE PC140-LNE-NBR               TO PC189-LINE-NUMBER-N      03371018
033720                                         PC158-PO-LNE-NBR.        03372018
033730                                                                  03373018
033740     MOVE PC140-SKU-NBR               TO DK-DEPT-CL-SKU-NBR.      03374018
033750     STRING '('                                                   03375018
033760            PC140-DEPT-NBR (2:3)                                  03376018
033770            '-'                                                   03377018
033780            PC140-BR-CLASS                                        03378018
033790            ')'                                                   03379018
033800            PC140-SKU-NBR                  DELIMITED BY SIZE      03380018
033810                                 INTO PC189-DEPT-CL-SKU.          03381018
033820     MOVE PC189-DEPT-CL-SKU           TO PC158-SKU-NBR.           03382018
033830                                                                  03383018
033840     MOVE PC140-STYLE                 TO PC189-STYLE              03384018
033850                                         PC158-STYLE.             03385018
033860     MOVE PC140-SKU-NBR               TO PC189-ITEM-NBR           03386018
033870                                         PC189-ITEM-NBR-BC        03387018
033880                                         PC158-ITEM-NBR-BC-NBR    03388018
033890                                         PC158-ITEM-NBR-BC.       03389018
033900     STRING PC140-PO-NBR                   DELIMITED BY SIZE      03390018
033910            ' '                            DELIMITED BY SIZE      03391018
033920            PC140-SKU-NBR                  DELIMITED BY SIZE      03392018
033930            ' '                            DELIMITED BY SIZE      03393018
033940            PC140-OTPK-UNTS                DELIMITED BY SIZE      03394018
033950                                      INTO PC189-PO-ITM-UNITS.    03395018
033960                                                                  03396018
033970     STRING PC140-PO-NBR                   DELIMITED BY SIZE      03397018
033980            PC140-SKU-NBR                  DELIMITED BY SIZE      03398018
033990            PC140-OTPK-UNTS                DELIMITED BY SIZE      03399018
034000                                      INTO PC189-PO-ITM-UNITS-BC. 03400018
034010                                                                  03401018
034020     MOVE PC-ERROR                    TO PC189-ERROR-MSG-1        03402018
034030                                         PC189-ERROR-MSG-2        03403018
034040                                         PC158-SML-LBL-DESC       03404018
034050                                         PC158-ZNE-STRG-HDG       03405018
034060                                         PC189-CARTON-NBR         03406018
034070                                         PC158-CRTN-HDG.          03407018
034080                                                                  03408018
034090     MOVE PC140-CURR-OPER-UNT-ID   TO DK-OPER-UNT-ID-4.           03409018
034100     STRING DK-OPER-UNT-ID-2         DELIMITED BY SIZE            03410018
034110            '-'                      DELIMITED BY SIZE            03411018
034120            PC140-BR-PRTR-ID         DELIMITED BY SIZE            03412018
034130                               INTO PC158-SML-PRTR-NBR.           03413018
034140                                                                  03414018
034150     MOVE PC158-FORM-NO-RPRT-BOX      TO PC158-REPRINT-BOX.       03415018
034160     MOVE PC158-FORM-NO-RPRT-FLD      TO PC158-REPRINT-TEXT.      03416018
034170     MOVE PC158-FORM-NO-INPK-BOX      TO PC158-INPK-CONVY-BOX.    03417018
034180     MOVE PC158-FORM-OTPK-HDG         TO PC158-INPK-CONVY-TEXT.   03418018
034190     MOVE PC140-OTPK-UNTS             TO PC158-PACK-UNT           03419018
034200                                         PC189-PACK-UNT.          03420018
034210                                                                  03421018
034230     MOVE PV-LBL-PRT-DATE             TO PC158-LBL-PRT-DATE.      03423018
034240     MOVE PV-LBL-PRT-TIME             TO PC158-LBL-PRT-TIME.      03424018
034250     MOVE PC158-FORM-NO-ODD-BOX       TO PC158-ODD-CARTON-BOX.    03425018
034260     MOVE PC158-FORM-NO-ODD-FLD       TO PC158-ODD-CARTON-FIELD.  03426018
034270     MOVE PC140-BR-USERID             TO PC158-USER-ID.           03427018
034281                                                                  03428120
034283******************************************************************03428320
034284* THE FOLLOWING IS GOING TO GET THE CURRENT TIMESTAMP AND         03428420
034285* THEN USE THE LAST 4 DIGITS OF THE NANO SECONDS TO PLUG          03428520
034286* INTO THE LAST 4 DIGITS OF THE 22 DIGIT BARCODE FOR RFID         03428620
034287* LABELS TO MAKE THE NUMBER AS UNIQUE AS POSSIBLE.                03428720
034288*                                                                 03428820
034289* THIS WAS DONE DUE TO A DUPLICATE BARCODE ISSUE BEING            03428920
034290* SEEN AT THE DC'S DUE TO THE ZERO IN THE LAST 4 DIGITS           03429020
034291* OF THE 22 DIGIT BARCODE NUMBER.                                 03429120
034292*                                                                 03429220
034293* ALSO ADDED LOGIC THAT IF THE LAST 4 DIGITS OF THE TIMESTAMP     03429320
034294* IS A VALUE LESS THAN 1000, THEN ADDED 1000 TO THE VALUE -       03429420
034295* WANTED TO MAKE SURE THAT IF THIS BARCODE EVER GOT INTO PACK-    03429520
034296* TO-LIGHT, IT COULD NOT BE USED TO LAUNCH THE LIGHTS ON THE      03429620
034297* MOD FOR A DISTRIBUTION.                                         03429720
034298*                                                                 03429820
034299******************************************************************03429920
034300                                                                  03430020
034301 3811-GET-LAST-4-OF-BARCODE.                                      03430120
034302                                                                  03430220
034303     EXEC SQL                                                     03430320
034304          SET :PV-CURRENT-TMST = CURRENT TIMESTAMP                03430420
034305     END-EXEC.                                                    03430520
034306                                                                  03430620
034307     MOVE PV-CURRENT-TMST TO PV-CURRENT-TMST-R.                   03430720
034308                                                                  03430820
034309     IF PV-CURRENT-TMST-R-LAST-4 < 1000                           03430920
034310        COMPUTE PV-CURRENT-TMST-R-LAST-4 =                        03431020
034311                PV-CURRENT-TMST-R-LAST-4 + 1000                   03431120
034312     END-IF.                                                      03431220
034313                                                                  03431320
034314******************************************************************03431420
034315* THIS PARAGRAPH WILL CHECK PARM RFIDMS TO SEE IF THE LAST 4      03431520
034316* DIGITS OF THE MICRO SECONDS FROM A TIMESTAMP SHOULD BE          03431620
034317* POPULATED TO THE LAST 4 DIGITS OF THE RFID LABEL BARCODE OR IF  03431720
034318* WE JUST POPULATE ZEROS.                                         03431820
034319******************************************************************03431920
034320                                                                  03432020
034321 3812-LAST-4-OF-BARCODE-PARM.                                     03432120
034322                                                                  03432220
034328     EXEC SQL                                                     03432820
034329          SELECT FUNC_END_TMST                                    03432920
034330          INTO  :KRPRPM-FUNC-END-TMST                             03433020
034331          FROM   TKRPRPM                                          03433120
034332          WHERE  SYS_PRC_FUNC_CDE  = 'RFIDMS'                     03433220
034333            AND  INTFC_SYS_CDE     = 'KHL'                        03433320
034334            AND  FUNC_PRC_STAT_CDE = 'AC'                         03433420
034335            AND  FUNC_TXT          = 'Y'                          03433520
034336            AND  LOC_ID            =  :KRPRPM-LOC-ID              03433620
034337     END-EXEC.                                                    03433720
034338                                                                  03433820
034339                                                                  03433920
034340     EVALUATE TRUE                                                03434020
034341         WHEN SQLCODE = ZERO                                      03434120
034342             SET PS-USE-LAST-4-FROM-TMST TO TRUE                  03434220
034344         WHEN SQLCODE = +100                                      03434420
034345             SET PS-USE-LAST-4-ZEROS TO TRUE                      03434520
034347         WHEN SQLWARN0 NOT = SPACES                               03434720
034348         WHEN SQLCODE < ZERO                                      03434820
034349         WHEN SQLCODE > ZERO                                      03434920
034350             MOVE 'TKRPRPM'            TO PV-DISP-TABLE-1         03435020
034351             PERFORM 9955-SQL-ERROR                               03435120
034352     END-EVALUATE.                                                03435220
034353                                                                  03435320
034354*----------------------------------------------------------------*03435418
034355* FORMAT TRAILER SERIAL LABEL ROUTINE                             03435518
034356*----------------------------------------------------------------*03435618
034357 3900-FMAT-TRAILER-SERIAL-LABEL.                                  03435718
034358                                                                  03435818
034359     STRING                                                       03435918
034360            ' 3900-FMAT-TRAILER-SERIAL-LABEL'                     03436018
034361     DELIMITED BY SIZE                                            03436118
034370     INTO PV-CICS-MSG-AREA                                        03437018
034380     PERFORM 9990-WRITE-CICS                                      03438018
034390                                                                  03439018
034400     MOVE PC140-TSN-SCAC               TO  PC197-SCAC.            03440018
034410     MOVE PC140-TSN-TRLR-ID            TO  PC197-TRLR-ID.         03441018
034420                                                                  03442018
034430     MOVE PC140-TSN-SERL-NBR           TO  PC197-TLR-DATA-BC      03443018
034440                                           PC197-TLR-DATA-BC-NBR. 03444018
034450                                                                  03445018
034460     MOVE PC-ERROR                     TO  PC196-TLR-FORM-BC.     03446018
034470     MOVE +1                           TO  PC197-TLR-TOT-LBL.     03447018
034480                                                                  03448018
034490     MOVE 'CN-TRLRSRL'                 TO  PC196-TLR-LBL-DESC.    03449018
034500                                                                  03450018
034510     STRING PC140-CRA-DC-ID           DELIMITED BY SIZE           03451018
034520            '-'                       DELIMITED BY SIZE           03452018
034530            PC140-TSN-PRTR-ID         DELIMITED BY SIZE           03453018
034540                                 INTO PC196-LBL-PRTR-NBR.         03454018
034550                                                                  03455018
034560     MOVE PV-LBL-PRT-DATE             TO PC196-LBL-PRT-DATE.      03456018
034570     MOVE PV-LBL-PRT-TIME             TO PC196-LBL-PRT-TIME.      03457018
034580     MOVE PC140-TSN-USERID            TO PC196-USER-ID.           03458018
034590                                                                  03459018
034600*----------------------------------------------------------------*03460018
034610* FORMAT RADIO FREQUENCY BLIND RECEIPT LABEL ROUTINE              03461018
034620*----------------------------------------------------------------*03462018
034630 3920-FMAT-RF-BLIND-RCPT-LABEL.                                   03463018
034640     MOVE PC140-RF-STR-NAME            TO PC189-SML-STR-NME.      03464018
034650     MOVE PC140-RF-STR-NBR             TO PV-4-DGT-STR-NBR.       03465018
034660     MOVE PV-4-DGT-STR-NBR             TO PC189-SML-STR-NBR.      03466018
034670                                                                  03467018
034680     MOVE PC140-RF-KOHLS-BARCODE   TO PC189-SML-BC                03468018
034690                                      PC160-20-DIGIT-BARCODE.     03469018
034700     MOVE PC160-20-SML-CONTAINER-CDE TO                           03470018
034710                                   PC160-20-SML-NBR-CONTAINER-CDE.03471018
034720     MOVE PC160-20-SML-PACKAGING-TYP TO                           03472018
034730                                   PC160-20-SML-NBR-PACKAGING-TYP.03473018
034740     MOVE PC160-20-SML-SOFTWARE-SRC  TO                           03474018
034750                                   PC160-20-SML-NBR-SOFTWARE-SRC. 03475018
034760     MOVE PC160-20-SML-BC-DIVERT  TO  PC160-20-SML-NBR-BC-DIVERT. 03476018
034770     MOVE PC160-20-SML-BC-DC-ORIGIN  TO                           03477018
034780                                   PC160-20-SML-NBR-BC-DC-ORIGIN. 03478018
034790     MOVE PC160-20-SML-BC-MNFST-NBR  TO                           03479018
034800                                   PC160-20-SML-NBR-BC-MNFST-NBR. 03480018
034810     MOVE PC160-20-DIGIT-BARCODE-NBR   TO PC189-SML-BC-NBR.       03481018
034820                                                                  03482018
034830     MOVE +1                           TO PC189-LABEL-NUMBER-N    03483018
034840                                          PC189-TOT-LBL-CNT       03484018
034850                                          PC189-SML-TOT-LBLS      03485018
034860                                          PC158-TOT-LBL-CNT.      03486018
034870     MOVE PC158-FORM-OF                TO PC158-LABEL-CNT.        03487018
034880                                                                  03488018
034890     IF  PC140-RF-CENTRAL-STK                                     03489018
034900         MOVE 'RF-CTL STK'             TO PC189-SML-LBL-DESC      03490018
034910         MOVE PC189-ZONE-HDG-VALUE     TO PC189-ZONE-STRG-HDG     03491018
034920     END-IF                                                       03492018
034930     IF  PC140-RF-E-COMMERCE                                      03493018
034940         MOVE 'RF-E COMM '             TO PC189-SML-LBL-DESC      03494018
034950         MOVE PC189-STORAGE-HDG-VALUE  TO PC189-ZONE-STRG-HDG     03495018
034960     END-IF.                                                      03496018
034970     IF  PC140-RF-ZONE  >  SPACES                                 03497018
034980         MOVE PC140-RF-ZONE        TO PC189-ZONE-STRG-DESC        03498018
034990                                      PC158-STR-ZN-ID             03499018
035000     ELSE                                                         03500018
035010         MOVE '@@@@@'              TO PC189-ZONE-STRG-DESC        03501018
035020                                      PC158-STR-ZN-ID             03502018
035030     END-IF                                                       03503018
035040                                                                  03504018
035050     MOVE PC140-RF-PO-NBR             TO DK-PO-NBR-Z.             03505018
035060     IF PC140-RF-PO-RCVR = ZEROES                                 03506018
035070         MOVE DK-PO-NBR-Z            TO PC158-PO-RCVR-NBR         03507018
035080     ELSE                                                         03508018
035090         MOVE PC140-RF-PO-RCVR       TO DK-RCVR-NBR               03509018
035100         STRING DK-PO-NBR-Z              DELIMITED BY SIZE        03510018
035110                '-'                      DELIMITED BY SIZE        03511018
035120                DK-RCVR-NBR              DELIMITED BY SIZE        03512018
035130                                   INTO PC158-PO-RCVR-NBR         03513018
035140     END-IF.                                                      03514018
035150     MOVE PC158-PO-RCVR-NBR           TO PC189-PO-RCVR.           03515018
035160                                                                  03516018
035170     MOVE PC140-RF-LNE-NBR            TO PC189-LINE-NUMBER-N      03517018
035180                                         PC158-PO-LNE-NBR.        03518018
035190                                                                  03519018
035200     IF PC140-RF-SKU > SPACES                                     03520018
035210         STRING '(' PC140-RF-DEPT                                 03521018
035220                '-' PC140-RF-CLASS                                03522018
035230                ')' PC140-RF-SKU          DELIMITED BY SIZE       03523018
035240                                      INTO PC189-DEPT-CL-SKU      03524018
035250         STRING '(' PC140-RF-DEPT                                 03525018
035260                '-' PC140-RF-CLASS                                03526018
035270                ')' PC140-RF-SKU          DELIMITED BY SIZE       03527018
035280                                      INTO PC158-SKU-NBR          03528018
035290     ELSE                                                         03529018
035300         MOVE SPACES                   TO PC189-DEPT-CL-SKU       03530018
035310                                          PC158-SKU-NBR           03531018
035320     END-IF.                                                      03532018
035330                                                                  03533018
035340     MOVE PC140-RF-SKU             TO PC189-ITEM-NBR              03534018
035350                                      PC189-ITEM-NBR-BC           03535018
035360                                      PC158-ITEM-NBR-BC-NBR       03536018
035370                                      PC158-ITEM-NBR-BC.          03537018
035380                                                                  03538018
035480     MOVE PC140-RF-PO-NBR  TO  PV-PO-NBR-DB2.                     03548018
035490     MOVE PV-PO-NBR-DB2    TO  PV-PO-NBR.                         03549018
035500     STRING PV-PO-NBR-X                    DELIMITED BY SIZE      03550018
035510            ' '                            DELIMITED BY SIZE      03551018
035520            PC189-ITEM-NBR                 DELIMITED BY SIZE      03552018
035530            ' '                            DELIMITED BY SIZE      03553018
035540            PC140-RF-OTPK-UNITS            DELIMITED BY SIZE      03554018
035550                                      INTO PC189-PO-ITM-UNITS.    03555018
035560                                                                  03556018
035570     STRING PV-PO-NBR-X                    DELIMITED BY SIZE      03557018
035580            PC189-ITEM-NBR                 DELIMITED BY SIZE      03558018
035590            PC140-RF-OTPK-UNITS            DELIMITED BY SIZE      03559018
035600                                      INTO PC189-PO-ITM-UNITS-BC. 03560018
035610                                                                  03561018
035620     MOVE PC140-RF-STYLE              TO PC189-STYLE              03562018
035630                                         PC158-STYLE.             03563018
035640     MOVE PC-ERROR                    TO PC189-ERROR-MSG-1        03564018
035650                                         PC189-ERROR-MSG-2        03565018
035660                                         PC158-SML-LBL-DESC       03566018
035670                                         PC158-ZNE-STRG-HDG       03567018
035680                                         PC189-CARTON-NBR         03568018
035690                                         PC158-CRTN-HDG.          03569018
035700                                                                  03570018
035710     STRING PC140-CRA-DC-ID           DELIMITED BY SIZE           03571018
035720            '-'                       DELIMITED BY SIZE           03572018
035730            PC140-RF-PRTR-ID          DELIMITED BY SIZE           03573018
035740                                 INTO PC158-SML-PRTR-NBR.         03574018
035750                                                                  03575018
035760     MOVE PC158-FORM-REPRT-BOX        TO PC158-REPRINT-BOX.       03576018
035770     MOVE PC158-FORM-REPRT-FLD        TO PC158-REPRINT-TEXT.      03577018
035780     MOVE PC158-FORM-NO-INPK-BOX      TO PC158-INPK-CONVY-BOX.    03578018
035790     MOVE PC158-FORM-OTPK-HDG         TO PC158-INPK-CONVY-TEXT.   03579018
035800     MOVE PC140-RF-OTPK-UNITS         TO PC158-PACK-UNT           03580018
035810                                         PC189-PACK-UNT.          03581018
035820                                                                  03582018
035840     MOVE PV-LBL-PRT-DATE             TO PC158-LBL-PRT-DATE.      03584018
035850     MOVE PV-LBL-PRT-TIME             TO PC158-LBL-PRT-TIME.      03585018
035860     MOVE PC158-FORM-NO-ODD-BOX       TO PC158-ODD-CARTON-BOX.    03586018
035870     MOVE PC158-FORM-NO-ODD-FLD       TO PC158-ODD-CARTON-FIELD.  03587018
035880     MOVE PC140-RF-USERID             TO PC158-USER-ID.           03588018
035890                                                                  03589018
035900*----------------------------------------------------------------*03590018
035910* FORMAT RADIO FREQUENCY GENERIC SML LABEL ROUTINE                03591018
035920*----------------------------------------------------------------*03592018
035930 3930-FMAT-RF-GENERIC-SML-LABEL.                                  03593018
035940     IF PC140-RF-ZNE-LINE-1  =  '* FAST TRANSFER *   '            03594018
035950         MOVE 'RF-FXR SML'         TO PC151-SML-LBL-DESC          03595018
035960     ELSE                                                         03596018
035970         IF PC140-RF-ZNE-LINE-1  =  '* MASTER CONTAINER *'        03597018
035980             MOVE 'RF-MST CNT'              TO PC151-SML-LBL-DESC 03598018
035990         ELSE                                                     03599018
036000             IF PC140-RF-CRTN-BULD                                03600018
036010                 MOVE 'RF-CTN BLD'          TO PC151-SML-LBL-DESC 03601018
036020             ELSE                                                 03602018
036030                 IF PC140-RF-PCK-2-LIT                            03603018
036040                     MOVE 'RF-PCK2LIT'      TO PC151-SML-LBL-DESC 03604018
036050                 ELSE                                             03605018
036060                     MOVE 'RF-GEN SML'      TO PC151-SML-LBL-DESC 03606018
036070                 END-IF                                           03607018
036080             END-IF                                               03608018
036090         END-IF                                                   03609018
036100     END-IF.                                                      03610018
036110     MOVE PV-LBL-PRT-DATE          TO PC151-LBL-PRT-DATE.         03611018
036120     MOVE PV-LBL-PRT-TIME          TO PC151-LBL-PRT-TIME.         03612018
036130                                                                  03613018
036140     MOVE PC151-FORM-REPRT-FLD     TO PC151-REPRINT-TEXT.         03614018
036150     MOVE PC151-FORM-REPRT-BOX     TO PC151-REPRINT-BOX.          03615018
036160                                                                  03616018
036170     MOVE 1                        TO PC152-SML-TOT-LBL.          03617018
036180                                                                  03618018
036190     MOVE PC140-RF-ZNE-LINE-1      TO PC151-STR-ZONE-LINE-1.      03619018
036200     MOVE PC140-RF-ZNE-LINE-2      TO PC151-STR-ZONE-LINE-2.      03620018
036210     MOVE PC140-RF-ZNE-LINE-3      TO PC151-STR-ZONE-LINE-3.      03621018
036220                                                                  03622018
036230* BUILD BARCODE & NUMBER ABOVE BARCODE FOR SML LABELS             03623018
036240                                                                  03624018
036250     MOVE PC140-RF-USERID       TO PC151-USER-ID.                 03625018
036260                                                                  03626018
036270     MOVE PC140-RF-STR-NBR      TO PV-4-DGT-STR-NBR.              03627018
036280     MOVE PV-4-DGT-STR-NBR      TO PC152-SML-DATA-STR-NBR.        03628018
036290     MOVE PC140-RF-STR-NAME     TO PC152-SML-DATA-STR-NME.        03629018
036300                                                                  03630029
036320     move '@@@@'    to  pc152-sml-data-door-id                    03632018
036330     if   PC140-SML-SHIP-DOOR-ORDER                               03633018
036340          move CNDRST-DOOR-ID        To pc152-sml-data-door-id    03634018
036350     else                                                         03635018
036360     if   PC140-DOOR-NOT-ON-LABEL                                 03636018
036370          continue                                                03637018
036380     else                                                         03638018
036390          MOVE PV-4-DGT-STR-NBR      TO cndrst-str-nbr            03639018
036400          MOVE PC140-CRA-OPER-UNT-ID to CNDRST-OPER-UNT-ID        03640018
036410          perform 4667-get-door-id                                03641018
036420          move CNDRST-DOOR-ID        To pc152-sml-data-door-id    03642018
036430     end-if                                                       03643018
036440     end-if                                                       03644018
036460                                                                  03646029
036470     MOVE PC140-RF-CONTAINER-CDE  TO  PC160-20-SML-CONTAINER-CDE. 03647018
036480     MOVE PC140-RF-PACKAGING-TYP  TO  PC160-20-SML-PACKAGING-TYP. 03648018
036490     MOVE PC140-RF-SOFTWARE-SRC   TO  PC160-20-SML-SOFTWARE-SRC.  03649018
036500     MOVE PC140-RF-BC-DIVERT      TO  PC160-20-SML-BC-DIVERT.     03650018
036510     MOVE PC140-RF-BC-DC-ORIGIN   TO  PC160-20-SML-BC-DC-ORIGIN.  03651018
036520     MOVE PC140-RF-BC-MNFST-NBR   TO  PC160-20-SML-BC-MNFST-NBR.  03652018
036530     MOVE PC160-20-SML-CONTAINER-CDE TO                           03653018
036540                                   PC160-20-SML-NBR-CONTAINER-CDE.03654018
036550     MOVE PC160-20-SML-PACKAGING-TYP TO                           03655018
036560                                   PC160-20-SML-NBR-PACKAGING-TYP.03656018
036570     MOVE PC160-20-SML-SOFTWARE-SRC  TO                           03657018
036580                                   PC160-20-SML-NBR-SOFTWARE-SRC. 03658018
036590     MOVE PC160-20-SML-BC-DIVERT     TO                           03659018
036600                                   PC160-20-SML-NBR-BC-DIVERT.    03660018
036610     MOVE PC160-20-SML-BC-DC-ORIGIN  TO                           03661018
036620                                   PC160-20-SML-NBR-BC-DC-ORIGIN. 03662018
036630     MOVE PC160-20-SML-BC-MNFST-NBR  TO                           03663018
036640                                   PC160-20-SML-NBR-BC-MNFST-NBR. 03664018
036650     MOVE PC160-20-DIGIT-BARCODE-NBR TO  PC152-SML-DATA-BC-NBR.   03665018
036660     MOVE PC140-RF-KOHLS-BARCODE     TO  PC152-SML-DATA-BC.       03666018
036670                                                                  03667018
036680     STRING PC140-CRA-DC-ID           DELIMITED BY SIZE           03668018
036690            '-'                       DELIMITED BY SIZE           03669018
036700            PC140-RF-PRTR-ID          DELIMITED BY SIZE           03670018
036710                                 INTO PC151-SML-PRTR-NBR.         03671018
036720                                                                  03672018
036730                                                                  03673018
036740*----------------------------------------------------------------*03674018
036750* FORMAT RADIO FREQUENCY CSEPK SML LABEL ROUTINE                  03675018
036760*----------------------------------------------------------------*03676018
036770 3940-FMAT-RF-CSEPK-SML-LABEL.                                    03677018
036780                                                                  03678018
036790     MOVE PC140-RF-STR-NBR             TO PV-4-DGT-STR-NBR.       03679018
036800     MOVE PV-4-DGT-STR-NBR             TO PC254-SML-STR-NBR.      03680018
036810                                                                  03681018
036830     SET PC254-DOOR-HDG-YES        TO  TRUE.                      03683018
036840                                                                  03684018
036850     MOVE PC140-RF-KOHLS-BARCODE     TO PC160-20-DIGIT-BARCODE.   03685018
036860     MOVE PC160-20-SML-CONTAINER-CDE TO                           03686018
036870                                   PC160-20-SML-NBR-CONTAINER-CDE.03687018
036880     MOVE PC160-20-SML-PACKAGING-TYP TO                           03688018
036890                                   PC160-20-SML-NBR-PACKAGING-TYP.03689018
036900     MOVE PC160-20-SML-SOFTWARE-SRC  TO                           03690018
036910                                   PC160-20-SML-NBR-SOFTWARE-SRC. 03691018
036920     MOVE PC160-20-SML-BC-DIVERT     TO                           03692018
036930                                   PC160-20-SML-NBR-BC-DIVERT.    03693018
036940     MOVE PC160-20-SML-BC-DC-ORIGIN  TO                           03694018
036950                                   PC160-20-SML-NBR-BC-DC-ORIGIN. 03695018
036960     MOVE PC160-20-SML-BC-MNFST-NBR  TO                           03696018
036970                                   PC160-20-SML-NBR-BC-MNFST-NBR. 03697018
036980     MOVE PC160-20-DIGIT-BARCODE-NBR TO  PC254-SML-BC-NBR.        03698018
036990     MOVE PC140-RF-KOHLS-BARCODE     TO  PC254-SML-BC.            03699018
037000                                                                  03700018
037010     STRING PC140-CRA-DC-ID           DELIMITED BY SIZE           03701018
037020            '-'                       DELIMITED BY SIZE           03702018
037030            PC140-RF-PRTR-ID          DELIMITED BY SIZE           03703018
037040                                 INTO PC253-SML-PRTR-NBR.         03704018
037050                                                                  03705018
037060     MOVE 'RF-CSP SML'               TO PC253-SML-LBL-DESC.       03706018
037070     MOVE PC-0001                    TO PC254-LABEL-NUMBER-N      03707018
037080                                        PC254-SML-TOT-LBLS        03708018
037090                                        PC253-TOT-LBL-CNT.        03709018
037100     SET  PC253-FORM-OF              TO TRUE.                     03710018
037110     MOVE PC140-RF-USERID             TO PC253-USER-ID.           03711018
037120                                                                  03712018
037130     MOVE PC140-RF-PO-NBR              TO  PV-PO-NUMBER.          03713018
037140     MOVE PC140-RF-PO-RCVR             TO  PV-PO-RECEIVER.        03714018
037150     MOVE PV-PO-RCVR                   TO  PC253-PO-RCVR-NBR.     03715018
037160                                                                  03716018
037170     IF  PC140-RF-STYLE   > SPACES                                03717018
037180         MOVE PC140-RF-STYLE         TO  PC253-STYLE              03718018
037190     ELSE                                                         03719018
037200         MOVE '@@@@@@@@@@@@@@@@@@@@' TO  PC253-STYLE              03720018
037210     END-IF.                                                      03721018
037220                                                                  03722018
037230*PREPACK ORDERS                                                   03723018
037240     IF  PC140-RF-PREPK                                           03724018
037250         SET  PC253-PACK-HDG            TO TRUE                   03725018
037260         MOVE PC140-RF-PREPK-ID         TO PC253-PO-LNE-NBR       03726018
037270     ELSE                                                         03727018
037280         SET   PC253-LINE-HDG           TO TRUE                   03728018
037290         MOVE PC140-RF-LNE-NBR          TO PC253-PO-LNE-NBR       03729018
037300     END-IF.                                                      03730018
037310                                                                  03731018
037320     IF PC140-RF-SKU > SPACES                                     03732018
037330         STRING '(' PC140-RF-DEPT                                 03733018
037340                '-' PC140-RF-CLASS                                03734018
037350                ')' PC140-RF-SKU          DELIMITED BY SIZE       03735018
037360                                      INTO PC253-SKU-NBR          03736018
037370     ELSE                                                         03737018
037380         MOVE SPACES                   TO PC253-SKU-NBR           03738018
037390     END-IF.                                                      03739018
037400                                                                  03740018
037410     IF  PC140-RF-INPK                                            03741018
037420         SET  PC253-FORM-INPK-HDG       TO TRUE                   03742018
037430     ELSE                                                         03743018
037440         SET  PC253-FORM-NO-INPK-BOX    TO TRUE                   03744018
037450     END-IF                                                       03745018
037460                                                                  03746018
037470     SET  PC253-FORM-REPRT-BOX      TO  TRUE                      03747018
037480     SET  PC253-FORM-REPRT-FLD      TO  TRUE                      03748018
037490                                                                  03749018
037510     IF PS-BRAND-FOUND-YES                                        03751018
037520        PERFORM 3942-INSPECT-BUS-AREA                             03752018
037530        MOVE PV-BUS-AREA-BRAND    TO PC253-POG-PROGRAM-NAME       03753018
037540     ELSE                                                         03754018
037550        STRING PC140-RF-DEPT-NAME     DELIMITED BY '  '           03755018
037560                    '/'                   DELIMITED BY SIZE       03756018
037570                    PC140-RF-MAJOR-CLASS  DELIMITED BY '   '      03757018
037580                                   INTO PC253-POG-PROGRAM-NAME    03758018
037590     END-IF                                                       03759018
037600                                                                  03760018
037610                                                                  03761018
037620     IF  PC140-RF-FIXTURE  >  SPACES                              03762018
037630         SET  PC253-FIXTURE-HDG-YES                               03763018
037650              PC254-FIXTURE-HDG-YES TO TRUE                       03765018
037660         MOVE PC140-RF-FIXTURE      TO  PC253-FIXTURE             03766018
037670                                        PC254-FIXTURE             03767018
037680     ELSE                                                         03768018
037690         SET  PC253-FIXTURE-HDG-NO                                03769018
037710              PC253-FORM-NO-FIXTURE                               03771018
037720              PC254-FIXTURE-HDG-NO  TO TRUE                       03772018
037730     END-IF.                                                      03773018
037740                                                                  03774018
037750     IF  PC140-RF-SEASONAL-SET  >  SPACES                         03775018
037760         SET PC253-FORM-SEASET-HDG                                03776018
037770             PC254-SEASET-HDG-YES    TO TRUE                      03777018
037780         MOVE PC140-RF-SEASONAL-SET  TO  PC254-SEASONAL-SET       03778018
037790     ELSE                                                         03779018
037800         SET PC254-SEASET-HDG-NO                                  03780018
037810             PC253-FORM-SEASET-NO-HDG                             03781018
037820             PC254-SEASET-NO         TO  TRUE                     03782018
037830     END-IF.                                                      03783018
037840                                                                  03784018
037850     MOVE PV-LBL-PRT-DATE             TO PC253-LBL-PRT-DATE.      03785018
037860     MOVE PV-LBL-PRT-TIME             TO PC253-LBL-PRT-TIME.      03786018
037870                                                                  03787029
037880     IF  PC140-RF-INPK                                            03788018
037890         SET  PC253-FORM-INPK-HDG     TO  TRUE                    03789018
037900         SET  PC253-FORM-INPK-BOX     TO  TRUE                    03790018
037910         MOVE PC140-RF-INPK-UNITS     TO  PC253-PACK-UNT          03791018
037920     ELSE                                                         03792018
037930         SET  PC253-FORM-OTPK-HDG     TO  TRUE                    03793018
037940         SET  PC253-FORM-NO-INPK-BOX  TO  TRUE                    03794018
037950         MOVE PC140-RF-OTPK-UNITS     TO  PC253-PACK-UNT          03795018
037960     END-IF.                                                      03796018
037970                                                                  03797018
037990     SET  PC253-FORM-NO-ODD-BOX       TO TRUE                     03799018
038000     SET  PC253-FORM-NO-ODD-FLD       TO TRUE.                    03800018
038020                                                                  03802018
038030                                                                  03803018
052130*----------------------------------------------------------------*05213018
052140*                                                                 05214018
052150*----------------------------------------------------------------*05215018
052170***************************************************************** 05217018
052180* ONLY BRING BACK AS MANY CHARACTERS UP TO 9 FOR THE BUSINESS     05218018
052190* AREA DESCRIPTION                                                05219018
052200***************************************************************** 05220018
052210 3942-INSPECT-BUS-AREA.                                           05221018
052220                                                                  05222018
052230     MOVE XL073-BUS-AREA-DESC(1:9) TO PV-BUS-AREA-DESC-9.         05223018
052240                                                                  05224018
052250     MOVE +0                               TO PV-DESC-LEN.        05225018
052260     MOVE LENGTH OF PV-BUS-AREA-DESC-9     TO PV-DESC-LEN.        05226018
052270                                                                  05227018
052280     PERFORM                                                      05228018
052290       UNTIL PV-BUS-AREA-DESC-9(PV-DESC-LEN:1) > SPACES OR        05229018
052300         PV-DESC-LEN = +0                                         05230018
052310       COMPUTE PV-DESC-LEN   = PV-DESC-LEN - 1                    05231018
052320     END-PERFORM.                                                 05232018
052330                                                                  05233018
052340     MOVE SPACES  TO  PV-BUS-AREA-BRAND.                          05234018
052350                                                                  05235018
052360     EVALUATE TRUE                                                05236018
052370        WHEN  PV-DESC-LEN   =  9                                  05237018
052380            STRING   PV-BUS-AREA-DESC-9(1:9)                      05238018
052390                                 '-'                              05239018
052400                     XLT00043-BRND-DESC DELIMITED BY SIZE         05240018
052410            INTO  PV-BUS-AREA-BRAND                               05241018
052420        WHEN  PV-DESC-LEN   =  8                                  05242018
052430            STRING   PV-BUS-AREA-DESC-9(1:8)                      05243018
052440                                 '-'                              05244018
052450                     XLT00043-BRND-DESC DELIMITED BY SIZE         05245018
052460            INTO  PV-BUS-AREA-BRAND                               05246018
052470        WHEN  PV-DESC-LEN   =  7                                  05247018
052480            STRING   PV-BUS-AREA-DESC-9(1:7)                      05248018
052490                                 '-'                              05249018
052500                     XLT00043-BRND-DESC DELIMITED BY SIZE         05250018
052510            INTO  PV-BUS-AREA-BRAND                               05251018
052520        WHEN  PV-DESC-LEN   =  6                                  05252018
052530            STRING   PV-BUS-AREA-DESC-9(1:6)                      05253018
052540                                 '-'                              05254018
052550                     XLT00043-BRND-DESC DELIMITED BY SIZE         05255018
052560            INTO  PV-BUS-AREA-BRAND                               05256018
052570        WHEN  PV-DESC-LEN   =  5                                  05257018
052580            STRING   PV-BUS-AREA-DESC-9(1:5)                      05258018
052590                                 '-'                              05259018
052600                     XLT00043-BRND-DESC DELIMITED BY SIZE         05260018
052610            INTO  PV-BUS-AREA-BRAND                               05261018
052620        WHEN  PV-DESC-LEN   =  4                                  05262018
052630            STRING   PV-BUS-AREA-DESC-9(1:4)                      05263018
052640                                 '-'                              05264018
052650                     XLT00043-BRND-DESC DELIMITED BY SIZE         05265018
052660            INTO  PV-BUS-AREA-BRAND                               05266018
052670        WHEN  PV-DESC-LEN   =  3                                  05267018
052680            STRING   PV-BUS-AREA-DESC-9(1:3)                      05268018
052690                                 '-'                              05269018
052700                     XLT00043-BRND-DESC DELIMITED BY SIZE         05270018
052710            INTO  PV-BUS-AREA-BRAND                               05271018
052720        WHEN  PV-DESC-LEN   =  2                                  05272018
052730            STRING   PV-BUS-AREA-DESC-9(1:2)                      05273018
052740                                 '-'                              05274018
052750                     XLT00043-BRND-DESC DELIMITED BY SIZE         05275018
052760            INTO  PV-BUS-AREA-BRAND                               05276018
052770        WHEN  PV-DESC-LEN   =  1                                  05277018
052780            STRING   PV-BUS-AREA-DESC-9(1:1)                      05278018
052790                                 '-'                              05279018
052800                     XLT00043-BRND-DESC DELIMITED BY SIZE         05280018
052810            INTO  PV-BUS-AREA-BRAND                               05281018
052820        WHEN  OTHER                                               05282018
052830*           NO BUSINESS AREA AVAILABLE                            05283018
052840            STRING   PV-BUS-AREA-DESC-9(1:9)                      05284018
052850                                 '-'                              05285018
052860                     XLT00043-BRND-DESC DELIMITED BY SIZE         05286018
052870            INTO  PV-BUS-AREA-BRAND                               05287018
052880     END-EVALUATE.                                                05288018
052890                                                                  05289018
052910                                                                  05291018
052920*----------------------------------------------------------------*05292018
052930* FORMAT RADIO FREQUENCY CHECKIN SML LABEL ROUTINE                05293018
052940*----------------------------------------------------------------*05294018
052950 3950-FMAT-RF-CHECKIN-SML-LABEL.                                  05295018
052960                                                                  05296018
052970     IF PC140-RF-SMOOTHING                                        05297018
052980         SET  PC255-SMTH-HDG               TO TRUE                05298018
052990     ELSE                                                         05299018
053000         SET  PC255-CRTN-HDG               TO TRUE                05300018
053010         MOVE PC140-RF-VNDR-BC-LAST-5      TO PC256-CARTON-ID     05301018
053020     END-IF.                                                      05302018
053030                                                                  05303018
053040     SET PC255-STR-REV-YES             TO TRUE                    05304018
053050                                                                  05305018
053060     MOVE PC140-RF-STR-NBR             TO PV-4-DGT-STR-NBR.       05306018
053070     MOVE PV-4-DGT-STR-NBR             TO PC256-SML-STR-NBR.      05307018
053080                                                                  05308018
053090     MOVE PC140-RF-PO-NBR              TO  PV-PO-NUMBER.          05309018
053100     MOVE PC140-RF-PO-RCVR             TO  PV-PO-RECEIVER.        05310018
053110     MOVE PV-PO-RCVR                   TO  PC256-PO-RCVR.         05311018
053120     MOVE PC140-RF-LNE-NBR             TO  PC256-LINE-NBR.        05312018
053130                                                                  05313018
053140     IF PC140-RF-SKU = '@@@@@@@@'                                 05314018
053150         MOVE '@@@@@@@@@@@@@@@@'       TO PC256-SKU               05315018
053160     ELSE                                                         05316018
053220         STRING '(' PC140-RF-DEPT                                 05322018
053230                '-' PC140-RF-CLASS                                05323018
053240                ')' PC140-RF-SKU          DELIMITED BY SIZE       05324018
053250                                      INTO PC256-SKU              05325018
053260     END-IF.                                                      05326018
053270                                                                  05327018
053280     IF PC140-RF-SMOOTHING                                        05328018
053290         MOVE '@@@@@'                     TO PC256-OTPK-UNIT      05329018
053300     ELSE                                                         05330018
053310         MOVE PC140-RF-PREPK-UNT-QTY      TO PC256-OTPK-UNIT      05331018
053320     END-IF.                                                      05332018
053330                                                                  05333018
053340     SET PC256-DOOR-HDG-YES          TO TRUE                      05334018
053350                                                                  05335018
053360     MOVE PC140-RF-KOHLS-BARCODE     TO PC160-20-DIGIT-BARCODE    05336018
053370                                                                  05337018
053380     MOVE PC160-20-SML-CONTAINER-CDE TO                           05338018
053390          PC160-20-SML-NBR-CONTAINER-CDE.                         05339018
053400     MOVE PC160-20-SML-PACKAGING-TYP TO                           05340018
053410          PC160-20-SML-NBR-PACKAGING-TYP.                         05341018
053420     MOVE PC160-20-SML-SOFTWARE-SRC  TO                           05342018
053430          PC160-20-SML-NBR-SOFTWARE-SRC.                          05343018
053440     MOVE PC160-20-SML-BC-DIVERT     TO                           05344018
053450          PC160-20-SML-NBR-BC-DIVERT.                             05345018
053460     MOVE PC160-20-SML-BC-DC-ORIGIN  TO                           05346018
053470          PC160-20-SML-NBR-BC-DC-ORIGIN.                          05347018
053480     MOVE PC160-20-SML-BC-MNFST-NBR  TO                           05348018
053490          PC160-20-SML-NBR-BC-MNFST-NBR.                          05349018
053500     MOVE PC160-20-DIGIT-BARCODE-NBR TO PC256-BARCODE-TEXT.       05350018
053510     MOVE PC140-RF-KOHLS-BARCODE     TO PC255-SML-BARCODE         05351018
053520                                        PC256-SML-BARCODE.        05352018
053530     SET  PC255-MFST-BOX-YES         TO TRUE.                     05353018
053540                                                                  05354018
053550     STRING PC140-CRA-DC-ID           DELIMITED BY SIZE           05355018
053560            '-'                       DELIMITED BY SIZE           05356018
053570            PC140-RF-PRTR-ID          DELIMITED BY SIZE           05357018
053580                                 INTO PC255-SML-PRTR-NBR.         05358018
053590                                                                  05359018
053600     MOVE PC-0001                    TO PC256-SML-LBL-QTY         05360018
053610                                        PC256-LABEL-NBR           05361018
053620                                        PC256-TOT-LABEL.          05362018
053630     MOVE PC-OF                      TO PC256-LABEL-OF.           05363018
053640                                                                  05364018
053650     IF PC140-RF-SMOOTHING                                        05365018
053660        MOVE 'RF'                    TO  PC255-FROM-APPLICATION   05366018
053670        MOVE '-SMG '                 TO  PC255-LBL-DESC           05367018
053680        MOVE 'SML  '                 TO  PC255-PRTR-ATTACHED      05368018
053690        MOVE PC255-LABEL-INFO-WORK   TO  PC255-LABEL-INFO         05369018
053700     ELSE                                                         05370018
053710         MOVE 'RF'                    TO  PC255-FROM-APPLICATION  05371018
053720         MOVE '-CKN '                 TO  PC255-LBL-DESC          05372018
053730         MOVE 'SML  '                 TO  PC255-PRTR-ATTACHED     05373018
053740         MOVE PC255-LABEL-INFO-WORK   TO  PC255-LABEL-INFO        05374018
053750     END-IF                                                       05375018
053760                                                                  05376018
053770                                                                  05377018
053780     IF  PC140-RF-STYLE   > SPACES                                05378018
053790         MOVE PC140-RF-STYLE       TO  PC255-STYLE                05379018
053800                                       PC256-STYLE                05380018
053810     ELSE                                                         05381018
053820         MOVE '@@@@@@@@@@@@@@@@@@@@' TO  PC255-STYLE              05382018
053830         MOVE '@@@@@@@@@@@@@@@@@@@@' TO  PC256-STYLE              05383018
053840     END-IF.                                                      05384018
053850                                                                  05385018
053860*PREPACK ORDERS                                                   05386018
053870     IF  PC140-RF-PREPK                                           05387018
053880         MOVE 'PACK ID:'                TO PC255-LNE-PCK-HDG      05388018
053890         MOVE PC140-RF-PREPK-ID         TO PC256-LINE-NBR         05389018
053900     ELSE                                                         05390018
053910         MOVE 'LINE NO:'                TO PC255-LNE-PCK-HDG      05391018
053920         MOVE PC140-RF-LNE-NBR          TO PC256-LINE-NBR         05392018
053930     END-IF.                                                      05393018
053940                                                                  05394018
053950*INNER PACK CONVEYABLE                                            05395018
053960     IF  PC140-RF-INPK                                            05396018
053970         SET  PC255-FORM-INPK-HDG       TO TRUE                   05397018
053980         SET  PC255-FORM-INPK-BOX       TO TRUE                   05398018
053990         MOVE PC140-RF-INPK-UNITS       TO PC256-OTPK-UNIT        05399018
054000     ELSE                                                         05400018
054010         SET  PC255-FORM-NO-UNT-HDG     TO TRUE                   05401018
054020         SET  PC255-FORM-NO-INPK-BOX    TO TRUE                   05402018
054030         MOVE '@@@@'                    TO PC256-OTPK-UNIT        05403018
054120     END-IF                                                       05412018
054130                                                                  05413018
054140     SET  PC255-FORM-REPRT-BOX      TO  TRUE                      05414018
054150     SET  PC255-FORM-REPRT-FLD      TO  TRUE                      05415018
054160                                                                  05416018
054170     MOVE '@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@'                   05417018
054180                              TO    PC255-POG-PROGRAM-NAME        05418018
054200     IF PS-BRAND-FOUND-YES                                        05420018
054210        PERFORM 3942-INSPECT-BUS-AREA                             05421018
054220        MOVE PV-BUS-AREA-BRAND    TO PC256-POG-PROGRAM-NAME       05422018
054240     ELSE                                                         05424018
054250        STRING XL073-DEPT-NAME        DELIMITED BY '  '           05425018
054260                    '/'                   DELIMITED BY SIZE       05426018
054270                    PC140-RF-MAJOR-CLASS  DELIMITED BY '   '      05427018
054280                                   INTO PC256-POG-PROGRAM-NAME    05428018
054290     END-IF                                                       05429018
054300                                                                  05430018
054470     IF  PC140-RF-FIXTURE  >  SPACES                              05447018
054480         SET PC255-FORM-FIX-HDG                                   05448018
054490             PC256-FIXTURE-HDG-YES  TO TRUE                       05449018
054510         MOVE PC140-RF-FIXTURE      TO  PC256-FIXTURE             05451018
054520     ELSE                                                         05452018
054530         SET PC255-FORM-NO-FIX-HDG                                05453018
054540             PC256-FIXTURE-HDG-NO                                 05454018
054550             PC255-FORM-NO-FIXTURE  TO TRUE                       05455018
054570     END-IF.                                                      05457018
054580                                                                  05458018
054590     IF  PC140-RF-SEASONAL-SET  >  SPACES                         05459018
054600         MOVE PC140-RF-SEASONAL-SET       TO  PC255-SET           05460018
054610                                              PC256-SEASET        05461018
054620         SET PC256-SEASET-HDG-YES         TO TRUE                 05462018
054630     ELSE                                                         05463018
054640         SET PC256-SEASET-NO              TO TRUE                 05464018
054650         SET PC256-SEASET-HDG-NO          TO TRUE                 05465018
054660     END-IF.                                                      05466018
054670                                                                  05467018
054680     MOVE PV-LBL-PRT-DATE             TO PC255-LBL-PRT-DATE.      05468018
054690     MOVE PV-LBL-PRT-TIME             TO PC255-LBL-PRT-TIME.      05469018
054700     MOVE PC140-RF-USERID             TO PC255-USER-ID.           05470018
054710                                                                  05471018
054730     IF PC140-RFID-YES                                            05473018
054760         EVALUATE TRUE                                            05476018
054770            WHEN PC140-PRINT-RFID-EAS                             05477018
054780                 MOVE PV-RFIDEAS-TXT-4    TO PC256-TEXT-4         05478018
054790            WHEN PC140-PRINT-RFID                                 05479018
054800                 MOVE PV-RFID-STORE-TXT-4 TO PC256-TEXT-4         05480018
054810            WHEN PC140-PRINT-EAS                                  05481018
054820                 MOVE PV-EAS-TXT-4        TO PC256-TEXT-4         05482018
054830            WHEN OTHER                                            05483018
054840                 SET PC256-TEXT-4-NO      TO TRUE                 05484018
054850         END-EVALUATE                                             05485018
054860      ELSE                                                        05486018
054870         SET PC256-TEXT-4-NO      TO TRUE                         05487018
054880      END-IF.                                                     05488018
054890                                                                  05489018
054900************************************************************      05490018
054910*SET NEW SWITCHES FOR FORM/DATA CHANGES ASSOCIATED TO AUDIT       05491018
054920*CHANGES GB 2/25/02                                               05492018
054930************************************************************      05493018
054940     SET PC255-BRCD-NBR-ABOVE                                     05494018
054950         PC255-SML-BRCD                                           05495018
054960         PC255-TEST-LNE-YES                                       05496018
054970         PC255-AUDIT-HDG-NO                                       05497018
054980         PC255-ZONE-HDG                                           05498018
054990         PC255-SET-HDG                TO TRUE.                    05499018
055000                                                                  05500018
055010     MOVE '@'                         TO PC255-AUDIT-CASI         05501018
055020                                                                  05502018
055030     IF PC140-RF-SMOOTHING                                        05503018
055040        SET PC256-AUDIT-COMPLETE      TO TRUE                     05504018
055050     ELSE                                                         05505018
055060        MOVE PS-AUDIT-IND             TO PC256-AUDIT-IND          05506018
055070     END-IF.                                                      05507018
055080                                                                  05508018
055090*----------------------------------------------------------------*05509018
055100* FORMAT RADIO FREQUENCY CHECKIN P2L LABEL ROUTINE                05510018
055110* paragraph added - dmh 12/24/02                                  05511018
055120*----------------------------------------------------------------*05512018
055130 3960-FMAT-RF-CHECKIN-P2L-LABEL.                                  05513018
055140                                                                  05514018
055150     MOVE '0001'                     TO PC169-LBL-QTY-TO-PRT.     05515018
055160                                                                  05516018
055170     MOVE PC140-RF-KOHLS-BARCODE     TO PC169-BC-BARCODE.         05517018
055180     MOVE PC140-RF-KOHLS-BARCODE     TO PC169-TXT-BARCODE.        05518018
055190     MOVE PC140-RF-USERID            TO PC169-USER-ID.            05519018
055200     MOVE 'RF-CKN DEST'              TO PC169-DEST-LBL-DESC.      05520018
055210                                                                  05521018
055220     MOVE 1                          TO PC169-LABEL-NBR.          05522018
055230     MOVE 1                          TO PC169-TOT-LABEL.          05523018
055240                                                                  05524018
055250     STRING PC140-CRA-DC-ID             DELIMITED BY SIZE         05525018
055260            '-'                         DELIMITED BY SIZE         05526018
055270            PC140-RF-PRTR-ID            DELIMITED BY SIZE         05527018
055280                                   INTO PC169-DES-PRINTER-ID.     05528018
055290                                                                  05529018
055300     MOVE PC140-RF-KOHLS-BARCODE     TO PV-RF-DEST-BARCODE.       05530018
055310     MOVE PV-RF-LBL-SEQ              TO PC169-START-CARTON-CNT-1. 05531018
055320                                                                  05532029
055340     PERFORM 3970-GET-P2L-MOD-NUMBER.                             05534018
055360                                                                  05536029
055390     PERFORM 3965-CHECK-TRIP-ON-P2L-LABEL                         05539018
055400     IF  PS-P2L-MOD-ON-LABEL                                      05540018
055410         STRING 'P2L-'                                            05541018
055430                PV-DISTHD-MOD-2        DELIMITED BY SIZE          05543018
055440                                   INTO PC169-MODULE-NAME         05544018
055450     ELSE                                                         05545018
055470         MOVE PV-DISTHD-MOD-2       TO PV-MOD                     05547018
055480         MOVE '-'                   TO PV-DASH                    05548018
055490         MOVE PC140-TRIP-ARRIVE-MM  TO PV-ARRIVE-MM               05549018
055500         MOVE PC140-TRIP-ARRIVE-DD  TO PV-ARRIVE-DD               05550018
055510         MOVE PV-MOD-DATE           TO PC169-MODULE-NAME          05551018
055520     END-IF                                                       05552018
055560                                                                  05556018
055570     MOVE PV-LBL-PRT-DATE              TO PC169-LBL-PRT-DATE.     05557018
055580     MOVE PV-LBL-PRT-TIME              TO PC169-LBL-PRT-TIME.     05558018
055590                                                                  05559018
055600     MOVE PS-AUDIT-IND                 TO PC169-AUDIT-IND.        05560018
055610                                                                  05561018
055620     MOVE PC140-RF-VNDR-BC-LAST-5      TO PC169-CRTN-NBR.         05562018
055630                                                                  05563018
055640     MOVE PC140-RF-PO-NBR              TO PC169-DES-PO.           05564018
055650     MOVE '-'                          TO PC169-DES-PO-DASH.      05565018
055660     MOVE PC140-RF-PO-RCVR             TO PC169-SEQ-NO.           05566018
055670                                                                  05567018
055680     MOVE PC140-RF-DEPT                TO PV-RF-DEST-DEPT.        05568018
055690     MOVE '-'                          TO PV-RF-DEST-DASH.        05569018
055700     MOVE PC140-RF-CLASS               TO PV-RF-DEST-CLASS.       05570018
055710     MOVE PV-RF-DPT-CLS                TO PC169-DEPT-CLASS.       05571018
055720                                                                  05572018
055730     IF  PC140-RF-ZONE    > SPACES                                05573018
055740         MOVE PC140-RF-ZONE            TO PC169-DES-ZONE          05574018
055750     ELSE                                                         05575018
055760         MOVE '@@@@'                   TO PC169-DES-ZONE          05576018
055770     END-IF.                                                      05577018
055780                                                                  05578018
055790     IF PC140-RF-SKU = '@@@@@@@@'                                 05579018
055800         MOVE '@@@@@@@@@@@@@@@@'       TO PC169-SKU               05580018
055810     ELSE                                                         05581018
055820         MOVE PC140-RF-SKU             TO PC169-SKU               05582018
055830     END-IF.                                                      05583018
055840                                                                  05584018
055850* PRE-PACK                                                        05585018
055860     IF  PC140-RF-PREPK                                           05586018
055870         MOVE PC169-DRVR-LNE-RATIO-DESC                           05587018
055880                                       TO PC169-LNE-NO-DESC       05588018
055890         MOVE PC140-RF-PREPK-RATIO     TO PV-RF-DEST-PACK-RATIO   05589018
055900         MOVE PV-RF-DEST-RATIO         TO PC169-LINE-NO           05590018
055910         MOVE PC169-TOT-UNITS-DESC     TO PC169-DES-INPK-DESC     05591018
055920         MOVE PC140-RF-UNTS-IN-PCK     TO PC169-DES-INPK-QTY      05592018
055930         MOVE PC169-PCKS-INCTN-DESC    TO PC169-DES-UNT-PK-DESC   05593018
055940         MOVE PC140-RF-PACKS-IN-CRTN   TO PC169-DES-UNT-PK-QTY    05594018
055950         MOVE PC169-DRVR-LINE-DESC     TO PC169-DES-DWN-SK-DESC   05595018
055960         MOVE PC169-PK-DIVIDE-BOX      TO PC169-PACK-DIVIDE-BOX   05596018
055970         MOVE PC169-PK-DIVIDE-FLD      TO PC169-PACK-DIVIDE-FLD   05597018
055980         MOVE SPACES                   TO PC169-SKU               05598018
055990         STRING 'PACK-'                   DELIMITED BY SIZE       05599018
056000                PC140-RF-PREPK-ID         DELIMITED BY SIZE       05600018
056010                                     INTO PC169-SKU               05601018
056011                                                                  05601126
056061         MOVE PC140-RF-SKU             TO PC169-DES-DWN-SK-QTY    05606126
056062                                                                  05606229
056070     ELSE                                                         05607018
056080         MOVE PC169-LINE-NO-DESC       TO PC169-LNE-NO-DESC       05608018
056110         MOVE PV-RF-LINE               TO PC169-LINE-NO           05611018
056120         MOVE PC169-INNER-PACK-DESC    TO PC169-DES-INPK-DESC     05612018
056130         MOVE PC140-RF-INPK-UNITS      TO PC169-DES-INPK-QTY      05613018
056140         MOVE SPACES                   TO PC169-DES-UNT-PK-DESC   05614018
056150         MOVE SPACES                   TO PC169-DES-UNT-PK-QTY    05615018
056160         MOVE SPACES                   TO PC169-DES-DWN-SK-DESC   05616018
056170         MOVE SPACES                   TO PC169-DES-DWN-SK-QTY    05617018
056180         MOVE PC140-RF-INPK-UNITS      TO PC169-DES-INPK-QTY      05618018
056190         MOVE PC169-NO-PK-DIVIDE-BOX   TO PC169-PACK-DIVIDE-BOX   05619018
056200         MOVE PC169-NO-PK-DIVIDE-FLD   TO PC169-PACK-DIVIDE-FLD   05620018
056210     END-IF.                                                      05621018
056220                                                                  05622018
056230*INNER PACK CONVEYABLE                                            05623018
056240     IF  PC140-RF-INPK                                            05624018
056250         MOVE  PC169-INPK-CNVY-BOX     TO PC169-INPK-BOX          05625018
056260     ELSE                                                         05626018
056270         MOVE  PC169-NO-INPK-CNVY-BOX  TO PC169-INPK-BOX          05627018
056280     END-IF.                                                      05628018
056290                                                                  05629018
056310     IF PC140-RFID-YES                                            05631018
056320         MOVE PC169-RFID-BOX TO PC169-LBL-RFID-BOX                05632018
056330         MOVE PC169-RFID-FLD TO PC169-LBL-RFID-FLD                05633018
056340     ELSE                                                         05634018
056350         MOVE PC169-NO-RFID-BOX TO PC169-LBL-RFID-BOX             05635018
056360         MOVE PC169-NO-RFID-FLD TO PC169-LBL-RFID-FLD             05636018
056370     END-IF.                                                      05637018
056390                                                                  05639018
056400*-----------------------------------------------------------------05640018
056410*  CHECK TO SEE IF THE DC WANTS TO HAVE THE TRIP ARRIVE DATE      05641018
056420*  TO APPEAR ON THE P2L LABEL                                     05642018
056430*-----------------------------------------------------------------05643018
056440 3965-CHECK-TRIP-ON-P2L-LABEL.                                    05644018
056450                                                                  05645018
056460     SET PS-P2L-MOD-ON-LABEL TO TRUE                              05646018
056470     MOVE  PC140-CRA-OPER-UNT-ID   TO  KRPRPM-LOC-ID              05647018
056480                                                                  05648018
056490     IF  PC140-CRA-OPER-UNT-ID  > 0                               05649018
056500         CONTINUE                                                 05650018
056510     ELSE                                                         05651018
056520         MOVE 90                   TO  KRPRPM-LOC-ID              05652018
056530     END-IF.                                                      05653018
056540                                                                  05654018
056550     EXEC SQL                                                     05655018
056560          SELECT FUNC_TXT                                         05656018
056570          INTO  :PS-P2L-LABEL-DISPLAY-SW                          05657018
056580          FROM   TKRPRPM                                          05658018
056590          WHERE  SYS_PRC_FUNC_CDE  = 'P2LARV'                     05659018
056600            AND  LOC_ID            = :KRPRPM-LOC-ID               05660018
056610            AND  INTFC_SYS_CDE     = 'KHL'                        05661018
056620            AND  FUNC_PRC_STAT_CDE = 'AC'                         05662018
056630     END-EXEC.                                                    05663018
056640                                                                  05664018
056650     EVALUATE TRUE                                                05665018
056660         WHEN SQLCODE = ZERO                                      05666018
056670             SET PS-TRIP-ARRIVE-DATE-ON-LABEL   TO  TRUE          05667018
056680         WHEN SQLCODE = +100                                      05668018
056690             SET PS-P2L-MOD-ON-LABEL   TO TRUE                    05669018
056700         WHEN SQLCODE = -904                                      05670018
056710         WHEN SQLCODE = -911                                      05671018
056720         WHEN SQLCODE = -913                                      05672018
056730             SET PS-P2L-MOD-ON-LABEL   TO TRUE                    05673018
056740             MOVE 'TKRPRPM'           TO PV-DISP-TABLE-1          05674018
056750             PERFORM 9955-SQL-ERROR                               05675018
056760             SET  PS-SOCKET-ERROR         TO TRUE                 05676018
056770             SET  PC140-CRA-SOCKET-COMM-ERROR  TO TRUE            05677018
056780             SET PS-DUMP-TO-LOG       TO TRUE                     05678018
056790             PERFORM 9990-WRITE-CICS                              05679018
056800         WHEN SQLWARN0 NOT = SPACES                               05680018
056810         WHEN SQLCODE < ZERO                                      05681018
056820         WHEN SQLCODE > ZERO                                      05682018
056830             MOVE 'TKRPRPM'           TO PV-DISP-TABLE-1          05683018
056840             PERFORM 9955-SQL-ERROR                               05684018
056850                                                                  05685018
056860     END-EVALUATE.                                                05686018
056870                                                                  05687018
056880                                                                  05688018
056890*-----------------------------------------------------------------05689018
056900*  GET THE P2L MOD NUMBER FROM THE DISTRIBUTION HEADER TABLE      05690018
056910*  DMH - 10-29-10                                                 05691018
056920*-----------------------------------------------------------------05692018
056930 3970-GET-P2L-MOD-NUMBER.                                         05693018
056940                                                                  05694018
056950     IF  PC140-RF-PO-NBR   >  0  AND                              05695018
056960         PC140-RF-PO-RCVR  >  0  AND                              05696018
056970         PC140-RF-LNE-NBR  >  0                                   05697018
056980         MOVE  PC140-RF-PO-NBR   TO  DISTHD-ORD-NBR               05698018
056990         MOVE  PC140-RF-PO-RCVR  TO  DISTHD-RCVR-SEQ-NBR          05699018
057000         MOVE  PC140-RF-LNE-NBR  TO  DISTHD-ORD-LNE-NBR           05700018
057010     ELSE                                                         05701018
057020         MOVE  PV-RF-PO       TO  DISTHD-ORD-NBR                  05702018
057030         MOVE  PV-RF-RCVR     TO  DISTHD-RCVR-SEQ-NBR             05703018
057040         MOVE  PV-RF-LINE     TO  DISTHD-ORD-LNE-NBR              05704018
057050     END-IF.                                                      05705018
057060                                                                  05706018
057070     EXEC SQL                                                     05707018
057080          SELECT PRC_AREA_MODU_ID                                 05708018
057090          INTO  :DISTHD-PRC-AREA-MODU-ID                          05709018
057100          FROM   TDISTHD                                          05710018
057110          WHERE  ORD_NBR           = :DISTHD-ORD-NBR              05711018
057120            AND  RCVR_SEQ_NBR      = :DISTHD-RCVR-SEQ-NBR         05712018
057130            AND  ORD_LNE_NBR       = :DISTHD-ORD-LNE-NBR          05713018
057140     END-EXEC.                                                    05714018
057150                                                                  05715018
057160     EVALUATE TRUE                                                05716018
057170         WHEN SQLCODE = ZERO                                      05717018
057180             MOVE  DISTHD-PRC-AREA-MODU-ID                        05718018
057190               TO  PV-DISTHD-MOD                                  05719018
057200         WHEN SQLCODE = +100                                      05720018
057210             MOVE 99  TO  PV-DISTHD-MOD-2                         05721018
057220         WHEN SQLCODE = -904                                      05722018
057230         WHEN SQLCODE = -911                                      05723018
057240         WHEN SQLCODE = -913                                      05724018
057250             MOVE 'TDISTHD'           TO PV-DISP-TABLE-1          05725018
057260             PERFORM 9955-SQL-ERROR                               05726018
057270             PERFORM 9990-WRITE-CICS                              05727018
057280         WHEN SQLWARN0 NOT = SPACES                               05728018
057290         WHEN SQLCODE < ZERO                                      05729018
057300         WHEN SQLCODE > ZERO                                      05730018
057310             MOVE 'TDISTHD'           TO PV-DISP-TABLE-1          05731018
057320             PERFORM 9955-SQL-ERROR                               05732018
057330                                                                  05733018
057340     END-EVALUATE.                                                05734018
057350                                                                  05735018
057360                                                                  05736018
057380*----------------------------------------------------------------*05738018
057390*  GET PARM THAT PROVIDES TEXT AND DIVERT CODE FOR RFID LABELS    05739018
057400*----------------------------------------------------------------*05740018
057410 3980-TKRPRPM-RFID-LBL-INFO.                                      05741018
057420                                                                  05742018
057430     MOVE PC140-CRA-OPER-UNT-ID       TO KRPRPM-LOC-ID            05743018
057440                                                                  05744018
057450     EXEC SQL                                                     05745018
057460          SELECT FUNC_TXT                                         05746018
057470          INTO  :KRPRPM-FUNC-TXT                                  05747018
057480          FROM   TKRPRPM                                          05748018
057490          WHERE  SYS_PRC_FUNC_CDE  = 'RFDCRT'                     05749018
057500            AND  INTFC_SYS_CDE     = 'KHL'                        05750018
057510            AND  FUNC_PRC_STAT_CDE = 'AC'                         05751018
057520            AND  LOC_ID            =  :KRPRPM-LOC-ID              05752018
057530     END-EXEC.                                                    05753018
057540                                                                  05754018
057550                                                                  05755018
057560     EVALUATE TRUE                                                05756018
057570         WHEN SQLCODE = ZERO                                      05757018
057590            MOVE KRPRPM-FUNC-TXT (7:4) TO PV-RFID-DIVERT-CDE      05759018
057600            MOVE PV-RFID-DIVERT-CDE-N  TO PV-22-CRTN-DIVERT-CDE   05760018
057610            MOVE 0                     TO PV-22-CRTN-TYPE-IND     05761018
057620            MOVE PC140-RF-PO-NBR       TO PV-22-CRTN-PO-NBR       05762018
057630            MOVE PC140-RF-PO-RCVR      TO PV-22-CTRN-RCVR-SEQ-NBR 05763018
057640            MOVE PC140-RF-LNE-NBR      TO PV-22-CRTN-PO-LNE-NBR   05764018
057641            PERFORM 3812-LAST-4-OF-BARCODE-PARM                   05764120
057645            IF  PS-USE-LAST-4-FROM-TMST                           05764520
057646                PERFORM 3811-GET-LAST-4-OF-BARCODE                05764620
057649                MOVE PV-CURRENT-TMST-R-LAST-4                     05764920
057650                                    TO PV-22-CRTN-CART-NBR        05765020
057651            ELSE                                                  05765120
057653                MOVE 0000 TO PV-22-CRTN-CART-NBR                  05765320
057654            END-IF                                                05765420
057660            MOVE PV-22-DIGIT-BARCODE   TO DK-BARCODE-NBR          05766018
057670         WHEN SQLCODE = +100                                      05767018
057680            MOVE 'XXXX'                TO PV-RFID-DIVERT-CDE      05768018
057690         WHEN SQLWARN0 NOT = SPACES                               05769018
057700         WHEN SQLCODE < ZERO                                      05770018
057710         WHEN SQLCODE > ZERO                                      05771018
057720             MOVE 'TKRPRPM'           TO PV-DISP-TABLE-1          05772018
057730             PERFORM 9955-SQL-ERROR                               05773018
057740     END-EVALUATE.                                                05774018
057750                                                                  05775018
057760*----------------------------------------------------------------*05776018
057770* BUILD CARTON LABEL FORM                                        *05777018
057780*----------------------------------------------------------------*05778018
057790 3990-BUILD-CRTN-LBL-FORM.                                        05779018
057800     INITIALIZE PC266-CARTON-LABEL                                05780018
057810                PV-DATE-CCYY-MM-DD                                05781018
057820                PV-ARVD-DATE                                      05782018
057830                DCLTRECEIV.                                       05783018
057840     SET PC266-REPRINT-BOX          TO  TRUE                      05784018
057850     SET PC266-REPRINT-TEXT         TO  TRUE                      05785018
057860     MOVE PV-CURRENT-YY             TO  PV-LBL-DATE-YY.           05786018
057870     MOVE PV-CURRENT-MM             TO  PV-LBL-DATE-MM.           05787018
057880     MOVE PV-CURRENT-DD             TO  PV-LBL-DATE-DD.           05788018
057890     MOVE '-'                       TO  PV-LBL-DASH1              05789018
057900                                        PV-LBL-DASH2              05790018
057910                                        PV-ARVD-DASH1             05791018
057920                                        PV-ARVD-DASH2.            05792018
057930     MOVE PV-LBL-DATE               TO  PC266-LBL-PRT-DATE.       05793018
057950     MOVE PV-CURRENT-DB2-TIME       TO  PC266-LBL-PRT-TIME.       05795018
057960                                                                  05796018
057970     MOVE PC140-RF-PRTR-ID          TO  PC266-PRINTER-NBR.        05797018
057980     MOVE PC140-RF-VNDR-BC-LAST-5   TO  PC266-SSCC-NBR.           05798018
057990     IF PC140-RF-SKU > SPACES                                     05799018
058000         STRING '(' PC140-RF-DEPT                                 05800018
058010                '-' PC140-RF-CLASS                                05801018
058020                ')' PC140-RF-SKU          DELIMITED BY SIZE       05802018
058030                                      INTO PC266-SKU              05803018
058040     ELSE                                                         05804018
058050         MOVE SPACES                   TO PC266-SKU               05805018
058060     END-IF.                                                      05806018
058070                                                                  05807018
058080     EVALUATE TRUE                                                05808018
058090       WHEN PC140-RF-AUDIT-STATUS = 'A'                           05809018
058100           SET PS-100-PERCENT TO TRUE                             05810018
058110       WHEN PC140-RF-AUDIT-STATUS = 'I'                           05811018
058120           SET PS-AUDIT-UNKNOWN TO TRUE                           05812018
058130       WHEN PC140-RF-AUDIT-STATUS = 'F'                           05813018
058140           SET PS-REWORK TO TRUE                                  05814018
058150       WHEN OTHER                                                 05815018
058160           SET PS-AUDIT-COMPLETE TO TRUE                          05816018
058170     END-EVALUATE.                                                05817018
058180     MOVE PS-AUDIT-IND             TO PC266-CASI.                 05818018
058190     MOVE PC140-RF-USERID          TO PC266-USERID.               05819018
058200     MOVE PC140-RF-PO-NBR TO                                      05820018
058220               RECEIV-ORD-NBR                                     05822018
058230               PC266-PO-NBR.                                      05823018
058280     MOVE PC140-RF-PO-RCVR      TO                                05828018
058290               RECEIV-REC-SEQ-NBR                                 05829018
058300               PC266-RECV-SEQ-NBR.                                05830018
058310     MOVE PC140-RF-LNE-NBR  TO                                    05831018
058330               PC266-PO-LNE-NBR                                   05833018
058340     PERFORM 3995-GET-ARVD-DATE.                                  05834018
058350     MOVE PV-ARVD-DATE TO PC266-ARVD-DTE.                         05835018
058360                                                                  05836018
058420     MOVE KRPRPM-FUNC-TXT (1:6) TO PC266-PROCESS-AREA.            05842018
058430                                                                  05843018
058440     IF PV-RFID-DIVERT-CDE = 'XXXX'                               05844018
058450*    NO BARCODE IS NEEDED                                         05845018
058460        SET  PC266-NO-BRCDE-NBR                                   05846018
058470             PC266-NO-BRCDE-VALUE  TO  TRUE                       05847018
058480        MOVE SPACES                TO  PC266-UNDR-BC-ZERO         05848018
058490                                       PC266-DIVERT-CODE          05849018
058500                                       PC266-PO-NBR-X             05850018
058510                                       PC266-RECV-SEQ-NBR-X       05851018
058520                                       PC266-PO-LNE-NBR-X         05852018
058530                                       PC266-START-CARTON-CNT     05853018
058540                                                                  05854018
058550        MOVE  PC266-WORK-END-CHARACTER TO  PC266-UNDR-BC-END      05855018
058560     ELSE                                                         05856018
058570*    BARCODE IS NEEDED                                            05857018
058580        SET  PC266-BRCD-NBR          TO TRUE                      05858018
058590        MOVE 0                       TO PC266-UNDR-BC-ZERO        05859018
058600        MOVE PC266-WORK-END-CHARACTER                             05860018
058610          TO PC266-BRCDE-NBR-END                                  05861018
058640        MOVE PC266-WORK-END-CHARACTER                             05864018
058650          TO PC266-UNDR-BC-END                                    05865018
058680        MOVE 0                       TO PC266-BC-ZERO             05868018
058690        MOVE PV-22-CRTN-DIVERT-CDE   TO PC266-BC-DIVERT-CODE      05869018
058700                                        PC266-DIVERT-CODE         05870018
058710        MOVE PC140-RF-PO-NBR         TO PC266-BC-PO-NBR           05871018
058720                                        PC266-PO-NBR-X            05872018
058730        MOVE PC140-RF-LNE-NBR        TO PV-PO-LNE-NBR-X           05873018
058740        MOVE PC140-RF-PO-RCVR(2:2)   TO PC266-BC-RECV-SEQ-NBR     05874018
058750                                        PC266-RECV-SEQ-NBR-X      05875018
058760        MOVE PV-PO-LNE-NBR-X(2:3)    TO PC266-BC-PO-LNE-NBR       05876018
058770                                        PC266-PO-LNE-NBR-X        05877018
058780        MOVE PV-22-CRTN-CART-NBR     TO PC266-START-CARTON-CNT    05878024
058790                                        PC266-BC-START-CARTON-CNT 05879018
058800     END-IF.                                                      05880018
058820                                                                  05882018
058830*----------------------------------------------------------------*05883018
058840* GET ARRIVAL DATE OF TRAILER                                    *05884018
058850*----------------------------------------------------------------*05885018
058860 3995-GET-ARVD-DATE.                                              05886018
058870                                                                  05887018
058880     EXEC SQL                                                     05888018
058890          SELECT DATE(REC_TMST)                                   05889018
058900          INTO  :PV-DATE-CCYY-MM-DD                               05890018
058910          FROM   TRECEIV                                          05891018
058920          WHERE  ORD_NBR        = :RECEIV-ORD-NBR                 05892018
058930          AND    REC_SEQ_NBR    = :RECEIV-REC-SEQ-NBR             05893018
058940          AND    VER_STATUS_CDE = 'A'                             05894018
058950     END-EXEC.                                                    05895018
058960                                                                  05896018
058970     EVALUATE TRUE                                                05897018
058980         WHEN SQLCODE = ZERO                                      05898018
058990              MOVE PV-DATE-MM-R TO PV-ARVD-DATE-MM                05899018
059000              MOVE PV-DATE-DD-R TO PV-ARVD-DATE-DD                05900018
059010              MOVE PV-DATE-YY-R TO PV-ARVD-DATE-YY                05901018
059020         WHEN SQLCODE = +100                                      05902018
059030              MOVE PV-LBL-DATE  TO PV-ARVD-DATE                   05903018
059040         WHEN SQLWARN0 NOT = SPACES                               05904018
059050         WHEN SQLCODE < ZERO                                      05905018
059060         WHEN SQLCODE > ZERO                                      05906018
059070             MOVE 'TRECEIV'           TO PV-DISP-TABLE-1          05907018
059080             PERFORM 9955-SQL-ERROR                               05908018
059090     END-EVALUATE.                                                05909018
059100                                                                  05910018
059120                                                                  05912018
059130*----------------------------------------------------------------*05913018
059140* PRINT LABEL ROUTINE                                            *05914018
059150*----------------------------------------------------------------*05915018
059160 4000-LABEL-ROUTINE.                                              05916018
059170                                                                  05917018
059180     STRING                                                       05918018
059190            ' 4000-LABEL-ROUTINE'                                 05919018
059200     DELIMITED BY SIZE                                            05920018
059210     INTO PV-CICS-MSG-AREA                                        05921018
059220     PERFORM 9990-WRITE-CICS                                      05922018
059230                                                                  05923018
059240     PERFORM 4300-FORMAT-IP-ADDR.                                 05924018
059250                                                                  05925018
059260     PERFORM 4310-CALL-SOCKET.                                    05926018
059270                                                                  05927018
059280     IF  PS-NO-SOCKET-ERROR                                       05928018
059290         PERFORM 4320-CONNECT-SOCKET                              05929018
059300     END-IF.                                                      05930018
059310                                                                  05931018
059320     IF PS-NO-SOCKET-ERROR                                        05932018
059330         PERFORM 4400-BLD-HDR-REC                                 05933018
059340     END-IF.                                                      05934018
059350                                                                  05935018
059360     IF  PS-NO-SOCKET-ERROR  AND                                  05936018
059370         (PC140-COMMON-USERID-LBL-NBR OR                          05937018
059380          PC140-COMMON-HDR-LBL-NBR OR                             05938018
059390          PC140-COMMON-MISC-LBL-NBR OR                            05939018
059400          PC140-COMMON-MISC-LBL-MSG OR                            05940018
059410          PC140-COMMON-RACK-LBL-NBR OR                            05941018
059420          PC140-BLIND-RECEIPT-LBL-NBR OR                          05942018
059430          PC140-TRAILER-SERIAL-LBL-NBR OR                         05943018
059440          PC140-RF-CRTN-STAT-APPL      OR                         05944018
059450          PC140-COMMON-MFST-LBL-NBR)                              05945018
059460         PERFORM 4450-BLD-FORM-REC                                05946018
059470     END-IF.                                                      05947018
059480                                                                  05948018
059490     IF PS-NO-SOCKET-ERROR                                        05949018
059500         PERFORM 4500-BLD-DTL-REC                                 05950018
059510     END-IF.                                                      05951018
059520                                                                  05952018
059530     IF PS-NO-SOCKET-ERROR                                        05953018
059540         PERFORM 4700-BLD-TLR-REC                                 05954018
059550     END-IF.                                                      05955018
059560                                                                  05956018
059570     IF  PS-NO-SOCKET-ERROR                                       05957018
059580         PERFORM 4340-CLOSE-SOCKET                                05958018
059590     END-IF.                                                      05959018
059600                                                                  05960018
059610                                                                  05961018
059620******************************************************************05962018
059630* this paragraph is for processing the generic SML Manifest label 05963018
059640* if all label for a DC are requested, break the request into     05964018
059650* multiple print jobs                                             05965018
059670******************************************************************05967018
059680 4100-SML-MFST-LABEL-ROUTINE.                                     05968018
059690                                                                  05969018
059700     STRING                                                       05970018
059710            ' 4100-SML-MFST-LABEL-ROUTINE'                        05971018
059720     DELIMITED BY SIZE                                            05972018
059730     INTO PV-CICS-MSG-AREA                                        05973018
059740     PERFORM 9990-WRITE-CICS                                      05974018
059750                                                                  05975018
059760                                                                  05976018
059770     PERFORM 4300-FORMAT-IP-ADDR.                                 05977018
059780                                                                  05978018
059790     SET  PS-FIRST-PASS  TO  TRUE.                                05979018
059800                                                                  05980018
059810     PERFORM 4655-OPEN-STORE-CSR.                                 05981018
059820                                                                  05982018
059830     PERFORM 4150-CREATE-SML-REQUEST                              05983018
059840       UNTIL PS-END-OF-STORE-CSR                                  05984018
059850          OR PS-SOCKET-ERROR.                                     05985018
059860                                                                  05986018
059870     PERFORM 4755-CLOSE-STORE-CSR.                                05987018
059880                                                                  05988018
059890 4150-CREATE-SML-REQUEST.                                         05989018
059900                                                                  05990018
059910     IF  PV-STORES-PROCESSED  >  0                                05991018
059920         CONTINUE                                                 05992018
059930     ELSE                                                         05993018
059940         PERFORM 4310-CALL-SOCKET                                 05994018
059950                                                                  05995018
059960         IF  PS-NO-SOCKET-ERROR                                   05996018
059970             PERFORM 4320-CONNECT-SOCKET                          05997018
059980         END-IF                                                   05998018
059990                                                                  05999018
060000         IF  PS-NO-SOCKET-ERROR                                   06000018
060010             PERFORM 4400-BLD-HDR-REC                             06001018
060020         END-IF                                                   06002018
060030                                                                  06003018
060040     END-IF.                                                      06004018
060050                                                                  06005018
060060     IF  PS-NO-SOCKET-ERROR  AND                                  06006018
060070          PC140-COMMON-MFST-LBL-NBR                               06007018
060080         PERFORM 4450-BLD-FORM-REC                                06008018
060090     END-IF.                                                      06009018
060100                                                                  06010018
060110                                                                  06011018
060120     PERFORM 4665-SML-FETCH-STORE-CSR                             06012018
060130       UNTIL PS-END-OF-STORE-CSR                                  06013018
060140          OR PV-STORES-PROCESSED = PV-LABEL-BREAK-QTY             06014018
060150          OR PS-SOCKET-ERROR.                                     06015018
060160                                                                  06016018
060170     MOVE  ZEROES  TO  PV-STORES-PROCESSED.                       06017018
060180                                                                  06018018
060190     IF PS-NO-SOCKET-ERROR                                        06019018
060200         PERFORM 4700-BLD-TLR-REC                                 06020018
060210     END-IF.                                                      06021018
060220                                                                  06022018
060230     IF  PS-NO-SOCKET-ERROR                                       06023018
060240         PERFORM 4340-CLOSE-SOCKET                                06024018
060250     END-IF.                                                      06025018
060260                                                                  06026018
060270                                                                  06027018
060330******************************************************************06033018
060340 4270-SEL-KRPRPM-FUNC-QTY.                                        06034018
060350******************************************************************06035018
060360                                                                  06036018
060370     MOVE PC140-CRA-OPER-UNT-ID      TO PC-OPER-UNT-ID.           06037018
060380                                                                  06038018
060390     STRING ' 4270-SEL-KRPRPM-FUNC-QTY'                           06039018
060400         DELIMITED BY SIZE                                        06040018
060410         INTO PV-CICS-MSG-AREA                                    06041018
060420                                                                  06042018
060430     MOVE PC-OPER-UNT-ID    TO PV-DISP-LOC                        06043018
060440     STRING ' LOC = ' PV-DISP-LOC                                 06044018
060450         ' FUNC CODE = ' DK-SYS-PRC-FUNC-CDE                      06045018
060460         DELIMITED BY SIZE INTO PV-CICS-MSG-AREA                  06046018
060470     PERFORM 9990-WRITE-CICS                                      06047018
060480                                                                  06048018
060490     EXEC SQL                                                     06049018
060500          SELECT FUNC_QTY                                         06050018
060510          INTO  :KRPRPM-FUNC-QTY                                  06051018
060520           FROM TKRPRPM                                           06052018
060530          WHERE LOC_ID             =  :PC-OPER-UNT-ID             06053018
060540            AND SYS_PRC_FUNC_CDE   = 'HDRLBL'                     06054018
060550            AND  INTFC_SYS_CDE     = 'KHL'                        06055018
060560            AND  FUNC_PRC_STAT_CDE = 'AC'                         06056018
060570     END-EXEC                                                     06057018
060580                                                                  06058018
060590                                                                  06059018
060600     MOVE SQLCODE TO    PV-SQLCODE                                06060018
060610     STRING ' PCKCS707-4270-SEL-KRPRPM-FUNC-QTY'                  06061018
060620            ' SQLCODE = ' PV-SQLCODE                              06062018
060630         DELIMITED BY SIZE INTO PV-CICS-MSG-AREA                  06063018
060640     PERFORM 9990-WRITE-CICS                                      06064018
060650                                                                  06065018
060660     EVALUATE TRUE                                                06066018
060670         WHEN SQLCODE = ZERO                                      06067018
060680             CONTINUE                                             06068018
060690         WHEN SQLCODE = +100                                      06069018
060700             MOVE 2    TO PC154-HEAD-COM-TOT-LBL                  06070018
060710         WHEN SQLCODE = -904                                      06071018
060720         WHEN SQLCODE = -911                                      06072018
060730         WHEN SQLCODE = -913                                      06073018
060740             MOVE 'TKRPRPM'           TO PV-DISP-TABLE-1          06074018
060750             PERFORM 9955-SQL-ERROR                               06075018
060760             SET  PS-SOCKET-ERROR         TO TRUE                 06076018
060770             SET  PC140-CRA-SOCKET-COMM-ERROR  TO TRUE            06077018
060780             SET PS-DUMP-TO-LOG       TO TRUE                     06078018
060790             PERFORM 9990-WRITE-CICS                              06079018
060800                                                                  06080018
060820         WHEN SQLWARN0 NOT = SPACES                               06082018
060830         WHEN SQLCODE < ZERO                                      06083018
060840         WHEN SQLCODE > ZERO                                      06084018
060850             MOVE 'TKRPRPM'           TO PV-DISP-TABLE-1          06085018
060860             PERFORM 9955-SQL-ERROR                               06086018
060870     END-EVALUATE.                                                06087018
060880                                                                  06088029
060890                                                                  06089018
060900*----------------------------------------------------------------*06090018
060910*  THIS PARAGRAPH WILL TAKE EACH NUMERIC PORTION OF THE IP       *06091018
060920*  ADDRESS AND CONVERT EACH PORTION INTO ITS HEX VALUE.  THE     *06092018
060930*  HEX VALUE WILL THEN BE MOVED TO A FIELD WHICH WILL STACK THE  *06093018
060940*  FOUR HEX VALUES SIDE BY SIDE INTO A FIELD DEFINED AS X(04).   *06094018
060950*  THIS VALUE IS THEN WHAT IS USED BY THE SOCKETS LOGIC FOR THE  *06095018
060960*  IP ADDRESS.                                                   *06096018
060970*----------------------------------------------------------------*06097018
060980 4300-FORMAT-IP-ADDR.                                             06098018
060990                                                                  06099018
061000     STRING                                                       06100018
061010            ' 4300-FORMAT-IP-ADDR'                                06101018
061020     DELIMITED BY SIZE                                            06102018
061030     INTO PV-CICS-MSG-AREA                                        06103018
061040     PERFORM 9990-WRITE-CICS                                      06104018
061050                                                                  06105018
061060     EVALUATE TRUE                                                06106018
061070     WHEN PC140-COMMON-MFST-LBL-NBR                               06107018
061080        MOVE PC140-SML-IP-ADDRESS TO PV-IP-ADDRESS                06108018
061090                                                                  06109018
061100     WHEN PC140-COMMON-USERID-LBL-NBR                             06110018
061110        MOVE PC140-UL-IP-ADDRESS TO PV-IP-ADDRESS                 06111018
061120                                                                  06112018
061130     WHEN PC140-COMMON-HDR-LBL-NBR                                06113018
061140        MOVE PC140-HL-IP-ADDRESS TO PV-IP-ADDRESS                 06114018
061150                                                                  06115018
061160     WHEN PC140-COMMON-CART-LBL-NBR                               06116018
061170        MOVE PC140-CL-IP-ADDRESS TO PV-IP-ADDRESS                 06117018
061180                                                                  06118018
061190     WHEN PC140-COMMON-MISC-LBL-NBR                               06119018
061200     WHEN PC140-COMMON-MISC-LBL-MSG                               06120018
061210        MOVE PC140-ML-IP-ADDRESS TO PV-IP-ADDRESS                 06121018
061220                                                                  06122018
061230     WHEN PC140-COMMON-RACK-LBL-NBR                               06123018
061240        MOVE PC140-RL-IP-ADDRESS TO PV-IP-ADDRESS                 06124018
061250                                                                  06125018
061260     WHEN PC140-BLIND-RECEIPT-LBL-NBR                             06126018
061270        MOVE PC140-BR-IP-ADDRESS TO PV-IP-ADDRESS                 06127018
061280                                                                  06128018
061290     WHEN PC140-TRAILER-SERIAL-LBL-NBR                            06129018
061300        MOVE PC140-TSN-IP-ADDRESS TO PV-IP-ADDRESS                06130018
061310                                                                  06131018
061320     WHEN PC140-RF-CRTN-STAT-APPL                                 06132018
061330        MOVE PC140-RF-IP-ADDRESS TO PV-IP-ADDRESS                 06133018
061340     END-EVALUATE.                                                06134018
061350                                                                  06135018
061360     MOVE PV-IP-ADDR-NUM1 TO PV-HEX-NUMERIC.                      06136018
061370     MOVE PV-HEX-CHAR-2 TO PV-HEX-FIELD-1.                        06137018
061380                                                                  06138018
061390     MOVE PV-IP-ADDR-NUM2 TO PV-HEX-NUMERIC.                      06139018
061400     MOVE PV-HEX-CHAR-2 TO PV-HEX-FIELD-2.                        06140018
061410                                                                  06141018
061420     MOVE PV-IP-ADDR-NUM3 TO PV-HEX-NUMERIC.                      06142018
061430     MOVE PV-HEX-CHAR-2 TO PV-HEX-FIELD-3.                        06143018
061440                                                                  06144018
061450     MOVE PV-IP-ADDR-NUM4 TO PV-HEX-NUMERIC.                      06145018
061460     MOVE PV-HEX-CHAR-2 TO PV-HEX-FIELD-4.                        06146018
061470                                                                  06147018
061480     MOVE PV-HEX-FIELD-NUMBER TO DP081-NAME-IP-ADDR.              06148018
061490                                                                  06149018
061500     MOVE DP081-NAME-IP-ADDR  TO PV-IP-ADDR                       06150018
061510     STRING                                                       06151018
061520            ' DP081-NAME-IP-ADDR = '  PV-IP-ADDR                  06152018
061530     DELIMITED BY SIZE                                            06153018
061540     INTO PV-CICS-MSG-AREA                                        06154018
061550     PERFORM 9990-WRITE-CICS.                                     06155018
061560                                                                  06156018
061570                                                                  06157018
061580*----------------------------------------------------------------*06158018
061590*  CALL SOCKET                                                   *06159018
061600*----------------------------------------------------------------*06160018
061610 4310-CALL-SOCKET.                                                06161018
061620                                                                  06162018
061630     STRING                                                       06163018
061640            ' 4310-CALL-SOCKET'                                   06164018
061650     DELIMITED BY SIZE                                            06165018
061660     INTO PV-CICS-MSG-AREA                                        06166018
061670     PERFORM 9990-WRITE-CICS                                      06167018
061680                                                                  06168018
061690                                                                  06169018
061700     CALL 'EZASOKET'                                              06170018
061710         USING DP081-SOCKET-CMD                                   06171018
061720               DP081-AF-INET                                      06172018
061730               DP081-SOCK-TYPE                                    06173018
061740               DP081-PROTOCOL                                     06174018
061750               DP081-ERRNO                                        06175018
061760               DP081-RETCODE.                                     06176018
061770                                                                  06177018
061780     MOVE DP081-RETCODE TO DP081-SOCK-ID.                         06178018
061790                                                                  06179018
061800     MOVE DP081-RETCODE  TO  PV-RETCODE.                          06180018
061810     MOVE DP081-ERRNO    TO  PV-ERRNO.                            06181018
061820     STRING                                                       06182018
061830            'RETURN CODE - '      DELIMITED BY SIZE               06183018
061840            PV-RETCODE            DELIMITED BY SIZE               06184018
061850            'ERROR NUMBER - '     DELIMITED BY SIZE               06185018
061860            PV-RETCODE            DELIMITED BY SIZE               06186018
061870                                  INTO PV-CICS-MSG-AREA.          06187018
061880     PERFORM 9990-WRITE-CICS.                                     06188018
061890                                                                  06189018
061900     IF DP081-RETCODE < ZERO                                      06190018
061910        SET  PS-SOCKET-ERROR         TO TRUE                      06191018
061920        SET  PC140-CRA-SOCKET-COMM-ERROR TO TRUE                  06192018
061930        MOVE PC-CURRENT-PROGRAM-NAME TO DP081-TCP-IP-PGM-NAME     06193018
061940        SET  DP081-TCP-IP-SOCKET-ERR TO TRUE                      06194018
061950        MOVE DP081-ERRNO             TO DP081-TCP-IP-ERR-NBR      06195018
061960        MOVE DP081-TCP-IP-LOGGING-MSG TO PV-CICS-MSG-AREA         06196018
061970        PERFORM 9990-WRITE-CICS                                   06197018
061980     END-IF.                                                      06198018
061990                                                                  06199018
062000*----------------------------------------------------------------*06200018
062010*  CONNECT THE PATH (SOCKET).                                    *06201018
062020*----------------------------------------------------------------*06202018
062030 4320-CONNECT-SOCKET.                                             06203018
062040                                                                  06204018
062050     STRING                                                       06205018
062060            ' 4320-CONNECT-SOCKET'                                06206018
062070     DELIMITED BY SIZE                                            06207018
062080     INTO PV-CICS-MSG-AREA                                        06208018
062090     PERFORM 9990-WRITE-CICS                                      06209018
062100                                                                  06210018
062110     MOVE DP081-AF-INET         TO DP081-NAME-FAMILY.             06211018
062120     MOVE DP081-COM-PORT        TO DP081-NAME-PORT.               06212018
062130                                                                  06213018
062140     STRING                                                       06214018
062150            'DP081-SOCK-NAME - '       DELIMITED BY SIZE          06215018
062160            DP081-SOCK-NAME            DELIMITED BY SIZE          06216018
062170            'DP081-SOCK-ID - '         DELIMITED BY SIZE          06217018
062180            PV-SOCK-ID                 DELIMITED BY SIZE          06218018
062190                                       INTO PV-CICS-MSG-AREA.     06219018
062200     PERFORM 9990-WRITE-CICS.                                     06220018
062210                                                                  06221018
062220     CALL 'EZASOKET'                                              06222018
062230         USING DP081-CONNECT-CMD                                  06223018
062240               DP081-SOCK-ID                                      06224018
062250               DP081-SOCK-NAME                                    06225018
062260               DP081-ERRNO                                        06226018
062270               DP081-RETCODE.                                     06227018
062280                                                                  06228018
062290     MOVE DP081-RETCODE  TO  PV-RETCODE.                          06229018
062300     MOVE DP081-ERRNO    TO  PV-ERRNO.                            06230018
062310     STRING ' EZASOKET CONNECT -'      DELIMITED BY SIZE          06231018
062320            ' DP081-RETCODE - '        DELIMITED BY SIZE          06232018
062330            PV-RETCODE                 DELIMITED BY SIZE          06233018
062340            ' DP081-ERRNO - '          DELIMITED BY SIZE          06234018
062350            PV-ERRNO                   DELIMITED BY SIZE          06235018
062360                                       INTO PV-CICS-MSG-AREA.     06236018
062370     PERFORM 9990-WRITE-CICS.                                     06237018
062380                                                                  06238018
062390     IF DP081-RETCODE < ZERO                                      06239018
062400        SET  PS-SOCKET-ERROR         TO TRUE                      06240018
062410        SET  PC140-CRA-SOCKET-COMM-ERROR  TO TRUE                 06241018
062420        MOVE PC-CURRENT-PROGRAM-NAME  TO DP081-TCP-IP-PGM-NAME    06242018
062430        SET  DP081-TCP-IP-CONNECT-ERR TO TRUE                     06243018
062440        MOVE DP081-ERRNO              TO DP081-TCP-IP-ERR-NBR     06244018
062450        MOVE DP081-TCP-IP-LOGGING-MSG TO PV-CICS-MSG-AREA         06245018
062460        PERFORM 9990-WRITE-CICS                                   06246018
062470                                                                  06247018
062480     ELSE                                                         06248018
062490        MOVE ' PCKCS707 - CONNECT SOCKET SUCCESSFUL'              06249018
062500                                            TO PV-CICS-MSG-AREA   06250018
062510        PERFORM 9990-WRITE-CICS                                   06251018
062520     END-IF.                                                      06252018
062530                                                                  06253018
062540*----------------------------------------------------------------*06254018
062550*  CLOSE THE SOCKET                                              *06255018
062560*----------------------------------------------------------------*06256018
062570 4340-CLOSE-SOCKET.                                               06257018
062580     STRING                                                       06258018
062590            ' 4340-CLOSE-SOCKET'                                  06259018
062600     DELIMITED BY SIZE                                            06260018
062610     INTO PV-CICS-MSG-AREA                                        06261018
062620     PERFORM 9990-WRITE-CICS                                      06262018
062630                                                                  06263018
062640     CALL 'EZASOKET'                                              06264018
062650         USING DP081-CLOSE-CMD                                    06265018
062660               DP081-SOCK-ID                                      06266018
062670               DP081-ERRNO                                        06267018
062680               DP081-RETCODE.                                     06268018
062690                                                                  06269018
062700     IF DP081-RETCODE < ZERO                                      06270018
062710        SET  PS-SOCKET-ERROR         TO TRUE                      06271018
062720        SET  PC140-CRA-SOCKET-COMM-ERROR  TO TRUE                 06272018
062730        MOVE PC-CURRENT-PROGRAM-NAME TO DP081-TCP-IP-PGM-NAME     06273018
062740        SET  DP081-TCP-IP-CLOSE-ERR  TO TRUE                      06274018
062750        MOVE DP081-ERRNO             TO DP081-TCP-IP-ERR-NBR      06275018
062760        MOVE DP081-TCP-IP-LOGGING-MSG TO PV-CICS-MSG-AREA         06276018
062770        PERFORM 9990-WRITE-CICS                                   06277018
062780                                                                  06278018
062790     ELSE                                                         06279018
062800        MOVE ' PCKCS707 - CLOSE SOCKET SUCCESSFUL'                06280018
062810                                            TO PV-CICS-MSG-AREA   06281018
062820        PERFORM 9990-WRITE-CICS                                   06282018
062830     END-IF.                                                      06283018
062840                                                                  06284018
062850                                                                  06285018
062860*----------------------------------------------------------------*06286018
062870*  CREATE SOCKET TRANSACTION ID USING RANDOM NUMBER PROGRAM      *06287018
062880*----------------------------------------------------------------*06288018
062890 4370-CREATE-TRANS-ID.                                            06289018
062900     STRING                                                       06290018
062910            ' 4370-CREATE-TRANS-ID'                               06291018
062920     DELIMITED BY SIZE                                            06292018
062930     INTO PV-CICS-MSG-AREA                                        06293018
062940     PERFORM 9990-WRITE-CICS                                      06294018
062950                                                                  06295018
062960     CALL PC-RANDOM-PGM USING DFHEIBLK                            06296018
062970                              DFHCOMMAREA                         06297018
062980                              DP902-RANDNBR-ROUTINE-FIELDS.       06298018
062990                                                                  06299018
063000     IF DP902-SUCCESSFUL                                          06300018
063010         MOVE DP902-RANDOM-NUMBER    TO PV-RANDOM-NUMBER          06301018
063020         MOVE PV-RANDOM-1-8          TO PV-LPMS-TRANS-ID          06302018
063030                                        LBTKHS-LBL-REQ-TRN-ID     06303018
063040                                                                  06304018
063050         STRING ' PCKCS707 - '        DELIMITED BY SIZE           06305018
063060                'RANDOM NUMBER - '    DELIMITED BY SIZE           06306018
063070                PV-RANDOM-NUMBER      DELIMITED BY SIZE           06307018
063080                ' LPMS-TRANS-ID - '   DELIMITED BY SIZE           06308018
063090                PV-LPMS-TRANS-ID      DELIMITED BY SIZE           06309018
063100                                      INTO PV-CICS-MSG-AREA       06310018
063110         PERFORM 9990-WRITE-CICS                                  06311018
063120                                                                  06312018
063130     ELSE                                                         06313018
063140         SET  PS-INVALID-INPUT       TO TRUE                      06314018
063150         STRING ' PCKCS707 -'              DELIMITED BY SIZE      06315018
063160                ' 4370-CREATE-TRANS-ID -'  DELIMITED BY SIZE      06316018
063170                ' ERROR GENERATING RANDOM' DELIMITED BY SIZE      06317018
063180                ' NBR FOR LPMS TRANS ID'   DELIMITED BY SIZE      06318018
063190                                           INTO PV-CICS-MSG-AREA  06319018
063200         PERFORM 9990-WRITE-CICS                                  06320018
063210         STRING ' PCKCS707 -'              DELIMITED BY SIZE      06321018
063220                ' LABEL TYPE - '           DELIMITED BY SIZE      06322018
063230                PC140-LABEL-FORMAT-NBR     DELIMITED BY SIZE      06323018
063240                '  PRTR ID - '             DELIMITED BY SIZE      06324018
063250                PC140-SML-PRTR-ID          DELIMITED BY SIZE      06325018
063260                                           INTO PV-CICS-MSG-AREA  06326018
063270         PERFORM 9990-WRITE-CICS                                  06327018
063280     END-IF.                                                      06328018
063290                                                                  06329018
063300*----------------------------------------------------------------*06330018
063310*                                                                *06331018
063320*----------------------------------------------------------------*06332018
063330 4400-BLD-HDR-REC.                                                06333018
063340     STRING                                                       06334018
063350            ' 4400-BLD-HDR-REC'                                   06335018
063360     DELIMITED BY SIZE                                            06336018
063370     INTO PV-CICS-MSG-AREA                                        06337018
063380     PERFORM 9990-WRITE-CICS                                      06338018
063390                                                                  06339018
063400     INITIALIZE PC133-LABEL-HDR-REC.                              06340018
063410     SET  PC133-LABEL-HDR           TO  TRUE.                     06341018
063420     MOVE PV-LPMS-TRANS-ID          TO  PC133-HDR-TRANS-ID.       06342018
063430     MOVE SPACES                    TO  PC133-HDR-LBL-TYPE.       06343018
063440     MOVE ZEROS                     TO  PC133-HDR-PO-NBR.         06344018
063450     MOVE ZEROS                     TO  PC133-HDR-RCVR-SEQ.       06345018
063460     MOVE SPACES                    TO  PC133-HDR-PROC-AREA.      06346018
063470     MOVE PC140-SML-PRTR-ID          TO  PC133-HDR-PRTR-ID.       06347018
063480     IF  (PC140-COMMON-MFST-LBL-NBR)                              06348018
063490         IF PC140-SML-STR-NBR (2:3) = 'ALL'                       06349018
063500             MOVE PC140-SML-STR-NBR (2:3) TO                      06350018
063510                        PC133-HDR-STORE-NBR (2:3)                 06351018
063520         ELSE                                                     06352018
063530             MOVE PC140-SML-STR-NBR  TO                           06353018
063540                        PC133-HDR-STORE-NBR                       06354018
063550         END-IF                                                   06355018
063560     END-IF.                                                      06356018
063570                                                                  06357018
063580     INSPECT PC133-LABEL-HDR-REC REPLACING ALL                    06358018
063590         '' BY SPACES.                                           06359018
063600     INSPECT PC133-LABEL-HDR-REC REPLACING ALL                    06360018
063610         ';' BY SPACES.                                           06361018
063620     INSPECT PC133-LABEL-HDR-REC REPLACING ALL                    06362018
063630         LOW-VALUES BY SPACES.                                    06363018
063640                                                                  06364018
063650     MOVE PC133-HDR-REC-LENGTH    TO DP081-TCPLENG                06365018
063660                                     DP081-NBR-BYTES.             06366018
063670                                                                  06367018
063680     PERFORM 5100-SEND-DATA-TO-LPMS.                              06368018
063690                                                                  06369018
063700*----------------------------------------------------------------*06370018
063710*  BUILD FORM RECORDS                                            *06371018
063720*----------------------------------------------------------------*06372018
063730 4450-BLD-FORM-REC.                                               06373018
063740     STRING                                                       06374018
063750            ' 4450-BLD-FORM-REC'                                  06375018
063760     DELIMITED BY SIZE                                            06376018
063770     INTO PV-CICS-MSG-AREA                                        06377018
063780     PERFORM 9990-WRITE-CICS                                      06378018
063790                                                                  06379018
063800     MOVE  ZEROES                TO PV-TRAILER-COUNT.             06380018
063810                                                                  06381018
063820* SEND FORM INFORMATION                                           06382018
063830     INITIALIZE PC133-LABEL-DTL-REC.                              06383018
063840     IF  PC140-COMMON-MFST-LBL-NBR                                06384018
063850         PERFORM 4465-SML-FORM-LABEL                              06385018
063860            VARYING PC151-IDX FROM 1 BY 1                         06386018
063870               UNTIL PC151-IDX > PC151-SML-LABEL-FORM-MAX-LN      06387018
063880                   OR PS-SOCKET-ERROR                             06388018
063890     ELSE                                                         06389018
063900     IF PC140-COMMON-USERID-LBL-NBR                               06390018
063910         PERFORM 4470-USERID-FORM-LABEL                           06391018
063920            VARYING PC155-IDX FROM 1 BY 1                         06392018
063930               UNTIL PC155-IDX > PC155-USER-LABEL-FORM-MAX-LN     06393018
063940                   OR PS-SOCKET-ERROR                             06394018
063950     ELSE                                                         06395018
063960     IF PC140-COMMON-HDR-LBL-NBR                                  06396018
063970         PERFORM 4475-HEADER-FORM-LABEL                           06397018
063980            VARYING PC153-IDX FROM 1 BY 1                         06398018
063990               UNTIL PC153-IDX > PC153-HEAD-LABEL-FORM-MAX-LN     06399018
064000                   OR PS-SOCKET-ERROR                             06400018
064010     ELSE                                                         06401018
064020     IF PC140-COMMON-MISC-LBL-NBR                                 06402018
064030         PERFORM 4480-MISC-FORM-LABEL                             06403018
064040            VARYING PC164-IDX FROM 1 BY 1                         06404018
064050               UNTIL PC164-IDX > PC164-DC-MISC-LBL-MAX-LN         06405018
064060                   OR PS-SOCKET-ERROR                             06406018
064070     ELSE                                                         06407018
064080     IF PC140-COMMON-MISC-LBL-MSG                                 06408018
064090         PERFORM 4481-MISC-FORM-LABEL-MSG                         06409018
064100            VARYING PC190-IDX FROM 1 BY 1                         06410018
064110               UNTIL PC190-IDX > PC190-DC-MISC-LBL-MAX-LN         06411018
064120                   OR PS-SOCKET-ERROR                             06412018
064130     ELSE                                                         06413018
064140     IF PC140-COMMON-RACK-LBL-NBR                                 06414018
064150         PERFORM 4485-RACK-FORM-LABEL                             06415018
064160            VARYING PC167-IDX FROM 1 BY 1                         06416018
064170               UNTIL PC167-IDX > PC167-CS-RACK-LBL-MAX-LN         06417018
064180                   OR PS-SOCKET-ERROR                             06418018
064190     ELSE                                                         06419018
064200     IF PC140-BLIND-RECEIPT-LBL-NBR                               06420018
064210         PERFORM 4490-BLIND-RECEIPT-FORM-LABEL                    06421018
064220            VARYING PC158-IDX FROM 1 BY 1                         06422018
064230               UNTIL PC158-IDX > PC158-SHIP-MFST-LBL-MAX-LN       06423018
064240                   OR PS-SOCKET-ERROR                             06424018
064250     ELSE                                                         06425018
064260     IF PC140-TRAILER-SERIAL-LBL-NBR                              06426018
064270         PERFORM 4495-TRAILER-SERIAL-FORM-LABEL                   06427018
064280            VARYING PC196-IDX FROM 1 BY 1                         06428018
064290               UNTIL PC196-IDX > PC196-TLR-LABEL-FORM-MAX-LN      06429018
064300                   OR PS-SOCKET-ERROR                             06430018
064310     ELSE                                                         06431018
064320     EVALUATE TRUE                                                06432018
064330         WHEN PC140-RF-CENTRAL-STK                                06433018
064340         WHEN PC140-RF-E-COMMERCE                                 06434018
064350            PERFORM 4497A-RF-BLIND-RCPT-FORM-LABEL                06435018
064360               VARYING PC158-IDX FROM 1 BY 1                      06436018
064370                  UNTIL PC158-IDX > PC158-SHIP-MFST-LBL-MAX-LN    06437018
064380                      OR PS-SOCKET-ERROR                          06438018
064390         WHEN PC140-RF-CHECKIN-SML                                06439018
064400         WHEN PC140-RF-SMOOTHING                                  06440018
064410           PERFORM 4497B-RF-CHECKIN-FORM-LABEL                    06441018
064420              VARYING PC255-IDX FROM 1 BY 1                       06442018
064430                 UNTIL PC255-IDX > PC255-SML-BATCH-LBL-MAX-LN     06443018
064440                     OR PS-SOCKET-ERROR                           06444018
064450         WHEN PC140-RF-DEST-LBL                                   06445018
064470           PERFORM 4497F-RF-CHECKIN-DEST-LABEL                    06447018
064480              VARYING PC169-IDX FROM 1 BY 1                       06448018
064490                 UNTIL PC169-IDX > PC169-P2L-DEST-LBL-MAX-LN      06449018
064500                     OR PS-SOCKET-ERROR                           06450018
064520         WHEN PC140-RF-PCK-2-LIT                                  06452018
064530         WHEN PC140-RF-CRTN-BULD                                  06453018
064540         WHEN PC140-RF-GENERIC-SML                                06454018
064550           PERFORM 4497C-RF-GENERIC-FORM-LABEL                    06455018
064560              VARYING PC151-IDX FROM 1 BY 1                       06456018
064570                 UNTIL PC151-IDX > PC151-SML-LABEL-FORM-MAX-LN    06457018
064580                     OR PS-SOCKET-ERROR                           06458018
064590         WHEN PC140-RF-CSEPK-SML                                  06459018
064600           IF PC140-RF-4-BY-4-LBL                                 06460018
064610               PERFORM 4497D-RF-CSEPK-FORM-LABEL                  06461018
064620                  VARYING PC253-IDX FROM 1 BY 1                   06462018
064630                     UNTIL PC253-IDX > PC253-SHIP-MFST-LBL-MAX-LN 06463018
064640                         OR PS-SOCKET-ERROR                       06464018
064700           END-IF                                                 06470018
064720         WHEN PC140-RF-CRTN-LBL                                   06472018
064730           PERFORM 4497G-RF-CRTN-FORM-LABEL                       06473018
064740              VARYING PC266-IDX FROM 1 BY 1                       06474018
064750                 UNTIL PC266-IDX > PC266-CARTON-LABEL-DATA-MAX-LN 06475018
064760                     OR PS-SOCKET-ERROR                           06476018
064780       END-EVALUATE                                               06478018
064790     END-IF.                                                      06479018
064800                                                                  06480018
064810*----------------------------------------------------------------*06481018
064820* SEND SML LABEL FORM                                            *06482018
064830*----------------------------------------------------------------*06483018
064840 4465-SML-FORM-LABEL.                                             06484018
064850                                                                  06485018
064860     STRING                                                       06486018
064870            ' 4465-SML-FORM-LABEL'                                06487018
064880     DELIMITED BY SIZE                                            06488018
064890     INTO PV-CICS-MSG-AREA                                        06489018
064900     PERFORM 9990-WRITE-CICS                                      06490018
064910                                                                  06491018
064920     SET  PC133-LABEL-DTL           TO  TRUE.                     06492018
064930     MOVE PV-LPMS-TRANS-ID          TO  PC133-DTL-TRANS-ID.       06493018
064940     SET  PC151-IDX-2               TO  PC151-IDX.                06494018
064950     MOVE PC151-SML-FORM-LINE-LENGTH (PC151-IDX-2)                06495018
064960                                    TO  PC133-DTL-LENGTH.         06496018
064970     MOVE PC151-SML-LBL-FORM-LINE (PC151-IDX)                     06497018
064980                                    TO  PC133-DTL-DATA.           06498018
064990                                                                  06499018
065000     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    06500018
065010         '' BY SPACES.                                           06501018
065020     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    06502018
065030         ';' BY SPACES.                                           06503018
065040     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    06504018
065050         LOW-VALUES BY SPACES.                                    06505018
065060                                                                  06506018
065070******************************************************************06507018
065080* LENGTH CALCULATION:                                            *06508018
065090*       LINE LENGTH SML DATA     (PC151-SML-FORM-LINE-LENGTH)    *06509018
065100*       20  =  PC133-RECORD-TYPE (LD)  (2 POSITIONS)             *06510018
065110*              PC133-DTL-TRANS-ID      (8 POSITIONS)             *06511018
065120*              PC133-DTL-LENGTH        (3 POSITIONS)             *06512018
065130*              HEX 03-END EACH DTL REC (1 POSITIONS)             *06513018
065140*              FILLER                  (6 POSITIONS)             *06514018
065150******************************************************************06515018
065160     MOVE ZEROES                  TO PC133-DTL-REC-LENGTH.        06516018
065170     MOVE PC151-SML-FORM-LINE-LENGTH (PC151-IDX-2)                06517018
065180                                  TO PC133-DTL-REC-LENGTH.        06518018
065190     ADD  20                      TO PC133-DTL-REC-LENGTH.        06519018
065200     MOVE PC133-DTL-REC-LENGTH    TO DP081-TCPLENG                06520018
065210                                     DP081-NBR-BYTES.             06521018
065220                                                                  06522018
065230     PERFORM 5100-SEND-DATA-TO-LPMS.                              06523018
065240                                                                  06524018
065250     ADD  1  TO  PV-TRAILER-COUNT.                                06525018
065260                                                                  06526018
065270*----------------------------------------------------------------*06527018
065280* SEND USERID LABEL FORM                                         *06528018
065290*----------------------------------------------------------------*06529018
065300 4470-USERID-FORM-LABEL.                                          06530018
065310     STRING                                                       06531018
065320            ' 4470-USERID-FORM-LABEL'                             06532018
065330     DELIMITED BY SIZE                                            06533018
065340     INTO PV-CICS-MSG-AREA                                        06534018
065350     PERFORM 9990-WRITE-CICS                                      06535018
065360                                                                  06536018
065370     SET  PC133-LABEL-DTL           TO  TRUE.                     06537018
065380     MOVE PV-LPMS-TRANS-ID          TO  PC133-DTL-TRANS-ID.       06538018
065390     SET  PC155-IDX-2               TO  PC155-IDX.                06539018
065400     MOVE PC155-USR-LINE-LENGTH (PC155-IDX-2)                     06540018
065410                                    TO  PC133-DTL-LENGTH.         06541018
065420     MOVE PC155-USER-LBL-LINE (PC155-IDX)                         06542018
065430                                    TO  PC133-DTL-DATA.           06543018
065440                                                                  06544018
065450     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    06545018
065460         '' BY SPACES.                                           06546018
065470     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    06547018
065480         ';' BY SPACES.                                           06548018
065490     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    06549018
065500         LOW-VALUES BY SPACES.                                    06550018
065510                                                                  06551018
065520******************************************************************06552018
065530* LENGTH CALCULATION:                                            *06553018
065540*       LINE LENGTH SL  DATA     (PC155-USR-LINE-LENGTH)         *06554018
065550*       20  =  PC133-RECORD-TYPE (LD)  (2 POSITIONS)             *06555018
065560*              PC133-DTL-TRANS-ID      (8 POSITIONS)             *06556018
065570*              PC133-DTL-LENGTH        (3 POSITIONS)             *06557018
065580*              HEX 03-END EACH DTL REC (1 POSITIONS)             *06558018
065590*              FILLER                  (6 POSITIONS)             *06559018
065600******************************************************************06560018
065610     MOVE ZEROES                  TO PC133-DTL-REC-LENGTH.        06561018
065620     MOVE PC155-USR-LINE-LENGTH (PC155-IDX-2)                     06562018
065630                                  TO PC133-DTL-REC-LENGTH.        06563018
065640     ADD  20                      TO PC133-DTL-REC-LENGTH.        06564018
065650     MOVE PC133-DTL-REC-LENGTH    TO DP081-TCPLENG                06565018
065660                                     DP081-NBR-BYTES.             06566018
065670                                                                  06567018
065680     PERFORM 5100-SEND-DATA-TO-LPMS.                              06568018
065690                                                                  06569018
065700     ADD  1  TO  PV-TRAILER-COUNT.                                06570018
065710                                                                  06571018
065720*----------------------------------------------------------------*06572018
065730* SEND HEADER LABEL FORM                                         *06573018
065740*----------------------------------------------------------------*06574018
065750 4475-HEADER-FORM-LABEL.                                          06575018
065760     STRING                                                       06576018
065770            ' 4475-HEADER-FORM-LABEL'                             06577018
065780     DELIMITED BY SIZE                                            06578018
065790     INTO PV-CICS-MSG-AREA                                        06579018
065800     PERFORM 9990-WRITE-CICS                                      06580018
065810                                                                  06581018
065820     SET  PC133-LABEL-DTL           TO  TRUE.                     06582018
065830     MOVE PV-LPMS-TRANS-ID          TO  PC133-DTL-TRANS-ID.       06583018
065840     SET  PC153-IDX-2               TO  PC153-IDX.                06584018
065850     MOVE PC153-HDR-LINE-LENGTH (PC153-IDX-2)                     06585018
065860                                    TO  PC133-DTL-LENGTH.         06586018
065870     MOVE PC153-HEADER-LBL-LINE (PC153-IDX)                       06587018
065880                                    TO  PC133-DTL-DATA.           06588018
065890                                                                  06589018
065900     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    06590018
065910         '' BY SPACES.                                           06591018
065920     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    06592018
065930         ';' BY SPACES.                                           06593018
065940     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    06594018
065950         LOW-VALUES BY SPACES.                                    06595018
065960                                                                  06596018
065970******************************************************************06597018
065980* LENGTH CALCULATION:                                            *06598018
065990*       LINE LENGTH SL  DATA     (PC153-HDR-LINE-LENGTH)         *06599018
066000*       20  =  PC133-RECORD-TYPE (LD)  (2 POSITIONS)             *06600018
066010*              PC133-DTL-TRANS-ID      (8 POSITIONS)             *06601018
066020*              PC133-DTL-LENGTH        (3 POSITIONS)             *06602018
066030*              HEX 03-END EACH DTL REC (1 POSITIONS)             *06603018
066040*              FILLER                  (6 POSITIONS)             *06604018
066050******************************************************************06605018
066060     MOVE ZEROES                  TO PC133-DTL-REC-LENGTH.        06606018
066070     MOVE PC153-HDR-LINE-LENGTH (PC153-IDX-2)                     06607018
066080                                  TO PC133-DTL-REC-LENGTH.        06608018
066090     ADD  20                      TO PC133-DTL-REC-LENGTH.        06609018
066100     MOVE PC133-DTL-REC-LENGTH    TO DP081-TCPLENG                06610018
066110                                     DP081-NBR-BYTES.             06611018
066120                                                                  06612018
066130     PERFORM 5100-SEND-DATA-TO-LPMS.                              06613018
066140                                                                  06614018
066150     ADD  1  TO  PV-TRAILER-COUNT.                                06615018
066160                                                                  06616030
066170*----------------------------------------------------------------*06617018
066180* SEND MISC LABEL FORM                                           *06618018
066190*----------------------------------------------------------------*06619018
066200 4480-MISC-FORM-LABEL.                                            06620018
066210                                                                  06621018
066220     STRING                                                       06622018
066230            ' 4480-MISC-FORM-LABEL'                               06623018
066240     DELIMITED BY SIZE                                            06624018
066250     INTO PV-CICS-MSG-AREA                                        06625018
066260     PERFORM 9990-WRITE-CICS                                      06626018
066270                                                                  06627018
066280     SET  PC133-LABEL-DTL           TO  TRUE.                     06628018
066290     MOVE PV-LPMS-TRANS-ID          TO  PC133-DTL-TRANS-ID.       06629018
066300     SET  PC164-IDX-2               TO  PC164-IDX.                06630018
066310     MOVE PC164-MISC-FORM-LINE-LENGTH (PC164-IDX-2)               06631018
066320                                    TO  PC133-DTL-LENGTH.         06632018
066330     MOVE PC164-DC-MISC-LBL-LINE (PC164-IDX)                      06633018
066340                                    TO  PC133-DTL-DATA.           06634018
066350                                                                  06635018
066360     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    06636018
066370         '' BY SPACES.                                           06637018
066380     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    06638018
066390         ';' BY SPACES.                                           06639018
066400     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    06640018
066410         LOW-VALUES BY SPACES.                                    06641018
066420                                                                  06642018
066430******************************************************************06643018
066440* LENGTH CALCULATION:                                            *06644018
066450*       LINE LENGTH ML  DATA     (PC164-MISC-FORM-LINE-LENGTH)   *06645018
066460*       20  =  PC133-RECORD-TYPE (LD)  (2 POSITIONS)             *06646018
066470*              PC133-DTL-TRANS-ID      (8 POSITIONS)             *06647018
066480*              PC133-DTL-LENGTH        (3 POSITIONS)             *06648018
066490*              HEX 03-END EACH DTL REC (1 POSITIONS)             *06649018
066500*              FILLER                  (6 POSITIONS)             *06650018
066510******************************************************************06651018
066520     MOVE ZEROES                  TO PC133-DTL-REC-LENGTH.        06652018
066530     MOVE PC164-MISC-FORM-LINE-LENGTH (PC164-IDX-2)               06653018
066540                                  TO PC133-DTL-REC-LENGTH.        06654018
066550     ADD  20                      TO PC133-DTL-REC-LENGTH.        06655018
066560     MOVE PC133-DTL-REC-LENGTH    TO DP081-TCPLENG                06656018
066570                                     DP081-NBR-BYTES.             06657018
066580                                                                  06658018
066590     PERFORM 5100-SEND-DATA-TO-LPMS.                              06659018
066600                                                                  06660018
066610     ADD  1  TO  PV-TRAILER-COUNT.                                06661018
066620                                                                  06662018
066630*----------------------------------------------------------------*06663018
066640* SEND MISC LABEL MESSAGE FORM                                   *06664018
066650*----------------------------------------------------------------*06665018
066660 4481-MISC-FORM-LABEL-MSG.                                        06666018
066670                                                                  06667018
066680     STRING                                                       06668018
066690            ' 4481-MISC-FORM-LABEL-MSG'                           06669018
066700     DELIMITED BY SIZE                                            06670018
066710     INTO PV-CICS-MSG-AREA                                        06671018
066720     PERFORM 9990-WRITE-CICS                                      06672018
066730                                                                  06673018
066740     SET  PC133-LABEL-DTL           TO  TRUE.                     06674018
066750     MOVE PV-LPMS-TRANS-ID          TO  PC133-DTL-TRANS-ID.       06675018
066760     SET  PC190-IDX-2               TO  PC190-IDX.                06676018
066770     MOVE PC190-MISC-FORM-LINE-LENGTH (PC190-IDX-2)               06677018
066780                                    TO  PC133-DTL-LENGTH.         06678018
066790     MOVE PC190-DC-MISC-LBL-LINE (PC190-IDX)                      06679018
066800                                    TO  PC133-DTL-DATA.           06680018
066810                                                                  06681018
066820     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    06682018
066830         '' BY SPACES.                                           06683018
066840     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    06684018
066850         ';' BY SPACES.                                           06685018
066860     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    06686018
066870         LOW-VALUES BY SPACES.                                    06687018
066880                                                                  06688018
066890******************************************************************06689018
066900* LENGTH CALCULATION:                                            *06690018
066910*       LINE LENGTH ML  DATA     (PC190-MISC-FORM-LINE-LENGTH)   *06691018
066920*       20  =  PC133-RECORD-TYPE (LD)  (2 POSITIONS)             *06692018
066930*              PC133-DTL-TRANS-ID      (8 POSITIONS)             *06693018
066940*              PC133-DTL-LENGTH        (3 POSITIONS)             *06694018
066950*              HEX 03-END EACH DTL REC (1 POSITIONS)             *06695018
066960*              FILLER                  (6 POSITIONS)             *06696018
066970******************************************************************06697018
066980     MOVE ZEROES                  TO PC133-DTL-REC-LENGTH.        06698018
066990     MOVE PC190-MISC-FORM-LINE-LENGTH (PC190-IDX-2)               06699018
067000                                  TO PC133-DTL-REC-LENGTH.        06700018
067010     ADD  20                      TO PC133-DTL-REC-LENGTH.        06701018
067020     MOVE PC133-DTL-REC-LENGTH    TO DP081-TCPLENG                06702018
067030                                     DP081-NBR-BYTES.             06703018
067040                                                                  06704018
067050     PERFORM 5100-SEND-DATA-TO-LPMS.                              06705018
067060                                                                  06706018
067070     ADD  1  TO  PV-TRAILER-COUNT.                                06707018
067080                                                                  06708018
067090*----------------------------------------------------------------*06709018
067100* SEND RACK LABEL FORM                                           *06710018
067110*----------------------------------------------------------------*06711018
067120 4485-RACK-FORM-LABEL.                                            06712018
067130                                                                  06713018
067140     STRING                                                       06714018
067150            ' 4485-RACK-FORM-LABEL'                               06715018
067160     DELIMITED BY SIZE                                            06716018
067170     INTO PV-CICS-MSG-AREA                                        06717018
067180     PERFORM 9990-WRITE-CICS                                      06718018
067190                                                                  06719018
067200     SET  PC133-LABEL-DTL           TO  TRUE.                     06720018
067210     MOVE PV-LPMS-TRANS-ID          TO  PC133-DTL-TRANS-ID.       06721018
067220     SET  PC167-IDX-2               TO  PC167-IDX.                06722018
067230     MOVE PC167-RACK-FORM-LINE-LENGTH (PC167-IDX-2)               06723018
067240                                    TO  PC133-DTL-LENGTH.         06724018
067250     MOVE PC167-CS-RACK-LBL-LINE (PC167-IDX)                      06725018
067260                                    TO  PC133-DTL-DATA.           06726018
067270                                                                  06727018
067280     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    06728018
067290         '' BY SPACES.                                           06729018
067300     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    06730018
067310         ';' BY SPACES.                                           06731018
067320     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    06732018
067330         LOW-VALUES BY SPACES.                                    06733018
067340                                                                  06734018
067350******************************************************************06735018
067360* LENGTH CALCULATION:                                            *06736018
067370*       LINE LENGTH ML  DATA     (PC167-RACK-FORM-LINE-LENGTH)   *06737018
067380*       20  =  PC133-RECORD-TYPE (LD)  (2 POSITIONS)             *06738018
067390*              PC133-DTL-TRANS-ID      (8 POSITIONS)             *06739018
067400*              PC133-DTL-LENGTH        (3 POSITIONS)             *06740018
067410*              HEX 03-END EACH DTL REC (1 POSITIONS)             *06741018
067420*              FILLER                  (6 POSITIONS)             *06742018
067430******************************************************************06743018
067440     MOVE ZEROES                  TO PC133-DTL-REC-LENGTH.        06744018
067450     MOVE PC167-RACK-FORM-LINE-LENGTH (PC167-IDX-2)               06745018
067460                                  TO PC133-DTL-REC-LENGTH.        06746018
067470     ADD  20                      TO PC133-DTL-REC-LENGTH.        06747018
067480     MOVE PC133-DTL-REC-LENGTH    TO DP081-TCPLENG                06748018
067490                                     DP081-NBR-BYTES.             06749018
067500                                                                  06750018
067510     PERFORM 5100-SEND-DATA-TO-LPMS.                              06751018
067520                                                                  06752018
067530     ADD  1  TO  PV-TRAILER-COUNT.                                06753018
067540                                                                  06754018
067550*----------------------------------------------------------------*06755018
067560* CREATE BLIND RECEIPT LABEL.                                     06756018
067570*----------------------------------------------------------------*06757018
067580 4490-BLIND-RECEIPT-FORM-LABEL.                                   06758018
067590                                                                  06759018
067600     STRING                                                       06760018
067610            ' 4490-BLIND-RECEIPT-FORM-LABEL'                      06761018
067620     DELIMITED BY SIZE                                            06762018
067630     INTO PV-CICS-MSG-AREA                                        06763018
067640     PERFORM 9990-WRITE-CICS                                      06764018
067650                                                                  06765018
067660     SET  PC133-LABEL-DTL           TO  TRUE.                     06766018
067670     MOVE PV-LPMS-TRANS-ID          TO  PC133-DTL-TRANS-ID.       06767018
067680     SET  PC158-IDX-2               TO  PC158-IDX.                06768018
067690     MOVE PC158-SML-FORM-LINE-LENGTH (PC158-IDX-2)                06769018
067700                                    TO  PC133-DTL-LENGTH.         06770018
067710     MOVE PC158-SHIP-MFST-LBL-LINE (PC158-IDX)                    06771018
067720                                    TO  PC133-DTL-DATA.           06772018
067730                                                                  06773018
067740     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    06774018
067750         '' BY SPACES.                                           06775018
067760     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    06776018
067770         ';' BY SPACES.                                           06777018
067780     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    06778018
067790         LOW-VALUES BY SPACES.                                    06779018
067800                                                                  06780018
067810******************************************************************06781018
067820* LENGTH CALCULATION:                                            *06782018
067830*       LINE LENGTH SL  DATA     (PC158-SML-FORM-LINE-LENGTH)    *06783018
067840*       20  =  PC133-RECORD-TYPE (LD)  (2 POSITIONS)             *06784018
067850*              PC133-DTL-TRANS-ID      (8 POSITIONS)             *06785018
067860*              PC133-DTL-LENGTH        (3 POSITIONS)             *06786018
067870*              HEX 03-END EACH DTL REC (1 POSITIONS)             *06787018
067880*              FILLER                  (6 POSITIONS)             *06788018
067890******************************************************************06789018
067900     MOVE ZEROES                  TO PC133-DTL-REC-LENGTH.        06790018
067910     MOVE PC158-SML-FORM-LINE-LENGTH (PC158-IDX-2)                06791018
067920                                  TO PC133-DTL-REC-LENGTH.        06792018
067930     ADD  20                      TO PC133-DTL-REC-LENGTH.        06793018
067940     MOVE PC133-DTL-REC-LENGTH    TO DP081-TCPLENG                06794018
067950                                     DP081-NBR-BYTES.             06795018
067960                                                                  06796018
067970     PERFORM 5100-SEND-DATA-TO-LPMS.                              06797018
067980                                                                  06798018
067990     ADD  1  TO  PV-TRAILER-COUNT.                                06799018
068000                                                                  06800018
068010*----------------------------------------------------------------*06801018
068020* CREATE TRAILER SERIAL LABEL.                                    06802018
068030*----------------------------------------------------------------*06803018
068040 4495-TRAILER-SERIAL-FORM-LABEL.                                  06804018
068050                                                                  06805018
068060     STRING                                                       06806018
068070            ' 4495-TRAILER-SERIAL-FORM-LABEL'                     06807018
068080     DELIMITED BY SIZE                                            06808018
068090     INTO PV-CICS-MSG-AREA                                        06809018
068100     PERFORM 9990-WRITE-CICS                                      06810018
068110                                                                  06811018
068120     SET  PC133-LABEL-DTL           TO  TRUE.                     06812018
068130     MOVE PV-LPMS-TRANS-ID          TO  PC133-DTL-TRANS-ID.       06813018
068140     SET  PC196-IDX-2               TO  PC196-IDX.                06814018
068150     MOVE PC196-TLR-FORM-LINE-LENGTH (PC196-IDX-2)                06815018
068160                                    TO  PC133-DTL-LENGTH.         06816018
068170     MOVE PC196-TLR-LBL-FORM-LINE (PC196-IDX)                     06817018
068180                                    TO  PC133-DTL-DATA.           06818018
068190                                                                  06819018
068200     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    06820018
068210         '' BY SPACES.                                           06821018
068220     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    06822018
068230         ';' BY SPACES.                                           06823018
068240     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    06824018
068250         LOW-VALUES BY SPACES.                                    06825018
068260                                                                  06826018
068270******************************************************************06827018
068280* LENGTH CALCULATION:                                            *06828018
068290*       LINE LENGTH SL  DATA     (PC196-TLR-FORM-LINE-LENGTH)    *06829018
068300*       20  =  PC133-RECORD-TYPE (LD)  (2 POSITIONS)             *06830018
068310*              PC133-DTL-TRANS-ID      (8 POSITIONS)             *06831018
068320*              PC133-DTL-LENGTH        (3 POSITIONS)             *06832018
068330*              HEX 03-END EACH DTL REC (1 POSITIONS)             *06833018
068340*              FILLER                  (6 POSITIONS)             *06834018
068350******************************************************************06835018
068360     MOVE ZEROES                  TO PC133-DTL-REC-LENGTH.        06836018
068370     MOVE PC196-TLR-FORM-LINE-LENGTH (PC196-IDX-2)                06837018
068380                                  TO PC133-DTL-REC-LENGTH.        06838018
068390     ADD  20                      TO PC133-DTL-REC-LENGTH.        06839018
068400     MOVE PC133-DTL-REC-LENGTH    TO DP081-TCPLENG                06840018
068410                                     DP081-NBR-BYTES.             06841018
068420                                                                  06842018
068430     PERFORM 5100-SEND-DATA-TO-LPMS.                              06843018
068440                                                                  06844018
068450     ADD  1  TO  PV-TRAILER-COUNT.                                06845018
068460                                                                  06846018
068470*----------------------------------------------------------------*06847018
068480* CREATE RF BLIND RECEIPT LABEL.                                  06848018
068490*----------------------------------------------------------------*06849018
068500 4497A-RF-BLIND-RCPT-FORM-LABEL.                                  06850018
068510     STRING ' 4497A-RF-BLIND-RCPT-FORM-LABEL'                     06851018
068520     DELIMITED BY SIZE                                            06852018
068530     INTO PV-CICS-MSG-AREA                                        06853018
068540     PERFORM 9990-WRITE-CICS                                      06854018
068550                                                                  06855018
068560     SET  PC133-LABEL-DTL           TO  TRUE.                     06856018
068570     MOVE PV-LPMS-TRANS-ID          TO  PC133-DTL-TRANS-ID.       06857018
068580     SET  PC158-IDX-2               TO  PC158-IDX.                06858018
068590     MOVE PC158-SML-FORM-LINE-LENGTH (PC158-IDX-2)                06859018
068600                                    TO  PC133-DTL-LENGTH.         06860018
068610     MOVE PC158-SHIP-MFST-LBL-LINE (PC158-IDX)                    06861018
068620                                    TO  PC133-DTL-DATA.           06862018
068630                                                                  06863018
068640     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    06864018
068650         '' BY SPACES.                                           06865018
068660     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    06866018
068670         ';' BY SPACES.                                           06867018
068680     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    06868018
068690         LOW-VALUES BY SPACES.                                    06869018
068700                                                                  06870018
068710******************************************************************06871018
068720* LENGTH CALCULATION:                                            *06872018
068730*       LINE LENGTH SL  DATA     (PC158-SML-FORM-LINE-LENGTH)    *06873018
068740*       20  =  PC133-RECORD-TYPE (LD)  (2 POSITIONS)             *06874018
068750*              PC133-DTL-TRANS-ID      (8 POSITIONS)             *06875018
068760*              PC133-DTL-LENGTH        (3 POSITIONS)             *06876018
068770*              HEX 03-END EACH DTL REC (1 POSITIONS)             *06877018
068780*              FILLER                  (6 POSITIONS)             *06878018
068790******************************************************************06879018
068800     MOVE ZEROES                  TO PC133-DTL-REC-LENGTH.        06880018
068810     MOVE PC158-SML-FORM-LINE-LENGTH (PC158-IDX-2)                06881018
068820                                  TO PC133-DTL-REC-LENGTH.        06882018
068830     ADD  20                      TO PC133-DTL-REC-LENGTH.        06883018
068840     MOVE PC133-DTL-REC-LENGTH    TO DP081-TCPLENG                06884018
068850                                     DP081-NBR-BYTES.             06885018
068860                                                                  06886018
068870     PERFORM 5100-SEND-DATA-TO-LPMS.                              06887018
068880                                                                  06888018
068890     ADD  1  TO  PV-TRAILER-COUNT.                                06889018
068900                                                                  06890018
068910*----------------------------------------------------------------*06891018
068920* CREATE RF CHECKIN SML LABEL FORM                                06892018
068930*----------------------------------------------------------------*06893018
068940 4497B-RF-CHECKIN-FORM-LABEL.                                     06894018
068950     INITIALIZE PC133-LABEL-DTL-REC.                              06895018
068960     SET  PC133-LABEL-DTL           TO  TRUE.                     06896018
068970                                                                  06897018
068980     MOVE PV-LPMS-TRANS-ID          TO  PC133-DTL-TRANS-ID.       06898018
068990     SET  PC255-IDX-2               TO  PC255-IDX.                06899018
069000     MOVE PC255-DTL-FORM-LNE-LNGTH (PC255-IDX-2)                  06900018
069010                                    TO  PC133-DTL-LENGTH.         06901018
069020     MOVE PC255-SHIP-MFST-LBL-LINE (PC255-IDX)                    06902018
069030                                    TO  PC133-DTL-DATA.           06903018
069040                                                                  06904018
069050     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    06905018
069060         '' BY SPACES.                                           06906018
069070     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    06907018
069080         ';' BY SPACES.                                           06908018
069090     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    06909018
069100         LOW-VALUES BY SPACES.                                    06910018
069110                                                                  06911018
069120******************************************************************06912018
069130* LENGTH CALCULATION:                                            *06913018
069140*       LINE LENGTH SML FORM     (PC255-DTL-FORM-LNE-LNGTH)      *06914018
069150*       20  =  PC133-RECORD-TYPE (LD)  (2 POSITIONS)             *06915018
069160*              PC133-DTL-TRANS-ID      (8 POSITIONS)             *06916018
069170*              PC133-DTL-LENGTH        (3 POSITIONS)             *06917018
069180*              HEX 03-END EACH DTL REC (1 POSITIONS)             *06918018
069190*              FILLER                  (6 POSITIONS)             *06919018
069200******************************************************************06920018
069210     MOVE ZEROES                  TO PC133-DTL-REC-LENGTH.        06921018
069220     MOVE PC255-DTL-FORM-LNE-LNGTH (PC255-IDX-2)                  06922018
069230                                  TO PC133-DTL-REC-LENGTH.        06923018
069240     ADD  20                      TO PC133-DTL-REC-LENGTH.        06924018
069250     MOVE PC133-DTL-REC-LENGTH    TO DP081-TCPLENG                06925018
069260                                     DP081-NBR-BYTES.             06926018
069270                                                                  06927018
069280     PERFORM 5100-SEND-DATA-TO-LPMS.                              06928018
069290                                                                  06929018
069300     ADD  1  TO  PV-TRAILER-COUNT.                                06930018
069310                                                                  06931029
069320*----------------------------------------------------------------*06932018
069330* CREATE RF GENERIC LABEL FORM                                    06933018
069340*----------------------------------------------------------------*06934018
069350 4497C-RF-GENERIC-FORM-LABEL.                                     06935018
069360     INITIALIZE PC133-LABEL-DTL-REC.                              06936018
069370     SET  PC133-LABEL-DTL           TO  TRUE.                     06937018
069380                                                                  06938018
069390     MOVE PV-LPMS-TRANS-ID          TO  PC133-DTL-TRANS-ID.       06939018
069400     SET  PC151-IDX-2               TO  PC151-IDX.                06940018
069410     MOVE PC151-SML-FORM-LINE-LENGTH (PC151-IDX-2)                06941018
069420                                    TO  PC133-DTL-LENGTH.         06942018
069430     MOVE PC151-SML-LBL-FORM-LINE (PC151-IDX)                     06943018
069440                                    TO  PC133-DTL-DATA.           06944018
069450                                                                  06945018
069460     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    06946018
069470         '' BY SPACES.                                           06947018
069480     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    06948018
069490         ';' BY SPACES.                                           06949018
069500     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    06950018
069510         LOW-VALUES BY SPACES.                                    06951018
069520                                                                  06952018
069530******************************************************************06953018
069540* LENGTH CALCULATION:                                            *06954018
069550*       LINE LENGTH SML FORM     (PC151-SML-FORM-LINE-LENGTH)    *06955018
069560*       20  =  PC133-RECORD-TYPE (LD)  (2 POSITIONS)             *06956018
069570*              PC133-DTL-TRANS-ID      (8 POSITIONS)             *06957018
069580*              PC133-DTL-LENGTH        (3 POSITIONS)             *06958018
069590*              HEX 03-END EACH DTL REC (1 POSITIONS)             *06959018
069600*              FILLER                  (6 POSITIONS)             *06960018
069610******************************************************************06961018
069620     MOVE ZEROES                  TO PC133-DTL-REC-LENGTH.        06962018
069630     MOVE PC151-SML-FORM-LINE-LENGTH (PC151-IDX-2)                06963018
069640                                  TO PC133-DTL-REC-LENGTH.        06964018
069650     ADD  20                      TO PC133-DTL-REC-LENGTH.        06965018
069660     MOVE PC133-DTL-REC-LENGTH    TO DP081-TCPLENG                06966018
069670                                     DP081-NBR-BYTES.             06967018
069680                                                                  06968018
069690     PERFORM 5100-SEND-DATA-TO-LPMS.                              06969018
069700                                                                  06970018
069710     ADD  1  TO  PV-TRAILER-COUNT.                                06971018
069720*                                                                 06972018
069730*----------------------------------------------------------------*06973018
069740* CREATE RF CSEPK 4-BY-4 LABEL FORM                               06974018
069750*----------------------------------------------------------------*06975018
069760 4497D-RF-CSEPK-FORM-LABEL.                                       06976018
069770     INITIALIZE PC133-LABEL-DTL-REC.                              06977018
069780     SET  PC133-LABEL-DTL           TO  TRUE.                     06978018
069790                                                                  06979018
069800     MOVE PV-LPMS-TRANS-ID          TO  PC133-DTL-TRANS-ID.       06980018
069810     SET  PC253-IDX-2               TO  PC253-IDX.                06981018
069820     MOVE PC253-SML-FORM-LINE-LENGTH (PC253-IDX-2)                06982018
069830                                    TO  PC133-DTL-LENGTH.         06983018
069840     MOVE PC253-SHIP-MFST-LBL-LINE (PC253-IDX)                    06984018
069850                                    TO  PC133-DTL-DATA.           06985018
069860                                                                  06986018
069870     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    06987018
069880         '' BY SPACES.                                           06988018
069890     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    06989018
069900         ';' BY SPACES.                                           06990018
069910     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    06991018
069920         LOW-VALUES BY SPACES.                                    06992018
069930                                                                  06993018
069940******************************************************************06994018
069950* LENGTH CALCULATION:                                            *06995018
069960*       LINE LENGTH SML FORM     (PC253-SML-FORM-LINE-LENGTH)    *06996018
069970*       20  =  PC133-RECORD-TYPE (LD)  (2 POSITIONS)             *06997018
069980*              PC133-DTL-TRANS-ID      (8 POSITIONS)             *06998018
069990*              PC133-DTL-LENGTH        (3 POSITIONS)             *06999018
070000*              HEX 03-END EACH DTL REC (1 POSITIONS)             *07000018
070010*              FILLER                  (6 POSITIONS)             *07001018
070020******************************************************************07002018
070030     MOVE ZEROES                  TO PC133-DTL-REC-LENGTH.        07003018
070040     MOVE PC253-SML-FORM-LINE-LENGTH (PC253-IDX-2)                07004018
070050                                  TO PC133-DTL-REC-LENGTH.        07005018
070060     ADD  20                      TO PC133-DTL-REC-LENGTH.        07006018
070070     MOVE PC133-DTL-REC-LENGTH    TO DP081-TCPLENG                07007018
070080                                     DP081-NBR-BYTES.             07008018
070090                                                                  07009018
070100     PERFORM 5100-SEND-DATA-TO-LPMS.                              07010018
070110                                                                  07011018
070120     ADD  1  TO  PV-TRAILER-COUNT.                                07012018
070130                                                                  07013029
070550*----------------------------------------------------------------*07055018
070560* CREATE RF GENERIC LABEL FORM                                    07056018
070570*----------------------------------------------------------------*07057018
070580 4497F-RF-CHECKIN-DEST-LABEL.                                     07058018
070590     INITIALIZE PC133-LABEL-DTL-REC.                              07059018
070600     SET  PC133-LABEL-DTL           TO  TRUE.                     07060018
070610                                                                  07061018
070620     MOVE PV-LPMS-TRANS-ID          TO  PC133-DTL-TRANS-ID.       07062018
070630     SET  PC169-IDX-2               TO  PC169-IDX.                07063018
070640     MOVE PC169-DEST-LBL-LINE-LENGTH (PC169-IDX-2)                07064018
070650                                    TO  PC133-DTL-LENGTH.         07065018
070660     MOVE PC169-P2L-DEST-LBL-LINE (PC169-IDX)                     07066018
070670                                    TO  PC133-DTL-DATA.           07067018
070680                                                                  07068018
070690     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    07069018
070700         '' BY SPACES.                                           07070018
070710     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    07071018
070720         ';' BY SPACES.                                           07072018
070730     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    07073018
070740         LOW-VALUES BY SPACES.                                    07074018
070750                                                                  07075018
070760     MOVE ZEROES                  TO PC133-DTL-REC-LENGTH.        07076018
070770     MOVE PC169-dest-lbl-line-lenGTH (PC169-IDX-2)                07077018
070780                                  TO PC133-DTL-REC-LENGTH.        07078018
070790     ADD  20                      TO PC133-DTL-REC-LENGTH.        07079018
070800     MOVE PC133-DTL-REC-LENGTH    TO DP081-TCPLENG                07080018
070810                                     DP081-NBR-BYTES.             07081018
070820                                                                  07082018
070830     PERFORM 5100-SEND-DATA-TO-LPMS.                              07083018
070840                                                                  07084018
070850     ADD  1  TO  PV-TRAILER-COUNT.                                07085018
070860                                                                  07086029
070870*----------------------------------------------------------------*07087018
070880* CREATE RF CARTON LABEL FORM                                     07088018
070890*----------------------------------------------------------------*07089018
070900 4497G-RF-CRTN-FORM-LABEL.                                        07090018
070910     INITIALIZE PC133-LABEL-DTL-REC.                              07091018
070920     SET  PC133-LABEL-DTL           TO  TRUE.                     07092018
070930                                                                  07093018
070940     MOVE PV-LPMS-TRANS-ID          TO  PC133-DTL-TRANS-ID.       07094018
070950     SET  PC266-IDX-2               TO  PC266-IDX.                07095018
070960     MOVE PC266-CART-LINE-LENGTH (PC266-IDX-2)                    07096018
070970                                    TO  PC133-DTL-LENGTH.         07097018
070980     MOVE PC266-CARTON-LBL-LINE (PC266-IDX)                       07098018
070990                                    TO  PC133-DTL-DATA.           07099018
071000                                                                  07100018
071010     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    07101018
071020         '' BY SPACES.                                           07102018
071030     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    07103018
071040         ';' BY SPACES.                                           07104018
071050     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    07105018
071060         LOW-VALUES BY SPACES.                                    07106018
071070                                                                  07107018
071080******************************************************************07108018
071090* LENGTH CALCULATION:                                            *07109018
071100*       LINE LENGTH SML FORM     (PC040-PGY-FORM-LINE-LENGTH)    *07110018
071110*       20  =  PC133-RECORD-TYPE (LD)  (2 POSITIONS)             *07111018
071120*              PC133-DTL-TRANS-ID      (8 POSITIONS)             *07112018
071130*              PC133-DTL-LENGTH        (3 POSITIONS)             *07113018
071140*              HEX 03-END EACH DTL REC (1 POSITIONS)             *07114018
071150*              FILLER                  (6 POSITIONS)             *07115018
071160******************************************************************07116018
071170     MOVE ZEROES                  TO PC133-DTL-REC-LENGTH.        07117018
071180     MOVE PC266-CART-LINE-LENGTH (PC266-IDX-2)                    07118018
071190                                  TO PC133-DTL-REC-LENGTH.        07119018
071200     ADD  20                      TO PC133-DTL-REC-LENGTH.        07120018
071210     MOVE PC133-DTL-REC-LENGTH    TO DP081-TCPLENG                07121018
071220                                     DP081-NBR-BYTES.             07122018
071230                                                                  07123018
071240     PERFORM 5100-SEND-DATA-TO-LPMS.                              07124018
071250                                                                  07125018
071260     ADD  1  TO  PV-TRAILER-COUNT.                                07126018
071270*                                                                 07127018
071280*----------------------------------------------------------------*07128018
071290*  BUILD DETAIL RECORDS                                          *07129018
071300*----------------------------------------------------------------*07130018
071310 4500-BLD-DTL-REC.                                                07131018
071320     STRING                                                       07132018
071330            ' 4500-BLD-DTL-REC'                                   07133018
071340     DELIMITED BY SIZE                                            07134018
071350     INTO PV-CICS-MSG-AREA                                        07135018
071360     PERFORM 9990-WRITE-CICS                                      07136018
071370                                                                  07137018
071380* SEND DETAIL LABELS                                              07138018
071390     INITIALIZE PC133-LABEL-DTL-REC.                              07139018
071400                                                                  07140018
071410     IF  PC140-COMMON-MFST-LBL-NBR                                07141018
071420         IF  PC140-ALL-STORES                                     07142018
071430             SET  PS-FIRST-PASS  TO  TRUE                         07143018
071440             PERFORM 4655-OPEN-STORE-CSR                          07144018
071450             PERFORM 4665-SML-FETCH-STORE-CSR                     07145018
071460               UNTIL PS-END-OF-STORE-CSR                          07146018
071470                  OR PS-SOCKET-ERROR                              07147018
071480             PERFORM 4755-CLOSE-STORE-CSR                         07148018
071490         ELSE                                                     07149018
071500             SET  PC133-LABEL-DTL            TO TRUE              07150018
071510             PERFORM 4515-SML-DTL-LABEL                           07151018
071520                VARYING PC152-IDX FROM 1 BY 1                     07152018
071530                  UNTIL PC152-IDX                                 07153018
071540                      > PC152-SML-LABEL-DATA-MAX-LN               07154018
071550                     OR PS-SOCKET-ERROR                           07155018
071560         END-IF                                                   07156018
071570     ELSE                                                         07157018
071580     IF PC140-COMMON-USERID-LBL-NBR                               07158018
071590         SET PC133-LABEL-DTL TO TRUE                              07159018
071600         PERFORM 4520-USERID-DTL-LABEL                            07160018
071610            VARYING PC156-IDX FROM 1 BY 1                         07161018
071620              UNTIL PC156-IDX                                     07162018
071630                    > PC156-USER-LABEL-DATA-MAX-LN                07163018
071640                          OR PS-SOCKET-ERROR                      07164018
071650     ELSE                                                         07165018
071660     IF PC140-COMMON-HDR-LBL-NBR                                  07166018
071670         SET PC133-LABEL-DTL TO TRUE                              07167018
071680         PERFORM 4525-HEADER-DTL-LABEL                            07168018
071690            VARYING PC154-IDX FROM 1 BY 1                         07169018
071700              UNTIL PC154-IDX                                     07170018
071710                    > PC154-HEAD-LABEL-DATA-MAX-LN                07171018
071720                          OR PS-SOCKET-ERROR                      07172018
071730     ELSE                                                         07173018
071740     IF PC140-COMMON-CART-LBL-NBR                                 07174018
071750         SET PC133-LABEL-DTL TO TRUE                              07175018
071760         PERFORM 4530-CARTON-DTL-LABEL                            07176018
071770            VARYING PC157-IDX FROM 1 BY 1                         07177018
071780              UNTIL PC157-IDX                                     07178018
071790                    > PC157-CARTON-LABEL-DATA-MAX-LN              07179018
071800                          OR PS-SOCKET-ERROR                      07180018
071810     ELSE                                                         07181018
071820     IF PC140-COMMON-MISC-LBL-NBR OR                              07182018
071830         PC140-COMMON-MISC-LBL-MSG                                07183018
071840         SET PC133-LABEL-DTL TO TRUE                              07184018
071850         IF PS-RANGE-REQUESTED                                    07185018
071860            PERFORM 4532-SETS-LOOP                                07186018
071870         ELSE                                                     07187018
071880            IF PC140-COMMON-MISC-LBL-NBR                          07188018
071890               MOVE PC140-ML-TOT-LBLS  TO PV-SETS-SUB             07189018
071900               PERFORM 4536-SEND-MISC-DATA PV-SETS-SUB  TIMES     07190018
071910            ELSE                                                  07191018
071920               MOVE PC140-ML-TOT-LBLS  TO PV-SETS-SUB             07192018
071940               PERFORM 4538-SEND-MISC-DATA-MSG PV-SETS-SUB TIMES  07194018
071950            END-IF                                                07195018
071960         END-IF                                                   07196018
071970     ELSE                                                         07197018
071980     IF PC140-COMMON-RACK-LBL-NBR                                 07198018
071990         SET PC133-LABEL-DTL TO TRUE                              07199018
072000         IF (PS-RANGE-REQUESTED OR PC140-RL-TOT-LBLS > +1)        07200018
072010            PERFORM 4542-SETS-LOOP-RL                             07201018
072020         ELSE                                                     07202018
072030            MOVE PC140-RL-TOT-LBLS  TO PV-SETS-SUB                07203018
072040            PERFORM 4546-SEND-RACK-DATA PV-SETS-SUB  TIMES        07204018
072050         END-IF                                                   07205018
072060     ELSE                                                         07206018
072070     IF PC140-BLIND-RECEIPT-LBL-NBR                               07207018
072080         SET PC133-LABEL-DTL TO TRUE                              07208018
072090         PERFORM 4550-BLIND-RECEIPT-DTL-LABEL                     07209018
072100            VARYING PC189-IDX FROM 1 BY 1                         07210018
072110              UNTIL PC189-IDX                                     07211018
072120                    > PC189-MAX-LABEL-LINES                       07212018
072130                          OR PS-SOCKET-ERROR                      07213018
072140     ELSE                                                         07214018
072150     IF PC140-TRAILER-SERIAL-LBL-NBR                              07215018
072160         SET PC133-LABEL-DTL TO TRUE                              07216018
072170         PERFORM 4560-TRAILER-SERIAL-DTL-LABEL                    07217018
072180            VARYING PC197-IDX FROM 1 BY 1                         07218018
072190              UNTIL PC197-IDX                                     07219018
072200                    > PC197-TLR-LABEL-DATA-MAX-LN                 07220018
072210                          OR PS-SOCKET-ERROR                      07221018
072220     ELSE                                                         07222018
072230     EVALUATE TRUE                                                07223018
072240         WHEN PC140-RF-CENTRAL-STK                                07224018
072250         WHEN PC140-RF-E-COMMERCE                                 07225018
072260             SET PC133-LABEL-DTL TO TRUE                          07226018
072270             PERFORM 4570-RF-BLIND-RCPT-DTL-LABEL                 07227018
072280                VARYING PC189-IDX FROM 1 BY 1                     07228018
072290                 UNTIL PC189-IDX > PC189-MAX-LABEL-LINES          07229018
072300                      OR PS-SOCKET-ERROR                          07230018
072310         WHEN PC140-RF-CHECKIN-SML                                07231018
072320         WHEN PC140-RF-SMOOTHING                                  07232018
072330             SET PC133-LABEL-DTL TO TRUE                          07233018
072340             PERFORM 4570A-RF-CHECKIN-SML-DTL-LABEL               07234018
072350                VARYING PC256-IDX FROM 1 BY 1                     07235018
072360                  UNTIL PC256-IDX > PC256-MAX-LABEL-LINES         07236018
072370                     OR PS-SOCKET-ERROR                           07237018
072380         WHEN PC140-RF-PCK-2-LIT                                  07238018
072390         WHEN PC140-RF-CRTN-BULD                                  07239018
072400         WHEN PC140-RF-GENERIC-SML                                07240018
072410             SET PC133-LABEL-DTL TO TRUE                          07241018
072420             PERFORM 4570B-RF-GENERIC-SML-DTL-LABEL               07242018
072430                VARYING PC152-IDX FROM 1 BY 1                     07243018
072440                  UNTIL PC152-IDX > PC152-SML-LABEL-DATA-MAX-LN   07244018
072450                     OR PS-SOCKET-ERROR                           07245018
072460         WHEN PC140-RF-CSEPK-SML                                  07246018
072470             IF PC140-RF-4-BY-4-LBL                               07247018
072480                 SET PC133-LABEL-DTL TO TRUE                      07248018
072490                 PERFORM 4570C-RF-CSEPK-SML-DTL-LABEL             07249018
072500                    VARYING PC254-IDX FROM 1 BY 1                 07250018
072510                      UNTIL PC254-IDX > PC254-MAX-LABEL-LINES     07251018
072520                         OR PS-SOCKET-ERROR                       07252018
072590             END-IF                                               07259018
072600       END-EVALUATE                                               07260018
072610     END-IF.                                                      07261018
072620                                                                  07262018
072630*----------------------------------------------------------------*07263018
072640* SEND DETAIL - SML LABEL                                        *07264018
072650*----------------------------------------------------------------*07265018
072660 4515-SML-DTL-LABEL.                                              07266018
072670                                                                  07267018
072680     STRING                                                       07268018
072690            ' 4515-SML-DTL-LABEL'                                 07269018
072700     DELIMITED BY SIZE                                            07270018
072710     INTO PV-CICS-MSG-AREA                                        07271018
072720     PERFORM 9990-WRITE-CICS                                      07272018
072730                                                                  07273018
072740     SET  PC133-LABEL-DTL           TO  TRUE.                     07274018
072750     MOVE PV-LPMS-TRANS-ID          TO  PC133-DTL-TRANS-ID.       07275018
072760     SET  PC152-IDX-2               TO  PC152-IDX.                07276018
072770     MOVE PC152-SML-LINE-LENGTH (PC152-IDX-2)                     07277018
072780                                    TO  PC133-DTL-LENGTH.         07278018
072790     MOVE PC152-SML-LBL-DATA-LINE (PC152-IDX)                     07279018
072800                                    TO  PC133-DTL-DATA.           07280018
072810                                                                  07281018
072820     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    07282018
072830         '' BY SPACES.                                           07283018
072840     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    07284018
072850         ';' BY SPACES.                                           07285018
072860     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    07286018
072870         LOW-VALUES BY SPACES.                                    07287018
072880                                                                  07288018
072890******************************************************************07289018
072900* LENGTH CALCULATION:                                            *07290018
072910*       LINE LENGTH SL  DATA     (PC152-SML-LINE-LENGTH)         *07291018
072920*       20  =  PC133-RECORD-TYPE (LD)  (2 POSITIONS)             *07292018
072930*              PC133-DTL-TRANS-ID      (8 POSITIONS)             *07293018
072940*              PC133-DTL-LENGTH        (3 POSITIONS)             *07294018
072950*              HEX 03-END EACH DTL REC (1 POSITIONS)             *07295018
072960*              FILLER                  (6 POSITIONS)             *07296018
072970******************************************************************07297018
072980     MOVE ZEROES                  TO PC133-DTL-REC-LENGTH.        07298018
072990     MOVE PC152-SML-LINE-LENGTH (PC152-IDX-2)                     07299018
073000                                  TO PC133-DTL-REC-LENGTH.        07300018
073010     ADD  20                      TO PC133-DTL-REC-LENGTH.        07301018
073020     MOVE PC133-DTL-REC-LENGTH    TO DP081-TCPLENG                07302018
073030                                     DP081-NBR-BYTES.             07303018
073040                                                                  07304018
073050     PERFORM 5100-SEND-DATA-TO-LPMS.                              07305018
073060                                                                  07306018
073070     ADD  1  TO  PV-TRAILER-COUNT.                                07307018
073080                                                                  07308018
073090*----------------------------------------------------------------*07309018
073100* SEND USERID LABEL DETAIL                                       *07310018
073110*----------------------------------------------------------------*07311018
073120 4520-USERID-DTL-LABEL.                                           07312018
073130                                                                  07313018
073140     STRING                                                       07314018
073150            ' 4520-USERID-DTL-LABEL'                              07315018
073160     DELIMITED BY SIZE                                            07316018
073170     INTO PV-CICS-MSG-AREA                                        07317018
073180     PERFORM 9990-WRITE-CICS                                      07318018
073190                                                                  07319018
073200     SET  PC133-LABEL-DTL           TO  TRUE.                     07320018
073210     MOVE PV-LPMS-TRANS-ID          TO  PC133-DTL-TRANS-ID.       07321018
073220     SET  PC156-IDX-2               TO  PC156-IDX.                07322018
073230     MOVE PC156-USR-LINE-LENGTH (PC156-IDX-2)                     07323018
073240                                    TO  PC133-DTL-LENGTH.         07324018
073250     MOVE PC156-USER-LBL-LINE (PC156-IDX)                         07325018
073260                                    TO  PC133-DTL-DATA.           07326018
073270                                                                  07327018
073280     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    07328018
073290         '' BY SPACES.                                           07329018
073300     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    07330018
073310         ';' BY SPACES.                                           07331018
073320     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    07332018
073330         LOW-VALUES BY SPACES.                                    07333018
073340                                                                  07334018
073350******************************************************************07335018
073360* LENGTH CALCULATION:                                            *07336018
073370*       LINE LENGTH SL  DATA     (PC156-USR-LINE-LENGTH)         *07337018
073380*       20  =  PC133-RECORD-TYPE (LD)  (2 POSITIONS)             *07338018
073390*              PC133-DTL-TRANS-ID      (8 POSITIONS)             *07339018
073400*              PC133-DTL-LENGTH        (3 POSITIONS)             *07340018
073410*              HEX 03-END EACH DTL REC (1 POSITIONS)             *07341018
073420*              FILLER                  (6 POSITIONS)             *07342018
073430******************************************************************07343018
073440     MOVE ZEROES                  TO PC133-DTL-REC-LENGTH.        07344018
073450     MOVE PC156-USR-LINE-LENGTH (PC156-IDX-2)                     07345018
073460                                  TO PC133-DTL-REC-LENGTH.        07346018
073470     ADD  20                      TO PC133-DTL-REC-LENGTH.        07347018
073480     MOVE PC133-DTL-REC-LENGTH    TO DP081-TCPLENG                07348018
073490                                     DP081-NBR-BYTES.             07349018
073500                                                                  07350018
073510     PERFORM 5100-SEND-DATA-TO-LPMS.                              07351018
073520                                                                  07352018
073530     ADD  1  TO  PV-TRAILER-COUNT.                                07353018
073540                                                                  07354018
073550*----------------------------------------------------------------*07355018
073560* SEND HEADER LABEL DETAIL                                       *07356018
073570*----------------------------------------------------------------*07357018
073580 4525-HEADER-DTL-LABEL.                                           07358018
073590     STRING                                                       07359018
073600            ' 4525-HEADER-DTL-LABEL'                              07360018
073610     DELIMITED BY SIZE                                            07361018
073620     INTO PV-CICS-MSG-AREA                                        07362018
073630     PERFORM 9990-WRITE-CICS                                      07363018
073640                                                                  07364018
073650     SET  PC133-LABEL-DTL           TO  TRUE.                     07365018
073660     MOVE PV-LPMS-TRANS-ID          TO  PC133-DTL-TRANS-ID.       07366018
073670     SET  PC154-IDX-2               TO  PC154-IDX.                07367018
073680     MOVE PC154-HDR-LINE-LENGTH (PC154-IDX-2)                     07368018
073690                                    TO  PC133-DTL-LENGTH.         07369018
073700     MOVE PC154-HEADER-LBL-LINE (PC154-IDX)                       07370018
073710                                    TO  PC133-DTL-DATA.           07371018
073720                                                                  07372018
073730     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    07373018
073740         '' BY SPACES.                                           07374018
073750     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    07375018
073760         ';' BY SPACES.                                           07376018
073770     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    07377018
073780         LOW-VALUES BY SPACES.                                    07378018
073790                                                                  07379018
073800******************************************************************07380018
073810* LENGTH CALCULATION:                                            *07381018
073820*       LINE LENGTH SL  DATA     (PC154-HDR-LINE-LENGTH)         *07382018
073830*       20  =  PC133-RECORD-TYPE (LD)  (2 POSITIONS)             *07383018
073840*              PC133-DTL-TRANS-ID      (8 POSITIONS)             *07384018
073850*              PC133-DTL-LENGTH        (3 POSITIONS)             *07385018
073860*              HEX 03-END EACH DTL REC (1 POSITIONS)             *07386018
073870*              FILLER                  (6 POSITIONS)             *07387018
073880******************************************************************07388018
073890     MOVE ZEROES                  TO PC133-DTL-REC-LENGTH.        07389018
073900     MOVE PC154-HDR-LINE-LENGTH (PC154-IDX-2)                     07390018
073910                                  TO PC133-DTL-REC-LENGTH.        07391018
073920     ADD  20                      TO PC133-DTL-REC-LENGTH.        07392018
073930     MOVE PC133-DTL-REC-LENGTH    TO DP081-TCPLENG                07393018
073940                                     DP081-NBR-BYTES.             07394018
073950                                                                  07395018
073960     PERFORM 5100-SEND-DATA-TO-LPMS.                              07396018
073970                                                                  07397018
073980     ADD  1  TO  PV-TRAILER-COUNT.                                07398018
073990                                                                  07399018
074000*----------------------------------------------------------------*07400018
074010* SEND CARTON LABEL DETAIL                                       *07401018
074020*----------------------------------------------------------------*07402018
074030 4530-CARTON-DTL-LABEL.                                           07403018
074040     STRING                                                       07404018
074050            ' 4530-CARTON-DTL-LABEL'                              07405018
074060     DELIMITED BY SIZE                                            07406018
074070     INTO PV-CICS-MSG-AREA                                        07407018
074080     PERFORM 9990-WRITE-CICS                                      07408018
074090                                                                  07409018
074100     SET  PC133-LABEL-DTL           TO  TRUE.                     07410018
074110     MOVE PV-LPMS-TRANS-ID          TO  PC133-DTL-TRANS-ID.       07411018
074120     SET  PC157-IDX-2               TO  PC157-IDX.                07412018
074130     MOVE PC157-CART-LINE-LENGTH (PC157-IDX-2)                    07413018
074140                                    TO  PC133-DTL-LENGTH.         07414018
074150     MOVE PC157-CARTON-LBL-LINE (PC157-IDX)                       07415018
074160                                    TO  PC133-DTL-DATA.           07416018
074170                                                                  07417018
074180     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    07418018
074190         '' BY SPACES.                                           07419018
074200     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    07420018
074210         ';' BY SPACES.                                           07421018
074220     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    07422018
074230         LOW-VALUES BY SPACES.                                    07423018
074240                                                                  07424018
074250******************************************************************07425018
074260* LENGTH CALCULATION:                                            *07426018
074270*       LINE LENGTH SL  DATA     (PC157-CART-LINE-LENGTH)        *07427018
074280*       20  =  PC133-RECORD-TYPE (LD)  (2 POSITIONS)             *07428018
074290*              PC133-DTL-TRANS-ID      (8 POSITIONS)             *07429018
074300*              PC133-DTL-LENGTH        (3 POSITIONS)             *07430018
074310*              HEX 03-END EACH DTL REC (1 POSITIONS)             *07431018
074320*              FILLER                  (6 POSITIONS)             *07432018
074330******************************************************************07433018
074340     MOVE ZEROES                  TO PC133-DTL-REC-LENGTH.        07434018
074350     MOVE PC157-CART-LINE-LENGTH (PC157-IDX-2)                    07435018
074360                                  TO PC133-DTL-REC-LENGTH.        07436018
074370     ADD  20                      TO PC133-DTL-REC-LENGTH.        07437018
074380     MOVE PC133-DTL-REC-LENGTH    TO DP081-TCPLENG                07438018
074390                                     DP081-NBR-BYTES.             07439018
074400                                                                  07440018
074410     PERFORM 5100-SEND-DATA-TO-LPMS.                              07441018
074420                                                                  07442018
074430     ADD  1  TO  PV-TRAILER-COUNT.                                07443018
074440                                                                  07444018
074450*----------------------------------------------------------------*07445018
074460* PERFORM THE RANGE LOOP THE NUMBER OF TIMES INDICATED IN THE SET*07446018
074470*----------------------------------------------------------------*07447018
074480 4532-SETS-LOOP.                                                  07448018
074490                                                                  07449018
074500     STRING                                                       07450018
074510            ' 4532-SETS-LOOP'                                     07451018
074520     DELIMITED BY SIZE                                            07452018
074530     INTO PV-CICS-MSG-AREA                                        07453018
074540     PERFORM 9990-WRITE-CICS                                      07454018
074550                                                                  07455018
074560     MOVE PC140-ML-TOT-LBLS         TO PV-SETS-SUB.               07456018
074570     MOVE PV-TOT-LABELS-IN-RANGE    TO PV-RANGE-SUB.              07457018
074580     PERFORM 4533-RANGE-LOOP    PV-SETS-SUB    TIMES.             07458018
074590                                                                  07459018
074600*----------------------------------------------------------------*07460018
074610* DETERMINE WHICH RANGE-VALUE TO INCREMENT BASED ON ITS POSITION *07461018
074620* SET THE BEGINNING RANGE VALUE TO THAT INDICATED BY USER        *07462018
074630*----------------------------------------------------------------*07463018
074640 4533-RANGE-LOOP.                                                 07464018
074650                                                                  07465018
074660     STRING                                                       07466018
074670            ' 4533-RANGE-LOOP'                                    07467018
074680     DELIMITED BY SIZE                                            07468018
074690     INTO PV-CICS-MSG-AREA                                        07469018
074700     PERFORM 9990-WRITE-CICS                                      07470018
074710                                                                  07471018
074720      EVALUATE PC140-ML-BEGIN-RANGE-POSN-HR                       07472018
074730          WHEN PC-01                                              07473018
074740              MOVE PC140-ML-BEGIN-RANGE-NBR TO                    07474018
074750                                     PV-HR-1-RANGE-VALUE          07475018
074760                                     PV-BC-1-RANGE-VALUE          07476018
074770              PERFORM 4534-ADJUST-RANGE-NBRS   PV-RANGE-SUB TIMES 07477018
074780          WHEN PC-02                                              07478018
074790              MOVE PC140-ML-BEGIN-RANGE-NBR TO                    07479018
074800                                     PV-HR-2-RANGE-VALUE          07480018
074810                                     PV-BC-2-RANGE-VALUE          07481018
074820              PERFORM 4534-ADJUST-RANGE-NBRS   PV-RANGE-SUB TIMES 07482018
074830          WHEN PC-03                                              07483018
074840              MOVE PC140-ML-BEGIN-RANGE-NBR TO                    07484018
074850                                     PV-HR-3-RANGE-VALUE          07485018
074860                                     PV-BC-3-RANGE-VALUE          07486018
074870              PERFORM 4534-ADJUST-RANGE-NBRS   PV-RANGE-SUB TIMES 07487018
074880          WHEN PC-04                                              07488018
074890              MOVE PC140-ML-BEGIN-RANGE-NBR TO                    07489018
074900                                     PV-HR-4-RANGE-VALUE          07490018
074910                                     PV-BC-4-RANGE-VALUE          07491018
074920              PERFORM 4534-ADJUST-RANGE-NBRS   PV-RANGE-SUB TIMES 07492018
074930          WHEN PC-05                                              07493018
074940              MOVE PC140-ML-BEGIN-RANGE-NBR TO                    07494018
074950                                     PV-HR-5-RANGE-VALUE          07495018
074960                                     PV-BC-5-RANGE-VALUE          07496018
074970              PERFORM 4534-ADJUST-RANGE-NBRS   PV-RANGE-SUB TIMES 07497018
074980          WHEN PC-06                                              07498018
074990              MOVE PC140-ML-BEGIN-RANGE-NBR TO                    07499018
075000                                     PV-HR-6-RANGE-VALUE          07500018
075010                                     PV-BC-6-RANGE-VALUE          07501018
075020              PERFORM 4534-ADJUST-RANGE-NBRS   PV-RANGE-SUB TIMES 07502018
075030          WHEN PC-07                                              07503018
075040              MOVE PC140-ML-BEGIN-RANGE-NBR TO                    07504018
075050                                     PV-HR-7-RANGE-VALUE          07505018
075060                                     PV-BC-7-RANGE-VALUE          07506018
075070              PERFORM 4534-ADJUST-RANGE-NBRS   PV-RANGE-SUB TIMES 07507018
075080          WHEN PC-08                                              07508018
075090              MOVE PC140-ML-BEGIN-RANGE-NBR TO                    07509018
075100                                     PV-HR-8-RANGE-VALUE          07510018
075110                                     PV-BC-8-RANGE-VALUE          07511018
075120              PERFORM 4534-ADJUST-RANGE-NBRS   PV-RANGE-SUB TIMES 07512018
075130          WHEN PC-09                                              07513018
075140              MOVE PC140-ML-BEGIN-RANGE-NBR TO                    07514018
075150                                     PV-HR-9-RANGE-VALUE          07515018
075160                                     PV-BC-9-RANGE-VALUE          07516018
075170              PERFORM 4534-ADJUST-RANGE-NBRS   PV-RANGE-SUB TIMES 07517018
075180*** LARGEST BAR CODE COULD BE (9 CHARS + 4 CHARS FOR RANGE)       07518018
075190          WHEN PC-10                                              07519018
075200              MOVE PC140-ML-BEGIN-RANGE-NBR TO                    07520018
075210                                     PV-HR-10-RANGE-VALUE         07521018
075220                                     PV-BC-9-RANGE-VALUE          07522018
075230              PERFORM 4534-ADJUST-RANGE-NBRS   PV-RANGE-SUB TIMES 07523018
075240          WHEN PC-11                                              07524018
075250              MOVE PC140-ML-BEGIN-RANGE-NBR TO                    07525018
075260                                     PV-HR-11-RANGE-VALUE         07526018
075270                                     PV-BC-9-RANGE-VALUE          07527018
075280              PERFORM 4534-ADJUST-RANGE-NBRS   PV-RANGE-SUB TIMES 07528018
075290          WHEN PC-12                                              07529018
075300              MOVE PC140-ML-BEGIN-RANGE-NBR TO                    07530018
075310                                     PV-HR-12-RANGE-VALUE         07531018
075320                                     PV-BC-9-RANGE-VALUE          07532018
075330              PERFORM 4534-ADJUST-RANGE-NBRS   PV-RANGE-SUB TIMES 07533018
075340          WHEN PC-13                                              07534018
075350              MOVE PC140-ML-BEGIN-RANGE-NBR TO                    07535018
075360                                     PV-HR-13-RANGE-VALUE         07536018
075370                                     PV-BC-9-RANGE-VALUE          07537018
075380              PERFORM 4534-ADJUST-RANGE-NBRS   PV-RANGE-SUB TIMES 07538018
075390          WHEN PC-14                                              07539018
075400              MOVE PC140-ML-BEGIN-RANGE-NBR TO                    07540018
075410                                     PV-HR-14-RANGE-VALUE         07541018
075420                                     PV-BC-9-RANGE-VALUE          07542018
075430              PERFORM 4534-ADJUST-RANGE-NBRS   PV-RANGE-SUB TIMES 07543018
075440          WHEN PC-15                                              07544018
075450              MOVE PC140-ML-BEGIN-RANGE-NBR TO                    07545018
075460                                     PV-HR-15-RANGE-VALUE         07546018
075470                                     PV-BC-9-RANGE-VALUE          07547018
075480              PERFORM 4534-ADJUST-RANGE-NBRS   PV-RANGE-SUB TIMES 07548018
075490          WHEN PC-16                                              07549018
075500              MOVE PC140-ML-BEGIN-RANGE-NBR TO                    07550018
075510                                     PV-HR-16-RANGE-VALUE         07551018
075520                                     PV-BC-9-RANGE-VALUE          07552018
075530              PERFORM 4534-ADJUST-RANGE-NBRS   PV-RANGE-SUB TIMES 07553018
075540          WHEN PC-17                                              07554018
075550              MOVE PC140-ML-BEGIN-RANGE-NBR TO                    07555018
075560                                     PV-HR-17-RANGE-VALUE         07556018
075570                                     PV-BC-9-RANGE-VALUE          07557018
075580              PERFORM 4534-ADJUST-RANGE-NBRS   PV-RANGE-SUB TIMES 07558018
075590      END-EVALUATE.                                               07559018
075600                                                                  07560018
075610*----------------------------------------------------------------*07561018
075620* INCREMENT THE VARIABLE RANGE OF BOTH HR AND BARCODE PORTION    *07562018
075630* OF TEXT. SEND THE "DATA" PART OF THE LABEL TO THE SOCKET.      *07563018
075640*----------------------------------------------------------------*07564018
075650 4534-ADJUST-RANGE-NBRS.                                          07565018
075660                                                                  07566018
075670     STRING                                                       07567018
075680            ' 4534-ADJUST-RANGE-NBRS'                             07568018
075690     DELIMITED BY SIZE                                            07569018
075700     INTO PV-CICS-MSG-AREA                                        07570018
075710     PERFORM 9990-WRITE-CICS                                      07571018
075720                                                                  07572018
075730      EVALUATE PC140-ML-BEGIN-RANGE-POSN-HR                       07573018
075740          WHEN PC-01                                              07574018
075750               MOVE PV-ML-HR-1     TO PC165-3OF9-BC-NBR           07575018
075760                                      PC191-3OF9-BC-NBR           07576018
075770               EVALUATE PC140-ML-BEGIN-RANGE-POSN-BC              07577018
075780                   WHEN PC-01                                     07578018
075790                        MOVE PV-ML-BC-1   TO PC165-3OF9-BC        07579018
075800                        IF PV-BC-1-RANGE-VALUE =                  07580018
075810                           PC140-ML-END-RANGE-NBR                 07581018
075820                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       07582018
075830                                        PV-BC-1-RANGE-VALUE       07583018
075840                        ELSE                                      07584018
075850                           ADD 1          TO PV-BC-1-RANGE-VALUE  07585018
075860                        END-IF                                    07586018
075870                   WHEN PC-02                                     07587018
075880                        MOVE PV-ML-BC-2   TO PC165-3OF9-BC        07588018
075890                        IF PV-BC-2-RANGE-VALUE =                  07589018
075900                           PC140-ML-END-RANGE-NBR                 07590018
075910                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       07591018
075920                                        PV-BC-2-RANGE-VALUE       07592018
075930                        ELSE                                      07593018
075940                           ADD 1          TO PV-BC-2-RANGE-VALUE  07594018
075950                        END-IF                                    07595018
075960                   WHEN PC-03                                     07596018
075970                        MOVE PV-ML-BC-3   TO PC165-3OF9-BC        07597018
075980                        IF PV-BC-3-RANGE-VALUE =                  07598018
075990                           PC140-ML-END-RANGE-NBR                 07599018
076000                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       07600018
076010                                        PV-BC-3-RANGE-VALUE       07601018
076020                        ELSE                                      07602018
076030                           ADD 1          TO PV-BC-3-RANGE-VALUE  07603018
076040                        END-IF                                    07604018
076050                   WHEN PC-04                                     07605018
076060                        MOVE PV-ML-BC-4   TO PC165-3OF9-BC        07606018
076070                        IF PV-BC-4-RANGE-VALUE =                  07607018
076080                           PC140-ML-END-RANGE-NBR                 07608018
076090                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       07609018
076100                                        PV-BC-4-RANGE-VALUE       07610018
076110                        ELSE                                      07611018
076120                           ADD 1          TO PV-BC-4-RANGE-VALUE  07612018
076130                        END-IF                                    07613018
076140                   WHEN PC-05                                     07614018
076150                        MOVE PV-ML-BC-5   TO PC165-3OF9-BC        07615018
076160                        IF PV-BC-5-RANGE-VALUE =                  07616018
076170                           PC140-ML-END-RANGE-NBR                 07617018
076180                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       07618018
076190                                        PV-BC-5-RANGE-VALUE       07619018
076200                        ELSE                                      07620018
076210                           ADD 1          TO PV-BC-5-RANGE-VALUE  07621018
076220                        END-IF                                    07622018
076230                   WHEN PC-06                                     07623018
076240                        MOVE PV-ML-BC-6   TO PC165-3OF9-BC        07624018
076250                        IF PV-BC-6-RANGE-VALUE =                  07625018
076260                           PC140-ML-END-RANGE-NBR                 07626018
076270                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       07627018
076280                                        PV-BC-6-RANGE-VALUE       07628018
076290                        ELSE                                      07629018
076300                           ADD 1          TO PV-BC-6-RANGE-VALUE  07630018
076310                        END-IF                                    07631018
076320                   WHEN PC-07                                     07632018
076330                        MOVE PV-ML-BC-7   TO PC165-3OF9-BC        07633018
076340                        IF PV-BC-7-RANGE-VALUE =                  07634018
076350                           PC140-ML-END-RANGE-NBR                 07635018
076360                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       07636018
076370                                        PV-BC-7-RANGE-VALUE       07637018
076380                        ELSE                                      07638018
076390                           ADD 1          TO PV-BC-7-RANGE-VALUE  07639018
076400                        END-IF                                    07640018
076410                   WHEN PC-08                                     07641018
076420                        MOVE PV-ML-BC-8   TO PC165-3OF9-BC        07642018
076430                        IF PV-BC-8-RANGE-VALUE =                  07643018
076440                           PC140-ML-END-RANGE-NBR                 07644018
076450                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       07645018
076460                                        PV-BC-8-RANGE-VALUE       07646018
076470                        ELSE                                      07647018
076480                           ADD 1          TO PV-BC-8-RANGE-VALUE  07648018
076490                        END-IF                                    07649018
076500                   WHEN PC-09                                     07650018
076510                        MOVE PV-ML-BC-9   TO PC165-3OF9-BC        07651018
076520                        IF PV-BC-9-RANGE-VALUE =                  07652018
076530                           PC140-ML-END-RANGE-NBR                 07653018
076540                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       07654018
076550                                        PV-BC-9-RANGE-VALUE       07655018
076560                        ELSE                                      07656018
076570                           ADD 1          TO PV-BC-9-RANGE-VALUE  07657018
076580                        END-IF                                    07658018
076590               END-EVALUATE                                       07659018
076600               IF PC140-COMMON-MISC-LBL-NBR                       07660018
076610                 PERFORM 4535-MISC-DTL-LABEL                      07661018
076620                    VARYING PC165-IDX FROM 1 BY 1                 07662018
076630                      UNTIL PC165-IDX                             07663018
076640                            > PC165-MAX-LABEL-LINES               07664018
076650                                  OR PS-SOCKET-ERROR              07665018
076660               ELSE                                               07666018
076670                 PERFORM 4537-MISC-DTL-LABEL-MSG                  07667018
076680                    VARYING PC191-IDX FROM 1 BY 1                 07668018
076690                      UNTIL PC191-IDX                             07669018
076700                            > PC191-MAX-LABEL-LINES               07670018
076710                                  OR PS-SOCKET-ERROR              07671018
076720               END-IF                                             07672018
076730               ADD 1 TO PV-HR-1-RANGE-VALUE                       07673018
076740          WHEN PC-02                                              07674018
076750               MOVE PV-ML-HR-2     TO PC165-3OF9-BC-NBR           07675018
076760                                      PC191-3OF9-BC-NBR           07676018
076770               EVALUATE PC140-ML-BEGIN-RANGE-POSN-BC              07677018
076780                   WHEN PC-01                                     07678018
076790                        MOVE PV-ML-BC-1   TO PC165-3OF9-BC        07679018
076800                        IF PV-BC-1-RANGE-VALUE =                  07680018
076810                           PC140-ML-END-RANGE-NBR                 07681018
076820                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       07682018
076830                                        PV-BC-1-RANGE-VALUE       07683018
076840                        ELSE                                      07684018
076850                           ADD 1          TO PV-BC-1-RANGE-VALUE  07685018
076860                        END-IF                                    07686018
076870                   WHEN PC-02                                     07687018
076880                        MOVE PV-ML-BC-2   TO PC165-3OF9-BC        07688018
076890                        IF PV-BC-2-RANGE-VALUE =                  07689018
076900                           PC140-ML-END-RANGE-NBR                 07690018
076910                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       07691018
076920                                        PV-BC-2-RANGE-VALUE       07692018
076930                        ELSE                                      07693018
076940                           ADD 1          TO PV-BC-2-RANGE-VALUE  07694018
076950                        END-IF                                    07695018
076960                   WHEN PC-03                                     07696018
076970                        MOVE PV-ML-BC-3   TO PC165-3OF9-BC        07697018
076980                        IF PV-BC-3-RANGE-VALUE =                  07698018
076990                           PC140-ML-END-RANGE-NBR                 07699018
077000                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       07700018
077010                                        PV-BC-3-RANGE-VALUE       07701018
077020                        ELSE                                      07702018
077030                           ADD 1          TO PV-BC-3-RANGE-VALUE  07703018
077040                        END-IF                                    07704018
077050                   WHEN PC-04                                     07705018
077060                        MOVE PV-ML-BC-4   TO PC165-3OF9-BC        07706018
077070                        IF PV-BC-4-RANGE-VALUE =                  07707018
077080                           PC140-ML-END-RANGE-NBR                 07708018
077090                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       07709018
077100                                        PV-BC-4-RANGE-VALUE       07710018
077110                        ELSE                                      07711018
077120                           ADD 1          TO PV-BC-4-RANGE-VALUE  07712018
077130                        END-IF                                    07713018
077140                   WHEN PC-05                                     07714018
077150                        MOVE PV-ML-BC-5   TO PC165-3OF9-BC        07715018
077160                        IF PV-BC-5-RANGE-VALUE =                  07716018
077170                           PC140-ML-END-RANGE-NBR                 07717018
077180                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       07718018
077190                                        PV-BC-5-RANGE-VALUE       07719018
077200                        ELSE                                      07720018
077210                           ADD 1          TO PV-BC-5-RANGE-VALUE  07721018
077220                        END-IF                                    07722018
077230                   WHEN PC-06                                     07723018
077240                        MOVE PV-ML-BC-6   TO PC165-3OF9-BC        07724018
077250                        IF PV-BC-6-RANGE-VALUE =                  07725018
077260                           PC140-ML-END-RANGE-NBR                 07726018
077270                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       07727018
077280                                        PV-BC-6-RANGE-VALUE       07728018
077290                        ELSE                                      07729018
077300                           ADD 1          TO PV-BC-6-RANGE-VALUE  07730018
077310                        END-IF                                    07731018
077320                   WHEN PC-07                                     07732018
077330                        MOVE PV-ML-BC-7   TO PC165-3OF9-BC        07733018
077340                        IF PV-BC-7-RANGE-VALUE =                  07734018
077350                           PC140-ML-END-RANGE-NBR                 07735018
077360                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       07736018
077370                                        PV-BC-7-RANGE-VALUE       07737018
077380                        ELSE                                      07738018
077390                           ADD 1          TO PV-BC-7-RANGE-VALUE  07739018
077400                        END-IF                                    07740018
077410                   WHEN PC-08                                     07741018
077420                        MOVE PV-ML-BC-8   TO PC165-3OF9-BC        07742018
077430                        IF PV-BC-8-RANGE-VALUE =                  07743018
077440                           PC140-ML-END-RANGE-NBR                 07744018
077450                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       07745018
077460                                        PV-BC-8-RANGE-VALUE       07746018
077470                        ELSE                                      07747018
077480                           ADD 1          TO PV-BC-8-RANGE-VALUE  07748018
077490                        END-IF                                    07749018
077500                   WHEN PC-09                                     07750018
077510                        MOVE PV-ML-BC-9   TO PC165-3OF9-BC        07751018
077520                        IF PV-BC-9-RANGE-VALUE =                  07752018
077530                           PC140-ML-END-RANGE-NBR                 07753018
077540                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       07754018
077550                                        PV-BC-9-RANGE-VALUE       07755018
077560                        ELSE                                      07756018
077570                           ADD 1          TO PV-BC-9-RANGE-VALUE  07757018
077580                        END-IF                                    07758018
077590               END-EVALUATE                                       07759018
077600               IF PC140-COMMON-MISC-LBL-NBR                       07760018
077610                 PERFORM 4535-MISC-DTL-LABEL                      07761018
077620                    VARYING PC165-IDX FROM 1 BY 1                 07762018
077630                      UNTIL PC165-IDX                             07763018
077640                            > PC165-MAX-LABEL-LINES               07764018
077650                                  OR PS-SOCKET-ERROR              07765018
077660               ELSE                                               07766018
077670                 PERFORM 4537-MISC-DTL-LABEL-MSG                  07767018
077680                    VARYING PC191-IDX FROM 1 BY 1                 07768018
077690                      UNTIL PC191-IDX                             07769018
077700                            > PC191-MAX-LABEL-LINES               07770018
077710                                  OR PS-SOCKET-ERROR              07771018
077720               END-IF                                             07772018
077730               ADD 1 TO PV-HR-2-RANGE-VALUE                       07773018
077740          WHEN PC-03                                              07774018
077750               MOVE PV-ML-HR-3     TO PC165-3OF9-BC-NBR           07775018
077760                                      PC191-3OF9-BC-NBR           07776018
077770               EVALUATE PC140-ML-BEGIN-RANGE-POSN-BC              07777018
077780                   WHEN PC-01                                     07778018
077790                        MOVE PV-ML-BC-1   TO PC165-3OF9-BC        07779018
077800                        IF PV-BC-1-RANGE-VALUE =                  07780018
077810                           PC140-ML-END-RANGE-NBR                 07781018
077820                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       07782018
077830                                        PV-BC-1-RANGE-VALUE       07783018
077840                        ELSE                                      07784018
077850                           ADD 1          TO PV-BC-1-RANGE-VALUE  07785018
077860                        END-IF                                    07786018
077870                   WHEN PC-02                                     07787018
077880                        MOVE PV-ML-BC-2   TO PC165-3OF9-BC        07788018
077890                        IF PV-BC-2-RANGE-VALUE =                  07789018
077900                           PC140-ML-END-RANGE-NBR                 07790018
077910                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       07791018
077920                                        PV-BC-2-RANGE-VALUE       07792018
077930                        ELSE                                      07793018
077940                           ADD 1          TO PV-BC-2-RANGE-VALUE  07794018
077950                        END-IF                                    07795018
077960                   WHEN PC-03                                     07796018
077970                        MOVE PV-ML-BC-3   TO PC165-3OF9-BC        07797018
077980                        IF PV-BC-3-RANGE-VALUE =                  07798018
077990                           PC140-ML-END-RANGE-NBR                 07799018
078000                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       07800018
078010                                        PV-BC-3-RANGE-VALUE       07801018
078020                        ELSE                                      07802018
078030                           ADD 1          TO PV-BC-3-RANGE-VALUE  07803018
078040                        END-IF                                    07804018
078050                   WHEN PC-04                                     07805018
078060                        MOVE PV-ML-BC-4   TO PC165-3OF9-BC        07806018
078070                        IF PV-BC-4-RANGE-VALUE =                  07807018
078080                           PC140-ML-END-RANGE-NBR                 07808018
078090                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       07809018
078100                                        PV-BC-4-RANGE-VALUE       07810018
078110                        ELSE                                      07811018
078120                           ADD 1          TO PV-BC-4-RANGE-VALUE  07812018
078130                        END-IF                                    07813018
078140                   WHEN PC-05                                     07814018
078150                        MOVE PV-ML-BC-5   TO PC165-3OF9-BC        07815018
078160                        IF PV-BC-5-RANGE-VALUE =                  07816018
078170                           PC140-ML-END-RANGE-NBR                 07817018
078180                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       07818018
078190                                        PV-BC-5-RANGE-VALUE       07819018
078200                        ELSE                                      07820018
078210                           ADD 1          TO PV-BC-5-RANGE-VALUE  07821018
078220                        END-IF                                    07822018
078230                   WHEN PC-06                                     07823018
078240                        MOVE PV-ML-BC-6   TO PC165-3OF9-BC        07824018
078250                        IF PV-BC-6-RANGE-VALUE =                  07825018
078260                           PC140-ML-END-RANGE-NBR                 07826018
078270                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       07827018
078280                                        PV-BC-6-RANGE-VALUE       07828018
078290                        ELSE                                      07829018
078300                           ADD 1          TO PV-BC-6-RANGE-VALUE  07830018
078310                        END-IF                                    07831018
078320                   WHEN PC-07                                     07832018
078330                        MOVE PV-ML-BC-7   TO PC165-3OF9-BC        07833018
078340                        IF PV-BC-7-RANGE-VALUE =                  07834018
078350                           PC140-ML-END-RANGE-NBR                 07835018
078360                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       07836018
078370                                        PV-BC-7-RANGE-VALUE       07837018
078380                        ELSE                                      07838018
078390                           ADD 1          TO PV-BC-7-RANGE-VALUE  07839018
078400                        END-IF                                    07840018
078410                   WHEN PC-08                                     07841018
078420                        MOVE PV-ML-BC-8   TO PC165-3OF9-BC        07842018
078430                        IF PV-BC-8-RANGE-VALUE =                  07843018
078440                           PC140-ML-END-RANGE-NBR                 07844018
078450                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       07845018
078460                                        PV-BC-8-RANGE-VALUE       07846018
078470                        ELSE                                      07847018
078480                           ADD 1          TO PV-BC-8-RANGE-VALUE  07848018
078490                        END-IF                                    07849018
078500                   WHEN PC-09                                     07850018
078510                        MOVE PV-ML-BC-9   TO PC165-3OF9-BC        07851018
078520                        IF PV-BC-9-RANGE-VALUE =                  07852018
078530                           PC140-ML-END-RANGE-NBR                 07853018
078540                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       07854018
078550                                        PV-BC-9-RANGE-VALUE       07855018
078560                        ELSE                                      07856018
078570                           ADD 1          TO PV-BC-9-RANGE-VALUE  07857018
078580                        END-IF                                    07858018
078590               END-EVALUATE                                       07859018
078600               IF PC140-COMMON-MISC-LBL-NBR                       07860018
078610                 PERFORM 4535-MISC-DTL-LABEL                      07861018
078620                    VARYING PC165-IDX FROM 1 BY 1                 07862018
078630                      UNTIL PC165-IDX                             07863018
078640                            > PC165-MAX-LABEL-LINES               07864018
078650                                  OR PS-SOCKET-ERROR              07865018
078660               ELSE                                               07866018
078670                 PERFORM 4537-MISC-DTL-LABEL-MSG                  07867018
078680                    VARYING PC191-IDX FROM 1 BY 1                 07868018
078690                      UNTIL PC191-IDX                             07869018
078700                            > PC191-MAX-LABEL-LINES               07870018
078710                                  OR PS-SOCKET-ERROR              07871018
078720               END-IF                                             07872018
078730               ADD 1 TO PV-HR-3-RANGE-VALUE                       07873018
078740          WHEN PC-04                                              07874018
078750               MOVE PV-ML-HR-4     TO PC165-3OF9-BC-NBR           07875018
078760                                      PC191-3OF9-BC-NBR           07876018
078770               EVALUATE PC140-ML-BEGIN-RANGE-POSN-BC              07877018
078780                   WHEN PC-01                                     07878018
078790                        MOVE PV-ML-BC-1   TO PC165-3OF9-BC        07879018
078800                        IF PV-BC-1-RANGE-VALUE =                  07880018
078810                           PC140-ML-END-RANGE-NBR                 07881018
078820                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       07882018
078830                                        PV-BC-1-RANGE-VALUE       07883018
078840                        ELSE                                      07884018
078850                           ADD 1          TO PV-BC-1-RANGE-VALUE  07885018
078860                        END-IF                                    07886018
078870                   WHEN PC-02                                     07887018
078880                        MOVE PV-ML-BC-2   TO PC165-3OF9-BC        07888018
078890                        IF PV-BC-2-RANGE-VALUE =                  07889018
078900                           PC140-ML-END-RANGE-NBR                 07890018
078910                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       07891018
078920                                        PV-BC-2-RANGE-VALUE       07892018
078930                        ELSE                                      07893018
078940                           ADD 1          TO PV-BC-2-RANGE-VALUE  07894018
078950                        END-IF                                    07895018
078960                   WHEN PC-03                                     07896018
078970                        MOVE PV-ML-BC-3   TO PC165-3OF9-BC        07897018
078980                        IF PV-BC-3-RANGE-VALUE =                  07898018
078990                           PC140-ML-END-RANGE-NBR                 07899018
079000                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       07900018
079010                                        PV-BC-3-RANGE-VALUE       07901018
079020                        ELSE                                      07902018
079030                           ADD 1          TO PV-BC-3-RANGE-VALUE  07903018
079040                        END-IF                                    07904018
079050                   WHEN PC-04                                     07905018
079060                        MOVE PV-ML-BC-4   TO PC165-3OF9-BC        07906018
079070                        IF PV-BC-4-RANGE-VALUE =                  07907018
079080                           PC140-ML-END-RANGE-NBR                 07908018
079090                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       07909018
079100                                        PV-BC-4-RANGE-VALUE       07910018
079110                        ELSE                                      07911018
079120                           ADD 1          TO PV-BC-4-RANGE-VALUE  07912018
079130                        END-IF                                    07913018
079140                   WHEN PC-05                                     07914018
079150                        MOVE PV-ML-BC-5   TO PC165-3OF9-BC        07915018
079160                        IF PV-BC-5-RANGE-VALUE =                  07916018
079170                           PC140-ML-END-RANGE-NBR                 07917018
079180                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       07918018
079190                                        PV-BC-5-RANGE-VALUE       07919018
079200                        ELSE                                      07920018
079210                           ADD 1          TO PV-BC-5-RANGE-VALUE  07921018
079220                        END-IF                                    07922018
079230                   WHEN PC-06                                     07923018
079240                        MOVE PV-ML-BC-6   TO PC165-3OF9-BC        07924018
079250                        IF PV-BC-6-RANGE-VALUE =                  07925018
079260                           PC140-ML-END-RANGE-NBR                 07926018
079270                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       07927018
079280                                        PV-BC-6-RANGE-VALUE       07928018
079290                        ELSE                                      07929018
079300                           ADD 1          TO PV-BC-6-RANGE-VALUE  07930018
079310                        END-IF                                    07931018
079320                   WHEN PC-07                                     07932018
079330                        MOVE PV-ML-BC-7   TO PC165-3OF9-BC        07933018
079340                        IF PV-BC-7-RANGE-VALUE =                  07934018
079350                           PC140-ML-END-RANGE-NBR                 07935018
079360                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       07936018
079370                                        PV-BC-7-RANGE-VALUE       07937018
079380                        ELSE                                      07938018
079390                           ADD 1          TO PV-BC-7-RANGE-VALUE  07939018
079400                        END-IF                                    07940018
079410                   WHEN PC-08                                     07941018
079420                        MOVE PV-ML-BC-8   TO PC165-3OF9-BC        07942018
079430                        IF PV-BC-8-RANGE-VALUE =                  07943018
079440                           PC140-ML-END-RANGE-NBR                 07944018
079450                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       07945018
079460                                        PV-BC-8-RANGE-VALUE       07946018
079470                        ELSE                                      07947018
079480                           ADD 1          TO PV-BC-8-RANGE-VALUE  07948018
079490                        END-IF                                    07949018
079500                   WHEN PC-09                                     07950018
079510                        MOVE PV-ML-BC-9   TO PC165-3OF9-BC        07951018
079520                        IF PV-BC-9-RANGE-VALUE =                  07952018
079530                           PC140-ML-END-RANGE-NBR                 07953018
079540                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       07954018
079550                                        PV-BC-9-RANGE-VALUE       07955018
079560                        ELSE                                      07956018
079570                           ADD 1          TO PV-BC-9-RANGE-VALUE  07957018
079580                        END-IF                                    07958018
079590               END-EVALUATE                                       07959018
079600               IF PC140-COMMON-MISC-LBL-NBR                       07960018
079610                 PERFORM 4535-MISC-DTL-LABEL                      07961018
079620                    VARYING PC165-IDX FROM 1 BY 1                 07962018
079630                      UNTIL PC165-IDX                             07963018
079640                            > PC165-MAX-LABEL-LINES               07964018
079650                                  OR PS-SOCKET-ERROR              07965018
079660               ELSE                                               07966018
079670                 PERFORM 4537-MISC-DTL-LABEL-MSG                  07967018
079680                    VARYING PC191-IDX FROM 1 BY 1                 07968018
079690                      UNTIL PC191-IDX                             07969018
079700                            > PC191-MAX-LABEL-LINES               07970018
079710                                  OR PS-SOCKET-ERROR              07971018
079720               END-IF                                             07972018
079730               ADD 1 TO PV-HR-4-RANGE-VALUE                       07973018
079740          WHEN PC-05                                              07974018
079750               MOVE PV-ML-HR-5     TO PC165-3OF9-BC-NBR           07975018
079760                                      PC191-3OF9-BC-NBR           07976018
079770               EVALUATE PC140-ML-BEGIN-RANGE-POSN-BC              07977018
079780                   WHEN PC-01                                     07978018
079790                        MOVE PV-ML-BC-1   TO PC165-3OF9-BC        07979018
079800                        IF PV-BC-1-RANGE-VALUE =                  07980018
079810                           PC140-ML-END-RANGE-NBR                 07981018
079820                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       07982018
079830                                        PV-BC-1-RANGE-VALUE       07983018
079840                        ELSE                                      07984018
079850                           ADD 1          TO PV-BC-1-RANGE-VALUE  07985018
079860                        END-IF                                    07986018
079870                   WHEN PC-02                                     07987018
079880                        MOVE PV-ML-BC-2   TO PC165-3OF9-BC        07988018
079890                        IF PV-BC-2-RANGE-VALUE =                  07989018
079900                           PC140-ML-END-RANGE-NBR                 07990018
079910                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       07991018
079920                                        PV-BC-2-RANGE-VALUE       07992018
079930                        ELSE                                      07993018
079940                           ADD 1          TO PV-BC-2-RANGE-VALUE  07994018
079950                        END-IF                                    07995018
079960                   WHEN PC-03                                     07996018
079970                        MOVE PV-ML-BC-3   TO PC165-3OF9-BC        07997018
079980                        IF PV-BC-3-RANGE-VALUE =                  07998018
079990                           PC140-ML-END-RANGE-NBR                 07999018
080000                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08000018
080010                                        PV-BC-3-RANGE-VALUE       08001018
080020                        ELSE                                      08002018
080030                           ADD 1          TO PV-BC-3-RANGE-VALUE  08003018
080040                        END-IF                                    08004018
080050                   WHEN PC-04                                     08005018
080060                        MOVE PV-ML-BC-4   TO PC165-3OF9-BC        08006018
080070                        IF PV-BC-4-RANGE-VALUE =                  08007018
080080                           PC140-ML-END-RANGE-NBR                 08008018
080090                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08009018
080100                                        PV-BC-4-RANGE-VALUE       08010018
080110                        ELSE                                      08011018
080120                           ADD 1          TO PV-BC-4-RANGE-VALUE  08012018
080130                        END-IF                                    08013018
080140                   WHEN PC-05                                     08014018
080150                        MOVE PV-ML-BC-5   TO PC165-3OF9-BC        08015018
080160                        IF PV-BC-5-RANGE-VALUE =                  08016018
080170                           PC140-ML-END-RANGE-NBR                 08017018
080180                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08018018
080190                                        PV-BC-5-RANGE-VALUE       08019018
080200                        ELSE                                      08020018
080210                           ADD 1          TO PV-BC-5-RANGE-VALUE  08021018
080220                        END-IF                                    08022018
080230                   WHEN PC-06                                     08023018
080240                        MOVE PV-ML-BC-6   TO PC165-3OF9-BC        08024018
080250                        IF PV-BC-6-RANGE-VALUE =                  08025018
080260                           PC140-ML-END-RANGE-NBR                 08026018
080270                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08027018
080280                                        PV-BC-6-RANGE-VALUE       08028018
080290                        ELSE                                      08029018
080300                           ADD 1          TO PV-BC-6-RANGE-VALUE  08030018
080310                        END-IF                                    08031018
080320                   WHEN PC-07                                     08032018
080330                        MOVE PV-ML-BC-7   TO PC165-3OF9-BC        08033018
080340                        IF PV-BC-7-RANGE-VALUE =                  08034018
080350                           PC140-ML-END-RANGE-NBR                 08035018
080360                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08036018
080370                                        PV-BC-7-RANGE-VALUE       08037018
080380                        ELSE                                      08038018
080390                           ADD 1          TO PV-BC-7-RANGE-VALUE  08039018
080400                        END-IF                                    08040018
080410                   WHEN PC-08                                     08041018
080420                        MOVE PV-ML-BC-8   TO PC165-3OF9-BC        08042018
080430                        IF PV-BC-8-RANGE-VALUE =                  08043018
080440                           PC140-ML-END-RANGE-NBR                 08044018
080450                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08045018
080460                                        PV-BC-8-RANGE-VALUE       08046018
080470                        ELSE                                      08047018
080480                           ADD 1          TO PV-BC-8-RANGE-VALUE  08048018
080490                        END-IF                                    08049018
080500                   WHEN PC-09                                     08050018
080510                        MOVE PV-ML-BC-9   TO PC165-3OF9-BC        08051018
080520                        IF PV-BC-9-RANGE-VALUE =                  08052018
080530                           PC140-ML-END-RANGE-NBR                 08053018
080540                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08054018
080550                                        PV-BC-9-RANGE-VALUE       08055018
080560                        ELSE                                      08056018
080570                           ADD 1          TO PV-BC-9-RANGE-VALUE  08057018
080580                        END-IF                                    08058018
080590               END-EVALUATE                                       08059018
080600               IF PC140-COMMON-MISC-LBL-NBR                       08060018
080610                 PERFORM 4535-MISC-DTL-LABEL                      08061018
080620                    VARYING PC165-IDX FROM 1 BY 1                 08062018
080630                      UNTIL PC165-IDX                             08063018
080640                            > PC165-MAX-LABEL-LINES               08064018
080650                                  OR PS-SOCKET-ERROR              08065018
080660               ELSE                                               08066018
080670                 PERFORM 4537-MISC-DTL-LABEL-MSG                  08067018
080680                    VARYING PC191-IDX FROM 1 BY 1                 08068018
080690                      UNTIL PC191-IDX                             08069018
080700                            > PC191-MAX-LABEL-LINES               08070018
080710                                  OR PS-SOCKET-ERROR              08071018
080720               END-IF                                             08072018
080730               ADD 1 TO PV-HR-5-RANGE-VALUE                       08073018
080740          WHEN PC-06                                              08074018
080750               MOVE PV-ML-HR-6     TO PC165-3OF9-BC-NBR           08075018
080760                                      PC191-3OF9-BC-NBR           08076018
080770               EVALUATE PC140-ML-BEGIN-RANGE-POSN-BC              08077018
080780                   WHEN PC-01                                     08078018
080790                        MOVE PV-ML-BC-1   TO PC165-3OF9-BC        08079018
080800                        IF PV-BC-1-RANGE-VALUE =                  08080018
080810                           PC140-ML-END-RANGE-NBR                 08081018
080820                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08082018
080830                                        PV-BC-1-RANGE-VALUE       08083018
080840                        ELSE                                      08084018
080850                           ADD 1          TO PV-BC-1-RANGE-VALUE  08085018
080860                        END-IF                                    08086018
080870                   WHEN PC-02                                     08087018
080880                        MOVE PV-ML-BC-2   TO PC165-3OF9-BC        08088018
080890                        IF PV-BC-2-RANGE-VALUE =                  08089018
080900                           PC140-ML-END-RANGE-NBR                 08090018
080910                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08091018
080920                                        PV-BC-2-RANGE-VALUE       08092018
080930                        ELSE                                      08093018
080940                           ADD 1          TO PV-BC-2-RANGE-VALUE  08094018
080950                        END-IF                                    08095018
080960                   WHEN PC-03                                     08096018
080970                        MOVE PV-ML-BC-3   TO PC165-3OF9-BC        08097018
080980                        IF PV-BC-3-RANGE-VALUE =                  08098018
080990                           PC140-ML-END-RANGE-NBR                 08099018
081000                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08100018
081010                                        PV-BC-3-RANGE-VALUE       08101018
081020                        ELSE                                      08102018
081030                           ADD 1          TO PV-BC-3-RANGE-VALUE  08103018
081040                        END-IF                                    08104018
081050                   WHEN PC-04                                     08105018
081060                        MOVE PV-ML-BC-4   TO PC165-3OF9-BC        08106018
081070                        IF PV-BC-4-RANGE-VALUE =                  08107018
081080                           PC140-ML-END-RANGE-NBR                 08108018
081090                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08109018
081100                                        PV-BC-4-RANGE-VALUE       08110018
081110                        ELSE                                      08111018
081120                           ADD 1          TO PV-BC-4-RANGE-VALUE  08112018
081130                        END-IF                                    08113018
081140                   WHEN PC-05                                     08114018
081150                        MOVE PV-ML-BC-5   TO PC165-3OF9-BC        08115018
081160                        IF PV-BC-5-RANGE-VALUE =                  08116018
081170                           PC140-ML-END-RANGE-NBR                 08117018
081180                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08118018
081190                                        PV-BC-5-RANGE-VALUE       08119018
081200                        ELSE                                      08120018
081210                           ADD 1          TO PV-BC-5-RANGE-VALUE  08121018
081220                        END-IF                                    08122018
081230                   WHEN PC-06                                     08123018
081240                        MOVE PV-ML-BC-6   TO PC165-3OF9-BC        08124018
081250                        IF PV-BC-6-RANGE-VALUE =                  08125018
081260                           PC140-ML-END-RANGE-NBR                 08126018
081270                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08127018
081280                                        PV-BC-6-RANGE-VALUE       08128018
081290                        ELSE                                      08129018
081300                           ADD 1          TO PV-BC-6-RANGE-VALUE  08130018
081310                        END-IF                                    08131018
081320                   WHEN PC-07                                     08132018
081330                        MOVE PV-ML-BC-7   TO PC165-3OF9-BC        08133018
081340                        IF PV-BC-7-RANGE-VALUE =                  08134018
081350                           PC140-ML-END-RANGE-NBR                 08135018
081360                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08136018
081370                                        PV-BC-7-RANGE-VALUE       08137018
081380                        ELSE                                      08138018
081390                           ADD 1          TO PV-BC-7-RANGE-VALUE  08139018
081400                        END-IF                                    08140018
081410                   WHEN PC-08                                     08141018
081420                        MOVE PV-ML-BC-8   TO PC165-3OF9-BC        08142018
081430                        IF PV-BC-8-RANGE-VALUE =                  08143018
081440                           PC140-ML-END-RANGE-NBR                 08144018
081450                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08145018
081460                                        PV-BC-8-RANGE-VALUE       08146018
081470                        ELSE                                      08147018
081480                           ADD 1          TO PV-BC-8-RANGE-VALUE  08148018
081490                        END-IF                                    08149018
081500                   WHEN PC-09                                     08150018
081510                        MOVE PV-ML-BC-9   TO PC165-3OF9-BC        08151018
081520                        IF PV-BC-9-RANGE-VALUE =                  08152018
081530                           PC140-ML-END-RANGE-NBR                 08153018
081540                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08154018
081550                                        PV-BC-9-RANGE-VALUE       08155018
081560                        ELSE                                      08156018
081570                           ADD 1          TO PV-BC-9-RANGE-VALUE  08157018
081580                        END-IF                                    08158018
081590               END-EVALUATE                                       08159018
081600               IF PC140-COMMON-MISC-LBL-NBR                       08160018
081610                 PERFORM 4535-MISC-DTL-LABEL                      08161018
081620                    VARYING PC165-IDX FROM 1 BY 1                 08162018
081630                      UNTIL PC165-IDX                             08163018
081640                            > PC165-MAX-LABEL-LINES               08164018
081650                                  OR PS-SOCKET-ERROR              08165018
081660               ELSE                                               08166018
081670                 PERFORM 4537-MISC-DTL-LABEL-MSG                  08167018
081680                    VARYING PC191-IDX FROM 1 BY 1                 08168018
081690                      UNTIL PC191-IDX                             08169018
081700                            > PC191-MAX-LABEL-LINES               08170018
081710                                  OR PS-SOCKET-ERROR              08171018
081720               END-IF                                             08172018
081730               ADD 1 TO PV-HR-6-RANGE-VALUE                       08173018
081740          WHEN PC-07                                              08174018
081750               MOVE PV-ML-HR-7     TO PC165-3OF9-BC-NBR           08175018
081760                                      PC191-3OF9-BC-NBR           08176018
081770               EVALUATE PC140-ML-BEGIN-RANGE-POSN-BC              08177018
081780                   WHEN PC-01                                     08178018
081790                        MOVE PV-ML-BC-1   TO PC165-3OF9-BC        08179018
081800                        IF PV-BC-1-RANGE-VALUE =                  08180018
081810                           PC140-ML-END-RANGE-NBR                 08181018
081820                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08182018
081830                                        PV-BC-1-RANGE-VALUE       08183018
081840                        ELSE                                      08184018
081850                           ADD 1          TO PV-BC-1-RANGE-VALUE  08185018
081860                        END-IF                                    08186018
081870                   WHEN PC-02                                     08187018
081880                        MOVE PV-ML-BC-2   TO PC165-3OF9-BC        08188018
081890                        IF PV-BC-2-RANGE-VALUE =                  08189018
081900                           PC140-ML-END-RANGE-NBR                 08190018
081910                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08191018
081920                                        PV-BC-2-RANGE-VALUE       08192018
081930                        ELSE                                      08193018
081940                           ADD 1          TO PV-BC-2-RANGE-VALUE  08194018
081950                        END-IF                                    08195018
081960                   WHEN PC-03                                     08196018
081970                        MOVE PV-ML-BC-3   TO PC165-3OF9-BC        08197018
081980                        IF PV-BC-3-RANGE-VALUE =                  08198018
081990                           PC140-ML-END-RANGE-NBR                 08199018
082000                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08200018
082010                                        PV-BC-3-RANGE-VALUE       08201018
082020                        ELSE                                      08202018
082030                           ADD 1          TO PV-BC-3-RANGE-VALUE  08203018
082040                        END-IF                                    08204018
082050                   WHEN PC-04                                     08205018
082060                        MOVE PV-ML-BC-4   TO PC165-3OF9-BC        08206018
082070                        IF PV-BC-4-RANGE-VALUE =                  08207018
082080                           PC140-ML-END-RANGE-NBR                 08208018
082090                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08209018
082100                                        PV-BC-4-RANGE-VALUE       08210018
082110                        ELSE                                      08211018
082120                           ADD 1          TO PV-BC-4-RANGE-VALUE  08212018
082130                        END-IF                                    08213018
082140                   WHEN PC-05                                     08214018
082150                        MOVE PV-ML-BC-5   TO PC165-3OF9-BC        08215018
082160                        IF PV-BC-5-RANGE-VALUE =                  08216018
082170                           PC140-ML-END-RANGE-NBR                 08217018
082180                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08218018
082190                                        PV-BC-5-RANGE-VALUE       08219018
082200                        ELSE                                      08220018
082210                           ADD 1          TO PV-BC-5-RANGE-VALUE  08221018
082220                        END-IF                                    08222018
082230                   WHEN PC-06                                     08223018
082240                        MOVE PV-ML-BC-6   TO PC165-3OF9-BC        08224018
082250                        IF PV-BC-6-RANGE-VALUE =                  08225018
082260                           PC140-ML-END-RANGE-NBR                 08226018
082270                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08227018
082280                                        PV-BC-6-RANGE-VALUE       08228018
082290                        ELSE                                      08229018
082300                           ADD 1          TO PV-BC-6-RANGE-VALUE  08230018
082310                        END-IF                                    08231018
082320                   WHEN PC-07                                     08232018
082330                        MOVE PV-ML-BC-7   TO PC165-3OF9-BC        08233018
082340                        IF PV-BC-7-RANGE-VALUE =                  08234018
082350                           PC140-ML-END-RANGE-NBR                 08235018
082360                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08236018
082370                                        PV-BC-7-RANGE-VALUE       08237018
082380                        ELSE                                      08238018
082390                           ADD 1          TO PV-BC-7-RANGE-VALUE  08239018
082400                        END-IF                                    08240018
082410                   WHEN PC-08                                     08241018
082420                        MOVE PV-ML-BC-8   TO PC165-3OF9-BC        08242018
082430                        IF PV-BC-8-RANGE-VALUE =                  08243018
082440                           PC140-ML-END-RANGE-NBR                 08244018
082450                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08245018
082460                                        PV-BC-8-RANGE-VALUE       08246018
082470                        ELSE                                      08247018
082480                           ADD 1          TO PV-BC-8-RANGE-VALUE  08248018
082490                        END-IF                                    08249018
082500                   WHEN PC-09                                     08250018
082510                        MOVE PV-ML-BC-9   TO PC165-3OF9-BC        08251018
082520                        IF PV-BC-9-RANGE-VALUE =                  08252018
082530                           PC140-ML-END-RANGE-NBR                 08253018
082540                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08254018
082550                                        PV-BC-9-RANGE-VALUE       08255018
082560                        ELSE                                      08256018
082570                           ADD 1          TO PV-BC-9-RANGE-VALUE  08257018
082580                        END-IF                                    08258018
082590               END-EVALUATE                                       08259018
082600               IF PC140-COMMON-MISC-LBL-NBR                       08260018
082610                 PERFORM 4535-MISC-DTL-LABEL                      08261018
082620                    VARYING PC165-IDX FROM 1 BY 1                 08262018
082630                      UNTIL PC165-IDX                             08263018
082640                            > PC165-MAX-LABEL-LINES               08264018
082650                                  OR PS-SOCKET-ERROR              08265018
082660               ELSE                                               08266018
082670                 PERFORM 4537-MISC-DTL-LABEL-MSG                  08267018
082680                    VARYING PC191-IDX FROM 1 BY 1                 08268018
082690                      UNTIL PC191-IDX                             08269018
082700                            > PC191-MAX-LABEL-LINES               08270018
082710                                  OR PS-SOCKET-ERROR              08271018
082720               END-IF                                             08272018
082730               ADD 1 TO PV-HR-7-RANGE-VALUE                       08273018
082740          WHEN PC-08                                              08274018
082750               MOVE PV-ML-HR-8     TO PC165-3OF9-BC-NBR           08275018
082760                                      PC191-3OF9-BC-NBR           08276018
082770               EVALUATE PC140-ML-BEGIN-RANGE-POSN-BC              08277018
082780                   WHEN PC-01                                     08278018
082790                        MOVE PV-ML-BC-1   TO PC165-3OF9-BC        08279018
082800                        IF PV-BC-1-RANGE-VALUE =                  08280018
082810                           PC140-ML-END-RANGE-NBR                 08281018
082820                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08282018
082830                                        PV-BC-1-RANGE-VALUE       08283018
082840                        ELSE                                      08284018
082850                           ADD 1          TO PV-BC-1-RANGE-VALUE  08285018
082860                        END-IF                                    08286018
082870                   WHEN PC-02                                     08287018
082880                        MOVE PV-ML-BC-2   TO PC165-3OF9-BC        08288018
082890                        IF PV-BC-2-RANGE-VALUE =                  08289018
082900                           PC140-ML-END-RANGE-NBR                 08290018
082910                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08291018
082920                                        PV-BC-2-RANGE-VALUE       08292018
082930                        ELSE                                      08293018
082940                           ADD 1          TO PV-BC-2-RANGE-VALUE  08294018
082950                        END-IF                                    08295018
082960                   WHEN PC-03                                     08296018
082970                        MOVE PV-ML-BC-3   TO PC165-3OF9-BC        08297018
082980                        IF PV-BC-3-RANGE-VALUE =                  08298018
082990                           PC140-ML-END-RANGE-NBR                 08299018
083000                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08300018
083010                                        PV-BC-3-RANGE-VALUE       08301018
083020                        ELSE                                      08302018
083030                           ADD 1          TO PV-BC-3-RANGE-VALUE  08303018
083040                        END-IF                                    08304018
083050                   WHEN PC-04                                     08305018
083060                        MOVE PV-ML-BC-4   TO PC165-3OF9-BC        08306018
083070                        IF PV-BC-4-RANGE-VALUE =                  08307018
083080                           PC140-ML-END-RANGE-NBR                 08308018
083090                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08309018
083100                                        PV-BC-4-RANGE-VALUE       08310018
083110                        ELSE                                      08311018
083120                           ADD 1          TO PV-BC-4-RANGE-VALUE  08312018
083130                        END-IF                                    08313018
083140                   WHEN PC-05                                     08314018
083150                        MOVE PV-ML-BC-5   TO PC165-3OF9-BC        08315018
083160                        IF PV-BC-5-RANGE-VALUE =                  08316018
083170                           PC140-ML-END-RANGE-NBR                 08317018
083180                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08318018
083190                                        PV-BC-5-RANGE-VALUE       08319018
083200                        ELSE                                      08320018
083210                           ADD 1          TO PV-BC-5-RANGE-VALUE  08321018
083220                        END-IF                                    08322018
083230                   WHEN PC-06                                     08323018
083240                        MOVE PV-ML-BC-6   TO PC165-3OF9-BC        08324018
083250                        IF PV-BC-6-RANGE-VALUE =                  08325018
083260                           PC140-ML-END-RANGE-NBR                 08326018
083270                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08327018
083280                                        PV-BC-6-RANGE-VALUE       08328018
083290                        ELSE                                      08329018
083300                           ADD 1          TO PV-BC-6-RANGE-VALUE  08330018
083310                        END-IF                                    08331018
083320                   WHEN PC-07                                     08332018
083330                        MOVE PV-ML-BC-7   TO PC165-3OF9-BC        08333018
083340                        IF PV-BC-7-RANGE-VALUE =                  08334018
083350                           PC140-ML-END-RANGE-NBR                 08335018
083360                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08336018
083370                                        PV-BC-7-RANGE-VALUE       08337018
083380                        ELSE                                      08338018
083390                           ADD 1          TO PV-BC-7-RANGE-VALUE  08339018
083400                        END-IF                                    08340018
083410                   WHEN PC-08                                     08341018
083420                        MOVE PV-ML-BC-8   TO PC165-3OF9-BC        08342018
083430                        IF PV-BC-8-RANGE-VALUE =                  08343018
083440                           PC140-ML-END-RANGE-NBR                 08344018
083450                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08345018
083460                                        PV-BC-8-RANGE-VALUE       08346018
083470                        ELSE                                      08347018
083480                           ADD 1          TO PV-BC-8-RANGE-VALUE  08348018
083490                        END-IF                                    08349018
083500                   WHEN PC-09                                     08350018
083510                        MOVE PV-ML-BC-9   TO PC165-3OF9-BC        08351018
083520                        IF PV-BC-9-RANGE-VALUE =                  08352018
083530                           PC140-ML-END-RANGE-NBR                 08353018
083540                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08354018
083550                                        PV-BC-9-RANGE-VALUE       08355018
083560                        ELSE                                      08356018
083570                           ADD 1          TO PV-BC-9-RANGE-VALUE  08357018
083580                        END-IF                                    08358018
083590               END-EVALUATE                                       08359018
083600               IF PC140-COMMON-MISC-LBL-NBR                       08360018
083610                 PERFORM 4535-MISC-DTL-LABEL                      08361018
083620                    VARYING PC165-IDX FROM 1 BY 1                 08362018
083630                      UNTIL PC165-IDX                             08363018
083640                            > PC165-MAX-LABEL-LINES               08364018
083650                                  OR PS-SOCKET-ERROR              08365018
083660               ELSE                                               08366018
083670                 PERFORM 4537-MISC-DTL-LABEL-MSG                  08367018
083680                    VARYING PC191-IDX FROM 1 BY 1                 08368018
083690                      UNTIL PC191-IDX                             08369018
083700                            > PC191-MAX-LABEL-LINES               08370018
083710                                  OR PS-SOCKET-ERROR              08371018
083720               END-IF                                             08372018
083730               ADD 1 TO PV-HR-8-RANGE-VALUE                       08373018
083740          WHEN PC-09                                              08374018
083750               MOVE PV-ML-HR-9     TO PC165-3OF9-BC-NBR           08375018
083760                                      PC191-3OF9-BC-NBR           08376018
083770               EVALUATE PC140-ML-BEGIN-RANGE-POSN-BC              08377018
083780                   WHEN PC-01                                     08378018
083790                        MOVE PV-ML-BC-1   TO PC165-3OF9-BC        08379018
083800                        IF PV-BC-1-RANGE-VALUE =                  08380018
083810                           PC140-ML-END-RANGE-NBR                 08381018
083820                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08382018
083830                                        PV-BC-1-RANGE-VALUE       08383018
083840                        ELSE                                      08384018
083850                           ADD 1          TO PV-BC-1-RANGE-VALUE  08385018
083860                        END-IF                                    08386018
083870                   WHEN PC-02                                     08387018
083880                        MOVE PV-ML-BC-2   TO PC165-3OF9-BC        08388018
083890                        IF PV-BC-2-RANGE-VALUE =                  08389018
083900                           PC140-ML-END-RANGE-NBR                 08390018
083910                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08391018
083920                                        PV-BC-2-RANGE-VALUE       08392018
083930                        ELSE                                      08393018
083940                           ADD 1          TO PV-BC-2-RANGE-VALUE  08394018
083950                        END-IF                                    08395018
083960                   WHEN PC-03                                     08396018
083970                        MOVE PV-ML-BC-3   TO PC165-3OF9-BC        08397018
083980                        IF PV-BC-3-RANGE-VALUE =                  08398018
083990                           PC140-ML-END-RANGE-NBR                 08399018
084000                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08400018
084010                                        PV-BC-3-RANGE-VALUE       08401018
084020                        ELSE                                      08402018
084030                           ADD 1          TO PV-BC-3-RANGE-VALUE  08403018
084040                        END-IF                                    08404018
084050                   WHEN PC-04                                     08405018
084060                        MOVE PV-ML-BC-4   TO PC165-3OF9-BC        08406018
084070                        IF PV-BC-4-RANGE-VALUE =                  08407018
084080                           PC140-ML-END-RANGE-NBR                 08408018
084090                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08409018
084100                                        PV-BC-4-RANGE-VALUE       08410018
084110                        ELSE                                      08411018
084120                           ADD 1          TO PV-BC-4-RANGE-VALUE  08412018
084130                        END-IF                                    08413018
084140                   WHEN PC-05                                     08414018
084150                        MOVE PV-ML-BC-5   TO PC165-3OF9-BC        08415018
084160                        IF PV-BC-5-RANGE-VALUE =                  08416018
084170                           PC140-ML-END-RANGE-NBR                 08417018
084180                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08418018
084190                                        PV-BC-5-RANGE-VALUE       08419018
084200                        ELSE                                      08420018
084210                           ADD 1          TO PV-BC-5-RANGE-VALUE  08421018
084220                        END-IF                                    08422018
084230                   WHEN PC-06                                     08423018
084240                        MOVE PV-ML-BC-6   TO PC165-3OF9-BC        08424018
084250                        IF PV-BC-6-RANGE-VALUE =                  08425018
084260                           PC140-ML-END-RANGE-NBR                 08426018
084270                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08427018
084280                                        PV-BC-6-RANGE-VALUE       08428018
084290                        ELSE                                      08429018
084300                           ADD 1          TO PV-BC-6-RANGE-VALUE  08430018
084310                        END-IF                                    08431018
084320                   WHEN PC-07                                     08432018
084330                        MOVE PV-ML-BC-7   TO PC165-3OF9-BC        08433018
084340                        IF PV-BC-7-RANGE-VALUE =                  08434018
084350                           PC140-ML-END-RANGE-NBR                 08435018
084360                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08436018
084370                                        PV-BC-7-RANGE-VALUE       08437018
084380                        ELSE                                      08438018
084390                           ADD 1          TO PV-BC-7-RANGE-VALUE  08439018
084400                        END-IF                                    08440018
084410                   WHEN PC-08                                     08441018
084420                        MOVE PV-ML-BC-8   TO PC165-3OF9-BC        08442018
084430                        IF PV-BC-8-RANGE-VALUE =                  08443018
084440                           PC140-ML-END-RANGE-NBR                 08444018
084450                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08445018
084460                                        PV-BC-8-RANGE-VALUE       08446018
084470                        ELSE                                      08447018
084480                           ADD 1          TO PV-BC-8-RANGE-VALUE  08448018
084490                        END-IF                                    08449018
084500                   WHEN PC-09                                     08450018
084510                        MOVE PV-ML-BC-9   TO PC165-3OF9-BC        08451018
084520                        IF PV-BC-9-RANGE-VALUE =                  08452018
084530                           PC140-ML-END-RANGE-NBR                 08453018
084540                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08454018
084550                                        PV-BC-9-RANGE-VALUE       08455018
084560                        ELSE                                      08456018
084570                           ADD 1          TO PV-BC-9-RANGE-VALUE  08457018
084580                        END-IF                                    08458018
084590               END-EVALUATE                                       08459018
084600               IF PC140-COMMON-MISC-LBL-NBR                       08460018
084610                 PERFORM 4535-MISC-DTL-LABEL                      08461018
084620                    VARYING PC165-IDX FROM 1 BY 1                 08462018
084630                      UNTIL PC165-IDX                             08463018
084640                            > PC165-MAX-LABEL-LINES               08464018
084650                                  OR PS-SOCKET-ERROR              08465018
084660               ELSE                                               08466018
084670                 PERFORM 4537-MISC-DTL-LABEL-MSG                  08467018
084680                    VARYING PC191-IDX FROM 1 BY 1                 08468018
084690                      UNTIL PC191-IDX                             08469018
084700                            > PC191-MAX-LABEL-LINES               08470018
084710                                  OR PS-SOCKET-ERROR              08471018
084720               END-IF                                             08472018
084730               ADD 1 TO PV-HR-9-RANGE-VALUE                       08473018
084740          WHEN PC-10                                              08474018
084750               MOVE PV-ML-HR-10    TO PC165-3OF9-BC-NBR           08475018
084760                                      PC191-3OF9-BC-NBR           08476018
084770               EVALUATE PC140-ML-BEGIN-RANGE-POSN-BC              08477018
084780                   WHEN PC-01                                     08478018
084790                        MOVE PV-ML-BC-1   TO PC165-3OF9-BC        08479018
084800                        IF PV-BC-1-RANGE-VALUE =                  08480018
084810                           PC140-ML-END-RANGE-NBR                 08481018
084820                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08482018
084830                                        PV-BC-1-RANGE-VALUE       08483018
084840                        ELSE                                      08484018
084850                           ADD 1          TO PV-BC-1-RANGE-VALUE  08485018
084860                        END-IF                                    08486018
084870                   WHEN PC-02                                     08487018
084880                        MOVE PV-ML-BC-2   TO PC165-3OF9-BC        08488018
084890                        IF PV-BC-2-RANGE-VALUE =                  08489018
084900                           PC140-ML-END-RANGE-NBR                 08490018
084910                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08491018
084920                                        PV-BC-2-RANGE-VALUE       08492018
084930                        ELSE                                      08493018
084940                           ADD 1          TO PV-BC-2-RANGE-VALUE  08494018
084950                        END-IF                                    08495018
084960                   WHEN PC-03                                     08496018
084970                        MOVE PV-ML-BC-3   TO PC165-3OF9-BC        08497018
084980                        IF PV-BC-3-RANGE-VALUE =                  08498018
084990                           PC140-ML-END-RANGE-NBR                 08499018
085000                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08500018
085010                                        PV-BC-3-RANGE-VALUE       08501018
085020                        ELSE                                      08502018
085030                           ADD 1          TO PV-BC-3-RANGE-VALUE  08503018
085040                        END-IF                                    08504018
085050                   WHEN PC-04                                     08505018
085060                        MOVE PV-ML-BC-4   TO PC165-3OF9-BC        08506018
085070                        IF PV-BC-4-RANGE-VALUE =                  08507018
085080                           PC140-ML-END-RANGE-NBR                 08508018
085090                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08509018
085100                                        PV-BC-4-RANGE-VALUE       08510018
085110                        ELSE                                      08511018
085120                           ADD 1          TO PV-BC-4-RANGE-VALUE  08512018
085130                        END-IF                                    08513018
085140                   WHEN PC-05                                     08514018
085150                        MOVE PV-ML-BC-5   TO PC165-3OF9-BC        08515018
085160                        IF PV-BC-5-RANGE-VALUE =                  08516018
085170                           PC140-ML-END-RANGE-NBR                 08517018
085180                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08518018
085190                                        PV-BC-5-RANGE-VALUE       08519018
085200                        ELSE                                      08520018
085210                           ADD 1          TO PV-BC-5-RANGE-VALUE  08521018
085220                        END-IF                                    08522018
085230                   WHEN PC-06                                     08523018
085240                        MOVE PV-ML-BC-6   TO PC165-3OF9-BC        08524018
085250                        IF PV-BC-6-RANGE-VALUE =                  08525018
085260                           PC140-ML-END-RANGE-NBR                 08526018
085270                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08527018
085280                                        PV-BC-6-RANGE-VALUE       08528018
085290                        ELSE                                      08529018
085300                           ADD 1          TO PV-BC-6-RANGE-VALUE  08530018
085310                        END-IF                                    08531018
085320                   WHEN PC-07                                     08532018
085330                        MOVE PV-ML-BC-7   TO PC165-3OF9-BC        08533018
085340                        IF PV-BC-7-RANGE-VALUE =                  08534018
085350                           PC140-ML-END-RANGE-NBR                 08535018
085360                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08536018
085370                                        PV-BC-7-RANGE-VALUE       08537018
085380                        ELSE                                      08538018
085390                           ADD 1          TO PV-BC-7-RANGE-VALUE  08539018
085400                        END-IF                                    08540018
085410                   WHEN PC-08                                     08541018
085420                        MOVE PV-ML-BC-8   TO PC165-3OF9-BC        08542018
085430                        IF PV-BC-8-RANGE-VALUE =                  08543018
085440                           PC140-ML-END-RANGE-NBR                 08544018
085450                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08545018
085460                                        PV-BC-8-RANGE-VALUE       08546018
085470                        ELSE                                      08547018
085480                           ADD 1          TO PV-BC-8-RANGE-VALUE  08548018
085490                        END-IF                                    08549018
085500                   WHEN PC-09                                     08550018
085510                        MOVE PV-ML-BC-9   TO PC165-3OF9-BC        08551018
085520                        IF PV-BC-9-RANGE-VALUE =                  08552018
085530                           PC140-ML-END-RANGE-NBR                 08553018
085540                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08554018
085550                                        PV-BC-9-RANGE-VALUE       08555018
085560                        ELSE                                      08556018
085570                           ADD 1          TO PV-BC-9-RANGE-VALUE  08557018
085580                        END-IF                                    08558018
085590               END-EVALUATE                                       08559018
085600               IF PC140-COMMON-MISC-LBL-NBR                       08560018
085610                 PERFORM 4535-MISC-DTL-LABEL                      08561018
085620                    VARYING PC165-IDX FROM 1 BY 1                 08562018
085630                      UNTIL PC165-IDX                             08563018
085640                            > PC165-MAX-LABEL-LINES               08564018
085650                                  OR PS-SOCKET-ERROR              08565018
085660               ELSE                                               08566018
085670                 PERFORM 4537-MISC-DTL-LABEL-MSG                  08567018
085680                    VARYING PC191-IDX FROM 1 BY 1                 08568018
085690                      UNTIL PC191-IDX                             08569018
085700                            > PC191-MAX-LABEL-LINES               08570018
085710                                  OR PS-SOCKET-ERROR              08571018
085720               END-IF                                             08572018
085730               ADD 1 TO PV-HR-10-RANGE-VALUE                      08573018
085740          WHEN PC-11                                              08574018
085750               MOVE PV-ML-HR-11    TO PC165-3OF9-BC-NBR           08575018
085760                                      PC191-3OF9-BC-NBR           08576018
085770               EVALUATE PC140-ML-BEGIN-RANGE-POSN-BC              08577018
085780                   WHEN PC-01                                     08578018
085790                        MOVE PV-ML-BC-1   TO PC165-3OF9-BC        08579018
085800                        IF PV-BC-1-RANGE-VALUE =                  08580018
085810                           PC140-ML-END-RANGE-NBR                 08581018
085820                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08582018
085830                                        PV-BC-1-RANGE-VALUE       08583018
085840                        ELSE                                      08584018
085850                           ADD 1          TO PV-BC-1-RANGE-VALUE  08585018
085860                        END-IF                                    08586018
085870                   WHEN PC-02                                     08587018
085880                        MOVE PV-ML-BC-2   TO PC165-3OF9-BC        08588018
085890                        IF PV-BC-2-RANGE-VALUE =                  08589018
085900                           PC140-ML-END-RANGE-NBR                 08590018
085910                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08591018
085920                                        PV-BC-2-RANGE-VALUE       08592018
085930                        ELSE                                      08593018
085940                           ADD 1          TO PV-BC-2-RANGE-VALUE  08594018
085950                        END-IF                                    08595018
085960                   WHEN PC-03                                     08596018
085970                        MOVE PV-ML-BC-3   TO PC165-3OF9-BC        08597018
085980                        IF PV-BC-3-RANGE-VALUE =                  08598018
085990                           PC140-ML-END-RANGE-NBR                 08599018
086000                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08600018
086010                                        PV-BC-3-RANGE-VALUE       08601018
086020                        ELSE                                      08602018
086030                           ADD 1          TO PV-BC-3-RANGE-VALUE  08603018
086040                        END-IF                                    08604018
086050                   WHEN PC-04                                     08605018
086060                        MOVE PV-ML-BC-4   TO PC165-3OF9-BC        08606018
086070                        IF PV-BC-4-RANGE-VALUE =                  08607018
086080                           PC140-ML-END-RANGE-NBR                 08608018
086090                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08609018
086100                                        PV-BC-4-RANGE-VALUE       08610018
086110                        ELSE                                      08611018
086120                           ADD 1          TO PV-BC-4-RANGE-VALUE  08612018
086130                        END-IF                                    08613018
086140                   WHEN PC-05                                     08614018
086150                        MOVE PV-ML-BC-5   TO PC165-3OF9-BC        08615018
086160                        IF PV-BC-5-RANGE-VALUE =                  08616018
086170                           PC140-ML-END-RANGE-NBR                 08617018
086180                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08618018
086190                                        PV-BC-5-RANGE-VALUE       08619018
086200                        ELSE                                      08620018
086210                           ADD 1          TO PV-BC-5-RANGE-VALUE  08621018
086220                        END-IF                                    08622018
086230                   WHEN PC-06                                     08623018
086240                        MOVE PV-ML-BC-6   TO PC165-3OF9-BC        08624018
086250                        IF PV-BC-6-RANGE-VALUE =                  08625018
086260                           PC140-ML-END-RANGE-NBR                 08626018
086270                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08627018
086280                                        PV-BC-6-RANGE-VALUE       08628018
086290                        ELSE                                      08629018
086300                           ADD 1          TO PV-BC-6-RANGE-VALUE  08630018
086310                        END-IF                                    08631018
086320                   WHEN PC-07                                     08632018
086330                        MOVE PV-ML-BC-7   TO PC165-3OF9-BC        08633018
086340                        IF PV-BC-7-RANGE-VALUE =                  08634018
086350                           PC140-ML-END-RANGE-NBR                 08635018
086360                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08636018
086370                                        PV-BC-7-RANGE-VALUE       08637018
086380                        ELSE                                      08638018
086390                           ADD 1          TO PV-BC-7-RANGE-VALUE  08639018
086400                        END-IF                                    08640018
086410                   WHEN PC-08                                     08641018
086420                        MOVE PV-ML-BC-8   TO PC165-3OF9-BC        08642018
086430                        IF PV-BC-8-RANGE-VALUE =                  08643018
086440                           PC140-ML-END-RANGE-NBR                 08644018
086450                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08645018
086460                                        PV-BC-8-RANGE-VALUE       08646018
086470                        ELSE                                      08647018
086480                           ADD 1          TO PV-BC-8-RANGE-VALUE  08648018
086490                        END-IF                                    08649018
086500                   WHEN PC-09                                     08650018
086510                        MOVE PV-ML-BC-9   TO PC165-3OF9-BC        08651018
086520                        IF PV-BC-9-RANGE-VALUE =                  08652018
086530                           PC140-ML-END-RANGE-NBR                 08653018
086540                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08654018
086550                                        PV-BC-9-RANGE-VALUE       08655018
086560                        ELSE                                      08656018
086570                           ADD 1          TO PV-BC-9-RANGE-VALUE  08657018
086580                        END-IF                                    08658018
086590               END-EVALUATE                                       08659018
086600               IF PC140-COMMON-MISC-LBL-NBR                       08660018
086610                 PERFORM 4535-MISC-DTL-LABEL                      08661018
086620                    VARYING PC165-IDX FROM 1 BY 1                 08662018
086630                      UNTIL PC165-IDX                             08663018
086640                            > PC165-MAX-LABEL-LINES               08664018
086650                                  OR PS-SOCKET-ERROR              08665018
086660               ELSE                                               08666018
086670                 PERFORM 4537-MISC-DTL-LABEL-MSG                  08667018
086680                    VARYING PC191-IDX FROM 1 BY 1                 08668018
086690                      UNTIL PC191-IDX                             08669018
086700                            > PC191-MAX-LABEL-LINES               08670018
086710                                  OR PS-SOCKET-ERROR              08671018
086720               END-IF                                             08672018
086730               ADD 1 TO PV-HR-11-RANGE-VALUE                      08673018
086740          WHEN PC-12                                              08674018
086750               MOVE PV-ML-HR-12    TO PC165-3OF9-BC-NBR           08675018
086760                                      PC191-3OF9-BC-NBR           08676018
086770               EVALUATE PC140-ML-BEGIN-RANGE-POSN-BC              08677018
086780                   WHEN PC-01                                     08678018
086790                        MOVE PV-ML-BC-1   TO PC165-3OF9-BC        08679018
086800                        IF PV-BC-1-RANGE-VALUE =                  08680018
086810                           PC140-ML-END-RANGE-NBR                 08681018
086820                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08682018
086830                                        PV-BC-1-RANGE-VALUE       08683018
086840                        ELSE                                      08684018
086850                           ADD 1          TO PV-BC-1-RANGE-VALUE  08685018
086860                        END-IF                                    08686018
086870                   WHEN PC-02                                     08687018
086880                        MOVE PV-ML-BC-2   TO PC165-3OF9-BC        08688018
086890                        IF PV-BC-2-RANGE-VALUE =                  08689018
086900                           PC140-ML-END-RANGE-NBR                 08690018
086910                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08691018
086920                                        PV-BC-2-RANGE-VALUE       08692018
086930                        ELSE                                      08693018
086940                           ADD 1          TO PV-BC-2-RANGE-VALUE  08694018
086950                        END-IF                                    08695018
086960                   WHEN PC-03                                     08696018
086970                        MOVE PV-ML-BC-3   TO PC165-3OF9-BC        08697018
086980                        IF PV-BC-3-RANGE-VALUE =                  08698018
086990                           PC140-ML-END-RANGE-NBR                 08699018
087000                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08700018
087010                                        PV-BC-3-RANGE-VALUE       08701018
087020                        ELSE                                      08702018
087030                           ADD 1          TO PV-BC-3-RANGE-VALUE  08703018
087040                        END-IF                                    08704018
087050                   WHEN PC-04                                     08705018
087060                        MOVE PV-ML-BC-4   TO PC165-3OF9-BC        08706018
087070                        IF PV-BC-4-RANGE-VALUE =                  08707018
087080                           PC140-ML-END-RANGE-NBR                 08708018
087090                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08709018
087100                                        PV-BC-4-RANGE-VALUE       08710018
087110                        ELSE                                      08711018
087120                           ADD 1          TO PV-BC-4-RANGE-VALUE  08712018
087130                        END-IF                                    08713018
087140                   WHEN PC-05                                     08714018
087150                        MOVE PV-ML-BC-5   TO PC165-3OF9-BC        08715018
087160                        IF PV-BC-5-RANGE-VALUE =                  08716018
087170                           PC140-ML-END-RANGE-NBR                 08717018
087180                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08718018
087190                                        PV-BC-5-RANGE-VALUE       08719018
087200                        ELSE                                      08720018
087210                           ADD 1          TO PV-BC-5-RANGE-VALUE  08721018
087220                        END-IF                                    08722018
087230                   WHEN PC-06                                     08723018
087240                        MOVE PV-ML-BC-6   TO PC165-3OF9-BC        08724018
087250                        IF PV-BC-6-RANGE-VALUE =                  08725018
087260                           PC140-ML-END-RANGE-NBR                 08726018
087270                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08727018
087280                                        PV-BC-6-RANGE-VALUE       08728018
087290                        ELSE                                      08729018
087300                           ADD 1          TO PV-BC-6-RANGE-VALUE  08730018
087310                        END-IF                                    08731018
087320                   WHEN PC-07                                     08732018
087330                        MOVE PV-ML-BC-7   TO PC165-3OF9-BC        08733018
087340                        IF PV-BC-7-RANGE-VALUE =                  08734018
087350                           PC140-ML-END-RANGE-NBR                 08735018
087360                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08736018
087370                                        PV-BC-7-RANGE-VALUE       08737018
087380                        ELSE                                      08738018
087390                           ADD 1          TO PV-BC-7-RANGE-VALUE  08739018
087400                        END-IF                                    08740018
087410                   WHEN PC-08                                     08741018
087420                        MOVE PV-ML-BC-8   TO PC165-3OF9-BC        08742018
087430                        IF PV-BC-8-RANGE-VALUE =                  08743018
087440                           PC140-ML-END-RANGE-NBR                 08744018
087450                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08745018
087460                                        PV-BC-8-RANGE-VALUE       08746018
087470                        ELSE                                      08747018
087480                           ADD 1          TO PV-BC-8-RANGE-VALUE  08748018
087490                        END-IF                                    08749018
087500                   WHEN PC-09                                     08750018
087510                        MOVE PV-ML-BC-9   TO PC165-3OF9-BC        08751018
087520                        IF PV-BC-9-RANGE-VALUE =                  08752018
087530                           PC140-ML-END-RANGE-NBR                 08753018
087540                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08754018
087550                                        PV-BC-9-RANGE-VALUE       08755018
087560                        ELSE                                      08756018
087570                           ADD 1          TO PV-BC-9-RANGE-VALUE  08757018
087580                        END-IF                                    08758018
087590               END-EVALUATE                                       08759018
087600               IF PC140-COMMON-MISC-LBL-NBR                       08760018
087610                 PERFORM 4535-MISC-DTL-LABEL                      08761018
087620                    VARYING PC165-IDX FROM 1 BY 1                 08762018
087630                      UNTIL PC165-IDX                             08763018
087640                            > PC165-MAX-LABEL-LINES               08764018
087650                                  OR PS-SOCKET-ERROR              08765018
087660               ELSE                                               08766018
087670                 PERFORM 4537-MISC-DTL-LABEL-MSG                  08767018
087680                    VARYING PC191-IDX FROM 1 BY 1                 08768018
087690                      UNTIL PC191-IDX                             08769018
087700                            > PC191-MAX-LABEL-LINES               08770018
087710                                  OR PS-SOCKET-ERROR              08771018
087720               END-IF                                             08772018
087730               ADD 1 TO PV-HR-12-RANGE-VALUE                      08773018
087740          WHEN PC-13                                              08774018
087750               MOVE PV-ML-HR-13    TO PC165-3OF9-BC-NBR           08775018
087760                                      PC191-3OF9-BC-NBR           08776018
087770               EVALUATE PC140-ML-BEGIN-RANGE-POSN-BC              08777018
087780                   WHEN PC-01                                     08778018
087790                        MOVE PV-ML-BC-1   TO PC165-3OF9-BC        08779018
087800                        IF PV-BC-1-RANGE-VALUE =                  08780018
087810                           PC140-ML-END-RANGE-NBR                 08781018
087820                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08782018
087830                                        PV-BC-1-RANGE-VALUE       08783018
087840                        ELSE                                      08784018
087850                           ADD 1          TO PV-BC-1-RANGE-VALUE  08785018
087860                        END-IF                                    08786018
087870                   WHEN PC-02                                     08787018
087880                        MOVE PV-ML-BC-2   TO PC165-3OF9-BC        08788018
087890                        IF PV-BC-2-RANGE-VALUE =                  08789018
087900                           PC140-ML-END-RANGE-NBR                 08790018
087910                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08791018
087920                                        PV-BC-2-RANGE-VALUE       08792018
087930                        ELSE                                      08793018
087940                           ADD 1          TO PV-BC-2-RANGE-VALUE  08794018
087950                        END-IF                                    08795018
087960                   WHEN PC-03                                     08796018
087970                        MOVE PV-ML-BC-3   TO PC165-3OF9-BC        08797018
087980                        IF PV-BC-3-RANGE-VALUE =                  08798018
087990                           PC140-ML-END-RANGE-NBR                 08799018
088000                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08800018
088010                                        PV-BC-3-RANGE-VALUE       08801018
088020                        ELSE                                      08802018
088030                           ADD 1          TO PV-BC-3-RANGE-VALUE  08803018
088040                        END-IF                                    08804018
088050                   WHEN PC-04                                     08805018
088060                        MOVE PV-ML-BC-4   TO PC165-3OF9-BC        08806018
088070                        IF PV-BC-4-RANGE-VALUE =                  08807018
088080                           PC140-ML-END-RANGE-NBR                 08808018
088090                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08809018
088100                                        PV-BC-4-RANGE-VALUE       08810018
088110                        ELSE                                      08811018
088120                           ADD 1          TO PV-BC-4-RANGE-VALUE  08812018
088130                        END-IF                                    08813018
088140                   WHEN PC-05                                     08814018
088150                        MOVE PV-ML-BC-5   TO PC165-3OF9-BC        08815018
088160                        IF PV-BC-5-RANGE-VALUE =                  08816018
088170                           PC140-ML-END-RANGE-NBR                 08817018
088180                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08818018
088190                                        PV-BC-5-RANGE-VALUE       08819018
088200                        ELSE                                      08820018
088210                           ADD 1          TO PV-BC-5-RANGE-VALUE  08821018
088220                        END-IF                                    08822018
088230                   WHEN PC-06                                     08823018
088240                        MOVE PV-ML-BC-6   TO PC165-3OF9-BC        08824018
088250                        IF PV-BC-6-RANGE-VALUE =                  08825018
088260                           PC140-ML-END-RANGE-NBR                 08826018
088270                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08827018
088280                                        PV-BC-6-RANGE-VALUE       08828018
088290                        ELSE                                      08829018
088300                           ADD 1          TO PV-BC-6-RANGE-VALUE  08830018
088310                        END-IF                                    08831018
088320                   WHEN PC-07                                     08832018
088330                        MOVE PV-ML-BC-7   TO PC165-3OF9-BC        08833018
088340                        IF PV-BC-7-RANGE-VALUE =                  08834018
088350                           PC140-ML-END-RANGE-NBR                 08835018
088360                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08836018
088370                                        PV-BC-7-RANGE-VALUE       08837018
088380                        ELSE                                      08838018
088390                           ADD 1          TO PV-BC-7-RANGE-VALUE  08839018
088400                        END-IF                                    08840018
088410                   WHEN PC-08                                     08841018
088420                        MOVE PV-ML-BC-8   TO PC165-3OF9-BC        08842018
088430                        IF PV-BC-8-RANGE-VALUE =                  08843018
088440                           PC140-ML-END-RANGE-NBR                 08844018
088450                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08845018
088460                                        PV-BC-8-RANGE-VALUE       08846018
088470                        ELSE                                      08847018
088480                           ADD 1          TO PV-BC-8-RANGE-VALUE  08848018
088490                        END-IF                                    08849018
088500                   WHEN PC-09                                     08850018
088510                        MOVE PV-ML-BC-9   TO PC165-3OF9-BC        08851018
088520                        IF PV-BC-9-RANGE-VALUE =                  08852018
088530                           PC140-ML-END-RANGE-NBR                 08853018
088540                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08854018
088550                                        PV-BC-9-RANGE-VALUE       08855018
088560                        ELSE                                      08856018
088570                           ADD 1          TO PV-BC-9-RANGE-VALUE  08857018
088580                        END-IF                                    08858018
088590               END-EVALUATE                                       08859018
088600               IF PC140-COMMON-MISC-LBL-NBR                       08860018
088610                 PERFORM 4535-MISC-DTL-LABEL                      08861018
088620                    VARYING PC165-IDX FROM 1 BY 1                 08862018
088630                      UNTIL PC165-IDX                             08863018
088640                            > PC165-MAX-LABEL-LINES               08864018
088650                                  OR PS-SOCKET-ERROR              08865018
088660               ELSE                                               08866018
088670                 PERFORM 4537-MISC-DTL-LABEL-MSG                  08867018
088680                    VARYING PC191-IDX FROM 1 BY 1                 08868018
088690                      UNTIL PC191-IDX                             08869018
088700                            > PC191-MAX-LABEL-LINES               08870018
088710                                  OR PS-SOCKET-ERROR              08871018
088720               END-IF                                             08872018
088730               ADD 1 TO PV-HR-13-RANGE-VALUE                      08873018
088740          WHEN PC-14                                              08874018
088750               MOVE PV-ML-HR-14    TO PC165-3OF9-BC-NBR           08875018
088760                                      PC191-3OF9-BC-NBR           08876018
088770               EVALUATE PC140-ML-BEGIN-RANGE-POSN-BC              08877018
088780                   WHEN PC-01                                     08878018
088790                        MOVE PV-ML-BC-1   TO PC165-3OF9-BC        08879018
088800                        IF PV-BC-1-RANGE-VALUE =                  08880018
088810                           PC140-ML-END-RANGE-NBR                 08881018
088820                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08882018
088830                                        PV-BC-1-RANGE-VALUE       08883018
088840                        ELSE                                      08884018
088850                           ADD 1          TO PV-BC-1-RANGE-VALUE  08885018
088860                        END-IF                                    08886018
088870                   WHEN PC-02                                     08887018
088880                        MOVE PV-ML-BC-2   TO PC165-3OF9-BC        08888018
088890                        IF PV-BC-2-RANGE-VALUE =                  08889018
088900                           PC140-ML-END-RANGE-NBR                 08890018
088910                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08891018
088920                                        PV-BC-2-RANGE-VALUE       08892018
088930                        ELSE                                      08893018
088940                           ADD 1          TO PV-BC-2-RANGE-VALUE  08894018
088950                        END-IF                                    08895018
088960                   WHEN PC-03                                     08896018
088970                        MOVE PV-ML-BC-3   TO PC165-3OF9-BC        08897018
088980                        IF PV-BC-3-RANGE-VALUE =                  08898018
088990                           PC140-ML-END-RANGE-NBR                 08899018
089000                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08900018
089010                                        PV-BC-3-RANGE-VALUE       08901018
089020                        ELSE                                      08902018
089030                           ADD 1          TO PV-BC-3-RANGE-VALUE  08903018
089040                        END-IF                                    08904018
089050                   WHEN PC-04                                     08905018
089060                        MOVE PV-ML-BC-4   TO PC165-3OF9-BC        08906018
089070                        IF PV-BC-4-RANGE-VALUE =                  08907018
089080                           PC140-ML-END-RANGE-NBR                 08908018
089090                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08909018
089100                                        PV-BC-4-RANGE-VALUE       08910018
089110                        ELSE                                      08911018
089120                           ADD 1          TO PV-BC-4-RANGE-VALUE  08912018
089130                        END-IF                                    08913018
089140                   WHEN PC-05                                     08914018
089150                        MOVE PV-ML-BC-5   TO PC165-3OF9-BC        08915018
089160                        IF PV-BC-5-RANGE-VALUE =                  08916018
089170                           PC140-ML-END-RANGE-NBR                 08917018
089180                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08918018
089190                                        PV-BC-5-RANGE-VALUE       08919018
089200                        ELSE                                      08920018
089210                           ADD 1          TO PV-BC-5-RANGE-VALUE  08921018
089220                        END-IF                                    08922018
089230                   WHEN PC-06                                     08923018
089240                        MOVE PV-ML-BC-6   TO PC165-3OF9-BC        08924018
089250                        IF PV-BC-6-RANGE-VALUE =                  08925018
089260                           PC140-ML-END-RANGE-NBR                 08926018
089270                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08927018
089280                                        PV-BC-6-RANGE-VALUE       08928018
089290                        ELSE                                      08929018
089300                           ADD 1          TO PV-BC-6-RANGE-VALUE  08930018
089310                        END-IF                                    08931018
089320                   WHEN PC-07                                     08932018
089330                        MOVE PV-ML-BC-7   TO PC165-3OF9-BC        08933018
089340                        IF PV-BC-7-RANGE-VALUE =                  08934018
089350                           PC140-ML-END-RANGE-NBR                 08935018
089360                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08936018
089370                                        PV-BC-7-RANGE-VALUE       08937018
089380                        ELSE                                      08938018
089390                           ADD 1          TO PV-BC-7-RANGE-VALUE  08939018
089400                        END-IF                                    08940018
089410                   WHEN PC-08                                     08941018
089420                        MOVE PV-ML-BC-8   TO PC165-3OF9-BC        08942018
089430                        IF PV-BC-8-RANGE-VALUE =                  08943018
089440                           PC140-ML-END-RANGE-NBR                 08944018
089450                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08945018
089460                                        PV-BC-8-RANGE-VALUE       08946018
089470                        ELSE                                      08947018
089480                           ADD 1          TO PV-BC-8-RANGE-VALUE  08948018
089490                        END-IF                                    08949018
089500                   WHEN PC-09                                     08950018
089510                        MOVE PV-ML-BC-9   TO PC165-3OF9-BC        08951018
089520                        IF PV-BC-9-RANGE-VALUE =                  08952018
089530                           PC140-ML-END-RANGE-NBR                 08953018
089540                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08954018
089550                                        PV-BC-9-RANGE-VALUE       08955018
089560                        ELSE                                      08956018
089570                           ADD 1          TO PV-BC-9-RANGE-VALUE  08957018
089580                        END-IF                                    08958018
089590               END-EVALUATE                                       08959018
089600               IF PC140-COMMON-MISC-LBL-NBR                       08960018
089610                 PERFORM 4535-MISC-DTL-LABEL                      08961018
089620                    VARYING PC165-IDX FROM 1 BY 1                 08962018
089630                      UNTIL PC165-IDX                             08963018
089640                            > PC165-MAX-LABEL-LINES               08964018
089650                                  OR PS-SOCKET-ERROR              08965018
089660               ELSE                                               08966018
089670                 PERFORM 4537-MISC-DTL-LABEL-MSG                  08967018
089680                    VARYING PC191-IDX FROM 1 BY 1                 08968018
089690                      UNTIL PC191-IDX                             08969018
089700                            > PC191-MAX-LABEL-LINES               08970018
089710                                  OR PS-SOCKET-ERROR              08971018
089720               END-IF                                             08972018
089730               ADD 1 TO PV-HR-14-RANGE-VALUE                      08973018
089740          WHEN PC-15                                              08974018
089750               MOVE PV-ML-HR-15    TO PC165-3OF9-BC-NBR           08975018
089760                                      PC191-3OF9-BC-NBR           08976018
089770               EVALUATE PC140-ML-BEGIN-RANGE-POSN-BC              08977018
089780                   WHEN PC-01                                     08978018
089790                        MOVE PV-ML-BC-1   TO PC165-3OF9-BC        08979018
089800                        IF PV-BC-1-RANGE-VALUE =                  08980018
089810                           PC140-ML-END-RANGE-NBR                 08981018
089820                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08982018
089830                                        PV-BC-1-RANGE-VALUE       08983018
089840                        ELSE                                      08984018
089850                           ADD 1          TO PV-BC-1-RANGE-VALUE  08985018
089860                        END-IF                                    08986018
089870                   WHEN PC-02                                     08987018
089880                        MOVE PV-ML-BC-2   TO PC165-3OF9-BC        08988018
089890                        IF PV-BC-2-RANGE-VALUE =                  08989018
089900                           PC140-ML-END-RANGE-NBR                 08990018
089910                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       08991018
089920                                        PV-BC-2-RANGE-VALUE       08992018
089930                        ELSE                                      08993018
089940                           ADD 1          TO PV-BC-2-RANGE-VALUE  08994018
089950                        END-IF                                    08995018
089960                   WHEN PC-03                                     08996018
089970                        MOVE PV-ML-BC-3   TO PC165-3OF9-BC        08997018
089980                        IF PV-BC-3-RANGE-VALUE =                  08998018
089990                           PC140-ML-END-RANGE-NBR                 08999018
090000                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       09000018
090010                                        PV-BC-3-RANGE-VALUE       09001018
090020                        ELSE                                      09002018
090030                           ADD 1          TO PV-BC-3-RANGE-VALUE  09003018
090040                        END-IF                                    09004018
090050                   WHEN PC-04                                     09005018
090060                        MOVE PV-ML-BC-4   TO PC165-3OF9-BC        09006018
090070                        IF PV-BC-4-RANGE-VALUE =                  09007018
090080                           PC140-ML-END-RANGE-NBR                 09008018
090090                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       09009018
090100                                        PV-BC-4-RANGE-VALUE       09010018
090110                        ELSE                                      09011018
090120                           ADD 1          TO PV-BC-4-RANGE-VALUE  09012018
090130                        END-IF                                    09013018
090140                   WHEN PC-05                                     09014018
090150                        MOVE PV-ML-BC-5   TO PC165-3OF9-BC        09015018
090160                        IF PV-BC-5-RANGE-VALUE =                  09016018
090170                           PC140-ML-END-RANGE-NBR                 09017018
090180                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       09018018
090190                                        PV-BC-5-RANGE-VALUE       09019018
090200                        ELSE                                      09020018
090210                           ADD 1          TO PV-BC-5-RANGE-VALUE  09021018
090220                        END-IF                                    09022018
090230                   WHEN PC-06                                     09023018
090240                        MOVE PV-ML-BC-6   TO PC165-3OF9-BC        09024018
090250                        IF PV-BC-6-RANGE-VALUE =                  09025018
090260                           PC140-ML-END-RANGE-NBR                 09026018
090270                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       09027018
090280                                        PV-BC-6-RANGE-VALUE       09028018
090290                        ELSE                                      09029018
090300                           ADD 1          TO PV-BC-6-RANGE-VALUE  09030018
090310                        END-IF                                    09031018
090320                   WHEN PC-07                                     09032018
090330                        MOVE PV-ML-BC-7   TO PC165-3OF9-BC        09033018
090340                        IF PV-BC-7-RANGE-VALUE =                  09034018
090350                           PC140-ML-END-RANGE-NBR                 09035018
090360                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       09036018
090370                                        PV-BC-7-RANGE-VALUE       09037018
090380                        ELSE                                      09038018
090390                           ADD 1          TO PV-BC-7-RANGE-VALUE  09039018
090400                        END-IF                                    09040018
090410                   WHEN PC-08                                     09041018
090420                        MOVE PV-ML-BC-8   TO PC165-3OF9-BC        09042018
090430                        IF PV-BC-8-RANGE-VALUE =                  09043018
090440                           PC140-ML-END-RANGE-NBR                 09044018
090450                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       09045018
090460                                        PV-BC-8-RANGE-VALUE       09046018
090470                        ELSE                                      09047018
090480                           ADD 1          TO PV-BC-8-RANGE-VALUE  09048018
090490                        END-IF                                    09049018
090500                   WHEN PC-09                                     09050018
090510                        MOVE PV-ML-BC-9   TO PC165-3OF9-BC        09051018
090520                        IF PV-BC-9-RANGE-VALUE =                  09052018
090530                           PC140-ML-END-RANGE-NBR                 09053018
090540                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       09054018
090550                                        PV-BC-9-RANGE-VALUE       09055018
090560                        ELSE                                      09056018
090570                           ADD 1          TO PV-BC-9-RANGE-VALUE  09057018
090580                        END-IF                                    09058018
090590               END-EVALUATE                                       09059018
090600               IF PC140-COMMON-MISC-LBL-NBR                       09060018
090610                 PERFORM 4535-MISC-DTL-LABEL                      09061018
090620                    VARYING PC165-IDX FROM 1 BY 1                 09062018
090630                      UNTIL PC165-IDX                             09063018
090640                            > PC165-MAX-LABEL-LINES               09064018
090650                                  OR PS-SOCKET-ERROR              09065018
090660               ELSE                                               09066018
090670                 PERFORM 4537-MISC-DTL-LABEL-MSG                  09067018
090680                    VARYING PC191-IDX FROM 1 BY 1                 09068018
090690                      UNTIL PC191-IDX                             09069018
090700                            > PC191-MAX-LABEL-LINES               09070018
090710                                  OR PS-SOCKET-ERROR              09071018
090720               END-IF                                             09072018
090730               ADD 1 TO PV-HR-15-RANGE-VALUE                      09073018
090740          WHEN PC-16                                              09074018
090750               MOVE PV-ML-HR-16    TO PC165-3OF9-BC-NBR           09075018
090760                                      PC191-3OF9-BC-NBR           09076018
090770               EVALUATE PC140-ML-BEGIN-RANGE-POSN-BC              09077018
090780                   WHEN PC-01                                     09078018
090790                        MOVE PV-ML-BC-1   TO PC165-3OF9-BC        09079018
090800                        IF PV-BC-1-RANGE-VALUE =                  09080018
090810                           PC140-ML-END-RANGE-NBR                 09081018
090820                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       09082018
090830                                        PV-BC-1-RANGE-VALUE       09083018
090840                        ELSE                                      09084018
090850                           ADD 1          TO PV-BC-1-RANGE-VALUE  09085018
090860                        END-IF                                    09086018
090870                   WHEN PC-02                                     09087018
090880                        MOVE PV-ML-BC-2   TO PC165-3OF9-BC        09088018
090890                        IF PV-BC-2-RANGE-VALUE =                  09089018
090900                           PC140-ML-END-RANGE-NBR                 09090018
090910                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       09091018
090920                                        PV-BC-2-RANGE-VALUE       09092018
090930                        ELSE                                      09093018
090940                           ADD 1          TO PV-BC-2-RANGE-VALUE  09094018
090950                        END-IF                                    09095018
090960                   WHEN PC-03                                     09096018
090970                        MOVE PV-ML-BC-3   TO PC165-3OF9-BC        09097018
090980                        IF PV-BC-3-RANGE-VALUE =                  09098018
090990                           PC140-ML-END-RANGE-NBR                 09099018
091000                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       09100018
091010                                        PV-BC-3-RANGE-VALUE       09101018
091020                        ELSE                                      09102018
091030                           ADD 1          TO PV-BC-3-RANGE-VALUE  09103018
091040                        END-IF                                    09104018
091050                   WHEN PC-04                                     09105018
091060                        MOVE PV-ML-BC-4   TO PC165-3OF9-BC        09106018
091070                        IF PV-BC-4-RANGE-VALUE =                  09107018
091080                           PC140-ML-END-RANGE-NBR                 09108018
091090                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       09109018
091100                                        PV-BC-4-RANGE-VALUE       09110018
091110                        ELSE                                      09111018
091120                           ADD 1          TO PV-BC-4-RANGE-VALUE  09112018
091130                        END-IF                                    09113018
091140                   WHEN PC-05                                     09114018
091150                        MOVE PV-ML-BC-5   TO PC165-3OF9-BC        09115018
091160                        IF PV-BC-5-RANGE-VALUE =                  09116018
091170                           PC140-ML-END-RANGE-NBR                 09117018
091180                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       09118018
091190                                        PV-BC-5-RANGE-VALUE       09119018
091200                        ELSE                                      09120018
091210                           ADD 1          TO PV-BC-5-RANGE-VALUE  09121018
091220                        END-IF                                    09122018
091230                   WHEN PC-06                                     09123018
091240                        MOVE PV-ML-BC-6   TO PC165-3OF9-BC        09124018
091250                        IF PV-BC-6-RANGE-VALUE =                  09125018
091260                           PC140-ML-END-RANGE-NBR                 09126018
091270                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       09127018
091280                                        PV-BC-6-RANGE-VALUE       09128018
091290                        ELSE                                      09129018
091300                           ADD 1          TO PV-BC-6-RANGE-VALUE  09130018
091310                        END-IF                                    09131018
091320                   WHEN PC-07                                     09132018
091330                        MOVE PV-ML-BC-7   TO PC165-3OF9-BC        09133018
091340                        IF PV-BC-7-RANGE-VALUE =                  09134018
091350                           PC140-ML-END-RANGE-NBR                 09135018
091360                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       09136018
091370                                        PV-BC-7-RANGE-VALUE       09137018
091380                        ELSE                                      09138018
091390                           ADD 1          TO PV-BC-7-RANGE-VALUE  09139018
091400                        END-IF                                    09140018
091410                   WHEN PC-08                                     09141018
091420                        MOVE PV-ML-BC-8   TO PC165-3OF9-BC        09142018
091430                        IF PV-BC-8-RANGE-VALUE =                  09143018
091440                           PC140-ML-END-RANGE-NBR                 09144018
091450                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       09145018
091460                                        PV-BC-8-RANGE-VALUE       09146018
091470                        ELSE                                      09147018
091480                           ADD 1          TO PV-BC-8-RANGE-VALUE  09148018
091490                        END-IF                                    09149018
091500                   WHEN PC-09                                     09150018
091510                        MOVE PV-ML-BC-9   TO PC165-3OF9-BC        09151018
091520                        IF PV-BC-9-RANGE-VALUE =                  09152018
091530                           PC140-ML-END-RANGE-NBR                 09153018
091540                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       09154018
091550                                        PV-BC-9-RANGE-VALUE       09155018
091560                        ELSE                                      09156018
091570                           ADD 1          TO PV-BC-9-RANGE-VALUE  09157018
091580                        END-IF                                    09158018
091590               END-EVALUATE                                       09159018
091600               IF PC140-COMMON-MISC-LBL-NBR                       09160018
091610                 PERFORM 4535-MISC-DTL-LABEL                      09161018
091620                    VARYING PC165-IDX FROM 1 BY 1                 09162018
091630                      UNTIL PC165-IDX                             09163018
091640                            > PC165-MAX-LABEL-LINES               09164018
091650                                  OR PS-SOCKET-ERROR              09165018
091660               ELSE                                               09166018
091670                 PERFORM 4537-MISC-DTL-LABEL-MSG                  09167018
091680                    VARYING PC191-IDX FROM 1 BY 1                 09168018
091690                      UNTIL PC191-IDX                             09169018
091700                            > PC191-MAX-LABEL-LINES               09170018
091710                                  OR PS-SOCKET-ERROR              09171018
091720               END-IF                                             09172018
091730               ADD 1 TO PV-HR-16-RANGE-VALUE                      09173018
091740          WHEN PC-17                                              09174018
091750               MOVE PV-ML-HR-17    TO PC165-3OF9-BC-NBR           09175018
091760                                      PC191-3OF9-BC-NBR           09176018
091770               EVALUATE PC140-ML-BEGIN-RANGE-POSN-BC              09177018
091780                   WHEN PC-01                                     09178018
091790                        MOVE PV-ML-BC-1   TO PC165-3OF9-BC        09179018
091800                        IF PV-BC-1-RANGE-VALUE =                  09180018
091810                           PC140-ML-END-RANGE-NBR                 09181018
091820                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       09182018
091830                                        PV-BC-1-RANGE-VALUE       09183018
091840                        ELSE                                      09184018
091850                           ADD 1          TO PV-BC-1-RANGE-VALUE  09185018
091860                        END-IF                                    09186018
091870                   WHEN PC-02                                     09187018
091880                        MOVE PV-ML-BC-2   TO PC165-3OF9-BC        09188018
091890                        IF PV-BC-2-RANGE-VALUE =                  09189018
091900                           PC140-ML-END-RANGE-NBR                 09190018
091910                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       09191018
091920                                        PV-BC-2-RANGE-VALUE       09192018
091930                        ELSE                                      09193018
091940                           ADD 1          TO PV-BC-2-RANGE-VALUE  09194018
091950                        END-IF                                    09195018
091960                   WHEN PC-03                                     09196018
091970                        MOVE PV-ML-BC-3   TO PC165-3OF9-BC        09197018
091980                        IF PV-BC-3-RANGE-VALUE =                  09198018
091990                           PC140-ML-END-RANGE-NBR                 09199018
092000                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       09200018
092010                                        PV-BC-3-RANGE-VALUE       09201018
092020                        ELSE                                      09202018
092030                           ADD 1          TO PV-BC-3-RANGE-VALUE  09203018
092040                        END-IF                                    09204018
092050                   WHEN PC-04                                     09205018
092060                        MOVE PV-ML-BC-4   TO PC165-3OF9-BC        09206018
092070                        IF PV-BC-4-RANGE-VALUE =                  09207018
092080                           PC140-ML-END-RANGE-NBR                 09208018
092090                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       09209018
092100                                        PV-BC-4-RANGE-VALUE       09210018
092110                        ELSE                                      09211018
092120                           ADD 1          TO PV-BC-4-RANGE-VALUE  09212018
092130                        END-IF                                    09213018
092140                   WHEN PC-05                                     09214018
092150                        MOVE PV-ML-BC-5   TO PC165-3OF9-BC        09215018
092160                        IF PV-BC-5-RANGE-VALUE =                  09216018
092170                           PC140-ML-END-RANGE-NBR                 09217018
092180                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       09218018
092190                                        PV-BC-5-RANGE-VALUE       09219018
092200                        ELSE                                      09220018
092210                           ADD 1          TO PV-BC-5-RANGE-VALUE  09221018
092220                        END-IF                                    09222018
092230                   WHEN PC-06                                     09223018
092240                        MOVE PV-ML-BC-6   TO PC165-3OF9-BC        09224018
092250                        IF PV-BC-6-RANGE-VALUE =                  09225018
092260                           PC140-ML-END-RANGE-NBR                 09226018
092270                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       09227018
092280                                        PV-BC-6-RANGE-VALUE       09228018
092290                        ELSE                                      09229018
092300                           ADD 1          TO PV-BC-6-RANGE-VALUE  09230018
092310                        END-IF                                    09231018
092320                   WHEN PC-07                                     09232018
092330                        MOVE PV-ML-BC-7   TO PC165-3OF9-BC        09233018
092340                        IF PV-BC-7-RANGE-VALUE =                  09234018
092350                           PC140-ML-END-RANGE-NBR                 09235018
092360                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       09236018
092370                                        PV-BC-7-RANGE-VALUE       09237018
092380                        ELSE                                      09238018
092390                           ADD 1          TO PV-BC-7-RANGE-VALUE  09239018
092400                        END-IF                                    09240018
092410                   WHEN PC-08                                     09241018
092420                        MOVE PV-ML-BC-8   TO PC165-3OF9-BC        09242018
092430                        IF PV-BC-8-RANGE-VALUE =                  09243018
092440                           PC140-ML-END-RANGE-NBR                 09244018
092450                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       09245018
092460                                        PV-BC-8-RANGE-VALUE       09246018
092470                        ELSE                                      09247018
092480                           ADD 1          TO PV-BC-8-RANGE-VALUE  09248018
092490                        END-IF                                    09249018
092500                   WHEN PC-09                                     09250018
092510                        MOVE PV-ML-BC-9   TO PC165-3OF9-BC        09251018
092520                        IF PV-BC-9-RANGE-VALUE =                  09252018
092530                           PC140-ML-END-RANGE-NBR                 09253018
092540                           MOVE PC140-ML-BEGIN-RANGE-NBR TO       09254018
092550                                        PV-BC-9-RANGE-VALUE       09255018
092560                        ELSE                                      09256018
092570                           ADD 1          TO PV-BC-9-RANGE-VALUE  09257018
092580                        END-IF                                    09258018
092590               END-EVALUATE                                       09259018
092600               IF PC140-COMMON-MISC-LBL-NBR                       09260018
092610                 PERFORM 4535-MISC-DTL-LABEL                      09261018
092620                    VARYING PC165-IDX FROM 1 BY 1                 09262018
092630                      UNTIL PC165-IDX                             09263018
092640                            > PC165-MAX-LABEL-LINES               09264018
092650                                  OR PS-SOCKET-ERROR              09265018
092660               ELSE                                               09266018
092670                 PERFORM 4537-MISC-DTL-LABEL-MSG                  09267018
092680                    VARYING PC191-IDX FROM 1 BY 1                 09268018
092690                      UNTIL PC191-IDX                             09269018
092700                            > PC191-MAX-LABEL-LINES               09270018
092710                                  OR PS-SOCKET-ERROR              09271018
092720               END-IF                                             09272018
092730      END-EVALUATE.                                               09273018
092740                                                                  09274018
092750*----------------------------------------------------------------*09275018
092760* SEND DETAIL - MISC LABEL                                       *09276018
092770* THE EXECUTION OF 3636-FORMAT-BARCODE IS NECESSARY AGAIN HERE   *09277018
092780* BECAUSE THE VARIABLE-SIZED NEEDS TO BE SENT TO THE SOCKET.     *09278018
092790*----------------------------------------------------------------*09279018
092800 4535-MISC-DTL-LABEL.                                             09280018
092810     STRING                                                       09281018
092820            ' 4535-MISC-DTL-LABEL'                                09282018
092830     DELIMITED BY SIZE                                            09283018
092840     INTO PV-CICS-MSG-AREA                                        09284018
092850     PERFORM 9990-WRITE-CICS                                      09285018
092860                                                                  09286018
092870     MOVE PC165-3OF9-BC               TO WS-MISC.                 09287018
092880     PERFORM 3636-FORMAT-BARCODE.                                 09288018
092890                                                                  09289018
092900     SET  PC133-LABEL-DTL           TO  TRUE.                     09290018
092910     MOVE PV-LPMS-TRANS-ID          TO  PC133-DTL-TRANS-ID.       09291018
092920     SET  PC165-IDX-2               TO  PC165-IDX.                09292018
092930     MOVE PC165-MISC-DATA-LINE-LENGTH (PC165-IDX-2)               09293018
092940                                    TO  PC133-DTL-LENGTH.         09294018
092950     MOVE PC165-MISC-LABEL-LINE (PC165-IDX)                       09295018
092960                                    TO  PC133-DTL-DATA.           09296018
092970                                                                  09297018
092980     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    09298018
092990         '' BY SPACES.                                           09299018
093000     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    09300018
093010         ';' BY SPACES.                                           09301018
093020     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    09302018
093030         LOW-VALUES BY SPACES.                                    09303018
093040                                                                  09304018
093050******************************************************************09305018
093060* LENGTH CALCULATION:                                            *09306018
093070*       LINE LENGTH ML  DATA     (PC165-MISC-DATA-LINE-LENGTH)   *09307018
093080*       20  =  PC133-RECORD-TYPE (LD)  (2 POSITIONS)             *09308018
093090*              PC133-DTL-TRANS-ID      (8 POSITIONS)             *09309018
093100*              PC133-DTL-LENGTH        (3 POSITIONS)             *09310018
093110*              HEX 03-END EACH DTL REC (1 POSITIONS)             *09311018
093120*              FILLER                  (6 POSITIONS)             *09312018
093130******************************************************************09313018
093140     MOVE ZEROES                  TO PC133-DTL-REC-LENGTH.        09314018
093150     MOVE PC165-MISC-DATA-LINE-LENGTH (PC165-IDX-2)               09315018
093160                                  TO PC133-DTL-REC-LENGTH.        09316018
093170     ADD  20                      TO PC133-DTL-REC-LENGTH.        09317018
093180     MOVE PC133-DTL-REC-LENGTH    TO DP081-TCPLENG                09318018
093190                                     DP081-NBR-BYTES.             09319018
093200                                                                  09320018
093210     PERFORM 5100-SEND-DATA-TO-LPMS.                              09321018
093220                                                                  09322018
093230     ADD  1  TO  PV-TRAILER-COUNT.                                09323018
093240                                                                  09324018
093250*----------------------------------------------------------------*09325018
093260*               MISC LABEL                                       *09326018
093270*----------------------------------------------------------------*09327018
093280 4536-SEND-MISC-DATA.                                             09328018
093290                                                                  09329018
093300     STRING                                                       09330018
093310            ' 4536-SEND-MISC-DATA'                                09331018
093320     DELIMITED BY SIZE                                            09332018
093330     INTO PV-CICS-MSG-AREA                                        09333018
093340     PERFORM 9990-WRITE-CICS                                      09334018
093350                                                                  09335018
093360            PERFORM 4535-MISC-DTL-LABEL                           09336018
093370               VARYING PC165-IDX FROM 1 BY 1                      09337018
093380                 UNTIL PC165-IDX                                  09338018
093390                       > PC165-MAX-LABEL-LINES                    09339018
093400                             OR PS-SOCKET-ERROR.                  09340018
093410                                                                  09341018
093420                                                                  09342018
093430*----------------------------------------------------------------*09343018
093440* SEND DETAIL - MISC LABEL                                       *09344018
093450* THE EXECUTION OF 3636-FORMAT-BARCODE IS NECESSARY AGAIN HERE   *09345018
093460* BECAUSE THE VARIABLE-SIZED NEEDS TO BE SENT TO THE SOCKET.     *09346018
093470*----------------------------------------------------------------*09347018
093480 4537-MISC-DTL-LABEL-MSG.                                         09348018
093490     STRING                                                       09349018
093500            ' 4537-MISC-DTL-LABEL-MSG'                            09350018
093510     DELIMITED BY SIZE                                            09351018
093520     INTO PV-CICS-MSG-AREA                                        09352018
093530     PERFORM 9990-WRITE-CICS                                      09353018
093540                                                                  09354018
093550     MOVE PC191-3OF9-BC-NBR           TO WS-MISC.                 09355018
093560     PERFORM 3636-FORMAT-BARCODE.                                 09356018
093570                                                                  09357018
093580     SET  PC133-LABEL-DTL           TO  TRUE.                     09358018
093590     MOVE PV-LPMS-TRANS-ID          TO  PC133-DTL-TRANS-ID.       09359018
093600     SET  PC191-IDX-2               TO  PC191-IDX.                09360018
093610     MOVE PC191-MISC-DATA-LINE-LENGTH (PC191-IDX-2)               09361018
093620                                    TO  PC133-DTL-LENGTH.         09362018
093630     MOVE PC191-MISC-LABEL-LINE (PC191-IDX)                       09363018
093640                                    TO  PC133-DTL-DATA.           09364018
093650                                                                  09365018
093660     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    09366018
093670         '' BY SPACES.                                           09367018
093680     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    09368018
093690         ';' BY SPACES.                                           09369018
093700     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    09370018
093710         LOW-VALUES BY SPACES.                                    09371018
093720                                                                  09372018
093730******************************************************************09373018
093740* LENGTH CALCULATION:                                            *09374018
093750*       LINE LENGTH ML  DATA     (PC191-MISC-DATA-LINE-LENGTH)   *09375018
093760*       20  =  PC133-RECORD-TYPE (LD)  (2 POSITIONS)             *09376018
093770*              PC133-DTL-TRANS-ID      (8 POSITIONS)             *09377018
093780*              PC133-DTL-LENGTH        (3 POSITIONS)             *09378018
093790*              HEX 03-END EACH DTL REC (1 POSITIONS)             *09379018
093800*              FILLER                  (6 POSITIONS)             *09380018
093810******************************************************************09381018
093820     MOVE ZEROES                  TO PC133-DTL-REC-LENGTH.        09382018
093830     MOVE PC191-MISC-DATA-LINE-LENGTH (PC191-IDX-2)               09383018
093840                                  TO PC133-DTL-REC-LENGTH.        09384018
093850     ADD  20                      TO PC133-DTL-REC-LENGTH.        09385018
093860     MOVE PC133-DTL-REC-LENGTH    TO DP081-TCPLENG                09386018
093870                                     DP081-NBR-BYTES.             09387018
093880                                                                  09388018
093890     PERFORM 5100-SEND-DATA-TO-LPMS.                              09389018
093900                                                                  09390018
093910     ADD  1  TO  PV-TRAILER-COUNT.                                09391018
093920                                                                  09392018
093930*----------------------------------------------------------------*09393018
093940*               MISC LABEL                                       *09394018
093950*----------------------------------------------------------------*09395018
093960 4538-SEND-MISC-DATA-MSG.                                         09396018
093970                                                                  09397018
093980     STRING                                                       09398018
093990            ' 4538-SEND-MISC-DATA-MSG'                            09399018
094000     DELIMITED BY SIZE                                            09400018
094010     INTO PV-CICS-MSG-AREA                                        09401018
094020     PERFORM 9990-WRITE-CICS                                      09402018
094030                                                                  09403018
094040            PERFORM 4537-MISC-DTL-LABEL-MSG                       09404018
094050               VARYING PC191-IDX FROM 1 BY 1                      09405018
094060                 UNTIL PC191-IDX                                  09406018
094070                       > PC191-MAX-LABEL-LINES                    09407018
094080                             OR PS-SOCKET-ERROR.                  09408018
094090                                                                  09409018
094100                                                                  09410018
094110*----------------------------------------------------------------*09411018
094120* PERFORM THE RANGE LOOP THE NUMBER OF TIMES INDICATED IN THE SET*09412018
094130*----------------------------------------------------------------*09413018
094140 4542-SETS-LOOP-RL.                                               09414018
094150                                                                  09415018
094160     STRING                                                       09416018
094170            ' 4542-SETS-LOOP-RL'                                  09417018
094180     DELIMITED BY SIZE                                            09418018
094190     INTO PV-CICS-MSG-AREA                                        09419018
094200     PERFORM 9990-WRITE-CICS                                      09420018
094210                                                                  09421018
094220     MOVE PC140-RL-TOT-LBLS         TO PV-SETS-SUB.               09422018
094230     MOVE PV-TOT-LABELS-IN-RANGE    TO PV-RANGE-SUB.              09423018
094240     PERFORM 4543-RANGE-LOOP-RL   PV-SETS-SUB    TIMES.           09424018
094250                                                                  09425018
094260*----------------------------------------------------------------*09426018
094270* SET THE BEGINNING RANGE VALUE TO THAT INDICATED BY USER        *09427018
094280* THEN INCREMENT IT.                                             *09428018
094290*----------------------------------------------------------------*09429018
094300 4543-RANGE-LOOP-RL.                                              09430018
094310                                                                  09431018
094320     STRING                                                       09432018
094330            ' 4543-RANGE-LOOP-RL'                                 09433018
094340     DELIMITED BY SIZE                                            09434018
094350     INTO PV-CICS-MSG-AREA                                        09435018
094360     PERFORM 9990-WRITE-CICS                                      09436018
094370                                                                  09437018
094380     MOVE PC140-RL-BEGIN-RANGE-NBR TO PV-RL-HR-SLOT-VALUE         09438018
094390                                      PV-RL-BC-SLOT-VALUE.        09439018
094400     PERFORM 4544-ADJUST-RANGE-NBRS-RL     PV-RANGE-SUB TIMES.    09440018
094410                                                                  09441018
094420*----------------------------------------------------------------*09442018
094430* INCREMENT THE VARIABLE RANGE OF BOTH HR AND BARCODE PORTION    *09443018
094440* OF TEXT. SEND THE "DATA" PART OF THE LABEL TO THE SOCKET.      *09444018
094450*----------------------------------------------------------------*09445018
094460 4544-ADJUST-RANGE-NBRS-RL.                                       09446018
094470                                                                  09447018
094480     STRING                                                       09448018
094490            ' 4544-ADJUST-RANGE-NBRS-RL'                          09449018
094500     DELIMITED BY SIZE                                            09450018
094510     INTO PV-CICS-MSG-AREA                                        09451018
094520     PERFORM 9990-WRITE-CICS                                      09452018
094530                                                                  09453018
094540     MOVE PV-RL-HR       TO PC168-3OF9-BC-NBR.                    09454018
094550     MOVE PV-RL-BC       TO PC168-3OF9-BC.                        09455018
094560     IF PV-RL-BC-SLOT-VALUE = PC140-RL-END-RANGE-NBR              09456018
094570        MOVE PC140-RL-BEGIN-RANGE-NBR                             09457018
094580                         TO PV-RL-BC-SLOT-VALUE                   09458018
094590     ELSE                                                         09459018
094600        ADD 1            TO PV-RL-BC-SLOT-VALUE                   09460018
094610     END-IF.                                                      09461018
094620                                                                  09462018
094630     PERFORM 4545-RACK-DTL-LABEL                                  09463018
094640        VARYING PC168-IDX FROM 1 BY 1                             09464018
094650          UNTIL PC168-IDX                                         09465018
094660                > PC168-MAX-LABEL-LINES                           09466018
094670                      OR PS-SOCKET-ERROR.                         09467018
094680                                                                  09468018
094690     ADD 1               TO PV-RL-HR-SLOT-VALUE.                  09469018
094700                                                                  09470018
094710*----------------------------------------------------------------*09471018
094720* SEND DETAIL - RACK LABEL                                       *09472018
094730*----------------------------------------------------------------*09473018
094740 4545-RACK-DTL-LABEL.                                             09474018
094750                                                                  09475018
094760     STRING                                                       09476018
094770            ' 4545-RACK-DTL-LABEL'                                09477018
094780     DELIMITED BY SIZE                                            09478018
094790     INTO PV-CICS-MSG-AREA                                        09479018
094800     PERFORM 9990-WRITE-CICS                                      09480018
094810                                                                  09481018
094820     SET  PC133-LABEL-DTL           TO  TRUE.                     09482018
094830     MOVE PV-LPMS-TRANS-ID          TO  PC133-DTL-TRANS-ID.       09483018
094840     SET  PC168-IDX-2               TO  PC168-IDX.                09484018
094850     MOVE PC168-RACK-DATA-LINE-LENGTH (PC168-IDX-2)               09485018
094860                                    TO  PC133-DTL-LENGTH.         09486018
094870     MOVE PC168-RACK-LABEL-LINE (PC168-IDX)                       09487018
094880                                    TO  PC133-DTL-DATA.           09488018
094890                                                                  09489018
094900     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    09490018
094910         '' BY SPACES.                                           09491018
094920     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    09492018
094930         ';' BY SPACES.                                           09493018
094940     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    09494018
094950         LOW-VALUES BY SPACES.                                    09495018
094960                                                                  09496018
094970******************************************************************09497018
094980* LENGTH CALCULATION:                                            *09498018
094990*       LINE LENGTH RL  DATA     (PC165-RACK-DATA-LINE-LENGTH)   *09499018
095000*       20  =  PC133-RECORD-TYPE (LD)  (2 POSITIONS)             *09500018
095010*              PC133-DTL-TRANS-ID      (8 POSITIONS)             *09501018
095020*              PC133-DTL-LENGTH        (3 POSITIONS)             *09502018
095030*              HEX 03-END EACH DTL REC (1 POSITIONS)             *09503018
095040*              FILLER                  (6 POSITIONS)             *09504018
095050******************************************************************09505018
095060     MOVE ZEROES                  TO PC133-DTL-REC-LENGTH.        09506018
095070     MOVE PC168-RACK-DATA-LINE-LENGTH (PC168-IDX-2)               09507018
095080                                  TO PC133-DTL-REC-LENGTH.        09508018
095090     ADD  20                      TO PC133-DTL-REC-LENGTH.        09509018
095100     MOVE PC133-DTL-REC-LENGTH    TO DP081-TCPLENG                09510018
095110                                     DP081-NBR-BYTES.             09511018
095120                                                                  09512018
095130     PERFORM 5100-SEND-DATA-TO-LPMS.                              09513018
095140                                                                  09514018
095150     ADD  1  TO  PV-TRAILER-COUNT.                                09515018
095160                                                                  09516018
095170*----------------------------------------------------------------*09517018
095180*               RACK LABEL                                       *09518018
095190*----------------------------------------------------------------*09519018
095200 4546-SEND-RACK-DATA.                                             09520018
095210                                                                  09521018
095220     STRING                                                       09522018
095230            ' 4546-SEND-RACK-DATA'                                09523018
095240     DELIMITED BY SIZE                                            09524018
095250     INTO PV-CICS-MSG-AREA                                        09525018
095260     PERFORM 9990-WRITE-CICS                                      09526018
095270                                                                  09527018
095280            PERFORM 4545-RACK-DTL-LABEL                           09528018
095290               VARYING PC168-IDX FROM 1 BY 1                      09529018
095300                 UNTIL PC168-IDX                                  09530018
095310                       > PC168-MAX-LABEL-LINES                    09531018
095320                             OR PS-SOCKET-ERROR.                  09532018
095330                                                                  09533018
095340*----------------------------------------------------------------*09534018
095350*  BLIND RECEIPT LABEL                                            09535018
095360*----------------------------------------------------------------*09536018
095370 4550-BLIND-RECEIPT-DTL-LABEL.                                    09537018
095380     STRING                                                       09538018
095390            ' 4550-BLIND-RECEIPT-DTL-LABEL'                       09539018
095400     DELIMITED BY SIZE                                            09540018
095410     INTO PV-CICS-MSG-AREA                                        09541018
095420     PERFORM 9990-WRITE-CICS                                      09542018
095430                                                                  09543018
095440                                                                  09544018
095450     SET  PC133-LABEL-DTL           TO  TRUE.                     09545018
095460     MOVE PV-LPMS-TRANS-ID          TO  PC133-DTL-TRANS-ID.       09546018
095470     SET  PC189-IDX-2               TO  PC189-IDX.                09547018
095480     MOVE PC189-SML-DATA-LINE-LENGTH (PC189-IDX-2)                09548018
095490                                    TO  PC133-DTL-LENGTH.         09549018
095500     MOVE PC189-SML-LABEL-LINE (PC189-IDX)                        09550018
095510                                    TO  PC133-DTL-DATA.           09551018
095520                                                                  09552018
095530     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    09553018
095540         '' BY SPACES.                                           09554018
095550     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    09555018
095560         ';' BY SPACES.                                           09556018
095570     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    09557018
095580         LOW-VALUES BY SPACES.                                    09558018
095590                                                                  09559018
095600******************************************************************09560018
095610* LENGTH CALCULATION:                                            *09561018
095620*       LINE LENGTH BR  DATA     (PC189-SML-DATA-LINE-LENGTH)    *09562018
095630*       20  =  PC133-RECORD-TYPE (LD)  (2 POSITIONS)             *09563018
095640*              PC133-DTL-TRANS-ID      (8 POSITIONS)             *09564018
095650*              PC133-DTL-LENGTH        (3 POSITIONS)             *09565018
095660*              HEX 03-END EACH DTL REC (1 POSITIONS)             *09566018
095670*              FILLER                  (6 POSITIONS)             *09567018
095680******************************************************************09568018
095690     MOVE ZEROES                  TO PC133-DTL-REC-LENGTH.        09569018
095700     MOVE PC189-SML-DATA-LINE-LENGTH (PC189-IDX-2)                09570018
095710                                  TO PC133-DTL-REC-LENGTH.        09571018
095720     ADD  20                      TO PC133-DTL-REC-LENGTH.        09572018
095730     MOVE PC133-DTL-REC-LENGTH    TO DP081-TCPLENG                09573018
095740                                     DP081-NBR-BYTES.             09574018
095750                                                                  09575018
095760     PERFORM 5100-SEND-DATA-TO-LPMS.                              09576018
095770                                                                  09577018
095780     ADD  1  TO  PV-TRAILER-COUNT.                                09578018
095790                                                                  09579018
095800*----------------------------------------------------------------*09580018
095810*  TRAILER SERIAL LABEL                                           09581018
095820*----------------------------------------------------------------*09582018
095830 4560-TRAILER-SERIAL-DTL-LABEL.                                   09583018
095840                                                                  09584018
095850     STRING                                                       09585018
095860            ' 4560-TRAILER-SERIAL-DTL-LABEL'                      09586018
095870     DELIMITED BY SIZE                                            09587018
095880     INTO PV-CICS-MSG-AREA                                        09588018
095890     PERFORM 9990-WRITE-CICS                                      09589018
095900                                                                  09590018
095910     SET  PC133-LABEL-DTL           TO  TRUE.                     09591018
095920     MOVE PV-LPMS-TRANS-ID          TO  PC133-DTL-TRANS-ID.       09592018
095930     SET  PC197-IDX-2               TO  PC197-IDX.                09593018
095940     MOVE PC197-TLR-LINE-LENGTH  (PC197-IDX-2)                    09594018
095950                                    TO  PC133-DTL-LENGTH.         09595018
095960     MOVE PC197-TLR-LBL-DATA-LINE (PC197-IDX)                     09596018
095970                                    TO  PC133-DTL-DATA.           09597018
095980                                                                  09598018
095990     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    09599018
096000         '' BY SPACES.                                           09600018
096010     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    09601018
096020         ';' BY SPACES.                                           09602018
096030     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    09603018
096040         LOW-VALUES BY SPACES.                                    09604018
096050                                                                  09605018
096060******************************************************************09606018
096070* LENGTH CALCULATION:                                            *09607018
096080*       LINE LENGTH BR  DATA     (PC197-TLR-LINE-LENGTH)         *09608018
096090*       20  =  PC133-RECORD-TYPE (LD)  (2 POSITIONS)             *09609018
096100*              PC133-DTL-TRANS-ID      (8 POSITIONS)             *09610018
096110*              PC133-DTL-LENGTH        (3 POSITIONS)             *09611018
096120*              HEX 03-END EACH DTL REC (1 POSITIONS)             *09612018
096130*              FILLER                  (6 POSITIONS)             *09613018
096140******************************************************************09614018
096150     MOVE ZEROES                  TO PC133-DTL-REC-LENGTH.        09615018
096160     MOVE PC197-TLR-LINE-LENGTH (PC197-IDX-2)                     09616018
096170                                  TO PC133-DTL-REC-LENGTH.        09617018
096180     ADD  20                      TO PC133-DTL-REC-LENGTH.        09618018
096190     MOVE PC133-DTL-REC-LENGTH    TO DP081-TCPLENG                09619018
096200                                     DP081-NBR-BYTES.             09620018
096210                                                                  09621018
096220     PERFORM 5100-SEND-DATA-TO-LPMS.                              09622018
096230                                                                  09623018
096240     ADD  1  TO  PV-TRAILER-COUNT.                                09624018
096250                                                                  09625018
096260*----------------------------------------------------------------*09626018
096270*  RF BLIND RECEIPT DETAIL LABEL                                  09627018
096280*----------------------------------------------------------------*09628018
096290 4570-RF-BLIND-RCPT-DTL-LABEL.                                    09629018
096300     STRING ' 4570-RF-BLIND-RCPT-DTL-LABEL'                       09630018
096310     DELIMITED BY SIZE                                            09631018
096320     INTO PV-CICS-MSG-AREA                                        09632018
096330     PERFORM 9990-WRITE-CICS                                      09633018
096340                                                                  09634018
096350     SET  PC133-LABEL-DTL           TO  TRUE.                     09635018
096360     MOVE PV-LPMS-TRANS-ID          TO  PC133-DTL-TRANS-ID.       09636018
096370     SET  PC189-IDX-2               TO  PC189-IDX.                09637018
096380     MOVE PC189-SML-DATA-LINE-LENGTH (PC189-IDX-2)                09638018
096390                                    TO  PC133-DTL-LENGTH.         09639018
096400     MOVE PC189-SML-LABEL-LINE (PC189-IDX)                        09640018
096410                                    TO  PC133-DTL-DATA.           09641018
096420                                                                  09642018
096430     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    09643018
096440         '' BY SPACES.                                           09644018
096450     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    09645018
096460         ';' BY SPACES.                                           09646018
096470     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    09647018
096480         LOW-VALUES BY SPACES.                                    09648018
096490                                                                  09649018
096500******************************************************************09650018
096510* LENGTH CALCULATION:                                            *09651018
096520*       LINE LENGTH BR  DATA     (PC189-SML-DATA-LINE-LENGTH)    *09652018
096530*       20  =  PC133-RECORD-TYPE (LD)  (2 POSITIONS)             *09653018
096540*              PC133-DTL-TRANS-ID      (8 POSITIONS)             *09654018
096550*              PC133-DTL-LENGTH        (3 POSITIONS)             *09655018
096560*              HEX 03-END EACH DTL REC (1 POSITIONS)             *09656018
096570*              FILLER                  (6 POSITIONS)             *09657018
096580******************************************************************09658018
096590     MOVE ZEROES                  TO PC133-DTL-REC-LENGTH.        09659018
096600     MOVE PC189-SML-DATA-LINE-LENGTH (PC189-IDX-2)                09660018
096610                                  TO PC133-DTL-REC-LENGTH.        09661018
096620     ADD  20                      TO PC133-DTL-REC-LENGTH.        09662018
096630     MOVE PC133-DTL-REC-LENGTH    TO DP081-TCPLENG                09663018
096640                                     DP081-NBR-BYTES.             09664018
096650                                                                  09665018
096660     PERFORM 5100-SEND-DATA-TO-LPMS.                              09666018
096670                                                                  09667018
096680     ADD  1  TO  PV-TRAILER-COUNT.                                09668018
096690                                                                  09669018
096700*----------------------------------------------------------------*09670018
096710* RF CHECKIN SML LABEL DATA                                       09671018
096720*----------------------------------------------------------------*09672018
096730 4570A-RF-CHECKIN-SML-DTL-LABEL.                                  09673018
096740     SET  PC133-LABEL-DTL           TO  TRUE.                     09674018
096750     MOVE PV-LPMS-TRANS-ID          TO  PC133-DTL-TRANS-ID.       09675018
096760     SET  PC256-IDX-2               TO  PC256-IDX.                09676018
096770     MOVE PC256-DTL-DATA-LNE-LNGTH (PC256-IDX-2)                  09677018
096780                                    TO  PC133-DTL-LENGTH.         09678018
096790     MOVE PC256-SML-LABEL-LINE (PC256-IDX)                        09679018
096800                                    TO  PC133-DTL-DATA.           09680018
096810                                                                  09681018
096820     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    09682018
096830         '' BY SPACES.                                           09683018
096840     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    09684018
096850         ';' BY SPACES.                                           09685018
096860     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    09686018
096870         LOW-VALUES BY SPACES.                                    09687018
096880                                                                  09688018
096890******************************************************************09689018
096900* LENGTH CALCULATION:                                            *09690018
096910*       LINE LENGTH SML DATA     (PC256-DTL-DATA-LNE-LNGTH)      *09691018
096920*       20  =  PC133-RECORD-TYPE (LD)  (2 POSITIONS)             *09692018
096930*              PC133-DTL-TRANS-ID      (8 POSITIONS)             *09693018
096940*              PC133-DTL-LENGTH        (3 POSITIONS)             *09694018
096950*              HEX 03-END EACH DTL REC (1 POSITIONS)             *09695018
096960*              FILLER                  (6 POSITIONS)             *09696018
096970******************************************************************09697018
096980     MOVE ZEROES                  TO PC133-DTL-REC-LENGTH.        09698018
096990     MOVE PC256-DTL-DATA-LNE-LNGTH (PC256-IDX-2)                  09699018
097000                                  TO PC133-DTL-REC-LENGTH.        09700018
097010     ADD  20                      TO PC133-DTL-REC-LENGTH.        09701018
097020     MOVE PC133-DTL-REC-LENGTH    TO DP081-TCPLENG                09702018
097030                                     DP081-NBR-BYTES.             09703018
097040                                                                  09704018
097050     PERFORM 5100-SEND-DATA-TO-LPMS.                              09705018
097060                                                                  09706018
097070     ADD  1  TO  PV-TRAILER-COUNT.                                09707018
097080                                                                  09708029
097090*----------------------------------------------------------------*09709018
097100* RF GENERIC LABEL DATA                                           09710018
097110*----------------------------------------------------------------*09711018
097120 4570B-RF-GENERIC-SML-DTL-LABEL.                                  09712018
097130     SET  PC133-LABEL-DTL           TO  TRUE.                     09713018
097140     MOVE PV-LPMS-TRANS-ID          TO  PC133-DTL-TRANS-ID.       09714018
097150     SET  PC152-IDX-2               TO  PC152-IDX.                09715018
097160     MOVE PC152-SML-LINE-LENGTH (PC152-IDX-2)                     09716018
097170                                    TO  PC133-DTL-LENGTH.         09717018
097180     MOVE PC152-SML-LBL-DATA-LINE (PC152-IDX)                     09718018
097190                                    TO  PC133-DTL-DATA.           09719018
097200                                                                  09720018
097210     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    09721018
097220         '' BY SPACES.                                           09722018
097230     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    09723018
097240         ';' BY SPACES.                                           09724018
097250     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    09725018
097260         LOW-VALUES BY SPACES.                                    09726018
097270                                                                  09727018
097280******************************************************************09728018
097290* LENGTH CALCULATION:                                            *09729018
097300*       LINE LENGTH SML DATA     (PC152-SML-LINE-LENGTH)         *09730018
097310*       20  =  PC133-RECORD-TYPE (LD)  (2 POSITIONS)             *09731018
097320*              PC133-DTL-TRANS-ID      (8 POSITIONS)             *09732018
097330*              PC133-DTL-LENGTH        (3 POSITIONS)             *09733018
097340*              HEX 03-END EACH DTL REC (1 POSITIONS)             *09734018
097350*              FILLER                  (6 POSITIONS)             *09735018
097360******************************************************************09736018
097370     MOVE ZEROES                  TO PC133-DTL-REC-LENGTH.        09737018
097380     MOVE PC152-SML-LINE-LENGTH (PC152-IDX-2)                     09738018
097390                                  TO PC133-DTL-REC-LENGTH.        09739018
097400     ADD  20                      TO PC133-DTL-REC-LENGTH.        09740018
097410     MOVE PC133-DTL-REC-LENGTH    TO DP081-TCPLENG                09741018
097420                                     DP081-NBR-BYTES.             09742018
097430                                                                  09743018
097440     PERFORM 5100-SEND-DATA-TO-LPMS.                              09744018
097450                                                                  09745018
097460     ADD  1  TO  PV-TRAILER-COUNT.                                09746018
097470                                                                  09747029
097480*----------------------------------------------------------------*09748018
097490* RF CSEPK SML LABEL DATA                                         09749018
097500*----------------------------------------------------------------*09750018
097510 4570C-RF-CSEPK-SML-DTL-LABEL.                                    09751018
097520     SET  PC133-LABEL-DTL           TO  TRUE.                     09752018
097530     MOVE PV-LPMS-TRANS-ID          TO  PC133-DTL-TRANS-ID.       09753018
097540     SET  PC254-IDX-2               TO  PC254-IDX.                09754018
097550     MOVE PC254-SML-DATA-LINE-LENGTH (PC254-IDX-2)                09755018
097560                                    TO  PC133-DTL-LENGTH.         09756018
097570     MOVE PC254-SML-LABEL-LINE (PC254-IDX)                        09757018
097580                                    TO  PC133-DTL-DATA.           09758018
097590                                                                  09759018
097600     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    09760018
097610         '' BY SPACES.                                           09761018
097620     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    09762018
097630         ';' BY SPACES.                                           09763018
097640     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    09764018
097650         LOW-VALUES BY SPACES.                                    09765018
097660                                                                  09766018
097670******************************************************************09767018
097680* LENGTH CALCULATION:                                            *09768018
097690*       LINE LENGTH SML DATA     (PC254-SML-DATA-LINE-LENGTH)    *09769018
097700*       20  =  PC133-RECORD-TYPE (LD)  (2 POSITIONS)             *09770018
097710*              PC133-DTL-TRANS-ID      (8 POSITIONS)             *09771018
097720*              PC133-DTL-LENGTH        (3 POSITIONS)             *09772018
097730*              HEX 03-END EACH DTL REC (1 POSITIONS)             *09773018
097740*              FILLER                  (6 POSITIONS)             *09774018
097750******************************************************************09775018
097760     MOVE ZEROES                  TO PC133-DTL-REC-LENGTH.        09776018
097770     MOVE PC254-SML-DATA-LINE-LENGTH (PC254-IDX-2)                09777018
097780                                  TO PC133-DTL-REC-LENGTH.        09778018
097790     ADD  20                      TO PC133-DTL-REC-LENGTH.        09779018
097800     MOVE PC133-DTL-REC-LENGTH    TO DP081-TCPLENG                09780018
097810                                     DP081-NBR-BYTES.             09781018
097820                                                                  09782018
097830     PERFORM 5100-SEND-DATA-TO-LPMS.                              09783018
097840                                                                  09784018
097850     ADD  1  TO  PV-TRAILER-COUNT.                                09785018
098250                                                                  09825018
098251                                                                  09825118
098260*----------------------------------------------------------------*09826018
098270*    OPEN CURSOR - SML'S                                         *09827018
098280*----------------------------------------------------------------*09828018
098290 4655-OPEN-STORE-CSR.                                             09829018
098300     STRING                                                       09830018
098310            ' 4655-OPEN-STORE-CSR'                                09831018
098320            '-' PC140-PARM-SML-ORD                                09832018
098330     DELIMITED BY SIZE                                            09833018
098340     INTO PV-CICS-MSG-AREA                                        09834018
098350     PERFORM 9990-WRITE-CICS                                      09835018
098360                                                                  09836018
098370     MOVE PC140-CRA-LOC-ID      TO DK-OPER-UNT-ID-NUM-4.          09837018
098380                                                                  09838018
098400     IF  PC140-SML-P2L-ORDER                                      09840018
098410         EXEC SQL                                                 09841018
098420             OPEN OPEN-SML-P2L-CSR                                09842018
098430         END-EXEC                                                 09843018
098440     ELSE                                                         09844018
098441     IF  PC140-SML-P2L-SEPHORA-ORD                                09844127
098442         EXEC SQL                                                 09844227
098443             OPEN OPEN-P2L-SEPH-CSR                               09844327
098444         END-EXEC                                                 09844427
098445     ELSE                                                         09844527
098450     IF  PC140-SML-SHIP-DOOR-ORDER                                09845018
098460         EXEC SQL                                                 09846018
098470             OPEN OPEN-SML-DOOR-CSR                               09847018
098480         END-EXEC                                                 09848018
098490     ELSE                                                         09849018
098500         EXEC SQL                                                 09850018
098510             OPEN OPEN-SML-STR-CSR                                09851018
098520         END-EXEC                                                 09852018
098530     END-IF                                                       09853018
098531     END-IF                                                       09853127
098540     END-IF.                                                      09854018
098550                                                                  09855018
098600                                                                  09860018
098610     EVALUATE TRUE                                                09861018
098620         WHEN SQLCODE = ZERO                                      09862018
098630             CONTINUE                                             09863018
098640                                                                  09864018
098650         WHEN SQLWARN0 NOT = SPACES                               09865018
098660         WHEN SQLCODE < ZERO                                      09866018
098670         WHEN SQLCODE > ZERO                                      09867018
098680             SET  PS-SOCKET-ERROR         TO TRUE                 09868018
098690             SET  PC140-CRA-SOCKET-COMM-ERROR  TO TRUE            09869018
098700             STRING ' PCKCS707 - '                                09870018
098710             '4655-OPEN-STORE-CSR '                               09871018
098720             '-' PC140-PARM-SML-ORD  ' '                          09872018
098730             'SQLCODE:'                                           09873018
098740             SQLCA                 DELIMITED BY SIZE              09874018
098750                                      INTO PV-CICS-MSG-AREA       09875018
098760             SET PS-DUMP-TO-LOG       TO TRUE                     09876018
098770             PERFORM 9990-WRITE-CICS                              09877018
098780                                                                  09878018
098790     END-EVALUATE.                                                09879018
098800                                                                  09880018
098810*----------------------------------------------------------------*09881018
098820*    FETCH OPEN-STORE-CSR (SHIPPING LABEL)                       *09882018
098830*    FETCH OPEN-STORE-CSR (SML LABEL)                            *09883018
098840*----------------------------------------------------------------*09884018
098850 4665-SML-FETCH-STORE-CSR.                                        09885018
098860                                                                  09886018
098870     STRING                                                       09887018
098880            ' 4665-SML-FETCH-STORE-CSR'                           09888018
098890            '-' PC140-PARM-SML-ORD                                09889018
098900     DELIMITED BY SIZE                                            09890018
098910     INTO PV-CICS-MSG-AREA                                        09891018
098920     PERFORM 9990-WRITE-CICS                                      09892018
098930                                                                  09893018
098950     IF  PC140-SML-P2L-ORDER                                      09895018
098960         EXEC SQL                                                 09896018
098970              FETCH  OPEN-SML-P2L-CSR                             09897018
098980               INTO :PV-GENERIC-SML-UNION                         09898018
098990                  , :PV-GENERIC-SML-SEQ                           09899018
099000                  , :XLT00010-LOC-NBR                             09900018
099010                  , :XLT00010-LOC-10-ABBR-NM                      09901018
099020         END-EXEC                                                 09902018
099030     ELSE                                                         09903018
099031     IF  PC140-SML-P2L-SEPHORA-ORD                                09903127
099032         EXEC SQL                                                 09903227
099033              FETCH  OPEN-P2L-SEPH-CSR                            09903327
099034               INTO :PV-GENERIC-SML-UNION                         09903427
099035                  , :PV-GENERIC-SML-SEQ                           09903527
099036                  , :XLT00010-LOC-NBR                             09903627
099037                  , :XLT00010-LOC-10-ABBR-NM                      09903727
099041         END-EXEC                                                 09904127
099042     ELSE                                                         09904227
099043     IF  PC140-SML-SHIP-DOOR-ORDER                                09904318
099050         EXEC SQL                                                 09905018
099060              FETCH  OPEN-SML-DOOR-CSR                            09906018
099070               INTO :PV-GENERIC-SML-UNION                         09907018
099080                  , :XLT00010-LOC-NBR                             09908018
099090                  , :XLT00010-LOC-10-ABBR-NM                      09909018
099100                  , :CNDRST-DOOR-ID                               09910018
099110                  , :CNDCDR-DOOR-LBL-SEQ-NBR                      09911018
099120         END-EXEC                                                 09912018
099130     ELSE                                                         09913018
099140         EXEC SQL                                                 09914018
099150              FETCH  OPEN-SML-STR-CSR                             09915018
099160               INTO :XLT00010-LOC-NBR,                            09916018
099170                    :XLT00010-LOC-10-ABBR-NM                      09917018
099180         END-EXEC                                                 09918018
099190     END-IF                                                       09919018
099191     END-IF                                                       09919127
099200     END-IF.                                                      09920018
099210                                                                  09921018
099280                                                                  09928018
099290***************************************************************** 09929018
099300*    STRING ' PCKCS707 -'              DELIMITED BY SIZE          09930018
099310*           ' 4665-OPEN-STORE-CSR - '  DELIMITED BY SIZE          09931018
099320*           'SQL CODE IS - '           DELIMITED BY SIZE          09932018
099330*           SQLCA                      DELIMITED BY SIZE          09933018
099340*                                          INTO PV-CICS-MSG-AREA. 09934018
099350*        PERFORM 9990-WRITE-CICS.                                 09935018
099360***************************************************************** 09936018
099370                                                                  09937018
099380     EVALUATE TRUE                                                09938018
099390         WHEN SQLCODE = ZERO                                      09939018
099400             ADD  1  TO              PV-STORES-PROCESSED          09940018
099410                                                                  09941018
099420             MOVE XLT00010-LOC-NBR   TO PV-DISP-LOC               09942018
099430             MOVE PV-DISP-LOC        TO PC140-SML-STR-NBR         09943018
099440             MOVE XLT00010-LOC-10-ABBR-NM                         09944018
099450                                     TO PC140-SML-STR-NAME        09945018
099460                                        PC152-SML-DATA-STR-NME    09946018
099470                                                                  09947018
099480             MOVE PC140-SML-STR-NBR  TO PV-9999-X                 09948018
099490             MOVE PV-9999-N     TO PC160-20-SML-BC-DIVERT-CDE     09949018
099500                                   PC160-20-SML-NBR-BC-DIVERT-CDE 09950018
099520             MOVE PC140-SML-ORIGIN-DC                             09952018
099530                                TO PC160-20-SML-BC-DC-ORIGIN      09953018
099540                                   PC160-20-SML-NBR-BC-DC-ORIGIN  09954018
099560                                                                  09956018
099570                                                                  09957018
099580             MOVE PC140-SML-DIVERT-PFX                            09958018
099590                                TO PC160-20-SML-BC-DIVERT-PFX     09959018
099600                                   PC160-20-SML-NBR-BC-DIVERT-PFX 09960018
099610                                                                  09961018
099620             MOVE XLT00010-LOC-NBR     TO PC187-STR-NBR           09962018
099630             MOVE  PC140-SML-TOT-CART TO PC187-NO-OF-LBLS         09963018
099640                                                                  09964029
099660* INCREASE NUMBER OF LABELS REQUESTED BY 1 TO SKIP ONE            09966018
099670* TRYING TO RESOLVE PRINTER ISSUE CAUSING DUPLICATE LABELS        09967018
099690                ADD  1  TO  PC187-NO-OF-LBLS                      09969018
099710                                                                  09971029
099720             PERFORM 4850-LINK-PCKCS721                           09972018
099730             MOVE  PC187-START-MFST-NBR                           09973018
099740                                  TO PC140-SML-STRT-MFST-NBR      09974018
099750                                                                  09975029
099770* REDUCE BACK TO ORIGINAL REQUESTED AMOUNT                        09977018
099780* TRYING TO RESOLVE PRINTER ISSUE CAUSING DUPLICATE LABELS        09978018
099800                SUBTRACT  1  FROM  PC187-NO-OF-LBLS               09980018
099810                SUBTRACT  1  FROM  PC187-END-MFST-NBR             09981018
099820                                                                  09982029
099850*** if tracking SML Manifest number insert into tuplder           09985018
099870             IF  PC140-MFST-TRACK-YES                             09987018
099880                 PERFORM 4670-TRACK-MAINFEST                      09988018
099890             END-IF                                               09989018
099930                                                                  09993029
099940*** add commit after calling PCKCS721 Manifest number module      09994018
099960             EXEC CICS SYNCPOINT                                  09996018
099970                 END-EXEC                                         09997018
099980                                                                  09998018
100000             IF  PS-NOT-FIRST-PASS                                10000018
100010                 IF  PC140-SML-PRTR-PRODIGY-MAX                   10001018
100020                     CONTINUE                                     10002018
100030                 ELSE                                             10003018
100040                     SUBTRACT  1  FROM  PC140-SML-STRT-MFST-NBR   10004018
100050                 END-IF                                           10005018
100060             END-IF                                               10006018
100070             SET  PS-NOT-FIRST-PASS  TO  TRUE                     10007018
100090                                                                  10009018
100100             MOVE PC140-SML-STRT-MFST-NBR TO PV-PIC911            10010018
100110             MOVE PV-PIC911               TO PV-PIC907            10011018
100120             MOVE PV-PIC911               TO PV-PIC908            10012018
100130             MOVE PV-PIC908     TO PC160-20-SML-BC-MNFST-NBR      10013018
100140                                   PC160-20-SML-NBR-BC-MNFST-NBR  10014018
100150                                                                  10015018
100160             MOVE PV-9999-N          TO PC152-SML-DATA-STR-NBR    10016018
100170                                                                  10017018
100180             SET PC160-20-SML-NBR-INTERNAL-LBL                    10018018
100190                 PC160-20-SML-NBR-FROM-KOHLS                      10019018
100200                 PC160-20-SML-INTERNAL-LBL                        10020018
100210                 PC160-20-SML-FROM-KOHLS     TO TRUE              10021018
100220             MOVE ZEROES    TO PC160-20-SML-NBR-CONTAINER-CDE     10022018
100230             MOVE PC160-20-DIGIT-BARCODE     TO PC152-SML-DATA-BC 10023018
100240             MOVE PC160-20-DIGIT-BARCODE-NBR                      10024018
100250                            TO PC152-SML-DATA-BC-NBR              10025018
100260                                                                  10026018
100270             SET  PC133-LABEL-DTL            TO TRUE              10027018
100290             move '@@@@'    to  pc152-sml-data-door-id            10029018
100300             if  PC140-SML-SHIP-DOOR-ORDER                        10030018
100310                 move CNDRST-DOOR-ID                              10031018
100320                            to  pc152-sml-data-door-id            10032018
100330             else                                                 10033018
100340             if  PC140-DOOR-NOT-ON-LABEL                          10034018
100350                 continue                                         10035018
100360             else                                                 10036018
100370                 if  PC140-SML-SHIP-DOOR-ORDER                    10037018
100380                     move CNDRST-DOOR-ID                          10038018
100390                            to  pc152-sml-data-door-id            10039018
100400                 else                                             10040018
100410                     MOVE  XLT00010-LOC-NBR                       10041018
100420                                  TO  cndrst-str-nbr              10042018
100430                     MOVE  PC140-CRA-OPER-UNT-ID                  10043018
100440                                  to  CNDRST-OPER-UNT-ID          10044018
100450                     perform 4667-get-door-id                     10045018
100460                     move CNDRST-DOOR-ID                          10046018
100470                            to  pc152-sml-data-door-id            10047018
100480                  end-if                                          10048018
100490             end-if                                               10049018
100500             end-if                                               10050018
100520             PERFORM 4515-SML-DTL-LABEL                           10052018
100530                VARYING PC152-IDX FROM 1 BY 1                     10053018
100540                   UNTIL PC152-IDX > PC152-SML-LABEL-DATA-MAX-LN  10054018
100550                       OR PS-SOCKET-ERROR                         10055018
100560                                                                  10056018
100570         WHEN SQLCODE = +100                                      10057018
100580             SET PS-END-OF-STORE-CSR TO TRUE                      10058018
100590                                                                  10059018
100600         WHEN SQLWARN0 NOT = SPACES                               10060018
100610         WHEN SQLCODE < ZERO                                      10061018
100620         WHEN SQLCODE > ZERO                                      10062018
100630             SET  PS-SOCKET-ERROR         TO TRUE                 10063018
100640             SET  PC140-CRA-SOCKET-COMM-ERROR  TO TRUE            10064018
100650             STRING ' PCKCS707 - '                                10065018
100660             '4665-SML-FETCH-STORE-CSR'                           10066018
100670             '-' PC140-PARM-SML-ORD  ' '                          10067018
100680             'SQLCODE:'                                           10068018
100690             SQLCA                 DELIMITED BY SIZE              10069018
100700                                      INTO PV-CICS-MSG-AREA       10070018
100710             SET PS-DUMP-TO-LOG       TO TRUE                     10071018
100720             PERFORM 9990-WRITE-CICS                              10072018
100730     END-EVALUATE.                                                10073018
100740                                                                  10074018
100750                                                                  10075018
100760******************************************************************10076018
100770* get shipping door id that the store is assigned to             *10077018
100780* dmh 2/24/16                                                    *10078018
100790******************************************************************10079018
100800 4667-get-door-id.                                                10080018
100810                                                                  10081018
100820     EXEC SQL                                                     10082018
100830           Select G.door_id                                       10083018
100840             INTO :CNDRST-DOOR-ID                                 10084018
100850             from tcndrst g                                       10085018
100860                , tcndcdr h                                       10086018
100870            where g.OPER_UNT_ID = :CNDRST-OPER-UNT-ID             10087018
100880              and g.str_nbr     = :cndrst-str-nbr                 10088018
100890              and g.OPER_UNT_ID = h.oper_unt_id                   10089018
100900              and g.door_id     =  h.door_id                      10090018
100910              and g.STRT_TMST  <=  current timestamp              10091018
100920              and g.END_TMST   >=  current timestamp              10092018
100930              AND h.DOOR_LOC_DESC NOT LIKE '%RE-OPEN%'            10093018
100940              AND h.DOOR_LOC_DESC NOT LIKE '%UPS%'                10094018
100950              AND h.DOOR_LOC_DESC NOT LIKE '%VIRTUAL%'            10095018
100960             WITH UR                                              10096018
100970     END-EXEC.                                                    10097018
100980                                                                  10098018
100990     EVALUATE TRUE                                                10099018
101000         WHEN SQLCODE = ZERO                                      10100018
101010             CONTINUE                                             10101018
101020         WHEN SQLCODE = +100                                      10102018
101030         WHEN SQLCODE = -811                                      10103018
101040             MOVE '@@@@'  TO  CNDRST-DOOR-ID                      10104018
101050         WHEN SQLCODE = -904                                      10105018
101060         WHEN SQLCODE = -911                                      10106018
101070         WHEN SQLCODE = -913                                      10107018
101080             MOVE SQLCODE TO    PV-SQLCODE                        10108018
101090             STRING ' PCKCS707 - 4667-get-door-id         '       10109018
101100                    ' SQLCODE = ' PV-SQLCODE                      10110018
101110                 DELIMITED BY SIZE INTO PV-CICS-MSG-AREA          10111018
101120             PERFORM 9990-WRITE-CICS                              10112018
101130             MOVE 'TCNDRST'           TO PV-DISP-TABLE-1          10113018
101140             MOVE 'TCNDCDR'           TO PV-DISP-TABLE-2          10114018
101150             PERFORM 9955-SQL-ERROR                               10115018
101160             SET  PS-SOCKET-ERROR         TO TRUE                 10116018
101170             SET  PC140-CRA-SOCKET-COMM-ERROR  TO TRUE            10117018
101180             SET PS-DUMP-TO-LOG       TO TRUE                     10118018
101190             PERFORM 9990-WRITE-CICS                              10119018
101200                                                                  10120018
101210         WHEN SQLWARN0 NOT = SPACES                               10121018
101220         WHEN SQLCODE < ZERO                                      10122018
101230         WHEN SQLCODE > ZERO                                      10123018
101240             MOVE SQLCODE TO    PV-SQLCODE                        10124018
101250             STRING ' PCKCS707 - 4667-get-door-id         '       10125018
101260                    ' SQLCODE = ' PV-SQLCODE                      10126018
101270                 DELIMITED BY SIZE INTO PV-CICS-MSG-AREA          10127018
101280             PERFORM 9990-WRITE-CICS                              10128018
101290             MOVE 'TCNDRST'           TO PV-DISP-TABLE-1          10129018
101300             MOVE 'TCNDCDR'           TO PV-DISP-TABLE-2          10130018
101310             PERFORM 9955-SQL-ERROR                               10131018
101320             SET  PS-SOCKET-ERROR         TO TRUE                 10132018
101330             SET  PC140-CRA-SOCKET-COMM-ERROR  TO TRUE            10133018
101340             SET PS-DUMP-TO-LOG       TO TRUE                     10134018
101350             PERFORM 9990-WRITE-CICS                              10135018
101360                                                                  10136018
101370     END-EVALUATE.                                                10137018
101380                                                                  10138018
101390                                                                  10139018
101400                                                                  10140018
101410******************************************************************10141018
101420* added inserts into tuplder to assist in determining issue where*10142018
101430* generic sml and check in cartons are receiving the same mfst # *10143018
101440* parm lbltrk is checked in previous program - pckcs116          *10144018
101450* added dmh - 6/20/12                                            *10145018
101460******************************************************************10146018
101470 4670-TRACK-MAINFEST.                                             10147018
101480     SET  PC263-SML-ALL-STORES      to  tRUE.                     10148018
101490                                                                  10149018
101500     MOVE PC140-CRA-USERID          TO  PC263-USER-ID.            10150018
101510     MOVE PC187-STR-NBR             TO  PC263-STR-NBR.            10151018
101520     MOVE PC187-NO-OF-LBLS          TO  PC263-NO-OF-LBLS.         10152018
101530     MOVE PC140-SML-PRTR-ID         TO  PC263-PRTR-ID.            10153018
101540     MOVE PC187-START-MFST-NBR      TO  PC263-START-MFST-NBR.     10154018
101550     MOVE PC187-END-MFST-NBR        TO  PC263-END-MFST-NBR.       10155018
101560     MOVE SQLCODE                   TO  PC263-SQLCODE.            10156018
101570     MOVE PC187-CRA-RET-CDE         TO  PC263-CRA-RET-CDE.        10157018
101580     MOVE PC187-CRA-RET-MSG         TO  PC263-CRA-RET-MSG.        10158018
101590     MOVE PC187-CRA-REQ-ID          TO  PC263-CRA-REQ-ID.         10159018
101600                                                                  10160018
101610     MOVE PC140-CRA-OPER-UNT-ID     TO UPLDER-OPER-UNT-ID.        10161018
101620     MOVE 'G'                       TO UPLDER-UPLD-TRN-CDE.       10162018
101630     MOVE '102'                     TO UPLDER-ERR-CDE.            10163018
101640     MOVE PC263-UPLOAD-ERROR-RECORD TO UPLDER-PKT-TXT.            10164018
101650     ADD  1                         TO UPLDER-UPLD-SEQ-NBR.       10165018
101660                                                                  10166018
101670     EXEC SQL                                                     10167018
101680         INSERT                                                   10168018
101690           INTO TUPLDER                                           10169018
101700             ( OPER_UNT_ID                                        10170018
101710             , UPLD_TRN_CDE                                       10171018
101720             , ERR_CDE                                            10172018
101730             , PRC_TMST                                           10173018
101740             , UPLD_SEQ_NBR                                       10174018
101750             , PKT_TXT                                            10175018
101760             )                                                    10176018
101770             VALUES                                               10177018
101780             ( :UPLDER-OPER-UNT-ID                                10178018
101790             , :UPLDER-UPLD-TRN-CDE                               10179018
101800             , :UPLDER-ERR-CDE                                    10180018
101810             ,  CURRENT TIMESTAMP                                 10181018
101820             , :UPLDER-UPLD-SEQ-NBR                               10182018
101830             , :UPLDER-PKT-TXT                                    10183018
101840             )                                                    10184018
101850     END-EXEC.                                                    10185018
101860                                                                  10186018
101870     EVALUATE TRUE                                                10187018
101880         WHEN SQLCODE = ZERO                                      10188018
101890             CONTINUE                                             10189018
101900         WHEN SQLCODE = -904                                      10190018
101910         WHEN SQLCODE = -911                                      10191018
101920         WHEN SQLCODE = -913                                      10192018
101930             MOVE SQLCODE TO    PV-SQLCODE                        10193018
101940             STRING ' PCKCS707 - 4670-TRACK-MAINFEST      '       10194018
101950                    ' SQLCODE = ' PV-SQLCODE                      10195018
101960                 DELIMITED BY SIZE INTO PV-CICS-MSG-AREA          10196018
101970             PERFORM 9990-WRITE-CICS                              10197018
101980             MOVE 'TUPLDER'           TO PV-DISP-TABLE-1          10198018
101990             PERFORM 9955-SQL-ERROR                               10199018
102000             SET  PS-SOCKET-ERROR         TO TRUE                 10200018
102010             SET  PC140-CRA-SOCKET-COMM-ERROR  TO TRUE            10201018
102020             SET PS-DUMP-TO-LOG       TO TRUE                     10202018
102030             PERFORM 9990-WRITE-CICS                              10203018
102040                                                                  10204018
102050         WHEN SQLWARN0 NOT = SPACES                               10205018
102060         WHEN SQLCODE < ZERO                                      10206018
102070         WHEN SQLCODE > ZERO                                      10207018
102080             MOVE SQLCODE TO    PV-SQLCODE                        10208018
102090             STRING ' PCKCS707 - 4670-TRACK-MAINFEST      '       10209018
102100                    ' SQLCODE = ' PV-SQLCODE                      10210018
102110                 DELIMITED BY SIZE INTO PV-CICS-MSG-AREA          10211018
102120             PERFORM 9990-WRITE-CICS                              10212018
102130             MOVE 'TUPLDER'           TO PV-DISP-TABLE-1          10213018
102140             PERFORM 9955-SQL-ERROR                               10214018
102150             SET  PS-SOCKET-ERROR         TO TRUE                 10215018
102160             SET  PC140-CRA-SOCKET-COMM-ERROR  TO TRUE            10216018
102170             SET PS-DUMP-TO-LOG       TO TRUE                     10217018
102180             PERFORM 9990-WRITE-CICS                              10218018
102190                                                                  10219018
102200     END-EVALUATE.                                                10220018
102230                                                                  10223018
102240                                                                  10224018
102250*----------------------------------------------------------------*10225018
102260*  BUILD SOCKET TRAILER RECORD                                   *10226018
102270*----------------------------------------------------------------*10227018
102280 4700-BLD-TLR-REC.                                                10228018
102290     STRING                                                       10229018
102300            ' 4700-BLD-TLR-REC'                                   10230018
102310     DELIMITED BY SIZE                                            10231018
102320     INTO PV-CICS-MSG-AREA                                        10232018
102330     PERFORM 9990-WRITE-CICS                                      10233018
102340                                                                  10234018
102350     INITIALIZE PC133-LABEL-TLR-REC.                              10235018
102360     SET  PC133-LABEL-TLR           TO  TRUE.                     10236018
102370     MOVE PV-LPMS-TRANS-ID          TO  PC133-TLR-TRANS-ID.       10237018
102380     MOVE PV-TRAILER-COUNT          TO  PC133-TLR-RECORD-COUNT.   10238018
102390                                                                  10239018
102400     INSPECT PC133-LABEL-TLR-REC REPLACING ALL                    10240018
102410         '' BY SPACES.                                           10241018
102420     INSPECT PC133-LABEL-TLR-REC REPLACING ALL                    10242018
102430         ';' BY SPACES.                                           10243018
102440     INSPECT PC133-LABEL-TLR-REC REPLACING ALL                    10244018
102450         LOW-VALUES BY SPACES.                                    10245018
102460                                                                  10246018
102470     MOVE PC133-TLR-REC-LENGTH    TO DP081-TCPLENG                10247018
102480                                     DP081-NBR-BYTES.             10248018
102490                                                                  10249018
102500     PERFORM 5100-SEND-DATA-TO-LPMS.                              10250018
102510                                                                  10251018
102520                                                                  10252018
102530*----------------------------------------------------------------*10253018
102540*   CLOSE CURSOR - SML'S                                         *10254018
102560*----------------------------------------------------------------*10256018
102570 4755-CLOSE-STORE-CSR.                                            10257018
102580     STRING                                                       10258018
102590            ' 4755-CLOSE-STORE-CSR'                               10259018
102600            '-' PC140-PARM-SML-ORD                                10260018
102610     DELIMITED BY SIZE                                            10261018
102620     INTO PV-CICS-MSG-AREA                                        10262018
102630     PERFORM 9990-WRITE-CICS                                      10263018
102640                                                                  10264018
102650     MOVE PC140-CRA-LOC-ID      TO DK-OPER-UNT-ID-NUM-4.          10265018
102660                                                                  10266018
102670     IF  PC140-SML-P2L-ORDER                                      10267018
102680         EXEC SQL                                                 10268018
102690             CLOSE OPEN-SML-P2L-CSR                               10269018
102700         END-EXEC                                                 10270018
102710     ELSE                                                         10271018
102711     IF  PC140-SML-P2L-SEPHORA-ORD                                10271127
102712         EXEC SQL                                                 10271227
102713              CLOSE  OPEN-P2L-SEPH-CSR                            10271327
102718         END-EXEC                                                 10271827
102719     ELSE                                                         10271927
102720     IF  PC140-SML-SHIP-DOOR-ORDER                                10272018
102730         EXEC SQL                                                 10273018
102740             CLOSE OPEN-SML-DOOR-CSR                              10274018
102750         END-EXEC                                                 10275018
102760     ELSE                                                         10276018
102770         EXEC SQL                                                 10277018
102780             CLOSE OPEN-SML-STR-CSR                               10278018
102790         END-EXEC                                                 10279018
102800     END-IF                                                       10280018
102801     END-IF                                                       10280127
102810     END-IF.                                                      10281018
102820                                                                  10282018
102830     EVALUATE TRUE                                                10283018
102840         WHEN SQLCODE = ZERO                                      10284018
102850             CONTINUE                                             10285018
102860                                                                  10286018
102870         WHEN SQLWARN0 NOT = SPACES                               10287018
102880         WHEN SQLCODE < ZERO                                      10288018
102890         WHEN SQLCODE > ZERO                                      10289018
102900             SET  PS-SOCKET-ERROR         TO TRUE                 10290018
102910             SET  PC140-CRA-SOCKET-COMM-ERROR  TO TRUE            10291018
102920             STRING ' PCKCS707 - '                                10292018
102930             '4755-CLOSE-STORE-CSR '                              10293018
102940             '-' PC140-PARM-SML-ORD  ' '                          10294018
102950             'SQLCODE:'                                           10295018
102960             SQLCA                 DELIMITED BY SIZE              10296018
102970                                      INTO PV-CICS-MSG-AREA       10297018
102980             SET PS-DUMP-TO-LOG       TO TRUE                     10298018
102990             PERFORM 9990-WRITE-CICS                              10299018
103000                                                                  10300018
103010     END-EVALUATE.                                                10301018
103020                                                                  10302018
103030                                                                  10303018
103040*----------------------------------------------------------------*10304018
103050*  LINK PCKCS721.                                                *10305018
103060*----------------------------------------------------------------*10306018
103070 4850-LINK-PCKCS721.                                              10307018
103080                                                                  10308018
103090     STRING                                                       10309018
103100            ' 4850-LINK-PCKCS721'                                 10310018
103110     DELIMITED BY SIZE                                            10311018
103120     INTO PV-CICS-MSG-AREA                                        10312018
103130     PERFORM 9990-WRITE-CICS                                      10313018
103140                                                                  10314018
103150     MOVE LENGTH OF PC187-COMMAREA-REC  TO  PV-COMMAREA-LENGTH.   10315018
103160                                                                  10316018
103170     EXEC CICS                                                    10317018
103180         LINK PROGRAM  (PV-PCKCS721)                              10318018
103190              COMMAREA (PC187-COMMAREA-REC)                       10319018
103200              LENGTH   (PV-COMMAREA-LENGTH)                       10320018
103210              RESP     (PV-CICS-RESPONSE)                         10321018
103220     END-EXEC.                                                    10322018
103230                                                                  10323018
103240     EVALUATE TRUE                                                10324018
103250         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 10325018
103260              IF  PC187-CRA-SUCCESSFUL                            10326018
103270                  CONTINUE                                        10327018
103280              ELSE                                                10328018
103290                  SET PV-DONE-PROCESSING          TO TRUE         10329018
103300                  SET PC140-CRA-SOCKET-COMM-ERROR TO TRUE         10330018
103310                  MOVE SQLCODE              TO PV-SQL-CODE        10331018
103320                  STRING ' PCKCS707 - '                           10332018
103330                         '4850-LINK-PCKCS721 '                    10333018
103340                         ' RETURN MESSAGE - '                     10334018
103350                         PC187-CRA-RET-MSG                        10335018
103360                         '  PARA-'                                10336018
103370                         PC187-CRA-REQ-ID      DELIMITED BY SIZE  10337018
103380                                          INTO PV-CICS-MSG-AREA   10338018
103390                  SET PS-DUMP-TO-LOG       TO TRUE                10339018
103400                  PERFORM 9990-WRITE-CICS                         10340018
103410                                                                  10341029
103430                  SET  PS-SOCKET-ERROR         TO TRUE            10343018
103440                  SET  PC140-CRA-SOCKET-COMM-ERROR  TO TRUE       10344018
103450                  STRING ' PCKCS707 - '                           10345018
103460                         '4850-LINK-PCKCS721 '                    10346018
103470                         'SQL CODE IS - '                         10347018
103480                          SQLCA            DELIMITED BY SIZE      10348018
103490                                      INTO PV-CICS-MSG-AREA       10349018
103500                  SET PS-DUMP-TO-LOG       TO TRUE                10350018
103510                  PERFORM 9990-WRITE-CICS                         10351018
103530                                                                  10353029
103540              END-IF                                              10354018
103550         WHEN OTHER                                               10355018
103560              SET PV-DONE-PROCESSING          TO TRUE             10356018
103570              SET PC140-CRA-SOCKET-COMM-ERROR TO TRUE             10357018
103580              MOVE SQLCODE              TO PV-SQL-CODE            10358018
103590              STRING ' PCKCS707 (OTHER) -'                        10359018
103600                     '4850-LINK-PCKCS721 '                        10360018
103610                     ' RETURN MESSAGE - '                         10361018
103620                     PC187-CRA-RET-MSG                            10362018
103630                     '  PARA-'                                    10363018
103640                     PC187-CRA-REQ-ID      DELIMITED BY SIZE      10364018
103650                                      INTO PV-CICS-MSG-AREA       10365018
103660              SET PS-DUMP-TO-LOG       TO TRUE                    10366018
103670              PERFORM 9990-WRITE-CICS                             10367018
103680                                                                  10368029
103700                  SET  PS-SOCKET-ERROR         TO TRUE            10370018
103710                  SET  PC140-CRA-SOCKET-COMM-ERROR  TO TRUE       10371018
103720                  STRING ' PCKCS707 - '                           10372018
103730                         '4850-LINK-PCKCS721 '                    10373018
103740                         'SQL CODE IS - '                         10374018
103750                          SQLCA            DELIMITED BY SIZE      10375018
103760                                      INTO PV-CICS-MSG-AREA       10376018
103770                  SET PS-DUMP-TO-LOG       TO TRUE                10377018
103780                  PERFORM 9990-WRITE-CICS                         10378018
103800                                                                  10380029
103810     END-EVALUATE.                                                10381018
103820                                                                  10382018
103830*----------------------------------------------------------------*10383018
103840*  CONNECT THE PATH (SOCKET).                                    *10384018
103850*----------------------------------------------------------------*10385018
103860 5100-SEND-DATA-TO-LPMS.                                          10386018
103870                                                                  10387018
103880     STRING                                                       10388018
103890            ' 5100-SEND-DATA-TO-LPMS'                             10389018
103900     DELIMITED BY SIZE                                            10390018
103910     INTO PV-CICS-MSG-AREA                                        10391018
103920     PERFORM 9990-WRITE-CICS                                      10392018
103930                                                                  10393018
103940     MOVE LOW-VALUES              TO TCP-BUF2.                    10394018
103950     MOVE PC133-LABEL-RECORD      TO TCP-BUF2.                    10395018
103960     MOVE PC133-LABEL-RECORD      TO PV-DISPLAY-DOWNLOAD.         10396018
103970                                                                  10397018
103980*---------------------------------------------------*             10398018
103990* DISPLAY RECORD TO BE DOWNLOADED (CSSL) (POS 1-80) *             10399018
104000*---------------------------------------------------*             10400018
104010     STRING ' '                        DELIMITED BY SIZE          10401018
104020            PV-DISPLAY-DOWNLOAD-1      DELIMITED BY SIZE          10402018
104030                                       INTO PV-CICS-MSG-AREA.     10403018
104040     PERFORM 9990-WRITE-CICS.                                     10404018
104050*                                                                 10405018
104060*** in for testing only   - begin                                 10406018
104070*                                                                 10407018
104080*       INITIALIZE                       PV-CICS-MSG-AREA         10408018
104090*       string ' part1:  '                                        10409018
104100*             PV-DISPLAY-DOWNLOAD-1      delimited by size        10410018
104110*                                   inTO PV-CICS-MSG-AREA         10411018
104120*       MOVE LENGTH OF PV-CICS-MSG-AREA                           10412018
104130*                                     TO PV-COMMAREA-LENGTH       10413018
104140*       EXEC CICS                                                 10414018
104150*           WRITEQ TD                                             10415018
104160*               QUEUE   ('CSSL')                                  10416018
104170*               FROM    (PV-CICS-MSG-AREA)                        10417018
104180*               LENGTH  (PV-COMMAREA-LENGTH)                      10418018
104190*               RESP    (PV-CICS-RESPONSE)                        10419018
104200*       END-EXEC.                                                 10420018
104210*                                                                 10421018
104220*-----------------------------------------------------*           10422018
104230* DISPLAY RECORD TO BE DOWNLOADED (CSSL) (POS 81-100) *           10423018
104240*-----------------------------------------------------*           10424018
104250     STRING ' '                        DELIMITED BY SIZE          10425018
104260            PV-DISPLAY-DOWNLOAD-2      DELIMITED BY SIZE          10426018
104270                                       INTO PV-CICS-MSG-AREA.     10427018
104280     PERFORM 9990-WRITE-CICS.                                     10428018
104290*                                                                 10429018
104300*** in for testing only   - begin                                 10430018
104310*                                                                 10431018
104320*       INITIALIZE                       PV-CICS-MSG-AREA         10432018
104330*       string ' part2:  '                                        10433018
104340*             PV-DISPLAY-DOWNLOAD-2      delimited by size        10434018
104350*                                   inTO PV-CICS-MSG-AREA         10435018
104360*       MOVE LENGTH OF PV-CICS-MSG-AREA                           10436018
104370*                                     TO PV-COMMAREA-LENGTH       10437018
104380*       EXEC CICS                                                 10438018
104390*           WRITEQ TD                                             10439018
104400*               QUEUE   ('CSSL')                                  10440018
104410*               FROM    (PV-CICS-MSG-AREA)                        10441018
104420*               LENGTH  (PV-COMMAREA-LENGTH)                      10442018
104430*               RESP    (PV-CICS-RESPONSE)                        10443018
104440*       END-EXEC.                                                 10444018
104450*                                                                 10445018
104460*** in for testing only   - begin                                 10446018
104470*                                                                 10447018
104480*       INITIALIZE                       PV-CICS-MSG-AREA         10448018
104490*       string ' part3:  '                                        10449018
104500*             PV-DISPLAY-DOWNLOAD-3      delimited by size        10450018
104510*                                   inTO PV-CICS-MSG-AREA         10451018
104520*       MOVE LENGTH OF PV-CICS-MSG-AREA                           10452018
104530*                                     TO PV-COMMAREA-LENGTH       10453018
104540*       EXEC CICS                                                 10454018
104550*           WRITEQ TD                                             10455018
104560*               QUEUE   ('CSSL')                                  10456018
104570*               FROM    (PV-CICS-MSG-AREA)                        10457018
104580*               LENGTH  (PV-COMMAREA-LENGTH)                      10458018
104590*               RESP    (PV-CICS-RESPONSE)                        10459018
104600*       END-EXEC.                                                 10460018
104610*                                                                 10461018
104620*-----------------------------------------------------*           10462018
104630* DISPLAY TCP LENGTH (CSSL)                           *           10463018
104640*-----------------------------------------------------*           10464018
104650     MOVE  DP081-TCPLENG               TO  PV-TCPLENG.            10465018
104660     STRING ' DP081-TCPLENG - '        DELIMITED BY SIZE          10466018
104670            PV-TCPLENG                 DELIMITED BY SIZE          10467018
104680                                       INTO PV-CICS-MSG-AREA.     10468018
104690     PERFORM 9990-WRITE-CICS.                                     10469018
104700                                                                  10470018
104710*-----------------------------------------------------*           10471018
104720*                                                     *           10472018
104730*-----------------------------------------------------*           10473018
104740     CALL 'EZACIC04'                                              10474018
104750         USING DP081-TOASCII-TOKEN                                10475018
104760               TCP-BUF2                                           10476018
104770               DP081-TCPLENG.                                     10477018
104780                                                                  10478018
104790*-----------------------------------------------------*           10479018
104800* DISPLAY TCP TOKEN (CSSL)                            *           10480018
104810*-----------------------------------------------------*           10481018
104820     STRING ' DP081-TCP-TOKEN - '      DELIMITED BY SIZE          10482018
104830            DP081-TCP-TOKEN            DELIMITED BY SIZE          10483018
104840                                       INTO PV-CICS-MSG-AREA.     10484018
104850     PERFORM 9990-WRITE-CICS.                                     10485018
104860                                                                  10486029
104870*-----------------------------------------------------*           10487018
104880* DISPLAY SEND COMMAND (CSSL)                         *           10488018
104890*-----------------------------------------------------*           10489018
104900     MOVE  DP081-SOCK-ID               TO  PV-SOCK-ID.            10490018
104910     STRING ' SEND COMMAND IS - '      DELIMITED BY SIZE          10491018
104920            DP081-SEND-CMD             DELIMITED BY SIZE          10492018
104930            ' SOCKET ID IS - '         DELIMITED BY SIZE          10493018
104940            PV-SOCK-ID                 DELIMITED BY SIZE          10494018
104950                                       INTO PV-CICS-MSG-AREA.     10495018
104960     PERFORM 9990-WRITE-CICS.                                     10496018
104970                                                                  10497029
104980*-----------------------------------------------------*           10498018
104990* DISPLAY TCP LENGTH 2 (CSSL)                         *           10499018
105000*-----------------------------------------------------*           10500018
105010     MOVE  DP081-TCPLENG               TO  PV-TCPLENG.            10501018
105020     MOVE  DP081-FLAG                  TO  PV-FLAG.               10502018
105030     STRING '  DP081-TCPLENG 2 - '     DELIMITED BY SIZE          10503018
105040            PV-TCPLENG                 DELIMITED BY SIZE          10504018
105050            '  DP081-FLAG - '          DELIMITED BY SIZE          10505018
105060            PV-FLAG                    DELIMITED BY SIZE          10506018
105070                                       INTO PV-CICS-MSG-AREA.     10507018
105080     PERFORM 9990-WRITE-CICS.                                     10508018
105090                                                                  10509018
105100*-----------------------------------------------------*           10510018
105110     SET  DP081-OUT-OF-BAND-FLAG TO TRUE.                         10511018
105120                                                                  10512018
105130     CALL 'EZASOKET'                                              10513018
105140         USING DP081-SEND-CMD                                     10514018
105150               DP081-SOCK-ID                                      10515018
105160               DP081-FLAG                                         10516018
105170               DP081-NBR-BYTES                                    10517018
105180               TCP-BUF2                                           10518018
105190               DP081-ERRNO                                        10519018
105200               DP081-RETCODE.                                     10520018
105210                                                                  10521018
105220*-----------------------------------------------------*           10522018
105230* DISPLAY RETURN CODE & ERROR NUMBER                  *           10523018
105240*-----------------------------------------------------*           10524018
105250     MOVE  DP081-RETCODE  TO  PV-RETCODE.                         10525018
105260     MOVE  DP081-ERRNO    TO  PV-ERRNO.                           10526018
105270     STRING '  DP081-RETCODE - '       DELIMITED BY SIZE          10527018
105280            PV-RETCODE                 DELIMITED BY SIZE          10528018
105290            '  DP081-ERRNO - '         DELIMITED BY SIZE          10529018
105300            PV-ERRNO                   DELIMITED BY SIZE          10530018
105310                                       INTO PV-CICS-MSG-AREA.     10531018
105320     PERFORM 9990-WRITE-CICS.                                     10532018
105330                                                                  10533018
105340     IF  DP081-RETCODE < ZERO                                     10534018
105350         SET  PS-SOCKET-ERROR        TO TRUE                      10535018
105360         SET  PC140-CRA-SOCKET-COMM-ERROR  TO TRUE                10536018
105370         MOVE PC-CURRENT-PROGRAM-NAME TO DP081-TCP-IP-PGM-NAME    10537018
105380         SET  DP081-TCP-IP-SEND-TO-ERR TO TRUE                    10538018
105390         MOVE DP081-ERRNO            TO DP081-TCP-IP-ERR-NBR      10539018
105400         MOVE DP081-TCP-IP-LOGGING-MSG TO PV-CICS-MSG-AREA        10540018
105410         PERFORM 9990-WRITE-CICS                                  10541018
105420                                                                  10542018
105430     ELSE                                                         10543018
105440         MOVE ' PCKCS707 - SEND SUCCESSFUL'                       10544018
105450                                      TO PV-CICS-MSG-AREA         10545018
105460         PERFORM 9990-WRITE-CICS                                  10546018
105470         IF  PC133-LABEL-HDR                                      10547018
105480             STRING ' PCKCS707 - '           DELIMITED BY SIZE    10548018
105490                    PC133-HDR-PO-NBR         DELIMITED BY SIZE    10549018
105500                    '-'                      DELIMITED BY SIZE    10550018
105510                    PC133-HDR-RCVR-SEQ       DELIMITED BY SIZE    10551018
105520                    '-'                      DELIMITED BY SIZE    10552018
105530                    PC133-HDR-LINE-NBR       DELIMITED BY SIZE    10553018
105540                    '  -  PRINTER ID-'       DELIMITED BY SIZE    10554018
105550                    PC133-HDR-PRTR-ID        DELIMITED BY SIZE    10555018
105560                                        INTO PV-CICS-MSG-AREA     10556018
105570             PERFORM 9990-WRITE-CICS                              10557018
105580         END-IF                                                   10558018
105590                                                                  10559018
105600     END-IF.                                                      10560018
105610                                                                  10561018
105620     PERFORM 5200-CHECK-SOCKET-CONNECTION.                        10562018
105630                                                                  10563018
105640     IF  PS-NO-SOCKET-ERROR                                       10564018
105650         PERFORM 5400-RECEIVE-CONFIRM-FROM-LPMS                   10565018
105660     END-IF.                                                      10566018
105670                                                                  10567018
105680                                                                  10568018
105690* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 10569018
105700*  added Select socket command to check if socket connection    * 10570018
105710*  is still active.  if return code > 0 then socket is active   * 10571018
105720*  if return code = 0 socket is no longer active.               * 10572018
105740* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 10574018
105750 5200-CHECK-SOCKET-CONNECTION.                                    10575018
105760                                                                  10576018
105770* ZERO OUT ALL OUTPUT BIT MASKS FOR SELECT                        10577018
105780     PERFORM VARYING SOCKNO FROM 1 BY 1 UNTIL SOCKNO > SOCKETS    10578018
105790        MOVE '0' TO CHAR-ENTRY(SOCKNO)                            10579018
105800     END-PERFORM.                                                 10580018
105810     PERFORM 5210-CHAR-TO-BIT.                                    10581018
105820     MOVE BIT-MASK TO SELECT-RR-MASK.                             10582018
105830     MOVE BIT-MASK TO SELECT-RW-MASK.                             10583018
105840     MOVE BIT-MASK TO SELECT-RE-MASK.                             10584018
105850     MOVE BIT-MASK TO SELECT-EX-MASK.                             10585018
105860     MOVE BIT-MASK TO SELECT-WR-MASK.                             10586018
105870                                                                  10587018
105880* set all input bit masks for select to 1                         10588018
105890     PERFORM VARYING SOCKNO FROM 1 BY 1 UNTIL SOCKNO > SOCKETS    10589018
105900        MOVE '1' TO CHAR-ENTRY(SOCKNO)                            10590018
105910     END-PERFORM.                                                 10591018
105920     PERFORM 5210-CHAR-TO-BIT.                                    10592018
105930     MOVE BIT-MASK TO SELECT-RD-MASK.                             10593018
105940*                                                                 10594018
105950* ISSUE THE SELECT COMMAND ----------------------------           10595018
105960* SELECT WILL FLIP A BIT IN THE READ MASK TO '1' FOR ANY          10596018
105970* SOCKET THAT HAS DATA TO BE PROCESSED.                           10597018
105980*                                                                 10598018
105990                                                                  10599018
106000     MOVE 0 TO DP081-ERRNO.                                       10600018
106010     MOVE 0 TO DP081-RETCODE.                                     10601018
106020     CALL 'EZASOKET' USING DP081-SELECT-CMD                       10602018
106030         SELECT-NUMFDS SELECT-TIMEOUT                             10603018
106040         SELECT-RD-MASK SELECT-WR-MASK SELECT-EX-MASK             10604018
106050         SELECT-RR-MASK SELECT-RW-MASK SELECT-RE-MASK             10605018
106060         DP081-ERRNO DP081-RETCODE.                               10606018
106070                                                                  10607018
106080     IF DP081-RETCODE < 0                                         10608018
106090                                                                  10609018
106100         SET  PS-SOCKET-ERROR         TO TRUE                     10610018
106110         SET  PC140-CRA-SOCKET-COMM-ERROR TO TRUE                 10611018
106120         MOVE PC-CURRENT-PROGRAM-NAME TO DP081-TCP-IP-PGM-NAME    10612018
106130         SET  DP081-TCP-IP-READ-ERR  TO TRUE                      10613018
106140         MOVE DP081-ERRNO            TO DP081-TCP-IP-ERR-NBR      10614018
106150         MOVE DP081-ERRNO            TO DP081-TCP-IP-ERR-NBR      10615018
106160                                        SOCKET-ERRNO              10616018
106170         MOVE DP081-RETCODE          TO SOCKET-RETCODE            10617018
106180         MOVE PC133-HDR-PO-NBR       TO SOCKET-RECEIVER           10618018
106190         MOVE PC133-HDR-RCVR-SEQ     TO SOCKET-SEQ                10619018
106200         MOVE PC133-HDR-LINE-NBR     TO SOCKET-LINE               10620018
106210         MOVE 'SEE ERROR NO '        TO SOCKET-DESCR              10621018
106220                                                                  10622018
106230         MOVE SOCKET-SELECT-ERR      TO PV-CICS-MSG-AREA          10623018
106240         PERFORM 9990-WRITE-CICS                                  10624018
106250         MOVE SOCKET-SELECT-ERR      TO PV-CICS-MSG-AREA          10625018
106260         PERFORM 9991-WRITEQ                                      10626018
106270         MOVE SPACES                 TO PV-CICS-MSG-AREA          10627018
106280                                                                  10628018
106290     END-IF.                                                      10629018
106300                                                                  10630018
106310     IF DP081-RETCODE = 0                                         10631018
106320         SET  PS-SOCKET-ERROR         TO TRUE                     10632018
106330         SET  PC140-CRA-SOCKET-COMM-ERROR TO TRUE                 10633018
106340         MOVE PC-CURRENT-PROGRAM-NAME TO DP081-TCP-IP-PGM-NAME    10634018
106350         SET  DP081-TCP-IP-READ-ERR  TO TRUE                      10635018
106360         MOVE DP081-ERRNO            TO DP081-TCP-IP-ERR-NBR      10636018
106370         MOVE DP081-ERRNO            TO DP081-TCP-IP-ERR-NBR      10637018
106380                                        SOCKET-ERRNO              10638018
106390         MOVE DP081-RETCODE          TO SOCKET-RETCODE            10639018
106400         MOVE PC133-HDR-PO-NBR       TO SOCKET-RECEIVER           10640018
106410         MOVE PC133-HDR-RCVR-SEQ     TO SOCKET-SEQ                10641018
106420         MOVE PC133-HDR-LINE-NBR     TO SOCKET-LINE               10642018
106430         MOVE 'SOCKET TIMEOUT'       TO SOCKET-DESCR              10643018
106440                                                                  10644018
106450         MOVE SOCKET-SELECT-ERR      TO PV-CICS-MSG-AREA          10645018
106460         PERFORM 9990-WRITE-CICS                                  10646018
106470         MOVE SOCKET-SELECT-ERR      TO PV-CICS-MSG-AREA          10647018
106480         PERFORM 9991-WRITEQ                                      10648018
106490         MOVE SPACES                 TO PV-CICS-MSG-AREA          10649018
106500     END-IF.                                                      10650018
106510                                                                  10651018
106520***************************************************************   10652018
106530* CHAR-TO-BIT                                                 *   10653018
106540* CONVERT THE CHARACTER ARRAY TO A SELECT BIT MASK SO THAT THE*   10654018
106550* COBOL PROGRAM CAN WRITE IT.                                 *   10655018
106560***************************************************************   10656018
106570 5210-CHAR-TO-BIT.                                                10657018
106580                                                                  10658029
106630     CALL 'EZACIC06' USING BITMASK-TOKEN CTOB                     10663018
106640          BIT-MASK CHAR-MASK BIT-MASK-LENGTH EZRETC               10664018
106650     IF  EZRETC < 0 THEN                                          10665018
106660         MOVE '!EZCIC06 - CTOB-EXCP ' TO PV-CICS-MSG-AREA         10666018
106670         MOVE LENGTH OF PV-CICS-MSG-AREA TO PV-COMMAREA-LENGTH    10667018
106680                                                                  10668018
106690         EXEC CICS                                                10669018
106700             WRITEQ TD                                            10670018
106710                 QUEUE   ('CSSL')                                 10671018
106720                 FROM    (PV-CICS-MSG-AREA)                       10672018
106730                 LENGTH  (PV-COMMAREA-LENGTH)                     10673018
106740                 RESP    (PV-CICS-RESPONSE)                       10674018
106750         END-EXEC                                                 10675018
106760                                                                  10676018
106770         SET  PS-SOCKET-ERROR         TO TRUE                     10677018
106780         SET  PC140-CRA-SOCKET-COMM-ERROR TO TRUE                 10678018
106790         MOVE PC-CURRENT-PROGRAM-NAME TO DP081-TCP-IP-PGM-NAME    10679018
106800         SET  DP081-TCP-IP-READ-ERR  TO TRUE                      10680018
106810         MOVE DP081-ERRNO            TO DP081-TCP-IP-ERR-NBR      10681018
106820         MOVE DP081-ERRNO            TO DP081-TCP-IP-ERR-NBR      10682018
106830                                        SOCKET-ERRNO              10683018
106840         MOVE DP081-RETCODE          TO SOCKET-RETCODE            10684018
106850         MOVE PC133-HDR-PO-NBR       TO SOCKET-RECEIVER           10685018
106860         MOVE PC133-HDR-RCVR-SEQ     TO SOCKET-SEQ                10686018
106870         MOVE PC133-HDR-LINE-NBR     TO SOCKET-LINE               10687018
106880         MOVE 'SEE ERROR NO '        TO SOCKET-DESCR              10688018
106890                                                                  10689018
106900         MOVE SOCKET-SELECT-ERR      TO PV-CICS-MSG-AREA          10690018
106910         PERFORM 9990-WRITE-CICS                                  10691018
106920         MOVE SOCKET-SELECT-ERR      TO PV-CICS-MSG-AREA          10692018
106930         PERFORM 9991-WRITEQ                                      10693018
106940         MOVE SPACES                 TO PV-CICS-MSG-AREA          10694018
106950                                                                  10695018
106960     END-IF.                                                      10696018
106970                                                                  10697018
107000                                                                  10700018
107010*----------------------------------------------------------------*10701018
107020*  RECEIVE CONFIRMATION BACK FROM AL SYSTEMS THAT THEY RECEIVED  *10702018
107030*  ALL RECORDS CORRECTLY.                                        *10703018
107040*----------------------------------------------------------------*10704018
107050 5400-RECEIVE-CONFIRM-FROM-LPMS.                                  10705018
107060                                                                  10706018
107070     STRING                                                       10707018
107080            ' 5400-RECEIVE-CONFIRM-FROM-LPMS'                     10708018
107090     DELIMITED BY SIZE                                            10709018
107100     INTO PV-CICS-MSG-AREA                                        10710018
107110     PERFORM 9990-WRITE-CICS                                      10711018
107120                                                                  10712018
107130     MOVE ' PCKCS707 - START OF RECEIVE CONFIRM FROM LPMS'        10713018
107140                                         TO PV-CICS-MSG-AREA.     10714018
107150     PERFORM 9990-WRITE-CICS.                                     10715018
107160                                                                  10716018
107170                                                                  10717018
107180     MOVE LOW-VALUES     TO  TCP-BUF2.                            10718018
107190     MOVE 50             TO  DP081-TCPLENG                        10719018
107200                             DP081-NBR-BYTES.                     10720018
107210     SET  DP081-NO-FLAG  TO  TRUE.                                10721018
107220                                                                  10722018
107230     CALL 'EZASOKET'                                              10723018
107240         USING DP081-RECV-CMD                                     10724018
107250               DP081-SOCK-ID                                      10725018
107260               DP081-FLAG                                         10726018
107270               DP081-NBR-BYTES                                    10727018
107280               TCP-BUF                                            10728018
107290               DP081-ERRNO                                        10729018
107300               DP081-RETCODE.                                     10730018
107310                                                                  10731018
107320     MOVE  DP081-RETCODE  TO  PV-RETCODE.                         10732018
107330     MOVE  DP081-ERRNO    TO  PV-ERRNO.                           10733018
107340     STRING '  RECEIVE -'              DELIMITED BY SIZE          10734018
107350            ' DP081-RETCODE - '        DELIMITED BY SIZE          10735018
107360            PV-RETCODE                 DELIMITED BY SIZE          10736018
107370            ' DP081-ERRNO - '          DELIMITED BY SIZE          10737018
107380            PV-ERRNO                   DELIMITED BY SIZE          10738018
107390                                       INTO PV-CICS-MSG-AREA.     10739018
107400     PERFORM 9990-WRITE-CICS.                                     10740018
107410                                                                  10741018
107420     CALL 'EZACIC05'                                              10742018
107430         USING DP081-TOEBCDIC-TOKEN                               10743018
107440               TCP-BUF                                            10744018
107450               DP081-TCPLENG.                                     10745018
107460                                                                  10746018
107470     IF  DP081-RETCODE < ZERO                                     10747018
107480         SET  PS-SOCKET-ERROR         TO TRUE                     10748018
107490         SET  PC140-CRA-SOCKET-COMM-ERROR TO TRUE                 10749018
107500         MOVE PC-CURRENT-PROGRAM-NAME TO DP081-TCP-IP-PGM-NAME    10750018
107510         SET  DP081-TCP-IP-READ-ERR  TO TRUE                      10751018
107520         MOVE DP081-ERRNO            TO DP081-TCP-IP-ERR-NBR      10752018
107530         MOVE DP081-TCP-IP-LOGGING-MSG TO PV-CICS-MSG-AREA        10753018
107540         PERFORM 9990-WRITE-CICS                                  10754018
107550                                                                  10755018
107560     ELSE                                                         10756018
107570         MOVE ' PCKCS707 - CONFIRM SUCCESSFUL'                    10757018
107580                                             TO PV-CICS-MSG-AREA  10758018
107590         PERFORM 9990-WRITE-CICS                                  10759018
107600                                                                  10760018
107610     END-IF.                                                      10761018
107620                                                                  10762018
107630     MOVE TCP-BUF TO PC133-LABEL-RECORD.                          10763018
107640                                                                  10764018
107650     IF  NOT PC133-SEND-SUCCESSFUL                                10765018
107660         PERFORM 4340-CLOSE-SOCKET                                10766018
107670         MOVE PC-CURRENT-PROGRAM-NAME TO DP081-TCP-IP-PGM-NAME    10767018
107680         SET  PS-SOCKET-ERROR         TO TRUE                     10768018
107690         SET  PC140-CRA-SOCKET-COMM-ERROR TO TRUE                 10769018
107700         SET  DP081-TCP-IP-READ-ERR  TO TRUE                      10770018
107710         MOVE DP081-ERRNO            TO DP081-TCP-IP-ERR-NBR      10771018
107720         MOVE DP081-TCP-IP-LOGGING-MSG TO PV-CICS-MSG-AREA        10772018
107730         PERFORM 9990-WRITE-CICS                                  10773018
107740         STRING '  '                 DELIMITED BY SIZE            10774018
107750                PC133-LABEL-RECORD   DELIMITED BY SIZE            10775018
107760                                     INTO PV-CICS-MSG-AREA        10776018
107770         PERFORM 9990-WRITE-CICS                                  10777018
107780                                                                  10778018
107790         EVALUATE TRUE                                            10779018
107800             WHEN  PC133-INVALID-PRINTER                          10780018
107810               STRING ' PCKCS707 -'           DELIMITED BY SIZE   10781018
107820                 PC138-MSG-INVALID-PRTR       DELIMITED BY SIZE   10782018
107830                                          INTO PV-CICS-MSG-AREA   10783018
107840             WHEN  PC133-DTL-WITHOUT-HDR                          10784018
107850               STRING ' PCKCS707 -'           DELIMITED BY SIZE   10785018
107860                 PC138-MSG-DTL-WO-HDR         DELIMITED BY SIZE   10786018
107870                                          INTO PV-CICS-MSG-AREA   10787018
107880             WHEN  PC133-TLR-WITHOUT-HDR-DTL                      10788018
107890               STRING ' PCKCS707 -'           DELIMITED BY SIZE   10789018
107900                 PC138-MSG-TLR-WO-HDR-DTL     DELIMITED BY SIZE   10790018
107910                                          INTO PV-CICS-MSG-AREA   10791018
107920             WHEN  PC133-TLR-CNT-NOT-MTCH-DTL                     10792018
107930               STRING ' PCKCS707 -'           DELIMITED BY SIZE   10793018
107940                 PC138-MSG-TLR-CNT-NOT-DTL    DELIMITED BY SIZE   10794018
107950                                          INTO PV-CICS-MSG-AREA   10795018
107960             WHEN  PC133-TRAN-IDS-NOT-MTCH                        10796018
107970               STRING ' PCKCS707 -'           DELIMITED BY SIZE   10797018
107980                 PC138-MSG-TRAN-IDS-NOT-MTCH  DELIMITED BY SIZE   10798018
107990                                          INTO PV-CICS-MSG-AREA   10799018
108000             WHEN  PC133-DTL-LNGTH-NOT-MTCH                       10800018
108010               STRING ' PCKCS707 -'           DELIMITED BY SIZE   10801018
108020                 PC138-MSG-DTL-LNGTH-NOT-MTCH DELIMITED BY SIZE   10802018
108030                                          INTO PV-CICS-MSG-AREA   10803018
108040             WHEN  PC133-DISK-ERROR                               10804018
108050               STRING ' PCKCS707 -'           DELIMITED BY SIZE   10805018
108060                 PC138-MSG-DISK-ERROR         DELIMITED BY SIZE   10806018
108070                                          INTO PV-CICS-MSG-AREA   10807018
108080             WHEN  PC133-TIMEOUT                                  10808018
108090               STRING ' PCKCS707 -'           DELIMITED BY SIZE   10809018
108100                 PC138-MSG-TIMEOUT            DELIMITED BY SIZE   10810018
108110                                          INTO PV-CICS-MSG-AREA   10811018
108120             WHEN  PC133-ADDR-NOT-FND                             10812018
108130               STRING ' PCKCS707 -'           DELIMITED BY SIZE   10813018
108140                 PC138-MSG-ADDR-NOT-FND       DELIMITED BY SIZE   10814018
108150                                          INTO PV-CICS-MSG-AREA   10815018
108160             WHEN  PC133-INVALID-PACKET                           10816018
108170               STRING ' PCKCS707 -'           DELIMITED BY SIZE   10817018
108180                 PC138-MSG-INVALID-PACKET     DELIMITED BY SIZE   10818018
108190                                          INTO PV-CICS-MSG-AREA   10819018
108200         END-EVALUATE                                             10820018
108210         PERFORM 9990-WRITE-CICS                                  10821018
108220     END-IF.                                                      10822018
108230******************************************************************10823018
108240* WHEN REPRINTING LABELS FROM THE CARTON STATUS PROGRAM,          10824018
108250**DETERMINE THE MERCHANDISE PRESENTATION(HANG,FOLD,MIXED,NONE)    10825018
108260**AND THE BUSINESS AREA ID                                        10826018
108270******************************************************************10827018
108280 6390-GET-LABEL-CODES.                                            10828018
108290     MOVE PC140-RF-KOHLS-BARCODE TO PV-SHIPT-UNT-X-22.            10829018
108300     MOVE PV-SHIPT-UNT-9-18      TO SUT00028-SHIPT-UNT-ID.        10830018
108310                                                                  10831018
108320     PERFORM 6400-DETERMINE-HANG-FOLD.                            10832018
108330                                                                  10833018
108340     EVALUATE PV-HNG-FOLD-SEQ-NBR                                 10834018
108350        WHEN  1                                                   10835018
108360            SET PC256-HANG                                        10836018
108370                PC253-HANG to true                                10837018
108390        WHEN  2                                                   10839018
108400            SET PC256-FOLD                                        10840018
108410                PC253-FOLD TO TRUE                                10841018
108430        WHEN  OTHER                                               10843018
108440            SET PC256-DEFLT-PRESENTATION                          10844018
108450                PC253-DEFLT-PRESENTATION TO TRUE                  10845018
108470     END-EVALUATE                                                 10847018
108480                                                                  10848018
108490     PERFORM 6700-LINK-XLKUT073.                                  10849018
108500                                                                  10850018
108510     PERFORM 6820-SELECT-EAS-TAG-IND                              10851018
108520     PERFORM 6830-GET-CURRENT-DOOR                                10852018
108530                                                                  10853018
108540*GET AUDIT STATUS FOR UCC128 CHECK-IN LABELS                      10854018
108550     IF PC140-RF-CHECKIN-SML  OR                                  10855018
108560        PC140-RF-DEST-LBL                                         10856018
108570        PERFORM 6800-SELECT-AUDIT-STATUS                          10857018
108580     END-IF.                                                      10858018
108590******************************************************************10859018
108600 6400-DETERMINE-HANG-FOLD.                                        10860018
108610      INITIALIZE PV-HNG-FOLD-SEQ-NBR                              10861018
108620                 PV-PREV-HANG-FOLD-IND                            10862018
108630                 PV-HANG-FOLD-IND.                                10863018
108640                                                                  10864018
108650      SET PS-NOT-EO-HANG-FOLD-CSR                                 10865018
108660          PS-NOT-HANG-FOLD-MIXED                                  10866018
108670          PS-FIRST-UPC-CALL    TO TRUE                            10867018
108680                                                                  10868018
108690      PERFORM 6450-OPEN-HANG-FOLD-CSR                             10869018
108700      PERFORM 6500-FETCH-HANG-FOLD-CSR                            10870018
108710        UNTIL PS-EO-HANG-FOLD-CSR OR                              10871018
108720              PS-HANG-FOLD-MIXED                                  10872018
108730      PERFORM 6550-CLOSE-HANG-FOLD-CSR.                           10873018
108740                                                                  10874018
108750******************************************************************10875018
108760 6450-OPEN-HANG-FOLD-CSR.                                         10876018
108770                                                                  10877018
108780         EXEC SQL                                                 10878018
108790              OPEN HANG_FOLD_CSR                                  10879018
108800         END-EXEC                                                 10880018
108810                                                                  10881018
108820                                                                  10882018
108830         EVALUATE TRUE                                            10883018
108840             WHEN SQLCODE = ZERO                                  10884018
108850                 CONTINUE                                         10885018
108860             WHEN SQLWARN0 NOT = SPACES                           10886018
108870             WHEN SQLCODE < ZERO                                  10887018
108880             WHEN SQLCODE > ZERO                                  10888018
108890                 SET  PS-SOCKET-ERROR         TO TRUE             10889018
108900                 SET  PC140-CRA-SOCKET-COMM-ERROR  TO TRUE        10890018
108910                 STRING ' PCKCS707 - '        DELIMITED BY SIZE   10891018
108920                 '6450-OPEN-HANG-FOLD' DELIMITED BY SIZE          10892018
108930                 'SQL CODE IS - '      DELIMITED BY SIZE          10893018
108940                 SQLCA                 DELIMITED BY SIZE          10894018
108950                                          INTO PV-CICS-MSG-AREA   10895018
108960                 SET PS-DUMP-TO-LOG       TO TRUE                 10896018
108970                 PERFORM 9990-WRITE-CICS                          10897018
108980         END-EVALUATE.                                            10898018
108990                                                                  10899018
109000                                                                  10900029
109010*----------------------------------------------------------------*10901018
109020*                                                                *10902018
109030*----------------------------------------------------------------*10903018
109040 6500-FETCH-HANG-FOLD-CSR.                                        10904018
109050                                                                  10905018
109060                                                                  10906018
109070     EXEC SQL                                                     10907018
109080        FETCH   HANG_FOLD_CSR                                     10908018
109090        INTO   :SUT00028-UPC-NBR                                  10909018
109100     END-EXEC.                                                    10910018
109110                                                                  10911018
109120     EVALUATE TRUE                                                10912018
109130       WHEN SQLCODE = ZEROS                                       10913018
109140            PERFORM 6575-GET-HANG-FOLD                            10914018
109150            IF XL001-VND-STYL-NOT-FOUND                           10915018
109160               CONTINUE                                           10916018
109170            ELSE                                                  10917018
109190              IF PS-BRAND-FOUND-NO                                10919018
109200                 PERFORM 6750-CHECK-BRAND                         10920018
109220              END-IF                                              10922018
109230                                                                  10923018
109240              IF PS-MERCH-PRES-FND-NO                             10924018
109250                EVALUATE TRUE                                     10925018
109260                  WHEN PV-HANG-FOLD-IND = 'H'                     10926018
109270                     MOVE 1 TO  PV-HNG-FOLD-SEQ-NBR               10927018
109280                     SET PS-MERCH-PRES-FND-YES TO TRUE            10928018
109290                  WHEN PV-HANG-FOLD-IND = 'F'                     10929018
109300                     MOVE 2 TO  PV-HNG-FOLD-SEQ-NBR               10930018
109310                     SET PS-MERCH-PRES-FND-YES TO TRUE            10931018
109320                  WHEN OTHER                                      10932018
109330                     MOVE  0  TO PV-HNG-FOLD-SEQ-NBR              10933018
109340                END-EVALUATE                                      10934018
109350              END-IF                                              10935018
109360            END-IF                                                10936018
109370                                                                  10937018
109380            IF PS-MERCH-PRES-FND-YES AND                          10938018
109400                          PS-BRAND-FOUND-NO                       10940018
109420                  SET PS-EO-HANG-FOLD-CSR TO TRUE                 10942018
109430            END-IF                                                10943018
109440       WHEN SQLCODE = +100                                        10944018
109450                SET  PS-EO-HANG-FOLD-CSR TO TRUE                  10945018
109460       WHEN OTHER                                                 10946018
109470             SET  PS-SOCKET-ERROR         TO TRUE                 10947018
109480             SET  PC140-CRA-SOCKET-COMM-ERROR  TO TRUE            10948018
109490             STRING ' PCKCS707 - '        DELIMITED BY SIZE       10949018
109500             '6450-FETCH-HANG-FLD' DELIMITED BY SIZE              10950018
109510             'SQL CODE IS - '      DELIMITED BY SIZE              10951018
109520             SQLCA                 DELIMITED BY SIZE              10952018
109530                                      INTO PV-CICS-MSG-AREA       10953018
109540             SET PS-DUMP-TO-LOG       TO TRUE                     10954018
109550             PERFORM 9990-WRITE-CICS                              10955018
109560     END-EVALUATE.                                                10956018
109570                                                                  10957018
109580                                                                  10958018
109590 6550-CLOSE-HANG-FOLD-CSR.                                        10959018
109600                                                                  10960018
109610         EXEC SQL                                                 10961018
109620             CLOSE HANG_FOLD_CSR                                  10962018
109630         END-EXEC                                                 10963018
109640                                                                  10964018
109650                                                                  10965018
109660         EVALUATE TRUE                                            10966018
109670             WHEN SQLCODE = ZERO                                  10967018
109680                 CONTINUE                                         10968018
109690             WHEN SQLWARN0 NOT = SPACES                           10969018
109700             WHEN SQLCODE < ZERO                                  10970018
109710             WHEN SQLCODE > ZERO                                  10971018
109720             SET  PS-SOCKET-ERROR         TO TRUE                 10972018
109730             SET  PC140-CRA-SOCKET-COMM-ERROR  TO TRUE            10973018
109740             STRING ' PCKCS707 - '        DELIMITED BY SIZE       10974018
109750             '6550-CLOSE-HANG-FLD' DELIMITED BY SIZE              10975018
109760             'SQL CODE IS - '      DELIMITED BY SIZE              10976018
109770             SQLCA                 DELIMITED BY SIZE              10977018
109780                                      INTO PV-CICS-MSG-AREA       10978018
109790             SET PS-DUMP-TO-LOG       TO TRUE                     10979018
109800             PERFORM 9990-WRITE-CICS                              10980018
109810         END-EVALUATE.                                            10981018
109820                                                                  10982018
109830                                                                  10983018
109840 EJECT                                                            10984018
109850 6575-GET-HANG-FOLD.                                              10985018
109860                                                                  10986018
109870     INITIALIZE XL001-ITEM-COMMAREA                               10987018
109880     SET XL001-SELECT-VND-STYL                                    10988018
109890         XL001-SELECT-SKU                                         10989018
109900         XL001-BY-UPC-NBR             TO TRUE                     10990018
109910                                                                  10991018
109920     MOVE  'V'               TO XL001-KEY-UPC-TYP-CDE             10992018
109930                                                                  10993018
109940     MOVE SUT00028-UPC-NBR            TO XL001-KEY-UPC-NBR        10994018
109950                                                                  10995018
109960     PERFORM 6576-CALL-XLKUT001-FOR-VNDUPC.                       10996018
109970                                                                  10997018
109980     EVALUATE TRUE                                                10998018
109990         WHEN XL001-UPC-SQLCODE = +100                            10999018
110000              MOVE ZERO TO PV-HNG-FOLD-SEQ-NBR                    11000018
110010         WHEN XL001-UPC-SQLCODE = 0                               11001018
110020              IF XL001-VND-STYL-SQLCODE = 0                       11002018
110030                 MOVE XL001-HNG-FOLD-CDE TO PV-HANG-FOLD-IND      11003018
110040              ELSE                                                11004018
110050                 IF XL001-VND-STYL-SQLCODE = +100                 11005018
110060                    MOVE SPACES TO PV-HANG-FOLD-IND               11006018
110070                 ELSE                                             11007018
110080                    SET  PS-SOCKET-ERROR                          11008018
110090                         PC140-CRA-SOCKET-COMM-ERROR              11009018
110100                                             TO TRUE              11010018
110110                    STRING ' PCKCS707 - '                         11011018
110120                    '6575-GET-HANG-FOLD '                         11012018
110130                    'SQL CODE IS - '                              11013018
110140                    XL001-SQLCA           DELIMITED BY SIZE       11014018
110150                                      INTO PV-CICS-MSG-AREA       11015018
110160                    SET PS-DUMP-TO-LOG       TO TRUE              11016018
110170                    PERFORM 9990-WRITE-CICS                       11017018
110180                 END-IF                                           11018018
110190              END-IF                                              11019018
110200         WHEN OTHER                                               11020018
110210              SET  PS-SOCKET-ERROR                                11021018
110220                   PC140-CRA-SOCKET-COMM-ERROR                    11022018
110230                                       TO TRUE                    11023018
110240              STRING ' PCKCS707 - '                               11024018
110250              '6575-GET-HANG-FOLD2 '                              11025018
110260              'SQL CODE IS - '                                    11026018
110270              XL001-SQLCA           DELIMITED BY SIZE             11027018
110280                                INTO PV-CICS-MSG-AREA             11028018
110290              SET PS-DUMP-TO-LOG       TO TRUE                    11029018
110300              PERFORM 9990-WRITE-CICS                             11030018
110310     END-EVALUATE.                                                11031018
110320                                                                  11032018
110330                                                                  11033018
110340 6576-CALL-XLKUT001-FOR-VNDUPC.                                   11034018
110350                                                                  11035018
110360     PERFORM 8600-CALL-XLKUT001.                                  11036018
110370                                                                  11037018
110380     EVALUATE TRUE                                                11038018
110390         WHEN XL001-UPC-SQLCODE = +100                            11039018
110400              MOVE  'I'        TO XL001-KEY-UPC-TYP-CDE           11040018
110410              PERFORM 8600-CALL-XLKUT001                          11041018
110420     END-EVALUATE.                                                11042018
110430                                                                  11043018
110440                                                                  11044018
110450                                                                  11045018
110460 6700-LINK-XLKUT073.                                              11046018
110470                                                                  11047018
110480     INITIALIZE XL073-COMMAREA-REC                                11048018
110490                                                                  11049018
110500     MOVE XL001-DEPT-NBR     TO  PV-XL-DEPT-NBR.                  11050018
110510                                                                  11051018
110520     IF  PV-XL-DEPT-NBR  =  0                                     11052018
110530         MOVE PC140-RF-DEPT           TO XL073-DEPT-NBR           11053018
110540     ELSE                                                         11054018
110550         MOVE XL001-DEPT-NBR          TO XL073-DEPT-NBR           11055018
110560     END-IF.                                                      11056018
110570                                                                  11057018
110580     CALL XL073-DEPT-CL-MODULE USING DFHEIBLK                     11058018
110590                                     XL073-COMMAREA               11059018
110600                                     XL073-COMMAREA-REC           11060018
110610                                                                  11061018
110620     EVALUATE TRUE                                                11062018
110630         WHEN XL073-NO-ERRORS                                     11063018
110640             MOVE XL073-BUS-AREA-ID  TO PC256-MDSE-GROUP          11064018
110650                                        PC253-MDSE-GROUP          11065018
110670         WHEN XL073-DEPT-NOT-FND                                  11067018
110680         WHEN XL073-MAJ-CL-NOT-FND                                11068018
110690         WHEN XL073-SUB-CL-NOT-FND                                11069018
110700                MOVE '@@'            TO PC256-MDSE-GROUP          11070018
110710                                        PC253-MDSE-GROUP          11071018
110730         WHEN OTHER                                               11073018
110740                 SET  PS-SOCKET-ERROR         TO TRUE             11074018
110750                 SET  PC140-CRA-SOCKET-COMM-ERROR  TO TRUE        11075018
110760                 STRING ' PCKCS707 - '        DELIMITED BY SIZE   11076018
110770                 '6700-LINK-XLKUT073 '                            11077018
110780                 'TABLE NAME  - '                                 11078018
110790                 XL073-DB2-TABLE                                  11079018
110800                 '  RETURN CODE='                                 11080018
110810                 XL073-SQLCODE                 DELIMITED BY SIZE  11081018
110820                                          INTO PV-CICS-MSG-AREA   11082018
110830                 SET PS-DUMP-TO-LOG       TO TRUE                 11083018
110840                 PERFORM 9990-WRITE-CICS                          11084018
110850     END-EVALUATE.                                                11085018
110860                                                                  11086018
110870                                                                  11087018
110890 6750-CHECK-BRAND.                                                11089018
110900                                                                  11090018
110910      MOVE XL001-SKU-NBR     TO XLT00003-SKU-NBR.                 11091018
110920                                                                  11092018
110930     EXEC SQL                                                     11093018
110940        SELECT  BRND_DESC                                         11094018
110950         INTO   :XLT00043-BRND-DESC                               11095018
110960          FROM  XLT_SKU      A                                    11096018
110970             ,  XLT_VND_STYL B                                    11097018
110980             ,  XLT_BRND     C                                    11098018
110990         WHERE  SKU_NBR           =  :XLT00003-SKU-NBR            11099018
111000           AND  A.STYL_ID         =  B.STYL_ID                    11100018
111010           AND  B.BRND_ID         =  C.BRND_ID                    11101018
111020           AND  C.BRND_ID         >  0                            11102018
111030     END-EXEC.                                                    11103018
111040                                                                  11104018
111050      EVALUATE TRUE                                               11105018
111060          WHEN SQLCODE = ZERO                                     11106018
111070               SET PS-BRAND-FOUND-YES           TO TRUE           11107018
111080          WHEN SQLCODE = +100                                     11108018
111090               SET PS-BRAND-FOUND-NO            TO TRUE           11109018
111100         WHEN SQLCODE = -904                                      11110018
111110         WHEN SQLCODE = -911                                      11111018
111120         WHEN SQLCODE = -913                                      11112018
111130             MOVE 'XLT_BRND        '  TO PV-DISP-TABLE-1          11113018
111140             PERFORM 9955-SQL-ERROR                               11114018
111150             SET  PS-SOCKET-ERROR         TO TRUE                 11115018
111160             SET  PC140-CRA-SOCKET-COMM-ERROR  TO TRUE            11116018
111170             SET PS-DUMP-TO-LOG       TO TRUE                     11117018
111180             PERFORM 9990-WRITE-CICS                              11118018
111190                                                                  11119018
111200         WHEN SQLWARN0 NOT = SPACES                               11120018
111210         WHEN SQLCODE < ZERO                                      11121018
111220         WHEN SQLCODE > ZERO                                      11122018
111230             MOVE 'XLT_BRND        '  TO PV-DISP-TABLE-1          11123018
111240             PERFORM 9955-SQL-ERROR                               11124018
111250     END-EVALUATE.                                                11125018
111270                                                                  11127018
111280 6800-SELECT-AUDIT-STATUS.                                        11128018
111290                                                                  11129018
111300      EVALUATE TRUE                                               11130018
111310        WHEN PC140-RF-AUDIT-STATUS = 'A'                          11131018
111320            SET PS-100-PERCENT TO TRUE                            11132018
111330        WHEN PC140-RF-AUDIT-STATUS = 'I'                          11133018
111340            SET PS-AUDIT-UNKNOWN TO TRUE                          11134018
111350        WHEN PC140-RF-AUDIT-STATUS = 'F'                          11135018
111360            SET PS-REWORK TO TRUE                                 11136018
111370        WHEN OTHER                                                11137018
111380            SET PS-AUDIT-COMPLETE TO TRUE                         11138018
111390      END-EVALUATE.                                               11139018
111400                                                                  11140018
111410     MOVE PC140-RF-KOHLS-BARCODE  TO SULBXF-BRCDE-NBR.            11141018
111420                                                                  11142018
111430     EXEC SQL                                                     11143018
111440          SELECT C.AUD_CNTL_NBR                                   11144018
111450            INTO :SUATRN-AUD-CNTL-NBR                             11145018
111460            FROM TSULBXF A                                        11146018
111470               , TSUATRN B                                        11147018
111480               , SUT_PO_AUD_REQ C                                 11148018
111490           WHERE A.BRCDE_NBR        = :SULBXF-BRCDE-NBR           11149018
111500             AND A.SHIPT_UNT_ID     = B.SHIPT_UNT_ID              11150018
111510             AND A.STAT_CDE         = 'A'                         11151018
111520             AND B.AUD_CNTL_NBR     = C.AUD_CNTL_NBR              11152018
111530     END-EXEC.                                                    11153018
111540                                                                  11154018
111550     MOVE SQLCODE TO    PV-SQLCODE                                11155018
111560     STRING ' PCKCS707 - 6800-SELECT-AUDIT-STATUS '               11156018
111570            ' SQLCODE = ' PV-SQLCODE                              11157018
111580         DELIMITED BY SIZE INTO PV-CICS-MSG-AREA                  11158018
111590     PERFORM 9990-WRITE-CICS                                      11159018
111600                                                                  11160018
111610     EVALUATE TRUE                                                11161018
111620         WHEN SQLCODE = ZERO                                      11162018
111630             SET PC255-AUDIT-YES TO TRUE                          11163018
111640         WHEN SQLCODE = +100                                      11164018
111650             SET PC255-AUDIT-NO TO TRUE                           11165018
111660         WHEN SQLCODE = -904                                      11166018
111670         WHEN SQLCODE = -911                                      11167018
111680         WHEN SQLCODE = -913                                      11168018
111690             MOVE 'TSULBXF'           TO PV-DISP-TABLE-1          11169018
111700             PERFORM 9955-SQL-ERROR                               11170018
111710             SET  PS-SOCKET-ERROR         TO TRUE                 11171018
111720             SET  PC140-CRA-SOCKET-COMM-ERROR  TO TRUE            11172018
111730             SET PS-DUMP-TO-LOG       TO TRUE                     11173018
111740             PERFORM 9990-WRITE-CICS                              11174018
111750                                                                  11175018
111760         WHEN SQLWARN0 NOT = SPACES                               11176018
111770         WHEN SQLCODE < ZERO                                      11177018
111780         WHEN SQLCODE > ZERO                                      11178018
111790             MOVE 'TKRPRPM'           TO PV-DISP-TABLE-1          11179018
111800             PERFORM 9955-SQL-ERROR                               11180018
111810     END-EVALUATE.                                                11181018
111820                                                                  11182029
111830 6820-SELECT-EAS-TAG-IND.                                         11183018
111840                                                                  11184018
111850     EXEC SQL                                                     11185018
111860          SELECT EAS_TAG_IND                                      11186018
111870            INTO :SUT00024-EAS-TAG-IND                            11187018
111880            FROM SUT_OTBND_CART                                   11188018
111890          WHERE  SHIPT_UNT_ID   = :SUT00028-SHIPT-UNT-ID          11189018
111900            AND  ACTV_IND       = 'Y'                             11190018
111910     END-EXEC.                                                    11191018
111920                                                                  11192018
111930                                                                  11193018
111940     EVALUATE TRUE                                                11194018
111950         WHEN SQLCODE = ZERO                                      11195018
111960             IF SUT00024-EAS-TAG-IND = 'Y'                        11196018
111970                SET PC256-EAS-TAG-YES                             11197018
111980                    PC255-EAS-TAG-NEEDED                          11198018
111990                    PC253-EAS-TAG-NEEDED TO TRUE                  11199018
112000             ELSE                                                 11200018
112010                SET PC256-EAS-TAG-NO                              11201018
112020                    PC255-EAS-TAG-NOT-NEEDED                      11202018
112030                    PC253-EAS-TAG-NOT-NEEDED TO TRUE              11203018
112040             END-IF                                               11204018
112050         WHEN SQLCODE = +100                                      11205018
112060             SET PC256-EAS-TAG-NO                                 11206018
112070                 PC255-EAS-TAG-NOT-NEEDED                         11207018
112080                 PC253-EAS-TAG-NOT-NEEDED TO TRUE                 11208018
112090         WHEN SQLCODE = -904                                      11209018
112100         WHEN SQLCODE = -911                                      11210018
112110         WHEN SQLCODE = -913                                      11211018
112120             MOVE SQLCODE TO    PV-SQLCODE                        11212018
112130             STRING ' PCKCS707 - 6800-SELECT-AUDIT-STATUS '       11213018
112140                    ' SQLCODE = ' PV-SQLCODE                      11214018
112150                 DELIMITED BY SIZE INTO PV-CICS-MSG-AREA          11215018
112160             PERFORM 9990-WRITE-CICS                              11216018
112170             MOVE 'SUT_OTBND_CART '   TO PV-DISP-TABLE-1          11217018
112180             PERFORM 9955-SQL-ERROR                               11218018
112190             SET  PS-SOCKET-ERROR         TO TRUE                 11219018
112200             SET  PC140-CRA-SOCKET-COMM-ERROR  TO TRUE            11220018
112210             SET PS-DUMP-TO-LOG       TO TRUE                     11221018
112220             PERFORM 9990-WRITE-CICS                              11222018
112230                                                                  11223018
112240         WHEN SQLWARN0 NOT = SPACES                               11224018
112250         WHEN SQLCODE < ZERO                                      11225018
112260         WHEN SQLCODE > ZERO                                      11226018
112270             MOVE SQLCODE TO    PV-SQLCODE                        11227018
112280             STRING ' PCKCS707 - 6800-SELECT-AUDIT-STATUS '       11228018
112290                    ' SQLCODE = ' PV-SQLCODE                      11229018
112300                 DELIMITED BY SIZE INTO PV-CICS-MSG-AREA          11230018
112310             PERFORM 9990-WRITE-CICS                              11231018
112320             MOVE 'SUT_OTBND_CART'    TO PV-DISP-TABLE-1          11232018
112330             PERFORM 9955-SQL-ERROR                               11233018
112340     END-EVALUATE.                                                11234018
112350                                                                  11235029
112360 6830-GET-CURRENT-DOOR.                                           11236018
112370                                                                  11237018
112380     MOVE PC140-RF-STR-NBR  TO CNDRST-STR-NBR.                    11238018
112390     MOVE PC140-CRA-OPER-UNT-ID  TO CNDCDR-OPER-UNT-ID.           11239018
112400                                                                  11240018
112410     EXEC SQL                                                     11241018
112420          SELECT A.DOOR_ID                                        11242018
112430          INTO   :CNDCDR-DOOR-ID                                  11243018
112440          FROM   TCNDCDR A                                        11244018
112450               , TCNDRST B                                        11245018
112460          WHERE  A.DOOR_ID         = B.DOOR_ID                    11246018
112470            AND  A.OPER_UNT_ID     = :CNDCDR-OPER-UNT-ID          11247018
112480            AND  A.OPER_UNT_ID     = B.OPER_UNT_ID                11248018
112490            AND  A.DOOR_TYP_CDE    = 'SH'                         11249018
112500            AND  B.STR_NBR         = :CNDRST-STR-NBR              11250018
112510            AND  B.END_TMST        = '9999-09-09-09.09.09.999999' 11251018
112520            AND  NOT   (DOOR_LOC_DESC  LIKE  '%UPS%'     OR       11252018
112530                        DOOR_LOC_DESC  LIKE  '%VIRTUAL%' OR       11253018
112540                        DOOR_LOC_DESC  LIKE  '%RE-OPEN%'          11254018
112550                       )                                          11255018
112560     END-EXEC.                                                    11256018
112570                                                                  11257018
112580                                                                  11258018
112590     EVALUATE TRUE                                                11259018
112600         WHEN SQLCODE = ZERO                                      11260018
112610             MOVE CNDCDR-DOOR-ID TO PC256-DOOR-NUMBER             11261018
112620                                    PC254-DOOR-NUMBER             11262018
112630         WHEN SQLCODE = +100                                      11263018
112640         WHEN SQLCODE = -811                                      11264018
112650             SET PC256-DOOR-NBR-NO                                11265018
112660                 PC254-DOOR-NBR-NO TO TRUE                        11266018
112670         WHEN SQLCODE = -904                                      11267018
112680         WHEN SQLCODE = -911                                      11268018
112690         WHEN SQLCODE = -913                                      11269018
112700             MOVE SQLCODE TO    PV-SQLCODE                        11270018
112710             STRING ' PCKCS707 - 6830-GET-CURRENT-DOOR  '         11271018
112720                    ' SQLCODE = ' PV-SQLCODE                      11272018
112730                 DELIMITED BY SIZE INTO PV-CICS-MSG-AREA          11273018
112740             PERFORM 9990-WRITE-CICS                              11274018
112750             MOVE 'TCNDCDR '   TO PV-DISP-TABLE-1                 11275018
112760             PERFORM 9955-SQL-ERROR                               11276018
112770             SET  PS-SOCKET-ERROR         TO TRUE                 11277018
112780             SET  PC140-CRA-SOCKET-COMM-ERROR  TO TRUE            11278018
112790             SET PS-DUMP-TO-LOG       TO TRUE                     11279018
112800             PERFORM 9990-WRITE-CICS                              11280018
112810                                                                  11281018
112820         WHEN SQLWARN0 NOT = SPACES                               11282018
112830         WHEN SQLCODE < ZERO                                      11283018
112840         WHEN SQLCODE > ZERO                                      11284018
112850             MOVE SQLCODE TO    PV-SQLCODE                        11285018
112860             STRING ' PCKCS707 - 6830-GET-CURRENT-DOOR  '         11286018
112870                    ' SQLCODE = ' PV-SQLCODE                      11287018
112880                 DELIMITED BY SIZE INTO PV-CICS-MSG-AREA          11288018
112890             PERFORM 9990-WRITE-CICS                              11289018
112900             MOVE 'TCNDCDR  '    TO PV-DISP-TABLE-1               11290018
112910             PERFORM 9955-SQL-ERROR                               11291018
112920     END-EVALUATE.                                                11292018
112930                                                                  11293029
112940 6850-CALL-STORE-ON-HAND-MOD.                                     11294018
112950     INITIALIZE XL088-ITEM-COMMAREA.                              11295018
112960     SET  XL088-ONHAND-YES        TO TRUE                         11296018
112970     MOVE PC140-RF-PO-NBR         TO XL088-KEY-PO.                11297018
112980     MOVE PC140-RF-PO-RCVR        TO XL088-KEY-REC-SEQ-NBR.       11298018
112990     MOVE PC140-RF-STR-NBR        TO PV-4-DGT-STR-NBR.            11299018
113000     MOVE PV-4-DGT-STR-NBR        TO XL088-KEY-STR-NBR.           11300018
113010     MOVE PC140-CRA-OPER-UNT-ID   TO XL088-OPER-UNT-ID.           11301018
113020                                                                  11302018
113030     SET XL088-BY-OTBND-CRTN TO TRUE.                             11303018
113040     MOVE SUT00028-SHIPT-UNT-ID TO XL088-OTBND-CRTN.              11304018
113050                                                                  11305018
113060     CALL XL088-USER-PGM USING DFHEIBLK                           11306018
113070                               XL088-COMMAREA                     11307018
113080                               XL088-ITEM-COMMAREA.               11308018
113090     EVALUATE TRUE                                                11309018
113100         WHEN XL088-SUCCESSFUL                                    11310018
113110           IF XL088-NO-PROCESS-MESSAGE                            11311018
113120               SET PC255-OH-ZERO-NO                               11312018
113130                   PC256-OH-ZERO-MSG-NO                           11313018
113140                   PC253-OH-ZERO-NO                               11314018
113150                   PC254-OH-ZERO-MSG-NO TO TRUE                   11315018
113160           ELSE                                                   11316018
113170               SET PC255-OH-ZERO-YES                              11317018
113180                   PC256-OH-ZERO-MSG-YES                          11318018
113190                   PC253-OH-ZERO-YES                              11319018
113200                   PC254-OH-ZERO-MSG-YES TO TRUE                  11320018
113210              MOVE XL088-PROCESS-MESSAGE-TXT                      11321018
113220                       TO PC256-ON-HAND-ERR-MSG                   11322018
113230              IF XL088-FIRST-STORE-RCPT                           11323018
113240                 MOVE PV-FIRST-STORE-RCPT-TXT-1 TO                11324018
113250                                          PC256-TEXT-1            11325018
113260                                          PC254-TEXT-LINE-1       11326018
113270                 MOVE PV-FIRST-STORE-RCPT-TXT-2 TO                11327018
113280                                          PC256-TEXT-2            11328018
113290                                          PC254-TEXT-LINE-2       11329018
113300                 MOVE PV-FIRST-STORE-RCPT-TXT-3 TO                11330018
113310                                          PC256-TEXT-3            11331018
113320                                          PC254-TEXT-LINE-3       11332018
113330                 SET PC256-TEXT-4-NO      TO TRUE                 11333018
113340                 SET PC254-NO-TEXT-LINE-4 TO TRUE                 11334018
113350              ELSE                                                11335018
113360                 SET PC256-TEXT-1-NO                              11336018
113370                     PC256-TEXT-2-NO                              11337018
113380                     PC256-TEXT-3-NO                              11338018
113390                     PC256-TEXT-4-NO                              11339018
113400                     PC254-NO-TEXT-LINE-1                         11340018
113410                     PC254-NO-TEXT-LINE-2                         11341018
113420                     PC254-NO-TEXT-LINE-3                         11342018
113430                     PC254-NO-TEXT-LINE-4 TO TRUE                 11343018
113440              END-IF                                              11344018
113450           END-IF                                                 11345018
113460         WHEN OTHER                                               11346018
113470             MOVE 'XLKUT088'           TO PV-DISP-TABLE-1         11347018
113480             MOVE XL088-RETURN-SQLCODE TO SQLCODE                 11348018
113490             PERFORM 9955-SQL-ERROR                               11349018
113500             SET  PS-SOCKET-ERROR         TO TRUE                 11350018
113510             SET  PC140-CRA-SOCKET-COMM-ERROR  TO TRUE            11351018
113520             SET PS-DUMP-TO-LOG       TO TRUE                     11352018
113530             PERFORM 9990-WRITE-CICS                              11353018
113540     END-EVALUATE.                                                11354018
113550                                                                  11355018
113560 7100-SELECT-TKRPRPM.                                             11356018
113570                                                                  11357018
113580     STRING ' 7100-SELECT-TKRPRPM'                                11358018
113590         DELIMITED BY SIZE                                        11359018
113600         INTO PV-CICS-MSG-AREA                                    11360018
113610                                                                  11361018
113620     MOVE KRPRPM-LOC-ID TO PV-DISP-LOC                            11362018
113630     STRING ' LOC = ' PV-DISP-LOC                                 11363018
113640         ' FUNC CODE = ' DK-SYS-PRC-FUNC-CDE                      11364018
113650         DELIMITED BY SIZE INTO PV-CICS-MSG-AREA                  11365018
113660     PERFORM 9990-WRITE-CICS                                      11366018
113670                                                                  11367018
113680                                                                  11368018
113690     EXEC SQL                                                     11369018
113700          SELECT FUNC_TXT                                         11370018
113710            INTO :KRPRPM-FUNC-TXT                                 11371018
113720            FROM TKRPRPM                                          11372018
113730           WHERE LOC_ID            = :KRPRPM-LOC-ID               11373018
113740             AND INTFC_SYS_CDE    = 'KHL'                         11374018
113750             AND SYS_PRC_FUNC_CDE = :DK-SYS-PRC-FUNC-CDE          11375018
113760             AND FUNC_PRC_STAT_CDE = 'AC'                         11376018
113770     END-EXEC.                                                    11377018
113780                                                                  11378018
113790     MOVE SQLCODE TO    PV-SQLCODE                                11379018
113800     STRING ' PCKCS707 - 7100-SELECT-TKRPRPM - '                  11380018
113810            ' SQLCODE = ' PV-SQLCODE                              11381018
113820         DELIMITED BY SIZE INTO PV-CICS-MSG-AREA                  11382018
113840     PERFORM 9990-WRITE-CICS                                      11384018
113850                                                                  11385018
113860     EVALUATE TRUE                                                11386018
113870         WHEN SQLCODE = ZERO                                      11387018
113880             IF KRPRPM-FUNC-TXT = 'Y'                             11388018
113890                 SET PS-SHOW-DEBUG-INFO                           11389018
113900                                      TO TRUE                     11390018
113910             ELSE                                                 11391018
113920                 SET PS-DONT-SHOW-DEBUG-INFO                      11392018
113930                                      TO TRUE                     11393018
113940             END-IF                                               11394018
113950         WHEN SQLCODE = +100                                      11395018
113960             SET PS-DONT-SHOW-DEBUG-INFO                          11396018
113970                                      TO TRUE                     11397018
113980         WHEN SQLCODE = -904                                      11398018
113990         WHEN SQLCODE = -911                                      11399018
114000         WHEN SQLCODE = -913                                      11400018
114010             MOVE 'TKRPRPM'           TO PV-DISP-TABLE-1          11401018
114020             PERFORM 9955-SQL-ERROR                               11402018
114040             SET  PS-SOCKET-ERROR         TO TRUE                 11404018
114050             SET  PC140-CRA-SOCKET-COMM-ERROR  TO TRUE            11405018
114060             SET PS-DUMP-TO-LOG       TO TRUE                     11406018
114070             PERFORM 9990-WRITE-CICS                              11407018
114080                                                                  11408018
114100         WHEN SQLWARN0 NOT = SPACES                               11410018
114110         WHEN SQLCODE < ZERO                                      11411018
114120         WHEN SQLCODE > ZERO                                      11412018
114130             MOVE 'TKRPRPM'           TO PV-DISP-TABLE-1          11413018
114140             PERFORM 9955-SQL-ERROR                               11414018
114150     END-EVALUATE.                                                11415018
114160                                                                  11416029
114170 8600-CALL-XLKUT001.                                              11417018
114180                                                                  11418018
114190     CALL XL001-VSM-PGM  USING DFHEIBLK                           11419018
114200                              XL001-COMMAREA                      11420018
114210                              XL001-ITEM-COMMAREA.                11421018
114220                                                                  11422018
114230     EVALUATE TRUE                                                11423018
114240         WHEN XL001-SUCCESSFUL                                    11424018
114250         WHEN XL001-UPC-NOT-FOUND                                 11425018
114260         WHEN XL001-VND-STYL-NOT-FOUND                            11426018
114270             CONTINUE                                             11427018
114280         WHEN XL001-SQL-ERROR                                     11428018
114290         WHEN XL001-INVALID-ACCESS                                11429018
114300             MOVE 'XLKUT001'          TO PV-DISP-TABLE-1          11430018
114310             PERFORM 9955-SQL-ERROR                               11431018
114320             SET  PS-SOCKET-ERROR         TO TRUE                 11432018
114330             SET  PC140-CRA-SOCKET-COMM-ERROR  TO TRUE            11433018
114340             SET PS-DUMP-TO-LOG       TO TRUE                     11434018
114350             PERFORM 9990-WRITE-CICS                              11435018
114360                                                                  11436018
114370         WHEN OTHER                                               11437018
114380             MOVE 'XLKUT001'          TO PV-DISP-TABLE-1          11438018
114390             PERFORM 9955-SQL-ERROR                               11439018
114400     END-EVALUATE.                                                11440018
114410                                                                  11441029
114570 9955-SQL-ERROR.                                                  11457018
114580                                                                  11458018
114600     MOVE SQLCODE                     TO PV-SQLCODE               11460018
114610     STRING ' SQLCODE = ' PV-SQLCODE                              11461018
114620         ' TABLE(S) = '                                           11462018
114630         PV-DISP-TABLE-1 ' '                                      11463018
114640         PV-DISP-TABLE-2 ' '                                      11464018
114650         PV-DISP-TABLE-3                                          11465018
114660         DELIMITED BY SIZE                                        11466018
114670         INTO PV-CICS-MSG-AREA                                    11467018
114680                                                                  11468018
114690     PERFORM 9991-WRITEQ.                                         11469018
114700                                                                  11470018
114710     CALL 'DSNTIAR' USING SQLCA                                   11471018
114720                          DP004-FORMATTED-MESSAGE                 11472018
114730                          DP004-ERROR-LINE-LENGTH.                11473018
114740                                                                  11474018
114750     MOVE DP004-ASTERISK-LINE         TO PV-CICS-MSG-AREA         11475018
114760     PERFORM 9991-WRITEQ                                          11476018
114770                                                                  11477018
114780     PERFORM                                                      11478018
114790         VARYING DP004-MSG-IDX                                    11479018
114800         FROM 1 BY 1                                              11480018
114810         UNTIL DP004-MSG-IDX > DP004-MAX-MESSAGE-LINES            11481018
114820              MOVE DP004-MESSAGE-LINE (DP004-MSG-IDX)             11482018
114830                                      TO PV-CICS-MSG-AREA         11483018
114840              PERFORM 9991-WRITEQ                                 11484018
114850                                                                  11485018
114860     END-PERFORM.                                                 11486018
114870                                                                  11487018
114871                                                                  11487129
114872******************************************************************11487229
114873* IF YOU'RE AT THE LAST OCCURRENCE OF THE TABLE,                  11487329
114874* THE NEXT MESSAGE WILL GO INTO THE FIRST OCCURRENCE.  KEEP       11487429
114875* INCREMENTING THE SEQUENCE SO THAT IF THE TABLE IS DUMPED TO THE 11487529
114876* LOG YOU WILL BE ABLE TO SEE THE LAST 200 LINES AND HOW THEY     11487629
114877* WRAPPED AROUND.                                                 11487729
114878******************************************************************11487829
114880 9990-WRITE-CICS.                                                 11488018
114950                                                                  11495018
114960     EVALUATE TRUE                                                11496018
114970     WHEN PT-MSG-IDX < PC-MSG-TABLE-SIZE                          11497018
114980         MOVE PV-CICS-MSG-AREA        TO PT-MSG-LINE (PT-MSG-IDX) 11498018
114990         MOVE PT-MSG-SEQ (PT-MSG-IDX) TO PV-PREV-SEQUENCE         11499018
115000         SET PT-MSG-IDX UP BY 1                                   11500018
115010     WHEN PT-MSG-IDX = PC-MSG-TABLE-SIZE                          11501018
115020         MOVE PV-CICS-MSG-AREA        TO PT-MSG-LINE (PT-MSG-IDX) 11502018
115030         MOVE PT-MSG-SEQ (PT-MSG-IDX) TO PV-PREV-SEQUENCE         11503018
115040         SET PT-MSG-IDX               TO 1                        11504018
115050     END-EVALUATE                                                 11505018
115060                                                                  11506018
115070     COMPUTE PV-NEXT-SEQUENCE = PV-PREV-SEQUENCE + 1              11507018
115080     MOVE PV-NEXT-SEQUENCE            TO PT-MSG-SEQ (PT-MSG-IDX)  11508018
115090                                                                  11509018
115100                                                                  11510018
115110*  IF THE DC HAS TRACE PROCESSING TURNED ON, ALL MESSAGES WILL    11511018
115120*  BE DISPLAYED AS THEY OCCUR.  DUMPING THE MESSAGE TABLE WILL    11512018
115130*  BE UNNECESSARY BECAUSE OF THE REAL-TIME DISPLAYS.              11513018
115140*                                                                 11514018
115150     IF PS-SHOW-DEBUG-INFO                                        11515018
115160         PERFORM 9991-WRITEQ                                      11516018
115170     END-IF                                                       11517018
115180     MOVE SPACES                      TO PV-CICS-MSG-AREA.        11518018
115190                                                                  11519018
115200 9991-WRITEQ.                                                     11520018
115210     EXEC CICS                                                    11521018
115220         WRITEQ TD                                                11522018
115230         QUEUE(PC-CSSL)                                           11523018
115240         FROM(PV-CICS-MSG-AREA)                                   11524018
115250         RESP(PV-CICS-RESPONSE)                                   11525018
115260     END-EXEC.                                                    11526018
115270                                                                  11527018
115271***************************************************************** 11527129
115272*  IF AN ERROR HAS OCCURRED, DUMP THE MESSAGE TABLE WHICH WILL    11527229
115273*  CONTAIN THE LAST 200 TRACE DISPLAYS.  IF THE TABLE EVER        11527329
115274*  OVERFLOWS, YOU WILL SEE THE SEQUENCE NUMBERS WRAP.  UNUSED     11527429
115275*  OCCURENCES ARE NOT DISPLAYED.                                  11527529
115276***************************************************************** 11527629
115280 9999-FINAL-DUMP.                                                 11528018
115340                                                                  11534018
115350     STRING ' 9999-FINAL-DUMP'                                    11535018
115360         DELIMITED BY SIZE                                        11536018
115370         INTO PV-CICS-MSG-AREA                                    11537018
115380     PERFORM 9990-WRITE-CICS                                      11538018
115390                                                                  11539018
115400         EXEC CICS ENQ                                            11540018
115410             RESOURCE(PC-CSSL)                                    11541018
115420         END-EXEC                                                 11542018
115430                                                                  11543018
115440         MOVE PV-TASK                 TO PV-DISP-TASK             11544018
115450         PERFORM VARYING PT-MSG-IDX FROM 1 BY 1 UNTIL             11545018
115460                         PT-MSG-IDX > PC-MSG-TABLE-SIZE           11546018
115470             IF PT-MSG-SEQ (PT-MSG-IDX) > ZERO                    11547018
115480                 MOVE PT-MSG-SEQ (PT-MSG-IDX)                     11548018
115490                                      TO PV-DISP-MSG-NBR          11549018
115500                 STRING ' ' PV-DISP-TASK ' '                      11550018
115510                      PV-DISP-MSG-NBR ' '                         11551018
115520                      PT-MSG-LINE (PT-MSG-IDX)                    11552018
115530                      DELIMITED BY SIZE                           11553018
115540                                    INTO PV-CICS-MSG-AREA         11554018
115550                 PERFORM 9991-WRITEQ                              11555018
115560             END-IF                                               11556018
115570         END-PERFORM                                              11557018
115580                                                                  11558018
115590         SET PT-MSG-IDX               TO 1                        11559018
115600         SET PS-DONT-DUMP-TO-LOG      TO TRUE                     11560018
115610                                                                  11561018
115620         EXEC CICS DEQ                                            11562018
115630             RESOURCE(PC-CSSL)                                    11563018
115640         END-EXEC.                                                11564018
115650                                                                  11565018
