00001 ******************************************************************01/17/96
00002  IDENTIFICATION DIVISION.                                         RCK00213
00003 ******************************************************************   LV002
00004                                                                   RCK00213
00005  PROGRAM-ID.             RCKUT990.                                RCK00213
00006  AUTHOR.                 BETH A. BILSKI.                          RCK00213
00007  INSTALLATION.           KOHLS.                                   RCK00213
00008  DATE-WRITTEN            JANUARY 1996.                            RCK00213
00009  DATE-COMPILED.                                                   RCK00213
00010                                                                   RCK00213
00011 ******************************************************************RCK00213
00012 *   THE PURPOSE OF THIS PROGRAM IS TO READ THE VERIFIED           RCK00213
00013 *   EXTRACT FILE AND ELIMINATE ANY PO'S THAT ARE IN ERROR.        RCK00213
00014 *   PO'S THAT ARE IN ERROR ARE FOUND ON THE PO ERROR FILE.        RCK00213
00015 ******************************************************************RCK00213
00016  ENVIRONMENT DIVISION.                                            RCK00213
00017                                                                   RCK00213
00018  CONFIGURATION SECTION.                                           RCK00213
00019                                                                   RCK00213
00020  SOURCE-COMPUTER.        IBM-3090.                                RCK00213
00021  OBJECT-COMPUTER.        IBM-3090.                                RCK00213
00022                                                                   RCK00213
00023  INPUT-OUTPUT SECTION.                                            RCK00213
00024                                                                   RCK00213
00025  FILE-CONTROL.                                                    RCK00213
00026                                                                   RCK00213
00027      SELECT PO-FILE-IN                                            RCK00213
00028          ASSIGN TO INP01.                                         RCK00213
00029                                                                   RCK00213
00030      SELECT PO-ERROR-FILE                                         RCK00213
00031          ASSIGN TO INP02.                                         RCK00213
00032                                                                   RCK00213
00033      SELECT PO-FILE-OUT                                           RCK00213
00034          ASSIGN TO OUT01.                                         RCK00213
00035                                                                   RCK00213
00036 ******************************************************************RCK00213
00037  DATA DIVISION.                                                   RCK00213
00038 ******************************************************************RCK00213
00039                                                                   RCK00213
00040  FILE SECTION.                                                    RCK00213
00041                                                                   RCK00213
00042  FD  PO-FILE-IN                                                   RCK00213
00043      RECORDING MODE IS F                                          RCK00213
00044      BLOCK CONTAINS 0 RECORDS                                     RCK00213
00045      LABEL RECORDS ARE STANDARD.                                  RCK00213
00046                                                                   RCK00213
00047  01  PO-FILE-IN-REC                          PIC X(080).          RCK00213
00048                                                                   RCK00213
00049  FD  PO-ERROR-FILE                                                RCK00213
00050      RECORDING MODE IS F                                          RCK00213
00051      BLOCK CONTAINS 0 RECORDS                                     RCK00213
00052      LABEL RECORDS ARE STANDARD.                                  RCK00213
00053                                                                   RCK00213
00054  01  PO-ERROR-FILE-REC                       PIC X(080).          RCK00213
00055                                                                   RCK00213
00056  FD  PO-FILE-OUT                                                  RCK00213
00057      RECORDING MODE IS F                                          RCK00213
00058      BLOCK CONTAINS 0 RECORDS                                     RCK00213
00059      LABEL RECORDS ARE STANDARD.                                  RCK00213
00060                                                                   RCK00213
00061  01  PO-FILE-OUT-REC                         PIC X(080).          RCK00213
00062                                                                   RCK00213
00063 ******************************************************************RCK00213
00064  WORKING-STORAGE SECTION.                                         RCK00213
00065 ******************************************************************RCK00213
00066                                                                   RCK00213
00067  01  ABEND-CODE                          PIC S9(04)  VALUE +0     RCK00213
00068                                                      COMP SYNC.   RCK00213
00069  01  WS-ERROR-PO-RECORD.                                          RCK00213
00070      05  WS-PO-NBR                       PIC S9(09) COMP.         RCK00213
00071      05  FILLER                          PIC X(76).               RCK00213
00072 *                                                                 RCK00213
00073      COPY RCRD050.                                                RCK00213
00074 *                                                                 RCK00213
00075  01  WS-ERROR-PO-TABLE.                                           RCK00213
00076      05  WS-ERROR-PO-ENTRY              OCCURS 1000 TIMES         RCK00213
00077                                         INDEXED BY WS-PO-IDX.     RCK00213
00078          10  WS-ERROR-PO                PIC S9(09)  COMP          RCK00213
00079                                                     VALUE ZERO.   RCK00213
00080 *                                                                 RCK00213
00081  EJECT                                                            RCK00213
00082                                                                   RCK00213
00083  01  PV-PROGRAM-VARIABLES.                                        RCK00213
00084      05  PV-PARA                         PIC X(30)   VALUE SPACES.RCK00213
00085      05  PV-PO-RECS-READ                 PIC 9(07)   VALUE ZEROS. RCK00213
00086      05  PV-PO-RECS-BYPASSED             PIC 9(07)   VALUE ZEROS. RCK00213
00087      05  PV-PO-RECS-WRITTEN              PIC 9(07)   VALUE ZEROS. RCK00213
00088      05  PV-ERROR-RECS-READ              PIC 9(07)   VALUE ZEROS. RCK00213
00089                                                                   RCK00213
00090  01  PROGRAM-SWITCHES.                                            RCK00213
00091      05  END-OF-PO-INPUT-SW              PIC X(01)   VALUE 'N'.   RCK00213
00092          88  END-OF-PO-INPUT                         VALUE 'Y'.   RCK00213
00093      05  END-OF-PO-ERROR-SW              PIC X(01)   VALUE 'N'.   RCK00213
00094          88  END-OF-PO-ERROR                         VALUE 'Y'.   RCK00213
00095      05  BYPASS-REC-SW                   PIC X(01)   VALUE 'N'.   RCK00213
00096          88  BYPASS-REC                              VALUE 'Y'.   RCK00213
00097          88  DONT-BYPASS-REC                         VALUE 'N'.   RCK00213
00098 *                                                                 RCK00213
00099 *                                                                 RCK00213
00100  PROCEDURE DIVISION.                                              RCK00213
00101                                                                   RCK00213
00102 ******************************************************************RCK00213
00103 *  0000-INITIAL-ROUTINE  -  MAIN LINE OF THE PROGRAM PERFORMS THE RCK00213
00104 *  INITIALIZATION ROUTINE AND CONTROLS THE PROCESSING OF THE PGM. RCK00213
00105 ******************************************************************RCK00213
00106                                                                   RCK00213
00107  0000-MAINLINE.                                                   RCK00213
00108                                                                   RCK00213
00109      PERFORM 0100-HOUSEKEEPING.                                   RCK00213
00110                                                                   RCK00213
00111      PERFORM 7000-READ-ERROR-FILE.                                RCK00213
00112                                                                   RCK00213
00113      PERFORM 1000-PROCESS-ERROR-RECORDS                           RCK00213
00114          VARYING WS-PO-IDX                                        RCK00213
00115          FROM 1 BY 1                                              RCK00213
00116          UNTIL END-OF-PO-ERROR.                                   RCK00213
00117                                                                   RCK00213
00118      PERFORM 7100-READ-PO-INPUT-FILE.                             RCK00213
00119                                                                   RCK00213
00120      PERFORM 2000-PROCESS-INPUT-RECORDS                           RCK00213
00121          UNTIL END-OF-PO-INPUT.                                   RCK00213
00122                                                                   RCK00213
00123      CLOSE PO-FILE-IN                                             RCK00213
00124            PO-ERROR-FILE                                          RCK00213
00125            PO-FILE-OUT.                                           RCK00213
00126                                                                   RCK00213
00127      DISPLAY '*** PO EXTRACT RECS READ....: ' PV-PO-RECS-READ.    RCK00213
00128      DISPLAY '*** PO ERROR RECS READ......: ' PV-ERROR-RECS-READ. RCK00213
00129      DISPLAY '*** PO EXTRACT RECS WRITTEN.: ' PV-PO-RECS-WRITTEN. RCK00213
00130      DISPLAY '*** PO EXTRACT RECS BYPASSED: ' PV-PO-RECS-BYPASSED.RCK00213
00131                                                                   RCK00213
00132      STOP RUN.                                                    RCK00213
00133                                                                   RCK00213
00134  0100-HOUSEKEEPING.                                               RCK00213
00135                                                                   RCK00213
00136      OPEN INPUT  PO-FILE-IN                                       RCK00213
00137                  PO-ERROR-FILE.                                   RCK00213
00138                                                                   RCK00213
00139      OPEN OUTPUT PO-FILE-OUT.                                     RCK00213
00140                                                                   RCK00213
00141  1000-PROCESS-ERROR-RECORDS.                                      RCK00213
00142      MOVE '*1000-PROCESS-ERROR-RECORDS.     *' TO PV-PARA.        RCK00213
00143      MOVE WS-PO-NBR         TO WS-ERROR-PO (WS-PO-IDX).           RCK00213
00144      ADD 1                  TO PV-ERROR-RECS-READ.                RCK00213
00145      PERFORM 7000-READ-ERROR-FILE.                                RCK00213
00146                                                                   RCK00213
00147  2000-PROCESS-INPUT-RECORDS.                                      RCK00213
00148      MOVE '*2000-PROCESS-INPUT-RECORDS.     *' TO PV-PARA.        RCK00213
00149                                                                   RCK00213
00150      SET WS-PO-IDX       TO +1.                                   RCK00213
00151      SET DONT-BYPASS-REC TO TRUE.                                 RCK00213
00152      ADD 1               TO PV-PO-RECS-READ.                      RCK00213
00153                                                                   RCK00213
00154      SEARCH WS-ERROR-PO-ENTRY                                     RCK00213
00155        VARYING WS-PO-IDX                                          RCK00213
00156          AT END                                                   RCK00213
00157              SET DONT-BYPASS-REC TO TRUE                          RCK00213
00158                                                                   RCK00213
00159          WHEN WS-ERROR-PO (WS-PO-IDX) = RC050-PO-NBR              RCK00213
00160              SET BYPASS-REC           TO TRUE                     RCK00213
00161      END-SEARCH.                                                  RCK00213
00162                                                                   RCK00213
00163      IF BYPASS-REC                                                RCK00213
00164         ADD 1 TO PV-PO-RECS-BYPASSED                              RCK00213
00165      ELSE                                                         RCK00213
00166         PERFORM 8000-WRITE-EXTRACT-FILE                           RCK00213
00167      END-IF.                                                      RCK00213
00168                                                                   RCK00213
00169      PERFORM 7100-READ-PO-INPUT-FILE.                             RCK00213
00170                                                                   RCK00213
00171  7000-READ-ERROR-FILE.                                            RCK00213
00172      READ PO-ERROR-FILE INTO WS-ERROR-PO-RECORD                   RCK00213
00173         AT END                                                    RCK00213
00174            SET END-OF-PO-ERROR TO TRUE.                           RCK00213
00175                                                                   RCK00213
00176  7100-READ-PO-INPUT-FILE.                                         RCK00213
00177      READ PO-FILE-IN    INTO RC050-RECORD                         RCK00213
00178         AT END                                                    RCK00213
00179            SET END-OF-PO-INPUT TO TRUE.                           RCK00213
00180                                                                   RCK00213
00181  8000-WRITE-EXTRACT-FILE.                                         RCK00213
00182      WRITE PO-FILE-OUT-REC                                        RCK00213
00183          FROM RC050-RECORD.                                          CL**2
00184                                                                   RCK00213
00185      ADD 1 TO PV-PO-RECS-WRITTEN.                                 RCK00213
00186                                                                   RCK00213
