W31475********************* !!! ATTENTION !!! **************************        
W31475* A COPY OF BVWS001 IS CREATED AS BVWS003. ANY CHANGE HERE NEEDES         
W31475* TO REFLECT IN BVWS003 ALSO AND VICE VERSA.                              
      ******************************************************************        
      *  THIS WORKING-STORAGE COPYBOOK IS NEEDED FOR BVPD001 COPY CODE.         
      *                                                                         
      *  FOR INSTRUCTIONS, PLEASE SEE BVPD001                                   
      ******************************************************************        
RONNA2*         10/05/2006   REMOVE LOGIC FOR SKU, ITEM, UPC, UPC ID,  *        
RONNA2*                      AND SKU DEPT LOOKUPS.                              
RONNA2*                      THE PRICING/ATTRIBUTE UTILITY WILL BE     *        
RONNA2*                      USED TO GET THE ATTRIBUTES, THEN          *        
RONNA2*                      BV UTILTY WILL BE CALLED THROUGH THE               
RONNA2*                      PRICING MODULE                                     
      ******************************************************************        
                                                                                
       01  BV001-PV-PROGRAM-VARIABLE.                                           
           05  BV001-PV-INPUT-AREA.                                             
               10  BV001-PV-LOOKUP-TYPE-IN PIC X(08) VALUE SPACES.              
                   88  BV001-PV-BRND-DEPT-LOOKUP     VALUE 'BRNDDPT'.           
                   88  BV001-PV-BRND-LOOKUP          VALUE 'BRAND'.             
                   88  BV001-PV-BRND-VND-DPT-LOOKUP  VALUE 'BVD'.               
                   88  BV001-PV-REL-ID-LOOKUP        VALUE 'REL'.               
                   88  BV001-PV-UNK-BRND-LOOKUP      VALUE 'UNK'.               
                   88  BV001-PV-VNDR-DEPT-LOOKUP     VALUE 'VNDDPT'.            
                   88  BV001-PV-VNDR-LOOKUP          VALUE 'VENDOR'.            
               10  BV001-PV-VND-PAST-FUT-IN   PIC X(01) VALUE 'N'.              
                   88  BV001-VND-LOOK-PAST-FUT       VALUE 'Y'.                 
                   88  BV001-VND-DONT-LOOK-PAST-FUT  VALUE 'N'.                 
               10  BV001-PV-USE-KNWN-UNK-SW   PIC X(01) VALUE 'N'.              
                   88  BV001-USE-KNOWN-UNKNOWN          VALUE 'Y'.              
                   88  BV001-DONT-USE-UNK-KNOWN         VALUE 'N'.              
               10  BV001-PV-PAST-MONTHS    PIC S9(4) VALUE ZEROES               
                                                    COMP.                       
               10  BV001-PV-EFF-DTE-IN.                                         
                   15 BV001-PV-EFF-DTE-IN-YR  PIC X(04) VALUE SPACES.           
                   15 FILLER                  PIC X(01) VALUE SPACES.           
                   15 BV001-PV-EFF-DTE-IN-MN  PIC X(02) VALUE SPACES.           
                   15 FILLER                  PIC X(01) VALUE SPACES.           
                   15 BV001-PV-EFF-DTE-IN-DY  PIC X(02) VALUE SPACES.           
               10  BV001-PV-ENT-ID-IN      PIC X(09) VALUE SPACES.              
               10  BV001-PV-ENT-ID-IN-9 REDEFINES BV001-PV-ENT-ID-IN            
                                           PIC 9(09).                           
               10  BV001-PV-BRAND-IN       PIC X(05)       VALUE SPACES.        
               10  BV001-PV-BRAND-IN-9       REDEFINES                          
                   BV001-PV-BRAND-IN       PIC 9(05).                           
               10  BV001-PV-DEPT-IN        PIC X(04) VALUE SPACES.              
               10  BV001-PV-DEPT-IN-9 REDEFINES BV001-PV-DEPT-IN                
                                           PIC 9(04).                           
               10  BV001-PV-RLTNSHP-ID-IN  PIC X(09).                           
               10  BV001-PV-RLTNSHP-ID-IN-9 REDEFINES                           
                   BV001-PV-RLTNSHP-ID-IN  PIC 9(09).                           
           05  BV001-PV-OUTPUT-AREA.                                            
               10  BV001-PV-ENT-ID-OUT     PIC S9(09)      VALUE ZEROES         
                               COMP.                                            
                   88  BV001-PV-ENT-NOT-FOUND              VALUE +5161.         
               10  BV001-PV-BRAND-OUT      PIC S9(04)      VALUE ZEROES         
                               COMP.                                            
                   88  BV001-PV-BRAND-NOT-FOUND            VALUE +2230.         
               10  BV001-PV-VD-CSR-SW      PIC X(01)       VALUE 'V'.           
                   88  BV001-PV-VNDR-DEPT-CSR-ORIG         VALUE 'V'.           
                   88  BV001-PV-VNDR-DEPT-CSR-FUT          VALUE 'F'.           
                   88  BV001-PV-VNDR-DEPT-CSR-PAST         VALUE 'P'.           
               10  BV001-PV-DEPT-OUT       PIC S9(04)      VALUE ZEROES         
                               COMP.                                            
               10  BV001-PV-RLTNSHP-ID-OUT PIC S9(09)      VALUE ZEROES         
                               COMP.                                            
               10  BV001-PV-SQLCODE-OUT    PIC S9(09) COMP-4.                   
               10  BV001-PV-RT-SUB-OUT     PIC S9(04) COMP VALUE ZERO.          
               10  BV001-PV-RLTNSHP-OUT-TABLE.                                  
                   15  BV001-PV-RLTNSHP-ENTRY-OUT OCCURS 9999 TIMES.            
                       20  BV001-RT-ENT-ID-OUT           PIC S9(09).            
                           88 BV001-RT-ENT-NOT-FOUND     VALUE +5161.           
                       20  BV001-RT-BRND-OUT             PIC S9(04).            
                           88 BV001-RT-BRND-NOT-FOUND    VALUE +2230.           
                       20  BV001-RT-DEPT-OUT             PIC S9(04).            
                       20  BV001-RT-RLTNSHP-ID-OUT       PIC S9(09).            
               10  BV001-PV-RETURN-STATUS-AREA.                                 
                   15  BV001-PV-RETURN-CDE PIC S9(04)      VALUE ZEROES         
                               COMP.                                            
                       88  BV001-PV-NO-ERRORS-FOUND   VALUE 0.                  
                       88  BV001-PV-ERROR-FOUND       VALUES                    
                           +1, +2, +3, +4, +5, +6, +7, +8.                      
                       88  BV001-PV-FOUND-REL-OR-UNK  VALUES                    
RONNA                      0, +1.                                               
RONNA *                    0, +1, +3, +9.                                       
RONNA *                88  BV001-PV-ITM-OR-REL-NOT-FOUND VALUES +1, +3.         
RONNA                  88  BV001-PV-ITM-OR-REL-NOT-FOUND VALUES +1.             
RONNA *                                                         +9.             
                       88  BV001-PV-NO-REL-FOUND      VALUE +1.                 
                       88  BV001-BAD-INPUT            VALUE +2.                 
RONNA *                88  BV001-ITEM-NOT-FOUND       VALUE +3.                 
                       88  BV001-REL-ID-NOT-FOUND     VALUE +4.                 
                       88  BV001-PV-SQL-ERROR         VALUE +5.                 
                       88  BV001-NO-RLTNSHP-FOR-DTE   VALUE +6.                 
                       88  BV001-PV-INVALID-FUNCTION  VALUE +7.                 
                       88  BV001-PV-OTHER-ERROR       VALUE +8.                 
RONNA *                88  BV001-PV-ZERO-BRAND        VALUE +9.                 
                   15  BV001-PV-PAST-FUT-DBV-REL-SW   PIC X(01)                 
                                                      VALUE 'N'.                
                       88  BV001-PAST-DBV-REL-FOUND   VALUE 'P'.                
                       88  BV001-FUT-DBV-REL-FOUND    VALUE 'F'.                
                       88  BV001-PAST-OR-FUT-DBV-REL-FND                        
                                                      VALUES 'F' 'P'.           
                   15  BV001-PV-RETURN-MSG-1 PIC X(80) VALUE SPACES.            
                   15  BV001-PV-RETURN-MSG-2 PIC X(80) VALUE SPACES.            
               10  BV001-PV-UNKNOWN-INS-SW   PIC X(01) VALUE 'N'.               
                   88  BV001-UNKNOWN-INS     VALUE 'Y'.                         
               10  BV001-PV-DUMMY-SKU-OUT-SW PIC X(01) VALUE 'N'.               
                   88  BV001-DUMMY-SKU       VALUE 'Y'.                         
           05  BV001-PV-WORK-AREA.                                              
               10 BV001-PV-WORK-FUNC-FOUND-SW PIC X(01).                        
                  88 BV001-PV-WORK-FUNC-FOUND     VALUE 'Y'.                    
                  88 BV001-PV-WORK-FUNC-NOT-FOUND VALUE 'N'.                    
               10 BV001-PV-MORE-CSR-RECORDS-SW PIC X(01).                       
                  88 BV001-PV-MORE-RECORDS        VALUE 'Y'.                    
                  88 BV001-PV-NO-MORE-RECORDS     VALUE 'N'.                    
               10 BV001-PV-DATE-PROVIDED-SW    PIC X(01).                       
                  88 BV001-PV-DATE-PROVIDED       VALUE 'Y'.                    
                  88 BV001-PV-NO-DATE-PROVIDED    VALUE 'N'.                    
               10  BV001-PV-WORK-ENT-ID     PIC  S9(9)     VALUE ZEROES         
                               COMP.                                            
                   88  BV001-PV-WORK-ENT-NOT-FOUND         VALUE +5161.         
               10  BV001-PV-WORK-REL-ID    PIC S9(09)      VALUE ZEROES         
                               COMP.                                            
               10  BV001-PV-WORK-SEQ-NBR   PIC S9(9)      VALUE ZEROES          
                               COMP.                                            
               10  BV001-PV-WORK-SKU       PIC S9(08)V     VALUE ZEROES         
                               COMP-3.                                          
               10  BV001-PV-WORK-BRAND      PIC  S9(4)     VALUE ZEROES         
                               COMP.                                            
                   88  BV001-PV-WORK-BRAND-NOT-FOUND        VALUE +2230.        
               10  BV001-PV-WORK-UPC-NBR   PIC S9(15)V     VALUE ZEROES         
                               COMP-3.                                          
               10  BV001-PV-WORK-UPC-ID    PIC S9(09)      VALUE ZEROES         
                               COMP.                                            
               10  BV001-PV-WORK-DATE      PIC X(10)       VALUE SPACES.        
               10  BV001-PV-WORK-ITM-NBR   PIC S9(15)V     VALUE ZEROES         
                               COMP-3.                                          
               10  BV001-PV-WORK-DEPT      PIC S9(4)V VALUE ZEROES              
                                                      COMP-3.                   
               10  BV001-PV-WORK-RLTNSHP-ID PIC S9(09)    VALUE ZEROES          
                               COMP.                                            
               10  BV001-PV-WORK-SQL-CODE  PIC  S9(9)     VALUE ZEROES.         
               10  BV001-PV-WORK-BVD-ERROR-FIELDS PIC X(01).                    
                   88 BV001-WORK-ERROR-JUST-BRND    VALUE 'A'.                  
                   88 BV001-WORK-ERROR-BRND-DPT     VALUE 'B'.                  
                   88 BV001-WORK-ERROR-JUST-VNDR    VALUE 'C'.                  
                   88 BV001-WORK-ERROR-VNDR-DPT     VALUE 'D'.                  
                   88 BV001-WORK-ERROR-BV-DPT       VALUE 'E'.                  
           05  BV001-PC-CONSTANTS.                                              
               10 BV001-PC-UNK-VNDR              PIC S9(09) VALUE +5161         
                                                 COMP.                          
               10 BV001-PC-UNK-BRAND             PIC S9(04) VALUE +2230         
                                                 COMP.                          
      ******************************************************************        
      * BRAND CURSOR.                                                           
      ******************************************************************        
           EXEC SQL                                                             
               DECLARE BV_BRND_CSR CURSOR FOR                                   
                 SELECT  DEPT_BRND_VND_ID                                       
                        ,DEPT_NBR                                               
                        ,ENT_ID                                                 
                 FROM IMT_DEPT_BRND_VND                                         
                 WHERE LBL_SEQ_NBR   = :BV001-PV-WORK-BRAND                     
                   AND EFF_BEG_DTE  <= :BV001-PV-WORK-DATE                      
                   AND (EFF_END_DTE IS NULL OR                                  
                        EFF_END_DTE >= :BV001-PV-WORK-DATE)                     
                 WITH UR                                                        
                 FOR FETCH ONLY                                                 
           END-EXEC.                                                            
                                                                                
      ************************************************************              
      * BRAND DEPT CURSOR.                                                      
      ************************************************************              
           EXEC SQL                                                             
               DECLARE BV_BRND_DEPT_CSR CURSOR FOR                              
                 SELECT  DEPT_BRND_VND_ID                                       
                        ,ENT_ID                                                 
                 FROM IMT_DEPT_BRND_VND                                         
                 WHERE LBL_SEQ_NBR   = :BV001-PV-WORK-BRAND                     
                   AND EFF_BEG_DTE  <= :BV001-PV-WORK-DATE                      
                   AND (EFF_END_DTE IS NULL OR                                  
                        EFF_END_DTE >= :BV001-PV-WORK-DATE)                     
                   AND DEPT_NBR      = :BV001-PV-WORK-DEPT                      
                 WITH UR                                                        
                 FOR FETCH ONLY                                                 
           END-EXEC.                                                            
                                                                                
      ************************************************************              
      * VENDOR CURSOR.                                                          
      ************************************************************              
           EXEC SQL                                                             
               DECLARE BV_VNDR_CSR CURSOR FOR                                   
                 SELECT  DEPT_BRND_VND_ID                                       
                        ,DEPT_NBR                                               
                        ,LBL_SEQ_NBR                                            
                 FROM IMT_DEPT_BRND_VND                                         
                 WHERE ENT_ID        = :BV001-PV-WORK-ENT-ID                    
                   AND EFF_BEG_DTE  <= :BV001-PV-WORK-DATE                      
                   AND (EFF_END_DTE IS NULL OR                                  
                        EFF_END_DTE >= :BV001-PV-WORK-DATE)                     
                 WITH UR                                                        
                 FOR FETCH ONLY                                                 
           END-EXEC.                                                            
                                                                                
      ************************************************************              
      * VENDOR DEPT CURSOR.                                                     
      ************************************************************              
           EXEC SQL                                                             
               DECLARE BV_VNDR_DEPT_CSR CURSOR FOR                              
                 SELECT  DEPT_BRND_VND_ID                                       
                        ,LBL_SEQ_NBR                                            
                 FROM IMT_DEPT_BRND_VND                                         
                 WHERE ENT_ID        = :BV001-PV-WORK-ENT-ID                    
                   AND EFF_BEG_DTE  <= :BV001-PV-WORK-DATE                      
                   AND (EFF_END_DTE IS NULL OR                                  
                        EFF_END_DTE >= :BV001-PV-WORK-DATE)                     
                   AND DEPT_NBR      = :BV001-PV-WORK-DEPT                      
                 WITH UR                                                        
                 FOR FETCH ONLY                                                 
           END-EXEC.                                                            
      ************************************************************              
      * VENDOR DEPT FUTURE CURSOR                                               
      ************************************************************              
           EXEC SQL                                                             
               DECLARE BV_VND_DPT_FUT_CSR CURSOR FOR                            
                 SELECT  DEPT_BRND_VND_ID                                       
                        ,LBL_SEQ_NBR                                            
                 FROM IMT_DEPT_BRND_VND                                         
                 WHERE ENT_ID        = :BV001-PV-WORK-ENT-ID                    
                   AND EFF_BEG_DTE  >  :BV001-PV-WORK-DATE                      
                   AND (EFF_END_DTE IS NULL OR                                  
                        EFF_END_DTE >  :BV001-PV-WORK-DATE)                     
                   AND DEPT_NBR      = :BV001-PV-WORK-DEPT                      
                 WITH UR                                                        
                 FOR FETCH ONLY                                                 
           END-EXEC.                                                            
      ************************************************************              
      * VENDOR DEPT PAST CURSOR                                                 
      ************************************************************              
           EXEC SQL                                                             
               DECLARE BV_VND_DPT_PST_CSR CURSOR FOR                            
                 SELECT  DEPT_BRND_VND_ID                                       
                        ,LBL_SEQ_NBR                                            
                 FROM IMT_DEPT_BRND_VND BV1                                     
                 WHERE ENT_ID      =  :BV001-PV-WORK-ENT-ID                     
                   AND EFF_BEG_DTE <  :BV001-PV-WORK-DATE                       
                   AND EFF_BEG_DTE >= DATE(:BV001-PV-WORK-DATE) -               
                                           :BV001-PV-PAST-MONTHS MONTHS         
                   AND DEPT_NBR    =  :BV001-PV-WORK-DEPT                       
                   AND EFF_END_DTE = (SELECT MAX(EFF_END_DTE)                   
                                        FROM IMT_DEPT_BRND_VND BV2              
                                       WHERE BV1.ENT_ID = BV2.ENT_ID            
                                         AND BV1.LBL_SEQ_NBR =                  
                                             BV2.LBL_SEQ_NBR                    
                                         AND BV1.DEPT_NBR    =                  
                                             BV2.DEPT_NBR                       
                                         AND BV2.EFF_BEG_DTE <                  
                                             :BV001-PV-WORK-DATE                
                                         AND BV2.EFF_BEG_DTE >=                 
                                             DATE(:BV001-PV-WORK-DATE) -        
                                             :BV001-PV-PAST-MONTHS              
                                              MONTHS)                           
                 WITH UR                                                        
                 FOR FETCH ONLY                                                 
           END-EXEC.                                                            
