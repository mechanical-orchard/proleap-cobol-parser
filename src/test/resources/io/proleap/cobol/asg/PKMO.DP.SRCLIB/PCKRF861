000100 IDENTIFICATION DIVISION.                                         00010099
000200                                                                  00020002
000300 PROGRAM-ID.             PCKRF861.                                00030002
000400 AUTHOR.                 LYNN MCADAMS.                            00040002
000500 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00050002
000600 DATE-WRITTEN            JANUARY, 2001.                           00060002
000700 DATE-COMPILED.                                                   00070002
000800                                                                  00080002
000900******************************************************************00090002
001000* THIS PROGRAM DISPLAYS THE ADJUSTED CARTON UNITS ON THE LRT      00100003
001100* (LASER RADIO TERMINAL) WHEN #1 CARTON FUNCTIONS IS SELECTED     00110099
001200* FROM THE MANIFESTING MENU AND #3 ADJUST UNITS IS SELECTED       00120099
001300* FROM THE CARTON FUNCTIONS MENU.                                 00130099
001400*                                                                 00140099
001500* IT WILL ACCEPT THE ENTRY OF THE CARTON NUMBER.                  00150099
001600*                                                                 00160009
001700* IF THE CARTON KEYED/SCANNED IS A MASTER CARTON, AN ERROR        00170041
001800* MESSAGE WILL APPEAR.  IT MUST BE A MERCHANDISE CARTON. THE      00180041
001900* SCREEN WILL DISPLAY THE DESTINATION STORE, THE NUMBER OF        00190003
002000* UNIQUE SKU'S IN THE CARTON, AND THE TOTAL NUMBER OF UNITS       00200003
002100* IN THE CARTON.                                                  00210003
002200*                                                                 00220002
002210* IF THE CARTON IS DIVERTED TO A TRAILER, SCANNED ON TO A         00221099
002220* TRAILER, OR LOADED ON TO A TRAILER, THE TRAILER MUST BE OPEN    00222099
002230* AT THE DC OR OPEN FOR AUDIT INORDER FOR THE CONTENTS TO BE      00223099
002240* ADJUSTED.                                                       00224099
002250* THIS CHANGED EFF. 6/27/02  - DEANNA BRANTNER                    00225099
002260*                                                                 00226099
002270* IF THE ASSOCIATE NEEDS TO ALTER CARTON CONTENTS, THE F4-CONTINUE00227099
002280* KEY IS PRESSED.  THIS WILL DISPLAY ANOTHER SCREEN (PCKRF862)    00228099
002290* THAT WILL CONTAIN A LIST OF REASON CODES.                       00229099
002300******************************************************************00230099
002400*                                                                 00240099
002500*                                                                 00250099
002600 ENVIRONMENT DIVISION.                                            00260099
002700 DATA DIVISION.                                                   00270099
002800 WORKING-STORAGE SECTION.                                         00280099
002900*                                                                 00290099
003000*                                                                 00300099
003100 01  DK-DB2-KEYS.                                                 00310099
003200     05  DK-SHIPT-UNT-ID             PIC  S9(18)V COMP-3.         00320099
003300     05  DK-BARCODE-NBR              PIC  X(22) VALUE SPACES.     00330099
003400     05  DK-SKU-NBR.                                              00340099
003500         10  DK-MERCH-DEPT-NMBR      PIC  X(03) VALUE SPACES.     00350099
003600         10  DK-MERCH-CLASS-NMBR     PIC  X(02) VALUE SPACES.     00360099
003700         10  DK-SEQ-NMBR             PIC  X(03) VALUE SPACES.     00370099
003800     05 DK-PO-NBR                    PIC  S9(9) COMP VALUE ZERO.  00380099
003900     05 DK-RCVR-NBR                  PIC  S9(9) COMP VALUE ZERO.  00390099
004000                                                                  00400099
004100* PROGRAM CONSTANTS                                               00410099
004200 01  PC-PROGRAM-CONSTANTS.                                        00420099
004300     05  PC-TRANID                       PIC  X(04)  VALUE 'E861'.00430099
004400     05  PC-MAX-RETRIES                  PIC S9(04)  VALUE +3     00440099
004500                                                     COMP SYNC.   00450099
004600     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     00460099
004700                                                     COMP SYNC.   00470099
004800     05  PC-RECEIVE-LENGTH               PIC S9(04)  VALUE +1     00480099
004900                                                     COMP SYNC.   00490099
005000     05  PC-0                            PIC  X(01)  VALUE '0'.   00500099
005100     05  PC-00                           PIC  X(02)  VALUE '00'.  00510099
005200     05  PC-4                            PIC  X(01)  VALUE '4'.   00520099
005300     05  PC-01                           PIC  X(02)  VALUE '01'.  00530099
005400     05  PC-18                           PIC S9(04)  VALUE 18     00540099
005500                                                     COMP SYNC.   00550099
005600     05  PC-20                           PIC S9(04)  VALUE 20     00560099
005700                                                     COMP SYNC.   00570099
005800     05  PC-49                           PIC  X(02)  VALUE '49'.  00580099
005900     05  PC-50                           PIC  X(02)  VALUE '50'.  00590099
006000     05  PC-95                           PIC  X(02)  VALUE '95'.  00600099
006100     05  PC-A                            PIC  X(01)  VALUE 'A'.   00610099
006200     05  PC-MGMX                         PIC  X(04)  VALUE 'MGMX'.00620099
006300     05  PC-UG                           PIC  X(02)  VALUE 'UG'.  00630099
006400     05  PC-90                           PIC  X(02)  VALUE '90'.  00640099
006500     05  PC-DEFAULT-TMST                 PIC  X(26)               00650099
006510                               VALUE '9999-09-09-09.09.09.999999'.00651099
006520                                                                  00652099
006530     05  PC-CURRENT-PROGRAM-NAME    PIC X(08) VALUE 'PCKRF861'.   00653099
006540     05  PC-MANIFEST-MENU-PGM       PIC X(08) VALUE 'PCKRF850'.   00654099
006550     05  PC-DC-RF-APPL-PGM          PIC X(08) VALUE 'MPKCS027'.   00655099
006560     05  PC-ADJUST-CRTN-UNTS-PGM    PIC X(08) VALUE 'PCKRF861'.   00656099
006570     05  PC-ALTER-REASON-PGM        PIC X(08) VALUE 'PCKRF862'.   00657099
006580     05  PC-ADJUSTED-QTY-PGM        PIC X(08) VALUE 'PCKRF863'.   00658099
006590     05  PC-CARTON-FUNC-PGM         PIC X(08) VALUE 'PCKRF884'.   00659099
006600     05  PC-AUTOVE-MODULE           PIC  X(08)  VALUE  'RCKUT127'.00660099
006700     05  PC-AUTOVE-MODULE-LENGTH    PIC S9(04)  VALUE  +400       00670099
006800                                                    COMP SYNC.    00680099
007400                                                                  00740047
007500* ERROR MESSAGES                                                  00750008
007600     05  PC-UNRECOGNIZED-PF-KEY-MSG PIC X(19) VALUE               00760062
007700                                           'UNRECOGNIZED PF KEY'. 00770062
007800     05  PC-ENTER-THROUGH-MENU-MSG  PIC X(19) VALUE               00780062
007900                                           'ENTER THROUGH MENU '. 00790062
008000     05  PC-TRANS-UNAVAILABLE-MSG   PIC X(19) VALUE               00800062
008100                                           'TRANS NOT AVAILABLE'. 00810062
008200     05  PC-PLS-ENT-FLD-MSG         PIC X(19) VALUE               00820062
008300                                           'PLEASE ENTER FIELD '. 00830062
008400     05  PC-MUST-BE-NUM-MSG         PIC X(19) VALUE               00840009
008500                                           'MUST BE NUMERIC    '. 00850009
008600     05  PC-MUST-BE-GT-0-MSG        PIC X(19) VALUE               00860009
008700                                           'MUST BE > ZERO     '. 00870010
008800     05  PC-FIRST-1-NOT-0-MSG       PIC X(19) VALUE               00880009
008900                                           'FIRST DIGIT NOT 0  '. 00890009
009000     05  PC-TOO-MANY-DIGITS         PIC X(19) VALUE               00900009
009100                                           'TOO MANY DIGITS    '. 00910009
009200     05  PC-MORE-DIGITS-REQD        PIC X(19) VALUE               00920009
009300                                           'MORE DIGITS REQUIRD'. 00930009
009400     05  PC-CARTON-ID-NOT-FOUND     PIC X(19) VALUE               00940020
009500                                           'CARTON ID NOT FOUND'. 00950020
009600     05  PC-MUST-BE-MERCHANDISE-CTN PIC X(19) VALUE               00960062
009700                                           'MUST BE MRCHDSE CTN'. 00970060
009800     05  PC-MUST-BE-KOHLS-BARCODE   PIC X(19) VALUE               00980099
009900                                           'MUST BE KOHLS BRCDE'. 00990099
010000     05  PC-CARTON-INACTIVATED      PIC X(19) VALUE               01000099
010100                                           'CARTON INACTIVATED '. 01010099
010200     05  PC-CANNOT-ADJ-SMOOTHED     PIC X(19) VALUE               01020099
010300                                           'CANNOT ADJ SMTH CTN'. 01030099
010310     05  PC-CANNOT-ADJ-TRP-CLSD     PIC X(19) VALUE               01031099
010320                                           'CANNOT ADJ TRP CLSD'. 01032099
010330     05  PC-CANNOT-ADJ-AUD-CRTN     PIC X(19) VALUE               01033099
010340                                           'CANNOT ADJ AUD OPEN'. 01034099
010341     05  PC-CANNOT-ADJ-P2L-CRTN     PIC X(19) VALUE               01034199
010342                                           'CANNOT ADJ P2L CRTN'. 01034299
010343     05  PC-CANNOT-ADJ-JWL-CRTN     PIC X(19) VALUE               01034399
010344                                           'CANNOT ADJ JWL CRTN'. 01034499
010345     05  PC-CANNOT-ADJ-FXR-CRTN     PIC X(19) VALUE               01034599
010346                                           'CANNOT ADJ FXR CRTN'. 01034699
010347     05  PC-CANNOT-ADJ-RDM-CRTN     PIC X(19) VALUE               01034799
010348                                           'CANNOT ADJ RDM CRTN'. 01034899
010400                                                                  01040047
010500* PROGRAM SWITCHES                                                01050008
010600 01  PS-PROGRAM-SWITCHES.                                         01060008
010700     05  PS-END-OF-CURSOR-SW             PIC  X(01)  VALUE 'N'.   01070099
010800         88  PS-END-OF-CURSOR                        VALUE 'Y'.   01080099
010900         88  PS-NOT-END-OF-CURSOR                    VALUE 'N'.   01090099
010910     05  PS-END-OF-CURSOR-AUD-SW         PIC  X(01)  VALUE 'N'.   01091099
010920         88  PS-END-OF-CURSOR-AUD                    VALUE 'Y'.   01092099
010930         88  PS-NOT-END-OF-CURSOR-AUD                VALUE 'N'.   01093099
011000     05  PS-VALID-INPUT-SW               PIC  X(01)  VALUE 'Y'.   01100008
011100         88  PS-VALID-INPUT                          VALUE 'Y'.   01110008
011200         88  PS-INVALID-INPUT                        VALUE 'N'.   01120008
011300     05  PS-NOT-FOUND-SW                 PIC  X(01)  VALUE 'Y'.   01130009
011400         88  PS-FOUND                                VALUE 'Y'.   01140009
011500         88  PS-NOT-FOUND                            VALUE 'N'.   01150009
011600     05  PS-MERCH-CTN-IND                PIC  X(01)  VALUE 'Y'.   01160041
011700         88  PS-MERCH-CTN                            VALUE 'Y'.   01170041
011800         88  PS-NOT-MERCH-CTN                        VALUE 'N'.   01180041
011801     05  PS-P2L-CTN-IND                  PIC  X(01)  VALUE 'N'.   01180199
011802         88  PS-P2L-CTN                              VALUE 'Y'.   01180241
011803         88  PS-NOT-P2L-CTN                          VALUE 'N'.   01180341
011804     05  PS-JWL-CTN-IND                  PIC  X(01)  VALUE 'N'.   01180441
011805         88  PS-JWL-CTN                              VALUE 'Y'.   01180541
011806         88  PS-NOT-JWL-CTN                          VALUE 'N'.   01180641
011807     05  PS-FXR-CTN-IND                  PIC  X(01)  VALUE 'N'.   01180741
011808         88  PS-FXR-CTN                              VALUE 'Y'.   01180841
011809         88  PS-NOT-FXR-CTN                          VALUE 'N'.   01180941
011810     05  PS-RDM-CTN-IND                  PIC  X(01)  VALUE 'N'.   01181041
011811         88  PS-RDM-CTN                              VALUE 'Y'.   01181141
011812         88  PS-NOT-RDM-CTN                          VALUE 'N'.   01181241
011900     05  PS-SCANNED-DATA-IND             PIC  X(01)  VALUE 'Y'.   01190041
012000         88  PS-NOT-SCANNED-DATA                     VALUE 'N'.   01200041
012100         88  PS-SCANNED-DATA                         VALUE 'Y'.   01210041
012200     05  PS-CARTON-EXISTS-SW             PIC  X(01)  VALUE 'Y'.   01220009
012300         88  PS-CARTON-EXISTS                        VALUE 'Y'.   01230009
012400         88  PS-CARTON-DOESNT-EXIST                  VALUE 'N'.   01240009
012410     05  PS-CARTON-AUDIT-PENDING-SW      PIC  X(01)  VALUE 'N'.   01241099
012420         88  PS-CARTON-AUDIT-PENDING                 VALUE 'Y'.   01242099
012430         88  PS-NO-CARTON-AUDIT-PENDING              VALUE 'N'.   01243099
012440     05  PS-AUTO-VE-SW                   PIC X(01)   VALUE ' '.   01244099
012450         88  PS-AUTO-VE-YES                          VALUE 'Y'.   01245099
012460         88  PS-AUTO-VE-NO                           VALUE 'N'.   01246099
012470     05  PS-ALLOW-ADJ-SW                 PIC X(01)   VALUE ' '.   01247099
012480         88  PS-ALLOW-ADJ-YES                        VALUE 'Y'.   01248099
012490         88  PS-ALLOW-ADJ-NO                         VALUE 'N'.   01249099
012500                                                                  01250047
012600* PROGRAM VARIABLES                                               01260008
012700 01  PV-PROGRAM-VARIABLES.                                        01270008
012800     05  PV-CICS-MSG-AREA.                                        01280008
012900         10  PV-CICS-MSG-AREA1           PIC  X(80)  VALUE SPACE. 01290008
013000         10  PV-CICS-MSG-AREA2           PIC  X(80)  VALUE SPACE. 01300008
013100         10  PV-CICS-MSG-AREA3           PIC  X(80)  VALUE SPACE. 01310008
013200         10  PV-CICS-MSG-AREA4           PIC  X(80)  VALUE SPACE. 01320008
013300         10  PV-CICS-MSG-AREA5           PIC  X(80)  VALUE SPACE. 01330008
013400         10  PV-CICS-MSG-AREA6           PIC  X(80)  VALUE SPACE. 01340008
013500     05  PV-MESSAGE-AREA                 PIC  X(19)  VALUE SPACE. 01350008
013600     05  PV-RECEIVE-DATA                 PIC  X(01)  VALUE SPACE. 01360008
013700     05  PV-CICS-RESPONSE                PIC S9(09)  VALUE ZEROS  01370008
013800                                                     COMP SYNC.   01380008
013900     05  PV-TRANSFER-PROGRAM             PIC  X(08)  VALUE SPACE. 01390008
014000     05  PV-RECORD-COUNT                 PIC S9(09)  VALUE ZEROS  01400008
014100                                                     COMP SYNC.   01410008
014200     05  PV-COUNT-IND                    PIC S9(04)  VALUE ZEROS  01420008
014300                                                     COMP SYNC.   01430008
014400     05  PV-SELECT-COUNTER               PIC S9(04)  VALUE ZEROS  01440008
014500                                                     COMP SYNC.   01450008
014600     05  PV-CHAR-COUNT                   PIC S9(04)  VALUE ZEROS  01460010
014700                                                     COMP SYNC.   01470010
014800     05  PV-MULTI-LINE-COUNT             PIC S9(04)  VALUE ZEROS  01480010
014900                                                     COMP SYNC.   01490010
015000     05  PV-ODDS-SUM                     PIC  9(04)  VALUE ZEROS. 01500010
015100     05  PV-EVENS-SUM                    PIC  9(04)  VALUE ZEROS. 01510010
015200     05  PV-TOTAL                        PIC  9(04).              01520010
015300     05  FILLER REDEFINES PV-TOTAL.                               01530010
015400         10  FILLER                      PIC  9(03).              01540010
015500         10  PV-TOTAL-LAST-DIGIT         PIC  9(01).              01550010
015600     05  PV-WRITE-LENGTH                 PIC  9(04)  VALUE  80    01560010
015700                                                     COMP SYNC.   01570010
015800     05  PV-CTN-X                        PIC  X(18).              01580009
015900     05  PV-CTN-N REDEFINES PV-CTN-X     PIC  9(18).              01590009
016000     05  PV-CTN-1-18 REDEFINES PV-CTN-X.                          01600009
016100         10  PV-CTN-9-1                  PIC  9(01).              01610009
016200         10  PV-CTN-9-2                  PIC  9(01).              01620009
016300         10  PV-CTN-9-3                  PIC  9(01).              01630009
016400         10  PV-CTN-9-4                  PIC  9(01).              01640009
016500         10  PV-CTN-9-5                  PIC  9(01).              01650009
016600         10  PV-CTN-9-6                  PIC  9(01).              01660009
016700         10  PV-CTN-9-7                  PIC  9(01).              01670009
016800         10  PV-CTN-9-8                  PIC  9(01).              01680009
016900         10  PV-CTN-9-9                  PIC  9(01).              01690009
017000         10  PV-CTN-9-10                 PIC  9(01).              01700009
017100         10  PV-CTN-9-11                 PIC  9(01).              01710009
017200         10  PV-CTN-9-12                 PIC  9(01).              01720009
017300         10  PV-CTN-9-13                 PIC  9(01).              01730009
017400         10  PV-CTN-9-14                 PIC  9(01).              01740009
017500         10  PV-CTN-9-15                 PIC  9(01).              01750009
017600         10  PV-CTN-9-16                 PIC  9(01).              01760009
017700         10  PV-CTN-9-17                 PIC  9(01).              01770009
017800         10  PV-CTN-9-18                 PIC  9(01).              01780009
018600                                                                  01860047
018700     05  PV-STORE-NBR                    PIC 9(04) VALUE ZEROS.   01870099
019000                                                                  01900020
019100     05  PV-PROGRAM-DATA.                                         01910011
019200         10  PV-STORE                    PIC  X(04)  VALUE SPACE. 01920020
019300         10  PV-STORE-N REDEFINES PV-STORE PIC ZZZ9.              01930020
019400                                                                  01940020
019500         10  PV-CTN.                                              01950011
019600             15  PV-CTN-FIRST-DIGIT      PIC  X(01).              01960011
019700             15  PV-CTN-LAST-17          PIC  X(17).              01970011
019800             15  PV-CTN-FILLER           PIC  X(02).              01980011
019900         10  FILLER REDEFINES PV-CTN.                             01990011
020000             15  PV-CTN-SCAN-00          PIC  X(02).              02000011
020100             15  PV-CTN-SCAN-THIRD-DGT   PIC  X(01).              02010011
020200             15  PV-CTN-SCAN-LAST-17     PIC  X(17).              02020011
020300         10  FILLER REDEFINES PV-CTN.                             02030011
020400             15  PV-CTN-SCAN-00          PIC  X(02).              02040011
020500             15  PV-CTN-SCAN-LAST-18     PIC  X(18).              02050011
020600                                                                  02060099
020700         10  PV-BARCODE                  PIC  X(20).              02070099
020800         10  PV-BARCODE-R REDEFINES PV-BARCODE.                   02080099
020900             15  PV-BARCODE-00           PIC  X(02).              02090099
021000             15  PV-BARCODE-LAST-18      PIC  X(18).              02100099
021100                                                                  02110099
021200                                                                  02120099
021300         10  PV-SKU-IN-CTN               PIC S9(09)   VALUE +0    02130035
021400                                                      COMP-3.     02140035
021500         10  PV-UNT-IN-CTN               PIC S9(09)   VALUE +0    02150050
021600                                                      COMP-3.     02160035
021700***************************************************************** 02170099
021800*   RCWS040 - IS THE LAYOUT THAT IS USED TO PASS INFO TO THE    * 02180099
021900*             AUTOVERIFY (AUTOVE) ELIGIBILITY MODULE (RCKUT127).* 02190099
022000***************************************************************** 02200099
022100     COPY RCWS040.                                                02210099
022101                                                                  02210199
022102******************************************************************02210299
022103* COMMAREA FOR PCKUT713 - CARTON STATUS MODULE                    02210399
022104******************************************************************02210499
022105     COPY PCWS046.                                                02210599
022106                                                                  02210699
022107* COMMAREA LAYOUT                                                 02210799
022108 01  CA-COMMAREA.                                                 02210873
022109     COPY PCWS033.                                                02210953
022110                                                                  02211008
022200* MAP LAYOUT                                                      02220008
022300     COPY PCKM861.                                                02230008
022400                                                                  02240008
022500* HELP SCREEN COMMAREA                                            02250008
022600     COPY PCWS192.                                                02260008
022700                                                                  02270008
022800* HELP SCREEN WORK AREA                                           02280008
022900     COPY PCWS188.                                                02290008
023000                                                                  02300008
023100* SENDING/RECEIVING AREA FOR THE NUMERIC EDIT ROUTINE (DPKUT100)  02310008
023200     COPY DPWS010I.                                               02320008
023300                                                                  02330008
023400* LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA.                02340008
023500     COPY DPWS013.                                                02350008
023600                                                                  02360008
023700* KOHL'S STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST    02370008
023800     COPY DPWS015.                                                02380008
023900                                                                  02390008
024300* KOHL'S STANDARD ATTENTION IDENTIFIER LIST                       02430008
024400     COPY DFHAID.                                                 02440008
024500                                                                  02450008
024600* DB2 AREA FOR THE SHIPMENT UNIT TABLE                            02460008
024700     EXEC SQL                                                     02470008
024800          INCLUDE SUT00024                                        02480099
024900     END-EXEC.                                                    02490008
025000                                                                  02500008
025600* DB2 AREA FOR THE SHIPMENT UNIT-UPC TABLE                        02560021
025700     EXEC SQL                                                     02570021
025800          INCLUDE SUT00028                                        02580099
025900     END-EXEC.                                                    02590021
026000                                                                  02600021
026600* XLV_SKU                                                         02660029
026700     EXEC SQL                                                     02670029
026800          INCLUDE XLV00000                                        02680029
026900     END-EXEC.                                                    02690029
026901                                                                  02690199
026902* XLV_UPC                                                         02690229
026903     EXEC SQL                                                     02690329
026904          INCLUDE XLV00003                                        02690429
026905     END-EXEC.                                                    02690529
026906                                                                  02690699
026910* DB2 AREA FOR THE CARTON AUDIT TABLE                             02691099
026920     EXEC SQL                                                     02692099
026930          INCLUDE TSUATRN                                         02693099
026940     END-EXEC.                                                    02694099
026950                                                                  02695099
026951* DB2 AREA FOR THE RECEIVING TABLE                                02695199
026952     EXEC SQL                                                     02695299
026953          INCLUDE TRECEIV                                         02695399
026954     END-EXEC.                                                    02695499
026955                                                                  02695599
026956* DB2 AREA FOR THE PO AUDIT REQUEST TABLE (SUT_PO_AUD_REQ)        02695699
026960     EXEC SQL                                                     02696099
026970          INCLUDE SUT00015                                        02697099
026980     END-EXEC.                                                    02698099
027000                                                                  02700009
027100* COMMUNICATIONS AREA FOR DB2                                     02710008
027200     EXEC SQL                                                     02720008
027300         INCLUDE SQLCA                                            02730008
027400     END-EXEC.                                                    02740008
027500*                                                                 02750008
027600*                                                                 02760008
029010***************************************************************** 02901099
029011**AUDIT CURSOR TO DETERMINE IF THERE IS A PENDING AUDIT ON THE ** 02901199
029012**CARTON ENTERED                                                  02901299
029013***************************************************************** 02901399
029020     EXEC SQL                                                     02902099
029030         DECLARE AUDIT-CSR CURSOR FOR                             02903099
029032             SELECT AUD_CNTL_NBR                                  02903299
029036             FROM   TSUATRN                                       02903699
029037             WHERE  SHIPT_UNT_ID   = :DK-SHIPT-UNT-ID             02903799
029038               AND  UNT_AUD_STAT_CDE IN ('IP','PP')               02903899
029095     END-EXEC.                                                    02909599
029096                                                                  02909699
029100 LINKAGE SECTION.                                                 02910008
029200 01  DFHCOMMAREA.                                                 02920008
029300     05  FILLER                       OCCURS 1 TO 4072 TIMES      02930008
029400                                      DEPENDING ON EIBCALEN.      02940008
029500         10  FILLER                   PIC X.                      02950008
029600*                                                                 02960008
029700*                                                                 02970008
029800 PROCEDURE DIVISION.                                              02980008
029900 0000-PROGRAM-MAINLINE.                                           02990008
030000                                                                  03000008
030100     INITIALIZE CA-COMMAREA                                       03010099
030200     MOVE DFHCOMMAREA TO CA-COMMAREA                              03020099
030300                                                                  03030091
030400     EVALUATE TRUE                                                03040008
030500         WHEN EIBCALEN = ZERO                                     03050008
030600              MOVE PC-ENTER-THROUGH-MENU-MSG TO PV-MESSAGE-AREA   03060099
030700              PERFORM 8300-RETURN                                 03070099
030800                                                                  03080099
030900         WHEN EIBTRNID = 'Z278'                                   03090075
031000              MOVE DFHCOMMAREA         TO PC192-COMMAREA          03100099
031100              MOVE PC192-HOST-SAVE-AREA                           03110099
031200                                       TO CA-COMMAREA             03120099
031300              SET PC033-PROCESS-SCREEN TO TRUE                    03130099
031400              MOVE PC192-HOST-SAVE-MAP TO PC861AO                 03140099
031500              MOVE -1                  TO ACARTNL                 03150099
031600              PERFORM 8000-SEND-MAP                               03160099
031700              PERFORM 8200-RETURN-TRANID                          03170099
031800                                                                  03180099
031900         WHEN EIBAID = DFHCLEAR                                   03190098
032000         WHEN PC033-INITIALIZE-SCREEN                             03200013
032100              SET PC033-PROCESS-SCREEN TO TRUE                    03210099
032200              PERFORM 1000-INITIALIZE                             03220099
032300              MOVE PC-CURRENT-PROGRAM-NAME                        03230099
032400                                 TO PC033-LAST-PROGRAM            03240099
032500              MOVE -1       TO ACARTNL                            03250099
032600              PERFORM 8000-SEND-MAP                               03260099
032700              PERFORM 8200-RETURN-TRANID                          03270099
032800                                                                  03280099
032900         WHEN EIBAID = DFHENTER                                   03290048
033000              SET PS-VALID-INPUT TO TRUE                          03300048
033100              PERFORM 2000-PROCESS-SCREEN-FIELDS                  03310048
033200                                                                  03320048
033300              IF  PS-VALID-INPUT                                  03330048
033400                  MOVE -1                 TO ACARTNL              03340048
033500                  MOVE PC033-CARTON       TO PV-CTN               03350074
033600                                             PV-CTN-N             03360048
033700                  MOVE PC033-STR-NBR      TO PV-STORE-N           03370048
033800                  MOVE PV-STORE           TO ASTRO                03380048
033900                  MOVE PV-SKU-IN-CTN      TO ASKUCTNO             03390048
034000                  MOVE PV-UNT-IN-CTN      TO AUNTCTNO             03400050
034100                                                                  03410048
034200                  PERFORM 8000-SEND-MAP                           03420048
034300                  PERFORM 8200-RETURN-TRANID                      03430048
034400              ELSE                                                03440048
034500                  IF PS-NOT-FOUND                                 03450048
034600                     MOVE PC-CARTON-ID-NOT-FOUND                  03460048
034700                                     TO AMSGLNO                   03470048
034800                     MOVE -1  TO ACARTNL                          03480048
034900                     PERFORM 8100-SEND-DATA-ONLY                  03490048
035000                     PERFORM 8200-RETURN-TRANID                   03500048
035100                  ELSE                                            03510099
035200                      IF PS-NOT-MERCH-CTN                         03520099
035300                         MOVE PC-MUST-BE-MERCHANDISE-CTN          03530099
035400                                                       TO AMSGLNO 03540099
035500                         MOVE -1  TO ACARTNL                      03550099
035600                         PERFORM 8100-SEND-DATA-ONLY              03560099
035700                         PERFORM 8200-RETURN-TRANID               03570099
035800                      ELSE                                        03580099
035900                          IF PS-P2L-CTN                           03590099
036000                              MOVE PC-CANNOT-ADJ-P2L-CRTN         03600099
036100                                                       TO AMSGLNO 03610099
036200                              MOVE -1  TO ACARTNL                 03620099
036300                              PERFORM 8100-SEND-DATA-ONLY         03630099
036400                              PERFORM 8200-RETURN-TRANID          03640099
036500                          ELSE                                    03650099
036600                              IF PS-JWL-CTN                       03660099
036700                                  MOVE PC-CANNOT-ADJ-JWL-CRTN     03670099
036800                                                       TO AMSGLNO 03680099
036900                                  MOVE -1  TO ACARTNL             03690099
037000                                  PERFORM 8100-SEND-DATA-ONLY     03700099
037100                                  PERFORM 8200-RETURN-TRANID      03710099
037200                              ELSE                                03720099
037300                                  IF PS-FXR-CTN                   03730099
037400                                      MOVE PC-CANNOT-ADJ-FXR-CRTN 03740099
037500                                                        TO AMSGLNO03750099
037600                                      MOVE -1  TO ACARTNL         03760099
037700                                      PERFORM 8100-SEND-DATA-ONLY 03770099
037800                                      PERFORM 8200-RETURN-TRANID  03780099
037900                                  ELSE                            03790099
038000                                    IF PS-RDM-CTN                 03800099
038100                                      MOVE PC-CANNOT-ADJ-RDM-CRTN 03810099
038200                                                        TO AMSGLNO03820099
038300                                      MOVE -1  TO ACARTNL         03830099
038400                                      PERFORM 8100-SEND-DATA-ONLY 03840099
038500                                      PERFORM 8200-RETURN-TRANID  03850099
038600                                    ELSE                          03860099
038700                                      MOVE -1  TO ACARTNL         03870099
038800                                      PERFORM 8100-SEND-DATA-ONLY 03880099
038900                                      PERFORM 8200-RETURN-TRANID  03890099
039000                                    END-IF                        03900099
039100                                  END-IF                          03910099
039200                              END-IF                              03920099
039300                          END-IF                                  03930099
039301                      END-IF                                      03930199
039302                  END-IF                                          03930248
039303              END-IF                                              03930348
039304                                                                  03930448
039305         WHEN EIBAID = DFHPF1                                     03930548
039306             PERFORM 2100-RECEIVE-MAP                             03930699
039307             MOVE PC861AO             TO PC192-HOST-SAVE-MAP      03930748
039308             PERFORM 1200-HELP-SCREEN                             03930848
039309                                                                  03930948
039310         WHEN EIBAID = DFHPF3                                     03931048
039311              MOVE PC-CARTON-FUNC-PGM TO                          03931199
039312                          PV-TRANSFER-PROGRAM                     03931255
039313              PERFORM 4000-XCTL-TO-SELECTED-PROGRAM               03931348
039314                                                                  03931448
039315         WHEN EIBAID = DFHPF4                                     03931589
039316              PERFORM 2000-PROCESS-SCREEN-FIELDS                  03931699
039317              SET  PC033-INITIALIZE-SCREEN TO TRUE                03931713
039318              IF PS-VALID-INPUT                                   03931857
039319                 PERFORM 3000-CHECK-CARTON-STATUS                 03931999
039320                 IF PS-VALID-INPUT                                03932099
039321                     MOVE PC-ALTER-REASON-PGM TO                  03932199
039322                                  PV-TRANSFER-PROGRAM             03932299
039323                     PERFORM 4000-XCTL-TO-SELECTED-PROGRAM        03932399
039324                 ELSE                                             03932499
039325                     MOVE PC-CANNOT-ADJ-TRP-CLSD TO AMSGLNO       03932599
039326                     MOVE -1  TO ACARTNL                          03932699
039327                     PERFORM 8100-SEND-DATA-ONLY                  03932799
039328                     PERFORM 8200-RETURN-TRANID                   03932899
039329                  END-IF                                          03932999
039330              ELSE                                                03933099
039331                  IF PV-CHAR-COUNT = 0                            03933199
039332                     MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNA       03933299
039333                     MOVE PC-PLS-ENT-FLD-MSG     TO AMSGLNO       03933399
039334                     MOVE -1                     TO ACARTNL       03933499
039335                     PERFORM 8100-SEND-DATA-ONLY                  03933599
039336                     PERFORM 8200-RETURN-TRANID                   03933699
039337                  ELSE                                            03933799
039338                      IF PS-NOT-FOUND                             03933899
039339                         MOVE PC-CARTON-ID-NOT-FOUND TO AMSGLNO   03933999
039400                         MOVE -1  TO ACARTNL                      03940099
039500                         PERFORM 8100-SEND-DATA-ONLY              03950099
039600                         PERFORM 8200-RETURN-TRANID               03960099
039700                      ELSE                                        03970099
039800                          IF PS-NOT-MERCH-CTN                     03980099
039900                              MOVE PC-MUST-BE-MERCHANDISE-CTN     03990099
040000                                                       TO AMSGLNO 04000099
040100                             MOVE -1  TO ACARTNL                  04010099
040200                             PERFORM 8100-SEND-DATA-ONLY          04020099
040300                             PERFORM 8200-RETURN-TRANID           04030099
040400                      ELSE                                        04040099
040401                          IF PS-P2L-CTN                           04040199
040402                              MOVE PC-CANNOT-ADJ-P2L-CRTN         04040299
040403                                                       TO AMSGLNO 04040399
040404                             MOVE -1  TO ACARTNL                  04040499
040405                             PERFORM 8100-SEND-DATA-ONLY          04040599
040406                             PERFORM 8200-RETURN-TRANID           04040699
040407                      ELSE                                        04040799
040408                          IF PS-JWL-CTN                           04040899
040409                              MOVE PC-CANNOT-ADJ-JWL-CRTN         04040999
040410                                                       TO AMSGLNO 04041099
040411                             MOVE -1  TO ACARTNL                  04041199
040412                             PERFORM 8100-SEND-DATA-ONLY          04041299
040413                             PERFORM 8200-RETURN-TRANID           04041399
040414                          ELSE                                    04041499
040415                              IF PS-FXR-CTN                       04041599
040416                                 MOVE PC-CANNOT-ADJ-FXR-CRTN      04041699
040417                                                       TO AMSGLNO 04041799
040418                                 MOVE -1  TO ACARTNL              04041899
040419                                 PERFORM 8100-SEND-DATA-ONLY      04041999
040420                                 PERFORM 8200-RETURN-TRANID       04042099
040430                              ELSE                                04043099
040440                                IF PS-RDM-CTN                     04044099
040450                                   MOVE PC-CANNOT-ADJ-RDM-CRTN    04045099
040460                                                       TO AMSGLNO 04046099
040470                                   MOVE -1  TO ACARTNL            04047099
040480                                   PERFORM 8100-SEND-DATA-ONLY    04048099
040490                                   PERFORM 8200-RETURN-TRANID     04049099
040500                                ELSE                              04050099
040600                                    MOVE -1  TO ACARTNL           04060099
040700                                    PERFORM 8100-SEND-DATA-ONLY   04070099
040800                                    PERFORM 8200-RETURN-TRANID    04080099
040900                                 END-IF                           04090099
041000                               END-IF                             04100099
041100                          END-IF                                  04110099
041200                          END-IF                                  04120099
041201                          END-IF                                  04120199
041202                      END-IF                                      04120299
041203                  END-IF                                          04120399
041204              END-IF                                              04120499
041205                                                                  04120557
041300         WHEN OTHER                                               04130008
041400              MOVE PC-UNRECOGNIZED-PF-KEY-MSG TO AMSGLNO          04140008
041500              PERFORM 8100-SEND-DATA-ONLY                         04150008
041600              PERFORM 8200-RETURN-TRANID                          04160008
041700     END-EVALUATE.                                                04170008
041800                                                                  04180008
041900     GOBACK.                                                      04190008
042000*                                                                 04200008
042100*-----------------------------------------------------------      04210099
042200 1000-INITIALIZE.                                                 04220008
042300     IF  PC033-LAST-PROGRAM = PC-MANIFEST-MENU-PGM OR             04230008
042400         PC033-LAST-PROGRAM = PC-ADJUST-CRTN-UNTS-PGM OR          04240008
042500         PC033-LAST-PROGRAM = PC-ALTER-REASON-PGM OR              04250008
042600         PC033-LAST-PROGRAM = PC-ADJUSTED-QTY-PGM OR              04260099
042700         PC033-LAST-PROGRAM = PC-CARTON-FUNC-PGM                  04270099
042800             INITIALIZE PV-PROGRAM-DATA                           04280011
042900             MOVE SPACES            TO  ACARTNO                   04290019
043000             MOVE -1                TO  ACARTNL                   04300019
043100     ELSE                                                         04310008
043200             MOVE DP015-PRO-NOR-OFF  TO  ACARTNA                  04320019
043300             MOVE -1                 TO  ACARTNL                  04330019
043400             COMPUTE PV-CTN-N      = PC033-CARTON * 1             04340066
043500                                                                  04350008
043600             MOVE PV-CTN-N           TO  ACARTNO                  04360065
043700     END-IF.                                                      04370008
043800                                                                  04380008
043900     MOVE PC-CURRENT-PROGRAM-NAME TO PC033-LAST-PROGRAM.          04390008
044000*                                                                 04400008
044100*                                                                 04410008
044200 1200-HELP-SCREEN.                                                04420008
044300     MOVE 'DPKRF278'                  TO PV-TRANSFER-PROGRAM      04430008
044400     MOVE 'PCKRF861'                  TO PC192-PROGRAM-NAME       04440008
044500     COPY PCPD188.                                                04450008
044600     MOVE PC188-DISPLAY-DATE          TO PC192-DISPLAY-DATE.      04460008
044700     MOVE CA-COMMAREA                 TO PC192-HOST-SAVE-AREA     04470073
044800     PERFORM 8400-XCTL-TO-HELP.                                   04480008
044900*                                                                 04490008
045000*                                                                 04500009
045100 2000-PROCESS-SCREEN-FIELDS.                                      04510008
045200     PERFORM 2100-RECEIVE-MAP.                                    04520008
045300     PERFORM 2200-EDIT-INPUT.                                     04530008
045400*                                                                 04540008
045500*                                                                 04550008
045600 2100-RECEIVE-MAP.                                                04560008
045700     EXEC CICS                                                    04570008
045800         RECEIVE MAP    ('PC861A')                                04580008
045900                 MAPSET ('PCKM861')                               04590008
046000                 RESP   (PV-CICS-RESPONSE)                        04600008
046100     END-EXEC.                                                    04610008
046200                                                                  04620008
046300     EVALUATE TRUE                                                04630008
046400         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 04640008
046500             PERFORM 2110-RECEIVE-SCREEN-FIELDS                   04650008
046600         WHEN PV-CICS-RESPONSE = DFHRESP (MAPFAIL)                04660008
046700             CONTINUE                                             04670008
046800         WHEN OTHER                                               04680008
046900            MOVE '2100-RECEIVE-MAP'      TO DP013-PARAGRAPH       04690008
047000            MOVE 'UNABLE TO RECEIVE MAP' TO DP013-MESSAGE-TEXT (1)04700008
047100            SET DP013-LOGIC-ABEND        TO TRUE                  04710008
047200            SET DP013-NO-ROLLBACK        TO TRUE                  04720008
047300            PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG                04730008
047400     END-EVALUATE.                                                04740008
047500*                                                                 04750008
047600*                                                                 04760008
047700 2110-RECEIVE-SCREEN-FIELDS.                                      04770008
047800     IF  ACARTNL > ZERO                                           04780019
047900         MOVE ACARTNI TO PV-CTN                                   04790019
048000     ELSE                                                         04800008
048100         IF ACARTNA = DP015-ERASE-EOF                             04810019
048200             MOVE SPACES TO PV-CTN                                04820008
048300         END-IF                                                   04830008
048400     END-IF.                                                      04840008
048500*                                                                 04850008
048600*                                                                 04860008
048700 2200-EDIT-INPUT.                                                 04870008
048800     PERFORM 2210-INITIALIZE-ATTRIBUTES.                          04880008
048900     PERFORM 2230-EDIT-CTN.                                       04890008
049000*                                                                 04900008
049100*                                                                 04910008
049200 2210-INITIALIZE-ATTRIBUTES.                                      04920008
049300     MOVE DP015-UNP-ALP-NOR-MDT      TO ACARTNA.                  04930019
049400                                                                  04940008
049500     MOVE PV-CTN         TO ACARTNO.                              04950092
049600     MOVE PV-STORE-NBR   TO ASTRO.                                04960092
049700     MOVE PV-SKU-IN-CTN  TO ASKUCTNO.                             04970010
049800     MOVE PV-UNT-IN-CTN  TO AUNTCTNO.                             04980050
049900     MOVE SPACES         TO AMSGLNO.                              04990008
050000*                                                                 05000008
050100*                                                                 05010008
050200 2230-EDIT-CTN.                                                   05020008
050210**  DMH- COMMENTED OUT EDITING OF CARTON ID AND REPLACED WITH     05021099
050220**  EDITING IN CARTON STATUS PROGRAM (PCKRF880)                   05022099
050230**                                                                05023099
050300**   MOVE 0 TO PV-CHAR-COUNT.                                     05030099
050400**   INSPECT PV-CTN TALLYING PV-CHAR-COUNT FOR CHARACTERS         05040099
050500**               BEFORE INITIAL SPACE.                            05050099
050600**   EVALUATE TRUE                                                05060099
050700**       WHEN PV-CTN = SPACES                                     05070099
050800**           SET PS-INVALID-INPUT        TO TRUE                  05080099
050900**           MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNA               05090099
051000**           MOVE -1                     TO ACARTNL               05100099
051100**           MOVE PC-PLS-ENT-FLD-MSG     TO AMSGLNO               05110099
051110**                                                                05111099
051200**       WHEN PV-CHAR-COUNT = PC-18 AND                           05120099
051400**           (PV-CTN-FIRST-DIGIT NOT =  PC-4)                     05140099
051500**           SET PS-INVALID-INPUT        TO TRUE                  05150099
051600**           MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNA               05160099
051700**           MOVE -1                     TO ACARTNL               05170099
051800**           MOVE PC-MUST-BE-KOHLS-BARCODE TO AMSGLNO             05180099
051900**                                                                05190099
052000**       WHEN PV-CHAR-COUNT = PC-20 AND                           05200099
052100**          ((PV-CTN-FIRST-DIGIT NOT =  PC-0) AND                 05210099
052200**           (PV-CTN-SCAN-THIRD-DGT NOT =  PC-4))                 05220099
052300**           SET PS-INVALID-INPUT        TO TRUE                  05230099
052400**           MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNA               05240099
052500**           MOVE -1                     TO ACARTNL               05250099
052600**           MOVE PC-MUST-BE-KOHLS-BARCODE TO AMSGLNO             05260099
052700**                                                                05270099
052800**       WHEN PV-CHAR-COUNT = PC-20 AND                           05280099
052900**          ((PV-CTN-FIRST-DIGIT =  PC-0) AND                     05290099
053000**           (PV-CTN-SCAN-THIRD-DGT NOT =  PC-4))                 05300099
053100**           SET PS-INVALID-INPUT        TO TRUE                  05310099
053200**           MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNA               05320099
053300**           MOVE -1                     TO ACARTNL               05330099
053400**           MOVE PC-MUST-BE-KOHLS-BARCODE TO AMSGLNO             05340099
053500**                                                                05350099
053600**       WHEN PV-CHAR-COUNT < PC-18                               05360099
053700**           SET PS-INVALID-INPUT        TO TRUE                  05370099
053800**           MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNA               05380099
053900**           MOVE -1                     TO ACARTNL               05390099
054000**           MOVE PC-MORE-DIGITS-REQD    TO AMSGLNO               05400099
054100**       WHEN OTHER                                               05410099
054200**           SET DP010I-NEGATIVE-NOT-ALLOWED                      05420099
054300**               PS-NOT-SCANNED-DATA TO TRUE                      05430099
054400**           IF PV-CHAR-COUNT = PC-18                             05440099
054500**               MOVE PV-CTN-LAST-17      TO DP010I-UNEDITED-FIELD05450099
054600**           ELSE                                                 05460099
054700**               IF PV-CHAR-COUNT < PC-18                         05470099
054800**                   MOVE PV-CTN          TO DP010I-UNEDITED-FIELD05480099
054900**               ELSE                                             05490099
055000**                   MOVE PV-CTN-SCAN-LAST-17                     05500099
055100**                                        TO DP010I-UNEDITED-FIELD05510099
055200**                   SET PS-SCANNED-DATA TO TRUE                  05520099
055300**               END-IF                                           05530099
055400**           END-IF                                               05540099
055500**           MOVE 17     TO DP010I-MAXIMUM-DIGITS                 05550099
055600**           MOVE 0      TO DP010I-MAXIMUM-DECIMALS               05560099
055700**                                                                05570099
055810**           CALL DP010I-NUMERIC-EDIT-ROUTINE                     05581099
055820**                       USING DP010I-NUMERIC-EDIT-AREA           05582099
055900**           IF  DP010I-ERROR-DETECTED                            05590099
056000**               SET PS-INVALID-INPUT        TO TRUE              05600099
056100**               MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNA           05610099
056200**               MOVE -1                     TO ACARTNL           05620099
056300**               MOVE PC-MUST-BE-NUM-MSG     TO AMSGLNO           05630099
056400**           ELSE                                                 05640099
056500**               IF DP010I-NUMERIC-FIELD = ZEROES                 05650099
056600**                   SET PS-INVALID-INPUT        TO TRUE          05660099
056700**                   MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNA       05670099
056800**                   MOVE -1                     TO ACARTNL       05680099
056900**                   MOVE PC-MUST-BE-GT-0-MSG    TO AMSGLNO       05690099
057000**               ELSE                                             05700099
057100**                    COMPUTE PC033-CARTON      ROUNDED =         05710099
057200**                      DP010I-NUM-FIELD-17-DIG-0-DEC * 1         05720099
057300**                    COMPUTE PV-CTN-N          ROUNDED =         05730099
057400**                      DP010I-NUM-FIELD-17-DIG-0-DEC * 1         05740099
057500**                     EVALUATE TRUE                              05750099
057600**                        WHEN PV-CHAR-COUNT = PC-20              05760099
057700**                           IF PV-CTN-SCAN-THIRD-DGT  = PC-4     05770099
057800**                              MOVE PV-CTN TO DK-BARCODE-NBR     05780099
057900**                              MOVE PV-CTN-SCAN-LAST-18 TO       05790099
058000**                                                PV-CTN-N        05800099
058100**                                                PC033-CARTON    05810099
058200**                           END-IF                               05820099
058300**                        WHEN PV-CHAR-COUNT = PC-18              05830099
058400**                           IF PV-CTN-FIRST-DIGIT  = PC-4        05840099
058500**                              MOVE PV-CTN  TO PV-CTN-N          05850099
058600**                              MOVE PV-CTN-N TO PC033-CARTON     05860099
058700**                           END-IF                               05870099
058800**                        END-EVALUATE                            05880099
058900**                   MOVE PV-CTN-N              TO ACARTNO        05890099
059000**                   PERFORM 2240-CHECK-TABLES                    05900099
059100**               END-IF                                           05910099
059200**           END-IF                                               05920099
059300**   END-EVALUATE.                                                05930099
059400**   EVALUATE TRUE                                                05940099
059500**      WHEN PV-CHAR-COUNT = 0                                    05950099
059600**         SET PS-INVALID-INPUT TO TRUE                           05960099
059700**      WHEN PV-CHAR-COUNT = PC-18                                05970099
059800**         MOVE PV-CTN-N TO DK-SHIPT-UNT-ID                       05980099
059900**      WHEN PV-CHAR-COUNT = PC-20                                05990099
060000**         MOVE PV-CTN   TO DK-BARCODE-NBR                        06000099
060100**   END-EVALUATE.                                                06010099
060110**                                                                06011099
060200                                                                  06020099
060201     MOVE 0 TO PV-CHAR-COUNT.                                     06020199
060203     INSPECT PV-CTN TALLYING PV-CHAR-COUNT FOR CHARACTERS         06020399
060204                 BEFORE INITIAL SPACE.                            06020499
060205                                                                  06020599
060206     EVALUATE TRUE                                                06020699
060207         WHEN PV-CTN = SPACES                                     06020799
060209             SET PS-INVALID-INPUT           TO TRUE               06020999
060210             MOVE DP015-UNP-ALP-BRT-MDT     TO ACARTNA            06021099
060211             MOVE -1                        TO ACARTNL            06021199
060212             MOVE PC-PLS-ENT-FLD-MSG        TO AMSGLNO            06021299
060215                                                                  06021599
060216         WHEN PV-CHAR-COUNT = PC-18 AND                           06021699
060218             (PV-CTN-FIRST-DIGIT NOT =  PC-4)                     06021899
060220             SET PS-INVALID-INPUT           TO TRUE               06022099
060221             MOVE DP015-UNP-ALP-BRT-MDT     TO ACARTNA            06022199
060222             MOVE -1                        TO ACARTNL            06022299
060223             MOVE PC-MUST-BE-KOHLS-BARCODE  TO AMSGLNO            06022399
060224                                                                  06022499
060226         WHEN PV-CHAR-COUNT < PC-18                               06022699
060228             SET PS-INVALID-INPUT            TO TRUE              06022899
060229             MOVE DP015-UNP-ALP-BRT-MDT      TO ACARTNA           06022999
060230             MOVE -1                         TO ACARTNL           06023099
060231             MOVE PC-MORE-DIGITS-REQD        TO AMSGLNO           06023199
060232                                                                  06023299
060234         WHEN OTHER                                               06023499
060235                                                                  06023599
060236             SET DP010I-NEGATIVE-NOT-ALLOWED                      06023699
060237                 PS-NOT-SCANNED-DATA         TO TRUE              06023799
060238                                                                  06023899
060239             IF PV-CHAR-COUNT = PC-18                             06023999
060240                 MOVE PV-CTN-LAST-17      TO DP010I-UNEDITED-FIELD06024099
060241             ELSE                                                 06024199
060242                 IF PV-CHAR-COUNT < PC-18                         06024299
060243                     MOVE PV-CTN          TO DP010I-UNEDITED-FIELD06024399
060244                 ELSE                                             06024499
060245                     MOVE PV-CTN-SCAN-LAST-17                     06024599
060246                                          TO DP010I-UNEDITED-FIELD06024699
060247                     SET PS-SCANNED-DATA  TO TRUE                 06024799
060248                 END-IF                                           06024899
060249             END-IF                                               06024999
060250                                                                  06025099
060251             MOVE 17     TO DP010I-MAXIMUM-DIGITS                 06025199
060252             MOVE 0      TO DP010I-MAXIMUM-DECIMALS               06025299
060253                                                                  06025399
060255             CALL DP010I-NUMERIC-EDIT-ROUTINE                     06025599
060256                         USING DP010I-NUMERIC-EDIT-AREA           06025699
060257                                                                  06025799
060258             IF  DP010I-ERROR-DETECTED                            06025899
060259                 SET PS-INVALID-INPUT        TO TRUE              06025999
060260                 MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNA           06026099
060261                 MOVE -1                     TO ACARTNL           06026199
060262                 MOVE PC-MUST-BE-NUM-MSG     TO AMSGLNO           06026299
060263                                                                  06026399
060264             ELSE                                                 06026499
060265                 IF DP010I-NUMERIC-FIELD = ZEROES                 06026599
060267                     SET PS-INVALID-INPUT        TO TRUE          06026799
060268                     MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNA       06026899
060269                     MOVE -1                     TO ACARTNL       06026999
060270                     MOVE PC-MUST-BE-GT-0-MSG    TO AMSGLNO       06027099
060271                                                                  06027199
060273                 ELSE                                             06027399
060274                      COMPUTE PC033-CARTON      ROUNDED =         06027499
060275                        DP010I-NUM-FIELD-17-DIG-0-DEC * 1         06027599
060276                      COMPUTE PV-CTN-N          ROUNDED =         06027699
060277                        DP010I-NUM-FIELD-17-DIG-0-DEC * 1         06027799
060278                                                                  06027899
060279                      EVALUATE TRUE                               06027999
060280                          WHEN PV-CHAR-COUNT = PC-20              06028099
060281                             IF PV-CTN-SCAN-THIRD-DGT  = PC-4     06028199
060284                                MOVE PV-CTN TO DK-BARCODE-NBR     06028499
060285                                MOVE PV-CTN-SCAN-LAST-18 TO       06028599
060287                                                    PV-CTN-N      06028799
060288                                                    PC033-CARTON  06028899
060289                             END-IF                               06028999
060290                                                                  06029099
060291                          WHEN PV-CHAR-COUNT = PC-18              06029199
060292                             IF PV-CTN-FIRST-DIGIT  = PC-4        06029299
060293                                MOVE PV-CTN    TO PV-CTN-N        06029399
060294                                MOVE PV-CTN-N  TO PC033-CARTON    06029499
060295                             END-IF                               06029599
060296                          END-EVALUATE                            06029699
060297                                                                  06029799
060298                     MOVE PV-CTN-N      TO ACARTNO                06029899
060299                     PERFORM 2240-CHECK-TABLES                    06029999
060301                                                                  06030199
060302                 END-IF                                           06030299
060303             END-IF                                               06030399
060304     END-EVALUATE.                                                06030499
060305                                                                  06030599
060306     EVALUATE TRUE                                                06030699
060307         WHEN PV-CHAR-COUNT = 0                                   06030799
060308              SET PS-INVALID-INPUT TO TRUE                        06030899
060309         WHEN PV-CHAR-COUNT = PC-18                               06030999
060310              MOVE PV-CTN-N TO DK-SHIPT-UNT-ID                    06031099
060311         WHEN PV-CHAR-COUNT = PC-20                               06031199
060312              MOVE PV-CTN   TO DK-BARCODE-NBR                     06031299
060313     END-EVALUATE.                                                06031399
060316                                                                  06031699
060317                                                                  06031799
060330                                                                  06033099
060400 2240-CHECK-TABLES.                                               06040009
060500     PERFORM 2250-SELECT-OTBND-CART.                              06050099
060600     IF PS-CARTON-EXISTS                                          06060033
060700        MOVE SUT00024-SHIPT-UNT-ID TO DK-SHIPT-UNT-ID             06070099
060701                                                                  06070199
060710**CHECK IF THERE IS AN OPEN AUDIT ON THE CARTON                   06071099
060720**IF SO, DO NOT ALLOW UNIT ADJUSTMENT                             06072099
060721                                                                  06072199
060730        SET PS-NO-CARTON-AUDIT-PENDING                            06073099
060740            PS-NOT-END-OF-CURSOR-AUD TO TRUE                      06074099
060750                                                                  06075099
060801        PERFORM 7600-OPEN-AUDIT-CSR                               06080199
060803        PERFORM 7610-FETCH-AUDIT-CSR UNTIL                        06080399
060804                   PS-END-OF-CURSOR-AUD OR                        06080499
060805                   PS-CARTON-AUDIT-PENDING                        06080599
060806        PERFORM 7620-CLOSE-AUDIT-CSR                              06080699
060807                                                                  06080799
060810        IF PS-CARTON-AUDIT-PENDING                                06081099
060830           MOVE PC-CANNOT-ADJ-AUD-CRTN                            06083099
060840                           TO AMSGLNO                             06084099
060850           MOVE -1  TO ACARTNL                                    06085099
060860           PERFORM 8100-SEND-DATA-ONLY                            06086099
060870           PERFORM 8200-RETURN-TRANID                             06087099
060880        END-IF                                                    06088099
060890                                                                  06089099
061000        INITIALIZE PV-SKU-IN-CTN                                  06100099
061100        PERFORM 7500-COUNT-SKUS-IN-CTN                            06110099
061300                                                                  06130099
061400        PERFORM 2260-GET-UNITS-IN-CTN                             06140052
061500     ELSE                                                         06150033
061600        SET PS-INVALID-INPUT                                      06160033
061700            PS-NOT-FOUND TO TRUE                                  06170041
061800     END-IF.                                                      06180033
061900*                                                                 06190008
062000*                                                                 06200033
062100*NOTE:  MERCHANDISE CARTONS - HIER_LVL_CDE=0                      06210041
062200*FIRST CHECK TO SEE IF SHIPT-UNT-ID IS ON SUT_OTBND_CART.         06220099
062300*IF NOT, CHECK TO SEE IF IT IS ON ORIG-SHIPT-UNT-ID.              06230099
062400 2250-SELECT-OTBND-CART.                                          06240099
062500     MOVE PV-CTN-N      TO DK-SHIPT-UNT-ID                        06250099
062600     EXEC SQL                                                     06260008
062700         SELECT  ORGN_LOC_NBR                                     06270099
062800                ,DEST_LOC_NBR                                     06280099
062900                ,CART_SRC_CDE                                     06290099
063000                ,SHIPT_UNT_ID                                     06300031
063100                ,MSTR_CART_IND                                    06310099
063200                ,ACTV_IND                                         06320099
063300         INTO    :SUT00024-ORGN-LOC-NBR                           06330099
063400                ,:SUT00024-DEST-LOC-NBR                           06340099
063500                ,:SUT00024-CART-SRC-CDE                           06350099
063600                ,:SUT00024-SHIPT-UNT-ID                           06360099
063700                ,:SUT00024-MSTR-CART-IND                          06370099
063800                ,:SUT00024-ACTV-IND                               06380099
063900         FROM   SUT_OTBND_CART                                    06390099
064000         WHERE  SHIPT_UNT_ID   = :DK-SHIPT-UNT-ID                 06400099
064100     END-EXEC.                                                    06410008
064200     EVALUATE TRUE                                                06420008
064300         WHEN SQLCODE = ZERO                                      06430008
064400            SET PS-CARTON-EXISTS TO TRUE                          06440008
064500            IF SUT00024-DEST-LOC-NBR = 0                          06450099
064600                  MOVE SUT00024-ORGN-LOC-NBR TO                   06460099
064700                                          SUT00024-DEST-LOC-NBR   06470099
064800                                          PV-STORE-NBR            06480010
064900                                          PC033-STR-NBR           06490008
065000            ELSE                                                  06500008
065100                  MOVE SUT00024-DEST-LOC-NBR   TO PV-STORE-NBR    06510099
065200                                                  PC033-STR-NBR   06520008
065300            END-IF                                                06530008
065400                                                                  06540041
065500            IF SUT00024-MSTR-CART-IND = 'N'                       06550099
065600               SET PS-MERCH-CTN TO TRUE                           06560041
065700               MOVE SUT00024-SHIPT-UNT-ID                         06570099
065800                           TO SUT00024-PRNT-CART-ID               06580099
065900            ELSE                                                  06590041
066000               SET PS-INVALID-INPUT        TO TRUE                06600099
066100               SET PS-NOT-MERCH-CTN TO TRUE                       06610041
066200            END-IF                                                06620041
066300*LMM                                                              06630099
066400            IF SUT00024-ACTV-IND = 'N'                            06640099
066500               MOVE PC-CARTON-INACTIVATED                         06650099
066600                               TO AMSGLNO                         06660099
066700               MOVE -1  TO ACARTNL                                06670099
066800               PERFORM 8100-SEND-DATA-ONLY                        06680099
066900               PERFORM 8200-RETURN-TRANID                         06690099
067000            END-IF                                                06700099
067100                                                                  06710099
067200            IF SUT00024-CART-SRC-CDE = 'P2L'                      06720099
067201               SET PS-P2L-CTN  TO TRUE                            06720199
067202               MOVE PC-CANNOT-ADJ-P2L-CRTN                        06720299
067203                               TO AMSGLNO                         06720399
067204               MOVE -1  TO ACARTNL                                06720499
067205               PERFORM 8100-SEND-DATA-ONLY                        06720599
067206               PERFORM 8200-RETURN-TRANID                         06720699
067207            END-IF                                                06720799
067208                                                                  06720899
067209            IF SUT00024-CART-SRC-CDE = 'JWL'                      06720999
067210               SET PS-JWL-CTN  TO TRUE                            06721099
067211               MOVE PC-CANNOT-ADJ-JWL-CRTN                        06721199
067212                               TO AMSGLNO                         06721299
067213               MOVE -1  TO ACARTNL                                06721399
067214               PERFORM 8100-SEND-DATA-ONLY                        06721499
067215               PERFORM 8200-RETURN-TRANID                         06721599
067216            END-IF                                                06721699
067217                                                                  06721799
067218            IF SUT00024-CART-SRC-CDE = 'FXR'                      06721899
067219               SET PS-FXR-CTN  TO TRUE                            06721999
067220               MOVE PC-CANNOT-ADJ-FXR-CRTN                        06722099
067221                               TO AMSGLNO                         06722199
067222               MOVE -1  TO ACARTNL                                06722299
067223               PERFORM 8100-SEND-DATA-ONLY                        06722399
067224               PERFORM 8200-RETURN-TRANID                         06722499
067225            END-IF                                                06722599
067226                                                                  06722699
067227            IF SUT00024-CART-SRC-CDE = 'RDM'                      06722799
067228               SET PS-RDM-CTN  TO TRUE                            06722899
067229               MOVE PC-CANNOT-ADJ-RDM-CRTN                        06722999
067230                               TO AMSGLNO                         06723099
067231               MOVE -1  TO ACARTNL                                06723199
067232               PERFORM 8100-SEND-DATA-ONLY                        06723299
067233               PERFORM 8200-RETURN-TRANID                         06723399
067234            END-IF                                                06723499
067235                                                                  06723599
067236            IF SUT00024-CART-SRC-CDE = 'SMO'                      06723699
067237                PERFORM 2255-GET-PO-RCVR                          06723799
067238                MOVE SPACE TO PS-AUTO-VE-SW                       06723899
067239                PERFORM 2256-CHECK-4-AUTOVE                       06723999
067240                IF PS-AUTO-VE-YES                                 06724099
067250                   PERFORM 2257-CHECK-TRECEIV                     06725099
067260                   IF PS-ALLOW-ADJ-YES                            06726099
067270                       CONTINUE                                   06727099
067280                   ELSE                                           06728099
067290                       MOVE PC-CANNOT-ADJ-SMOOTHED TO AMSGLNO     06729099
067300                       MOVE -1  TO ACARTNL                        06730099
067400                       PERFORM 8100-SEND-DATA-ONLY                06740099
067500                       PERFORM 8200-RETURN-TRANID                 06750099
067600                   END-IF                                         06760099
067700                ELSE                                              06770099
067800                    MOVE PC-CANNOT-ADJ-SMOOTHED TO AMSGLNO        06780099
067900                    MOVE -1  TO ACARTNL                           06790099
068000                    PERFORM 8100-SEND-DATA-ONLY                   06800099
068100                    PERFORM 8200-RETURN-TRANID                    06810099
068200                END-IF                                            06820099
068201            END-IF                                                06820199
068202                                                                  06820299
068203         WHEN SQLCODE = +100                                      06820308
068204              PERFORM 2251-SELECT-OTBND-CART                      06820499
068205         WHEN SQLWARN0 NOT = SPACES                               06820508
068300         WHEN SQLCODE NOT EQUAL ZERO                              06830008
068400             MOVE '2250-SELECT-OTBND-CART'                        06840099
068500                             TO DP013-PARAGRAPH                   06850008
068600             MOVE 'PCKRF861 - CHECK VALID CARTON'                 06860020
068700                             TO DP013-MESSAGE-TEXT(1)             06870008
068800             MOVE SUT00024-SHIPT-UNT-ID                           06880099
068900                             TO DP013-MESSAGE-TEXT(2)             06890008
069000             MOVE SQLCA      TO DP013-SQLCA                       06900008
069100             MOVE 'SUT00024' TO DP013-DB2-TABLE-NAME(1)           06910099
069200             SET DP013-DB2-ABEND                                  06920008
069300                             TO TRUE                              06930008
069400             SET DP013-ROLLBACK                                   06940008
069500                             TO TRUE                              06950008
069600             SET DP013-XCTL-DISPLAY-RESTART                       06960008
069700                             TO TRUE                              06970008
069800             PERFORM DP014-0000-PROCESS-ABEND                     06980008
069900     END-EVALUATE.                                                06990008
070100*                                                                 07010009
070200 2251-SELECT-OTBND-CART.                                          07020099
070300                                                                  07030099
070400     EXEC SQL                                                     07040099
070500         SELECT  ORGN_LOC_NBR                                     07050099
070600                ,DEST_LOC_NBR                                     07060099
070700                ,CART_SRC_CDE                                     07070099
070800                ,SHIPT_UNT_ID                                     07080099
070900                ,MSTR_CART_IND                                    07090099
071000                ,ACTV_IND                                         07100099
071010                ,ORIG_CART_ID                                     07101099
071100         INTO    :SUT00024-ORGN-LOC-NBR                           07110099
071200                ,:SUT00024-DEST-LOC-NBR                           07120099
071300                ,:SUT00024-CART-SRC-CDE                           07130099
071400                ,:SUT00024-SHIPT-UNT-ID                           07140099
071500                ,:SUT00024-MSTR-CART-IND                          07150099
071600                ,:SUT00024-ACTV-IND                               07160099
071610                ,:SUT00024-ORIG-CART-ID                           07161099
071700         FROM   SUT_OTBND_CART                                    07170099
071800         WHERE  ORIG_CART_ID   = :DK-SHIPT-UNT-ID                 07180099
071900     END-EXEC.                                                    07190099
071910                                                                  07191099
072000     EVALUATE TRUE                                                07200099
072100         WHEN SQLCODE = ZERO                                      07210099
072110            SET PS-CARTON-EXISTS TO TRUE                          07211099
072112*           MOVE SUT00024-ORIG-CART-ID  TO SUT00024-SHIPT-UNT-ID  07211299
072120            IF SUT00024-DEST-LOC-NBR = 0                          07212099
072130                  MOVE SUT00024-ORGN-LOC-NBR TO                   07213099
072140                                          SUT00024-DEST-LOC-NBR   07214099
072150                                          PV-STORE-NBR            07215099
072160                                          PC033-STR-NBR           07216099
072170            ELSE                                                  07217099
072180                  MOVE SUT00024-DEST-LOC-NBR   TO PV-STORE-NBR    07218099
072190                                                  PC033-STR-NBR   07219099
072191            END-IF                                                07219199
072192                                                                  07219299
072193            IF SUT00024-MSTR-CART-IND = 'N'                       07219399
072194               SET PS-MERCH-CTN TO TRUE                           07219499
072195               MOVE SUT00024-ORIG-CART-ID                         07219599
072196                           TO SUT00024-PRNT-CART-ID               07219699
072197            ELSE                                                  07219799
072198               SET PS-INVALID-INPUT        TO TRUE                07219899
072199               SET PS-NOT-MERCH-CTN TO TRUE                       07219999
072200            END-IF                                                07220099
072202            IF SUT00024-ACTV-IND = 'N'                            07220299
072203               MOVE PC-CARTON-INACTIVATED                         07220399
072204                               TO AMSGLNO                         07220499
072205               MOVE -1  TO ACARTNL                                07220599
072206               PERFORM 8100-SEND-DATA-ONLY                        07220699
072207               PERFORM 8200-RETURN-TRANID                         07220799
072208            END-IF                                                07220899
072209                                                                  07220999
072210            IF SUT00024-CART-SRC-CDE = 'P2L'                      07221099
072211               SET PS-P2L-CTN       TO TRUE                       07221199
072212               MOVE PC-CANNOT-ADJ-P2L-CRTN                        07221299
072213                               TO AMSGLNO                         07221399
072214               MOVE -1  TO ACARTNL                                07221499
072215               PERFORM 8100-SEND-DATA-ONLY                        07221599
072216               PERFORM 8200-RETURN-TRANID                         07221699
072217            END-IF                                                07221799
072218                                                                  07221899
072219            IF SUT00024-CART-SRC-CDE = 'JWL'                      07221999
072220               SET PS-JWL-CTN       TO TRUE                       07222099
072221               MOVE PC-CANNOT-ADJ-JWL-CRTN                        07222199
072222                               TO AMSGLNO                         07222299
072223               MOVE -1  TO ACARTNL                                07222399
072224               PERFORM 8100-SEND-DATA-ONLY                        07222499
072225               PERFORM 8200-RETURN-TRANID                         07222599
072226            END-IF                                                07222699
072227                                                                  07222799
072228            IF SUT00024-CART-SRC-CDE = 'FXR'                      07222899
072229               SET PS-FXR-CTN  TO TRUE                            07222999
072230               MOVE PC-CANNOT-ADJ-FXR-CRTN                        07223099
072231                               TO AMSGLNO                         07223199
072232               MOVE -1  TO ACARTNL                                07223299
072233               PERFORM 8100-SEND-DATA-ONLY                        07223399
072234               PERFORM 8200-RETURN-TRANID                         07223499
072235            END-IF                                                07223599
072236                                                                  07223699
072237            IF SUT00024-CART-SRC-CDE = 'RDM'                      07223799
072238               SET PS-RDM-CTN  TO TRUE                            07223899
072239               MOVE PC-CANNOT-ADJ-RDM-CRTN                        07223999
072240                               TO AMSGLNO                         07224099
072241               MOVE -1  TO ACARTNL                                07224199
072242               PERFORM 8100-SEND-DATA-ONLY                        07224299
072243               PERFORM 8200-RETURN-TRANID                         07224399
072244            END-IF                                                07224499
072245                                                                  07224599
072246            IF SUT00024-CART-SRC-CDE = 'SMO'                      07224699
072247                PERFORM 2255-GET-PO-RCVR                          07224799
072248                MOVE SPACE  TO PS-AUTO-VE-SW                      07224899
072249                PERFORM 2256-CHECK-4-AUTOVE                       07224999
072250                IF PS-AUTO-VE-YES                                 07225099
072260                   PERFORM 2257-CHECK-TRECEIV                     07226099
072270                   IF PS-ALLOW-ADJ-YES                            07227099
072280                       CONTINUE                                   07228099
072290                   ELSE                                           07229099
072300                       MOVE PC-CANNOT-ADJ-SMOOTHED TO AMSGLNO     07230099
072400                       MOVE -1  TO ACARTNL                        07240099
072500                       PERFORM 8100-SEND-DATA-ONLY                07250099
072600                       PERFORM 8200-RETURN-TRANID                 07260099
072700                   END-IF                                         07270099
072800                ELSE                                              07280099
072900                    MOVE PC-CANNOT-ADJ-SMOOTHED TO AMSGLNO        07290099
073000                    MOVE -1  TO ACARTNL                           07300099
073100                    PERFORM 8100-SEND-DATA-ONLY                   07310099
073200                    PERFORM 8200-RETURN-TRANID                    07320099
073201                END-IF                                            07320199
073202            END-IF                                                07320299
073203                                                                  07320399
073204         WHEN SQLCODE = +100                                      07320499
073205              SET PS-INVALID-INPUT       TO TRUE                  07320599
073206              SET PS-CARTON-DOESNT-EXIST TO TRUE                  07320699
073207         WHEN SQLWARN0 NOT = SPACES                               07320799
073208         WHEN SQLCODE NOT EQUAL ZERO                              07320899
073209             MOVE '2251-SELECT-OTBND-CART'                        07320999
073210                             TO DP013-PARAGRAPH                   07321099
073211             MOVE 'PCKRF861 - CHECK VALID CARTON'                 07321199
073212                             TO DP013-MESSAGE-TEXT(1)             07321299
073213             MOVE SUT00024-SHIPT-UNT-ID                           07321399
073214                             TO DP013-MESSAGE-TEXT(2)             07321499
073215             MOVE SQLCA      TO DP013-SQLCA                       07321599
073216             MOVE 'SUT00024' TO DP013-DB2-TABLE-NAME(1)           07321699
073217             SET DP013-DB2-ABEND                                  07321799
073218                             TO TRUE                              07321899
073219             SET DP013-ROLLBACK                                   07321999
073220                             TO TRUE                              07322099
073221             SET DP013-XCTL-DISPLAY-RESTART                       07322199
073222                             TO TRUE                              07322299
073223             PERFORM DP014-0000-PROCESS-ABEND                     07322399
073224     END-EVALUATE.                                                07322499
073225                                                                  07322599
073226 2255-GET-PO-RCVR.                                                07322699
075400     EXEC SQL                                                     07540020
075500         SELECT TRN_NBR                                           07550099
075600               ,RCVR_SEQ_NBR                                      07560099
075700         INTO   :DK-PO-NBR                                        07570099
075800               ,:DK-RCVR-NBR                                      07580099
075900         FROM   SUT_OTBND_UPC                                     07590099
076000         WHERE  SHIPT_UNT_ID   = :DK-SHIPT-UNT-ID                 07600099
076100     END-EXEC.                                                    07610099
076200                                                                  07620020
076300     EVALUATE TRUE                                                07630020
076400         WHEN SQLCODE = ZERO                                      07640020
076600         WHEN SQLCODE = -811                                      07660099
076700             CONTINUE                                             07670034
076701         WHEN SQLCODE = +100                                      07670199
076702             MOVE ZEROES TO DK-PO-NBR                             07670234
076703             MOVE ZEROES TO DK-RCVR-NBR                           07670334
076800         WHEN SQLWARN0 NOT = SPACES                               07680020
076900         WHEN SQLCODE NOT EQUAL ZERO                              07690020
077000             MOVE '2256-GET-PO-RCVR' TO DP013-PARAGRAPH           07700099
077100             MOVE 'PCKRF861 - GET UNITS IN CTN'                   07710099
077200                             TO DP013-MESSAGE-TEXT(1)             07720099
077300             MOVE SUT00024-SHIPT-UNT-ID TO DP013-MESSAGE-TEXT(2)  07730099
077400             MOVE SQLCA      TO DP013-SQLCA                       07740099
077500             MOVE 'SUT00024' TO DP013-DB2-TABLE-NAME(1)           07750099
077600             SET DP013-DB2-ABEND TO TRUE                          07760099
077700             SET DP013-ROLLBACK  TO TRUE                          07770099
077800             SET DP013-XCTL-DISPLAY-RESTART TO TRUE               07780099
078400             PERFORM DP014-0000-PROCESS-ABEND                     07840020
078500     END-EVALUATE.                                                07850020
078600*                                                                 07860008
078700*----------------------------------------------------------------*07870099
078800*    CALL (AUTOVE) AUTOVERIFICATION MODULE (RCKUT127)             07880099
078900*----------------------------------------------------------------*07890099
079000 2256-CHECK-4-AUTOVE.                                             07900099
079100                                                                  07910099
079200     INITIALIZE RC040-FIELDS.                                     07920099
079300     MOVE DK-PO-NBR             TO RC040-PO-NBR.                  07930099
079400     MOVE DK-RCVR-NBR           TO RC040-PO-RCVR.                 07940099
079500     MOVE SUT00024-ORGN-LOC-NBR TO RC040-SIGNON-LOCATION.         07950099
079600     SET RC040-RCVR-EXISTS      TO TRUE.                          07960099
079700     MOVE 'PCKRF861'            TO RC040-CALLING-PROGRAM.         07970099
079800                                                                  07980099
079900     CALL RC040-AUTOVE-CHECK-PGM USING  DFHEIBLK                  07990099
080000                                        RC040-COMMAREA            08000099
080100                                        RC040-FIELDS.             08010099
080200                                                                  08020099
080300     EVALUATE TRUE                                                08030099
080400         WHEN RC040-SUCCESSFUL                                    08040099
080500             MOVE RC040-AUTO-VE-SW     TO PS-AUTO-VE-SW           08050099
080600         WHEN OTHER                                               08060099
080700             SET PS-AUTO-VE-NO         TO TRUE                    08070099
080701     END-EVALUATE.                                                08070199
080702*                                                                 08070220
080703 2257-CHECK-TRECEIV.                                              08070399
080704     EXEC SQL                                                     08070420
080705         SELECT STATUS_CDE                                        08070599
080706               ,ML_POST_TMST                                      08070699
080707           INTO :RECEIV-STATUS-CDE                                08070799
080708               ,:RECEIV-ML-POST-TMST                              08070899
080709         FROM   TRECEIV                                           08070999
080710         WHERE  ORD_NBR       = :DK-PO-NBR                        08071099
080720           AND  REC_SEQ_NBR   = :DK-RCVR-NBR                      08072099
080721     END-EXEC.                                                    08072199
080722                                                                  08072220
080723     EVALUATE TRUE                                                08072320
080724         WHEN SQLCODE = ZERO                                      08072420
080725             IF RECEIV-STATUS-CDE = 'VE' AND                      08072599
080726                RECEIV-ML-POST-TMST NOT = PC-DEFAULT-TMST         08072699
080727                  SET PS-ALLOW-ADJ-YES  TO TRUE                   08072799
080728              ELSE                                                08072899
080729                  SET PS-ALLOW-ADJ-NO   TO TRUE                   08072999
080730              END-IF                                              08073099
080740         WHEN SQLCODE = +100                                      08074099
080741             SET PS-ALLOW-ADJ-NO   TO TRUE                        08074199
080742         WHEN SQLWARN0 NOT = SPACES                               08074220
080743         WHEN SQLCODE NOT EQUAL ZERO                              08074320
080744             MOVE '2256-GET-PO-RCVR' TO DP013-PARAGRAPH           08074499
080745             MOVE 'PCKRF861 - GET UNITS IN CTN'                   08074599
080746                             TO DP013-MESSAGE-TEXT(1)             08074699
080747             MOVE SUT00024-SHIPT-UNT-ID TO DP013-MESSAGE-TEXT(2)  08074799
080748             MOVE SQLCA      TO DP013-SQLCA                       08074899
080749             MOVE 'SUT00024' TO DP013-DB2-TABLE-NAME(1)           08074999
080750             SET DP013-DB2-ABEND TO TRUE                          08075099
080760             SET DP013-ROLLBACK  TO TRUE                          08076099
080761             SET DP013-XCTL-DISPLAY-RESTART TO TRUE               08076199
080762             PERFORM DP014-0000-PROCESS-ABEND                     08076220
080763     END-EVALUATE.                                                08076320
080764*                                                                 08076408
080765*                                                                 08076520
080766 2260-GET-UNITS-IN-CTN.                                           08076652
080767     EXEC SQL                                                     08076720
080768         SELECT SUM(B.SHPD_UNT_QTY)                               08076899
080769         INTO   :PV-UNT-IN-CTN                                    08076950
080770         FROM   SUT_OTBND_CART A                                  08077099
080771               ,SUT_OTBND_UPC B                                   08077199
080772         WHERE  A.SHIPT_UNT_ID   = :DK-SHIPT-UNT-ID               08077242
080773           AND  B.SHIPT_UNT_ID   = A.SHIPT_UNT_ID                 08077320
080774     END-EXEC.                                                    08077420
080775                                                                  08077520
080776     EVALUATE TRUE                                                08077620
080777         WHEN SQLCODE = ZERO                                      08077720
080778         WHEN SQLCODE = +100                                      08077899
080779         WHEN SQLCODE = -305                                      08077999
080780             CONTINUE                                             08078034
080781         WHEN SQLWARN0 NOT = SPACES                               08078120
080782         WHEN SQLCODE NOT EQUAL ZERO                              08078220
080783             MOVE '2260-GET-UNITS-IN-CTN'                         08078352
080784                             TO DP013-PARAGRAPH                   08078420
080785             MOVE 'PCKRF861 - GET UNITS IN CTN'                   08078586
080786                             TO DP013-MESSAGE-TEXT(1)             08078620
080787             MOVE SUT00024-SHIPT-UNT-ID                           08078799
080788                             TO DP013-MESSAGE-TEXT(2)             08078820
080789             MOVE SQLCA      TO DP013-SQLCA                       08078920
080790             MOVE 'SUT00024' TO DP013-DB2-TABLE-NAME(1)           08079099
080791             SET DP013-DB2-ABEND                                  08079120
080792                             TO TRUE                              08079220
080793             SET DP013-ROLLBACK                                   08079320
080794                             TO TRUE                              08079420
080795             SET DP013-XCTL-DISPLAY-RESTART                       08079520
080796                             TO TRUE                              08079620
080797             PERFORM DP014-0000-PROCESS-ABEND                     08079720
080798     END-EVALUATE.                                                08079820
080799*                                                                 08079908
080800*                                                                 08080099
080801*                                                                 08080199
080802 2280-CHECK-PO-AUD-REQ.                                           08080299
080803     EXEC SQL                                                     08080399
080804         SELECT AUD_STAT_CDE                                      08080499
080805         INTO   :SUT00015-AUD-STAT-CDE                            08080599
080806         FROM   SUT_PO_AUD_REQ                                    08080699
080807         WHERE  AUD_CNTL_NBR   = :SUATRN-AUD-CNTL-NBR             08080799
080808     END-EXEC.                                                    08080899
080809                                                                  08080999
080810     EVALUATE TRUE                                                08081099
080811         WHEN SQLCODE = ZERO                                      08081199
080812              IF SUT00015-AUD-STAT-CDE = 'I'                      08081299
080813                 SET PS-CARTON-AUDIT-PENDING TO TRUE              08081399
080814              ELSE                                                08081499
080815                 SET PS-NO-CARTON-AUDIT-PENDING TO TRUE           08081599
080816              END-IF                                              08081699
080817         WHEN SQLCODE = +100                                      08081799
080818               CONTINUE                                           08081899
080819         WHEN SQLWARN0 NOT = SPACES                               08081999
080820         WHEN SQLCODE NOT EQUAL ZERO                              08082099
080821             MOVE '2280-CHECK-PO-AUD-REQ'                         08082199
080822                             TO DP013-PARAGRAPH                   08082299
080823             MOVE 'PCKRF861 - GET UNITS IN CTN'                   08082399
080824                             TO DP013-MESSAGE-TEXT(1)             08082499
080825             MOVE SUT00024-SHIPT-UNT-ID                           08082599
080826                             TO DP013-MESSAGE-TEXT(2)             08082699
080827             MOVE SQLCA      TO DP013-SQLCA                       08082799
080828             MOVE 'SUT_PO_AUD_REQ'  TO DP013-DB2-TABLE-NAME(1)    08082899
080829             SET DP013-DB2-ABEND                                  08082999
080830                             TO TRUE                              08083099
080831             SET DP013-ROLLBACK                                   08083199
080832                             TO TRUE                              08083299
080833             SET DP013-XCTL-DISPLAY-RESTART                       08083399
080834                             TO TRUE                              08083499
080835             PERFORM DP014-0000-PROCESS-ABEND                     08083599
080836     END-EVALUATE.                                                08083699
080837*                                                                 08083799
080838*-----------------------------------------------------------------08083899
080839* DETERMINE LAST ACTIVITY FOR CARTON                              08083999
080840*-----------------------------------------------------------------08084099
080841 3000-CHECK-CARTON-STATUS.                                        08084199
080842                                                                  08084299
080843     INITIALIZE  PC046-COMMAREA-REC.                              08084399
080844     SET   PC046-FROM-CRTN-STAT  TO  TRUE.                        08084499
080845     MOVE  DK-SHIPT-UNT-ID       TO  PC046-CARTON-ID.             08084599
080846                                                                  08084699
080847                                                                  08084799
080848     CALL PC046-CARTON-STATUS-MODULE                              08084899
080849             USING DFHEIBLK                                       08084999
080850             PC046-COMMAREA                                       08085099
080860             PC046-COMMAREA-REC                                   08086099
080870     END-CALL                                                     08087099
080871                                                                  08087199
080872     PERFORM 3100-VALIDATE-STATUS-CALL.                           08087299
080873                                                                  08087399
080874*----------------------------------------------------------------*08087499
080875* CHECK RETURN CODE FROM CRTN STATUS PROGRAM TO SEE IF SUCCESSFUL*08087599
080876* CHECK CARTON STATUS.                                            08087699
080877*----------------------------------------------------------------*08087799
080878 3100-VALIDATE-STATUS-CALL.                                       08087899
080879                                                                  08087999
080880     IF  PC046-SUCCESSFUL                                         08088099
080881         IF ((PC046-SCANNED-ONTO-TRLR OR                          08088199
080882              PC046-LOADED-ONTO-TRLR)                             08088299
080883                     AND                                          08088399
080884          (PC046-TRIP-STATUS NOT = 'DO' AND 'AO' AND '  '))       08088499
080885             SET  PS-INVALID-INPUT  TO  TRUE                      08088599
080886     ELSE                                                         08088699
080887             SET  PS-VALID-INPUT  TO  TRUE                        08088799
080888     END-IF.                                                      08088899
080889                                                                  08088999
080890*                                                                 08089009
080891 4000-XCTL-TO-SELECTED-PROGRAM.                                   08089137
080892     SET PC033-INITIALIZE-SCREEN     TO TRUE.                     08089208
080893     MOVE PC-CURRENT-PROGRAM-NAME TO PC033-LAST-PROGRAM.          08089308
080894                                                                  08089408
080895     MOVE LENGTH OF CA-COMMAREA TO PV-COMMAREA-LENGTH             08089573
080896     EXEC CICS                                                    08089608
080897         XCTL  PROGRAM   (PV-TRANSFER-PROGRAM)                    08089708
080898               COMMAREA  (CA-COMMAREA)                            08089873
080899               LENGTH    (PV-COMMAREA-LENGTH)                     08089908
080900               RESP      (PV-CICS-RESPONSE)                       08090008
080901     END-EXEC.                                                    08090108
080902                                                                  08090208
080903     EVALUATE TRUE                                                08090308
080904         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 08090408
080905             CONTINUE                                             08090508
080906         WHEN OTHER                                               08090608
080907             MOVE '4000-XCTL-TO-SELECTED-PROGRAM'                 08090737
080908                 TO DP013-PARAGRAPH                               08090808
080909             MOVE 'UNABLE TO XCTL TO PROGRAM: '                   08090908
080910                 TO DP013-MESSAGE-TEXT (1)                        08091008
080911             MOVE PV-TRANSFER-PROGRAM                             08091108
080912                 TO DP013-MESSAGE-TEXT (2)                        08091208
081000             SET DP013-CICS-ABEND  TO TRUE                        08100008
081100             SET DP013-NO-ROLLBACK TO TRUE                        08110008
081200             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               08120008
081300             MOVE PC-TRANS-UNAVAILABLE-MSG TO AMSGLNO             08130008
081400             SET PC033-PROCESS-SCREEN TO TRUE                     08140008
081500             PERFORM 8000-SEND-MAP                                08150008
081600             PERFORM 8200-RETURN-TRANID                           08160008
081700     END-EVALUATE.                                                08170008
081800*                                                                 08180008
084500                                                                  08450099
084600 7500-COUNT-SKUS-IN-CTN.                                          08460099
084700     EXEC SQL                                                     08470099
084701         SELECT COUNT(DISTINCT                                    08470199
084702                XSKU.SKU_NBR)                                     08470201
084703         INTO :PV-SKU-IN-CTN                                      08470399
084704         FROM    SUT_OTBND_UPC A                                  08470401
084705               , XLV_UPC       XUPC                               08470501
084706               , XLV_SKU       XSKU                               08470601
084707         WHERE  A.SHIPT_UNT_ID   = :SUT00024-SHIPT-UNT-ID         08470700
084708           AND  A.UPC_NBR        = XUPC.UPC_NBR                   08470801
084709           AND  XUPC.INTR_UPC_ID = XSKU.INTR_UPC_ID               08470901
084710           AND  A.SHPD_UNT_QTY   > 0                              08471099
085200     END-EXEC                                                     08520099
085210                                                                  08521099
085300     EVALUATE TRUE                                                08530099
085400         WHEN SQLCODE = ZERO                                      08540099
085800         WHEN SQLCODE = +100                                      08580099
085801         WHEN SQLCODE = -904                                      08580199
085802         WHEN SQLCODE = -913                                      08580299
085803         WHEN SQLCODE = -911                                      08580399
085900             CONTINUE                                             08590099
086000         WHEN SQLWARN0 NOT = SPACES                               08600099
086100         WHEN SQLCODE < ZERO                                      08610099
086200         WHEN SQLCODE > ZERO                                      08620099
086300             MOVE '7500-COUNT-SKUS-IN-CTN'                        08630099
086400                               TO DP013-PARAGRAPH                 08640099
086500             MOVE 'SELECT DISTINCT'                               08650099
086600                               TO DP013-MESSAGE-TEXT (1)          08660099
086700             MOVE SQLCA        TO DP013-SQLCA                     08670099
086800             MOVE 'SUT_OTBND_UPC'  TO DP013-DB2-TABLE-NAME (1)    08680099
086801             MOVE 'XLV_UPC '   TO DP013-DB2-TABLE-NAME (2)        08680199
086802             MOVE 'XLV_SKU '   TO DP013-DB2-TABLE-NAME (3)        08680299
086900             SET DP013-DB2-ABEND                                  08690099
087000                 DP013-XCTL-DISPLAY-RESTART TO TRUE               08700099
087100             PERFORM DP014-0000-PROCESS-ABEND                     08710099
087200     END-EVALUATE.                                                08720099
089710                                                                  08971099
089730 7600-OPEN-AUDIT-CSR.                                             08973099
089740         EXEC SQL                                                 08974099
089750              OPEN AUDIT-CSR                                      08975099
089760         END-EXEC                                                 08976099
089770         EVALUATE TRUE                                            08977099
089780             WHEN SQLCODE = ZERO                                  08978099
089790             WHEN SQLCODE = -904                                  08979099
089791             WHEN SQLCODE = -913                                  08979199
089792                 CONTINUE                                         08979299
089793             WHEN SQLWARN0 NOT = SPACES                           08979399
089794             WHEN SQLCODE < ZERO                                  08979499
089795             WHEN SQLCODE > ZERO                                  08979599
089796                 MOVE '7600-OPEN-AUDIT-CSR'                       08979699
089797                                   TO DP013-PARAGRAPH             08979799
089798                 MOVE 'OPEN CURSOR - '                            08979899
089799                                   TO DP013-MESSAGE-TEXT (1)      08979999
089800                 MOVE SQLCA        TO DP013-SQLCA                 08980099
089801                 MOVE 'TSUATRN '   TO DP013-DB2-TABLE-NAME (1)    08980199
089802                 SET DP013-DB2-ABEND                              08980299
089803                     DP013-XCTL-DISPLAY-RESTART TO TRUE           08980399
089804                 PERFORM DP014-0000-PROCESS-ABEND                 08980499
089805         END-EVALUATE.                                            08980599
089806*                                                                 08980699
089807*                                                                 08980799
089808*FETCH AUDIT CURSOR.                                              08980899
089809 7610-FETCH-AUDIT-CSR.                                            08980999
089810     EXEC SQL                                                     08981099
089811          FETCH AUDIT-CSR                                         08981199
089812            INTO :SUATRN-AUD-CNTL-NBR                             08981299
089815     END-EXEC                                                     08981599
089816     EVALUATE TRUE                                                08981699
089817         WHEN SQLCODE = ZERO                                      08981799
089819            SET PS-CARTON-AUDIT-PENDING TO TRUE                   08981999
089821            PERFORM 2280-CHECK-PO-AUD-REQ                         08982199
089826         WHEN SQLCODE = +100                                      08982699
089827             SET PS-NO-CARTON-AUDIT-PENDING                       08982799
089828                 PS-END-OF-CURSOR-AUD TO TRUE                     08982899
089829         WHEN SQLWARN0 NOT = SPACES                               08982999
089830         WHEN SQLCODE < ZERO                                      08983099
089831         WHEN SQLCODE > ZERO                                      08983199
089832             MOVE '7610-FETCH-AUDIT-CSR'                          08983299
089833                               TO DP013-PARAGRAPH                 08983399
089834             MOVE 'FETCH CURSOR - '                               08983499
089835                               TO DP013-MESSAGE-TEXT (1)          08983599
089836             MOVE SQLCA        TO DP013-SQLCA                     08983699
089837             MOVE 'TSUATRN '   TO DP013-DB2-TABLE-NAME (1)        08983799
089838             SET DP013-DB2-ABEND                                  08983899
089839                 DP013-XCTL-DISPLAY-RESTART TO TRUE               08983999
089840             PERFORM DP014-0000-PROCESS-ABEND                     08984099
089841     END-EVALUATE.                                                08984199
089842*                                                                 08984299
089843*                                                                 08984399
089844* CLOSE SKU CURSOR                                                08984499
089845 7620-CLOSE-AUDIT-CSR.                                            08984599
089846     EXEC SQL                                                     08984699
089847          CLOSE AUDIT-CSR                                         08984799
089848     END-EXEC                                                     08984899
089849     EVALUATE TRUE                                                08984999
089850         WHEN SQLCODE = ZERO                                      08985099
089851             CONTINUE                                             08985199
089852         WHEN SQLWARN0 NOT = SPACES                               08985299
089853         WHEN SQLCODE < ZERO                                      08985399
089854         WHEN SQLCODE > ZERO                                      08985499
089855             MOVE '7520-CLOSE-AUDIT-CSR'                          08985599
089856                               TO DP013-PARAGRAPH                 08985699
089857             MOVE 'CLOSE CURSOR '                                 08985799
089858                               TO DP013-MESSAGE-TEXT (1)          08985899
089859             MOVE SQLCA        TO DP013-SQLCA                     08985999
089860             MOVE 'TSUATRN '   TO DP013-DB2-TABLE-NAME (1)        08986099
089861             SET DP013-DB2-ABEND                                  08986199
089862                 DP013-XCTL-DISPLAY-RESTART TO TRUE               08986299
089863             PERFORM DP014-0000-PROCESS-ABEND                     08986399
089864     END-EVALUATE.                                                08986499
089865*                                                                 08986599
089866*                                                                 08986699
089870 8000-SEND-MAP.                                                   08987099
089900     EXEC CICS                                                    08990099
090000         SEND MAP       ('PC861A')                                09000099
090100              MAPSET    ('PCKM861')                               09010099
090200              ERASE                                               09020099
090300              CURSOR                                              09030099
090400              RESP      (PV-CICS-RESPONSE)                        09040099
090500     END-EXEC.                                                    09050099
090600                                                                  09060099
090700     EVALUATE TRUE                                                09070099
090800         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 09080099
090900             CONTINUE                                             09090099
091000         WHEN OTHER                                               09100099
091100             MOVE '8000-SEND-MAP'      TO DP013-PARAGRAPH         09110099
091200             MOVE 'UNABLE TO SEND MAP' TO DP013-MESSAGE-TEXT (1)  09120099
091300             SET DP013-CICS-ABEND      TO TRUE                    09130099
091400             SET DP013-NO-ROLLBACK     TO TRUE                    09140099
091500             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               09150099
091600     END-EVALUATE.                                                09160099
091700*                                                                 09170099
091800*                                                                 09180099
091900 8100-SEND-DATA-ONLY.                                             09190099
092000     EXEC CICS                                                    09200099
092100         SEND MAP       ('PC861A')                                09210099
092200              MAPSET    ('PCKM861')                               09220099
092300              CURSOR                                              09230099
092400              DATAONLY                                            09240099
092500              RESP      (PV-CICS-RESPONSE)                        09250099
092600     END-EXEC.                                                    09260099
092700                                                                  09270099
092800     EVALUATE TRUE                                                09280099
092900         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 09290099
093000             CONTINUE                                             09300099
093100         WHEN OTHER                                               09310099
093200             MOVE '8100-SEND-DATA-ONLY' TO DP013-PARAGRAPH        09320099
093300             MOVE 'UNABLE TO SEND DATA' TO DP013-MESSAGE-TEXT (1) 09330099
093400             SET DP013-CICS-ABEND       TO TRUE                   09340099
093500             SET DP013-NO-ROLLBACK      TO TRUE                   09350099
093600             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               09360099
093700     END-EVALUATE.                                                09370099
093800*                                                                 09380099
093900*                                                                 09390099
094000 8200-RETURN-TRANID.                                              09400099
094100     MOVE LENGTH OF CA-COMMAREA TO PV-COMMAREA-LENGTH             09410099
094200     EXEC CICS                                                    09420099
094300         RETURN TRANSID  (PC-TRANID)                              09430099
094400                COMMAREA (CA-COMMAREA)                            09440099
094500                LENGTH   (PV-COMMAREA-LENGTH)                     09450099
094600                RESP     (PV-CICS-RESPONSE)                       09460099
094700     END-EXEC.                                                    09470099
094800                                                                  09480099
094900     EVALUATE TRUE                                                09490099
095000         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 09500099
095100             CONTINUE                                             09510099
095200         WHEN OTHER                                               09520099
095300             MOVE '8200-RETURN-TRANID'  TO DP013-PARAGRAPH        09530099
095400             MOVE 'UNABLE TO RETURN TO TRANID'                    09540099
095500                 TO DP013-MESSAGE-TEXT (1)                        09550099
095600             SET DP013-CICS-ABEND       TO TRUE                   09560099
095700             SET DP013-NO-ROLLBACK      TO TRUE                   09570099
095800             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               09580099
095900     END-EVALUATE.                                                09590099
096000*                                                                 09600099
096100*                                                                 09610099
096200 8300-RETURN.                                                     09620099
096300     EXEC CICS                                                    09630099
096400         SEND FROM (PV-MESSAGE-AREA)                              09640099
096500              LENGTH (19)                                         09650099
096600              ERASE                                               09660099
096700     END-EXEC.                                                    09670099
096800                                                                  09680099
096900     EXEC CICS                                                    09690099
097000         RETURN                                                   09700099
097100     END-EXEC.                                                    09710099
097200*                                                                 09720099
097300*                                                                 09730099
097400 8400-XCTL-TO-HELP.                                               09740099
097500     MOVE LENGTH OF PC192-COMMAREA    TO PV-COMMAREA-LENGTH       09750099
097600                                                                  09760099
097700     EXEC CICS                                                    09770099
097800         XCTL                                                     09780099
097900             PROGRAM   (PV-TRANSFER-PROGRAM)                      09790099
098000             COMMAREA  (PC192-COMMAREA)                           09800099
098100             LENGTH    (PV-COMMAREA-LENGTH)                       09810099
098200             RESP      (PV-CICS-RESPONSE)                         09820099
098300     END-EXEC.                                                    09830099
098400                                                                  09840099
098500     EVALUATE TRUE                                                09850099
098600         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 09860099
098700              CONTINUE                                            09870099
098800         WHEN OTHER                                               09880099
098900             MOVE '8400-XCTL-TO-HELP' TO DP013-PARAGRAPH          09890099
099000             MOVE 'PCKRF861 - UNABLE TO XCTL TO PROGRAM: '        09900099
099100                                      TO DP013-MESSAGE-TEXT (1)   09910099
099200             MOVE PV-TRANSFER-PROGRAM TO DP013-MESSAGE-TEXT (2)   09920099
099300             SET DP013-CICS-ABEND                                 09930099
099400                 DP013-ROLLBACK       TO TRUE                     09940099
099500             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               09950099
099600             MOVE PC-TRANS-UNAVAILABLE-MSG                        09960099
099700                                      TO AMSGLNO                  09970099
099800             SET PC033-PROCESS-SCREEN TO TRUE                     09980099
099900             MOVE -1                  TO ACARTNL                  09990099
100000             PERFORM 8000-SEND-MAP                                10000099
100100             PERFORM 8200-RETURN-TRANID                           10010099
100200     END-EVALUATE.                                                10020099
100300*                                                                 10030099
100400*                                                                 10040099
100500 9999-WRITE-MESSAGE-TO-CICS-LOG.                                  10050099
100600     MOVE PC-CURRENT-PROGRAM-NAME  TO DP013-PROGRAM.              10060099
100700     MOVE DFHEIBLK                 TO DP013-DFHEIBLK.             10070099
100800     INITIALIZE DP013-SRC-TASK-NUMBER                             10080099
100900                DP013-STACK.                                      10090099
101000     SET DP013-LINK-RETURN TO TRUE.                               10100099
101100                                                                  10110099
101200     EXEC CICS                                                    10120099
101300         LINK                                                     10130099
101400             PROGRAM   (DP013-NAME)                               10140099
101500             COMMAREA  (DP013-PARAMETERS)                         10150099
101600             LENGTH    (DP013-LENGTH)                             10160099
101700     END-EXEC.                                                    10170099
101800                                                                  10180099
101900* ABEND PROCESSOR MODULE                                          10190099
102000     COPY DPPD014.                                                10200099
