000100 IDENTIFICATION DIVISION.                                         00010008
000200                                                                  00020009
000300 PROGRAM-ID.             TRKRP008.                                00030009
000400 AUTHOR.                 JEAN KURKOWSKI.                          00040009
000500 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00050009
000600 DATE-WRITTEN            03/12/08.                                00060009
000700 DATE-COMPILED.                                                   00070009
000800                                                                  00080009
000900*************************************************************     00090009
001000*  THIS PROGRAM CREATES A TRAILER UNLOADED STATUS REPORT.  *      00100009
001100*************************************************************     00110009
001200                                                                  00120009
001300 ENVIRONMENT DIVISION.                                            00130009
001400 INPUT-OUTPUT SECTION.                                            00140009
001500                                                                  00150009
001600 FILE-CONTROL.                                                    00160009
001700                                                                  00170009
001800     SELECT TRAILER-STATUS-REPORT    ASSIGN TO RPT01.             00180009
001900                                                                  00190009
002000                                                                  00200009
002100 DATA DIVISION.                                                   00210009
002200                                                                  00220009
002300 FILE SECTION.                                                    00230009
002400 FD  TRAILER-STATUS-REPORT                                        00240009
002500     RECORDING MODE IS F                                          00250009
002600     LABEL RECORDS ARE STANDARD                                   00260009
002700     BLOCK CONTAINS 0 RECORDS.                                    00270009
002800                                                                  00280009
002900 01  TRAILER-STATUS-RECORD          PIC X(132).                   00290009
003000                                                                  00300009
003100 WORKING-STORAGE SECTION.                                         00310009
003200 01  PS-SWITCHES.                                                 00320009
003300     05  PS-EOD-SW                   PIC  X(03)    VALUE 'N'.     00330009
003400         88  PS-EOD                                VALUE 'Y'.     00340009
003500         88  PS-NOT-EOD                            VALUE 'N'.     00350009
003600     05  PS-FIRST-PAGE-SW            PIC  X(03)    VALUE 'Y'.     00360009
003700         88  PS-FIRST-PAGE                         VALUE 'Y'.     00370009
003800         88  PS-NOT-FIRST-PAGE                     VALUE 'N'.     00380009
003900     05  PS-DUP-FOUND-SW             PIC  X(03)    VALUE 'N'.     00390009
004000         88  PS-DUP-FOUND                          VALUE 'Y'.     00400009
004100         88  PS-NO-DUP-FOUND                       VALUE 'N'.     00410009
004200     05  PS-SHOULD-BE-REPORTED-SW    PIC  X(03)    VALUE 'N'.     00420009
004300         88  PS-SHOULD-BE-REPORTED                 VALUE 'Y'.     00430009
004400         88  PS-SHOULD-NOT-BE-REPORTED             VALUE 'N'.     00440009
004500                                                                  00450009
004600 01  CD-CPU-DATE.                                                 00460009
004700     03  CD-YEAR                     PIC  9(02)    VALUE ZERO.    00470009
004800     03  CD-MONTH                    PIC  9(02)    VALUE ZERO.    00480009
004900     03  CD-DAY                      PIC  9(02)    VALUE ZERO.    00490009
005000                                                                  00500009
005100 01  CD-CPU-DATE-MDY.                                             00510009
005200     03  CD-MM                       PIC  9(02)    VALUE ZERO.    00520009
005300     03  CD-DD                       PIC  9(02)    VALUE ZERO.    00530009
005400     03  CD-YY                       PIC  9(02)    VALUE ZERO.    00540009
005500                                                                  00550009
005600 01  DT-DATE.                                                     00560009
005700     03  DT-CC                       PIC  9(02)    VALUE ZERO.    00570009
005800     03  DT-YEAR                     PIC  9(02)    VALUE ZERO.    00580009
005900     03  FILLER                      PIC  X(01)    VALUE SPACE.   00590009
006000     03  DT-MONTH                    PIC  9(02)    VALUE ZERO.    00600009
006100     03  FILLER                      PIC  X(01)    VALUE SPACE.   00610009
006200     03  DT-DAY                      PIC  9(02)    VALUE ZERO.    00620009
006300                                                                  00630009
006400 01  VD-VARIFIED-DATE.                                            00640009
006500     03  VD-MONTH                    PIC  9(02)    VALUE ZERO.    00650009
006600     03  VD-DAY                      PIC  9(02)    VALUE ZERO.    00660009
006700     03  VD-YEAR                     PIC  9(02)    VALUE ZERO.    00670009
006800                                                                  00680009
006900 01  TM-TIME.                                                     00690009
007000     03  DT-HOURS                    PIC  9(02)    VALUE ZERO.    00700009
007100     03  FILLER                      PIC  X(01)    VALUE SPACE.   00710009
007200     03  DT-MINUTES                  PIC  9(02)    VALUE ZERO.    00720009
007300     03  FILLER                      PIC  X(01)    VALUE SPACE.   00730009
007400     03  DT-SECONDS                  PIC  9(02)    VALUE ZERO.    00740009
007500                                                                  00750009
007600 01  VT-VARIFIED-TIME.                                            00760009
007700     03  VT-HOURS                    PIC  9(02)    VALUE ZERO.    00770009
007800     03  VT-MINUTES                  PIC  9(02)    VALUE ZERO.    00780009
007900                                                                  00790009
008000 01  CT-CPU-TIME.                                                 00800009
008100     03  CT-HOUR                     PIC  9(02)    VALUE ZERO.    00810009
008200     03  CT-MINUTE                   PIC  9(02)    VALUE ZERO.    00820009
008300     03  FILLER                      PIC  9(04)    VALUE ZERO.    00830009
008400                                                                  00840009
008500 01  CT-CPU-TIME-4.                                               00850009
008600     03  CT-HH                       PIC  9(02)    VALUE ZERO.    00860009
008700     03  CT-MM                       PIC  9(02)    VALUE ZERO.    00870009
008800                                                                  00880009
008900 01  PC-PROGRAM-CONSTANTS.                                        00890009
009000     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)    VALUE          00900009
009100                                          'TRKRP008'.             00910009
009200                                                                  00920009
009300     05  PC-SLASH                    PIC  X(01)    VALUE '/'.     00930009
009400     05  PC-LINE-LIMIT               PIC S9(04)    VALUE +60      00940009
009500                                                   COMP SYNC.     00950009
009600     05  PC-1                        PIC  9(02)    VALUE 1.       00960009
009700     05  PC-DEFAULT-DTE              PIC  X(10)    VALUE          00970009
009800                                      '01/01/0001'.               00980009
009900     05  PC-DEFAULT-TME              PIC  X(05)    VALUE          00990009
010000                                      '00.00'.                    01000009
010100 01  PV-PROGRAM-VARIABLES.                                        01010009
010200     05  PV-ABEND-CODE               PIC S9(04)    VALUE ZERO     01020009
010300                                                   COMP SYNC.     01030009
010400     05  PV-ABEND-PARAGRAPH          PIC  X(30)    VALUE SPACES.  01040009
010500     05  PV-LINE-COUNT               PIC S9(04)    VALUE +80      01050009
010600                                                   COMP SYNC.     01060009
010700     05  PV-PAGE-COUNT               PIC S9(04)    VALUE ZERO     01070009
010800                                                   COMP SYNC.     01080009
010900     05  PV-TRAILER-COUNT            PIC S9(04)    VALUE 0        01090009
011000                                                   COMP SYNC.     01100009
011010     05 PV-VE-COUNT                  PIC S9(04)    VALUE 0        01101010
011020                                                   COMP SYNC.     01102010
011030     05 PV-NON-VE-COUNT              PIC S9(04)    VALUE 0        01103010
011040                                                   COMP SYNC.     01104010
011050     05 PV-0-RCVR-COUNT              PIC S9(04)    VALUE 0        01105010
011060                                                   COMP SYNC.     01106010
011100     05  PV-SAVE-LOC                 PIC  9(03)    VALUE 999.     01110009
011200     05  PV-ARRIVAL-DTE              PIC  X(10)   VALUE SPACE.    01120009
011210     05  PV-ENROUTE-UID              PIC  X(08)   VALUE SPACE.    01121015
011300 01  TC-TRAILER-CURSOR-RTN-AREA.                                  01130009
011400     05 TC-TRIP-ID                   PIC S9(09)   VALUE ZERO      01140009
011500                                                  COMP.           01150009
011600     05 TC-OWNER-SCAC                PIC  X(04)   VALUE SPACE.    01160009
011700     05 TC-VEH-NBR                   PIC  X(10)   VALUE SPACE.    01170009
011800     05 TC-TRIP-STAT-CDE             PIC  X(02)   VALUE SPACE.    01180009
011900     05 TC-UNLOAD-DTE                PIC  X(10)   VALUE SPACE.    01190009
012000     05 TC-UNLOAD-TIME               PIC  X(08)   VALUE SPACE.    01200009
012010     05 TC-UNLOAD-USERID             PIC  X(08)   VALUE SPACE.    01201010
012100     05 TC-OPER-UNT-ID               PIC S9(04)   VALUE ZERO      01210009
012200                                                  COMP.           01220009
012300     05 TC-FCLTY-ID                  PIC S9(04)   VALUE ZERO      01230009
012400                                                  COMP.           01240009
012500     05 TC-FCLTY-AREA-ID             PIC  X(06)   VALUE SPACE.    01250009
012600                                                                  01260009
012700     COPY DPWS500.                                                01270009
012800                                                                  01280009
012900     COPY DPWS132O.                                               01290009
013000                                                                  01300009
013100 01  HL1-HEADING-LINE-1.                                          01310009
013200     05  FILLER                      PIC  X(35)    VALUE SPACES.  01320009
013300     05  FILLER                      PIC  X(62)    VALUE          01330009
013400     'TRAILER STATUS REPORT - UNLOADED STATUS FOR AT LEAST 72 HOUR01340009
013500-        'S'.                                                     01350009
013600     05  FILLER                      PIC  X(35)    VALUE SPACES.  01360009
013700                                                                  01370009
013800 01  HL2-HEADING-LINE-2.                                          01380009
013900     05  FILLER                      PIC  X(01)    VALUE SPACES.  01390009
014000     05  FILLER                      PIC  X(13)    VALUE          01400009
014100                                              'OPER UNIT ID:'.    01410009
014200     05  FILLER                      PIC  X(03)    VALUE SPACES.  01420009
014300     05  HL2-OPER-UNIT-ID            PIC  9(04)    VALUE ZEROS.   01430009
014400     05  FILLER                      PIC  X(01)    VALUE SPACES.  01440009
014500     05  HL2-OPER-UNIT-DESC          PIC  X(25)    VALUE SPACES.  01450009
014600     05  FILLER                      PIC  X(85)    VALUE SPACES.  01460013
014700                                                                  01470009
014800 01  HL3-HEADING-LINE-3.                                          01480009
014900     05  FILLER                      PIC  X(22)    VALUE SPACES.  01490014
015000     05  FILLER                      PIC  X(04)    VALUE          01500014
015100                                                  'TRIP'.         01510014
015200     05  FILLER                      PIC  X(04)    VALUE SPACES.  01520014
015300     05  FILLER                      PIC  X(08)    VALUE          01530014
015400                                                  'ENROUTE'.      01540014
015500     05  FILLER                      PIC  X(02)    VALUE SPACES.  01550017
015600     05  FILLER                      PIC  X(25)    VALUE          01560014
015700                              '-------- ARRIVAL --------'.        01570014
015800     05  FILLER                      PIC  X(02)    VALUE SPACES.  01580014
015900     05  FILLER                      PIC  X(25)    VALUE          01590014
016000                              '------- UNLOADED --------'.        01600014
016100     05  FILLER                      PIC  X(07)    VALUE SPACES.  01610017
016200     05  FILLER                      PIC  X(04)    VALUE          01620014
016300                                                  '# VE'.         01630014
016400     05  FILLER                      PIC  X(07)    VALUE SPACES.  01640014
016410     05  FILLER                      PIC  X(08)    VALUE          01641014
016420                                                  '# NON-VE'.     01642014
016430     05  FILLER                      PIC  X(05)    VALUE SPACES.  01643014
016440     05  FILLER                      PIC  X(08)    VALUE          01644014
016450                                                  'SHPMT PO'.     01645014
016460     05  FILLER                      PIC  X(01)    VALUE SPACES.  01646014
016500                                                                  01650009
016600 01  HL4-HEADING-LINE-4.                                          01660009
016700     05  FILLER                      PIC  X(04)    VALUE 'SCAC'.  01670014
016800     05  FILLER                      PIC  X(02)    VALUE SPACES.  01680014
016900     05  FILLER                      PIC  X(07)    VALUE          01690014
017000                                                  'TRAILER'.      01700014
017100     05  FILLER                      PIC  X(10)    VALUE SPACES.  01710014
017200     05  FILLER                      PIC  X(02)    VALUE          01720014
017300                                                  'ID'.           01730014
017400     05  FILLER                      PIC  X(05)    VALUE SPACES.  01740014
017500     05  FILLER                      PIC  X(06)    VALUE          01750014
017600                                                  'USERID'.       01760014
017700     05  FILLER                      PIC  X(07)    VALUE SPACE.   01770014
017800     05  FILLER                      PIC  X(21)    VALUE          01780014
017900                              'DATE    TIME  USERID '.            01790014
018000     05  FILLER                      PIC  X(06)    VALUE SPACES.  01800014
018100     05  FILLER                      PIC  X(21)    VALUE          01810014
018110                              'DATE    TIME  USERID '.            01811014
018120     05  FILLER                      PIC  X(06)    VALUE SPACES.  01812014
018130     05  FILLER                      PIC  X(09)    VALUE          01813014
018140                                                  'RECEIVERS'.    01814014
018150     05  FILLER                      PIC  X(04)    VALUE SPACES.  01815014
018160     05  FILLER                      PIC  X(09)    VALUE          01816014
018170                                                  'RECEIVERS'.    01817014
018180     05  FILLER                      PIC  X(04)    VALUE SPACES.  01818014
018190     05  FILLER                      PIC  X(08)    VALUE          01819014
018191                                                  'NO RCVR#'.     01819114
018192     05  FILLER                      PIC  X(01)    VALUE SPACES.  01819214
018200                                                                  01820009
018300 01  DL1-DETAIL-LINE-1.                                           01830009
018400     05  DL1-DELVRY-SCAC             PIC  X(04)    VALUE SPACES.  01840014
018500     05  FILLER                      PIC  X(02)    VALUE SPACES.  01850014
018600     05  DL1-TRAILER                 PIC  X(10)    VALUE ZERO.    01860014
018700     05  FILLER                      PIC  X(02)    VALUE SPACES.  01870014
018800     05  DL1-TRIP-ID                 PIC  Z(10)    VALUE ZERO.    01880014
018900     05  FILLER                      PIC  X(02)    VALUE SPACES.  01890014
019000     05  DL1-ENROUTE-USERID          PIC  X(08)    VALUE SPACES.  01900014
019100     05  FILLER                      PIC  X(02)    VALUE SPACES.  01910014
019200     05  DL1-ARRIVAL-DTE             PIC  X(16)    VALUE ZERO.    01920014
019300     05  FILLER                      PIC  X(01)    VALUE SPACES.  01930014
019400     05  DL1-ARRIVAL-USERID          PIC  X(08)    VALUE SPACES.  01940014
019410     05  FILLER                      PIC  X(02)    VALUE SPACES.  01941014
019420     05  DL1-UNLOAD-DTE              PIC  X(16)    VALUE ZERO.    01942014
019430     05  FILLER                      PIC  X(01)    VALUE SPACES.  01943014
019440     05  DL1-UNLOAD-USERID           PIC  X(08)    VALUE ZEROES.  01944014
019450     05  FILLER                      PIC  X(02)    VALUE SPACES.  01945014
019460     05  DL1-VE-CNT                  PIC  ZZZ,ZZZ,ZZ9             01946014
019470                                                   VALUE ZEROES.  01947014
019480     05  FILLER                      PIC  X(02)    VALUE SPACES.  01948014
019490     05  DL1-NON-VE-CNT              PIC  ZZZ,ZZZ,ZZ9             01949014
019491                                                   VALUE ZEROES.  01949114
019492     05  FILLER                      PIC  X(02)    VALUE SPACES.  01949214
019493     05  DL1-0-RCVR-CNT              PIC  ZZZ,ZZZ,ZZ9             01949314
019494                                                   VALUE ZEROES.  01949414
019495     05  FILLER                      PIC  X(01)    VALUE SPACES.  01949514
019500                                                                  01950009
019600 01  BL-BLANK-LINE                   PIC  X(132)   VALUE SPACES.  01960009
019700                                                                  01970009
019800 01  TL1-TOTAL-LINE.                                              01980009
019900     05  FILLER                      PIC  X(01)    VALUE SPACES.  01990009
020000     05  FILLER                      PIC  X(19)    VALUE          02000009
020100                                          'TOTAL TRAILERS PER '.  02010009
020200     05  TL1-OPER-UNIT-DESC          PIC  X(25)    VALUE SPACES.  02020009
020300     05  FILLER                      PIC  X(03)    VALUE ':  '.   02030009
020400     05  TL1-TRAILER-COUNT           PIC  Z(03)9   VALUE ZEROS.   02040009
020500                                                                  02050009
020600 01  PR-PRINT-NO-DETAIL.                                          02060009
020700     05  FILLER                      PIC X(01)  VALUE SPACES.     02070009
020800     05  FILLER                      PIC X(35)  VALUE             02080009
020900         '*** THERE WAS NO DATA TO REPORT ON '.                   02090009
021000     05  FILLER                      PIC X(24)  VALUE             02100009
021100         'FOR THIS TIME PERIOD ***'.                              02110009
021200                                                                  02120009
021300 01  PR-PRINT-FINAL.                                              02130009
021400     05  FILLER                      PIC X(53)  VALUE SPACES.     02140009
021500     05  FILLER                      PIC X(21)  VALUE             02150009
021600         '*** END OF REPORT ***'.                                 02160009
021700                                                                  02170009
021800     COPY DPWS004.                                                02180009
021900                                                                  02190009
022000*---------------------------------------------------------------* 02200009
022100*    DB2 AREA FOR TVHTRIP                                       * 02210009
022200*---------------------------------------------------------------* 02220009
022300     EXEC SQL                                                     02230009
022400          INCLUDE TVHTRIP                                         02240009
022500     END-EXEC.                                                    02250009
022600*---------------------------------------------------------------* 02260009
022700*    DB2 AREA FOR TTRIPST                                       * 02270009
022800*---------------------------------------------------------------* 02280009
022900     EXEC SQL                                                     02290009
023000          INCLUDE TTRIPST                                         02300009
023100     END-EXEC.                                                    02310009
023200*---------------------------------------------------------------* 02320009
023300*    DB2 AREA FOR TTRSTYP                                       * 02330009
023400*---------------------------------------------------------------* 02340009
023500     EXEC SQL                                                     02350009
023600          INCLUDE TTRSTYP                                         02360009
023700     END-EXEC.                                                    02370009
023800*---------------------------------------------------------------* 02380009
023900*    DB2 AREA FOR TVEHICL                                       * 02390009
024000*---------------------------------------------------------------* 02400009
024100     EXEC SQL                                                     02410009
024200          INCLUDE TVEHICL                                         02420009
024300     END-EXEC.                                                    02430009
024400*---------------------------------------------------------------* 02440009
024500*    DB2 AREA FOR TFACLTY                                       * 02450009
024600*---------------------------------------------------------------* 02460009
024700     EXEC SQL                                                     02470009
024800          INCLUDE TFACLTY                                         02480009
024900     END-EXEC.                                                    02490009
025110*---------------------------------------------------------------* 02511004
025120*    DB2 AREA FOR TKRPRPM                                       * 02512004
025130*---------------------------------------------------------------* 02513004
025140     EXEC SQL                                                     02514004
025150          INCLUDE TKRPRPM                                         02515004
025160     END-EXEC.                                                    02516004
025200*---------------------------------------------------------------* 02520001
025300*    DB2 AREA FOR XLT00010 -- XLT_LOC                           * 02530001
025400*---------------------------------------------------------------* 02540001
025500     EXEC SQL                                                     02550001
025600          INCLUDE XLT00010                                        02560001
025700     END-EXEC.                                                    02570001
025800*---------------------------------------------------------------* 02580001
025900*    DB2 AREA FOR COMMUNICATIONS                                * 02590001
026000*---------------------------------------------------------------* 02600001
026100     EXEC SQL                                                     02610001
026200          INCLUDE SQLCA                                           02620001
026300     END-EXEC.                                                    02630001
026400*---------------------------------------------------------------* 02640001
026500*    CURSOR TO GET DUPLICATE SHIPMENTS                          * 02650001
026600*---------------------------------------------------------------* 02660001
026700     EXEC SQL                                                     02670001
026800         DECLARE TRAILER_CSR CURSOR FOR                           02680001
026900             SELECT A.TRIP_ID,                                    02690001
027000                    A.OWNER_SCAC_ID,                              02700001
027100                    A.VEH_NBR,                                    02710001
027200                    B.TRIP_STATUS_CDE,                            02720001
027300                    B.STATUS_DTE,                                 02730001
027400                    B.STATUS_TME,                                 02740001
027410                    B.STATUS_UID,                                 02741010
027500                    B.OPER_UNT_ID,                                02750001
027600                    B.FCLTY_ID,                                   02760001
027700                    B.FCLTY_AREA_ID                               02770001
027800             FROM TVHTRIP A,                                      02780001
027900                  TTRIPST B,                                      02790001
028000                  TTRSTYP C,                                      02800001
028100                  TVEHICL D,                                      02810001
028200                  XLT_LOC E                                       02820001
028300             WHERE A.TRIP_ID         = B.TRIP_ID                  02830001
028400               AND B.TRIP_STATUS_CDE = C.TRIP_STATUS_CDE          02840001
028410               AND D.OWNER_SCAC_ID   = A.OWNER_SCAC_ID            02841009
028420               AND D.VEH_NBR         = A.VEH_NBR                  02842009
028500               AND D.CURR_TRIP_ID    = A.TRIP_ID                  02850001
028600               AND C.PRTY_CDE        = '70'                       02860001
028700               AND E.LOC_NBR         = B.OPER_UNT_ID              02870001
028800               AND E.LOC_TYP_CDE     = 'DC'                       02880001
028900               AND B.STATUS_DTE      < :PV-ARRIVAL-DTE            02890001
029000               AND B.STATUS_DTE      >                            02900004
029100                         CURRENT DATE - :KRPRPM-FUNC-QTY DAYS     02910005
029600               ORDER BY 8, 9, 2, 3                                02960010
029700     END-EXEC.                                                    02970001
029800                                                                  02980001
029900***************************************************************** 02990001
030000 PROCEDURE DIVISION.                                              03000001
030100***************************************************************** 03010001
030200                                                                  03020001
030300 0000-MAINLINE.                                                   03030001
030400***************************************************************** 03040001
030500*  THIS PARAGRAPH DRIVES THE PROGRAM.                           * 03050001
030600***************************************************************** 03060001
030700     PERFORM 1000-INITIALIZE.                                     03070001
030800                                                                  03080001
030900     PERFORM 2000-MAIN-PROCESS                                    03090001
031000           UNTIL  PS-EOD                                          03100001
031100                                                                  03110001
031200     PERFORM 2515-PRINT-TOTAL-LINE  THRU 2515-EXIT.               03120001
031300                                                                  03130001
031400     PERFORM 9000-END-PROCESS THRU 9000-EXIT.                     03140001
031500                                                                  03150001
031600     PERFORM 9100-CLOSE-CURSOR        THRU 9100-EXIT.             03160001
031700                                                                  03170001
031800     CLOSE  TRAILER-STATUS-REPORT.                                03180001
031900 0000-EXIT.  STOP RUN.                                            03190001
032000                                                                  03200001
032100 1000-INITIALIZE.                                                 03210001
032200     OPEN  OUTPUT TRAILER-STATUS-REPORT.                          03220001
032300                                                                  03230001
032400     ACCEPT CD-CPU-DATE FROM DATE.                                03240001
032500     ACCEPT CT-CPU-TIME FROM TIME.                                03250001
032600                                                                  03260001
032700     PERFORM 1200-INITIALIZE-HEADINGS  THRU 1200-EXIT.            03270001
032800     PERFORM 6999-PRINT-HEADINGS       THRU 6999-EXIT.            03280001
032900     INITIALIZE DPG51 DPG52 DPG53                                 03290001
033000                DPG54 DPG55 DPG56.                                03300001
033100     MOVE CD-CPU-DATE                TO DPG51-SYSTEM-DATE         03310001
033200                                                                  03320001
033300     SET DPG51-ACTUAL-CALENDAR-ONLY  TO TRUE.                     03330001
033400     SET DPG51-DECREMENT-DATE        TO TRUE.                     03340001
033500     SET DPG52-LK-DTE-GREG           TO TRUE.                     03350001
033600     MOVE 3                          TO DPG51-INCR-DECR-DAYS-9.   03360001
033700                                                                  03370001
033800     MOVE CD-YEAR                    TO CD-YY.                    03380001
033900     MOVE CD-MONTH                   TO CD-MM.                    03390001
034000     MOVE CD-DAY                     TO CD-DD.                    03400001
034100     MOVE CD-CPU-DATE-MDY            TO DPG52-LK-DATE-INPUT.      03410001
034200     CALL DP500-KOHLS-CALENDAR-ROUTINE                            03420001
034300         USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.               03430001
034400                                                                  03440001
034500     MOVE DPG55-DB2-ISO-DATE-FMT     TO PV-ARRIVAL-DTE.           03450001
034600     DISPLAY 'DATE MINUS 3 DAYS = ' PV-ARRIVAL-DTE.               03460001
034610                                                                  03461004
034611     PERFORM 1150-GET-TRLR-UNLD-DAYS.                             03461106
034700     PERFORM 1300-OPEN-CURSOR          THRU 1300-EXIT.            03470001
034800                                                                  03480001
034900 1000-EXIT.  EXIT.                                                03490001
035000                                                                  03500001
035001 1150-GET-TRLR-UNLD-DAYS.                                         03500104
035002***************************************************************** 03500204
035003     EXEC SQL                                                     03500307
035020          SELECT FUNC_QTY                                         03502007
035030          INTO   :KRPRPM-FUNC-QTY                                 03503007
035040          FROM   TKRPRPM                                          03504007
035050          WHERE  LOC_ID             = 090                         03505008
035060          AND    FUNC_PRC_STAT_CDE  = 'AC'                        03506007
035070          AND    SYS_PRC_FUNC_CDE   = 'TRUNDY'                    03507007
035071     END-EXEC.                                                    03507107
035080                                                                  03508004
035091     EVALUATE TRUE                                                03509104
035092         WHEN SQLCODE = +0                                        03509204
035093              DISPLAY 'DAYS TO SUBTRACT = ' KRPRPM-FUNC-QTY       03509306
035098         WHEN OTHER                                               03509804
035099             DISPLAY '** ABEND ** IN TRKRP008'                    03509904
035100             DISPLAY 'PARAGRAPH:1150-GET-TRLR-UNLD-DAYS'          03510004
035101             DISPLAY 'MESSAGE:  SQL ERROR SELECTING FROM TKRPRPM' 03510104
035102             PERFORM 9999-SQL-ERROR    THRU 9999-EXIT             03510204
035103     END-EVALUATE.                                                03510304
035104 1150-EXIT.    EXIT.                                              03510404
035105                                                                  03510504
035110 1200-INITIALIZE-HEADINGS.                                        03511001
035200***************************************************************** 03520001
035300*  INITIALIZE REPORT HEADINGS                                   * 03530001
035400***************************************************************** 03540001
035500     MOVE CD-YEAR                TO DP132O-RUN-YEAR.              03550001
035600     MOVE CD-MONTH               TO DP132O-RUN-MONTH.             03560001
035700     MOVE CD-DAY                 TO DP132O-RUN-DAY.               03570001
035800     MOVE CT-HOUR                TO DP132O-RUN-HOUR.              03580001
035900     MOVE CT-MINUTE              TO DP132O-RUN-MINUTE.            03590001
036000     MOVE 'TRKRP008'             TO DP132O-PROGRAM-NAME.          03600001
036100     MOVE 1                      TO DP132O-REPORT-NUMBER.         03610001
036200 1200-EXIT.   EXIT.                                               03620001
036300                                                                  03630001
036400                                                                  03640001
036500 1300-OPEN-CURSOR.                                                03650001
036600     EXEC SQL                                                     03660001
036700         OPEN TRAILER_CSR                                         03670001
036800     END-EXEC.                                                    03680001
036900                                                                  03690001
037000     EVALUATE TRUE                                                03700001
037100         WHEN SQLWARN0 NOT = SPACE                                03710001
037200         WHEN SQLCODE < ZERO                                      03720001
037300         WHEN SQLCODE > ZERO                                      03730001
037400              DISPLAY '** ABEND ** IN TRKRP008'                   03740001
037500              DISPLAY 'PARAGRAPH:  1300-OPEN-CURSOR'              03750001
037600              DISPLAY 'MESSAGE:  SQL ERROR OPENING TRAILER_CSR'   03760001
037700              PERFORM 9999-SQL-ERROR  THRU 9999-EXIT              03770001
037800         WHEN SQLCODE = ZERO                                      03780001
037900             CONTINUE                                             03790001
038000     END-EVALUATE.                                                03800001
038100 1300-EXIT.  EXIT.                                                03810001
038200                                                                  03820001
038300 2000-MAIN-PROCESS.                                               03830001
038400     PERFORM 2100-FETCH-TRAILER-CURSOR  THRU 2100-EXIT.           03840001
038500     EVALUATE TRUE                                                03850001
038600        WHEN PS-EOD                                               03860001
038700             CONTINUE                                             03870001
038800        WHEN PS-NOT-EOD                                           03880001
038900            PERFORM 2400-GET-BEG-ARRIVAL-DTE  THRU 2400-EXIT      03890002
038901            PERFORM 2405-GET-ENROUTE-UID                          03890114
038910            PERFORM 2410-COUNT-VE-RCVRS                           03891010
038920            PERFORM 2420-COUNT-NON-VE-RCVRS                       03892010
038930            PERFORM 2430-COUNT-0-RCVR-RCVRS                       03893010
039000            PERFORM 2500-PRINT-REPORT          THRU 2500-EXIT     03900001
039100     END-EVALUATE.                                                03910001
039200 2000-EXIT.   EXIT.                                               03920001
039300                                                                  03930001
039400 2100-FETCH-TRAILER-CURSOR.                                       03940001
039500     EXEC SQL                                                     03950001
039600          FETCH TRAILER_CSR                                       03960001
039700           INTO :TC-TRAILER-CURSOR-RTN-AREA                       03970001
039800     END-EXEC.                                                    03980001
039900                                                                  03990001
040000     EVALUATE TRUE                                                04000001
040100         WHEN SQLCODE = +0                                        04010001
040200              CONTINUE                                            04020001
040300                                                                  04030001
040400         WHEN SQLCODE = +100                                      04040001
040500              SET  PS-EOD         TO TRUE                         04050001
040600              MOVE SPACES         TO FACLTY-FCLTY-NME             04060001
040700                                                                  04070001
040800         WHEN OTHER                                               04080001
040900            DISPLAY '** ABEND ** IN TRKRP008'                     04090001
041000            DISPLAY 'PARAGRAPH:  2100-FETCH-TRAILER-CURSOR'       04100001
041100            DISPLAY 'MESSAGE:  SQL ERROR FETCHING TRAILER_CSR'    04110001
041200            PERFORM 9999-SQL-ERROR  THRU 9999-EXIT                04120001
041300     END-EVALUATE.                                                04130001
041400                                                                  04140001
041500 2100-EXIT.    EXIT.                                              04150001
041600                                                                  04160016
041601 2400-GET-BEG-ARRIVAL-DTE.                                        04160112
041602     EXEC SQL                                                     04160212
041603          SELECT STATUS_DTE,                                      04160312
041604                 STATUS_TME,                                      04160412
041605                 STATUS_UID                                       04160512
041606           INTO :TRIPST-STATUS-DTE,                               04160612
041607                :TRIPST-STATUS-TME,                               04160712
041608                :TRIPST-STATUS-UID                                04160812
041609           FROM  TTRIPST                                          04160912
041610           WHERE TRIP_ID         = :TC-TRIP-ID                    04161012
041611             AND TRIP_STATUS_CDE = 'AR'                           04161112
041612            WITH UR                                               04161214
041613     END-EXEC.                                                    04161312
041614                                                                  04161412
041615     EVALUATE TRUE                                                04161512
041616         WHEN SQLCODE = +0                                        04161612
041617              CONTINUE                                            04161712
041618                                                                  04161812
041619         WHEN SQLCODE = +100                                      04161912
041620              MOVE SPACES              TO TRIPST-STATUS-DTE       04162012
041621              MOVE SPACES              TO TRIPST-STATUS-TME       04162112
041622              MOVE SPACES              TO TRIPST-STATUS-UID       04162212
041623         WHEN OTHER                                               04162312
041624             DISPLAY '** ABEND ** IN TRKRP008'                    04162412
041625             DISPLAY 'PARAGRAPH:2400-GET-BEG-ARRIVAL-DTE'         04162512
041626             DISPLAY 'MESSAGE:  SQL ERROR SELECTING FROM TTRIPST' 04162612
041627             PERFORM 9999-SQL-ERROR    THRU 9999-EXIT             04162712
041628     END-EVALUATE.                                                04162812
041629 2400-EXIT.    EXIT.                                              04162912
041630                                                                  04163012
041631 2405-GET-ENROUTE-UID.                                            04163114
041632     EXEC SQL                                                     04163214
041634          SELECT STATUS_UID                                       04163414
041637           INTO :PV-ENROUTE-UID                                   04163714
041638           FROM  TTRIPST                                          04163814
041639           WHERE TRIP_ID         = :TC-TRIP-ID                    04163914
041640             AND TRIP_STATUS_CDE = 'EN'                           04164014
041641            WITH UR                                               04164114
041642     END-EXEC.                                                    04164214
041643                                                                  04164314
041644     EVALUATE TRUE                                                04164414
041645         WHEN SQLCODE = +0                                        04164514
041646              CONTINUE                                            04164614
041647                                                                  04164714
041648         WHEN SQLCODE = +100                                      04164814
041650              MOVE SPACES              TO PV-ENROUTE-UID          04165014
041651         WHEN OTHER                                               04165114
041652             DISPLAY '** ABEND ** IN TRKRP008'                    04165214
041653             DISPLAY 'PARAGRAPH:2405-GET-ENROUTE-UID    '         04165314
041654             DISPLAY 'MESSAGE:  SQL ERROR SELECTING FROM TTRIPST' 04165414
041655             PERFORM 9999-SQL-ERROR    THRU 9999-EXIT             04165514
041656     END-EVALUATE.                                                04165614
041657 2410-COUNT-VE-RCVRS.                                             04165712
041658                                                                  04165812
041659     MOVE ZEROES  TO  PV-VE-COUNT.                                04165912
041660                                                                  04166010
041661     EXEC SQL                                                     04166110
041662          SELECT COUNT(*)                                         04166210
041670            INTO :PV-VE-COUNT                                     04167010
041680           FROM                                                   04168010
041690          (SELECT DISTINCT                                        04169010
041691                 C.ORD_NBR                                        04169110
041692               , C.REC_SEQ_NBR                                    04169210
041693               , C.STATUS_CDE                                     04169310
041694            FROM TSHIPMT A                                        04169410
041695               , TSHPTPO B                                        04169510
041696               , TRECEIV C                                        04169610
041697          WHERE A.TRIP_ID      =  :TC-TRIP-ID                     04169710
041698            AND A.SHIPT_ID     =  B.SHIPT_ID                      04169810
041699            AND B.PO_NBR       =  C.ORD_NBR                       04169910
041700            AND B.REC_SEQ_NBR  =  C.REC_SEQ_NBR                   04170010
041701            AND C.STATUS_CDE   = 'VE'                             04170110
041702          ) AS T1                                                 04170210
041703          WITH UR                                                 04170310
041704     END-EXEC.                                                    04170410
041705                                                                  04170510
041706     EVALUATE TRUE                                                04170610
041707         WHEN SQLCODE = +0                                        04170710
041708              CONTINUE                                            04170810
041709                                                                  04170910
041710         WHEN SQLCODE = +100                                      04171010
041711         WHEN SQLCODE = -305                                      04171110
041712              MOVE ZEROES              TO PV-VE-COUNT             04171210
041713         WHEN OTHER                                               04171310
041714             DISPLAY '** ABEND ** IN TRKRP007'                    04171410
041715             DISPLAY 'PARAGRAPH:2410-COUNT-VE-RCVRS       '       04171510
041716             DISPLAY 'MESSAGE:  SQL ERROR SELECTING FROM TTRIPST' 04171610
041717             PERFORM 9999-SQL-ERROR    THRU 9999-EXIT             04171710
041718     END-EVALUATE.                                                04171810
041719                                                                  04171910
041720                                                                  04172010
041721 2420-COUNT-NON-VE-RCVRS.                                         04172110
041722                                                                  04172210
041723     MOVE ZEROES  TO  PV-NON-VE-COUNT.                            04172310
041724                                                                  04172410
041725     EXEC SQL                                                     04172510
041726          SELECT COUNT(*)                                         04172610
041727            INTO :PV-NON-VE-COUNT                                 04172710
041728           FROM                                                   04172810
041729          (SELECT DISTINCT                                        04172910
041730                 C.ORD_NBR                                        04173010
041731               , C.REC_SEQ_NBR                                    04173110
041732               , C.STATUS_CDE                                     04173210
041733            FROM TSHIPMT A                                        04173310
041734               , TSHPTPO B                                        04173410
041735               , TRECEIV C                                        04173510
041736          WHERE A.TRIP_ID      =  :TC-TRIP-ID                     04173610
041737            AND A.SHIPT_ID     =  B.SHIPT_ID                      04173710
041738            AND B.PO_NBR       =  C.ORD_NBR                       04173810
041739            AND B.REC_SEQ_NBR  =  C.REC_SEQ_NBR                   04173910
041740            AND NOT C.STATUS_CDE   = 'VE'                         04174010
041741          ) AS T1                                                 04174110
041742          WITH UR                                                 04174210
041743     END-EXEC.                                                    04174310
041744                                                                  04174410
041745     EVALUATE TRUE                                                04174510
041746         WHEN SQLCODE = +0                                        04174610
041747              CONTINUE                                            04174710
041748                                                                  04174810
041749         WHEN SQLCODE = +100                                      04174910
041750         WHEN SQLCODE = -305                                      04175010
041751              MOVE ZEROES              TO PV-NON-VE-COUNT         04175110
041752         WHEN OTHER                                               04175210
041753             DISPLAY '** ABEND ** IN TRKRP007'                    04175310
041754             DISPLAY 'PARAGRAPH:2420-COUNT-NON-VE-RCVRS   '       04175410
041755             DISPLAY 'MESSAGE:  SQL ERROR SELECTING FROM TTRIPST' 04175510
041756             PERFORM 9999-SQL-ERROR    THRU 9999-EXIT             04175610
041757     END-EVALUATE.                                                04175710
041758                                                                  04175810
041759                                                                  04175910
041760 2430-COUNT-0-RCVR-RCVRS.                                         04176010
041761                                                                  04176110
041762     MOVE ZEROES  TO  PV-0-RCVR-COUNT.                            04176210
041763                                                                  04176310
041764     EXEC SQL                                                     04176410
041765          SELECT COUNT(*)                                         04176510
041766            INTO :PV-0-RCVR-COUNT                                 04176610
041767           FROM                                                   04176710
041768          (SELECT DISTINCT                                        04176810
041769                 B.PO_NBR                                         04176910
041770               , B.REC_SEQ_NBR                                    04177010
041771            FROM TSHIPMT A                                        04177110
041772               , TSHPTPO B                                        04177210
041773          WHERE A.TRIP_ID      =  :TC-TRIP-ID                     04177310
041774            AND A.SHIPT_ID     =  B.SHIPT_ID                      04177410
041775            AND B.REC_SEQ_NBR  =  0                               04177510
041776          ) AS T1                                                 04177610
041777          WITH UR                                                 04177710
041778     END-EXEC.                                                    04177810
041779                                                                  04177910
041780     EVALUATE TRUE                                                04178010
041781         WHEN SQLCODE = +0                                        04178110
041782              CONTINUE                                            04178210
041783                                                                  04178310
041784         WHEN SQLCODE = +100                                      04178410
041785         WHEN SQLCODE = -305                                      04178510
041786              MOVE ZEROES              TO PV-0-RCVR-COUNT         04178610
041787         WHEN OTHER                                               04178710
041788             DISPLAY '** ABEND ** IN TRKRP007'                    04178810
041789             DISPLAY 'PARAGRAPH:420-COUNT-0-RCVR-RCVRS    '       04178910
041790             DISPLAY 'MESSAGE:  SQL ERROR SELECTING FROM TTRIPST' 04179010
041791             PERFORM 9999-SQL-ERROR    THRU 9999-EXIT             04179110
041792     END-EVALUATE.                                                04179210
041793                                                                  04179310
041794                                                                  04179410
044300 2500-PRINT-REPORT.                                               04430001
044400                                                                  04440001
044500     IF  TC-OPER-UNT-ID      = PV-SAVE-LOC                        04450001
044600         PERFORM 2510-PRINT-DETAIL-LINE THRU 2510-EXIT            04460001
044700     ELSE                                                         04470001
044800         IF PV-TRAILER-COUNT NOT = 0                              04480001
044900             PERFORM 2515-PRINT-TOTAL-LINE  THRU 2515-EXIT        04490001
045000             PERFORM 9000-END-PROCESS THRU 9000-EXIT              04500001
045100         END-IF                                                   04510001
045200         MOVE 0   TO PV-TRAILER-COUNT                             04520001
045300         PERFORM 2520-GET-FCLTY-ID-NAME THRU 2520-EXIT            04530001
045400         IF PS-FIRST-PAGE                                         04540001
045500             SET PS-NOT-FIRST-PAGE TO TRUE                        04550001
045600         ELSE                                                     04560001
045700             MOVE 0                TO PV-PAGE-COUNT               04570001
045800             PERFORM 6999-PRINT-HEADINGS    THRU 6999-EXIT        04580001
045900         END-IF                                                   04590001
046000         PERFORM 7000-PRINT-HEADINGS    THRU 7000-EXIT            04600001
046100         PERFORM 2510-PRINT-DETAIL-LINE THRU 2510-EXIT            04610001
046200         MOVE TC-OPER-UNT-ID    TO  PV-SAVE-LOC                   04620001
046300     END-IF.                                                      04630001
046400 2500-EXIT.   EXIT.                                               04640001
046500                                                                  04650001
046600 2510-PRINT-DETAIL-LINE.                                          04660001
046700                                                                  04670001
046800     ADD 1 TO PV-TRAILER-COUNT                                    04680001
046900                                                                  04690001
047000     IF  PV-LINE-COUNT > PC-LINE-LIMIT                            04700001
047100         PERFORM 6999-PRINT-HEADINGS   THRU 6999-EXIT             04710001
047200         PERFORM 7000-PRINT-HEADINGS    THRU 7000-EXIT            04720001
047300     END-IF.                                                      04730001
047400                                                                  04740001
047500      MOVE TC-TRIP-ID              TO    DL1-TRIP-ID              04750010
047600      MOVE TC-OWNER-SCAC           TO    DL1-DELVRY-SCAC          04760001
047700      MOVE TC-VEH-NBR              TO    DL1-TRAILER              04770011
047800      STRING TC-UNLOAD-DTE                                        04780002
047900             ' '                                                  04790001
048000             TC-UNLOAD-TIME                                       04800002
048100          DELIMITED BY SIZE                                       04810001
048200          INTO DL1-UNLOAD-DTE                                     04820002
048300      END-STRING                                                  04830001
048400      STRING TRIPST-STATUS-DTE                                    04840001
048500             ' '                                                  04850001
048600             TRIPST-STATUS-TME                                    04860001
048700         DELIMITED BY SIZE                                        04870001
048800         INTO DL1-ARRIVAL-DTE                                     04880002
048900      END-STRING                                                  04890001
049000                                                                  04900001
049030      MOVE TC-UNLOAD-USERID        TO    DL1-UNLOAD-USERID        04903012
049031      MOVE TRIPST-STATUS-UID       TO    DL1-ARRIVAL-USERID       04903112
049032      MOVE PV-ENROUTE-UID          TO    DL1-ENROUTE-USERID       04903214
049040                                                                  04904010
049050      MOVE PV-VE-COUNT             TO    DL1-VE-CNT               04905010
049060      MOVE PV-NON-VE-COUNT         TO    DL1-NON-VE-CNT           04906010
049070      MOVE PV-0-RCVR-COUNT         TO    DL1-0-RCVR-CNT           04907010
049080                                                                  04908010
049100      WRITE  TRAILER-STATUS-RECORD                                04910001
049200        FROM DL1-DETAIL-LINE-1                                    04920001
049300          AFTER ADVANCING 1 LINE.                                 04930001
049400                                                                  04940001
049500     ADD 1                      TO PV-LINE-COUNT.                 04950001
049600 2510-EXIT.   EXIT.                                               04960001
049700                                                                  04970001
049800 2515-PRINT-TOTAL-LINE.                                           04980001
049900     MOVE HL2-OPER-UNIT-DESC TO TL1-OPER-UNIT-DESC                04990001
050000     MOVE PV-TRAILER-COUNT   TO TL1-TRAILER-COUNT                 05000001
050100     WRITE  TRAILER-STATUS-RECORD                                 05010001
050200        FROM TL1-TOTAL-LINE                                       05020001
050300          AFTER ADVANCING 2 LINE.                                 05030001
050400     ADD 2                      TO PV-LINE-COUNT.                 05040001
050500 2515-EXIT.   EXIT.                                               05050001
050600                                                                  05060001
050700 2520-GET-FCLTY-ID-NAME.                                          05070001
050800          EXEC SQL                                                05080001
050900            SELECT  FCLTY_ID                                      05090001
051000                   ,FCLTY_NME                                     05100001
051100              INTO :FACLTY-FCLTY-ID                               05110001
051200                   ,:FACLTY-FCLTY-NME                             05120001
051300               FROM  TFACLTY                                      05130001
051400              WHERE  OPER_UNT_ID = :TC-OPER-UNT-ID                05140001
051500                AND  FCLTY_ID    = :TC-FCLTY-ID                   05150001
051600          END-EXEC                                                05160001
051700                                                                  05170001
051800          EVALUATE TRUE                                           05180001
051900              WHEN SQLCODE = +0                                   05190001
052000                MOVE TC-OPER-UNT-ID    TO HL2-OPER-UNIT-ID        05200001
052100                MOVE FACLTY-FCLTY-NME  TO HL2-OPER-UNIT-DESC      05210001
052200              WHEN SQLCODE = +100                                 05220001
052300              WHEN SQLCODE = -904                                 05230001
052400              WHEN SQLCODE = -913                                 05240001
052500                  CONTINUE                                        05250001
052600                                                                  05260001
052700              WHEN SQLWARN0 NOT = SPACES                          05270001
052800              WHEN SQLCODE < +0                                   05280001
052900              WHEN SQLCODE > +0                                   05290001
053000                   DISPLAY '** ABEND ** IN TRKRP008'              05300001
053100                   DISPLAY 'PARAGRAPH:2520-GET-FCLTY-ID-NAME'     05310001
053200                   DISPLAY                                        05320001
053300                  'MESSAGE:  SQL ERROR SELECTING FROM TFACLTY'    05330001
053400                   PERFORM 9999-SQL-ERROR   THRU 9999-EXIT        05340001
053500          END-EVALUATE.                                           05350001
053600 2520-EXIT.   EXIT.                                               05360001
053700 6999-PRINT-HEADINGS.                                             05370001
053800***************************************************************** 05380001
053900*  HEADING ROUTINE.                                             * 05390001
054000***************************************************************** 05400001
054100     ADD 1                       TO PV-PAGE-COUNT.                05410001
054200     MOVE PV-PAGE-COUNT          TO DP132O-PAGE-NUMBER.           05420001
054300                                                                  05430001
054400     WRITE TRAILER-STATUS-RECORD                                  05440001
054500       FROM DP132O-STANDRD-HEADER-132-COLS                        05450001
054600         AFTER ADVANCING PAGE.                                    05460001
054700                                                                  05470001
054800     WRITE TRAILER-STATUS-RECORD                                  05480001
054900       FROM HL1-HEADING-LINE-1                                    05490001
055000         AFTER ADVANCING 2 LINES.                                 05500001
055100     MOVE 3                   TO PV-LINE-COUNT.                   05510001
055200 6999-EXIT.   EXIT.                                               05520001
055300                                                                  05530001
055400 7000-PRINT-HEADINGS.                                             05540001
055500     WRITE TRAILER-STATUS-RECORD                                  05550001
055600       FROM HL2-HEADING-LINE-2                                    05560001
055700         AFTER ADVANCING 2 LINES                                  05570001
055800                                                                  05580001
055900     WRITE TRAILER-STATUS-RECORD                                  05590001
056000       FROM HL3-HEADING-LINE-3                                    05600001
056100         AFTER ADVANCING 2 LINES.                                 05610001
056200                                                                  05620001
056300     WRITE TRAILER-STATUS-RECORD                                  05630001
056400       FROM HL4-HEADING-LINE-4                                    05640001
056500         AFTER ADVANCING 1 LINE.                                  05650001
056600                                                                  05660001
056700     WRITE TRAILER-STATUS-RECORD                                  05670001
056800       FROM BL-BLANK-LINE                                         05680001
056900         AFTER ADVANCING 1 LINE.                                  05690001
057000                                                                  05700001
057100     ADD  6                   TO PV-LINE-COUNT.                   05710001
057200 7000-EXIT.   EXIT.                                               05720001
057300                                                                  05730001
057400 9000-END-PROCESS.                                                05740001
057500***************************************************************** 05750001
057600*  CLOSE FILES.                                                   05760001
057700***************************************************************** 05770001
057800                                                                  05780001
057900     WRITE TRAILER-STATUS-RECORD                                  05790001
058000       FROM PR-PRINT-FINAL                                        05800001
058100         AFTER ADVANCING 3 LINES.                                 05810001
058200                                                                  05820001
058300 9000-EXIT.  EXIT.                                                05830001
058400                                                                  05840001
058500 9100-CLOSE-CURSOR .                                              05850001
058600     EXEC SQL                                                     05860001
058700         CLOSE TRAILER_CSR                                        05870001
058800     END-EXEC.                                                    05880001
058900                                                                  05890001
059000     EVALUATE TRUE                                                05900001
059100         WHEN SQLWARN0 NOT = SPACE                                05910001
059200         WHEN SQLCODE < ZERO                                      05920001
059300         WHEN SQLCODE > ZERO                                      05930001
059400             DISPLAY '** ABEND ** IN TRKRP008'                    05940001
059500             DISPLAY 'PARAGRAPH:9100-CLOSE-CURSOR'                05950001
059600             DISPLAY 'MESSAGE:  SQL ERROR CLOSING TRAILER_CSR'    05960001
059700             PERFORM 9999-SQL-ERROR    THRU 9999-EXIT             05970001
059800         WHEN SQLCODE = ZERO                                      05980001
059900             CONTINUE                                             05990001
060000     END-EVALUATE.                                                06000001
060100                                                                  06010001
060200 9100-EXIT.  EXIT.                                                06020001
060300                                                                  06030001
060400 9999-SQL-ERROR.                                                  06040001
060500                                                                  06050001
060600     COPY DPPD004.                                                06060001
060700                                                                  06070001
060800     MOVE +4013 TO PV-ABEND-CODE.                                 06080001
060900     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         06090001
061000 9999-EXIT.   EXIT.                                               06100001
061100                                                                  06110001
