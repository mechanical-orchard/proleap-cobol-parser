000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.    POKCS103.                                         00020000
000300 AUTHOR.        DAVE COLOMBO - COMPUWARE.                         00030000
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040000
000500 DATE-WRITTEN.  06-01-99.                                         00050000
000600 DATE-COMPILED.                                                   00060000
000700*----------------------------------------------------------------*00070000
000800*    W103 - PURCHASE ORDER INQUIRY CRITERIA SPEC                 *00080000
000900*                                                                *00090000
001000*    THIS PROGRAM ALLOWS THE USER TO ENTER DATA TO BE USED BY    *00100000
001100*    SUBSEQUENT PROGRAMS TO CREATE A LIST SCREEN. ALL OTHER      *00110000
001200*    EDITS ARE DONE IN THE DESTINATION PROGRAMS WHEN THE 'GO-TO' *00120000
001300*    TYPE FUNCTION IS USED.                                      *00130000
001400*----------------------------------------------------------------*00140000
W24803* 05/12/03 - S PRABHAKAR RAO, IGSI - WR NO. 24803                *00150025
W24803*    - IN MAP POKM103 REPLACED DEPARTMENT, CLASS AND             *00160026
W24803*      SEQUENCE NUMBER BY DEPARTMENT, MAJOR CLASS, SUB CLASS     *00170026
W24803*      AND SKU NUMBER AND ADJUSTED THE POSITIONS OF OTHER FIELDS.*00180026
W24803*    - COPY BOOKS POWS079 IS CHANGED.                            *00190026
W24803*    - REPLACED DEPARTMENT, CLASS AND 3 DIGIT SEQUENCE NUMBER    *00200026
W24803*      WITH DEPARTMENT, SUB CLASS, MAJOR CLASS AND SKU NUMBER    *00210026
W24803*      RESPECTIVELY FOR NI SKU CONVERSION.                       *00220026
W24803*----------------------------------------------------------------*00230026
C98147* 11/10/14 - LINDA FRIESS          - CHG0098147                   00240045
C98147*    - EXPANDED PO NUMBER TO 8 DIGITS IN MAP AND COMMAREA.        00250045
C98147*---------------------------------------------------------------* 00260045
076319* DATE  10/27/2021                                                00262047
076320*            - CHANGE CALL OF 'DPKUT100' TO                     * 00263047
076321*              CALL DP010I-NUMERIC-EDIT-ROUTINE                 * 00264047
076322*              MAKING THE CALL DYNAMIC VS STATIC                * 00265047
076323*     MADE BY: GERMAN BANDA            WR/IR #: CHG0263126        00266048
076312*                                                               * 00267047
076318*---------------------------------------------------------------* 00268047
CICS  *  CHANGED 11/16/2022    BY BARB SCHULTZ    WR: CHG0278485      * 00269050
CICS  *                                                               * 00269149
CICS  *  ADDED COPYBOOK DPWS930 AND MADE THE CICS ARCHITECTURE CALL   * 00269249
CICS  *  DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.    * 00269349
CICS  *---------------------------------------------------------------* 00269649
001500                                                                  00270000
001600 ENVIRONMENT DIVISION.                                            00280000
001700 DATA DIVISION.                                                   00290000
001800 EJECT                                                            00300000
001900 WORKING-STORAGE SECTION.                                         00310000
002000                                                                  00320000
002100 01  PC-PROGRAM-CONSTANTS.                                        00330000
002200     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE  'PO103A  '. 00340000
002300     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE  'POKM103 '. 00350000
002400     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE  'POKCS103'. 00360000
002500     05  PC-MAX-RETRIES            PIC  9(01)  VALUE  3.          00370000
002600     05  PC-TSYMSG-NUMBERS.                                       00380000
002700         10  PC-TSYMSG-00005       PIC  9(05)  VALUE  00005.      00390000
002800         10  PC-TSYMSG-00008       PIC  9(05)  VALUE  00008.      00400000
002900         10  PC-TSYMSG-00009       PIC  9(05)  VALUE  00009.      00410000
003000         10  PC-TSYMSG-00143       PIC  9(05)  VALUE  00143.      00420000
003100         10  PC-TSYMSG-00148       PIC  9(05)  VALUE  00148.      00430000
003200         10  PC-TSYMSG-00639       PIC  9(05)  VALUE  00639.      00440000
003300         10  PC-TSYMSG-00640       PIC  9(05)  VALUE  00640.      00450000
               10  PC-TSYMSG-03445       PIC  9(05)  VALUE  03445.      00460032
               10  PC-TSYMSG-03488       PIC  9(05)  VALUE  03488.      00470032
003400                                                                  00480000
003500     05  PC-INTER-APPL-CODES.                                     00490000
003600         10  PC-INTER-APPL-CRIT       PIC X(01)  VALUE ' '.       00500000
003700         10  PC-INTER-APPL-LIST       PIC X(01)  VALUE '1'.       00510000
003800                                                                  00520000
003900 01  PV-PROGRAM-VARIABLES.                                        00530000
004000     05  PV-RETRY-COUNTER          PIC  9(03)  VALUE  0           00540000
004100                                               COMP-3.            00550000
004200     05  PV-DB2-COUNT              PIC S9(09)  VALUE +0           00560000
004300                                               COMP-3.            00570000
004400     05  PV-DONT-SHIP-DATE         PIC X(10) VALUE SPACES.        00580000
004500     05  PV-AD-DATE                PIC X(10) VALUE SPACES.        00590000
004600                                                                  00600000
004700 01  PS-PROGRAM-SWITCHES.                                         00610000
004800     05  PS-COMMAREA-SW            PIC  X(01) VALUE 'N'.          00620000
004900         88  PS-COMMAREA-VALID                VALUE 'Y'.          00630000
005000         88  PS-COMMAREA-NOT-VALID            VALUE 'N'.          00640000
005100     05  PS-ERROR-SW               PIC  X(01)  VALUE  'N'.        00650000
005200         88  PS-ERROR                          VALUE  'Y'.        00660000
005300         88  PS-NO-ERROR                       VALUE  'N'.        00670000
005400*----------------------------------------------------------------*00680000
005500*    MAP LAYOUT                                                  *00690000
005600*----------------------------------------------------------------*00700000
005700     COPY POKM103.                                                00710000
005800 EJECT                                                            00720000
005900*----------------------------------------------------------------*00730000
006000*    ATTRIBUTE SETTINGS COPYBOOK.                                *00740000
006100*----------------------------------------------------------------*00750000
006200     COPY DPWS015.                                                00760000
006300 EJECT                                                            00770000
006400*----------------------------------------------------------------*00780000
006500*    FUNCTION KEYS COPYBOOK                                      *00790000
006600*----------------------------------------------------------------*00800000
006700     COPY DPWS016.                                                00810000
006800 EJECT                                                            00820000
006900******************************************************************00830000
007000** THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT    **00840000
007100** SUB-ROUTINE (DPKUT100).                                      **00850000
007200******************************************************************00860000
007300     COPY DPWS010I.                                               00870000
007400 EJECT                                                            00880000
007500*----------------------------------------------------------------*00890000
007600*  WORK AREA PASSED IN CALL TO DPKUT500                          *00900000
007700*----------------------------------------------------------------*00910000
007800     COPY DPWS500.                                                00920000
007900 EJECT                                                            00930000
008000******************************************************************00940000
CICS  *    PARAMETERS FOR CALLING THE CICS ARCHITECTURE API.          **00950049
008300******************************************************************00970000
008400     COPY DPWS030.                                                00980000
CICS       COPY DPWS930.                                                00981049
008500 EJECT                                                            00990000
008600***************************************************************** 01000000
008700*    STANDARD COMMAREA.                                           01010000
008800***************************************************************** 01020000
008900                                                                  01030000
009000     COPY DPWS020.                                                01040000
009100     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                01050000
009200                                                                  01060000
009300***************************************************************** 01070000
009400*    INTER-APPLICATION COMMAREA.                                  01080000
009500*      POWS079 - COMMAREA PASSED FROM POKCS102 AND PASSED TO      01090000
009600*                POKCS104                                         01100000
009700***************************************************************** 01110000
009800         10  INTER-APPL-COMM-AREA PIC X(200).                     01120000
009900                                                                  01130000
010000     COPY POWS079.                                                01140000
010100                                                                  01150000
010200***************************************************************** 01160000
010300*    SPECIFIC COMMMAREA FOR POKCS103.                             01170000
010400***************************************************************** 01180000
010500         10  ASC-SPECIFIC-COMMAREA.                               01190000
010600             15  ASC-SET-FIELDS.                                  01200000
010700                 20  ASC-SET-YEAR              PIC X(04).         01210000
010800                 20  ASC-SET-SHORT-NME         PIC X(05).         01220000
010900             15  ASC-KEY-FIELDS.                                  01230000
C98147                 20  ASC-PO-NBR                PIC X(08).         01240045
011100                 20  ASC-PO-NBR-N REDEFINES ASC-PO-NBR            01250000
C98147                                               PIC 9(08).         01260045
011300                 20  ASC-IMPRT-AGNT-PO-NBR     PIC X(08).         01270000
011400                 20  ASC-IMPRT-AGNT-PO-NBR-N REDEFINES            01280000
011500                     ASC-IMPRT-AGNT-PO-NBR     PIC 9(08).         01290000
011600                 20  ASC-DEPT-NBR              PIC X(3).          01300000
011700                 20  ASC-DEPT-NBR-N REDEFINES ASC-DEPT-NBR        01310000
011800                                               PIC 9(3).          01320000
011900                 20  ASC-STATUS-GRP            PIC X(3).          01330000
012000                 20  ASC-STATUS-CDE            PIC X(2).          01340000
W24803                 20  ASC-MAJ-CL-NBR            PIC X(2).          01350000
W24803                 20  ASC-MAJ-CL-NBR-N REDEFINES ASC-MAJ-CL-NBR    01360000
W24803                                               PIC 9(2).          01370000
W24803                 20  ASC-SUB-CL-NBR            PIC X(2).          01380022
W24803                 20  ASC-SUB-CL-NBR-N REDEFINES ASC-SUB-CL-NBR    01390022
012300                                               PIC 9(2).          01400000
012400                 20  ASC-PO-TYP-CDE            PIC X(2).          01410000
012500                 20  ASC-PO-TYP-DESC           PIC X(20).         01420000
W24803                 20  ASC-SKU-NBR               PIC X(8).          01430000
W24803                 20  ASC-SKU-NBR-N REDEFINES ASC-SKU-NBR          01440000
W24803                                               PIC 9(8).          01450000
012900                 20  ASC-STR-NBR               PIC X(4).          01460028
013000                 20  ASC-STR-NBR-N REDEFINES ASC-STR-NBR          01470000
013100                                               PIC 9(4).          01480028
013200                 20  ASC-ENT-NAME-DESC         PIC X(30).         01490000
013300                 20  ASC-VEND-STYL-NME         PIC X(20).         01500000
013400                 20  ASC-AD-EVNT-DTE           PIC X(08).         01510000
013500                 20  ASC-AD-EVNT-DTE-ISO       PIC X(10).         01520000
013600                 20  ASC-OTB-PER-NBR-BEG       PIC X(06).         01530000
013700                 20  ASC-OTB-PER-NBR-BEG-N REDEFINES              01540000
013800                     ASC-OTB-PER-NBR-BEG       PIC 9(06).         01550000
013900                 20  ASC-OTB-PER-NBR-END       PIC X(06).         01560000
014000                 20  ASC-OTB-PER-NBR-END-N REDEFINES              01570000
014100                     ASC-OTB-PER-NBR-END       PIC 9(06).         01580000
014200                 20  ASC-NEW-STORE-IND         PIC X(01).         01590000
                       20  ASC-SHIP-BEG              PIC X(10).         01600030
                       20  ASC-SHIP-END              PIC X(10).         01610030
C98147         10  FILLER                            PIC X(2693).       01620045
014300 EJECT                                                            01630000
014400*----------------------------------------------------------------*01640000
014500*    ABEND PROCESSING COPYBOOK.                                  *01650000
014600*----------------------------------------------------------------*01660000
014700     COPY DPWS013.                                                01670000
014800 EJECT                                                            01680000
014900 EJECT                                                            01690000
015000 LINKAGE SECTION.                                                 01700000
015100                                                                  01710000
015200 01  DFHCOMMAREA.                                                 01720000
015300     05  FILLER                         OCCURS  1 TO 4072 TIMES   01730000
015400                                        DEPENDING ON EIBCALEN.    01740000
015500         10  FILLER                     PIC X.                    01750000
015600 EJECT                                                            01760000
015700 PROCEDURE DIVISION.                                              01770000
015800                                                                  01780000
015900***************************************************************** 01790000
016000** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** 01800000
016100** THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  ** 01810000
016200** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            ** 01820000
016300**                                                             ** 01830000
016400** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  ** 01840000
016500** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       ** 01850000
016600***************************************************************** 01860000
016700                                                                  01870000
016800 0000-MAIN-MODULE.                                                01880000
016900                                                                  01890000
017000     INITIALIZE DP030-CICS-API-FIELDS.                            01900000
017100     MOVE +1                     TO DP030-NUMBER-OF-MAPS.         01910000
017200     MOVE PC-CURRENT-MAPSET-NAME TO DP030-MAPSET-NAME.            01920000
017300     MOVE PC-CURRENT-MAP-NAME    TO DP030-MAP-NAME (1).           01930000
017400     SET DP030-RECEIVE-APPL-MAP  TO TRUE.                         01940000
017500     MOVE LENGTH OF PO103AI      TO DP030-MAP-LENGTH (1).         01950000
017600     MOVE 'PROGRAM ENTRY CALL'   TO DP013-MESSAGE-TEXT (1).       01960000
017700                                                                  01970000
017800     PERFORM 0001-CALL-CICS-ARCH-API.                             01980000
017900     PERFORM 1000-CONTROL-PROCESSING                              01990000
018000                                                                  02000000
018100     MOVE 'PROGRAM EXIT CALL'    TO DP013-MESSAGE-TEXT (1).       02010000
018200     PERFORM 0001-CALL-CICS-ARCH-API.                             02020000
018300                                                                  02030000
018400                                                                  02040000
018500 0001-CALL-CICS-ARCH-API.                                         02050000
018600                                                                  02060000
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      02070049
018800                                    DFHCOMMAREA                   02080049
018900                                    DP030-CICS-API-FIELDS         02090049
019000                                    DP020-STANDARD-COMMAREA       02100049
019100                                    PO103AI.                      02110049
019200                                                                  02120000
019300     IF  DP030-RC-CALL-SUCCESSFUL                                 02130000
019400         CONTINUE                                                 02140000
019500     ELSE                                                         02150000
019600         SET DP013-NO-ROLLBACK                                    02160000
019700             DP013-XCTL-DISPLAY-RESTART                           02170000
019800             DP013-CICS-ABEND    TO TRUE                          02180000
CICS           MOVE '0001-CALL-CICS-ARCH-API'                           02190049
020000                                 TO DP013-PARAGRAPH               02200000
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O02210049
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      02220049
020300         MOVE DP030-RETURN-CODE  TO DP013-MESSAGE-TEXT (3)        02230000
020400         PERFORM DP013-0000-PROCESS-ABEND                         02240000
020500     END-IF.                                                      02250000
020600 EJECT                                                            02260000
020700*----------------------------------------------------------------*02270000
020800*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *02280000
020900*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *02290000
021000*----------------------------------------------------------------*02300000
021100                                                                  02310000
021200 1000-CONTROL-PROCESSING.                                         02320000
021300                                                                  02330000
021400     EVALUATE TRUE                                                02340000
021500         WHEN DP020-NEXT-ACT-INITIAL                              02350000
021600             INITIALIZE ASC-SPECIFIC-COMMAREA                     02360000
021700              PERFORM 1100-PROCESS-INTER-APPL-COMM                02370000
021800              IF  PS-COMMAREA-NOT-VALID                           02380000
021900                  CONTINUE                                        02390000
022000              ELSE                                                02400000
022100                  PERFORM 4000-BUILD-INITIAL-PANEL                02410000
022200              END-IF                                              02420000
022300             PERFORM 4000-BUILD-INITIAL-PANEL                     02430000
022400                                                                  02440000
022500         WHEN DP020-NEXT-ACT-READ-MAP                             02450000
022600             PERFORM 2000-FKEY-PROCESSING                         02460000
022700                                                                  02470000
022800         WHEN DP020-NEXT-ACT-RETURN                               02480000
022900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 02490000
023000             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   02500000
023100                                                                  02510000
023200         WHEN OTHER                                               02520000
023300             SET DP013-LOGIC-ABEND                                02530000
023400                 DP013-NO-ROLLBACK                                02540000
023500                                 TO TRUE                          02550000
023600             MOVE '1000-CONTROL-PROCESSING'                       02560000
023700                                 TO  DP013-PARAGRAPH              02570000
023800             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   02580000
023900                                 TO  DP013-MESSAGE-TEXT(1)        02590000
024000             MOVE DP020-NEXT-APPL-ACTIVITY                        02600000
024100                                 TO DP013-MESSAGE-TEXT(2)         02610000
024200             PERFORM DP013-0000-PROCESS-ABEND                     02620000
024300     END-EVALUATE.                                                02630000
024400 EJECT                                                            02640000
024500                                                                  02650000
024600*----------------------------------------------------------------*02660000
024700*    DETERMINE THE KEY OF THE OBJECT TO BE UPDATED BASED ON THE  *02670000
024800*    INTER-APPLICATION FORMAT CODE.                              *02680000
024900*                                                                *02690000
025000*    PERFORM SPECIFIC VALIDATIONS FOR EACH "MODE" AND BASED      *02700000
025100*    ON WHERE THE PROGRAM WAS INITIATED FROM.                    *02710000
025200*----------------------------------------------------------------*02720000
025300 1100-PROCESS-INTER-APPL-COMM.                                    02730000
025400                                                                  02740000
025500     SET PS-COMMAREA-VALID            TO TRUE.                    02750000
025600                                                                  02760000
025700     EVALUATE DP020-INT-APPL-FORMAT-IND                           02770000
025800                                                                  02780000
025900         WHEN PC-INTER-APPL-CRIT                                  02790000
026000             MOVE PO079-SET-SHORT-NME TO ASC-SET-SHORT-NME        02800000
026100             MOVE PO079-SET-YEAR      TO ASC-SET-YEAR             02810000
026200                                                                  02820000
026300         WHEN OTHER                                               02830000
026400             MOVE PC-TSYMSG-00148 TO DP020-MSG-NUMBER             02840000
026500             SET PS-COMMAREA-NOT-VALID                            02850000
026600                 DP020-MSG-FATAL                                  02860000
026700                 DP020-NEXT-ACT-APPL-ERROR                        02870000
026800                                 TO TRUE                          02880000
026900                                                                  02890000
027000     END-EVALUATE.                                                02900000
027100                                                                  02910000
027200 EJECT                                                            02920000
027300                                                                  02930000
027400*----------------------------------------------------------------*02940000
027500* FURTHER DETERMINE PROCESSING PATH BASED ON FUNCTION KEY ACTIONS*02950000
027600* SPECIFIC FUNCTION KEYS LISTED HERE ARE ACTED UPON REGARDLESS OF*02960000
027700* EDITS.                                                         *02970000
027800*----------------------------------------------------------------*02980000
027900                                                                  02990000
028000 2000-FKEY-PROCESSING.                                            03000000
028100                                                                  03010000
028200     EVALUATE TRUE                                                03020000
028300                                                                  03030000
028400         WHEN DP020-SRC-AID = DP016-CLEAR                         03040000
028500             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   03050000
028600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 03060000
028700                                                                  03070000
028800         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     03080000
028900             INITIALIZE ASC-KEY-FIELDS                            03090000
029000             PERFORM 4000-BUILD-INITIAL-PANEL                     03100000
029100             PERFORM 3100-RESET-ATTRIBUTES                        03110000
029200                                                                  03120000
029300         WHEN OTHER                                               03130000
029400             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 03140000
029500             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   03150000
029600             IF  PS-NO-ERROR                                      03160000
029700                 SET DP030-CONTINUE-GO                            03170000
029800                                 TO TRUE                          03180000
029900                 PERFORM 2100-CHECK-FUNCTION-KEY                  03190000
030000             ELSE                                                 03200000
030100                 SET DP030-OVERRIDE-GO                            03210000
030200                                 TO TRUE                          03220000
030300             END-IF                                               03230000
030400     END-EVALUATE.                                                03240000
030500 EJECT                                                            03250000
030600******************************************************************03260000
030700** ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED     **03270000
030800** FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED **03280000
030900** FROM THE CICS ARCHITECTURE API.                              **03290000
031000******************************************************************03300000
031100                                                                  03310000
031200 2100-CHECK-FUNCTION-KEY.                                         03320000
031300                                                                  03330000
031400     EVALUATE TRUE                                                03340000
031500         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              03350000
031600             PERFORM 2110-PREPARE-INTER-APPL-COMM                 03360000
031700                                                                  03370000
031800         WHEN DP020-SRC-AID = DP016-ENTER                         03380000
031900             CONTINUE                                             03390000
032000                                                                  03400000
032100         WHEN OTHER                                               03410000
032200             SET DP013-NO-ROLLBACK                                03420000
032300                 DP013-XCTL-DISPLAY-RESTART                       03430000
032400                 DP013-CICS-ABEND                                 03440000
032500                                 TO TRUE                          03450000
032600             MOVE '2100-CHECK-FUNCTION-KEY'                       03460000
032700                                 TO DP013-PARAGRAPH               03470000
032800             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      03480000
032900                                 TO DP013-MESSAGE-TEXT (1)        03490000
033000             PERFORM DP013-0000-PROCESS-ABEND                     03500000
033100     END-EVALUATE.                                                03510000
033200 EJECT                                                            03520000
033300******************************************************************03530000
033400** MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE   **03540000
033500** INTER-APPLICATION COMMAREA.                                  **03550000
033600******************************************************************03560000
033700                                                                  03570000
033800 2110-PREPARE-INTER-APPL-COMM.                                    03580000
033900                                                                  03590000
034000*    INITIALIZE PO079-INTER-APPL-COMMAREA.                        03600000
034100                                                                  03610000
034200     MOVE ASC-SET-YEAR           TO PO079-SET-YEAR.               03620000
034300     MOVE ASC-SET-SHORT-NME      TO PO079-SET-SHORT-NME.          03630000
034400                                                                  03640000
034500*    IF PO NBR WAS ENTERED IGNORE ALL OTHER DATA                  03650000
034600     IF ASC-PO-NBR > ZEROS                                        03660000
034700         MOVE ASC-PO-NBR         TO PO079-PO-NBR                  03670000
034800         MOVE ZEROS              TO PO079-IMPRT-AGNT-PO-NBR       03680000
034900                                    PO079-STR-NBR                 03690000
035000         MOVE SPACES             TO PO079-DEPT-NBR                03700000
035100                                    PO079-STATUS-GRP              03710000
035200                                    PO079-STATUS-CDE              03720000
W24803                                    PO079-MAJ-CL-NBR              03730000
035300                                    PO079-CL-NBR                  03740000
035400                                    PO079-PO-TYP-CDE              03750000
W24803                                    PO079-SKU-NBR                 03760000
035600                                    PO079-ENT-NAME-DESC           03770000
035700                                    PO079-VEND-STYL-NME           03780000
035800                                    PO079-AD-EVNT-DTE             03790000
035900                                    PO079-AD-EVNT-DTE-ISO         03800000
036000                                    PO079-OTB-PER-NBR-BEG         03810000
036100                                    PO079-OTB-PER-NBR-END         03820000
036200                                    PO079-NEW-STR-IND             03830000
                                          PO079-DONT-SHIP-BEF-DTE       03840036
                                          PO079-CAN-IFNOT-SHIP-DTE      03850036
036300     ELSE                                                         03860000
036400         MOVE ASC-IMPRT-AGNT-PO-NBR                               03870000
036500                                 TO PO079-IMPRT-AGNT-PO-NBR       03880000
036600         MOVE ASC-DEPT-NBR       TO PO079-DEPT-NBR                03890000
036700         MOVE ASC-STATUS-GRP     TO PO079-STATUS-GRP              03900000
036800         MOVE ASC-STATUS-CDE     TO PO079-STATUS-CDE              03910000
W24803         MOVE ASC-MAJ-CL-NBR     TO PO079-MAJ-CL-NBR              03920000
W24803         MOVE ASC-SUB-CL-NBR     TO PO079-CL-NBR                  03930022
037000         MOVE ASC-PO-TYP-CDE     TO PO079-PO-TYP-CDE              03940000
W24803         MOVE ASC-SKU-NBR        TO PO079-SKU-NBR                 03950000
037200         MOVE ASC-STR-NBR-N      TO PO079-STR-NBR                 03960000
037300         MOVE ASC-ENT-NAME-DESC  TO PO079-ENT-NAME-DESC           03970000
037400         MOVE ASC-VEND-STYL-NME  TO PO079-VEND-STYL-NME           03980000
037500         MOVE ASC-AD-EVNT-DTE    TO PO079-AD-EVNT-DTE             03990000
037600         MOVE ASC-AD-EVNT-DTE-ISO                                 04000000
037700                                 TO PO079-AD-EVNT-DTE-ISO         04010000
037800         MOVE ASC-OTB-PER-NBR-BEG(3:4)                            04020000
037900                                 TO PO079-OTB-PER-NBR-BEG         04030000
038000         MOVE ASC-OTB-PER-NBR-END(3:4)                            04040000
038100                                 TO PO079-OTB-PER-NBR-END         04050000
038200                                                                  04060000
038300         MOVE ASC-NEW-STORE-IND  TO PO079-NEW-STR-IND             04070000
               MOVE ASC-SHIP-BEG       TO PO079-DONT-SHIP-BEF-DTE       04080032
               MOVE ASC-SHIP-END       TO PO079-CAN-IFNOT-SHIP-DTE      04090030
038400     END-IF.                                                      04100032
038500                                                                  04110000
038600 EJECT                                                            04120000
038700*----------------------------------------------------------------*04130000
038800* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS IN*04140000
038900* THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN THE  *04150000
039000* APPLICATION-SPECIFIC COMMAREA, NOT ON THE SCREEN.              *04160000
039100*----------------------------------------------------------------*04170000
039200                                                                  04180000
039300 2200-MOVE-SCREEN-TO-COMMAREA.                                    04190000
039400                                                                  04200000
039500     IF  APONUML > ZERO                                           04210000
039600         MOVE APONUMI              TO ASC-PO-NBR                  04220000
039700     ELSE                                                         04230000
039800         IF  APONUMF = DP015-ERASE-EOF                            04240000
039900             MOVE SPACE            TO ASC-PO-NBR                  04250000
040000         END-IF                                                   04260000
040100     END-IF.                                                      04270000
040200                                                                  04280000
040300     IF  ADEPTL > ZERO                                            04290000
040400         MOVE ADEPTI               TO ASC-DEPT-NBR                04300000
040500     ELSE                                                         04310000
040600         IF  ADEPTF = DP015-ERASE-EOF                             04320000
040700             MOVE SPACE            TO ASC-DEPT-NBR                04330000
040800         END-IF                                                   04340000
040900     END-IF.                                                      04350000
041000                                                                  04360000
041100     IF  ASTGRPL > ZERO                                           04370000
041200         MOVE ASTGRPI              TO ASC-STATUS-GRP              04380000
041300     ELSE                                                         04390000
041400         IF  ASTGRPF = DP015-ERASE-EOF                            04400000
041500             MOVE SPACE            TO ASC-STATUS-GRP              04410000
041600         END-IF                                                   04420000
041700     END-IF.                                                      04430000
041800                                                                  04440000
041900     IF  ASC1L > ZERO                                             04450000
042000         MOVE ASC1I                TO ASC-STATUS-CDE              04460000
042100     ELSE                                                         04470000
042200         IF  ASC1F = DP015-ERASE-EOF                              04480000
042300             MOVE SPACE            TO ASC-STATUS-CDE              04490000
042400         END-IF                                                   04500000
042500     END-IF.                                                      04510000
042600                                                                  04520000
W24803     IF  AMCLL > ZERO                                             04530000
W24803           MOVE AMCLI                 TO ASC-MAJ-CL-NBR           04540000
W24803       ELSE                                                       04550000
W24803           IF  AMCLF = DP015-ERASE-EOF                            04560000
W24803               MOVE SPACE             TO ASC-MAJ-CL-NBR           04570000
W24803           END-IF                                                 04580000
W24803      END-IF.                                                     04590000
W24803                                                                  04600000
042700     IF  ACLASSL > ZERO                                           04610000
W24803         MOVE ACLASSI               TO ASC-SUB-CL-NBR             04620023
042900     ELSE                                                         04630000
043000         IF  ACLASSF = DP015-ERASE-EOF                            04640000
W24803             MOVE SPACE             TO ASC-SUB-CL-NBR             04650023
043200         END-IF                                                   04660000
043300     END-IF.                                                      04670000
043400                                                                  04680000
043500     IF  APOTYPEL > ZERO                                          04690000
043600         MOVE APOTYPEI             TO ASC-PO-TYP-CDE              04700000
043700     ELSE                                                         04710000
043800         IF  APOTYPEF = DP015-ERASE-EOF                           04720000
043900             MOVE SPACE            TO ASC-PO-TYP-CDE              04730000
044000         END-IF                                                   04740000
044100     END-IF.                                                      04750000
044200                                                                  04760000
044300     IF ASKUL > ZERO                                              04770000
W24803         MOVE ASKUI                TO ASC-SKU-NBR                 04780000
044500     ELSE                                                         04790000
044600         IF ASKUF = DP015-ERASE-EOF                               04800000
W24803             MOVE SPACE            TO ASC-SKU-NBR                 04810000
044800         END-IF                                                   04820000
044900     END-IF.                                                      04830000
045000                                                                  04840000
045100     IF ASTOREL > ZERO                                            04850000
045200         MOVE ASTOREI              TO ASC-STR-NBR                 04860000
045300     ELSE                                                         04870000
045400         IF ASTOREF = DP015-ERASE-EOF                             04880000
045500             MOVE SPACE            TO ASC-STR-NBR                 04890000
045600         END-IF                                                   04900000
045700     END-IF.                                                      04910000
045800                                                                  04920000
045900     IF  AIPONUML > ZERO                                          04930000
046000         MOVE AIPONUMI             TO ASC-IMPRT-AGNT-PO-NBR       04940000
046100     ELSE                                                         04950000
046200         IF  AIPONUMF = DP015-ERASE-EOF                           04960000
046300             MOVE SPACE            TO ASC-IMPRT-AGNT-PO-NBR       04970000
046400         END-IF                                                   04980000
046500     END-IF.                                                      04990000
046600                                                                  05000000
046700     IF AVENDNML > ZERO                                           05010000
046800         MOVE AVENDNMI             TO ASC-ENT-NAME-DESC           05020000
046900     ELSE                                                         05030000
047000         IF AVENDNMF = DP015-ERASE-EOF                            05040000
047100             MOVE SPACE            TO ASC-ENT-NAME-DESC           05050000
047200         END-IF                                                   05060000
047300     END-IF.                                                      05070000
047400                                                                  05080000
047500     IF ASTYLEL > ZERO                                            05090000
047600         MOVE ASTYLEI              TO ASC-VEND-STYL-NME           05100000
047700     ELSE                                                         05110000
047800         IF ASTYLEF = DP015-ERASE-EOF                             05120000
047900             MOVE SPACE            TO ASC-VEND-STYL-NME           05130000
048000         END-IF                                                   05140000
048100     END-IF.                                                      05150000
048200                                                                  05160000
048300     IF ADDATEL > ZERO                                            05170000
048400         MOVE ADDATEI              TO ASC-AD-EVNT-DTE             05180000
048500     ELSE                                                         05190000
048600         IF ADDATEF = DP015-ERASE-EOF                             05200000
048700             MOVE SPACE            TO ASC-AD-EVNT-DTE             05210000
048800                                      ASC-AD-EVNT-DTE-ISO         05220000
048900         END-IF                                                   05230000
049000     END-IF.                                                      05240000
049100                                                                  05250000
049200     IF AOTBBEGL > ZERO                                           05260000
049300         IF AOTBBEGI(3:2) > 80                                    05270000
049400            MOVE '19' TO ASC-OTB-PER-NBR-BEG(1:2)                 05280000
049500         ELSE                                                     05290000
049600            MOVE '20' TO ASC-OTB-PER-NBR-BEG(1:2)                 05300000
049700         END-IF                                                   05310000
049800         MOVE AOTBBEGI(3:2) TO ASC-OTB-PER-NBR-BEG(3:2)           05320000
049900         MOVE AOTBBEGI(1:2) TO ASC-OTB-PER-NBR-BEG(5:2)           05330000
050000     ELSE                                                         05340000
050100         IF AOTBBEGF = DP015-ERASE-EOF                            05350000
050200             MOVE SPACE            TO ASC-OTB-PER-NBR-BEG         05360000
050300         END-IF                                                   05370000
050400     END-IF.                                                      05380000
050500                                                                  05390000
050600     IF AOTBENDL > ZERO                                           05400000
050700         IF AOTBENDI(3:2) > 80                                    05410000
050800            MOVE '19' TO ASC-OTB-PER-NBR-END(1:2)                 05420000
050900         ELSE                                                     05430000
051000            MOVE '20' TO ASC-OTB-PER-NBR-END(1:2)                 05440000
051100         END-IF                                                   05450000
051200         MOVE AOTBENDI(3:2) TO ASC-OTB-PER-NBR-END(3:2)           05460000
051300         MOVE AOTBENDI(1:2) TO ASC-OTB-PER-NBR-END(5:2)           05470000
051400     ELSE                                                         05480000
051500         IF AOTBENDF = DP015-ERASE-EOF                            05490000
051600             MOVE SPACE            TO ASC-OTB-PER-NBR-END         05500000
051700         END-IF                                                   05510000
051800     END-IF.                                                      05520000
051900                                                                  05530000
052000     IF ANEWSTRL > ZERO                                           05540000
052100         MOVE ANEWSTRI             TO ASC-NEW-STORE-IND           05550000
052200     ELSE                                                         05560000
052300         IF ANEWSTRF = DP015-ERASE-EOF                            05570000
052400             MOVE SPACE            TO ASC-NEW-STORE-IND           05580000
052500         END-IF                                                   05590000
052600     END-IF.                                                      05600000
052700                                                                  05610033
           IF ASHPBEGL > ZERO                                           05620030
               IF ASHPBEGI(5:2) > 80                                    05630030
                  MOVE '19' TO ASC-SHIP-BEG(1:2)                        05640030
               ELSE                                                     05650030
                  MOVE '20' TO ASC-SHIP-BEG(1:2)                        05660030
               END-IF                                                   05670030
               MOVE ASHPBEGI(3:2) TO ASC-SHIP-BEG(9:2)                  05680030
               MOVE ASHPBEGI(1:2) TO ASC-SHIP-BEG(6:2)                  05690030
               MOVE ASHPBEGI(5:2) TO ASC-SHIP-BEG(3:2)                  05700031
               MOVE '-'           TO ASC-SHIP-BEG(5:1)                  05710035
               MOVE '-'           TO ASC-SHIP-BEG(8:1)                  05720035
           ELSE                                                         05730031
               IF ASHPBEGF = DP015-ERASE-EOF                            05740031
                   MOVE SPACE            TO ASC-SHIP-BEG                05750031
               END-IF                                                   05760031
           END-IF.                                                      05770031
                                                                        05780031
           IF ASHPENDL > ZERO                                           05790031
               IF ASHPENDI(5:2) > 80                                    05800030
                  MOVE '19' TO ASC-SHIP-END(1:2)                        05810030
               ELSE                                                     05820030
                  MOVE '20' TO ASC-SHIP-END(1:2)                        05830030
               END-IF                                                   05840030
               MOVE ASHPENDI(3:2) TO ASC-SHIP-END(9:2)                  05850030
               MOVE ASHPENDI(1:2) TO ASC-SHIP-END(6:2)                  05860030
               MOVE ASHPENDI(5:2) TO ASC-SHIP-END(3:2)                  05870031
               MOVE '-'           TO ASC-SHIP-END(5:1)                  05880035
               MOVE '-'           TO ASC-SHIP-END(8:1)                  05890035
           ELSE                                                         05900030
               IF ASHPENDF = DP015-ERASE-EOF                            05910030
                   MOVE SPACE            TO ASC-SHIP-END                05920030
               END-IF                                                   05930030
           END-IF.                                                      05940030
                                                                        05950030
052800 EJECT                                                            05960000
052900*----------------------------------------------------------------*05970000
053000* ENSURE THE DATA IS CORRECT.  NOTE THAT IN A CRITERIA SPECIFI-  *05980000
053100* CATION SCREEN ONLY MINIMAL EDITS ARE DONE.  EDITS RELATED TO   *05990000
053200* A SPECIFIC SCREEN THAT THE USER IS GOING TO (LOCAL-GO) ARE DONE*06000000
053300* IN THE DESTINATION PROGRAM, NOT HERE.                          *06010000
053400*----------------------------------------------------------------*06020000
053500                                                                  06030000
053600 3000-EDIT-DATA-IN-COMMAREA.                                      06040000
053700                                                                  06050000
053800     PERFORM 3100-RESET-ATTRIBUTES.                               06060000
053900                                                                  06070000
054000     IF  ASC-IMPRT-AGNT-PO-NBR > SPACES                           06080000
054100         MOVE ASC-IMPRT-AGNT-PO-NBR                               06090000
054200                                   TO DP010I-UNEDITED-FIELD       06100000
054300         MOVE LENGTH OF ASC-IMPRT-AGNT-PO-NBR                     06110000
054400                                   TO DP010I-MAXIMUM-DIGITS       06120000
054500         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     06130000
054600         SET DP010I-NEGATIVE-NOT-ALLOWED                          06140000
054700                                   TO TRUE                        06150000
264220         CALL DP010I-NUMERIC-EDIT-ROUTINE                         06161046
264230                         USING DP010I-NUMERIC-EDIT-AREA           06162046
054900         IF  DP010I-ERROR-DETECTED                                06170000
055000             SET PS-ERROR                                         06180000
055100                 DP020-MSG-FATAL   TO TRUE                        06190000
055200             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            06200000
055300             MOVE DP015-UNP-ALP-BRT-OFF                           06210000
055400                                   TO AIPONUMA                    06220000
055500             MOVE DP015-RED        TO AIPONUMC                    06230000
055600             MOVE DP015-REVERSE    TO AIPONUMH                    06240000
055700             MOVE -1               TO AIPONUML                    06250000
055800             SET DP030-SET-CURSOR-APPL-1                          06260000
055900                                   TO TRUE                        06270000
056000         ELSE                                                     06280000
056100             MOVE DP010I-NUMERIC-FIELD                            06290000
056200                                   TO ASC-IMPRT-AGNT-PO-NBR-N     06300000
056300         END-IF                                                   06310000
056400     END-IF.                                                      06320000
056500                                                                  06330000
056600     IF  ASC-NEW-STORE-IND > SPACES                               06340000
056700         IF  ASC-NEW-STORE-IND = 'Y' OR 'N'                       06350000
056800             CONTINUE                                             06360000
056900         ELSE                                                     06370000
057000             SET PS-ERROR          TO TRUE                        06380000
057100             SET DP020-MSG-FATAL   TO TRUE                        06390000
057200             MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            06400000
057300             MOVE DP015-UNP-ALP-BRT-OFF                           06410000
057400                                   TO ANEWSTRA                    06420000
057500             MOVE DP015-RED        TO ANEWSTRC                    06430000
057600             MOVE DP015-REVERSE    TO ANEWSTRH                    06440000
057700             MOVE -1               TO ANEWSTRL                    06450000
057800             SET DP030-SET-CURSOR-APPL-1                          06460000
057900                                   TO TRUE                        06470000
058000         END-IF                                                   06480000
058100     END-IF.                                                      06490000
058200                                                                  06500030
           IF  ASC-SHIP-END > SPACES                                    06510030
               INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56           06520032
               MOVE ASC-SHIP-END               TO  DPG52-LK-DATE-INPUT  06530032
               SET  DPG51-ACTUAL-CALENDAR-ONLY                          06540032
                    DPG52-LK-DTE-ISO-FMT       TO TRUE                  06550032
                                                                        06560032
               CALL DP500-KOHLS-CALENDAR-ROUTINE USING                  06570032
                     DPG51 DPG52 DPG53 DPG54 DPG55 DPG56                06580032
               IF NOT DPG54-NO-ERROR                                    06590032
                   SET PS-ERROR                                         06600030
                       DP020-MSG-FATAL                                  06610030
                       DP030-SET-CURSOR-APPL-1 TO TRUE                  06620030
                   MOVE PC-TSYMSG-00009        TO DP020-MSG-NUMBER      06630032
                   MOVE -1                     TO ASHPENDL              06640030
                   MOVE DP015-UNP-ALP-BRT-MDT  TO ASHPENDA              06650030
                   MOVE DP015-RED              TO ASHPENDC              06660030
                   MOVE DP015-REVERSE          TO ASHPENDH              06670030
               END-IF                                                   06680030
           END-IF.                                                      06690030
                                                                        06700030
           IF  ASC-SHIP-BEG > SPACES                                    06710032
               INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56           06720032
               MOVE ASC-SHIP-BEG               TO  DPG52-LK-DATE-INPUT  06730032
               SET  DPG51-ACTUAL-CALENDAR-ONLY                          06740032
                    DPG52-LK-DTE-ISO-FMT       TO TRUE                  06750032
                                                                        06760032
               CALL DP500-KOHLS-CALENDAR-ROUTINE USING                  06770032
                     DPG51 DPG52 DPG53 DPG54 DPG55 DPG56                06780032
               IF NOT DPG54-NO-ERROR                                    06790032
                   SET PS-ERROR                                         06800032
                       DP020-MSG-FATAL                                  06810032
                       DP030-SET-CURSOR-APPL-1 TO TRUE                  06820032
                   MOVE PC-TSYMSG-00009        TO DP020-MSG-NUMBER      06830032
                   MOVE -1                     TO ASHPBEGL              06840032
                   MOVE DP015-UNP-ALP-BRT-MDT  TO ASHPBEGA              06850032
                   MOVE DP015-RED              TO ASHPBEGC              06860032
                   MOVE DP015-REVERSE          TO ASHPBEGH              06870032
               END-IF                                                   06880032
           END-IF.                                                      06890032
                                                                        06900030
           IF   ASC-SHIP-BEG > SPACES                                   06910032
            AND ASC-SHIP-END > SPACES                                   06920037
            AND PS-NO-ERROR                                             06930032
               INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56           06940032
               MOVE ASC-SHIP-END           TO  DPG52-LK-DATE-INPUT      06950041
               MOVE ASC-SHIP-BEG           TO  DPG53-LK-CMPR-DATE-INPUT 06960041
               SET  DPG51-ACTUAL-CALENDAR-ONLY                          06970032
                    DPG51-DO-NOT-INCR-DECR-DATE                         06980040
                    DPG52-LK-DTE-ISO-FMT                                06990040
                    DPG53-LK-CMPR-DTE-ISO-FMT  TO TRUE                  07000040
                                                                        07010032
               CALL DP500-KOHLS-CALENDAR-ROUTINE USING                  07020032
                     DPG51 DPG52 DPG53 DPG54 DPG55 DPG56                07030032
               IF DPG54-NO-ERROR                                        07040038
                   IF DPG55-DAYS-DIFFERENCE IS NEGATIVE                 07050032
                       SET PS-ERROR                                     07060032
                           DP020-MSG-FATAL                              07070032
                           DP030-SET-CURSOR-APPL-1 TO TRUE              07080032
                       MOVE PC-TSYMSG-03445      TO DP020-MSG-NUMBER    07090032
                       MOVE DP015-UNP-ALP-BRT-OFF                       07100032
                                                 TO ASHPENDA            07110032
                       MOVE DP015-RED            TO ASHPENDC            07120032
                       MOVE DP015-REVERSE        TO ASHPENDH            07130032
                       MOVE -1                   TO ASHPENDL            07140032
                   ELSE                                                 07150032
                       IF DPG55-DAYS-DIFFERENCE > 15                    07160032
                           SET PS-ERROR                                 07170032
                               DP020-MSG-FATAL                          07180032
                               DP030-SET-CURSOR-APPL-1 TO TRUE          07190032
                           MOVE PC-TSYMSG-03488      TO DP020-MSG-NUMBER07200032
                           MOVE DP015-UNP-ALP-BRT-OFF                   07210032
                                                     TO ASHPENDA        07220032
                           MOVE DP015-RED            TO ASHPENDC        07230032
                           MOVE DP015-REVERSE        TO ASHPENDH        07240032
                           MOVE -1                   TO ASHPENDL        07250032
                   END-IF                                               07260032
               END-IF                                                   07270032
           END-IF.                                                      07280032
                                                                        07290032
058300     IF  ASC-OTB-PER-NBR-END > SPACES                             07300000
058400         IF  ASC-OTB-PER-NBR-END(5:2) < '01'                      07310000
058500         OR  ASC-OTB-PER-NBR-END(5:2) > '12'                      07320000
058600             SET PS-ERROR                                         07330000
058700                 DP020-MSG-FATAL                                  07340000
058800                 DP030-SET-CURSOR-APPL-1 TO TRUE                  07350000
058900             MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER      07360000
059000             MOVE -1                     TO AOTBENDL              07370000
059100             MOVE DP015-UNP-ALP-BRT-MDT  TO AOTBENDA              07380000
059200             MOVE DP015-RED              TO AOTBENDC              07390000
059300             MOVE DP015-REVERSE          TO AOTBENDH              07400000
059400         END-IF                                                   07410000
059500     END-IF.                                                      07420000
059600                                                                  07430000
059700     IF  ASC-OTB-PER-NBR-BEG > SPACES                             07440000
059800         IF  ASC-OTB-PER-NBR-BEG(5:2) < '01'                      07450000
059900         OR  ASC-OTB-PER-NBR-BEG(5:2) > '12'                      07460000
060000             SET PS-ERROR                                         07470000
060100                 DP020-MSG-FATAL                                  07480000
060200                 DP030-SET-CURSOR-APPL-1 TO TRUE                  07490000
060300             MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER      07500000
060400             MOVE -1                     TO AOTBBEGL              07510000
060500             MOVE DP015-UNP-ALP-BRT-MDT  TO AOTBBEGA              07520000
060600             MOVE DP015-RED              TO AOTBBEGC              07530000
060700             MOVE DP015-REVERSE          TO AOTBBEGH              07540000
060800         END-IF                                                   07550000
060900     END-IF.                                                      07560000
061000                                                                  07570000
061100     IF  ASC-OTB-PER-NBR-BEG > SPACES                             07580000
061200     AND ASC-OTB-PER-NBR-END > SPACES                             07590000
061300         IF  ASC-OTB-PER-NBR-BEG-N > ASC-OTB-PER-NBR-END-N        07600000
061400             SET PS-ERROR                                         07610000
061500                 DP020-MSG-FATAL  TO TRUE                         07620000
061600             MOVE PC-TSYMSG-00143 TO DP020-MSG-NUMBER             07630000
061700             MOVE DP015-UNP-ALP-BRT-MDT                           07640000
061800                                  TO AOTBENDA                     07650000
061900             MOVE DP015-RED       TO AOTBENDC                     07660000
062000             MOVE DP015-REVERSE   TO AOTBENDH                     07670000
062100             MOVE -1              TO AOTBENDL                     07680000
062200             SET DP030-SET-CURSOR-APPL-1                          07690000
062300                                  TO TRUE                         07700000
062400         END-IF                                                   07710000
062500     END-IF.                                                      07720000
062600                                                                  07730000
062700     IF ASC-AD-EVNT-DTE > SPACES                                  07740000
062800        INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56            07750000
062900        SET DPG51-ACTUAL-CALENDAR-ONLY                            07760000
063000                                 TO TRUE                          07770000
063100        SET DPG51-DO-NOT-INCR-DECR-DATE                           07780000
063200                                 TO TRUE                          07790000
063300        MOVE ZERO                TO TALLY                         07800000
063400        INSPECT ASC-AD-EVNT-DTE                                   07810000
063500                TALLYING TALLY FOR ALL '/'                        07820000
063600        IF TALLY > 1                                              07830000
063700*               'MM/DD/YY'                                        07840000
063800           SET DPG52-LK-DTE-GREG-CC-FMT                           07850000
063900                                  TO TRUE                         07860000
064000           IF ASC-AD-EVNT-DTE(7:2) > 80                           07870000
064100              MOVE '19' TO PV-AD-DATE(7:2)                        07880000
064200           ELSE                                                   07890000
064300              MOVE '20' TO PV-AD-DATE(7:2)                        07900000
064400           END-IF                                                 07910000
064500           MOVE ASC-AD-EVNT-DTE(1:6) TO PV-AD-DATE(1:6)           07920000
064600           MOVE ASC-AD-EVNT-DTE(7:2) TO PV-AD-DATE(9:2)           07930000
064700        ELSE                                                      07940000
064800*               'MMDDYY  '                                        07950000
064900           IF ASC-AD-EVNT-DTE(7:2) <= SPACES                      07960000
065000               SET DPG52-LK-DTE-GREG-CC TO TRUE                   07970000
065100               IF ASC-AD-EVNT-DTE(5:2) > 80                       07980000
065200                  MOVE '19' TO PV-AD-DATE(5:2)                    07990000
065300               ELSE                                               08000000
065400                  MOVE '20' TO PV-AD-DATE(5:2)                    08010000
065500               END-IF                                             08020000
065600               MOVE ASC-AD-EVNT-DTE(1:2) TO PV-AD-DATE(1:2)       08030000
065700               MOVE ASC-AD-EVNT-DTE(3:2) TO PV-AD-DATE(3:2)       08040000
065800               MOVE ASC-AD-EVNT-DTE(5:2) TO PV-AD-DATE(7:2)       08050000
065900               MOVE SPACES               TO PV-AD-DATE(9:2)       08060000
066000           ELSE                                                   08070000
066100*               'MMDDCCYY'                                        08080000
066200               MOVE ASC-AD-EVNT-DTE(1:8) TO PV-AD-DATE(1:8)       08090000
066300               MOVE SPACES               TO PV-AD-DATE(9:2)       08100000
066400           END-IF                                                 08110000
066500        END-IF                                                    08120000
066600        MOVE PV-AD-DATE           TO DPG52-LK-DATE-INPUT          08130000
066700        CALL DP500-KOHLS-CALENDAR-ROUTINE USING                   08140000
066800                   DPG51 DPG52 DPG53 DPG54 DPG55 DPG56            08150000
066900        IF (DPG54-WARNING-ERROR                                   08160000
067000        OR  DPG54-SEVERE-ERROR)                                   08170000
067100            SET PS-ERROR                                          08180000
067200                DP020-MSG-FATAL   TO TRUE                         08190000
067300*        ---- INVALID DATE ----                                   08200000
067400            MOVE PC-TSYMSG-00009  TO DP020-MSG-NUMBER             08210000
067500            MOVE DP015-UNP-ALP-BRT-MDT                            08220000
067600                                  TO ADDATEA                      08230000
067700            MOVE DP015-RED        TO ADDATEC                      08240000
067800            MOVE DP015-REVERSE    TO ADDATEH                      08250000
067900            MOVE -1               TO ADDATEL                      08260000
068000            SET DP030-SET-CURSOR-APPL-1                           08270000
068100                                  TO TRUE                         08280000
068200        ELSE                                                      08290000
068300            MOVE DPG55-GREG-DATE-FMT                              08300000
068400                                  TO ASC-AD-EVNT-DTE              08310000
068500            MOVE DPG55-DB2-ISO-DATE-FMT                           08320000
068600                                  TO ASC-AD-EVNT-DTE-ISO          08330000
068700        END-IF                                                    08340000
068800     END-IF.                                                      08350000
068900                                                                  08360000
069000     IF  ASC-STR-NBR > SPACES                                     08370000
069100         MOVE ASC-STR-NBR          TO DP010I-UNEDITED-FIELD       08380000
069200         MOVE LENGTH OF ASC-STR-NBR                               08390000
069300                                   TO DP010I-MAXIMUM-DIGITS       08400000
069400         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     08410000
069500         SET DP010I-NEGATIVE-NOT-ALLOWED                          08420000
069600                                   TO TRUE                        08430000
264220         CALL DP010I-NUMERIC-EDIT-ROUTINE                         08441046
264230                         USING DP010I-NUMERIC-EDIT-AREA           08442046
069800         IF  DP010I-ERROR-DETECTED                                08450000
069900             SET PS-ERROR                                         08460000
070000                 DP020-MSG-FATAL   TO TRUE                        08470000
070100             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            08480000
070200             MOVE DP015-UNP-ALP-BRT-OFF                           08490000
070300                                   TO ASTOREA                     08500000
070400             MOVE DP015-RED        TO ASTOREC                     08510000
070500             MOVE DP015-REVERSE    TO ASTOREH                     08520000
070600             MOVE -1               TO ASTOREL                     08530000
070700             SET DP030-SET-CURSOR-APPL-1                          08540000
070800                                   TO TRUE                        08550000
070900         ELSE                                                     08560000
071000             MOVE DP010I-NUMERIC-FIELD                            08570000
071100                                   TO ASC-STR-NBR-N               08580000
071200         END-IF                                                   08590000
071300     END-IF.                                                      08600000
071400                                                                  08610000
071500     IF  ASC-STATUS-GRP > SPACES                                  08620000
071600         IF ASC-STATUS-GRP = 'WKS' OR 'ACT' OR 'CMP' OR 'BTH'     08630000
071700             CONTINUE                                             08640000
071800         ELSE                                                     08650000
071900             SET PS-ERROR          TO TRUE                        08660000
072000             SET DP020-MSG-FATAL   TO TRUE                        08670000
072100             MOVE PC-TSYMSG-00639  TO DP020-MSG-NUMBER            08680000
072200             MOVE DP015-UNP-ALP-BRT-OFF                           08690000
072300                                   TO ASTGRPA                     08700000
072400             MOVE DP015-RED        TO ASTGRPC                     08710000
072500             MOVE DP015-REVERSE    TO ASTGRPH                     08720000
072600             MOVE -1               TO ASTGRPL                     08730000
072700             SET DP030-SET-CURSOR-APPL-1                          08740000
072800                                   TO TRUE                        08750000
072900         END-IF                                                   08760000
073000     END-IF.                                                      08770000
073100                                                                  08780000
073200     IF  ASC-STATUS-GRP > SPACES                                  08790000
073300         IF ASC-STATUS-CDE > SPACES                               08800000
073400             SET PS-ERROR          TO TRUE                        08810000
073500             SET DP020-MSG-FATAL   TO TRUE                        08820000
073600             MOVE PC-TSYMSG-00640  TO DP020-MSG-NUMBER            08830000
073700             MOVE DP015-UNP-ALP-BRT-OFF                           08840000
073800                                   TO ASC1A                       08850000
073900             MOVE DP015-RED        TO ASC1C                       08860000
074000             MOVE DP015-REVERSE    TO ASC1H                       08870000
074100             MOVE -1               TO ASC1L                       08880000
074200             SET DP030-SET-CURSOR-APPL-1                          08890000
074300                                   TO TRUE                        08900000
074400         END-IF                                                   08910000
074500     END-IF.                                                      08920000
074600                                                                  08930000
W24803     IF  ASC-SKU-NBR > SPACES                                     08940000
W24803         MOVE ASC-SKU-NBR          TO DP010I-UNEDITED-FIELD       08950000
W24803         MOVE LENGTH OF ASC-SKU-NBR                               08960000
075000                                   TO DP010I-MAXIMUM-DIGITS       08970000
075100         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     08980000
075200         SET DP010I-NEGATIVE-NOT-ALLOWED                          08990000
075300                                   TO TRUE                        09000000
264220         CALL DP010I-NUMERIC-EDIT-ROUTINE                         09011046
264230                         USING DP010I-NUMERIC-EDIT-AREA           09012046
075500         IF  DP010I-ERROR-DETECTED                                09020000
075600             SET PS-ERROR                                         09030000
075700                 DP020-MSG-FATAL   TO TRUE                        09040000
075800             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            09050000
075900             MOVE DP015-UNP-ALP-BRT-OFF                           09060000
076000                                   TO ASKUA                       09070000
076100             MOVE DP015-RED        TO ASKUC                       09080000
076200             MOVE DP015-REVERSE    TO ASKUH                       09090000
076300             MOVE -1               TO ASKUL                       09100000
076400             SET DP030-SET-CURSOR-APPL-1                          09110000
076500                                   TO TRUE                        09120000
076600         ELSE                                                     09130000
076700             MOVE DP010I-NUMERIC-FIELD                            09140000
W24803                                   TO ASC-SKU-NBR-N               09150000
076900         END-IF                                                   09160000
077000     END-IF.                                                      09170000
077100                                                                  09180000
W24803     IF  ASC-MAJ-CL-NBR > SPACES                                  09190000
W24803              MOVE ASC-MAJ-CL-NBR       TO DP010I-UNEDITED-FIELD  09200000
W24803              MOVE LENGTH OF ASC-MAJ-CL-NBR                       09210023
W24803                                        TO   DP010I-MAXIMUM-DIGITS09220023
W24803              MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS09230000
W24803              SET DP010I-NEGATIVE-NOT-ALLOWED                     09240000
W24803                                        TO TRUE                   09250000
264220              CALL DP010I-NUMERIC-EDIT-ROUTINE                    09261046
264230                         USING DP010I-NUMERIC-EDIT-AREA           09262046
W24803              IF  DP010I-ERROR-DETECTED                           09270000
W24803                  SET PS-ERROR                                    09280000
W24803                      DP020-MSG-FATAL   TO TRUE                   09290000
W24803                  MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER       09300000
W24803                  MOVE DP015-UNP-ALP-BRT-OFF                      09310000
W24803                                        TO AMCLA                  09320000
W24803               MOVE DP015-RED           TO AMCLC                  09330000
W24803               MOVE DP015-REVERSE       TO AMCLH                  09340000
W24803               MOVE -1                  TO AMCLL                  09350000
W24803               SET DP030-SET-CURSOR-APPL-1                        09360000
W24803                                        TO TRUE                   09370000
W24803           END-IF                                                 09380000
W24803       END-IF.                                                    09390000
W24803     IF  ASC-SUB-CL-NBR > SPACES                                  09400023
W24803         MOVE ASC-SUB-CL-NBR       TO DP010I-UNEDITED-FIELD       09410023
W24803         MOVE LENGTH OF ASC-SUB-CL-NBR                            09420023
W24803                                   TO DP010I-MAXIMUM-DIGITS       09430023
077500         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     09440000
077600         SET DP010I-NEGATIVE-NOT-ALLOWED                          09450000
077700                                   TO TRUE                        09460000
264220         CALL DP010I-NUMERIC-EDIT-ROUTINE                         09471046
264230                         USING DP010I-NUMERIC-EDIT-AREA           09472046
077900         IF  DP010I-ERROR-DETECTED                                09480000
078000             SET PS-ERROR                                         09490000
078100                 DP020-MSG-FATAL   TO TRUE                        09500000
078200             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            09510000
078300             MOVE DP015-UNP-ALP-BRT-OFF                           09520000
078400                                   TO ACLASSA                     09530000
078500             MOVE DP015-RED        TO ACLASSC                     09540000
078600             MOVE DP015-REVERSE    TO ACLASSH                     09550000
078700             MOVE -1               TO ACLASSL                     09560000
078800             SET DP030-SET-CURSOR-APPL-1                          09570000
078900                                   TO TRUE                        09580000
079000         END-IF                                                   09590000
079100     END-IF.                                                      09600000
079200                                                                  09610000
079300     IF  ASC-DEPT-NBR > SPACES                                    09620000
079400         MOVE ASC-DEPT-NBR         TO DP010I-UNEDITED-FIELD       09630000
079500         MOVE LENGTH OF ASC-DEPT-NBR                              09640000
079600                                   TO DP010I-MAXIMUM-DIGITS       09650000
079700         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     09660000
079800         SET DP010I-NEGATIVE-NOT-ALLOWED                          09670000
079900                                   TO TRUE                        09680000
264220         CALL DP010I-NUMERIC-EDIT-ROUTINE                         09691046
264230                         USING DP010I-NUMERIC-EDIT-AREA           09692046
080100         IF  DP010I-ERROR-DETECTED                                09700000
080200             SET PS-ERROR                                         09710000
080300                 DP020-MSG-FATAL   TO TRUE                        09720000
080400             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            09730000
080500             MOVE DP015-UNP-ALP-BRT-OFF                           09740000
080600                                   TO ADEPTA                      09750000
080700             MOVE DP015-RED        TO ADEPTC                      09760000
080800             MOVE DP015-REVERSE    TO ADEPTH                      09770000
080900             MOVE -1               TO ADEPTL                      09780000
081000             SET DP030-SET-CURSOR-APPL-1                          09790000
081100                                   TO TRUE                        09800000
081200         ELSE                                                     09810000
081300             MOVE DP010I-NUMERIC-FIELD                            09820000
081400                                   TO ASC-DEPT-NBR-N              09830000
081500         END-IF                                                   09840000
081600     END-IF.                                                      09850000
081700                                                                  09860000
081800     IF  ASC-PO-NBR > SPACES                                      09870000
081900         MOVE ASC-PO-NBR           TO DP010I-UNEDITED-FIELD       09880000
082000         MOVE LENGTH OF ASC-PO-NBR TO DP010I-MAXIMUM-DIGITS       09890000
082100         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     09900000
082200         SET DP010I-NEGATIVE-NOT-ALLOWED                          09910000
082300                                   TO TRUE                        09920000
264220         CALL DP010I-NUMERIC-EDIT-ROUTINE                         09931046
264230                         USING DP010I-NUMERIC-EDIT-AREA           09932046
082500         IF  DP010I-ERROR-DETECTED                                09940000
082600             SET PS-ERROR                                         09950000
082700                 DP020-MSG-FATAL   TO TRUE                        09960000
082800             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            09970000
082900             MOVE DP015-UNP-ALP-BRT-OFF                           09980000
083000                                   TO APONUMA                     09990000
083100             MOVE DP015-RED        TO APONUMC                     10000000
083200             MOVE DP015-REVERSE    TO APONUMH                     10010000
083300             MOVE -1               TO APONUML                     10020000
083400             SET DP030-SET-CURSOR-APPL-1                          10030000
083500                                   TO TRUE                        10040000
083600         ELSE                                                     10050000
083700             MOVE DP010I-NUMERIC-FIELD                            10060000
083800                                   TO ASC-PO-NBR-N                10070000
083900         END-IF                                                   10080000
084000     END-IF.                                                      10090000
084100                                                                  10100000
084200     IF  PS-NO-ERROR                                              10110000
084300         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     10120000
084400         MOVE -1                 TO APONUML                       10130000
084500         SET DP030-SET-CURSOR-APPL-1                              10140000
084600                                 TO TRUE                          10150000
084700     END-IF.                                                      10160000
084800 EJECT                                                            10170000
084900*----------------------------------------------------------------*10180000
085000*  MOVE THE DEFAULT ATTRIBUTES TO ALL OF THE OPEN FIELDS ON THE  *10190000
085100*  MAP.                                                          *10200000
085200*----------------------------------------------------------------*10210000
085300                                                                  10220000
085400 3100-RESET-ATTRIBUTES.                                           10230000
085500                                                                  10240000
085600     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTGRPA                     10250000
085700                                      ASC1A                       10260000
085800                                      APOTYPEA                    10270000
085900                                      ASKUA                       10280000
086000                                      ASTOREA                     10290000
086100                                      AVENDNMA                    10300000
086200                                      ASTYLEA                     10310000
086300                                      ADDATEA                     10320000
086400                                      APONUMA                     10330000
086500                                      AIPONUMA                    10340000
086600                                      ADEPTA                      10350000
W24803                                      AMCLA                       10360000
086700                                      ACLASSA                     10370000
086800                                      AOTBBEGA                    10380000
086900                                      AOTBENDA                    10390000
                                            ASHPBEGA                    10400036
                                            ASHPENDA                    10410036
087000                                      ANEWSTRA.                   10420000
087100                                                                  10430000
087200     MOVE DP015-GREEN              TO APONUMC                     10440000
087300                                      AIPONUMC                    10450000
087400                                      ADEPTC                      10460000
087500                                      ASTGRPC                     10470000
087600                                      ASC1C                       10480000
W24803                                      AMCLC                       10490000
087700                                      ACLASSC                     10500000
087800                                      APOTYPEC                    10510000
087900                                      ASKUC                       10520000
088000                                      ASTOREC                     10530000
088100                                      AVENDNMC                    10540000
088200                                      ASTYLEC                     10550000
088300                                      ADDATEC                     10560000
088400                                      AOTBBEGC                    10570000
088500                                      AOTBENDC                    10580000
                                            ASHPBEGC                    10590036
                                            ASHPENDC                    10600036
088600                                      ANEWSTRC.                   10610000
088700                                                                  10620000
088800     MOVE DP015-UNDERLINE          TO APONUMH                     10630000
088900                                      AIPONUMH                    10640000
089000                                      ADEPTH                      10650000
089100                                      ASTGRPH                     10660000
089200                                      ASC1H                       10670000
W24803                                      AMCLH                       10680000
089300                                      ACLASSH                     10690000
089400                                      APOTYPEH                    10700000
089500                                      ASKUH                       10710000
089600                                      ASTOREH                     10720000
089700                                      AVENDNMH                    10730000
089800                                      ASTYLEH                     10740000
089900                                      ADDATEH                     10750000
090000                                      AOTBBEGH                    10760000
090100                                      AOTBENDH                    10770000
                                            ASHPBEGH                    10780036
                                            ASHPENDH                    10790036
090200                                      ANEWSTRH.                   10800000
090300 EJECT                                                            10810000
090400*----------------------------------------------------------------*10820000
090500*  POSITION THE CURSOR AT THE APPROPRIATE FIELD.                 *10830000
090600*  IF THERE IS ANY DATA TO MOVE TO THE SCREEN ON INITIAL, MOVE   *10840000
090700*  IT HERE.                                                      *10850000
090800*----------------------------------------------------------------*10860000
090900                                                                  10870000
091000 4000-BUILD-INITIAL-PANEL.                                        10880000
091100                                                                  10890000
091200     SET DP030-SET-CURSOR-APPL-1 TO TRUE                          10900000
091300     MOVE -1                     TO APONUML.                      10910000
091400     MOVE 'ACT'                  TO ASTGRPO                       10920000
091500                                    ASC-STATUS-GRP.               10930000
091600     MOVE ASC-SET-SHORT-NME      TO ASETNMEO.                     10940000
091700     MOVE ASC-SET-YEAR           TO ASETYRO.                      10950000
091800                                                                  10960000
091900 EJECT                                                            10970000
092000*----------------------------------------------------------------*10980000
092100*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *10990000
092200*----------------------------------------------------------------*11000000
092300                                                                  11010000
092400 4400-MOVE-COMMAREA-TO-SCREEN.                                    11020000
092500                                                                  11030000
092600     MOVE ASC-SET-SHORT-NME      TO ASETNMEO.                     11040000
092700     MOVE ASC-SET-YEAR           TO ASETYRO.                      11050000
092800     MOVE ASC-PO-NBR             TO APONUMO.                      11060000
092900     MOVE ASC-IMPRT-AGNT-PO-NBR  TO AIPONUMO.                     11070000
093000     MOVE ASC-DEPT-NBR           TO ADEPTO.                       11080000
093100     MOVE ASC-STATUS-GRP         TO ASTGRPO.                      11090000
093200     MOVE ASC-STATUS-CDE         TO ASC1O.                        11100000
W24803     MOVE ASC-MAJ-CL-NBR         TO AMCLO.                        11110000
W24803     MOVE ASC-SUB-CL-NBR         TO ACLASSO.                      11120023
093400     MOVE ASC-PO-TYP-CDE         TO APOTYPEO.                     11130000
093500*    MOVE ASC-PO-TYP-DESC        TO ADESCO.                       11140000
W24803     MOVE ASC-SKU-NBR            TO ASKUO.                        11150000
093700     MOVE ASC-STR-NBR            TO ASTOREO.                      11160000
093800     MOVE ASC-ENT-NAME-DESC      TO AVENDNMO.                     11170000
093900     MOVE ASC-VEND-STYL-NME      TO ASTYLEO.                      11180000
094000     MOVE ASC-AD-EVNT-DTE        TO ADDATEO.                      11190000
094100     STRING ASC-OTB-PER-NBR-BEG(5:2) DELIMITED BY SIZE            11200000
094200            ASC-OTB-PER-NBR-BEG(3:2) DELIMITED BY SIZE            11210000
094300                               INTO AOTBBEGO.                     11220000
094400     STRING ASC-OTB-PER-NBR-END(5:2) DELIMITED BY SIZE            11230000
094500            ASC-OTB-PER-NBR-END(3:2) DELIMITED BY SIZE            11240000
094600                               INTO AOTBENDO.                     11250000
094700                                                                  11260000
094800     MOVE ASC-NEW-STORE-IND      TO ANEWSTRO.                     11270000
           STRING ASC-SHIP-BEG(6:2) DELIMITED BY SIZE                   11280030
                  ASC-SHIP-BEG(9:2) DELIMITED BY SIZE                   11290030
                  ASC-SHIP-BEG(3:2) DELIMITED BY SIZE                   11300030
                                     INTO ASHPBEGO.                     11310030
           STRING ASC-SHIP-END(6:2) DELIMITED BY SIZE                   11320030
                  ASC-SHIP-END(9:2) DELIMITED BY SIZE                   11330030
                  ASC-SHIP-END(3:2) DELIMITED BY SIZE                   11340030
                                     INTO ASHPENDO.                     11350030
094900                                                                  11360000
095000 EJECT                                                            11370000
095100*----------------------------------------------------------------*11380000
095200*    ABEND PROCESSOR MODULE                                      *11390000
095300*----------------------------------------------------------------*11400000
095400     COPY DPPD013.                                                11410000
