000100*----------------------------------------------------------       00000100
000200 IDENTIFICATION DIVISION.                                         00000200
000300*----------------------------------------------------------       00000900
000400 PROGRAM-ID.    XSKRP029.                                         00001000
000500 AUTHOR.        JOSEPH MENYAH.                                    00001100
000600 DATE-WRITTEN.  OCTOBER , 2002.                                   00001200
000700                                                                  00001300
000800*----------------------------------------------------------       00001400
000900*            PRICE EXCLUSION EVENT INTEGRITY CHECK                00001500
001000*----------------------------------------------------------       00001600
001010* THIS PROGRAM WILL PERFORM THE NECESSARY BUSINESS EVENT          00002000
001020* INTEGRITY CHECK FOR THE PRICING BUSINESS EVENT.                 00003000
001124*                                                                 00004000
001125*----------------------------------------------------------       00005000
001126* HISTORY LOG:                                                    00006000
P11215*  11/22/2010     COGNIZANT     PBI000000011215                  *00006226
P11215*  - TO EXCLUDE THE RECORDS WHICH HAVE STAT-CDE = 'D'            *00006326
P11215*    MADE CHANGES TO SKIP THE RECORD WHICH HAVE STAT-CDE AS'D'   *00006426
P11215*    TO CLEAR THE ERRORS IN THE XS REPORT                        *00006526
001127*                                                                 00007000
001128*----------------------------------------------------------       00008000
001129* DATE:                                                           00009000
001130* WR/IR#:                                                         00010000
001131* PROGRAMMER:                                                     00020000
001140* DESCRIPTION:                                                    00030000
001150*                                                                 00040000
001160*----------------------------------------------------------       00050000
001170 ENVIRONMENT DIVISION.                                            00060000
001180*----------------------------------------------------------       00070000
001190 CONFIGURATION SECTION.                                           00080000
001200 SOURCE-COMPUTER. IBM-3090.                                       00090000
001300 OBJECT-COMPUTER. IBM-3090.                                       00100000
001400                                                                  00110000
001500 INPUT-OUTPUT SECTION.                                            00120000
001600                                                                  00130000
001700 FILE-CONTROL.                                                    00140000
004900     SELECT CONTROL-CARD                                          00150000
005000         ASSIGN TO INP00.                                         00151000
                                                                        00152000
004900     SELECT PROMO-EXTRACT-FILE                                    00153000
005000         ASSIGN TO INP01.                                         00154000
                                                                        00155000
004900     SELECT DOMAIN-EXTRACT-FILE                                   00156000
005000         ASSIGN TO INP02.                                         00157000
                                                                        00158000
                                                                        00159000
004900     SELECT ERROR-FILE                                            00160000
005000         ASSIGN TO OUT01.                                         00170000
                                                                        00180000
004900     SELECT REPORT-FILE                                           00190000
005000         ASSIGN TO RPT01.                                         00200000
                                                                        00201000
001900*----------------------------------------------------------       00202000
002000 DATA DIVISION.                                                   00203000
002100*----------------------------------------------------------       00204000
002200 FILE SECTION.                                                    00205000
002300                                                                  00206000
008000 FD  PROMO-EXTRACT-FILE                                           00207000
008100     RECORDING MODE IS F                                          00208000
008200     LABEL RECORDS ARE OMITTED                                    00209000
008300     RECORD CONTAINS 250 CHARACTERS                               00210000
008400     DATA RECORD IS PROMO-EVNT-RECORD.                            00220000
008500 01  PROMO-EVNT-REC              PIC X(250).                      00230000
008600                                                                  00240000
008000 FD  DOMAIN-EXTRACT-FILE                                          00250000
008100     RECORDING MODE IS F                                          00260000
008200     LABEL RECORDS ARE OMITTED                                    00270000
008300     RECORD CONTAINS 128 CHARACTERS                               00280000
008400     DATA RECORD IS DOMAIN-EVNT-RECORD.                           00290000
008500 01  DOMAIN-EVNT-REC              PIC X(128).                     00300000
006500                                                                  00310000
       FD  CONTROL-CARD                                                 00320000
           RECORDING MODE F                                             00330000
           BLOCK CONTAINS 0 RECORDS                                     00340000
           LABEL RECORDS ARE OMITTED                                    00350000
           DATA RECORD IS CONTROL-CARD-RECORD.                          00360000
       01  CONTROL-CARD-RECORD             PIC X(080).                  00370000
                                                                        00380000
       FD  REPORT-FILE                                                  00390000
           RECORDING MODE F                                             00400000
           BLOCK CONTAINS 0 RECORDS                                     00401000
           LABEL RECORDS ARE OMITTED                                    00402000
009600     RECORD CONTAINS 132 CHARACTERS                               00403000
           DATA RECORD IS REPORT-RECORD.                                00404000
       01  REPORT-RECORD                   PIC X(132).                  00405000
                                                                        00406000
       FD  ERROR-FILE                                                   00407000
           RECORDING MODE F                                             00408000
           BLOCK CONTAINS 0 RECORDS                                     00409000
           LABEL RECORDS ARE OMITTED                                    00410000
           DATA RECORD IS DIFFERENCES-RECORD.                           00410100
       01  DIFFERENCES-RECORD              PIC X(128).                  00410200
                                                                        00410300
002500*---------------------------------------------------------        00410400
002600                                                                  00410500
002700 WORKING-STORAGE SECTION.                                         00410600
002800*---------------------------------------------------------        00410700
003500* PC- PROGRAM CONSTANTS                                           00410800
003600*----------------------------------------------------------       00410900
003700 01  PC-PROGRAM-CONSTANTS.                                        00411000
003800     05  PC-PROGRAM-NAME              PIC X(08) VALUE 'XSKRP029'. 00412000
003900     05  PC-MAX-RETRIES               PIC S9(04) VALUE +5 COMP.   00413000
004000                                                                  00414000
097700 01  CD-CPU-DATE.                                                 00415000
097800     03  CD-CPU-YEAR             PIC 99.                          00416000
097900     03  CD-CPU-MONTH            PIC 99.                          00417000
098000     03  CD-CPU-DAY              PIC 99.                          00418000
098100                                                                  00419000
098200 01  CD-CPU-DATE-CC.                                              00420000
098300     03  CD-CPU-CENT             PIC 99.                          00430000
098400     03  CD-CPU-YYMMDD           PIC 9(6).                        00440000
                                                                        00450000
084800 01  PC-REPORT-NO                PIC  9(5)          VALUE 00001.  00460000
                                                                        00470000
011200 01  CT-CPU-TIME.                                                 00480000
011300     03  CT-HOUR                 PIC 99.                          00490000
011400     03  CT-MINUTE               PIC 99.                          00500000
011500     03  FILLER                  PIC 9(4).                        00501000
      *----------------------------------------------------------       00501100
      **PROGRAM                                                         00501200
      *----------------------------------------------------------       00501300
       01  PC-PROGRAM-COUNTER.                                          00501400
           05  PC-RECORD-COUNT                 PIC S9(09) VALUE ZEROS   00501500
                                                          COMP-3.       00501600
           05  PC-PROMO-EXTRACT-RECS-READ      PIC 9(09) VALUE ZEROS.   00501700
           05  PC-DOMAIN-EXTRACT-RECS-READ     PIC 9(09) VALUE ZEROS.   00501800
           05  PC-ERROR-RECORD-WRITTEN         PIC 9(09) VALUE ZEROS.   00501900
           05  PC-ERROR-REPORT-WRITTEN         PIC 9(09) VALUE ZEROS.   00502000
           05  PC-PAGE-CNT                     PIC 9(09) VALUE ZEROS.   00502100
004100*----------------------------------------------------------       00502200
004200* PS- PROGRAM SWITCHES                                            00502300
004300*----------------------------------------------------------       00502400
004400 01  PS-PROGRAM-SWITCHES.                                         00502500
004500     05  PS-EOF-PROMO-EXTRACT-SW          PIC X(01)  VALUE SPACE. 00502600
004600         88  PS-EOF-PROMO                        VALUE 'Y'.       00502700
004600         88  PS-NOT-EOF-PROMO                    VALUE 'N'.       00502800
004800                                                                  00502900
004500     05  PS-EOF-DOMAIN-EXTRACT-SW         PIC X(01)  VALUE SPACE. 00503000
004600         88  PS-EOF-DOMAIN                       VALUE 'Y'.       00504000
004600         88  PS-NOT-EOF-DOMAIN                   VALUE 'N'.       00505000
004800                                                                  00506000
004500     05  PS-NEW-RECORD-SW                 PIC X(01)  VALUE SPACE. 00507000
004600         88  PS-NEW-RECORD                       VALUE 'Y'.       00508000
004600         88  PS-NOT-NEW-RECORD                   VALUE 'N'.       00509000
004800                                                                  00510000
004900*----------------------------------------------------------       00520000
      *    CONTROL-CARD-LAYOUT.                                         00530000
004900*----------------------------------------------------------       00540000
       01  CONTROL-CARD-LAYOUT.                                         00550000
           05  CC-START-POINT                  PIC 9(05) VALUE ZEROS.   00560000
           05  FILLER                          PIC X(01) VALUE SPACES.  00570000
           05  CC-READ-FREQUENCY               PIC 9(05) VALUE ZEROS.   00580000
           05  FILLER                          PIC X(69) VALUE SPACES.  00580100
004900*----------------------------------------------------------       00580200
005000* PV- PROGRAM VARIABLES                                           00580300
005100*----------------------------------------------------------       00580400
005200 01 PV-PROGRAM-VARIABLES.                                         00580500
013800    05  ABEND-CODE              PIC S9(4)  VALUE ZEROS COMP SYNC. 00580600
005500    05  PV-SQL-SUB                    PIC S9(4)  VALUE +0 COMP.   00580700
005600    05  PV-MAX-OFFSET-DTE             PIC 9(08)  VALUE 0.         00580800
005710    05  PV-PROMO-INTFC-ID-HLD         PIC 9(10) VALUE 0.          00580900
005710    05  PV-MDSE-LNE-ID-HLD            PIC 9(05) VALUE 0.          00581000
005800    05  PV-ACTION-CODE                PIC X(01).                  00582000
005810        88  PV-INSERT-DATA                       VALUE 'I'.       00583000
005820        88  PV-UPDATE-DATA                       VALUE 'U'.       00584000
                                                                        00585000
006000    05  PV-RECORD-COUNT               PIC 9(05) VALUE ZEROS.      00586000
006000    05  PV-LD-STATUS-CDE              PIC X(02).                  00587000
006100        88  PV-NO-ERROR                          VALUE '00'.      00588000
006200        88  PV-CRITICAL-ERROR                    VALUE '01'.      00589000
006300        88  PV-NOT-CRITICAL-ERROR                VALUE '02'.      00590000
007000                                                                  00600000
           05  PS-ERROR-FOUND-SW               PIC X(01) VALUE 'N'.     00610000
               88  PS-ERROR-FOUND                        VALUE 'Y'.     00620000
               88  PS-ERROR-NOT-FOUND                    VALUE 'N'.     00630000
                                                                        00640000
007100    05  PV-STRT-PARM.                                             00650000
007200        10  PV-STRT-DTE-CC            PIC X(02).                  00660000
007200        10  PV-STRT-DTE-YY            PIC X(02).                  00670000
007400        10  PV-STRT-DTE-MM            PIC X(02).                  00680000
007600        10  PV-STRT-DTE-DD            PIC X(02).                  00690000
007400        10  FILLER                    PIC X.                      00700000
007400        10  PV-DECREMENT              PIC X(02).                  00710000
007400        10  FILLER                    PIC X(69).                  00720000
007700                                                                  00730000
007100    05  PV-PROMO-STRT-DTE           PIC X(10).                    00740000
007100    05  PV-PROMO-END-DTE            PIC X(10).                    00750000
                                                                        00760000
008600    05  PV-PROMO-KEY.                                             00770000
008700        10  PV-PM-PROMO-INTFC-ID          PIC 9(10).              00780000
008700        10  PV-PM-MDSE-LNE-ID             PIC 9(10).              00790000
008700        10  PV-PM-MDSE-LNE-EXCLN-ID       PIC 9(10).              00800000
008700        10  PV-PM-PROMO-INTFC-SUB-ID      PIC 9(10).              00810000
                                                                        00820000
008600    05  PV-DOMAIN-KEY.                                            00830000
008700        10  PV-XS-PROMO-INTFC-ID          PIC 9(10).              00840000
008700        10  PV-XS-MDSE-LNE-ID             PIC 9(10).              00850000
008700        10  PV-XS-MDSE-LNE-EXCLN-ID       PIC 9(10).              00851000
008700        10  PV-XS-PROMO-INTFC-SUB-ID      PIC 9(10).              00852000
                                                                        00853000
008600    05  PV-PROMO-SOURCE              PIC X(40) VALUE              00854000
              'DATA SOURCE IS THE PROMO DATABASE'.                      00855000
                                                                        00856000
008600    05  PV-PROMO-NF                  PIC X(40) VALUE              00857000
              'RECORD NOT FOUND IN XS DOMAIN'.                          00858000
                                                                        00859000
008600    05  PV-DOMAIN-SOURCE             PIC X(40) VALUE              00860000
              'DATA SOURCE IS THE XS DOMAIN DATABASE'.                  00870000
                                                                        00880000
008600    05  PV-DOMAIN-NF                  PIC X(40) VALUE             00890000
              'RECORD NOT FOUND IN PROMO TABLES'.                       00900000
                                                                        00910000
       01  PV-PM-TOTAL-RECORD.                                          00920000
           05 PV-PM-BUSINESS-EVNT-ID           PIC 9(03) VALUE ZERO.    00930000
           05 PV-PM-ACTION-CDE                 PIC X(01) VALUE 'T'.     00940000
           05 PV-PM-TOTAL-NBR-OF-RECS          PIC 9(11) VALUE ZERO.    00950000
                                                                        00960000
       01  PV-XS-TOTAL-RECORD.                                          00970000
           05 PV-XS-BUSINESS-EVNT-ID           PIC 9(03) VALUE ZERO.    00980000
           05 PV-XS-ACTION-CDE                 PIC X(01) VALUE 'T'.     00981000
           05 PV-XS-TOTAL-NBR-OF-RECS          PIC 9(11) VALUE ZERO.    00981100
                                                                        00981200
000700 01  ERROR-RECORD                    PIC X(128) VALUE SPACES.     00981300
                                                                        00981400
042800     COPY DPWS132O.                                               00981600
042900                                                                  00981700
                                                                        00981800
043100 01  DR-HEAD2.                                                    00981900
043200     05  FILLER                 PIC X(41)    VALUE SPACES.        00982000
043300     05  DR-TITLE               PIC X(55)    VALUE                00983000
043400      'INTEGRITY CHECK PROGRAM  - PRICING EXCLUSION'.             00984000
                                                                        00985000
043500                                                                  00986000
043100 01  DR-HEAD3.                                                    00987000
043200     05  FILLER                 PIC X(03)    VALUE                00988000
            'KEY'.                                                      00989000
043200     05  FILLER                 PIC X(39)    VALUE SPACES.        00990000
043200     05  FILLER                 PIC X(10)    VALUE                00991000
            'FIELD NAME'.                                               00992000
043200     05  FILLER                 PIC X(12)    VALUE SPACES.        00993000
043200     05  FILLER                 PIC X(05)    VALUE                00993100
            'VALUE'.                                                    00993200
043200     05  FILLER                 PIC X(23)    VALUE SPACES.        00993300
043200     05  FILLER                 PIC X(16)    VALUE                00993400
            'SOURCE / MESSAGE'.                                         00993500
043200     05  FILLER                 PIC X(35)    VALUE SPACES.        00993600
043500                                                                  00993700
043100 01  DR-HEAD5.                                                    00993800
043200     05  FILLER                 PIC X(132)   VALUE ALL '='.       00993900
000700 01  REPORT-DETAIL.                                               00994000
000800   05 PROMO-RPT-INFO.                                             00995000
000800      10 PROMO-EVNT-KEY              PIC X(40).                   00995100
 00800      10 FILLER                      PIC X(2).                    00995200
 00800      10 PROMO-RPT-DATA-NAME         PIC X(20).                   00995300
 00800      10 FILLER                      PIC X(2).                    00995400
 00800      10 PROMO-RPT-DATA-VALUE        PIC X(26).                   00995500
 00800      10 FILLER                      PIC X(2).                    00995600
000800   05 REPORT-NOTES                   PIC X(40).                   00995700
010900*----------------------------------------------------------       00995800
011000* DOMAIN PRICING EVENT RECORD LAYOUT                              00995900
011100*----------------------------------------------------------       00996000
011200     COPY XSRD021.                                                00996100
011800                                                                  00996200
004900*----------------------------------------------------------       00996300
005000* PROMO PRICING  COPY BOOK.                                       00996400
005100*----------------------------------------------------------       00996500
           COPY PMRD708.                                                00996600
011800                                                                  00996700
030310                                                                  00996800
031400*----------------------------------------------------------       00996900
031500 PROCEDURE DIVISION.                                              00997000
032100*----------------------------------------------------------       00998000
032200 0000-MAINLINE.                                                   00999000
128200     ACCEPT CD-CPU-DATE FROM DATE.                                01000000
128300     IF CD-CPU-YEAR > 80                                          01010000
128400         MOVE 19 TO CD-CPU-CENT                                   01020000
128500     ELSE                                                         01030000
128600         MOVE 20 TO CD-CPU-CENT.                                  01040000
128700     MOVE CD-CPU-DATE TO CD-CPU-YYMMDD.                           01050000
128800                                                                  01060000
128900     ACCEPT CT-CPU-TIME FROM TIME.                                01070000
032300                                                                  01080000
032400     PERFORM 1000-INITIALIZATION.                                 01090000
032500                                                                  01100000
032600     PERFORM 2000-PROCESS-EXTRACT-DATA                            01110000
032700             UNTIL PS-EOF-DOMAIN                                  01120000
032700                OR PS-EOF-PROMO.                                  01130000
                                                                        01140000
           PERFORM 3000-PROCESS-EXTRA-RECORDS                           01150000
032700             UNTIL PS-EOF-DOMAIN                                  01160000
032700               AND PS-EOF-PROMO.                                  01170000
035000                                                                  01180000
035100     PERFORM 9999-WRAPUP.                                         01190000
035200                                                                  01200000
035500     GOBACK.                                                      01210000
035700                                                                  01220000
035701*0000-EXIT.                                                       01230000
035702 EJECT.                                                           01240000
035703                                                                  01250000
035800*----------------------------------------------------------       01260000
035900* 1000-INITIALIZATION.                                            01270000
036000*     INTIALIZES OR MOVES ANY VARIABLES BEFORE IT WILL            01280000
036100*     UPDATE OR INSERT A RECORD.                                  01290000
036200*----------------------------------------------------------       01300000
036300 1000-INITIALIZATION.                                             01310000
                                                                        01320000
132408     MOVE CD-CPU-YEAR  TO DP132O-RUN-YEAR.                        01330000
132409     MOVE CD-CPU-MONTH TO DP132O-RUN-MONTH.                       01340000
132410     MOVE CD-CPU-DAY   TO DP132O-RUN-DAY.                         01350000
132420     MOVE CT-HOUR    TO DP132O-RUN-HOUR.                          01360000
132430     MOVE CT-MINUTE  TO DP132O-RUN-MINUTE.                        01370000
132440     MOVE 'XSKRP029' TO DP132O-PROGRAM-NAME.                      01380000
132450     MOVE 1          TO DP132O-REPORT-NUMBER.                     01390000
           SET PS-NOT-EOF-PROMO TO TRUE.                                01400000
           SET PS-NOT-EOF-DOMAIN TO TRUE.                               01410000
026600     OPEN INPUT  PROMO-EXTRACT-FILE                               01420000
026600                 DOMAIN-EXTRACT-FILE                              01430000
026600                 CONTROL-CARD                                     01440000
026600          OUTPUT ERROR-FILE                                       01450000
026600                 REPORT-FILE.                                     01460000
                                                                        01470000
           PERFORM 9999-PRINT-HEADINGS.                                 01480000
           PERFORM 9999-READ-CONTROL-CARD.                              01490000
           READ DOMAIN-EXTRACT-FILE INTO PV-XS-TOTAL-RECORD             01500000
           READ PROMO-EXTRACT-FILE INTO PV-PM-TOTAL-RECORD              01510000
                                                                        01520000
           IF PV-PM-TOTAL-NBR-OF-RECS NOT EQUAL TO                      01530000
              PV-XS-TOTAL-NBR-OF-RECS                                   01540000
             MOVE 1 TO CC-START-POINT                                   01550000
             MOVE 1 TO CC-READ-FREQUENCY                                01560000
           END-IF.                                                      01570000
                                                                        01580000
           PERFORM 9999-READ-PROMO-EXTRACT CC-START-POINT TIMES.        01590000
           PERFORM 9999-READ-DOMAIN-EXTRACT  CC-START-POINT TIMES.      01600000
                                                                        01610000
056500                                                                  01620000
037240*1100-EXIT.                                                       01630000
037250 EJECT.                                                           01640000
037251                                                                  01650000
037260*----------------------------------------------------------       01660000
037300* 2000-PROCESS-EXTRACT-DATA.                                      01670000
037400*     THIS CHECKS THE ACTION TO SEE WHETHER THE RECORD            01680000
037500*     SHOULD BE INSERTED INTO THE AD EVENT TABLE OR UPDATED.      01690000
037600*     IF SOMETHING IS WRONG WITH THE ACTION CODE IT WILL          01700000
037700*     PROCESS AN ERROR AND EXIT THE PROGRAM.                      01710000
037800*----------------------------------------------------------       01720000
037900 2000-PROCESS-EXTRACT-DATA.                                       01730000
           IF PM708-PROMO-INTFC-ID = XS021-PROMO-INTFC-ID               01740000
             IF PM708-MDSE-LNE-ID    = XS021-MDSE-LNE-ID                01750000
               IF PM708-MDSE-LNE-EXCLN-ID = XS021-MDSE-LNE-EXCLN-ID     01760000
                 IF PM708-PROMO-INTFC-SUB-ID = XS021-PROMO-INTFC-SUB-ID 01770000
                   PERFORM 2100-COMPARE-FIELDS                          01780000
                   PERFORM 9999-READ-DOMAIN-EXTRACT                     01790000
                           CC-READ-FREQUENCY TIMES                      01800000
                   PERFORM 9999-READ-PROMO-EXTRACT                      01810000
                           CC-READ-FREQUENCY TIMES                      01820000
                 ELSE                                                   01830000
                  IF PM708-PROMO-INTFC-SUB-ID >                         01840000
                     XS021-PROMO-INTFC-SUB-ID                           01850000
P11215             IF XS021-STAT-CDE = 'D'                              01851000
P11215                 PERFORM 9999-READ-DOMAIN-EXTRACT                 01852000
P11215             ELSE                                                 01853000
                       MOVE PV-DOMAIN-NF   TO REPORT-NOTES              01860000
                       MOVE PV-DOMAIN-KEY  TO PROMO-EVNT-KEY            01870000
                       PERFORM 9999-WRITE-ERROR-REPORT                  01880000
                       MOVE XS021-PRICING-EXCLSNS-RECORD TO ERROR-RECORD01890000
                       PERFORM 9999-WRITE-ERROR-RECORD                  01900000
                       PERFORM 9999-READ-DOMAIN-EXTRACT                 01900100
P11215             END-IF                                               01900200
                  ELSE                                                  01900300
                       MOVE PV-PROMO-NF TO REPORT-NOTES                 01900400
                       MOVE PV-PROMO-KEY  TO PROMO-EVNT-KEY             01900500
                       PERFORM 9999-WRITE-ERROR-REPORT                  01900600
                       MOVE PM708-PRICING-EXCLSNS-RECORD TO ERROR-RECORD01900700
                       PERFORM 9999-WRITE-ERROR-RECORD                  01900800
                       PERFORM 9999-READ-PROMO-EXTRACT                  01900900
                  END-IF                                                01901000
                 END-IF                                                 01901100
               ELSE                                                     01902000
                IF PM708-MDSE-LNE-EXCLN-ID > XS021-MDSE-LNE-EXCLN-ID    01903000
P11215           IF XS021-STAT-CDE = 'D'                                01903100
P11215               PERFORM 9999-READ-DOMAIN-EXTRACT                   01903200
P11215           ELSE                                                   01903300
                   MOVE PV-DOMAIN-NF   TO REPORT-NOTES                  01904000
                   MOVE PV-DOMAIN-KEY TO PROMO-EVNT-KEY                 01905000
                   PERFORM 9999-WRITE-ERROR-REPORT                      01906000
                   MOVE XS021-PRICING-EXCLSNS-RECORD TO ERROR-RECORD    01907000
                   PERFORM 9999-WRITE-ERROR-RECORD                      01908000
                   PERFORM 9999-READ-DOMAIN-EXTRACT                     01909000
P11215           END-IF                                                 01909100
                ELSE                                                    01909200
                   MOVE PV-PROMO-NF TO REPORT-NOTES                     01909300
                   MOVE PV-PROMO-KEY TO PROMO-EVNT-KEY                  01909400
                   PERFORM 9999-WRITE-ERROR-REPORT                      01909500
                   MOVE PM708-PRICING-EXCLSNS-RECORD TO ERROR-RECORD    01909600
                   PERFORM 9999-WRITE-ERROR-RECORD                      01909700
                   PERFORM 9999-READ-PROMO-EXTRACT                      01909800
                END-IF                                                  01909900
               END-IF                                                   01910000
             ELSE                                                       01910100
              IF PM708-MDSE-LNE-ID > XS021-MDSE-LNE-ID                  01910200
P11215         IF XS021-STAT-CDE = 'D'                                  01910300
P11215             PERFORM 9999-READ-DOMAIN-EXTRACT                     01910400
P11215         ELSE                                                     01910500
                 MOVE PV-DOMAIN-NF   TO REPORT-NOTES                    01910600
                 MOVE PV-DOMAIN-KEY         TO PROMO-EVNT-KEY           01910700
                 PERFORM 9999-WRITE-ERROR-REPORT                        01910800
                 MOVE XS021-PRICING-EXCLSNS-RECORD TO ERROR-RECORD      01910900
                 PERFORM 9999-WRITE-ERROR-RECORD                        01911000
                 PERFORM 9999-READ-DOMAIN-EXTRACT                       01911100
P11215         END-IF                                                   01911200
              ELSE                                                      01911300
                 MOVE PV-PROMO-NF TO REPORT-NOTES                       01911400
                 MOVE PV-PROMO-KEY TO PROMO-EVNT-KEY                    01911500
                 PERFORM 9999-WRITE-ERROR-REPORT                        01911600
                 MOVE PM708-PRICING-EXCLSNS-RECORD TO ERROR-RECORD      01911700
                 PERFORM 9999-WRITE-ERROR-RECORD                        01911800
                 PERFORM 9999-READ-PROMO-EXTRACT                        01911900
              END-IF                                                    01912000
             END-IF                                                     01912100
           ELSE                                                         01912200
            IF PM708-PROMO-INTFC-ID > XS021-PROMO-INTFC-ID              01912300
P11215       IF XS021-STAT-CDE = 'D'                                    01912400
P11215           PERFORM 9999-READ-DOMAIN-EXTRACT                       01912500
P11215       ELSE                                                       01912600
               MOVE PV-DOMAIN-NF   TO REPORT-NOTES                      01912700
               MOVE PV-DOMAIN-KEY         TO PROMO-EVNT-KEY             01912800
               PERFORM 9999-WRITE-ERROR-REPORT                          01912900
               MOVE XS021-PRICING-EXCLSNS-RECORD TO ERROR-RECORD        01913000
               PERFORM 9999-WRITE-ERROR-RECORD                          01913100
               PERFORM 9999-READ-DOMAIN-EXTRACT                         01913200
P11215       END-IF                                                     01913300
            ELSE                                                        01913400
               MOVE PV-PROMO-NF TO REPORT-NOTES                         01913500
               MOVE PV-PROMO-KEY TO PROMO-EVNT-KEY                      01913600
               PERFORM 9999-WRITE-ERROR-REPORT                          01913700
               MOVE PM708-PRICING-EXCLSNS-RECORD TO ERROR-RECORD        01913800
               PERFORM 9999-WRITE-ERROR-RECORD                          01913900
               PERFORM 9999-READ-PROMO-EXTRACT                          01914000
            END-IF                                                      01914200
           END-IF.                                                      01914300
      *       WHEN PM708-PROMO-INTFC-ID  > XS021-PROMO-INTFC-ID OR      01914400
      *            PM708-MDSE-LNE-ID    > XS021-MDSE-LNE-ID OR          01914500
      *            PM708-EXCL-MDSE-ID   > XS021-EXCL-MDSE-ID OR         01914600
      *            PM708-PROMO-INTFC-SUB-ID > XS021-PROMO-INTFC-SUB-ID  01914700
      *            INITIALIZE REPORT-DETAIL                             01914800
      *            MOVE PV-DOMAIN-NF             TO REPORT-NOTES        01914900
      *            MOVE XS021-PROMO-INTFC-ID     TO PROMO-EVNT-KEY      01915000
      *            PERFORM 9999-WRITE-ERROR-REPORT                      01915100
      *            MOVE XS021-PRICING-EXCLSNS-RECORD TO ERROR-RECORD    01916000
      *            PERFORM 9999-WRITE-ERROR-RECORD                      01917000
      *            PERFORM 9999-READ-DOMAIN-EXTRACT                     01918000
      *                                                                 01919000
      *       WHEN PM708-PROMO-INTFC-ID  = XS021-PROMO-INTFC-ID OR      01920000
      *            PM708-MDSE-LNE-ID    > XS021-MDSE-LNE-ID OR          01930000
      *            PM708-EXCL-MDSE-ID   > XS021-EXCL-MDSE-ID OR         01940000
      *            PM708-PROMO-INTFC-SUB-ID > XS021-PROMO-INTFC-SUB-ID  01940100
      *            MOVE PV-DOMAIN-NF             TO REPORT-NOTES        01940200
      *            MOVE XS021-PROMO-INTFC-ID     TO PROMO-EVNT-KEY      01940300
      *            PERFORM 9999-WRITE-ERROR-REPORT                      01940400
      *            MOVE XS021-PRICING-EXCLSNS-RECORD TO ERROR-RECORD    01940500
      *            PERFORM 9999-WRITE-ERROR-RECORD                      01940600
      *            PERFORM 9999-READ-DOMAIN-EXTRACT                     01940700
      *                                                                 01940800
      *       WHEN PM708-PROMO-INTFC-ID  < XS021-PROMO-INTFC-ID OR      01940900
      *            PM708-MDSE-LNE-ID    < XS021-MDSE-LNE-ID             01941000
      *            INITIALIZE REPORT-DETAIL                             01941100
      *            MOVE PV-PROMO-NF             TO REPORT-NOTES         01941200
      *            MOVE PM708-PROMO-INTFC-ID     TO PROMO-EVNT-KEY      01941300
      *            PERFORM 9999-WRITE-ERROR-REPORT                      01941400
      *            MOVE PM708-PRICING-EXCLSNS-RECORD TO ERROR-RECORD    01941500
      *            PERFORM 9999-WRITE-ERROR-RECORD                      01941600
      *            PERFORM 9999-READ-PROMO-EXTRACT                      01941700
      *                                                                 01941800
      *       WHEN PM708-PROMO-INTFC-ID =  XS021-PROMO-INTFC-ID OR      01941900
      *            PM708-MDSE-LNE-ID    < XS021-MDSE-LNE-ID             01942000
      *            INITIALIZE REPORT-DETAIL                             01942100
      *            MOVE PV-PROMO-NF             TO REPORT-NOTES         01942200
      *            MOVE PM708-PROMO-INTFC-ID     TO PROMO-EVNT-KEY      01942300
      *            PERFORM 9999-WRITE-ERROR-REPORT                      01942400
      *            MOVE PM708-PRICING-EXCLSNS-RECORD TO ERROR-RECORD    01942500
      *            PERFORM 9999-WRITE-ERROR-RECORD                      01942600
      *            PERFORM 9999-READ-PROMO-EXTRACT                      01942700
      *    END-EVALUATE.                                                01942800
038000                                                                  01942900
038110*2000-EXIT.                                                       01943000
038200 EJECT.                                                           01943100
                                                                        01943200
038300*------------------------------------------------------           01943300
038400* 2100-COMPARE-FIELDS.                                            01943400
038500*     COMPARES THE EXTRACT FILES AND NOTES ANY DIFFERENCES        01943500
038600*------------------------------------------------------           01943600
038210                                                                  01943700
054400 2100-COMPARE-FIELDS.                                             01943800
036600     IF PM708-BUSINESS-EVNT-ID NOT EQUAL XS021-BUSINESS-EVNT-ID   01943900
              MOVE 'PM708-BUSINESS-EVNT-ID' TO PROMO-RPT-DATA-NAME      01944000
              MOVE PM708-BUSINESS-EVNT-ID   TO PROMO-RPT-DATA-VALUE     01945000
              MOVE PV-PROMO-SOURCE         TO REPORT-NOTES              01946000
              MOVE PV-PROMO-KEY          TO PROMO-EVNT-KEY              01947000
              PERFORM 9999-WRITE-ERROR-REPORT                           01948000
              MOVE 'XS021-BUSINESS-EVNT-ID' TO PROMO-RPT-DATA-NAME      01949000
              MOVE XS021-BUSINESS-EVNT-ID   TO PROMO-RPT-DATA-VALUE     01950000
              MOVE PV-DOMAIN-SOURCE         TO REPORT-NOTES             01960000
              MOVE PV-DOMAIN-KEY         TO PROMO-EVNT-KEY              01970000
              PERFORM 9999-WRITE-ERROR-REPORT                           01980000
              SET PS-ERROR-FOUND     TO TRUE                            01990000
           END-IF.                                                      02000000
                                                                        02010000
036600     IF PM708-PROMO-INTFC-ID   NOT EQUAL XS021-PROMO-INTFC-ID     02020000
              MOVE 'PM708-PROMO-INTFC-ID'   TO PROMO-RPT-DATA-NAME      02030000
              MOVE PM708-PROMO-INTFC-ID     TO PROMO-RPT-DATA-VALUE     02040000
              MOVE PV-PROMO-SOURCE         TO REPORT-NOTES              02050000
              MOVE PV-PROMO-KEY         TO PROMO-EVNT-KEY               02051000
              PERFORM 9999-WRITE-ERROR-REPORT                           02052000
              MOVE 'XS021-PROMO-INTFC-ID'   TO PROMO-RPT-DATA-NAME      02053000
              MOVE XS021-PROMO-INTFC-ID     TO PROMO-RPT-DATA-VALUE     02054000
              MOVE PV-DOMAIN-SOURCE         TO REPORT-NOTES             02055000
              MOVE PV-DOMAIN-KEY        TO PROMO-EVNT-KEY               02056000
              PERFORM 9999-WRITE-ERROR-REPORT                           02057000
              SET PS-ERROR-FOUND     TO TRUE                            02058000
           END-IF.                                                      02059000
                                                                        02060000
036600     IF PM708-PROMO-INTFC-SUB-ID NOT EQUAL TO                     02070000
              XS021-PROMO-INTFC-SUB-ID                                  02080000
              MOVE 'PM708-PROMO-INTFC-SUB-ID' TO PROMO-RPT-DATA-NAME    02090000
              MOVE PM708-PROMO-INTFC-SUB-ID   TO PROMO-RPT-DATA-VALUE   02100000
              MOVE PV-PROMO-SOURCE         TO REPORT-NOTES              02110000
              MOVE PV-PROMO-KEY         TO PROMO-EVNT-KEY               02120000
              PERFORM 9999-WRITE-ERROR-REPORT                           02120100
              MOVE 'XS021-PROMO-INTFC-SUB-ID'  TO PROMO-RPT-DATA-NAME   02120200
              MOVE XS021-PROMO-INTFC-SUB-ID    TO PROMO-RPT-DATA-VALUE  02120300
              MOVE PV-DOMAIN-SOURCE         TO REPORT-NOTES             02120400
              MOVE PV-DOMAIN-KEY        TO PROMO-EVNT-KEY               02120500
              PERFORM 9999-WRITE-ERROR-REPORT                           02120600
              SET PS-ERROR-FOUND     TO TRUE                            02120700
           END-IF.                                                      02120800
                                                                        02120900
036600     IF PM708-MDSE-LNE-ID NOT EQUAL XS021-MDSE-LNE-ID             02121000
              MOVE 'PM708-MDSE-LNE-ID' TO PROMO-RPT-DATA-NAME           02121100
              MOVE PM708-MDSE-LNE-ID   TO PROMO-RPT-DATA-VALUE          02121200
              MOVE PV-PROMO-SOURCE         TO REPORT-NOTES              02121300
              MOVE PV-PROMO-KEY         TO PROMO-EVNT-KEY               02121400
              PERFORM 9999-WRITE-ERROR-REPORT                           02121500
              MOVE 'XS021-MDSE-LNE-ID' TO PROMO-RPT-DATA-NAME           02121600
              MOVE XS021-MDSE-LNE-ID TO PROMO-RPT-DATA-VALUE            02121700
              MOVE PV-DOMAIN-KEY        TO PROMO-EVNT-KEY               02121800
              MOVE PV-DOMAIN-SOURCE         TO REPORT-NOTES             02121900
              PERFORM 9999-WRITE-ERROR-REPORT                           02122000
              SET PS-ERROR-FOUND     TO TRUE                            02123000
           END-IF.                                                      02124000
                                                                        02125000
036600     IF PM708-MDSE-LNE-EXCLN-ID NOT EQUAL XS021-MDSE-LNE-EXCLN-ID 02126000
              MOVE 'PM708-MDSE-LNE-EXCLN-ID' TO PROMO-RPT-DATA-NAME     02127000
              MOVE PM708-MDSE-LNE-EXCLN-ID   TO PROMO-RPT-DATA-VALUE    02128000
              MOVE PV-PROMO-SOURCE         TO REPORT-NOTES              02129000
              MOVE PV-PROMO-KEY         TO PROMO-EVNT-KEY               02129100
              PERFORM 9999-WRITE-ERROR-REPORT                           02129200
              MOVE 'XS021-MDSE-LNE-EXCLN-ID' TO PROMO-RPT-DATA-NAME     02129300
              MOVE XS021-MDSE-LNE-EXCLN-ID TO PROMO-RPT-DATA-VALUE      02129400
              MOVE PV-DOMAIN-SOURCE         TO REPORT-NOTES             02129500
              MOVE PV-DOMAIN-KEY        TO PROMO-EVNT-KEY               02129600
              PERFORM 9999-WRITE-ERROR-REPORT                           02129700
              SET PS-ERROR-FOUND     TO TRUE                            02129800
           END-IF.                                                      02129900
                                                                        02130000
036600     IF PM708-MDSE-HIER-CDE NOT EQUAL XS021-MDSE-HIER-CDE         02130100
              MOVE 'PM708-MDSE-HIER-CDE' TO PROMO-RPT-DATA-NAME         02130200
              MOVE PM708-MDSE-HIER-CDE   TO PROMO-RPT-DATA-VALUE        02130300
              MOVE PV-PROMO-SOURCE         TO REPORT-NOTES              02130400
              MOVE PV-PROMO-KEY        TO PROMO-EVNT-KEY                02130500
              PERFORM 9999-WRITE-ERROR-REPORT                           02130600
              MOVE 'XS021-MDSE-HIER-CDE' TO PROMO-RPT-DATA-NAME         02130700
              MOVE XS021-MDSE-HIER-CDE TO PROMO-RPT-DATA-VALUE          02130800
              MOVE PV-DOMAIN-SOURCE         TO REPORT-NOTES             02130900
              MOVE PV-DOMAIN-KEY        TO PROMO-EVNT-KEY               02131000
              PERFORM 9999-WRITE-ERROR-REPORT                           02131100
              SET PS-ERROR-FOUND     TO TRUE                            02131200
           END-IF.                                                      02131300
                                                                        02131400
036600     IF PM708-DEPT-NBR  NOT EQUAL XS021-DEPT-NBR                  02131500
              MOVE 'PM708-DEPT-NBR' TO PROMO-RPT-DATA-NAME              02131600
              MOVE PM708-DEPT-NBR   TO PROMO-RPT-DATA-VALUE             02131700
              MOVE PV-PROMO-SOURCE         TO REPORT-NOTES              02131800
              MOVE PV-PROMO-KEY        TO PROMO-EVNT-KEY                02131900
              PERFORM 9999-WRITE-ERROR-REPORT                           02132000
              MOVE 'XS021-DEPT-NBR' TO PROMO-RPT-DATA-NAME              02132100
              MOVE XS021-DEPT-NBR TO PROMO-RPT-DATA-VALUE               02132200
              MOVE PV-DOMAIN-SOURCE         TO REPORT-NOTES             02132300
              MOVE PV-DOMAIN-KEY        TO PROMO-EVNT-KEY               02132400
              PERFORM 9999-WRITE-ERROR-REPORT                           02132500
              SET PS-ERROR-FOUND     TO TRUE                            02132600
           END-IF.                                                      02132700
                                                                        02132800
036600     IF PM708-MAJ-CL-NBR NOT EQUAL XS021-MAJ-CL-NBR               02132900
              MOVE 'PM708-MAJ-CL-NBR' TO PROMO-RPT-DATA-NAME            02133000
              MOVE PM708-MAJ-CL-NBR   TO PROMO-RPT-DATA-VALUE           02133100
              MOVE PV-PROMO-SOURCE         TO REPORT-NOTES              02133200
              MOVE PV-PROMO-KEY        TO PROMO-EVNT-KEY                02133300
              PERFORM 9999-WRITE-ERROR-REPORT                           02133400
              MOVE 'XS021-MAJ-CL-NBR' TO PROMO-RPT-DATA-NAME            02133500
              MOVE XS021-MAJ-CL-NBR TO PROMO-RPT-DATA-VALUE             02133600
              MOVE PV-DOMAIN-SOURCE         TO REPORT-NOTES             02133700
              MOVE PV-DOMAIN-KEY        TO PROMO-EVNT-KEY               02133800
              PERFORM 9999-WRITE-ERROR-REPORT                           02133900
              SET PS-ERROR-FOUND     TO TRUE                            02134000
           END-IF.                                                      02134100
                                                                        02134200
036600     IF PM708-SUB-CL-NBR NOT EQUAL XS021-SUB-CL-NBR               02134300
              MOVE 'PM708-SUB-CL-NBR' TO PROMO-RPT-DATA-NAME            02134400
              MOVE PM708-SUB-CL-NBR   TO PROMO-RPT-DATA-VALUE           02134500
              MOVE PV-PROMO-SOURCE         TO REPORT-NOTES              02134600
              MOVE PV-PROMO-KEY        TO PROMO-EVNT-KEY                02134700
              PERFORM 9999-WRITE-ERROR-REPORT                           02134800
              MOVE 'XS021-SUB-CL-NBR' TO PROMO-RPT-DATA-NAME            02134900
              MOVE XS021-SUB-CL-NBR TO PROMO-RPT-DATA-VALUE             02135000
              MOVE PV-DOMAIN-SOURCE         TO REPORT-NOTES             02135100
              MOVE PV-DOMAIN-KEY        TO PROMO-EVNT-KEY               02135200
              PERFORM 9999-WRITE-ERROR-REPORT                           02135300
              SET PS-ERROR-FOUND     TO TRUE                            02135400
           END-IF.                                                      02135500
                                                                        02135600
036600     IF PM708-STYLE-ID NOT EQUAL XS021-STYL-ID                    02135700
              MOVE 'PM708-STYLE-ID' TO PROMO-RPT-DATA-NAME              02135800
              MOVE PM708-STYLE-ID   TO PROMO-RPT-DATA-VALUE             02135900
              MOVE PV-PROMO-SOURCE         TO REPORT-NOTES              02136000
              MOVE PV-PROMO-KEY        TO PROMO-EVNT-KEY                02136100
              PERFORM 9999-WRITE-ERROR-REPORT                           02136200
              MOVE 'XS021-STYL-ID' TO PROMO-RPT-DATA-NAME               02136300
              MOVE XS021-STYL-ID TO PROMO-RPT-DATA-VALUE                02136400
              MOVE PV-DOMAIN-SOURCE         TO REPORT-NOTES             02136500
              MOVE PV-DOMAIN-KEY        TO PROMO-EVNT-KEY               02136600
              PERFORM 9999-WRITE-ERROR-REPORT                           02136700
              SET PS-ERROR-FOUND     TO TRUE                            02136800
           END-IF.                                                      02136900
                                                                        02137000
036600     IF PM708-SKU-NBR NOT EQUAL XS021-SKU-NBR                     02137100
              MOVE 'PM708-SKU-NBR' TO PROMO-RPT-DATA-NAME               02137200
              MOVE PM708-SKU-NBR   TO PROMO-RPT-DATA-VALUE              02137300
              MOVE PV-PROMO-SOURCE         TO REPORT-NOTES              02137400
              MOVE PV-PROMO-KEY        TO PROMO-EVNT-KEY                02137500
              PERFORM 9999-WRITE-ERROR-REPORT                           02137600
              MOVE 'XS021-SKU-NBR' TO PROMO-RPT-DATA-NAME               02137700
              MOVE XS021-SKU-NBR TO PROMO-RPT-DATA-VALUE                02137800
              MOVE PV-DOMAIN-SOURCE         TO REPORT-NOTES             02137900
              MOVE PV-DOMAIN-KEY        TO PROMO-EVNT-KEY               02138000
              PERFORM 9999-WRITE-ERROR-REPORT                           02138100
              SET PS-ERROR-FOUND     TO TRUE                            02138200
           END-IF.                                                      02138300
                                                                        02138400
036600     IF PM708-STAT-CDE  NOT EQUAL XS021-STAT-CDE                  02138500
              MOVE 'PM708-STAT-CDE'   TO PROMO-RPT-DATA-NAME            02138600
              MOVE PM708-STAT-CDE           TO PROMO-RPT-DATA-VALUE     02138700
              MOVE PV-PROMO-SOURCE         TO REPORT-NOTES              02138800
              MOVE PV-PROMO-KEY        TO PROMO-EVNT-KEY                02138900
              PERFORM 9999-WRITE-ERROR-REPORT                           02139000
              MOVE 'XS021-STAT-CDE'   TO PROMO-RPT-DATA-NAME            02139100
              MOVE XS021-STAT-CDE     TO PROMO-RPT-DATA-VALUE           02139200
              MOVE PV-DOMAIN-SOURCE         TO REPORT-NOTES             02139300
              MOVE PV-DOMAIN-KEY        TO PROMO-EVNT-KEY               02139400
              PERFORM 9999-WRITE-ERROR-REPORT                           02139500
              SET PS-ERROR-FOUND     TO TRUE                            02139600
           END-IF.                                                      02139700
                                                                        02139800
                                                                        02139900
           IF  PS-ERROR-FOUND                                           02140000
037200        IF PM708-LAST-UPD-TMST > XS021-LAST-UPD-TMST              02150000
                 PERFORM 9999-FORMAT-ERROR-RECORD                       02160000
                 PERFORM 9999-WRITE-ERROR-RECORD                        02170000
              END-IF                                                    02180000
           END-IF.                                                      02190000
054500                                                                  02200000
056900 2100-EXIT.                                                       02210000
057000     EXIT.                                                        02220000
043600 EJECT.                                                           02230000
043610                                                                  02240000
                                                                        02250000
      ******************************************************************02260000
      **COMPARES FIELDS BETWEEN FILES TO SEE IF ANY DIFFERENCES EXIST   02270000
      ******************************************************************02280000
       3000-PROCESS-EXTRA-RECORDS.                                      02290000
                                                                        02300000
           IF  PS-NOT-EOF-PROMO                                         02310000
               INITIALIZE REPORT-DETAIL                                 02320000
               MOVE PV-PROMO-NF             TO REPORT-NOTES             02330000
               MOVE PV-PROMO-KEY             TO PROMO-EVNT-KEY          02340000
               PERFORM 9999-WRITE-ERROR-REPORT                          02350000
               MOVE PM708-PRICING-EXCLSNS-RECORD TO ERROR-RECORD        02360000
               PERFORM 9999-WRITE-ERROR-RECORD                          02370000
               PERFORM 9999-READ-PROMO-EXTRACT                          02380000
           END-IF.                                                      02390000
                                                                        02400000
           IF  PS-NOT-EOF-DOMAIN                                        02410000
P11215      IF XS021-STAT-CDE = 'D'                                     02411000
P11215          PERFORM 9999-READ-DOMAIN-EXTRACT                        02412000
P11215      ELSE                                                        02413000
               INITIALIZE REPORT-DETAIL                                 02420000
               MOVE PV-DOMAIN-NF             TO REPORT-NOTES            02430000
               MOVE PV-DOMAIN-KEY            TO PROMO-EVNT-KEY          02440000
               PERFORM 9999-WRITE-ERROR-REPORT                          02450000
               MOVE XS021-PRICING-EXCLSNS-RECORD TO ERROR-RECORD        02460000
               PERFORM 9999-WRITE-ERROR-RECORD                          02470000
               PERFORM 9999-READ-DOMAIN-EXTRACT                         02480000
P11215      END-IF                                                      02481000
           END-IF.                                                      02490000
                                                                        02500000
056900 3000-EXIT.                                                       02510000
057000     EXIT.                                                        02520000
                                                                        02530000
       EJECT.                                                           02540000
059800*----------------------------------------------------------       02550000
059900* 9999-WRAPUP.                                                    02560000
059910*     MOVES ALL ERROR CODES TO THE LINKAGE VARIABLES TO           02570000
059920*     BE PASSED BACK TO THE CALLING PROGRAM.  EXITS THE           02580000
059930*     PROGRAM.                                                    02590000
060000*----------------------------------------------------------       02600000
060100 9999-WRAPUP.                                                     02610000
026600     CLOSE PROMO-EXTRACT-FILE                                     02620000
026600           DOMAIN-EXTRACT-FILE                                    02630000
026600           ERROR-FILE                                             02640000
026600           REPORT-FILE.                                           02650000
                                                                        02660000
           IF  PC-ERROR-RECORD-WRITTEN > 0                              02670000
               MOVE 04               TO RETURN-CODE                     02680000
           END-IF.                                                      02690000
                                                                        02700000
                                                                        02710000
060500                                                                  02720000
060710*9999-EXIT.                                                       02730000
060800 EJECT.                                                           02740000
      ***************************************************************** 02750000
      **FORMAT ERROR-RECORD                                             02760000
      ***************************************************************** 02770000
       9999-FORMAT-ERROR-RECORD.                                        02780000
           MOVE PM708-PRICING-EXCLSNS-RECORD TO ERROR-RECORD.           02790000
                                                                        02800000
       EJECT.                                                           02810000
      ***************************************************************** 02820000
      **READ PROMO  EXTRACT FILE                                        02830000
      ***************************************************************** 02840000
       9999-READ-PROMO-EXTRACT.                                         02850000
           IF  PS-NOT-EOF-PROMO                                         02860000
               READ PROMO-EXTRACT-FILE INTO PM708-PRICING-EXCLSNS-RECORD02870000
                    AT END                                              02880000
                       SET PS-EOF-PROMO TO TRUE                         02890000
               END-READ                                                 02900000
           END-IF.                                                      02910000
                                                                        02920000
           IF  PS-NOT-EOF-PROMO                                         02930000
             ADD +1                  TO PC-PROMO-EXTRACT-RECS-READ      02940000
             MOVE PM708-PROMO-INTFC-ID      TO PV-PM-PROMO-INTFC-ID     02950000
             MOVE PM708-MDSE-LNE-ID         TO PV-PM-MDSE-LNE-ID        02960000
             MOVE PM708-PROMO-INTFC-SUB-ID  TO PV-PM-PROMO-INTFC-SUB-ID 02970000
             MOVE PM708-MDSE-LNE-EXCLN-ID   TO PV-PM-MDSE-LNE-EXCLN-ID  02980000
                                                                        02990000
           END-IF.                                                      03000000
                                                                        03010000
       EJECT.                                                           03020000
      ***************************************************************** 03030000
      **READ XS EXTRACT FILE                                            03040000
      ***************************************************************** 03050000
       9999-READ-DOMAIN-EXTRACT.                                        03060000
           IF  PS-NOT-EOF-DOMAIN                                        03070000
               READ DOMAIN-EXTRACT-FILE INTO                            03080000
                                    XS021-PRICING-EXCLSNS-RECORD        03090000
                    AT END                                              03100000
                       SET PS-EOF-DOMAIN TO TRUE                        03110000
               END-READ                                                 03120000
           END-IF.                                                      03130000
                                                                        03140000
           IF  PS-NOT-EOF-DOMAIN                                        03150000
            ADD +1              TO PC-DOMAIN-EXTRACT-RECS-READ          03160000
            MOVE XS021-PROMO-INTFC-ID      TO PV-XS-PROMO-INTFC-ID      03170000
            MOVE XS021-MDSE-LNE-ID         TO PV-XS-MDSE-LNE-ID         03180000
            MOVE XS021-PROMO-INTFC-SUB-ID  TO PV-XS-PROMO-INTFC-SUB-ID  03190000
            MOVE XS021-MDSE-LNE-EXCLN-ID   TO PV-XS-MDSE-LNE-EXCLN-ID   03200000
           END-IF.                                                      03210000
                                                                        03220000
       EJECT.                                                           03230000
      ***************************************************************** 03240000
      **READ CONTROL CARD FOR FREQUENCY OF COMPARE                      03250000
      ***************************************************************** 03260000
       9999-READ-CONTROL-CARD.                                          03270000
                                                                        03280000
           READ CONTROL-CARD INTO CONTROL-CARD-LAYOUT.                  03290000
                                                                        03300000
       EJECT.                                                           03310000
      ***************************************************************** 03320000
      **WRITE ERROR RECORD                                              03330000
      ***************************************************************** 03340000
       9999-WRITE-ERROR-RECORD.                                         03350000
                                                                        03360000
           WRITE DIFFERENCES-RECORD FROM ERROR-RECORD.                  03370000
                                                                        03380000
           ADD +1                       TO PC-ERROR-RECORD-WRITTEN.     03390000
                                                                        03400000
       EJECT.                                                           03410000
      ***************************************************************** 03420000
      **WRITE ERROR REPORT                                              03430000
      ***************************************************************** 03440000
       9999-WRITE-ERROR-REPORT.                                         03450000
           IF PC-ERROR-REPORT-WRITTEN > 66                              03460000
              PERFORM 9999-PRINT-HEADINGS                               03470000
           ELSE                                                         03480000
              WRITE REPORT-RECORD FROM REPORT-DETAIL                    03490000
              INITIALIZE REPORT-DETAIL                                  03500000
              ADD +1 TO PC-ERROR-REPORT-WRITTEN                         03510000
           END-IF.                                                      03520000
                                                                        03530000
       EJECT.                                                           03540000
      ***************************************************************** 03550000
      **PRINT HEADINGS                                                  03560000
      ***************************************************************** 03570000
       9999-PRINT-HEADINGS.                                             03580000
           ADD 1 TO PC-PAGE-CNT.                                        03590000
           MOVE PC-PAGE-CNT TO DP132O-PAGE-NUMBER.                      03600000
           MOVE ZEROS TO PC-ERROR-REPORT-WRITTEN.                       03610000
                                                                        03620000
491700     WRITE REPORT-RECORD                                          03630000
491800         FROM DP132O-STANDRD-HEADER-132-COLS                      03640000
491900         AFTER ADVANCING PAGE.                                    03650000
           ADD +1                       TO PC-ERROR-REPORT-WRITTEN.     03660000
                                                                        03670000
491700     WRITE REPORT-RECORD                                          03680000
491800         FROM DR-HEAD2                                            03690000
491900         AFTER ADVANCING 1 LINE.                                  03700000
           ADD +1                       TO PC-ERROR-REPORT-WRITTEN.     03710000
                                                                        03720000
491700     WRITE REPORT-RECORD                                          03730000
491800         FROM DR-HEAD3                                            03740000
491900         AFTER ADVANCING 2 LINE.                                  03750000
           ADD +2                       TO PC-ERROR-REPORT-WRITTEN.     03760000
                                                                        03770000
491700     WRITE REPORT-RECORD                                          03780000
491800         FROM DR-HEAD5                                            03790000
491900         AFTER ADVANCING 1 LINE.                                  03800000
                                                                        03810000
           ADD +1                       TO PC-ERROR-REPORT-WRITTEN.     03820000
                                                                        03830000
       EJECT.                                                           03840000
