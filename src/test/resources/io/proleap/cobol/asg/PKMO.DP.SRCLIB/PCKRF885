000100 IDENTIFICATION DIVISION.                                         00010018
000200 PROGRAM-ID.             PCKRF885.                                00020018
000300 AUTHOR.                 LYNN MCADAMS.                            00030018
000400 INSTALLATION.           KOHLS.                                   00040018
000500 DATE-WRITTEN            MARCH, 2001.                             00050018
000600 DATE-COMPILED.                                                   00060018
000700                                                                  00070018
000800******************************************************************00080018
000900* THIS PROGRAM IS DISPLAYED BY SELECTING OPTION 2, LABEL          00090018
001000* FUNCTIONS, ON THE MANIFESTING MENU (PCKRF850) SCREEN.           00100018
001100*                                                                 00110018
001200* THIS PROGRAM DISPLAYS THE LABEL FUNCTIONS SUBMENU ON THE        00120018
001300* LRT (LASER RADIO TERMINAL) AND PASSES CONTROL TO THE PROGRAM    00130018
001400* WHICH PROCESSES THE SELECTED FUNCTION.                          00140018
001500******************************************************************00150018
001600                                                                  00160018
001700 ENVIRONMENT DIVISION.                                            00170018
001800 DATA DIVISION.                                                   00180018
001900                                                                  00190018
002000 WORKING-STORAGE SECTION.                                         00200018
002100 01  CA-COMMAREA.                                                 00210018
002200     05  CA-COMMON-DATA.                                          00220018
002300         10  CA-TRANSACTION-STATUS                                00230018
002400                                         PIC  X(01)  VALUE SPACE. 00240018
002500             88  CA-INITIALIZE-SCREEN                VALUE 'S'.   00250018
002600             88  CA-PROCESS-SCREEN                   VALUE 'R'.   00260018
002700         10  CA-LAST-PROGRAM             PIC  X(08)  VALUE SPACE. 00270018
002800     05  CA-PROGRAM-DATA.                                         00280018
002900         10  CA-SELECTION-X              PIC  X(01)  VALUE SPACE. 00290026
003000             88  CA-VALID-SELECTION                  VALUE        00300018
003100                 '1', '3', 'T'.                                   00310027
003200             88  CA-SELECTION-TEST                   VALUE 'T'.   00320018
003300         10  CA-SELECTION  REDEFINES  CA-SELECTION-X              00330018
003400                                         PIC  9(01).              00340018
003500             88  CA-SELECTION-ONE                    VALUE 1.     00350018
003600*            88  CA-SELECTION-TWO                    VALUE 2.     00360018
003610             88  CA-SELECTION-THREE                  VALUE 3.     00361020
003700         10  CA-FILLER1                  PIC  X(290) VALUE SPACE. 00370018
003800                                                                  00380018
003900 01  CA-COMMAREA-2.                                               00390018
004000     COPY PCWS033.                                                00400018
004100                                                                  00410018
004200* HELP SCREEN COMMAREA                                            00420018
004300     COPY PCWS192.                                                00430018
004400* HELP SCREEN WORK AREA                                           00440018
004500     COPY PCWS188.                                                00450018
004600/                                                                 00460018
004700 01  PC-PROGRAM-CONSTANTS.                                        00470018
004800     05  PC-CURRENT-PROGRAM-NAME         PIC  X(08)  VALUE        00480018
004900         'PCKRF885'.                                              00490018
005000     05  PC-MANF-MENU-PGM                PIC  X(08)  VALUE        00500018
005100         'PCKRF850'.                                              00510018
005200     05  PC-MENU-TRANID                  PIC  X(04)  VALUE 'E885'.00520018
005300     05  PC-CHECK-AUTH-FOR-TRAN-E851     PIC  X(04)  VALUE 'E851'.00530018
005400     05  PC-CHECK-AUTH-FOR-TRAN-E886     PIC  X(04)  VALUE 'E886'.00540018
005500     05  PC-END-OF-SESSION-MSG           PIC  X(19)  VALUE        00550018
005600         'END OF SESSION     '.                                   00560018
005700     05  PC-INVALID-SELECTION-MSG        PIC  X(19)  VALUE        00570018
005800         'INVALID SELECTION  '.                                   00580018
005900     05  PC-UNRECOGNIZED-PF-KEY-MSG      PIC  X(19)  VALUE        00590018
006000         'UNRECOGNIZED PF KEY'.                                   00600018
006100     05  PC-ACCESS-NOT-ALLOWED-MSG       PIC  X(19)  VALUE        00610018
006200         'USER NOT AUTHORIZED'.                                   00620018
006300     05  PC-NON-NUMERIC-SELECTION-MSG    PIC  X(19)  VALUE        00630018
006400         'NUMERIC VALUE REQ. '.                                   00640018
006500     05  PC-PROGRAM-FUNCTION-KEYS        PIC  X(19)  VALUE        00650018
006600         'F3 =END            '.                                   00660018
006700     05  PC-TRANS-UNAVAILABLE-MSG        PIC  X(19)  VALUE        00670018
006800         'TRANS NOT AVAILABLE'.                                   00680018
006900     05  PC-CICS-ABEND-MSG               PIC  X(19)  VALUE        00690018
007000         'CICS ABEND -CALL DP'.                                   00700018
007100     05  PC-CICSAUTH-MSG                 PIC  X(19)  VALUE        00710018
007200         'CICSAUTH BAD RETURN'.                                   00720018
007300     05  PC-UNAVAIL-SELECTION-MSG        PIC X(19)   VALUE        00730018
007400         'SELECTION NOT AVAIL'.                                   00740018
007500                                                                  00750018
007900 01  PN-PGM-NAME-DATA.                                            00790018
008110     05  PN-SELECTION-01-PROGRAM         PIC  X(08)  VALUE        00811027
008120         'PCKRF859'.                                              00812024
008200     05  PN-SELECTION-02-PROGRAM         PIC  X(08)  VALUE        00820018
008300         'PCKRF886'.                                              00830018
008310     05  PN-SELECTION-03-PROGRAM         PIC  X(08)  VALUE        00831019
008320         'PCKRF859'.                                              00832019
008400                                                                  00840018
008500 01  PN-PGM-NAME-TABLE  REDEFINES  PN-PGM-NAME-DATA.              00850018
008600     05  PN-PGM-NAME  OCCURS 3 TIMES                              00860019
008700                      INDEXED BY PN-INDX                          00870018
008800                                         PIC  X(08).              00880018
008900                                                                  00890018
009000 01  PS-PROGRAM-SWITCHES.                                         00900018
009100     05  PS-ACCESS-ALLOWED-IND           PIC  X(01)  VALUE 'N'.   00910018
009200         88  PS-NO-ACCESS-ALLOWED                    VALUE 'N'.   00920018
009300         88  PS-ACCESS-ALLOWED                       VALUE 'Y'.   00930018
009400                                                                  00940018
009500 01  PV-PROGRAM-VARIABLES.                                        00950018
009600     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     00960018
009700                                                     COMP SYNC.   00970018
009800     05  PV-MESSAGE-AREA                 PIC  X(19)  VALUE SPACE. 00980018
009900     05  PV-CICS-RESPONSE                PIC S9(08)  VALUE ZEROS  00990018
010000                                                     COMP SYNC.   01000018
010100     05  PV-TRANSFER-PROGRAM             PIC  X(08)  VALUE SPACE. 01010018
010200                                                                  01020018
010300     COPY DPWS026.                                                01030018
010400                                                                  01040018
010500*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA.               01050018
010600     COPY DPWS013.                                                01060018
010700                                                                  01070018
010800*    COPY BOOK FOR THE CICSAUTH SUBROUTINE                        01080018
010900     COPY DPWS008.                                                01090018
011000                                                                  01100018
011100*  SENDING/RECEIVING AREA FOR THE NUMERIC EDIT ROUTINE (DPKUT100) 01110018
011200     COPY DPWS010I.                                               01120018
011300                                                                  01130018
011400*  MAPSET                                                         01140018
011500     COPY PCKM885.                                                01150018
011600                                                                  01160018
011700*  KOHL'S STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST   01170018
011800     COPY DPWS015.                                                01180018
011900                                                                  01190018
012000     COPY DFHAID.                                                 01200018
012100                                                                  01210018
012200 LINKAGE SECTION.                                                 01220018
012300 01  DFHCOMMAREA.                                                 01230018
012400     05  FILLER                       OCCURS 1 TO 4072 TIMES      01240018
012500                                      DEPENDING ON EIBCALEN.      01250018
012600         10  FILLER                   PIC X.                      01260018
012700/                                                                 01270018
012800 PROCEDURE DIVISION.                                              01280018
012900 0000-PROGRAM-MAINLINE.                                           01290018
013000     INITIALIZE                         CA-COMMAREA.              01300018
013100     MOVE DFHCOMMAREA                TO CA-COMMAREA.              01310018
013200     MOVE LOW-VALUES                 TO PC885AI.                  01320018
013300                                                                  01330018
013400     EVALUATE TRUE                                                01340018
013500         WHEN EIBCALEN = ZERO                                     01350018
013600         WHEN EIBTRNID = 'Z278'                                   01360018
013700         WHEN EIBAID = DFHCLEAR                                   01370018
013800         WHEN CA-INITIALIZE-SCREEN                                01380018
013900              INITIALIZE CA-COMMAREA                              01390018
014000              PERFORM 8000-SEND-MAP                               01400018
014100              PERFORM 8200-RETURN-TRANID                          01410018
014200         WHEN EIBAID = DFHENTER                                   01420018
014300              PERFORM 1000-RECEIVE-MAP                            01430018
014400              PERFORM 1100-EDIT-SELECTION                         01440018
014500         WHEN EIBAID = DFHPF3                                     01450018
014600              MOVE PC-MANF-MENU-PGM TO PV-TRANSFER-PROGRAM        01460018
014700              PERFORM 2100-XCTL-TO-SELECTED-PROGRAM               01470018
014800         WHEN EIBAID = DFHPF1                                     01480018
014900              PERFORM 1200-HELP-SCREEN                            01490018
015000         WHEN OTHER                                               01500018
015100              MOVE PC-UNRECOGNIZED-PF-KEY-MSG                     01510018
015200                                     TO AMSGLNO                   01520018
015300              PERFORM 8100-SEND-DATA-ONLY                         01530018
015400              PERFORM 8200-RETURN-TRANID                          01540018
015500     END-EVALUATE.                                                01550018
015600                                                                  01560018
015700     GOBACK.                                                      01570018
015800*                                                                 01580018
015900*                                                                 01590018
016000 1000-RECEIVE-MAP.                                                01600018
016100     EXEC CICS                                                    01610018
016200         RECEIVE MAP    ('PC885A')                                01620018
016300                 MAPSET ('PCKM885')                               01630018
016400                 RESP   (PV-CICS-RESPONSE)                        01640018
016500     END-EXEC.                                                    01650018
016600                                                                  01660018
016700     EVALUATE TRUE                                                01670018
016800         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 01680018
016900              PERFORM 1010-RECEIVE-SCREEN-FIELDS                  01690018
017000         WHEN PV-CICS-RESPONSE = DFHRESP (MAPFAIL)                01700018
017100              CONTINUE                                            01710018
017200         WHEN OTHER                                               01720018
017300              MOVE '1000-RECEIVE-MAP'                             01730018
017400                                     TO DP013-PARAGRAPH           01740018
017500              MOVE 'UNABLE TO RECEIVE MAP'                        01750018
017600                                     TO DP013-MESSAGE-TEXT (1)    01760018
017700              SET DP013-LOGIC-ABEND  TO TRUE                      01770018
017800              SET DP013-NO-ROLLBACK  TO TRUE                      01780018
017900              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              01790018
018000     END-EVALUATE.                                                01800018
018100*                                                                 01810018
018200*                                                                 01820018
018300 1010-RECEIVE-SCREEN-FIELDS.                                      01830018
018400     IF  ASELECTL > ZERO                                          01840018
018500         MOVE ASELECTI               TO CA-SELECTION-X            01850018
018600     END-IF.                                                      01860018
018700*                                                                 01870018
018800*                                                                 01880018
018900 1100-EDIT-SELECTION.                                             01890018
019000                                                                  01900018
019100     IF  CA-SELECTION-TEST                                        01910018
019200         CONTINUE                                                 01920018
019300     ELSE                                                         01930018
019400         MOVE CA-SELECTION-X         TO DP010I-UNEDITED-FIELD     01940018
019500         MOVE 1                      TO DP010I-MAXIMUM-DIGITS     01950018
019600         MOVE 0                      TO DP010I-MAXIMUM-DECIMALS   01960018
019700         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  01970018
019800                                                                  01980018
019910         CALL DP010I-NUMERIC-EDIT-ROUTINE                         01991030
019920                         USING DP010I-NUMERIC-EDIT-AREA           01992030
020000                                                                  02000018
020100         IF  DP010I-ERROR-DETECTED                                02010018
020200             MOVE PC-NON-NUMERIC-SELECTION-MSG TO AMSGLNO         02020018
020300             PERFORM 8100-SEND-DATA-ONLY                          02030018
020400             PERFORM 8200-RETURN-TRANID                           02040018
020500         ELSE                                                     02050018
020600             MOVE DP010I-NUMERIC-FIELD   TO CA-SELECTION          02060018
020700         END-IF                                                   02070018
020800     END-IF.                                                      02080018
020900                                                                  02090018
021000     EVALUATE TRUE                                                02100018
021100     WHEN CA-VALID-SELECTION                                      02110021
021200         PERFORM 2000-PROCESS-SELECTION                           02120018
021300     WHEN OTHER                                                   02130018
021400         MOVE DP015-UNP-ALP-BRT-MDT  TO ASELECTA                  02140018
021500         MOVE PC-INVALID-SELECTION-MSG                            02150018
021600                                     TO AMSGLNO                   02160018
021700         PERFORM 8100-SEND-DATA-ONLY                              02170018
021800         PERFORM 8200-RETURN-TRANID                               02180018
021900     END-EVALUATE.                                                02190018
022000*                                                                 02200018
022100*                                                                 02210018
022200 1200-HELP-SCREEN.                                                02220018
022300     MOVE 'DPKRF278'                  TO PV-TRANSFER-PROGRAM      02230018
022400     MOVE 'PCKRF885'                  TO PC192-PROGRAM-NAME       02240018
022500     COPY PCPD188.                                                02250018
022600     MOVE PC188-DISPLAY-DATE          TO PC192-DISPLAY-DATE.      02260018
022700     PERFORM 2200-XCTL-TO-HELP.                                   02270018
022800*                                                                 02280018
022900*                                                                 02290018
023000 2000-PROCESS-SELECTION.                                          02300018
023100     SET PN-INDX                     TO CA-SELECTION.             02310018
023200     IF CA-SELECTION < 3                                          02320018
023300         PERFORM 9000-CHECK-RACF                                  02330018
023400     ELSE                                                         02340018
023900         MOVE PN-PGM-NAME (PN-INDX)  TO PV-TRANSFER-PROGRAM       02390027
024000         PERFORM 2100-XCTL-TO-SELECTED-PROGRAM                    02400018
024200     END-IF.                                                      02420018
024300                                                                  02430018
024400     IF  PS-ACCESS-ALLOWED                                        02440018
024500         MOVE PN-PGM-NAME (PN-INDX)  TO PV-TRANSFER-PROGRAM       02450018
024600         PERFORM 2100-XCTL-TO-SELECTED-PROGRAM                    02460018
024700     ELSE                                                         02470018
024800         MOVE DP015-UNP-ALP-BRT-MDT  TO ASELECTA                  02480018
024900         PERFORM 8100-SEND-DATA-ONLY                              02490018
025000         PERFORM 8200-RETURN-TRANID                               02500018
025100     END-IF.                                                      02510018
025300*                                                                 02530018
025400 2100-XCTL-TO-SELECTED-PROGRAM.                                   02540018
025500                                                                  02550018
025600     INITIALIZE PC033-COMMON-DATA.                                02560018
025700     SET PC033-INITIALIZE-SCREEN     TO TRUE.                     02570018
025800     MOVE PC-CURRENT-PROGRAM-NAME    TO PC033-LAST-PROGRAM.       02580018
025810     MOVE CA-SELECTION               TO PC033-UNUSD-OR-RCLM-SW.   02581025
025900                                                                  02590018
026000     PERFORM DP026-0000-GET-LOGON-INFO.                           02600018
026100     MOVE DP026-USERID                TO PC033-USER-ID.           02610018
026200     MOVE DP026-LOCATION-NBR          TO PC033-OPER-UNT-ID        02620028
026300     MOVE DP026-FCLTY-ID              TO PC033-FCLTY-ID           02630018
026500     MOVE DP026-QUEUE-TERM            TO PC033-TERM-ID            02650018
026600     SET PC033-PROCESS-BY-UPC         TO TRUE                     02660018
026700                                                                  02670018
026800                                                                  02680018
026900     MOVE LENGTH OF CA-COMMAREA-2 TO PV-COMMAREA-LENGTH           02690018
027000                                                                  02700018
027100     EXEC CICS                                                    02710018
027200         XCTL                                                     02720018
027300             PROGRAM   (PV-TRANSFER-PROGRAM)                      02730018
027400             COMMAREA  (PC033-COMMON-DATA)                        02740018
027500             LENGTH    (PV-COMMAREA-LENGTH)                       02750018
027600             RESP      (PV-CICS-RESPONSE)                         02760018
027700     END-EXEC.                                                    02770018
027800                                                                  02780018
027900     EVALUATE TRUE                                                02790018
028000         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 02800018
028100              CONTINUE                                            02810018
028200         WHEN OTHER                                               02820018
028300              MOVE '2100-XCTL-TO-SELECTED-PROGRAM'                02830018
028400                                     TO DP013-PARAGRAPH           02840018
028500              MOVE 'UNABLE TO XCTL THE FOLLOWING PROGRAM: '       02850018
028600                                     TO DP013-MESSAGE-TEXT (1)    02860018
028700              MOVE PV-TRANSFER-PROGRAM                            02870018
028800                                     TO DP013-MESSAGE-TEXT (2)    02880018
028900              SET DP013-CICS-ABEND   TO TRUE                      02890018
029000              SET DP013-NO-ROLLBACK  TO TRUE                      02900018
029100              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              02910018
029200              MOVE PC-TRANS-UNAVAILABLE-MSG                       02920018
029300                                     TO AMSGLNO                   02930018
029400              SET CA-PROCESS-SCREEN TO TRUE                       02940018
029500              PERFORM 8100-SEND-DATA-ONLY                         02950018
029600              PERFORM 8200-RETURN-TRANID                          02960018
029700     END-EVALUATE.                                                02970018
029800                                                                  02980018
029900     COPY DPPD026.                                                02990018
030000*                                                                 03000018
030100 2200-XCTL-TO-HELP.                                               03010018
030200                                                                  03020018
030300     MOVE LENGTH OF PC192-COMMAREA    TO PV-COMMAREA-LENGTH       03030018
030400                                                                  03040018
030500     EXEC CICS                                                    03050018
030600         XCTL                                                     03060018
030700             PROGRAM   (PV-TRANSFER-PROGRAM)                      03070018
030800             COMMAREA  (PC192-COMMAREA)                           03080018
030900             LENGTH    (PV-COMMAREA-LENGTH)                       03090018
031000             RESP      (PV-CICS-RESPONSE)                         03100018
031100     END-EXEC.                                                    03110018
031200                                                                  03120018
031300     EVALUATE TRUE                                                03130018
031400         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 03140018
031500              CONTINUE                                            03150018
031600         WHEN OTHER                                               03160018
031700              MOVE '2200-XCTL-TO-HELP'                            03170018
031800                                     TO DP013-PARAGRAPH           03180018
031900              MOVE 'UNABLE TO XCTL THE FOLLOWING PROGRAM: '       03190018
032000                                     TO DP013-MESSAGE-TEXT (1)    03200018
032100              MOVE PV-TRANSFER-PROGRAM                            03210018
032200                                     TO DP013-MESSAGE-TEXT (2)    03220018
032300              SET DP013-CICS-ABEND   TO TRUE                      03230018
032400              SET DP013-NO-ROLLBACK  TO TRUE                      03240018
032500              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              03250018
032600              MOVE PC-TRANS-UNAVAILABLE-MSG                       03260018
032700                                     TO AMSGLNO                   03270018
032800              SET CA-PROCESS-SCREEN TO TRUE                       03280018
032900              PERFORM 8100-SEND-DATA-ONLY                         03290018
033000              PERFORM 8200-RETURN-TRANID                          03300018
033100     END-EVALUATE.                                                03310018
033200*                                                                 03320018
033300*                                                                 03330018
033400 8000-SEND-MAP.                                                   03340018
033500     EXEC CICS                                                    03350018
033600         SEND MAP       ('PC885A')                                03360018
033700              MAPSET    ('PCKM885')                               03370018
033800              ERASE                                               03380018
033900              RESP      (PV-CICS-RESPONSE)                        03390018
034000     END-EXEC.                                                    03400018
034100                                                                  03410018
034200     EVALUATE TRUE                                                03420018
034300         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 03430018
034400              CONTINUE                                            03440018
034500         WHEN OTHER                                               03450018
034600              MOVE '8000-SEND-MAP'   TO DP013-PARAGRAPH           03460018
034700              MOVE 'UNABLE TO SEND MAP'                           03470018
034800                                     TO DP013-MESSAGE-TEXT (1)    03480018
034900              SET DP013-CICS-ABEND   TO TRUE                      03490018
035000              SET DP013-NO-ROLLBACK  TO TRUE                      03500018
035100              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              03510018
035200     END-EVALUATE.                                                03520018
035300*                                                                 03530018
035400*                                                                 03540018
035500 8100-SEND-DATA-ONLY.                                             03550018
035600     MOVE -1 TO ASELECTL.                                         03560018
035700                                                                  03570018
035800     EXEC CICS                                                    03580018
035900         SEND MAP       ('PC885A')                                03590018
036000              MAPSET    ('PCKM885')                               03600018
036100              CURSOR                                              03610018
036200              DATAONLY                                            03620018
036300              RESP      (PV-CICS-RESPONSE)                        03630018
036400     END-EXEC.                                                    03640018
036500                                                                  03650018
036600     EVALUATE TRUE                                                03660018
036700         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 03670018
036800              CONTINUE                                            03680018
036900         WHEN OTHER                                               03690018
037000              MOVE '8100-SEND-DATA-ONLY'                          03700018
037100                                     TO DP013-PARAGRAPH           03710018
037200              MOVE 'UNABLE TO SEND DATA'                          03720018
037300                                     TO DP013-MESSAGE-TEXT (1)    03730018
037400              SET DP013-CICS-ABEND   TO TRUE                      03740018
037500              SET DP013-NO-ROLLBACK  TO TRUE                      03750018
037600              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              03760018
037700     END-EVALUATE.                                                03770018
037800*                                                                 03780018
037900*                                                                 03790018
038000 8200-RETURN-TRANID.                                              03800018
038100     MOVE LENGTH OF CA-COMMAREA-2     TO PV-COMMAREA-LENGTH       03810018
038200     EXEC CICS                                                    03820018
038300         RETURN TRANSID   (PC-MENU-TRANID)                        03830018
038400                COMMAREA  (CA-COMMAREA)                           03840018
038500                LENGTH    (PV-COMMAREA-LENGTH)                    03850018
038600                RESP      (PV-CICS-RESPONSE)                      03860018
038700     END-EXEC.                                                    03870018
038800                                                                  03880018
038900     EVALUATE TRUE                                                03890018
039000         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 03900018
039100              CONTINUE                                            03910018
039200         WHEN OTHER                                               03920018
039300              MOVE '8200-RETURN-TRANID'                           03930018
039400                                     TO DP013-PARAGRAPH           03940018
039500              MOVE 'UNABLE TO RETURN TO TRANID'                   03950018
039600                                     TO DP013-MESSAGE-TEXT (1)    03960018
039700              SET DP013-CICS-ABEND   TO TRUE                      03970018
039800              SET DP013-NO-ROLLBACK  TO TRUE                      03980018
039900              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              03990018
040000     END-EVALUATE.                                                04000018
040100*                                                                 04010018
040200*                                                                 04020018
040300 9000-CHECK-RACF.                                                 04030018
040400******************************************************************04040018
040500*  CHECK ACCESSS AUTHORITY OF USER                                04050018
040600******************************************************************04060018
040700     SET DP008-RSRC-TYPE-TRAN        TO TRUE.                     04070018
040800     SET DP008-ACCESS-TYPE-USE       TO TRUE.                     04080018
040900                                                                  04090018
041000     EVALUATE TRUE                                                04100018
041100         WHEN CA-SELECTION-ONE                                    04110018
041200              MOVE PC-CHECK-AUTH-FOR-TRAN-E851                    04120018
041300                                      TO DP008-RESOURCE-NAME      04130018
041400*        WHEN CA-SELECTION-TWO                                    04140018
041500*             MOVE PC-CHECK-AUTH-FOR-TRAN-E886                    04150018
041600*                                     TO DP008-RESOURCE-NAME      04160018
041700     END-EVALUATE.                                                04170018
041800                                                                  04180018
041900     EXEC CICS                                                    04190018
042000          LINK PROGRAM  (DP008-SECURITY-SUBROUTINE)               04200018
042100               COMMAREA (DP008-SECURITY-COMMAREA)                 04210018
042200               LENGTH   (DP008-SECURITY-COMMAREA-LENGTH)          04220018
042300               RESP     (PV-CICS-RESPONSE)                        04230018
042400     END-EXEC.                                                    04240018
042500                                                                  04250018
042600     IF  PV-CICS-RESPONSE = DFHRESP(NORMAL)                       04260018
042700         IF  DP008-CALL-SUCCESSFUL                                04270018
042800             IF  DP008-ACCESS-ALLOWED                             04280018
042900                 SET PS-ACCESS-ALLOWED                            04290018
043000                                     TO TRUE                      04300018
043100             ELSE                                                 04310018
043200                 MOVE PC-ACCESS-NOT-ALLOWED-MSG                   04320018
043300                                     TO AMSGLNO                   04330018
043400             END-IF                                               04340018
043500         ELSE                                                     04350018
043600             MOVE PC-CICSAUTH-MSG    TO AMSGLNO                   04360018
043700         END-IF                                                   04370018
043800     ELSE                                                         04380018
043900         MOVE '9000-CHECK-RACF'      TO DP013-PARAGRAPH           04390018
044000         MOVE 'BAD LINK TO RACF PROGRAM'                          04400018
044100                                     TO DP013-MESSAGE-TEXT (1)    04410018
044200         SET DP013-CICS-ABEND        TO TRUE                      04420018
044300         SET DP013-NO-ROLLBACK       TO TRUE                      04430018
044400         PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG                   04440018
044500     END-IF.                                                      04450018
044600*                                                                 04460018
044700*                                                                 04470018
044800 9999-WRITE-MESSAGE-TO-CICS-LOG.                                  04480018
044900     MOVE PC-CURRENT-PROGRAM-NAME    TO DP013-PROGRAM.            04490018
045000     MOVE DFHEIBLK                   TO DP013-DFHEIBLK.           04500018
045100     INITIALIZE DP013-SRC-TASK-NUMBER                             04510018
045200                DP013-STACK.                                      04520018
045300     SET DP013-LINK-RETURN           TO TRUE.                     04530018
045400                                                                  04540018
045500     EXEC CICS                                                    04550018
045600         LINK                                                     04560018
045700             PROGRAM   (DP013-NAME)                               04570018
045800             COMMAREA  (DP013-PARAMETERS)                         04580018
045900             LENGTH    (DP013-LENGTH)                             04590018
046000     END-EXEC.                                                    04600018
