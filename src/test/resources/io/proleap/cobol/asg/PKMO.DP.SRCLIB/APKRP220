000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.     APKRP220.                                        00020000
000300 AUTHOR.         JEAN KURK.                                       00030000
000400*DATE-WRITTEN.   OCTOBER 2022.                                    00040000
000500*DATE-COMPILED.                                                   00050000
000600****************************************************************  00060000
000700* COBOL 2                                                      *  00070000
000800*--------------------------------------------------------------*  00080000
000900* DIRECT IMPORTER MODIFIED PAYMENTS                            *  00090000
001100*--------------------------------------------------------------*  00110000
002000* CHANGE LOG:                                                  *  00200000
002100*                                                              *  00210000
002200* 03/16/23    BY JEAN KURK                                     *  00220032
002300*             ORIGINAL VERSION               CHG0285404        *  00230032
012602****************************************************************  01226000
012603                                                                  01227000
012604 ENVIRONMENT DIVISION.                                            01228000
012605 CONFIGURATION SECTION.                                           01229000
012606                                                                  01230000
012607 SOURCE-COMPUTER. IBM-3090.                                       01240000
012608 OBJECT-COMPUTER. IBM-3090.                                       01250000
012609                                                                  01260000
012610 INPUT-OUTPUT SECTION.                                            01270000
012620 FILE-CONTROL.                                                    01280000
012700                                                                  01290000
012800      SELECT EDI-INP-FILE ASSIGN TO INP01.                        01300005
012900      SELECT EDI-REPORT ASSIGN TO RPT01.                          01310000
013200                                                                  01340000
013300 DATA DIVISION.                                                   01350000
013400 FILE SECTION.                                                    01360000
013500                                                                  01370000
013600 FD  EDI-INP-FILE                                                 01380005
013700     RECORDING MODE IS F                                          01390000
013800     LABEL RECORDS ARE STANDARD                                   01400000
013900     BLOCK CONTAINS 0 RECORDS                                     01410000
014000     DATA RECORD IS EDI-RECORD.                                   01420000
014100 01  EDI-RECORD                  PIC X(350).                      01430030
014200                                                                  01440000
014300 FD  EDI-REPORT                                                   01450000
014400     RECORDING MODE IS F                                          01460000
014500     LABEL RECORDS ARE STANDARD                                   01470000
014600     RECORD CONTAINS 132 CHARACTERS                               01480000
014700     BLOCK CONTAINS 0 RECORDS                                     01490000
014800     DATA RECORD IS EDI-LINE.                                     01500000
014900 01  EDI-LINE                    PIC X(132).                      01510000
015000                                                                  01520000
016700 WORKING-STORAGE SECTION.                                         01690000
016800*--------------------------------------------------------------*  01700000
016900* STANDARD HEADER 132 COLUMNS                                  *  01710000
017000*--------------------------------------------------------------*  01720000
017100     COPY DPWS132O.                                               01730000
017200                                                                  01740000
017300*--------------------------------------------------------------*  01750000
017400* ERROR MESSAGE CODES DESCRIPTIONS                             *  01760000
017500*--------------------------------------------------------------*  01770000
017600     COPY APWS050.                                                01780000
017700                                                                  01790000
017800*--------------------------------------------------------------*  01800000
017900* EDI REJECTION REPORT FILE LAYOUT                             *  01810000
018000*--------------------------------------------------------------*  01820000
018100 01  WS-EDI-INVOIC-REC.                                           01830005
018200     COPY APRD052.                                                01840000
018400                                                                  01860000
018500*--------------------------------------------------------------*  01870000
018600* REPORT LINES                                                 *  01880000
018700*--------------------------------------------------------------*  01890000
018800 01  BLANK-LINE.                                                  01900026
018900     05  FILLER                  PIC X(132)   VALUE ALL ' '.      01910026
019000                                                                  01920000
019700 01  EOR-END-OF-REPORT-LINE.                                      01990000
019800     05  FILLER                  PIC X(37)     VALUE SPACES.      02000000
019900     05  FILLER                  PIC X(25)     VALUE              02010000
020000             'E N D   O F   R E P O R T'.                         02020000
020100     05  FILLER                  PIC X(88)     VALUE SPACES.      02030000
020200                                                                  02040000
025100 01  REPORT-LINE.                                                 02530000
025200     05  FILLER                  PIC X(02)    VALUE SPACES.       02540000
025400     05  RPT-PO-NBR              PIC X(09).                       02560000
025900     05  FILLER                  PIC X(02)    VALUE SPACES.       02610000
026200     05  RPT-INVC-ID             PIC X(22).                       02640000
026300     05  FILLER                  PIC X(01)    VALUE SPACES.       02650000
026400     05  RPT-VNDR-NBR            PIC X(09).                       02660000
026700     05  FILLER                  PIC X(02)    VALUE SPACES.       02690000
027300     05  RPT-VNDR-NAME           PIC X(30).                       02750000
027400     05  FILLER                  PIC X(01)    VALUE SPACES.       02760002
027500     05  PRT-INVC-TOTAL          PIC $$,$$$,$$9.99-.              02770000
027600     05  FILLER                  PIC X(02)    VALUE SPACES.       02780000
027700     05  RPT-INVC-DATE-MM        PIC X(02).                       02790022
027600     05  FILLER                  PIC X(01)    VALUE '/'.          02790102
027700     05  RPT-INVC-DATE-DD        PIC X(02).                       02791022
027600     05  FILLER                  PIC X(01)    VALUE '/'.          02791102
027700     05  RPT-INVC-DATE-YY        PIC X(02).                       02792022
027800     05  FILLER                  PIC X(01)    VALUE SPACE.        02800000
037500                                                                  03770000
037600 01  TYPE4-LINE.                                                  03780000
037700     05  FILLER                  PIC X(32)    VALUE               03790000
037800         'TYPE: 04  TERMS DATA            '.                      03800000
037900     05  FILLER                  PIC X(100)   VALUE SPACES.       03810000
038000 01  TYPE4-LINE2.                                                 03820000
038100     05  FILLER                  PIC X(16)    VALUE               03830000
038200         'TERMS TYPE CD:  '.                                      03840000
038300     05  TYPE4-TERMS-TYPE        PIC X(12)    VALUE SPACES.       03850000
038400     05  FILLER                  PIC X(12)    VALUE SPACES.       03860000
038500     05  FILLER                  PIC X(11)    VALUE               03870000
038600         'DISC PCT: '.                                            03880000
038700     05  FILLER                  PIC X(06)    VALUE SPACES.       03890000
038800     05  TYPE4-DISC-PCT          PIC ZZZ.99-.                     03900000
038900     05  FILLER                  PIC X(01)    VALUE '%'.          03910000
039000     05  FILLER                  PIC X(05)    VALUE SPACES.       03920000
039100     05  FILLER                  PIC X(22)    VALUE               03930000
039200         'DEFERRED PCT PAYABLE: '.                                03940000
039300     05  TYPE4-DEF-PCT-PAY       PIC ZZZ.99-.                     03950000
039400     05  FILLER                  PIC X(01)    VALUE '%'.          03960000
039500     05  FILLER                  PIC X(32)    VALUE SPACES.       03970000
039600 01  TYPE4-LINE3.                                                 03980000
039700     05  FILLER                  PIC X(22)    VALUE               03990000
039800         'TERMS BASIS DATE CD:  '.                                04000000
039900     05  TYPE4-BAS-DTE-CD        PIC X(12)    VALUE SPACES.       04010000
040000     05  FILLER                  PIC X(06)    VALUE SPACES.       04020000
040100     05  FILLER                  PIC X(15)    VALUE               04030000
040200         'DISC DUE DATE: '.                                       04040000
040300     05  TYPE4-DISC-DUE-YY       PIC X(02)    VALUE SPACES.       04050000
040400     05  FILLER                  PIC X(01)    VALUE '/'.          04060000
040500     05  TYPE4-DISC-DUE-MM       PIC X(02)    VALUE SPACES.       04070000
040600     05  FILLER                  PIC X(01)    VALUE '/'.          04080000
040700     05  TYPE4-DISC-DUE-DD       PIC X(02)    VALUE SPACES.       04090000
040800     05  FILLER                  PIC X(07)    VALUE SPACES.       04100000
040900     05  FILLER                  PIC X(20)    VALUE               04110000
041000         'DEFERRED DUE DATE:  '.                                  04120000
041100     05  TYPE4-DEF-DUE-YY        PIC X(02)    VALUE SPACES.       04130000
041200     05  FILLER                  PIC X(01)    VALUE '/'.          04140000
041300     05  TYPE4-DEF-DUE-MM        PIC X(02)    VALUE SPACES.       04150000
041400     05  FILLER                  PIC X(01)    VALUE '/'.          04160000
041500     05  TYPE4-DEF-DUE-DD        PIC X(02)    VALUE SPACES.       04170000
041600     05  FILLER                  PIC X(03)    VALUE SPACES.       04180000
041700     05  FILLER                  PIC X(32)    VALUE SPACES.       04190000
041800 01  TYPE4-LINE4.                                                 04200000
041900     05  FILLER                  PIC X(16)    VALUE               04210000
042000         'NET DUE DATE :  '.                                      04220000
042100     05  TYPE4-NET-DUE-YY        PIC X(02)    VALUE SPACES.       04230000
042200     05  FILLER                  PIC X(01)    VALUE '/'.          04240000
042300     05  TYPE4-NET-DUE-MM        PIC X(02)    VALUE SPACES.       04250000
042400     05  FILLER                  PIC X(01)    VALUE '/'.          04260000
042500     05  TYPE4-NET-DUE-DD        PIC X(02)    VALUE SPACES.       04270000
042600     05  FILLER                  PIC X(16)    VALUE SPACES.       04280000
042700     05  FILLER                  PIC X(15)    VALUE               04290000
042800         'DISC DAYS DUE: '.                                       04300000
042900     05  TYPE4-DISC-DAYS-DUE     PIC ZZ9      VALUE ZEROS.        04310000
043000     05  FILLER                  PIC X(12)    VALUE SPACES.       04320000
043100     05  FILLER                  PIC X(23)    VALUE               04330000
043200         'NET DEFERRED DAYS DUE: '.                               04340000
043300     05  FILLER                  PIC X(02)    VALUE SPACES.       04350000
043400     05  TYPE4-NET-DEF-DAYS      PIC ZZ9.                         04360000
043500     05  FILLER                  PIC X(06)    VALUE SPACES.       04370000
043600     05  FILLER                  PIC X(32)    VALUE SPACES.       04380000
043700 01  TYPE4-LINE5.                                                 04390000
043800     05  FILLER                  PIC X(40)    VALUE SPACES.       04400000
043900     05  FILLER                  PIC X(10)    VALUE               04410000
044000         'DISC AMT: '.                                            04420000
044100     05  TYPE4-DISC-AMT          PIC $$$$,$$$.99-.                04430000
044200     05  FILLER                  PIC X(08)    VALUE SPACES.       04440000
044300     05  FILLER                  PIC X(14)    VALUE               04450000
044400         'DEFERRED AMT: '.                                        04460000
044500     05  FILLER                  PIC X(03)    VALUE SPACES.       04470000
044600     05  TYPE4-DEF-AMT           PIC $$$$,$$$.99-.                04480000
044700     05  FILLER                  PIC X(01)    VALUE SPACES.       04490000
044800     05  FILLER                  PIC X(32)    VALUE SPACES.       04500000
044900                                                                  04510000
045000 01  TYPE5-LINE.                                                  04520000
045100     05  FILLER                  PIC X(32)    VALUE               04530000
045200         'TYPE: 05  ALLOWANCE/CHARGE DATA '.                      04540000
045300     05  FILLER                  PIC X(100)   VALUE SPACES.       04550000
045400 01  TYPE5-LINE2.                                                 04560000
045500     05  FILLER                  PIC X(16)    VALUE               04570000
045600         'ALLW/CHRG TYPE: '.                                      04580000
045700     05  TYPE5-ALLW-CHRG-TYPE    PIC X(11)   VALUE SPACE.         04590000
045800     05  FILLER                  PIC X(08)   VALUE SPACES.        04600000
045900     05  FILLER                  PIC X(16)   VALUE                04610000
046000         'ALLW/CHRG CODE: '.                                      04620000
046100     05  TYPE5-ALLW-CHRG-CD      PIC X(16)   VALUE SPACES.        04630000
046200     05  FILLER                  PIC X(02)   VALUE SPACES.        04640000
046300     05  FILLER                  PIC X(16)   VALUE                04650000
046400         'SPEC SRVC CODE: '.                                      04660000
046500     05  TYPE5-SPEC-SRVC-CD      PIC X(10)   VALUE SPACES.        04670000
046600     05  FILLER                  PIC X(02)   VALUE SPACES.        04680000
046700     05  FILLER                  PIC X(18)   VALUE                04690000
046800         'ALLW/CHRG METHOD: '.                                    04700000
046900     05  TYPE5-ALLW-CHRG-MTHD    PIC X(12)   VALUE SPACES.        04710000
047000     05  FILLER                  PIC X(19)   VALUE SPACES.        04720000
047100 01  TYPE5-LINE3.                                                 04730000
047200     05  FILLER                  PIC X(17)   VALUE                04740000
047300         'ALLW/CHRG TOTAL: '.                                     04750000
047400     05  TYPE5-ALLW-CHRG-TOTL    PIC $$$,$$$,$$$.99-.             04760000
047500     05  FILLER                  PIC X(03)   VALUE SPACES.        04770000
047600     05  FILLER                  PIC X(15)   VALUE                04780000
047700         'ALLW/CHRG PCT: '.                                       04790000
047800     05  TYPE5-ALLW-CHRG-PCT     PIC ZZZ.99-.                     04800000
047900     05  FILLER                  PIC X(01)   VALUE '%'.           04810000
048000     05  FILLER                  PIC X(11)   VALUE SPACES.        04820000
048100     05  FILLER                  PIC X(25)   VALUE                04830000
048200         'ALLW/CHRG PCT QUALIFIER: '.                             04840000
048300     05  TYPE5-ALLW-CHRG-QUAL    PIC X(10)   VALUE SPACE.         04850000
048400     05  FILLER                  PIC X(23)   VALUE SPACES.        04860000
048500                                                                  04870000
059500                                                                  05970000
059600*--------------------------------------------------------------*  05980000
059700* REPORT HEADING LINES                                         *  05990000
059800*--------------------------------------------------------------*  06000000
059900 01  HL-HEADING-LINE1.                                            06010000
060000     05  FILLER                  PIC X(40)     VALUE SPACES.      06020000
060100     05  FILLER                  PIC X(35)     VALUE              06030000
060200             ' IMPORT INVOICES MODIFIED PAYMENTS'.                06040000
060300     05  FILLER                  PIC X(05)     VALUE SPACES.      06050000
060400     05  HEADER-TYPE             PIC X(25)     VALUE SPACES.      06060000
060500     05  FILLER                  PIC X(20)     VALUE SPACES.      06070000
060600                                                                  06080000
060700 01  HL-HEADING-LINE2.                                            06090000
060800     05  FILLER                  PIC X(35)     VALUE              06100000
060900         '  PO NUMBER  INVOICE               '.                   06110000
060800     05  FILLER                  PIC X(43)     VALUE              06131000
060900         ' VENDOR NBR VENDOR NAME           '.                    06132022
061400     05  FILLER                  PIC X(30)     VALUE              06160000
061500         'INVOICE TOTAL  INVC DATE   '.                           06170000
062300                                                                  06250000
064000 01  NO-DATA-LINE.                                                06420000
064100     05  FILLER                  PIC X(44)     VALUE SPACES.      06430000
064200     05  FILLER                  PIC X(41)     VALUE              06440000
064300             ' NO REJECTION INVOICES FOR THIS RUN      '.         06450000
064400     05  FILLER                  PIC X(46)     VALUE SPACES.      06460000
064500                                                                  06470000
064600                                                                  06480000
064700 01  PC-PROGRAM-CONSTANTS.                                        06490000
064800     05  PC-SLASH                PIC X(01)     VALUE '/'.         06500000
064900     05  PC-DASH                 PIC X(01)     VALUE '-'.         06510000
065000 01  PV-PROGRAM-VARIABLES.                                        06520000
065100     05  PV-ABEND-CODE           PIC S9(04)    VALUE ZEROES       06530000
065200                                               COMP.              06540000
065300                                                                  06550000
065400     05  PV-PROGRAM-NAME         PIC X(08)     VALUE 'APKRP220'.  06560000
065500     05  PV-INVC-CNT             PIC S9(09)    VALUE ZEROES.      06570016
065500     05  PV-LINE-COUNT           PIC S9(03)    VALUE 100          06571021
065600                                               COMP-3.            06580000
066300     05  PV-LINE-LIMIT           PIC S9(03)    VALUE +60          06650000
066400                                               COMP-3.            06660000
066500     05  PV-PAGE-COUNT           PIC S9(06)    VALUE ZEROES       06670000
066600                                               COMP-3.            06680000
067300     05  PV-DISC-AMT-DUE         PIC 999,999,999.99-.             06750000
067400     05  PV-GROSS-INV-AMT        PIC 999,999,999.99-.             06760000
067500     05  PV-TOT-INVC-LINES       PIC ZZ,ZZZ,ZZ9.                  06770000
067500     05  PV-HOLD-FIELDS.                                          06771000
067500         10  PV-HOLD-NEXUS       PIC X(01).                       06772012
067500         10  PV-HOLD-PO-NBR      PIC X(09).                       06772112
067500         10  PV-HOLD-INVC        PIC X(22).                       06773000
067500         10  PV-HOLD-DUN-NBR     PIC 9(09).                       06774000
067500         10  PV-HOLD-VNDR-NAME   PIC X(30).                       06775000
067500         10  PV-HOLD-GROSS-AMT   PIC S9(08)V9(02).                06776000
067500         10  PV-HOLD-INVC-DT-MM  PIC 9(02).                       06777002
067500         10  PV-HOLD-INVC-DT-DD  PIC 9(02).                       06777102
067500         10  PV-HOLD-INVC-DT-YY  PIC 9(02).                       06777202
067500         10  PV-HOLD-TERMS-TYP   PIC X(02).                       06777302
067500         10  PV-HOLD-TRMS-BSS-DT PIC X(02).                       06777402
067500         10  PV-HOLD-DISC-PCT    PIC S9(03)V9(02).                06777502
067500         10  PV-HOLD-DISC-DUE-MM PIC 9(02).                       06777602
067500         10  PV-HOLD-DISC-DUE-DD PIC 9(02).                       06777702
067500         10  PV-HOLD-DISC-DUE-YY PIC 9(02).                       06777802
067500         10  PV-HOLD-DISC-DAYS   PIC 9(03).                       06777902
067500         10  PV-HOLD-DISC-AMT    PIC S9(06)V9(02).                06778002
067500         10  PV-HOLD-NET-DUE-MM  PIC 9(02).                       06778102
067500         10  PV-HOLD-NET-DUE-DD  PIC 9(02).                       06778202
067500         10  PV-HOLD-NET-DUE-YY  PIC 9(02).                       06778302
067500         10  PV-HOLD-NET-DEF     PIC 9(03).                       06778402
067500         10  PV-HOLD-PCT-PAY     PIC 9(03).                       06778502
067500         10  PV-HOLD-DEF-DUE-MM  PIC 9(02).                       06778602
067500         10  PV-HOLD-DEF-DUE-DD  PIC 9(02).                       06778702
067500         10  PV-HOLD-DEF-DUE-YY  PIC 9(02).                       06778802
067500         10  PV-HOLD-DEF-AMT     PIC S9(06)V9(02).                06779002
067500         10  PV-HOLD-TYPE4       PIC X(01).                       06779122
067500         10  PV-HOLD-ALLW-ARRAY  OCCURS 10 TIMES INDEXED BY I-IDX.06779222
067500            15  PV-HOLD-IN-USE      PIC X(01).                    06779322
067500            15  PV-HOLD-ALLW-CHG    PIC X(01).                    06779422
067500            15  PV-HOLD-ALLW-CDE    PIC X(03).                    06779522
067500            15  PV-HOLD-SPEC-SRVC   PIC X(10).                    06779622
067500            15  PV-HOLD-CHRG-MTHD   PIC X(02).                    06779722
067500            15  PV-HOLD-CHRG-TOTAL  PIC S9(08)V9(02).             06779822
067500            15  PV-HOLD-CHRG-PCT    PIC S9(03)V9(02).             06779922
067500            15  PV-HOLD-CHRG-PCT-QL PIC X(01).                    06780022
067600                                                                  06781000
067700 01  WS-PROGRAM-SWITCHES.                                         06790000
067800     05  WS-EDI-INP-EOF-SW       PIC X(01)    VALUE 'N'.          06800005
067900         88  WS-EDI-INP-EOF          VALUE 'Y'.                   06810005
068000     05  WS-EDI-EMPTY-FILE-SW    PIC X(01)    VALUE 'N'.          06820000
068100         88  WS-EDI-INP-EMPTY-FILE   VALUE 'Y'.                   06830005
068200     05  WS-REPORT-NEEDED        PIC X(01)    VALUE 'N'.          06840002
068300         88  WS-RPT-NEEDED-YES                VALUE 'Y'.          06850002
068400         88  WS-RPT-NEEDED-NO                 VALUE 'N'.          06860002
070000                                                                  07020000
070100 01  REPORT-TYPE-CONTROL         PIC X(01)     VALUE SPACE.       07030000
070200                                                                  07040000
070300 01  SD-SYSTEM-DATE.                                              07050000
070400     05  SD-SYSTEM-YEAR          PIC 9(02)     VALUE ZEROES.      07060000
070500     05  SD-SYSTEM-MONTH         PIC 9(02)     VALUE ZEROES.      07070000
070600     05  SD-SYSTEM-DAY           PIC 9(02)     VALUE ZEROES.      07080000
070700                                                                  07090000
070800 01  ST-SYSTEM-TIME.                                              07100000
070900     05  ST-SYSTEM-HOUR          PIC 9(02)     VALUE ZEROES.      07110000
071000     05  ST-SYSTEM-MINUTE        PIC 9(02)     VALUE ZEROES.      07120000
071100     05  FILLER                  PIC X(04)     VALUE SPACES.      07130000
071200                                                                  07140000
071800*------------------------*                                        07200000
071900 PROCEDURE DIVISION.                                              07210000
072000*------------------------*                                        07220000
072100 A000-MAIN-DRIVER.                                                07230000
072200                                                                  07240000
072300*--------------------------------------------------------------*  07250000
072400* THIS MODULE CONTROLS THE OVERALL FLOW OF THE PROGRAM THROUGH *  07260000
072500* TO ITS END.                                                  *  07270000
072600*--------------------------------------------------------------*  07280000
072700                                                                  07290000
072800     OPEN INPUT  EDI-INP-FILE                                     07300005
072900          OUTPUT EDI-REPORT.                                      07310000
073200                                                                  07340000
073300     PERFORM H000-HOUSEKEEPING.                                   07350000
073400     IF NOT WS-EDI-INP-EMPTY-FILE                                 07360005
073500        PERFORM B000-PROCESS                                      07370000
073600             UNTIL WS-EDI-INP-EOF                                 07380005
073700     END-IF.                                                      07390000
073800     PERFORM Z900-END-OF-JOB.                                     07400000
073900     STOP RUN.                                                    07410000
074000                                                                  07420000
074100*--------------------------------------------------------------*  07430000
074200* PROCESS THE EDI INVOICE DATA                                 *  07440012
074200* IF THE INVOICE IS FROM A DIRECT IMPORTER AND WE HAVE CHANGED *  07441012
074200* THE TERMS OR ALLOWANCES/CHARGES, IT NEED TO BE REPORTED      *  07442012
074300*--------------------------------------------------------------*  07450000
074400 B000-PROCESS.                                                    07460000
074500                                                                  07470000
074600     IF AP052-KOHLS-PO-NBR NOT = PV-HOLD-PO-NBR                   07480000
074600     OR (AP052-KOHLS-PO-NBR = PV-HOLD-PO-NBR                      07481015
074600         AND AP052-VENDOR-INVOICE-NBR NOT = PV-HOLD-INVC)         07482015
074700        IF WS-RPT-NEEDED-YES                                      07490002
074700        AND PV-HOLD-NEXUS = 'Y'                                   07490133
074700            PERFORM P100-PRINT-RPT                                07491002
074700        END-IF                                                    07492002
074700        INITIALIZE PV-HOLD-FIELDS                                 07500000
074700        SET I-IDX TO 1                                            07501008
074700        MOVE AP052-KOHLS-PO-NBR       TO PV-HOLD-PO-NBR           07510015
074600        MOVE AP052-VENDOR-INVOICE-NBR TO PV-HOLD-INVC             07511015
075700     END-IF.                                                      07590000
075800                                                                  07600000
075900     EVALUATE AP052-RECORD-TYPE-IND                               07610000
076000        WHEN '01'                                                 07620000
076100             PERFORM C000-TYPE1                                   07630000
076200        WHEN '02'                                                 07640000
076300             PERFORM C100-TYPE2                                   07650000
076600        WHEN '04'                                                 07680000
076700             PERFORM C300-TYPE4                                   07690000
076800        WHEN '05'                                                 07700000
076900             PERFORM C400-TYPE5                                   07710000
077000        WHEN '06'                                                 07720000
077100             PERFORM C500-TYPE6                                   07730000
077700        WHEN OTHER                                                07790000
077800             CONTINUE                                             07800002
077900     END-EVALUATE.                                                07810000
078000                                                                  07820000
079000     PERFORM R100-READ-EDI-INVOIC.                                07920005
079100                                                                  07930000
079200*--------------------------------------------------------------*  07940000
079300* PROCESS THE INTERCHANGE RECORD                               *  07950000
079400*--------------------------------------------------------------*  07960000
079500 C000-TYPE1.                                                      07970000
079600                                                                  07980000
079800     MOVE AP052-NEXUS-INVC           TO PV-HOLD-NEXUS.            08000012
079800     MOVE AP052-VENDOR-INVOICE-NBR   TO PV-HOLD-INVC.             08001012
079900     MOVE AP052-EXTENT-DUN-NBR       TO PV-HOLD-DUN-NBR.          08010000
080000     MOVE AP052-ENT-ID-DESC          TO PV-HOLD-VNDR-NAME.        08020000
080800                                                                  08100000
082200                                                                  08240000
082300*--------------------------------------------------------------*  08250000
082400* PROCESS THE INVOICE RECORD                                   *  08260000
082500*--------------------------------------------------------------*  08270000
082600 C100-TYPE2.                                                      08280000
082700                                                                  08290000
082800     MOVE AP052-INV-DTE-MM          TO PV-HOLD-INVC-DT-MM.        08300002
082800     MOVE AP052-INV-DTE-DD          TO PV-HOLD-INVC-DT-DD.        08310002
082800     MOVE AP052-INV-DTE-YY          TO PV-HOLD-INVC-DT-YY.        08320002
084000                                                                  08420000
085400                                                                  08560000
088900*--------------------------------------------------------------*  08910000
089000* PROCESS THE TERMS RECORD                                     *  08920000
089100*--------------------------------------------------------------*  08930000
089200 C300-TYPE4.                                                      08940000
089300                                                                  08950000
089400     MOVE 'Y'                       TO PV-HOLD-TYPE4.             08960022
089400     MOVE AP052-TERMS-TYPE-CODE     TO PV-HOLD-TERMS-TYP.         08960122
092700     MOVE AP052-TRMS-BASIS-DTE-CODE TO PV-HOLD-TRMS-BSS-DT.       08960222
094000     MOVE AP052-DISC-PCT            TO PV-HOLD-DISC-PCT.          08960322
094100     MOVE AP052-DISC-DUE-DTE-MM     TO PV-HOLD-DISC-DUE-MM.       08960422
094100     MOVE AP052-DISC-DUE-DTE-DD     TO PV-HOLD-DISC-DUE-DD.       08960522
094100     MOVE AP052-DISC-DUE-DTE-YY     TO PV-HOLD-DISC-DUE-YY.       08960622
094400     MOVE AP052-DISC-DAYS-DUE       TO PV-HOLD-DISC-DAYS.         08960722
094500     MOVE AP052-DISC-AMT            TO PV-HOLD-DISC-AMT.          08960822
094600     MOVE AP052-NET-DUE-DTE-MM      TO PV-HOLD-NET-DUE-MM.        08960922
094600     MOVE AP052-NET-DUE-DTE-DD      TO PV-HOLD-NET-DUE-DD.        08961022
094600     MOVE AP052-NET-DUE-DTE-YY      TO PV-HOLD-NET-DUE-YY.        08961122
094900     MOVE AP052-NET-DEFRD-DAYS-DUE  TO PV-HOLD-NET-DEF.           08961222
095000     MOVE AP052-PCT-PAYABLE         TO PV-HOLD-PCT-PAY.           08961322
095100     MOVE AP052-DEF-DUE-DTE-MM      TO PV-HOLD-DEF-DUE-MM.        08961422
095100     MOVE AP052-DEF-DUE-DTE-DD      TO PV-HOLD-DEF-DUE-DD.        08961522
095100     MOVE AP052-DEF-DUE-DTE-YY      TO PV-HOLD-DEF-DUE-YY.        08961622
095400     MOVE AP052-DEFERRED-AMT        TO PV-HOLD-DEF-AMT.           08961722
089300                                                                  08961822
089300     IF AP052-SRC-CMP                                             08961922
089300         SET WS-RPT-NEEDED-YES      TO TRUE                       08962022
089300     END-IF.                                                      08962222
089300                                                                  08963002
097600*--------------------------------------------------------------*  09780000
097700* PROCESS THE ALLW/CHRG RECORD                                 *  09790000
097800*--------------------------------------------------------------*  09800000
097900 C400-TYPE5.                                                      09810000
098000                                                                  09820000
089400     MOVE 'Y'                       TO PV-HOLD-IN-USE(I-IDX).     09821011
089400     MOVE AP052-ALLW-CHG-TYPE       TO PV-HOLD-ALLW-CHG(I-IDX).   09821111
089400     MOVE AP052-ALLW-CHRG-CODE      TO PV-HOLD-ALLW-CDE(I-IDX).   09822008
105400     MOVE AP052-SPEC-SRVC-CODE      TO PV-HOLD-SPEC-SRVC(I-IDX).  09823008
105400     MOVE AP052-ALLW-CHRG-MTHD      TO PV-HOLD-CHRG-MTHD(I-IDX).  09823108
105400     MOVE AP052-ALLW-CHRG-TOTAL     TO PV-HOLD-CHRG-TOTAL(I-IDX). 09823208
105400     MOVE AP052-ALLW-CHRG-PCT       TO PV-HOLD-CHRG-PCT(I-IDX).   09823308
105400     MOVE AP052-ALLW-CHRG-PCT-QUAL  TO PV-HOLD-CHRG-PCT-QL(I-IDX).09823408
105400     SET I-IDX UP BY 1.                                           09823508
098000                                                                  09824002
089300     IF AP052-KOHLS-PO-ADD                                        09824102
089300         SET WS-RPT-NEEDED-YES      TO TRUE                       09824202
089300     END-IF.                                                      09824402
089300                                                                  09824502
098000                                                                  09825002
109400*--------------------------------------------------------------*  10960000
109500* PROCESS THE SUMMARY RECORD                                   *  10970000
109600*--------------------------------------------------------------*  10980000
109700 C500-TYPE6.                                                      10990000
109800                                                                  11000000
109900     MOVE AP052-GROSS-INVOICE-AMT   TO PV-HOLD-GROSS-AMT.         11010000
109800                                                                  11020000
129800*--------------------------------------------------------------*  13020000
129900* PERFORM ALL DATE ROUTINES, FILE OPENS, ETC                   *  13030000
130000*--------------------------------------------------------------*  13040000
130100 H000-HOUSEKEEPING.                                               13050000
130200                                                                  13060000
130300     ACCEPT SD-SYSTEM-DATE FROM DATE.                             13070000
130400     ACCEPT ST-SYSTEM-TIME FROM TIME.                             13080000
130500                                                                  13090000
130600     ACCEPT REPORT-TYPE-CONTROL.                                  13100000
130700     EVALUATE REPORT-TYPE-CONTROL                                 13110000
130800        WHEN 'T'                                                  13120000
130900          MOVE '     EDI TEST DATA       ' TO HEADER-TYPE         13130000
131200        WHEN 'P'                                                  13160000
131300          MOVE '  EDI PRODUCTION DATA    ' TO HEADER-TYPE         13170000
131200        WHEN 'A'                                                  13180003
131700          MOVE ' EDI PRE-PRODUCTION DATA ' TO HEADER-TYPE         13210000
132000        WHEN OTHER                                                13240000
132100          MOVE '   DATA TYPE UNKNOWN     ' TO HEADER-TYPE         13250000
132400     END-EVALUATE.                                                13280000
132500                                                                  13290000
132600     DISPLAY 'TYPE OF REPORT = ' REPORT-TYPE-CONTROL.             13300000
132700                                                                  13310000
132800     MOVE SD-SYSTEM-YEAR TO DP132O-RUN-YEAR.                      13320000
132900     MOVE SD-SYSTEM-MONTH TO DP132O-RUN-MONTH.                    13330000
133000     MOVE SD-SYSTEM-DAY TO DP132O-RUN-DAY.                        13340000
133100                                                                  13350000
133200     MOVE ST-SYSTEM-HOUR TO DP132O-RUN-HOUR.                      13360000
133300     MOVE ST-SYSTEM-MINUTE TO DP132O-RUN-MINUTE.                  13370000
133400                                                                  13380000
133500     MOVE PV-PROGRAM-NAME TO DP132O-PROGRAM-NAME.                 13390000
133600                                                                  13400000
133900     PERFORM R100-READ-EDI-INVOIC.                                13430005
134000     IF WS-EDI-INP-EOF                                            13440006
134100        DISPLAY '********************************* *'             13450000
134200        DISPLAY '*   EMPTY EDI REJECTION FILE      *'             13460000
134300        DISPLAY '*   PROGRAM ** = APKRP220         *'             13470000
134400        DISPLAY '*   PARAGRAPH  = H000-HOUSEKEEPING*'             13480000
134500        DISPLAY '***********************************'             13490000
135100        PERFORM W200-HEADING-ROUTINE                              13550000
135200        WRITE EDI-LINE FROM NO-DATA-LINE                          13560000
135900        SET WS-EDI-INP-EMPTY-FILE TO TRUE                         13630006
136000     ELSE                                                         13640000
074700        INITIALIZE PV-HOLD-FIELDS                                 13641000
136100        MOVE AP052-KOHLS-PO-NBR        TO PV-HOLD-PO-NBR          13650002
074600        MOVE AP052-VENDOR-INVOICE-NBR  TO PV-HOLD-INVC            13650115
136100        SET WS-RPT-NEEDED-NO           TO TRUE                    13660002
137000     END-IF.                                                      13740000
137100                                                                  13750000
137200*--------------------------------------------------------------*  13760000
137300* PRINT THE LINES ON THE REPORT FOR THE INVOICE                *  13770002
137400*--------------------------------------------------------------*  13780000
137500 P100-PRINT-RPT.                                                  13790002
137600                                                                  13800000
108000     ADD 1 TO PV-INVC-CNT.                                        13801516
108000     ADD 4 TO PV-LINE-COUNT.                                      13801616
108100     IF PV-LINE-COUNT >= PV-LINE-LIMIT                            13801716
108200        PERFORM W200-HEADING-ROUTINE                              13801816
108300     END-IF.                                                      13801916
108400                                                                  13802016
157600     WRITE EDI-LINE FROM HL-HEADING-LINE2.                        13802126
157800                                                                  13802325
025400     MOVE PV-HOLD-PO-NBR           TO RPT-PO-NBR.                 13802416
026200     MOVE PV-HOLD-INVC             TO RPT-INVC-ID.                13802516
026400     MOVE PV-HOLD-DUN-NBR          TO RPT-VNDR-NBR.               13802616
027300     MOVE PV-HOLD-VNDR-NAME        TO RPT-VNDR-NAME.              13802716
027500     MOVE PV-HOLD-GROSS-AMT        TO PRT-INVC-TOTAL.             13802816
027700     MOVE PV-HOLD-INVC-DT-MM       TO RPT-INVC-DATE-MM.           13802916
027700     MOVE PV-HOLD-INVC-DT-DD       TO RPT-INVC-DATE-DD.           13803016
027700     MOVE PV-HOLD-INVC-DT-YY       TO RPT-INVC-DATE-YY.           13803116
137600                                                                  13803216
108500     WRITE EDI-LINE FROM REPORT-LINE.                             13803326
108500     WRITE EDI-LINE FROM BLANK-LINE.                              13803426
108700                                                                  13803516
108700     IF PV-HOLD-TYPE4 = 'Y'                                       13803622
089400         EVALUATE PV-HOLD-TERMS-TYP                               13803722
089500           WHEN '01'                                              13803822
089600             MOVE 'BASIC       '        TO TYPE4-TERMS-TYPE       13803922
089700           WHEN '02'                                              13804022
089800             MOVE 'END OF MONTH'        TO TYPE4-TERMS-TYPE       13804122
089900           WHEN '03'                                              13804222
090000             MOVE 'FIXED DATE  '        TO TYPE4-TERMS-TYPE       13804322
090100           WHEN '04'                                              13804422
090200             MOVE 'DEFR INSTALL'        TO TYPE4-TERMS-TYPE       13804522
090300           WHEN '05'                                              13804622
090400             MOVE 'NO DISC     '        TO TYPE4-TERMS-TYPE       13804722
090500           WHEN '06'                                              13804822
090600             MOVE 'MIXED       '        TO TYPE4-TERMS-TYPE       13804922
090700           WHEN '07'                                              13805022
090800             MOVE 'EXTENDED    '        TO TYPE4-TERMS-TYPE       13805122
090900           WHEN '08'                                              13805222
091000             MOVE 'BASIC DISC  '        TO TYPE4-TERMS-TYPE       13805322
091100           WHEN '09'                                              13805422
091200             MOVE 'PROXIMO     '        TO TYPE4-TERMS-TYPE       13805522
091300           WHEN '10'                                              13805622
091400             MOVE 'INSTANT     '        TO TYPE4-TERMS-TYPE       13805722
091500           WHEN '11'                                              13805822
091600             MOVE 'ELECTIVE    '        TO TYPE4-TERMS-TYPE       13805922
091700           WHEN '12'                                              13806022
091800             MOVE '10 DAYS EOM '        TO TYPE4-TERMS-TYPE       13806122
091900           WHEN '13'                                              13806222
092000             MOVE 'PREV AGREED '        TO TYPE4-TERMS-TYPE       13806322
092100           WHEN '14'                                              13806422
092200             MOVE 'MUTUAL DEFIN'        TO TYPE4-TERMS-TYPE       13806522
092300           WHEN OTHER                                             13806622
092400             MOVE PV-HOLD-TERMS-TYP     TO TYPE4-TERMS-TYPE       13806722
092500         END-EVALUATE                                             13806822
092600                                                                  13806902
092700         EVALUATE PV-HOLD-TRMS-BSS-DT                             13807022
092800           WHEN '01'                                              13807122
092900             MOVE 'SHIP DATE   '        TO TYPE4-BAS-DTE-CD       13807222
093000           WHEN '02'                                              13807322
093100             MOVE 'DELIV DATE  '        TO TYPE4-BAS-DTE-CD       13807422
093200           WHEN '03'                                              13807522
093300             MOVE 'INVOICE DATE'        TO TYPE4-BAS-DTE-CD       13807622
093400           WHEN '04'                                              13807722
093500             MOVE 'EFFECT DATE '        TO TYPE4-BAS-DTE-CD       13807822
093600           WHEN OTHER                                             13807922
093700             MOVE PV-HOLD-TRMS-BSS-DT   TO TYPE4-BAS-DTE-CD       13808022
093800         END-EVALUATE                                             13808122
093900                                                                  13808202
094000         MOVE PV-HOLD-DISC-PCT          TO TYPE4-DISC-PCT         13808322
094100         MOVE PV-HOLD-DISC-DUE-YY       TO TYPE4-DISC-DUE-YY      13808422
094200         MOVE PV-HOLD-DISC-DUE-MM       TO TYPE4-DISC-DUE-MM      13808522
094300         MOVE PV-HOLD-DISC-DUE-DD       TO TYPE4-DISC-DUE-DD      13808622
094400         MOVE PV-HOLD-DISC-DAYS         TO TYPE4-DISC-DAYS-DUE    13808723
094500         MOVE PV-HOLD-DISC-AMT          TO TYPE4-DISC-AMT         13808823
094600         MOVE PV-HOLD-NET-DUE-YY        TO TYPE4-NET-DUE-YY       13808923
094700         MOVE PV-HOLD-NET-DUE-MM        TO TYPE4-NET-DUE-MM       13809023
094800         MOVE PV-HOLD-NET-DUE-DD        TO TYPE4-NET-DUE-DD       13809123
094900         MOVE PV-HOLD-NET-DEF           TO TYPE4-NET-DEF-DAYS     13809223
095000         MOVE PV-HOLD-PCT-PAY           TO TYPE4-DEF-PCT-PAY      13809323
095100         MOVE PV-HOLD-DEF-DUE-YY        TO TYPE4-DEF-DUE-YY       13809423
095200         MOVE PV-HOLD-DEF-DUE-MM        TO TYPE4-DEF-DUE-MM       13809523
095300         MOVE PV-HOLD-DEF-DUE-DD        TO TYPE4-DEF-DUE-DD       13809623
095400         MOVE PV-HOLD-DEF-AMT           TO TYPE4-DEF-AMT          13809723
095500                                                                  13809802
095600         ADD 6 TO PV-LINE-COUNT                                   13809924
095700         IF PV-LINE-COUNT >= PV-LINE-LIMIT                        13810022
095800            PERFORM W200-HEADING-ROUTINE                          13810122
095900         END-IF                                                   13810222
096000                                                                  13810302
096100         WRITE EDI-LINE FROM TYPE4-LINE                           13810422
096400         WRITE EDI-LINE FROM TYPE4-LINE2                          13810722
096700         WRITE EDI-LINE FROM TYPE4-LINE3                          13811022
097000         WRITE EDI-LINE FROM TYPE4-LINE4                          13811322
097300         WRITE EDI-LINE FROM TYPE4-LINE5                          13811622
097300         WRITE EDI-LINE FROM BLANK-LINE                           13811727
097400     END-IF.                                                      13811822
097500                                                                  13811922
028800     PERFORM P200-PRINT-ALLW                                      13812008
028900         VARYING I-IDX FROM 1 BY 1                                13812108
029000         UNTIL I-IDX = 10                                         13812211
029000         OR PV-HOLD-IN-USE(I-IDX) = ' '.                          13812311
097500                                                                  13812411
097500                                                                  13812511
137200*--------------------------------------------------------------*  13812611
137300* PRINT THE ALLOWANCE/CHARGES LINES FOR THE INVOICE               13812711
137400*--------------------------------------------------------------*  13812811
137500 P200-PRINT-ALLW.                                                 13812911
137600                                                                  13813011
098100     EVALUATE PV-HOLD-ALLW-CHG(I-IDX)                             13813108
098200       WHEN 'C'                                                   13813208
098300         MOVE 'CHARGE     '         TO TYPE5-ALLW-CHRG-TYPE       13813308
098400       WHEN 'A'                                                   13813408
098500         MOVE 'ALLOWANCE  '         TO TYPE5-ALLW-CHRG-TYPE       13813508
098600       WHEN 'N'                                                   13813608
098700         MOVE 'NO ALLW CHG'         TO TYPE5-ALLW-CHRG-TYPE       13813708
098800       WHEN OTHER                                                 13813808
098900         MOVE PV-HOLD-ALLW-CHG(I-IDX) TO TYPE5-ALLW-CHRG-TYPE     13813908
099000     END-EVALUATE.                                                13814008
099100                                                                  13814108
099200     EVALUATE PV-HOLD-ALLW-CDE(I-IDX)                             13814208
099300       WHEN '275'                                                 13814308
099400       WHEN 'DSC'                                                 13814408
099500         MOVE 'TERMS DISCOUNT  '    TO TYPE5-ALLW-CHRG-CD         13814508
099600       WHEN 'TTD'                                                 13814608
099700         MOVE 'TRADE DISCOUNT  '    TO TYPE5-ALLW-CHRG-CD         13814708
099800       WHEN 'CAC'                                                 13814808
099900         MOVE 'CASH DISCOUNT   '    TO TYPE5-ALLW-CHRG-CD         13814908
100000       WHEN 'NSD'                                                 13815008
100100       WHEN 'NSA'                                                 13815108
100200         MOVE 'NEW STORE/PROMO '    TO TYPE5-ALLW-CHRG-CD         13815208
100300       WHEN 'FFA'                                                 13815308
100400         MOVE 'FREIGHT ALLOW   '    TO TYPE5-ALLW-CHRG-CD         13815408
100500       WHEN 'TAL'                                                 13815508
100600         MOVE 'TRUCKLOAD DISC  '    TO TYPE5-ALLW-CHRG-CD         13815608
100700       WHEN 'VAB'                                                 13815708
100800         MOVE 'VOLUME DISCOUNT '    TO TYPE5-ALLW-CHRG-CD         13815808
100900       WHEN 'RCA'                                                 13815908
101000         MOVE 'NO RET CREDIT AL'    TO TYPE5-ALLW-CHRG-CD         13816008
101100       WHEN 'WSA'                                                 13816108
101200         MOVE 'WHAREHOUSE ALLW '    TO TYPE5-ALLW-CHRG-CD         13816208
101300       WHEN 'DDA'                                                 13816308
101400         MOVE 'DEFECTIVE ALLW  '    TO TYPE5-ALLW-CHRG-CD         13816408
101500       WHEN 'AAA'                                                 13816508
101600         MOVE 'ADVETISING ALLW '    TO TYPE5-ALLW-CHRG-CD         13816608
101700       WHEN 'EEA'                                                 13816708
101800         MOVE 'EARLY BUY ALLW  '    TO TYPE5-ALLW-CHRG-CD         13816808
101900       WHEN 'UUM'                                                 13816908
102000         MOVE 'UNSALEABLE MERCH'    TO TYPE5-ALLW-CHRG-CD         13817008
102100       WHEN '400'                                                 13817108
102200       WHEN 'FFC'                                                 13817208
102300       WHEN 'PAB'                                                 13817308
102400       WHEN 'SAB'                                                 13817408
102500       WHEN 'PST'                                                 13817508
102600       WHEN 'UUC'                                                 13817608
102700         MOVE 'FREIGHT CHARGE  '    TO TYPE5-ALLW-CHRG-CD         13817708
102800       WHEN 'MRK'                                                 13817808
102900         MOVE 'PRETICKETING    '    TO TYPE5-ALLW-CHRG-CD         13817908
103000       WHEN '445'                                                 13818008
103100       WHEN 'INS'                                                 13818108
103200         MOVE 'INSURANCE       '    TO TYPE5-ALLW-CHRG-CD         13818208
103300       WHEN 'MSG'                                                 13818308
103400         MOVE 'MISCELLANEOUS   '    TO TYPE5-ALLW-CHRG-CD         13818408
103500       WHEN 'MSC'                                                 13818508
103600         MOVE 'MISC/HANGER CHG '    TO TYPE5-ALLW-CHRG-CD         13818608
103700       WHEN 'SST'                                                 13818708
103800       WHEN 'TTL'                                                 13818808
103900       WHEN 'TTS'                                                 13818908
104000         MOVE 'TAX             '    TO TYPE5-ALLW-CHRG-CD         13819008
104100       WHEN 'SGG'                                                 13819108
104200         MOVE 'SMALL ORDER CHG '    TO TYPE5-ALLW-CHRG-CD         13819208
104300       WHEN 'HBG'                                                 13819308
104400       WHEN '690'                                                 13819408
104500         MOVE 'HANDLING        '    TO TYPE5-ALLW-CHRG-CD         13819508
104600       WHEN 'LAE'                                                 13819608
104700         MOVE 'LICENSE FEE     '    TO TYPE5-ALLW-CHRG-CD         13819708
104800       WHEN 'PPN'                                                 13819808
104900         MOVE 'PALLET CHARGE   '    TO TYPE5-ALLW-CHRG-CD         13819908
105000       WHEN OTHER                                                 13820008
105100         MOVE PV-HOLD-ALLW-CDE(I-IDX) TO TYPE5-ALLW-CHRG-CD       13820108
105200     END-EVALUATE.                                                13820208
105300                                                                  13820308
105400     MOVE PV-HOLD-SPEC-SRVC(I-IDX)  TO TYPE5-SPEC-SRVC-CD.        13820408
105500     EVALUATE PV-HOLD-SPEC-SRVC(I-IDX)                            13820509
105600       WHEN 'FG        '                                          13820608
105700         MOVE 'FREE GOODS'          TO TYPE5-SPEC-SRVC-CD         13820708
105800       WHEN 'TC        '                                          13820808
105900         MOVE 'TICKETING '          TO TYPE5-SPEC-SRVC-CD         13820908
106000       WHEN OTHER                                                 13821008
106100         MOVE PV-HOLD-SPEC-SRVC(I-IDX) TO TYPE5-SPEC-SRVC-CD      13821108
106200     END-EVALUATE.                                                13821208
106300                                                                  13821308
106400     EVALUATE PV-HOLD-CHRG-MTHD(I-IDX)                            13821408
106500       WHEN '02'                                                  13821508
106600         MOVE 'OFF INVOICE '        TO TYPE5-ALLW-CHRG-MTHD       13821608
106700       WHEN OTHER                                                 13821708
106800         MOVE PV-HOLD-CHRG-MTHD(I-IDX) TO TYPE5-ALLW-CHRG-MTHD    13821808
106900     END-EVALUATE.                                                13821908
107000                                                                  13822008
107100     MOVE PV-HOLD-CHRG-TOTAL(I-IDX) TO TYPE5-ALLW-CHRG-TOTL.      13822108
107200     MOVE PV-HOLD-CHRG-PCT(I-IDX)   TO TYPE5-ALLW-CHRG-PCT.       13822208
107300     EVALUATE PV-HOLD-CHRG-PCT-QL(I-IDX)                          13822308
107400       WHEN '3'                                                   13822408
107500         MOVE 'DISC GROSS' TO TYPE5-ALLW-CHRG-QUAL                13822508
107600       WHEN OTHER                                                 13822608
107700         MOVE '          ' TO TYPE5-ALLW-CHRG-QUAL                13822708
107800     END-EVALUATE.                                                13822808
107900                                                                  13822908
108000     ADD 4 TO PV-LINE-COUNT.                                      13823008
108100     IF PV-LINE-COUNT >= PV-LINE-LIMIT                            13823108
108200        PERFORM W200-HEADING-ROUTINE                              13823208
108300     END-IF.                                                      13823308
108400                                                                  13823408
108500     WRITE EDI-LINE FROM TYPE5-LINE.                              13823527
108800     WRITE EDI-LINE FROM TYPE5-LINE2.                             13823827
109100     WRITE EDI-LINE FROM TYPE5-LINE3.                             13824127
109100     WRITE EDI-LINE FROM BLANK-LINE.                              13824227
109300                                                                  13824308
137100                                                                  13824408
137200*--------------------------------------------------------------*  13824508
137300* READ THE EDI TRANSMISSION REJECTION FILE                     *  13824608
137400*--------------------------------------------------------------*  13824708
137500 R100-READ-EDI-INVOIC.                                            13824808
137600                                                                  13824908
137700     READ EDI-INP-FILE INTO WS-EDI-INVOIC-REC                     13825008
137800         AT END                                                   13826000
137900             SET WS-EDI-INP-EOF  TO TRUE.                         13830006
138000                                                                  13840000
154900*--------------------------------------------------------------*  15530000
155000* WRITE THE DETAIL LINE HEADING                                *  15540025
155100*--------------------------------------------------------------*  15550000
155200 W200-HEADING-ROUTINE.                                            15560000
155300                                                                  15570000
155400     ADD 1 TO PV-PAGE-COUNT.                                      15580000
155500     EVALUATE REPORT-TYPE-CONTROL                                 15590000
155600        WHEN 'T'                                                  15600000
155700           MOVE 1 TO DP132O-REPORT-NUMBER                         15610000
155800        WHEN 'A'                                                  15620000
155900           MOVE 3 TO DP132O-REPORT-NUMBER                         15630000
156000        WHEN 'P'                                                  15640000
156100           MOVE 5 TO DP132O-REPORT-NUMBER                         15650000
156200        WHEN OTHER                                                15660000
156300           MOVE 1 TO DP132O-REPORT-NUMBER                         15670000
156400     END-EVALUATE.                                                15680000
156500                                                                  15690000
156600     MOVE  9 TO PV-LINE-COUNT.                                    15700000
156700                                                                  15710000
156800     MOVE PV-PAGE-COUNT TO DP132O-PAGE-NUMBER.                    15720000
156900                                                                  15730000
157000     WRITE EDI-LINE FROM DP132O-STANDRD-HEADER-132-COLS           15740000
157100         AFTER ADVANCING PAGE.                                    15750000
157200                                                                  15760000
157300     WRITE EDI-LINE FROM HL-HEADING-LINE1.                        15770027
157300     WRITE EDI-LINE FROM BLANK-LINE.                              15771028
157500                                                                  15790000
197200*--------------------------------------------------------------*  19760000
197300* END OF JOB ROUTINES, PRINT COUNTS, CLOSE FILES               *  19770000
197400*--------------------------------------------------------------*  19780000
197500 Z900-END-OF-JOB.                                                 19790000
197600                                                                  19800000
197700     ADD 1 TO PV-LINE-COUNT.                                      19810000
197800     IF PV-LINE-COUNT >= PV-LINE-LIMIT                            19820000
197800     OR PV-INVC-CNT = 0                                           19821016
197900        PERFORM W200-HEADING-ROUTINE                              19830000
198000     END-IF.                                                      19840000
198100                                                                  19850000
199200     IF NOT WS-EDI-INP-EMPTY-FILE                                 19960006
199300        WRITE EDI-LINE FROM EOR-END-OF-REPORT-LINE                19970000
199400            AFTER ADVANCING 2 LINE                                19980000
199500     END-IF.                                                      19990000
199600                                                                  20000000
200403     CLOSE EDI-INP-FILE                                           20060007
200404           EDI-REPORT.                                            20070000
