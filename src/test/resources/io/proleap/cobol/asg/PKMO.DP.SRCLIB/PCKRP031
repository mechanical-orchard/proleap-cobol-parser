000100***************************************************************** 00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300***************************************************************** 00030000
000400                                                                  00040000
000500 PROGRAM-ID.             PCKRP031.                                00050000
000600 AUTHOR.                 BRENDA ROCKWELL.                         00060000
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070000
000800 DATE-WRITTEN            DECEMBER, 2009.                          00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100***************************************************************** 00110000
001200*                                                               * 00120000
001300*  THIS PROGRAM WILL PRINT THE INBOUND TRAILER DETAIL REPORT    * 00130000
001400***************************************************************** 00140000
001500***************************************************************** 00150000
001600*  CHANGE LOG.                                                    00160000
001700*  DATE         CHANGED BY      DESC                              00170000
001800*  -----------  -------------- ---------------------------------- 00180000
001900*  04/03/2012   B. ROCKWELL    ADD SKU NUMBER TO REPORT           00190000
002000*                              PROJ ID:  3347A                    00200000
002100*                              WR/IR#:   WR40796                  00210000
002200*  10/07/2011   S. ANDERSON    EFC OPTIMIZATION AND HOLIDAY PREP  00220000
002300*               (CODEWORKS)     - ADDITIONAL DATA NEEDED FOR      00230000
002400*                                 SUMMARY REPORTS                 00240006
002500*                              PROJ ID:   3253                    00250000
002600*                              WR/IR#:   WR40392                  00260000
002700*  RECOMPILE TO PICK UP CHANGES TO COPY PCRD068                   00270000
002800*  03/25/2013   C. PARMLEY     INCLUDE RFID # CARTONS AND UNITS   00280000
002900*                              ON REPORT                          00290000
003000*                              PROJ ID:   5148B                   00300000
003100*                              WR/IR#:   CRQ0000000?????          00310000
003200*  01/20/2014   SHOBHIT BAIJAL INCLUDE COUNTS OF RFID AUDIT       00320000
003300*                              CARTONS PER RECEIVER ON REPORT     00330000
003400*                              PROJ ID:   5148D                   00340000
003500*                              CHANGES TAGGED *SB 01/20/14        00350000
003510*  03/28/2014   SHOBHIT BAIJAL UPDATED TO PRINT DC, TRAILER LOC,  00351000
003520*                              ARRIVAL DATE, SCAC AND TRAILER     00352000
003521*                              ON THE PO/REC LEVEL TOTALS RECORD  00352100
003530*                              PROJ ID:   5148D                   00353000
003540*                              CHANGES TAGGED *SB 03/28/14        00354000
003550*  07/01/2014   DENISE HAHN    INCREASED REPORT SIZE FROM 250 TO  00355008
003560*                              275 TO ALLOW FOR NEW TOTALS        00356008
003570*                              HAZARDOUS CARTONS/UNITS            00357008
003580*                              CONTROLLED FLOW CARTONS/NITS       00358008
003590*                              CHANGES TAGGED *DMH 07/01/14       00359008
003600***************************************************************** 00360000
003700/                                                                 00370000
003800***************************************************************** 00380000
003900 ENVIRONMENT DIVISION.                                            00390000
004000***************************************************************** 00400000
004100                                                                  00410000
004200 CONFIGURATION SECTION.                                           00420000
004300 SOURCE-COMPUTER.        IBM-3090.                                00430000
004400 OBJECT-COMPUTER.        IBM-3090.                                00440000
004500                                                                  00450000
004600 INPUT-OUTPUT SECTION.                                            00460000
004700                                                                  00470000
004800 FILE-CONTROL.                                                    00480000
004900                                                                  00490000
005000     SELECT INPUT01-FILE       ASSIGN TO INP01.                   00500000
005100     SELECT REPORT-FILE        ASSIGN TO RPT01.                   00510000
005200                                                                  00520000
005300***************************************************************** 00530000
005400 DATA DIVISION.                                                   00540000
005500***************************************************************** 00550000
005600                                                                  00560000
005700 FILE SECTION.                                                    00570000
005800                                                                  00580000
005900 FD  INPUT01-FILE                                                 00590000
006000     LABEL RECORDS ARE STANDARD                                   00600000
006100     RECORDING MODE IS F                                          00610000
006200     BLOCK CONTAINS 0 RECORDS                                     00620000
006300* CLP 06/05/13 PR #5148B START                                    00630000
006400*SB 01/20/14 - BEGIN PR#5148D                                     00640000
006500     RECORD CONTAINS 400 CHARACTERS.                              00650000
006600 01  INPUT01-RECORD                  PIC X(400).                  00660000
006700*SB 01/20/14 - END PR#5148D                                       00670000
006800* CLP 06/05/13 PR #5148B START                                    00680000
006900                                                                  00690000
007000 FD  REPORT-FILE                                                  00700000
007100     RECORDING MODE IS F                                          00710000
007200     BLOCK CONTAINS 0  RECORDS.                                   00720000
007300 01  REPORT-RECORD                   PIC  X(280).                 00730012
007400/                                                                 00740000
007500 WORKING-STORAGE SECTION.                                         00750000
007600                                                                  00760000
007700 01  PROGRAM-SWITCHES.                                            00770000
007800     05  PS-END-OF-INPUT-SW          PIC  X(01)    VALUE 'N'.     00780000
007900         88  PS-END-OF-INPUT                       VALUE 'Y'.     00790000
008000     05  PS-FIRST-TIME-SW            PIC  X(01)    VALUE 'Y'.     00800000
008100         88  PS-FIRST-TIME                         VALUE 'Y'.     00810000
008200     05  PS-FIRST-TIME-PO-SW         PIC  X(01)    VALUE 'Y'.     00820000
008300         88  PS-FIRST-TIME-PO                      VALUE 'Y'.     00830000
008400         88  PS-FIRST-TIME-PO-NO                   VALUE 'N'.     00840000
008500     05  PS-FIRST-TIME-SHPMT-SW      PIC  X(01)    VALUE 'Y'.     00850000
008600         88  PS-FIRST-TIME-SHPMT                   VALUE 'Y'.     00860000
008700         88  PS-FIRST-TIME-SHPMT-NO                VALUE 'N'.     00870000
008800     05  PS-NEW-TRIP-SW              PIC  X(01)    VALUE 'Y'.     00880000
008900         88  PS-NEW-TRIP-YES                       VALUE 'Y'.     00890000
009000         88  PS-NEW-TRIP-NO                        VALUE 'N'.     00900000
009100                                                                  00910000
009200 01  PC-CONSTANTS.                                                00920000
009300     05  PC-PROGRAM-NAME             PIC  X(08)    VALUE          00930000
009400                           'PCKRP031'.                            00940000
009500     05  PC-REPORT-NBR               PIC  X(02)    VALUE          00950000
009600                           '-1'.                                  00960000
009700                                                                  00970000
009800 01  PV-MISC-FIELDS.                                              00980000
009900     05  PV-LINE-CNT                 PIC S9(05) COMP-3 VALUE +0.  00990000
010000     05  PV-NBR-OF-LINES             PIC S9(05) COMP-3 VALUE +0.  01000000
010100     05  PV-LINE-LIMIT               PIC S9(03) COMP-3 VALUE +57. 01010000
010200     05  PV-PAGE-CNT                 PIC S9(05) COMP-3 VALUE +0.  01020000
010300     05  PV-USER-NAME                PIC X(25)     VALUE SPACES.  01030000
010400     05  PV-HOLD-NUMERIC             PIC 9(9)      VALUE ZERO.    01040000
010500     05  PV-REC-PO-TOTAL             PIC S9(9) COMP-3 VALUE +0.   01050000
010600     05  PV-AUD-UNIT-TOTAL           PIC S9(9) COMP-3 VALUE +0.   01060000
010700*SB 01/20/14 - BEGIN PR#5148D                                     01070000
010800     05  PV-AUD-RFID-TOTAL           PIC S9(9) COMP-3 VALUE +0.   01080000
010900*SB 01/20/14 - END PR#5148D                                       01090000
011000     05  PV-TODAYS-DATE.                                          01100000
011100         10  PV-TODAYS-DATE-YY       PIC  9(02)    VALUE ZERO.    01110000
011200         10  PV-TODAYS-DATE-MM       PIC  9(02)    VALUE ZERO.    01120000
011300         10  PV-TODAYS-DATE-DD       PIC  9(02)    VALUE ZERO.    01130000
011400     05  PV-TODAYS-TIME.                                          01140000
011500         10  PV-TODAYS-TIME-HH       PIC  9(02)    VALUE ZERO.    01150000
011600         10  PV-TODAYS-TIME-MM       PIC  9(02)    VALUE ZERO.    01160000
011700         10  PV-TODAYS-TIME-SS       PIC  9(02)    VALUE ZERO.    01170000
011800         10  FILLER                  PIC  9(02)    VALUE ZERO.    01180000
011900     05  PV-FORMAT-DATE.                                          01190000
012000         10  PV-FORMAT-DATE-MM       PIC  X(02)    VALUE SPACES.  01200000
012100         10  FILLER                  PIC  X(01)    VALUE '/'.     01210000
012200         10  PV-FORMAT-DATE-DD       PIC  X(02)    VALUE SPACES.  01220000
012300         10  FILLER                  PIC  X(01)    VALUE '/'.     01230000
012400         10  PV-FORMAT-DATE-YYYY     PIC  X(04)    VALUE SPACES.  01240000
012500     05  PV-DC-LOCATION              PIC 9(04)         VALUE 0.   01250000
012600     05  PV-TRIP-ID                  PIC 9(09)         VALUE 0.   01260000
012700     05  PV-PREV-PO                  PIC 9(08)         VALUE 0.   01270000
012800     05  PV-PREV-RECEIVER            PIC 9(04)         VALUE 0.   01280000
012900*SB 01/20/14 - BEGIN PR#5148D                                     01290000
013000     05  PV-PREV-RFID-RANK           PIC X(06)       VALUE SPACES.01300000
013100     05  PV-PREV-RFID-100-PC         PIC 9(05)         VALUE 0.   01310000
013101*SB 01/20/14 - END PR#5148D                                       01310100
013102*SB 03/28/14 - BEGIN PR#5148D                                     01310200
013110     05  PV-PREV-DC                  PIC ZZZ9     BLANK WHEN ZERO.01311000
013111     05  PV-PREV-TRLR-LOC            PIC X(05)       VALUE SPACES.01311100
013112     05  PV-PREV-ARR-DATE            PIC X(10)       VALUE SPACES.01311200
013113     05  PV-PREV-SCAC                PIC X(04)       VALUE SPACES.01311300
013120     05  PV-PREV-TRAILER             PIC X(10)       VALUE SPACES.01312000
013130*SB 03/28/14 - END PR#5148D                                       01313000
013300     05  PV-PCNT-FIELD               PIC 999V99        VALUE 0.   01330000
013400/                                                                 01340000
013500****************************************************              01350000
013600* INPUT01 COPYBOOK                                 *              01360000
013700****************************************************              01370000
013800     COPY PCRD068.                                                01380000
013900/                                                                 01390000
014000******************************************************************01400000
014100*    STANDARD HEADER FOR 250 COLUMN REPORT                       *01410000
014200******************************************************************01420000
014300     COPY DPWS250O.                                               01430000
014400/                                                                 01440000
014500 01  HDR-LINES.                                                   01450000
014600     05  HDR01-LINE.                                              01460000
014700         10  FILLER                  PIC  X(52)    VALUE SPACES.  01470000
014800         10  FILLER                  PIC  X(34)    VALUE          01480000
014900             'INBOUND TRAILER FORECAST DETAIL   '.                01490000
015000         10  FILLER                  PIC  X(46)    VALUE SPACES.  01500000
015100     05  HDR02-LINE.                                              01510000
015200         10  FILLER                  PIC  X(17)    VALUE          01520000
015300             'DC.............: '.                                 01530000
015400         10  HDR02-DC                PIC  ZZZZ9.                  01540000
015500         10  FILLER                  PIC  X(02)    VALUE SPACES.  01550000
015600         10  HDR02-DC-DESCRIPTION    PIC  X(40)    VALUE SPACES.  01560000
015700         10  FILLER                  PIC  X(68)    VALUE SPACES.  01570000
015800     05  HDR03-LINE.                                              01580000
015900*SB 01/20/14 - BEGIN PR#5148D                                     01590000
016000         10  FILLER                  PIC  X(48)    VALUE          01600000
016100             '---- --------TRAILER INFORMATION----- ------VEND'.  01610000
016200         10  FILLER                  PIC  X(49)    VALUE          01620000
016300             'OR------- --PO AND CASEPACK INFORMATION----------'. 01630000
016400*SB 01/20/14 - END PR#5148D                                       01640000
016500         10  FILLER                  PIC  X(45)    VALUE          01650000
016600             '-------- --REALTIME AUDIT---------- ---------'.     01660000
016700         10  FILLER                  PIC  X(45)    VALUE          01670000
016800             '---AUDIT CRITERIA----------------- ---EST AUD'.     01680000
016900* CLP 06/05/13 PR #5148B START                                    01690000
017000*SB 01/20/14 - BEGIN PR#5148D                                     01700000
017100         10  FILLER                  PIC  X(24)    VALUE          01710000
017200             'IT INFO-- ---P2L INFO---'.                          01720000
017300*SB 01/20/14 - END PR#5148D                                       01730000
017400         10  FILLER                  PIC  X(13)    VALUE          01740000
017500             ' --RFID INFO-'.                                     01750000
017600         10  FILLER                  PIC  X(11)    VALUE          01760000
017700             '- -TRBL --R'.                                       01770000
017800*SB 01/20/14 - BEGIN PR#5148D                                     01780000
017900         10  FILLER                  PIC  X(24)    VALUE          01790000
018000             'EMAINDER------          '.                          01800000
018100*SB 01/20/14 - END PR#5148D                                       01810000
018200* CLP 06/05/13 PR #5148B END                                      01820000
018300     05  HDR04-LINE.                                              01830000
018400         10  FILLER                  PIC  X(45)    VALUE          01840000
018500             '                                             '.     01850000
018600*SB 01/20/14 - BEGIN PR#5148D                                     01860000
018700         10  FILLER                  PIC  X(47)    VALUE          01870000
018800             '                                               '.   01880000
018900         10  FILLER                  PIC  X(50)    VALUE          01890000
019000             '                   UCC        PREV 100%           '.01900000
019100         10  FILLER                  PIC  X(40)    VALUE          01910000
019200             '  PRMPT MIN  MAX        UNT/  REQ   #   '.          01920000
019300         10  FILLER                  PIC  X(40)    VALUE          01930000
019400* CLP 06/05/13 PR #5148B START                                    01940000
019500             ' #                              #      #'.          01950000
019600* CLP 06/05/13 PR #5148B END                                      01960000
019700*SB 01/20/14 - END PR#5148D                                       01970000
019800         10  FILLER                  PIC  X(25)    VALUE          01980000
019900             '                         '.                         01990000
019910*                                                                 01991009
019911*** DMH 07/01/14 - BEGIN                                          01991109
019920         10  FILLER                  PIC  X(30)    VALUE          01992014
019930             '       #      #    CNTL   CNTL'.                    01993014
019940*** DMH 07/01/14 - BEGIN                                          01994009
019950*                                                                 01995009
020000     05  HDR05-LINE.                                              02000000
020100         10  FILLER                  PIC  X(45)    VALUE          02010000
020200             '     TRLR  ARRIVED                           '.     02020000
020300*SB 01/20/14 - BEGIN PR#5148D                                     02030000
020400         10  FILLER                  PIC  X(49)    VALUE          02040000
020500             '       VNDR                                  OUT '. 02050000
020600         10  FILLER                  PIC  X(48)    VALUE          02060000
020700             'P2L   SHIP  CSPK 128   AUD  AUD   AUD  PCK  VNDR'.  02070000
020800         10  FILLER                  PIC  X(40)    VALUE          02080000
020900             '  LINES CRTN CRTN  % TO PCKS UNT/   Q   '.          02090000
021000* CLP 06/05/13 PR #5148B START                                    02100000
021100         10  FILLER                  PIC  X(31)    VALUE          02110000
021200             ' U   CRDK  %   P2L  %   P2L   '.                    02120000
021300*SB 01/20/14 - END PR#5148D                                       02130000
021400         10  FILLER                  PIC  X(13)    VALUE          02140000
021500             'RFID   RFID '.                                      02150000
021600         10  FILLER                  PIC  X(09)    VALUE          02160000
021700             'TRBL  CRT'.                                         02170000
021800* CLP 06/05/13 PR #5148B END                                      02180000
021900         10  FILLER                  PIC  X(13)    VALUE          02190010
022000             ' NOT   %     '.                                     02200010
022010*                                                                 02201009
022020*** DMH 07/01/14 - BEGIN                                          02202009
022030         10  FILLER                  PIC  X(29)    VALUE          02203014
022040             '     HAZ    HAZ   FLOW   FLOW'.                     02204014
022050*** DMH 07/01/14 - BEGIN                                          02205009
022060*                                                                 02206009
022100     05  HDR06-LINE.                                              02210000
022200         10  FILLER                  PIC  X(45)    VALUE          02220000
022300             ' DC  LOC     DATE     SCAC TRAILER    VENDOR '.     02230000
022400*SB 01/20/14 - BEGIN PR#5148D                                     02240000
022500         10  FILLER                  PIC  X(49)    VALUE          02250000
022600             '      AGRMNT PO/RECEIVER  LNE  PCK   SKU     PAK '. 02260000
022700         10  FILLER                  PIC  X(48)    VALUE          02270000
022800             'LABEL LABEL DWLD DATA CMPLT FAIL COUNT TYP  RNKG'.  02280000
022900         10  FILLER                  PIC  X(40)    VALUE          02290000
023000             '  (B/C) CHCK CHCK AUDIT AUD  CRTN  CRTN '.          02300000
023100* CLP 06/05/13 PR #5148B START                                    02310000
023200         10  FILLER                  PIC  X(28)    VALUE          02320000
023300             'CRTN CRTN CRDK CNT P2L  ZONE'.                      02330000
023400*SB 01/20/14 - END PR#5148D                                       02340000
023500         10  FILLER                  PIC  X(14)    VALUE          02350000
023600             '   CTNS   UNTS'.                                    02360000
023700         10  FILLER                  PIC  X(11)    VALUE          02370000
023800             '  CRTNS SCA'.                                       02380000
023900* CLP 06/05/13 PR #5148B END                                      02390000
024000         10  FILLER                  PIC  X(14)    VALUE          02400010
024100*SB 01/20/14 - BEGIN PR#5148D                                     02410000
024200             'NNED  SCANNED '.                                    02420010
024300*SB 01/20/14 - END PR#5148D                                       02430000
024310*                                                                 02431009
024320*** DMH 07/01/14 - BEGIN                                          02432009
024330         10  FILLER                  PIC  X(29)    VALUE          02433012
024340             '   CTNS   UNTS   CTNS   UNTS'.                      02434012
024350*** DMH 07/01/14 - BEGIN                                          02435009
024360*                                                                 02436009
024400     05  HDR07-LINE.                                              02440000
024500*SB 01/20/14 - BEGIN PR#5148D                                     02450000
024600         10  FILLER                  PIC  X(50)    VALUE          02460000
024700             '---- ----- ---------- ---- ---------- ------------'.02470000
024800         10  FILLER                  PIC  X(47)    VALUE          02480000
024900             ' ------ ------------ ---- ---- -------- --- ---'.   02490000
025000         10  FILLER                  PIC  X(45)    VALUE          02500000
025100             '-- ----- ---- ----- ---- ---- ----- --- -----'.     02510000
025200         10  FILLER                  PIC  X(40)    VALUE          02520000
025300             '- ----- ---- ----- ---- ---- ----- ---- '.          02530000
025400         10  FILLER                  PIC  X(36)    VALUE          02540000
025500* CLP 06/05/13 PR #5148B START                                    02550000
025600             '---- ---- ---- --- ---- ----- ------'.              02560000
025700*SB 01/20/14 - END PR#5148D                                       02570000
025800         10  FILLER                  PIC  X(06)    VALUE          02580000
025900             ' -----'.                                            02590000
026000         10  FILLER                  PIC  X(26)    VALUE          02600010
026100             '- ----- -------- -------- '.                        02610010
026200* CLP 06/05/13 PR #5148B END                                      02620000
026210*                                                                 02621009
026220*** DMH 07/01/14 - BEGIN                                          02622009
026230         10  FILLER                  PIC  X(27)    VALUE          02623011
026240             '------ ------ ------ ------'.                       02624011
026250*** DMH 07/01/14 - BEGIN                                          02625009
026260*                                                                 02626009
026300     05  BLANK-LINE                  PIC X(250)    VALUE SPACES.  02630000
026400     05  END-OF-REPORT-LINE.                                      02640000
026500         10  FILLER                  PIC  X(44)    VALUE SPACES.  02650000
026600         10  FILLER                  PIC  X(45)    VALUE          02660000
026700             '*******   E N D   O F   R E P O R T   *******'.     02670000
026800         10  FILLER                  PIC  X(43)    VALUE SPACES.  02680000
026900     05  NO-DATA-TO-REPORT-LINE.                                  02690000
027000         10  FILLER                  PIC  X(40)    VALUE SPACES.  02700000
027100         10  FILLER                  PIC  X(52)    VALUE          02710000
027200         '*******  N O   D A T A   T O   R E P O R T   *******'.  02720000
027300         10  FILLER                  PIC  X(40)    VALUE SPACES.  02730000
027400/                                                                 02740000
027500 01  DETAIL-LINES.                                                02750000
027600     05  DTL01-LINE.                                              02760000
027700         10  DTL01-DC                PIC  ZZZ9    BLANK WHEN ZERO.02770000
027800         10  FILLER                  PIC  X(01)    VALUE SPACES.  02780000
027900         10  DTL01-TRLR-LOC          PIC  X(05)    VALUE SPACES.  02790000
028000         10  FILLER                  PIC  X(01)    VALUE SPACES.  02800000
028100         10  DTL01-ARR-DATE          PIC  X(10)    VALUE SPACES.  02810000
028200         10  FILLER                  PIC  X(01)    VALUE SPACES.  02820000
028300         10  DTL01-SCAC              PIC  X(04)    VALUE SPACES.  02830000
028400         10  FILLER                  PIC  X(01)    VALUE SPACES.  02840000
028500         10  DTL01-TRLR              PIC  X(10)    VALUE SPACES.  02850000
028600         10  FILLER                  PIC  X(01)    VALUE SPACES.  02860000
028700         10  DTL01-VENDOR            PIC  X(12)    VALUE SPACES.  02870000
028800*SB 01/20/14 - BEGIN PR#5148D                                     02880000
028900         10  FILLER                  PIC  X(04)    VALUE SPACES.  02890000
029000         10  DTL01-RFID-STATUS       PIC  X(01)    VALUE SPACES.  02900000
029100         10  FILLER                  PIC  X(03)    VALUE SPACES.  02910000
029200*SB 01/20/14 - END PR#5148D                                       02920000
029300         10  DTL01-PO                PIC ZZZZZZZ9 BLANK WHEN ZERO.02930000
029400         10  FILLER                  PIC  X(01)    VALUE '-'.     02940000
029500         10  DTL01-RECEIVER          PIC  999     BLANK WHEN ZERO.02950000
029600         10  FILLER                  PIC  X(01)    VALUE SPACES.  02960000
029700         10  DTL01-LNE               PIC  ZZZ9    BLANK WHEN ZERO.02970000
029800         10  FILLER                  PIC  X(01)    VALUE SPACES.  02980000
029900         10  DTL01-PACK              PIC  ZZZ9    BLANK WHEN ZERO.02990000
030000         10  FILLER                  PIC  X(01)    VALUE SPACES.  03000000
030100         10  DTL01-SKU               PIC  X(08)    VALUE SPACES.  03010000
030200         10  FILLER                  PIC  X(01)    VALUE SPACES.  03020000
030300         10  DTL01-OUT-PAK           PIC    ZZ9   BLANK WHEN ZERO.03030000
030400         10  FILLER                  PIC  X(01)    VALUE SPACES.  03040000
030500         10  DTL01-P2L-LABEL         PIC  ZZZZ9   BLANK WHEN ZERO.03050000
030600         10  FILLER                  PIC  X(01)    VALUE SPACES.  03060000
030700         10  DTL01-SHIP-LABEL        PIC  ZZZZ9   BLANK WHEN ZERO.03070000
030800         10  FILLER                  PIC  X(02)    VALUE SPACES.  03080000
030900         10  DTL01-CSPK-DWLD         PIC  X(01)    VALUE SPACES.  03090000
031000         10  FILLER                  PIC  X(04)    VALUE SPACES.  03100000
031100         10  DTL01-UCC128            PIC  X(01)    VALUE SPACES.  03110000
031200         10  FILLER                  PIC  X(05)    VALUE SPACES.  03120000
031300         10  DTL01-AUD-CMPLT         PIC  X(01)    VALUE SPACES.  03130000
031400         10  FILLER                  PIC  X(04)    VALUE SPACES.  03140000
031500         10  DTL01-PREV-AUD          PIC  X(01)    VALUE SPACES.  03150000
031600         10  FILLER                  PIC  X(03)    VALUE SPACES.  03160000
031700         10  DTL01-100-AUD-CNT       PIC  ZZZ9    BLANK WHEN ZERO.03170000
031800         10  FILLER                  PIC  X(03)    VALUE SPACES.  03180000
031900         10  DTL01-PACK-TYPE         PIC  X(01)    VALUE SPACES.  03190000
032000         10  FILLER                  PIC  X(02)    VALUE SPACES.  03200000
032100         10  DTL01-VENDOR-RANK       PIC  X(06)    VALUE SPACES.  03210000
032200         10  FILLER                  PIC  X(02)    VALUE SPACES.  03220000
032300         10  DTL01-PROMPT-LINES      PIC  ZZZ9    BLANK WHEN ZERO.03230000
032400         10  FILLER                  PIC  X(01)    VALUE SPACES.  03240000
032500         10  DTL01-MIN-CTN-CHK       PIC  ZZZ9    BLANK WHEN ZERO.03250000
032600         10  FILLER                  PIC  X(01)    VALUE SPACES.  03260000
032700         10  DTL01-MAX-CTN-CHK       PIC  ZZZ9    BLANK WHEN ZERO.03270000
032800         10  FILLER                  PIC  X(01)    VALUE SPACES.  03280000
032900         10  DTL01-PCNT-TO-AUD       PIC  Z.99   BLANK WHEN ZERO. 03290000
033000         10  FILLER                  PIC  X(01)    VALUE SPACES.  03300000
033100         10  DTL01-UNT-PCKS-AUD      PIC  ZZZ9    BLANK WHEN ZERO.03310000
033200         10  FILLER                  PIC  X(02)    VALUE SPACES.  03320000
033300         10  DTL01-REQ-UNTS-CTN      PIC  ZZZ9    BLANK WHEN ZERO.03330000
033400         10  FILLER                  PIC  X(02)    VALUE SPACES.  03340000
033500         10  DTL01-Q-CTN             PIC  ZZZ9    BLANK WHEN ZERO.03350000
033600         10  FILLER                  PIC  X(01)    VALUE SPACES.  03360000
033700*SB 01/20/14 - BEGIN PR#5148D                                     03370000
033800*        10  DTL01-PCNT-Q-CTN        PIC  Z.99   BLANK WHEN ZERO. 03380000
033900*        10  FILLER                  PIC  X(01)    VALUE SPACES.  03390000
034000*SB 01/20/14 - END PR#5148D                                       03400000
034100         10  DTL01-NBR-U-CTN         PIC  ZZZ9    BLANK WHEN ZERO.03410000
034200         10  FILLER                  PIC  X(01)    VALUE SPACES.  03420000
034300*SB 01/20/14 - BEGIN PR#5148D                                     03430000
034400*        10  DTL01-PCNT-U-CTN        PIC  Z.99   BLANK WHEN ZERO. 03440000
034500*        10  FILLER                  PIC  X(01)    VALUE SPACES.  03450000
034600*SB 01/20/14 - END PR#5148D                                       03460000
034700         10  DTL01-NBR-CRSDK         PIC  ZZZ9    BLANK WHEN ZERO.03470000
034800         10  FILLER                  PIC  X(01)    VALUE SPACES.  03480000
034900         10  DTL01-PCNT-CRSDK        PIC  Z.99   BLANK WHEN ZERO. 03490000
035000*        10  FILLER                  PIC  X(01)    VALUE SPACES.  03500000
035100         10  DTL01-P2L-CTN           PIC  ZZZ9    BLANK WHEN ZERO.03510000
035200         10  FILLER                  PIC  X(01)    VALUE SPACES.  03520000
035300         10  DTL01-PCNT-P2L          PIC  Z.99   BLANK WHEN ZERO. 03530000
035400         10  FILLER                  PIC  X(01)    VALUE SPACES.  03540000
035500         10  DTL01-P2L-ZONE          PIC  X(05)    VALUE SPACES.  03550000
035600* CLP 06/05/13 PR #5148B START                                    03560000
035700         10  FILLER                  PIC  X(01)    VALUE SPACES.  03570000
035800         10  DTL01-RFID-CTN          PIC ZZZZZ9  BLANK WHEN ZERO. 03580000
035900         10  FILLER                  PIC  X(01)    VALUE SPACES.  03590000
036000         10  DTL01-RFID-UNT          PIC ZZZZZ9  BLANK WHEN ZERO. 03600000
036100* CLP 06/05/13 PR #5148B END                                      03610000
036200         10  FILLER                  PIC  X(01)    VALUE SPACES.  03620000
036300         10  DTL01-TRBL-CTN          PIC  ZZZZ9   BLANK WHEN ZERO.03630000
036400         10  FILLER                  PIC  X(02)    VALUE SPACES.  03640000
036500         10  DTL01-CTNS-NOT-SCN      PIC  ZZZZ9   BLANK WHEN ZERO.03650000
036600         10  FILLER                  PIC  X(04)    VALUE SPACES.  03660000
036700         10  DTL01-PCNT-COMPLETE     PIC  Z.99   BLANK WHEN ZERO. 03670000
036810*                                                                 03681008
036811* DMH 07/01/14 - START                                            03681108
036820         10  FILLER                  PIC  X(04)    VALUE SPACES.  03682013
036830         10  DTL01-HAZ-CTN           PIC ZZZZZ9  BLANK WHEN ZERO. 03683008
036840         10  FILLER                  PIC  X(01)    VALUE SPACES.  03684008
036850         10  DTL01-HAZ-UNT           PIC ZZZZZ9  BLANK WHEN ZERO. 03685008
036851         10  FILLER                  PIC  X(01)    VALUE SPACES.  03685108
036852         10  DTL01-CNTL-FLOW-CTN     PIC ZZZZZ9  BLANK WHEN ZERO. 03685208
036853         10  FILLER                  PIC  X(01)    VALUE SPACES.  03685308
036854         10  DTL01-CNTL-FLOW-UNT     PIC ZZZZZ9  BLANK WHEN ZERO. 03685408
036860* DMH 07/01/14 - END                                              03686008
036861*                                                                 03686108
036870     05  DTL02-LINE.                                              03687008
036900*SB 01/20/14 - BEGIN PR#5148D                                     03690000
037000*SB 03/28/14 - BEGIN PR#5148D                                     03700000
037210         10  DTL02-DC                PIC  ZZZ9    BLANK WHEN ZERO.03721000
037220         10  FILLER                  PIC  X(01)    VALUE SPACES.  03722000
037230         10  DTL02-TRLR-LOC          PIC  X(05)    VALUE SPACES.  03723000
037240         10  FILLER                  PIC  X(01)    VALUE SPACES.  03724000
037250         10  DTL02-ARR-DATE          PIC  X(10)    VALUE SPACES.  03725000
037260         10  FILLER                  PIC  X(01)    VALUE SPACES.  03726000
037300         10  DTL02-SCAC              PIC  X(04)    VALUE SPACES.  03730000
037400         10  FILLER                  PIC  X(01)    VALUE SPACES.  03740000
037500         10  DTL02-TRLR              PIC  X(10)    VALUE SPACES.  03750000
037600         10  FILLER                  PIC  X(14)    VALUE SPACES.  03760000
037610*SB 03/28/14 - END PR#5148D                                       03761000
037700         10  FILLER                  PIC  X(07)                   03770000
037800                    VALUE 'PO/REC '.                              03780000
037900         10  DTL02-PO                PIC ZZZZZZZ9 BLANK WHEN ZERO.03790000
038000         10  FILLER                  PIC  X(01)    VALUE '-'.     03800000
038100         10  DTL02-RECEIVER          PIC  999     BLANK WHEN ZERO.03810000
038200         10  FILLER                  PIC  X(05)    VALUE SPACES.  03820000
038300         10  FILLER                  PIC  X(35)                   03830000
038400                    VALUE 'TOTAL AUDIT CARTONS _ RECEIVER     '.  03840000
038500*        10  DTL02-TOTAL             PIC  ZZZZ9 BLANK WHEN ZERO.  03850000
038600         10  FILLER                  PIC  X(01)    VALUE SPACES.  03860000
038700         10  DTL02-TOTAL             PIC  ZZZZ9.                  03870000
038800     05  DTL03-LINE.                                              03880000
038900*SB 03/28/14 - BEGIN PR#5148D                                     03890000
039110         10  DTL03-DC                PIC  ZZZ9    BLANK WHEN ZERO.03911000
039120         10  FILLER                  PIC  X(01)    VALUE SPACES.  03912000
039130         10  DTL03-TRLR-LOC          PIC  X(05)    VALUE SPACES.  03913000
039140         10  FILLER                  PIC  X(01)    VALUE SPACES.  03914000
039150         10  DTL03-ARR-DATE          PIC  X(10)    VALUE SPACES.  03915000
039160         10  FILLER                  PIC  X(01)    VALUE SPACES.  03916000
039200         10  DTL03-SCAC              PIC  X(04)    VALUE SPACES.  03920000
039300         10  FILLER                  PIC  X(01)    VALUE SPACES.  03930000
039400         10  DTL03-TRLR              PIC  X(10)    VALUE SPACES.  03940000
039500         10  FILLER                  PIC  X(14)    VALUE SPACES.  03950000
039510*SB 03/28/14 - END PR#5148D                                       03951000
039600         10  FILLER                  PIC  X(07)                   03960000
039700                    VALUE 'PO/REC '.                              03970000
039800         10  DTL03-PO                PIC ZZZZZZZ9 BLANK WHEN ZERO.03980000
039900         10  FILLER                  PIC  X(01)    VALUE '-'.     03990000
040000         10  DTL03-RECEIVER          PIC  999     BLANK WHEN ZERO.04000000
040100         10  FILLER                  PIC  X(05)    VALUE SPACES.  04010000
040200         10  FILLER                  PIC  X(35)                   04020000
040300                    VALUE 'TOTAL UNIT/PACK TO AUDIT _ RECEIVER'.  04030000
040400*        10  DTL03-TOTAL             PIC  ZZZZ9 BLANK WHEN ZERO.  04040000
040500         10  FILLER                  PIC  X(01)    VALUE SPACES.  04050000
040600         10  DTL03-TOTAL             PIC  ZZZZ9.                  04060000
040700     05  DTL04-LINE.                                              04070000
040800*SB 03/28/14 - BEGIN PR#5148D                                     04080000
041010         10  DTL04-DC                PIC  ZZZ9    BLANK WHEN ZERO.04101000
041020         10  FILLER                  PIC  X(01)    VALUE SPACES.  04102000
041030         10  DTL04-TRLR-LOC          PIC  X(05)    VALUE SPACES.  04103000
041040         10  FILLER                  PIC  X(01)    VALUE SPACES.  04104000
041050         10  DTL04-ARR-DATE          PIC  X(10)    VALUE SPACES.  04105000
041060         10  FILLER                  PIC  X(01)    VALUE SPACES.  04106000
041100         10  DTL04-SCAC              PIC  X(04)    VALUE SPACES.  04110000
041200         10  FILLER                  PIC  X(01)    VALUE SPACES.  04120000
041300         10  DTL04-TRLR              PIC  X(10)    VALUE SPACES.  04130000
041400         10  FILLER                  PIC  X(14)    VALUE SPACES.  04140000
041410*SB 03/28/14 - END PR#5148D                                       04141000
041500         10  FILLER                  PIC  X(07)                   04150000
041600                    VALUE 'PO/REC '.                              04160000
041700         10  DTL04-PO                PIC ZZZZZZZ9 BLANK WHEN ZERO.04170000
041800         10  FILLER                  PIC  X(01)    VALUE '-'.     04180000
041900         10  DTL04-RECEIVER          PIC  999     BLANK WHEN ZERO.04190000
042000         10  FILLER                  PIC  X(05)    VALUE SPACES.  04200000
042100         10  FILLER                  PIC  X(35)                   04210000
042200                    VALUE 'TOTAL RFID AUDIT CARTONS _ RECEIVER'.  04220000
042300*        10  DTL04-TOTAL             PIC  ZZZZ9 BLANK WHEN ZERO.  04230000
042400         10  FILLER                  PIC  X(01)    VALUE SPACES.  04240000
042500         10  DTL04-TOTAL             PIC  ZZZZ9.                  04250000
042600         10  FILLER                  PIC  X(11)    VALUE SPACES.  04260000
042700         10  DTL04-RFID-100-PC       PIC  ZZZZ9.                  04270000
042800         10  FILLER                  PIC  X(05)    VALUE SPACES.  04280000
042900         10  DTL04-RFID-RANK         PIC  X(06).                  04290000
043000*SB 01/20/14 - END PR#5148D                                       04300000
043100/                                                                 04310000
043200******************************************************            04320000
043300*  XLT00010 - DC LOCATION TABLE                      *            04330000
043400******************************************************            04340000
043500     EXEC SQL                                                     04350000
043600          INCLUDE XLT00010                                        04360000
043700     END-EXEC.                                                    04370000
043800/                                                                 04380000
043900******************************************************            04390000
044000*  TENTNME - VENDOR NAME TABLE                       *            04400000
044100******************************************************            04410000
044200     EXEC SQL                                                     04420000
044300          INCLUDE TENTNME                                         04430000
044400     END-EXEC.                                                    04440000
044500/                                                                 04450000
044600******************************************************            04460000
044700*  TEXTENT - VENDOR ENTITY TABLE                     *            04470000
044800******************************************************            04480000
044900     EXEC SQL                                                     04490000
045000          INCLUDE TEXTENT                                         04500000
045100     END-EXEC.                                                    04510000
045200/                                                                 04520000
045300******************************************************            04530000
045400*  DB2 AREA FOR COMMUNICATIONS                       *            04540000
045500******************************************************            04550000
045600     EXEC SQL                                                     04560000
045700          INCLUDE SQLCA                                           04570000
045800     END-EXEC.                                                    04580000
045900                                                                  04590000
046000     COPY SQLCA2.                                                 04600000
046100/                                                                 04610000
046200 PROCEDURE DIVISION.                                              04620000
046300                                                                  04630000
046400     DISPLAY '***BEGINNING PCKRP031***'.                          04640000
046500******************************************************            04650000
046600* 0000-MAINLINE.                                     *            04660000
046700******************************************************            04670000
046800 0000-MAINLINE.                                                   04680000
046900                                                                  04690000
047000     PERFORM 0010-INITIALIZATION.                                 04700000
047100                                                                  04710000
047200     PERFORM 1000-PROCESS-INPUT                                   04720000
047300        THRU 1000-PROCESS-INPUT-EXIT                              04730000
047400         UNTIL ( PS-END-OF-INPUT ).                               04740000
047500                                                                  04750000
047600     PERFORM 0020-END-PROGRAM.                                    04760000
047700     GOBACK.                                                      04770000
047800/                                                                 04780000
047900******************************************************            04790000
048000* 0010-INITIALIZATION.                               *            04800000
048100******************************************************            04810000
048200 0010-INITIALIZATION.                                             04820000
048300                                                                  04830000
048400     OPEN INPUT  INPUT01-FILE                                     04840000
048500          OUTPUT REPORT-FILE.                                     04850000
048600                                                                  04860000
048700     ACCEPT PV-TODAYS-DATE   FROM DATE.                           04870000
048800     ACCEPT PV-TODAYS-TIME   FROM TIME.                           04880000
048900                                                                  04890000
049000     MOVE PV-TODAYS-DATE-MM      TO DP250O-RUN-MONTH.             04900000
049100     MOVE PV-TODAYS-DATE-DD      TO DP250O-RUN-DAY.               04910000
049200     MOVE PV-TODAYS-DATE-YY      TO DP250O-RUN-YEAR.              04920000
049300     MOVE PV-TODAYS-TIME-HH      TO DP250O-RUN-HOUR.              04930000
049400     MOVE PV-TODAYS-TIME-MM      TO DP250O-RUN-MINUTE.            04940000
049500     MOVE PC-PROGRAM-NAME        TO DP250O-PROGRAM-NAME.          04950000
049600     MOVE PC-REPORT-NBR          TO DP250O-REPORT-NUMBER.         04960000
049700                                                                  04970000
049800     PERFORM 9050-REPORT-HEADERS.                                 04980000
049900/                                                                 04990000
050000******************************************************            05000000
050100* 0020-END-PROGRAM.                                  *            05010000
050200******************************************************            05020000
050300 0020-END-PROGRAM.                                                05030000
050400                                                                  05040000
050500     PERFORM 3000-TOTAL-RECORD.                                   05050000
050600                                                                  05060000
050700     IF ( PV-LINE-CNT > PV-LINE-LIMIT )                           05070000
050800         PERFORM 9050-REPORT-HEADERS                              05080000
050900     END-IF.                                                      05090000
051000                                                                  05100000
051100     IF ( PS-FIRST-TIME )                                         05110000
051200         WRITE REPORT-RECORD FROM NO-DATA-TO-REPORT-LINE          05120000
051300              AFTER ADVANCING 2 LINES                             05130000
051400     END-IF.                                                      05140000
051500                                                                  05150000
051600     WRITE REPORT-RECORD FROM END-OF-REPORT-LINE                  05160000
051700          AFTER ADVANCING 3 LINES.                                05170000
051800                                                                  05180000
051900     CLOSE INPUT01-FILE                                           05190000
052000           REPORT-FILE.                                           05200000
052100/                                                                 05210000
052200******************************************************            05220000
052300* 1000-PROCESS-INPUT.                                *            05230000
052400******************************************************            05240000
052500 1000-PROCESS-INPUT.                                              05250000
052600                                                                  05260000
052700     READ INPUT01-FILE INTO PC068-RECORD-LAYOUT                   05270000
052800         AT END MOVE 'Y' TO PS-END-OF-INPUT-SW                    05280000
052900                GO TO 1000-PROCESS-INPUT-EXIT.                    05290000
053000                                                                  05300000
053100**** THIS PROGRAM SHOULD ONLY PROCESS DETAIL RECORD TYPES         05310000
053200     IF PC068-TRAILER-RECORD                                      05320000
053300         GO TO 1000-PROCESS-INPUT-EXIT.                           05330000
053400                                                                  05340000
053500     IF ( PS-FIRST-TIME )                                         05350000
053600         MOVE 'N' TO PS-FIRST-TIME-SW                             05360000
053700         MOVE PC068-OPER-UNT-ID TO PV-DC-LOCATION                 05370000
053800                                   HDR02-DC                       05380000
053900         MOVE PC068-REC-SEQ-NBR TO PV-PREV-RECEIVER               05390000
054000         MOVE PC068-PO-NBR      TO PV-PREV-PO                     05400000
054100*SB 01/20/14 - BEGIN PR#5148D                                     05410000
054200         MOVE PC068-RFID-VENDOR-RANKING TO PV-PREV-RFID-RANK      05420000
054300         MOVE PC068-RFID-AUD-CRTNS-100-PO TO PV-PREV-RFID-100-PC  05430000
054400*SB 01/20/14 - END PR#5148D                                       05440000
054401*SB 03/28/14 - BEGIN PR#5148D                                     05440100
054410         MOVE PC068-OPER-UNT-ID TO PV-PREV-DC                     05441000
054411         MOVE PC068-TRLR-LOC    TO PV-PREV-TRLR-LOC               05441100
054412         IF ( PC068-ARRIVAL-DATE = '01-01-0001' )                 05441200
054413             MOVE 'ENROUTE   '         TO PV-PREV-ARR-DATE        05441300
054414         ELSE                                                     05441400
054415             MOVE PC068-ARRIVAL-DATE   TO PV-PREV-ARR-DATE        05441500
054416         END-IF                                                   05441600
054417         MOVE PC068-SCAC        TO PV-PREV-SCAC                   05441700
054420         MOVE PC068-TRLR-NBR    TO PV-PREV-TRAILER                05442000
054430*SB 03/28/14 - END PR#5148D                                       05443000
054500         PERFORM 2000-VALIDATE-DC                                 05450000
054600         PERFORM 9040-PAGE-HEADERS                                05460000
054700     END-IF.                                                      05470000
054800                                                                  05480000
054900     IF ( PC068-OPER-UNT-ID NOT = PV-DC-LOCATION )                05490000
055000         MOVE PC068-OPER-UNT-ID TO PV-DC-LOCATION                 05500000
055100                                   HDR02-DC                       05510000
055200         PERFORM 3000-TOTAL-RECORD                                05520000
055300         MOVE PC068-REC-SEQ-NBR TO PV-PREV-RECEIVER               05530000
055400         MOVE PC068-PO-NBR      TO PV-PREV-PO                     05540000
055401*SB 03/28/14 - BEGIN PR#5148D                                     05540100
055402         MOVE PC068-OPER-UNT-ID TO PV-PREV-DC                     05540200
055403         MOVE PC068-TRLR-LOC    TO PV-PREV-TRLR-LOC               05540300
055404         IF ( PC068-ARRIVAL-DATE = '01-01-0001' )                 05540400
055405             MOVE 'ENROUTE   '         TO PV-PREV-ARR-DATE        05540500
055406         ELSE                                                     05540600
055407             MOVE PC068-ARRIVAL-DATE   TO PV-PREV-ARR-DATE        05540700
055408         END-IF                                                   05540800
055410         MOVE PC068-SCAC        TO PV-PREV-SCAC                   05541000
055420         MOVE PC068-TRLR-NBR    TO PV-PREV-TRAILER                05542000
055430*SB 03/28/14 - END PR#5148D                                       05543000
055500         PERFORM 2000-VALIDATE-DC                                 05550000
055600         PERFORM 9050-REPORT-HEADERS                              05560000
055700         PERFORM 9040-PAGE-HEADERS                                05570000
055800     ELSE                                                         05580000
055900         IF (PC068-REC-SEQ-NBR NOT = PV-PREV-RECEIVER) OR         05590000
056000            (PC068-PO-NBR      NOT = PV-PREV-PO)                  05600000
056100             PERFORM 3000-TOTAL-RECORD                            05610000
056200             MOVE PC068-REC-SEQ-NBR TO PV-PREV-RECEIVER           05620000
056300             MOVE PC068-PO-NBR      TO PV-PREV-PO                 05630000
056301*SB 03/28/14 - BEGIN PR#5148D                                     05630100
056302             MOVE PC068-OPER-UNT-ID TO PV-PREV-DC                 05630200
056303             MOVE PC068-TRLR-LOC    TO PV-PREV-TRLR-LOC           05630300
056304             IF ( PC068-ARRIVAL-DATE = '01-01-0001' )             05630400
056305                MOVE 'ENROUTE   '         TO PV-PREV-ARR-DATE     05630500
056306             ELSE                                                 05630600
056307                MOVE PC068-ARRIVAL-DATE   TO PV-PREV-ARR-DATE     05630700
056308             END-IF                                               05630800
056311             MOVE PC068-SCAC        TO PV-PREV-SCAC               05631100
056320             MOVE PC068-TRLR-NBR    TO PV-PREV-TRAILER            05632000
056330*SB 03/28/14 - END PR#5148D                                       05633000
056400         END-IF                                                   05640000
056500     END-IF.                                                      05650000
056600                                                                  05660000
056700*SB 01/20/14 - BEGIN PR#5148D                                     05670000
056800     MOVE PC068-RFID-VENDOR-RANKING TO PV-PREV-RFID-RANK          05680000
056900     MOVE PC068-RFID-AUD-CRTNS-100-PO TO PV-PREV-RFID-100-PC      05690000
057000*SB 01/20/14 - END PR#5148D                                       05700000
057100                                                                  05710000
057200     PERFORM 9000-REPORT-DETAIL.                                  05720000
057300                                                                  05730000
057400 1000-PROCESS-INPUT-EXIT.                                         05740000
057500     EXIT.                                                        05750000
057600/                                                                 05760000
057700******************************************************            05770000
057800* 2000-VALIDATE-DC.                                  *            05780000
057900******************************************************            05790000
058000 2000-VALIDATE-DC.                                                05800000
058100                                                                  05810000
058200     MOVE PV-DC-LOCATION TO XLT00010-LOC-NBR.                     05820000
058300                                                                  05830000
058400     EXEC SQL                                                     05840000
058500         SELECT A.LOC_NM                                          05850000
058600           INTO :XLT00010-LOC-NM                                  05860000
058700           FROM XLT_LOC A                                         05870000
058800          WHERE A.LOC_NBR     = :XLT00010-LOC-NBR                 05880000
058900           WITH UR                                                05890000
059000     END-EXEC.                                                    05900000
059100                                                                  05910000
059200     EVALUATE TRUE                                                05920000
059300       WHEN SQLCODE = ZERO                                        05930000
059400           MOVE XLT00010-LOC-NM TO HDR02-DC-DESCRIPTION           05940000
059500       WHEN OTHER                                                 05950000
059600           MOVE SPACES          TO HDR02-DC-DESCRIPTION           05960000
059700     END-EVALUATE.                                                05970000
059800/                                                                 05980000
059900******************************************************            05990000
060000 3000-TOTAL-RECORD.                                               06000000
060100                                                                  06010000
060200     IF ( PV-LINE-CNT > PV-LINE-LIMIT )                           06020000
060300         PERFORM 9050-REPORT-HEADERS                              06030000
060400         PERFORM 9040-PAGE-HEADERS                                06040000
060500     END-IF.                                                      06050000
060600                                                                  06060000
060700     MOVE PV-REC-PO-TOTAL          TO DTL02-TOTAL.                06070000
060800                                                                  06080000
060900*SB 01/20/14 - BEGIN PR#5148D                                     06090000
061000     MOVE PV-PREV-PO               TO DTL02-PO                    06100000
061100     MOVE PV-PREV-RECEIVER         TO DTL02-RECEIVER              06110000
061101*SB 01/20/14 - END PR#5148D                                       06110100
061102*SB 03/28/14 - BEGIN PR#5148D                                     06110200
061110     MOVE PV-PREV-DC               TO DTL02-DC                    06111000
061111     MOVE PV-PREV-TRLR-LOC         TO DTL02-TRLR-LOC              06111100
061112     MOVE PV-PREV-ARR-DATE         TO DTL02-ARR-DATE              06111200
061113     MOVE PV-PREV-SCAC             TO DTL02-SCAC                  06111300
061120     MOVE PV-PREV-TRAILER          TO DTL02-TRLR                  06112000
061130*SB 03/28/14 - END PR#5148D                                       06113000
061300     WRITE REPORT-RECORD FROM DTL02-LINE                          06130000
061400            AFTER ADVANCING 1 LINE.                               06140000
061500                                                                  06150000
061600     MOVE PV-AUD-UNIT-TOTAL        TO DTL03-TOTAL.                06160000
061700                                                                  06170000
061800*SB 01/20/14 - BEGIN PR#5148D                                     06180000
061900     MOVE PV-PREV-PO               TO DTL03-PO                    06190000
062000     MOVE PV-PREV-RECEIVER         TO DTL03-RECEIVER              06200000
062100*SB 01/20/14 - END PR#5148D                                       06210000
062101*SB 03/28/14 - BEGIN PR#5148D                                     06210100
062102     MOVE PV-PREV-DC               TO DTL03-DC                    06210200
062103     MOVE PV-PREV-TRLR-LOC         TO DTL03-TRLR-LOC              06210300
062104     MOVE PV-PREV-ARR-DATE         TO DTL03-ARR-DATE              06210400
062110     MOVE PV-PREV-SCAC             TO DTL03-SCAC                  06211000
062120     MOVE PV-PREV-TRAILER          TO DTL03-TRLR                  06212000
062130*SB 03/28/14 - END PR#5148D                                       06213000
062200     WRITE REPORT-RECORD FROM DTL03-LINE                          06220000
062300            AFTER ADVANCING 1 LINE.                               06230000
062400                                                                  06240000
062500*SB 01/20/14 - BEGIN PR#5148D                                     06250000
062600     MOVE PV-PREV-PO               TO DTL04-PO                    06260000
062700     MOVE PV-PREV-RECEIVER         TO DTL04-RECEIVER              06270000
062800     MOVE PV-AUD-RFID-TOTAL        TO DTL04-TOTAL.                06280000
062900     MOVE PV-PREV-RFID-RANK        TO DTL04-RFID-RANK.            06290000
063000     MOVE PV-PREV-RFID-100-PC      TO DTL04-RFID-100-PC.          06300000
063001*SB 03/28/14 - BEGIN PR#5148D                                     06300100
063002     MOVE PV-PREV-DC               TO DTL04-DC.                   06300200
063003     MOVE PV-PREV-TRLR-LOC         TO DTL04-TRLR-LOC.             06300300
063004     MOVE PV-PREV-ARR-DATE         TO DTL04-ARR-DATE.             06300400
063010     MOVE PV-PREV-SCAC             TO DTL04-SCAC.                 06301000
063020     MOVE PV-PREV-TRAILER          TO DTL04-TRLR.                 06302000
063030*SB 03/28/14 - END PR#5148D                                       06303000
063100                                                                  06310000
063200     WRITE REPORT-RECORD FROM DTL04-LINE                          06320000
063300            AFTER ADVANCING 1 LINE.                               06330000
063400                                                                  06340000
063500     ADD  +3     TO PV-LINE-CNT.                                  06350000
063600*SB 01/20/14 - END PR#5148D                                       06360000
063700                                                                  06370000
063800     MOVE ZERO TO PV-REC-PO-TOTAL                                 06380000
063900                  PV-AUD-UNIT-TOTAL                               06390000
064000*SB 01/20/14 - BEGIN PR#5148D                                     06400000
064100                  PV-AUD-RFID-TOTAL                               06410000
064200*SB 01/20/14 - END PR#5148D                                       06420000
064300                  PV-NBR-OF-LINES.                                06430000
064400/                                                                 06440000
064500******************************************************            06450000
064600* 8000-GET-VENDOR-NAME.                              *            06460000
064700******************************************************            06470000
064800 8000-GET-VENDOR-NAME.                                            06480000
064900                                                                  06490000
065000     EXEC SQL                                                     06500000
065100         SELECT  A.ENT_NAME_DESC                                  06510000
065200           INTO :ENTNME-ENT-NAME-DESC                             06520000
065300           FROM TENTNME A                                         06530000
065400               ,TEXTENT B                                         06540000
065500          WHERE B.ENT_ID        = :PC068-ENT-ID                   06550000
065600            AND A.TYPE_CDE      = '01'                            06560000
065700            AND B.ENT_ID        = A.ENT_ID                        06570000
065800            AND B.STATUS_CDE    = 'A'                             06580000
065900           WITH UR                                                06590000
066000     END-EXEC.                                                    06600000
066100     EVALUATE TRUE                                                06610000
066200       WHEN SQLCODE = ZERO                                        06620000
066300           MOVE ENTNME-ENT-NAME-DESC TO DTL01-VENDOR              06630000
066400       WHEN OTHER                                                 06640000
066500           MOVE SPACES               TO DTL01-VENDOR              06650000
066600     END-EVALUATE.                                                06660000
066700/                                                                 06670000
066800******************************************************            06680000
066900* 9000-REPORT-DETAIL.                                *            06690000
067000******************************************************            06700000
067100 9000-REPORT-DETAIL.                                              06710000
067200                                                                  06720000
067300     IF ( PV-LINE-CNT > PV-LINE-LIMIT )                           06730000
067400         PERFORM 9050-REPORT-HEADERS                              06740000
067500         PERFORM 9040-PAGE-HEADERS                                06750000
067600     END-IF.                                                      06760000
067700                                                                  06770000
067800     PERFORM 8000-GET-VENDOR-NAME.                                06780000
067900                                                                  06790000
068000* CLP 06/05/13 PR #5148B START                                    06800000
068100     MOVE PC068-RFID-CTN-CNT   TO DTL01-RFID-CTN.                 06810000
068200     MOVE PC068-RFID-UNT-CNT   TO DTL01-RFID-UNT.                 06820000
068300* CLP 06/05/13 PR #5148B END                                      06830000
068400     MOVE PC068-OPER-UNT-ID        TO DTL01-DC.                   06840000
068500     MOVE PC068-TRLR-LOC           TO DTL01-TRLR-LOC.             06850000
068600     IF ( PC068-ARRIVAL-DATE = '01-01-0001' )                     06860000
068700         MOVE 'ENROUTE   '         TO DTL01-ARR-DATE              06870000
068800     ELSE                                                         06880000
068900         MOVE PC068-ARRIVAL-DATE   TO DTL01-ARR-DATE.             06890000
069000     MOVE PC068-SCAC               TO DTL01-SCAC.                 06900000
069100     MOVE PC068-TRLR-NBR           TO DTL01-TRLR.                 06910000
069200     MOVE PC068-PO-NBR             TO DTL01-PO.                   06920000
069300     MOVE PC068-REC-SEQ-NBR        TO DTL01-RECEIVER.             06930000
069400     MOVE PC068-PO-LNE-NBR         TO DTL01-LNE.                  06940000
069500     MOVE PC068-PACK-ID            TO DTL01-PACK.                 06950000
069600     MOVE PC068-SKU-NUMBER         TO DTL01-SKU.                  06960000
069700** GB 4/24/12                                                     06970000
069800     MOVE PC068-OTPK-QTY           TO DTL01-OUT-PAK.              06980000
069900** GB 4/24/12                                                     06990000
070000     MOVE PC068-P2L-CTN-CNT        TO DTL01-P2L-LABEL.            07000000
070100     MOVE PC068-XDCK-CTN-CNT       TO DTL01-SHIP-LABEL.           07010000
070200     MOVE PC068-CASEPK-IND         TO DTL01-CSPK-DWLD.            07020000
070300     MOVE PC068-UCC128-IND         TO DTL01-UCC128.               07030000
070400     MOVE PC068-AUD-COMPLETE       TO DTL01-AUD-CMPLT.            07040000
070500     MOVE PC068-PREV-AUD-FAIL      TO DTL01-PREV-AUD.             07050000
070600     MOVE PC068-AUD-CRTNS-100-PO   TO DTL01-100-AUD-CNT.          07060000
070700     MOVE PC068-PKG-TYPE           TO DTL01-PACK-TYPE.            07070000
070800     MOVE PC068-VENDOR-RANKING     TO DTL01-VENDOR-RANK.          07080000
070900     MOVE PC068-PROMPTED-LINES     TO DTL01-PROMPT-LINES.         07090000
071000     MOVE PC068-MIN-CRTN-CHECK     TO DTL01-MIN-CTN-CHK.          07100000
071100     MOVE PC068-MAX-CRTN-CHECK     TO DTL01-MAX-CTN-CHK.          07110000
071200*    MOVE PC068-PCNT-TO-AUDIT      TO DTL01-PCNT-TO-AUD.          07120000
071300     IF PC068-PCNT-TO-AUDIT > ZERO                                07130000
071400         COMPUTE PV-PCNT-FIELD =                                  07140000
071500                (PC068-PCNT-TO-AUDIT / 100)                       07150000
071600         MOVE PV-PCNT-FIELD TO DTL01-PCNT-TO-AUD                  07160000
071700     ELSE                                                         07170000
071800         MOVE ZERO          TO DTL01-PCNT-TO-AUD.                 07180000
071900     MOVE PC068-UNITS-TO-AUDIT     TO DTL01-UNT-PCKS-AUD.         07190000
072000     MOVE PC068-UNITS-TO-AUDIT     TO DTL01-REQ-UNTS-CTN.         07200000
072100     MOVE PC068-AUD-CRTNS-LINE     TO DTL01-Q-CTN.                07210000
072200     MOVE PC068-AUD-CRTNS-LINE-U   TO DTL01-NBR-U-CTN.            07220000
072300     MOVE PC068-XDCK-CTN-CNT TO DTL01-NBR-CRSDK.                  07230000
072400     IF PC068-XDCK-CTN-CNT > ZERO AND PC068-TOT-CTN-CNT > ZERO    07240000
072500         COMPUTE PV-PCNT-FIELD =                                  07250000
072600                 (PC068-XDCK-CTN-CNT / PC068-TOT-CTN-CNT)         07260000
072700         MOVE PV-PCNT-FIELD TO DTL01-PCNT-CRSDK                   07270000
072800     ELSE                                                         07280000
072900         MOVE ZERO          TO DTL01-PCNT-CRSDK.                  07290000
073000     MOVE PC068-P2L-CTN-CNT        TO DTL01-P2L-CTN.              07300000
073100     IF PC068-P2L-CTN-CNT > ZERO AND PC068-TOT-CTN-CNT > ZERO     07310000
073200         COMPUTE PV-PCNT-FIELD =                                  07320000
073300                (PC068-P2L-CTN-CNT / PC068-TOT-CTN-CNT)           07330000
073400         MOVE PV-PCNT-FIELD TO DTL01-PCNT-P2L                     07340000
073500     ELSE                                                         07350000
073600         MOVE ZERO          TO DTL01-PCNT-P2L.                    07360000
073700     MOVE PC068-STORE-ZONE         TO DTL01-P2L-ZONE.             07370000
073800     MOVE PC068-TRBLE-CTN-LINE     TO DTL01-TRBL-CTN.             07380000
073900     MOVE PC068-CRTNS-TO-SCAN      TO DTL01-CTNS-NOT-SCN.         07390000
074000     IF PC068-CRTNS-TO-SCAN > ZERO AND PC068-TOT-CTN-CNT > ZERO   07400000
074100         COMPUTE PV-PCNT-FIELD =                                  07410000
074200                ((PC068-TOT-CTN-CNT - PC068-CRTNS-TO-SCAN) /      07420000
074300                 PC068-TOT-CTN-CNT)                               07430000
074400         MOVE PV-PCNT-FIELD TO DTL01-PCNT-COMPLETE                07440000
074500     ELSE                                                         07450000
074600     IF PC068-TOT-CTN-CNT = ZERO                                  07460000
074700         MOVE ZERO          TO DTL01-PCNT-COMPLETE                07470000
074800     ELSE                                                         07480000
074900         MOVE 1.00          TO DTL01-PCNT-COMPLETE.               07490000
075000                                                                  07500000
075100*SB 01/20/14 - BEGIN PR#5148D                                     07510000
075200     MOVE PC068-RFID-STATUS TO DTL01-RFID-STATUS.                 07520000
075300*SB 01/20/14 - END PR#5148D                                       07530000
075400                                                                  07540000
075401* DMH 07/01/14 - BEGIN                                            07540108
075410     MOVE PC068-HAZ-CTN-CNT       TO DTL01-HAZ-CTN.               07541008
075430     MOVE PC068-HAZ-UNT-CNT       TO DTL01-HAZ-UNT.               07543008
075450     MOVE PC068-CNTL-FLOW-CTN-CNT TO DTL01-CNTL-FLOW-CTN.         07545008
075470     MOVE PC068-CNTL-FLOW-UNT-CNT TO DTL01-CNTL-FLOW-UNT.         07547008
075480* DMH 07/01/14 - END                                              07548008
075490                                                                  07549008
075500     WRITE REPORT-RECORD FROM DTL01-LINE                          07550000
075600            AFTER ADVANCING 1 LINE.                               07560000
075700                                                                  07570000
075800     ADD  +1 TO PV-LINE-CNT                                       07580000
075900                PV-NBR-OF-LINES.                                  07590000
076000                                                                  07600000
076100     COMPUTE PV-REC-PO-TOTAL       =                              07610000
076200             PV-REC-PO-TOTAL + PC068-AUD-CRTNS-LINE.              07620000
076300     COMPUTE PV-AUD-UNIT-TOTAL     =                              07630000
076400             PV-AUD-UNIT-TOTAL + PC068-UNITS-TO-AUDIT.            07640000
076500*SB 01/10/14 - BEGIN PR#5148D                                     07650000
076600     COMPUTE PV-AUD-RFID-TOTAL     =                              07660000
076700             PV-AUD-RFID-TOTAL + PC068-RFID-AUD-CRTNS-LINE.       07670000
076800*SB 01/20/14 - END PR#5148D                                       07680000
076900/                                                                 07690000
077000******************************************************            07700000
077100* 9040-PAGE-HEADERS.                                 *            07710000
077200******************************************************            07720000
077300 9040-PAGE-HEADERS.                                               07730000
077400                                                                  07740000
077500     IF ( PV-LINE-CNT > PV-LINE-LIMIT )                           07750000
077600         PERFORM 9050-REPORT-HEADERS                              07760000
077700     END-IF.                                                      07770000
077800                                                                  07780000
077900     WRITE REPORT-RECORD FROM HDR02-LINE                          07790000
078000            AFTER ADVANCING 2 LINES.                              07800000
078100     WRITE REPORT-RECORD FROM HDR03-LINE                          07810000
078200            AFTER ADVANCING 1 LINE.                               07820000
078300     WRITE REPORT-RECORD FROM HDR04-LINE                          07830000
078400            AFTER ADVANCING 1 LINE.                               07840000
078500     WRITE REPORT-RECORD FROM HDR05-LINE                          07850000
078600            AFTER ADVANCING 1 LINES.                              07860000
078700     WRITE REPORT-RECORD FROM HDR06-LINE                          07870000
078800            AFTER ADVANCING 1 LINES.                              07880000
078900     WRITE REPORT-RECORD FROM HDR07-LINE                          07890000
079000            AFTER ADVANCING 1 LINE.                               07900000
079100                                                                  07910000
079200     ADD  +7 TO PV-LINE-CNT.                                      07920000
079300/                                                                 07930000
079400******************************************************            07940000
079500* 9050-REPORT-HEADERS.                               *            07950000
079600******************************************************            07960000
079700 9050-REPORT-HEADERS.                                             07970000
079800                                                                  07980000
079900     ADD +1           TO PV-PAGE-CNT.                             07990000
080000     MOVE PV-PAGE-CNT TO DP250O-PAGE-NUMBER.                      08000000
080100                                                                  08010000
080200     WRITE REPORT-RECORD FROM DP250O-STANDRD-HEADER-250-COLS      08020000
080300            AFTER ADVANCING PAGE.                                 08030000
080400     WRITE REPORT-RECORD FROM HDR01-LINE                          08040000
080500            AFTER ADVANCING 1 LINE.                               08050000
080600*    WRITE REPORT-RECORD FROM BLANK-LINE                          08060000
080700*           AFTER ADVANCING 1 LINE.                               08070000
080800                                                                  08080000
080900     MOVE +2 TO PV-LINE-CNT.                                      08090000
081000*    MOVE +3 TO PV-LINE-CNT.                                      08100000
081100/                                                                 08110000
