000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.             RCKRP094.                                00020000
000300 AUTHOR.                 DENISE HAHN.                             00030000
000400 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00040000
000500 DATE-WRITTEN.           JANUARY, 2022.                           00050000
000600 DATE-COMPILED.                                                   00060000
000700                                                                  00070000
000800***************************************************************** 00080000
000900*                                                               * 00090000
001000*  FALL OUT REPORT - ASN BEING SENT TO 3RD PARTY WAREHOUSE      * 00100000
001100*  ISSUE WITH DATA BEING SENT                                   * 00110000
001200*                                                               * 00120000
001300*  INPUT FILE IS CREATED BY RCKUT186 - RCRD001 - LRECL 600      * 00130000
001400*                                                               * 00140000
001500***************************************************************** 00150000
001600 ENVIRONMENT DIVISION.                                            00160000
001700 CONFIGURATION SECTION.                                           00170000
001800                                                                  00180000
001900 SOURCE-COMPUTER.        IBM-3090.                                00190000
002000 OBJECT-COMPUTER.        IBM-3090.                                00200000
002100                                                                  00210000
002200***************************************************************** 00220000
002300 INPUT-OUTPUT SECTION.                                            00230000
002400                                                                  00240000
002500 FILE-CONTROL.                                                    00250000
002600                                                                  00260000
002700     SELECT INPUT-FILE                                            00270000
002800         ASSIGN TO INP01.                                         00280000
002900                                                                  00290000
003000     SELECT REPORT-FILE                                           00300000
003100         ASSIGN TO RPT01.                                         00310000
003200                                                                  00320000
003300***************************************************************** 00330000
003400 DATA DIVISION.                                                   00340000
003500***************************************************************** 00350000
003600 FILE SECTION.                                                    00360000
003700                                                                  00370000
003800 FD  INPUT-FILE                                                   00380000
003900     RECORDING MODE IS F                                          00390000
004000     LABEL RECORDS ARE STANDARD                                   00400000
004100     BLOCK CONTAINS 0 RECORDS.                                    00410000
004200 01  INPUT-RECORD                    PIC  X(600).                 00420000
004300                                                                  00430000
004400 FD  REPORT-FILE                                                  00440000
004500     RECORDING MODE IS F                                          00450000
004600     BLOCK CONTAINS 0  RECORDS.                                   00460000
004700 01  REPORT-RECORD                   PIC X(250).                  00470002
004800                                                                  00480000
004900***************************************************************** 00490000
005000 WORKING-STORAGE SECTION.                                         00500000
005100                                                                  00510000
005200 01  PROGRAM-SWITCHES.                                            00520000
005300     05  PS-END-OF-INPUT-FILE-SW     PIC X(01) VALUE 'N'.         00530000
005400         88  PS-END-OF-INPUT                   VALUE 'Y'.         00540000
005500         88  PS-NOT-END-OF-INPUT               VALUE 'N'.         00550000
005600                                                                  00560000
005700 01  PC-PROGRAM-CONSTANTS.                                        00570000
005800     05  PC-RCKRP094                 PIC X(08) VALUE              00580000
005900                                               'RCKRP094'.        00590000
006000     05  PC-REPORT-NBR               PIC X(02) VALUE '-1'.        00600000
006100     05  PC-MAX-LINE-COUNT           PIC S9(3) VALUE +60          00610000
006200                                               COMP-3.            00620000
006300     05  PC-SLASH                    PIC X(01) VALUE '/'.         00630000
006400     05  PC-DASH                     PIC X(01) VALUE '-'.         00640000
006500                                                                  00650000
006600 01  SD-DATE-TIME.                                                00660000
006700     05  SD-SYSTEM-DATE.                                          00670000
006800         10  SD-SYSTEM-DATE-YY       PIC 9(02) VALUE ZERO.        00680000
006900         10  SD-SYSTEM-DATE-MM       PIC 9(02) VALUE ZERO.        00690000
007000         10  SD-SYSTEM-DATE-DD       PIC 9(02) VALUE ZERO.        00700000
007100     05  SD-SYSTEM-TIME.                                          00710000
007200         10  SD-SYSTEM-TIME-HH       PIC 9(02) VALUE ZERO.        00720000
007300         10  SD-SYSTEM-TIME-MM       PIC 9(02) VALUE ZERO.        00730000
007400         10  SD-SYSTEM-TIME-SS       PIC 9(02) VALUE ZERO.        00740000
007500         10  FILLER                  PIC 9(02) VALUE ZERO.        00750000
007600*                                                                 00760000
007700 01  PV-PROGRAM-VARIABLES.                                        00770000
007800     05  PV-PREV-OPER                PIC  9(05).                  00780000
007900     05  PV-PREV-PO                  PIC  9(09).                  00790000
008100     05  PV-SQLCODE                  PIC  9(09) VALUE ZERO.       00810004
008110     05  PV-SUB                      PIC S9(04) VALUE ZERO        00811004
008120                                                COMP SYNC.        00812004
008130                                                                  00813004
008200     05  PV-PAGE-COUNT               PIC S9(4) VALUE ZERO         00820000
008300                                               COMP-3.            00830000
008400     05  PV-READ-COUNT                PIC S9(7) COMP-3            00840000
008500                                                VALUE ZERO.       00850000
008600     05  PV-WRITE-COUNT               PIC S9(7) COMP-3            00860000
008700                                                VALUE ZERO.       00870000
008800     05  PV-LINE-COUNT               PIC S9(3) VALUE ZERO         00880000
008900                                               COMP-3.            00890000
009000     05  PV-LINES-ON-PAGE            PIC  9(3) VALUE 60.          00900000
009100                                                                  00910000
009200     05  PV-RPT-DATE.                                             00920000
009300         10  PV-RPT-DATE-MM          PIC 9(02) VALUE ZERO.        00930000
009400         10  FILLER                  PIC X(01) VALUE '-'.         00940000
009500         10  PV-RPT-DATE-DD          PIC 9(02) VALUE ZERO.        00950000
009600         10  FILLER                  PIC X(01) VALUE '-'.         00960000
009700         10  PV-RPT-DATE-YY          PIC 9(02) VALUE ZERO.        00970000
009800                                                                  00980000
009900 01  PV-ABEND-FIELDS.                                             00990000
010000     05  PV-DB2-FUNCTION              PIC X(30) VALUE SPACES.     01000000
010100     05  PV-DB2-TABLE-NAME            PIC X(30) VALUE SPACES.     01010000
010200     05  PV-ABEND-CODE               PIC S9(4) VALUE +0           01020000
010300                                               COMP SYNC.         01030000
010400     05  PV-ABEND-PROGRAM            PIC X(08) VALUE 'RCKRP094'.  01040000
010500     05  PV-ABEND-PARAGRAPH          PIC X(50) VALUE SPACES.      01050000
010600     05  PV-ABEND-OPERATION          PIC X(50) VALUE SPACES.      01060000
010700     05  PV-ABEND-STRUCTURE-1        PIC X(08) VALUE SPACES.      01070000
010800                                                                  01080000
010900     05  PV-DISPLAY-READ-COUNT       PIC ZZZ,ZZZ,ZZ9.             01090000
011000     05  PV-DISPLAY-WRITE-COUNT      PIC ZZZ,ZZZ,ZZ9.             01100000
011100     05  PV-DISP-SQL                 PIC  -999.                   01110000
011200     05  PV-DISP-OPER                PIC  9999.                   01120000
011300                                                                  01130000
011400******************************************************************01140000
011500* RECORD LAYOUT FOR THE INPUT FILE.                               01150000
011600******************************************************************01160000
011700     COPY RCRD001.                                                01170000
011800                                                                  01180000
011900******************************************************************01190000
012000*  WORK FIELDS FOR PRINTING A 250 CHARACTER REPORT.               01200002
012100******************************************************************01210000
012200     COPY DPWS250O.                                               01220007
012300                                                                  01230000
012400 01  WS-BATCH-PROC-DATE.                                          01240000
012500     05  WS-BATCH-PROC-CC            PIC X(02) VALUE SPACES.      01250000
012600     05  WS-BATCH-PROC-YY            PIC X(02) VALUE SPACES.      01260000
012700     05  FILLER                      PIC X(01) VALUE SPACES.      01270000
012800     05  WS-BATCH-PROC-MM            PIC X(02) VALUE SPACES.      01280000
012900     05  FILLER                      PIC X(01) VALUE SPACES.      01290000
013000     05  WS-BATCH-PROC-DD            PIC X(02) VALUE SPACES.      01300000
013100*                                                                 01310000
013200 01  HEADING-LINES.                                               01320000
013300     05  HEADING-LINE1.                                           01330000
013400         10  FILLER                  PIC X(98) VALUE SPACES.      01340012
013500         10  FILLER                  PIC X(41) VALUE              01350000
013600         'ASN TO THIRD PARTY WAREHOUSE DISTRIBUTION'.             01360008
013602         10  FILLER                  PIC X(13) VALUE              01360200
013610         ' - EXCEPTIONS'.                                         01361000
013900         10  FILLER                  PIC X(98) VALUE SPACES.      01390012
014000                                                                  01400000
014100     05  HEADING-LINE2.                                           01410002
014200         10  FILLER                  PIC X(112) VALUE SPACES.     01420012
014300         10  FILLER                  PIC X(16)  VALUE             01430012
014400         'PROCESS DATE OF '.                                      01440000
014500         10  HD2-PROCESS-DATE        PIC X(10)  VALUE SPACES.     01450012
014600         10  FILLER                  PIC X(112) VALUE SPACES.     01460012
014700                                                                  01470000
014800     05  HEADING-LINE3.                                           01480002
014900         10  HD3-OPER-UNT-ID         PIC 9(04) VALUE ZEROES.      01490002
015000         10  FILLER                  PIC X(01) VALUE SPACES.      01500000
015100         10  HD3-DC-NAME             PIC X(40) VALUE SPACES.      01510002
015200         10  FILLER                  PIC X(205) VALUE SPACES.     01520012
015300                                                                  01530000
015301     05  HEADING-LINE4.                                           01530109
015302         10  FILLER                  PIC  X(08) VALUE SPACES.     01530208
015304         10  FILLER                  PIC  X(03) VALUE 'EDI'.      01530402
015305         10  FILLER                  PIC  X(30) VALUE SPACE.      01530502
015306         10  FILLER                  PIC  X(04) VALUE 'CARR'.     01530602
015307         10  FILLER                  PIC  X(68) VALUE SPACES.     01530715
015308         10  FILLER                  PIC  X(02) VALUE 'PO'.       01530802
015309         10  FILLER                  PIC  X(02) VALUE SPACES.     01530925
015310         10  FILLER                  PIC  X(04) VALUE ' PO '.     01531022
015311         10  FILLER                  PIC  X(01) VALUE SPACE.      01531126
015312         10  FILLER                  PIC  X(04) VALUE 'STR '.     01531226
015313         10  FILLER                  PIC  X(04) VALUE ' PO '.     01531326
015314         10  FILLER                  PIC  X(04) VALUE ' LN '.     01531426
015315         10  FILLER                  PIC  X(03) VALUE 'DPT'.      01531527
015316         10  FILLER                  PIC  X(07) VALUE SPACES.     01531626
015317         10  FILLER                  PIC  X(03) VALUE 'UPC'.      01531726
015318         10  FILLER                  PIC  X(10) VALUE SPACES.     01531826
015319         10  FILLER                  PIC  X(03) VALUE 'SKU'.      01531926
015320         10  FILLER                  PIC  X(10) VALUE SPACES.     01532026
015321         10  FILLER                  PIC  X(06) VALUE 'CARTON'.   01532126
015322         10  FILLER                  PIC  X(11) VALUE SPACES.     01532228
015323         10  FILLER                  PIC  X(06) VALUE 'CARTON'.   01532326
015324         10  FILLER                  PIC  X(01) VALUE SPACES.     01532433
015325         10  FILLER                  PIC  X(03) VALUE 'REC'.      01532533
015326         10  FILLER                  PIC  X(53) VALUE SPACES.     01532633
015327                                                                  01532726
015328     05  HEADING-LINE5.                                           01532826
015329         10  FILLER                  PIC  X(04) VALUE 'OPER'.     01532926
015330         10  FILLER                  PIC  X(03) VALUE SPACES.     01533026
015331         10  FILLER                  PIC  X(06) VALUE 'VENDOR'.   01533126
015332         10  FILLER                  PIC  X(02) VALUE SPACE.      01533226
015333         10  FILLER                  PIC  X(15)                   01533326
015334                                         VALUE 'EDI VENDOR NAME'. 01533426
015335         10  FILLER                  PIC  X(11) VALUE SPACE.      01533526
015336         10  FILLER                  PIC  X(04) VALUE 'SCAC'.     01533626
015337         10  FILLER                  PIC  X(01) VALUE SPACES.     01533726
015338         10  FILLER                  PIC  X(30)                   01533826
015339                          VALUE '-------- ASN HEADER ----------'. 01533926
015340         10  FILLER                  PIC  X(01) VALUE SPACES.     01534026
015341         10  FILLER                  PIC  X(30)                   01534126
015342                          VALUE '------- BILL OF LADING -------'. 01534226
015343         10  FILLER                  PIC  X(04) VALUE SPACES.     01534326
015344         10  FILLER                  PIC  X(06) VALUE 'NUMBER'.   01534426
015345         10  FILLER                  PIC  X(04) VALUE ' ST '.     01534522
015346         10  FILLER                  PIC  X(04) VALUE ' NBR'.     01534627
015347         10  FILLER                  PIC  X(01) VALUE SPACES.     01534727
015348         10  FILLER                  PIC  X(04) VALUE 'LINE'.     01534822
015349         10  FILLER                  PIC  X(04) VALUE ' ST '.     01534922
015350         10  FILLER                  PIC  X(03) VALUE 'NBR'.      01535022
015351         10  FILLER                  PIC  X(05) VALUE SPACES.     01535122
015352         10  FILLER                  PIC  X(06) VALUE 'NUMBER'.   01535222
015353         10  FILLER                  PIC  X(08) VALUE SPACES.     01535322
015354         10  FILLER                  PIC  X(06) VALUE 'NUMBER'.   01535422
015355         10  FILLER                  PIC  X(06) VALUE SPACES.     01535522
015356         10  FILLER                  PIC  X(11)                   01535622
015357                                          VALUE 'SSCC NUMBER'.    01535722
015358         10  FILLER                  PIC  X(09) VALUE SPACES.     01535831
015359         10  FILLER                  PIC  X(05) VALUE 'UNITS'.    01535922
015360         10  FILLER                  PIC  X(01) VALUE SPACES.     01536031
015362         10  FILLER                  PIC  X(04) VALUE 'TYP '.     01536233
015363         10  FILLER                  PIC  X(40) VALUE             01536330
015364                    '-------------- E R R O R ---------------'.   01536429
015365         10  FILLER                  PIC  X(11) VALUE SPACES.     01536533
015537                                                                  01553701
015577 01  DETAIL-LINES.                                                01557701
015578     05  DETAIL-LINE1.                                            01557801
015579         10  DL1-OPER                PIC  X(04)    VALUE SPACES.  01557903
015580         10  FILLER                  PIC  X(01)    VALUE SPACES.  01558001
015587         10  DL1-EDI-VENDOR          PIC  X(09)    VALUE ZEROES.  01558703
015596         10  FILLER                  PIC  X(01)    VALUE SPACES.  01559601
015597         10  DL1-VENDOR-NAME         PIC  X(25)    VALUE SPACES.  01559703
015605         10  FILLER                  PIC  X(01)    VALUE SPACES.  01560501
015606         10  DL1-CARR-SCAC           PIC  X(04)    VALUE SPACES.  01560603
015607         10  FILLER                  PIC  X(01)    VALUE SPACES.  01560703
015608         10  DL1-ASN-HDR             PIC  X(30)    VALUE SPACES.  01560803
015609         10  FILLER                  PIC  X(01)    VALUE SPACES.  01560903
015610         10  DL1-BOL                 PIC  X(30)    VALUE SPACES.  01561003
015611         10  FILLER                  PIC  X(01)    VALUE SPACE.   01561114
015612         10  DL1-PO                  PIC  Z(09)    VALUE ZERO.    01561203
015614         10  FILLER                  PIC  X(01)    VALUE SPACE.   01561401
015615         10  DL1-PO-STATUS           PIC  X(02)    VALUE SPACE.   01561524
015616         10  FILLER                  PIC  X(01)    VALUE SPACE.   01561622
015617         10  DL1-STORE-NBR           PIC  X(04)    VALUE SPACE.   01561703
015618         10  FILLER                  PIC  X(01)    VALUE SPACE.   01561801
015619         10  DL1-PO-LINE             PIC  X(04)    VALUE SPACES.  01561903
015620         10  FILLER                  PIC  X(01)    VALUE SPACE.   01562001
015621         10  DL1-PO-LINE-STATUS      PIC  X(02)    VALUE SPACE.   01562123
015622         10  FILLER                  PIC  X(01)    VALUE SPACE.   01562222
015623         10  DL1-DEPT                PIC  X(03)    VALUE SPACES.  01562308
015624         10  FILLER                  PIC  X(01)    VALUE SPACE.   01562401
015625         10  DL1-UPC                 PIC  X(16)    VALUE SPACES.  01562503
015626         10  FILLER                  PIC  X(01)    VALUE SPACES.  01562603
015627         10  DL1-SKU                 PIC  X(08)    VALUE SPACES.  01562703
015628         10  FILLER                  PIC  X(01)    VALUE SPACES.  01562803
015629         10  DL1-SSCC                PIC  Z(18)    VALUE ZEROES.  01562903
015630         10  FILLER                  PIC  X(01)    VALUE SPACES.  01563003
015631         10  DL1-SSCC-UNITS          PIC  Z(10)    VALUE ZEROES.  01563103
015632         10  FILLER                  PIC  X(01)    VALUE SPACES.  01563203
015633         10  DL1-REC-TYPE            PIC  X(03)    VALUE ZEROES.  01563333
015634         10  FILLER                  PIC  X(01)    VALUE SPACES.  01563433
015635         10  DL1-ERROR               PIC  X(51)    VALUE SPACES.  01563533
015636                                                                  01563601
021900                                                                  02190000
022000 01  MISCELLANEOUS-LINES.                                         02200000
022100     05  BLANK-LINE.                                              02210000
022200         10  FILLER                  PIC X(250) VALUE SPACES.     02220029
022300                                                                  02230000
022400     05  END-OF-REPORT-LINE.                                      02240000
022500         10  FILLER                  PIC X(103) VALUE SPACES.     02250009
022600         10  FILLER                  PIC X(45) VALUE              02260000
022700             '*******   E N D   O F   R E P O R T   *******'.     02270000
022800         10  FILLER                  PIC X(102) VALUE SPACES.     02280009
023000                                                                  02300000
023100     05  NO-DATA-TO-REPORT-LINE.                                  02310000
023200         10  FILLER                  PIC X(40) VALUE SPACES.      02320000
023300         10  FILLER                  PIC  X(52)    VALUE          02330000
023400         '*******  N O   D A T A   T O   R E P O R T   *******'.  02340000
023500         10  FILLER                  PIC  X(40)    VALUE SPACES.  02350000
023600         10  FILLER                  PIC X(18) VALUE SPACES.      02360000
023700                                                                  02370000
023800                                                                  02380000
023900******************************************************************02390000
024000*  USED FOR DB2 ERROR MESSAGE BUILDING                            02400000
024100******************************************************************02410000
024200     COPY DPWS004.                                                02420000
024300                                                                  02430000
024400******************************************************************02440000
024500*   DB2 SQL COMMUNICATION AREA                                    02450000
024600******************************************************************02460000
024700     EXEC SQL                                                     02470000
024800          INCLUDE SQLCA                                           02480000
024900     END-EXEC.                                                    02490000
025000                                                                  02500000
025100*---------------------------------------------------------------* 02510000
025200*  DCLGEN FOR THE LOGISTICS LOCATION TABLE                        02520000
025300*  XLT_LOC                                                        02530000
025400*---------------------------------------------------------------* 02540000
025500     EXEC SQL                                                     02550000
025600          INCLUDE XLT00010                                        02560000
025700     END-EXEC.                                                    02570000
025800                                                                  02580000
025900*---------------------------------------------------------------* 02590000
026000*  TPURCHS                                                        02600000
026100*---------------------------------------------------------------* 02610000
026200     EXEC SQL                                                     02620000
026300          INCLUDE TPURCHS                                         02630000
026400     END-EXEC.                                                    02640000
026500                                                                  02650000
026510*---------------------------------------------------------------* 02651003
026520*  TPURITM                                                        02652003
026530*---------------------------------------------------------------* 02653003
026540     EXEC SQL                                                     02654003
026550          INCLUDE TPURITM                                         02655003
026560     END-EXEC.                                                    02656003
026570                                                                  02657003
028000******************************************************************02800000
028100 PROCEDURE DIVISION.                                              02810000
028200     DISPLAY '**** START OF RCKRP094 ****'.                       02820000
028300                                                                  02830000
028400*OPEN FILES.                                                      02840000
028500     OPEN INPUT  INPUT-FILE                                       02850000
028600          OUTPUT REPORT-FILE.                                     02860000
028700                                                                  02870000
028800     PERFORM 1000-INITIALIZATION.                                 02880000
028900                                                                  02890000
029000     SET  PS-NOT-END-OF-INPUT   TO  TRUE.                         02900000
029100                                                                  02910000
029200     PERFORM 7000-READ-EXTRACT-FILE.                              02920000
029300                                                                  02930000
029400     MOVE RC001-DIST-CNTR       TO  PV-PREV-OPER.                 02940003
029500     MOVE RC001-PO-NBR          TO  PV-PREV-PO.                   02950003
029700                                                                  02970000
029800     IF PS-END-OF-INPUT                                           02980000
029900        ADD +1                  TO PV-PAGE-COUNT                  02990000
030000        MOVE PV-PAGE-COUNT      TO DP250O-PAGE-NUMBER             03000002
030100        WRITE REPORT-RECORD                                       03010000
030200          FROM DP250O-STANDRD-HEADER-250-COLS                     03020002
030300            AFTER ADVANCING PAGE                                  03030000
030400        WRITE REPORT-RECORD                                       03040000
030500          FROM HEADING-LINE1                                      03050000
030600            AFTER ADVANCING 1 LINES                               03060000
031000        WRITE REPORT-RECORD                                       03100000
031100          FROM HEADING-LINE2                                      03110000
031200            AFTER ADVANCING 1 LINE                                03120000
031300        WRITE REPORT-RECORD                                       03130000
031400          FROM NO-DATA-TO-REPORT-LINE                             03140000
031500            AFTER ADVANCING 2 LINES                               03150000
031600     ELSE                                                         03160000
031700         MOVE RC001-DIST-CNTR       TO  PV-PREV-OPER              03170003
031800         PERFORM 8500-GET-LOCATION-NAME                           03180000
031900         PERFORM 1500-PRINT-HEADINGS                              03190000
032200         PERFORM 2000-PROCESS-INPUT                               03220000
032300           UNTIL PS-END-OF-INPUT                                  03230000
032400     END-IF.                                                      03240000
032500                                                                  03250000
032600*FINISH REPORT.                                                   03260000
032700                                                                  03270000
032800     WRITE REPORT-RECORD                                          03280000
032900       FROM END-OF-REPORT-LINE                                    03290000
033000         AFTER ADVANCING 3 LINES.                                 03300000
033100                                                                  03310000
033200*CLOSE FILES.                                                     03320000
033300     CLOSE INPUT-FILE                                             03330000
033400           REPORT-FILE.                                           03340000
033500                                                                  03350000
033600     MOVE PV-READ-COUNT TO PV-DISPLAY-READ-COUNT.                 03360000
033700     DISPLAY 'TOTAL INPUT READ ' PV-DISPLAY-READ-COUNT.           03370000
033800                                                                  03380000
033900     MOVE PV-WRITE-COUNT TO PV-DISPLAY-WRITE-COUNT.               03390000
034000     DISPLAY 'TOTAL RECS WRITTEN ' PV-DISPLAY-WRITE-COUNT.        03400000
034100                                                                  03410000
034200     GOBACK.                                                      03420000
034300*                                                                 03430000
034400******************************************************************03440000
034500*  PERFORM THE INITIAL PROCESSING FOR THE PROGRAM.               *03450000
034600******************************************************************03460000
034700 1000-INITIALIZATION.                                             03470000
034800     ACCEPT SD-SYSTEM-DATE                                        03480000
034900       FROM DATE.                                                 03490000
035000                                                                  03500000
035100     ACCEPT SD-SYSTEM-TIME                                        03510000
035200       FROM TIME.                                                 03520000
035300                                                                  03530000
035400     MOVE SD-SYSTEM-DATE-MM  TO DP250O-RUN-MONTH.                 03540002
035500     MOVE SD-SYSTEM-DATE-DD  TO DP250O-RUN-DAY.                   03550002
035600     MOVE SD-SYSTEM-DATE-YY  TO DP250O-RUN-YEAR.                  03560002
035700     MOVE SD-SYSTEM-TIME-HH  TO DP250O-RUN-HOUR.                  03570002
035800     MOVE SD-SYSTEM-TIME-MM  TO DP250O-RUN-MINUTE.                03580002
035900                                                                  03590000
036000     MOVE SD-SYSTEM-DATE-MM  TO PV-RPT-DATE-MM.                   03600000
036100     MOVE SD-SYSTEM-DATE-DD  TO PV-RPT-DATE-DD.                   03610000
036200     MOVE SD-SYSTEM-DATE-YY  TO PV-RPT-DATE-YY.                   03620000
036300                                                                  03630000
036400     MOVE PC-RCKRP094             TO DP250O-PROGRAM-NAME.         03640002
036500     MOVE PC-REPORT-NBR           TO DP250O-REPORT-NUMBER.        03650002
036600     MOVE +0                      TO PV-PAGE-COUNT.               03660000
036700                                                                  03670000
036800                                                                  03680000
036900******************************************************************03690000
037000**  WRITES REPORT HEADER LINES FOR FIRST PAGE AND ANY SUBSEQUENT  03700000
037100**  PAGES (AS NEEDED).                                            03710000
037200******************************************************************03720000
037300 1500-PRINT-HEADINGS.                                             03730000
037400     ADD +1                  TO PV-PAGE-COUNT.                    03740000
037500     MOVE PV-PAGE-COUNT      TO DP250O-PAGE-NUMBER.               03750002
037600                                                                  03760000
037700     MOVE PV-RPT-DATE        TO  HD2-PROCESS-DATE.                03770009
037800                                                                  03780000
037900     WRITE REPORT-RECORD                                          03790000
038000       FROM DP250O-STANDRD-HEADER-250-COLS                        03800002
038100         AFTER ADVANCING PAGE.                                    03810000
038200                                                                  03820000
038300     WRITE REPORT-RECORD                                          03830000
038400       FROM HEADING-LINE1                                         03840000
038500         AFTER ADVANCING 1 LINES.                                 03850000
038600                                                                  03860000
039100     WRITE REPORT-RECORD                                          03910000
039200       FROM HEADING-LINE2                                         03920000
039300         AFTER ADVANCING 1 LINE.                                  03930000
039400                                                                  03940000
039500     WRITE REPORT-RECORD                                          03950000
039600       FROM HEADING-LINE3                                         03960000
039700         AFTER ADVANCING 2 LINES.                                 03970000
039800                                                                  03980000
039810     PERFORM 6000-PRINT-BLANK-LINE.                               03981029
039820                                                                  03982029
039900     WRITE REPORT-RECORD                                          03990000
040000       FROM HEADING-LINE4                                         04000011
040100         AFTER ADVANCING 1 LINES.                                 04010029
040200                                                                  04020000
040210     WRITE REPORT-RECORD                                          04021011
040220       FROM HEADING-LINE5                                         04022011
040230         AFTER ADVANCING 1 LINES.                                 04023011
040240                                                                  04024011
040700     MOVE +05                TO PV-LINE-COUNT.                    04070000
040800                                                                  04080000
040900                                                                  04090000
041000******************************************************************04100000
041100**  READ INPUT-FILE, WHEN DC CHANGES, DO A PAGE BREAK             04110000
041200******************************************************************04120000
041300 2000-PROCESS-INPUT.                                              04130000
041400     IF  RC001-DIST-CNTR       =  PV-PREV-OPER  AND               04140003
041500         RC001-PO-NBR          =  PV-PREV-PO                      04150003
041600         CONTINUE                                                 04160000
041700     ELSE                                                         04170000
041800         PERFORM 6000-PRINT-BLANK-LINE                            04180000
041900         IF  PV-LINE-COUNT  > PV-LINES-ON-PAGE                    04190000
042000             PERFORM 1500-PRINT-HEADINGS                          04200000
042100         END-IF                                                   04210000
042200     END-IF.                                                      04220000
042300                                                                  04230000
042400     IF  RC001-DIST-CNTR       =  PV-PREV-OPER                    04240003
042500         CONTINUE                                                 04250000
042600     ELSE                                                         04260000
042700         MOVE RC001-DIST-CNTR       TO  PV-PREV-OPER              04270003
042800         PERFORM 8500-GET-LOCATION-NAME                           04280000
042900         PERFORM 1500-PRINT-HEADINGS                              04290000
043000     END-IF.                                                      04300000
043100                                                                  04310000
043900     MOVE RC001-PO-NBR          TO  PV-PREV-PO.                   04390003
044100                                                                  04410000
044200     PERFORM 5000-WRITE-RPT-DTL.                                  04420000
044300                                                                  04430000
044400     PERFORM 7000-READ-EXTRACT-FILE.                              04440000
044500                                                                  04450000
044600                                                                  04460000
053300****************************************************************  05330000
053400* MOVE THE DETAILS TO REPORT LINE.                             *  05340000
053500****************************************************************  05350000
053600 5000-WRITE-RPT-DTL.                                              05360000
053700                                                                  05370000
053710     MOVE RC001-DIST-CNTR           TO DL1-OPER.                  05371003
053730     MOVE RC001-EDI-VEND-ID         TO DL1-EDI-VENDOR.            05373003
053750     MOVE RC001-EDI-VEND-NAME       TO DL1-VENDOR-NAME.           05375003
053770     MOVE RC001-CARRIER-SCAC-CODE   TO DL1-CARR-SCAC.             05377003
053790     MOVE RC001-ASNHDR-NBR          TO DL1-ASN-HDR.               05379003
053792     MOVE RC001-BILL-OF-LADING-NBR  TO DL1-BOL.                   05379203
053794     MOVE RC001-PO-NBR              TO DL1-PO.                    05379403
053796     MOVE RC001-STORE-NBR           TO DL1-STORE-NBR.             05379603
053798     MOVE RC001-PO-LINE-NBR         TO DL1-PO-LINE.               05379803
053800     MOVE RC001-DEPT-NBR            TO DL1-DEPT.                  05380003
053801                                                                  05380103
053802     MOVE SPACES  TO  PURCHS-STATUS-CDE                           05380203
053803                      PURITM-STATUS-CDE.                          05380303
053804                                                                  05380403
053805     PERFORM 8510-GET-PO-STATUS.                                  05380503
053806     MOVE PURCHS-STATUS-CDE  TO  DL1-PO-STATUS.                   05380622
053807                                                                  05380722
053808     IF  RC001-PO-LINE-NBR = HIGH-VALUES OR                       05380822
053809         RC001-PO-LINE-NBR = 0                                    05380922
053810         MOVE SPACES                    TO  DL1-PO-LINE-STATUS    05381022
053811         MOVE SPACES                    TO  DL1-PO-LINE           05381136
053813     ELSE                                                         05381322
053814         PERFORM 8520-GET-LINE-STATUS                             05381422
053815         MOVE PURITM-STATUS-CDE         TO  DL1-PO-LINE-STATUS    05381522
053816     END-IF.                                                      05381622
053817                                                                  05381722
053818     IF  RC001-PO-LINE-NBR = HIGH-VALUES OR                       05381803
053819         RC001-PO-LINE-NBR = 0                                    05381903
053820         MOVE 'SKU IS NOT ON THE PO'            TO DL1-ERROR      05382022
053821     ELSE                                                         05382120
053822         IF  PURITM-STATUS-CDE = 'CM'                             05382220
053823             MOVE 'PO-LINE IS IN COMPLETE STATUS'                 05382320
053824                                                TO DL1-ERROR      05382420
053825         ELSE                                                     05382520
053826             IF  PURITM-STATUS-CDE = 'CA'                         05382620
053827                 MOVE 'PO-LINE IS IN CANCELLED STATUS'            05382720
053828                                                TO DL1-ERROR      05382820
053829             ELSE                                                 05382920
053830                 IF  PURITM-STATUS-CDE = 'CB'                     05383020
053831                     MOVE 'PO-LINE IS IN CANCEL BALANCE STATUS'   05383120
053832                                                TO DL1-ERROR      05383220
053834                 ELSE                                             05383420
053835                     IF  PURCHS-STATUS-CDE  = 'CA'                05383520
053836                         MOVE 'PO CANCELLED'    TO DL1-ERROR      05383620
053837                     ELSE                                         05383720
053838                         MOVE 'UNKNOWN ERROR'   TO DL1-ERROR      05383820
053839                     END-IF                                       05383920
053840                 END-IF                                           05384020
053841             END-IF                                               05384120
053842         END-IF                                                   05384220
053843     END-IF.                                                      05384320
053844                                                                  05384403
053845     IF  RC001-DETAIL-RECORD                                      05384503
053846         PERFORM 5010-WRITE-DETAIL                                05384603
053847     ELSE                                                         05384703
053848         PERFORM 5020-WRITE-CARTON                                05384810
053851     END-IF.                                                      05385103
053860                                                                  05386003
056100                                                                  05610000
056110 5010-WRITE-DETAIL.                                               05611003
056111                                                                  05611103
056112     PERFORM 6000-PRINT-BLANK-LINE.                               05611229
056116                                                                  05611603
056118     IF  PV-LINE-COUNT  > PV-LINES-ON-PAGE                        05611803
056119         PERFORM 1500-PRINT-HEADINGS                              05611903
056120     END-IF.                                                      05612003
056121                                                                  05612103
056122     MOVE RC001-UPC-NBR             TO DL1-UPC.                   05612203
056130     MOVE RC001-SKU-NBR             TO DL1-SKU.                   05613003
056140     MOVE ZEROES                    TO DL1-SSCC.                  05614021
056160     MOVE RC001-QTY-SHIPPED         TO DL1-SSCC-UNITS.            05616033
056170     MOVE 'DTL'                     TO DL1-REC-TYPE.              05617033
056191                                                                  05619103
056194     WRITE REPORT-RECORD                                          05619403
056195      FROM DETAIL-LINE1                                           05619503
056196     AFTER ADVANCING 1 LINES.                                     05619603
056197                                                                  05619703
056198     ADD  1                  TO PV-LINE-COUNT.                    05619803
056199     IF  PV-LINE-COUNT  > PV-LINES-ON-PAGE                        05619903
056200         PERFORM 1500-PRINT-HEADINGS                              05620003
056201     END-IF.                                                      05620103
056202                                                                  05620203
056203                                                                  05620303
056204 5020-WRITE-CARTON.                                               05620403
056205                                                                  05620503
056206     PERFORM 5030-PROCESS-ASN-CARTONS                             05620604
056207             VARYING PV-SUB                                       05620704
056208                FROM 1 BY 1                                       05620804
056209               UNTIL PV-SUB > 10 OR                               05620904
056210                     RC001-CARTON-NBR(PV-SUB) = 0.                05621004
056211                                                                  05621104
056212                                                                  05621204
056213 5030-PROCESS-ASN-CARTONS.                                        05621310
056214                                                                  05621404
056215     MOVE RC001-CTN-UPC(PV-SUB)     TO DL1-UPC                    05621504
056216     MOVE RC001-CARTON-NBR(PV-SUB)  TO DL1-SSCC                   05621604
056217     MOVE RC001-CARTON-QTY(PV-SUB)  TO DL1-SSCC-UNITS             05621704
056218     MOVE 'CTN'                     TO DL1-REC-TYPE.              05621833
056219                                                                  05621904
056220     WRITE REPORT-RECORD                                          05622004
056221      FROM DETAIL-LINE1                                           05622104
056222     AFTER ADVANCING 1 LINES.                                     05622204
056223                                                                  05622304
056224     ADD  1                  TO PV-LINE-COUNT.                    05622404
056225     IF  PV-LINE-COUNT  > PV-LINES-ON-PAGE                        05622504
056226         PERFORM 1500-PRINT-HEADINGS                              05622604
056227     END-IF.                                                      05622704
056228                                                                  05622804
056229                                                                  05622904
056230****************************************************************  05623000
056300* PRINTS A BLANK LINE                                          *  05630000
056400****************************************************************  05640000
056500 6000-PRINT-BLANK-LINE.                                           05650000
056600                                                                  05660000
056700        WRITE REPORT-RECORD                                       05670000
056800          FROM BLANK-LINE                                         05680000
056900            AFTER ADVANCING 1 LINE                                05690000
057000                                                                  05700000
057100     ADD +1 TO PV-LINE-COUNT.                                     05710000
057200                                                                  05720000
057300******************************************************************05730000
057400*  READ A FROM THE INPUT FILE                                    *05740000
057500******************************************************************05750000
057600 7000-READ-EXTRACT-FILE.                                          05760000
057700     READ INPUT-FILE                                              05770000
057800          INTO RC001-ASN-TRANSCRIPTION-RECORD                     05780010
057900         AT END                                                   05790000
058000             SET PS-END-OF-INPUT TO TRUE                          05800000
058100         NOT AT END                                               05810000
058200             ADD +1 TO PV-READ-COUNT                              05820000
058300     END-READ.                                                    05830000
058400                                                                  05840000
058500******************************************************************05850000
058600*                                                                *05860000
058700******************************************************************05870000
058800 8500-GET-LOCATION-NAME.                                          05880000
058900                                                                  05890000
059000     MOVE PV-PREV-OPER         TO  XLT00010-LOC-NBR               05900000
059100                                   PV-DISP-OPER.                  05910000
059200                                                                  05920000
059300     EXEC SQL                                                     05930000
059400         SELECT   LOC_NM                                          05940000
059500           INTO  :XLT00010-LOC-NM                                 05950000
059600           FROM   XLT_LOC                                         05960000
059700          WHERE   LOC_NBR  =  :XLT00010-LOC-NBR                   05970000
059800     END-EXEC.                                                    05980000
059900                                                                  05990000
060000     EVALUATE TRUE                                                06000000
060100         WHEN SQLCODE = +0                                        06010000
060200              MOVE PV-PREV-OPER        TO HD3-OPER-UNT-ID         06020010
060300              MOVE XLT00010-LOC-NM     TO HD3-DC-NAME             06030010
060400         WHEN OTHER                                               06040000
060500              CONTINUE                                            06050000
060600     END-EVALUATE.                                                06060000
060700                                                                  06070000
060800                                                                  06080000
060801******************************************************************06080109
060802*                                                                *06080209
060803******************************************************************06080309
060810 8510-GET-PO-STATUS.                                              06081009
060811                                                                  06081109
060812     MOVE RC001-PO-NBR         TO  PURCHS-PO-NBR                  06081209
060814                                                                  06081409
060815     EXEC SQL                                                     06081509
060816         SELECT   STATUS_CDE                                      06081609
060817           INTO  :PURCHS-STATUS-CDE                               06081709
060818           FROM   TPURCHS                                         06081809
060819          WHERE   PO_NBR   =  :PURCHS-PO-NBR                      06081909
060820            AND   VER_STATUS_CDE  = 'A'                           06082010
060821           WITH UR                                                06082109
060822     END-EXEC.                                                    06082209
060823                                                                  06082309
060824     EVALUATE TRUE                                                06082409
060825         WHEN SQLCODE = +0                                        06082509
060826              CONTINUE                                            06082609
060827         WHEN OTHER                                               06082709
060828              CONTINUE                                            06082809
060829     END-EVALUATE.                                                06082909
060840                                                                  06084009
060860                                                                  06086009
060861******************************************************************06086109
060862*                                                                *06086209
060863******************************************************************06086309
060870 8520-GET-LINE-STATUS.                                            06087009
060871                                                                  06087109
060872     MOVE RC001-PO-NBR         TO  PURITM-PO-NBR.                 06087209
060873     MOVE RC001-PO-LINE-NBR-9  TO  PURITM-PO-LNE-NBR.             06087309
060874                                                                  06087409
060875     EXEC SQL                                                     06087509
060876         SELECT   STATUS_CDE                                      06087609
060877           INTO  :PURITM-STATUS-CDE                               06087709
060878           FROM   TPURITM                                         06087809
060879          WHERE   PO_NBR        =  :PURITM-PO-NBR                 06087909
060880            AND   PO_LNE_NBR    =  :PURITM-PO-LNE-NBR             06088009
060881            AND   VER_STATUS_CDE  = 'A'                           06088110
060882           WITH UR                                                06088209
060883     END-EXEC.                                                    06088309
060884                                                                  06088409
060885     EVALUATE TRUE                                                06088509
060886         WHEN SQLCODE = +0                                        06088609
060887              CONTINUE                                            06088709
060888         WHEN OTHER                                               06088809
060889              CONTINUE                                            06088909
060890     END-EVALUATE.                                                06089009
060891                                                                  06089109
060892                                                                  06089209
060900******************************************************************06090000
061000*  ABEND ROUTINE                                                 *06100000
061100******************************************************************06110000
061200 9900-DB2-ABEND.                                                  06120000
061300                                                                  06130000
061400     MOVE SQLCODE TO PV-SQLCODE.                                  06140000
061500     DISPLAY '*** DB2 ERROR '.                                    06150000
061600     DISPLAY '*** SQLCODE   = ' PV-SQLCODE.                       06160000
061700     DISPLAY '*** PROGRAM   = ' PV-ABEND-PROGRAM.                 06170000
061800     DISPLAY '*** PARAGRAPH = ' PV-ABEND-PARAGRAPH.               06180000
061900     DISPLAY '*** OPERATION = ' PV-ABEND-OPERATION.               06190000
062000     DISPLAY '*** FUNCTION  = ' PV-DB2-FUNCTION.                  06200000
062100     DISPLAY '*** TABLE 1   = ' PV-DB2-TABLE-NAME.                06210000
062200                                                                  06220000
062300     COPY DPPD004.                                                06230000
062400                                                                  06240000
062500     MOVE +4013 TO PV-ABEND-CODE.                                 06250000
062600     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         06260000
062700                                                                  06270000
062800 9998-ABEND.                                                      06280000
062900                                                                  06290000
063000     DISPLAY '***************'.                                   06300000
063100     DISPLAY '** ABEND     **'.                                   06310000
063200     DISPLAY '** PROGRAM   ** = ' PV-ABEND-PROGRAM.               06320000
063300     DISPLAY '** PARAGRAPH ** = ' PV-ABEND-PARAGRAPH.             06330000
063400     DISPLAY '***************'.                                   06340000
063500                                                                  06350000
063600     MOVE +4008                  TO PV-ABEND-CODE.                06360000
063700     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         06370000
063800                                                                  06380000
063900 9999-ABEND.                                                      06390000
064000                                                                  06400000
064100     DISPLAY '***************'.                                   06410000
064200     DISPLAY '** ABEND     **'.                                   06420000
064300     DISPLAY '** PROGRAM   ** = ' PV-ABEND-PROGRAM.               06430000
064400     DISPLAY '** PARAGRAPH ** = ' PV-ABEND-PARAGRAPH.             06440000
064500     DISPLAY '***************'.                                   06450000
064600                                                                  06460000
064700     MOVE +4008                  TO PV-ABEND-CODE.                06470000
064800     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         06480000
064900                                                                  06490000
065000******************************************************************06500000
065100*                 E N D   O F   P R O G R A M                    *06510000
065200******************************************************************06520000
