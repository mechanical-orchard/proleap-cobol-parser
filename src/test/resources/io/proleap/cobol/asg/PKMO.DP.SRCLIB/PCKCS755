000100*-----------------------*                                         00010099
000200 IDENTIFICATION DIVISION.                                         00020099
000300*-----------------------*                                         00030099
000400 PROGRAM-ID.    PCKCS755.                                         00040099
000500 AUTHOR.        DEANNA BRANTNER.                                  00050099
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060099
000700 DATE-WRITTEN.  01-2002.                                          00070099
000800 DATE-COMPILED.                                                   00080099
000900*----------------------------------------------------------------*00090099
001000*    E755 - UNITS WORKED ON-REQUEST REPORTS                      *00100099
001100*                                                                *00110099
001200*    THIS PROGRAM ALLOWS THE USER ENTER DATA TO BE USED BY       *00120099
001300*    SUBSEQUENT PROGRAMS TO CREATE UNITS WORKED ON RQST REPORTS  *00130099
001400*    BY SHIFT OR ENTIRE PERIOD.  THEY CAN BE PRINTED ON RDS OR   *00140099
001500*    REMOTE PRINTER.                                             *00150099
001710*    THEY CAN ALSO PRINT REPORTS FROM THE CURRENT/PREVIOUS SCRN. *00171092
001720*    CHANGED:  2/2002 - DEANNA BRANTNER                          *00172092
001800*----------------------------------------------------------------*00180002
001900* DATE  11/04/2021                                                00190099
001910*            - CHANGE CALL OF 'DPKUT100' TO                     * 00191099
001920*              CALL DP010I-NUMERIC-EDIT-ROUTINE                 * 00192099
001930*              MAKING THE CALL DYNAMIC VS STATIC                * 00193099
001940*     MADE BY: GERMAN BANDA            WR/IR #: CHG0264232        00194099
001950*-----------------------------------------------------------------00195099
1122RM* DATE  11/07/2022                                              * 00196099
1122RM*            - ADD COPYBOOK DPWS930                             * 00197099
1122RM*              CHANGE CALL TO DPWS030 FROM STATIC TO            * 00198099
1122RM*              DYNAMIC.                                         * 00199099
1122RM*     MADE BY: BOB MCASEY              WR/IR #: CHG0277910      * 00199199
1122RM*-----------------------------------------------------------------00199299
002000*----------------------------------------------------------------*00200002
002100 ENVIRONMENT DIVISION.                                            00210002
002500 DATA DIVISION.                                                   00250002
002600*----------------------------------------------------------------*00260002
002800 WORKING-STORAGE SECTION.                                         00280002
002900                                                                  00290002
003000*-----------------------------------------------------------------00300002
003100*  SENDING/RECEIVING AREA FOR THE NUMERIC EDIT ROUTINE (DPKUT100) 00310002
003200*-----------------------------------------------------------------00320002
003300     COPY DPWS010I.                                               00330002
003400                                                                  00340002
003500*-----------------------------------------------------------------00350002
003600*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA                00360002
003700*-----------------------------------------------------------------00370002
003800     COPY DPWS013.                                                00380002
003900                                                                  00390002
004000*-----------------------------------------------------------------00400002
004100*  CICS ATTRIBUTES COPYBOOK                                       00410002
004200*-----------------------------------------------------------------00420002
004300     COPY DPWS015.                                                00430002
004400                                                                  00440002
004500*-----------------------------------------------------------------00450002
004600*  FUNCTION KEYS COPYBOOK                                         00460002
004700*-----------------------------------------------------------------00470002
004800     COPY DPWS016.                                                00480002
004900                                                                  00490002
005000     COPY DPWS017.                                                00500002
005100                                                                  00510002
005200*-----------------------------------------------------------------00520002
005300*  STANDARD ATTENTION IDENTIFIER LIST                             00530002
005400*-----------------------------------------------------------------00540002
005500     COPY DFHAID.                                                 00550002
005600                                                                  00560002
005700*-----------------------------------------------------------------00570002
005800*  STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST          00580002
005900*-----------------------------------------------------------------00590002
006000     COPY DFHBMSCA.                                               00600002
006100                                                                  00610002
006200*-----------------------------------------------------------------00620002
006300*  COPYBOOK FOR CONTROL CARD                                      00630009
006400*-----------------------------------------------------------------00640002
006500     COPY PCWS239.                                                00650009
006600                                                                  00660002
006610*-----------------------------------------------------------------00661009
006620*  DSECT FOR THE PCKM755 MAPSET                                   00662009
006630*-----------------------------------------------------------------00663009
006640     COPY PCKM755.                                                00664009
006650                                                                  00665009
006700*----------------------------------------------------------------*00670002
006800*  SENDING/RECEIVING AREA FOR THE                                 00680002
006900*  PRINTER VALIDATION ROUTING (DPKCS060)                          00690002
007000*----------------------------------------------------------------*00700002
007100     COPY DPWS072.                                                00710002
007200                                                                  00720002
007500*-----------------------------------------------------------------00750002
007510*-----------------------------------------------------------------00751002
007600  01  PS-INTERNAL-READER-ENQ-DEQ-IND                              00760002
007700                              PIC X(1)     VALUE 'N'.             00770002
007800      88  PS-INTERNAL-READER-ENQUEUED      VALUE 'Y'.             00780002
007900      88  PS-INTERNAL-READER-DEQUEUED      VALUE 'N'.             00790002
008000                                                                  00800002
008400 01  DK-DB2-KEYS.                                                 00840002
008500     05  DK-OPER-UNT-ID                 PIC S9(04)  COMP VALUE +0.00850002
008600     05  DK-FCLTY-ID                    PIC S9(04)  COMP VALUE +0.00860002
008700     05  DK-STORE-NMBR.                                           00870002
008800         10  FILLER                     PIC X(01)   VALUE SPACES. 00880002
008900         10  DK-THREE-DIG-STORE-NMBR    PIC X(03)   VALUE SPACES. 00890002
008910     05  DK-FROM-DATE                   PIC X(10) VALUE SPACES.   00891002
008911     05  DK-PREV-FROM-DATE              PIC X(10) VALUE SPACES.   00891102
008920     05  DK-FROM-DATE-X.                                          00892002
008930         10  DK-FROM-YY                 PIC X(04) VALUE SPACES.   00893002
008940         10  FILLER                     PIC X(01) VALUE '-'.      00894002
008950         10  DK-FROM-MM                 PIC X(02) VALUE SPACES.   00895002
008960         10  FILLER                     PIC X(01) VALUE '-'.      00896002
008970         10  DK-FROM-DD                 PIC X(02) VALUE SPACES.   00897002
008980     05  DK-TO-DATE                     PIC X(10).                00898002
008981     05  DK-PREV-TO-DATE                PIC X(10) VALUE SPACES.   00898102
008990     05  DK-TO-DATE-X.                                            00899002
008991         10  DK-TO-YY                   PIC X(04) VALUE SPACES.   00899102
008992         10  FILLER                     PIC X(01) VALUE '-'.      00899202
008993         10  DK-TO-MM                   PIC X(02) VALUE SPACES.   00899302
008994         10  FILLER                     PIC X(01) VALUE '-'.      00899402
008995         10  DK-TO-DD                   PIC X(02) VALUE SPACES.   00899502
008996     05  DK-FISCAL-WEEK.                                          00899602
008997         10  DK-FISCAL-YEAR             PIC X(04) VALUE SPACES.   00899702
008998         10  DK-FISCAL-WK               PIC X(02) VALUE SPACES.   00899802
008999     05  DK-FISCAL-MONTH.                                         00899902
009000         10  DK-FISCAL-YR               PIC X(04) VALUE SPACES.   00900002
009010         10  DK-FISCAL-MN               PIC X(02) VALUE SPACES.   00901002
009100                                                                  00910002
009400 01  WS-DATE.                                                     00940002
009500     10  WS-CCYY.                                                 00950002
009600         15 WS-CC                   PIC 99      VALUE  0.         00960002
009700         15 WS-YY                   PIC 99      VALUE  0.         00970002
009800     10 WS-MM                       PIC 99      VALUE  0.         00980002
009900     10 WS-DD                       PIC 99      VALUE  0.         00990002
010000                                                                  01000002
010400 01  TD-TRANSIENT-DATA-AREA.                                      01040002
010500     05  TD-QUEUE-NAME-LENGTH    PIC S9(4)    VALUE +4            01050002
010600                                 COMP SYNC.                       01060002
010700     05  TD-JCL-LINE-LENGTH      PIC S9(4)    VALUE +80           01070002
010800                                 COMP SYNC.                       01080002
010900     05  TD-QUEUE-NAME           PIC X(4)     VALUE 'IRTD'.       01090002
011000     05  TD-JCL-LINE             PIC X(80)    VALUE SPACES.       01100002
011100                                                                  01110002
011500 01  PS-PROGRAM-SWITCHES.                                         01150002
011600     05  PS-EDIT-ERROR-IND       PIC X(1)     VALUE 'N'.          01160002
011700         88  PS-NO-EDIT-ERROR                 VALUE 'N'.          01170002
011800         88  PS-EDIT-ERROR                    VALUE 'Y'.          01180002
011900                                                                  01190002
012300 01  PC-PROGRAM-CONSTANTS.                                        01230002
012400     05  PC-01                   PIC X(02)    VALUE '01'.         01240002
012500     05  PC-A                    PIC X(01)    VALUE 'A'.          01250009
012501     05  PC-B                    PIC X(01)    VALUE 'B'.          01250109
012502     05  PC-C                    PIC X(01)    VALUE 'C'.          01250209
012503     05  PC-D                    PIC X(01)    VALUE 'D'.          01250309
012504     05  PC-E                    PIC X(01)    VALUE 'E'.          01250409
012505     05  PC-S                    PIC X(01)    VALUE 'S'.          01250553
012506     05  PC-Y                    PIC X(01)    VALUE 'Y'.          01250653
012510     05  PC-TEST                 PIC X(01)    VALUE 'T'.          01251009
012600     05  PC-QA                   PIC X(01)    VALUE 'Q'.          01260002
012700     05  PC-LEARN                PIC X(01)    VALUE 'L'.          01270002
012800     05  PC-PRTR-VALIDATION-PGM  PIC X(08)    VALUE 'DPKCS060'.   01280002
012900     05  PC-REPORT-PGM           PIC X(08)    VALUE 'PCKRP011'.   01290019
013000     05  PC-CURRENT-PROGRAM-NAME PIC X(08)    VALUE 'PCKCS755'.   01300002
013100     05  PC-CURRENT-MAPSET-NAME  PIC X(08)    VALUE 'PCKM755'.    01310002
013200     05  PC-CURRENT-MAP-NAME     PIC X(08)    VALUE 'PC755A'.     01320002
013300     05  PC-DPKCS030             PIC X(08)    VALUE 'DPKCS030'.   01330002
013400     05  PC-MAX-RETRIES          PIC S9(4)    VALUE +2.           01340002
013500     05  PC-KOHLS-OPERATING-COMPANY                               01350002
013600                                 PIC X(2)     VALUE '03'.         01360002
013700                                                                  01370002
013800     05  PC-STATUS-REPORT-DESC   PIC  X(16)  VALUE                01380014
013900         'UNITS WORKED '.                                         01390012
014000     05  PC-STATUS-REPORT-PROC1  PIC  X(07)  VALUE                01400099
014100         'PCK9151'.                                               01410012
014200     05  PC-STATUS-REPORT-JOB1   PIC  X(07)  VALUE                01420099
014300         'PCK915 '.                                               01430012
014310     05  PC-STATUS-REPORT-PROC2  PIC  X(07)  VALUE                01431099
014320         'PCK9251'.                                               01432099
014330     05  PC-STATUS-REPORT-JOB2   PIC  X(07)  VALUE                01433099
014340         'PCK925 '.                                               01434099
014400                                                                  01440002
014500*-----------------------------------------------------------------01450002
014600*  SYSTEM MESSAGES - FROM TSYMSG TABLE                            01460002
014700*-----------------------------------------------------------------01470002
014800 01  PC-TSYMSG-AREA.                                              01480002
014900*  INVALID VALUE                                                  01490002
015000     05  PC-TSYMSG-00005      PIC 9(5) VALUE 00005.               01500002
015100*  REQUIRED ENTRY                                                 01510002
015200     05  PC-TSYMSG-00007      PIC 9(5) VALUE 00007.               01520002
015300*  MUST BE NUMERIC                                                01530002
015400     05  PC-TSYMSG-00008      PIC 9(5) VALUE 00008.               01540002
015500*  PRINT REQUEST HAS BEEN SUBMITTED                               01550002
015600     05  PC-TSYMSG-00098      PIC 9(5) VALUE 00098.               01560002
015700*  REPORT REQUEST SUCCESSFULLY SUBMITTED                          01570002
015800     05  PC-TSYMSG-00458      PIC 9(5) VALUE 00458.               01580002
015810*  ENTER AN 'S' TO SELECT                                         01581040
015820     05  PC-TSYMSG-00397      PIC 9(5) VALUE 00397.               01582040
015900*  INVALID PRINTER DESTINATION                                    01590002
016000     05  PC-TSYMSG-00746      PIC 9(5) VALUE 00746.               01600002
016100*  PRINTER ID MUST BE ENTERED FOR THIS SELECTION                  01610002
016200     05  PC-TSYMSG-01563      PIC 9(5) VALUE 01563.               01620002
016201*  INVALID DATE OR DATE RANGE                                     01620106
016210     05  PC-TSYMSG-02416       PIC  9(05)  VALUE  02416.          01621006
016300*  PLEASE MAKE ONLY ONE SELECTION AT A TIME.                      01630027
016400     05  PC-TSYMSG-02665      PIC 9(5) VALUE 02665.               01640027
016500*  REPORTS MUST BE SENT TO EITHER RDS OR REMOTE PRINTER.          01650027
016600     05  PC-TSYMSG-02887      PIC 9(5) VALUE 02887.               01660027
016900                                                                  01690002
017000*-----------------------------------------------------------------01700002
017300 01  PV-PROGRAM-VARIABLES.                                        01730002
017400     05  PV-PRINTER-DESTINATION    PIC  X(05)  VALUE SPACES.      01740002
017410     05  PV-DP020-INT-APPL-FORMAT-IND  PIC X(1) VALUE SPACES.     01741076
017500     05  PV-SQL-SUB              PIC S9(04)   COMP VALUE +0.      01750002
017600     05  PV-TRANSFER-PROGRAM     PIC X(8)     VALUE SPACES.       01760002
017700     05  PV-LEAVE-SYSTEM-MESSAGE PIC X(400)   VALUE SPACES.       01770002
017800     05  PV-CICS-RESPONSE        PIC S9(9)    VALUE ZERO          01780002
017900                                 COMP SYNC.                       01790002
018000     05  PV-RETRY-COUNT          PIC S9(4)    VALUE ZERO          01800002
018100                                 COMP SYNC.                       01810002
018200     05  PV-CURRENT-YEAR         PIC S9(9)    VALUE ZERO          01820002
018300                                 COMP SYNC.                       01830002
018400     05  PV-KEY-FEEDBACK-AREA    PIC X(11)    VALUE SPACES.       01840002
018500     05  PV-MESSAGE-NBR          PIC 9(05)    VALUE ZEROES.       01850002
018600     05  PV-DEPT-NMBR            PIC X(03)    VALUE SPACES.       01860002
018700     05  PV-DP020-NAV-KEY-DATA   PIC X(25)    VALUE SPACES.       01870002
018800     05  PV-USER-ID              PIC X(8)     VALUE SPACES.       01880002
018900                                                                  01890002
019000     05  PV-SYSTEM-ID.                                            01900002
019100         10  FILLER              PIC  X(04)  VALUE SPACE.         01910002
019200         10  PV-REGION-IND       PIC  X(01).                      01920002
019300             88  PV-TEST-CICS                VALUE 'T'.           01930002
019400             88  PV-QA-CICS                  VALUE 'Q'.           01940002
019500             88  PV-PROD-CICS                VALUE 'P'.           01950002
019600             88  PV-LEARN-CICS               VALUE 'L'.           01960002
019700         10  FILLER              PIC  X(03)  VALUE SPACES.        01970002
019800                                                                  01980002
020100                                                                  02010002
020600     05  PV-JOB-DESCRIPTION      PIC  X(16)  VALUE SPACES.        02060017
020700     05  PV-JOB-PROC             PIC  X(07)  VALUE SPACES.        02070002
020800     05  PV-JOB-NAME             PIC  X(07)  VALUE SPACES.        02080002
020820     05  PV-DISPLAY-TITLE1       PIC  X(55) VALUE SPACES.         02082012
020830     05  PV-DISPLAY-TITLE2       PIC  X(55) VALUE SPACES.         02083012
020831     05  PV-PRINTER-ID           PIC  X(08) VALUE SPACES.         02083169
020840     05  PV-KEY-DATE             PIC  X(10)  VALUE SPACES.        02084002
020850     05  PV-KEY-DATE-R REDEFINES PV-KEY-DATE.                     02085002
020860         10  PV-KEY-YY           PIC  9(04).                      02086002
020870         10  PV-DASH-1           PIC  X(01).                      02087002
020880         10  PV-KEY-MM           PIC  9(02).                      02088002
020890         10  PV-DASH-2           PIC  X(01).                      02089002
020891         10  PV-KEY-DD           PIC  9(02).                      02089102
020892     05  PV-CURR-TMST            PIC  X(26)  VALUE SPACES.        02089210
020893     05  PV-CURRENT-TMST-R REDEFINES PV-CURR-TMST.                02089310
020894         10  PV-CURR-DATE.                                        02089410
020895             15  PV-CUR-YY           PIC  9(04).                  02089510
020896             15  FILLER              PIC  X(01).                  02089610
020897             15  PV-CUR-MM           PIC  9(02).                  02089710
020898             15  FILLER              PIC  X(01).                  02089810
020899             15  PV-CUR-DD           PIC  9(02).                  02089910
020900         10  FILLER                  PIC  X(01).                  02090012
020901         10  PV-CURR-TIME.                                        02090110
020902             15  PV-CUR-HH           PIC  9(02).                  02090210
020903             15  FILLER              PIC  X(01).                  02090310
020904             15  PV-CUR-MN           PIC  9(02).                  02090410
020905             15  FILLER              PIC  X(01).                  02090510
020906             15  PV-CUR-SEC          PIC  9(02).                  02090610
020907         10  FILLER                  PIC  X(07).                  02090710
020910                                                                  02091002
021000*-----------------------------------------------------------------02100002
021100*  JCL LINES FOR A REPORT'S REQUEST                               02110002
021200*-----------------------------------------------------------------02120002
021300  01  JL-JCL-LINE-AREA.                                           02130002
021400      05  JL-JCL-LINE-1           PIC X(80)    VALUE SPACE.       02140002
021500      05  JL-JOB-LINE-PROD.                                       02150002
021600          10  FILLER              PIC X(02)    VALUE '//'.        02160002
021700          10  JL-PROD-JOB-NAME    PIC X(07)    VALUE SPACE.       02170002
021800          10  FILLER              PIC X(12)    VALUE              02180002
021900              '  JOB KOHLS,'.                                     02190002
022000          10  FILLER              PIC X(1)     VALUE QUOTE.       02200002
022100          10  JL-PROD-JOB-DESC    PIC X(16)    VALUE SPACES.      02210017
022200          10  FILLER              PIC X(1)     VALUE QUOTE.       02220002
022300          10  FILLER              PIC X(29)    VALUE              02230002
022400              ',MSGCLASS=P,CLASS=Q,REGION=3M'.                    02240087
022500          10  FILLER              PIC X(15)    VALUE SPACES.      02250002
022600      05  JL-JOB-LINE-TEST.                                       02260002
022700          10  FILLER              PIC X(02)    VALUE '//'.        02270002
022800          10  JL-TEST-JOB-NAME    PIC X(07)    VALUE SPACE.       02280002
022900          10  FILLER              PIC X(01)    VALUE 'Q'.         02290002
023000          10  FILLER              PIC X(11)    VALUE              02300002
023100              ' JOB KOHLS,'.                                      02310002
023200          10  FILLER              PIC X(1)     VALUE QUOTE.       02320002
023300          10  JL-TEST-JOB-DESC    PIC X(16)    VALUE SPACES.      02330017
023400          10  FILLER              PIC X(1)     VALUE QUOTE.       02340002
023500          10  FILLER              PIC X(29)    VALUE              02350002
023600              ',MSGCLASS=X,CLASS=E,REGION=3M'.                    02360002
023700      05  JL-JCL-LINE-2-PROD.                                     02370002
023800          10  FILLER              PIC X(13)    VALUE              02380002
023900               '/*JOBPARM K=0'.                                   02390002
024000          10  FILLER              PIC X(67)    VALUE SPACES.      02400002
024100      05  JL-JCL-LINE-3.                                          02410002
024200          10  FILLER              PIC X(34)    VALUE              02420002
024300          '//JOBOUT01 OUTPUT FORMS=STD,CLASS='.                   02430002
024400          10  JL-LINE-3-CLASS     PIC X(1)     VALUE SPACES.      02440002
024500          10  FILLER              PIC X(15)    VALUE              02450002
024600          ',COPIES=1,DEST='.                                      02460002
024700          10  JL-LINE-3-PRINTER   PIC X(8)     VALUE SPACES.      02470002
024800          10  FILLER              PIC X(22)    VALUE SPACES.      02480002
024900      05  JL-JCL-LINE-4-PROD.                                     02490002
025000          10  FILLER              PIC X(40)    VALUE              02500002
025100               '//JOBLIB    DD DSN=PKMO.LOADLIB,DISP=SHR'.        02510002
025200          10  FILLER              PIC X(40)    VALUE SPACES.      02520002
025300      05  JL-JCL-LINE-4-TEST.                                     02530002
025400          10  FILLER              PIC X(40)    VALUE              02540002
025500               '//JOBLIB    DD DSN=TKMA.LOADLIB,DISP=SHR'.        02550002
025600          10  FILLER              PIC X(40)    VALUE SPACES.      02560002
026100      05  JL-JCL-LINE-6.                                          02610002
026200          10  FILLER              PIC X(16)    VALUE              02620002
026300              '//PS020    EXEC '.                                 02630002
026400          10  JL-LINE-6-PROC      PIC X(07)    VALUE SPACES.      02640002
026500          10  JL-LINE-6-PROC-T    PIC X(01)    VALUE SPACE.       02650002
026600          10  FILLER              PIC X(56)    VALUE SPACES.      02660002
026700      05  JL-JCL-LINE-7.                                          02670002
026800          10  FILLER              PIC X(18)    VALUE              02680002
026900              '//S010.SYSUT1 DD *'.                               02690002
027000          10  FILLER              PIC X(62)    VALUE SPACES.      02700002
027100      05  JL-JCL-LINE-8.                                          02710002
027200          10  JL-LINE-8-USER-ID           PIC X(08) VALUE SPACES. 02720009
027300          10  JL-LINE-8-OPER-UNT          PIC 9(04) VALUE ZEROES. 02730010
027400          10  JL-LINE-8-REQUEST-DATE      PIC X(10) VALUE SPACES. 02740009
027500          10  JL-LINE-8-REQUEST-TIME      PIC X(08) VALUE SPACES. 02750009
027600          10  JL-LINE-8-START-DATE        PIC X(10) VALUE SPACES. 02760009
027700          10  JL-LINE-8-END-DATE          PIC X(10) VALUE SPACES. 02770009
027800          10  JL-LINE-8-FISCAL-YYYY       PIC 9(04) VALUE ZEROES. 02780010
027810          10  JL-LINE-8-FISCAL-MONTH      PIC 9(02) VALUE ZEROES. 02781010
027820          10  JL-LINE-8-FISCAL-WEEK       PIC 9(02) VALUE ZEROES. 02782009
027830          10  JL-LINE-8-TO-RDS            PIC X(01) VALUE SPACES. 02783010
027900          10  JL-LINE-8-PRINTER           PIC X(08) VALUE SPACES. 02790009
028000          10  JL-LINE-8-REPORT-TYPE       PIC X(01) VALUE SPACES. 02800010
028100          10  JL-LINE-8-REPORT-PREV       PIC X(01) VALUE SPACES. 02810010
028110          10  JL-LINE-8-REPORT-CONTENT    PIC X(01) VALUE SPACES. 02811010
028120          10  JL-LINE-8-REPORT-CREATE     PIC X(01) VALUE SPACES. 02812010
028200          10  FILLER                      PIC X(09) VALUE SPACES. 02820009
028300*DP   05  JL-JCL-AUTO-SCHD.                                       02830002
028400*DP       10  FILLER              PIC X(40)    VALUE              02840002
028500*DP           '//$AUTO    EXEC PGM=$A,COND=(4,LE),PARM='.         02850002
028600*DP       10  FILLER              PIC X(01)    VALUE QUOTE.       02860002
028700*DP       10  FILLER              PIC X(01)    VALUE '>'.         02870002
028800*DP       10  FILLER              PIC X(01)    VALUE QUOTE.       02880002
028900*DP       10  FILLER              PIC X(37)    VALUE SPACES.      02890002
029000      05  JL-JCL-LINE-EOF.                                        02900002
029100          10  FILLER              PIC X(5)     VALUE '/*EOF'.     02910002
029200          10  FILLER              PIC X(75)    VALUE SPACES.      02920002
029300                                                                  02930002
029700*-----------------------------------------------------------------02970002
029800 01  RF-ROLLBACK-FAILURE-MESSAGE.                                 02980002
029900     05  FILLER                  PIC X(5)     VALUE SPACES.       02990002
030000     05  FILLER                  PIC X(61)    VALUE               03000002
030100     '**  THE ATTEMPTED ROLLBACK FAILED  **'.                     03010002
030200     05  FILLER                  PIC X(10)    VALUE 'EIBRESP = '. 03020002
030300     05  RF-CICS-RESPONSE        PIC 9(4)     VALUE ZERO.         03030002
030400                                                                  03040002
030800 01  IC-ISO-CURRENT-DATE-AREA.                                    03080002
030900     05  IC-ISO-CURRENT-DATE-X.                                   03090002
031000         10  IC-CURRENT-YEAR     PIC 9(4)     VALUE ZERO.         03100002
031100         10  FILLER              PIC X(6)     VALUE SPACES.       03110002
031200     05  FILLER                  REDEFINES IC-ISO-CURRENT-DATE-X. 03120002
031300         10  FILLER              PIC X(2).                        03130002
031400         10  IC-CURRENT-YY-MM-DD PIC X(8).                        03140002
031500     05  IC-ISO-CURRENT-DATE     REDEFINES IC-ISO-CURRENT-DATE-X  03150002
031600                                 PIC X(10).                       03160002
032100 01  SE-SYSTEM-ERROR-MESSAGE.                                     03210002
032200     05  FILLER                  PIC X(51)    VALUE               03220002
032300         'A SYSTEM ERROR HAS OCCURRED - CONTACT DP - PROGRAM '.   03230002
032400     05  SE-CURRENT-PROGRAM-NAME PIC X(8)     VALUE SPACES.       03240002
032500     05  FILLER                  PIC X(7)     VALUE SPACES.       03250002
032600     05  FILLER                  PIC X(10)    VALUE 'EIBRESP = '. 03260002
032700     05  SE-CICS-RESPONSE        PIC 9(4)     VALUE ZERO.         03270002
032800     05  FILLER                  PIC X(5)     VALUE SPACES.       03280002
032900     05  FILLER                  PIC X(14)    VALUE               03290002
033000         'ATTEMPTING TO '.                                        03300002
033100     05  SE-ATTEMPTED-ACTION     PIC X(61)    VALUE SPACES.       03310002
033200                                                                  03320002
033600 01  DRU-DB2-RESOURCE-UNAVAIL-MSG.                                03360002
033700     05  FILLER                  PIC X(85)    VALUE               03370002
033800         'A RESOURCE WAS NOT AVAILABLE.  PLEASE TRY AGAIN.'.      03380002
033900     05  FILLER                  PIC X(45)    VALUE               03390002
034000         'IF THE PROBLEM PERSISTS, CONTACT DP (PROGRAM '.         03400002
034100     05  DRU-CURRENT-PROGRAM-NAME                                 03410002
034200                                 PIC X(8)     VALUE SPACES.       03420002
034300     05  FILLER                  PIC X(22)    VALUE ').'.         03430002
034400                                                                  03440002
034500 01  DE-DB2-ERROR-MESSAGE.                                        03450002
034600     05  FILLER                  PIC X(48)    VALUE               03460002
034700         'A DB2 ERROR HAS OCCURRED - CONTACT DP - PROGRAM '.      03470002
034800     05  DE-CURRENT-PROGRAM-NAME PIC X(8)     VALUE SPACES.       03480002
034900     05  FILLER                  PIC X(29)    VALUE SPACES.       03490002
035000     05  FILLER                  PIC X(11)    VALUE               03500002
035100         'SQLCODE = ('.                                           03510002
035200     05  DE-SQLCODE              PIC Z(8)9-   VALUE ZERO.         03520002
035300     05  FILLER                  PIC X(21)    VALUE               03530002
035400         ')  ROWS PROCESSED = ('.                                 03540002
035500     05  DE-ROWS-PROCESSED       PIC Z(8)9-   VALUE ZERO.         03550002
035600     05  FILLER                  PIC X(23)    VALUE ')'.          03560002
035700     05  FILLER                  PIC X(5)     VALUE SPACES.       03570002
035800     05  FILLER                  PIC X(14)    VALUE               03580002
035900         'ATTEMPTING TO '.                                        03590002
036000     05  DE-ATTEMPTED-ACTION     PIC X(61)    VALUE SPACES.       03600002
036100                                                                  03610002
036200 01  DW-DB2-WARNING-MESSAGE.                                      03620002
036300     05  FILLER                  PIC X(50)    VALUE               03630002
036400         'A DB2 WARNING HAS OCCURRED - CONTACT DP - PROGRAM '.    03640002
036500     05  DW-CURRENT-PROGRAM-NAME PIC X(8)     VALUE SPACES.       03650002
036600     05  FILLER                  PIC X(27)    VALUE SPACES.       03660002
036700     05  FILLER                  PIC X(11)    VALUE               03670002
036800         'SQLCODE = ('.                                           03680002
036900     05  DW-SQLCODE              PIC Z(8)9-   VALUE ZERO.         03690002
037000     05  FILLER                  PIC X(21)    VALUE               03700002
037100         ')  ROWS PROCESSED = ('.                                 03710002
037200     05  DW-ROWS-PROCESSED       PIC Z(8)9-   VALUE ZERO.         03720002
037300     05  FILLER                  PIC X(14)    VALUE               03730002
037400         ')  SQLWARN = ('.                                        03740002
037500     05  DW-SQLWARN              PIC X(8)     VALUE SPACES.       03750002
037600     05  FILLER                  PIC X(1)     VALUE ')'.          03760002
037700     05  FILLER                  PIC X(5)     VALUE SPACES.       03770002
037800     05  FILLER                  PIC X(14)    VALUE               03780002
037900         'ATTEMPTING TO '.                                        03790002
038000     05  DW-ATTEMPTED-ACTION     PIC X(61)    VALUE SPACES.       03800002
038100                                                                  03810002
038200 01  ST-SYSTEM-TIME-AREA.                                         03820002
038300     05  ST-ABSTIME              PIC S9(18)   VALUE ZERO          03830002
038400                                 COMP SYNC.                       03840002
038500     05  ST-TIME-EDIT.                                            03850002
038600         10  ST-TIME-HHMM        PIC X(5)     VALUE SPACES.       03860002
038700         10  FILLER              PIC X(3)     VALUE SPACES.       03870002
038800                                                                  03880002
038810*---------------------------------------------------------------* 03881002
038820*    PARAMETERS FOR CALLING CICS ARCHITECTURE API (DPKCS030).   * 03882002
038830*---------------------------------------------------------------* 03883002
038840     COPY DPWS030.                                                03884002
1122RM     COPY DPWS930.                                                03885099
038900                                                                  03890002
039000*-----------------------------------------------------------------03900002
039100*    STANDARD COMMAREA DEFINITION                                 03910025
039200*-----------------------------------------------------------------03920002
039400     COPY DPWS020.                                                03940002
039500    05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                 03950002
039510                                                                  03951002
039520*---------------------------------------------------------------* 03952002
039530* INTER-APPLICATION COMMAREA.                                   * 03953002
039560*   PCWS214 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 03956002
039570*             THIS LIST PROGRAMMING FOR A LOCAL-GO FUNCTION.    * 03957002
039600*----------------------------------------------------------------*03960002
039700*       APPLICATION COMMAREA.                                    *03970002
039800*----------------------------------------------------------------*03980002
039902                                                                  03990202
039910         10  INTER-APPL-COMM-AREA          PIC X(200).            03991008
039930     COPY PCWS214.                                                03993007
041400*-------------------------------------------------------------*   04140002
041500*    APPLICATION SPECIFIC COMMAREA.                           *   04150002
041600*-------------------------------------------------------------*   04160002
041700         10  ASC-SPECIFIC-COMMAREA.                               04170002
041900             15  ASC-OPER-UNT-ID           PIC X(04).             04190002
042000             15  ASC-OPER-UNT-ID-N REDEFINES ASC-OPER-UNT-ID      04200002
042100                                           PIC 9(04).             04210002
042500             15  ASC-OPER-DESC             PIC X(25).             04250002
042800             15  ASC-BY-SHIFT              PIC X.                 04280002
042810             15  ASC-BY-PERIOD             PIC X.                 04281002
042820             15  ASC-BY-CO                 PIC X.                 04282092
042830             15  ASC-BY-DC                 PIC X.                 04283092
042900             15  ASC-TO-RDS                PIC X.                 04290002
042910             15  ASC-TO-REMOTE             PIC X.                 04291002
043010             15  ASC-BUSN-DATE.                                   04301002
043020                 20  ASC-BUSN-YY             PIC  X(04).          04302023
043030                 20  ASC-BUSN-MM             PIC  X(02).          04303002
043040                 20  ASC-BUSN-DD             PIC  X(02).          04304002
043042             15  ASC-FROM-DATE.                                   04304202
043044                 20  ASC-FROM-MM             PIC  X(02).          04304402
043045                 20  ASC-FROM-DD             PIC  X(02).          04304502
043046                 20  ASC-FROM-YY             PIC  X(04).          04304612
043047             15  ASC-TO-DATE.                                     04304702
043049                 20  ASC-TO-MM               PIC  X(02).          04304902
043050                 20  ASC-TO-DD               PIC  X(02).          04305002
043051                 20  ASC-TO-YY               PIC  X(04).          04305112
043052             15  ASC-FISCAL-WEEK.                                 04305202
043053                 20  ASC-FSCL-YY             PIC  X(04).          04305302
043054                 20  ASC-FSCL-WW             PIC  X(02).          04305402
043060             15  ASC-FISCAL-MONTH.                                04306002
043061                 20  ASC-FSCL-YR             PIC  X(04).          04306102
043062                 20  ASC-FSCL-MM             PIC  X(02).          04306202
043070             15  ASC-PRINTER-ID              PIC  X(08).          04307002
043080             15  ASC-DISPLAY-REPORT          PIC  X(24).          04308007
043081             15  ASC-DISPLAY-TITLE1          PIC  X(55).          04308112
043090             15  ASC-DISPLAY-TITLE2          PIC  X(55).          04309012
043100             15  FILLER                      PIC X(001).          04310002
043300                                                                  04330002
043400         10  INTER-APPL-COMM-AREA1.                               04340099
043410             15  ACA-USER-ID              PIC X(08).              04341099
043420             15  ACA-OPER-UNIT-ID         PIC X(04).              04342099
043430             15  ACA-OPER-UNIT-ID-N REDEFINES                     04343099
043440                 ACA-OPER-UNIT-ID         PIC 9(04).              04344099
043450             15  ACA-REQUEST-DATE         PIC X(10).              04345099
043460             15  ACA-REQUEST-TIME         PIC X(08).              04346099
043470             15  ACA-START-DATE           PIC X(10).              04347099
043480             15  ACA-END-DATE             PIC X(10).              04348099
043490             15  ACA-FISCAL-YYYY          PIC X(04).              04349099
043491             15  ACA-FISCAL-MONTH         PIC X(02).              04349199
043492             15  ACA-FISCAL-WEEK          PIC X(02).              04349299
043493             15  ACA-TO-RDS               PIC X(01).              04349399
043494             15  ACA-PRINTER-ID           PIC X(08).              04349499
043495             15  ACA-REPORT-TYPE          PIC X(01).              04349599
043496             15  ACA-REPORT-PREV          PIC X(01).              04349699
043497             15  ACA-REPORT-CONTENT       PIC X(01).              04349799
043498             15  ACA-REPORT-CREATE        PIC X(01).              04349899
043499             15  FILLER                   PIC X(129).             04349999
043500*---------------------------------------------------------------- 04350002
043600*  XLT_LOC - LOCATION TABLE                                       04360099
043700*---------------------------------------------------------------- 04370002
043800     EXEC SQL                                                     04380002
043900         INCLUDE XLT00010                                         04390099
044000     END-EXEC.                                                    04400002
044100                                                                  04410002
044300*---------------------------------------------------------------- 04430002
044400*  SQL AND COBOL DECLARATIONS FOR THE TDTATTR TABLE (TDTATTR)     04440002
044500*---------------------------------------------------------------- 04450002
044600     EXEC SQL                                                     04460002
044700         INCLUDE TDTATTR                                          04470002
044800     END-EXEC.                                                    04480002
044900                                                                  04490002
045900*---------------------------------------------------------------- 04590002
046000*  STANDARD LAYOUT FOR THE SQL COMMUNICATIONS AREA                04600002
046100*---------------------------------------------------------------- 04610002
046200     EXEC SQL                                                     04620002
046300         INCLUDE SQLCA                                            04630002
046400     END-EXEC.                                                    04640002
046500                                                                  04650002
046700*---------------------------------------------------------------- 04670002
046800 LINKAGE SECTION.                                                 04680002
046900*---------------------------------------------------------------- 04690002
047000 01  DFHCOMMAREA.                                                 04700002
047100     05  FILLER                       OCCURS 1 TO 4072 TIMES      04710002
047200                                      DEPENDING ON EIBCALEN.      04720002
047300         10  FILLER                   PIC X.                      04730002
047400                                                                  04740002
047600*---------------------------------------------------------------- 04760002
047700 PROCEDURE DIVISION.                                              04770002
047800*---------------------------------------------------------------- 04780002
047900 0000-MAIN-MODULE.                                                04790002
048000     INITIALIZE DP030-CICS-API-FIELDS.                            04800002
048100     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       04810002
048200     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          04820002
048300     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         04830002
048400     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       04840002
048500     MOVE LENGTH OF PC755AI        TO DP030-MAP-LENGTH (1).       04850002
048600     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     04860002
048700     PERFORM 0001-CALL-CICS-ARCH-API.                             04870002
048800*                                                                 04880002
048900     PERFORM 1000-CONTROL-PROCESSING                              04890002
049000                                                                  04900002
049100     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     04910002
049200     PERFORM 0001-CALL-CICS-ARCH-API.                             04920002
049300                                                                  04930002
049500 0001-CALL-CICS-ARCH-API.                                         04950002
1122RM*    CALL PC-DPKCS030 USING DFHEIBLK                              04960099
1122RM     CALL DP930-CICS-ARCH-API                                     04961099
1122RM                      USING DFHEIBLK                              04962099
049700                            DFHCOMMAREA                           04970002
049800                            DP030-CICS-API-FIELDS                 04980002
049900                            DP020-STANDARD-COMMAREA               04990002
050000                            PC755AI.                              05000002
050100*                                                                 05010002
050200     IF  DP030-RC-CALL-SUCCESSFUL                                 05020002
050300         CONTINUE                                                 05030002
050400     ELSE                                                         05040002
050500         SET DP013-NO-ROLLBACK                                    05050002
050600             DP013-XCTL-DISPLAY-RESTART                           05060002
050700             DP013-CICS-ABEND      TO TRUE                        05070002
050800         MOVE '0001-CALL-CICS-ARCH-API' TO DP013-PARAGRAPH        05080002
1122RM*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX05100099
1122RM*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      05110099
1122rm         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O05111099
1122RM-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      05112099
051200         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      05120002
051400         PERFORM DP013-0000-PROCESS-ABEND                         05140002
051500     END-IF.                                                      05150002
051700                                                                  05170002
051800*----------------------------------------------------------------*05180002
051900*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *05190002
052000*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *05200002
052100*----------------------------------------------------------------*05210002
052200 1000-CONTROL-PROCESSING.                                         05220002
052300                                                                  05230002
053100     EVALUATE TRUE                                                05310002
053200         WHEN DP020-NEXT-ACT-INITIAL                              05320002
053300             INITIALIZE ASC-SPECIFIC-COMMAREA                     05330002
053400                        INTER-APPL-COMM-AREA1                     05340015
053750             MOVE PC214-OPER-UNT-ID  TO ASC-OPER-UNT-ID           05375052
053760             MOVE PC214-BUSN-DATE    TO ASC-BUSN-DATE             05376052
053770             MOVE PC214-FROM-DATE    TO ASC-FROM-DATE             05377052
053780             MOVE PC214-TO-DATE      TO ASC-TO-DATE               05378052
053790             MOVE PC214-FISCAL-WEEK  TO ASC-FISCAL-WEEK           05379052
053791             MOVE PC214-FISCAL-MONTH TO ASC-FISCAL-MONTH          05379152
053792             MOVE PC214-PRINTER-ID   TO ASC-PRINTER-ID            05379252
053800             PERFORM 4000-BUILD-INITIAL-PANEL                     05380052
053810             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 05381052
053820             IF DP020-INT-APPL-FORMAT-IND = '2'                   05382079
053830                 PERFORM 3200-RESET-ATTRIBUTES                    05383051
053831                 MOVE PC-S               TO ASEL1O                05383192
053832                                            ASC-BY-SHIFT          05383292
053840             ELSE                                                 05384051
053841                 IF DP020-INT-APPL-FORMAT-IND = '6'               05384192
053842                     PERFORM 3400-RESET-ATTRIBUTES                05384292
053851                 ELSE                                             05385199
053852                     PERFORM 3300-RESET-ATTRIBUTES                05385299
053860                 END-IF                                           05386092
053870             END-IF                                               05387092
053900                                                                  05390002
054000         WHEN DP020-NEXT-ACT-READ-MAP                             05400002
054100             PERFORM 2000-FKEY-PROCESSING                         05410002
054200                                                                  05420002
054300         WHEN DP020-NEXT-ACT-RETURN                               05430002
054400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 05440007
054600             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  05460002
054800                                                                  05480002
054900         WHEN OTHER                                               05490002
055000             SET DP013-LOGIC-ABEND                                05500002
055100                 DP013-NO-ROLLBACK TO TRUE                        05510002
055200             MOVE '1000-CONTROL-PROCESSING'                       05520002
055300                                   TO  DP013-PARAGRAPH            05530002
055400             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    05540002
055500                                   TO  DP013-MESSAGE-TEXT(1)      05550002
055800             PERFORM DP013-0000-PROCESS-ABEND                     05580002
055900     END-EVALUATE.                                                05590002
056100                                                                  05610002
056200*----------------------------------------------------------------*05620002
056300* FURTHER DETERMINE PROCESSING PATH BASED ON FUNCTION KEY ACTIONS*05630002
056400* SPECIFIC FUNCTION KEYS LISTED HERE ARE ACTED UPON REGARDLESS OF*05640002
056500* EDITS.                                                         *05650002
056600*----------------------------------------------------------------*05660002
056700 2000-FKEY-PROCESSING.                                            05670002
056800                                                                  05680002
056900     EVALUATE TRUE                                                05690002
057000                                                                  05700002
057100         WHEN DP020-SRC-AID = DP016-CLEAR                         05710002
057200             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   05720025
057210             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 05721002
057300                                                                  05730002
057400         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     05740002
057900             MOVE SPACES TO ASC-BY-SHIFT                          05790099
057901                            ASC-BY-PERIOD                         05790199
057902                            ASC-TO-RDS                            05790299
057903                            ASC-TO-REMOTE                         05790399
057904                            ASC-BY-CO                             05790499
057905                            ASC-BY-DC                             05790599
057906             PERFORM 4000-BUILD-INITIAL-PANEL                     05790699
057910             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 05791099
057920             IF DP020-INT-APPL-FORMAT-IND = '2'                   05792079
057930                 PERFORM 3200-RESET-ATTRIBUTES                    05793049
057940             ELSE                                                 05794049
057941                 IF DP020-INT-APPL-FORMAT-IND = '6'               05794192
057942                     PERFORM 3400-RESET-ATTRIBUTES                05794292
057946                 ELSE                                             05794692
057950                     PERFORM 3300-RESET-ATTRIBUTES                05795092
057960                 END-IF                                           05796092
057961             END-IF                                               05796192
058200                                                                  05820002
058300         WHEN OTHER                                               05830002
058400             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 05840025
058500             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   05850025
058600             IF  PS-NO-EDIT-ERROR                                 05860002
058700                 SET DP030-CONTINUE-GO TO TRUE                    05870002
058800                 MOVE -1      TO AOPERL                           05880002
058900                 PERFORM 2100-CHECK-FUNCTION-KEY                  05890002
059000             ELSE                                                 05900002
059100                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             05910002
059110                 SET DP030-OVERRIDE-GO TO TRUE                    05911002
059200             END-IF                                               05920002
059300     END-EVALUATE.                                                05930002
059400                                                                  05940002
059600*---------------------------------------------------------------- 05960002
059700*  PERFORM THIS PARAGRAPH AFTER ALL THE EDITS HAVE BEEN MADE AND  05970002
059800*  THEN CHECK THE INT-APPL-FORMAT-IND TO SEE WHAT PF KEY HAS BEEN 05980002
059900*  SELECTED.                                                      05990002
060000*                                                                 06000002
060100*  CURRENTLY PROGRAM IS ONLY SET UP FOR ENTER & F18 KEYS.         06010002
060200*     ENTER - ONLY EDITS SCREEN                                   06020002
060300*     F18 --- REQUEST REPORTS TO PRINT                            06030002
060400*---------------------------------------------------------------- 06040002
060500 2100-CHECK-FUNCTION-KEY.                                         06050002
060600     EVALUATE TRUE                                                06060002
060700         WHEN DP020-SRC-AID = DP016-ENTER                         06070002
060701             IF DP020-INT-APPL-FORMAT-IND = '2'                   06070179
060702                 PERFORM 3200-RESET-ATTRIBUTES                    06070241
060703                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             06070399
060704             ELSE                                                 06070441
060705                 IF DP020-INT-APPL-FORMAT-IND = '6'               06070592
060706                     PERFORM 3400-RESET-ATTRIBUTES                06070692
060707                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         06070799
060708                 ELSE                                             06070892
060710                     PERFORM 3300-RESET-ATTRIBUTES                06071092
060711                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         06071199
060720                 END-IF                                           06072092
060730             END-IF                                               06073092
060900         WHEN DP020-SRC-AID = DP016-PF18                          06090002
061000              PERFORM 4500-MOVE-ASC-TO-ACA-AREA                   06100093
061001              PERFORM 4600-SUBMIT-JOB                             06100193
061010         WHEN OTHER                                               06101002
061020             SET DP013-NO-ROLLBACK                                06102002
061030                 DP013-XCTL-DISPLAY-RESTART                       06103002
061040                 DP013-CICS-ABEND  TO TRUE                        06104002
061050             MOVE '2100-CHECK-FUNCTION-KEY'                       06105002
061060                                   TO DP013-PARAGRAPH             06106002
061070             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      06107002
061080                                   TO DP013-MESSAGE-TEXT (1)      06108002
061090             PERFORM DP013-0000-PROCESS-ABEND                     06109002
061100     END-EVALUATE.                                                06110002
061200                                                                  06120002
061400*----------------------------------------------------------------*06140002
061500* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS IN*06150002
061600* THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN THE  *06160025
061700* APPLICATION-SPECIFIC COMMAREA, NOT ON THE SCREEN.              *06170025
061800*----------------------------------------------------------------*06180002
061900 2200-MOVE-SCREEN-TO-COMMAREA.                                    06190025
062102                                                                  06210246
062110     IF  AOPERL > ZERO                                            06211046
062200         MOVE AOPERI               TO ASC-OPER-UNT-ID             06220002
062300     ELSE                                                         06230002
062400         IF  AOPERF = DP015-ERASE-EOF                             06240002
062520             MOVE  SPACES          TO ASC-OPER-DESC               06252036
062530                                      ASC-OPER-UNT-ID             06253042
062600         END-IF                                                   06260002
062700     END-IF.                                                      06270002
062800                                                                  06280002
062900     IF  ASEL1L  > ZERO                                           06290002
063000         MOVE ASEL1I               TO ASC-BY-SHIFT                06300002
063100     ELSE                                                         06310002
063200         IF  ASEL1F  = DP015-ERASE-EOF                            06320002
063300             MOVE SPACE            TO ASC-BY-SHIFT                06330002
063310                                      ASEL1O                      06331060
063400         END-IF                                                   06340002
063500     END-IF.                                                      06350002
063600                                                                  06360002
063610     IF  ASEL2L  > ZERO                                           06361002
063620         MOVE ASEL2I               TO ASC-BY-PERIOD               06362002
063630     ELSE                                                         06363002
063640         IF  ASEL2F  = DP015-ERASE-EOF                            06364002
063650             MOVE SPACE            TO ASC-BY-PERIOD               06365002
063651                                      ASEL2O                      06365160
063660         END-IF                                                   06366002
063670     END-IF.                                                      06367002
063680                                                                  06368002
063700     IF  ASEL3L > ZERO                                            06370002
063800         MOVE ASEL3I               TO ASC-TO-RDS                  06380002
063900     ELSE                                                         06390002
064000         IF  ASEL3F = DP015-ERASE-EOF                             06400002
064100             MOVE SPACE            TO ASC-TO-RDS                  06410002
064110                                      ASEL3O                      06411060
064200         END-IF                                                   06420002
064300     END-IF.                                                      06430002
064400                                                                  06440002
064500     IF  ASEL4L > ZERO                                            06450002
064600         MOVE ASEL4I               TO ASC-TO-REMOTE               06460002
064700     ELSE                                                         06470002
064800         IF  ASEL4F = DP015-ERASE-EOF                             06480002
064900             MOVE SPACE            TO ASC-TO-REMOTE               06490002
064910                                      ASEL4O                      06491060
065000         END-IF                                                   06500002
065100     END-IF.                                                      06510002
065200                                                                  06520002
065300     IF  ASEL5L > ZERO                                            06530092
065400         MOVE ASEL5I               TO ASC-BY-CO                   06540092
065500     ELSE                                                         06550092
065600         IF  ASEL5F = DP015-ERASE-EOF                             06560092
065700             MOVE SPACE            TO ASC-BY-CO                   06570092
065800                                      ASEL5O                      06580092
065900         END-IF                                                   06590092
066000     END-IF.                                                      06600092
066010                                                                  06601092
066020     IF  ASEL6L > ZERO                                            06602092
066030         MOVE ASEL6I               TO ASC-BY-DC                   06603092
066040     ELSE                                                         06604092
066050         IF  ASEL6F = DP015-ERASE-EOF                             06605092
066060             MOVE SPACE            TO ASC-BY-DC                   06606092
066070                                      ASEL6O                      06607092
066080         END-IF                                                   06608092
066090     END-IF.                                                      06609092
066091                                                                  06609192
066100     IF  APRTRL  > ZERO                                           06610002
066200         MOVE APRTRI               TO ASC-PRINTER-ID              06620002
066300     ELSE                                                         06630002
066400         IF  APRTRF  = DP015-ERASE-EOF                            06640002
066500             MOVE SPACE            TO ASC-PRINTER-ID              06650002
066600         END-IF                                                   06660002
066700     END-IF.                                                      06670002
066800                                                                  06680002
067100*----------------------------------------------------------------*06710002
067200* ENSURE THE DATA IS CORRECT.                                     06720002
067600*----------------------------------------------------------------*06760002
067700 3000-EDIT-DATA-IN-COMMAREA.                                      06770025
067800                                                                  06780002
067900     IF DP020-INT-APPL-FORMAT-IND = '2'                           06790079
068000         PERFORM 3200-RESET-ATTRIBUTES                            06800055
068100     ELSE                                                         06810055
068101         IF DP020-INT-APPL-FORMAT-IND = '6'                       06810192
068102             PERFORM 3400-RESET-ATTRIBUTES                        06810292
068103         ELSE                                                     06810392
068110             PERFORM 3300-RESET-ATTRIBUTES                        06811092
068120         END-IF                                                   06812092
068121     END-IF.                                                      06812192
068130                                                                  06813055
068200*** VALIDATE OPERATING UNIT ID IS NUMERIC                         06820027
068300*                                                                 06830002
068400     IF ASC-OPER-UNT-ID > SPACES AND                              06840035
068410              ASC-OPER-UNT-ID-N NOT = 9999                        06841032
068500         MOVE ASC-OPER-UNT-ID      TO DP010I-UNEDITED-FIELD       06850002
068600         MOVE LENGTH OF ASC-OPER-UNT-ID  TO DP010I-MAXIMUM-DIGITS 06860002
068700         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     06870002
068800         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  06880002
068910         CALL DP010I-NUMERIC-EDIT-ROUTINE                         06891099
068920                         USING DP010I-NUMERIC-EDIT-AREA           06892099
069000         IF  DP010I-ERROR-DETECTED                                06900002
069100             SET PS-EDIT-ERROR                                    06910002
069200                 DP020-MSG-FATAL   TO TRUE                        06920002
069300             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            06930002
069400             MOVE DP015-UNP-ALP-BRT-OFF TO AOPERA                 06940002
069600             MOVE DP015-RED             TO AOPERC                 06960002
069700             MOVE DP015-REVERSE         TO AOPERH                 06970002
069800             MOVE -1                    TO AOPERL                 06980002
069900             MOVE SPACES                TO ASC-OPER-DESC          06990002
070000             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  07000002
070100         ELSE                                                     07010002
070200             MOVE DP010I-NUMERIC-FIELD TO ASC-OPER-UNT-ID-N       07020002
070400                                          DK-OPER-UNT-ID          07040002
070500             MOVE ASC-OPER-UNT-ID      TO AOPERO                  07050032
071500         END-IF                                                   07150032
071501     ELSE                                                         07150136
071502         MOVE SPACES   TO ASC-OPER-DESC                           07150236
071503                          ANAMEO                                  07150337
071510     END-IF.                                                      07151032
071600                                                                  07160002
075200     IF  PS-NO-EDIT-ERROR                                         07520002
075300         IF  ASC-OPER-UNT-ID-N > ZEROES AND                       07530032
075400                 ASC-OPER-UNT-ID-N NOT = 9999                     07540032
075600             MOVE ASC-OPER-UNT-ID      TO DK-STORE-NMBR           07560002
075700             PERFORM 3500-VALIDATE-OPER-UNT-ID                    07570096
075800             IF  PS-EDIT-ERROR                                    07580002
075900                 SET DP020-MSG-FATAL         TO TRUE              07590002
076000                 MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER  07600002
076100                 MOVE DP015-UNP-ALP-BRT-OFF  TO AOPERA            07610002
076300                 MOVE DP015-RED              TO AOPERC            07630002
076400                 MOVE DP015-REVERSE          TO AOPERH            07640002
076500                 MOVE -1                     TO AOPERL            07650002
076600                 MOVE SPACES                 TO ASC-OPER-DESC     07660002
076700                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              07670002
078500             ELSE                                                 07850062
078510                 MOVE ASC-OPER-DESC         TO ANAMEO             07851062
078520             END-IF                                               07852062
078600         ELSE                                                     07860034
078602             MOVE SPACES               TO ASC-OPER-DESC           07860234
078610         END-IF                                                   07861034
078700     END-IF.                                                      07870002
078800                                                                  07880002
082700*** MAKE SURE ONE REPORT IS SELECTED                              08270040
082800     IF  PS-NO-EDIT-ERROR                                         08280029
082900         IF DP020-INT-APPL-FORMAT-IND = '6'                       08290092
083000             IF  ASC-BY-CO  = SPACE  AND ASC-BY-DC  = SPACE       08300092
083300                 SET PS-EDIT-ERROR                                08330092
083400                     DP020-MSG-FATAL   TO TRUE                    08340092
083500                 MOVE PC-TSYMSG-00397  TO DP020-MSG-NUMBER        08350092
083600                 MOVE DP015-UNP-ALP-BRT-MDT TO ASEL5A             08360092
083700                                               ASEL6A             08370092
083800                 MOVE DP015-RED             TO ASEL5C             08380092
083810                                               ASEL6C             08381092
083900                 MOVE DP015-REVERSE         TO ASEL5H             08390092
083910                                               ASEL6H             08391092
084000                 MOVE -1                    TO ASEL5L             08400092
084200                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              08420092
084300             END-IF                                               08430092
084301         ELSE                                                     08430192
084302             IF  ASC-BY-SHIFT = SPACE  AND ASC-BY-PERIOD  = SPACE 08430292
084304                 SET PS-EDIT-ERROR                                08430492
084305                     DP020-MSG-FATAL   TO TRUE                    08430592
084306                 MOVE PC-TSYMSG-00397  TO DP020-MSG-NUMBER        08430692
084307                 MOVE DP015-UNP-ALP-BRT-MDT TO ASEL1A             08430792
084308                                               ASEL2A             08430892
084309                 MOVE DP015-RED             TO ASEL1C             08430992
084310                                               ASEL2C             08431092
084311                 MOVE DP015-REVERSE         TO ASEL1H             08431192
084312                                               ASEL2H             08431292
084313                 MOVE -1                    TO ASEL1L             08431392
084314                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              08431492
084315             END-IF                                               08431599
084316         END-IF                                                   08431699
084320     END-IF.                                                      08432092
084400                                                                  08440002
084410*** MAKE SURE ONLY ONE REPORT IS SELECTED                         08441040
084420     IF  PS-NO-EDIT-ERROR                                         08442040
084421         IF DP020-INT-APPL-FORMAT-IND = '6'                       08442192
084422             IF  ASC-BY-CO  = PC-S   AND ASC-BY-DC  = PC-S        08442294
084450                 SET PS-EDIT-ERROR                                08445040
084460                     DP020-MSG-FATAL   TO TRUE                    08446040
084470                 MOVE PC-TSYMSG-02665  TO DP020-MSG-NUMBER        08447040
084480                 MOVE DP015-UNP-ALP-BRT-MDT TO ASEL5A             08448092
084490                                               ASEL6A             08449092
084491                 MOVE DP015-RED             TO ASEL5C             08449192
084492                                               ASEL6C             08449292
084493                 MOVE DP015-REVERSE         TO ASEL5H             08449392
084494                                               ASEL6H             08449492
084495                 MOVE -1                    TO ASEL5L             08449599
084503                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              08450343
084504             END-IF                                               08450492
084505         ELSE                                                     08450592
084506             IF  ASC-BY-SHIFT = PC-S   AND ASC-BY-PERIOD = PC-S   08450692
084507                     SET PS-EDIT-ERROR                            08450792
084508                         DP020-MSG-FATAL   TO TRUE                08450892
084509                     MOVE PC-TSYMSG-02665  TO DP020-MSG-NUMBER    08450992
084510                     MOVE DP015-RED             TO ASEL1C         08451092
084511                                                   ASEL2C         08451192
084512                     MOVE DP015-REVERSE         TO ASEL1H         08451292
084513                                                   ASEL2H         08451392
084514                     IF DP020-INT-APPL-FORMAT-IND = '2'           08451492
084515                         MOVE -1                    TO ASEL1L     08451592
084516                         MOVE DP015-UNP-ALP-NOR-MDT TO ASEL1A     08451692
084517                     ELSE                                         08451792
084518                         MOVE -1                    TO ASEL2L     08451892
084519                         MOVE DP015-PRO-NOR-MDT     TO ASEL1A     08451992
084520                     END-IF                                       08452092
084521                     SET DP030-SET-CURSOR-APPL-1 TO TRUE          08452192
084522             END-IF                                               08452292
084523         END-IF                                                   08452392
084524     END-IF.                                                      08452492
084525                                                                  08452592
084526*** MAKE SURE ONLY ONE PRINTER TYPE IS SELECTED                   08452692
084527     IF  PS-NO-EDIT-ERROR                                         08452792
084528         IF  ASC-TO-RDS = PC-S  AND  ASC-TO-REMOTE = PC-S         08452892
084529                 SET PS-EDIT-ERROR                                08452992
084530                     DP020-MSG-FATAL   TO TRUE                    08453092
084531                 MOVE PC-TSYMSG-02665  TO DP020-MSG-NUMBER        08453192
084532                 MOVE DP015-UNP-ALP-BRT-MDT TO ASEL3A             08453292
084533                                               ASEL4A             08453392
084534                 MOVE DP015-RED             TO ASEL3C             08453492
084535                                               ASEL4C             08453592
084536                 MOVE DP015-REVERSE         TO ASEL3H             08453692
084537                                               ASEL4H             08453792
084538                 MOVE -1                    TO ASEL3L             08453892
084539                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              08453992
084540         END-IF                                                   08454092
084541     END-IF.                                                      08454192
084542                                                                  08454292
084543*** MAKE SURE A PRINTER IS SELECTED                               08454392
084550     IF  PS-NO-EDIT-ERROR                                         08455092
084600         IF  ASC-TO-RDS     = SPACE  AND                          08460061
084700             ASC-TO-REMOTE  = SPACE  AND                          08470061
084800             ASC-PRINTER-ID = SPACE                               08480055
084900                 SET PS-EDIT-ERROR                                08490029
085000                     DP020-MSG-FATAL   TO TRUE                    08500029
085100                 MOVE PC-TSYMSG-02887  TO DP020-MSG-NUMBER        08510029
085200                 MOVE DP015-UNP-ALP-BRT-MDT TO ASEL3A             08520063
085300                                               ASEL4A             08530053
085400                 MOVE DP015-RED             TO ASEL3C             08540029
085500                                               ASEL4C             08550053
085600                 MOVE DP015-REVERSE         TO ASEL3H             08560029
085700                                               ASEL4H             08570053
085800                 MOVE -1                    TO ASEL3L             08580029
085900                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              08590029
086000         END-IF                                                   08600029
086010     END-IF.                                                      08601029
086100                                                                  08610027
086200*** IF GOING TO RDS MAKE SURE THAT THERE IS NO REMOTE PRINTER ID  08620053
086300     IF  PS-NO-EDIT-ERROR                                         08630053
086400         IF  ASC-TO-RDS     = PC-S   AND  ASC-PRINTER-ID > SPACES 08640053
086600                 SET PS-EDIT-ERROR                                08660053
086700                     DP020-MSG-FATAL   TO TRUE                    08670053
086800                 MOVE PC-TSYMSG-02887  TO DP020-MSG-NUMBER        08680053
086900                 MOVE DP015-UNP-ALP-BRT-MDT TO ASEL3A             08690053
087000                                               APRTRA             08700053
087100                 MOVE DP015-RED             TO ASEL3C             08710053
087200                                               APRTRC             08720053
087300                 MOVE DP015-REVERSE         TO ASEL3H             08730053
087400                                               APRTRH             08740053
087500                 MOVE -1                    TO ASEL3L             08750053
087600                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              08760053
087700         END-IF                                                   08770053
087800     END-IF.                                                      08780053
087900                                                                  08790053
089100*** IF GOING TO A REMOTE PRINTER - PRINTER ID MUST BE FILLED IN.  08910053
089310     IF  PS-NO-EDIT-ERROR                                         08931029
089400         IF ASC-PRINTER-ID  = SPACE AND ASC-TO-REMOTE = PC-S      08940053
089600             SET PS-EDIT-ERROR                                    08960029
089700                 DP020-MSG-FATAL   TO TRUE                        08970029
089800             MOVE PC-TSYMSG-01563  TO DP020-MSG-NUMBER            08980029
089900             MOVE DP015-UNP-ALP-BRT-MDT TO APRTRA                 08990029
090100             MOVE DP015-RED             TO APRTRC                 09010029
090200             MOVE DP015-REVERSE         TO APRTRH                 09020029
090300             MOVE -1                    TO APRTRL                 09030029
090500             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  09050029
090600         END-IF                                                   09060029
090610     END-IF.                                                      09061029
090700                                                                  09070002
091000*** VALIDATE PRINTER ID                                           09100002
091200*                                                                 09120002
091210     IF  PS-NO-EDIT-ERROR                                         09121029
091300         IF   ASC-PRINTER-ID > SPACES                             09130029
091500              PERFORM 3600-VALIDATE-PRINTER                       09150029
091600              IF DP072-PRTR-PRTR-TRK-STAT-CDE  EQUAL 'A'          09160029
091700                  CONTINUE                                        09170090
091800              ELSE                                                09180029
091900                 SET PS-EDIT-ERROR                                09190029
092000                     DP020-MSG-FATAL TO TRUE                      09200029
092200                 MOVE PC-TSYMSG-00746 TO DP020-MSG-NUMBER         09220029
092400                 MOVE DP015-UNP-ALP-BRT-MDT  TO APRTRA            09240029
092700                 MOVE DP015-RED              TO APRTRC            09270029
092800                 MOVE DP015-REVERSE          TO APRTRH            09280029
093000                 MOVE -1                     TO APRTRL            09300029
093200                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              09320029
093400              END-IF                                              09340029
093500         END-IF                                                   09350029
093510     END-IF.                                                      09351029
093600                                                                  09360002
097600*---------------------------------------------------------------- 09760002
097700** MOVE THE DEFAULT ATTRIBUTES TO ALL OF THE OPEN FIELDS ON THE **09770002
097800** MAP.                                                         **09780002
097900*---------------------------------------------------------------- 09790002
098000 3200-RESET-ATTRIBUTES.                                           09800002
098100                                                                  09810002
098400     MOVE DP015-UNP-ALP-NOR-OFF    TO AOPERA                      09840002
098500                                      ASEL1A                      09850002
098600                                      ASEL2A                      09860002
098700                                      ASEL3A                      09870002
098710                                      ASEL4A                      09871002
098720                                      APRTRA.                     09872002
098730     MOVE DP015-PRO-NOR-OFF        TO ASEL5A                      09873092
098750                                      ASEL6A.                     09875092
098800     MOVE DP015-UNDERLINE          TO AOPERH                      09880002
098900                                      ASEL1H                      09890002
099000                                      ASEL2H                      09900002
099100                                      ASEL3H                      09910002
099200                                      ASEL4H                      09920002
099300                                      APRTRH.                     09930002
099310     MOVE DP015-HL-OFF             TO ASEL5H                      09931092
099330                                      ASEL6H.                     09933092
099400      MOVE DP015-GREEN             TO AOPERC                      09940002
099500                                      ASEL1C                      09950002
099600                                      ASEL2C                      09960002
099700                                      ASEL3C                      09970002
099800                                      ASEL4C                      09980002
099900                                      APRTRC.                     09990002
100000                                                                  10000002
100120*---------------------------------------------------------------- 10012041
100130** MOVE THESE ATTRIBUTES TO THE OPEN FIELDS ON THE MAP.           10013041
100150*---------------------------------------------------------------- 10015041
100160 3300-RESET-ATTRIBUTES.                                           10016041
100170                                                                  10017041
100180     MOVE DP015-UNP-ALP-NOR-OFF    TO AOPERA                      10018041
100192                                      ASEL3A                      10019241
100193                                      ASEL4A                      10019341
100194                                      APRTRA.                     10019441
100195     MOVE DP015-PRO-NOR-OFF        TO ASEL1A                      10019550
100196                                      ASEL2A                      10019694
100197                                      ASEL5A                      10019794
100198                                      ASEL6A.                     10019892
100199     MOVE DP015-UNDERLINE          TO AOPERH                      10019992
100200                                      ASEL3H                      10020041
100201                                      ASEL4H                      10020141
100202                                      APRTRH.                     10020241
100203     MOVE DP015-HL-OFF             TO ASEL1H                      10020350
100204                                      ASEL2H                      10020494
100205                                      ASEL5H                      10020594
100206                                      ASEL6H.                     10020692
100207     MOVE DP015-GREEN              TO AOPERC                      10020792
100208                                      ASEL3C                      10020841
100209                                      ASEL4C                      10020941
100210                                      APRTRC.                     10021041
100211     MOVE DP015-BLUE               TO ASEL1C.                     10021141
100213                                                                  10021341
100214      MOVE 'S'                     TO ASEL1O                      10021473
100215                                      ASC-BY-SHIFT.               10021573
100216                                                                  10021673
100217*---------------------------------------------------------------- 10021792
100218** MOVE THESE ATTRIBUTES TO THE OPEN FIELDS ON THE MAP.           10021892
100219*---------------------------------------------------------------- 10021992
100220 3400-RESET-ATTRIBUTES.                                           10022092
100221                                                                  10022192
100222     MOVE DP015-UNP-ALP-NOR-OFF    TO ASEL3A                      10022292
100225                                      ASEL4A                      10022592
100226                                      APRTRA.                     10022692
100227     MOVE DP015-UNDERLINE          TO ASEL3H                      10022792
100228                                      ASEL4H                      10022892
100229                                      APRTRH.                     10022992
100230     MOVE DP015-GREEN              TO ASEL3C                      10023092
100231                                      ASEL4C                      10023192
100232                                      APRTRC.                     10023292
100233     MOVE +1                       TO AOPERL.                     10023399
100240     IF ASC-OPER-UNT-ID > ZEROES                                  10024098
100241         MOVE DP015-HL-OFF             TO AOPERH                  10024192
100242                                          ASEL1H                  10024292
100243                                          ASEL2H                  10024392
100244                                          ASEL5H                  10024492
100245                                          ASEL6H                  10024592
100246         MOVE DP015-PRO-NOR-OFF        TO AOPERA                  10024692
100247                                          ASEL1A                  10024792
100248                                          ASEL2A                  10024892
100249                                          ASEL5A                  10024992
100250                                          ASEL6A                  10025092
100251         MOVE DP015-BLUE               TO ASEL6C                  10025196
100252         MOVE 'S'                      TO ASEL6O                  10025299
100254                                          ASC-BY-DC               10025492
100255         MOVE -1                       TO ASEL3L                  10025599
100256     ELSE                                                         10025692
100257         MOVE DP015-HL-OFF             TO AOPERH                  10025799
100258                                          ASEL1H                  10025899
100259                                          ASEL2H                  10025999
100260         MOVE DP015-UNDERLINE          TO ASEL5H                  10026092
100261                                          ASEL6H                  10026192
100262         MOVE DP015-PRO-NOR-OFF        TO AOPERA                  10026292
100263                                          ASEL1A                  10026392
100264                                          ASEL2A                  10026492
100265         MOVE DP015-UNP-ALP-NOR-OFF    TO ASEL5A                  10026592
100266                                          ASEL6A                  10026692
100267         MOVE DP015-GREEN              TO ASEL5C                  10026792
100268                                          ASEL6C                  10026892
100269         MOVE -1                       TO ASEL5L                  10026999
100271     END-IF.                                                      10027192
100272     SET DP030-SET-CURSOR-APPL-1       TO TRUE.                   10027299
100273                                                                  10027392
100280*----------------------------------------------------------------*10028092
100300*  VALIDATE THE OPERATING UNIT ID TO MAKE SURE THAT IT IS A      *10030002
100400*  VALID DISTRIBUTION CENTER.                                    *10040002
100500*----------------------------------------------------------------*10050002
100600 3500-VALIDATE-OPER-UNT-ID.                                       10060096
101600         EXEC SQL                                                 10160002
101700            SELECT LOC_NBR                                        10170099
101710                  ,LOC_NM                                         10171099
101800              INTO :XLT00010-LOC-NBR                              10180099
101810                  ,:XLT00010-LOC-NM                               10181099
101900              FROM XLT_LOC                                        10190099
102110             WHERE   LOC_NBR      = :DK-OPER-UNT-ID               10211099
102200               AND   LOC_TYP_CDE  = 'DC'                          10220099
102300         END-EXEC                                                 10230002
102400                                                                  10240002
102500         EVALUATE TRUE                                            10250002
102600             WHEN SQLCODE = -904                                  10260002
102700             WHEN SQLCODE = -913                                  10270002
102800                 CONTINUE                                         10280002
102900             WHEN SQLCODE = +100                                  10290002
103000                 SET PS-EDIT-ERROR TO TRUE                        10300002
103100             WHEN SQLCODE = +0                                    10310002
103200                 MOVE XLT00010-LOC-NM    TO ASC-OPER-DESC         10320099
103300             WHEN SQLCODE < +0                                    10330002
103400             WHEN ((SQLCODE > ZERO) AND (SQLCODE NOT = +100))     10340002
103500             WHEN SQLWARN0 NOT = SPACES                           10350002
103600                  MOVE '3500-VALIDATE-OPER-UNT-ID'                10360096
103700                                   TO DP013-PARAGRAPH             10370002
103800                  MOVE 'SELECT OPERATING UNIT ID'                 10380002
103900                                   TO DP013-MESSAGE-TEXT (1)      10390002
104000                  MOVE SQLCA       TO DP013-SQLCA                 10400002
104100                  MOVE 'XLT_LOC '  TO DP013-DB2-TABLE-NAME (1)    10410099
104200                  SET DP013-DB2-ABEND                             10420002
104300                      DP013-XCTL-DISPLAY-RESTART                  10430002
104400                                   TO TRUE                        10440002
104500                  PERFORM DP013-0000-PROCESS-ABEND                10450002
104600         END-EVALUATE.                                            10460006
104800                                                                  10480002
113100*-----------------------------------------------------------------11310002
113200*  3600-VALIDATE-PRINTER.                                         11320002
113300*      CALLS SPKCS060 TO VALIDATE THE PRINTER ID                  11330002
113400*-----------------------------------------------------------------11340002
113500 3600-VALIDATE-PRINTER.                                           11350002
113600     MOVE ASC-PRINTER-ID             TO DP072-PRINTER-ID.         11360002
113700                                                                  11370002
113800     MOVE PC-REPORT-PGM              TO DP072-RPT-PGM-NME.        11380002
113900     MOVE PC-01                      TO DP072-RPT-PGM-TYP-ID.     11390002
114000     MOVE DP020-LOCATION-NBR         TO DP072-ORIGIN-OPER-UNT-ID. 11400099
114010     IF ASC-OPER-UNT-ID-N = 9999 OR ASC-OPER-UNT-ID = SPACES      11401041
114020         MOVE DP020-LOCATION-NBR     TO DP072-OPER-UNT-ID         11402099
114030     ELSE                                                         11403032
114100         MOVE ASC-OPER-UNT-ID        TO DP072-OPER-UNT-ID         11410032
114110     END-IF.                                                      11411032
114200     MOVE 1                          TO DP072-ORIGIN-FCLTY-ID     11420002
114300                                        DP072-FCLTY-ID.           11430002
114400     SET DP072-VALIDATE              TO TRUE.                     11440002
114500                                                                  11450002
114600     EXEC CICS                                                    11460002
114700          LINK PROGRAM  (PC-PRTR-VALIDATION-PGM)                  11470002
114800               COMMAREA (DP072-COMM-AREA)                         11480002
114900               RESP     (PV-CICS-RESPONSE)                        11490002
115000     END-EXEC                                                     11500002
115100                                                                  11510002
115200     EVALUATE TRUE                                                11520002
115300         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 11530002
115400             CONTINUE                                             11540002
115500         WHEN OTHER                                               11550002
115600             MOVE '3600-VALIDATE-PRINTER' TO DP013-PARAGRAPH      11560009
115800             MOVE PV-CICS-RESPONSE TO DP013-MESSAGE-TEXT(1)       11580002
116000             SET DP013-LINK-RETURN                                11600002
116100                 DP013-CICS-ABEND                                 11610002
116200                 DP013-NO-ROLLBACK TO TRUE                        11620002
116300             PERFORM DP013-0000-PROCESS-ABEND                     11630002
116400     END-EVALUATE.                                                11640002
116500                                                                  11650002
116700*----------------------------------------------------------------*11670002
116800*  POSITION THE CURSOR AT THE APPROPRIATE FIELD.                 *11680002
116900*  IF THERE IS ANY DATA TO MOVE TO THE SCREEN ON INITIAL, MOVE   *11690002
117000*  IT HERE.                                                      *11700002
117100*----------------------------------------------------------------*11710002
117200 4000-BUILD-INITIAL-PANEL.                                        11720002
117300                                                                  11730002
117400     SET DP030-SET-CURSOR-APPL-1   TO TRUE                        11740002
117500     MOVE -1                       TO AOPERL.                     11750002
117600                                                                  11760002
117700     IF  ASC-OPER-UNT-ID-N > ZEROES                               11770022
117710         MOVE ASC-OPER-UNT-ID-N    TO AOPERO                      11771066
117800                                      DK-OPER-UNT-ID              11780066
118200         PERFORM 4010-GET-FCLTY-NAME                              11820022
118440     ELSE                                                         11844093
118450         MOVE SPACES TO ASC-OPER-DESC                             11845093
118460     END-IF.                                                      11846093
118495                                                                  11849566
118502     PERFORM 5000-FIND-TITLE-INFO.                                11850266
118510*                                                                 11851002
118600*----------------------------------------------------------------*11860002
118700*    GET THE FACILITY NAME                                       *11870002
118800*----------------------------------------------------------------*11880002
118900 4010-GET-FCLTY-NAME.                                             11890002
119000                                                                  11900002
119900         EXEC SQL                                                 11990002
120000              SELECT LOC_NM                                       12000099
120100                INTO :XLT00010-LOC-NM                             12010099
120200                FROM XLT_LOC                                      12020099
120300               WHERE LOC_NBR  = :DK-OPER-UNT-ID                   12030099
120500         END-EXEC                                                 12050002
120600                                                                  12060002
120700         EVALUATE TRUE                                            12070002
120800             WHEN SQLCODE = +0                                    12080002
120900                  MOVE XLT00010-LOC-NM    TO ASC-OPER-DESC        12090099
121200             WHEN SQLCODE = +100                                  12120002
121300                  MOVE SPACES     TO ASC-OPER-DESC                12130006
121500             WHEN SQLCODE = -904                                  12150002
121600             WHEN SQLCODE = -913                                  12160002
121700                  CONTINUE                                        12170002
121900             WHEN SQLWARN0 NOT = SPACES                           12190002
122000             WHEN SQLCODE < +0                                    12200002
122100             WHEN SQLCODE > +0                                    12210002
122200                  MOVE '4010-GET-FCLTY-NAME'                      12220002
122300                                  TO DP013-PARAGRAPH              12230002
122400                  MOVE 'UNSUCCESSFUL SELECT ON FACILITY TABLE'    12240002
122500                                  TO DP013-MESSAGE-TEXT (1)       12250002
122600                  MOVE SQLCA      TO DP013-SQLCA                  12260002
122700                  MOVE 'XLT_LOC ' TO DP013-DB2-TABLE-NAME (1)     12270099
122800                  SET DP013-DB2-ABEND                             12280002
122900                      DP013-XCTL-DISPLAY-RESTART                  12290002
123000                                  TO TRUE                         12300002
123100                  PERFORM DP013-0000-PROCESS-ABEND                12310002
123200         END-EVALUATE.                                            12320002
123400                                                                  12340002
124900*----------------------------------------------------------------*12490002
125000*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *12500002
125100*----------------------------------------------------------------*12510002
125200 4400-MOVE-COMMAREA-TO-SCREEN.                                    12520006
125300                                                                  12530002
125310     MOVE ASC-OPER-UNT-ID-N        TO AOPERO.                     12531066
127100     MOVE ASC-OPER-DESC            TO ANAMEO.                     12710002
127300     MOVE ASC-DISPLAY-REPORT       TO AREPORTO.                   12730007
127600     MOVE ASC-DISPLAY-TITLE1       TO ATITLE1O.                   12760007
127610     MOVE ASC-DISPLAY-TITLE2       TO ATITLE2O.                   12761007
127620     MOVE ASC-PRINTER-ID           TO APRTRO.                     12762054
128600                                                                  12860002
128700*----------------------------------------------------------------*12870093
128800*    MOVE DATA TO THE OUTPUT AREA.                               *12880093
128900*----------------------------------------------------------------*12890093
128910 4500-MOVE-ASC-TO-ACA-AREA.                                       12891093
128920                                                                  12892093
128930     IF ASC-OPER-UNT-ID-N > ZEROES                                12893093
128940         MOVE ASC-OPER-UNT-ID-N    TO ACA-OPER-UNIT-ID-N          12894094
128941     ELSE                                                         12894193
128942         IF ASC-BY-DC = PC-S                                      12894295
128943             MOVE ZEROES           TO ACA-OPER-UNIT-ID-N          12894394
128944         ELSE                                                     12894493
128945             MOVE 9999             TO ACA-OPER-UNIT-ID-N          12894594
128946         END-IF                                                   12894693
128947     END-IF.                                                      12894793
128948     EXEC SQL                                                     12894893
128949         SET :PV-CURR-TMST = CURRENT_TIMESTAMP                    12894993
128950     END-EXEC.                                                    12895093
128951                                                                  12895193
128952     MOVE PV-CURR-DATE             TO ACA-REQUEST-DATE.           12895293
128953     MOVE PV-CURR-TIME             TO ACA-REQUEST-TIME.           12895393
128954     EVALUATE ACA-REPORT-CONTENT                                  12895493
128955         WHEN PC-A                                                12895593
128956             IF  ACA-REPORT-PREV = PC-Y                           12895699
128957                 MOVE  PC-STATUS-REPORT-PROC2 TO PV-JOB-PROC      12895799
128958                 MOVE  PC-STATUS-REPORT-JOB2  TO PV-JOB-NAME      12895899
128959                 MOVE 'UNTS WRKD RPT 14'   TO PV-JOB-DESCRIPTION  12895999
128960             ELSE                                                 12896099
128961                 MOVE  PC-STATUS-REPORT-PROC1 TO PV-JOB-PROC      12896199
128962                 MOVE  PC-STATUS-REPORT-JOB1  TO PV-JOB-NAME      12896299
128963                 MOVE 'UNTS WRKD RPT 11'   TO PV-JOB-DESCRIPTION  12896399
128964             END-IF                                               12896499
128965         WHEN PC-B                                                12896593
128966             MOVE  PC-STATUS-REPORT-PROC1 TO PV-JOB-PROC          12896699
128967             MOVE  PC-STATUS-REPORT-JOB1  TO PV-JOB-NAME          12896799
128968             MOVE 'UNTS WRKD RPT 11'   TO PV-JOB-DESCRIPTION      12896893
128969         WHEN PC-C                                                12896993
128975             MOVE  PC-STATUS-REPORT-PROC1 TO PV-JOB-PROC          12897599
128976             MOVE  PC-STATUS-REPORT-JOB1  TO PV-JOB-NAME          12897699
128977             IF ASC-BY-PERIOD > SPACES                            12897799
128978                 MOVE PC-B             TO ACA-REPORT-CREATE       12897899
128979                                          JL-LINE-8-REPORT-CREATE 12897999
128980                 MOVE 'UNTS WRKD RPT 12' TO PV-JOB-DESCRIPTION    12898099
128981             ELSE                                                 12898199
128982                 MOVE PC-C             TO ACA-REPORT-CREATE       12898299
128983                                          JL-LINE-8-REPORT-CREATE 12898399
128984                 MOVE 'UNTS WRKD RPT 13' TO PV-JOB-DESCRIPTION    12898499
128986             END-IF                                               12898699
128987     END-EVALUATE.                                                12898799
128988     MOVE ASC-PRINTER-ID           TO ACA-PRINTER-ID.             12898899
128990                                                                  12899093
129000*-----------------------------------------------------------      12900002
129100*                                                                 12910002
129200*-----------------------------------------------------------      12920002
129300 4600-SUBMIT-JOB.                                                 12930002
129917                                                                  12991714
129920      EXEC CICS                                                   12992002
130000          ASSIGN                                                  13000002
130100              APPLID(PV-SYSTEM-ID)                                13010002
130200              USERID (PV-USER-ID)                                 13020002
130300      END-EXEC.                                                   13030002
130400                                                                  13040002
130500      PERFORM 4610-ENQUEUE-INTERNAL-READER.                       13050002
130600                                                                  13060002
130700      MOVE '*4600-SUBMIT-JOB            *' TO DP013-PARAGRAPH     13070002
130800                                                                  13080002
130900*-----------------------------------------------------------      13090002
131000* PROD/LEARN JCL SETUP                                            13100002
131100*     //PCK915   JOB KOHLS,'STATUS REPORT',MSGCLASS=P,CLASS=Q     13110087
131200*     //JOBOUT01 OUTPUT FORMS=STD,FCB=8S,DEST=UNNNNNNN            13120002
131300*     //JOBLIB   DD DSN=PKMO.LOADLIB,DISP=SHR                     13130002
131500*     //PS020    EXEC PCK9151                                     13150086
131600*     //S010.SYSUT1 DD *                                          13160002
131700*     TKXXXXX DDDD SSYUNNNNNNN                                    13170002
131800*     //$AUTO    EXEC PGM=$A,COND=(4,LE),PARM='>'                 13180002
131900*     /*EOF                                                       13190002
132000*-----------------------------------------------------------      13200002
132100* TEST JCL SETUP                                                  13210002
132200*     //XXXXXXXQ JOB KOHLS,'STATUS REPORT',MSGCLASS=X,CLASS=E     13220002
132300*     //JOBOUT01 OUTPUT FORMS=STD,FCB=8S,DEST=UNNNNNNN            13230002
132400*     //JOBLIB   DD DSN=TKMA.LOADLIB,DISP=SHR                     13240002
132500*     //PS020    EXEC PCK9151T                                    13250086
132600*     //S010.SYSUT1 DD *                                          13260002
132700*     TKXXXXX DDDD SSYUNNNNNNN                                    13270002
132800*     //$AUTO    EXEC PGM=$A,COND=(4,LE),PARM='>'                 13280002
132900*     /*EOF                                                       13290002
133000*-----------------------------------------------------------      13300002
133100                                                                  13310002
133800      IF PV-PROD-CICS                                             13380002
133910          MOVE PV-JOB-NAME            TO  JL-PROD-JOB-NAME        13391002
134000          MOVE PV-JOB-DESCRIPTION     TO  JL-PROD-JOB-DESC        13400002
134100          MOVE JL-JOB-LINE-PROD       TO  JL-JCL-LINE-1           13410002
134200          MOVE JL-JCL-LINE-1          TO  TD-JCL-LINE             13420002
134300          PERFORM 4620-WRITE-TD-LINE                              13430002
134310          IF  ASC-PRINTER-ID  =  SPACES                           13431085
134320              MOVE 'Y'    TO  ACA-TO-RDS                          13432091
134321              MOVE SPACES TO  ACA-PRINTER-ID                      13432191
134330          ELSE                                                    13433085
134331              MOVE ' '            TO  ACA-TO-RDS                  13433188
134332                                      ASC-TO-RDS                  13433288
134340              MOVE ASC-PRINTER-ID TO  PV-PRINTER-DESTINATION      13434085
134350                                      ACA-PRINTER-ID              13435085
134360          END-IF                                                  13436085
134400          MOVE 'A'                    TO  JL-LINE-3-CLASS         13440002
134500          MOVE PV-PRINTER-DESTINATION TO  JL-LINE-3-PRINTER       13450002
134600          MOVE JL-JCL-LINE-3          TO  TD-JCL-LINE             13460002
134700          PERFORM 4620-WRITE-TD-LINE                              13470002
134800          MOVE JL-JCL-LINE-4-PROD     TO  TD-JCL-LINE             13480002
134900          PERFORM 4620-WRITE-TD-LINE                              13490002
135200          MOVE PV-JOB-PROC            TO  JL-LINE-6-PROC          13520002
135300          MOVE SPACE                  TO  JL-LINE-6-PROC-T        13530002
135400          MOVE JL-JCL-LINE-6          TO  TD-JCL-LINE             13540002
135500          PERFORM 4620-WRITE-TD-LINE                              13550002
135600          MOVE JL-JCL-LINE-7          TO  TD-JCL-LINE             13560002
135700          PERFORM 4620-WRITE-TD-LINE                              13570002
135800      ELSE                                                        13580002
135900          IF PV-TEST-CICS                                         13590070
135901              IF  ASC-PRINTER-ID  =  SPACES                       13590189
135902                  MOVE 'Y'    TO  ACA-TO-RDS                      13590291
135903                  MOVE SPACES TO  ACA-PRINTER-ID                  13590391
135904              ELSE                                                13590489
135905                  MOVE ' '            TO  ACA-TO-RDS              13590589
135906                                          ASC-TO-RDS              13590689
135907                  MOVE ASC-PRINTER-ID TO  PV-PRINTER-DESTINATION  13590789
135908                                          ACA-PRINTER-ID          13590889
135909              END-IF                                              13590989
136000              MOVE DP020-USERID       TO  JL-TEST-JOB-NAME        13600089
136100              MOVE PV-JOB-DESCRIPTION TO  JL-TEST-JOB-DESC        13610089
136200              MOVE JL-JOB-LINE-TEST   TO  JL-JCL-LINE-1           13620089
136300              MOVE JL-JCL-LINE-1      TO  TD-JCL-LINE             13630089
136400              PERFORM 4620-WRITE-TD-LINE                          13640089
136500              MOVE 'A'                    TO  JL-LINE-3-CLASS     13650089
136600              MOVE PV-PRINTER-DESTINATION TO JL-LINE-3-PRINTER    13660089
136700              MOVE JL-JCL-LINE-3          TO  TD-JCL-LINE         13670089
136800              PERFORM 4620-WRITE-TD-LINE                          13680089
136900              MOVE JL-JCL-LINE-4-TEST     TO  TD-JCL-LINE         13690089
137000              PERFORM 4620-WRITE-TD-LINE                          13700089
137100              MOVE PV-JOB-PROC            TO  JL-LINE-6-PROC      13710089
137200              MOVE PC-TEST               TO  JL-LINE-6-PROC-T     13720089
137300              MOVE JL-JCL-LINE-6          TO  TD-JCL-LINE         13730089
137400              PERFORM 4620-WRITE-TD-LINE                          13740089
137500              MOVE JL-JCL-LINE-7          TO  TD-JCL-LINE         13750089
137600              PERFORM 4620-WRITE-TD-LINE                          13760089
137710          ELSE                                                    13771071
137800              IF PV-QA-CICS                                       13780071
137801                  PERFORM 3600-VALIDATE-PRINTER                   13780171
137802                  IF DP072-PRTR-PRTR-TRK-STAT-CDE  EQUAL 'A'      13780271
137803                     MOVE ASC-PRINTER-ID  TO ACA-PRINTER-ID       13780390
137805                                            PV-PRINTER-DESTINATION13780571
137806                                            APRTRO                13780690
137807                  ELSE                                            13780790
137808                      SET PS-EDIT-ERROR                           13780890
137809                          DP020-MSG-FATAL TO TRUE                 13780990
137810                      MOVE PC-TSYMSG-00746 TO DP020-MSG-NUMBER    13781090
137811                      MOVE DP015-UNP-ALP-BRT-MDT  TO APRTRA       13781190
137812                      MOVE DP015-RED              TO APRTRC       13781290
137813                      MOVE DP015-REVERSE          TO APRTRH       13781390
137814                      MOVE -1                     TO APRTRL       13781490
137815                      MOVE SPACES                 TO ASEL3O       13781590
137816                                                     ACA-TO-RDS   13781690
137817                                                     ASC-TO-RDS   13781790
137818                      SET DP030-SET-CURSOR-APPL-1 TO TRUE         13781890
137819                  END-IF                                          13781990
137820                  IF PS-NO-EDIT-ERROR                             13782090
137900                      MOVE DP020-USERID      TO  JL-TEST-JOB-NAME 13790071
138000                      MOVE PV-JOB-DESCRIPTION TO JL-TEST-JOB-DESC 13800071
138100                      MOVE JL-JOB-LINE-TEST   TO JL-JCL-LINE-1    13810071
138200                      MOVE JL-JCL-LINE-1      TO  TD-JCL-LINE     13820071
138300                      PERFORM 4620-WRITE-TD-LINE                  13830071
138400                      MOVE 'A'       TO  JL-LINE-3-CLASS          13840071
138500                      MOVE PV-PRINTER-DESTINATION TO              13850071
138510                                                 JL-LINE-3-PRINTER13851071
138600                      MOVE JL-JCL-LINE-3      TO  TD-JCL-LINE     13860071
138700                      PERFORM 4620-WRITE-TD-LINE                  13870071
138800                      MOVE JL-JCL-LINE-4-TEST TO  TD-JCL-LINE     13880071
138900                      PERFORM 4620-WRITE-TD-LINE                  13890071
139000                      MOVE PV-JOB-PROC         TO  JL-LINE-6-PROC 13900071
139100                      MOVE PC-QA             TO  JL-LINE-6-PROC-T 13910071
139200                      MOVE JL-JCL-LINE-6     TO  TD-JCL-LINE      13920071
139300                      PERFORM 4620-WRITE-TD-LINE                  13930071
139400                      MOVE JL-JCL-LINE-7      TO  TD-JCL-LINE     13940071
139500                      PERFORM 4620-WRITE-TD-LINE                  13950071
139600                  END-IF                                          13960071
139601            ELSE                                                  13960171
139602                  PERFORM 3600-VALIDATE-PRINTER                   13960271
139603                  IF DP072-PRTR-PRTR-TRK-STAT-CDE  EQUAL 'A'      13960371
139604                     MOVE ASC-PRINTER-ID  TO APRTRO               13960471
139605                                             ACA-PRINTER-ID       13960571
139606                                            PV-PRINTER-DESTINATION13960671
139607                  ELSE                                            13960771
139608                      SET PS-EDIT-ERROR                           13960871
139609                          DP020-MSG-FATAL TO TRUE                 13960971
139610                      MOVE PC-TSYMSG-00746 TO DP020-MSG-NUMBER    13961071
139611                      MOVE DP015-UNP-ALP-BRT-MDT  TO APRTRA       13961171
139612                      MOVE DP015-RED              TO APRTRC       13961271
139613                      MOVE DP015-REVERSE          TO APRTRH       13961371
139614                      MOVE -1                     TO APRTRL       13961471
139615                      MOVE SPACES                 TO ASEL3O       13961583
139616                                                     ACA-TO-RDS   13961684
139617                                                     ASC-TO-RDS   13961784
139618                      SET DP030-SET-CURSOR-APPL-1 TO TRUE         13961871
139619                  END-IF                                          13961971
139620                  IF PS-NO-EDIT-ERROR                             13962071
139700                      MOVE DP020-USERID TO JL-TEST-JOB-NAME       13970071
139800                      MOVE PV-JOB-DESCRIPTION TO JL-TEST-JOB-DESC 13980071
139900                      MOVE JL-JOB-LINE-TEST TO JL-JCL-LINE-1      13990071
140000                      MOVE JL-JCL-LINE-1 TO TD-JCL-LINE           14000071
140100                      PERFORM 4620-WRITE-TD-LINE                  14010071
140200                      MOVE 'A'     TO  JL-LINE-3-CLASS            14020071
140300                      MOVE PV-PRINTER-DESTINATION TO              14030071
140310                                          JL-LINE-3-PRINTER       14031071
140400                      MOVE JL-JCL-LINE-3 TO  TD-JCL-LINE          14040071
140500                      PERFORM 4620-WRITE-TD-LINE                  14050071
140600                      MOVE JL-JCL-LINE-4-TEST     TO  TD-JCL-LINE 14060071
140700                      PERFORM 4620-WRITE-TD-LINE                  14070071
140800                      MOVE PV-JOB-PROC     TO  JL-LINE-6-PROC     14080071
140900                      MOVE PC-LEARN     TO  JL-LINE-6-PROC-T      14090072
141000                      MOVE JL-JCL-LINE-6  TO  TD-JCL-LINE         14100071
141100                      PERFORM 4620-WRITE-TD-LINE                  14110071
141200                      MOVE JL-JCL-LINE-7  TO  TD-JCL-LINE         14120071
141300                      PERFORM 4620-WRITE-TD-LINE                  14130071
141310                  END-IF.                                         14131071
141400                                                                  14140002
141410     IF PS-NO-EDIT-ERROR                                          14141074
141500         MOVE DP020-USERID            TO  JL-LINE-8-USER-ID       14150074
141510                                          ACA-USER-ID             14151074
141600         MOVE ACA-OPER-UNIT-ID        TO  JL-LINE-8-OPER-UNT      14160074
141700                                                                  14170002
141800         MOVE ACA-REQUEST-DATE        TO  JL-LINE-8-REQUEST-DATE  14180074
141900         MOVE ACA-REQUEST-TIME        TO  JL-LINE-8-REQUEST-TIME  14190074
142000         MOVE ACA-START-DATE          TO  JL-LINE-8-START-DATE    14200074
142010         MOVE ACA-END-DATE            TO  JL-LINE-8-END-DATE      14201074
142020         MOVE ACA-FISCAL-YYYY         TO  JL-LINE-8-FISCAL-YYYY   14202074
142030         MOVE ACA-FISCAL-MONTH        TO  JL-LINE-8-FISCAL-MONTH  14203074
142040         MOVE ACA-FISCAL-WEEK         TO  JL-LINE-8-FISCAL-WEEK   14204074
142050         MOVE ACA-TO-RDS              TO  JL-LINE-8-TO-RDS        14205074
142200                                                                  14220002
143300         MOVE ACA-PRINTER-ID          TO  JL-LINE-8-PRINTER       14330074
143400         MOVE ACA-REPORT-TYPE         TO  JL-LINE-8-REPORT-TYPE   14340074
143500         MOVE ACA-REPORT-PREV         TO  JL-LINE-8-REPORT-PREV   14350074
143510         MOVE ACA-REPORT-CONTENT     TO  JL-LINE-8-REPORT-CONTENT 14351074
143520         MOVE ACA-REPORT-CREATE       TO  JL-LINE-8-REPORT-CREATE 14352074
143600         MOVE JL-JCL-LINE-8           TO  TD-JCL-LINE             14360074
143700         PERFORM 4620-WRITE-TD-LINE                               14370074
143800                                                                  14380002
144200         MOVE JL-JCL-LINE-EOF             TO  TD-JCL-LINE         14420074
144300         PERFORM 4620-WRITE-TD-LINE                               14430074
144400                                                                  14440002
144500         PERFORM 9800-DEQUEUE-INTERNAL-READER                     14450075
144600                                                                  14460002
144700         MOVE PC-TSYMSG-00458        TO DP020-MSG-NUMBER          14470075
144800                                                                  14480002
144900         SET DP020-MSG-INFORMATIONAL TO TRUE                      14490075
145000     END-IF.                                                      14500074
145200                                                                  14520002
145300*-----------------------------------------------------------      14530002
145400*                                                                 14540002
145500*-----------------------------------------------------------      14550002
145600  4610-ENQUEUE-INTERNAL-READER.                                   14560002
145700      MOVE '*4610-ENQUEUE-INTERNAL-READER.   *' TO DP013-PARAGRAPH14570002
145800      EXEC CICS                                                   14580002
145900          ENQ                                                     14590002
146000              RESOURCE(TD-QUEUE-NAME)                             14600002
146100              LENGTH(TD-QUEUE-NAME-LENGTH)                        14610002
146200              RESP(PV-CICS-RESPONSE)                              14620002
146300      END-EXEC.                                                   14630002
146400                                                                  14640002
146500      IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                   14650002
146600          STRING 'ENQUEUE '            DELIMITED BY SIZE          14660002
146700                 TD-QUEUE-NAME         DELIMITED BY SIZE          14670002
146800                 ' (INTERNAL READER)'  DELIMITED BY SIZE          14680002
146900              INTO DP013-MESSAGE-TEXT(1)                          14690002
147000          PERFORM 9920-CICS-ERROR                                 14700002
147100      END-IF.                                                     14710002
147200                                                                  14720002
147300      SET PS-INTERNAL-READER-ENQUEUED TO TRUE.                    14730002
147400                                                                  14740002
147500                                                                  14750002
147600*-----------------------------------------------------------      14760002
147700*  WRITE A JCL LINE TO THE TRANSIENT DATA QUEUE FOR THE INTERNAL  14770002
147800*  READER.  ON ANY ERROR, DEQUEUE THE INTERNAL READER, DELETE     14780002
147900*  THE TEMPORARY STORAGE QUEUE (TO PREVENT OLD REQUEST            14790002
148000*  INFORMATION FROM ACCIDENTALLY APPEARING ON A FUTURE REQUEST),  14800002
148100*  FORMAT AND DISPLAY AN ERROR MESSAGE, AND RETURN TO NATIVE      14810002
148200*  CICS.                                                          14820002
148300*-----------------------------------------------------------      14830002
148400  4620-WRITE-TD-LINE.                                             14840002
148500      MOVE '*4620-WRITE-TD-LINE.             *' TO DP013-PARAGRAPH14850002
148600      EXEC CICS                                                   14860002
148700          WRITEQ TD                                               14870002
148800              QUEUE(TD-QUEUE-NAME)                                14880002
148900              FROM(TD-JCL-LINE)                                   14890002
149000              LENGTH(TD-JCL-LINE-LENGTH)                          14900002
149100              RESP(PV-CICS-RESPONSE)                              14910002
149200      END-EXEC.                                                   14920002
149300                                                                  14930002
149400      IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                   14940002
149500          STRING 'WRITE TO TRANSIENT DATA QUEUE '                 14950002
149600                                                 DELIMITED BY SIZE14960002
149700                 TD-QUEUE-NAME                   DELIMITED BY SIZE14970002
149800                 ' (INTERNAL READER)'            DELIMITED BY SIZE14980002
149900              INTO DP013-MESSAGE-TEXT(1)                          14990002
150000          PERFORM 9800-DEQUEUE-INTERNAL-READER                    15000002
150100          PERFORM 9920-CICS-ERROR                                 15010002
150200      END-IF.                                                     15020002
150300                                                                  15030002
150400                                                                  15040002
150410*----------------------------------------------------------------*15041002
150420*    FIND DATE INFORMATION FOR SCREEN HEADER FIELDS.              15042002
150430*----------------------------------------------------------------*15043002
150440 5000-FIND-TITLE-INFO.                                            15044002
150450     IF ASC-FISCAL-WEEK > SPACES                                  15045002
150451         MOVE ASC-FISCAL-WEEK    TO DK-FISCAL-WEEK                15045102
150452         MOVE ASC-FSCL-YY        TO ACA-FISCAL-YYYY               15045209
150453         MOVE ASC-FSCL-WW        TO ACA-FISCAL-WEEK               15045309
150454         MOVE PC-C               TO ACA-REPORT-TYPE               15045409
150455         PERFORM 5100-GET-WEEK-INFO                               15045509
150456         MOVE DK-FROM-DATE       TO ACA-START-DATE                15045609
150457         MOVE DK-TO-DATE         TO ACA-END-DATE                  15045709
150458         STRING 'CURRENT.: ' DELIMITED BY SIZE                    15045809
150459                'WTD INCL '  DELIMITED BY SIZE                    15045909
150460                DK-TO-DATE   DELIMITED BY SIZE                    15046009
150461                    INTO ASC-DISPLAY-TITLE1                       15046109
150462         IF DP020-INT-APPL-FORMAT-IND = '6'                       15046279
150464             MOVE DK-FROM-DATE TO PV-KEY-DATE                     15046409
150465             PERFORM 5300-GET-TDTATTR                             15046509
150466             MOVE DTATTR-LY-THIS-DAY-KY-DTE TO DK-PREV-FROM-DATE  15046609
150467             MOVE DK-TO-DATE TO PV-KEY-DATE                       15046709
150468             PERFORM 5300-GET-TDTATTR                             15046809
150469             MOVE DTATTR-LY-THIS-DAY-KY-DTE TO DK-PREV-TO-DATE    15046909
150474             STRING 'PREVIOUS: ' DELIMITED BY SIZE                15047409
150475                    'WTD INCL '  DELIMITED BY SIZE                15047509
150476               DK-PREV-TO-DATE   DELIMITED BY SIZE                15047609
150477                        INTO ASC-DISPLAY-TITLE2                   15047709
150478         END-IF                                                   15047809
150479     ELSE                                                         15047909
150480         IF ASC-FISCAL-MONTH > SPACES                             15048009
150481             MOVE ASC-FISCAL-MONTH   TO DK-FISCAL-MONTH           15048109
150482             MOVE ASC-FSCL-YR        TO ACA-FISCAL-YYYY           15048209
150483             MOVE ASC-FSCL-MM        TO ACA-FISCAL-MONTH          15048310
150484             PERFORM 5200-GET-MONTH-INFO                          15048409
150485             MOVE DK-FROM-DATE       TO ACA-START-DATE            15048509
150486             MOVE DK-TO-DATE         TO ACA-END-DATE              15048609
150487             MOVE PC-B               TO ACA-REPORT-TYPE           15048709
150488             STRING 'CURRENT.: ' DELIMITED BY SIZE                15048809
150489                    'MTD INCL '  DELIMITED BY SIZE                15048909
150490                    DK-TO-DATE   DELIMITED BY SIZE                15049009
150491                        INTO ASC-DISPLAY-TITLE1                   15049109
150492             IF DP020-INT-APPL-FORMAT-IND = '6'                   15049279
150493                 MOVE DK-FROM-DATE TO PV-KEY-DATE                 15049309
150494                 PERFORM 5300-GET-TDTATTR                         15049409
150495                 MOVE DTATTR-LY-THIS-DAY-KY-DTE TO                15049509
150496                                                DK-PREV-FROM-DATE 15049609
150497                 MOVE DK-TO-DATE TO PV-KEY-DATE                   15049709
150498                 PERFORM 5300-GET-TDTATTR                         15049809
150499                 MOVE DTATTR-LY-THIS-DAY-KY-DTE TO                15049909
150500                                                DK-PREV-TO-DATE   15050009
150501                 STRING 'PREVIOUS: ' DELIMITED BY SIZE            15050109
150502                        'MTD INCL '  DELIMITED BY SIZE            15050209
150503                   DK-PREV-TO-DATE   DELIMITED BY SIZE            15050309
150504                            INTO ASC-DISPLAY-TITLE2               15050409
150509             END-IF                                               15050909
150510         ELSE                                                     15051009
150511             IF ASC-FROM-DATE > SPACES                            15051109
150512                 MOVE ASC-FROM-YY        TO DK-FROM-YY            15051209
150513                 MOVE ASC-FROM-MM        TO DK-FROM-MM            15051309
150514                 MOVE ASC-FROM-DD        TO DK-FROM-DD            15051409
150515                 MOVE DK-FROM-DATE-X     TO DK-FROM-DATE          15051509
150516                                            ACA-START-DATE        15051610
150517                 MOVE ASC-TO-YY          TO DK-TO-YY              15051709
150518                 MOVE ASC-TO-MM          TO DK-TO-MM              15051809
150519                 MOVE ASC-TO-DD          TO DK-TO-DD              15051909
150520                 MOVE DK-TO-DATE-X       TO DK-TO-DATE            15052009
150521                                            ACA-END-DATE          15052110
150522                 MOVE PC-D               TO ACA-REPORT-TYPE       15052209
150523                 STRING 'CURRENT.: '  DELIMITED BY SIZE           15052309
150524                        'BUSINESS DATE RANGE: ' DELIMITED BY SIZE 15052409
150525                        DK-FROM-DATE  DELIMITED BY SIZE           15052509
150526                        ' '           DELIMITED BY SIZE           15052609
150527                        'TO '         DELIMITED BY SIZE           15052709
150528                        DK-TO-DATE    DELIMITED BY SIZE           15052809
150529                            INTO ASC-DISPLAY-TITLE1               15052909
150530                 IF DP020-INT-APPL-FORMAT-IND = '6'               15053079
150531                     MOVE DK-FROM-DATE TO PV-KEY-DATE             15053109
150532                     PERFORM 5300-GET-TDTATTR                     15053209
150533                     MOVE DTATTR-LY-THIS-DAY-KY-DTE TO            15053309
150534                                                DK-PREV-FROM-DATE 15053409
150535                     MOVE DK-TO-DATE TO PV-KEY-DATE               15053509
150536                     PERFORM 5300-GET-TDTATTR                     15053609
150537                     MOVE DTATTR-LY-THIS-DAY-KY-DTE TO            15053709
150538                                                DK-PREV-TO-DATE   15053809
150539                     STRING 'PREVIOUS: ' DELIMITED BY SIZE        15053909
150540                        'BUSINESS DATE RANGE: ' DELIMITED BY SIZE 15054009
150541                        DK-PREV-FROM-DATE  DELIMITED BY SIZE      15054109
150542                             ' '           DELIMITED BY SIZE      15054209
150543                             'TO '         DELIMITED BY SIZE      15054309
150544                         DK-PREV-TO-DATE   DELIMITED BY SIZE      15054409
150545                                INTO ASC-DISPLAY-TITLE2           15054509
150546                 END-IF                                           15054609
150547             ELSE                                                 15054709
150548                 MOVE ASC-BUSN-YY        TO DK-FROM-YY            15054809
150549                 MOVE ASC-BUSN-MM        TO DK-FROM-MM            15054909
150550                 MOVE ASC-BUSN-DD        TO DK-FROM-DD            15055009
150551                 MOVE DK-FROM-DATE-X     TO DK-FROM-DATE          15055109
150552                                            ACA-START-DATE        15055209
150553                 MOVE DK-FROM-DATE       TO DK-TO-DATE            15055309
150554                                            ACA-END-DATE          15055409
150555                 MOVE PC-E               TO ACA-REPORT-TYPE       15055509
150556                     STRING 'CURRENT.: '      DELIMITED BY SIZE   15055697
150557                            'BUSINESS DATE: ' DELIMITED BY SIZE   15055797
150558                             DK-TO-DATE       DELIMITED BY SIZE   15055897
150559                                INTO ASC-DISPLAY-TITLE1           15055997
150560                 IF DP020-INT-APPL-FORMAT-IND = '6'               15056097
150561                     MOVE DK-FROM-DATE TO PV-KEY-DATE             15056197
150562                     PERFORM 5300-GET-TDTATTR                     15056297
150563                     MOVE DTATTR-LY-THIS-DAY-KY-DTE TO            15056397
150564                                                DK-PREV-FROM-DATE 15056497
150565                     MOVE DK-TO-DATE TO PV-KEY-DATE               15056597
150566                     PERFORM 5300-GET-TDTATTR                     15056697
150567                     MOVE DTATTR-LY-THIS-DAY-KY-DTE TO            15056797
150568                                                DK-PREV-TO-DATE   15056897
150569                     STRING 'PREVIOUS: ' DELIMITED BY SIZE        15056997
150570                       'BUSINESS DATE: ' DELIMITED BY SIZE        15057097
150571                       DK-PREV-TO-DATE   DELIMITED BY SIZE        15057197
150572                                 INTO ASC-DISPLAY-TITLE2          15057297
150573                 END-IF                                           15057397
150574             END-IF                                               15057497
150575         END-IF                                                   15057597
150576     END-IF.                                                      15057697
150577                                                                  15057797
150578     EVALUATE DP020-INT-APPL-FORMAT-IND                           15057897
150579         WHEN '2'                                                 15057997
150580             MOVE 'UNITS BY OPER FOR SHIFT' TO ASC-DISPLAY-REPORT 15058097
150581             MOVE SPACES                    TO ASC-DISPLAY-TITLE2 15058197
150582             MOVE PC-C                      TO ACA-REPORT-CONTENT 15058297
150584         WHEN '3'                                                 15058409
150585             MOVE 'UNITS BY PROCESS AREA  ' TO ASC-DISPLAY-REPORT 15058509
150586             MOVE SPACES                    TO ASC-DISPLAY-TITLE2 15058609
150587             MOVE PC-A                      TO ACA-REPORT-CONTENT 15058709
150588             MOVE PC-A                      TO ACA-REPORT-CREATE  15058809
150593         WHEN '4'                                                 15059309
150594             MOVE 'UNITS BY PROCESS GROUP ' TO ASC-DISPLAY-REPORT 15059409
150595             MOVE SPACES                    TO ASC-DISPLAY-TITLE2 15059509
150596             MOVE PC-B                      TO ACA-REPORT-CONTENT 15059609
150597             MOVE PC-A                      TO ACA-REPORT-CREATE  15059709
150602         WHEN '6'                                                 15060209
150603             MOVE 'UNITS BY CURR YR/PREV YR' TO ASC-DISPLAY-REPORT15060309
150604             MOVE PC-Y                      TO ACA-REPORT-PREV    15060409
150605             MOVE PC-A                      TO ACA-REPORT-CONTENT 15060599
150606             MOVE PC-D                      TO ACA-REPORT-CREATE  15060693
150607     END-EVALUATE.                                                15060709
150608                                                                  15060809
150609*----------------------------------------------------------------*15060909
150610*   GET WEEK INFORMATION FROM TDTATTR                             15061009
150611*----------------------------------------------------------------*15061109
150612 5100-GET-WEEK-INFO.                                              15061209
150613     EXEC SQL                                                     15061309
150614          SELECT DISTINCT (FSCL_WK_BEG_DTE)                       15061409
150615                 ,FSCL_WK_END_DTE                                 15061509
150616            INTO  :DTATTR-FSCL-WK-BEG-DTE                         15061609
150617                 ,:DTATTR-FSCL-WK-END-DTE                         15061709
150618            FROM  TDTATTR                                         15061809
150619           WHERE  FSCL_YR_NBR   =  :DK-FISCAL-YEAR                15061909
150620             AND  FSCL_WK_NBR   =  :DK-FISCAL-WK                  15062009
150621     END-EXEC.                                                    15062109
150622                                                                  15062209
150623     EVALUATE TRUE                                                15062309
150624         WHEN SQLCODE = +0                                        15062409
150625             MOVE DTATTR-FSCL-WK-BEG-DTE TO  ASC-FROM-DATE        15062509
150626                                             DK-FROM-DATE         15062609
150627             MOVE DTATTR-FSCL-WK-END-DTE TO  ASC-TO-DATE          15062709
150628                                             DK-TO-DATE           15062809
150629         WHEN OTHER                                               15062909
150630             MOVE SPACES                 TO  ASC-FROM-DATE        15063009
150631                                             ASC-TO-DATE          15063109
150632                                             DK-FROM-DATE         15063209
150633                                             DK-TO-DATE           15063309
150634     END-EVALUATE.                                                15063409
150635                                                                  15063509
150636*----------------------------------------------------------------*15063609
150637*   GET MONTH INFORMATION FROM TDTATTR                            15063709
150638*----------------------------------------------------------------*15063809
150639 5200-GET-MONTH-INFO.                                             15063909
150640     EXEC SQL                                                     15064009
150641          SELECT DISTINCT (FSCL_MN_BEG_DTE)                       15064109
150642                 ,FSCL_MN_END_DTE                                 15064209
150643            INTO  :DTATTR-FSCL-MN-BEG-DTE                         15064309
150644                 ,:DTATTR-FSCL-MN-END-DTE                         15064409
150645            FROM  TDTATTR                                         15064509
150646           WHERE  FSCL_YR_NBR   =  :DK-FISCAL-YR                  15064609
150647             AND  FSCL_MN_NBR   =  :DK-FISCAL-MN                  15064709
150648     END-EXEC.                                                    15064809
150649                                                                  15064909
150650     EVALUATE TRUE                                                15065009
150651         WHEN SQLCODE = +0                                        15065109
150652             MOVE DTATTR-FSCL-MN-BEG-DTE TO  ASC-FROM-DATE        15065209
150653                                             DK-FROM-DATE         15065309
150654             MOVE DTATTR-FSCL-MN-END-DTE TO  ASC-TO-DATE          15065409
150655                                             DK-TO-DATE           15065509
150656         WHEN OTHER                                               15065609
150657             MOVE SPACES                 TO  ASC-FROM-DATE        15065709
150658                                             ASC-TO-DATE          15065809
150659                                             DK-FROM-DATE         15065909
150660                                             DK-TO-DATE           15066009
150661     END-EVALUATE.                                                15066109
150662                                                                  15066209
150663*----------------------------------------------------------------*15066309
150664*    RETRIEVE THE PREVIOUS DATE                                   15066409
150665*----------------------------------------------------------------*15066509
150666 5300-GET-TDTATTR.                                                15066609
150667     EXEC SQL                                                     15066709
150668          SELECT  LY_THIS_DAY_KY_DTE                              15066809
150669            INTO :DTATTR-LY-THIS-DAY-KY-DTE                       15066909
150670            FROM TDTATTR                                          15067009
150671          WHERE KY_DTE   =  :PV-KEY-DATE                          15067109
150672      END-EXEC.                                                   15067209
150673                                                                  15067309
150674      EVALUATE TRUE                                               15067409
150675          WHEN SQLCODE = +0                                       15067509
150676              CONTINUE                                            15067609
150677          WHEN SQLCODE = +100                                     15067709
150678              SET PS-EDIT-ERROR                                   15067809
150679                  DP020-MSG-FATAL         TO TRUE                 15067909
150680              MOVE PC-TSYMSG-02416        TO DP020-MSG-NUMBER     15068009
150681          WHEN OTHER                                              15068109
150682              MOVE '5300-GET-TDTATTR   '   TO DP013-PARAGRAPH     15068209
150683              MOVE 'GETTING TDTATTR  ' TO DP013-MESSAGE-TEXT (1)  15068309
150684              MOVE SQLCA   TO DP013-SQLCA                         15068409
150685              MOVE 'TDTATTR ' TO DP013-DB2-TABLE-NAME (1)         15068509
150686              SET DP013-DB2-ABEND                                 15068609
150687                  DP013-XCTL-DISPLAY-RESTART TO TRUE              15068709
150688              PERFORM DP013-0000-PROCESS-ABEND                    15068809
150689      END-EVALUATE.                                               15068909
150690                                                                  15069009
150691*-----------------------------------------------------------      15069109
150692**  ROLL BACK ALL RESOURCES, FOLLOWING A DB2 ERROR.  FORMAT       15069202
150700**  INFORMATION RELATIVE TO THE ERROR.                            15070002
150800*-----------------------------------------------------------      15080002
150900  9920-CICS-ERROR.                                                15090002
151000                                                                  15100002
151100      SET DP013-ROLLBACK                                          15110002
151200          DP013-XCTL-DISPLAY-RESTART                              15120002
151300          DP013-CICS-ABEND      TO TRUE                           15130002
151400                                                                  15140002
151500      PERFORM DP013-0000-PROCESS-ABEND.                           15150002
151600                                                                  15160002
151700                                                                  15170002
151800*-----------------------------------------------------------      15180002
151900**  DEQUEUE THE TRANSIENT DATA QUEUE FOR THE INTERNAL READER.     15190002
152000**  THIS SHOULD BE DONE FOLLOWING A SUCCESSFUL REPORT REQUEST     15200002
152100**  SUBMISSION, A CANCELLATION OF THE CURRENT REPORT REQUEST, OR  15210002
152200**  ANY DETECTED ABENDS.  THIS WILL FREE UP THE INTERNAL READER   15220002
152300**  FOR THE NEXT USER.  IF ANY ERRORS OCCUR, CHECK TO SEE IF      15230002
152400**  ANY OTHER ABEND SITUATIONS HAVE ALREADY OCCURRED.  IF SO, DO  15240002
152500**  NOT FORCE THE ABEND FOR THIS ERROR, AND ALLOW PROGRAM CONTROL 15250002
152600**  TO RETURN TO THE POINT WHERE THE FIRST ABEND OCCURRED, AND    15260002
152700**  DISPLAY THE MESSAGE RELATING TO THAT ABEND.  IF NOT, DELETE   15270002
152800**  THE TEMPORARY STORAGE QUEUE (TO PREVENT OLD REQUEST           15280002
152900**  INFORMATION FROM ACCIDENTALLY APPEARING ON A FUTURE REQUEST), 15290002
153000**  FORMAT AND DISPLAY AN ERROR MESSAGE, AND RETURN TO NATIVE     15300002
153100**  CICS.                                                         15310002
153200*-----------------------------------------------------------      15320002
153300  9800-DEQUEUE-INTERNAL-READER.                                   15330002
153400                                                                  15340002
153500      SET PS-INTERNAL-READER-DEQUEUED TO TRUE.                    15350002
153600                                                                  15360002
153700      EXEC CICS                                                   15370002
153800          DEQ                                                     15380002
153900              RESOURCE(TD-QUEUE-NAME)                             15390002
154000              LENGTH(TD-QUEUE-NAME-LENGTH)                        15400002
154100              RESP(PV-CICS-RESPONSE)                              15410002
154200      END-EXEC.                                                   15420002
154300                                                                  15430002
154400      IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                   15440002
154500          STRING 'DEQUEUE '                DELIMITED BY SIZE      15450002
154600                 TD-QUEUE-NAME             DELIMITED BY SIZE      15460002
154700                 ' (INTERNAL READER)'      DELIMITED BY SIZE      15470002
154800              INTO DP013-MESSAGE-TEXT(1)                          15480002
154900          PERFORM 9920-CICS-ERROR                                 15490002
155000      END-IF.                                                     15500002
155100                                                                  15510002
155500*----------------------------------------------------------------*15550002
155600*    ABEND PROCESSOR MODULE                                      *15560002
155700*----------------------------------------------------------------*15570002
155800                                                                  15580002
155900     COPY DPPD013.                                                15590002
156000                                                                  15600002
156100     COPY DPPD017.                                                15610002
156200                                                                  15620002
156300                                                                  15630002
