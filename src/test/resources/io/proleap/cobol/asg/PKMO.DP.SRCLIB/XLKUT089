000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.    XLKUT089.                                         00020099
000300 AUTHOR.        TKMA497                                           00030099
000400 DATE-WRITTEN.  SEPTEMBER, 2005.                                  00040099
000500*                                                                 00050000
000600*                                                                 00060000
000700****************************************************************  00070000
000800*                V E N D O R   D O M A I N                        00080099
000900*                                                                 00090000
001000* THIS PROGRAM COMPARES FOUR SETS OF FILES, CREATING A            00100099
001100* COMBINED OUTFILE OF THE DIFFERENCES BETWEEN EACH SET OF FILES.  00110000
001200* THE PROGRAM WILL COMPARE FILES EXTRACTED FROM SYSTEM OF RECORD  00120099
001300* AND FILES EXTRACTED FROM THE DB2 'XLT' VENDOR TABLES.           00130099
001400* (EACH SET OF FILES CORRESPONDS TO A DB2 VENDOR DOMAIN TABLE)    00140099
001500*                                                                 00150000
001600* DIFFERENCES BETWEEN THE FILES WILL BE WRITTEN TO AN             00160099
001700* OUTPUT FILE AS EITHER AN ADD, DELETE OR UPDATE RECORD.          00170000
001800****************************************************************  00180000
001900 ENVIRONMENT DIVISION.                                            00190000
002000 INPUT-OUTPUT SECTION.                                            00200000
002100                                                                  00210000
002200 FILE-CONTROL.                                                    00220000
002300     SELECT VN-VND-FILE              ASSIGN TO INP01.             00230099
002400     SELECT XLT-VND-FILE             ASSIGN TO INP02.             00240099
002500                                                                  00250000
002600     SELECT VN-VND-DEPT-FILE         ASSIGN TO INP03.             00260099
002700     SELECT XLT-VND-DEPT-FILE        ASSIGN TO INP04.             00270099
002800                                                                  00280000
002900     SELECT VN-VND-CPBL-FILE         ASSIGN TO INP05.             00290099
003000     SELECT XLT-VND-CPBL-FILE        ASSIGN TO INP06.             00300099
003100                                                                  00310099
003200     SELECT VN-VND-CPBL-CDE-FILE     ASSIGN TO INP07.             00320099
003300     SELECT XLT-VND-CPBL-CDE-FILE    ASSIGN TO INP08.             00330099
003400                                                                  00340099
003500     SELECT OUTPUT-FILE              ASSIGN TO OUT01.             00350099
003600                                                                  00360000
003700****************************************************************  00370000
003800 DATA DIVISION.                                                   00380000
003900 FILE SECTION.                                                    00390000
004000                                                                  00400000
004100 FD  VN-VND-FILE                                                  00410099
004200     LABEL RECORDS ARE STANDARD                                   00420000
004300     RECORDING MODE IS F                                          00430000
004400     BLOCK CONTAINS 0 RECORDS.                                    00440000
004500 01  VN-VND-FILE-REC             PIC X(150).                      00450099
004600                                                                  00460000
004700 FD  XLT-VND-FILE                                                 00470099
004800     LABEL RECORDS ARE STANDARD                                   00480000
004900     RECORDING MODE IS F                                          00490000
005000     BLOCK CONTAINS 0 RECORDS.                                    00500000
005100 01  XLT-VND-FILE-REC            PIC X(121).                      00510099
005200                                                                  00520000
005300 FD  VN-VND-DEPT-FILE                                             00530099
005400     LABEL RECORDS ARE STANDARD                                   00540000
005500     RECORDING MODE IS F                                          00550000
005600     BLOCK CONTAINS 0 RECORDS.                                    00560000
005700 01  VN-VND-DEPT-FILE-REC        PIC X(100).                      00570099
005800                                                                  00580000
005900 FD  XLT-VND-DEPT-FILE                                            00590099
006000     LABEL RECORDS ARE STANDARD                                   00600000
006100     RECORDING MODE IS F                                          00610000
006200     BLOCK CONTAINS 0 RECORDS.                                    00620000
006300 01  XLT-VND-DEPT-FILE-REC       PIC X(11).                       00630099
006400                                                                  00640000
006500 FD  VN-VND-CPBL-FILE                                             00650099
006600     LABEL RECORDS ARE STANDARD                                   00660000
006700     RECORDING MODE IS F                                          00670000
006800     BLOCK CONTAINS 0 RECORDS.                                    00680000
006900 01  VN-VND-CPBL-FILE-REC        PIC X(100).                      00690099
007000                                                                  00700000
007100 FD  XLT-VND-CPBL-FILE                                            00710099
007200     LABEL RECORDS ARE STANDARD                                   00720000
007300     RECORDING MODE IS F                                          00730000
007400     BLOCK CONTAINS 0 RECORDS.                                    00740000
007500 01  XLT-VND-CPBL-FILE-REC       PIC X(71).                       00750099
007600                                                                  00760099
007700 FD  VN-VND-CPBL-CDE-FILE                                         00770099
007800     LABEL RECORDS ARE STANDARD                                   00780099
007900     RECORDING MODE IS F                                          00790099
008000     BLOCK CONTAINS 0 RECORDS.                                    00800099
008100 01  VN-VND-CPBL-CDE-FILE-REC    PIC X(100).                      00810099
008200                                                                  00820099
008300 FD  XLT-VND-CPBL-CDE-FILE                                        00830099
008400     LABEL RECORDS ARE STANDARD                                   00840099
008500     RECORDING MODE IS F                                          00850099
008600     BLOCK CONTAINS 0 RECORDS.                                    00860099
008700 01  XLT-VND-CPBL-CDE-FILE-REC   PIC X(68).                       00870099
008800                                                                  00880000
008900 FD  OUTPUT-FILE                                                  00890000
009000     LABEL RECORDS ARE STANDARD                                   00900000
009100     RECORDING MODE IS F                                          00910000
009200     BLOCK CONTAINS 0 RECORDS.                                    00920000
009300 01  OUTPUT-FILE-REC             PIC X(900).                      00930000
009400                                                                  00940000
009500****************************************************************  00950000
009600 WORKING-STORAGE SECTION.                                         00960000
009700                                                                  00970000
009800 01  WS-WORKING-STOAGE-VALUE     PIC X(35)  VALUE                 00980000
009900                          '*** WORKING STORAGE STARTS HERE ***'.  00990000
010000 01  PS-PROGRAM-SWITCHES.                                         01000000
010100     05  PS-EMPTY-FILE-SW              PIC X(01)  VALUE 'N'.      01010000
010200         88  PS-EMPTY-FILE                        VALUE 'Y'.      01020099
010300         88  PS-NOT-EMPTY-FILE              VALUE 'N'.            01030000
010400                                                                  01040099
010500     05  PS-END-OF-VN-VND-SW           PIC X(01)  VALUE 'N'.      01050099
010600         88  PS-END-OF-VN-VND               VALUE 'Y'.            01060099
010700         88  PS-NOT-END-OF-VN-VND           VALUE 'N'.            01070099
010800     05  PS-END-OF-XLT-VND-SW          PIC X(01)  VALUE 'N'.      01080099
010900         88  PS-END-OF-XLT-VND              VALUE 'Y'.            01090099
011000         88  PS-NOT-END-OF-XLT-VND          VALUE 'N'.            01100099
011100                                                                  01110000
011200     05  PS-END-OF-VN-VND-DEPT-SW      PIC X(01)  VALUE 'N'.      01120099
011300         88  PS-END-OF-VN-VND-DEPT          VALUE 'Y'.            01130099
011400         88  PS-NOT-END-OF-VN-VND-DEPT      VALUE 'N'.            01140099
011500     05  PS-END-OF-XLT-VND-DEPT-SW     PIC X(01)  VALUE 'N'.      01150099
011600         88  PS-END-OF-XLT-VND-DEPT         VALUE 'Y'.            01160099
011700         88  PS-NOT-END-OF-XLT-VND-DEPT     VALUE 'N'.            01170099
011800                                                                  01180000
011900     05  PS-END-OF-VN-VND-CPBL-SW      PIC X(01)  VALUE 'N'.      01190099
012000         88  PS-END-OF-VN-VND-CPBL          VALUE 'Y'.            01200099
012100         88  PS-NOT-END-OF-VN-VND-CPBL      VALUE 'N'.            01210099
012200     05  PS-END-OF-XLT-VND-CPBL-SW     PIC X(01)  VALUE 'N'.      01220099
012300         88  PS-END-OF-XLT-VND-CPBL         VALUE 'Y'.            01230099
012400         88  PS-NOT-END-OF-XLT-VND-CPBL     VALUE 'N'.            01240099
012500                                                                  01250000
012600     05  PS-END-OF-VN-VND-CPBL-CDE-SW  PIC X(01)  VALUE 'N'.      01260099
012700         88  PS-END-OF-VN-VND-CPBL-CDE     VALUE 'Y'.             01270099
012800         88  PS-NOT-END-OF-VN-VND-CPBL-CDE VALUE 'N'.             01280099
012900     05  PS-END-OF-XLT-VND-CPBL-CDE-SW PIC X(01)  VALUE 'N'.      01290099
013000         88  PS-END-OF-XLT-VND-CPBL-CDE     VALUE 'Y'.            01300099
013100         88  PS-NOT-END-OF-XLT-VND-CPBL-CDE VALUE 'N'.            01310099
013200                                                                  01320099
013300 01  PC-PROGRAM-CONSTANTS.                                        01330000
013400     05  PC-CURRENT-PROGRAM-NAME PIC X(08)  VALUE 'XLKUT089'.     01340099
013500     05  PC-DASH                 PIC X(01)  VALUE '-'.            01350000
013600     05  PC-A                    PIC X(01)  VALUE 'A'.            01360000
013700     05  PC-DEFAULT-TMST         PIC X(26)                        01370000
013800             VALUE '9999-09-09-09.09.09.999999'.                  01380000
013900                                                                  01390000
014000 01  CONTROL-CARD-DATA.                                           01400000
014100     05  CC-PROGRAM-NAME         PIC X(01)  VALUE SPACES.         01410000
014200         88  CC-NIGHTLY-MAINT               VALUE '1'.            01420000
014300         88  CC-DATA-INTEGRITY              VALUE '2'.            01430000
014400     05  CC-FILLER               PIC X(79)  VALUE SPACES.         01440000
014500                                                                  01450000
014600*CREATE PV FIELDS TO USE WHEN COMPARING VN AND XLT FIELDS         01460099
014700*SINCE THEY ARE DEFINED DIFFERENTLY.                              01470000
014800                                                                  01480000
014900 01  PV-PROGRAM-VARIABLES.                                        01490000
015000     05  PV-DC-RET-CDE                PIC X(02).                  01500099
015100     05  PV-DEPT-NBR                  PIC X(03).                  01510099
015200     05  FILLER REDEFINES PV-DEPT-NBR.                            01520099
015300         10  PV-DEPT-NBR-9            PIC 9(03).                  01530099
015400                                                                  01540099
015500*VENDOR DEPT PRIMARY KEYS                                         01550099
015600     05  PV-VN-VND-DEPT-KEYS.                                     01560099
015700         10  PV-VN101-ENT-ID         PIC S9(09)  COMP.            01570099
015800         10  PV-VN101-DEPT-NBR       PIC  9(04).                  01580099
015900     05  PV-XLT-VND-DEPT-KEYS.                                    01590099
016000         10  PV-XLT39-ENT-ID         PIC S9(09)  COMP.            01600099
016100         10  PV-XLT39-DEPT-NBR       PIC  9(04).                  01610099
016200*VENDOR CAPABILITES PRIMARY KEYS                                  01620099
016300     05  PV-VN-VND-CPBL-KEYS.                                     01630099
016400         10  PV-VN104-ENT-ID         PIC S9(09)  COMP.            01640099
016500         10  PV-VN104-VND-CPBL-CDE   PIC  X(03).                  01650099
016600         10  PV-VN104-EFF-BEG-DTE    PIC  X(10).                  01660099
016700     05  PV-XLT-VND-CPBL-KEYS.                                    01670099
016800         10  PV-XLT37-ENT-ID         PIC S9(09)  COMP.            01680099
016900         10  PV-XLT37-VND-CPBL-CDE   PIC  X(03).                  01690099
017000         10  PV-XLT37-EFF-BEG-DTE    PIC  X(10).                  01700099
017100                                                                  01710099
017200     05  PV-STYL-ID                   PIC 9(08).                  01720000
017300                                                                  01730000
017400     05  PV-CURRENT-TMST              PIC X(26).                  01740099
017500                                                                  01750099
017600     05  PV-CURRENT-DATE.                                         01760099
017700         10  PV-CURR-DATE-CC          PIC X(02).                  01770099
017800         10  PV-CURR-DATE-YY          PIC X(02).                  01780099
017900         10  FILLER                   PIC X(01) VALUE '-'.        01790000
018000         10  PV-CURR-DATE-MM          PIC X(02).                  01800099
018100         10  FILLER                   PIC X(01) VALUE '-'.        01810000
018200         10  PV-CURR-DATE-DD          PIC X(02).                  01820099
018300                                                                  01830000
018400     05  PV-PARAGRAPH-NAME            PIC X(30) VALUE SPACES.     01840000
018500     05  PV-SQLCODE                   PIC 9(09) VALUE ZERO.       01850000
018600     05  PV-XLT-COUNT                 PIC S9(9) VALUE +0          01860099
018700                                                COMP-3.           01870000
018800                                                                  01880000
018900 01  PV-ABEND-FIELDS.                                             01890000
019000     05  PV-ABEND-CODE               PIC S9(4) VALUE +0           01900000
019100                                               COMP SYNC.         01910000
019200     05  PV-ABEND-PROGRAM            PIC X(08) VALUE 'XLKUT089'.  01920099
019300     05  PV-ABEND-PARAGRAPH          PIC X(50) VALUE SPACES.      01930000
019400     05  PV-ABEND-OPERATION          PIC X(50) VALUE SPACES.      01940000
019500     05  PV-XLT-OPERATION-MESSAGE-1  PIC X(79) VALUE SPACES.      01950099
019600     05  PV-XLT-OPERATION-MESSAGE-2  PIC X(79) VALUE SPACES.      01960099
019700     05  PV-XLT-OPERATION-MESSAGE-3  PIC X(79) VALUE SPACES.      01970099
019800     05  PV-XLT-OPERATION-MESSAGE-4  PIC X(79) VALUE SPACES.      01980099
019900     05  PV-XLT-TABLE-NAME-1         PIC X(20) VALUE SPACES.      01990099
020000     05  PV-XLT-TABLE-NAME-2         PIC X(20) VALUE SPACES.      02000099
020100                                                                  02010000
020200     05  PV-DISPLAY-ENT-ID           PIC  9(09) VALUE ZEROES.     02020099
020300     05  PV-DISPLAY-DEPT-NBR         PIC  9(04) VALUE ZEROES.     02030099
020400     05  PV-DISPLAY-VND-CPBL-CDE     PIC  X(03) VALUE ZEROES.     02040099
020500                                                                  02050099
020600 01  PC-PROGRAM-COUNTERS.                                         02060000
020700     05  PC-VN-VND-RECS-READ             PIC 9(09) VALUE ZEROS.   02070099
020800     05  PC-XLT-VND-RECS-READ            PIC 9(09) VALUE ZEROS.   02080099
020900                                                                  02090000
021000     05  PC-VN-VND-DEPT-RECS-READ        PIC 9(09) VALUE ZEROS.   02100099
021100     05  PC-XLT-VND-DEPT-RECS-READ       PIC 9(09) VALUE ZEROS.   02110099
021200                                                                  02120000
021300     05  PC-VN-VND-CPBL-RECS-READ        PIC 9(09) VALUE ZEROS.   02130099
021400     05  PC-XLT-VND-CPBL-RECS-READ       PIC 9(09) VALUE ZEROS.   02140099
021500                                                                  02150099
021600     05  PC-VN-VND-CPBL-CDE-RECS-READ    PIC 9(09) VALUE ZEROS.   02160099
021700     05  PC-XLT-VND-CPBL-CDE-RECS-READ   PIC 9(09) VALUE ZEROS.   02170099
021800                                                                  02180099
021900     05  PC-DIFFER-RECORD-WRITTEN        PIC 9(09) VALUE ZEROS.   02190000
022000                                                                  02200000
022100 01  DK-DB-KEYS.                                                  02210000
022200     05  DK-ENT-ID                       PIC  S9(9) COMP.         02220099
022300     05  DK-STR-GP-ID                    PIC  S9(4) COMP.         02230000
022400     05  DK-STR-GP-TYP-CDE               PIC  S9(4) COMP.         02240000
022500                                                                  02250000
022600******************************************************************02260000
022700*  USED FOR DB2 ERROR MESSAGE BUILDING                            02270000
022800******************************************************************02280000
022900     COPY DPWS004.                                                02290000
023000                                                                  02300000
023100******************************************************************02310000
023200* LAYOUTS OF INPUT FILES.                                         02320000
023300******************************************************************02330000
023400***                                                               02340000
023500*VENDOR                                                           02350099
023600     COPY VNRD100.                                                02360099
023700                                                                  02370000
023800*VENDOR DEPT                                                      02380099
023900     COPY VNRD101.                                                02390099
024000                                                                  02400000
024100***                                                               02410000
024200*VENDOR CAPABILITIES                                              02420099
024300     COPY VNRD104.                                                02430099
024400                                                                  02440000
024500*VENDOR CAPABILITIES CODE                                         02450099
024600     COPY VNRD105.                                                02460099
024700***                                                               02470000
024800     EXEC SQL                                                     02480000
024900         INCLUDE SQLCA                                            02490000
025000     END-EXEC.                                                    02500000
025100                                                                  02510000
025200***TABLE XLT_VND                                                  02520099
025300     EXEC SQL                                                     02530000
025400         INCLUDE XLT00035                                         02540099
025500     END-EXEC.                                                    02550000
025600                                                                  02560000
025700***TABLE XLT_VND_DEPT                                             02570099
025800     EXEC SQL                                                     02580000
025900         INCLUDE XLT00039                                         02590099
026000     END-EXEC.                                                    02600000
026100                                                                  02610000
026200***TABLE XLT_VND_CPBL                                             02620099
026300     EXEC SQL                                                     02630000
026400         INCLUDE XLT00037                                         02640099
026500     END-EXEC.                                                    02650000
026600                                                                  02660099
026700***TABLE XLT_VND_CPBL_CDE                                         02670099
026800     EXEC SQL                                                     02680099
026900         INCLUDE XLT00036                                         02690099
027000     END-EXEC.                                                    02700099
027100                                                                  02710000
027200******************************************************************02720000
027300* COPYBOOK OF OUTPUT FILE.                                        02730000
027400******************************************************************02740000
027500     COPY XLRD058.                                                02750099
027600                                                                  02760000
027700******************************************************************02770000
027800 PROCEDURE DIVISION.                                              02780000
027900                                                                  02790000
028000******************************************************************02800000
028100 0000-MAINLINE.                                                   02810000
028200     PERFORM 1000-INITIALIZATION.                                 02820000
028300*                                                                 02830000
028400*CHECK IF ANY EMPTY PPC FILES (ERROR MESSAGE).                    02840000
028500     IF PS-EMPTY-FILE                                             02850099
028600         MOVE 4095 TO RETURN-CODE                                 02860099
028700         PERFORM 9999-TERMINATE                                   02870099
028800         GOBACK                                                   02880099
028900     END-IF.                                                      02890099
029000                                                                  02900000
029100*COMPARE VENDOR                                                   02910099
029200     PERFORM 2000-PROCESS-VENDOR                                  02920099
029300       UNTIL PS-END-OF-VN-VND                                     02930099
029400          OR PS-END-OF-XLT-VND.                                   02940099
029500     PERFORM 2900-PROCESS-EXTRA-VEND-REC                          02950099
029600       UNTIL PS-END-OF-VN-VND                                     02960099
029700         AND PS-END-OF-XLT-VND.                                   02970099
029800                                                                  02980000
029900*COMPARE VENDOR DEPARTMENT                                        02990099
030000     PERFORM 3000-PROCESS-VEND-DEPT                               03000099
030100       UNTIL PS-END-OF-VN-VND-DEPT                                03010099
030200          OR PS-END-OF-XLT-VND-DEPT.                              03020099
030300     PERFORM 3900-PROCESS-EXT-VND-DEPT-REC                        03030099
030400       UNTIL PS-END-OF-VN-VND-DEPT                                03040099
030500         AND PS-END-OF-XLT-VND-DEPT.                              03050099
030600                                                                  03060000
030700*COMPARE VENDOR CAPABILITIES                                      03070099
030800     PERFORM 4000-PROCESS-VEND-CPBL                               03080099
030900       UNTIL PS-END-OF-VN-VND-CPBL                                03090099
031000          OR PS-END-OF-XLT-VND-CPBL.                              03100099
031100     PERFORM 4900-PROCESS-EXTRA-CPBL-REC                          03110099
031200       UNTIL PS-END-OF-VN-VND-CPBL                                03120099
031300         AND PS-END-OF-XLT-VND-CPBL.                              03130099
031400                                                                  03140099
031500*COMPARE VENDOR CAPABILITIES CODE                                 03150099
031600     PERFORM 5000-PROCESS-VND-CPBL-CDE                            03160099
031700       UNTIL PS-END-OF-VN-VND-CPBL-CDE                            03170099
031800          OR PS-END-OF-XLT-VND-CPBL-CDE.                          03180099
031900     PERFORM 5900-PROCESS-EXTRA-CPBL-CDE                          03190099
032000       UNTIL PS-END-OF-VN-VND-CPBL-CDE                            03200099
032100         AND PS-END-OF-XLT-VND-CPBL-CDE.                          03210099
032200                                                                  03220000
032300*FINISH PROCESSING.                                               03230000
032400     PERFORM 9999-TERMINATE.                                      03240000
032500                                                                  03250000
032600     GOBACK.                                                      03260000
032700                                                                  03270000
032800******************************************************************03280000
032900*             I N I T I A L I Z A T I O N                        *03290000
033000******************************************************************03300000
033100 1000-INITIALIZATION.                                             03310000
033200     MOVE '1000-INITIALIZATION           ' TO PV-PARAGRAPH-NAME.  03320000
033300                                                                  03330000
033400*SET COUNTERS TO ZERO.                                            03340000
033500     INITIALIZE PC-PROGRAM-COUNTERS.                              03350000
033600                                                                  03360000
033700*READ SYSIN CONTROL CARD.                                         03370000
033800     ACCEPT CONTROL-CARD-DATA FROM SYSIN.                         03380000
033900                                                                  03390000
034000     OPEN INPUT  VN-VND-FILE                                      03400099
034100                 XLT-VND-FILE                                     03410099
034200                 VN-VND-DEPT-FILE                                 03420099
034300                 XLT-VND-DEPT-FILE                                03430099
034400                 VN-VND-CPBL-FILE                                 03440099
034500                 XLT-VND-CPBL-FILE                                03450099
034600                 VN-VND-CPBL-CDE-FILE                             03460099
034700                 XLT-VND-CPBL-CDE-FILE                            03470099
034800          OUTPUT OUTPUT-FILE.                                     03480000
034900                                                                  03490000
035000     SET PS-NOT-EMPTY-FILE                                        03500099
035100         PS-NOT-END-OF-VN-VND                                     03510099
035200         PS-NOT-END-OF-XLT-VND                                    03520099
035300         PS-NOT-END-OF-VN-VND-DEPT                                03530099
035400         PS-NOT-END-OF-XLT-VND-DEPT                               03540099
035500         PS-NOT-END-OF-VN-VND-CPBL                                03550099
035600         PS-NOT-END-OF-XLT-VND-CPBL                               03560099
035700         PS-NOT-END-OF-VN-VND-CPBL-CDE                            03570099
035800         PS-NOT-END-OF-XLT-VND-CPBL-CDE TO TRUE.                  03580099
035900                                                                  03590000
036000     EXEC SQL                                                     03600099
036100        SET :PV-CURRENT-TMST = CURRENT TIMESTAMP                  03610099
036200     END-EXEC.                                                    03620099
036300     MOVE PV-CURRENT-TMST TO PV-CURRENT-DATE                      03630099
036400                                                                  03640099
036500     PERFORM 6000-READ-VN-VND                                     03650099
036600     PERFORM 6100-READ-XLT-VND.                                   03660099
036700                                                                  03670000
036800     PERFORM 7000-READ-VN-VND-DEPT                                03680099
036900     PERFORM 7100-READ-XLT-VND-DEPT.                              03690099
037000                                                                  03700000
037100     PERFORM 8000-READ-VN-VND-CPBL                                03710099
037200     PERFORM 8100-READ-XLT-VND-CPBL.                              03720099
037300                                                                  03730099
037400     PERFORM 9000-READ-VN-VND-CPBL-CDE                            03740099
037500     PERFORM 9100-READ-XLT-VND-CPBL-CDE.                          03750099
037600                                                                  03760000
037700                                                                  03770099
037800******************************************************************03780000
037900*     P R O C E S S   V E N D O R   C H A N G E                  *03790099
038000* COMPARE ON PRIMARY KEY ENT_ID (VENDOR)                         *03800099
038100******************************************************************03810000
038200 2000-PROCESS-VENDOR.                                             03820099
038300     MOVE '2000-PROCESS-VENDOR            ' TO PV-PARAGRAPH-NAME. 03830099
038400                                                                  03840000
038500     MOVE SPACES          TO XL058-TRANS-REC.                     03850099
038600                                                                  03860000
038700     EVALUATE TRUE                                                03870000
038800     WHEN VN100-ENT-ID = XLT00035-ENT-ID                          03880099
038900        PERFORM 2200-COMPARE-VENDOR-FIELDS                        03890099
039000        PERFORM 6000-READ-VN-VND                                  03900099
039100        PERFORM 6100-READ-XLT-VND                                 03910099
039200     WHEN VN100-ENT-ID > XLT00035-ENT-ID                          03920099
039300        SET XL058-DELETE     TO TRUE                              03930099
039400        MOVE PC-DEFAULT-TMST TO XL058-VEND-SOR-CRE-TMST           03940099
039500                                XL058-VEND-SOR-LAST-UPD-TMST      03950099
039600        MOVE 'A'             TO XL058-RECORD-TYPE                 03960099
039700        MOVE '24'            TO XL058-SORT-SEQUENCE               03970099
039800        PERFORM 6500-MOVE-XLT-VENDOR-VALUES                       03980099
039900        PERFORM 9800-WRITE-OUTPUT-RECORD                          03990099
040000        PERFORM 6100-READ-XLT-VND                                 04000099
040100     WHEN VN100-ENT-ID < XLT00035-ENT-ID                          04010099
040200        SET XL058-INSERT TO TRUE                                  04020099
040300        MOVE PV-CURRENT-TMST TO XL058-VEND-SOR-CRE-TMST           04030099
040400                                XL058-VEND-SOR-LAST-UPD-TMST      04040099
040500        MOVE 'A'  TO XL058-RECORD-TYPE                            04050099
040600        MOVE '01' TO XL058-SORT-SEQUENCE                          04060099
040700        PERFORM 6400-MOVE-VN-VENDOR-VALUES                        04070099
040800        PERFORM 9800-WRITE-OUTPUT-RECORD                          04080000
040900        PERFORM 6000-READ-VN-VND                                  04090099
041000     END-EVALUATE.                                                04100000
041100                                                                  04110000
041200******************************************************************04120000
041300** COMPARES ALL NON-PRIMARY FIELDS TO SEE IF DIFFERENCES EXIST    04130000
041400******************************************************************04140000
041500 2200-COMPARE-VENDOR-FIELDS.                                      04150099
041600     MOVE '2200-PROCESS-VENDOR-FIELDS     ' TO PV-PARAGRAPH-NAME. 04160099
041700                                                                  04170000
041800     IF XLT00035-VND-NBR             = VN100-VND-NBR              04180099
041900       AND XLT00035-VND-TYP-CDE      = VN100-PRIM-TYP-CDE         04190099
042000       AND XLT00035-PRTNR-TYP-CDE    = VN100-PRTNR-TYP-CDE        04200099
042100       AND XLT00035-PRIM-VND-NM      = VN100-PRIMARY-NAME         04210099
042200       AND XLT00035-STAT-CDE         = VN100-STATUS-CDE           04220099
042300       AND XLT00035-SCAC-CDE         = VN100-SCAC-CDE             04230099
042400       AND XLT00035-CFY-SLSRNK-NBR   = VN100-CFY-SLSRNK-NBR       04240099
042500       AND XLT00035-PFY-SLSRNK-NBR   = VN100-PFY-SLSRNK-NBR       04250099
042600       AND XLT00035-P12MN-SLSRNK-NBR = VN100-P12MN-SLSRNK-NBR     04260099
042700       AND XLT00035-EDI-PO-PREPK-CDE = VN100-EDI-PO-PREPK-CDE     04270099
042800       AND XLT00035-SHRT-VND-NM      = VN100-SHRT-VND-NM          04280099
042900        CONTINUE                                                  04290000
043000     ELSE                                                         04300000
043100        SET XL058-UPDATE     TO TRUE                              04310099
043200        MOVE PC-DEFAULT-TMST TO XL058-VEND-SOR-CRE-TMST           04320099
043300        MOVE PV-CURRENT-TMST TO XL058-VEND-SOR-LAST-UPD-TMST      04330099
043400        MOVE 'A'             TO XL058-RECORD-TYPE                 04340099
043500        MOVE '11'            TO XL058-SORT-SEQUENCE               04350099
043600        PERFORM 6400-MOVE-VN-VENDOR-VALUES                        04360099
043700        PERFORM 9800-WRITE-OUTPUT-RECORD                          04370000
043800     END-IF.                                                      04380000
043900                                                                  04390000
044000******************************************************************04400000
044100**COMPLETE PROCESSING OF EXTRACT RECORDS IF THEY EXIST            04410000
044200******************************************************************04420000
044300 2900-PROCESS-EXTRA-VEND-REC.                                     04430099
044400                                                                  04440000
044500     MOVE '2900-PROCESS-EXTRA-VEND-REC' TO PV-PARAGRAPH-NAME.     04450099
044600                                                                  04460000
044700     MOVE SPACES          TO XL058-TRANS-REC.                     04470099
044800                                                                  04480000
044900     IF  PS-NOT-END-OF-VN-VND                                     04490099
045000         SET XL058-INSERT     TO TRUE                             04500099
045100         MOVE PV-CURRENT-TMST TO XL058-VEND-SOR-CRE-TMST          04510099
045200         MOVE PC-DEFAULT-TMST TO XL058-VEND-SOR-LAST-UPD-TMST     04520099
045300         MOVE 'A'             TO XL058-RECORD-TYPE                04530099
045400         MOVE '01'            TO XL058-SORT-SEQUENCE              04540099
045500         PERFORM 6400-MOVE-VN-VENDOR-VALUES                       04550099
045600         PERFORM 9800-WRITE-OUTPUT-RECORD                         04560000
045700         PERFORM 6000-READ-VN-VND                                 04570099
045800     END-IF.                                                      04580000
045900                                                                  04590000
046000     IF  PS-NOT-END-OF-XLT-VND                                    04600099
046100         SET XL058-DELETE     TO TRUE                             04610099
046200         MOVE PC-DEFAULT-TMST TO XL058-VEND-SOR-CRE-TMST          04620099
046300                                 XL058-VEND-SOR-LAST-UPD-TMST     04630099
046400         MOVE 'A'             TO XL058-RECORD-TYPE                04640099
046500         MOVE '24'            TO XL058-SORT-SEQUENCE              04650099
046600         PERFORM 6500-MOVE-XLT-VENDOR-VALUES                      04660099
046700         PERFORM 9800-WRITE-OUTPUT-RECORD                         04670099
046800         PERFORM 6100-READ-XLT-VND                                04680099
046900     END-IF.                                                      04690000
047000                                                                  04700000
047100******************************************************************04710000
047200*     P R O C E S S   V E N D O R   D E P A R T M E N T          *04720099
047300* COMPARE ON PRIMARY KEYS ENT_ID, DEPT_NBR                       *04730099
047400******************************************************************04740000
047500 3000-PROCESS-VEND-DEPT.                                          04750099
047600     MOVE '3000-PROCESS-VEND-DEPT         ' TO PV-PARAGRAPH-NAME. 04760099
047700                                                                  04770000
047800     MOVE SPACES          TO XL058-TRANS-REC.                     04780099
047900                                                                  04790000
048000     IF VN101-PRCHS-AGMNT-EFF-DTE <= PV-CURRENT-DATE AND          04800099
048100        VN101-PRCHS-AGMNT-EXP-DTE >  PV-CURRENT-DATE              04810099
048200                                                                  04820099
048300         MOVE VN101-ENT-ID         TO PV-VN101-ENT-ID             04830099
048400         MOVE VN101-DEPT-NBR       TO PV-DEPT-NBR                 04840099
048500         MOVE PV-DEPT-NBR-9        TO PV-VN101-DEPT-NBR           04850099
048600                                                                  04860099
048700         MOVE XLT00039-ENT-ID      TO PV-XLT39-ENT-ID             04870099
048800         MOVE XLT00039-DEPT-NBR    TO PV-XLT39-DEPT-NBR           04880099
048900                                                                  04890099
049000         EVALUATE TRUE                                            04900099
049100         WHEN PV-VN-VND-DEPT-KEYS  = PV-XLT-VND-DEPT-KEYS         04910099
049200              PERFORM 3200-COMPARE-VND-DEPT-FIELDS                04920099
049300              PERFORM 7000-READ-VN-VND-DEPT                       04930099
049400              PERFORM 7100-READ-XLT-VND-DEPT                      04940099
049500         WHEN PV-VN-VND-DEPT-KEYS  > PV-XLT-VND-DEPT-KEYS         04950099
049600            SET XL058-DELETE TO TRUE                              04960099
049700            MOVE 'B'         TO XL058-RECORD-TYPE                 04970099
049800            MOVE '23'        TO XL058-SORT-SEQUENCE               04980099
049900            PERFORM 7500-MOVE-XLT-VND-DEPT-VALUES                 04990099
050000            PERFORM 9800-WRITE-OUTPUT-RECORD                      05000099
050100            PERFORM 7100-READ-XLT-VND-DEPT                        05010099
050200                                                                  05020099
050300         WHEN PV-VN-VND-DEPT-KEYS  < PV-XLT-VND-DEPT-KEYS         05030099
050400              SET XL058-INSERT TO TRUE                            05040099
050500              MOVE 'B'         TO XL058-RECORD-TYPE               05050099
050600              MOVE '02'        TO XL058-SORT-SEQUENCE             05060099
050700              PERFORM 7400-MOVE-VN-VND-DEPT-VALUES                05070099
050800              PERFORM 9800-WRITE-OUTPUT-RECORD                    05080099
050900              PERFORM 7000-READ-VN-VND-DEPT                       05090099
051000         END-EVALUATE                                             05100099
051100     ELSE                                                         05110099
051200         PERFORM 7000-READ-VN-VND-DEPT                            05120099
051300     END-IF.                                                      05130099
051400                                                                  05140000
051500******************************************************************05150000
051600** COMPARES ALL NON-PRIMARY FIELDS TO SEE IF DIFFERENCES EXIST    05160000
051700******************************************************************05170000
051800 3200-COMPARE-VND-DEPT-FIELDS.                                    05180099
051900     MOVE '3200-COMPARE-VND-DEPT-FIELDS   ' TO PV-PARAGRAPH-NAME. 05190099
052000     PERFORM 3300-CONVERT-DC-RET-CDE.                             05200099
052100     IF XLT00039-DEPT-TYP-CDE       = VN101-VEND-TYP-IND          05210099
052200        AND XLT00039-VND-DEPT-STAT-CDE                            05220099
052300                                    = VN101-VND-DEPT-STAT-CD      05230099
052400        AND XLT00039-DC-RET-CDE     = PV-DC-RET-CDE               05240099
052500        CONTINUE                                                  05250000
052600     ELSE                                                         05260000
052700        SET XL058-UPDATE TO TRUE                                  05270099
052800        MOVE 'B'         TO XL058-RECORD-TYPE                     05280099
052900        MOVE '12'        TO XL058-SORT-SEQUENCE                   05290099
053000        PERFORM 7400-MOVE-VN-VND-DEPT-VALUES                      05300099
053100        PERFORM 9800-WRITE-OUTPUT-RECORD                          05310000
053200     END-IF.                                                      05320000
053300                                                                  05330000
053400 3300-CONVERT-DC-RET-CDE.                                         05340099
053500     INITIALIZE PV-DC-RET-CDE.                                    05350099
053600                                                                  05360099
053700     IF VN101-RTV-RA-REQD-IND = 'Y'                               05370099
053800        MOVE 'RA' TO PV-DC-RET-CDE                                05380099
053900     END-IF.                                                      05390099
054000     IF VN101-RTV-NO-RA-REQD-IND = 'Y'                            05400099
054100        MOVE 'RV' TO PV-DC-RET-CDE                                05410099
054200     END-IF.                                                      05420099
054300     IF VN101-DEBIT-DESTROY-IND = 'Y'                             05430099
054400        MOVE 'DD' TO PV-DC-RET-CDE                                05440099
054500     END-IF.                                                      05450099
054600     IF VN101-MARKOUT-IND = 'Y'                                   05460099
054700        MOVE 'MO' TO PV-DC-RET-CDE                                05470099
054800     END-IF.                                                      05480099
054900                                                                  05490099
055000******************************************************************05500000
055100**COMPLETE PROCESSING OF EXTRACT RECORDS IF THEY EXIST            05510000
055200******************************************************************05520000
055300 3900-PROCESS-EXT-VND-DEPT-REC.                                   05530099
055400                                                                  05540000
055500     MOVE '3900-PROCESS-EXT-VND-DEPT-REC'                         05550099
055600                          TO PV-PARAGRAPH-NAME.                   05560099
055700                                                                  05570000
055800     MOVE SPACES          TO XL058-TRANS-REC.                     05580099
055900                                                                  05590099
056000     IF VN101-PRCHS-AGMNT-EFF-DTE <= PV-CURRENT-DATE AND          05600099
056100        VN101-PRCHS-AGMNT-EXP-DTE >  PV-CURRENT-DATE              05610099
056200                                                                  05620099
056300         MOVE VN101-ENT-ID         TO PV-VN101-ENT-ID             05630099
056400         MOVE VN101-DEPT-NBR       TO PV-DEPT-NBR                 05640099
056500         MOVE PV-DEPT-NBR-9        TO PV-VN101-DEPT-NBR           05650099
056600                                                                  05660099
056700         IF  PS-NOT-END-OF-VN-VND-DEPT                            05670099
056800             SET XL058-INSERT TO TRUE                             05680099
056900             MOVE 'B'         TO XL058-RECORD-TYPE                05690099
057000             MOVE '02'        TO XL058-SORT-SEQUENCE              05700099
057100             PERFORM 7400-MOVE-VN-VND-DEPT-VALUES                 05710099
057200             PERFORM 9800-WRITE-OUTPUT-RECORD                     05720099
057300             PERFORM 7000-READ-VN-VND-DEPT                        05730099
057400         END-IF                                                   05740099
057500                                                                  05750099
057600         IF  PS-NOT-END-OF-XLT-VND-DEPT                           05760099
057700            SET XL058-DELETE TO TRUE                              05770099
057800            MOVE 'B'         TO XL058-RECORD-TYPE                 05780099
057900            MOVE '23'        TO XL058-SORT-SEQUENCE               05790099
058000            PERFORM 7500-MOVE-XLT-VND-DEPT-VALUES                 05800099
058100            PERFORM 9800-WRITE-OUTPUT-RECORD                      05810099
058200           PERFORM 7100-READ-XLT-VND-DEPT                         05820099
058300         END-IF                                                   05830099
058400     ELSE                                                         05840099
058500         PERFORM 7000-READ-VN-VND-DEPT                            05850099
058600     END-IF.                                                      05860099
058700                                                                  05870000
058800******************************************************************05880000
058900 4000-PROCESS-VEND-CPBL.                                          05890099
059000     MOVE '4000-PROCESS-VEND-CPBL         ' TO PV-PARAGRAPH-NAME. 05900099
059100                                                                  05910000
059200     MOVE SPACES          TO XL058-TRANS-REC.                     05920099
059300                                                                  05930000
059400     MOVE VN104-ENT-ID          TO PV-VN104-ENT-ID.               05940099
059500     MOVE VN104-VND-CPBL-CDE    TO PV-VN104-VND-CPBL-CDE.         05950099
059600     MOVE VN104-EFF-BEG-DTE     TO PV-VN104-EFF-BEG-DTE.          05960099
059700                                                                  05970099
059800     MOVE XLT00037-ENT-ID       TO PV-XLT37-ENT-ID.               05980099
059900     MOVE XLT00037-VND-CPBL-CDE TO PV-XLT37-VND-CPBL-CDE.         05990099
060000     MOVE XLT00037-EFF-BEG-DTE  TO PV-XLT37-EFF-BEG-DTE.          06000099
060100                                                                  06010000
060200     EVALUATE TRUE                                                06020000
060300     WHEN PV-VN-VND-CPBL-KEYS  = PV-XLT-VND-CPBL-KEYS             06030099
060400          PERFORM 4200-COMPARE-VND-CPBL-FIELDS                    06040099
060500          PERFORM 8000-READ-VN-VND-CPBL                           06050099
060600          PERFORM 8100-READ-XLT-VND-CPBL                          06060099
060700                                                                  06070099
060800     WHEN PV-VN-VND-CPBL-KEYS  > PV-XLT-VND-CPBL-KEYS             06080099
060900         SET XL058-DELETE     TO TRUE                             06090099
061000         MOVE 'D'             TO XL058-RECORD-TYPE                06100099
061100         MOVE '21'            TO XL058-SORT-SEQUENCE              06110099
061200         PERFORM 8500-MOVE-XLT-VND-CPBL-VALUES                    06120099
061300         PERFORM 9800-WRITE-OUTPUT-RECORD                         06130099
061400        PERFORM 8100-READ-XLT-VND-CPBL                            06140099
061500                                                                  06150099
061600     WHEN PV-VN-VND-CPBL-KEYS  < PV-XLT-VND-CPBL-KEYS             06160099
061700          SET XL058-INSERT TO TRUE                                06170099
061800          MOVE 'D'  TO XL058-RECORD-TYPE                          06180099
061900          MOVE '04' TO XL058-SORT-SEQUENCE                        06190099
062000          PERFORM 8400-MOVE-VND-CPBL-VALUES                       06200099
062100          PERFORM 9800-WRITE-OUTPUT-RECORD                        06210000
062200          PERFORM 8000-READ-VN-VND-CPBL                           06220099
062300     END-EVALUATE.                                                06230000
062400                                                                  06240000
062500******************************************************************06250000
062600** COMPARES ALL NON-PRIMARY FIELDS TO SEE IF DIFFERENCES EXIST    06260000
062700******************************************************************06270000
062800 4200-COMPARE-VND-CPBL-FIELDS.                                    06280099
062900     MOVE '4200-COMPARE-VND-CPBL-FIELDS  ' TO PV-PARAGRAPH-NAME.  06290099
063000                                                                  06300000
063100     IF XLT00037-EFF-END-DTE = VN104-EFF-END-DTE AND              06310099
063200        XLT00037-CRE-DTE     = VN104-CRE-DTE     AND              06320099
063300        XLT00037-LAST-UPD-TMST                                    06330099
063400                             = VN104-LAST-UPD-TMST AND            06340099
063500        XLT00037-LAST-UPD-BY-USR-ID                               06350099
063600                             = VN104-LAST-UPD-BY-USR-ID           06360099
063700        CONTINUE                                                  06370000
063800     ELSE                                                         06380000
063900        SET XL058-UPDATE     TO TRUE                              06390099
064000        MOVE 'D'             TO XL058-RECORD-TYPE                 06400099
064100        MOVE '14'            TO XL058-SORT-SEQUENCE               06410099
064200        PERFORM 8400-MOVE-VND-CPBL-VALUES                         06420099
064300        PERFORM 9800-WRITE-OUTPUT-RECORD                          06430000
064400     END-IF.                                                      06440000
064500                                                                  06450000
064600******************************************************************06460000
064700**COMPLETE PROCESSING OF EXTRACT RECORDS IF THEY EXIST            06470000
064800******************************************************************06480000
064900 4900-PROCESS-EXTRA-CPBL-REC.                                     06490099
065000                                                                  06500000
065100     MOVE '4900-PROCESS-EXTRA-CPBL-REC' TO PV-PARAGRAPH-NAME.     06510099
065200                                                                  06520000
065300     MOVE SPACES          TO XL058-TRANS-REC.                     06530099
065400                                                                  06540000
065500     IF  PS-NOT-END-OF-VN-VND-CPBL                                06550099
065600         SET XL058-INSERT   TO TRUE                               06560099
065700         MOVE 'D'  TO XL058-RECORD-TYPE                           06570099
065800         MOVE '04' TO XL058-SORT-SEQUENCE                         06580099
065900         PERFORM 8400-MOVE-VND-CPBL-VALUES                        06590099
066000         PERFORM 9800-WRITE-OUTPUT-RECORD                         06600000
066100         PERFORM 8000-READ-VN-VND-CPBL                            06610099
066200     END-IF.                                                      06620000
066300                                                                  06630000
066400     IF  PS-NOT-END-OF-XLT-VND-CPBL                               06640099
066500          SET XL058-DELETE TO TRUE                                06650099
066600          MOVE 'D'  TO XL058-RECORD-TYPE                          06660099
066700          MOVE '21' TO XL058-SORT-SEQUENCE                        06670099
066800          PERFORM 8400-MOVE-VND-CPBL-VALUES                       06680099
066900          PERFORM 9800-WRITE-OUTPUT-RECORD                        06690099
067000          PERFORM 8100-READ-XLT-VND-CPBL                          06700099
067100     END-IF.                                                      06710000
067200                                                                  06720000
067300 5000-PROCESS-VND-CPBL-CDE.                                       06730099
067400     MOVE '5000-PROCESS-VND-CPBL-CDE      ' TO PV-PARAGRAPH-NAME. 06740099
067500                                                                  06750099
067600     MOVE SPACES          TO XL058-TRANS-REC.                     06760099
067700                                                                  06770099
067800     EVALUATE TRUE                                                06780099
067900     WHEN VN105-VND-CPBL-CDE   = XLT00036-VND-CPBL-CDE            06790099
068000          PERFORM 5200-COMPARE-VND-CPBL-CDE-FLDS                  06800099
068100          PERFORM 9000-READ-VN-VND-CPBL-CDE                       06810099
068200          PERFORM 9100-READ-XLT-VND-CPBL-CDE                      06820099
068300                                                                  06830099
068400     WHEN VN105-VND-CPBL-CDE  > XLT00036-VND-CPBL-CDE             06840099
068500         SET XL058-DELETE     TO TRUE                             06850099
068600         MOVE 'C'             TO XL058-RECORD-TYPE                06860099
068700         MOVE '22'            TO XL058-SORT-SEQUENCE              06870099
068800         PERFORM 9500-MOVE-XLT-VND-CPBL-CDE-VAL                   06880099
068900         PERFORM 9800-WRITE-OUTPUT-RECORD                         06890099
069000         PERFORM 9100-READ-XLT-VND-CPBL-CDE                       06900099
069100                                                                  06910099
069200     WHEN VN105-VND-CPBL-CDE  < XLT00036-VND-CPBL-CDE             06920099
069300          SET XL058-INSERT TO TRUE                                06930099
069400          MOVE 'C'  TO XL058-RECORD-TYPE                          06940099
069500          MOVE '03' TO XL058-SORT-SEQUENCE                        06950099
069600          PERFORM 9400-MOVE-VN-VND-CPBL-CDE-VALS                  06960099
069700          PERFORM 9800-WRITE-OUTPUT-RECORD                        06970099
069800          PERFORM 9000-READ-VN-VND-CPBL-CDE                       06980099
069900     END-EVALUATE.                                                06990099
070000                                                                  07000099
070100******************************************************************07010099
070200** COMPARES ALL NON-PRIMARY FIELDS TO SEE IF DIFFERENCES EXIST    07020099
070300******************************************************************07030099
070400 5200-COMPARE-VND-CPBL-CDE-FLDS.                                  07040099
070500     MOVE '5200-COMPARE-VND-CPBL-CDE-FLDS'                        07050099
070600                                           TO PV-PARAGRAPH-NAME.  07060099
070700                                                                  07070099
070800     IF XLT00036-VND-CPBL-DESC = VN105-VND-CPBL-DESC AND          07080099
070900        XLT00036-ACTV-IND      = VN105-ACTV-IND      AND          07090099
071000        XLT00036-LAST-UPD-BY-USR-ID                               07100099
071100                               = VN105-LAST-UPD-BY-USR-ID AND     07110099
071200        XLT00036-LAST-UPD-TMST = VN105-LAST-UPD-TMST              07120099
071300        CONTINUE                                                  07130099
071400     ELSE                                                         07140099
071500        SET XL058-UPDATE     TO TRUE                              07150099
071600        MOVE 'C'             TO XL058-RECORD-TYPE                 07160099
071700        MOVE '13'            TO XL058-SORT-SEQUENCE               07170099
071800        PERFORM 9400-MOVE-VN-VND-CPBL-CDE-VALS                    07180099
071900        PERFORM 9800-WRITE-OUTPUT-RECORD                          07190099
072000     END-IF.                                                      07200099
072100                                                                  07210099
072200******************************************************************07220099
072300**COMPLETE PROCESSING OF EXTRACT RECORDS IF THEY EXIST            07230099
072400******************************************************************07240099
072500 5900-PROCESS-EXTRA-CPBL-CDE.                                     07250099
072600                                                                  07260099
072700     MOVE '5900-PROCESS-EXTRA-CPBL-CDE' TO PV-PARAGRAPH-NAME.     07270099
072800                                                                  07280099
072900     MOVE SPACES          TO XL058-TRANS-REC.                     07290099
073000                                                                  07300099
073100     IF  PS-NOT-END-OF-VN-VND-CPBL-CDE                            07310099
073200         SET XL058-INSERT   TO TRUE                               07320099
073300         MOVE 'C'  TO XL058-RECORD-TYPE                           07330099
073400         MOVE '03' TO XL058-SORT-SEQUENCE                         07340099
073500         PERFORM 9400-MOVE-VN-VND-CPBL-CDE-VALS                   07350099
073600         PERFORM 9800-WRITE-OUTPUT-RECORD                         07360099
073700         PERFORM 9000-READ-VN-VND-CPBL-CDE                        07370099
073800     END-IF.                                                      07380099
073900                                                                  07390099
074000     IF  PS-NOT-END-OF-XLT-VND-CPBL-CDE                           07400099
074100         SET XL058-DELETE TO TRUE                                 07410099
074200         MOVE 'C'  TO XL058-RECORD-TYPE                           07420099
074300         MOVE '22' TO XL058-SORT-SEQUENCE                         07430099
074400         PERFORM 9500-MOVE-XLT-VND-CPBL-CDE-VAL                   07440099
074500         PERFORM 9800-WRITE-OUTPUT-RECORD                         07450099
074600         PERFORM 9100-READ-XLT-VND-CPBL-CDE                       07460099
074700     END-IF.                                                      07470099
074800                                                                  07480099
074900******************************************************************07490099
075000*            I N P U T   F I L E   R E A D S                     *07500099
075100******************************************************************07510000
075200 6000-READ-VN-VND.                                                07520099
075300     MOVE '6000-READ-VN-VND    ' TO PV-PARAGRAPH-NAME.            07530099
075400                                                                  07540000
075500     READ VN-VND-FILE INTO VN100-VENDOR-EXTRACT-RECD              07550099
075600       AT END                                                     07560000
075700         SET PS-END-OF-VN-VND    TO TRUE                          07570099
075800         SET PS-EMPTY-FILE       TO TRUE.                         07580000
075900                                                                  07590000
076000     IF  PS-NOT-END-OF-VN-VND                                     07600099
076100         ADD +1 TO PC-VN-VND-RECS-READ                            07610099
076200     END-IF.                                                      07620000
076300                                                                  07630000
076400******************************************************************07640000
076500 6100-READ-XLT-VND.                                               07650099
076600     MOVE '6100-READ-XLT-VND ' TO PV-PARAGRAPH-NAME.              07660099
076700                                                                  07670000
076800     READ XLT-VND-FILE INTO DCLXLT00035                           07680099
076900       AT END                                                     07690000
077000         SET PS-END-OF-XLT-VND TO TRUE                            07700099
077100         SET PS-EMPTY-FILE     TO TRUE.                           07710099
077200                                                                  07720000
077300     IF  PS-NOT-END-OF-XLT-VND                                    07730099
077400         ADD +1 TO PC-XLT-VND-RECS-READ                           07740099
077500     END-IF.                                                      07750000
077600                                                                  07760000
077700***************************************************************** 07770000
077800**MOVES VN VENDOR EXTRACT VALUES TO OUTPUT FILE                   07780099
077900***************************************************************** 07790000
078000 6400-MOVE-VN-VENDOR-VALUES.                                      07800099
078100     MOVE VN100-ENT-ID             TO XL058-VEND-ENT-ID           07810099
078200     MOVE VN100-VND-NBR            TO XL058-VEND-VND-NBR          07820099
078300     MOVE VN100-PRIM-TYP-CDE       TO XL058-VEND-VND-TYP-CDE      07830099
078400     MOVE VN100-PRTNR-TYP-CDE      TO XL058-VEND-PRTNR-TYP-CDE    07840099
078500     MOVE VN100-PRIMARY-NAME       TO XL058-VEND-PRIM-VND-NM      07850099
078600     MOVE VN100-STATUS-CDE         TO XL058-VEND-STAT-CDE         07860099
078700     MOVE VN100-SCAC-CDE           TO XL058-VEND-SCAC-CDE         07870099
078800     MOVE VN100-CFY-SLSRNK-NBR     TO XL058-VEND-CFY-SLSRNK-NBR   07880099
078900     MOVE VN100-PFY-SLSRNK-NBR     TO XL058-VEND-PFY-SLSRNK-NBR   07890099
079000     MOVE VN100-P12MN-SLSRNK-NBR   TO XL058-VEND-P12MN-SLSRNK-NBR 07900099
079100     MOVE VN100-EDI-PO-PREPK-CDE   TO XL058-VEND-EDI-PO-PREPK-CDE.07910099
079200     MOVE VN100-SHRT-VND-NM        TO XL058-VEND-SHRT-VND-NM.     07920099
079300                                                                  07930000
079400***************************************************************** 07940000
079500**MOVES XLT VENDOR EXTRACT VALUES TO OUTPUT FILE                  07950099
079600***************************************************************** 07960000
079700 6500-MOVE-XLT-VENDOR-VALUES.                                     07970099
079800       MOVE XLT00035-ENT-ID      TO XL058-VEND-ENT-ID             07980099
079900       MOVE XLT00035-VND-NBR     TO XL058-VEND-VND-NBR            07990099
080000       MOVE XLT00035-VND-TYP-CDE TO XL058-VEND-VND-TYP-CDE        08000099
080100       MOVE XLT00035-PRTNR-TYP-CDE                                08010099
080200                                 TO XL058-VEND-PRTNR-TYP-CDE      08020099
080300       MOVE XLT00035-PRIM-VND-NM TO XL058-VEND-PRIM-VND-NM        08030099
080400       MOVE XLT00035-STAT-CDE    TO XL058-VEND-STAT-CDE           08040099
080500       MOVE XLT00035-SCAC-CDE    TO XL058-VEND-SCAC-CDE           08050099
080600       MOVE XLT00035-CFY-SLSRNK-NBR                               08060099
080700                                 TO XL058-VEND-CFY-SLSRNK-NBR     08070099
080800       MOVE XLT00035-PFY-SLSRNK-NBR                               08080099
080900                                 TO XL058-VEND-PFY-SLSRNK-NBR     08090099
081000       MOVE XLT00035-P12MN-SLSRNK-NBR                             08100099
081100                                 TO XL058-VEND-P12MN-SLSRNK-NBR   08110099
081200       MOVE XLT00035-EDI-PO-PREPK-CDE                             08120099
081300                                 TO XL058-VEND-EDI-PO-PREPK-CDE   08130099
081400       MOVE XLT00035-SHRT-VND-NM TO XL058-VEND-SHRT-VND-NM.       08140099
081500                                                                  08150000
081600******************************************************************08160000
081700*            I N P U T   F I L E   R E A D S                     *08170000
081800******************************************************************08180000
081900 7000-READ-VN-VND-DEPT.                                           08190099
082000     MOVE '7000-READ-VN-VND-DEPT      ' TO      PV-PARAGRAPH-NAME.08200099
082100                                                                  08210000
082200     READ VN-VND-DEPT-FILE INTO VN101-VENDOR-DEPT-EXTR            08220099
082300       AT END                                                     08230000
082400         SET PS-END-OF-VN-VND-DEPT TO TRUE                        08240099
082500         SET PS-EMPTY-FILE         TO TRUE.                       08250099
082600                                                                  08260000
082700     IF  PS-NOT-END-OF-VN-VND-DEPT                                08270099
082800         ADD +1 TO PC-VN-VND-DEPT-RECS-READ                       08280099
082900     END-IF.                                                      08290000
083000                                                                  08300000
083100******************************************************************08310000
083200 7100-READ-XLT-VND-DEPT.                                          08320099
083300     MOVE '7100-READ-XLT-VND-DEPT ' TO PV-PARAGRAPH-NAME.         08330099
083400                                                                  08340000
083500     READ XLT-VND-DEPT-FILE INTO DCLXLT00039                      08350099
083600       AT END                                                     08360000
083700         SET PS-END-OF-XLT-VND-DEPT TO TRUE                       08370099
083800         SET PS-EMPTY-FILE          TO TRUE.                      08380099
083900                                                                  08390000
084000     IF  PS-NOT-END-OF-XLT-VND-DEPT                               08400099
084100         ADD +1 TO PC-XLT-VND-DEPT-RECS-READ                      08410099
084200     END-IF.                                                      08420000
084300                                                                  08430000
084400***************************************************************** 08440000
084500**MOVES VN VENDOR DEPT VALUES TO OUTPUT FILE                      08450099
084600***************************************************************** 08460000
084700 7400-MOVE-VN-VND-DEPT-VALUES.                                    08470099
084800                                                                  08480000
084900     PERFORM 3300-CONVERT-DC-RET-CDE.                             08490099
085000     MOVE VN101-ENT-ID           TO XL058-VNDP-ENT-ID.            08500099
085100     MOVE PV-VN101-DEPT-NBR      TO XL058-VNDP-DEPT-NBR.          08510099
085200     MOVE PV-DC-RET-CDE          TO XL058-VNDP-DC-RET-CDE.        08520099
085300     MOVE VN101-VEND-TYP-IND     TO XL058-VNDP-DEPT-TYP-CDE.      08530099
085400     MOVE VN101-VND-DEPT-STAT-CD TO XL058-VNDP-VND-DEPT-STAT-CDE. 08540099
085500                                                                  08550099
085600***************************************************************** 08560000
085700**MOVES XLT VENDOR DEPARTMENT VALUES TO OUTPUT FILE               08570099
085800***************************************************************** 08580000
085900 7500-MOVE-XLT-VND-DEPT-VALUES.                                   08590099
086000                                                                  08600000
086100     PERFORM 3300-CONVERT-DC-RET-CDE.                             08610099
086200     MOVE XLT00039-ENT-ID           TO XL058-VNDP-ENT-ID.         08620099
086300     MOVE XLT00039-DEPT-NBR         TO XL058-VNDP-DEPT-NBR.       08630099
086400     MOVE XLT00039-DC-RET-CDE       TO XL058-VNDP-DC-RET-CDE.     08640099
086500     MOVE XLT00039-DEPT-TYP-CDE     TO XL058-VNDP-DEPT-TYP-CDE.   08650099
086600     MOVE XLT00039-VND-DEPT-STAT-CDE                              08660099
086700                                  TO XL058-VNDP-VND-DEPT-STAT-CDE.08670099
086800                                                                  08680000
086900******************************************************************08690000
087000*            I N P U T   F I L E   R E A D S                     *08700000
087100******************************************************************08710000
087200 8000-READ-VN-VND-CPBL.                                           08720099
087300     MOVE '8000-READ-VN-VND-CPBL ' TO PV-PARAGRAPH-NAME.          08730099
087400                                                                  08740000
087500     READ VN-VND-CPBL-FILE INTO VN104-CAPABILITY-EXTRACT-RECD     08750099
087600       AT END                                                     08760000
087700         SET PS-END-OF-VN-VND-CPBL TO TRUE                        08770099
087800         SET PS-EMPTY-FILE         TO TRUE.                       08780099
087900                                                                  08790000
088000     IF  PS-NOT-END-OF-VN-VND-CPBL                                08800099
088100         ADD +1 TO PC-VN-VND-CPBL-RECS-READ                       08810099
088200     END-IF.                                                      08820000
088300                                                                  08830000
088400******************************************************************08840000
088500 8100-READ-XLT-VND-CPBL.                                          08850099
088600     MOVE '8100-READ-XLT-VND-CPBL      ' TO     PV-PARAGRAPH-NAME.08860099
088700                                                                  08870000
088800     READ XLT-VND-CPBL-FILE INTO DCLXLT00037                      08880099
088900       AT END                                                     08890000
089000         SET PS-END-OF-XLT-VND-CPBL TO TRUE                       08900099
089100         SET PS-EMPTY-FILE          TO TRUE.                      08910099
089200                                                                  08920000
089300     IF  PS-NOT-END-OF-XLT-VND-CPBL                               08930099
089400         ADD +1 TO PC-XLT-VND-CPBL-RECS-READ                      08940099
089500     END-IF.                                                      08950000
089600                                                                  08960000
089700                                                                  08970000
089800***************************************************************** 08980000
089900**MOVES VN VENDOR CAPABLILITY VALUES TO OUTPUT FILE               08990099
090000***************************************************************** 09000000
090100 8400-MOVE-VND-CPBL-VALUES.                                       09010099
090200                                                                  09020000
090300     MOVE VN104-ENT-ID           TO XL058-VNCP-ENT-ID.            09030099
090400     MOVE VN104-VND-CPBL-CDE     TO XL058-VNCP-VND-CPBL-CDE.      09040099
090500     MOVE VN104-EFF-BEG-DTE      TO XL058-VNCP-EFF-BEG-DTE.       09050099
090600     MOVE VN104-EFF-END-DTE      TO XL058-VNCP-EFF-END-DTE.       09060099
090700     MOVE VN104-CRE-DTE          TO XL058-VNCP-CRE-DTE.           09070099
090800     MOVE VN104-LAST-UPD-TMST    TO XL058-VNCP-LAST-UPD-TMST.     09080099
090900     MOVE VN104-LAST-UPD-BY-USR-ID                                09090099
091000                                 TO XL058-VNCP-LAST-UPD-BY-USR-ID.09100099
091100                                                                  09110000
091200***************************************************************** 09120000
091300**MOVES XLT VENDOR CAPABILITY EXTRACT VALUES TO OUTPUT FILE       09130099
091400***************************************************************** 09140000
091500 8500-MOVE-XLT-VND-CPBL-VALUES.                                   09150099
091600                                                                  09160000
091700     MOVE XLT00037-ENT-ID        TO XL058-VNCP-ENT-ID.            09170099
091800     MOVE XLT00037-VND-CPBL-CDE  TO XL058-VNCP-VND-CPBL-CDE.      09180099
091900     MOVE XLT00037-EFF-BEG-DTE   TO XL058-VNCP-EFF-BEG-DTE.       09190099
092000     MOVE XLT00037-EFF-END-DTE   TO XL058-VNCP-EFF-END-DTE.       09200099
092100     MOVE XLT00037-CRE-DTE       TO XL058-VNCP-CRE-DTE.           09210099
092200     MOVE XLT00037-LAST-UPD-TMST TO XL058-VNCP-LAST-UPD-TMST.     09220099
092300     MOVE XLT00037-LAST-UPD-BY-USR-ID                             09230099
092400                                 TO XL058-VNCP-LAST-UPD-BY-USR-ID.09240099
092500                                                                  09250099
092600******************************************************************09260099
092700*            I N P U T   F I L E   R E A D S                     *09270099
092800******************************************************************09280099
092900 9000-READ-VN-VND-CPBL-CDE.                                       09290099
093000     MOVE '9000-READ-VN-VND-CPBL-CDE ' TO PV-PARAGRAPH-NAME.      09300099
093100                                                                  09310099
093200     READ VN-VND-CPBL-CDE-FILE INTO                               09320099
093300                                 VN105-CAPABILITY-CD-EXTRCT-REC   09330099
093400       AT END                                                     09340099
093500         SET PS-END-OF-VN-VND-CPBL-CDE TO TRUE                    09350099
093600         SET PS-EMPTY-FILE             TO TRUE.                   09360099
093700                                                                  09370099
093800     IF  PS-NOT-END-OF-VN-VND-CPBL-CDE                            09380099
093900         ADD +1 TO PC-VN-VND-CPBL-CDE-RECS-READ                   09390099
094000     END-IF.                                                      09400099
094100                                                                  09410099
094200******************************************************************09420099
094300 9100-READ-XLT-VND-CPBL-CDE.                                      09430099
094400     MOVE '9100-READ-XLT-VND-CPBL-CDE  ' TO     PV-PARAGRAPH-NAME.09440099
094500                                                                  09450099
094600     READ XLT-VND-CPBL-CDE-FILE INTO DCLXLT00036                  09460099
094700       AT END                                                     09470099
094800         SET PS-END-OF-XLT-VND-CPBL-CDE TO TRUE                   09480099
094900         SET PS-EMPTY-FILE              TO TRUE.                  09490099
095000                                                                  09500099
095100     IF  PS-NOT-END-OF-XLT-VND-CPBL-CDE                           09510099
095200         ADD +1 TO PC-XLT-VND-CPBL-CDE-RECS-READ                  09520099
095300     END-IF.                                                      09530099
095400                                                                  09540099
095500                                                                  09550099
095600***************************************************************** 09560099
095700**MOVES VN VENDOR EXTRACT VALUES TO OUTPUT FILE                   09570099
095800***************************************************************** 09580099
095900 9400-MOVE-VN-VND-CPBL-CDE-VALS.                                  09590099
096000                                                                  09600099
096100     MOVE VN105-VND-CPBL-CDE     TO XL058-VNCD-VND-CPBL-CDE.      09610099
096200     MOVE VN105-VND-CPBL-DESC    TO XL058-VNCD-VND-CPBL-DESC.     09620099
096300     MOVE VN105-ACTV-IND         TO XL058-VNCD-ACTV-IND.          09630099
096400     MOVE VN105-LAST-UPD-TMST    TO XL058-VNCD-LAST-UPD-TMST.     09640099
096500     MOVE VN105-LAST-UPD-BY-USR-ID                                09650099
096600                                 TO XL058-VNCD-LAST-UPD-BY-USR-ID.09660099
096700                                                                  09670099
096800***************************************************************** 09680099
096900**MOVES DB2 MDSE EXTRACT VALUES TO OUTPUT FILE                    09690099
097000***************************************************************** 09700099
097100 9500-MOVE-XLT-VND-CPBL-CDE-VAL.                                  09710099
097200                                                                  09720099
097300     MOVE XLT00036-VND-CPBL-CDE  TO XL058-VNCD-VND-CPBL-CDE.      09730099
097400     MOVE XLT00036-VND-CPBL-DESC TO XL058-VNCD-VND-CPBL-DESC.     09740099
097500     MOVE XLT00036-ACTV-IND      TO XL058-VNCD-ACTV-IND.          09750099
097600     MOVE XLT00036-LAST-UPD-TMST TO XL058-VNCD-LAST-UPD-TMST.     09760099
097700     MOVE XLT00036-LAST-UPD-BY-USR-ID                             09770099
097800                                 TO XL058-VNCD-LAST-UPD-BY-USR-ID.09780099
097900                                                                  09790000
098000******************************************************************09800000
098100******************************************************************09810000
098200 9800-WRITE-OUTPUT-RECORD.                                        09820000
098300                                                                  09830000
098400     WRITE OUTPUT-FILE-REC FROM XL058-TRANS-REC.                  09840099
098500                                                                  09850000
098600     ADD +1                   TO PC-DIFFER-RECORD-WRITTEN.        09860000
098700                                                                  09870000
098800     IF CC-DATA-INTEGRITY                                         09880000
098900         MOVE 4094 TO RETURN-CODE                                 09890000
099000     END-IF.                                                      09900000
099100                                                                  09910000
099200******************************************************************09920000
099300*  ABEND ROUTINE                                                 *09930000
099400******************************************************************09940000
099500 9900-XLT-ABEND.                                                  09950099
099600                                                                  09960000
099700     MOVE SQLCODE TO PV-SQLCODE.                                  09970000
099800     DISPLAY '*** DB2 ERROR '.                                    09980000
099900     DISPLAY '*** SQLCODE   = ' PV-SQLCODE.                       09990000
100000     DISPLAY '*** PROGRAM   = ' PV-ABEND-PROGRAM.                 10000000
100100     DISPLAY '*** PARAGRAPH = ' PV-ABEND-PARAGRAPH.               10010000
100200     DISPLAY '*** OPERATION = ' PV-ABEND-OPERATION.               10020000
100300     DISPLAY '*** MESSAGE   = ' PV-XLT-OPERATION-MESSAGE-1.       10030099
100400     DISPLAY '***           = ' PV-XLT-OPERATION-MESSAGE-2.       10040099
100500     DISPLAY '*** TABLE 1   = ' PV-XLT-TABLE-NAME-1.              10050099
100600     DISPLAY '*** TABLE 2   = ' PV-XLT-TABLE-NAME-2.              10060099
100700                                                                  10070000
100800     DISPLAY 'ENT_ID         = ' PV-DISPLAY-ENT-ID.               10080099
100900     DISPLAY 'DEPT_NBR       = ' PV-DISPLAY-DEPT-NBR.             10090099
101000                                                                  10100000
101100     COPY DPPD004.                                                10110000
101200                                                                  10120000
101300     MOVE +4013 TO PV-ABEND-CODE.                                 10130000
101400     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         10140000
101500                                                                  10150000
101600******************************************************************10160000
101700*                 E N D   O F   J O B                            *10170000
101800******************************************************************10180000
101900 9999-TERMINATE.                                                  10190000
102000     MOVE '9999-TERMINATE                ' TO PV-PARAGRAPH-NAME.  10200000
102100                                                                  10210000
102200     CLOSE VN-VND-FILE                                            10220099
102300           XLT-VND-FILE                                           10230099
102400           VN-VND-DEPT-FILE                                       10240099
102500           XLT-VND-DEPT-FILE                                      10250099
102600           VN-VND-CPBL-FILE                                       10260099
102700           XLT-VND-CPBL-FILE                                      10270099
102800           VN-VND-CPBL-CDE-FILE                                   10280099
102900           XLT-VND-CPBL-CDE-FILE                                  10290099
103000           OUTPUT-FILE.                                           10300000
103100                                                                  10310000
103200     PERFORM 9999-DISPLAY-STATISTICS.                             10320000
103300                                                                  10330000
103400****************************************************************  10340000
103500*DISPLAY PROGRAM STATISTICS                                       10350000
103600****************************************************************  10360000
103700 9999-DISPLAY-STATISTICS.                                         10370000
103800                                                                  10380000
103900     DISPLAY ' '.                                                 10390000
104000     DISPLAY '**************************************************'.10400000
104100     DISPLAY 'PROGRAM.................'   PC-CURRENT-PROGRAM-NAME.10410000
104200     DISPLAY 'VN  VENDOR RECS READ    = ' PC-VN-VND-RECS-READ.    10420099
104300     DISPLAY 'XLT VENDOR RECS READ    = ' PC-XLT-VND-RECS-READ.   10430099
104400     DISPLAY ' '.                                                 10440000
104500     DISPLAY 'VN  VEND DEPT RECS READ = '                         10450099
104600                                     PC-VN-VND-DEPT-RECS-READ.    10460099
104700     DISPLAY 'XLT VEND DEPT RECS READ = '                         10470099
104800                                     PC-XLT-VND-DEPT-RECS-READ.   10480099
104900     DISPLAY ' '.                                                 10490000
105000     DISPLAY 'VN  VEND CPBL RECS READ  = '                        10500099
105100                                     PC-VN-VND-CPBL-RECS-READ.    10510099
105200     DISPLAY 'XLT VEND CPBL RECS READ  = '                        10520099
105300                                     PC-XLT-VND-CPBL-RECS-READ.   10530099
105400     DISPLAY ' '.                                                 10540000
105500     DISPLAY 'VN  VEND CPBL CDE RECS READ = '                     10550099
105600                                   PC-VN-VND-CPBL-CDE-RECS-READ.  10560099
105700     DISPLAY 'XLT VEND CPBL CDE RECS READ  = '                    10570099
105800                                   PC-XLT-VND-CPBL-CDE-RECS-READ. 10580099
105900     DISPLAY ' '.                                                 10590099
106000     DISPLAY 'DIFFER RECORDS WRITTEN: '                           10600000
106100     DISPLAY                            PC-DIFFER-RECORD-WRITTEN. 10610000
106200     DISPLAY '**************************************************'.10620000
