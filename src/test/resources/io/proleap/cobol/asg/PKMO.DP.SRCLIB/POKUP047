       IDENTIFICATION DIVISION.                                         00010000
       PROGRAM-ID.    POKUP047.                                         00020000
       AUTHOR.        RYAN STAUFFACHER.                                 00030000
       DATE-WRITTEN.  09/03.                                            00040000
      ******************************************************************00050000
      *   VENDOR-GENERATED PURCHASE ORDER CREATION                      00060000
      *                                                                 00070000
      *   INSERT VENDOR-GENERATED (EDI) PURCHASE ORDERS TO DB2 DATABASE 00080000
      *                                                                 00090000
      *   THE CURRENT VENDOR GENERATED PO NUMBER RANGES.                00100000
      *       JOCKEY               -   1,500,000 - 1,999,999            00110000
      *       JOCKEY               -   3,700,000 - 3,999,999            00120000
      * N/A   SARA LEE INTIMATES   -   2,400,000 - 2,499,999            00130000
      *       HANES                -   BUYING OFFICE GIVES OUT          00140000
      * N/A   MULBERRY NECKWEAR    -   2,600,000 - 2,699,999            00150000
      *       HALLMARK             -   2,700,000 - 3,499,999            00160000
      * N/A   CARLTON CARDS        -   3,500,000 - 3,599,999            00170000
      *       VANITY FAIR          -   6,100,000 - 6,199,999            00180000
      *       LILY OF FRANCE       -   6,200,000 - 6,299,999            00190000
      *       ESTEE LAUDER         -   6,300,000 - 6,399,999            00200000
      *       LEE WRANGLER         -   6,400,000 - 6,499,999            00210000
      *       FISHMAN & TOBIN      -   6,500,000 - 6,500,099            00220000
      *       OLGA/WARNER          -   6,510,000 - 6,519,999            00230000
      *       PLAYTEX INTIMATES    -   6,520,000 - 6,522,999            00240000
      *       BALI                 -   6,523,000 - 6,525,999            00250000
      *       WONDERBRA            -   6,526,000 - 6,528,999            00260000
      *       TOP OF THE WORLD     -   6,529,000 - 6,533,999            00270000
      *       VF IMAGEWEAR         -   6,534,000 - 6,538,999            00280000
      *       KNIGHTS APPAREL      -   6,540,000 - 6,549,999            00290000
      *       NEXT INC             -   6,550,000 - 6,559,999            00300000
352053*       47BRAND LLC          -   6,560,000 - 6,562,999            00310000
      *       SUPREME INTERNATIONAL-   6,563,000 - 6,567,999            00320000
      *       COLLEGE CONCEPTS     -   6,568,000 - 6,572,999            00330000
      *       RUSSELL ATHLETIC     -   6,573,000 - 6,577,999            00340000
      *       OUTERSTUFF           -   6,578,000 - 6,582,999            00350000
      *       HADDAD               -   6,583,000 - 6,587,999            00360000
      *       HANES UNDERWEAR      -   6,588,000 - 6,592,999            00370000
      *       COKEM                -   6,593,000 - 6,593,999            00380000
      *       GEAR FOR SPORTS      -   6,594,000 - 6,598,999            00390000
      *       COLOSSEUM ATHLETICS  -   6,599,000 - 6,603,999            00400000
      *       SPORTS LICENSED DIVISION 6,604,000 - 6,608,999            00410000
      *       RENAISSANCE IMPORTS  -   6,609,000 - 6,613,999            00420000
WR9604*       LEVI STRAUSS & CO    -   6,614,000 - 6,623,999            00430000
NEWRNG*       VF IMAGEWARE         -   6,624,000 - 6,633,999            00440000
BALIIN*       BALI INTIMATES       -   6,634,000 - 6,643,999            00450000
RCKRPB*       LEE - ROCK & REPUBLIC-   6,644,000 - 6,644,999            00460000
OUTRST*       OUTERSTUFF           -   6,645,000 - 6,654,999 ADDL BLOCK 00470000
RCKRPB*       LEE - ROCK & REPUBLIC-   6,655,000 - 6,655,999 ADDL BLOCK 00480000
      *       LIZ CLAIBORNE        -   BUYING OFFICES PROVIDE           00490000
WR0933* N/A   T-SHIRT INTERNATIONAL-   TSI WILL USE 'NEXT INC' PO BLOCK 00500000
W41905*       JACMEL JEWELRY       -   6,656,000 - 6,658,999            00510000
W41952*       G-III LEATHER FASHIONS-  6,659,000 - 6,661,999            00520000
W42092*       PVH SUPERBA           -  6,662,000 - 6,664,999            00530000
WXXXXX*       RENAISSANCE IMPORTS   -  6,665,000 - 6,666,999 ADDL BLOCK 00540000
WXXXXX*       WRANGLER              -  6,667,000 - 6,671,999 ADDL BLOCK 00550000
WXXXXX*                              (WRANGLER SHARE TRADING PARTNER ID 00560000
WXXXXX*                              WITH LEE CO/WRANGLER -01/007131501)00570000
534202*       J AMERICA             -  6,672,000 - 6,673,999            00580000
732468*       SUPREME INTERNATIONAL -  6,674,000 - 6,678,999 ADDL BLOCK 00590000
      *       OUTERSTUFF            -  6,679,000 - 6,683,999 ADDL BLOCK 00600000
453643*       ETERNAL FORTUNE FASHION- 98,106,000 - 98,106,499          00610000
494672*       HAGGAR CLOTHING COMPANY- 98,156,000 - 98,160,999          00620000
686121*       WILLIAMSON-DICKIE MFG CO - 98,161,000 - 98,163,999        00630000
102069*       G-III LEATHER FASHIONS-98,164,000 - 98,164,999 ADDL BLOCK 00640000
371617*       NEW ERA CAP CO INC       - 98,149,500 - 98,149,999        00650000
505256*       MAIDENFORM INC           - 98,166,500 - 98,171,499        00660000
683003*       RANDA ACCESSORIES        - 98,171,500 - 98,176,499        00670000
683026*       RANDA CORP               - 98,176,500 - 98,181,499        00680000
944205*       BOELTER COMPANIES        - 98,181,500 - 98,191,499        00690000
002139*       GONZALES ENT INC         - 98,191,500 - 98,196,499        00700000
323391*       CC PRODUCTS              - 98,201,501 - 98,206,500        00710000
647062*       LUXOTTICA USA LLC        - 98,206,501 - 98,211,499        00720000
042023*       CC PRODUCTS(EDI TP/ID CHG) - 98,201,501 - 98,206,500      00730000
018127*       TERVIS TUMBLER             - 98,211,500 - 98,231,599      00740000
356324*       PERRY ELLIS MENSWEAR       - 98,231,600 - 98,241,599      00750000
637834*       OURAY SPORTSWEAR           - 98,253,600 - 98,258,599      00760000
185577*       BESPOKE FASHION LLC        - 98,298,600 - 98,299,599      00770000
790723*       FGX INTERNATIONAL INC      - 98,301,600 - 98,302,599      00780000
956632*       RANDA LUGGAGE              - 98,302,600 - 98,303,599      00790000
956632*       LOGO BRANDS INC            - 98,303,600 - 98,304,599      00800000
956632*       GREAT AMERICAN PRODUCTS    - 98,304,600 - 98,305,599      00810000
346771*       MAD ENGINE LLC             - 98,307,600 - 98,308,599      00820000
265129*       HYBRID PROMOTIONS LLC      - 98,308,600 - 98,309,599      00830000
887802*       BIOWORLD MERCHANDISING     - 98,312,600 - 98,313,599      00840000
927044*       NORTHWEST CO/ASHLAND MILL  - 98,314,600 - 98,315,599      00850000
925845*       FOR BARE FEET              - 98,306,600 - 98,307,599      00860000
762449*       MASTERPIECES PUZZLE COMPANY- 98,313,600 - 98,314,599      00870000
889751*       RIPPLE JUNCTION DESIGN CO INC - 98,427,713 - 98,428,713   00880000
064017*       S LICHTENBERG & CO INC     - 98,431,678 - 98,432,478      00890000
176716*       SPIRIT LEATHERWORKS LLC    - 98,432,479 - 98,432,979      00900000
176682*       TEE SHIRT CENTRAL INC      - 98,432,980 - 98,433,480      00910000
680553*       LF MEN'S GROUP LLC         - 98,435,483 - 98,436,483      00911000
      ******************************************************************00920000
      * 09/22/03 - RYAN STAUFFACHER  WR23521                           *00930000
      *          - PROGRAM WILL ONLY PROCESS ORDERS WHERE THE DEPT     *00940000
      *          - ADDED XLWS001 COPYBOOK FOR XLKUT001 DOMAIN PROGRAM  *00950000
      ******************************************************************00960000
      * 11/13/03 - RYAN STAUFFACHER  WR26136                           *00970000
      *          - ADDED LILY OF FRANCE                                *00980000
      ******************************************************************00990000
      * 04/21/04 - RYAN STAUFFACHER  WR26811                           *01000000
      *          - ADDED ESTEE LAUDER                                  *01010000
      ******************************************************************01020000
      * 07/21/04 - RYAN STAUFFACHER  WR26811                           *01030000
      *          - ADDED LIZ CLAIBORNE                                 *01040000
      ******************************************************************01050000
      * 10/12/05 - RYAN STAUFFACHER  WR29605                           *01060000
      *          - ADDED LEE WRANGLER                                  *01070000
      ******************************************************************01080000
      * 03/22/06 - RYAN STAUFFACHER  WR30495                           *01090000
      *          - ADDED FISHMAN AND TOBIN                             *01100000
      ******************************************************************01110000
      * 04/13/06 - RYAN STAUFFACHER  WR30619                           *01120000
      *          - ADDED OLGA/WARNER                                   *01130000
      ******************************************************************01140000
      * 07/07/06 - RYAN STAUFFACHER  WR30986                           *01150000
      *          - ADDED PLAYTEX/BALI/WONDERBRA                        *01160000
      ******************************************************************01170000
      * 07/07/06 - RYAN STAUFFACHER  WR31009                           *01180000
      *          - ADDED TOP OF THE WORLD                              *01190000
      ******************************************************************01200000
      * 09/05/06 - RYAN STAUFFACHER  WR31264                           *01210000
      *          - ADDED VF IMAGEWEAR                                  *01220000
      ******************************************************************01230000
      * 09/21/06 - RYAN STAUFFACHER  WR31375                           *01240000
      *          - ADDED KNIGHTS APPAREL                               *01250000
      ******************************************************************01260000
      * 01/11/07 - RYAN STAUFFACHER  WR31915                           *01270000
      *          - ADDED NEXT INC                                      *01280000
      ******************************************************************01290000
      * 04/12/07 - CINDY HANSEN      WR32276                           *01300000
      *          - ADDED TWINS NEW YORK                                *01310000
      ******************************************************************01320000
      * 04/27/07 - RYAN STAUFFACHER  WR32671                           *01330000
      *          - ADDED DIRECT TO STORE LOGIC                         *01340000
      ******************************************************************01350000
      * 04/30/07 - RYAN STAUFFACHER  WR32745                           *01360000
      *          - ADDED SUPREME INTERNATIONAL                         *01370000
      ******************************************************************01380000
      * 05/21/07 - CINDY HANSEN      WR32636                           *01390000
      *          - ADDED COLLEGE CONCEPTS                              *01400000
      ******************************************************************01410000
      * 05/31/07 - RYAN STAUFFACHER  WR32891                           *01420000
      *          - ADDED RUSSELL ATHLETIC                              *01430000
      ******************************************************************01440000
      * 06/22/07 - JACK KRAMER       WR33081                           *01450000
      *          - ADDED OUTERSTUFF                                    *01460000
      ******************************************************************01470000
      * 08/20/07 - RYAN STAUFFACHER  WR33366                           *01480000
      *          - ADDED HADDAD                                        *01490000
      ******************************************************************01500000
      * 10/31/07 - RYAN STAUFFACHER  WR33721                           *01510000
      *          - ADDED HANES UNDERWEAR                               *01520000
      ******************************************************************01530000
      * 05/16/08 - RYAN STAUFFACHER  WR34833                           *01540000
      *          - ADDED GEAR FOR SPORTS                               *01550000
      ******************************************************************01560000
      * 06/10/09 - RYAN STAUFFACHER  WR36799                           *01570000
      *          - ADDED COLOSSEUM ATHLETICS                           *01580000
      ******************************************************************01590000
      *07/07/09 - RYAN STAUFFACHER  WR36942                           * 01600000
      *          - ADDED CHAMPION CUSTOM                               *01610000
      ******************************************************************01620000
      *12/17/09 - RYAN STAUFFACHER  WR37612                           * 01630000
      *          - ADDED SPORTS LICENSED DIVISION OF                   *01640000
      ******************************************************************01650000
      *07/28/10 - COGNIZANT(KARTHIK KRISHNA K) WR38861                 *01660000
      *          - MOVED 'N' TO A NEW FIELD "PO025-HDR-WHSE-RPLNT-IND  *01670000
      *            IN PARA: 12500-FORMAT-API-HEADER &                  *01680000
      *                     13000-PROCESS-HEADER                       *01690000
      ******************************************************************01700000
      *08/27/10 - RYAN STAUFFACHER  WR38822                            *01710000
      *          - ADDED RENAISSANCE IMPORTS                           *01720000
      ******************************************************************01730000
      ******************************************************************01740000
WR9604*03/01/11 - SAI  PRIYA        WR39604                            *01750000
      *          - ADDED LEVI STRAUSS & CO                             *01760000
      ******************************************************************01770000
WR0933******************************************************************01780000
WR0933*04/04/12 - JAYAPRAKHASHAM    WR40933                            *01790000
WR0933*          - ADDED T-SHIRT INTERNATIONAL                         *01800000
WR0933*          - T-SHIRT INTERNATIONAL HAS ABSORBED NEXT INC. HENCE, *01810000
WR0933*          - TSI WILL BE USING THE PO'S BLOCK OF NEXT INC.       *01820000
WR0933******************************************************************01830000
WR7746*06/22/12 - JOHN SELWITSCHKA                                     *01840000
WR7746*          - ASSIGN DELIVERY STRATEGY                            *01850000
WR7746*          - ASSIGN INNER AND OUTER PK QTY                       *01860000
WR7746******************************************************************01870000
W41905*04/26/13  - COGNIZANT        WR41905                            *01880000
W41905*          - ADDED JACMEL JEWELERY                               *01890000
W41952*04/26/13  - COGNIZANT        WR41952                            *01900000
W41952*          - ADDED G-III LEATHER FASHIONS                        *01910000
W41905******************************************************************01920000
P41269*04/26/13 - COGNIZANT                                            *01930000
P41269*          - ADDED 'WITH UR' IN SELECT SQL PARA TO HANDLE        *01940000
P41269*            DEADLOCK ISSUE.                                     *01950000
P41269******************************************************************01960000
W42092*08/16/13  - COGNIZANT        WR42092                            *01970000
W42092*          - ADDED PVH SUPERBA                                    01980000
W42092******************************************************************01990000
CHGID *03/05/14 - COGNIZANT         INC0588831                          02000000
CHGID *         - CHANGED THE EDI TRADING PARTNER ID AS 08/4229981500  *02010000
CHGID *         - INSTEAD OF 12/2035798435 & 12/8187827568 FOR          02020000
CHGID *         - THE VENDOR OLGA AND WARNER'S.                         02030000
CHGID ******************************************************************02040000
534202*04/04/14  - COGNIZANT        INC0534202                         *02050000
534202*          - ADDED J AMERICA                                      02060000
534202******************************************************************02070000
C98147*11/04/14 - LINDA FRIESS      CHG0098147                          02080000
C98147*         - EXPANDED PO NUMBER TO 8 DIGITS - INCLUDING POWS026    02090000
C98147*           COPYBOOK                                              02100000
C98147***************************************************************** 02110000
453643******************************************************************02120000
453643*04/16/15  - COGNIZANT        INC1453643                         *02130000
453643*          - ADDED ETERNAL FORTUNE FASHION                        02140000
453643******************************************************************02150000
494672******************************************************************02160000
494672*04/29/15  - COGNIZANT        INC1494672                         *02170000
494672*          - ADDED HAGGAR CLOTHING COMPANY                        02180000
494672******************************************************************02190000
686121******************************************************************02200000
686121*07/07/15  - COGNIZANT        INC1686121                         *02210000
686121*          - ADDED WILLIAMSON-DICKIE MFG CO                       02220000
686121******************************************************************02230000
371617******************************************************************02240000
371617*02/04/16  - COGNIZANT        INC2371617                         *02250000
371617*          - ADDED NEW ERA CAP CO INC                             02260000
371617******************************************************************02270000
505256******************************************************************02280000
505256*02/29/16  - COGNIZANT        INC2505256                         *02290000
505256*          - ADDED MAIDENFORM INC                                 02300000
505256******************************************************************02310000
683003******************************************************************02320000
683003*04/22/16  - COGNIZANT        INC2683003                         *02330000
683003*          - ADDED RANDA ACCESSORIES                              02340000
683003******************************************************************02350000
683026******************************************************************02360000
683026*04/22/16  - COGNIZANT        INC2683026                         *02370000
683026*          - ADDED RANDA CORP                                     02380000
683026******************************************************************02390000
C98147***************************************************************** 02400000
944205*07/05/16  - COGNIZANT        INC2944205                         *02410000
944205*          - BOELTER COMPANIES                                    02420000
944205******************************************************************02430000
C98147***************************************************************** 02440000
002139*08/12/16  - COGNIZANT        INC3002139                         *02450000
002139*          - GONZALES ENT INC                                     02460000
002139******************************************************************02470000
323391***************************************************************** 02480000
323391*10/25/16  - COGNIZANT        INC3323391                         *02490000
323391*          - GONZALES ENT INC                                     02500000
323391******************************************************************02510000
714055***************************************************************** 02520000
714055*01/17/17  - COGNIZANT        INC3714055                         *02530000
714055*          - CHANGED INTERFACE ID TO "COLOSSEUM ATHLETICS INC"    02540000
714055******************************************************************02550000
647062***************************************************************** 02560000
647062*01/23/17  - COGNIZANT        INC3647062                         *02570000
647062*          - CHANGED INTERFACE ID TO "LUXOTTICA USA LLC"          02580000
647062***************************************************************** 02590000
042023*04/06/17  - COGNIZANT        INC4042023                         *02600000
042023*          - CHANGED INTERFACE ID TO "CC PRODUCTS"                02610000
018127***************************************************************** 02620000
018127*06/30/17  - COGNIZANT        INC4018127                         *02630000
018127*          - TERVIS TUMBLER                                       02640000
647062******************************************************************02650000
356324***************************************************************** 02660000
356324*06/30/17  - COGNIZANT        INC4356324                         *02670000
356324*          - PERRY ELLIS MENSWEAR                                 02680000
647062******************************************************************02690000
002139***************************************************************** 02700000
575459*08/24/17 - COGNIZANT         INC4575459                          02710000
575459*         - ADDED TRADING PARTNER ID 12/9139423258 TO            *02720000
575459*           "GEAR FOR SPORTS" VENDOR                             *02730000
575459******************************************************************02740000
575459******************************************************************02750000
637834******************************************************************02760000
637834*06/19/18 - COGNIZANT         INC5637834                         *02770000
637834*         - OURAY SPORTSWEAR                                     *02780000
637834******************************************************************02790000
756744*10/18/18 - COGNIZANT         INC6756744                          02800000
756744*         - REPLACE INTERCHANGE ID 125175212525 WITH 125176557948*02810000
756744*           FOR "J AMERICA" VENDOR.                               02820000
185577******************************************************************02830000
185577******************************************************************02840000
185577*12/12/18 - COGNIZANT         INC7185577                         *02850000
185577*         - BESPOKE FASHION LLC                                  *02860000
185577******************************************************************02870000
790723******************************************************************02880000
790723*02/28/19 - COGNIZANT         SCTASK0790723                      *02890000
790723*         - FGX INTERNATIONAL INC                                *02900000
790723******************************************************************02910000
956632******************************************************************02920000
956632*05/22/19 - COGNIZANT         INC7956632                         *02930000
956632*         - RANDA LUGGAGE                                        *02940000
956632******************************************************************02950000
956632******************************************************************02960000
956632*05/22/19 - COGNIZANT         INC7956632                         *02970000
956632*         - LOGO BRANDS INC                                      *02980000
956632******************************************************************02990000
956632******************************************************************03000000
956632*05/22/19 - COGNIZANT         INC7956632                         *03010000
956632*         - GREAT AMERICAN PRODUCTS                              *03020000
956632******************************************************************03030000
346771******************************************************************03040000
346771*08/06/19 - COGNIZANT         INC8346771                         *03050000
346771*         - MAD ENGINE LLC                                       *03060000
346771******************************************************************03070000
265129******************************************************************03080000
265129*08/06/19 - COGNIZANT         INC7265129                         *03090000
265129*         - HYBRID PROMOTIONS LLC                                *03100000
265129******************************************************************03110000
887802******************************************************************03120000
887802*10/22/19 - COGNIZANT         INC8887802                         *03130000
887802*         - BIOWORLD MERCHANDISING                               *03140000
887802******************************************************************03150000
927044******************************************************************03160000
927044*10/30/19 - COGNIZANT         INC8927044                         *03170000
927044*         -  NORTHWEST CO/ASHLAND MILL                           *03180000
927044******************************************************************03190000
925845******************************************************************03200000
925845*10/30/19 - COGNIZANT         INC8925845                         *03210000
925845*         - FOR BARE FEET                                        *03220000
925845******************************************************************03230000
762449******************************************************************03240000
762449*09/29/20 - COGNIZANT         INC10762449                        *03250000
762449*         - FOR MASTERPIECES PUZZLE COMPANY                      *03260000
762449******************************************************************03270000
562625******************************************************************03280000
562625*09/29/20 - COGNIZANT         INC11562625                        *03290000
562625*         - FOR BIOWORLD MERCHANDISING INTERCHANGE ID CORRECTION *03300000
562625******************************************************************03310000
000020*04/17/21 - JEAN KURK                                            *03320000
000030*         - REMOVE TABLE TPORESV AND TSTVNDC                     *03330000
000040******************************************************************03340000
352053*08/11/22 - SRINIVASAN SIVARAJ INC13352053                       *03350000
352053*         - CHANGED NAME OF TWINS NEW YORK TO 47BRAND LLC        *03360000
352053******************************************************************03370000
889751******************************************************************03380000
889751*01/04/23 - SRINIVASAN SIVARAJ INC13889751                       *03390000
889751*         - FOR RIPPLE JUNCTION DESIGN CO INC                    *03400000
889751******************************************************************03410000
064017******************************************************************03420000
064017*03/03/23 - SRINIVASAN SIVARAJ INC14064017                       *03430000
064017*         - FOR S LICHTENBERG & CO INC                           *03440000
064017******************************************************************03450000
176716******************************************************************03460000
176716*04/13/23 - SRINIVASAN SIVARAJ INC14176716                       *03470000
176716*         - FOR SPIRIT LEATHERWORKS LLC                          *03480000
176716******************************************************************03490000
176682******************************************************************03500000
176682*04/13/23 - SRINIVASAN SIVARAJ INC14176682                       *03510000
176682*         - FOR TEE SHIRT CENTRAL INC                            *03520000
176682******************************************************************03530000
680553******************************************************************03531000
680553*10/05/23 - SRINIVASAN SIVARAJ INC14680553                       *03532000
680553*         - FOR LF MEN'S GROUP LLC                               *03533000
680553******************************************************************03534000
       ENVIRONMENT DIVISION.                                            03540000
       INPUT-OUTPUT SECTION.                                            03550000
                                                                        03560000
       FILE-CONTROL.                                                    03570000
           SELECT INPUT-FILE                                            03580000
                 ASSIGN TO INP01.                                       03590000
                                                                        03600000
           SELECT CONTROL-OUTPUT-QMGR                                   03610000
                 ASSIGN TO INP02.                                       03620000
                                                                        03630000
           SELECT CONTROL-OUTPUT-QUEUE                                  03640000
                 ASSIGN TO INP03.                                       03650000
                                                                        03660000
           SELECT CONTROL-OUTPUT-QMGR-API                               03670000
                 ASSIGN TO INP04.                                       03680000
                                                                        03690000
           SELECT CONTROL-OUTPUT-QUEUE-API                              03700000
                 ASSIGN TO INP05.                                       03710000
                                                                        03720000
           SELECT ERROR-REPORT                                          03730000
                 ASSIGN TO RPT01.                                       03740000
                                                                        03750000
           SELECT BAD-STORE-REPORT                                      03760000
                 ASSIGN TO RPT02.                                       03770000
                                                                        03780000
       DATA DIVISION.                                                   03790000
       FILE SECTION.                                                    03800000
                                                                        03810000
       FD  INPUT-FILE                                                   03820000
           RECORDING MODE IS F                                          03830000
           LABEL RECORDS ARE STANDARD                                   03840000
           RECORD CONTAINS 350 CHARACTERS                               03850000
           BLOCK CONTAINS 0 RECORDS                                     03860000
           DATA RECORD IS INPUT-RECORD.                                 03870000
                                                                        03880000
       01  INPUT-RECORD                     PIC X(350).                 03890000
                                                                        03900000
       FD  CONTROL-OUTPUT-QMGR                                          03910000
           RECORDING MODE F                                             03920000
           BLOCK CONTAINS 0 RECORDS                                     03930000
           LABEL RECORDS ARE OMITTED.                                   03940000
       01  CONTROL-OUTPUT-QMGR-REC          PIC  X(80).                 03950000
                                                                        03960000
       FD  CONTROL-OUTPUT-QUEUE                                         03970000
           RECORDING MODE F                                             03980000
           BLOCK CONTAINS 0 RECORDS                                     03990000
           LABEL RECORDS ARE OMITTED.                                   04000000
       01  CONTROL-OUTPUT-QUEUE-REC         PIC  X(80).                 04010000
                                                                        04020000
       FD  CONTROL-OUTPUT-QMGR-API                                      04030000
           RECORDING MODE F                                             04040000
           BLOCK CONTAINS 0 RECORDS                                     04050000
           LABEL RECORDS ARE OMITTED.                                   04060000
       01  CONTROL-OUTPUT-QMGR-REC-API      PIC  X(80).                 04070000
                                                                        04080000
       FD  CONTROL-OUTPUT-QUEUE-API                                     04090000
           RECORDING MODE F                                             04100000
           BLOCK CONTAINS 0 RECORDS                                     04110000
           LABEL RECORDS ARE OMITTED.                                   04120000
       01  CONTROL-OUTPUT-QUEUE-REC-API     PIC  X(80).                 04130000
                                                                        04140000
       FD  ERROR-REPORT                                                 04150000
           RECORDING MODE IS F                                          04160000
           LABEL RECORDS ARE OMITTED                                    04170000
           RECORD CONTAINS 132 CHARACTERS                               04180000
           BLOCK CONTAINS 0 RECORDS                                     04190000
           DATA RECORD IS ERROR-RECORD.                                 04200000
                                                                        04210000
       01  ERROR-RECORD                     PIC X(132).                 04220000
                                                                        04230000
       FD  BAD-STORE-REPORT                                             04240000
           RECORDING MODE IS F                                          04250000
           LABEL RECORDS ARE OMITTED                                    04260000
           RECORD CONTAINS 132 CHARACTERS                               04270000
           BLOCK CONTAINS 0 RECORDS                                     04280000
           DATA RECORD IS BAD-STORE-RECORD.                             04290000
                                                                        04300000
       01  BAD-STORE-RECORD                 PIC X(132).                 04310000
                                                                        04320000
       WORKING-STORAGE SECTION.                                         04330000
      *    API CONTROL BLOCKS                                           04340000
                                                                        04350000
       01  MQM-OBJECT-DESCRIPTOR.                                       04360000
           COPY CMQODV.                                                 04370000
       01  MQM-MESSAGE-DESCRIPTOR.                                      04380000
           COPY CMQMDV.                                                 04390000
       01  MQM-OBJECT-DESCRIPTOR-API.                                   04400000
           COPY CMQODV REPLACING MQOD BY MQOA.                          04410000
       01  MQM-MESSAGE-DESCRIPTOR-API.                                  04420000
           COPY CMQMDV REPLACING MQMD BY MQMA.                          04430000
       01  MQM-GET-MESSAGE-OPTIONS.                                     04440000
           COPY CMQGMOV.                                                04450000
       01  MQM-PUT-MESSAGE-OPTIONS.                                     04460000
           COPY CMQPMOV.                                                04470000
       01  MQM-PUT-MESSAGE-OPTIONS-API.                                 04480000
           COPY CMQPMOV REPLACING MQPMO BY MQPMA.                       04490000
                                                                        04500000
      *    MQV CONTAINS CONSTANTS (FOR FILLING IN THE CONTROL BLOCKS)   04510000
      *    AND RETURN CODES (FOR TESTING THE RESULT OF A CALL)          04520000
                                                                        04530000
       01  MQM-CONSTANTS.                                               04540000
           COPY CMQV.                                                   04550000
      *                                                                 04560000
       01  MQ-WORKING-STORAGE.                                          04570000
           05  WS-MQCONN               PIC X(8)  VALUE 'CSQBCONN'.      04580000
           05  WS-MQOPEN               PIC X(8)  VALUE 'CSQBOPEN'.      04590000
           05  WS-MQGET                PIC X(8)  VALUE 'CSQBGET'.       04600000
           05  WS-MQPUT                PIC X(8)  VALUE 'CSQBPUT'.       04610000
           05  WS-MQCMIT               PIC X(8)  VALUE 'CSQBCOMM'.      04620000
           05  WS-MQBACK               PIC X(8)  VALUE 'CSQBBACK'.      04630000
           05  WS-MQCLOSE              PIC X(8)  VALUE 'CSQBCLOS'.      04640000
           05  WS-MQDISC               PIC X(8)  VALUE 'CSQBDISC'.      04650000
           05  WS-SYSWAIT              PIC X(08) VALUE 'SYSWAIT'.       04660000
           05  WS-MQCHECK              PIC X(08) VALUE 'MQR2C'.         04670000
           05  MQPMA-SYNCPOINT         PIC S9(9) BINARY.                04680000
                                                                        04690000
       01  PC-PROGRAM-CONSTANTS.                                        04700000
           05  PC-DELAY-INTERVAL.                                       04710000
               10  FILLER              PIC X(2)     VALUE SPACES.       04720000
               10  PC-DELAY-TIME       PIC 9(8)     VALUE 0500.         04730000
           05  PC-MQ-SERIES-ERROR      PIC X(01)    VALUE 'M'.          04740000
           05  PC-HEADER-SEG           PIC X(02)    VALUE 'HE'.         04750000
           05  PC-SKU-SEG              PIC X(02)    VALUE 'SK'.         04760000
           05  PC-SHIPTO-SEG           PIC X(02)    VALUE 'SH'.         04770000
           05  PC-STORES-SEG           PIC X(02)    VALUE 'ST'.         04780000
           05  PC-PROGRAM-NAME         PIC X(08)    VALUE 'POKUP047'.   04790000
           05  PC-MAX-SKUS             PIC S9(04)   COMP VALUE 999.     04800000
                                                                        04810000
       01  WS-PROGRAM-SWITCHES.                                         04820000
           05  WS-MORE-DCS-SW               PIC  X    VALUE 'Y'.        04830000
               88  WS-MORE-DCS                        VALUE 'Y'.        04840000
               88  WS-NO-MORE-DCS                     VALUE 'N'.        04850000
           05  WS-MORE-INPUT-SW             PIC  X    VALUE 'Y'.        04860000
               88  WS-MORE-INPUT                      VALUE 'Y'.        04870000
               88  WS-NO-MORE-INPUT                   VALUE 'N'.        04880000
           05  WS-FIRST-HEADER-SW           PIC  X    VALUE 'Y'.        04890000
               88  WS-FIRST-HEADER                    VALUE 'Y'.        04900000
               88  WS-NOT-FIRST-HEADER                VALUE 'N'.        04910000
           05  WS-FIRST-ITEM-SW             PIC  X    VALUE 'Y'.        04920000
               88  WS-FIRST-ITEM                      VALUE 'Y'.        04930000
               88  WS-NOT-FIRST-ITEM                  VALUE 'N'.        04940000
           05  WS-ITEM-WRITTEN-SW           PIC  X    VALUE 'N'.        04950000
               88  WS-NO-ITEM-WRITTEN                 VALUE 'N'.        04960000
               88  WS-ITEM-WRITTEN                    VALUE 'Y'.        04970000
           05  WS-PRETICKET-SW              PIC  X    VALUE 'N'.        04980000
               88  WS-NO-PRETICKET                    VALUE 'N'.        04990000
               88  WS-PRETICKET                       VALUE 'Y'.        05000000
           05  WS-PKBYSTR-SW                PIC  X    VALUE 'N'.        05010000
               88  WS-NO-PKBYSTR                      VALUE 'N'.        05020000
               88  WS-PKBYSTR                         VALUE 'Y'.        05030000
           05  WS-EDI-SW                    PIC  X    VALUE 'N'.        05040000
               88  WS-NO-EDI                          VALUE 'N'.        05050000
               88  WS-EDI                             VALUE 'Y'.        05060000
           05  WS-SKU-FOUND-SW              PIC  X    VALUE 'Y'.        05070000
               88  WS-SKU-FOUND                       VALUE 'Y'.        05080000
               88  WS-SKU-NOT-FOUND                   VALUE 'N'.        05090000
           05  WS-DTS-PO-SW                 PIC  X    VALUE 'N'.        05100000
               88  WS-NOT-DTS-PO                      VALUE 'N'.        05110000
               88  WS-DTS-PO                          VALUE 'Y'.        05120000
           05  WS-HANES-SW                  PIC  X    VALUE 'N'.        05130000
               88  WS-NOT-HANES                       VALUE 'N'.        05140000
               88  WS-HANES                           VALUE 'Y'.        05150000
           05  WS-JOCKEY-SW                 PIC  X    VALUE 'N'.        05160000
               88  WS-NOT-JOCKEY                      VALUE 'N'.        05170000
               88  WS-JOCKEY                          VALUE 'Y'.        05180000
           05  WS-HALLMARK-SW               PIC  X    VALUE 'N'.        05190000
               88  WS-NOT-HALLMARK                    VALUE 'N'.        05200000
               88  WS-HALLMARK                        VALUE 'Y'.        05210000
           05  WS-MULBERRY-SW               PIC  X    VALUE 'N'.        05220000
               88  WS-NOT-MULBERRY                    VALUE 'N'.        05230000
               88  WS-MULBERRY                        VALUE 'Y'.        05240000
           05  WS-VANITY-FAIR-SW            PIC  X    VALUE 'N'.        05250000
               88  WS-NOT-VANITY-FAIR                 VALUE 'N'.        05260000
               88  WS-VANITY-FAIR                     VALUE 'Y'.        05270000
           05  WS-LILY-OF-FRANCE-SW         PIC  X    VALUE 'N'.        05280000
               88  WS-NOT-LILY-OF-FRANCE              VALUE 'N'.        05290000
               88  WS-LILY-OF-FRANCE                  VALUE 'Y'.        05300000
           05  WS-ESTEE-LAUDER-SW           PIC  X    VALUE 'N'.        05310000
               88  WS-NOT-ESTEE-LAUDER                VALUE 'N'.        05320000
               88  WS-ESTEE-LAUDER                    VALUE 'Y'.        05330000
           05  WS-LIZ-CLAIBORNE-SW          PIC  X    VALUE 'N'.        05340000
               88  WS-NOT-LIZ-CLAIBORNE               VALUE 'N'.        05350000
               88  WS-LIZ-CLAIBORNE                   VALUE 'Y'.        05360000
           05  WS-LEE-WRANGLER-SW           PIC  X    VALUE 'N'.        05370000
               88  WS-NOT-LEE-WRANGLER                VALUE 'N'.        05380000
               88  WS-LEE-WRANGLER                    VALUE 'Y'.        05390000
           05  WS-FISHMAN-SW                PIC  X    VALUE 'N'.        05400000
               88  WS-NOT-FISHMAN                     VALUE 'N'.        05410000
               88  WS-FISHMAN                         VALUE 'Y'.        05420000
           05  WS-OLGA-WARNER-SW            PIC  X    VALUE 'N'.        05430000
               88  WS-NOT-OLGA-WARNER                 VALUE 'N'.        05440000
               88  WS-OLGA-WARNER                     VALUE 'Y'.        05450000
           05  WS-PLAYTEX-SW                PIC  X    VALUE 'N'.        05460000
               88  WS-NOT-PLAYTEX                     VALUE 'N'.        05470000
               88  WS-PLAYTEX                         VALUE 'Y'.        05480000
           05  WS-BALI-SW                   PIC  X    VALUE 'N'.        05490000
               88  WS-NOT-BALI                        VALUE 'N'.        05500000
               88  WS-BALI                            VALUE 'Y'.        05510000
           05  WS-WONDERBRA-SW              PIC  X    VALUE 'N'.        05520000
               88  WS-NOT-WONDERBRA                   VALUE 'N'.        05530000
               88  WS-WONDERBRA                       VALUE 'Y'.        05540000
           05  WS-TOP-OF-THE-WORLD-SW       PIC  X    VALUE 'N'.        05550000
               88  WS-NOT-TOP-OF-THE-WORLD            VALUE 'N'.        05560000
               88  WS-TOP-OF-THE-WORLD                VALUE 'Y'.        05570000
           05  WS-VF-IMAGEWEAR-SW           PIC  X    VALUE 'N'.        05580000
               88  WS-NOT-VF-IMAGEWEAR                VALUE 'N'.        05590000
               88  WS-VF-IMAGEWEAR                    VALUE 'Y'.        05600000
           05  WS-KNIGHTS-APPAREL-SW        PIC  X    VALUE 'N'.        05610000
               88  WS-NOT-KNIGHTS-APPAREL             VALUE 'N'.        05620000
               88  WS-KNIGHTS-APPAREL                 VALUE 'Y'.        05630000
           05  WS-NEXT-INC-SW               PIC  X    VALUE 'N'.        05640000
               88  WS-NOT-NEXT-INC                    VALUE 'N'.        05650000
               88  WS-NEXT-INC                        VALUE 'Y'.        05660000
352053     05  WS-47BRAND-LLC-SW            PIC  X    VALUE 'N'.        05670000
352053         88  WS-NOT-47BRAND-LLC                 VALUE 'N'.        05680000
352053         88  WS-47BRAND-LLC                     VALUE 'Y'.        05690000
           05  WS-SUPREME-INTL-SW           PIC  X    VALUE 'N'.        05700000
               88  WS-NOT-SUPREME-INTL                VALUE 'N'.        05710000
               88  WS-SUPREME-INTL                    VALUE 'Y'.        05720000
           05  WS-COLLEGE-CONCEPTS-SW       PIC  X    VALUE 'N'.        05730000
               88  WS-NOT-COLLEGE-CONCEPTS            VALUE 'N'.        05740000
               88  WS-COLLEGE-CONCEPTS                VALUE 'Y'.        05750000
           05  WS-RUSSELL-ATHLETIC-SW       PIC  X    VALUE 'N'.        05760000
               88  WS-NOT-RUSSELL-ATHLETIC            VALUE 'N'.        05770000
               88  WS-RUSSELL-ATHLETIC                VALUE 'Y'.        05780000
           05  WS-OUTERSTUFF-SW             PIC  X    VALUE 'N'.        05790000
               88  WS-NOT-OUTERSTUFF                  VALUE 'N'.        05800000
               88  WS-OUTERSTUFF                      VALUE 'Y'.        05810000
           05  WS-HADDAD-SW                 PIC  X    VALUE 'N'.        05820000
               88  WS-NOT-HADDAD                      VALUE 'N'.        05830000
               88  WS-HADDAD                          VALUE 'Y'.        05840000
           05  WS-HANES-UNDERWEAR-SW        PIC  X    VALUE 'N'.        05850000
               88  WS-NOT-HANES-UNDERWEAR             VALUE 'N'.        05860000
               88  WS-HANES-UNDERWEAR                 VALUE 'Y'.        05870000
           05  WS-COKEM-SW                  PIC  X    VALUE 'N'.        05880000
               88  WS-NOT-COKEM                       VALUE 'N'.        05890000
               88  WS-COKEM                           VALUE 'Y'.        05900000
           05  WS-GEAR-FOR-SPORTS-SW        PIC  X    VALUE 'N'.        05910000
               88  WS-NOT-GEAR-FOR-SPORTS             VALUE 'N'.        05920000
               88  WS-GEAR-FOR-SPORTS                 VALUE 'Y'.        05930000
           05  WS-COLOSSEUM-SW              PIC  X    VALUE 'N'.        05940000
               88  WS-NOT-COLOSSEUM                   VALUE 'N'.        05950000
               88  WS-COLOSSEUM                       VALUE 'Y'.        05960000
           05  WS-SPORTS-LIC-SW             PIC  X    VALUE 'N'.        05970000
               88  WS-NOT-SPORTS-LIC                  VALUE 'N'.        05980000
               88  WS-SPORTS-LIC                      VALUE 'Y'.        05990000
           05  WS-RENAISSANCE-SW            PIC  X    VALUE 'N'.        06000000
               88  WS-NOT-RENAISSANCE                 VALUE 'N'.        06010000
               88  WS-RENAISSANCE                     VALUE 'Y'.        06020000
WR9604     05  WS-LEVIS-SW                  PIC  X    VALUE 'N'.        06030000
WR9604         88  WS-NOT-LEVIS                       VALUE 'N'.        06040000
WR9604         88  WS-LEVIS                           VALUE 'Y'.        06050000
WR0933     05  WS-TSHIRT-INT-SW             PIC  X    VALUE 'N'.        06060000
WR0933         88  WS-NOT-TSHIRT-INT                  VALUE 'N'.        06070000
WR0933         88  WS-TSHIRT-INT                      VALUE 'Y'.        06080000
W41905     05  WS-JACMEL-JWL-SW             PIC  X    VALUE 'N'.        06090000
W41905         88  WS-NOT-JACMEL-JWL                  VALUE 'N'.        06100000
W41905         88  WS-JACMEL-JWL                      VALUE 'Y'.        06110000
W41952     05  WS-GIII-LEATHER-SW           PIC  X    VALUE 'N'.        06120000
W41952         88  WS-NOT-GIII-LEATHER                VALUE 'N'.        06130000
W41952         88  WS-GIII-LEATHER                    VALUE 'Y'.        06140000
W42092     05  WS-PVH-SUPERBA-SW            PIC  X    VALUE 'N'.        06150000
W42092         88  WS-NOT-PVH-SUPERBA                 VALUE 'N'.        06160000
W42092         88  WS-PVH-SUPERBA                     VALUE 'Y'.        06170000
534202     05  WS-J-AMERICA-SW              PIC  X    VALUE 'N'.        06180000
534202         88  WS-NOT-J-AMERICA                   VALUE 'N'.        06190000
534202         88  WS-J-AMERICA                       VALUE 'Y'.        06200000
494672     05  WS-HGGR-CLTING-SW            PIC  X    VALUE 'N'.        06210000
494672         88  WS-NOT-HGGR-CLTING                 VALUE 'N'.        06220000
494672         88  WS-HGGR-CLTING                     VALUE 'Y'.        06230000
453643     05  WS-ETRNL-FRTN-SW             PIC  X    VALUE 'N'.        06240000
453643         88  WS-NOT-ETRNL-FRTN                  VALUE 'N'.        06250000
453643         88  WS-ETRNL-FRTN                      VALUE 'Y'.        06260000
686121     05  WS-WILL-DICKIE-SW            PIC  X    VALUE 'N'.        06270000
686121         88  WS-NOT-WILL-DICKIE                 VALUE 'N'.        06280000
686121         88  WS-WILL-DICKIE                     VALUE 'Y'.        06290000
371617     05  WS-NEW-ERACAP-SW             PIC  X    VALUE 'N'.        06300000
371617         88  WS-NOT-NEW-ERACAP                  VALUE 'N'.        06310000
371617         88  WS-NEW-ERACAP                      VALUE 'Y'.        06320000
505256     05  WS-NEW-MAIDENFORM-SW         PIC  X    VALUE 'N'.        06330000
505256         88  WS-NOT-NEW-MAIDENFORM              VALUE 'N'.        06340000
505256         88  WS-NEW-MAIDENFORM                  VALUE 'Y'.        06350000
683003     05  WS-RANDA-ACCESSORIES-SW      PIC  X    VALUE 'N'.        06360000
683003         88  WS-NOT-RANDA-ACCESSORIES           VALUE 'N'.        06370000
683003         88  WS-RANDA-ACCESSORIES               VALUE 'Y'.        06380000
683026     05  WS-RANDA-CORP-SW             PIC  X    VALUE 'N'.        06390000
683026         88  WS-NOT-RANDA-CORP                  VALUE 'N'.        06400000
683026         88  WS-RANDA-CORP                      VALUE 'Y'.        06410000
944205     05  WS-BOELTER-COMPANIES-SW      PIC  X    VALUE 'N'.        06420000
944205         88  WS-NOT-BOELTER                     VALUE 'N'.        06430000
944205         88  WS-BOELTER                         VALUE 'Y'.        06440000
002139     05  WS-GONZALS-COMPANIES-SW      PIC  X    VALUE 'N'.        06450000
002139         88  WS-NOT-GONZALS                     VALUE 'N'.        06460000
002139         88  WS-GONZALS                         VALUE 'Y'.        06470000
647062     05  WS-LUXOTTICA-USA-SW          PIC  X    VALUE 'N'.        06480000
647062         88  WS-NOT-LUXOTTICA                   VALUE 'N'.        06490000
647062         88  WS-LUXOTTICA                       VALUE 'Y'.        06500000
042023     05  WS-CC-PRODUCTS-SW            PIC  X    VALUE 'N'.        06510000
042023         88  WS-NOT-CC-PRODUCTS                 VALUE 'N'.        06520000
042023         88  WS-CC-PRODUCTS                     VALUE 'Y'.        06530000
018127     05  WS-TERVIS-SW                 PIC  X    VALUE 'N'.        06540000
018127         88  WS-NOT-TERVIS                      VALUE 'N'.        06550000
018127         88  WS-TERVIS                          VALUE 'Y'.        06560000
356324     05  WS-PERRY-SW                  PIC  X    VALUE 'N'.        06570000
356324         88  WS-NOT-PERRY                       VALUE 'N'.        06580000
356324         88  WS-PERRY                           VALUE 'Y'.        06590000
637834     05  WS-OURAY-SW                  PIC  X    VALUE 'N'.        06600000
637834         88  WS-NOT-OURAY                       VALUE 'N'.        06610000
637834         88  WS-OURAY                           VALUE 'Y'.        06620000
185577     05  WS-BESPOKE-SW                PIC  X    VALUE 'N'.        06630000
185577         88  WS-NOT-BESPOKE                     VALUE 'N'.        06640000
185577         88  WS-BESPOKE                         VALUE 'Y'.        06650000
790723     05  WS-FGX-SW                    PIC  X    VALUE 'N'.        06660000
790723         88  WS-NOT-FGX                         VALUE 'N'.        06670000
790723         88  WS-FGX                             VALUE 'Y'.        06680000
956632     05  WS-RANDA-SW                  PIC  X    VALUE 'N'.        06690000
956632         88  WS-NOT-RANDA                       VALUE 'N'.        06700000
956632         88  WS-RANDA                           VALUE 'Y'.        06710000
956632     05  WS-LOGO-SW                   PIC  X    VALUE 'N'.        06720000
956632         88  WS-NOT-LOGO                        VALUE 'N'.        06730000
956632         88  WS-LOGO                            VALUE 'Y'.        06740000
956632     05  WS-GREAT-AMERICAN-SW         PIC  X    VALUE 'N'.        06750000
956632         88  WS-NOT-GREAT-AMERICAN              VALUE 'N'.        06760000
956632         88  WS-GREAT-AMERICAN                  VALUE 'Y'.        06770000
346771     05  WS-MAD-ENGINE-SW             PIC  X    VALUE 'N'.        06780000
346771         88  WS-NOT-MAD-ENGINE                  VALUE 'N'.        06790000
346771         88  WS-MAD-ENGINE                      VALUE 'Y'.        06800000
265129     05  WS-HYBRID-PROM-SW            PIC X     VALUE 'N'.        06810000
265129         88  WS-NOT-HYBRID-PROM                 VALUE 'N'.        06820000
265129         88  WS-HYBRID-PROM                     VALUE 'Y'.        06830000
887802     05  WS-BIO-WORLD-SW              PIC X     VALUE 'N'.        06840000
887802         88  WS-NOT-BIO-WORLD                   VALUE 'N'.        06850000
887802         88  WS-BIO-WORLD                       VALUE 'Y'.        06860000
927044     05  WS-NORTH-WEST-SW             PIC X     VALUE 'N'.        06870000
927044         88  WS-NOT-NORTH-WEST                  VALUE 'N'.        06880000
927044         88  WS-NORTH-WEST                      VALUE 'Y'.        06890000
925845     05  WS-BARE-FEET-SW              PIC X     VALUE 'N'.        06900000
925845         88  WS-NOT-BARE-FEET                   VALUE 'N'.        06910000
925845         88  WS-BARE-FEET                       VALUE 'Y'.        06920000
762449     05  WS-MASTER-PUZZLE-SW          PIC X     VALUE 'N'.        06930000
762449         88  WS-NOT-MASTER-PUZZLE               VALUE 'N'.        06940000
762449         88  WS-MASTER-PUZZLE                   VALUE 'Y'.        06950000
889751     05  WS-RIPPLE-JUNCTION-SW        PIC X     VALUE 'N'.        06960000
889751         88  WS-NOT-RIPPLE-JUNCTION             VALUE 'N'.        06970000
889751         88  WS-RIPPLE-JUNCTION                 VALUE 'Y'.        06980000
064017     05  WS-LICHTENBERG-SW            PIC X     VALUE 'N'.        06990000
064017         88  WS-NOT-LICHTENBERG                 VALUE 'N'.        07000000
064017         88  WS-LICHTENBERG                     VALUE 'Y'.        07010000
176716     05  WS-SPIRIT-LEATHERWORKS-SW    PIC X     VALUE 'N'.        07020000
176716         88  WS-NOT-SPIRIT-LEATHERWORKS         VALUE 'N'.        07030000
176716         88  WS-SPIRIT-LEATHERWORKS             VALUE 'Y'.        07040000
176682     05  WS-TEE-SHIRT-CENTRAL-SW      PIC X     VALUE 'N'.        07050000
176682         88  WS-NOT-TEE-SHIRT-CENTRAL           VALUE 'N'.        07060000
176682         88  WS-TEE-SHIRT-CENTRAL               VALUE 'Y'.        07070000
680553     05  WS-LF-MENS-GROUP-LLC-SW      PIC X     VALUE 'N'.        07071001
680553         88  WS-NOT-LF-MENS-GROUP-LLC           VALUE 'N'.        07072000
680553         88  WS-LF-MENS-GROUP-LLC               VALUE 'Y'.        07073000
           05  WS-ERROR-RECORD-SW           PIC X     VALUE 'N'.        07080000
               88  WS-NOT-ERROR-RECORD                VALUE 'N'.        07090000
               88  WS-ERROR-RECORD                    VALUE 'Y'.        07100000
           05  PS-MULTIPLE-DEPTS-SW         PIC X     VALUE 'Y'.        07110000
               88  PS-MULTIPLE-DEPTS                  VALUE 'Y'.        07120000
               88  PS-NOT-MULTIPLE-DEPTS              VALUE 'N'.        07130000
           05  PS-VALID-SKUS-SW             PIC X     VALUE 'Y'.        07140000
               88  PS-VALID-SKUS                      VALUE 'Y'.        07150000
               88  PS-NO-VALID-SKUS                   VALUE 'N'.        07160000
           05  PS-ROLLBACK-ORDER-SW         PIC X     VALUE 'N'.        07170000
               88  PS-ROLLBACK-ORDER                  VALUE 'Y'.        07180000
               88  PS-NO-ROLLBACK-ORDER               VALUE 'N'.        07190000
           05  PS-BAD-STORE-SW              PIC X     VALUE 'N'.        07200000
               88  PS-BAD-STORE-FOUND                 VALUE 'Y'.        07210000
               88  PS-NO-BAD-STORE-FOUND              VALUE 'N'.        07220000
           05  PS-MQPUT-SUCCESSFUL-SW       PIC X     VALUE 'N'.        07230000
               88  PS-MQPUT-SUCCESSFUL                VALUE 'Y'.        07240000
           05  PS-MQPUT-SUCCESSFUL-SW-API   PIC X     VALUE 'N'.        07250000
               88  PS-MQPUT-SUCCESSFUL-API            VALUE 'Y'.        07260000
           05  PS-MQPUT-ERROR-SW            PIC X     VALUE 'N'.        07270000
               88  PS-MQPUT-ERROR                     VALUE 'Y'.        07280000
           05  PS-MQPUT-ERROR-SW-API        PIC X     VALUE 'N'.        07290000
               88  PS-MQPUT-ERROR-API                 VALUE 'Y'.        07300000
           05 PS-TABLE-MQ-ERRORS-SW    PIC X(01)    VALUE 'N'.          07310000
               88  PS-TABLE-MQ-ERRORS               VALUE 'Y'.          07320000
               88  PS-TABLE-MQ-ERRORS-NO            VALUE 'N'.          07330000
           05  SW-MQ-CONNECTED-SW           PIC  X(01)    VALUE 'N'.    07340000
               88  SW-MQ-CONNECTED                        VALUE 'Y'.    07350000
               88  SW-MQ-NOT-CONNECTED                    VALUE 'N'.    07360000
           05  SW-MQ-OPENED-SW              PIC  X(01)    VALUE 'N'.    07370000
               88  SW-MQ-OPENED                           VALUE 'Y'.    07380000
               88  SW-MQ-NOT-OPENED                       VALUE 'N'.    07390000
           05  SW-MQ-CONNECTED-SW-API       PIC  X(01)    VALUE 'N'.    07400000
               88  SW-MQ-CONNECTED-API                    VALUE 'Y'.    07410000
               88  SW-MQ-NOT-CONNECTED-API                VALUE 'N'.    07420000
           05  SW-MQ-OPENED-SW-API          PIC  X(01)    VALUE 'N'.    07430000
               88  SW-MQ-OPENED-API                       VALUE 'Y'.    07440000
               88  SW-MQ-NOT-OPENED-API                   VALUE 'N'.    07450000
           05  PS-BRIDGE-BACKOUT-MODE-SW    PIC  X(01)    VALUE 'N'.    07460000
               88  PS-BRIDGE-BACKOUT-MODE                 VALUE 'Y'.    07470000
               88  PS-NOT-BRIDGE-BACKOUT-MODE             VALUE 'N'.    07480000
           05  PS-TYPE-OF-BACKOUT-MODE-SW   PIC  X(01)    VALUE ' '.    07490000
               88  PS-TERMINATE-BRIDGE                    VALUE 'T'.    07500000
               88  PS-SUSPEND-BRIDGE                      VALUE 'S'.    07510000
           05  PS-PO-HAS-S-ROW-SW           PIC  X(01)    VALUE 'N'.    07520000
               88  PS-PO-HAS-S-ROW                        VALUE 'Y'.    07530000
           05  PS-DEPT-ROLLOUT-SW           PIC  X(01)    VALUE 'N'.    07540000
               88  PS-DEPT-ROLLOUT                        VALUE 'Y'.    07550000
           05  PS-HNG-IND-SW                PIC  X(01)    VALUE 'N'.    07560000
               88  PS-HNG-IND-FOUND                       VALUE 'Y'.    07570000
               88  PS-NO-HNG-IND-FOUND                    VALUE 'N'.    07580000
           05  PS-HOLD-ENTRY-SYS-SW         PIC  X(01)    VALUE 'N'.    07590000
               88  PS-HOLD-ENTRY-IN-LEGACY                VALUE 'Y'.    07600000
               88  PS-HOLD-ENTRY-NOT-IN-LEGACY            VALUE 'N'.    07610000
           05  PS-BELOW-MAX-ITEMS-SW        PIC  X(01)    VALUE 'Y'.    07620000
               88  PS-BELOW-MAX-ITEMS                     VALUE 'Y'.    07630000
               88  PS-ABOVE-MAX-ITEMS                     VALUE 'N'.    07640000
           05  PS-ERROR-REPORT-CREATION-SW  PIC  X(01)    VALUE 'N'.    07650000
               88  PS-ERROR-REPORT-CREATED                VALUE 'Y'.    07660000
               88  PS-NO-ERROR-REPORT-CREATED             VALUE 'N'.    07670000
           05  PS-ACTIVE-VENDOR-SW          PIC  X(01)    VALUE 'N'.    07680000
               88  PS-ACTIVE-VENDOR                       VALUE 'Y'.    07690000
               88  PS-INACTIVE-VENDOR                     VALUE 'N'.    07700000
                                                                        07710000
       01  PV-PROGRAM-VARIABLES.                                        07720000
           05  PV-LAST-UPD-TMESTMP         PIC X(26)  VALUE SPACES.     07730000
           05  PV-MQPUT-RETRY-COUNTER      PIC S9(4)  COMP VALUE 0.     07740000
           05  PV-MSGBUFFER-LENGTH         PIC S9(9)  BINARY.           07750000
           05  PV-MSGBUFFER-LENGTH-API     PIC S9(9)  BINARY.           07760000
           05  PV-COMPLETION-CODE          PIC S9(9)  COMP.             07770000
           05  PV-REASON                   PIC S9(9)  COMP.             07780000
           05  PV-HCONN                    PIC S9(09) BINARY VALUE 0.   07790000
           05  PV-PQ-HANDLE                PIC S9(09) BINARY VALUE 0.   07800000
           05  PV-PQ-HANDLE-API            PIC S9(09) BINARY VALUE 0.   07810000
           05  PV-OPEN-OPTIONS             PIC S9(09) BINARY.           07820000
           05  PV-OPEN-OPTIONS-API         PIC S9(09) BINARY.           07830000
           05  PV-CON-REASON               PIC S9(09) BINARY.           07840000
           05  PV-CON-REASON-API           PIC S9(09) BINARY.           07850000
           05  PV-MAX-PRCG-SEQ             PIC S9(09) VALUE +0          07860000
                                                      COMP.             07870000
           05  PV-NEXT-PRCG-SEQ            PIC S9(09) VALUE +0          07880000
                                                      COMP.             07890000
           05  PV-MQ-ERR-ROW-COUNT         PIC S9(4)  COMP VALUE 0.     07900000
           05  PV-STRING-CLAUSE.                                        07910000
               10  FILLER                  PIC X(15000000).             07920000
           05  PV-STRING-POINTER-WHERE     PIC S9(09)   VALUE +0.       07930000
           05  PV-STRING-LENGTH            PIC S9(09)   VALUE +0 COMP.  07940000
           05  PV-MQ-REASON-TEXT           PIC X(30)  VALUE SPACES.     07950000
           05  PV-ERROR.                                                07960000
               10  PV-ERROR-LITERAL        PIC X(14)  VALUE SPACES.     07970000
               10  PV-ERROR-VARIABLE       PIC X(34)  VALUE SPACES.     07980000
           05  PV-ERROR-MESSAGE            PIC X(48)  VALUE SPACES.     07990000
           05  PV-ERROR-MESSAGE2           PIC X(48)  VALUE SPACES.     08000000
           05  PV-SAVE-COMPLETION-CODE     PIC S9(09) BINARY.           08010000
           05  PV-SAVE-REASON              PIC S9(09) BINARY.           08020000
           05  PV-PROMO-CODE               PIC X(02).                   08030000
           05  PV-DC-NBR-9                 PIC 9(04).                   08040000
           05  PV-DC-NBR-X REDEFINES PV-DC-NBR-9                        08050000
                                           PIC X(04).                   08060000
           05  PV-DB-DC-NBR                PIC S9(04) COMP.             08070000
                                                                        08080000
W24803     05  PV-SKU                      PIC 9(08) VALUE ZEROS.       08090000
W24803     05  PV-ISA-CNTL-NBR             PIC 9(09) VALUE ZEROS.       08100000
W24803                                                                  08110000
       01  WS-ABEND-FIELDS.                                             08120000
           05  WS-PROGRAM-ID                PIC X(8)  VALUE 'POKUP047'. 08130000
           05  PV-PARAGRAPH-NAME            PIC X(50) VALUE SPACES.     08140000
           05  WS-ABEND-CODE                PIC S9(4) COMP SYNC         08150000
                                                      VALUE ZERO.       08160000
               88  WS-CONTROL-CARD-ERROR              VALUE +4003.      08170000
               88  WS-DB2-ABEND                       VALUE +4013.      08180000
               88  WS-MQ-ERROR                        VALUE +4020.      08190000
               88  WS-PO056-ERROR                     VALUE +4030.      08200000
                                                                        08210000
       01  WS-DATE-TIME-FIELDS.                                         08220000
      *** DATE FORMAT = YYMMDD                                          08230000
           05  WS-DATE                      PIC 9(6)  VALUE ZERO.       08240000
      *** TIME FORMAT = HHMMSSUU                                        08250000
           05  WS-TIME                      PIC 9(8)  VALUE ZERO.       08260000
           05  WS-DEFAULT-TIMESTAMP         PIC X(26) VALUE             08270000
                                   '0001-01-01-01.01.01.000000'.        08280000
           05  WS-DEFAULT-DATE              PIC X(10) VALUE             08290000
                                   '0001-01-01'.                        08300000
           05  WS-DB2-TIMESTAMP.                                        08310000
               10  WS-TS-CC                 PIC XX    VALUE SPACES.     08320000
               10  WS-TS-YY                 PIC XX    VALUE SPACES.     08330000
               10  FILLER                   PIC X     VALUE '-'.        08340000
               10  WS-TS-MM                 PIC XX    VALUE SPACES.     08350000
               10  FILLER                   PIC X     VALUE '-'.        08360000
               10  WS-TS-DD                 PIC XX    VALUE SPACES.     08370000
               10  FILLER                   PIC X     VALUE '-'.        08380000
               10  WS-TS-HH                 PIC XX    VALUE SPACES.     08390000
               10  FILLER                   PIC X     VALUE '.'.        08400000
               10  WS-TS-II                 PIC XX    VALUE SPACES.     08410000
               10  FILLER                   PIC X     VALUE '.'.        08420000
               10  WS-TS-SS                 PIC XX    VALUE SPACES.     08430000
               10  FILLER                   PIC X     VALUE '.'.        08440000
               10  WS-TS-MS                 PIC X(6)  VALUE SPACES.     08450000
           05  WS-DB2-DATE.                                             08460000
               10  WS-D-CC                  PIC XX    VALUE SPACES.     08470000
               10  WS-D-YY                  PIC XX    VALUE SPACES.     08480000
               10  FILLER                   PIC X     VALUE '-'.        08490000
               10  WS-D-MM                  PIC XX    VALUE SPACES.     08500000
               10  FILLER                   PIC X     VALUE '-'.        08510000
               10  WS-D-DD                  PIC XX    VALUE SPACES.     08520000
           05  WS-SHIP-DATE                 PIC X(10) VALUE SPACES.     08530000
           05  WS-CANCEL-DATE               PIC X(10) VALUE SPACES.     08540000
           05  WS-CURR-DB2-DATE             PIC X(10) VALUE SPACES.     08550000
                                                                        08560000
       01  WS-ACCUMULATORS.                                             08570000
           05  PV-RETRY-COUNTER             PIC S9(04)     COMP         08580000
                                                      VALUE ZERO.       08590000
           05  PV-SKU-COUNT                 PIC S9(08)     COMP         08600000
                                                      VALUE ZERO.       08610000
           05  PV-ALLOC-COUNT               PIC S9(08)     COMP         08620000
                                                      VALUE ZERO.       08630000
           05  WS-POAGMT-SEQ-NBR            PIC S9(09)     COMP         08640000
                                                      VALUE ZERO.       08650000
           05  WS-TOT-UNT-QTY               PIC S9(09)     COMP-3       08660000
                                                      VALUE ZERO.       08670000
           05  WS-TOT-ITEM-QTY              PIC S9(09)     COMP-3       08680000
                                                      VALUE ZERO.       08690000
           05  WS-TOT-SKUS-QTY              PIC S9(09)     COMP-3       08700000
                                                      VALUE ZERO.       08710000
           05  WS-TOT-VAL-COST-AMT          PIC S9(08)V99  COMP-3       08720000
                                                      VALUE ZERO.       08730000
           05  WS-TOT-VAL-RTL-AMT           PIC S9(08)V99  COMP-3       08740000
                                                      VALUE ZERO.       08750000
           05  WS-TOT-CALC-COST-AMT         PIC S9(8)V9(4) COMP-3       08760000
                                                      VALUE ZERO.       08770000
           05  WS-TOT-CALC-RTL-AMT          PIC S9(8)V9(4) COMP-3       08780000
                                                      VALUE ZERO.       08790000
           05  WS-MQ-PO-MESSAGES            PIC 9(04) VALUE ZERO.       08800000
           05  WS-MQ-PO-MESSAGES-API        PIC 9(04) VALUE ZERO.       08810000
           05  WS-TPURCHS-INSERTED          PIC 9(04) VALUE ZERO.       08820000
           05  WS-TPLNSHP-INSERTED          PIC 9(04) VALUE ZERO.       08830000
           05  WS-TPURITM-INSERTED          PIC 9(04) VALUE ZERO.       08840000
           05  WS-TALLPLN-INSERTED          PIC 9(04) VALUE ZERO.       08850000
           05  WS-TPOAGMT-INSERTED          PIC 9(04) VALUE ZERO.       08860000
           05  WS-TMESTDS-INSERTED          PIC 9(04) VALUE ZERO.       08870000
           05  WS-ERR-RPT-PAGE              PIC 9(04) VALUE ZERO.       08880000
                                                                        08890000
       01  WS-DISPLAY-FIELDS.                                           08900000
           05  WS-D-SQLCODE                 PIC Z(8)9- VALUE ZERO.      08910000
           05  WS-D-PO-MSG                  PIC X(79)  VALUE SPACES.    08920000
C98147     05  WS-D-PO-NBR                  PIC 9(08)  VALUE ZERO.      08930000
           05  WS-D-VNDR-NBR                PIC 9(07)  VALUE ZERO.      08940000
W24803     05  WS-D-ENT-ID                  PIC 9(09)  VALUE ZEROS.     08950000
           05  WS-SKU-NOT-FOUND-MSG         PIC X(132) VALUE            08960000
               '=========>>   S K U  NOT FOUND'.                        08970000
           05  WS-PO-EXISTS-MSG             PIC X(132) VALUE            08980000
               '=========>>   PURCHASE ORDER CURRENTLY EXISTS'.         08990000
           05  WS-MULT-DEPT-MSG             PIC X(132) VALUE            09000000
               '=========>>   MULTIPLE DEPARTMENTS EXIST ON THIS PO'.   09010000
           05  WS-MAX-SKUS-MSG              PIC X(132) VALUE            09020000
               '=========>>   PURCHASE ORDER HAS MORE THAN 999 ITEMS.'. 09030000
           05  WS-DEFAULTING-CANCEL-DATE    PIC X(132) VALUE            09040000
               '=========>>   CANCEL DATE WAS NOT PROVIDED.'.           09050000
           05  WS-NO-VALID-SKUS-MSG         PIC X(132) VALUE            09060000
               '=========>>   PO HAS NO VALID SKUS.'.                   09070000
           05  WS-INACTIVE-VENDOR           PIC X(132) VALUE            09080000
               '=========>>   INACTIVE VENDOR.'.                        09090000
                                                                        09100000
       01  WS-MISCELLANEOUS-FIELDS.                                     09110000
           05  WS-TPURCHS-SQLCODE           PIC S9(09) COMP-4           09120000
                                                      VALUE ZERO.       09130000
           05  WS-LINE-MAX                  PIC 9(02) VALUE 55.         09140000
           05  WS-STORE-SUB-MAX             PIC S9(04) COMP             09150000
                                                      VALUE +10.        09160000
           05  WS-STR-SUB-MAX               PIC S9(04) COMP             09170000
                                                      VALUE +800.       09180000
           05  PC-MAX-RETRIES               PIC S9(4) COMP VALUE +3.    09190000
           05  WS-DB2-COUNT                 PIC S9(04) COMP             09200000
                                                      VALUE ZERO.       09210000
           05  WS-STORE-SUB                 PIC S9(04) COMP             09220000
                                                      VALUE ZERO.       09230000
           05  WS-STR-TBLE-SUB-API          PIC S9(04) COMP             09240000
                                                      VALUE ZERO.       09250000
           05  WS-STORE-COUNT-API           PIC S9(04) COMP             09260000
                                                      VALUE ZERO.       09270000
           05  WS-STR-SUB                   PIC S9(04) COMP             09280000
                                                      VALUE ZERO.       09290000
           05  WS-ERR-SUB                   PIC S9(04) COMP             09300000
                                                      VALUE ZERO.       09310000
           05  WS-DC-TBL-SUB                PIC S9(04) COMP             09320000
                                                      VALUE ZERO.       09330000
           05  WS-STR-TBL-SUB               PIC S9(04) COMP             09340000
                                                      VALUE ZERO.       09350000
           05  WS-PO-LNE-NBR                PIC S9(09) COMP             09360000
                                                      VALUE ZERO.       09370000
           05  WS-SHIPT-NBR                 PIC S9(09) COMP             09380000
                                                      VALUE ZERO.       09390000
W24803     05  WS-DEPT-NBR                  PIC 9(03) VALUE ZEROES.     09400000
           05  WS-SAVE-PO-NBR               PIC S9(09) COMP             09410000
                                                      VALUE ZERO.       09420000
           05  WS-CURR-INTERCHANGE          PIC X(17) VALUE SPACES.     09430000
           05  WS-BYR-FIRST                 PIC X(12) VALUE SPACES.     09440000
           05  WS-BYR-LAST                  PIC X(18) VALUE SPACES.     09450000
           05  WS-HOLD-PO-NBR               PIC 9(09) VALUE ZERO.       09460000
           05  WS-PARENT-ENT-ID             PIC 9(09) VALUE ZERO.       09470000
           05  WS-FACTORY-ENT-ID            PIC 9(09) VALUE ZERO.       09480000
                                                                        09490000
       01  WS-CONVERSION-FIELDS.                                        09500000
           05  WS-SQLCODE                   PIC S9(9) VALUE ZERO.       09510000
C98147     05  WS-PO-NBR                    PIC 9(08) VALUE ZERO.       09520000
           05  WS-STORE-X                   PIC X(05) VALUE SPACES.     09530000
           05  WS-STORE-9  REDEFINES WS-STORE-X                         09540000
                                            PIC 9(05).                  09550000
           05  WS-DC-NUMBER                 PIC 9(04) VALUE ZEROES.     09560000
           05  WS-DC-NUMBER-A REDEFINES WS-DC-NUMBER.                   09570000
               10  WS-DC-NUMBER-LIT         PIC X(04).                  09580000
                                                                        09590000
       01  CC-CONTROL-OUTPUT-QMGR.                                      09600000
           05  CC-OUTPUT-QMGR-NAME          PIC X(48).                  09610000
           05  FILLER                       PIC X(32).                  09620000
                                                                        09630000
       01  CC-CONTROL-OUTPUT-QUEUE.                                     09640000
           05  CC-OUTPUT-QUEUE-NAME         PIC X(48).                  09650000
           05  FILLER                       PIC X(32).                  09660000
                                                                        09670000
       01  CC-CONTROL-OUTPUT-QMGR-API.                                  09680000
           05  CC-OUTPUT-QMGR-NAME-API      PIC X(48).                  09690000
           05  FILLER                       PIC X(32).                  09700000
                                                                        09710000
       01  CC-CONTROL-OUTPUT-QUEUE-API.                                 09720000
           05  CC-OUTPUT-QUEUE-NAME-API     PIC X(48).                  09730000
           05  FILLER                       PIC X(32).                  09740000
                                                                        09750000
       01  WS-BAD-STORE-RPT-TITLE.                                      09760000
           05  FILLER                       PIC X(42) VALUE SPACES.     09770000
           05  FILLER                       PIC X(49) VALUE             09780000
               'INVALID LOCATION ON VENDOR GENERATED ORDER REPORT'.     09790000
           05  FILLER                       PIC X(41) VALUE SPACES.     09800000
                                                                        09810000
       01  WS-BAD-STORE-RPT.                                            09820000
           05  FILLER                       PIC X(05) VALUE SPACES.     09830000
           05  FILLER                       PIC X(17) VALUE             09840000
               'PURCHASE ORDER = '.                                     09850000
           05  FILLER                       PIC X(01) VALUE SPACES.     09860000
C98147     05  WS-BAD-PO                    PIC 9(08) VALUE ZEROES.     09870000
C98147     05  FILLER                       PIC X(02) VALUE SPACES.     09880000
           05  FILLER                       PIC X(06) VALUE 'LOC = '.   09890000
           05  FILLER                       PIC X(01) VALUE SPACES.     09900000
           05  WS-BAD-STORE                 PIC X(04) VALUE SPACES.     09910000
           05  FILLER                       PIC X(02) VALUE SPACES.     09920000
           05  FILLER                       PIC X(09) VALUE 'VENDOR = '.09930000
           05  FILLER                       PIC X(01) VALUE SPACES.     09940000
           05  WS-BAD-VENDOR                PIC X(30) VALUE SPACES.     09950000
           05  FILLER                       PIC X(01) VALUE SPACES.     09960000
           05  FILLER                       PIC X(12) VALUE             09970000
                                                      'ISA NBR = '.     09980000
           05  WS-ISA-CNTL-NBR              PIC 9(09) VALUE ZERO.       09990000
           05  FILLER                       PIC X(01) VALUE SPACES.     10000000
           05  FILLER                       PIC X(06) VALUE 'DTS = '.   10010000
           05  WS-BAD-DTS                   PIC X(01) VALUE 'N'.        10020000
           05  FILLER                       PIC X(18) VALUE SPACES.     10030000
                                                                        10040000
       01  WS-DC-TABLE.                                                 10050000
           05  WS-DC-TBL-ENTRY  OCCURS 25 TIMES.                        10060000
               10  WS-DC-ID                 PIC 9(04) VALUE ZERO.       10070000
               10  WS-DC-QTY                PIC S9(09) COMP             10080000
                                                      VALUE ZERO.       10090000
                                                                        10100000
       01  WS-STR-TABLE.                                                10110000
           05  WS-STR-TBL-ENTRY  OCCURS 1500 TIMES.                     10120000
               10  WS-STR-NBR               PIC 9(04) VALUE ZERO.       10130000
               10  WS-STR-QTY               PIC 9(07) VALUE ZERO.       10140000
                                                                        10150000
       01  WS-STR-TABLE-API.                                            10160000
           05  WS-STR-TBL-API-ENTRY  OCCURS 1500 TIMES.                 10170000
               10  WS-STR-NBR-API           PIC 9(04) VALUE ZERO.       10180000
               10  WS-STR-QTY-API           PIC 9(07) VALUE ZERO.       10190000
               10  WS-STR-DC-API            PIC 9(07) VALUE ZERO.       10200000
                                                                        10210000
       01  ERR-RPT-HEADER-1.                                            10220000
           05  ERR-RPT-H1-DATE.                                         10230000
               10  ERR-RPT-H1-MM            PIC 9(02) VALUE ZERO.       10240000
               10  FILLER                   PIC X(01) VALUE '/'.        10250000
               10  ERR-RPT-H1-DD            PIC 9(02) VALUE ZERO.       10260000
               10  FILLER                   PIC X(01) VALUE '/'.        10270000
               10  ERR-RPT-H1-YY            PIC 9(02) VALUE ZERO.       10280000
           05  FILLER                       PIC X(02) VALUE SPACES.     10290000
           05  ERR-RPT-H1-TIME.                                         10300000
               10  ERR-RPT-H1-HH            PIC 9(02) VALUE ZERO.       10310000
               10  FILLER                   PIC X(01) VALUE ':'.        10320000
               10  ERR-RPT-H1-MN            PIC 9(02) VALUE ZERO.       10330000
           05  FILLER                       PIC X(27) VALUE SPACES.     10340000
           05  FILLER                       PIC X(45)                   10350000
               VALUE 'K O H L S   D E P A R T M E N T   S T O R E S'.   10360000
           05  FILLER                       PIC X(21) VALUE SPACES.     10370000
           05  FILLER                       PIC X(08) VALUE 'POKUP047'. 10380000
           05  ERR-RPT-H1-RPT-NBR           PIC X(02) VALUE SPACES.     10390000
           05  FILLER                       PIC X(02) VALUE SPACES.     10400000
           05  FILLER                       PIC X(05) VALUE 'PAGE'.     10410000
           05  ERR-RPT-H1-PAGE              PIC ZZZZ9 VALUE ZERO.       10420000
                                                                        10430000
       01  ERR-RPT-HEADER-2.                                            10440000
           05  FILLER                       PIC X(45) VALUE SPACES.     10450000
           05  FILLER                       PIC X(40) VALUE             10460000
               'VENDOR-GENERATED PURCHASE ORDER CREATION'.              10470000
                                                                        10480000
       01  ERR-RPT-HEADER-3.                                            10490000
           05  FILLER                       PIC X(60) VALUE SPACES.     10500000
           05  FILLER                       PIC X(12) VALUE             10510000
               'ERROR REPORT'.                                          10520000
                                                                        10530000
       01  ERR-RPT-BLANK-LINE.                                          10540000
           05  FILLER                       PIC X(132) VALUE SPACES.    10550000
                                                                        10560000
       01  ERR-RPT-DETAIL-1.                                            10570000
           05  FILLER                       PIC X(08) VALUE 'BUYER   '. 10580000
           05  ERR-RPT-D1-BUYER-NBR         PIC X(03) VALUE SPACES.     10590000
           05  FILLER                       PIC X(01) VALUE SPACE.      10600000
           05  ERR-RPT-D1-BUYER-NAME        PIC X(30) VALUE SPACES.     10610000
                                                                        10620000
       01  ERR-RPT-DETAIL-2.                                            10630000
           05  FILLER                       PIC X(08) VALUE 'VENDOR  '. 10640000
           05  ERR-RPT-D2-VENDOR-NBR        PIC X(09) VALUE SPACES.     10650000
           05  FILLER                       PIC X(01) VALUE SPACE.      10660000
           05  ERR-RPT-D2-VENDOR-NAME       PIC X(30) VALUE SPACES.     10670000
                                                                        10680000
       01  ERR-RPT-DETAIL-3.                                            10690000
           05  FILLER                       PIC X(08) VALUE 'ISA NBR '. 10700000
           05  ERR-RPT-D3-ISA-CNTL-NBR      PIC X(09) VALUE SPACES.     10710000
                                                                        10720000
       01  ERR-RPT-DETAIL-4.                                            10730000
           05  FILLER                       PIC X(08) VALUE 'PO NBR  '. 10740000
C98147     05  ERR-RPT-D4-PO-NBR            PIC X(08) VALUE SPACES.     10750000
                                                                        10760000
       01  ERR-RPT-DETAIL-5.                                            10770000
           05  FILLER                       PIC X(08) VALUE 'U P C   '. 10780000
           05  ERR-RPT-D5-UPC               PIC X(15) VALUE SPACES.     10790000
           05  FILLER                       PIC X(05) VALUE SPACES.     10800000
W24803     05  FILLER                       PIC X(04) VALUE 'SKU '.     10810000
W24803     05  ERR-RPT-D5-SKU               PIC 9(08) VALUE ZEROS.      10820000
                                                                        10830000
       01  ERR-RPT-HEADER-ALLOC.                                        10840000
           05  FILLER                       PIC X(13) VALUE             10850000
               'STR   QTY    '.                                         10860000
           05  FILLER                       PIC X(13) VALUE             10870000
               'STR   QTY    '.                                         10880000
           05  FILLER                       PIC X(13) VALUE             10890000
               'STR   QTY    '.                                         10900000
           05  FILLER                       PIC X(13) VALUE             10910000
               'STR   QTY    '.                                         10920000
           05  FILLER                       PIC X(13) VALUE             10930000
               'STR   QTY    '.                                         10940000
           05  FILLER                       PIC X(13) VALUE             10950000
               'STR   QTY    '.                                         10960000
           05  FILLER                       PIC X(13) VALUE             10970000
               'STR   QTY    '.                                         10980000
           05  FILLER                       PIC X(13) VALUE             10990000
               'STR   QTY    '.                                         11000000
           05  FILLER                       PIC X(13) VALUE             11010000
               'STR   QTY    '.                                         11020000
           05  FILLER                       PIC X(13) VALUE             11030000
               'STR   QTY    '.                                         11040000
                                                                        11050000
       01  ERR-RPT-DETAIL-ALLOC.                                        11060000
           05  ERR-RPT-DTL-ENTRY  OCCURS 10 TIMES.                      11070000
               10  ERR-RPT-DA-STR           PIC X(05) VALUE SPACES.     11080000
               10  FILLER                   PIC X(01) VALUE SPACE.      11090000
               10  ERR-RPT-DA-QTY           PIC Z(05).                  11100000
               10  FILLER                   PIC X(02) VALUE SPACES.     11110000
                                                                        11120000
       01  ERR-RPT-DETAIL-ERROR.                                        11130000
           05  FILLER                       PIC X(132) VALUE SPACES.    11140000
                                                                        11150000
       01  ERR-RPT-DETAIL-FINAL.                                        11160000
           05  FILLER                       PIC X(56) VALUE SPACES.     11170000
           05  FILLER                       PIC X(21) VALUE             11180000
               '*** END OF REPORT ***'.                                 11190000
                                                                        11200000
W24803******************************************************************11210000
W24803*   XLWS001 NEEDED FOR DOMAIN PROGRAM XLKUT001                    11220000
W24803******************************************************************11230000
W24803     COPY XLWS001.                                                11240000
W24803                                                                  11250000
      ******************************************************************11260000
      *   POWS055 NEEDED FOR PROCEDURE AREA POPD055 TO CALC OTB DATE    11270000
      ******************************************************************11280000
           COPY POWS055.                                                11290000
                                                                        11300000
      ******************************************************************11310000
      *   POWS056 NEEDED FOR PROCEDURE POPD056 TO CHECK FOR PO ROLLOUT  11320000
      ******************************************************************11330000
           COPY POWS056.                                                11340000
                                                                        11350000
           COPY PORD002.                                                11360000
                                                                        11370000
           COPY POWS025.                                                11380000
                                                                        11390000
           COPY DPWS500.                                                11400000
                                                                        11410000
      *  MQ MESSAGE COPYBOOK.                                           11420000
           COPY POWS026.                                                11430000
                                                                        11440000
      ******************************************************************11450000
      *   DB2 SQL COMMUNICATION AREA                                    11460000
      ******************************************************************11470000
           EXEC SQL                                                     11480000
                INCLUDE SQLCA                                           11490000
           END-EXEC.                                                    11500000
                                                                        11510000
      ******************************************************************11520000
      *   DB2 DCLGEN FOR VENDOR DEPARTMENT TABLE                        11530000
      ******************************************************************11540000
           EXEC SQL                                                     11550000
                INCLUDE TVNDDPT                                         11560000
           END-EXEC.                                                    11570000
                                                                        11580000
      ******************************************************************11590000
      *   DB2 DCLGEN FOR EXTERNAL ENTERPRISE TABLE                      11600000
      ******************************************************************11610000
           EXEC SQL                                                     11620000
                INCLUDE TEXTENT                                         11630000
           END-EXEC.                                                    11640000
                                                                        11650000
      ******************************************************************11660000
      *   DB2 DCLGEN FOR ENTERPRISE NAME TABLE                          11670000
      ******************************************************************11680000
           EXEC SQL                                                     11690000
                INCLUDE TENTNME                                         11700000
           END-EXEC.                                                    11710000
                                                                        11720000
      ******************************************************************11730000
      *   DB2 DCLGEN FOR MERCHANDISE AREA TABLE                         11740000
      ******************************************************************11750000
           EXEC SQL                                                     11760000
                INCLUDE TMDSEAR                                         11770000
           END-EXEC.                                                    11780000
                                                                        11790000
      ******************************************************************11800000
      *   DB2 DCLGEN FOR RESPONSIBILITY AREA TABLE                      11810000
      ******************************************************************11820000
           EXEC SQL                                                     11830000
                INCLUDE TRSPBAR                                         11840000
           END-EXEC.                                                    11850000
                                                                        11860000
      ******************************************************************11870000
      *   DB2 DCLGEN FOR VENDOR AGREEMENT TABLE                         11880000
      ******************************************************************11890000
           EXEC SQL                                                     11900000
                INCLUDE TVNDAGR                                         11910000
           END-EXEC.                                                    11920000
                                                                        11930000
      ******************************************************************11940000
      *   DB2 DCLGEN FOR FREIGHT TERMS TABLE                            11950000
      ******************************************************************11960000
           EXEC SQL                                                     11970000
                INCLUDE TFRGTRM                                         11980000
           END-EXEC.                                                    11990000
                                                                        12000000
                                                                        12010000
      ******************************************************************12020000
      *   DB2 DCLGEN FOR LOCATION TABLE                                 12030000
      ******************************************************************12040000
           EXEC SQL                                                     12050000
                INCLUDE XMT00001                                        12060000
           END-EXEC.                                                    12070000
                                                                        12080000
      ******************************************************************12090000
      *   DB2 DCLGEN FOR DC/LOCATION TABLE                              12100000
      ******************************************************************12110000
           EXEC SQL                                                     12120000
                INCLUDE XMT00002                                        12130000
           END-EXEC.                                                    12140000
                                                                        12150000
      ******************************************************************12160000
      *   DB2 DCLGEN FOR STORE VENDOR DC TABLE                          12170000
      ******************************************************************12180000
      *    EXEC SQL                                                     12190000
      *         INCLUDE TSTVNDC                                         12200000
      *    END-EXEC.                                                    12210000
                                                                        12220000
      ******************************************************************12230000
      *   DB2 DCLGEN FOR PURCHASE ORDER HEADER TABLE                    12240000
      ******************************************************************12250000
           EXEC SQL                                                     12260000
                INCLUDE TPURCHS                                         12270000
           END-EXEC.                                                    12280000
                                                                        12290000
      ******************************************************************12300000
      *   DB2 DCLGEN FOR PURCHASE ORDER PLANNED SHIPMENT TABLE          12310000
      ******************************************************************12320000
           EXEC SQL                                                     12330000
                INCLUDE TPLNSHP                                         12340000
           END-EXEC.                                                    12350000
                                                                        12360000
      ******************************************************************12370000
      *   DB2 DCLGEN FOR PURCHASE ORDER PLANNED SHIPMENT TABLE          12380000
      ******************************************************************12390000
           EXEC SQL                                                     12400000
                INCLUDE TPOAGMT                                         12410000
           END-EXEC.                                                    12420000
                                                                        12430000
      ******************************************************************12440000
      *   DB2 DCLGEN FOR PURCHASE ORDER ITEM TABLE                      12450000
      ******************************************************************12460000
           EXEC SQL                                                     12470000
                INCLUDE TPURITM                                         12480000
           END-EXEC.                                                    12490000
                                                                        12500000
      ******************************************************************12510000
      *   DB2 DCLGEN FOR PURCHASE ORDER ALLOCATION PLAN TABLE           12520000
      ******************************************************************12530000
           EXEC SQL                                                     12540000
                INCLUDE TALLPLN                                         12550000
           END-EXEC.                                                    12560000
                                                                        12570000
      ******************************************************************12580000
      *   DB2 DCLGEN FOR STORE ALLOCATION TABLE                         12590000
      ******************************************************************12600000
           EXEC SQL                                                     12610000
                INCLUDE TMESTDS                                         12620000
           END-EXEC.                                                    12630000
                                                                        12640000
      ******************************************************************12650000
      *   DB2 DCLGEN FOR PURCHASE ORDER RESERVATION TABLE               12660000
      ******************************************************************12670000
      *    EXEC SQL                                                     12680000
      *         INCLUDE TPORESV                                         12690000
      *    END-EXEC.                                                    12700000
                                                                        12710000
      ******************************************************************12720000
      *   DB2 DCLGEN FOR PO DB2/MQ SERIES ERROR TABLE                   12730000
      ******************************************************************12740000
           EXEC SQL                                                     12750000
                INCLUDE POT00002                                        12760000
           END-EXEC.                                                    12770000
                                                                        12780000
      ******************************************************************12790000
      *   DB2 DCLGEN FOR THE SYSTEM DUMMY TABLE                         12800000
      ******************************************************************12810000
           EXEC SQL                                                     12820000
                INCLUDE SYSDUMMY                                        12830000
           END-EXEC.                                                    12840000
                                                                        12850000
      ******************************************************************12860000
      *   DB2 ABEND FIELDS                                              12870000
      ******************************************************************12880000
           COPY DPWS004.                                                12890000
                                                                        12900000
           EXEC SQL                                                     12910000
                DECLARE DC-CURSOR CURSOR FOR                            12920000
                 SELECT LOC_NBR                                         12930000
                   FROM XMT_LOC                                         12940000
                  WHERE LOC_TYP_CDE = 'DC'                              12950000
                    AND CLO_DTE > CURRENT DATE                          12960000
                    AND (OPN_DTE - COALESCE(STRT_ORD_DAYS_QTY,0) DAYS) <12970000
                        (CURRENT DATE + 180 DAYS)                       12980000
                  ORDER BY LOC_NBR                                      12990000
P41269            WITH UR                                               13000000
           END-EXEC.                                                    13010000
                                                                        13020000
       PROCEDURE DIVISION.                                              13030000
                                                                        13040000
           PERFORM 1000-FILL-DC-TABLE.                                  13050000
                                                                        13060000
           ACCEPT WS-DATE  FROM DATE.                                   13070000
           MOVE WS-DATE(3:2) TO ERR-RPT-H1-MM.                          13080000
           MOVE WS-DATE(5:2) TO ERR-RPT-H1-DD.                          13090000
           MOVE WS-DATE(1:2) TO ERR-RPT-H1-YY.                          13100000
                                                                        13110000
           OPEN INPUT  INPUT-FILE                                       13120000
                       CONTROL-OUTPUT-QMGR                              13130000
                       CONTROL-OUTPUT-QUEUE                             13140000
                       CONTROL-OUTPUT-QMGR-API                          13150000
                       CONTROL-OUTPUT-QUEUE-API                         13160000
                OUTPUT ERROR-REPORT                                     13170000
                       BAD-STORE-REPORT.                                13180000
                                                                        13190000
           PERFORM 30800-CHECK-FOR-BRIDGE-BACKOUT.                      13200000
                                                                        13210000
           IF PS-BRIDGE-BACKOUT-MODE                                    13220000
               EVALUATE TRUE                                            13230000
                   WHEN POT00002-ERR-TYP-CDE = 'T'                      13240000
                       SET PS-TERMINATE-BRIDGE TO TRUE                  13250000
                   WHEN POT00002-ERR-TYP-CDE = 'S'                      13260000
                       SET PS-SUSPEND-BRIDGE   TO TRUE                  13270000
               END-EVALUATE                                             13280000
           ELSE                                                         13290000
               PERFORM 0200-MQ-INITIALIZATION                           13300000
           END-IF.                                                      13310000
                                                                        13320000
           PERFORM 0300-MQ-INITIALIZATION-API                           13330000
                                                                        13340000
           SET WS-MORE-INPUT TO TRUE.                                   13350000
           SET PS-NO-BAD-STORE-FOUND TO TRUE.                           13360000
                                                                        13370000
           PERFORM 99997-READ-INPUT-FILE.                               13380000
                                                                        13390000
           IF PO002-HEADER-RECORD                                       13400000
               MOVE SPACES TO PV-STRING-CLAUSE                          13410000
               MOVE ZERO TO VNDDPT-ENT-ID                               13420000
               MOVE +1 TO PV-STRING-POINTER-WHERE                       13430000
               SET WS-FIRST-HEADER TO TRUE                              13440000
               SET PS-ACTIVE-VENDOR TO TRUE                             13450000
               INITIALIZE PO025-MESSAGE-HEADER-RECORD                   13460000
               MOVE 'PO_CREATE ' TO PO025-MESSAGE-HEADER-BOOKMARK       13470000
            ELSE                                                        13480000
                DISPLAY ' '                                             13490000
                DISPLAY 'INPUT FILE WAS EMPTY'                          13500000
                GO TO END-PROCESSING                                    13510000
            END-IF.                                                     13520000
                                                                        13530000
            PERFORM 10000-PROCESS-INPUT-FILE                            13540000
                   UNTIL WS-NO-MORE-INPUT.                              13550000
                                                                        13560000
           IF WS-SKU-NOT-FOUND                                          13570000
               PERFORM 97000-FORMAT-ERROR-STR-QTY                       13580000
           END-IF.                                                      13590000
                                                                        13600000
           IF WS-ITEM-WRITTEN                                           13610000
               IF WS-NOT-DTS-PO                                         13620000
                   PERFORM 17000-PROCESS-TALLPLN                        13630000
               END-IF                                                   13640000
                                                                        13650000
               PERFORM 18000-PROCESS-HEADER                             13660000
                                                                        13670000
               IF PS-BRIDGE-BACKOUT-MODE                                13680000
                   IF PS-SUSPEND-BRIDGE                                 13690000
                       PERFORM 30900-CHECK-FOR-PO-S-ROW                 13700000
                       IF PS-PO-HAS-S-ROW                               13710000
                           CONTINUE                                     13720000
                       ELSE                                             13730000
                           PERFORM 40000-CHECK-DEPT-ROLLOUT             13740000
                           IF PS-DEPT-ROLLOUT                           13750000
                              PERFORM 30300-WRITE-MQ-ERROR              13760000
                           END-IF                                       13770000
                       END-IF                                           13780000
                   END-IF                                               13790000
               ELSE                                                     13800000
                   PERFORM 30900-CHECK-FOR-PO-S-ROW                     13810000
                   IF PS-PO-HAS-S-ROW                                   13820000
                       CONTINUE                                         13830000
                   ELSE                                                 13840000
                       PERFORM 30000-MQ-MESSAGE-ROUTER                  13850000
                   END-IF                                               13860000
               END-IF                                                   13870000
                                                                        13880000
               IF PS-HOLD-ENTRY-IN-LEGACY                               13890000
                   PERFORM 19000-COMMIT-PURCHASE-ORDER                  13900000
      *            PERFORM 17500-UPDATE-TPURITM-TSTVNDC                 13910000
               END-IF                                                   13920000
           END-IF.                                                      13930000
                                                                        13940000
           IF PS-ERROR-REPORT-CREATED                                   13950000
              PERFORM 99000-PRINT-FINAL-PAGE                            13960000
           END-IF.                                                      13970000
                                                                        13980000
       END-PROCESSING.                                                  13990000
                                                                        14000000
           CLOSE INPUT-FILE                                             14010000
                 CONTROL-OUTPUT-QMGR                                    14020000
                 CONTROL-OUTPUT-QUEUE                                   14030000
                 CONTROL-OUTPUT-QMGR-API                                14040000
                 CONTROL-OUTPUT-QUEUE-API                               14050000
                 ERROR-REPORT                                           14060000
                 BAD-STORE-REPORT.                                      14070000
                                                                        14080000
           IF SW-MQ-OPENED                                              14090000
               PERFORM 0250-MQ-CLOSE-QUEUE                              14100000
           END-IF.                                                      14110000
                                                                        14120000
           IF SW-MQ-OPENED-API                                          14130000
               PERFORM 0350-MQ-CLOSE-QUEUE-API                          14140000
           END-IF.                                                      14150000
                                                                        14160000
           IF SW-MQ-CONNECTED                                           14170000
               PERFORM 0260-MQ-DISCONNECT-QMGR                          14180000
           END-IF.                                                      14190000
                                                                        14200000
           DISPLAY ' '                                                  14210000
           DISPLAY 'TOT # PURCH ORDERS CREATED : ' WS-TPURCHS-INSERTED. 14220000
           DISPLAY 'TOT # MQ PO MESSAGES SENT  : ' WS-MQ-PO-MESSAGES.   14230000
           DISPLAY 'TOT # MQ API PO MESSAGES SENT  : '                  14240000
                                                 WS-MQ-PO-MESSAGES-API. 14250000
                                                                        14260000
           GOBACK.                                                      14270000
                                                                        14280000
      * ------------------------------------------------------------- * 14290000
       0200-MQ-INITIALIZATION.                                          14300000
                                                                        14310000
           COMPUTE PV-MSGBUFFER-LENGTH          =                       14320000
                  (LENGTH OF PO026-COMMON-AREA) +                       14330000
                  (LENGTH OF PO026-APPROVAL-SPECIFIC-FIELDS).           14340000
                                                                        14350000
           PERFORM 30700-CHECK-MQ-ERROR-TABLE.                          14360000
           IF PV-MQ-ERR-ROW-COUNT > 0                                   14370000
              DISPLAY 'MQ ERRORS EXIST IN THE TABLE - MQ NOT CONNECTED' 14380000
              SET PS-TABLE-MQ-ERRORS  TO TRUE                           14390000
           END-IF.                                                      14400000
           PERFORM 0210-READ-CONTROL-FILES.                             14410000
           PERFORM 0220-MQ-CONNECT-QMGR.                                14420000
           IF SW-MQ-CONNECTED                                           14430000
              PERFORM 0230-MQ-OPEN-QUEUE                                14440000
           END-IF.                                                      14450000
           IF (SW-MQ-NOT-OPENED OR SW-MQ-NOT-CONNECTED)                 14460000
              SET PS-TABLE-MQ-ERRORS  TO TRUE                           14470000
           END-IF.                                                      14480000
                                                                        14490000
           PERFORM 0240-GET-CURR-DB2-DATE.                              14500000
                                                                        14510000
      * ------------------------------------------------------------- * 14520000
       0210-READ-CONTROL-FILES.                                         14530000
           READ CONTROL-OUTPUT-QMGR INTO CC-CONTROL-OUTPUT-QMGR         14540000
               AT END                                                   14550000
                 DISPLAY WS-PROGRAM-ID                                  14560000
                   ' CONTROL CARD MISSING - FOR OUTPUT QMGR NAME'       14570000
                 SET WS-CONTROL-CARD-ERROR TO TRUE                      14580000
                 CALL 'ILBOABN0' USING WS-ABEND-CODE.                   14590000
                                                                        14600000
           READ CONTROL-OUTPUT-QUEUE INTO CC-CONTROL-OUTPUT-QUEUE       14610000
               AT END                                                   14620000
                 DISPLAY WS-PROGRAM-ID                                  14630000
                   ' CONTROL CARD MISSING - FOR OUTPUT QUEUE NAME'      14640000
                 SET WS-CONTROL-CARD-ERROR TO TRUE                      14650000
                 CALL 'ILBOABN0' USING WS-ABEND-CODE.                   14660000
                                                                        14670000
       0220-MQ-CONNECT-QMGR.                                            14680000
                                                                        14690000
      * ------------------------------------------------------------- * 14700000
      *    CONNECT TO THE QUEUE MANAGER                                 14710000
      * ------------------------------------------------------------- * 14720000
                                                                        14730000
           CALL WS-MQCONN USING CC-OUTPUT-QMGR-NAME                     14740000
                                PV-HCONN                                14750000
                                PV-COMPLETION-CODE                      14760000
                                PV-REASON.                              14770000
                                                                        14780000
      *    IF CONNECTION FAILED THEN DISPLAY ERROR MESSAGE              14790000
      *    AND EXIT                                                     14800000
                                                                        14810000
           MOVE PV-REASON TO PV-CON-REASON.                             14820000
           IF (PV-COMPLETION-CODE NOT = MQCC-OK) THEN                   14830000
               DISPLAY 'MQCONN ERROR: ' CC-OUTPUT-QMGR-NAME             14840000
               SET SW-MQ-NOT-CONNECTED        TO TRUE                   14850000
           ELSE                                                         14860000
               SET SW-MQ-CONNECTED        TO TRUE                       14870000
               DISPLAY 'MQCONN SUCCESSFUL TO ', CC-OUTPUT-QMGR-NAME     14880000
           END-IF.                                                      14890000
                                                                        14900000
                                                                        14910000
       0230-MQ-OPEN-QUEUE.                                              14920000
                                                                        14930000
      * ------------------------------------------------------------- * 14940000
      *    OPEN THE UNIX VENDOR INFO QUEUE FOR OUTPUT                   14950000
      * ------------------------------------------------------------- * 14960000
                                                                        14970000
           COMPUTE PV-OPEN-OPTIONS = MQOO-OUTPUT +                      14980000
                                     MQOO-FAIL-IF-QUIESCING.            14990000
           MOVE CC-OUTPUT-QUEUE-NAME           TO MQOD-OBJECTNAME.      15000000
           MOVE CC-OUTPUT-QMGR-NAME            TO MQOD-OBJECTQMGRNAME.  15010000
      *                                                                 15020000
           CALL WS-MQOPEN USING PV-HCONN                                15030000
                                MQM-OBJECT-DESCRIPTOR                   15040000
                                PV-OPEN-OPTIONS                         15050000
                                PV-PQ-HANDLE                            15060000
                                PV-COMPLETION-CODE                      15070000
                                PV-REASON.                              15080000
      *                                                                 15090000
      *    IF OPEN FAILED THEN DISPLAY ERROR MESSAGE                    15100000
      *    AND EXIT.                                                    15110000
      *                                                                 15120000
           IF (PV-COMPLETION-CODE NOT = MQCC-OK) THEN                   15130000
               DISPLAY 'MQOPEN ERROR: ' CC-OUTPUT-QUEUE-NAME            15140000
               SET SW-MQ-NOT-OPENED      TO TRUE                        15150000
           ELSE                                                         15160000
               SET SW-MQ-OPENED          TO TRUE                        15170000
               DISPLAY 'MQOPEN SUCCESSFUL FOR ' , MQOD-OBJECTQMGRNAME   15180000
               DISPLAY '                      ' , MQOD-OBJECTNAME       15190000
           END-IF.                                                      15200000
                                                                        15210000
       0240-GET-CURR-DB2-DATE.                                          15220000
                                                                        15230000
           PERFORM WITH TEST AFTER                                      15240000
                   VARYING PV-RETRY-COUNTER FROM 1 BY 1                 15250000
                   UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR         15260000
                           SQLCODE = ZERO                               15270000
                                                                        15280000
                   EXEC SQL                                             15290000
                        SET :WS-CURR-DB2-DATE = CURRENT DATE            15300000
                   END-EXEC                                             15310000
                                                                        15320000
                   EVALUATE TRUE                                        15330000
                       WHEN SQLCODE = ZERO                              15340000
                       WHEN SQLCODE = -904                              15350000
                       WHEN SQLCODE = -913                              15360000
                            CONTINUE                                    15370000
                                                                        15380000
                       WHEN SQLCODE NOT = ZERO                          15390000
                            MOVE '0240-GET-CURR-DB2-DATE'               15400000
                                               TO PV-PARAGRAPH-NAME     15410000
                            GO TO 99999-DB2-ABEND                       15420000
                   END-EVALUATE                                         15430000
           END-PERFORM.                                                 15440000
                                                                        15450000
           IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         15460000
               MOVE '0240-GET-CURR-DATE' TO PV-PARAGRAPH-NAME           15470000
               GO TO 99999-DB2-ABEND                                    15480000
           END-IF.                                                      15490000
                                                                        15500000
      ******************************************************************15510000
      *  CLOSE THE OUTPUT MESSAGE QUEUE.                               *15520000
      ******************************************************************15530000
       0250-MQ-CLOSE-QUEUE.                                             15540000
                                                                        15550000
           CALL WS-MQCLOSE USING PV-HCONN                               15560000
                                 PV-PQ-HANDLE                           15570000
                                 MQCO-NONE                              15580000
                                 PV-COMPLETION-CODE                     15590000
                                 PV-REASON.                             15600000
                                                                        15610000
           IF (PV-COMPLETION-CODE NOT = MQCC-OK) THEN                   15620000
               DISPLAY 'MQCLOSE ERROR: ' CC-OUTPUT-QUEUE-NAME           15630000
           ELSE                                                         15640000
              DISPLAY 'SUCCESSFUL CLOSE FOR OUTPUT QUEUE'               15650000
           END-IF.                                                      15660000
                                                                        15670000
      ******************************************************************15680000
      *  DISCONNECT FROM THE MQ QUEUE MANAGER                          *15690000
      ******************************************************************15700000
       0260-MQ-DISCONNECT-QMGR.                                         15710000
                                                                        15720000
           IF PV-CON-REASON IS NOT EQUAL TO MQRC-ALREADY-CONNECTED      15730000
              CALL WS-MQDISC USING PV-HCONN                             15740000
                                   PV-COMPLETION-CODE                   15750000
                                   PV-REASON                            15760000
               IF (PV-COMPLETION-CODE NOT = MQCC-OK) THEN               15770000
                   DISPLAY 'MQDISC ERROR: ' CC-OUTPUT-QMGR-NAME         15780000
               END-IF                                                   15790000
           ELSE                                                         15800000
               DISPLAY 'MQDISC SUCCESSFUL TO ', CC-OUTPUT-QMGR-NAME     15810000
           END-IF.                                                      15820000
                                                                        15830000
       0300-MQ-INITIALIZATION-API.                                      15840000
                                                                        15850000
           PERFORM 0310-READ-CONTROL-FILES-API.                         15860000
           IF SW-MQ-CONNECTED                                           15870000
              PERFORM 0330-MQ-OPEN-QUEUE-API                            15880000
           END-IF.                                                      15890000
                                                                        15900000
      * ------------------------------------------------------------- * 15910000
       0310-READ-CONTROL-FILES-API.                                     15920000
           READ CONTROL-OUTPUT-QMGR-API                                 15930000
                 INTO CC-CONTROL-OUTPUT-QMGR-API                        15940000
               AT END                                                   15950000
                 DISPLAY WS-PROGRAM-ID                                  15960000
                   ' CONTROL CARD MISSING - FOR OUTPUT QMGR-API NAME'   15970000
                 SET WS-CONTROL-CARD-ERROR TO TRUE                      15980000
                 CALL 'ILBOABN0' USING WS-ABEND-CODE.                   15990000
                                                                        16000000
           READ CONTROL-OUTPUT-QUEUE-API                                16010000
                 INTO CC-CONTROL-OUTPUT-QUEUE-API                       16020000
               AT END                                                   16030000
                 DISPLAY WS-PROGRAM-ID                                  16040000
                   ' CONTROL CARD MISSING - FOR OUTPUT QUEUE-API NAME'  16050000
                 SET WS-CONTROL-CARD-ERROR TO TRUE                      16060000
                 CALL 'ILBOABN0' USING WS-ABEND-CODE.                   16070000
                                                                        16080000
       0330-MQ-OPEN-QUEUE-API.                                          16090000
                                                                        16100000
      * ------------------------------------------------------------- * 16110000
      *    OPEN THE UNIX VENDOR INFO QUEUE FOR OUTPUT                   16120000
      * ------------------------------------------------------------- * 16130000
                                                                        16140000
           COMPUTE PV-OPEN-OPTIONS-API = MQOO-OUTPUT +                  16150000
                                         MQOO-FAIL-IF-QUIESCING.        16160000
           MOVE CC-OUTPUT-QUEUE-NAME-API TO MQOA-OBJECTNAME.            16170000
           MOVE CC-OUTPUT-QMGR-NAME-API TO MQOA-OBJECTQMGRNAME.         16180000
      *                                                                 16190000
           CALL WS-MQOPEN USING PV-HCONN                                16200000
                                MQM-OBJECT-DESCRIPTOR-API               16210000
                                PV-OPEN-OPTIONS-API                     16220000
                                PV-PQ-HANDLE-API                        16230000
                                PV-COMPLETION-CODE                      16240000
                                PV-REASON.                              16250000
      *                                                                 16260000
      *    IF OPEN FAILED THEN DISPLAY ERROR MESSAGE                    16270000
      *    AND EXIT.                                                    16280000
      *                                                                 16290000
           IF (PV-COMPLETION-CODE NOT = MQCC-OK) THEN                   16300000
              DISPLAY 'MQOPEN ERROR: ' CC-OUTPUT-QUEUE-NAME-API         16310000
              SET SW-MQ-NOT-OPENED-API      TO TRUE                     16320000
              PERFORM 99998-MQ-ABEND                                    16330000
           ELSE                                                         16340000
              SET SW-MQ-OPENED-API          TO TRUE                     16350000
              DISPLAY 'MQOPEN SUCCESSFUL FOR ' , MQOA-OBJECTQMGRNAME    16360000
              DISPLAY '                      ' , MQOA-OBJECTNAME        16370000
           END-IF.                                                      16380000
                                                                        16390000
                                                                        16400000
      ******************************************************************16410000
      *  CLOSE THE OUTPUT MESSAGE QUEUE.                               *16420000
      ******************************************************************16430000
       0350-MQ-CLOSE-QUEUE-API.                                         16440000
                                                                        16450000
           CALL WS-MQCLOSE USING PV-HCONN                               16460000
                                 PV-PQ-HANDLE-API                       16470000
                                 MQCO-NONE                              16480000
                                 PV-COMPLETION-CODE                     16490000
                                 PV-REASON.                             16500000
                                                                        16510000
           IF (PV-COMPLETION-CODE NOT = MQCC-OK) THEN                   16520000
               DISPLAY 'MQCLOSE ERROR: ' CC-OUTPUT-QUEUE-NAME-API       16530000
           ELSE                                                         16540000
              DISPLAY 'SUCCESSFUL CLOSE FOR OUTPUT QUEUE API'           16550000
           END-IF.                                                      16560000
                                                                        16570000
       1000-FILL-DC-TABLE.                                              16580000
                                                                        16590000
           INITIALIZE WS-DC-TABLE.                                      16600000
                                                                        16610000
           PERFORM 1100-OPEN-DC-CURSOR.                                 16620000
                                                                        16630000
           SET WS-MORE-DCS TO TRUE.                                     16640000
           MOVE ZERO TO WS-DC-TBL-SUB.                                  16650000
                                                                        16660000
           PERFORM 1200-FETCH-DC-CURSOR                                 16670000
                   UNTIL WS-NO-MORE-DCS.                                16680000
                                                                        16690000
           PERFORM 1300-CLOSE-DC-CURSOR.                                16700000
                                                                        16710000
       1100-OPEN-DC-CURSOR.                                             16720000
                                                                        16730000
           EXEC SQL                                                     16740000
                OPEN DC-CURSOR                                          16750000
           END-EXEC.                                                    16760000
                                                                        16770000
           EVALUATE TRUE                                                16780000
               WHEN SQLCODE NOT = ZERO                                  16790000
                    MOVE '1100-OPEN-DC-CURSOR' TO PV-PARAGRAPH-NAME     16800000
                    GO TO 99999-DB2-ABEND                               16810000
           END-EVALUATE.                                                16820000
                                                                        16830000
       1200-FETCH-DC-CURSOR.                                            16840000
                                                                        16850000
           EXEC SQL                                                     16860000
                FETCH DC-CURSOR                                         16870000
                 INTO :XMT00001-LOC-NBR                                 16880000
           END-EXEC.                                                    16890000
                                                                        16900000
           EVALUATE TRUE                                                16910000
               WHEN SQLCODE = ZERO                                      16920000
                    PERFORM 1210-FILL-DC-TBL-ENTRY                      16930000
                                                                        16940000
               WHEN SQLCODE = +100                                      16950000
                    SET WS-NO-MORE-DCS TO TRUE                          16960000
                                                                        16970000
               WHEN OTHER                                               16980000
                    MOVE '1200-FETCH-DC-CURSOR' TO PV-PARAGRAPH-NAME    16990000
                    GO TO 99999-DB2-ABEND                               17000000
           END-EVALUATE.                                                17010000
                                                                        17020000
       1210-FILL-DC-TBL-ENTRY.                                          17030000
                                                                        17040000
           ADD +1 TO WS-DC-TBL-SUB.                                     17050000
           MOVE XMT00001-LOC-NBR TO WS-DC-ID (WS-DC-TBL-SUB).           17060000
                                                                        17070000
       1300-CLOSE-DC-CURSOR.                                            17080000
                                                                        17090000
           EXEC SQL                                                     17100000
                CLOSE DC-CURSOR                                         17110000
           END-EXEC.                                                    17120000
                                                                        17130000
           EVALUATE TRUE                                                17140000
               WHEN SQLCODE NOT = ZERO                                  17150000
                    MOVE '1300-CLOSE-DC-CURSOR' TO PV-PARAGRAPH-NAME    17160000
                    GO TO 99999-DB2-ABEND                               17170000
           END-EVALUATE.                                                17180000
                                                                        17190000
       10000-PROCESS-INPUT-FILE.                                        17200000
                                                                        17210000
           EVALUATE TRUE                                                17220000
               WHEN PO002-ALLOC-RECORD                                  17230000
                 IF PS-HOLD-ENTRY-NOT-IN-LEGACY                         17240000
                    IF PO002-A-ALLOC-QTY (1)  > ZERO                    17250000
                        PERFORM 11000-PROCESS-ITEM-ALLOCATION           17260000
                                VARYING WS-STORE-SUB FROM 1 BY 1        17270000
                                UNTIL   WS-STORE-SUB > WS-STORE-SUB-MAX 17280000
                                OR      PS-ROLLBACK-ORDER               17290000
                    END-IF                                              17300000
                 END-IF                                                 17310000
                                                                        17320000
               WHEN PO002-ITEM-RECORD                                   17330000
                 IF PS-HOLD-ENTRY-NOT-IN-LEGACY                         17340000
                    IF PO002-I-TOTAL-QTY > ZERO                         17350000
                        PERFORM 12000-PROCESS-ITEM-DETAIL               17360000
                    END-IF                                              17370000
                 END-IF                                                 17380000
                                                                        17390000
               WHEN PO002-HEADER-RECORD                                 17400000
                    IF WS-SKU-NOT-FOUND                                 17410000
                        PERFORM 97000-FORMAT-ERROR-STR-QTY              17420000
                        SET WS-SKU-FOUND TO TRUE                        17430000
                    END-IF                                              17440000
                                                                        17450000
                    MOVE ZERO TO WS-TPURCHS-SQLCODE                     17460000
                    MOVE PO002-H-INTERCHANGE  TO WS-CURR-INTERCHANGE    17470000
                    MOVE ZERO TO VNDDPT-ENT-ID                          17480000
                                                                        17490000
                    SET PS-MULTIPLE-DEPTS TO TRUE                       17500000
                    SET PS-VALID-SKUS     TO TRUE                       17510000
                    SET PS-ACTIVE-VENDOR  TO TRUE                       17520000
                    PERFORM 10100-CHECK-DEPTS                           17530000
                       UNTIL PS-NOT-MULTIPLE-DEPTS AND PS-VALID-SKUS    17540000
                                                                        17550000
                    IF WS-NO-MORE-INPUT                                 17560000
                        CONTINUE                                        17570000
                    ELSE                                                17580000
                        PERFORM 10001-CHECK-PO-NBR                      17590000
                           UNTIL WS-NO-MORE-INPUT OR                    17600000
                                 WS-TPURCHS-SQLCODE = +100              17610000
                    END-IF                                              17620000
                                                                        17630000
                    IF WS-MORE-INPUT                                    17640000
                        SET WS-FIRST-ITEM TO TRUE                       17650000
                                                                        17660000
                        PERFORM 13000-PROCESS-HEADER                    17670000
                    END-IF                                              17680000
           END-EVALUATE.                                                17690000
                                                                        17700000
           IF PS-ROLLBACK-ORDER                                         17710000
               SET PS-NO-ROLLBACK-ORDER TO TRUE                         17720000
           ELSE                                                         17730000
               IF WS-ERROR-RECORD                                       17740000
                   SET WS-NOT-ERROR-RECORD TO TRUE                      17750000
               ELSE                                                     17760000
                   IF WS-MORE-INPUT                                     17770000
                       PERFORM 99997-READ-INPUT-FILE                    17780000
                   END-IF                                               17790000
               END-IF                                                   17800000
           END-IF.                                                      17810000
                                                                        17820000
       10001-CHECK-PO-NBR.                                              17830000
                                                                        17840000
           MOVE PURCHS-PO-NBR  TO WS-SAVE-PO-NBR.                       17850000
           MOVE PO002-H-INTERCHANGE TO WS-CURR-INTERCHANGE.             17860000
           MOVE ZERO TO VNDDPT-ENT-ID.                                  17870000
           MOVE PO002-H-PO-NBR TO PURCHS-PO-NBR.                        17880000
           PERFORM 13010-CHECK-RMS-ROLLOUT.                             17890000
                                                                        17900000
           IF PO002-H-LC-IND NOT EQUAL 'LC'                             17910000
              PERFORM WITH TEST AFTER                                   17920000
                      VARYING PV-RETRY-COUNTER FROM 1 BY 1              17930000
                      UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR      17940000
                              SQLCODE = ZERO OR                         17950000
                              SQLCODE = +100                            17960000
                                                                        17970000
                      EXEC SQL                                          17980000
                           SELECT PO_NBR                                17990000
                             INTO :PURCHS-PO-NBR                        18000000
                             FROM TPURCHS                               18010000
                            WHERE PO_NBR = :PURCHS-PO-NBR               18020000
                              AND VER_STATUS_CDE = 'A'                  18030000
P41269                      WITH UR                                     18040000
                      END-EXEC                                          18050000
                                                                        18060000
                      EVALUATE TRUE                                     18070000
                          WHEN SQLCODE = ZERO                           18080000
                          WHEN SQLCODE = +100                           18090000
                          WHEN SQLCODE = -904                           18100000
                          WHEN SQLCODE = -913                           18110000
                               CONTINUE                                 18120000
                                                                        18130000
                          WHEN SQLCODE NOT = ZERO                       18140000
                               MOVE '10001-CHECK-PO-NBR'                18150000
                                                   TO PV-PARAGRAPH-NAME 18160000
                               GO TO 99999-DB2-ABEND                    18170000
                      END-EVALUATE                                      18180000
              END-PERFORM                                               18190000
                                                                        18200000
              IF PV-RETRY-COUNTER > PC-MAX-RETRIES                      18210000
                  MOVE '10001-CHECK-PO-NBR' TO PV-PARAGRAPH-NAME        18220000
                  GO TO 99999-DB2-ABEND                                 18230000
              END-IF                                                    18240000
                                                                        18250000
              IF SQLCODE = ZERO                                         18260000
      *THE CHECK IS DONE FOR DEPARTMENT OF ENTRY BECAUSE THIS PROGRAM   18270000
      *DOES NOT CARE ABOUT ORDERS THAT HAVE ENTRY IN LEGACY.  SO IF THE 18280000
      *PROGRAM COMES ACROSS A PO THAT ALREADY EXISTS AND HAS ENTRY IN   18290000
      *LEGACY, IT DOES NOT CARE.                                        18300000
                IF PO056-ENTRY-NOT-IN-LEGACY                            18310000
                  MOVE ZERO TO WS-TPURCHS-SQLCODE                       18320000
                                                                        18330000
                  PERFORM 96000-FORMAT-ERROR-INFO                       18340000
                                                                        18350000
                  MOVE PO002-H-PO-NBR  TO WS-PO-NBR                     18360000
                  MOVE WS-PO-NBR       TO ERR-RPT-D4-PO-NBR             18370000
                  MOVE PO002-H-ISA-CNTL-NBR TO ERR-RPT-D3-ISA-CNTL-NBR  18380000
                  MOVE SPACES TO ERR-RPT-D5-UPC                         18390000
W24803            MOVE ZEROES TO ERR-RPT-D5-SKU                         18400000
                                                                        18410000
                  PERFORM 98000-PRINT-ERROR-PAGE                        18420000
                                                                        18430000
                  MOVE WS-PO-EXISTS-MSG TO ERR-RPT-DETAIL-ERROR         18440000
                  WRITE ERROR-RECORD  FROM ERR-RPT-DETAIL-ERROR         18450000
                        AFTER ADVANCING 3 LINES                         18460000
                  SET PS-ERROR-REPORT-CREATED TO TRUE                   18470000
                                                                        18480000
                END-IF                                                  18490000
                SET PO002-ITEM-RECORD TO TRUE                           18500000
                SET WS-ERROR-RECORD   TO TRUE                           18510000
                PERFORM 99997-READ-INPUT-FILE                           18520000
                      UNTIL WS-NO-MORE-INPUT OR                         18530000
                           PO002-HEADER-RECORD                          18540000
                SET PS-MULTIPLE-DEPTS TO TRUE                           18550000
                SET PS-VALID-SKUS     TO TRUE                           18560000
                PERFORM 10100-CHECK-DEPTS                               18570000
                   UNTIL PS-NOT-MULTIPLE-DEPTS AND PS-VALID-SKUS        18580000
              ELSE                                                      18590000
                  IF SQLCODE = +100                                     18600000
                     MOVE +100 TO WS-TPURCHS-SQLCODE                    18610000
                  END-IF                                                18620000
              END-IF                                                    18630000
           ELSE                                                         18640000
               MOVE +100 TO WS-TPURCHS-SQLCODE                          18650000
           END-IF.                                                      18660000
                                                                        18670000
           MOVE WS-SAVE-PO-NBR TO PURCHS-PO-NBR.                        18680000
                                                                        18690000
       10100-CHECK-DEPTS.                                               18700000
                                                                        18710000
           IF PO002-H-DEPT-STATUS = 'M'                                 18720000
                                                                        18730000
               SET PS-MULTIPLE-DEPTS TO TRUE                            18740000
               PERFORM 96000-FORMAT-ERROR-INFO                          18750000
                                                                        18760000
               MOVE PO002-H-PO-NBR TO WS-PO-NBR                         18770000
               MOVE PO002-H-ISA-CNTL-NBR TO ERR-RPT-D3-ISA-CNTL-NBR     18780000
               MOVE WS-PO-NBR      TO ERR-RPT-D4-PO-NBR                 18790000
                                                                        18800000
               MOVE SPACES TO ERR-RPT-D5-UPC                            18810000
W24803         MOVE ZEROES TO ERR-RPT-D5-SKU                            18820000
                                                                        18830000
               PERFORM 98000-PRINT-ERROR-PAGE                           18840000
                                                                        18850000
               MOVE WS-MULT-DEPT-MSG TO ERR-RPT-DETAIL-ERROR            18860000
               WRITE ERROR-RECORD  FROM ERR-RPT-DETAIL-ERROR            18870000
                     AFTER ADVANCING 3 LINES                            18880000
                                                                        18890000
               SET PS-ERROR-REPORT-CREATED TO TRUE                      18900000
               SET PO002-ITEM-RECORD TO TRUE                            18910000
               SET WS-ERROR-RECORD TO TRUE                              18920000
                                                                        18930000
               PERFORM 99997-READ-INPUT-FILE                            18940000
                       UNTIL WS-NO-MORE-INPUT OR                        18950000
                             PO002-HEADER-RECORD                        18960000
           ELSE                                                         18970000
              IF (PO002-H-DEPT-NBR = '000' OR                           18980000
                  PO002-H-DEPT-NBR = '   ') AND WS-MORE-INPUT           18990000
                  SET PS-NO-VALID-SKUS TO TRUE                          19000000
                  PERFORM 96000-FORMAT-ERROR-INFO                       19010000
                                                                        19020000
                  MOVE PO002-H-PO-NBR TO WS-PO-NBR                      19030000
                  MOVE PO002-H-ISA-CNTL-NBR TO ERR-RPT-D3-ISA-CNTL-NBR  19040000
                  MOVE WS-PO-NBR      TO ERR-RPT-D4-PO-NBR              19050000
                                                                        19060000
                  MOVE SPACES TO ERR-RPT-D5-UPC                         19070000
W24803            MOVE ZEROES TO ERR-RPT-D5-SKU                         19080000
                                                                        19090000
                  PERFORM 98000-PRINT-ERROR-PAGE                        19100000
                                                                        19110000
                  MOVE WS-NO-VALID-SKUS-MSG TO ERR-RPT-DETAIL-ERROR     19120000
                  WRITE ERROR-RECORD  FROM ERR-RPT-DETAIL-ERROR         19130000
                        AFTER ADVANCING 3 LINES                         19140000
                                                                        19150000
                  SET PS-ERROR-REPORT-CREATED TO TRUE                   19160000
                  SET PO002-ITEM-RECORD TO TRUE                         19170000
                  SET WS-ERROR-RECORD TO TRUE                           19180000
                                                                        19190000
                  PERFORM 99997-READ-INPUT-FILE                         19200000
                          UNTIL WS-NO-MORE-INPUT OR                     19210000
                                PO002-HEADER-RECORD                     19220000
               ELSE                                                     19230000
                  SET PS-NOT-MULTIPLE-DEPTS TO TRUE                     19240000
                  SET PS-VALID-SKUS         TO TRUE                     19250000
               END-IF                                                   19260000
           END-IF.                                                      19270000
                                                                        19280000
       11000-PROCESS-ITEM-ALLOCATION.                                   19290000
                                                                        19300000
           IF PO002-A-STORE-NBR (WS-STORE-SUB) = SPACES                 19310000
               MOVE WS-STORE-SUB-MAX TO WS-STORE-SUB                    19320000
           ELSE                                                         19330000
               IF WS-SKU-FOUND                                          19340000
                   IF (WS-NOT-HANES AND WS-NOT-JOCKEY AND               19350000
                       WS-NOT-VANITY-FAIR AND WS-NOT-LILY-OF-FRANCE AND 19360000
                       WS-NOT-ESTEE-LAUDER AND WS-NOT-HALLMARK AND      19370000
                       WS-NOT-LIZ-CLAIBORNE AND WS-NOT-LEE-WRANGLER AND 19380000
                       WS-NOT-FISHMAN AND WS-NOT-OLGA-WARNER AND        19390000
                       WS-NOT-PLAYTEX AND WS-NOT-BALI AND               19400000
                       WS-NOT-WONDERBRA AND WS-NOT-TOP-OF-THE-WORLD AND 19410000
                       WS-NOT-VF-IMAGEWEAR AND WS-NOT-KNIGHTS-APPAREL   19420000
                       AND WS-NOT-NEXT-INC                              19430000
352053                 AND WS-NOT-47BRAND-LLC                           19440000
                       AND WS-NOT-SUPREME-INTL                          19450000
                       AND WS-NOT-COLLEGE-CONCEPTS                      19460000
                       AND WS-NOT-RUSSELL-ATHLETIC                      19470000
                       AND WS-NOT-OUTERSTUFF                            19480000
                       AND WS-NOT-HADDAD                                19490000
                       AND WS-NOT-HANES-UNDERWEAR                       19500000
                       AND WS-NOT-COKEM                                 19510000
                       AND WS-NOT-GEAR-FOR-SPORTS                       19520000
                       AND WS-NOT-COLOSSEUM                             19530000
                       AND WS-NOT-SPORTS-LIC                            19540000
                       AND WS-NOT-RENAISSANCE                           19550000
WR9604                 AND WS-NOT-LEVIS                                 19560000
WR0933                 AND WS-NOT-TSHIRT-INT                            19570000
W41905                 AND WS-NOT-JACMEL-JWL                            19580000
W41952                 AND WS-NOT-GIII-LEATHER                          19590000
W42092                 AND WS-NOT-PVH-SUPERBA                           19600000
534202                 AND WS-NOT-J-AMERICA                             19610000
453643                 AND WS-NOT-ETRNL-FRTN                            19620000
686121                 AND WS-NOT-HGGR-CLTING                           19630000
371617                 AND WS-NOT-WILL-DICKIE                           19640000
371617                 AND WS-NOT-NEW-ERACAP                            19650000
505256                 AND WS-NOT-NEW-MAIDENFORM                        19660000
683003                 AND WS-NOT-RANDA-ACCESSORIES                     19670000
944205                 AND WS-NOT-BOELTER                               19680000
002139                 AND WS-NOT-GONZALS                               19690000
647062                 AND WS-NOT-LUXOTTICA                             19700000
042023                 AND WS-NOT-CC-PRODUCTS                           19710000
018127                 AND WS-NOT-TERVIS                                19720000
356324                 AND WS-NOT-PERRY                                 19730000
637834                 AND WS-NOT-OURAY                                 19740000
185577                 AND WS-NOT-BESPOKE                               19750000
790723                 AND WS-NOT-FGX                                   19760000
956632                 AND WS-NOT-RANDA                                 19770000
956632                 AND WS-NOT-LOGO                                  19780000
956632                 AND WS-NOT-GREAT-AMERICAN                        19790000
683026                 AND WS-NOT-RANDA-CORP                            19800000
346771                 AND WS-NOT-MAD-ENGINE                            19810000
265129                 AND WS-NOT-HYBRID-PROM                           19820000
887802                 AND WS-NOT-BIO-WORLD                             19830000
927044                 AND WS-NOT-NORTH-WEST                            19840000
925845                 AND WS-NOT-BARE-FEET                             19850000
762449                 AND WS-NOT-MASTER-PUZZLE                         19860000
889751                 AND WS-NOT-RIPPLE-JUNCTION                       19870000
064017                 AND WS-NOT-LICHTENBERG                           19880000
176716                 AND WS-NOT-SPIRIT-LEATHERWORKS                   19890000
176682                 AND WS-NOT-TEE-SHIRT-CENTRAL                     19900000
680553                 AND WS-NOT-LF-MENS-GROUP-LLC)                    19901000
                       OR                                               19910000
                     (WS-HANES  AND WS-SHIP-DATE = '2000-00-00') OR     19920000
                     (WS-HANES  AND WS-SHIP-DATE = '20  -  -  ') OR     19930000
                     (WS-JOCKEY AND WS-SHIP-DATE = '2000-00-00') OR     19940000
                     (WS-JOCKEY AND WS-SHIP-DATE = '20  -  -  ')        19950000
                         PERFORM 18230-GET-SHIP-DATE                    19960000
                   END-IF                                               19970000
                   IF WS-DTS-PO                                         19980000
                      PERFORM 11110-VALIDATE-DTS-STORE                  19990000
                   ELSE                                                 20000000
                      PERFORM 11100-FIND-DC-FOR-STORE                   20010000
                   END-IF                                               20020000
                   IF PS-ROLLBACK-ORDER                                 20030000
                       CONTINUE                                         20040000
                   ELSE                                                 20050000
                                                                        20060000
                       PERFORM 11200-FORMAT-TMESTDS                     20070000
                                                                        20080000
                       IF PS-HOLD-ENTRY-IN-LEGACY                       20090000
                           PERFORM 11300-INSERT-TMESTDS                 20100000
                       END-IF                                           20110000
                                                                        20120000
                       IF WS-DTS-PO                                     20130000
                           PERFORM 11400-FORMAT-TALLPLN-DTS             20140000
                                                                        20150000
                           IF PS-HOLD-ENTRY-IN-LEGACY                   20160000
                               PERFORM 17200-INSERT-TALLPLN             20170000
                           END-IF                                       20180000
                       END-IF                                           20190000
               ELSE                                                     20200000
                   PERFORM 11500-FORMAT-SKU-ERROR                       20210000
               END-IF                                                   20220000
           END-IF.                                                      20230000
                                                                        20240000
       11100-FIND-DC-FOR-STORE.                                         20250000
           MOVE PO002-A-STORE-NBR (WS-STORE-SUB) TO WS-STORE-X.         20260000
           MOVE WS-STORE-9 TO XMT00001-LOC-NBR.                         20270000
                                                                        20280000
           PERFORM WITH TEST AFTER                                      20290000
              VARYING PV-RETRY-COUNTER FROM 1 BY 1                      20300000
                UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES OR              20310000
                      SQLCODE = ZERO OR SQLCODE = +100                  20320000
                                                                        20330000
              EXEC SQL                                                  20340000
                   SELECT XL1.LOC_NBR                                   20350000
                         ,XL2.LOC_NBR                                   20360000
      *                  , 0                                            20370000
                     INTO :XMT00001-LOC-NBR                             20380000
                         ,:PV-DB-DC-NBR                                 20390000
      *                  ,:STVNDC-SHIP-TO-TMP-DC-NBR                    20400000
                     FROM XMT_LOC XL1                                   20410000
                         ,XMT_LOC XL2                                   20420000
                    WHERE (XL1.LOC_TYP_CDE  IN ('DS','DC','CS')         20430000
                       OR  XL1.LOC_NBR = 899)                           20440000
                      AND XL1.LOC_NBR = :XMT00001-LOC-NBR               20450000
                      AND XL1.CLO_DTE > DATE(:WS-SHIP-DATE)             20460000
                      AND (XL2.LOC_TYP_CDE = 'DC' OR                    20470000
                           XL2.LOC_NBR = 899)                           20480000
                      AND XL2.LOC_NBR =                                 20490000
                         (SELECT DC_NBR                                 20500000
                            FROM XMT_DC_LOC_ASGMT DLA1                  20510000
                           WHERE DLA1.LOC_NBR = XL1.LOC_NBR             20520000
                             AND DLA1.PO_STRT_DTE =                     20530000
                                (SELECT MAX(PO_STRT_DTE)                20540000
                                   FROM XMT_DC_LOC_ASGMT DLA2           20550000
                                  WHERE DLA2.PO_STRT_DTE <=             20560000
                                        DATE(:WS-SHIP-DATE)             20570000
                                   AND DLA1.LOC_NBR = DLA2.LOC_NBR))    20580000
      *               AND XL1.LOC_NBR NOT IN                            20590000
      *                  (SELECT B.STR_NBR                              20600000
      *                     FROM   TSTVNDC B                            20610000
      *                    WHERE  B.STR_NBR  = XL1.LOC_NBR              20620000
      *                      AND  ENT_ID = :VNDDPT-ENT-ID               20630000
      *                      AND (DEPT_NBR = '999' OR                   20640000
      *                           DEPT_NBR = :VNDDPT-DEPT-NBR)          20650000
      *                      AND (DATE(:WS-SHIP-DATE) BETWEEN           20660000
      *                            EFF_BEG_DTE AND EFF_END_DTE))        20670000
      *            UNION                                                20680000
      *            SELECT XL1.LOC_NBR                                   20690000
      *                  ,XL2.LOC_NBR                                   20700000
      *                  ,SHIP_TO_TMP_DC_NBR                            20710000
      *              INTO :XMT00001-LOC-NBR                             20720000
      *                  ,:PV-DB-DC-NBR                                 20730000
      *                  ,:STVNDC-SHIP-TO-TMP-DC-NBR                    20740000
      *              FROM XMT_LOC XL1                                   20750000
      *                  ,XMT_LOC XL2                                   20760000
      *                  ,TSTVNDC B                                     20770000
      *             WHERE XL1.LOC_TYP_CDE  IN ('DS','DC','CS')          20780000
      *               AND XL1.LOC_NBR = :XMT00001-LOC-NBR               20790000
      *               AND XL1.CLO_DTE > DATE(:WS-SHIP-DATE)             20800000
      *               AND B.STR_NBR  = XL1.LOC_NBR                      20810000
      *               AND ENT_ID = :VNDDPT-ENT-ID                       20820000
      *               AND (DEPT_NBR = '999' OR                          20830000
      *                    DEPT_NBR = :VNDDPT-DEPT-NBR)                 20840000
      *               AND (DATE(:WS-SHIP-DATE) BETWEEN                  20850000
      *                    EFF_BEG_DTE AND EFF_END_DTE)                 20860000
      *               AND XL2.LOC_TYP_CDE = 'DC'                        20870000
      *               AND XL2.LOC_NBR =                                 20880000
      *                  (SELECT DC_NBR                                 20890000
      *                     FROM XMT_DC_LOC_ASGMT DLA1                  20900000
      *                    WHERE DLA1.LOC_NBR = XL1.LOC_NBR             20910000
      *                      AND DLA1.PO_STRT_DTE =                     20920000
      *                         (SELECT MAX(PO_STRT_DTE)                20930000
      *                            FROM XMT_DC_LOC_ASGMT DLA2           20940000
      *                           WHERE DLA2.PO_STRT_DTE <=             20950000
      *                                 DATE(:WS-SHIP-DATE)             20960000
      *                            AND DLA1.LOC_NBR = DLA2.LOC_NBR))    20970000
P41269               WITH UR                                            20980000
              END-EXEC                                                  20990000
                                                                        21000000
                   EVALUATE TRUE                                        21010000
                       WHEN SQLCODE = ZERO                              21020000
                       WHEN SQLCODE = -904                              21030000
                       WHEN SQLCODE = -913                              21040000
                            CONTINUE                                    21050000
                                                                        21060000
                       WHEN SQLCODE = +100                              21070000
                           MOVE PO002-H-PO-NBR TO WS-HOLD-PO-NBR        21080000
                           IF PS-HOLD-ENTRY-IN-LEGACY                   21090000
                               PERFORM 20000-ROLLBACK-PURCHASE-ORDER    21100000
                           END-IF                                       21110000
                           PERFORM 11150-PRINT-INVALID-STORE            21120000
                           PERFORM 99997-READ-INPUT-FILE                21130000
                             UNTIL WS-HOLD-PO-NBR NOT = PO002-H-PO-NBR  21140000
                                OR WS-NO-MORE-INPUT                     21150000
                           SET PS-ROLLBACK-ORDER                        21160000
                               WS-NO-ITEM-WRITTEN TO TRUE               21170000
                           MOVE ZERO TO WS-PO-LNE-NBR                   21180000
                                        WS-TPURITM-INSERTED             21190000
                                        WS-TMESTDS-INSERTED             21200000
                           PERFORM 17050-INITIALIZE-DC-QTY              21210000
                                                                        21220000
                       WHEN SQLCODE NOT = ZERO                          21230000
                            DISPLAY 'WS-STORE-9 ' WS-STORE-9            21240000
                            MOVE '11100-FIND-DC-FOR-STORE'              21250000
                                                   TO PV-PARAGRAPH-NAME 21260000
                            GO TO 99999-DB2-ABEND                       21270000
                   END-EVALUATE                                         21280000
           END-PERFORM.                                                 21290000
                                                                        21300000
           IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         21310000
               MOVE '11100-FIND-DC-FOR-STR' TO PV-PARAGRAPH-NAME        21320000
               GO TO 99999-DB2-ABEND                                    21330000
           END-IF.                                                      21340000
                                                                        21350000
      *  GET THE CORRECT DC NUMBER INTO THE WS FIELD THAT IS USED       21360000
      *  THROUGHOUT THE PROGRAM.                                        21370000
           MOVE PV-DB-DC-NBR TO PV-DC-NBR-9.                            21380000
      *    IF STVNDC-SHIP-TO-TMP-DC-NBR > ZEROES                        21390000
      *        MOVE STVNDC-SHIP-TO-TMP-DC-NBR   TO WS-DC-NUMBER         21400000
      *        MOVE WS-DC-NUMBER-LIT        TO PV-DC-NBR-9              21410000
      *    ELSE                                                         21420000
      *        MOVE PV-DB-DC-NBR TO PV-DC-NBR-9                         21430000
      *    END-IF.                                                      21440000
                                                                        21450000
      * IF THE ORDER HAS ENTRY IN RMS, ADD THE STORE TO THE API STORE   21460000
      * ALLOCATION TABLE.                                               21470000
           IF PS-HOLD-ENTRY-NOT-IN-LEGACY AND SQLCODE = ZERO AND        21480000
             ((WS-NOT-HALLMARK         AND WS-NOT-LIZ-CLAIBORNE AND     21490000
               WS-NOT-ESTEE-LAUDER     AND WS-NOT-LEE-WRANGLER  AND     21500000
               WS-NOT-FISHMAN          AND WS-NOT-OLGA-WARNER   AND     21510000
               WS-NOT-PLAYTEX          AND WS-NOT-HANES         AND     21520000
               WS-NOT-BALI             AND WS-NOT-WONDERBRA     AND     21530000
               WS-NOT-TOP-OF-THE-WORLD AND WS-NOT-VF-IMAGEWEAR  AND     21540000
               WS-NOT-KNIGHTS-APPAREL  AND WS-NOT-NEXT-INC      AND     21550000
352053         WS-NOT-47BRAND-LLC      AND WS-NOT-SUPREME-INTL  AND     21560000
               WS-NOT-COLLEGE-CONCEPTS AND WS-NOT-RUSSELL-ATHLETIC AND  21570000
               WS-NOT-OUTERSTUFF AND WS-NOT-HADDAD AND                  21580000
               WS-NOT-HANES-UNDERWEAR AND WS-NOT-COKEM AND              21590000
               WS-NOT-GEAR-FOR-SPORTS AND WS-NOT-COLOSSEUM AND          21600000
               WS-NOT-SPORTS-LIC AND WS-NOT-RENAISSANCE AND             21610000
WR9604         WS-NOT-LEVIS AND                                         21620000
WR0933         WS-NOT-TSHIRT-INT AND                                    21630000
W41905         WS-NOT-JACMEL-JWL AND                                    21640000
W41952         WS-NOT-GIII-LEATHER AND                                  21650000
W42092         WS-NOT-PVH-SUPERBA  AND                                  21660000
534202         WS-NOT-J-AMERICA    AND                                  21670000
453643         WS-NOT-ETRNL-FRTN   AND                                  21680000
686121         WS-NOT-HGGR-CLTING  AND                                  21690000
371617         WS-NOT-WILL-DICKIE  AND                                  21700000
371617         WS-NOT-NEW-ERACAP   AND                                  21710000
505256         WS-NOT-NEW-MAIDENFORM      AND                           21720000
683003         WS-NOT-RANDA-ACCESSORIES   AND                           21730000
944205         WS-NOT-RANDA-CORP   AND                                  21740000
002139         WS-NOT-GONZALS      AND                                  21750000
647062         WS-NOT-LUXOTTICA    AND                                  21760000
042023         WS-NOT-CC-PRODUCTS  AND                                  21770000
018127         WS-NOT-TERVIS       AND                                  21780000
356324         WS-NOT-PERRY        AND                                  21790000
637834         WS-NOT-OURAY        AND                                  21800000
185577         WS-NOT-BESPOKE      AND                                  21810000
790723         WS-NOT-FGX          AND                                  21820000
956632         WS-NOT-RANDA        AND                                  21830000
956632         WS-NOT-LOGO         AND                                  21840000
956632         WS-NOT-GREAT-AMERICAN  AND                               21850000
944205         WS-NOT-BOELTER      AND                                  21860000
346771         WS-NOT-MAD-ENGINE   AND                                  21870000
265129         WS-NOT-HYBRID-PROM  AND                                  21880000
887802         WS-NOT-BIO-WORLD    AND                                  21890000
927044         WS-NOT-NORTH-WEST   AND                                  21900000
925845         WS-NOT-BARE-FEET    AND                                  21910000
762449         WS-NOT-MASTER-PUZZLE AND                                 21920000
889751         WS-NOT-RIPPLE-JUNCTION AND                               21930000
064017         WS-NOT-LICHTENBERG AND                                   21940000
176716         WS-NOT-SPIRIT-LEATHERWORKS AND                           21950000
176682         WS-NOT-TEE-SHIRT-CENTRAL   AND                           21960000
680553         WS-NOT-LF-MENS-GROUP-LLC)                                21961000
                                   OR                                   21970000
              ((WS-HALLMARK OR WS-LIZ-CLAIBORNE OR WS-ESTEE-LAUDER OR   21980000
                WS-LEE-WRANGLER OR WS-FISHMAN OR WS-OLGA-WARNER    OR   21990000
                WS-PLAYTEX OR WS-BALI  OR WS-WONDERBRA             OR   22000000
                WS-TOP-OF-THE-WORLD    OR WS-VF-IMAGEWEAR          OR   22010000
                WS-KNIGHTS-APPAREL     OR WS-NEXT-INC              OR   22020000
352053          WS-47BRAND-LLC         OR WS-SUPREME-INTL          OR   22030000
                WS-COLLEGE-CONCEPTS    OR WS-RUSSELL-ATHLETIC      OR   22040000
                WS-OUTERSTUFF          OR WS-HADDAD OR                  22050000
                WS-HANES-UNDERWEAR     OR WS-COKEM OR WS-HANES OR       22060000
                WS-GEAR-FOR-SPORTS     OR WS-COLOSSEUM OR               22070000
                WS-SPORTS-LIC          OR WS-RENAISSANCE OR             22080000
WR9604          WS-LEVIS               OR                               22090000
WR0933          WS-TSHIRT-INT          OR                               22100000
W41905          WS-JACMEL-JWL          OR WS-GIII-LEATHER OR            22110000
W42092          WS-PVH-SUPERBA         OR                               22120000
534202          WS-J-AMERICA           OR                               22130000
453643          WS-ETRNL-FRTN          OR                               22140000
686121          WS-HGGR-CLTING         OR                               22150000
371617          WS-WILL-DICKIE         OR                               22160000
371617          WS-NEW-ERACAP          OR                               22170000
505256          WS-NEW-MAIDENFORM      OR                               22180000
683003          WS-RANDA-ACCESSORIES   OR                               22190000
683026          WS-RANDA-CORP          OR                               22200000
683026          WS-GONZALS             OR                               22210000
647062          WS-LUXOTTICA           OR                               22220000
042023          WS-CC-PRODUCTS         OR                               22230000
018127          WS-TERVIS              OR                               22240000
356324          WS-PERRY               OR                               22250000
637834          WS-OURAY               OR                               22260000
185577          WS-BESPOKE             OR                               22270000
790723          WS-FGX                 OR                               22280000
956632          WS-RANDA               OR                               22290000
956632          WS-LOGO                OR                               22300000
956632          WS-GREAT-AMERICAN      OR                               22310000
683026          WS-BOELTER             OR                               22320000
346771          WS-MAD-ENGINE          OR                               22330000
265129          WS-HYBRID-PROM         OR                               22340000
887802          WS-BIO-WORLD           OR                               22350000
927044          WS-NORTH-WEST          OR                               22360000
925845          WS-BARE-FEET           OR                               22370000
762449          WS-MASTER-PUZZLE       OR                               22380000
889751          WS-RIPPLE-JUNCTION     OR                               22390000
064017          WS-LICHTENBERG         OR                               22400000
176716          WS-SPIRIT-LEATHERWORKS OR                               22410000
176682          WS-TEE-SHIRT-CENTRAL   OR                               22420000
680553          WS-LF-MENS-GROUP-LLC)                                   22421000
                                                   AND                  22430000
               (XMT00001-LOC-NBR NOT EQUAL PV-DC-NBR-9)))               22440000
              MOVE XMT00001-LOC-NBR TO                                  22450000
                                     WS-STR-NBR-API(WS-STR-TBLE-SUB-API)22460000
              MOVE PO002-A-ALLOC-QTY (WS-STORE-SUB) TO                  22470000
                   WS-STR-QTY-API(WS-STR-TBLE-SUB-API)                  22480000
              MOVE PV-DC-NBR-9 TO                                       22490000
                                      WS-STR-DC-API(WS-STR-TBLE-SUB-API)22500000
              ADD 1 TO WS-STR-TBLE-SUB-API                              22510000
           END-IF.                                                      22520000
                                                                        22530000
       11110-VALIDATE-DTS-STORE.                                        22540000
           MOVE PO002-A-STORE-NBR (WS-STORE-SUB) TO WS-STORE-X.         22550000
           MOVE WS-STORE-9 TO XMT00001-LOC-NBR.                         22560000
                                                                        22570000
           PERFORM WITH TEST AFTER                                      22580000
              VARYING PV-RETRY-COUNTER FROM 1 BY 1                      22590000
                UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES OR              22600000
                      SQLCODE = ZERO OR SQLCODE = +100                  22610000
                                                                        22620000
              EXEC SQL                                                  22630000
                   SELECT XL1.LOC_NBR                                   22640000
                     INTO :XMT00001-LOC-NBR                             22650000
                     FROM XMT_LOC XL1                                   22660000
                    WHERE (XL1.LOC_TYP_CDE  IN ('DS','CS')              22670000
                       OR  XL1.LOC_NBR = 899)                           22680000
                      AND XL1.LOC_NBR = :XMT00001-LOC-NBR               22690000
                      AND XL1.CLO_DTE > :WS-SHIP-DATE                   22700000
      *               AND XL1.LOC_NBR NOT IN                            22710000
      *                  (SELECT B.STR_NBR                              22720000
      *                     FROM   TSTVNDC B                            22730000
      *                    WHERE  B.STR_NBR  = XL1.LOC_NBR              22740000
      *                      AND  ENT_ID = :VNDDPT-ENT-ID               22750000
      *                      AND (DEPT_NBR = '999' OR                   22760000
      *                           DEPT_NBR = :VNDDPT-DEPT-NBR)          22770000
      *                      AND (DATE(:WS-SHIP-DATE) BETWEEN           22780000
      *                            EFF_BEG_DTE AND EFF_END_DTE))        22790000
P41269             WITH UR                                              22800000
              END-EXEC                                                  22810000
                                                                        22820000
                   EVALUATE TRUE                                        22830000
                       WHEN SQLCODE = ZERO                              22840000
                       WHEN SQLCODE = -904                              22850000
                       WHEN SQLCODE = -913                              22860000
                            CONTINUE                                    22870000
                       WHEN SQLCODE = +100                              22880000
                           MOVE PO002-H-PO-NBR TO WS-HOLD-PO-NBR        22890000
                           IF PS-HOLD-ENTRY-IN-LEGACY                   22900000
                               PERFORM 20000-ROLLBACK-PURCHASE-ORDER    22910000
                           END-IF                                       22920000
                           PERFORM 11150-PRINT-INVALID-STORE            22930000
                           PERFORM 99997-READ-INPUT-FILE                22940000
                             UNTIL WS-HOLD-PO-NBR NOT = PO002-H-PO-NBR  22950000
                                OR WS-NO-MORE-INPUT                     22960000
                           SET PS-ROLLBACK-ORDER                        22970000
                               WS-NO-ITEM-WRITTEN TO TRUE               22980000
                           MOVE ZERO TO WS-PO-LNE-NBR                   22990000
                                        WS-TPURITM-INSERTED             23000000
                                        WS-TMESTDS-INSERTED             23010000
                           PERFORM 17050-INITIALIZE-DC-QTY              23020000
                                                                        23030000
                       WHEN SQLCODE NOT = ZERO                          23040000
                            MOVE '11110-VALIDATE-DTS-STORE'             23050000
                                                   TO PV-PARAGRAPH-NAME 23060000
                            GO TO 99999-DB2-ABEND                       23070000
                   END-EVALUATE                                         23080000
           END-PERFORM.                                                 23090000
                                                                        23100000
           IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         23110000
               MOVE '11110-VALIDATE-DTS-STORE' TO PV-PARAGRAPH-NAME     23120000
               GO TO 99999-DB2-ABEND                                    23130000
           END-IF.                                                      23140000
                                                                        23150000
                                                                        23160000
       11150-PRINT-INVALID-STORE.                                       23170000
                                                                        23180000
           MOVE PO002-H-PO-NBR TO WS-BAD-PO.                            23190000
           MOVE XMT00001-LOC-NBR TO WS-BAD-STORE.                       23200000
           MOVE PV-ISA-CNTL-NBR  TO WS-ISA-CNTL-NBR.                    23210000
           PERFORM 96500-FORMAT-WS-BAD-VENDOR.                          23220000
                                                                        23230000
           IF PS-BAD-STORE-FOUND                                        23240000
               CONTINUE                                                 23250000
           ELSE                                                         23260000
               SET PS-BAD-STORE-FOUND TO TRUE                           23270000
               ACCEPT WS-TIME  FROM TIME                                23280000
               MOVE WS-TIME(1:2) TO ERR-RPT-H1-HH                       23290000
               MOVE WS-TIME(3:2) TO ERR-RPT-H1-MN                       23300000
               MOVE '-2'         TO ERR-RPT-H1-RPT-NBR                  23310000
               ADD 1 TO WS-ERR-RPT-PAGE                                 23320000
               MOVE WS-ERR-RPT-PAGE TO ERR-RPT-H1-PAGE                  23330000
               WRITE BAD-STORE-RECORD FROM ERR-RPT-HEADER-1             23340000
                     AFTER ADVANCING PAGE                               23350000
               WRITE BAD-STORE-RECORD FROM WS-BAD-STORE-RPT-TITLE       23360000
                     AFTER ADVANCING 1                                  23370000
           END-IF.                                                      23380000
                                                                        23390000
           WRITE BAD-STORE-RECORD FROM WS-BAD-STORE-RPT                 23400000
                 AFTER ADVANCING 2.                                     23410000
                                                                        23420000
       11200-FORMAT-TMESTDS.                                            23430000
                                                                        23440000
           IF WS-NOT-DTS-PO                                             23450000
               PERFORM WITH TEST AFTER                                  23460000
                       VARYING WS-DC-TBL-SUB FROM 1 BY 1                23470000
                       UNTIL   WS-DC-ID (WS-DC-TBL-SUB) = ZERO          23480000
                       OR WS-DC-ID (WS-DC-TBL-SUB) = PV-DC-NBR-9        23490000
                       IF WS-DC-ID (WS-DC-TBL-SUB) = PV-DC-NBR-9        23500000
                           ADD PO002-A-ALLOC-QTY (WS-STORE-SUB) TO      23510000
                                               WS-DC-QTY (WS-DC-TBL-SUB)23520000
                           MOVE WS-DC-TBL-SUB TO MESTDS-PLAN-NBR        23530000
                       END-IF                                           23540000
               END-PERFORM                                              23550000
           ELSE                                                         23560000
               MOVE +1 TO MESTDS-PLAN-NBR                               23570000
           END-IF.                                                      23580000
                                                                        23590000
           MOVE PURCHS-PO-NBR                  TO MESTDS-PO-NBR.        23600000
           MOVE WS-PO-LNE-NBR                  TO MESTDS-PO-LNE-NBR.    23610000
           MOVE XMT00001-LOC-NBR               TO MESTDS-STR-NBR.       23620000
           MOVE PO002-A-ALLOC-QTY (WS-STORE-SUB)                        23630000
                                               TO MESTDS-STR-DISTRO-QTY.23640000
      *CK  ADD  PO002-A-ALLOC-QTY (WS-STORE-SUB)                        23650000
      *CK                                      TO WS-TOT-ITEM-QTY.      23660000
                                                                        23670000
       11300-INSERT-TMESTDS.                                            23680000
                                                                        23690000
                                                                        23700000
           IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         23710000
               MOVE '11300-INSERT-TMESTDS' TO PV-PARAGRAPH-NAME         23720000
               GO TO 99999-DB2-ABEND                                    23730000
           END-IF.                                                      23740000
                                                                        23750000
           IF SQLCODE = ZERO                                            23760000
               ADD 1 TO WS-TMESTDS-INSERTED.                            23770000
                                                                        23780000
       11400-FORMAT-TALLPLN-DTS.                                        23790000
                                                                        23800000
           MOVE PURCHS-PO-NBR      TO ALLPLN-PO-NBR.                    23810000
           MOVE WS-PO-LNE-NBR      TO ALLPLN-PO-LNE-NBR.                23820000
           MOVE +1                 TO ALLPLN-PLAN-NBR.                  23830000
           MOVE PO002-A-ALLOC-QTY (WS-STORE-SUB)                        23840000
                                   TO ALLPLN-CURR-SPLIT-QTY.            23850000
           MOVE XMT00001-LOC-NBR TO WS-STORE-X.                         23860000
           MOVE WS-STORE-9         TO ALLPLN-DEST-NBR.                  23870000
           MOVE 'AC'               TO ALLPLN-STATUS-CDE.                23880000
           MOVE ZERO               TO ALLPLN-DC-SPLIT-QTY.              23890000
           MOVE WS-PROGRAM-ID      TO ALLPLN-SPLIT-CRE-ID               23900000
                                      ALLPLN-DISTRO-CRE-ID.             23910000
           MOVE WS-DEFAULT-DATE    TO ALLPLN-SPLIT-UPD-DATE.            23920000
                                                                        23930000
           IF PO002-A-ALLOC-QTY(WS-STORE-SUB) EQUAL ZERO                23940000
               CONTINUE                                                 23950000
           ELSE                                                         23960000
               INITIALIZE PO025-SHIPTO-DATA-RECORD                      23970000
               MOVE PC-SHIPTO-SEG TO PO025-SHIPTO-DATA-BOOKMARK         23980000
               MOVE XMT00001-LOC-NBR TO PO025-SHIPTO-LOCATION           23990000
               MOVE 'S' TO PO025-SHIPTO-LOC-TYPE                        24000000
               MOVE PO002-A-ALLOC-QTY(WS-STORE-SUB) TO                  24010000
                     PO025-SHIPTO-CURRENT-QTY                           24020000
               STRING PO025-SHIPTO-DATA-RECORD DELIMITED BY SIZE        24030000
               INTO PV-STRING-CLAUSE                                    24040000
               WITH POINTER PV-STRING-POINTER-WHERE                     24050000
           END-IF.                                                      24060000
                                                                        24070000
       11500-FORMAT-SKU-ERROR.                                          24080000
                                                                        24090000
           MOVE PO002-A-STORE-NBR (WS-STORE-SUB) TO                     24100000
                                                WS-STR-NBR (WS-STR-SUB).24110000
           MOVE PO002-A-ALLOC-QTY (WS-STORE-SUB) TO                     24120000
                                                WS-STR-QTY (WS-STR-SUB).24130000
           ADD 1 TO WS-STR-SUB.                                         24140000
                                                                        24150000
       12000-PROCESS-ITEM-DETAIL.                                       24160000
                                                                        24170000
           IF WS-SKU-NOT-FOUND                                          24180000
               PERFORM 97000-FORMAT-ERROR-STR-QTY                       24190000
           END-IF.                                                      24200000
                                                                        24210000
           IF WS-PO-LNE-NBR > ZERO                                      24220000
               IF WS-NOT-DTS-PO                                         24230000
                   PERFORM 17000-PROCESS-TALLPLN                        24240000
               END-IF                                                   24250000
           END-IF.                                                      24260000
                                                                        24270000
           INITIALIZE WS-STR-TABLE-API.                                 24280000
           MOVE 1 TO WS-STR-TBLE-SUB-API.                               24290000
W24803     INITIALIZE  XL001-ITEM-COMMAREA.                             24300000
W24803     IF  PO002-I-SKU > SPACES                                     24310000
W24803         AND PO002-I-SEQ NOT EQUAL '000'                          24320000
W24803         AND PO002-I-SEQ NOT EQUAL '999'                          24330000
W24803         PERFORM 12100-CALL-XLKUT-DOMAIN-PGM                      24340000
W24803     ELSE                                                         24350000
W24803         SET WS-SKU-NOT-FOUND TO TRUE                             24360000
W24803     END-IF.                                                      24370000
                                                                        24380000
           IF WS-SKU-FOUND                                              24390000
              IF WS-FIRST-ITEM                                          24400000
                                                                        24410000
                  PERFORM 15000-GET-VENDOR-DEFAULTS                     24420000
                                                                        24430000
                  MOVE SPACES TO PV-STRING-CLAUSE                       24440000
                  MOVE +1 TO PV-STRING-POINTER-WHERE                    24450000
                  INITIALIZE PO025-MESSAGE-HEADER-RECORD                24460000
                  MOVE 'PO_CREATE ' TO PO025-MESSAGE-HEADER-BOOKMARK    24470000
                  PERFORM 12500-FORMAT-API-HEADER                       24480000
                                                                        24490000
                  PERFORM 16000-CALCULATE-PO-TIMESTAMP                  24500000
                                                                        24510000
                  SET WS-NOT-FIRST-ITEM TO TRUE                         24520000
              END-IF                                                    24530000
                                                                        24540000
              PERFORM 12200-FORMAT-TPURITM                              24550000
                                                                        24560000
              IF PS-HOLD-ENTRY-IN-LEGACY                                24570000
                  PERFORM 12300-INSERT-TPURITM                          24580000
              END-IF                                                    24590000
                                                                        24600000
              IF PS-BELOW-MAX-ITEMS AND PS-ACTIVE-VENDOR                24610000
                 SET WS-ITEM-WRITTEN TO TRUE                            24620000
              ELSE                                                      24630000
                 SET WS-NO-ITEM-WRITTEN TO TRUE                         24640000
                 SET PS-BELOW-MAX-ITEMS TO TRUE                         24650000
              END-IF                                                    24660000
           ELSE                                                         24670000
               PERFORM 12400-FORMAT-SKU-ERROR                           24680000
                                                                        24690000
               PERFORM 98000-PRINT-ERROR-PAGE                           24700000
                                                                        24710000
               INITIALIZE WS-STR-TABLE                                  24720000
               MOVE 1 TO WS-STR-SUB                                     24730000
           END-IF.                                                      24740000
                                                                        24750000
W24803 12100-CALL-XLKUT-DOMAIN-PGM.                                     24760000
W24803     SET XL001-BY-NUMERIC-SKU                                     24770000
W24803         XL001-SELECT-SKU                                         24780000
W24803         XL001-SELECT-VND-STYL                                    24790000
W24803         XL001-SELECT-SKU-STR  TO TRUE.                           24800000
W24803                                                                  24810000
W24803     MOVE PO002-I-SKU          TO PV-SKU.                         24820000
W24803     MOVE PV-SKU               TO XL001-KEY-SKU.                  24830000
W24803                                                                  24840000
W24803     CALL XL001-VSM-PGM USING XL001-ITEM-COMMAREA.                24850000
W24803     EVALUATE TRUE                                                24860000
W24803          WHEN XL001-SUCCESSFUL                                   24870000
W24803               SET WS-SKU-FOUND TO TRUE                           24880000
W24803          WHEN XL001-SKU-NOT-FOUND                                24890000
W24803          WHEN XL001-VND-STYL-NOT-FOUND                           24900000
W24803          WHEN XL001-SKU-STR-NOT-FOUND                            24910000
W24803               SET WS-SKU-NOT-FOUND TO TRUE                       24920000
W24803          WHEN XL001-SQL-ERROR                                    24930000
W24803          WHEN XL001-INVALID-ACCESS                               24940000
W24803               MOVE '12100-CALL-XLKUT-DOMAIN-PGM'                 24950000
W24803                                        TO PV-PARAGRAPH-NAME      24960000
W24803               GO TO 99999-DB2-ABEND                              24970000
W24803     END-EVALUATE.                                                24980000
W24803*                                                                 24990000
                                                                        25000000
       12200-FORMAT-TPURITM.                                            25010000
                                                                        25020000
           MOVE PURCHS-PO-NBR         TO PURITM-PO-NBR.                 25030000
           MOVE +1                    TO PURITM-VER-NBR.                25040000
           ADD  1                     TO WS-PO-LNE-NBR.                 25050000
           MOVE WS-PO-LNE-NBR         TO PURITM-PO-LNE-NBR              25060000
                                         PURITM-APP-PO-LNE-NBR.         25070000
           MOVE 'A'                   TO PURITM-VER-STATUS-CDE.         25080000
W24803     MOVE PO002-I-SEQ           TO PURITM-SKU-SEQ-NBR.            25090000
W24803     MOVE XL001-SUB-CL-NBR-2CH  TO PURITM-CL-NBR.                 25100000
W24803     MOVE XL001-VS-NBR          TO PURITM-VEND-STYL-NAME.         25110000
W24803     MOVE XL001-CSTM-CLOR-DESC  TO PURITM-COLOR-DESC.             25120000
W24803     MOVE XL001-SIZE-DESC       TO PURITM-SIZE-DESC.              25130000
W24803     MOVE XL001-NRF-CLOR-CDE    TO PURITM-COLOR-CDE.              25140000
W24803     MOVE XL001-KOHLS-SIZE-CDE  TO PURITM-SIZE-CDE.               25150000
W24803     MOVE 'EA'                  TO PURITM-UM-IND.                 25160000
           MOVE PO002-I-TOTAL-QTY     TO PURITM-UNT-QTY.                25170000
           ADD  PO002-I-TOTAL-QTY     TO WS-TOT-UNT-QTY.                25180000
           IF PO002-I-SKU = '02640140' OR                               25190000
                            '02640141' OR                               25200000
                            '02640142'                                  25210000
      *        MOVE PO002-I-UNIT-PRICE TO PURITM-UNT-COST-AMT           25220000
      *        COMPUTE PURITM-TOT-VAL-COST-AMT ROUNDED =                25230000
      *            PO002-I-UNIT-PRICE * PO002-I-TOTAL-QTY               25240000
      *        IF PO002-I-SKU = '02640141'                              25250000
W24803         MOVE XL001-UNT-RTL-AMT     TO PURITM-UNT-RTL-PR-AMT      25260000
               MOVE 0 TO PURITM-TOT-VAL-COST-AMT                        25270000
                         PURITM-UNT-COST-AMT                            25280000
      *        ELSE                                                     25290000
      *            MULTIPLY PO002-I-UNIT-PRICE BY 2 GIVING              25300000
      *                     TSK-CUR-UNIT-RTL-AMT                        25310000
      *            MOVE TSK-CUR-UNIT-RTL-AMT  TO PURITM-UNT-RTL-PR-AMT  25320000
      *        END-IF                                                   25330000
           ELSE                                                         25340000
W24803         MOVE XL001-UNT-COST-AMT    TO PURITM-UNT-COST-AMT        25350000
               COMPUTE PURITM-TOT-VAL-COST-AMT ROUNDED =                25360000
W24803               XL001-UNT-COST-AMT * PO002-I-TOTAL-QTY             25370000
W24803         MOVE XL001-UNT-RTL-AMT     TO PURITM-UNT-RTL-PR-AMT      25380000
           END-IF.                                                      25390000
                                                                        25400000
W24803     IF XL001-GP-QTY > 1                                          25410000
              COMPUTE PURITM-TOT-VAL-RTL-AMT =                          25420000
W24803               (XL001-GP-AMT / XL001-GP-QTY) * PO002-I-TOTAL-QTY  25430000
           ELSE                                                         25440000
               COMPUTE PURITM-TOT-VAL-RTL-AMT ROUNDED =                 25450000
W24803                 XL001-UNT-RTL-AMT * PO002-I-TOTAL-QTY            25460000
           END-IF.                                                      25470000
                                                                        25480000
           ADD PURITM-TOT-VAL-COST-AMT TO WS-TOT-VAL-COST-AMT.          25490000
           ADD PURITM-TOT-VAL-RTL-AMT  TO WS-TOT-VAL-RTL-AMT.           25500000
                                                                        25510000
           IF PURITM-TOT-VAL-RTL-AMT = ZERO                             25520000
               MOVE ZERO TO PURITM-MU-PCT                               25530000
           ELSE                                                         25540000
               MOVE PURITM-TOT-VAL-COST-AMT TO WS-TOT-CALC-COST-AMT     25550000
               MOVE PURITM-TOT-VAL-RTL-AMT  TO WS-TOT-CALC-RTL-AMT      25560000
               COMPUTE PURITM-MU-PCT ROUNDED =                          25570000
                       ((WS-TOT-CALC-RTL-AMT -                          25580000
                         WS-TOT-CALC-COST-AMT) * 100) /                 25590000
                         WS-TOT-CALC-RTL-AMT                            25600000
           END-IF.                                                      25610000
                                                                        25620000
           MOVE WS-DB2-TIMESTAMP   TO PURITM-CRE-TMST.                  25630000
           MOVE WS-DEFAULT-TIMESTAMP  TO PURITM-LAST-UPD-TMST.          25640000
W24803     MOVE XL001-ITM-NBR      TO PURITM-ITM-NBR.                   25650000
W24803     MOVE XL001-SKU-DESC     TO PURITM-SKU-DESC.                  25660000
WR7746     MOVE 1                  TO PURITM-INNR-PK-QTY                25670000
WR7746                                PURITM-OUTR-PK-QTY.               25680000
           MOVE WS-DEFAULT-DATE    TO PURITM-AD-EVNT-DTE.               25690000
           MOVE 'AC'               TO PURITM-STATUS-CDE.                25700000
           MOVE WS-PROGRAM-ID      TO PURITM-CRE-BY-UID.                25710000
           MOVE SPACES             TO PURITM-LAST-UPD-BY-UID.           25720000
                                                                        25730000
W24803     IF XL001-GP-QTY > 1                                          25740000
W24803         MOVE XL001-GP-QTY   TO PURITM-GP-QTY                     25750000
W24803         MOVE XL001-GP-AMT   TO PURITM-GP-RTL-AMT                 25760000
           ELSE                                                         25770000
               MOVE ZERO           TO PURITM-GP-QTY                     25780000
                                      PURITM-GP-RTL-AMT                 25790000
           END-IF.                                                      25800000
                                                                        25810000
           ADD +1                  TO WS-TOT-SKUS-QTY.                  25820000
           MOVE 'N'                TO PURITM-PIC-ITM-IND.               25830000
           MOVE ZERO               TO PURITM-PIC-PG-NBR                 25840000
                                      PURITM-PRD-1ST-COST-AMT.          25850000
                                                                        25860000
           INITIALIZE PO025-SKU-DATA-RECORD.                            25870000
           MOVE 'SK' TO PO025-SKU-DATA-BOOKMARK.                        25880000
W24803     MOVE XL001-SKU-NBR TO PO025-SKU-SKU.                         25890000
           MOVE '0001-01-01' TO PO025-SKU-PRMO-START-DATE.              25900000
           MOVE PO002-I-TOTAL-QTY TO PO025-SKU-TOT-CURRENT-QTY.         25910000
WR7746     MOVE 1                 TO PO025-SKU-INNER-PK-QTY             25920000
WR7746                               PO025-SKU-OUTER-PK-QTY.            25930000
           STRING PO025-SKU-DATA-RECORD DELIMITED BY SIZE               25940000
           INTO PV-STRING-CLAUSE                                        25950000
           WITH POINTER PV-STRING-POINTER-WHERE.                        25960000
           ADD 1 TO PV-SKU-COUNT.                                       25970000
           IF PV-SKU-COUNT > PC-MAX-SKUS                                25980000
              PERFORM 96000-FORMAT-ERROR-INFO                           25990000
              MOVE PO002-H-PO-NBR TO WS-PO-NBR                          26000000
              MOVE WS-PO-NBR      TO ERR-RPT-D4-PO-NBR                  26010000
                                                                        26020000
              MOVE SPACES TO ERR-RPT-D5-UPC                             26030000
              MOVE ZEROES TO ERR-RPT-D5-SKU                             26040000
                                                                        26050000
              PERFORM 98000-PRINT-ERROR-PAGE                            26060000
                                                                        26070000
              MOVE WS-MAX-SKUS-MSG TO ERR-RPT-DETAIL-ERROR              26080000
              SET  PS-ABOVE-MAX-ITEMS TO TRUE                           26090000
              WRITE ERROR-RECORD   FROM ERR-RPT-DETAIL-ERROR            26100000
                    AFTER ADVANCING 3 LINES                             26110000
                                                                        26120000
              SET PS-ERROR-REPORT-CREATED TO TRUE                       26130000
              SET PO002-ITEM-RECORD TO TRUE                             26140000
              SET WS-ERROR-RECORD TO TRUE                               26150000
              PERFORM 20000-ROLLBACK-PURCHASE-ORDER                     26160000
              SET WS-NO-ITEM-WRITTEN TO TRUE                            26170000
              MOVE ZERO TO WS-PO-LNE-NBR                                26180000
                           WS-TPURITM-INSERTED                          26190000
                           WS-TMESTDS-INSERTED                          26200000
                                                                        26210000
              PERFORM 99997-READ-INPUT-FILE                             26220000
                      UNTIL WS-NO-MORE-INPUT OR                         26230000
                            PO002-HEADER-RECORD                         26240000
           END-IF.                                                      26250000
                                                                        26260000
       12300-INSERT-TPURITM.                                            26270000
                                                                        26280000
           IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         26290000
               MOVE '12300-INSERT-TPURITM' TO PV-PARAGRAPH-NAME         26300000
               GO TO 99999-DB2-ABEND                                    26310000
           END-IF.                                                      26320000
                                                                        26330000
           IF SQLCODE = ZERO                                            26340000
               ADD 1 TO WS-TPURITM-INSERTED                             26350000
           ELSE                                                         26360000
               IF SQLCODE = -803                                        26370000
                   MOVE PURITM-PO-NBR TO WS-D-PO-NBR                    26380000
                   DISPLAY ' '                                          26390000
                   DISPLAY 'ATTEMPTING TO INSERT PURCHASE ORDER/LINE '  26400000
                           WS-D-PO-NBR ' ' WS-PO-LNE-NBR                26410000
               END-IF                                                   26420000
           END-IF.                                                      26430000
                                                                        26440000
       12400-FORMAT-SKU-ERROR.                                          26450000
                                                                        26460000
           PERFORM 96000-FORMAT-ERROR-INFO.                             26470000
                                                                        26480000
           MOVE PO002-I-PO-NBR TO WS-PO-NBR.                            26490000
           MOVE WS-PO-NBR      TO ERR-RPT-D4-PO-NBR.                    26500000
                                                                        26510000
           STRING PO002-I-UPC(04:1) '-'                                 26520000
                  PO002-I-UPC(05:5) '-'                                 26530000
                  PO002-I-UPC(10:5) '-'                                 26540000
                  PO002-I-UPC(15:1)                                     26550000
                  DELIMITED BY SIZE                                     26560000
                  INTO ERR-RPT-D5-UPC.                                  26570000
                                                                        26580000
W24803        MOVE PO002-I-SKU         TO ERR-RPT-D5-SKU.               26590000
                                                                        26600000
       12500-FORMAT-API-HEADER.                                         26610000
      *XXX                                                              26620000
           MOVE ZERO TO PV-SKU-COUNT.                                   26630000
           MOVE ZERO TO PV-ALLOC-COUNT.                                 26640000
           INITIALIZE PO025-MESSAGE-HEADER-RECORD.                      26650000
           MOVE 'PO_CREATE' TO PO025-MESSAGE-HEADER-BOOKMARK.           26660000
           MOVE PO002-I-PO-NBR TO PO025-MHDR-REQ-ID.                    26670000
                                                                        26680000
           STRING PO025-MESSAGE-HEADER-RECORD DELIMITED BY SIZE         26690000
           INTO PV-STRING-CLAUSE                                        26700000
           WITH POINTER PV-STRING-POINTER-WHERE                         26710000
                                                                        26720000
           MOVE PO002-I-PO-NBR TO PO025-HDR-ORDER-NBR.                  26730000
           MOVE XL001-DEPT-NBR TO PO025-HDR-DEPT.                       26740000
           MOVE 'C' TO PO025-HDR-FUNCTION-CDE.                          26750000
           MOVE WS-PROGRAM-ID TO PO025-HDR-USER-ID.                     26760000
           MOVE 'VN' TO PO025-HDR-PO-TYPE.                              26770000
           IF WS-JOCKEY OR WS-VANITY-FAIR OR WS-LILY-OF-FRANCE OR       26780000
              WS-LIZ-CLAIBORNE                                          26790000
               MOVE 'Y'              TO PO025-HDR-EDI-PO-IND            26800000
           ELSE                                                         26810000
               MOVE 'N'              TO PO025-HDR-EDI-PO-IND            26820000
           END-IF.                                                      26830000
           MOVE WS-PROGRAM-ID TO PO025-HDR-APPROVAL-ID.                 26840000
           MOVE EXTENT-DUN-NBR TO PO025-HDR-SUPPLIER.                   26850000
           IF WS-NO-PKBYSTR                                             26860000
              MOVE 'N' TO PO025-HDR-PACK-BY-STORE-IND                   26870000
              MOVE 'B' TO PO025-HDR-PKGNG-CDE                           26880000
           ELSE                                                         26890000
              MOVE 'Y' TO PO025-HDR-PACK-BY-STORE-IND                   26900000
              MOVE SPACES TO PO025-HDR-PKGNG-CDE                        26910000
           END-IF.                                                      26920000
           IF PS-HNG-IND-FOUND                                          26930000
               MOVE 'Y' TO PO025-HDR-HNG-IND                            26940000
           ELSE                                                         26950000
               MOVE 'N' TO PO025-HDR-HNG-IND                            26960000
           END-IF.                                                      26970000
           IF WS-PRETICKET                                              26980000
               MOVE 'Y' TO PO025-HDR-PTKT-IND                           26990000
           ELSE                                                         27000000
               MOVE 'N' TO PO025-HDR-PTKT-IND                           27010000
           END-IF.                                                      27020000
           MOVE ZERO TO PO025-HDR-PTKT-IDTM-DAYS.                       27030000
           MOVE SPACES TO PO025-HDR-EDI-PROMO-TXT30.                    27040000
           MOVE PV-PROMO-CODE TO PO025-HDR-EDI-PROMO-TXT.               27050000
           IF WS-JOCKEY                                                 27060000
                 OR WS-VANITY-FAIR OR WS-LILY-OF-FRANCE                 27070000
                 OR WS-LIZ-CLAIBORNE                                    27080000
               MOVE 'Y' TO PO025-HDR-EDI-PO-IND                         27090000
           ELSE                                                         27100000
               MOVE 'N' TO PO025-HDR-EDI-PO-IND                         27110000
           END-IF.                                                      27120000
           MOVE WS-DTS-PO-SW TO PO025-HDR-DIRECT-TO-STR-IND.            27130000
           IF WS-HANES                                                  27140000
                 OR WS-JOCKEY                                           27150000
                 OR WS-VANITY-FAIR  OR WS-LILY-OF-FRANCE                27160000
                 OR WS-ESTEE-LAUDER                                     27170000
                 OR WS-LIZ-CLAIBORNE                                    27180000
                 OR WS-LEE-WRANGLER                                     27190000
                 OR WS-FISHMAN                                          27200000
                 OR WS-OLGA-WARNER                                      27210000
                 OR WS-PLAYTEX                                          27220000
                 OR WS-BALI                                             27230000
                 OR WS-WONDERBRA                                        27240000
                 OR WS-TOP-OF-THE-WORLD                                 27250000
                 OR WS-VF-IMAGEWEAR                                     27260000
                 OR WS-KNIGHTS-APPAREL                                  27270000
                 OR WS-NEXT-INC                                         27280000
352053           OR WS-47BRAND-LLC                                      27290000
                 OR WS-SUPREME-INTL                                     27300000
                 OR WS-COLLEGE-CONCEPTS                                 27310000
                 OR WS-RUSSELL-ATHLETIC                                 27320000
                 OR WS-OUTERSTUFF                                       27330000
                 OR WS-HADDAD                                           27340000
                 OR WS-HANES-UNDERWEAR                                  27350000
                 OR WS-COKEM                                            27360000
                 OR WS-GEAR-FOR-SPORTS                                  27370000
                 OR WS-COLOSSEUM                                        27380000
                 OR WS-SPORTS-LIC                                       27390000
                 OR WS-RENAISSANCE                                      27400000
WR9604           OR WS-LEVIS                                            27410000
WR0933           OR WS-TSHIRT-INT                                       27420000
W41905           OR WS-JACMEL-JWL                                       27430000
W41952           OR WS-GIII-LEATHER                                     27440000
W42092           OR WS-PVH-SUPERBA                                      27450000
534202           OR WS-J-AMERICA                                        27460000
453643           OR WS-ETRNL-FRTN                                       27470000
494672           OR WS-HGGR-CLTING                                      27480000
686121           OR WS-WILL-DICKIE                                      27490000
371617           OR WS-NEW-ERACAP                                       27500000
505256           OR WS-NEW-MAIDENFORM                                   27510000
683003           OR WS-RANDA-ACCESSORIES                                27520000
683026           OR WS-RANDA-CORP                                       27530000
944205           OR WS-BOELTER                                          27540000
002139           OR WS-GONZALS                                          27550000
647062           OR WS-LUXOTTICA                                        27560000
042023           OR WS-CC-PRODUCTS                                      27570000
018127           OR WS-TERVIS                                           27580000
356324           OR WS-PERRY                                            27590000
637834           OR WS-OURAY                                            27600000
185577           OR WS-BESPOKE                                          27610000
790723           OR WS-FGX                                              27620000
956632           OR WS-RANDA                                            27630000
956632           OR WS-LOGO                                             27640000
956632           OR WS-GREAT-AMERICAN                                   27650000
346771           OR WS-MAD-ENGINE                                       27660000
265129           OR WS-HYBRID-PROM                                      27670000
887802           OR WS-BIO-WORLD                                        27680000
927044           OR WS-NORTH-WEST                                       27690000
925845           OR WS-BARE-FEET                                        27700000
762449           OR WS-MASTER-PUZZLE                                    27710000
889751           OR WS-RIPPLE-JUNCTION                                  27720000
064017           OR WS-LICHTENBERG                                      27730000
176716           OR WS-SPIRIT-LEATHERWORKS                              27740000
176682           OR WS-TEE-SHIRT-CENTRAL                                27750000
680553           OR WS-LF-MENS-GROUP-LLC                                27751000
               MOVE WS-SHIP-DATE TO PO025-HDR-NOT-BEFORE-DATE           27760000
           ELSE                                                         27770000
               MOVE WS-CURR-DB2-DATE TO PO025-HDR-NOT-BEFORE-DATE       27780000
                                        WS-SHIP-DATE                    27790000
           END-IF.                                                      27800000
           PERFORM 18235-GET-CANCEL-DATE.                               27810000
           MOVE WS-CANCEL-DATE TO PO025-HDR-NOT-AFTER-DATE.             27820000
           MOVE 'N' TO PO025-HDR-NEW-STR-PO-IND.                        27830000
           MOVE 'N' TO PO025-HDR-PREPK-TO-PBS-IND.                      27840000
           MOVE WS-PARENT-ENT-ID TO PO025-HDR-PARENT-ENT-ID.            27850000
           MOVE WS-FACTORY-ENT-ID TO PO025-HDR-FACTORY-ENT-ID.          27860000
           MOVE SPACES TO PO025-HDR-DELIVERY-ID-X.                      27870000
           MOVE 'N' TO PO025-HDR-WHSE-RPLNT-IND.                        27880000
WR7746     MOVE 'F' TO PO025-HDR-DELIVERY-STRATEGY.                     27890000
           STRING PO025-HEADER-RECORD DELIMITED BY SIZE                 27900000
           INTO PV-STRING-CLAUSE                                        27910000
           WITH POINTER PV-STRING-POINTER-WHERE.                        27920000
                                                                        27930000
       13000-PROCESS-HEADER.                                            27940000
                                                                        27950000
           IF WS-SKU-NOT-FOUND                                          27960000
               PERFORM 97000-FORMAT-ERROR-STR-QTY                       27970000
                                                                        27980000
               SET WS-SKU-FOUND TO TRUE                                 27990000
           END-IF.                                                      28000000
                                                                        28010000
                                                                        28020000
           IF WS-FIRST-HEADER                                           28030000
               MOVE PO002-H-PO-NBR       TO PURCHS-PO-NBR               28040000
               MOVE PO002-H-INTERCHANGE  TO WS-CURR-INTERCHANGE         28050000
               MOVE ZERO TO VNDDPT-ENT-ID                               28060000
               IF PO002-H-LC-IND EQUAL LOW-VALUES                       28070000
                  MOVE SPACES TO PO002-H-LC-IND                         28080000
               END-IF                                                   28090000
               MOVE PO002-H-ISA-CNTL-NBR TO PV-ISA-CNTL-NBR             28100000
               MOVE PO002-H-LC-IND       TO PV-PROMO-CODE               28110000
               MOVE PO002-SHIP-DATE(1:2) TO WS-D-MM                     28120000
               MOVE PO002-SHIP-DATE(3:2) TO WS-D-DD                     28130000
               MOVE PO002-SHIP-DATE(5:2) TO WS-D-YY                     28140000
               IF WS-D-YY > '80'                                        28150000
                   MOVE '19'             TO WS-D-CC                     28160000
               ELSE                                                     28170000
                   MOVE '20'             TO WS-D-CC                     28180000
               END-IF                                                   28190000
               MOVE WS-DB2-DATE          TO WS-SHIP-DATE                28200000
               MOVE PO002-CANCEL-DATE(1:2) TO WS-D-MM                   28210000
               MOVE PO002-CANCEL-DATE(3:2) TO WS-D-DD                   28220000
               MOVE PO002-CANCEL-DATE(5:2) TO WS-D-YY                   28230000
               MOVE '20'                   TO WS-D-CC                   28240000
               MOVE WS-DB2-DATE            TO WS-CANCEL-DATE            28250000
               IF PO002-H-INTERCHANGE = '01067429365'                   28260000
                   SET WS-HANES TO TRUE                                 28270000
               ELSE                                                     28280000
                   SET WS-NOT-HANES TO TRUE                             28290000
               END-IF                                                   28300000
               IF PO002-H-INTERCHANGE = '010419368400'                  28310000
                   SET WS-JOCKEY TO TRUE                                28320000
               ELSE                                                     28330000
                   SET WS-NOT-JOCKEY TO TRUE                            28340000
               END-IF                                                   28350000
               IF PO002-H-INTERCHANGE = '086119230000'                  28360000
                   SET WS-HALLMARK TO TRUE                              28370000
               ELSE                                                     28380000
                   SET WS-NOT-HALLMARK TO TRUE                          28390000
               END-IF                                                   28400000
               IF PO002-H-INTERCHANGE = '124154571577'                  28410000
                   SET WS-MULBERRY TO TRUE                              28420000
               ELSE                                                     28430000
                   SET WS-NOT-MULBERRY TO TRUE                          28440000
               END-IF                                                   28450000
               IF PO002-H-INTERCHANGE = '01002344208'                   28460000
                   SET WS-VANITY-FAIR TO TRUE                           28470000
               ELSE                                                     28480000
                   SET WS-NOT-VANITY-FAIR TO TRUE                       28490000
               END-IF                                                   28500000
               IF PO002-H-INTERCHANGE = '01031360197'                   28510000
                   SET WS-LILY-OF-FRANCE TO TRUE                        28520000
               ELSE                                                     28530000
                   SET WS-NOT-LILY-OF-FRANCE TO TRUE                    28540000
               END-IF                                                   28550000
               IF PO002-H-INTERCHANGE = '01143367634'                   28560000
                   SET WS-ESTEE-LAUDER TO TRUE                          28570000
               ELSE                                                     28580000
                   SET WS-NOT-ESTEE-LAUDER TO TRUE                      28590000
               END-IF                                                   28600000
               IF PO002-H-INTERCHANGE = '086116630000' OR               28610000
                  PO002-H-INTERCHANGE = '086116630050'                  28620000
                   SET WS-LIZ-CLAIBORNE TO TRUE                         28630000
               ELSE                                                     28640000
                   SET WS-NOT-LIZ-CLAIBORNE TO TRUE                     28650000
               END-IF                                                   28660000
               IF PO002-H-INTERCHANGE = '01007131501'                   28670000
                   SET WS-LEE-WRANGLER TO TRUE                          28680000
               ELSE                                                     28690000
                   SET WS-NOT-LEE-WRANGLER TO TRUE                      28700000
               END-IF                                                   28710000
               IF PO002-H-INTERCHANGE = '012270726'                     28720000
                   SET WS-FISHMAN TO TRUE                               28730000
               ELSE                                                     28740000
                   SET WS-NOT-FISHMAN TO TRUE                           28750000
               END-IF                                                   28760000
CHGID          IF PO002-H-INTERCHANGE = '084229981500'                  28770000
CHGID *        IF PO002-H-INTERCHANGE = '122035798435' OR               28780000
CHGID *           PO002-H-INTERCHANGE = '128187827568'                  28790000
                   SET WS-OLGA-WARNER TO TRUE                           28800000
               ELSE                                                     28810000
                   SET WS-NOT-OLGA-WARNER TO TRUE                       28820000
               END-IF                                                   28830000
               IF PO002-H-INTERCHANGE = '1213026746000'                 28840000
                   SET WS-PLAYTEX TO TRUE                               28850000
               ELSE                                                     28860000
                   SET WS-NOT-PLAYTEX TO TRUE                           28870000
               END-IF                                                   28880000
               IF PO002-H-INTERCHANGE = '086111151100'                  28890000
                   SET WS-BALI TO TRUE                                  28900000
               ELSE                                                     28910000
                   SET WS-NOT-BALI TO TRUE                              28920000
               END-IF                                                   28930000
               IF PO002-H-INTERCHANGE = '129105196395'                  28940000
                   SET WS-WONDERBRA TO TRUE                             28950000
               ELSE                                                     28960000
                   SET WS-NOT-WONDERBRA TO TRUE                         28970000
               END-IF                                                   28980000
               IF PO002-H-INTERCHANGE = '124053609856'                  28990000
                   SET WS-TOP-OF-THE-WORLD TO TRUE                      29000000
               ELSE                                                     29010000
                   SET WS-NOT-TOP-OF-THE-WORLD TO TRUE                  29020000
               END-IF                                                   29030000
               IF PO002-H-INTERCHANGE = '086126930000'                  29040000
                   SET WS-VF-IMAGEWEAR TO TRUE                          29050000
               ELSE                                                     29060000
                   SET WS-NOT-VF-IMAGEWEAR TO TRUE                      29070000
               END-IF                                                   29080000
               IF PO002-H-INTERCHANGE = '128649689682'                  29090000
                   SET WS-KNIGHTS-APPAREL TO TRUE                       29100000
               ELSE                                                     29110000
                   SET WS-NOT-KNIGHTS-APPAREL TO TRUE                   29120000
               END-IF                                                   29130000
               IF PO002-H-INTERCHANGE = '122605632187'                  29140000
                   SET WS-NEXT-INC TO TRUE                              29150000
               ELSE                                                     29160000
                   SET WS-NOT-NEXT-INC TO TRUE                          29170000
               END-IF                                                   29180000
               IF PO002-H-INTERCHANGE = '086174371385'                  29190000
352053             SET WS-47BRAND-LLC    TO TRUE                        29200000
               ELSE                                                     29210000
352053             SET WS-NOT-47BRAND-LLC    TO TRUE                    29220000
               END-IF                                                   29230000
               IF PO002-H-INTERCHANGE = 'ZZPERRYGEGP'                   29240000
                   SET WS-SUPREME-INTL TO TRUE                          29250000
               ELSE                                                     29260000
                   SET WS-NOT-SUPREME-INTL TO TRUE                      29270000
               END-IF                                                   29280000
               IF PO002-H-INTERCHANGE = '01004637980'                   29290000
                   SET WS-COLLEGE-CONCEPTS TO TRUE                      29300000
               ELSE                                                     29310000
                   SET WS-NOT-COLLEGE-CONCEPTS TO TRUE                  29320000
               END-IF                                                   29330000
               IF PO002-H-INTERCHANGE = '086111770002'                  29340000
                   SET WS-RUSSELL-ATHLETIC TO TRUE                      29350000
               ELSE                                                     29360000
                   SET WS-NOT-RUSSELL-ATHLETIC TO TRUE                  29370000
               END-IF                                                   29380000
               IF PO002-H-INTERCHANGE = '01001334036'                   29390000
                   SET WS-OUTERSTUFF TO TRUE                            29400000
               ELSE                                                     29410000
                   SET WS-NOT-OUTERSTUFF TO TRUE                        29420000
               END-IF                                                   29430000
               IF PO002-H-INTERCHANGE = '14037794872C'                  29440000
                   SET WS-HADDAD TO TRUE                                29450000
               ELSE                                                     29460000
                   SET WS-NOT-HADDAD TO TRUE                            29470000
               END-IF                                                   29480000
               IF PO002-H-INTERCHANGE = '123365192222'                  29490000
                   SET WS-HANES-UNDERWEAR TO TRUE                       29500000
               ELSE                                                     29510000
                   SET WS-NOT-HANES-UNDERWEAR TO TRUE                   29520000
               END-IF                                                   29530000
               IF PO002-H-INTERCHANGE = '126129445069'                  29540000
                   SET WS-COKEM TO TRUE                                 29550000
               ELSE                                                     29560000
                   SET WS-NOT-COKEM TO TRUE                             29570000
               END-IF                                                   29580000
               IF PO002-H-INTERCHANGE = '129136933200' OR               29590000
575459            PO002-H-INTERCHANGE = '129136933996' OR               29600000
575459            PO002-H-INTERCHANGE = '129139423258'                  29610000
                   SET WS-GEAR-FOR-SPORTS TO TRUE                       29620000
               ELSE                                                     29630000
                   SET WS-NOT-GEAR-FOR-SPORTS TO TRUE                   29640000
               END-IF                                                   29650000
714055         IF PO002-H-INTERCHANGE = '01833753478' OR                29660000
714055            PO002-H-INTERCHANGE = '01833753478N'                  29670000
                   SET WS-COLOSSEUM TO TRUE                             29680000
               ELSE                                                     29690000
                   SET WS-NOT-COLOSSEUM TO TRUE                         29700000
               END-IF                                                   29710000
               IF PO002-H-INTERCHANGE = '01053736070'                   29720000
                   SET WS-SPORTS-LIC TO TRUE                            29730000
               ELSE                                                     29740000
                   SET WS-NOT-SPORTS-LIC TO TRUE                        29750000
               END-IF                                                   29760000
               IF PO002-H-INTERCHANGE = '127048211005'                  29770000
                   SET WS-RENAISSANCE TO TRUE                           29780000
               ELSE                                                     29790000
                   SET WS-NOT-RENAISSANCE TO TRUE                       29800000
               END-IF                                                   29810000
               IF PO002-H-INTERCHANGE = '086111190003'                  29820000
WR9604             SET WS-LEVIS TO TRUE                                 29830000
               ELSE                                                     29840000
WR9604             SET WS-NOT-LEVIS TO TRUE                             29850000
               END-IF                                                   29860000
WR0933         IF PO002-H-INTERCHANGE = '123045622401'                  29870000
WR0933             SET WS-TSHIRT-INT TO TRUE                            29880000
WR0933         ELSE                                                     29890000
WR0933             SET WS-NOT-TSHIRT-INT TO TRUE                        29900000
WR0933         END-IF                                                   29910000
W41905         IF PO002-H-INTERCHANGE = '127183494307'                  29920000
W41905             SET WS-JACMEL-JWL TO TRUE                            29930000
W41905         ELSE                                                     29940000
W41905             SET WS-NOT-JACMEL-JWL TO TRUE                        29950000
W41905         END-IF                                                   29960000
W41952         IF PO002-H-INTERCHANGE = '122124030661'                  29970000
W41952             SET WS-GIII-LEATHER TO TRUE                          29980000
W41952         ELSE                                                     29990000
W41952             SET WS-NOT-GIII-LEATHER TO TRUE                      30000000
W41952         END-IF                                                   30010000
W42092         IF PO002-H-INTERCHANGE = 'ZZSUPERBAINC'                  30020000
W42092             SET WS-PVH-SUPERBA TO TRUE                           30030000
W42092         ELSE                                                     30040000
W42092             SET WS-NOT-PVH-SUPERBA TO TRUE                       30050000
W42092         END-IF                                                   30060000
756744*        IF PO002-H-INTERCHANGE = '125175212525'                  30070000
756744         IF PO002-H-INTERCHANGE = '125176557948'                  30080000
534202             SET WS-J-AMERICA TO TRUE                             30090000
534202         ELSE                                                     30100000
534202             SET WS-NOT-J-AMERICA TO TRUE                         30110000
534202         END-IF                                                   30120000
453643         IF PO002-H-INTERCHANGE = '086594140000'                  30130000
453643             SET WS-ETRNL-FRTN TO TRUE                            30140000
453643         ELSE                                                     30150000
453643             SET WS-NOT-ETRNL-FRTN TO TRUE                        30160000
453643         END-IF                                                   30170000
494672         IF PO002-H-INTERCHANGE = '086111270000'                  30180000
494672             SET WS-HGGR-CLTING TO TRUE                           30190000
494672         ELSE                                                     30200000
494672             SET WS-NOT-HGGR-CLTING TO TRUE                       30210000
494672         END-IF                                                   30220000
686121         IF PO002-H-INTERCHANGE = '01008029498'                   30230000
686121             SET WS-WILL-DICKIE TO TRUE                           30240000
686121         ELSE                                                     30250000
686121             SET WS-NOT-WILL-DICKIE TO TRUE                       30260000
686121         END-IF                                                   30270000
371617         IF PO002-H-INTERCHANGE = '01056612773'                   30280000
371617             SET WS-NEW-ERACAP  TO TRUE                           30290000
371617         ELSE                                                     30300000
371617             SET WS-NOT-NEW-ERACAP  TO TRUE                       30310000
371617         END-IF                                                   30320000
505256         IF PO002-H-INTERCHANGE = '122014369009'                  30330000
505256             SET WS-NEW-MAIDENFORM TO TRUE                        30340000
505256         ELSE                                                     30350000
505256             SET WS-NOT-NEW-MAIDENFORM TO TRUE                    30360000
505256         END-IF                                                   30370000
683003         IF PO002-H-INTERCHANGE = '01089087787'                   30380000
683003             SET WS-RANDA-ACCESSORIES TO TRUE                     30390000
683003         ELSE                                                     30400000
683003             SET WS-NOT-RANDA-ACCESSORIES TO TRUE                 30410000
683003         END-IF                                                   30420000
683026         IF PO002-H-INTERCHANGE = '086117470000'                  30430000
683026             SET WS-RANDA-CORP  TO TRUE                           30440000
683026         ELSE                                                     30450000
683026             SET WS-NOT-RANDA-CORP  TO TRUE                       30460000
683026         END-IF                                                   30470000
944205         IF PO002-H-INTERCHANGE = '14006436299AS'                 30480000
944205             SET WS-BOELTER     TO TRUE                           30490000
944205         ELSE                                                     30500000
944205             SET WS-NOT-BOELTER     TO TRUE                       30510000
944205         END-IF                                                   30520000
002139         IF PO002-H-INTERCHANGE = '125303438725'                  30530000
002139             SET WS-GONZALS     TO TRUE                           30540000
002139         ELSE                                                     30550000
002139             SET WS-NOT-GONZALS     TO TRUE                       30560000
002139         END-IF                                                   30570000
647062         IF PO002-H-INTERCHANGE = '01012697983'                   30580000
647062             SET WS-LUXOTTICA   TO TRUE                           30590000
647062         ELSE                                                     30600000
647062             SET WS-NOT-LUXOTTICA   TO TRUE                       30610000
647062         END-IF                                                   30620000
042023         IF PO002-H-INTERCHANGE = '129139423259'                  30630000
042023             SET WS-CC-PRODUCTS TO TRUE                           30640000
042023         ELSE                                                     30650000
042023             SET WS-NOT-CC-PRODUCTS TO TRUE                       30660000
042023         END-IF                                                   30670000
018127         IF PO002-H-INTERCHANGE = '129419662114'                  30680000
018127             SET WS-TERVIS      TO TRUE                           30690000
018127         ELSE                                                     30700000
018127             SET WS-NOT-TERVIS      TO TRUE                       30710000
018127         END-IF                                                   30720000
356324         IF PO002-H-INTERCHANGE = '122122217500'                  30730000
356324             SET WS-PERRY       TO TRUE                           30740000
356324         ELSE                                                     30750000
356324             SET WS-NOT-PERRY       TO TRUE                       30760000
356324         END-IF                                                   30770000
637834         IF PO002-H-INTERCHANGE = 'ZZ30378999YK'                  30780000
637834             SET WS-OURAY       TO TRUE                           30790000
637834         ELSE                                                     30800000
637834             SET WS-NOT-OURAY       TO TRUE                       30810000
637834         END-IF                                                   30820000
185577         IF PO002-H-INTERCHANGE = '01034698614'                   30830000
185577             SET WS-BESPOKE     TO TRUE                           30840000
185577         ELSE                                                     30850000
185577             SET WS-NOT-BESPOKE     TO TRUE                       30860000
185577         END-IF                                                   30870000
790723         IF PO002-H-INTERCHANGE = 'ZZ062312087S2'                 30880000
790723             SET WS-FGX         TO TRUE                           30890000
790723         ELSE                                                     30900000
790723             SET WS-NOT-FGX         TO TRUE                       30910000
790723         END-IF                                                   30920000
956632         IF PO002-H-INTERCHANGE = '129738121700'                  30930000
956632             SET WS-RANDA       TO TRUE                           30940000
956632         ELSE                                                     30950000
956632             SET WS-NOT-RANDA       TO TRUE                       30960000
956632         END-IF                                                   30970000
956632         IF PO002-H-INTERCHANGE = '126152619218'                  30980000
956632             SET WS-LOGO        TO TRUE                           30990000
956632         ELSE                                                     31000000
956632             SET WS-NOT-LOGO        TO TRUE                       31010000
956632         END-IF                                                   31020000
956632         IF PO002-H-INTERCHANGE = '128306204400'                  31030000
956632             SET WS-GREAT-AMERICAN TO TRUE                        31040000
956632         ELSE                                                     31050000
956632             SET WS-NOT-GREAT-AMERICAN TO TRUE                    31060000
956632         END-IF                                                   31070000
346771         IF PO002-H-INTERCHANGE = '128585585273'                  31080000
346771             SET WS-MAD-ENGINE TO TRUE                            31090000
346771         ELSE                                                     31100000
346771             SET WS-NOT-MAD-ENGINE TO TRUE                        31110000
346771         END-IF                                                   31120000
265129         IF PO002-H-INTERCHANGE = '123109949975N'                 31130000
265129             SET WS-HYBRID-PROM TO TRUE                           31140000
265129         ELSE                                                     31150000
265129             SET WS-NOT-HYBRID-PROM TO TRUE                       31160000
265129         END-IF                                                   31170000
887802         IF PO002-H-INTERCHANGE = '14087607334'                   31180000
887802             SET WS-BIO-WORLD   TO TRUE                           31190000
887802         ELSE                                                     31200000
887802             SET WS-NOT-BIO-WORLD   TO TRUE                       31210000
887802         END-IF                                                   31220000
927044         IF PO002-H-INTERCHANGE = '125164846996'                  31230000
927044             SET WS-NORTH-WEST  TO TRUE                           31240000
927044         ELSE                                                     31250000
927044             SET WS-NOT-NORTH-WEST  TO TRUE                       31260000
927044         END-IF                                                   31270000
925845         IF PO002-H-INTERCHANGE = '127653497474'                  31280000
925845             SET WS-BARE-FEET   TO TRUE                           31290000
925845         ELSE                                                     31300000
925845             SET WS-NOT-BARE-FEET   TO TRUE                       31310000
925845         END-IF                                                   31320000
762449         IF PO002-H-INTERCHANGE = 'ZZ52074119YK'                  31330000
762449             SET WS-MASTER-PUZZLE TO TRUE                         31340000
762449         ELSE                                                     31350000
762449             SET WS-NOT-MASTER-PUZZLE TO TRUE                     31360000
762449         END-IF                                                   31370000
889751         IF PO002-H-INTERCHANGE = '01805838083'                   31380000
889751             SET WS-RIPPLE-JUNCTION TO TRUE                       31390000
889751         ELSE                                                     31400000
889751             SET WS-NOT-RIPPLE-JUNCTION TO TRUE                   31410000
889751         END-IF                                                   31420000
064017         IF PO002-H-INTERCHANGE = '086118910100'                  31430000
064017             SET WS-LICHTENBERG TO TRUE                           31440000
064017         ELSE                                                     31450000
064017             SET WS-NOT-LICHTENBERG TO TRUE                       31460000
064017         END-IF                                                   31470000
176716         IF PO002-H-INTERCHANGE = '122137472376'                  31480000
176716             SET WS-SPIRIT-LEATHERWORKS TO TRUE                   31490000
176716         ELSE                                                     31500000
176716             SET WS-NOT-SPIRIT-LEATHERWORKS TO TRUE               31510000
176716         END-IF                                                   31520000
176682         IF PO002-H-INTERCHANGE = '123056226763'                  31530000
176682             SET WS-TEE-SHIRT-CENTRAL TO TRUE                     31540000
176682         ELSE                                                     31550000
176682             SET WS-NOT-TEE-SHIRT-CENTRAL TO TRUE                 31560000
176682         END-IF                                                   31570000
680553         IF PO002-H-INTERCHANGE = '086116110015'                  31571000
680553             SET WS-LF-MENS-GROUP-LLC TO TRUE                     31572000
680553         ELSE                                                     31573000
680553             SET WS-NOT-LF-MENS-GROUP-LLC TO TRUE                 31574000
680553         END-IF                                                   31575000
               SET WS-NOT-FIRST-HEADER                                  31580000
                   WS-NO-ITEM-WRITTEN  TO TRUE                          31590000
               IF PO002-H-DTS                                           31600000
                   SET WS-DTS-PO TO TRUE                                31610000
                   MOVE 'Y' TO WS-BAD-DTS                               31620000
               ELSE                                                     31630000
                   SET WS-NOT-DTS-PO TO TRUE                            31640000
                   MOVE 'N' TO WS-BAD-DTS                               31650000
               END-IF                                                   31660000
               MOVE ZERO TO WS-PARENT-ENT-ID                            31670000
               MOVE ZERO TO WS-FACTORY-ENT-ID                           31680000
               MOVE PO002-H-PARENT-ENT-ID TO WS-PARENT-ENT-ID           31690000
               MOVE PO002-H-FACTORY-ENT-ID TO WS-FACTORY-ENT-ID         31700000
               MOVE SPACES TO PO025-HDR-DELIVERY-ID-X                   31710000
               MOVE 'N' TO PO025-HDR-WHSE-RPLNT-IND                     31720000
           ELSE                                                         31730000
               IF WS-ITEM-WRITTEN                                       31740000
                   IF WS-NOT-DTS-PO                                     31750000
                       PERFORM 17000-PROCESS-TALLPLN                    31760000
                   END-IF                                               31770000
                                                                        31780000
                   PERFORM 18000-PROCESS-HEADER                         31790000
                                                                        31800000
                   IF PS-BRIDGE-BACKOUT-MODE                            31810000
                       IF PS-SUSPEND-BRIDGE                             31820000
                           PERFORM 30900-CHECK-FOR-PO-S-ROW             31830000
                           IF PS-PO-HAS-S-ROW                           31840000
                               CONTINUE                                 31850000
                           ELSE                                         31860000
                               PERFORM 40000-CHECK-DEPT-ROLLOUT         31870000
                               IF PS-DEPT-ROLLOUT                       31880000
                                   PERFORM 30300-WRITE-MQ-ERROR         31890000
                               END-IF                                   31900000
                           END-IF                                       31910000
                       END-IF                                           31920000
                   ELSE                                                 31930000
                       PERFORM 30900-CHECK-FOR-PO-S-ROW                 31940000
                       IF PS-PO-HAS-S-ROW                               31950000
                           CONTINUE                                     31960000
                       ELSE                                             31970000
                           PERFORM 30000-MQ-MESSAGE-ROUTER              31980000
                       END-IF                                           31990000
                   END-IF                                               32000000
                                                                        32010000
                   IF PS-HOLD-ENTRY-IN-LEGACY                           32020000
                       PERFORM 19000-COMMIT-PURCHASE-ORDER              32030000
      *                PERFORM 17500-UPDATE-TPURITM-TSTVNDC             32040000
                   END-IF                                               32050000
               END-IF                                                   32060000
                                                                        32070000
               MOVE PO002-H-PO-NBR      TO PURCHS-PO-NBR                32080000
               MOVE PO002-H-INTERCHANGE TO WS-CURR-INTERCHANGE          32090000
               MOVE ZERO TO VNDDPT-ENT-ID                               32100000
               MOVE PO002-H-ISA-CNTL-NBR TO PV-ISA-CNTL-NBR             32110000
               MOVE PO002-H-LC-IND       TO PV-PROMO-CODE               32120000
               MOVE PO002-SHIP-DATE(1:2) TO WS-D-MM                     32130000
               MOVE PO002-SHIP-DATE(3:2) TO WS-D-DD                     32140000
               MOVE PO002-SHIP-DATE(5:2) TO WS-D-YY                     32150000
               IF WS-D-YY > '80'                                        32160000
                   MOVE '19'             TO WS-D-CC                     32170000
               ELSE                                                     32180000
                   MOVE '20'             TO WS-D-CC                     32190000
               END-IF                                                   32200000
               MOVE WS-DB2-DATE          TO WS-SHIP-DATE                32210000
                                                                        32220000
               MOVE PO002-CANCEL-DATE(1:2) TO WS-D-MM                   32230000
               MOVE PO002-CANCEL-DATE(3:2) TO WS-D-DD                   32240000
               MOVE PO002-CANCEL-DATE(5:2) TO WS-D-YY                   32250000
               MOVE '20'                   TO WS-D-CC                   32260000
               MOVE WS-DB2-DATE            TO WS-CANCEL-DATE            32270000
               MOVE PO002-H-PARENT-ENT-ID  TO WS-PARENT-ENT-ID          32280000
               MOVE PO002-H-FACTORY-ENT-ID TO WS-FACTORY-ENT-ID         32290000
               IF PO002-H-INTERCHANGE = '01067429365'                   32300000
                   SET WS-HANES TO TRUE                                 32310000
               ELSE                                                     32320000
                   SET WS-NOT-HANES TO TRUE                             32330000
               END-IF                                                   32340000
               IF PO002-H-INTERCHANGE = '010419368400'                  32350000
                   SET WS-JOCKEY TO TRUE                                32360000
               ELSE                                                     32370000
                   SET WS-NOT-JOCKEY TO TRUE                            32380000
               END-IF                                                   32390000
               IF PO002-H-INTERCHANGE = '086119230000'                  32400000
                   SET WS-HALLMARK TO TRUE                              32410000
               ELSE                                                     32420000
                   SET WS-NOT-HALLMARK TO TRUE                          32430000
               END-IF                                                   32440000
               IF PO002-H-INTERCHANGE = '124154571577'                  32450000
                   SET WS-MULBERRY TO TRUE                              32460000
               ELSE                                                     32470000
                   SET WS-NOT-MULBERRY TO TRUE                          32480000
               END-IF                                                   32490000
               IF PO002-H-INTERCHANGE = '01002344208'                   32500000
                   SET WS-VANITY-FAIR TO TRUE                           32510000
               ELSE                                                     32520000
                   SET WS-NOT-VANITY-FAIR TO TRUE                       32530000
               END-IF                                                   32540000
               IF PO002-H-INTERCHANGE = '01031360197'                   32550000
                   SET WS-LILY-OF-FRANCE TO TRUE                        32560000
               ELSE                                                     32570000
                   SET WS-NOT-LILY-OF-FRANCE TO TRUE                    32580000
               END-IF                                                   32590000
               IF PO002-H-INTERCHANGE = '01143367634'                   32600000
                   SET WS-ESTEE-LAUDER TO TRUE                          32610000
               ELSE                                                     32620000
                   SET WS-NOT-ESTEE-LAUDER TO TRUE                      32630000
               END-IF                                                   32640000
               IF PO002-H-INTERCHANGE = '086116630000' OR               32650000
                  PO002-H-INTERCHANGE = '086116630050'                  32660000
                   SET WS-LIZ-CLAIBORNE TO TRUE                         32670000
               ELSE                                                     32680000
                   SET WS-NOT-LIZ-CLAIBORNE TO TRUE                     32690000
               END-IF                                                   32700000
               IF PO002-H-INTERCHANGE = '01007131501'                   32710000
                   SET WS-LEE-WRANGLER TO TRUE                          32720000
               ELSE                                                     32730000
                   SET WS-NOT-LEE-WRANGLER TO TRUE                      32740000
               END-IF                                                   32750000
               IF PO002-H-INTERCHANGE = '012270726'                     32760000
                   SET WS-FISHMAN TO TRUE                               32770000
               ELSE                                                     32780000
                   SET WS-NOT-FISHMAN TO TRUE                           32790000
               END-IF                                                   32800000
CHGID          IF PO002-H-INTERCHANGE = '084229981500'                  32810000
CHGID *        IF PO002-H-INTERCHANGE = '122035798435' OR               32820000
CHGID *           PO002-H-INTERCHANGE = '128187827568'                  32830000
                   SET WS-OLGA-WARNER TO TRUE                           32840000
               ELSE                                                     32850000
                   SET WS-NOT-OLGA-WARNER TO TRUE                       32860000
               END-IF                                                   32870000
               IF PO002-H-INTERCHANGE = '1213026746000'                 32880000
                   SET WS-PLAYTEX TO TRUE                               32890000
               ELSE                                                     32900000
                   SET WS-NOT-PLAYTEX TO TRUE                           32910000
               END-IF                                                   32920000
               IF PO002-H-INTERCHANGE = '086111151100'                  32930000
                   SET WS-BALI TO TRUE                                  32940000
               ELSE                                                     32950000
                   SET WS-NOT-BALI TO TRUE                              32960000
               END-IF                                                   32970000
               IF PO002-H-INTERCHANGE = '129105196395'                  32980000
                   SET WS-WONDERBRA TO TRUE                             32990000
               ELSE                                                     33000000
                   SET WS-NOT-WONDERBRA TO TRUE                         33010000
               END-IF                                                   33020000
               IF PO002-H-INTERCHANGE = '124053609856'                  33030000
                   SET WS-TOP-OF-THE-WORLD TO TRUE                      33040000
               ELSE                                                     33050000
                   SET WS-NOT-TOP-OF-THE-WORLD TO TRUE                  33060000
               END-IF                                                   33070000
               IF PO002-H-INTERCHANGE = '086126930000'                  33080000
                   SET WS-VF-IMAGEWEAR TO TRUE                          33090000
               ELSE                                                     33100000
                   SET WS-NOT-VF-IMAGEWEAR TO TRUE                      33110000
               END-IF                                                   33120000
               IF PO002-H-INTERCHANGE = '128649689682'                  33130000
                   SET WS-KNIGHTS-APPAREL TO TRUE                       33140000
               ELSE                                                     33150000
                   SET WS-NOT-KNIGHTS-APPAREL TO TRUE                   33160000
               END-IF                                                   33170000
               IF PO002-H-INTERCHANGE = '122605632187'                  33180000
                   SET WS-NEXT-INC TO TRUE                              33190000
               ELSE                                                     33200000
                   SET WS-NOT-NEXT-INC TO TRUE                          33210000
               END-IF                                                   33220000
               IF PO002-H-INTERCHANGE = '086174371385'                  33230000
352053             SET WS-47BRAND-LLC    TO TRUE                        33240000
               ELSE                                                     33250000
352053             SET WS-NOT-47BRAND-LLC    TO TRUE                    33260000
               END-IF                                                   33270000
               IF PO002-H-INTERCHANGE = 'ZZPERRYGEGP'                   33280000
                   SET WS-SUPREME-INTL TO TRUE                          33290000
               ELSE                                                     33300000
                   SET WS-NOT-SUPREME-INTL TO TRUE                      33310000
               END-IF                                                   33320000
               IF PO002-H-INTERCHANGE = '01004637980'                   33330000
                   SET WS-COLLEGE-CONCEPTS TO TRUE                      33340000
               ELSE                                                     33350000
                   SET WS-NOT-COLLEGE-CONCEPTS TO TRUE                  33360000
               END-IF                                                   33370000
               IF PO002-H-INTERCHANGE = '086111770002'                  33380000
                   SET WS-RUSSELL-ATHLETIC TO TRUE                      33390000
               ELSE                                                     33400000
                   SET WS-NOT-RUSSELL-ATHLETIC TO TRUE                  33410000
               END-IF                                                   33420000
               IF PO002-H-INTERCHANGE = '01001334036'                   33430000
                   SET WS-OUTERSTUFF TO TRUE                            33440000
               ELSE                                                     33450000
                   SET WS-NOT-OUTERSTUFF TO TRUE                        33460000
               END-IF                                                   33470000
               IF PO002-H-INTERCHANGE = '14037794872C'                  33480000
                   SET WS-HADDAD TO TRUE                                33490000
               ELSE                                                     33500000
                   SET WS-NOT-HADDAD TO TRUE                            33510000
               END-IF                                                   33520000
               IF PO002-H-INTERCHANGE = '123365192222'                  33530000
                   SET WS-HANES-UNDERWEAR TO TRUE                       33540000
               ELSE                                                     33550000
                   SET WS-NOT-HANES-UNDERWEAR TO TRUE                   33560000
               END-IF                                                   33570000
               IF PO002-H-INTERCHANGE = '126129445069'                  33580000
                   SET WS-COKEM TO TRUE                                 33590000
               ELSE                                                     33600000
                   SET WS-NOT-COKEM TO TRUE                             33610000
               END-IF                                                   33620000
               IF PO002-H-INTERCHANGE = '129136933200' OR               33630000
575459            PO002-H-INTERCHANGE = '129136933996' OR               33640000
575459            PO002-H-INTERCHANGE = '129139423258'                  33650000
                   SET WS-GEAR-FOR-SPORTS TO TRUE                       33660000
               ELSE                                                     33670000
                   SET WS-NOT-GEAR-FOR-SPORTS TO TRUE                   33680000
               END-IF                                                   33690000
714055         IF PO002-H-INTERCHANGE = '01833753478' OR                33700000
714055            PO002-H-INTERCHANGE = '01833753478N'                  33710000
                   SET WS-COLOSSEUM TO TRUE                             33720000
               ELSE                                                     33730000
                   SET WS-NOT-COLOSSEUM TO TRUE                         33740000
               END-IF                                                   33750000
               IF PO002-H-INTERCHANGE = '01053736070'                   33760000
                   SET WS-SPORTS-LIC TO TRUE                            33770000
               ELSE                                                     33780000
                   SET WS-NOT-SPORTS-LIC TO TRUE                        33790000
               END-IF                                                   33800000
               IF PO002-H-INTERCHANGE = '127048211005'                  33810000
                   SET WS-RENAISSANCE TO TRUE                           33820000
               ELSE                                                     33830000
                   SET WS-NOT-RENAISSANCE TO TRUE                       33840000
               END-IF                                                   33850000
               IF PO002-H-INTERCHANGE = '086111190003'                  33860000
WR9604             SET WS-LEVIS TO TRUE                                 33870000
               ELSE                                                     33880000
WR9604             SET WS-NOT-LEVIS TO TRUE                             33890000
               END-IF                                                   33900000
WR0933         IF PO002-H-INTERCHANGE = '123045622401'                  33910000
WR0933             SET WS-TSHIRT-INT TO TRUE                            33920000
WR0933         ELSE                                                     33930000
WR0933             SET WS-NOT-TSHIRT-INT TO TRUE                        33940000
WR0933         END-IF                                                   33950000
W41905         IF PO002-H-INTERCHANGE = '127183494307'                  33960000
W41905             SET WS-JACMEL-JWL TO TRUE                            33970000
W41905         ELSE                                                     33980000
W41905             SET WS-NOT-JACMEL-JWL TO TRUE                        33990000
W41905         END-IF                                                   34000000
W41952         IF PO002-H-INTERCHANGE = '122124030661'                  34010000
W41952             SET WS-GIII-LEATHER TO TRUE                          34020000
W41952         ELSE                                                     34030000
W41952             SET WS-NOT-GIII-LEATHER TO TRUE                      34040000
W41952         END-IF                                                   34050000
W42092         IF PO002-H-INTERCHANGE = 'ZZSUPERBAINC'                  34060000
W42092             SET WS-PVH-SUPERBA TO TRUE                           34070000
W42092         ELSE                                                     34080000
W42092             SET WS-NOT-PVH-SUPERBA TO TRUE                       34090000
W42092         END-IF                                                   34100000
756744*        IF PO002-H-INTERCHANGE = '125175212525'                  34110000
756744         IF PO002-H-INTERCHANGE = '125176557948'                  34120000
534202             SET WS-J-AMERICA TO TRUE                             34130000
534202         ELSE                                                     34140000
534202             SET WS-NOT-J-AMERICA TO TRUE                         34150000
534202         END-IF                                                   34160000
453643         IF PO002-H-INTERCHANGE = '086594140000'                  34170000
453643             SET WS-ETRNL-FRTN TO TRUE                            34180000
453643         ELSE                                                     34190000
453643             SET WS-NOT-ETRNL-FRTN TO TRUE                        34200000
453643         END-IF                                                   34210000
494672         IF PO002-H-INTERCHANGE = '086111270000'                  34220000
494672             SET WS-HGGR-CLTING TO TRUE                           34230000
494672         ELSE                                                     34240000
494672             SET WS-NOT-HGGR-CLTING TO TRUE                       34250000
494672         END-IF                                                   34260000
686121         IF PO002-H-INTERCHANGE = '01008029498'                   34270000
686121             SET WS-WILL-DICKIE TO TRUE                           34280000
686121         ELSE                                                     34290000
686121             SET WS-NOT-WILL-DICKIE TO TRUE                       34300000
686121         END-IF                                                   34310000
371617         IF PO002-H-INTERCHANGE = '01056612773'                   34320000
371617             SET WS-NEW-ERACAP  TO TRUE                           34330000
371617         ELSE                                                     34340000
371617             SET WS-NOT-NEW-ERACAP  TO TRUE                       34350000
371617         END-IF                                                   34360000
505256         IF PO002-H-INTERCHANGE = '122014369009'                  34370000
505256             SET WS-NEW-MAIDENFORM TO TRUE                        34380000
505256         ELSE                                                     34390000
505256             SET WS-NOT-NEW-MAIDENFORM  TO TRUE                   34400000
505256         END-IF                                                   34410000
683003         IF PO002-H-INTERCHANGE = '01089087787'                   34420000
683003             SET WS-RANDA-ACCESSORIES TO TRUE                     34430000
683003         ELSE                                                     34440000
683003             SET WS-NOT-RANDA-ACCESSORIES TO TRUE                 34450000
683003         END-IF                                                   34460000
683026         IF PO002-H-INTERCHANGE = '086117470000'                  34470000
683026             SET WS-RANDA-CORP TO TRUE                            34480000
683026         ELSE                                                     34490000
683026             SET WS-NOT-RANDA-CORP TO TRUE                        34500000
683026         END-IF                                                   34510000
944205         IF PO002-H-INTERCHANGE = '14006436299AS'                 34520000
944205             SET WS-BOELTER    TO TRUE                            34530000
944205         ELSE                                                     34540000
944205             SET WS-NOT-BOELTER    TO TRUE                        34550000
944205         END-IF                                                   34560000
002139         IF PO002-H-INTERCHANGE = '125303438725'                  34570000
002139             SET WS-GONZALS    TO TRUE                            34580000
002139         ELSE                                                     34590000
002139             SET WS-NOT-GONZALS    TO TRUE                        34600000
002139         END-IF                                                   34610000
647062         IF PO002-H-INTERCHANGE = '01012697983'                   34620000
647062             SET WS-LUXOTTICA  TO TRUE                            34630000
647062         ELSE                                                     34640000
647062             SET WS-NOT-LUXOTTICA  TO TRUE                        34650000
647062         END-IF                                                   34660000
042023         IF PO002-H-INTERCHANGE = '129139423259'                  34670000
042023             SET WS-CC-PRODUCTS    TO TRUE                        34680000
042023         ELSE                                                     34690000
042023             SET WS-NOT-CC-PRODUCTS  TO TRUE                      34700000
042023         END-IF                                                   34710000
042023         IF PO002-H-INTERCHANGE = '129419662114'                  34720000
042023             SET WS-TERVIS         TO TRUE                        34730000
042023         ELSE                                                     34740000
042023             SET WS-NOT-TERVIS       TO TRUE                      34750000
042023         END-IF                                                   34760000
356324         IF PO002-H-INTERCHANGE = '122122217500'                  34770000
356324             SET WS-PERRY          TO TRUE                        34780000
356324         ELSE                                                     34790000
356324             SET WS-NOT-PERRY        TO TRUE                      34800000
356324         END-IF                                                   34810000
637834         IF PO002-H-INTERCHANGE = 'ZZ30378999YK'                  34820000
637834             SET WS-OURAY          TO TRUE                        34830000
637834         ELSE                                                     34840000
637834             SET WS-NOT-OURAY        TO TRUE                      34850000
637834         END-IF                                                   34860000
185577         IF PO002-H-INTERCHANGE = '01034698614'                   34870000
185577             SET WS-BESPOKE        TO TRUE                        34880000
185577         ELSE                                                     34890000
185577             SET WS-NOT-BESPOKE      TO TRUE                      34900000
185577         END-IF                                                   34910000
790723         IF PO002-H-INTERCHANGE = 'ZZ062312087S2'                 34920000
790723             SET WS-FGX            TO TRUE                        34930000
790723         ELSE                                                     34940000
790723             SET WS-NOT-FGX              TO TRUE                  34950000
790723         END-IF                                                   34960000
956632         IF PO002-H-INTERCHANGE = '129738121700'                  34970000
956632             SET WS-RANDA          TO TRUE                        34980000
956632         ELSE                                                     34990000
956632             SET WS-NOT-RANDA            TO TRUE                  35000000
956632         END-IF                                                   35010000
956632         IF PO002-H-INTERCHANGE = '126152619218'                  35020000
956632             SET WS-LOGO           TO TRUE                        35030000
956632         ELSE                                                     35040000
956632             SET WS-NOT-LOGO             TO TRUE                  35050000
956632         END-IF                                                   35060000
956632         IF PO002-H-INTERCHANGE = '128306204400'                  35070000
956632             SET WS-GREAT-AMERICAN TO TRUE                        35080000
956632         ELSE                                                     35090000
956632             SET WS-NOT-GREAT-AMERICAN   TO TRUE                  35100000
956632         END-IF                                                   35110000
346771         IF PO002-H-INTERCHANGE = '128585585273'                  35120000
346771             SET WS-MAD-ENGINE     TO TRUE                        35130000
346771         ELSE                                                     35140000
346771             SET WS-NOT-MAD-ENGINE       TO TRUE                  35150000
346771         END-IF                                                   35160000
265129         IF PO002-H-INTERCHANGE = '123109949975N'                 35170000
265129             SET WS-HYBRID-PROM    TO TRUE                        35180000
265129         ELSE                                                     35190000
265129             SET WS-NOT-HYBRID-PROM      TO TRUE                  35200000
265129         END-IF                                                   35210000
887802         IF PO002-H-INTERCHANGE = '14087607334'                   35220000
887802             SET WS-BIO-WORLD      TO TRUE                        35230000
887802         ELSE                                                     35240000
887802             SET WS-NOT-BIO-WORLD        TO TRUE                  35250000
887802         END-IF                                                   35260000
927044         IF PO002-H-INTERCHANGE = '125164846996'                  35270000
927044             SET WS-NORTH-WEST     TO TRUE                        35280000
927044         ELSE                                                     35290000
927044             SET WS-NOT-NORTH-WEST       TO TRUE                  35300000
927044         END-IF                                                   35310000
925845         IF PO002-H-INTERCHANGE = '127653497474'                  35320000
925845             SET WS-BARE-FEET      TO TRUE                        35330000
925845         ELSE                                                     35340000
925845             SET WS-NOT-BARE-FEET        TO TRUE                  35350000
925845         END-IF                                                   35360000
762449         IF PO002-H-INTERCHANGE = 'ZZ52074119YK'                  35370000
762449             SET WS-MASTER-PUZZLE TO TRUE                         35380000
762449         ELSE                                                     35390000
762449             SET WS-NOT-MASTER-PUZZLE TO TRUE                     35400000
762449         END-IF                                                   35410000
889751         IF PO002-H-INTERCHANGE = '01805838083'                   35420000
889751             SET WS-RIPPLE-JUNCTION TO TRUE                       35430000
889751         ELSE                                                     35440000
889751             SET WS-NOT-RIPPLE-JUNCTION TO TRUE                   35450000
889751         END-IF                                                   35460000
064017         IF PO002-H-INTERCHANGE = '086118910100'                  35470000
064017             SET WS-LICHTENBERG TO TRUE                           35480000
064017         ELSE                                                     35490000
064017             SET WS-NOT-LICHTENBERG TO TRUE                       35500000
064017         END-IF                                                   35510000
176716         IF PO002-H-INTERCHANGE = '122137472376'                  35520000
176716             SET WS-SPIRIT-LEATHERWORKS TO TRUE                   35530000
176716         ELSE                                                     35540000
176716             SET WS-NOT-SPIRIT-LEATHERWORKS TO TRUE               35550000
176716         END-IF                                                   35560000
176682         IF PO002-H-INTERCHANGE = '123056226763'                  35570000
176682             SET WS-TEE-SHIRT-CENTRAL TO TRUE                     35580000
176682         ELSE                                                     35590000
176682             SET WS-NOT-TEE-SHIRT-CENTRAL TO TRUE                 35600000
176682         END-IF                                                   35610000
680553         IF PO002-H-INTERCHANGE = '086116110015'                  35611000
680553             SET WS-LF-MENS-GROUP-LLC TO TRUE                     35612000
680553         ELSE                                                     35613000
680553             SET WS-NOT-LF-MENS-GROUP-LLC TO TRUE                 35614000
680553         END-IF                                                   35615000
               SET WS-NO-ITEM-WRITTEN   TO TRUE                         35620000
               IF PO002-H-DTS                                           35630000
                   SET WS-DTS-PO TO TRUE                                35640000
                   MOVE 'Y' TO WS-BAD-DTS                               35650000
               ELSE                                                     35660000
                   SET WS-NOT-DTS-PO TO TRUE                            35670000
                   MOVE 'N' TO WS-BAD-DTS                               35680000
               END-IF                                                   35690000
                                                                        35700000
               INITIALIZE PO025-MESSAGE-HEADER-RECORD                   35710000
               MOVE 'PO_CREATE '                                        35720000
                     TO PO025-MESSAGE-HEADER-BOOKMARK                   35730000
               INITIALIZE PO025-HEADER-RECORD                           35740000
               MOVE 'HE' TO PO025-HEADER-BOOKMARK                       35750000
                                                                        35760000
      *        PERFORM 15000-GET-VENDOR-DEFAULTS                        35770000
      *                                                                 35780000
      *        PERFORM 16000-CALCULATE-PO-TIMESTAMP                     35790000
           END-IF.                                                      35800000
                                                                        35810000
      *    THE ROLLOUT CHECK WAS MOVED FROM HERE TO PARA 10001- DUE TO  35820000
      *    AN ISSUE WITH PURCHASE ORDERS THAT ALREADY EXIST.  THE HOLD  35830000
      *    SWITCH IS SET HERE IN PLACE OF THE OLD ROLLOUT CHECK.        35840000
      *    PERFORM 13010-CHECK-RMS-ROLLOUT.                             35850000
           MOVE PO056-ENTRY-SYS-SW TO PS-HOLD-ENTRY-SYS-SW.             35860000
                                                                        35870000
       13010-CHECK-RMS-ROLLOUT.                                         35880000
           MOVE PO002-H-DEPT-NBR TO PO056-DEPT-NBR.                     35890000
           PERFORM PO056-CHECK-ROLLOUT-CONTROL.                         35900000
           EVALUATE TRUE                                                35910000
               WHEN PO056-ERRORS-FOUND                                  35920000
                   DISPLAY WS-PROGRAM-ID ' DEPARTMENT ' PO056-DEPT-NBR  35930000
                          ' HAD ERRORS IN ROLLOUT TABLE CHECKING'       35940000
                   DISPLAY 'ORDER WAS ' PO002-H-PO-NBR                  35950000
                   DISPLAY 'SQL CODE = ' PO056-SQLCODE                  35960000
                   DISPLAY 'TABLE NAME = ' PO056-DB2-TABLE-NAME         35970000
                   DISPLAY 'PARAGRAPH = ' PO056-PARAGRAPH               35980000
                   DISPLAY PO056-MESSAGE-TEXT                           35990000
                   SET WS-PO056-ERROR TO TRUE                           36000000
                   CALL 'ILBOABN0' USING WS-ABEND-CODE                  36010000
           END-EVALUATE.                                                36020000
                                                                        36030000
                                                                        36040000
       15000-GET-VENDOR-DEFAULTS.                                       36050000
                                                                        36060000
           PERFORM 15100-GET-ENT-ID.                                    36070000
                                                                        36080000
           PERFORM 15200-DEFAULT-SHIPMENT-INFO.                         36090000
                                                                        36100000
           PERFORM 15300-DEFAULT-PAYMENT-TERM.                          36110000
                                                                        36120000
           PERFORM 15500-DEFAULT-PRETICKET-IND.                         36130000
                                                                        36140000
           IF WS-DTS-PO                                                 36150000
               SET WS-NO-PKBYSTR TO TRUE                                36160000
           ELSE                                                         36170000
               IF WS-NOT-DTS-PO                                         36180000
                   PERFORM 15600-DEFAULT-PKBYSTR-IND                    36190000
               END-IF                                                   36200000
           END-IF.                                                      36210000
                                                                        36220000
           PERFORM 15700-DEFAULT-EDI-IND.                               36230000
                                                                        36240000
           PERFORM 15800-HANG-IND.                                      36250000
                                                                        36260000
                                                                        36270000
       15100-GET-ENT-ID.                                                36280000
                                                                        36290000
W24803     MOVE XL001-DEPT-NBR TO WS-DEPT-NBR.                          36300000
W24803     MOVE WS-DEPT-NBR    TO VNDDPT-DEPT-NBR.                      36310000
W24803     MOVE XL001-ENT-ID   TO VNDDPT-ENT-ID.                        36320000
           MOVE 'A'            TO EXTENT-STATUS-CDE.                    36330000
                                                                        36340000
           PERFORM WITH TEST AFTER                                      36350000
                   VARYING PV-RETRY-COUNTER FROM 1 BY 1                 36360000
                   UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR         36370000
                           SQLCODE = ZERO OR SQLCODE = +100             36380000
                                                                        36390000
                   EXEC SQL                                             36400000
                        SELECT A.ENT_ID                                 36410000
                              ,A.DEPT_NBR                               36420000
                              ,B.DUN_NBR                                36430000
                          INTO :VNDDPT-ENT-ID                           36440000
                              ,:VNDDPT-DEPT-NBR                         36450000
                              ,:EXTENT-DUN-NBR                          36460000
                          FROM TVNDDPT A                                36470000
                              ,TEXTENT B                                36480000
                         WHERE A.DEPT_NBR    = :VNDDPT-DEPT-NBR         36490000
W24803                     AND A.ENT_ID      = :VNDDPT-ENT-ID           36500000
                           AND B.STATUS_CDE  = :EXTENT-STATUS-CDE       36510000
                           AND A.ENT_ID      = B.ENT_ID                 36520000
P41269                   WITH UR                                        36530000
                   END-EXEC                                             36540000
                                                                        36550000
                   EVALUATE TRUE                                        36560000
                       WHEN SQLCODE = ZERO                              36570000
                       WHEN SQLCODE = -904                              36580000
                       WHEN SQLCODE = -913                              36590000
                            CONTINUE                                    36600000
                       WHEN SQLCODE = +100                              36610000
                            SET PS-INACTIVE-VENDOR TO TRUE              36620000
                            PERFORM 96000-FORMAT-ERROR-INFO             36630000
                                                                        36640000
                            MOVE PO002-H-PO-NBR TO WS-PO-NBR            36650000
                            MOVE WS-PO-NBR      TO ERR-RPT-D4-PO-NBR    36660000
                                                                        36670000
                            MOVE SPACES TO ERR-RPT-D5-UPC               36680000
W24803                      MOVE ZEROES TO ERR-RPT-D5-SKU               36690000
                                                                        36700000
                            PERFORM 98000-PRINT-ERROR-PAGE              36710000
                                                                        36720000
                            MOVE WS-INACTIVE-VENDOR TO                  36730000
                                 ERR-RPT-DETAIL-ERROR                   36740000
                            WRITE ERROR-RECORD  FROM                    36750000
                                  ERR-RPT-DETAIL-ERROR                  36760000
                                  AFTER ADVANCING 3 LINES               36770000
                            SET PS-ERROR-REPORT-CREATED TO TRUE         36780000
                            SET WS-ERROR-RECORD   TO TRUE               36790000
                            SET PS-ROLLBACK-ORDER                       36800000
                                WS-NO-ITEM-WRITTEN TO TRUE              36810000
                            PERFORM 99997-READ-INPUT-FILE               36820000
                              UNTIL WS-NO-MORE-INPUT OR                 36830000
                                    PO002-HEADER-RECORD                 36840000
                            SET PS-MULTIPLE-DEPTS TO TRUE               36850000
                            SET PS-VALID-SKUS     TO TRUE               36860000
                            PERFORM 10100-CHECK-DEPTS                   36870000
                               UNTIL PS-NOT-MULTIPLE-DEPTS AND          36880000
                                     PS-VALID-SKUS                      36890000
                       WHEN SQLCODE NOT = ZERO                          36900000
W24803                      MOVE VNDDPT-ENT-ID TO WS-D-ENT-ID           36910000
                            DISPLAY ' '                                 36920000
                            DISPLAY 'PO NUMBER  : ' PURCHS-PO-NBR       36930000
                            DISPLAY 'DEPARTMENT : ' WS-DEPT-NBR         36940000
W24803                      DISPLAY 'ENT ID     : ' WS-D-ENT-ID         36950000
                            MOVE '15100-GET-ENT-ID'                     36960000
                                                   TO PV-PARAGRAPH-NAME 36970000
                            GO TO 99999-DB2-ABEND                       36980000
                   END-EVALUATE                                         36990000
           END-PERFORM.                                                 37000000
                                                                        37010000
           IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         37020000
               MOVE '15100-GET-ENT-ID' TO PV-PARAGRAPH-NAME             37030000
               GO TO 99999-DB2-ABEND                                    37040000
           END-IF.                                                      37050000
                                                                        37060000
       15101-GET-REPORT-HEADER-INFO.                                    37070000
           PERFORM WITH TEST AFTER                                      37080000
                   VARYING PV-RETRY-COUNTER FROM 1 BY 1                 37090000
                   UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR         37100000
                           SQLCODE = ZERO OR SQLCODE = +100             37110000
                                                                        37120000
                   EXEC SQL                                             37130000
                      SELECT BYR_NBR,                                   37140000
                             WORKER_FIR_NAME,                           37150000
                             WORKER_LAST_NAME,                          37160000
                             ENT_NAME_DESC,                             37170000
                             DUN_NBR                                    37180000
                        INTO :MDSEAR-BYR-NBR                            37190000
                            ,:RSPBAR-WORKER-FIR-NAME                    37200000
                            ,:RSPBAR-WORKER-LAST-NAME                   37210000
                            ,:ENTNME-ENT-NAME-DESC                      37220000
                            ,:EXTENT-DUN-NBR                            37230000
                        FROM TENTNME E,                                 37240000
                             TMDSEAR M,                                 37250000
                             TRSPBAR R,                                 37260000
                             TEXTENT X                                  37270000
                       WHERE E.ENT_ID = :VNDDPT-ENT-ID                  37280000
                         AND E.TYPE_CDE = '01'                          37290000
                         AND E.ENT_ID = X.ENT_ID                        37300000
                         AND M.DEPT_NBR = :VNDDPT-DEPT-NBR              37310000
                         AND M.OPERCO_NBR = '03'                        37320000
                         AND R.OPERCO_NBR = '03'                        37330000
                         AND M.MDSELV_CDE = 'DPT'                       37340000
                         AND CURRENT DATE BETWEEN M.STRT_DTE AND        37350000
                                                  M.END_DTE             37360000
                         AND CURRENT DATE BETWEEN R.WORKER_STRT_DTE AND 37370000
                                                  R.WORKER_END_DTE      37380000
                         AND R.RSPLVL_CDE = 'BYR'                       37390000
                         AND M.MDSEAR_DKEY = R.MDSEAR_DKEY              37400000
P41269                 WITH UR                                          37410000
                   END-EXEC                                             37420000
                                                                        37430000
                   EVALUATE TRUE                                        37440000
                       WHEN SQLCODE = ZERO                              37450000
                          MOVE MDSEAR-BYR-NBR TO ERR-RPT-D1-BUYER-NBR   37460000
                          STRING RSPBAR-WORKER-FIR-NAME DELIMITED BY ' '37470000
                                 ' ' DELIMITED BY SIZE                  37480000
                                 RSPBAR-WORKER-LAST-NAME                37490000
                                     DELIMITED BY SIZE                  37500000
                                      INTO ERR-RPT-D1-BUYER-NAME        37510000
                          MOVE EXTENT-DUN-NBR TO  ERR-RPT-D2-VENDOR-NBR 37520000
                          MOVE ENTNME-ENT-NAME-DESC TO                  37530000
                               ERR-RPT-D2-VENDOR-NAME                   37540000
                       WHEN SQLCODE = -904                              37550000
                       WHEN SQLCODE = -913                              37560000
                            MOVE 'NOT FOUND' TO ERR-RPT-D2-VENDOR-NAME  37570000
                                                ERR-RPT-D1-BUYER-NAME   37580000
                       WHEN SQLCODE = +100                              37590000
                       WHEN SQLCODE NOT = ZERO                          37600000
W24803                      MOVE VNDDPT-ENT-ID TO WS-D-ENT-ID           37610000
                            DISPLAY ' '                                 37620000
                            DISPLAY 'PO NUMBER  : ' PURCHS-PO-NBR       37630000
                            DISPLAY 'DEPARTMENT : ' WS-DEPT-NBR         37640000
W24803                      DISPLAY 'ENT ID     : ' WS-D-ENT-ID         37650000
                            MOVE '15100-GET-ENT-ID'                     37660000
                                                   TO PV-PARAGRAPH-NAME 37670000
                            GO TO 99999-DB2-ABEND                       37680000
                   END-EVALUATE                                         37690000
           END-PERFORM.                                                 37700000
                                                                        37710000
           IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         37720000
               MOVE '15100-GET-ENT-ID' TO PV-PARAGRAPH-NAME             37730000
               GO TO 99999-DB2-ABEND                                    37740000
           END-IF.                                                      37750000
                                                                        37760000
       15200-DEFAULT-SHIPMENT-INFO.                                     37770000
                                                                        37780000
           MOVE VNDDPT-ENT-ID   TO VNDAGR-ENT-ID.                       37790000
           MOVE VNDDPT-DEPT-NBR TO VNDAGR-DEPT-NBR.                     37800000
           MOVE '1'             TO VNDAGR-AGRMT-TYP-ID.                 37810000
                                                                        37820000
           PERFORM WITH TEST AFTER                                      37830000
                   VARYING PV-RETRY-COUNTER FROM 1 BY 1                 37840000
                   UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR         37850000
                           SQLCODE = ZERO OR                            37860000
                           SQLCODE = +100                               37870000
                                                                        37880000
                   EXEC SQL                                             37890000
                        SELECT FOB_POINT_TXT                            37900000
                              ,SHIPT_POINT_TXT                          37910000
                              ,FRGT_TERM_ID                             37920000
                          INTO :VNDAGR-FOB-POINT-TXT                    37930000
                              ,:VNDAGR-SHIPT-POINT-TXT                  37940000
                              ,:VNDAGR-FRGT-TERM-ID                     37950000
                          FROM TVNDAGR                                  37960000
                         WHERE ENT_ID          = :VNDAGR-ENT-ID         37970000
                           AND DEPT_NBR        = :VNDAGR-DEPT-NBR       37980000
                           AND AGRMT_TYP_ID    = :VNDAGR-AGRMT-TYP-ID   37990000
                           AND EFFECTIVE_DATE  <= CURRENT DATE          38000000
                           AND EXPIRATION_DATE >  CURRENT DATE          38010000
                           AND SEQ_NBR         =                        38020000
                       (SELECT MAX(SEQ_NBR)                             38030000
                          FROM TVNDAGR                                  38040000
                         WHERE ENT_ID          = :VNDAGR-ENT-ID         38050000
                           AND DEPT_NBR        = :VNDAGR-DEPT-NBR       38060000
                           AND AGRMT_TYP_ID    = :VNDAGR-AGRMT-TYP-ID)  38070000
P41269                  WITH UR                                         38080000
                   END-EXEC                                             38090000
                                                                        38100000
                   EVALUATE TRUE                                        38110000
                       WHEN SQLCODE = ZERO                              38120000
                       WHEN SQLCODE = +100                              38130000
                       WHEN SQLCODE = -904                              38140000
                       WHEN SQLCODE = -913                              38150000
                            CONTINUE                                    38160000
                                                                        38170000
                       WHEN SQLCODE NOT = ZERO                          38180000
                            MOVE '15200-DEFAULT-SHIPMENT-INFO'          38190000
                                                   TO PV-PARAGRAPH-NAME 38200000
                            GO TO 99999-DB2-ABEND                       38210000
                   END-EVALUATE                                         38220000
           END-PERFORM.                                                 38230000
                                                                        38240000
           IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         38250000
               MOVE '15200-DEFAULT-SHIPMENT-INFO' TO PV-PARAGRAPH-NAME  38260000
               GO TO 99999-DB2-ABEND                                    38270000
           END-IF.                                                      38280000
                                                                        38290000
           IF SQLCODE = +100                                            38300000
               MOVE ZEROES TO FRGTRM-VND-FRGT-PCT                       38310000
                              FRGTRM-KOHLS-FRGT-PCT                     38320000
               MOVE SPACES TO VNDAGR-FOB-POINT-TXT                      38330000
                              VNDAGR-SHIPT-POINT-TXT                    38340000
           ELSE                                                         38350000
               PERFORM 15250-GET-PCTS-FROM-TFRGTRM                      38360000
           END-IF.                                                      38370000
                                                                        38380000
       15250-GET-PCTS-FROM-TFRGTRM.                                     38390000
                                                                        38400000
           MOVE VNDAGR-FRGT-TERM-ID TO FRGTRM-FRGT-TERM-ID.             38410000
                                                                        38420000
           PERFORM WITH TEST AFTER                                      38430000
                   VARYING PV-RETRY-COUNTER FROM 1 BY 1                 38440000
                   UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR         38450000
                           SQLCODE = ZERO OR                            38460000
                           SQLCODE = +100                               38470000
                                                                        38480000
                   EXEC SQL                                             38490000
                        SELECT KOHLS_FRGT_PCT                           38500000
                              ,VND_FRGT_PCT                             38510000
                          INTO :FRGTRM-KOHLS-FRGT-PCT                   38520000
                              ,:FRGTRM-VND-FRGT-PCT                     38530000
                          FROM TFRGTRM                                  38540000
                         WHERE FRGT_TERM_ID    = :FRGTRM-FRGT-TERM-ID   38550000
P41269                  WITH UR                                         38560000
                   END-EXEC                                             38570000
                                                                        38580000
                   EVALUATE TRUE                                        38590000
                       WHEN SQLCODE = ZERO                              38600000
                       WHEN SQLCODE = +100                              38610000
                       WHEN SQLCODE = -904                              38620000
                       WHEN SQLCODE = -913                              38630000
                            CONTINUE                                    38640000
                                                                        38650000
                       WHEN SQLCODE NOT = ZERO                          38660000
                            MOVE '15250-GET-PCTS-FROM-TFRGTRM'          38670000
                                                   TO PV-PARAGRAPH-NAME 38680000
                            GO TO 99999-DB2-ABEND                       38690000
                   END-EVALUATE                                         38700000
           END-PERFORM.                                                 38710000
                                                                        38720000
           IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         38730000
               MOVE '15250-GET-PCTS-FROM-TFRGTRM' TO PV-PARAGRAPH-NAME  38740000
               GO TO 99999-DB2-ABEND                                    38750000
           END-IF.                                                      38760000
                                                                        38770000
           IF SQLCODE = +100                                            38780000
               MOVE ZEROES TO FRGTRM-KOHLS-FRGT-PCT                     38790000
                              FRGTRM-VND-FRGT-PCT                       38800000
           END-IF.                                                      38810000
                                                                        38820000
       15300-DEFAULT-PAYMENT-TERM.                                      38830000
                                                                        38840000
           MOVE '2' TO VNDAGR-AGRMT-TYP-ID.                             38850000
                                                                        38860000
           PERFORM WITH TEST AFTER                                      38870000
                   VARYING PV-RETRY-COUNTER FROM 1 BY 1                 38880000
                   UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR         38890000
                           SQLCODE = ZERO OR                            38900000
                           SQLCODE = +100                               38910000
                                                                        38920000
                   EXEC SQL                                             38930000
                        SELECT PAYT_TERM_ID                             38940000
                          INTO :VNDAGR-PAYT-TERM-ID                     38950000
                          FROM TVNDAGR                                  38960000
                         WHERE ENT_ID          = :VNDAGR-ENT-ID         38970000
                           AND DEPT_NBR        = :VNDAGR-DEPT-NBR       38980000
                           AND AGRMT_TYP_ID    = :VNDAGR-AGRMT-TYP-ID   38990000
                           AND EFFECTIVE_DATE  <= CURRENT DATE          39000000
                           AND EXPIRATION_DATE >  CURRENT DATE          39010000
                           AND SEQ_NBR         =                        39020000
                       (SELECT MAX(SEQ_NBR)                             39030000
                          FROM TVNDAGR                                  39040000
                         WHERE ENT_ID          = :VNDAGR-ENT-ID         39050000
                           AND DEPT_NBR        = :VNDAGR-DEPT-NBR       39060000
                           AND AGRMT_TYP_ID    = :VNDAGR-AGRMT-TYP-ID)  39070000
P41269                   WITH UR                                        39080000
                   END-EXEC                                             39090000
                                                                        39100000
                   EVALUATE TRUE                                        39110000
                       WHEN SQLCODE = ZERO                              39120000
                       WHEN SQLCODE = +100                              39130000
                       WHEN SQLCODE = -904                              39140000
                       WHEN SQLCODE = -913                              39150000
                            CONTINUE                                    39160000
                                                                        39170000
                       WHEN SQLCODE NOT = ZERO                          39180000
                            MOVE '15300-DEFAULT-PAYMENT-TERM'           39190000
                                                   TO PV-PARAGRAPH-NAME 39200000
                            GO TO 99999-DB2-ABEND                       39210000
                   END-EVALUATE                                         39220000
           END-PERFORM.                                                 39230000
                                                                        39240000
           IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         39250000
               MOVE '15300-DEFAULT-PAYMENT-TERM' TO PV-PARAGRAPH-NAME   39260000
               GO TO 99999-DB2-ABEND                                    39270000
           END-IF.                                                      39280000
                                                                        39290000
           IF SQLCODE = +100                                            39300000
               MOVE +1 TO VNDAGR-PAYT-TERM-ID.                          39310000
                                                                        39320000
       15500-DEFAULT-PRETICKET-IND.                                     39330000
                                                                        39340000
           SET WS-NO-PRETICKET TO TRUE.                                 39350000
           MOVE '4' TO VNDAGR-AGRMT-TYP-ID.                             39360000
           MOVE +1  TO VNDAGR-TYP-CDE.                                  39370000
                                                                        39380000
           PERFORM WITH TEST AFTER                                      39390000
                   VARYING PV-RETRY-COUNTER FROM 1 BY 1                 39400000
                   UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR         39410000
                           SQLCODE = ZERO                               39420000
                                                                        39430000
                   EXEC SQL                                             39440000
                        SELECT COUNT(*)                                 39450000
                          INTO :WS-DB2-COUNT                            39460000
                          FROM TVNDAGR                                  39470000
                         WHERE ENT_ID          = :VNDAGR-ENT-ID         39480000
                           AND DEPT_NBR        = :VNDAGR-DEPT-NBR       39490000
                           AND AGRMT_TYP_ID    = :VNDAGR-AGRMT-TYP-ID   39500000
                           AND TYP_CDE         = :VNDAGR-TYP-CDE        39510000
                           AND EFFECTIVE_DATE  <= CURRENT DATE          39520000
                           AND EXPIRATION_DATE >  CURRENT DATE          39530000
                           AND SEQ_NBR         =                        39540000
                       (SELECT MAX(SEQ_NBR)                             39550000
                          FROM TVNDAGR                                  39560000
                         WHERE ENT_ID          = :VNDAGR-ENT-ID         39570000
                           AND DEPT_NBR        = :VNDAGR-DEPT-NBR       39580000
                           AND AGRMT_TYP_ID    = :VNDAGR-AGRMT-TYP-ID   39590000
                           AND TYP_CDE         = :VNDAGR-TYP-CDE)       39600000
P41269                   WITH UR                                        39610000
                   END-EXEC                                             39620000
                                                                        39630000
                   EVALUATE TRUE                                        39640000
                       WHEN SQLCODE = ZERO                              39650000
                       WHEN SQLCODE = -904                              39660000
                       WHEN SQLCODE = -913                              39670000
                            CONTINUE                                    39680000
                                                                        39690000
                       WHEN SQLCODE NOT = ZERO                          39700000
                            MOVE '15500-DEFAULT-PRETICKET-IND'          39710000
                                                   TO PV-PARAGRAPH-NAME 39720000
                            GO TO 99999-DB2-ABEND                       39730000
                   END-EVALUATE                                         39740000
           END-PERFORM.                                                 39750000
                                                                        39760000
           IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         39770000
               MOVE '15500-DEFAULT-PRETICKET-IND' TO PV-PARAGRAPH-NAME  39780000
               GO TO 99999-DB2-ABEND                                    39790000
           END-IF.                                                      39800000
                                                                        39810000
           IF SQLCODE = ZERO                                            39820000
              IF WS-DB2-COUNT > ZERO                                    39830000
                  SET WS-PRETICKET TO TRUE.                             39840000
                                                                        39850000
       15600-DEFAULT-PKBYSTR-IND.                                       39860000
                                                                        39870000
           SET WS-NO-PKBYSTR TO TRUE.                                   39880000
           MOVE '4' TO VNDAGR-AGRMT-TYP-ID.                             39890000
           MOVE +4  TO VNDAGR-TYP-CDE.                                  39900000
                                                                        39910000
           PERFORM WITH TEST AFTER                                      39920000
                   VARYING PV-RETRY-COUNTER FROM 1 BY 1                 39930000
                   UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR         39940000
                           SQLCODE = ZERO                               39950000
                                                                        39960000
                   EXEC SQL                                             39970000
                        SELECT COUNT(*)                                 39980000
                          INTO :WS-DB2-COUNT                            39990000
                          FROM TVNDAGR                                  40000000
                         WHERE ENT_ID          = :VNDAGR-ENT-ID         40010000
                           AND DEPT_NBR        = :VNDAGR-DEPT-NBR       40020000
                           AND AGRMT_TYP_ID    = :VNDAGR-AGRMT-TYP-ID   40030000
                           AND TYP_CDE         = :VNDAGR-TYP-CDE        40040000
                           AND EFFECTIVE_DATE  <= CURRENT DATE          40050000
                           AND EXPIRATION_DATE >  CURRENT DATE          40060000
                           AND SEQ_NBR         =                        40070000
                       (SELECT MAX(SEQ_NBR)                             40080000
                          FROM TVNDAGR                                  40090000
                         WHERE ENT_ID          = :VNDAGR-ENT-ID         40100000
                           AND DEPT_NBR        = :VNDAGR-DEPT-NBR       40110000
                           AND AGRMT_TYP_ID    = :VNDAGR-AGRMT-TYP-ID   40120000
                           AND TYP_CDE         = :VNDAGR-TYP-CDE)       40130000
P41269                   WITH UR                                        40140000
                   END-EXEC                                             40150000
                                                                        40160000
                   EVALUATE TRUE                                        40170000
                       WHEN SQLCODE = ZERO                              40180000
                       WHEN SQLCODE = -904                              40190000
                       WHEN SQLCODE = -913                              40200000
                            CONTINUE                                    40210000
                                                                        40220000
                       WHEN SQLCODE NOT = ZERO                          40230000
                            MOVE '15600-DEFAULT-PKBYSTR-IND'            40240000
                                                   TO PV-PARAGRAPH-NAME 40250000
                            GO TO 99999-DB2-ABEND                       40260000
                   END-EVALUATE                                         40270000
           END-PERFORM.                                                 40280000
                                                                        40290000
           IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         40300000
               MOVE '15600-DEFAULT-PKBYSTR-IND' TO PV-PARAGRAPH-NAME    40310000
               GO TO 99999-DB2-ABEND                                    40320000
           END-IF.                                                      40330000
                                                                        40340000
           IF SQLCODE = ZERO                                            40350000
              IF WS-DB2-COUNT > ZERO                                    40360000
                  SET WS-PKBYSTR TO TRUE.                               40370000
                                                                        40380000
       15700-DEFAULT-EDI-IND.                                           40390000
                                                                        40400000
           SET WS-NO-EDI TO TRUE.                                       40410000
           MOVE '4' TO VNDAGR-AGRMT-TYP-ID.                             40420000
           MOVE +5  TO VNDAGR-TYP-CDE.                                  40430000
                                                                        40440000
           PERFORM WITH TEST AFTER                                      40450000
                   VARYING PV-RETRY-COUNTER FROM 1 BY 1                 40460000
                   UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR         40470000
                           SQLCODE = ZERO                               40480000
                                                                        40490000
                   EXEC SQL                                             40500000
                        SELECT COUNT(*)                                 40510000
                          INTO :WS-DB2-COUNT                            40520000
                          FROM TVNDAGR                                  40530000
                         WHERE ENT_ID          = :VNDAGR-ENT-ID         40540000
                           AND DEPT_NBR        = :VNDAGR-DEPT-NBR       40550000
                           AND AGRMT_TYP_ID    = :VNDAGR-AGRMT-TYP-ID   40560000
                           AND TYP_CDE         = :VNDAGR-TYP-CDE        40570000
                           AND EFFECTIVE_DATE  <= CURRENT DATE          40580000
                           AND EXPIRATION_DATE >  CURRENT DATE          40590000
                           AND SEQ_NBR         =                        40600000
                       (SELECT MAX(SEQ_NBR)                             40610000
                          FROM TVNDAGR                                  40620000
                         WHERE ENT_ID          = :VNDAGR-ENT-ID         40630000
                           AND DEPT_NBR        = :VNDAGR-DEPT-NBR       40640000
                           AND AGRMT_TYP_ID    = :VNDAGR-AGRMT-TYP-ID   40650000
                           AND TYP_CDE         = :VNDAGR-TYP-CDE)       40660000
P41269                   WITH UR                                        40670000
                   END-EXEC                                             40680000
                                                                        40690000
                   EVALUATE TRUE                                        40700000
                       WHEN SQLCODE = ZERO                              40710000
                       WHEN SQLCODE = -904                              40720000
                       WHEN SQLCODE = -913                              40730000
                            CONTINUE                                    40740000
                                                                        40750000
                       WHEN SQLCODE NOT = ZERO                          40760000
                            MOVE '15700-DEFAULT-EDI-IND'                40770000
                                                   TO PV-PARAGRAPH-NAME 40780000
                            GO TO 99999-DB2-ABEND                       40790000
                   END-EVALUATE                                         40800000
           END-PERFORM.                                                 40810000
                                                                        40820000
           IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         40830000
               MOVE '15700-DEFAULT-EDI-IND' TO PV-PARAGRAPH-NAME        40840000
               GO TO 99999-DB2-ABEND                                    40850000
           END-IF.                                                      40860000
                                                                        40870000
           IF SQLCODE = ZERO                                            40880000
              IF WS-DB2-COUNT > ZERO                                    40890000
                  SET WS-EDI TO TRUE.                                   40900000
                                                                        40910000
                                                                        40920000
       15800-HANG-IND.                                                  40930000
                                                                        40940000
           SET PS-NO-HNG-IND-FOUND TO TRUE.                             40950000
           MOVE '4' TO VNDAGR-AGRMT-TYP-ID.                             40960000
           MOVE +2  TO VNDAGR-TYP-CDE.                                  40970000
                                                                        40980000
           PERFORM WITH TEST AFTER                                      40990000
                   VARYING PV-RETRY-COUNTER FROM 1 BY 1                 41000000
                   UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR         41010000
                           SQLCODE = ZERO                               41020000
                                                                        41030000
                   EXEC SQL                                             41040000
                        SELECT COUNT(*)                                 41050000
                          INTO :WS-DB2-COUNT                            41060000
                          FROM TVNDAGR                                  41070000
                         WHERE ENT_ID          = :VNDAGR-ENT-ID         41080000
                           AND DEPT_NBR        = :VNDAGR-DEPT-NBR       41090000
                           AND AGRMT_TYP_ID    = :VNDAGR-AGRMT-TYP-ID   41100000
                           AND TYP_CDE         = :VNDAGR-TYP-CDE        41110000
                           AND EFFECTIVE_DATE  <= CURRENT DATE          41120000
                           AND EXPIRATION_DATE >  CURRENT DATE          41130000
                           AND SEQ_NBR         =                        41140000
                       (SELECT MAX(SEQ_NBR)                             41150000
                          FROM TVNDAGR                                  41160000
                         WHERE ENT_ID          = :VNDAGR-ENT-ID         41170000
                           AND DEPT_NBR        = :VNDAGR-DEPT-NBR       41180000
                           AND AGRMT_TYP_ID    = :VNDAGR-AGRMT-TYP-ID   41190000
                           AND TYP_CDE         = :VNDAGR-TYP-CDE)       41200000
P41269                  WITH UR                                         41210000
                   END-EXEC                                             41220000
                                                                        41230000
                   EVALUATE TRUE                                        41240000
                       WHEN SQLCODE = ZERO                              41250000
                       WHEN SQLCODE = -904                              41260000
                       WHEN SQLCODE = -913                              41270000
                            CONTINUE                                    41280000
                                                                        41290000
                       WHEN SQLCODE NOT = ZERO                          41300000
                            MOVE '15800-HANG-IND'  TO PV-PARAGRAPH-NAME 41310000
                            GO TO 99999-DB2-ABEND                       41320000
                   END-EVALUATE                                         41330000
           END-PERFORM.                                                 41340000
                                                                        41350000
           IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         41360000
               MOVE '15800-HANG-IND' TO PV-PARAGRAPH-NAME               41370000
               GO TO 99999-DB2-ABEND                                    41380000
           END-IF.                                                      41390000
                                                                        41400000
           IF SQLCODE = ZERO                                            41410000
              IF WS-DB2-COUNT > ZERO                                    41420000
                  SET PS-HNG-IND-FOUND TO TRUE                          41430000
              END-IF                                                    41440000
           END-IF.                                                      41450000
                                                                        41460000
       16000-CALCULATE-PO-TIMESTAMP.                                    41470000
                                                                        41480000
           ACCEPT WS-DATE  FROM DATE.                                   41490000
           ACCEPT WS-TIME  FROM TIME.                                   41500000
           IF WS-DATE(1:2) > 80                                         41510000
              MOVE '19'         TO WS-TS-CC                             41520000
           ELSE                                                         41530000
              MOVE '20'         TO WS-TS-CC                             41540000
           END-IF.                                                      41550000
           MOVE WS-DATE(1:2) TO WS-TS-YY.                               41560000
           MOVE WS-DATE(3:2) TO WS-TS-MM.                               41570000
           MOVE WS-DATE(5:2) TO WS-TS-DD.                               41580000
           MOVE WS-TIME(1:2) TO WS-TS-HH.                               41590000
           MOVE WS-TIME(3:2) TO WS-TS-II.                               41600000
           MOVE WS-TIME(5:2) TO WS-TS-SS.                               41610000
           MOVE ZERO         TO WS-TS-MS.                               41620000
                                                                        41630000
       17000-PROCESS-TALLPLN.                                           41640000
           INITIALIZE PO025-SHIPTO-DATA-RECORD.                         41650000
           MOVE PC-SHIPTO-SEG TO PO025-SHIPTO-DATA-BOOKMARK.            41660000
                                                                        41670000
           PERFORM 17100-FORMAT-TALLPLN.                                41680000
                                                                        41690000
           PERFORM VARYING WS-DC-TBL-SUB FROM 1 BY 1                    41700000
                   UNTIL   WS-DC-ID (WS-DC-TBL-SUB) = 0                 41710000
              MOVE WS-DC-TBL-SUB             TO ALLPLN-PLAN-NBR         41720000
              MOVE WS-DC-QTY (WS-DC-TBL-SUB) TO ALLPLN-CURR-SPLIT-QTY   41730000
              MOVE WS-DC-ID  (WS-DC-TBL-SUB) TO PO025-SHIPTO-LOCATION   41740000
              IF WS-DC-QTY (WS-DC-TBL-SUB) EQUAL ZERO                   41750000
                  CONTINUE                                              41760000
              ELSE                                                      41770000
                  MOVE 'W' TO PO025-SHIPTO-LOC-TYPE                     41780000
                  MOVE WS-DC-QTY(WS-DC-TBL-SUB) TO                      41790000
                         PO025-SHIPTO-CURRENT-QTY                       41800000
                  STRING PO025-SHIPTO-DATA-RECORD DELIMITED BY SIZE     41810000
                  INTO PV-STRING-CLAUSE                                 41820000
                  WITH POINTER PV-STRING-POINTER-WHERE                  41830000
                  INITIALIZE PO025-STORES-RECORD                        41840000
                  SET PO025-STORE-INDEX TO +1                           41850000
                  MOVE 0 TO PO025-STR-STORE-COUNT                       41860000
                  MOVE PC-STORES-SEG TO PO025-STORES-BOOKMARK           41870000
                  PERFORM VARYING WS-STR-TBLE-SUB-API FROM 1 BY 1       41880000
                          UNTIL   WS-STR-NBR-API(WS-STR-TBLE-SUB-API)   41890000
                          EQUAL   SPACES OR ZERO                        41900000
                    IF PO025-SHIPTO-LOCATION EQUAL                      41910000
                       WS-STR-DC-API(WS-STR-TBLE-SUB-API)               41920000
                       MOVE WS-STR-NBR-API(WS-STR-TBLE-SUB-API) TO      41930000
                            PO025-STR-STORE(PO025-STORE-INDEX)          41940000
                       MOVE WS-STR-QTY-API(WS-STR-TBLE-SUB-API) TO      41950000
                            PO025-STR-QTY-ALLOC(PO025-STORE-INDEX)      41960000
                       SET PO025-STORE-INDEX UP BY 1                    41970000
                       ADD 1 TO PO025-STR-STORE-COUNT                   41980000
                       ADD 1 TO PV-ALLOC-COUNT                          41990000
                    END-IF                                              42000000
                  END-PERFORM                                           42010000
                  IF PO025-STR-STORE-COUNT > 0                          42020000
                     MOVE '####' TO PO025-STR-STORE-X(PO025-STORE-INDEX)42030000
                     STRING PO025-STORES-RECORD DELIMITED BY '####'     42040000
                     INTO PV-STRING-CLAUSE                              42050000
                     WITH POINTER PV-STRING-POINTER-WHERE               42060000
                  END-IF                                                42070000
              END-IF                                                    42080000
                                                                        42090000
              IF ALLPLN-CURR-SPLIT-QTY > ZERO                           42100000
                    AND PS-HOLD-ENTRY-IN-LEGACY                         42110000
                  PERFORM 17200-INSERT-TALLPLN                          42120000
              END-IF                                                    42130000
           END-PERFORM.                                                 42140000
                                                                        42150000
           PERFORM 17050-INITIALIZE-DC-QTY.                             42160000
                                                                        42170000
                                                                        42180000
       17050-INITIALIZE-DC-QTY.                                         42190000
                                                                        42200000
           MOVE ZERO TO WS-DC-QTY (1)                                   42210000
                        WS-DC-QTY (2)                                   42220000
                        WS-DC-QTY (3)                                   42230000
                        WS-DC-QTY (4)                                   42240000
                        WS-DC-QTY (5)                                   42250000
                        WS-DC-QTY (6)                                   42260000
                        WS-DC-QTY (7)                                   42270000
                        WS-DC-QTY (8)                                   42280000
                        WS-DC-QTY (9)                                   42290000
                        WS-DC-QTY (10)                                  42300000
                        WS-DC-QTY (11)                                  42310000
                        WS-DC-QTY (12)                                  42320000
                        WS-DC-QTY (13)                                  42330000
                        WS-DC-QTY (14)                                  42340000
                        WS-DC-QTY (15)                                  42350000
                        WS-DC-QTY (16)                                  42360000
                        WS-DC-QTY (17)                                  42370000
                        WS-DC-QTY (18)                                  42380000
                        WS-DC-QTY (19)                                  42390000
                        WS-DC-QTY (20)                                  42400000
                        WS-DC-QTY (21)                                  42410000
                        WS-DC-QTY (22)                                  42420000
                        WS-DC-QTY (23)                                  42430000
                        WS-DC-QTY (24)                                  42440000
                        WS-DC-QTY (25).                                 42450000
                                                                        42460000
       17100-FORMAT-TALLPLN.                                            42470000
                                                                        42480000
           MOVE PURCHS-PO-NBR    TO ALLPLN-PO-NBR.                      42490000
           MOVE WS-PO-LNE-NBR    TO ALLPLN-PO-LNE-NBR.                  42500000
           MOVE 'AC'             TO ALLPLN-STATUS-CDE.                  42510000
           MOVE ZERO             TO ALLPLN-DC-SPLIT-QTY.                42520000
           MOVE WS-PROGRAM-ID TO ALLPLN-SPLIT-CRE-ID                    42530000
                                 ALLPLN-DISTRO-CRE-ID.                  42540000
           MOVE WS-DEFAULT-DATE TO ALLPLN-SPLIT-UPD-DATE.               42550000
                                                                        42560000
       17200-INSERT-TALLPLN.                                            42570000
                                                                        42580000
                                                                        42590000
           IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         42600000
               MOVE '17200-INSERT-TALLPLN' TO PV-PARAGRAPH-NAME         42610000
               GO TO 99999-DB2-ABEND                                    42620000
           END-IF.                                                      42630000
                                                                        42640000
           IF SQLCODE = ZERO                                            42650000
               ADD 1 TO WS-TALLPLN-INSERTED.                            42660000
                                                                        42670000
                                                                        42680000
      *17500-UPDATE-TPURITM-TSTVNDC.                                    42690000
      *                                                                 42700000
      *                                                                 42710000
      *    IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         42720000
      *        MOVE '17500-UPDATE-TPURITM-TSTVNDC'                      42730000
      *                                TO PV-PARAGRAPH-NAME             42740000
      *        GO TO 99999-DB2-ABEND                                    42750000
      *    END-IF.                                                      42760000
                                                                        42770000
                                                                        42780000
       18000-PROCESS-HEADER.                                            42790000
                                                                        42800000
           PERFORM 18100-CREATE-TPOAGMTS.                               42810000
                                                                        42820000
           PERFORM 18200-CREATE-TPLNSHP.                                42830000
                                                                        42840000
           PERFORM 18300-CREATE-TPURCHS.                                42850000
                                                                        42860000
           MOVE PURCHS-PO-NBR TO WS-D-PO-NBR.                           42870000
           MOVE PURCHS-ENT-ID TO WS-D-VNDR-NBR.                         42880000
           DISPLAY ' '.                                                 42890000
           STRING  'PURCHASE ORDER '     WS-D-PO-NBR                    42900000
                   ' CREATED FOR DEPT. ' PURCHS-DEPT-NBR                42910000
                   ', VENDOR ' WS-D-VNDR-NBR                            42920000
                   DELIMITED BY SIZE                                    42930000
                   INTO WS-D-PO-MSG.                                    42940000
           DISPLAY WS-D-PO-MSG.                                         42950000
           DISPLAY '   LINE  ITEMS    SENT : ' PV-SKU-COUNT.            42960000
           DISPLAY '   STORE ALLOCTNS SENT : ' PV-ALLOC-COUNT.          42970000
                                                                        42980000
           MOVE ZERO TO WS-PO-LNE-NBR                                   42990000
                        WS-TPURITM-INSERTED                             43000000
                        WS-TMESTDS-INSERTED                             43010000
                        WS-PARENT-ENT-ID                                43020000
                        WS-FACTORY-ENT-ID.                              43030000
                                                                        43040000
       18100-CREATE-TPOAGMTS.                                           43050000
                                                                        43060000
           MOVE ZERO TO WS-POAGMT-SEQ-NBR.                              43070000
                                                                        43080000
           PERFORM 18110-FORMAT-TPOAGMT-PAYMENT.                        43090000
                                                                        43100000
           IF PS-HOLD-ENTRY-IN-LEGACY                                   43110000
               PERFORM 18120-INSERT-TPOAGMT-PAYMENT                     43120000
           END-IF.                                                      43130000
                                                                        43140000
           IF WS-PRETICKET                                              43150000
               ADD +1 TO WS-POAGMT-SEQ-NBR                              43160000
                                                                        43170000
               PERFORM 18130-FORMAT-TPOAGMT-PRETICKET                   43180000
                                                                        43190000
               IF PS-HOLD-ENTRY-IN-LEGACY                               43200000
                   PERFORM 18140-INSERT-TPOAGMT-PRETICKET               43210000
               END-IF                                                   43220000
           END-IF.                                                      43230000
                                                                        43240000
           IF WS-PKBYSTR                                                43250000
               ADD +1 TO WS-POAGMT-SEQ-NBR                              43260000
                                                                        43270000
               PERFORM 18150-FORMAT-TPOAGMT-PKBYSTR                     43280000
                                                                        43290000
               IF PS-HOLD-ENTRY-IN-LEGACY                               43300000
                   PERFORM 18160-INSERT-TPOAGMT-PKBYSTR                 43310000
               END-IF                                                   43320000
           END-IF.                                                      43330000
                                                                        43340000
       18110-FORMAT-TPOAGMT-PAYMENT.                                    43350000
                                                                        43360000
           MOVE PURCHS-PO-NBR            TO POAGMT-PO-NBR.              43370000
           MOVE +1                       TO POAGMT-VER-NBR.             43380000
           MOVE '2'                      TO POAGMT-AGRMT-TYP-ID.        43390000
           MOVE +1                       TO POAGMT-SEQ-NBR.             43400000
           MOVE 'A'                      TO POAGMT-VER-STATUS-CDE.      43410000
           MOVE ZERO                     TO POAGMT-TYP-CDE.             43420000
           MOVE SPACE                    TO POAGMT-TKT-MKR-IND.         43430000
           MOVE SPACE                    TO POAGMT-BULK-STK-TKT-IND.    43440000
           MOVE SPACES                   TO POAGMT-EDI-PROMO-TXT.       43450000
           MOVE ZERO                     TO POAGMT-PO-CAN-DAY-QTY.      43460000
           MOVE SPACE                    TO POAGMT-AUTO-PO-CAN-IND.     43470000
           MOVE ZERO                     TO POAGMT-DISC-DOL-AMT.        43480000
           MOVE ZERO                     TO POAGMT-DISC-PCT.            43490000
           MOVE ZERO                     TO POAGMT-DISC-PAY-DAY-QTY.    43500000
           MOVE WS-DB2-TIMESTAMP         TO POAGMT-LAST-UPD-TMST.       43510000
           MOVE VNDAGR-PAYT-TERM-ID      TO POAGMT-PAYT-TERM-ID.        43520000
           MOVE WS-PROGRAM-ID            TO POAGMT-LAST-UPD-BY-UID.     43530000
                                                                        43540000
       18120-INSERT-TPOAGMT-PAYMENT.                                    43550000
                                                                        43560000
                                                                        43570000
           IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         43580000
               MOVE '18120-INSERT-TPOAGMT-PAYMENT' TO PV-PARAGRAPH-NAME 43590000
               GO TO 99999-DB2-ABEND                                    43600000
           END-IF.                                                      43610000
                                                                        43620000
           IF SQLCODE = ZERO                                            43630000
               ADD 1 TO WS-TPOAGMT-INSERTED.                            43640000
                                                                        43650000
       18130-FORMAT-TPOAGMT-PRETICKET.                                  43660000
                                                                        43670000
           MOVE PURCHS-PO-NBR            TO POAGMT-PO-NBR.              43680000
           MOVE +1                       TO POAGMT-VER-NBR.             43690000
           MOVE '4'                      TO POAGMT-AGRMT-TYP-ID.        43700000
           MOVE WS-POAGMT-SEQ-NBR        TO POAGMT-SEQ-NBR.             43710000
           MOVE 'A'                      TO POAGMT-VER-STATUS-CDE.      43720000
           MOVE +1                       TO POAGMT-TYP-CDE.             43730000
           MOVE SPACE                    TO POAGMT-TKT-MKR-IND.         43740000
           MOVE SPACE                    TO POAGMT-BULK-STK-TKT-IND.    43750000
           MOVE SPACES                   TO POAGMT-EDI-PROMO-TXT.       43760000
           MOVE ZERO                     TO POAGMT-PO-CAN-DAY-QTY.      43770000
           MOVE SPACE                    TO POAGMT-AUTO-PO-CAN-IND.     43780000
           MOVE ZERO                     TO POAGMT-DISC-DOL-AMT.        43790000
           MOVE ZERO                     TO POAGMT-DISC-PCT.            43800000
           MOVE ZERO                     TO POAGMT-DISC-PAY-DAY-QTY.    43810000
           MOVE WS-DB2-TIMESTAMP         TO POAGMT-LAST-UPD-TMST.       43820000
           MOVE ZERO                     TO POAGMT-PAYT-TERM-ID.        43830000
           MOVE WS-PROGRAM-ID            TO POAGMT-LAST-UPD-BY-UID.     43840000
                                                                        43850000
       18140-INSERT-TPOAGMT-PRETICKET.                                  43860000
                                                                        43870000
                                                                        43880000
           IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         43890000
               MOVE '18140-INSERT-TPOAGMT-PRETICKET'                    43900000
                                                   TO PV-PARAGRAPH-NAME 43910000
               GO TO 99999-DB2-ABEND                                    43920000
           END-IF.                                                      43930000
                                                                        43940000
           IF SQLCODE = ZERO                                            43950000
               ADD 1 TO WS-TPOAGMT-INSERTED.                            43960000
                                                                        43970000
       18150-FORMAT-TPOAGMT-PKBYSTR.                                    43980000
                                                                        43990000
           MOVE PURCHS-PO-NBR            TO POAGMT-PO-NBR.              44000000
           MOVE +1                       TO POAGMT-VER-NBR.             44010000
           MOVE '4'                      TO POAGMT-AGRMT-TYP-ID.        44020000
           MOVE WS-POAGMT-SEQ-NBR        TO POAGMT-SEQ-NBR.             44030000
           MOVE 'A'                      TO POAGMT-VER-STATUS-CDE.      44040000
           MOVE +4                       TO POAGMT-TYP-CDE.             44050000
           MOVE SPACE                    TO POAGMT-TKT-MKR-IND.         44060000
           MOVE SPACE                    TO POAGMT-BULK-STK-TKT-IND.    44070000
           MOVE SPACES                   TO POAGMT-EDI-PROMO-TXT.       44080000
           MOVE ZERO                     TO POAGMT-PO-CAN-DAY-QTY.      44090000
           MOVE SPACE                    TO POAGMT-AUTO-PO-CAN-IND.     44100000
           MOVE ZERO                     TO POAGMT-DISC-DOL-AMT.        44110000
           MOVE ZERO                     TO POAGMT-DISC-PCT.            44120000
           MOVE ZERO                     TO POAGMT-DISC-PAY-DAY-QTY.    44130000
           MOVE WS-DB2-TIMESTAMP         TO POAGMT-LAST-UPD-TMST.       44140000
           MOVE ZERO                     TO POAGMT-PAYT-TERM-ID.        44150000
           MOVE WS-PROGRAM-ID            TO POAGMT-LAST-UPD-BY-UID.     44160000
                                                                        44170000
       18160-INSERT-TPOAGMT-PKBYSTR.                                    44180000
                                                                        44190000
                                                                        44200000
           IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         44210000
               MOVE '18160-INSERT-TPOAGMT-PKBYSTR' TO PV-PARAGRAPH-NAME 44220000
               GO TO 99999-DB2-ABEND                                    44230000
           END-IF.                                                      44240000
                                                                        44250000
           IF SQLCODE = ZERO                                            44260000
               ADD 1 TO WS-TPOAGMT-INSERTED.                            44270000
                                                                        44280000
       18200-CREATE-TPLNSHP.                                            44290000
                                                                        44300000
           PERFORM 18210-GET-SHIPMENT-NUMBER.                           44310000
                                                                        44320000
           PERFORM 18220-FORMAT-TPLNSHP.                                44330000
                                                                        44340000
           IF (WS-NOT-HANES         AND WS-NOT-JOCKEY          AND      44350000
               WS-NOT-VANITY-FAIR   AND WS-NOT-LILY-OF-FRANCE  AND      44360000
               WS-NOT-ESTEE-LAUDER  AND WS-NOT-HALLMARK        AND      44370000
               WS-NOT-LIZ-CLAIBORNE AND WS-NOT-LEE-WRANGLER    AND      44380000
               WS-NOT-FISHMAN       AND WS-NOT-OLGA-WARNER     AND      44390000
               WS-NOT-PLAYTEX AND WS-NOT-BALI AND WS-NOT-WONDERBRA AND  44400000
               WS-NOT-TOP-OF-THE-WORLD AND WS-NOT-VF-IMAGEWEAR AND      44410000
               WS-NOT-KNIGHTS-APPAREL  AND WS-NOT-NEXT-INC     AND      44420000
352053         WS-NOT-47BRAND-LLC      AND WS-NOT-SUPREME-INTL AND      44430000
               WS-NOT-COLLEGE-CONCEPTS AND WS-NOT-RUSSELL-ATHLETIC AND  44440000
               WS-NOT-OUTERSTUFF AND WS-NOT-HADDAD AND                  44450000
               WS-NOT-HANES-UNDERWEAR AND WS-NOT-COKEM AND              44460000
               WS-NOT-GEAR-FOR-SPORTS AND WS-NOT-COLOSSEUM AND          44470000
               WS-NOT-SPORTS-LIC AND WS-NOT-RENAISSANCE AND             44480000
WR0933         WS-NOT-LEVIS  AND WS-NOT-TSHIRT-INT AND                  44490000
W41905         WS-NOT-JACMEL-JWL AND WS-NOT-GIII-LEATHER AND            44500000
534202         WS-NOT-PVH-SUPERBA AND WS-NOT-J-AMERICA  AND             44510000
494672         WS-NOT-ETRNL-FRTN  AND WS-NOT-HGGR-CLTING AND            44520000
371617         WS-NOT-WILL-DICKIE AND WS-NOT-NEW-ERACAP  AND            44530000
683003         WS-NOT-NEW-MAIDENFORM  AND WS-NOT-RANDA-ACCESSORIES AND  44540000
944205         WS-NOT-RANDA-CORP AND WS-NOT-BOELTER AND                 44550000
647062         WS-NOT-GONZALS AND WS-NOT-LUXOTTICA  AND                 44560000
018127         WS-NOT-CC-PRODUCTS AND WS-NOT-TERVIS AND                 44570000
637834         WS-NOT-PERRY AND WS-NOT-OURAY AND                        44580000
790723         WS-NOT-FGX AND                                           44590000
956632         WS-NOT-RANDA AND                                         44600000
956632         WS-NOT-LOGO  AND                                         44610000
956632         WS-NOT-GREAT-AMERICAN AND                                44620000
185577         WS-NOT-BESPOKE AND                                       44630000
346771         WS-NOT-MAD-ENGINE AND                                    44640000
265129         WS-NOT-HYBRID-PROM AND                                   44650000
887802         WS-NOT-BIO-WORLD   AND                                   44660000
927044         WS-NOT-NORTH-WEST  AND                                   44670000
925845         WS-NOT-BARE-FEET   AND                                   44680000
762449         WS-NOT-MASTER-PUZZLE  AND                                44690000
889751         WS-NOT-RIPPLE-JUNCTION AND                               44700000
064017         WS-NOT-LICHTENBERG AND                                   44710000
176716         WS-NOT-SPIRIT-LEATHERWORKS AND                           44720000
176682         WS-NOT-TEE-SHIRT-CENTRAL   AND                           44730000
680553         WS-NOT-LF-MENS-GROUP-LLC) OR                             44731000
             (WS-HANES  AND WS-SHIP-DATE = '2000-00-00') OR             44740000
             (WS-HANES  AND WS-SHIP-DATE = '20  -  -  ') OR             44750000
             (WS-JOCKEY AND WS-SHIP-DATE = '2000-00-00') OR             44760000
             (WS-JOCKEY AND WS-SHIP-DATE = '20  -  -  ')                44770000
               PERFORM 18230-GET-SHIP-DATE.                             44780000
                                                                        44790000
           PERFORM 18235-GET-CANCEL-DATE.                               44800000
                                                                        44810000
           IF PS-HOLD-ENTRY-IN-LEGACY                                   44820000
               PERFORM 18240-INSERT-TPLNSHP                             44830000
           END-IF.                                                      44840000
                                                                        44850000
       18210-GET-SHIPMENT-NUMBER.                                       44860000
                                                                        44870000
           PERFORM WITH TEST AFTER                                      44880000
                   VARYING PV-RETRY-COUNTER FROM 1 BY 1                 44890000
                   UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR         44900000
                           SQLCODE = ZERO                               44910000
                                                                        44920000
                   EXEC SQL                                             44930000
                        SELECT MAX(SHIPT_NBR)                           44940000
                          INTO :WS-SHIPT-NBR                            44950000
                          FROM TPLNSHP                                  44960000
                         WHERE VER_STATUS_CDE = 'A'                     44970000
P41269                  WITH UR                                         44980000
                   END-EXEC                                             44990000
                                                                        45000000
                   EVALUATE TRUE                                        45010000
                       WHEN SQLCODE = ZERO                              45020000
                       WHEN SQLCODE = -904                              45030000
                       WHEN SQLCODE = -913                              45040000
                            CONTINUE                                    45050000
                                                                        45060000
                       WHEN SQLCODE NOT = ZERO                          45070000
                            MOVE '18210-GET-SHIPMENT-NUMBER'            45080000
                                                   TO PV-PARAGRAPH-NAME 45090000
                            GO TO 99999-DB2-ABEND                       45100000
                   END-EVALUATE                                         45110000
           END-PERFORM.                                                 45120000
                                                                        45130000
           IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         45140000
               MOVE '18210-GET-SHIPMENT-NUMBER' TO PV-PARAGRAPH-NAME    45150000
               GO TO 99999-DB2-ABEND                                    45160000
           END-IF.                                                      45170000
                                                                        45180000
       18220-FORMAT-TPLNSHP.                                            45190000
           INITIALIZE DCLTPLNSHP.                                       45200000
                                                                        45210000
           ADD  +1                        TO WS-SHIPT-NBR.              45220000
           MOVE WS-SHIPT-NBR              TO PLNSHP-SHIPT-NBR.          45230000
           MOVE +1                        TO PLNSHP-VER-NBR.            45240000
           MOVE 'A'                       TO PLNSHP-VER-STATUS-CDE.     45250000
           MOVE 'ST'                      TO PLNSHP-SHIPT-TYP-CDE.      45260000
           MOVE ZERO                      TO PLNSHP-SHIPT-DEST-NBR.     45270000
           MOVE VNDAGR-SHIPT-POINT-TXT    TO PLNSHP-SHIPT-POINT-TXT.    45280000
           MOVE VNDAGR-FOB-POINT-TXT      TO PLNSHP-FOB-POINT-TXT.      45290000
                                                                        45300000
           IF FRGTRM-KOHLS-FRGT-PCT = 1.0000                            45310000
               MOVE ZEROES                TO PLNSHP-KOHLS-FRGT-PCT      45320000
                                             PLNSHP-VEND-FRGT-PCT       45330000
               MOVE 'K'                   TO PLNSHP-FRGT-PAYT-CDE       45340000
           ELSE                                                         45350000
               IF FRGTRM-VND-FRGT-PCT = 1.0000                          45360000
                   MOVE ZEROES            TO PLNSHP-VEND-FRGT-PCT       45370000
                                             PLNSHP-KOHLS-FRGT-PCT      45380000
                   MOVE 'V'               TO PLNSHP-FRGT-PAYT-CDE       45390000
               ELSE                                                     45400000
                   MOVE FRGTRM-KOHLS-FRGT-PCT                           45410000
                                          TO PLNSHP-KOHLS-FRGT-PCT      45420000
                   MOVE FRGTRM-VND-FRGT-PCT                             45430000
                                          TO PLNSHP-VEND-FRGT-PCT       45440000
                   IF FRGTRM-KOHLS-FRGT-PCT = 0 AND                     45450000
                      FRGTRM-VND-FRGT-PCT   = 0                         45460000
                       MOVE 'K'           TO PLNSHP-FRGT-PAYT-CDE       45470000
                   ELSE                                                 45480000
                       MOVE 'B'           TO PLNSHP-FRGT-PAYT-CDE       45490000
                   END-IF                                               45500000
               END-IF                                                   45510000
           END-IF.                                                      45520000
                                                                        45530000
           MOVE SPACES                    TO PLNSHP-PORT-ENTR-DESC.     45540000
           MOVE WS-DEFAULT-DATE           TO PLNSHP-STRT-FCTRY-DTE      45550000
                                             PLNSHP-LAST-FCTRY-DTE      45560000
                                             PLNSHP-EXT-CAN-DTE.        45570000
           MOVE 'AC'                      TO PLNSHP-STATUS-CDE.         45580000
           MOVE VNDDPT-ENT-ID             TO PLNSHP-ENT-ID.             45590000
           MOVE PURCHS-PO-NBR             TO PLNSHP-PO-NBR.             45600000
           MOVE WS-PROGRAM-ID             TO PLNSHP-LAST-UPD-BY-UID.    45610000
           MOVE SPACES                    TO PLNSHP-FOB-CDE             45620000
                                             PLNSHP-POE-CDE.            45630000
                                                                        45640000
       18230-GET-SHIP-DATE.                                             45650000
                                                                        45660000
           PERFORM WITH TEST AFTER                                      45670000
                   VARYING PV-RETRY-COUNTER FROM 1 BY 1                 45680000
                   UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR         45690000
                           SQLCODE = ZERO                               45700000
                                                                        45710000
                   EXEC SQL                                             45720000
                        SET :WS-SHIP-DATE = CURRENT DATE                45730000
                   END-EXEC                                             45740000
                                                                        45750000
                   EVALUATE TRUE                                        45760000
                       WHEN SQLCODE = ZERO                              45770000
                       WHEN SQLCODE = -904                              45780000
                       WHEN SQLCODE = -913                              45790000
                            CONTINUE                                    45800000
                                                                        45810000
                       WHEN SQLCODE NOT = ZERO                          45820000
                            MOVE '18230-GET-SHIP-DATE'                  45830000
                                               TO PV-PARAGRAPH-NAME     45840000
                            GO TO 99999-DB2-ABEND                       45850000
                   END-EVALUATE                                         45860000
           END-PERFORM.                                                 45870000
                                                                        45880000
           IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         45890000
               MOVE '18230-GET-SHIP-DATE' TO PV-PARAGRAPH-NAME          45900000
               GO TO 99999-DB2-ABEND                                    45910000
           END-IF.                                                      45920000
                                                                        45930000
       18235-GET-CANCEL-DATE.                                           45940000
           IF WS-HANES OR WS-JOCKEY OR                                  45950000
              WS-HALLMARK OR WS-MULBERRY OR                             45960000
              WS-VANITY-FAIR OR WS-LILY-OF-FRANCE OR                    45970000
              WS-PLAYTEX OR WS-BALI OR WS-WONDERBRA                     45980000
               PERFORM 18237-GET-CANCEL-DATE                            45990000
           ELSE                                                         46000000
               IF WS-ESTEE-LAUDER OR WS-LEE-WRANGLER OR WS-FISHMAN OR   46010000
                  WS-OLGA-WARNER  OR WS-TOP-OF-THE-WORLD OR             46020000
                  WS-VF-IMAGEWEAR OR WS-KNIGHTS-APPAREL OR              46030000
352053            WS-NEXT-INC OR WS-47BRAND-LLC    OR                   46040000
                  WS-SUPREME-INTL OR WS-COLLEGE-CONCEPTS OR             46050000
                  WS-RUSSELL-ATHLETIC OR WS-OUTERSTUFF OR WS-HADDAD OR  46060000
                  WS-HANES-UNDERWEAR OR WS-COKEM OR WS-GEAR-FOR-SPORTS  46070000
                  OR WS-COLOSSEUM OR WS-SPORTS-LIC OR WS-RENAISSANCE    46080000
WR9604            OR WS-LEVIS OR WS-TSHIRT-INT                          46090000
W41905            OR WS-JACMEL-JWL OR WS-GIII-LEATHER                   46100000
W42092            OR WS-PVH-SUPERBA                                     46110000
534202            OR WS-J-AMERICA                                       46120000
453643            OR WS-ETRNL-FRTN                                      46130000
494672            OR WS-HGGR-CLTING                                     46140000
686121            OR WS-WILL-DICKIE                                     46150000
371617            OR WS-NEW-ERACAP                                      46160000
505256            OR WS-NEW-MAIDENFORM                                  46170000
683003            OR WS-RANDA-ACCESSORIES                               46180000
683026            OR WS-RANDA-CORP                                      46190000
944205            OR WS-BOELTER                                         46200000
002139            OR WS-GONZALS                                         46210000
647062            OR WS-LUXOTTICA                                       46220000
647062            OR WS-CC-PRODUCTS                                     46230000
018127            OR WS-TERVIS                                          46240000
356324            OR WS-PERRY                                           46250000
637834            OR WS-OURAY                                           46260000
185577            OR WS-BESPOKE                                         46270000
790723            OR WS-FGX                                             46280000
956632            OR WS-RANDA                                           46290000
956632            OR WS-LOGO                                            46300000
956632            OR WS-GREAT-AMERICAN                                  46310000
346771            OR WS-MAD-ENGINE                                      46320000
265129            OR WS-HYBRID-PROM                                     46330000
887802            OR WS-BIO-WORLD                                       46340000
927044            OR WS-NORTH-WEST                                      46350000
925845            OR WS-BARE-FEET                                       46360000
762449            OR WS-MASTER-PUZZLE                                   46370000
889751            OR WS-RIPPLE-JUNCTION                                 46380000
064017            OR WS-LICHTENBERG                                     46390000
176716            OR WS-SPIRIT-LEATHERWORKS                             46400000
176682            OR WS-TEE-SHIRT-CENTRAL                               46410000
680553            OR WS-LF-MENS-GROUP-LLC                               46411000
                  IF (WS-CANCEL-DATE = '2000-00-00') OR                 46420000
                     (WS-CANCEL-DATE = '20  -  -  ')                    46430000
                     PERFORM 96000-FORMAT-ERROR-INFO                    46440000
                                                                        46450000
                     MOVE PO002-H-PO-NBR TO WS-PO-NBR                   46460000
                     MOVE WS-PO-NBR      TO ERR-RPT-D4-PO-NBR           46470000
                                                                        46480000
                     MOVE SPACES TO ERR-RPT-D5-UPC                      46490000
                     MOVE ZEROES TO ERR-RPT-D5-SKU                      46500000
                                                                        46510000
                     PERFORM 98000-PRINT-ERROR-PAGE                     46520000
                                                                        46530000
                     MOVE WS-DEFAULTING-CANCEL-DATE TO                  46540000
                                              ERR-RPT-DETAIL-ERROR      46550000
                     WRITE ERROR-RECORD  FROM ERR-RPT-DETAIL-ERROR      46560000
                           AFTER ADVANCING 3 LINES                      46570000
                     SET PS-ERROR-REPORT-CREATED TO TRUE                46580000
                    PERFORM 18237-GET-CANCEL-DATE                       46590000
                  END-IF                                                46600000
               ELSE                                                     46610000
                  IF WS-LIZ-CLAIBORNE                                   46620000
                     IF (WS-CANCEL-DATE = '2000-00-00') OR              46630000
                     (WS-CANCEL-DATE = '20  -  -  ')                    46640000
                                                                        46650000
                        PERFORM 96000-FORMAT-ERROR-INFO                 46660000
                                                                        46670000
                        MOVE PO002-H-PO-NBR TO WS-PO-NBR                46680000
                        MOVE WS-PO-NBR      TO ERR-RPT-D4-PO-NBR        46690000
                                                                        46700000
                        MOVE SPACES TO ERR-RPT-D5-UPC                   46710000
                        MOVE ZEROES TO ERR-RPT-D5-SKU                   46720000
                                                                        46730000
                        PERFORM 98000-PRINT-ERROR-PAGE                  46740000
                                                                        46750000
                        MOVE WS-DEFAULTING-CANCEL-DATE TO               46760000
                                                 ERR-RPT-DETAIL-ERROR   46770000
                        WRITE ERROR-RECORD  FROM ERR-RPT-DETAIL-ERROR   46780000
                              AFTER ADVANCING 3 LINES                   46790000
                        SET PS-ERROR-REPORT-CREATED TO TRUE             46800000
                        PERFORM 18237-GET-CANCEL-DATE                   46810000
                      END-IF                                            46820000
                  ELSE                                                  46830000
                     PERFORM 18239-GET-CANCEL-DATE                      46840000
                  END-IF                                                46850000
               END-IF                                                   46860000
           END-IF.                                                      46870000
                                                                        46880000
       18237-GET-CANCEL-DATE.                                           46890000
           SET DPG51-FISCAL-JAN-DEC-F2   TO TRUE.                       46900000
           SET DPG51-INCREMENT-DATE      TO TRUE.                       46910000
                                                                        46920000
      *VENDOR SHIP/CANCEL WINDOW IS 10 DAYS                             46930000
           MOVE 10 TO DPG51-INCR-DECR-DAYS-9.                           46940000
                                                                        46950000
      *OVERLAY SHIP/CANCEL WINDOW NUMBER OF DAYS FOR HANES PO'S         46960000
           IF WS-HANES                                                  46970000
               MOVE  8 TO DPG51-INCR-DECR-DAYS-9                        46980000
           END-IF.                                                      46990000
                                                                        47000000
      *OVERLAY SHIP/CANCEL WINDOW NUMBER OF DAYS FOR ESTEE PO'S         47010000
           IF WS-ESTEE-LAUDER                                           47020000
               MOVE  12 TO DPG51-INCR-DECR-DAYS-9                       47030000
           END-IF.                                                      47040000
                                                                        47050000
      *OVERLAY SHIP/CANCEL WINDOW NUMBER OF DAYS FOR HALLMARK.          47060000
           IF WS-HALLMARK OR WS-MULBERRY OR WS-VANITY-FAIR OR           47070000
              WS-LILY-OF-FRANCE OR WS-LEE-WRANGLER OR WS-FISHMAN OR     47080000
              WS-OLGA-WARNER OR WS-PLAYTEX OR WS-BALI OR WS-WONDERBRA   47090000
              OR WS-TOP-OF-THE-WORLD OR WS-VF-IMAGEWEAR OR              47100000
              WS-KNIGHTS-APPAREL OR WS-NEXT-INC                         47110000
352053        OR WS-47BRAND-LLC    OR WS-SUPREME-INTL                   47120000
              OR WS-COLLEGE-CONCEPTS OR WS-RUSSELL-ATHLETIC             47130000
              OR WS-OUTERSTUFF OR WS-HADDAD OR WS-HANES-UNDERWEAR       47140000
              OR WS-COKEM OR WS-GEAR-FOR-SPORTS OR WS-COLOSSEUM         47150000
              OR WS-SPORTS-LIC OR WS-RENAISSANCE                        47160000
WR0933        OR WS-LEVIS OR WS-TSHIRT-INT                              47170000
W41905        OR WS-JACMEL-JWL OR WS-GIII-LEATHER                       47180000
W42092        OR WS-PVH-SUPERBA                                         47190000
534202        OR WS-J-AMERICA                                           47200000
453643        OR WS-ETRNL-FRTN                                          47210000
494672        OR WS-HGGR-CLTING                                         47220000
686121        OR WS-WILL-DICKIE                                         47230000
371617        OR WS-NEW-ERACAP                                          47240000
505256        OR WS-NEW-MAIDENFORM                                      47250000
683003        OR WS-RANDA-ACCESSORIES                                   47260000
683026        OR WS-RANDA-CORP                                          47270000
944205        OR WS-BOELTER                                             47280000
002139        OR WS-GONZALS                                             47290000
647062        OR WS-LUXOTTICA                                           47300000
042023        OR WS-CC-PRODUCTS                                         47310000
018127        OR WS-TERVIS                                              47320000
356324        OR WS-PERRY                                               47330000
637834        OR WS-OURAY                                               47340000
185577        OR WS-BESPOKE                                             47350000
790723        OR WS-FGX                                                 47360000
956632        OR WS-RANDA                                               47370000
956632        OR WS-LOGO                                                47380000
956632        OR WS-GREAT-AMERICAN                                      47390000
346771        OR WS-MAD-ENGINE                                          47400000
265129        OR WS-HYBRID-PROM                                         47410000
887802        OR WS-BIO-WORLD                                           47420000
927044        OR WS-NORTH-WEST                                          47430000
925845        OR WS-BARE-FEET                                           47440000
762449        OR WS-MASTER-PUZZLE                                       47450000
889751        OR WS-RIPPLE-JUNCTION                                     47460000
064017        OR WS-LICHTENBERG                                         47470000
176716        OR WS-SPIRIT-LEATHERWORKS                                 47480000
176682        OR WS-TEE-SHIRT-CENTRAL                                   47490000
680553        OR WS-LF-MENS-GROUP-LLC                                   47491000
               MOVE 7 TO DPG51-INCR-DECR-DAYS-9                         47500000
           END-IF.                                                      47510000
                                                                        47520000
           SET DPG52-LK-DTE-ISO-FMT      TO TRUE.                       47530000
           MOVE WS-SHIP-DATE TO DPG52-LK-DATE-INPUT.                    47540000
                                                                        47550000
           CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51                47560000
                                                   DPG52                47570000
                                                   DPG53                47580000
                                                   DPG54                47590000
                                                   DPG55                47600000
                                                   DPG56.               47610000
                                                                        47620000
           EVALUATE TRUE                                                47630000
               WHEN DPG54-SEVERE-ERROR                                  47640000
               WHEN DPG54-WARNING-ERROR                                 47650000
                    DISPLAY ' '                                         47660000
                    DISPLAY '18237 : UNSUCCESSFUL DPKUT500 CALL'        47670000
                    DISPLAY 'DATE PASSED IN WAS: ' WS-SHIP-DATE         47680000
                    DISPLAY DPG54-ERROR-MESSAGE                         47690000
                                                                        47700000
               WHEN DPG54-NO-ERROR                                      47710000
                    STRING DPG55-DB2-ISO-DATE-YR-X '-'                  47720000
                           DPG55-DB2-ISO-DATE-MO-X '-'                  47730000
                           DPG55-DB2-ISO-DATE-DY-X                      47740000
                           DELIMITED BY SIZE                            47750000
                           INTO WS-CANCEL-DATE                          47760000
           END-EVALUATE.                                                47770000
                                                                        47780000
       18239-GET-CANCEL-DATE.                                           47790000
           PERFORM WITH TEST AFTER                                      47800000
                   VARYING PV-RETRY-COUNTER FROM 1 BY 1                 47810000
                   UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR         47820000
                           SQLCODE = ZERO                               47830000
                                                                        47840000
                   EXEC SQL                                             47850000
      *                 SELECT DISTINCT (CURRENT DATE + 21 DAYS)        47860000
                        SELECT DISTINCT (CURRENT DATE + 10 DAYS)        47870000
                          INTO :WS-CANCEL-DATE                          47880000
                          FROM XMT_LOC                                  47890000
P41269                  WITH UR                                         47900000
                   END-EXEC                                             47910000
                                                                        47920000
                   EVALUATE TRUE                                        47930000
                       WHEN SQLCODE = ZERO                              47940000
                       WHEN SQLCODE = -904                              47950000
                       WHEN SQLCODE = -913                              47960000
                            CONTINUE                                    47970000
                                                                        47980000
                       WHEN SQLCODE NOT = ZERO                          47990000
                            MOVE '18239-GET-CANCEL-DATE'                48000000
                                                   TO PV-PARAGRAPH-NAME 48010000
                            GO TO 99999-DB2-ABEND                       48020000
                   END-EVALUATE                                         48030000
           END-PERFORM.                                                 48040000
                                                                        48050000
           IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         48060000
               MOVE '18239-GET-CANCEL-DATE' TO PV-PARAGRAPH-NAME        48070000
               GO TO 99999-DB2-ABEND                                    48080000
           END-IF.                                                      48090000
                                                                        48100000
       18240-INSERT-TPLNSHP.                                            48110000
                                                                        48120000
                                                                        48130000
           IF (PV-RETRY-COUNTER > PC-MAX-RETRIES AND SQLCODE NOT = 0)   48140000
               MOVE '18240-INSERT-TPLNSHP' TO PV-PARAGRAPH-NAME         48150000
               GO TO 99999-DB2-ABEND                                    48160000
           END-IF.                                                      48170000
                                                                        48180000
           IF SQLCODE = ZERO                                            48190000
               ADD 1 TO WS-TPLNSHP-INSERTED.                            48200000
                                                                        48210000
       18300-CREATE-TPURCHS.                                            48220000
                                                                        48230000
           PERFORM 18310-FORMAT-TPURCHS.                                48240000
                                                                        48250000
           IF PS-HOLD-ENTRY-IN-LEGACY                                   48260000
               PERFORM 18320-INSERT-TPURCHS                             48270000
           END-IF.                                                      48280000
                                                                        48290000
      *    PERFORM 18330-DELETE-TPORESV.                                48300000
                                                                        48310000
                                                                        48320000
       18310-FORMAT-TPURCHS.                                            48330000
                                                                        48340000
           MOVE +1                   TO PURCHS-VER-NBR.                 48350000
           MOVE 'A'                  TO PURCHS-VER-STATUS-CDE.          48360000
           MOVE 'VN'                 TO PURCHS-PO-TYP-CDE.              48370000
           MOVE 'MR'                 TO PURCHS-PO-CATEG-CDE.            48380000
                                                                        48390000
           IF WS-EDI                                                    48400000
               MOVE 'Y'              TO PURCHS-EDI-IND                  48410000
           ELSE                                                         48420000
               MOVE 'N'              TO PURCHS-EDI-IND                  48430000
           END-IF.                                                      48440000
                                                                        48450000
           MOVE 'N'                  TO PURCHS-EDI-IND.                 48460000
                                                                        48470000
           IF WS-JOCKEY OR WS-VANITY-FAIR OR WS-LILY-OF-FRANCE OR       48480000
              WS-LIZ-CLAIBORNE                                          48490000
               MOVE 'Y'              TO PURCHS-EDI-IND                  48500000
           ELSE                                                         48510000
               MOVE 'N'              TO PURCHS-EDI-IND                  48520000
           END-IF.                                                      48530000
                                                                        48540000
           MOVE WS-TOT-UNT-QTY       TO PURCHS-TOT-UNT-QTY.             48550000
           MOVE WS-TOT-VAL-COST-AMT  TO PURCHS-TOT-VAL-COST-AMT.        48560000
           MOVE WS-TOT-VAL-RTL-AMT   TO PURCHS-TOT-VAL-RTL-AMT.         48570000
                                                                        48580000
           IF PURCHS-TOT-VAL-RTL-AMT = ZERO                             48590000
               MOVE ZERO             TO PURCHS-TOT-MU-PCT               48600000
           ELSE                                                         48610000
               MOVE PURCHS-TOT-VAL-COST-AMT TO WS-TOT-CALC-COST-AMT     48620000
               MOVE PURCHS-TOT-VAL-RTL-AMT  TO WS-TOT-CALC-RTL-AMT      48630000
               COMPUTE PURCHS-TOT-MU-PCT ROUNDED =                      48640000
                       ((WS-TOT-CALC-RTL-AMT -                          48650000
                         WS-TOT-CALC-COST-AMT) * 100) /                 48660000
                         WS-TOT-CALC-RTL-AMT                            48670000
           END-IF.                                                      48680000
                                                                        48690000
           MOVE WS-TOT-SKUS-QTY      TO PURCHS-TOT-SKUS-QTY.            48700000
           MOVE ZERO                 TO PURCHS-IMPRT-AGNT-PO-NBR        48710000
                                        PURCHS-REJ-CT                   48720000
                                        PURCHS-REVISION-CT              48730000
                                        PURCHS-ADR-SEQ-NBR              48740000
                                        PURCHS-UNT-PER-CBMT-QTY         48750000
           MOVE SPACES               TO PURCHS-IMPRT-ORD-OFF-NAME       48760000
                                        PURCHS-IMPRT-VEND-NAME          48770000
                                        PURCHS-IMPRT-FCTRY-NAME         48780000
                                        PURCHS-IMPRT-CNTRY-NAME         48790000
                                        PURCHS-VEND-CNTRY-NAME          48800000
                                        PURCHS-IMPRT-PO-IND             48810000
                                        PURCHS-IMPRT-AGNT-PO-IND        48820000
                                        PURCHS-EDI-REXMIT-IND           48830000
                                        PURCHS-APP-BY-UID               48840000
                                        PURCHS-LAST-UPD-BY-UID          48850000
                                        PURCHS-REJ-UID                  48860000
                                        PURCHS-PLCMNT-CNTRY-CDE         48870000
                                        PURCHS-PROD-CNTRY-CDE           48880000
           MOVE 'N'                  TO PURCHS-NEW-STR-PO-IND.          48890000
                                                                        48900000
           IF WS-JOCKEY OR WS-VANITY-FAIR OR WS-LILY-OF-FRANCE OR       48910000
              WS-LIZ-CLAIBORNE                                          48920000
               MOVE 'T' TO PURCHS-EDI-REXMIT-IND                        48930000
           END-IF.                                                      48940000
                                                                        48950000
           IF WS-DTS-PO                                                 48960000
               MOVE 'Y'              TO PURCHS-DIR-STR-IND              48970000
           ELSE                                                         48980000
               MOVE 'N'              TO PURCHS-DIR-STR-IND              48990000
           END-IF.                                                      49000000
                                                                        49010000
           MOVE WS-DB2-TIMESTAMP     TO PURCHS-STATUS-TMST              49020000
           MOVE WS-DEFAULT-TIMESTAMP TO PURCHS-EDI-REXMIT-TMST          49030000
                                        PURCHS-LAST-UPD-TMST.           49040000
           MOVE VNDDPT-DEPT-NBR      TO PURCHS-DEPT-NBR.                49050000
           MOVE VNDDPT-ENT-ID        TO PURCHS-ENT-ID.                  49060000
           MOVE 'AC'                 TO PURCHS-STATUS-CDE.              49070000
           MOVE WS-PROGRAM-ID        TO PURCHS-CRE-BY-UID.              49080000
           IF WS-JOCKEY OR WS-VANITY-FAIR OR WS-LILY-OF-FRANCE OR       49090000
              WS-LIZ-CLAIBORNE                                          49100000
             MOVE 'N'                TO PURCHS-DEST-KNOWN-IND           49110000
             MOVE 'N'                TO PURCHS-RLSE-IND                 49120000
           ELSE                                                         49130000
             MOVE 'Y'                TO PURCHS-DEST-KNOWN-IND           49140000
             MOVE 'Y'                TO PURCHS-RLSE-IND                 49150000
           END-IF.                                                      49160000
           MOVE WS-DATE (3:2)        TO WS-D-MM.                        49170000
           MOVE WS-DATE (5:2)        TO WS-D-DD.                        49180000
           MOVE WS-DATE (1:2)        TO WS-D-YY.                        49190000
                                                                        49200000
           IF WS-DATE (1:2) > 80                                        49210000
               MOVE '19'             TO WS-D-CC                         49220000
           ELSE                                                         49230000
               MOVE '20'             TO WS-D-CC.                        49240000
           IF WS-JOCKEY OR WS-VANITY-FAIR OR WS-LILY-OF-FRANCE OR       49250000
              WS-LIZ-CLAIBORNE                                          49260000
               MOVE WS-DEFAULT-DATE TO PURCHS-RLSE-DTE                  49270000
           ELSE                                                         49280000
               MOVE WS-DB2-DATE     TO PURCHS-RLSE-DTE                  49290000
           END-IF.                                                      49300000
           MOVE WS-DB2-DATE         TO PURCHS-ORD-DTE.                  49310000
                                                                        49320000
           PERFORM 18312-FORMAT-OTB.                                    49330000
                                                                        49340000
           MOVE ZERO                 TO WS-TOT-UNT-QTY                  49350000
                                        WS-TOT-VAL-COST-AMT             49360000
                                        WS-TOT-VAL-RTL-AMT              49370000
                                        WS-TOT-SKUS-QTY.                49380000
                                                                        49390000
       18312-FORMAT-OTB.                                                49400000
                                                                        49410000
           IF WS-HANES OR WS-JOCKEY OR WS-VANITY-FAIR OR                49420000
              WS-LILY-OF-FRANCE OR WS-ESTEE-LAUDER OR WS-HALLMARK OR    49430000
              WS-LIZ-CLAIBORNE OR WS-LEE-WRANGLER OR WS-FISHMAN OR      49440000
              WS-OLGA-WARNER OR WS-PLAYTEX OR WS-BALI OR WS-WONDERBRA OR49450000
              WS-TOP-OF-THE-WORLD OR WS-VF-IMAGEWEAR OR                 49460000
              WS-KNIGHTS-APPAREL OR WS-NEXT-INC                         49470000
352053        OR WS-47BRAND-LLC    OR WS-SUPREME-INTL                   49480000
              OR WS-COLLEGE-CONCEPTS OR WS-RUSSELL-ATHLETIC             49490000
              OR WS-OUTERSTUFF OR WS-HADDAD OR WS-HANES-UNDERWEAR       49500000
              OR WS-COKEM OR WS-GEAR-FOR-SPORTS OR WS-COLOSSEUM         49510000
              OR WS-SPORTS-LIC OR WS-RENAISSANCE                        49520000
WR0933        OR WS-LEVIS OR WS-TSHIRT-INT                              49530000
W41905        OR WS-JACMEL-JWL OR WS-GIII-LEATHER                       49540000
W42092        OR WS-PVH-SUPERBA                                         49550000
534202        OR WS-J-AMERICA                                           49560000
453643        OR WS-ETRNL-FRTN                                          49570000
494672        OR WS-HGGR-CLTING                                         49580000
686121        OR WS-WILL-DICKIE                                         49590000
371617        OR WS-NEW-ERACAP                                          49600000
505256        OR WS-NEW-MAIDENFORM                                      49610000
683003        OR WS-RANDA-ACCESSORIES                                   49620000
683026        OR WS-RANDA-CORP                                          49630000
944205        OR WS-BOELTER                                             49640000
002139        OR WS-GONZALS                                             49650000
647062        OR WS-LUXOTTICA                                           49660000
042023        OR WS-CC-PRODUCTS                                         49670000
018127        OR WS-TERVIS                                              49680000
356324        OR WS-PERRY                                               49690000
637834        OR WS-OURAY                                               49700000
185577        OR WS-BESPOKE                                             49710000
790723        OR WS-FGX                                                 49720000
956632        OR WS-RANDA                                               49730000
956632        OR WS-LOGO                                                49740000
956632        OR WS-GREAT-AMERICAN                                      49750000
346771        OR WS-MAD-ENGINE                                          49760000
265129        OR WS-HYBRID-PROM                                         49770000
887802        OR WS-BIO-WORLD                                           49780000
927044        OR WS-NORTH-WEST                                          49790000
925845        OR WS-BARE-FEET                                           49800000
762449        OR WS-MASTER-PUZZLE                                       49810000
889751        OR WS-RIPPLE-JUNCTION                                     49820000
064017        OR WS-LICHTENBERG                                         49830000
176716        OR WS-SPIRIT-LEATHERWORKS                                 49840000
176682        OR WS-TEE-SHIRT-CENTRAL                                   49850000
680553        OR WS-LF-MENS-GROUP-LLC                                   49851000
               MOVE WS-SHIP-DATE           TO POWS055-INPUT-DATE        49860000
           ELSE                                                         49870000
               MOVE WS-DB2-TIMESTAMP(1:10) TO POWS055-INPUT-DATE        49880000
           END-IF.                                                      49890000
                                                                        49900000
           PERFORM POPD055-CALC-WEEKLY-OTB.                             49910000
                                                                        49920000
           EVALUATE TRUE                                                49930000
               WHEN POWS055-INVALID-INPUT-DATE                          49940000
                    DISPLAY ' '                                         49950000
                    DISPLAY 'COULD NOT CALCULATE OTB DATE.  REASON:  '  49960000
                    DISPLAY '    INVALID INPUT DATE OF VALUE: '         49970000
                             POWS055-INPUT-DATE                         49980000
                                                                        49990000
               WHEN POWS055-BAD-SELECT-TO-TPOLDTM                       50000000
                    DISPLAY ' '                                         50010000
                    DISPLAY 'COULD NOT CALCULATE OTB DATE.  REASON:  '  50020000
                    DISPLAY '    BAD SELECT TO TPOLDTM.  SQL CODE: '    50030000
                             POWS055-SQLCODE                            50040000
                                                                        50050000
               WHEN POWS055-BAD-SELECT-TO-TDTATTR                       50060000
                    DISPLAY ' '                                         50070000
                    DISPLAY 'COULD NOT CALCULATE OTB DATE.  REASON:  '  50080000
                    DISPLAY '    BAD SELECT TO TDTATTR.  SQL CODE: '    50090000
                             POWS055-SQLCODE                            50100000
                                                                        50110000
               WHEN POWS055-NO-ERROR                                    50120000
                    MOVE POWS055-OTB-YEAR   TO                          50130000
                              PURCHS-OTB-PER-NBR(1:4)                   50140000
                    MOVE POWS055-OTB-MONTH  TO                          50150000
                              PURCHS-OTB-PER-NBR(5:2)                   50160000
           END-EVALUATE.                                                50170000
                                                                        50180000
           COPY POPD055.                                                50190000
                                                                        50200000
           COPY POPD056.                                                50210000
                                                                        50220000
                                                                        50230000
       18320-INSERT-TPURCHS.                                            50240000
                                                                        50250000
                                                                        50260000
           IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         50270000
               MOVE '18320-INSERT-TPURCHS' TO PV-PARAGRAPH-NAME         50280000
               GO TO 99999-DB2-ABEND                                    50290000
           END-IF.                                                      50300000
                                                                        50310000
           IF SQLCODE = ZERO                                            50320000
               ADD 1 TO WS-TPURCHS-INSERTED.                            50330000
                                                                        50340000
      *18330-DELETE-TPORESV.                                            50350000
      *                                                                 50360000
      *                                                                 50370000
      *    IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         50380000
      *        MOVE '18330-DELETE-TPORESV' TO PV-PARAGRAPH-NAME         50390000
      *        GO TO 99999-DB2-ABEND                                    50400000
      *    END-IF.                                                      50410000
                                                                        50420000
      * IF PO WAS FOUND, IT NEEDS TO BE DELETED FROM TPORESV            50430000
                                                                        50440000
       19000-COMMIT-PURCHASE-ORDER.                                     50450000
                                                                        50460000
           EXEC SQL                                                     50470000
                COMMIT                                                  50480000
           END-EXEC.                                                    50490000
                                                                        50500000
       20000-ROLLBACK-PURCHASE-ORDER.                                   50510000
                                                                        50520000
           EXEC SQL                                                     50530000
                ROLLBACK                                                50540000
           END-EXEC.                                                    50550000
                                                                        50560000
      *-----------------------------------------------------------      50570000
       30000-MQ-MESSAGE-ROUTER.                                         50580000
                                                                        50590000
           INITIALIZE PS-MQPUT-SUCCESSFUL-SW                            50600000
                      PV-MQPUT-RETRY-COUNTER                            50610000
                      PO026-RECORD.                                     50620000
                                                                        50630000
                                                                        50640000
           MOVE WS-PROGRAM-ID             TO PO026-PROGRAM.             50650000
           SET PO026-APPROVED-PO          TO TRUE.                      50660000
           EXEC SQL                                                     50670000
               SET :PV-LAST-UPD-TMESTMP   =  CURRENT TIMESTAMP          50680000
           END-EXEC.                                                    50690000
                                                                        50700000
           MOVE PV-LAST-UPD-TMESTMP(1:16) TO PO026-LAST-UPD-DTE.        50710000
           MOVE WS-PROGRAM-ID             TO PO026-LAST-UPD-ID.         50720000
                                                                        50730000
           MOVE PURCHS-PO-NBR             TO PO026-PO-NBR.              50740000
      *     PURCHS-PO-NBR IS INTEGER - CORREL-ID IS CHARACTER;          50750000
C98147*     WE ONLY WANT THE 8 CHARACTER PO NUMBER IN CORREL-ID         50760000
           MOVE PO026-PO-NBR              TO MQMD-CORRELID.             50770000
                                                                        50780000
           IF PS-HOLD-ENTRY-IN-LEGACY                                   50790000
              IF PS-TABLE-MQ-ERRORS                                     50800000
                PERFORM 30300-WRITE-MQ-ERROR                            50810000
              ELSE                                                      50820000
                PERFORM 30005-PUT-MQ-MESSAGE                            50830000
              END-IF                                                    50840000
           ELSE                                                         50850000
              PERFORM 30015-PUT-MQ-MESSAGE-API                          50860000
           END-IF.                                                      50870000
                                                                        50880000
      *-----------------------------------------------------------      50890000
       30005-PUT-MQ-MESSAGE.                                            50900000
                                                                        50910000
           MOVE CC-OUTPUT-QMGR-NAME       TO MQOD-OBJECTQMGRNAME.       50920000
           MOVE CC-OUTPUT-QUEUE-NAME      TO MQOD-OBJECTNAME.           50930000
           MOVE MQMI-NONE                 TO MQMD-MSGID.                50940000
           MOVE MQFMT-STRING              TO MQMD-FORMAT.               50950000
           MOVE MQPER-PERSISTENT          TO MQMD-PERSISTENCE.          50960000
           COMPUTE MQPMO-OPTIONS          =  MQPMO-SYNCPOINT.           50970000
                                                                        50980000
           PERFORM 30010-MQ-PUT-LOOP                                    50990000
             UNTIL PS-MQPUT-SUCCESSFUL                                  51000000
                OR PV-MQPUT-RETRY-COUNTER > PC-MAX-RETRIES.             51010000
                                                                        51020000
            IF PS-MQPUT-SUCCESSFUL                                      51030000
              PERFORM 30100-COMMIT-MQ-MESSAGE                           51040000
              ADD 1 TO WS-MQ-PO-MESSAGES                                51050000
            ELSE                                                        51060000
              SET PS-MQPUT-ERROR          TO TRUE                       51070000
              PERFORM 30200-BACK-OUT-MQ                                 51080000
              PERFORM 30300-WRITE-MQ-ERROR                              51090000
              SET PS-TABLE-MQ-ERRORS     TO TRUE                        51100000
           END-IF.                                                      51110000
                                                                        51120000
      *---------------------------------------------------------------- 51130000
       30010-MQ-PUT-LOOP.                                               51140000
                                                                        51150000
           CALL WS-MQPUT USING PV-HCONN                                 51160000
                               PV-PQ-HANDLE                             51170000
                               MQM-MESSAGE-DESCRIPTOR                   51180000
                               MQM-PUT-MESSAGE-OPTIONS                  51190000
                               PV-MSGBUFFER-LENGTH                      51200000
                               PO026-RECORD                             51210000
                               PV-COMPLETION-CODE                       51220000
                               PV-REASON.                               51230000
                                                                        51240000
      *        IF PUT FAILED THEN DISPLAY ERROR MESSAGE                 51250000
      *        AND BREAK OUT OF LOOP                                    51260000
                                                                        51270000
           IF (PV-COMPLETION-CODE = MQCC-OK)                            51280000
             SET PS-MQPUT-SUCCESSFUL TO TRUE                            51290000
           ELSE                                                         51300000
             IF PV-REASON = MQRC-PAGESET-FULL OR MQRC-Q-FULL            51310000
               ADD 1 TO PV-MQPUT-RETRY-COUNTER                          51320000
               IF PV-MQPUT-RETRY-COUNTER > PC-MAX-RETRIES               51330000
                 CONTINUE                                               51340000
               ELSE                                                     51350000
      **         WAIT FOR 5 SECONDS AND TRY AGAIN                       51360000
                 CALL WS-SYSWAIT USING PC-DELAY-INTERVAL                51370000
               END-IF                                                   51380000
             ELSE                                                       51390000
               COMPUTE PV-MQPUT-RETRY-COUNTER = PC-MAX-RETRIES + 1      51400000
             END-IF                                                     51410000
           END-IF.                                                      51420000
      *-----------------------------------------------------------      51430000
       30015-PUT-MQ-MESSAGE-API.                                        51440000
                                                                        51450000
           MOVE PV-STRING-POINTER-WHERE TO PV-STRING-LENGTH.            51460000
           MOVE PV-STRING-LENGTH  TO PV-MSGBUFFER-LENGTH-API.           51470000
           DISPLAY 'THE LENGTH OF THE PUT IS ' PV-STRING-LENGTH.        51480000
           COMPUTE PV-MSGBUFFER-LENGTH-API =                            51490000
                                            PV-MSGBUFFER-LENGTH-API - 1.51500000
                                                                        51510000
           MOVE CC-OUTPUT-QMGR-NAME-API   TO MQOA-OBJECTQMGRNAME.       51520000
           MOVE CC-OUTPUT-QUEUE-NAME-API  TO MQOA-OBJECTNAME.           51530000
           MOVE MQMI-NONE                 TO MQMA-MSGID.                51540000
           MOVE MQFMT-STRING              TO MQMA-FORMAT.               51550000
           MOVE MQPER-PERSISTENT          TO MQMA-PERSISTENCE.          51560000
           COMPUTE MQPMA-OPTIONS         =  MQPMA-SYNCPOINT.            51570000
                                                                        51580000
           INITIALIZE PS-MQPUT-SUCCESSFUL-SW-API.                       51590000
                                                                        51600000
           PERFORM 30020-MQ-PUT-API-MSG                                 51610000
             UNTIL PS-MQPUT-SUCCESSFUL-API                              51620000
                OR PV-MQPUT-RETRY-COUNTER > PC-MAX-RETRIES.             51630000
                                                                        51640000
           IF PS-MQPUT-SUCCESSFUL-API                                   51650000
             PERFORM 30120-COMMIT-MQ-MESSAGE-API                        51660000
             ADD 1 TO WS-MQ-PO-MESSAGES-API                             51670000
           ELSE                                                         51680000
              SET PS-MQPUT-ERROR-API        TO TRUE                     51690000
              PERFORM 30220-BACK-OUT-MQ-API                             51700000
              MOVE 'MQ PUT ERROR:'     TO PV-ERROR-LITERAL              51710000
              MOVE CC-OUTPUT-QMGR-NAME TO PV-ERROR-VARIABLE             51720000
              MOVE PV-ERROR            TO PV-ERROR-MESSAGE              51730000
              MOVE 'PV-COMPLETION-CODE '                                51740000
                                       TO PV-ERROR-LITERAL              51750000
              MOVE PV-COMPLETION-CODE  TO PV-ERROR-VARIABLE             51760000
              MOVE PV-ERROR            TO PV-ERROR-MESSAGE2             51770000
              MOVE '30020-MQ-PUT-API-MSG'                               51780000
                                       TO PV-PARAGRAPH-NAME             51790000
              PERFORM 99998-MQ-ABEND                                    51800000
           END-IF.                                                      51810000
                                                                        51820000
                                                                        51830000
       30020-MQ-PUT-API-MSG.                                            51840000
           MOVE MQCC-OK TO PV-COMPLETION-CODE.                          51850000
           CALL WS-MQPUT USING PV-HCONN                                 51860000
                               PV-PQ-HANDLE-API                         51870000
                               MQM-MESSAGE-DESCRIPTOR-API               51880000
                               MQM-PUT-MESSAGE-OPTIONS-API              51890000
                               PV-MSGBUFFER-LENGTH-API                  51900000
                               PV-STRING-CLAUSE                         51910000
                               PV-COMPLETION-CODE                       51920000
                               PV-REASON.                               51930000
                                                                        51940000
      *        IF PUT FAILED THEN DISPLAY ERROR MESSAGE                 51950000
      *        AND BREAK OUT OF LOOP                                    51960000
                                                                        51970000
           IF (PV-COMPLETION-CODE = MQCC-OK)                            51980000
             SET PS-MQPUT-SUCCESSFUL-API TO TRUE                        51990000
             DISPLAY 'PUT SUCCESSFUL FOR ' PO025-HDR-ORDER-NBR          52000000
           ELSE                                                         52010000
             IF PV-REASON = MQRC-PAGESET-FULL OR MQRC-Q-FULL            52020000
               ADD 1 TO PV-MQPUT-RETRY-COUNTER                          52030000
               IF PV-MQPUT-RETRY-COUNTER > PC-MAX-RETRIES               52040000
                 CONTINUE                                               52050000
               ELSE                                                     52060000
      **         WAIT FOR 5 SECONDS AND TRY AGAIN                       52070000
                 CALL WS-SYSWAIT USING PC-DELAY-INTERVAL                52080000
               END-IF                                                   52090000
             ELSE                                                       52100000
               COMPUTE PV-MQPUT-RETRY-COUNTER = PC-MAX-RETRIES + 1      52110000
             END-IF                                                     52120000
           END-IF.                                                      52130000
                                                                        52140000
      ******************************************************************52150000
      *  CALCULATE THE LENGTH OF THE OUTPUT MESSAGE                    *52160000
      ******************************************************************52170000
       30021-CALCULATE-MESSAGE-LENGTH.                                  52180000
                                                                        52190000
               COMPUTE PV-MSGBUFFER-LENGTH-API =                        52200000
                      (LENGTH OF PO025-MESSAGE-RECORD).                 52210000
                                                                        52220000
      ******************************************************************52230000
      *  COMMIT MQ PROCESSING SINCE THE POINT OF THE LAST COMMIT       *52240000
      ******************************************************************52250000
       30100-COMMIT-MQ-MESSAGE.                                         52260000
                                                                        52270000
           CALL WS-MQCMIT USING PV-HCONN                                52280000
                                PV-COMPLETION-CODE                      52290000
                                PV-REASON.                              52300000
                                                                        52310000
           IF (PV-COMPLETION-CODE NOT = MQCC-OK) THEN                   52320000
               DISPLAY 'MQCMIT ERROR: '  CC-OUTPUT-QUEUE-NAME           52330000
               SET PS-TABLE-MQ-ERRORS   TO TRUE                         52340000
           END-IF.                                                      52350000
                                                                        52360000
      ******************************************************************52370000
      *  COMMIT MQ-API PROCESSING SINCE THE POINT OF THE LAST COMMIT   *52380000
      ******************************************************************52390000
       30120-COMMIT-MQ-MESSAGE-API.                                     52400000
                                                                        52410000
           CALL WS-MQCMIT USING PV-HCONN                                52420000
                                PV-COMPLETION-CODE                      52430000
                                PV-REASON.                              52440000
                                                                        52450000
           IF (PV-COMPLETION-CODE NOT = MQCC-OK) THEN                   52460000
              MOVE '30120-COMMIT-MQ-MESSAGE-API' TO PV-PARAGRAPH-NAME   52470000
              MOVE 'MQCMIT ERROR'          TO PV-ERROR-MESSAGE          52480000
              MOVE SPACES                  TO PV-ERROR-MESSAGE2         52490000
              MOVE PV-COMPLETION-CODE      TO PV-SAVE-COMPLETION-CODE   52500000
              MOVE PV-REASON               TO PV-SAVE-REASON            52510000
              PERFORM 30200-BACK-OUT-MQ                                 52520000
              MOVE PV-SAVE-COMPLETION-CODE TO PV-COMPLETION-CODE        52530000
              MOVE PV-SAVE-REASON          TO PV-REASON                 52540000
              PERFORM 99998-MQ-ABEND                                    52550000
           END-IF.                                                      52560000
                                                                        52570000
      ******************************************************************52580000
      * BACK OUT MQ PROCESSING SINCE THE POINT OF THE LAST COMMIT      *52590000
      ******************************************************************52600000
       30200-BACK-OUT-MQ.                                               52610000
                                                                        52620000
           CALL WS-MQBACK USING PV-HCONN                                52630000
                                PV-COMPLETION-CODE                      52640000
                                PV-REASON.                              52650000
                                                                        52660000
           IF (PV-COMPLETION-CODE NOT = MQCC-OK) THEN                   52670000
              MOVE '30200-BACK-OUT-MQ' TO PV-PARAGRAPH-NAME             52680000
              MOVE 'MQBACK ERROR'      TO PV-ERROR-MESSAGE              52690000
              MOVE SPACES              TO PV-ERROR-MESSAGE2             52700000
              PERFORM 99998-MQ-ABEND                                    52710000
           ELSE                                                         52720000
              DISPLAY 'BACKOUT SUCCESSFUL'                              52730000
           END-IF.                                                      52740000
                                                                        52750000
      ******************************************************************52760000
      * BACK OUT MQ-API PROCESSING SINCE THE POINT OF THE LAST COMMIT  *52770000
      ******************************************************************52780000
       30220-BACK-OUT-MQ-API.                                           52790000
                                                                        52800000
           CALL WS-MQBACK USING PV-HCONN                                52810000
                                PV-COMPLETION-CODE                      52820000
                                PV-REASON                               52830000
                                                                        52840000
           IF (PV-COMPLETION-CODE NOT = MQCC-OK) THEN                   52850000
               DISPLAY 'MQBACK ERROR: ' CC-OUTPUT-QUEUE-NAME-API        52860000
           END-IF.                                                      52870000
                                                                        52880000
      ******************************************************************52890000
                                                                        52900000
        30300-WRITE-MQ-ERROR.                                           52910000
           PERFORM 30400-GET-MAX-ERROR-SEQUENCE.                        52920000
           IF PS-HOLD-ENTRY-IN-LEGACY                                   52930000
               PERFORM 30500-FORMAT-POT-DB2-MQ-ERR                      52940000
               PERFORM 30600-INSERT-POT-DB2-MQ-ERR                      52950000
           END-IF.                                                      52960000
           MOVE 'N' TO PS-MQPUT-ERROR-SW.                               52970000
                                                                        52980000
      ******************************************************************52990000
                                                                        53000000
       30400-GET-MAX-ERROR-SEQUENCE.                                    53010000
                                                                        53020000
           PERFORM                                                      53030000
               WITH TEST AFTER                                          53040000
               VARYING PV-RETRY-COUNTER                                 53050000
               FROM 1 BY 1                                              53060000
               UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               53070000
                   OR (SQLCODE = +0)                                    53080000
                   OR (SQLCODE = -305))                                 53090000
                                                                        53100000
               EXEC SQL                                                 53110000
                    SELECT MAX(PRCG_SEQ)                                53120000
                      INTO :PV-MAX-PRCG-SEQ                             53130000
                      FROM POT_DB2_MQ_ERR                               53140000
P41269              WITH UR                                             53150000
               END-EXEC                                                 53160000
                                                                        53170000
               EVALUATE TRUE                                            53180000
                   WHEN SQLCODE = +0                                    53190000
                        COMPUTE PV-NEXT-PRCG-SEQ =                      53200000
                                PV-MAX-PRCG-SEQ + 1                     53210000
                                                                        53220000
                   WHEN SQLCODE = -305                                  53230000
                        MOVE +1         TO PV-NEXT-PRCG-SEQ             53240000
                                                                        53250000
                   WHEN SQLCODE = -904                                  53260000
                   WHEN SQLCODE = -913                                  53270000
                        CONTINUE                                        53280000
                                                                        53290000
                   WHEN SQLWARN0 NOT = SPACES                           53300000
                   WHEN SQLCODE < +0                                    53310000
                   WHEN SQLCODE > +0                                    53320000
                        MOVE '30400-GET-MAX-ERROR-SEQUENCE'             53330000
                                        TO PV-PARAGRAPH-NAME            53340000
                        GO TO 99999-DB2-ABEND                           53350000
               END-EVALUATE                                             53360000
           END-PERFORM.                                                 53370000
                                                                        53380000
           IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        53390000
               MOVE '30400-GET-MAX-ERROR-SEQUENCE'                      53400000
                                         TO PV-PARAGRAPH-NAME           53410000
               GO TO 99999-DB2-ABEND                                    53420000
           END-IF.                                                      53430000
                                                                        53440000
      *----------------------------------------------------------------*53450000
      *    FORMAT A ROW TO BE INSERTED TO THE PO MQ ERROR TABLE        *53460000
      *----------------------------------------------------------------*53470000
                                                                        53480000
       30500-FORMAT-POT-DB2-MQ-ERR.                                     53490000
           IF PS-BRIDGE-BACKOUT-MODE                                    53500000
250900         MOVE PV-NEXT-PRCG-SEQ    TO POT00002-PRCG-SEQ            53510000
251000         MOVE 'S'                 TO POT00002-ERR-TYP-CDE         53520000
251100         MOVE PURCHS-PO-NBR       TO POT00002-PO-NBR              53530000
251200         MOVE SPACES              TO POT00002-MSG-TXT-TEXT        53540000
251300         MOVE ZEROES              TO POT00002-MSG-TXT-LEN         53550000
           ELSE                                                         53560000
               MOVE PV-NEXT-PRCG-SEQ    TO POT00002-PRCG-SEQ            53570000
               MOVE PC-MQ-SERIES-ERROR  TO POT00002-ERR-TYP-CDE         53580000
               MOVE PURCHS-PO-NBR       TO POT00002-PO-NBR              53590000
               MOVE PO026-RECORD(1:PV-MSGBUFFER-LENGTH)                 53600000
                                        TO POT00002-MSG-TXT-TEXT        53610000
               MOVE PV-MSGBUFFER-LENGTH TO POT00002-MSG-TXT-LEN         53620000
           END-IF.                                                      53630000
                                                                        53640000
      *----------------------------------------------------------------*53650000
      *    INSERT A ROW TO THE PO MQ ERROR TABLE                       *53660000
      *----------------------------------------------------------------*53670000
                                                                        53680000
       30600-INSERT-POT-DB2-MQ-ERR.                                     53690000
                                                                        53700000
                                                                        53710000
      *--------------------------------------------------------------   53720000
       30700-CHECK-MQ-ERROR-TABLE.                                      53730000
                                                                        53740000
           INITIALIZE PV-MQ-ERR-ROW-COUNT.                              53750000
                                                                        53760000
           PERFORM                                                      53770000
               WITH TEST AFTER                                          53780000
               VARYING PV-RETRY-COUNTER                                 53790000
               FROM 1 BY 1                                              53800000
               UNTIL (PV-RETRY-COUNTER > PC-MAX-RETRIES)                53810000
                   OR (SQLCODE = +0)                                    53820000
                                                                        53830000
               EXEC SQL                                                 53840000
                    SELECT   COUNT(*)                                   53850000
                      INTO  :PV-MQ-ERR-ROW-COUNT                        53860000
                      FROM   POT_DB2_MQ_ERR                             53870000
                      WHERE  ERR_TYP_CDE = 'M'                          53880000
P41269              WITH UR                                             53890000
               END-EXEC                                                 53900000
                                                                        53910000
               EVALUATE TRUE                                            53920000
                                                                        53930000
                   WHEN SQLCODE = +0                                    53940000
                   WHEN SQLCODE = -904                                  53950000
                   WHEN SQLCODE = -913                                  53960000
                        CONTINUE                                        53970000
                                                                        53980000
                   WHEN SQLWARN0 NOT = SPACES                           53990000
                   WHEN SQLCODE < +0                                    54000000
                   WHEN SQLCODE > +0                                    54010000
                       MOVE '30700-CHECK-MQ-ERROR-TABLE'                54020000
                                         TO PV-PARAGRAPH-NAME           54030000
                       PERFORM 99999-DB2-ABEND                          54040000
               END-EVALUATE                                             54050000
           END-PERFORM.                                                 54060000
                                                                        54070000
           IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        54080000
               MOVE '30700-CHECK-MQ-ERROR-TABLE'                        54090000
                                         TO PV-PARAGRAPH-NAME           54100000
               PERFORM 99999-DB2-ABEND                                  54110000
           END-IF.                                                      54120000
                                                                        54130000
      *--------------------------------------------------------------   54140000
       30800-CHECK-FOR-BRIDGE-BACKOUT.                                  54150000
           MOVE 'N' TO PS-BRIDGE-BACKOUT-MODE-SW.                       54160000
                                                                        54170000
           PERFORM                                                      54180000
               WITH TEST AFTER                                          54190000
               VARYING PV-RETRY-COUNTER                                 54200000
               FROM 1 BY 1                                              54210000
               UNTIL (PV-RETRY-COUNTER > PC-MAX-RETRIES)                54220000
                   OR (SQLCODE = +0)                                    54230000
                   OR (SQLCODE = +100)                                  54240000
                   OR (SQLCODE = -305)                                  54250000
                                                                        54260000
               EXEC SQL                                                 54270000
                    SELECT   MAX(ERR_TYP_CDE)                           54280000
                      INTO  :POT00002-ERR-TYP-CDE                       54290000
                      FROM   POT_DB2_MQ_ERR                             54300000
                      WHERE  ERR_TYP_CDE IN ('T','S')                   54310000
                      AND    PO_NBR = 0                                 54320000
P41269              WITH UR                                             54330000
               END-EXEC                                                 54340000
                                                                        54350000
               EVALUATE TRUE                                            54360000
                                                                        54370000
                   WHEN SQLCODE = +0                                    54380000
                       SET PS-BRIDGE-BACKOUT-MODE TO TRUE               54390000
                                                                        54400000
                   WHEN SQLCODE = +100                                  54410000
                   WHEN SQLCODE = -305                                  54420000
                   WHEN SQLCODE = -904                                  54430000
                   WHEN SQLCODE = -913                                  54440000
                        CONTINUE                                        54450000
                                                                        54460000
                   WHEN SQLWARN0 NOT = SPACES                           54470000
                   WHEN SQLCODE < +0                                    54480000
                   WHEN SQLCODE > +0                                    54490000
                       MOVE '30800-CHECK-FOR-BRIDGE-BACKOUT'            54500000
                                         TO PV-PARAGRAPH-NAME           54510000
                       PERFORM 99999-DB2-ABEND                          54520000
               END-EVALUATE                                             54530000
           END-PERFORM.                                                 54540000
                                                                        54550000
           IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        54560000
               MOVE '30800-CHECK-FOR-BRIDGE-BACKOUT'                    54570000
                                         TO PV-PARAGRAPH-NAME           54580000
               PERFORM 99999-DB2-ABEND                                  54590000
           END-IF.                                                      54600000
                                                                        54610000
      *--------------------------------------------------------------   54620000
       30900-CHECK-FOR-PO-S-ROW.                                        54630000
           MOVE 'N' TO PS-PO-HAS-S-ROW-SW.                              54640000
                                                                        54650000
           PERFORM                                                      54660000
               WITH TEST AFTER                                          54670000
               VARYING PV-RETRY-COUNTER                                 54680000
               FROM 1 BY 1                                              54690000
               UNTIL (PV-RETRY-COUNTER > PC-MAX-RETRIES)                54700000
                   OR (SQLCODE = +0)                                    54710000
                   OR (SQLCODE = +100)                                  54720000
                   OR (SQLCODE = -305)                                  54730000
                                                                        54740000
               EXEC SQL                                                 54750000
                    SELECT 'Y'                                          54760000
                      INTO :PS-PO-HAS-S-ROW-SW                          54770000
                      FROM  SYSIBM.SYSDUMMY1 X                          54780000
                     WHERE  EXISTS                                      54790000
                        (SELECT *                                       54800000
                           FROM  POT_DB2_MQ_ERR                         54810000
                          WHERE ERR_TYP_CDE = 'S'                       54820000
                            AND PO_NBR = :PURCHS-PO-NBR                 54830000
                            AND X.IBMREQD = X.IBMREQD)                  54840000
P41269              WITH UR                                             54850000
               END-EXEC                                                 54860000
                                                                        54870000
               EVALUATE TRUE                                            54880000
                                                                        54890000
                   WHEN SQLCODE = +0                                    54900000
                   WHEN SQLCODE = +100                                  54910000
                   WHEN SQLCODE = -305                                  54920000
                   WHEN SQLCODE = -904                                  54930000
                   WHEN SQLCODE = -913                                  54940000
                        CONTINUE                                        54950000
                                                                        54960000
                   WHEN SQLWARN0 NOT = SPACES                           54970000
                   WHEN SQLCODE < +0                                    54980000
                   WHEN SQLCODE > +0                                    54990000
                       MOVE '30900-CHECK-FOR-PO-S-ROW'                  55000000
                                         TO PV-PARAGRAPH-NAME           55010000
                       PERFORM 99999-DB2-ABEND                          55020000
               END-EVALUATE                                             55030000
           END-PERFORM.                                                 55040000
                                                                        55050000
           IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        55060000
               MOVE '30900-CHECK-FOR-PO-S-ROW'                          55070000
                                         TO PV-PARAGRAPH-NAME           55080000
               PERFORM 99999-DB2-ABEND                                  55090000
           END-IF.                                                      55100000
                                                                        55110000
      *--------------------------------------------------------------   55120000
       40000-CHECK-DEPT-ROLLOUT.                                        55130000
           MOVE 'N'             TO PS-DEPT-ROLLOUT-SW.                  55140000
           MOVE WS-DEPT-NBR     TO POT00006-DEPT-NBR.                   55150000
                                                                        55160000
           PERFORM                                                      55170000
               WITH TEST AFTER                                          55180000
               VARYING PV-RETRY-COUNTER                                 55190000
               FROM 1 BY 1                                              55200000
               UNTIL (PV-RETRY-COUNTER > PC-MAX-RETRIES)                55210000
                   OR (SQLCODE = +0)                                    55220000
                   OR (SQLCODE = +100)                                  55230000
                   OR (SQLCODE = -305)                                  55240000
                                                                        55250000
               EXEC SQL                                                 55260000
                    SELECT 'Y'                                          55270000
                      INTO :PS-DEPT-ROLLOUT-SW                          55280000
                      FROM  SYSIBM.SYSDUMMY1 X                          55290000
                     WHERE  EXISTS                                      55300000
                        (SELECT *                                       55310000
                           FROM POT_RMS_RLOUT_CTL                       55320000
                          WHERE DEPT_NBR         = :POT00006-DEPT-NBR   55330000
                            AND X.IBMREQD        =  X.IBMREQD)          55340000
P41269              WITH UR                                             55350000
               END-EXEC                                                 55360000
                                                                        55370000
               EVALUATE TRUE                                            55380000
                                                                        55390000
                   WHEN SQLCODE = +0                                    55400000
                   WHEN SQLCODE = +100                                  55410000
                   WHEN SQLCODE = -305                                  55420000
                   WHEN SQLCODE = -904                                  55430000
                   WHEN SQLCODE = -913                                  55440000
                        CONTINUE                                        55450000
                                                                        55460000
                   WHEN SQLWARN0 NOT = SPACES                           55470000
                   WHEN SQLCODE < +0                                    55480000
                   WHEN SQLCODE > +0                                    55490000
                       MOVE '40000-CHECK-DEPT-ROLLOUT'                  55500000
                                         TO PV-PARAGRAPH-NAME           55510000
                       PERFORM 99999-DB2-ABEND                          55520000
               END-EVALUATE                                             55530000
           END-PERFORM.                                                 55540000
                                                                        55550000
           IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        55560000
               MOVE '40000-CHECK-DEPT-ROLLOUT'                          55570000
                                 TO PV-PARAGRAPH-NAME                   55580000
               PERFORM 99999-DB2-ABEND                                  55590000
           END-IF.                                                      55600000
                                                                        55610000
      *--------------------------------------------------------------   55620000
       96000-FORMAT-ERROR-INFO.                                         55630000
                                                                        55640000
           MOVE PV-ISA-CNTL-NBR TO ERR-RPT-D3-ISA-CNTL-NBR              55650000
           IF VNDDPT-ENT-ID NOT EQUAL ZERO                              55660000
              PERFORM 15101-GET-REPORT-HEADER-INFO                      55670000
           ELSE                                                         55680000
              EVALUATE WS-CURR-INTERCHANGE                              55690000
                  WHEN '086119230000'                                   55700000
                       MOVE '003'              TO ERR-RPT-D1-BUYER-NBR  55710000
                       MOVE 'GARY LEWANDOWSKI' TO ERR-RPT-D1-BUYER-NAME 55720000
                       MOVE '003949435'        TO ERR-RPT-D2-VENDOR-NBR 55730000
                       MOVE 'HALLMARK MARKETING CORP' TO                55740000
                                                  ERR-RPT-D2-VENDOR-NAME55750000
                  WHEN 'ZZHDLEKOHL'                                     55760000
                       MOVE '015'              TO ERR-RPT-D1-BUYER-NBR  55770000
                       MOVE 'GARY NICKOLIE'    TO ERR-RPT-D1-BUYER-NAME 55780000
                       MOVE '006958243'        TO ERR-RPT-D2-VENDOR-NBR 55790000
                       MOVE 'HANDLEMAN COMPANY' TO                      55800000
                                                  ERR-RPT-D2-VENDOR-NAME55810000
                  WHEN '01067429365'                                    55820000
                       MOVE '022'              TO ERR-RPT-D1-BUYER-NBR  55830000
                       MOVE 'JANE LARSON'      TO ERR-RPT-D1-BUYER-NAME 55840000
                       MOVE '053189627'        TO ERR-RPT-D2-VENDOR-NBR 55850000
                       MOVE 'HANES HOSIERY'    TO ERR-RPT-D2-VENDOR-NAME55860000
                                                                        55870000
                  WHEN '086111970038'                                   55880000
                       MOVE '003'              TO ERR-RPT-D1-BUYER-NBR  55890000
                       MOVE 'GARY LEWANDOWSKI' TO ERR-RPT-D1-BUYER-NAME 55900000
                       MOVE '000384198'        TO ERR-RPT-D2-VENDOR-NBR 55910000
                       MOVE 'INTERCRAFT COMPANY' TO                     55920000
                                               ERR-RPT-D2-VENDOR-NAME   55930000
                  WHEN '010419368400'                                   55940000
                       MOVE '036'              TO ERR-RPT-D1-BUYER-NBR  55950000
                       MOVE 'PHYLLIS GORELL'   TO ERR-RPT-D1-BUYER-NAME 55960000
                       MOVE '041936840'        TO ERR-RPT-D2-VENDOR-NBR 55970000
                       MOVE 'JOCKEY INTERNATIONAL INC' TO               55980000
                                                  ERR-RPT-D2-VENDOR-NAME55990000
                  WHEN '086111151100'                                   56000000
                       MOVE '036'              TO ERR-RPT-D1-BUYER-NBR  56010000
                       MOVE 'PHYLLIS GORELL'   TO ERR-RPT-D1-BUYER-NAME 56020000
                       MOVE '001212836'        TO ERR-RPT-D2-VENDOR-NBR 56030000
                       MOVE 'SARA LEE INTIMATES' TO                     56040000
                                                  ERR-RPT-D2-VENDOR-NAME56050000
                  WHEN '01076735463'                                    56060000
                       MOVE '003'              TO ERR-RPT-D1-BUYER-NBR  56070000
                       MOVE 'GARY LEWANDOWSKI' TO ERR-RPT-D1-BUYER-NAME 56080000
                       MOVE '076735463'        TO ERR-RPT-D2-VENDOR-NBR 56090000
                       MOVE 'CARLTON CARDS'    TO                       56100000
                                                  ERR-RPT-D2-VENDOR-NAME56110000
                  WHEN '124154571577'                                   56120000
                       MOVE '151'              TO ERR-RPT-D1-BUYER-NBR  56130000
                       MOVE 'TAMMY LITZAU'     TO ERR-RPT-D1-BUYER-NAME 56140000
                       MOVE '009207739'        TO ERR-RPT-D2-VENDOR-NBR 56150000
                       MOVE 'MULBERRY NECKWEAR' TO                      56160000
                                                  ERR-RPT-D2-VENDOR-NAME56170000
                  WHEN '01002344208'                                    56180000
                       MOVE '034'            TO ERR-RPT-D1-BUYER-NBR    56190000
                       MOVE 'PHYLLIS GORELL' TO ERR-RPT-D1-BUYER-NAME   56200000
                       MOVE '003919446'      TO ERR-RPT-D2-VENDOR-NBR   56210000
                       MOVE 'VANITY FAIR      ' TO                      56220000
                                                  ERR-RPT-D2-VENDOR-NAME56230000
                  WHEN '01031360197'                                    56240000
                       MOVE '034'              TO ERR-RPT-D1-BUYER-NBR  56250000
                       MOVE 'PHYLLIS GORELL'   TO ERR-RPT-D1-BUYER-NAME 56260000
                       MOVE '003919446'        TO ERR-RPT-D2-VENDOR-NBR 56270000
                       MOVE 'LILY OF FRANCE   ' TO                      56280000
                                                  ERR-RPT-D2-VENDOR-NAME56290000
                  WHEN '01143367634'                                    56300000
                       MOVE '033'              TO ERR-RPT-D1-BUYER-NBR  56310000
                       MOVE 'JULIE SILHOL'     TO ERR-RPT-D1-BUYER-NAME 56320000
                       MOVE '000882225'        TO ERR-RPT-D2-VENDOR-NBR 56330000
                       MOVE 'ESTEE LAUDER     ' TO                      56340000
                                                  ERR-RPT-D2-VENDOR-NAME56350000
                  WHEN '086116630000'                                   56360000
                  WHEN '086116630050'                                   56370000
                       MOVE '???'              TO ERR-RPT-D1-BUYER-NBR  56380000
                       MOVE '????????????'     TO ERR-RPT-D1-BUYER-NAME 56390000
                       MOVE '000320432'        TO ERR-RPT-D2-VENDOR-NBR 56400000
                       MOVE 'LIZ CLAIBORNE    ' TO                      56410000
                                                  ERR-RPT-D2-VENDOR-NAME56420000
                  WHEN '01007131501'                                    56430000
                       MOVE '???'              TO ERR-RPT-D1-BUYER-NBR  56440000
                       MOVE 'WHORRAL/MAASCH'   TO ERR-RPT-D1-BUYER-NAME 56450000
                       MOVE '003919446'        TO ERR-RPT-D2-VENDOR-NBR 56460000
                       MOVE 'LEE CO/WRANGLER  ' TO                      56470000
                                                  ERR-RPT-D2-VENDOR-NAME56480000
                  WHEN '012270726'                                      56490000
                       MOVE '???'              TO ERR-RPT-D1-BUYER-NBR  56500000
                       MOVE '??????????????'   TO ERR-RPT-D1-BUYER-NAME 56510000
                       MOVE '078635307'        TO ERR-RPT-D2-VENDOR-NBR 56520000
                       MOVE 'FISHMAN & TOBIN INC' TO                    56530000
                                                  ERR-RPT-D2-VENDOR-NAME56540000
                                                                        56550000
CHGID *           WHEN '122035798435'                                   56560000
CHGID *           WHEN '128187827568'                                   56570000
CHGID             WHEN '084229981500'                                   56580000
                       MOVE '???'              TO ERR-RPT-D1-BUYER-NBR  56590000
                       MOVE '????????????'     TO ERR-RPT-D1-BUYER-NAME 56600000
                       MOVE '?????????'        TO ERR-RPT-D2-VENDOR-NBR 56610000
                       MOVE 'OLGA/WARNER      ' TO                      56620000
                                                  ERR-RPT-D2-VENDOR-NAME56630000
                  WHEN '1213026746000'                                  56640000
                       MOVE '036'              TO ERR-RPT-D1-BUYER-NBR  56650000
                       MOVE 'T. WESTING  '     TO ERR-RPT-D1-BUYER-NAME 56660000
                       MOVE '001941988'        TO ERR-RPT-D2-VENDOR-NBR 56670000
                       MOVE 'PLAYTEX          ' TO                      56680000
                                               ERR-RPT-D2-VENDOR-NAME   56690000
                  WHEN '086111151100'                                   56700000
                       MOVE '???'              TO ERR-RPT-D1-BUYER-NBR  56710000
                       MOVE 'T. WESTING  '     TO ERR-RPT-D1-BUYER-NAME 56720000
                       MOVE '001212836'        TO ERR-RPT-D2-VENDOR-NBR 56730000
                       MOVE 'BALI             ' TO                      56740000
                                                  ERR-RPT-D2-VENDOR-NAME56750000
                  WHEN '129105196395'                                   56760000
                       MOVE '036'              TO ERR-RPT-D1-BUYER-NBR  56770000
                       MOVE 'T. WESTING  '     TO ERR-RPT-D1-BUYER-NAME 56780000
                       MOVE '042590087'        TO ERR-RPT-D2-VENDOR-NBR 56790000
                       MOVE 'WONDERBRA        ' TO                      56800000
                                                  ERR-RPT-D2-VENDOR-NAME56810000
                  WHEN '124053609856'                                   56820000
                       MOVE '???'              TO ERR-RPT-D1-BUYER-NBR  56830000
                       MOVE '????????????'     TO ERR-RPT-D1-BUYER-NAME 56840000
                       MOVE '197552482'        TO ERR-RPT-D2-VENDOR-NBR 56850000
                       MOVE 'TOP OF THE WORLD ' TO                      56860000
                                                  ERR-RPT-D2-VENDOR-NAME56870000
                  WHEN '086126930000'                                   56880000
                       MOVE '???'              TO ERR-RPT-D1-BUYER-NBR  56890000
                       MOVE '????????????'     TO ERR-RPT-D1-BUYER-NAME 56900000
                       MOVE '000989053'        TO ERR-RPT-D2-VENDOR-NBR 56910000
                       MOVE 'VF IMAGEWEAR     ' TO                      56920000
                                                  ERR-RPT-D2-VENDOR-NAME56930000
                  WHEN '128649689682'                                   56940000
                       MOVE '019'              TO ERR-RPT-D1-BUYER-NBR  56950000
                       MOVE 'B. COUEY    '     TO ERR-RPT-D1-BUYER-NAME 56960000
                       MOVE '019223390'        TO ERR-RPT-D2-VENDOR-NBR 56970000
                       MOVE 'KNIGHTS APPAREL  ' TO                      56980000
                                                  ERR-RPT-D2-VENDOR-NAME56990000
                  WHEN '122605632187'                                   57000000
                       MOVE '019'              TO ERR-RPT-D1-BUYER-NBR  57010000
                       MOVE 'BRYANT COUEY'     TO ERR-RPT-D1-BUYER-NAME 57020000
                       MOVE '364143198'        TO ERR-RPT-D2-VENDOR-NBR 57030000
                       MOVE 'NEXT INC         ' TO                      57040000
                                                  ERR-RPT-D2-VENDOR-NAME57050000
                  WHEN '086174371385'                                   57060000
                       MOVE '019'              TO ERR-RPT-D1-BUYER-NBR  57070000
                       MOVE 'BRYANT COUEY'     TO ERR-RPT-D1-BUYER-NAME 57080000
                       MOVE '000524397'        TO ERR-RPT-D2-VENDOR-NBR 57090000
352053                 MOVE '47BRAND LLC      ' TO                      57100000
                                                  ERR-RPT-D2-VENDOR-NAME57110000
                  WHEN 'ZZPERRYGEGP'                                    57120000
                       MOVE '???'              TO ERR-RPT-D1-BUYER-NBR  57130000
                       MOVE '????????????'     TO ERR-RPT-D1-BUYER-NAME 57140000
                       MOVE '44029452'         TO ERR-RPT-D2-VENDOR-NBR 57150000
                       MOVE 'SUPREME INTL     ' TO                      57160000
                                                  ERR-RPT-D2-VENDOR-NAME57170000
                  WHEN '01004637980'                                    57180000
                       MOVE '019'              TO ERR-RPT-D1-BUYER-NBR  57190000
                       MOVE 'BRYANT COUEY'     TO ERR-RPT-D1-BUYER-NAME 57200000
                       MOVE '144637980'        TO ERR-RPT-D2-VENDOR-NBR 57210000
                       MOVE 'COLLEGE CONCEPTS ' TO                      57220000
                                                  ERR-RPT-D2-VENDOR-NAME57230000
                  WHEN '086111770002'                                   57240000
                       MOVE '???'              TO ERR-RPT-D1-BUYER-NBR  57250000
                       MOVE '????????????'     TO ERR-RPT-D1-BUYER-NAME 57260000
                       MOVE '3395902'          TO ERR-RPT-D2-VENDOR-NBR 57270000
                       MOVE 'RUSSELL ATHLETIC ' TO                      57280000
                                                  ERR-RPT-D2-VENDOR-NAME57290000
                  WHEN '01001334036'                                    57300000
                       MOVE '???'              TO ERR-RPT-D1-BUYER-NBR  57310000
                       MOVE '????????????'     TO ERR-RPT-D1-BUYER-NAME 57320000
                       MOVE '378893'           TO ERR-RPT-D2-VENDOR-NBR 57330000
                       MOVE 'OUTER STUFF ' TO                           57340000
                                                  ERR-RPT-D2-VENDOR-NAME57350000
                  WHEN '14037794872C'                                   57360000
                       MOVE '???'              TO ERR-RPT-D1-BUYER-NBR  57370000
                       MOVE '????????????'     TO ERR-RPT-D1-BUYER-NAME 57380000
                       MOVE '37794872'         TO ERR-RPT-D2-VENDOR-NBR 57390000
                       MOVE 'HADDAD ' TO                                57400000
                                                  ERR-RPT-D2-VENDOR-NAME57410000
                  WHEN '123365192222'                                   57420000
                       MOVE '???'              TO ERR-RPT-D1-BUYER-NBR  57430000
                       MOVE '????????????'     TO ERR-RPT-D1-BUYER-NAME 57440000
                       MOVE '3213188'          TO ERR-RPT-D2-VENDOR-NBR 57450000
                       MOVE 'HANES UNDERWEAR'  TO                       57460000
                                                  ERR-RPT-D2-VENDOR-NAME57470000
                  WHEN '126129445069'                                   57480000
                       MOVE '???'              TO ERR-RPT-D1-BUYER-NBR  57490000
                       MOVE '????????????'     TO ERR-RPT-D1-BUYER-NAME 57500000
                       MOVE '127640931'        TO ERR-RPT-D2-VENDOR-NBR 57510000
                       MOVE 'COKEM  ' TO                                57520000
                                                  ERR-RPT-D2-VENDOR-NAME57530000
                  WHEN '129136933200'                                   57540000
575459            WHEN '129139423258'                                   57550000
                       MOVE '???'              TO ERR-RPT-D1-BUYER-NBR  57560000
                       MOVE '????????????'     TO ERR-RPT-D1-BUYER-NAME 57570000
                       MOVE '679639671'        TO ERR-RPT-D2-VENDOR-NBR 57580000
                       MOVE 'GEAR FOR SPORTS' TO                        57590000
                                                  ERR-RPT-D2-VENDOR-NAME57600000
                  WHEN '129136933996'                                   57610000
                       MOVE '???'              TO ERR-RPT-D1-BUYER-NBR  57620000
                       MOVE '????????????'     TO ERR-RPT-D1-BUYER-NAME 57630000
                       MOVE '18487707'         TO ERR-RPT-D2-VENDOR-NBR 57640000
                       MOVE 'CHAMP. CUSTOM  ' TO                        57650000
                                                  ERR-RPT-D2-VENDOR-NAME57660000
                  WHEN '01833753478'                                    57670000
714055            WHEN '01833753478N'                                   57680000
                       MOVE '???'              TO ERR-RPT-D1-BUYER-NBR  57690000
                       MOVE '????????????'     TO ERR-RPT-D1-BUYER-NAME 57700000
                       MOVE '833753478'        TO ERR-RPT-D2-VENDOR-NBR 57710000
                       MOVE 'COLOSSEUM ATH. ' TO                        57720000
                                                  ERR-RPT-D2-VENDOR-NAME57730000
                  WHEN '01053736070'                                    57740000
                       MOVE '???'              TO ERR-RPT-D1-BUYER-NBR  57750000
                       MOVE '????????????'     TO ERR-RPT-D1-BUYER-NAME 57760000
                       MOVE '1051671  '        TO ERR-RPT-D2-VENDOR-NBR 57770000
                       MOVE 'SPORTS LICEN...' TO                        57780000
                                                  ERR-RPT-D2-VENDOR-NAME57790000
                  WHEN '127048211005'                                   57800000
                       MOVE '???'              TO ERR-RPT-D1-BUYER-NBR  57810000
                       MOVE '????????????'     TO ERR-RPT-D1-BUYER-NAME 57820000
WR9604                 MOVE '001120807'        TO ERR-RPT-D2-VENDOR-NBR 57830000
                       MOVE 'RENAISSANCE IMP' TO                        57840000
                                                  ERR-RPT-D2-VENDOR-NAME57850000
WR9604            WHEN '086111190003'                                   57860000
WR9604                 MOVE '???'              TO ERR-RPT-D1-BUYER-NBR  57870000
WR9604                 MOVE '????????????'     TO ERR-RPT-D1-BUYER-NAME 57880000
WR9604                 MOVE '009109273'        TO ERR-RPT-D2-VENDOR-NBR 57890000
WR9604                 MOVE 'LEVI STRAUSS & CO' TO                      57900000
                                                  ERR-RPT-D2-VENDOR-NAME57910000
WR0933            WHEN '123045622401'                                   57920000
WR0933                 MOVE '???'              TO ERR-RPT-D1-BUYER-NBR  57930000
WR0933                 MOVE '????????????'     TO ERR-RPT-D1-BUYER-NAME 57940000
WR0933                 MOVE '000985424'        TO ERR-RPT-D2-VENDOR-NBR 57950000
WR0933                 MOVE 'T-SHIRT INTERNATIONAL INC'                 57960000
WR0933                                         TO ERR-RPT-D2-VENDOR-NAME57970000
W41905            WHEN '127183494307'                                   57980000
W41905                 MOVE '???'              TO ERR-RPT-D1-BUYER-NBR  57990000
W41905                 MOVE '????????????'     TO ERR-RPT-D1-BUYER-NAME 58000000
W41905                 MOVE '086893815'        TO ERR-RPT-D2-VENDOR-NBR 58010000
W41905                 MOVE 'JACMEL JEWELRY INC'                        58020000
W41905                                         TO ERR-RPT-D2-VENDOR-NAME58030000
W41952            WHEN '122124030661'                                   58040000
W41952                 MOVE '???'              TO ERR-RPT-D1-BUYER-NBR  58050000
W41952                 MOVE '????????????'     TO ERR-RPT-D1-BUYER-NAME 58060000
W41952                 MOVE '068225002'        TO ERR-RPT-D2-VENDOR-NBR 58070000
W41952                 MOVE 'G-III LEATHER FASHIONS'                    58080000
W41952                                         TO ERR-RPT-D2-VENDOR-NAME58090000
W42092            WHEN 'ZZSUPERBAINC'                                   58100000
W42092                 MOVE '???'              TO ERR-RPT-D1-BUYER-NBR  58110000
W42092                 MOVE '????????????'     TO ERR-RPT-D1-BUYER-NAME 58120000
W42092                 MOVE '008374241'        TO ERR-RPT-D2-VENDOR-NBR 58130000
W42092                 MOVE 'PVH SUPERBA'                               58140000
W42092                                         TO ERR-RPT-D2-VENDOR-NAME58150000
756744*           WHEN '125175212525'                                   58160000
756744            WHEN '125176557948'                                   58170000
534202                 MOVE '???'              TO ERR-RPT-D1-BUYER-NBR  58180000
534202                 MOVE '????????????'     TO ERR-RPT-D1-BUYER-NAME 58190000
534202                 MOVE '799110721'        TO ERR-RPT-D2-VENDOR-NBR 58200000
534202                 MOVE 'J AMERICA'                                 58210000
534202                                         TO ERR-RPT-D2-VENDOR-NAME58220000
453643            WHEN '086594140000'                                   58230000
453643                 MOVE '???'              TO ERR-RPT-D1-BUYER-NBR  58240000
453643                 MOVE '????????????'     TO ERR-RPT-D1-BUYER-NAME 58250000
453643                 MOVE '000850727'        TO ERR-RPT-D2-VENDOR-NBR 58260000
453643                 MOVE 'ETERNAL FORTUNE FASHIONS LLC'              58270000
453643                                         TO ERR-RPT-D2-VENDOR-NAME58280000
494672            WHEN '086111270000'                                   58290000
494672                 MOVE '???'              TO ERR-RPT-D1-BUYER-NBR  58300000
494672                 MOVE '????????????'     TO ERR-RPT-D1-BUYER-NAME 58310000
494672                 MOVE '007926645'        TO ERR-RPT-D2-VENDOR-NBR 58320000
494672                 MOVE 'HAGGAR CLOTHING COMPANY'                   58330000
494672                                         TO ERR-RPT-D2-VENDOR-NAME58340000
686121            WHEN '01008029498'                                    58350000
686121                 MOVE '???'              TO ERR-RPT-D1-BUYER-NBR  58360000
686121                 MOVE '????????????'     TO ERR-RPT-D1-BUYER-NAME 58370000
686121                 MOVE '008029498'        TO ERR-RPT-D2-VENDOR-NBR 58380000
686121                 MOVE 'WILLIAMSON-DICKIE MFG CO'                  58390000
686121                                         TO ERR-RPT-D2-VENDOR-NAME58400000
371617            WHEN '01056612773'                                    58410000
371617                 MOVE '???'              TO ERR-RPT-D1-BUYER-NBR  58420000
371617                 MOVE '????????????'     TO ERR-RPT-D1-BUYER-NAME 58430000
371617                 MOVE '056612773'        TO ERR-RPT-D2-VENDOR-NBR 58440000
371617                 MOVE 'NEW ERA CAP CO INC'                        58450000
371617                                         TO ERR-RPT-D2-VENDOR-NAME58460000
505256            WHEN '122014369009'                                   58470000
505256                 MOVE '???'              TO ERR-RPT-D1-BUYER-NBR  58480000
505256                 MOVE '????????????'     TO ERR-RPT-D1-BUYER-NAME 58490000
505256                 MOVE '001467893'        TO ERR-RPT-D2-VENDOR-NBR 58500000
505256                 MOVE 'MAIDENFORM INC'                            58510000
505256                                         TO ERR-RPT-D2-VENDOR-NAME58520000
683003            WHEN '01089087787'                                    58530000
683003                 MOVE '???'              TO ERR-RPT-D1-BUYER-NBR  58540000
683003                 MOVE '????????????'     TO ERR-RPT-D1-BUYER-NAME 58550000
683003                 MOVE '001025237'        TO ERR-RPT-D2-VENDOR-NBR 58560000
683003                 MOVE 'RANDA ACCESSORIES'                         58570000
683003                                         TO ERR-RPT-D2-VENDOR-NAME58580000
683026            WHEN '086117470000'                                   58590000
683026                 MOVE '???'              TO ERR-RPT-D1-BUYER-NBR  58600000
683026                 MOVE '????????????'     TO ERR-RPT-D1-BUYER-NAME 58610000
683026                 MOVE '001107043'        TO ERR-RPT-D2-VENDOR-NBR 58620000
683026                 MOVE 'RANDA CORP'                                58630000
683026                                         TO ERR-RPT-D2-VENDOR-NAME58640000
944205            WHEN '14006436299AS'                                  58650000
944205                 MOVE '???'              TO ERR-RPT-D1-BUYER-NBR  58660000
944205                 MOVE '????????????'     TO ERR-RPT-D1-BUYER-NAME 58670000
944205                 MOVE '94199'            TO ERR-RPT-D2-VENDOR-NBR 58680000
944205                 MOVE 'BOELTER COMPANIES'                         58690000
944205                                         TO ERR-RPT-D2-VENDOR-NAME58700000
002139            WHEN '125303438725'                                   58710000
002139                 MOVE '???'              TO ERR-RPT-D1-BUYER-NBR  58720000
002139                 MOVE '????????????'     TO ERR-RPT-D1-BUYER-NAME 58730000
002139                 MOVE '883082182'        TO ERR-RPT-D2-VENDOR-NBR 58740000
002139                 MOVE 'GONZALS ENT INC DBA FIFTH'                 58750000
002139                                         TO ERR-RPT-D2-VENDOR-NAME58760000
647062            WHEN '01012697983'                                    58770000
647062                 MOVE '???'              TO ERR-RPT-D1-BUYER-NBR  58780000
647062                 MOVE '????????????'     TO ERR-RPT-D1-BUYER-NAME 58790000
647062                 MOVE '012697983'        TO ERR-RPT-D2-VENDOR-NBR 58800000
647062                 MOVE 'LUXOTTICA USA LLC'                         58810000
647062                                         TO ERR-RPT-D2-VENDOR-NAME58820000
042023            WHEN '129139423259'                                   58830000
042023                 MOVE '???'              TO ERR-RPT-D1-BUYER-NBR  58840000
042023                 MOVE '????????????'     TO ERR-RPT-D1-BUYER-NAME 58850000
042023                 MOVE '018487707'        TO ERR-RPT-D2-VENDOR-NBR 58860000
042023                 MOVE 'CC PRODUCTS'                               58870000
042023                                         TO ERR-RPT-D2-VENDOR-NAME58880000
018127            WHEN '129419662114'                                   58890000
018127                 MOVE '???'              TO ERR-RPT-D1-BUYER-NBR  58900000
018127                 MOVE '????????????'     TO ERR-RPT-D1-BUYER-NAME 58910000
018127                 MOVE '087755492'        TO ERR-RPT-D2-VENDOR-NBR 58920000
018127                 MOVE 'TERVIS TUMBLER'                            58930000
018127                                         TO ERR-RPT-D2-VENDOR-NAME58940000
356324            WHEN '122122217500'                                   58950000
356324                 MOVE '???'              TO ERR-RPT-D1-BUYER-NBR  58960000
356324                 MOVE '????????????'     TO ERR-RPT-D1-BUYER-NAME 58970000
356324                 MOVE '000916643'        TO ERR-RPT-D2-VENDOR-NBR 58980000
356324                 MOVE 'PERRY ELLIS MENSWEAR'                      58990000
356324                                         TO ERR-RPT-D2-VENDOR-NAME59000000
637834            WHEN 'ZZ30378999YK'                                   59010000
637834                 MOVE '???'              TO ERR-RPT-D1-BUYER-NBR  59020000
637834                 MOVE '????????????'     TO ERR-RPT-D1-BUYER-NAME 59030000
637834                 MOVE '000211755'        TO ERR-RPT-D2-VENDOR-NBR 59040000
637834                 MOVE 'OURAY SPORTSWEAR'                          59050000
637834                                         TO ERR-RPT-D2-VENDOR-NAME59060000
185577            WHEN '01034698614'                                    59070000
185577                 MOVE '???'              TO ERR-RPT-D1-BUYER-NBR  59080000
185577                 MOVE '????????????'     TO ERR-RPT-D1-BUYER-NAME 59090000
185577                 MOVE '000214536'        TO ERR-RPT-D2-VENDOR-NBR 59100000
185577                 MOVE 'BESPOKE FASHION LLC'                       59110000
185577                                         TO ERR-RPT-D2-VENDOR-NAME59120000
790723            WHEN 'ZZ062312087S2'                                  59130000
790723                 MOVE '???'              TO ERR-RPT-D1-BUYER-NBR  59140000
790723                 MOVE '????????????'     TO ERR-RPT-D1-BUYER-NAME 59150000
790723                 MOVE '000000907'        TO ERR-RPT-D2-VENDOR-NBR 59160000
790723                 MOVE 'FGX INTERNATIONAL INC'                     59170000
790723                                         TO ERR-RPT-D2-VENDOR-NAME59180000
956632            WHEN '129738121700'                                   59190000
956632                 MOVE '???'              TO ERR-RPT-D1-BUYER-NBR  59200000
956632                 MOVE '????????????'     TO ERR-RPT-D1-BUYER-NAME 59210000
956632                 MOVE '000103644'        TO ERR-RPT-D2-VENDOR-NBR 59220000
956632                 MOVE 'RANDA LUGGAGE'                             59230000
956632                                         TO ERR-RPT-D2-VENDOR-NAME59240000
956632            WHEN '126152619218'                                   59250000
956632                 MOVE '???'              TO ERR-RPT-D1-BUYER-NBR  59260000
956632                 MOVE '????????????'     TO ERR-RPT-D1-BUYER-NAME 59270000
956632                 MOVE '000144864'        TO ERR-RPT-D2-VENDOR-NBR 59280000
956632                 MOVE 'LOGO BRANDS INC'                           59290000
956632                                         TO ERR-RPT-D2-VENDOR-NAME59300000
956632            WHEN '128306204400'                                   59310000
956632                 MOVE '???'              TO ERR-RPT-D1-BUYER-NBR  59320000
956632                 MOVE '????????????'     TO ERR-RPT-D1-BUYER-NAME 59330000
956632                 MOVE '000009968'        TO ERR-RPT-D2-VENDOR-NBR 59340000
956632                 MOVE 'GREAT AMERICAN PRODUCTS'                   59350000
956632                                         TO ERR-RPT-D2-VENDOR-NAME59360000
346771            WHEN '128585585273'                                   59370000
346771                 MOVE '???'              TO ERR-RPT-D1-BUYER-NBR  59380000
346771                 MOVE '????????????'     TO ERR-RPT-D1-BUYER-NAME 59390000
346771                 MOVE '000031949'        TO ERR-RPT-D2-VENDOR-NBR 59400000
346771                 MOVE 'MAD ENGINE LLC'                            59410000
346771                                         TO ERR-RPT-D2-VENDOR-NAME59420000
265129            WHEN '123109949975N'                                  59430000
265129                 MOVE '???'              TO ERR-RPT-D1-BUYER-NBR  59440000
265129                 MOVE '????????????'     TO ERR-RPT-D1-BUYER-NAME 59450000
265129                 MOVE '000055202'        TO ERR-RPT-D2-VENDOR-NBR 59460000
265129                 MOVE 'HYBRID PROMOTIONS LLC'                     59470000
265129                                         TO ERR-RPT-D2-VENDOR-NAME59480000
887802            WHEN '14087607334'                                    59490000
887802                 MOVE '???'              TO ERR-RPT-D1-BUYER-NBR  59500000
887802                 MOVE '????????????'     TO ERR-RPT-D1-BUYER-NAME 59510000
887802                 MOVE '000058690'        TO ERR-RPT-D2-VENDOR-NBR 59520000
887802                 MOVE 'BIOWORLD MERCHANDISING'                    59530000
887802                                         TO ERR-RPT-D2-VENDOR-NAME59540000
927044            WHEN '125164846996'                                   59550000
927044                 MOVE '???'              TO ERR-RPT-D1-BUYER-NBR  59560000
927044                 MOVE '????????????'     TO ERR-RPT-D1-BUYER-NAME 59570000
927044                 MOVE '000004163'        TO ERR-RPT-D2-VENDOR-NBR 59580000
927044                 MOVE 'NORTHWEST CO/ASHLAND MILL'                 59590000
927044                                         TO ERR-RPT-D2-VENDOR-NAME59600000
925845            WHEN '127653497474'                                   59610000
925845                 MOVE '???'              TO ERR-RPT-D1-BUYER-NBR  59620000
925845                 MOVE '????????????'     TO ERR-RPT-D1-BUYER-NAME 59630000
925845                 MOVE '000180649'        TO ERR-RPT-D2-VENDOR-NBR 59640000
925845                 MOVE 'FOR BARE FEET'                             59650000
925845                                         TO ERR-RPT-D2-VENDOR-NAME59660000
762449            WHEN 'ZZ52074119YK'                                   59670000
762449                 MOVE '???'              TO ERR-RPT-D1-BUYER-NBR  59680000
762449                 MOVE '????????????'     TO ERR-RPT-D1-BUYER-NAME 59690000
762449                 MOVE '948939830'        TO ERR-RPT-D2-VENDOR-NBR 59700000
762449                 MOVE 'MASTERPIECES'                              59710000
762449                                         TO ERR-RPT-D2-VENDOR-NAME59720000
889751            WHEN '01805838083'                                    59730000
889751                 MOVE '???'              TO ERR-RPT-D1-BUYER-NBR  59740000
889751                 MOVE '????????????'     TO ERR-RPT-D1-BUYER-NAME 59750000
889751                 MOVE '805838083'        TO ERR-RPT-D2-VENDOR-NBR 59760000
889751                 MOVE 'RIPPLE-JUNCTION'                           59770000
889751                                         TO ERR-RPT-D2-VENDOR-NAME59780000
064017            WHEN '086118910100'                                   59790000
064017                 MOVE '???'              TO ERR-RPT-D1-BUYER-NBR  59800000
064017                 MOVE '????????????'     TO ERR-RPT-D1-BUYER-NAME 59810000
064017                 MOVE '6118910100'       TO ERR-RPT-D2-VENDOR-NBR 59820000
064017                 MOVE 'S LICHTENBERG & CO INC'                    59830000
064017                                         TO ERR-RPT-D2-VENDOR-NAME59840000
176716            WHEN '122137472376'                                   59850000
176716                 MOVE '???'              TO ERR-RPT-D1-BUYER-NBR  59860000
176716                 MOVE '????????????'     TO ERR-RPT-D1-BUYER-NAME 59870000
176716                 MOVE '2137472376'       TO ERR-RPT-D2-VENDOR-NBR 59880000
176716                 MOVE 'SPIRIT LEATHERWORKS LLC'                   59890000
176716                                         TO ERR-RPT-D2-VENDOR-NAME59900000
176682            WHEN '123056226763'                                   59910000
176682                 MOVE '???'              TO ERR-RPT-D1-BUYER-NBR  59920000
176682                 MOVE '????????????'     TO ERR-RPT-D1-BUYER-NAME 59930000
176682                 MOVE '3056226763'       TO ERR-RPT-D2-VENDOR-NBR 59940000
176682                 MOVE 'TEE SHIRT CENTRAL INC'                     59950000
176682                                         TO ERR-RPT-D2-VENDOR-NAME59960000
680553            WHEN '086116110015'                                   59961000
680553                 MOVE '???'              TO ERR-RPT-D1-BUYER-NBR  59962000
680553                 MOVE '????????????'     TO ERR-RPT-D1-BUYER-NAME 59963000
680553                 MOVE '6116110015'       TO ERR-RPT-D2-VENDOR-NBR 59964000
680553                 MOVE 'LF MENS GROUP LLC'                         59965000
680553                                         TO ERR-RPT-D2-VENDOR-NAME59966000
                  WHEN OTHER                                            59970000
                       MOVE '???'              TO ERR-RPT-D1-BUYER-NBR  59980000
                       MOVE '????????????????' TO ERR-RPT-D1-BUYER-NAME 59990000
                       MOVE '?????????'        TO ERR-RPT-D2-VENDOR-NBR 60000000
                       MOVE '??????????????????' TO                     60010000
                                                  ERR-RPT-D2-VENDOR-NAME60020000
              END-EVALUATE                                              60030000
           END-IF.                                                      60040000
                                                                        60050000
       96500-FORMAT-WS-BAD-VENDOR.                                      60060000
                                                                        60070000
           EVALUATE WS-CURR-INTERCHANGE                                 60080000
               WHEN '086119230000'                                      60090000
                    MOVE 'HALLMARK MARKETING CORP' TO                   60100000
                                               WS-BAD-VENDOR            60110000
               WHEN '124154571577'                                      60120000
                    MOVE 'MULBERRY NECKWEAR' TO                         60130000
                                               WS-BAD-VENDOR            60140000
               WHEN 'ZZHDLEKOHL'                                        60150000
                    MOVE 'HANDLEMAN COMPANY' TO                         60160000
                                               WS-BAD-VENDOR            60170000
               WHEN '01067429365'                                       60180000
                    MOVE 'HANES HOSIERY'    TO WS-BAD-VENDOR            60190000
                                                                        60200000
               WHEN '086111970038'                                      60210000
                    MOVE 'INTERCRAFT COMPANY      ' TO                  60220000
                                               WS-BAD-VENDOR            60230000
               WHEN '010419368400'                                      60240000
                    MOVE 'JOCKEY INTERNATIONAL INC' TO                  60250000
                                               WS-BAD-VENDOR            60260000
               WHEN '086111151100'                                      60270000
                    MOVE 'SARA LEE INTIMATES      ' TO                  60280000
                                               WS-BAD-VENDOR            60290000
               WHEN '01076735463'                                       60300000
                    MOVE 'CARLTON CARDS           '      TO             60310000
                                               WS-BAD-VENDOR            60320000
               WHEN '01002344208'                                       60330000
                    MOVE 'VANITY FAIR             ' TO                  60340000
                                               WS-BAD-VENDOR            60350000
               WHEN '01031360197'                                       60360000
                    MOVE 'LILY OF FRANCE          ' TO                  60370000
                                               WS-BAD-VENDOR            60380000
               WHEN '01143367634'                                       60390000
                    MOVE 'ESTEE LAUDER            ' TO                  60400000
                                               WS-BAD-VENDOR            60410000
               WHEN '086116630000'                                      60420000
               WHEN '086116630050'                                      60430000
                    MOVE 'LIZ CLAIBORNE           ' TO                  60440000
                                               WS-BAD-VENDOR            60450000
               WHEN '01007131501'                                       60460000
                    MOVE 'LEE WRANGLER            ' TO                  60470000
                                               WS-BAD-VENDOR            60480000
               WHEN '012270726'                                         60490000
                    MOVE 'FISHMAN & TOBIN INC     ' TO                  60500000
                                               WS-BAD-VENDOR            60510000
CHGID *        WHEN '122035798435'                                      60520000
CHGID *        WHEN '128187827568'                                      60530000
CHGID          WHEN '084229981500'                                      60540000
                    MOVE 'OLGA/WARNER             ' TO                  60550000
                                               WS-BAD-VENDOR            60560000
               WHEN '1213026746000'                                     60570000
                    MOVE 'PLAYTEX                 ' TO                  60580000
                                               WS-BAD-VENDOR            60590000
               WHEN '086111151100'                                      60600000
                    MOVE 'BALI                    ' TO                  60610000
                                               WS-BAD-VENDOR            60620000
               WHEN '129105196395'                                      60630000
                    MOVE 'WONDERBRA               ' TO                  60640000
                                               WS-BAD-VENDOR            60650000
               WHEN '124053609856'                                      60660000
                    MOVE 'TOP OF THE WORLD        ' TO                  60670000
                                               WS-BAD-VENDOR            60680000
               WHEN '086126930000'                                      60690000
                    MOVE 'VF IMAGEWEAR            ' TO                  60700000
                                               WS-BAD-VENDOR            60710000
               WHEN '128649689682'                                      60720000
                    MOVE 'KNIGHTS APPAREL         ' TO                  60730000
                                               WS-BAD-VENDOR            60740000
               WHEN '122605632187'                                      60750000
                    MOVE 'NEXT INC                ' TO                  60760000
                                               WS-BAD-VENDOR            60770000
               WHEN '086174371385'                                      60780000
352053              MOVE '47BRAND LLC             ' TO                  60790000
                                               WS-BAD-VENDOR            60800000
               WHEN 'ZZPERRYGEGP'                                       60810000
                    MOVE 'SUPREME INTL            ' TO                  60820000
                                               WS-BAD-VENDOR            60830000
               WHEN '01004637980'                                       60840000
                    MOVE 'COLLEGE CONCEPTS        ' TO                  60850000
                                               WS-BAD-VENDOR            60860000
               WHEN '061117700002'                                      60870000
                    MOVE 'RUSSELL ATHLETIC        ' TO                  60880000
                                               WS-BAD-VENDOR            60890000
               WHEN '01001334036'                                       60900000
                    MOVE 'OUTERSTUFF              ' TO                  60910000
                                               WS-BAD-VENDOR            60920000
               WHEN '14037794872C'                                      60930000
                    MOVE 'HADDAD                  ' TO                  60940000
                                               WS-BAD-VENDOR            60950000
               WHEN '123365192222'                                      60960000
                    MOVE 'HANES UNDERWEAR         ' TO                  60970000
                                               WS-BAD-VENDOR            60980000
               WHEN '126129445069'                                      60990000
                    MOVE 'COKEM                   ' TO                  61000000
                                               WS-BAD-VENDOR            61010000
               WHEN '129136933200'                                      61020000
575459         WHEN '129139423258'                                      61030000
                    MOVE 'GEAR FOR SPORTS         ' TO                  61040000
                                               WS-BAD-VENDOR            61050000
               WHEN '129136933996'                                      61060000
                    MOVE 'CHAMPION CUSTOMS        ' TO                  61070000
                                               WS-BAD-VENDOR            61080000
               WHEN '01833753478'                                       61090000
714055         WHEN '01833753478N'                                      61100000
                    MOVE 'COLOSSEUM ATHLETICS     ' TO                  61110000
                                               WS-BAD-VENDOR            61120000
               WHEN '01053736070'                                       61130000
                    MOVE 'SPORTS LICENSED DIVISION' TO                  61140000
                                               WS-BAD-VENDOR            61150000
               WHEN '127048211005'                                      61160000
                    MOVE 'RENAISSANCE IMPORTS     ' TO                  61170000
                                               WS-BAD-VENDOR            61180000
WR9604         WHEN '086111190003'                                      61190000
WR9604              MOVE 'LEVI STRAUSS & CO       ' TO                  61200000
WR9604                                         WS-BAD-VENDOR            61210000
WR0933         WHEN '123045622401'                                      61220000
WR0933              MOVE 'T-SHIRT INTERNATIONAL INC' TO                 61230000
WR0933                                         WS-BAD-VENDOR            61240000
W41905         WHEN '127183494307'                                      61250000
W41905              MOVE 'JACMEL JEWELRY INC       ' TO                 61260000
W41905                                         WS-BAD-VENDOR            61270000
W41952         WHEN '122124030661'                                      61280000
W41952              MOVE 'G-III LEATHER FASHIONS   ' TO                 61290000
W41952                                         WS-BAD-VENDOR            61300000
W42092         WHEN 'ZZSUPERBAINC'                                      61310000
W42092              MOVE 'PVH SUPERBA              ' TO                 61320000
W42092                                         WS-BAD-VENDOR            61330000
756744*        WHEN '125175212525'                                      61340000
756744         WHEN '125176557948'                                      61350000
534202              MOVE 'J AMERICA                ' TO                 61360000
534202                                         WS-BAD-VENDOR            61370000
453643         WHEN '086594140000'                                      61380000
453643              MOVE 'ETERNAL FORTUNE FASHIONS LLC' TO              61390000
453643                                         WS-BAD-VENDOR            61400000
494672         WHEN '086111270000'                                      61410000
494672              MOVE 'HAGGAR CLOTHING COMPANY' TO                   61420000
494672                                         WS-BAD-VENDOR            61430000
686121         WHEN '01008029498'                                       61440000
686121              MOVE 'WILLIAMSON-DICKIE MFG CO' TO                  61450000
686121                                         WS-BAD-VENDOR            61460000
371617         WHEN '01056612773'                                       61470000
371617              MOVE 'NEW ERA CAP CO INC'       TO                  61480000
371617                                         WS-BAD-VENDOR            61490000
505256         WHEN '122014369009'                                      61500000
505256              MOVE 'MAIDENFORM INC'        TO                     61510000
505256                                         WS-BAD-VENDOR            61520000
683003         WHEN '01089087787'                                       61530000
683003              MOVE 'RANDA ACCESSORIES'     TO                     61540000
683003                                         WS-BAD-VENDOR            61550000
683026         WHEN '086117470000'                                      61560000
683026              MOVE 'RANDA CORP'            TO                     61570000
683026                                         WS-BAD-VENDOR            61580000
944205         WHEN '14006436299AS'                                     61590000
944205              MOVE 'BOELTER COMPANIES'               TO           61600000
944205                                         WS-BAD-VENDOR            61610000
002139         WHEN '125303438725'                                      61620000
002139              MOVE 'GONZALES ENT INC'               TO            61630000
002139                                         WS-BAD-VENDOR            61640000
647062         WHEN '01012697983'                                       61650000
647062              MOVE 'LUXOTTICA USA LLC'              TO            61660000
647062                                         WS-BAD-VENDOR            61670000
042023         WHEN '129139423259'                                      61680000
042023              MOVE 'CC PRODUCTS'                    TO            61690000
042023                                         WS-BAD-VENDOR            61700000
018127         WHEN '129419662114'                                      61710000
018127              MOVE 'TERVIS TUMBLER'                 TO            61720000
018127                                         WS-BAD-VENDOR            61730000
356324         WHEN '122122217500'                                      61740000
356324              MOVE 'PERRY ELLIS MENSWEAR'           TO            61750000
356324                                         WS-BAD-VENDOR            61760000
637834         WHEN 'ZZ30378999YK'                                      61770000
637834              MOVE 'OURAY SPORTSWEAR'               TO            61780000
637834                                         WS-BAD-VENDOR            61790000
185577         WHEN '01034698614'                                       61800000
185577              MOVE 'BESPOKE FASHION LLC'            TO            61810000
185577                                         WS-BAD-VENDOR            61820000
790723         WHEN 'ZZ062312087S2'                                     61830000
790723              MOVE 'FGX INTERNATIONAL INC'          TO            61840000
790723                                         WS-BAD-VENDOR            61850000
956632         WHEN '129738121700'                                      61860000
956632              MOVE 'RANDA LUGGAGE'          TO                    61870000
956632                                         WS-BAD-VENDOR            61880000
956632         WHEN '126152619218'                                      61890000
956632              MOVE 'LOGO BRANDS INC'        TO                    61900000
956632                                         WS-BAD-VENDOR            61910000
956632         WHEN '128306204400'                                      61920000
956632              MOVE 'GREAT AMERICAN PRODUCTS' TO                   61930000
956632                                         WS-BAD-VENDOR            61940000
346771         WHEN '128585585273'                                      61950000
346771              MOVE 'MAD ENGINE LLC'          TO                   61960000
346771                                         WS-BAD-VENDOR            61970000
265129         WHEN '123109949975N'                                     61980000
265129              MOVE 'HYBRID PROMOTIONS LLC'   TO                   61990000
265129                                         WS-BAD-VENDOR            62000000
887802         WHEN '14087607334'                                       62010000
887802              MOVE 'BIOWORLD MERCHANDISING'  TO                   62020000
887802                                         WS-BAD-VENDOR            62030000
927044         WHEN '125164846996'                                      62040000
927044              MOVE 'NORTHWEST CO/ASHLAND MILL' TO                 62050000
927044                                         WS-BAD-VENDOR            62060000
925845         WHEN '127653497474'                                      62070000
925845              MOVE 'FOR BARE FEET'       TO                       62080000
925845                                         WS-BAD-VENDOR            62090000
762449         WHEN 'ZZ52074119YK'                                      62100000
762449              MOVE 'MASTERPIECES'        TO                       62110000
762449                                         WS-BAD-VENDOR            62120000
889751         WHEN '01805838083'                                       62130000
889751              MOVE 'RIPPLE JUNCTION'     TO                       62140000
889751                                         WS-BAD-VENDOR            62150000
064017         WHEN '086118910100'                                      62160000
064017              MOVE 'S LICHTENBERG & CO INC' TO                    62170000
064017                                         WS-BAD-VENDOR            62180000
176716         WHEN '122137472376'                                      62190000
176716              MOVE 'SPIRIT LEATHERWORKS LLC' TO                   62200000
176716                                         WS-BAD-VENDOR            62210000
176682         WHEN '123056226763'                                      62220000
176682              MOVE 'TEE SHIRT CENTRAL INC'   TO                   62230000
176682                                         WS-BAD-VENDOR            62240000
680553         WHEN '086116110015'                                      62241000
680553              MOVE 'LF MENS GROUP LLC'       TO                   62242000
680553                                         WS-BAD-VENDOR            62243000
               WHEN OTHER                                               62250000
                    MOVE '??????????????????' TO                        62260000
                                               WS-BAD-VENDOR            62270000
           END-EVALUATE.                                                62280000
                                                                        62290000
       97000-FORMAT-ERROR-STR-QTY.                                      62300000
                                                                        62310000
           SET PS-ERROR-REPORT-CREATED TO TRUE.                         62320000
           WRITE ERROR-RECORD FROM ERR-RPT-HEADER-ALLOC                 62330000
                 AFTER ADVANCING 2 LINES.                               62340000
           WRITE ERROR-RECORD FROM ERR-RPT-BLANK-LINE                   62350000
                 AFTER ADVANCING 1 LINE.                                62360000
                                                                        62370000
           MOVE 1 TO WS-ERR-SUB.                                        62380000
           PERFORM 97100-FORMAT-STR-QTY                                 62390000
                   VARYING WS-STR-SUB  FROM 1 BY 1                      62400000
                     UNTIL WS-STR-NBR (WS-STR-SUB) = ZERO OR            62410000
                           WS-STR-SUB > WS-STR-SUB-MAX.                 62420000
                                                                        62430000
           WRITE ERROR-RECORD FROM ERR-RPT-DETAIL-ALLOC                 62440000
                 AFTER ADVANCING 1 LINE.                                62450000
           MOVE SPACES TO ERR-RPT-DETAIL-ALLOC.                         62460000
           MOVE WS-SKU-NOT-FOUND-MSG TO ERR-RPT-DETAIL-ERROR.           62470000
           WRITE ERROR-RECORD FROM ERR-RPT-DETAIL-ERROR                 62480000
                 AFTER ADVANCING 3 LINES.                               62490000
                                                                        62500000
       97100-FORMAT-STR-QTY.                                            62510000
                                                                        62520000
           IF WS-ERR-SUB > WS-STORE-SUB-MAX                             62530000
               WRITE ERROR-RECORD FROM ERR-RPT-DETAIL-ALLOC             62540000
                     AFTER ADVANCING 1 LINE                             62550000
               MOVE SPACES TO ERR-RPT-DETAIL-ALLOC                      62560000
               MOVE 1 TO WS-ERR-SUB                                     62570000
           END-IF.                                                      62580000
                                                                        62590000
           MOVE WS-STR-NBR (WS-STR-SUB) TO ERR-RPT-DA-STR (WS-ERR-SUB). 62600000
           MOVE WS-STR-QTY (WS-STR-SUB) TO ERR-RPT-DA-QTY (WS-ERR-SUB). 62610000
           ADD 1 TO WS-ERR-SUB.                                         62620000
                                                                        62630000
       98000-PRINT-ERROR-PAGE.                                          62640000
           SET PS-ERROR-REPORT-CREATED TO TRUE.                         62650000
           ACCEPT WS-TIME  FROM TIME.                                   62660000
           MOVE WS-TIME(1:2) TO ERR-RPT-H1-HH.                          62670000
           MOVE WS-TIME(3:2) TO ERR-RPT-H1-MN.                          62680000
           MOVE '-1'         TO ERR-RPT-H1-RPT-NBR.                     62690000
           ADD 1 TO WS-ERR-RPT-PAGE.                                    62700000
           MOVE WS-ERR-RPT-PAGE TO ERR-RPT-H1-PAGE.                     62710000
           WRITE ERROR-RECORD FROM ERR-RPT-HEADER-1                     62720000
                 AFTER ADVANCING PAGE.                                  62730000
           WRITE ERROR-RECORD FROM ERR-RPT-HEADER-2                     62740000
                 AFTER ADVANCING 2 LINES.                               62750000
           WRITE ERROR-RECORD FROM ERR-RPT-HEADER-3                     62760000
                 AFTER ADVANCING 1 LINE.                                62770000
           WRITE ERROR-RECORD FROM ERR-RPT-DETAIL-1                     62780000
                 AFTER ADVANCING 2 LINES.                               62790000
           WRITE ERROR-RECORD FROM ERR-RPT-DETAIL-2                     62800000
                 AFTER ADVANCING 2 LINES.                               62810000
           WRITE ERROR-RECORD FROM ERR-RPT-DETAIL-3                     62820000
                 AFTER ADVANCING 2 LINES.                               62830000
           WRITE ERROR-RECORD FROM ERR-RPT-DETAIL-4                     62840000
                 AFTER ADVANCING 2 LINES.                               62850000
           WRITE ERROR-RECORD FROM ERR-RPT-DETAIL-5                     62860000
                 AFTER ADVANCING 2 LINES.                               62870000
                                                                        62880000
       99000-PRINT-FINAL-PAGE.                                          62890000
                                                                        62900000
           ACCEPT WS-TIME  FROM TIME.                                   62910000
           MOVE WS-TIME(1:2) TO ERR-RPT-H1-HH.                          62920000
           MOVE WS-TIME(3:2) TO ERR-RPT-H1-MN.                          62930000
           ADD 1 TO WS-ERR-RPT-PAGE.                                    62940000
           MOVE WS-ERR-RPT-PAGE TO ERR-RPT-H1-PAGE.                     62950000
           WRITE ERROR-RECORD FROM ERR-RPT-HEADER-1                     62960000
                 AFTER ADVANCING PAGE.                                  62970000
           WRITE ERROR-RECORD FROM ERR-RPT-HEADER-2                     62980000
                 AFTER ADVANCING 2 LINES.                               62990000
           WRITE ERROR-RECORD FROM ERR-RPT-HEADER-3                     63000000
                 AFTER ADVANCING 1 LINE.                                63010000
           WRITE ERROR-RECORD FROM ERR-RPT-DETAIL-FINAL                 63020000
                 AFTER ADVANCING 3 LINES.                               63030000
                                                                        63040000
       99997-READ-INPUT-FILE.                                           63050000
                                                                        63060000
           READ INPUT-FILE                                              63070000
                AT END  SET WS-NO-MORE-INPUT TO TRUE.                   63080000
                                                                        63090000
           IF WS-MORE-INPUT                                             63100000
               MOVE INPUT-RECORD TO PO002-EDI855-RECORD.                63110000
                                                                        63120000
       99998-MQ-ABEND.                                                  63130000
           SET WS-MQ-ERROR TO TRUE.                                     63140000
           CALL WS-MQCHECK USING PV-REASON                              63150000
                                 PV-MQ-REASON-TEXT.                     63160000
                                                                        63170000
           DISPLAY '                 '.                                 63180000
                                                                        63190000
           DISPLAY '**** ABEND *************************************'.  63200000
           DISPLAY '** MQSERIES ERROR **'.                              63210000
           DISPLAY '** PROGRAM:    ', PC-PROGRAM-NAME.                  63220000
           DISPLAY '** PARAGRAPH:  ', PV-PARAGRAPH-NAME.                63230000
           DISPLAY '** MESSAGE:    ', PV-ERROR-MESSAGE.                 63240000
           IF PV-ERROR-MESSAGE2 NOT EQUAL SPACES                        63250000
               DISPLAY '** MESSAGE:    ', PV-ERROR-MESSAGE2             63260000
           END-IF.                                                      63270000
           DISPLAY '** COMP CODE:  ', PV-COMPLETION-CODE.               63280000
           DISPLAY '** RSN CODE:   ', PV-REASON.                        63290000
           DISPLAY '** RSN TEXT:   ', PV-MQ-REASON-TEXT.                63300000
           DISPLAY '************************************************'.  63310000
           CALL 'ILBOABN0' USING WS-ABEND-CODE.                         63320000
       99999-DB2-ABEND.                                                 63330000
                                                                        63340000
           DISPLAY ' '.                                                 63350000
           DISPLAY PV-PARAGRAPH-NAME.                                   63360000
                                                                        63370000
           COPY DPPD004.                                                63380000
                                                                        63390000
           IF SQLCODE NOT = -913                                        63400000
               EXEC SQL                                                 63410000
                    ROLLBACK                                            63420000
               END-EXEC                                                 63430000
           END-IF.                                                      63440000
                                                                        63450000
           SET WS-DB2-ABEND TO TRUE.                                    63460000
                                                                        63470000
           CALL 'ILBOABN0' USING WS-ABEND-CODE.                         63480000
                                                                        63490000
