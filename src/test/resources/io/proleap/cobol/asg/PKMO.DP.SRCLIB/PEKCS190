000100*-----------------------*                                         00010013
000200 IDENTIFICATION DIVISION.                                         00020014
000300*-----------------------*                                         00030014
000400 PROGRAM-ID.    PEKCS190.                                         00040014
000500 AUTHOR.        AMY REILAND.                                      00050014
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060014
000700 DATE-WRITTEN.  05-23-93.                                         00070014
000800 DATE-COMPILED.                                                   00080014
000900*----------------------------------------------------------------*00090014
001000*    Q190 - IN-STORE DOCUMENT ENTRY CRITERIA SPEC                *00100014
001100*                                                                *00110014
001200*    THIS PROGRAM ALLOWS THE USER TO ENTER DATA TO BE USED BY    *00120014
001300*    SUBSEQUENT PROGRAMS WITHIN THE IN-STORE DOCUMENT ENTRY      *00130014
001400*    SYSTEM.  DATA CAN BE PASSED TO THE HEADER ADD, INQUIRY,     *00140014
001500*    CANCEL, LIST AND UPDATE PROGRAMS.  STORE WILL BE EDITTED    *00150014
001600*    WITHIN THIS PROGRAM ALONG WITH THE OPTIONAL FIELDS, DEPT    *00160014
001700*    STATUS AND REASON.  THIS WILL BE DONE BECAUSE THE           *00170014
001800*    DESCRIPTIONS WILL DISPLAY WHEN ENTER IS HIT.  DATE RANGE    *00180014
001900*    WILL BE EDITTED TO ENSURE THEY ARE VALID DATES.  ALL OTHER  *00190014
002000*    EDITS ARE DONE IN THE DESTINATION PROGRAMS WHEN THE         *00200014
002100*    'GO-TO' TYPE FUNCTION IS USED.                              *00210014
002200*                                                                *00220014
002300*    CICSAUTH WILL BE CALLED TO DETERMINE IF THE USER HAS THE    *00230014
002400*    AUTHORITY TO LOOK AT OR ENTER ANY STORE, OR IF THE STORE    *00240014
002500*    NUMBER WILL BE PROTECTED AND AUTOMATICALLY PRE-FILLED.      *00250014
002600*----------------------------------------------------------------*00260014
002700* 02/02/95 - TCM -  WR NO. 3289                                  *00270014
002800*    - ADD CODING TO 4000-BUILD-INITIAL-PANEL TO PROCESS         *00280014
002900*      LOCATION TYPE: RV - RETURN TO VENDOR                      *00290014
003000*----------------------------------------------------------------*00300014
003100* 06/26/96 - TCM -  WR NO. 3966                                  *00310014
003200*    - REPLACE PC-LOC-TYPE-HEADQUARTERS, PC-LOC-TYPE-DC,         *00320014
003300*      PC-LOC-TYPE-RV WITH APPROPRIATE PE049-LOCATION-TYPE-CODES *00330014
003400*    - ADD PE049-CENT-STK-LOC-TYP-CDE TO                         *00340014
003500*      4000-BUILD-INITIAL-PANEL PARAGRAPH PROCESSING             *00350014
003600*    - REPLACE ALL "++INCLUDE" REFERENCES WITH "COPY"            *00360014
003700*      REFERENCES, PER STANDARDS                                 *00370014
003800*----------------------------------------------------------------*00380014
003900* 02/04/98 - JIM ARENDT - WR NO. 5742                            *00390014
004000*    -  SPACED OUT COLS 73-80.                                   *00400014
004100*    -  CHANGED THE CALENDAR CALL TO USE DPWS500 CALENDAR        *00410014
004200*       ROUTINE NAME (DP500-KOHLS-CALENDAR-ROUTINE).             *00420014
004300*    -  ADDED DB2 CALL TO TABLE TSTR000 TO RETRIEVE "CS"(CENTRAL *00430014
004400*       STOCK) LOCATION FOR A GIVEN "DC"(DISTRIBUTION CENTER).   *00440014
004500*----------------------------------------------------------------*00450014
004600* 02/12/98 - LONNA HANNAN  WR NO. PO00161416                     *00460014
004700*    -  ADDED WHERE CONDITION TO 5000-GET-STORE-NAME TO EXCLUDE  *00470014
004800*       STORES THAT ARE NOT YET OPEN FOR RECIEVING.              *00480014
004900*    -  IF THE STORE IS NOT OPEN OR OPEN FOR RECIEVING, THE USER *00490014
005000*       SHOULD NOT BE ALLOWED TO CREATE AN IN-STORE PRICE CHANGE *00500014
005100*       FOR THAT STORE NUMBER.                                   *00510014
005200*----------------------------------------------------------------*00520014
005300* 12/01/99 - TCM -  WR NO. PM00331736                            *00530014
005400* BECAUSE OF MULTIPLE CENTRAL STOCK LOCATIONS AT A DC, WILL NO   *00540014
005500* LONGER DEFAULT THE DISPLAYED STORE NUMBER TO A DC'S CENTRAL    *00550014
005600* STOCK LOCATION IN 4200-CONTINUE.                               *00560014
005700*----------------------------------------------------------------*00570014
005800* 02/09/01 - JFK -  WR NO. 21963                                 *00580014
005900* ADDED RF CONTINUED CLEARANCE AND RETURN TO VENDOR SHORT DESCR. *00590014
006000*----------------------------------------------------------------*00600014
006100* 02/09/05 - TCM -  WR NO. 27559                                 *00610014
006200*    - CHANGED ALL STORE NUMBER LENGTH REFERENCES FROM 3 TO 4    *00620014
006300*      DIGITS IN LENGTH, REMOVING ANY UNNECESSARY STORE NUMBER   *00630014
006400*      WORKING-STORAGE FIELDS, AND ANY MISCELLANEOUS DEAD CODE   *00640014
006500*    - REPLACED TSTR000 STORE TABLE CALL(S) WITH STORE TABLE     *00650014
006600*      CALL(S) TO XST_LOC                                        *00660014
006700*    - CHANGED THE FILLER REDEFINES DP020-VARIABLE-COMMAREA      *00670014
006800*      FILLER LENGTH AND THE APPROPRIATE MNEMONIC LENGTH         *00680014
006900*    - REPLACED THE TSTR000-PERM-RLSE-AVL-NBR FIELD WITH A       *00690014
007000*      CALCULATED PV-PERM-RLSE-AVL-NBR FIELD                     *00700014
007100*    - ADDED THE NEW REASON CODE ("87") FOR                      *00710014
007200*      "COSMETICS TESTERS ONLY" IN-STORE DOCUMENTS               *00720014
007300*----------------------------------------------------------------*00730014
007400* 02/15/05 - TCM -  WR NO. 27559                                 *00740014
007500*    - IN 5000-GET-STORE-NAME GET THE LOCATION TYPE CODE,        *00750014
007600*      LOCATION NAME, AND LOCATION OPEN DATE.  BASED ON LOCATION *00760014
007700*      TYPE CODE, FOR DCS AND RVS CALCULATE THE PERM RELEASE     *00770014
007800*      AVAILABLE NUMBER FROM THE XST_LOC.OPN_DTE, FOR ALL OTHER  *00780014
007900*      TYPE CODES CALCULATE THE PERM RELEASE AVAILABLE NUMBER    *00790014
008000*      FROM THE OPEN FOR RECEIVING DATE                          *00800014
008100*      (XST_DC_LOC_ASGMT.EFF_BEG_DTE) IN                         *00810014
008200*      5050-GET-DS-RECEIVING-DATE.                               *00820014
008300*----------------------------------------------------------------*00830014
008400* 02/16/05 - TCM -  WR NO. 27559                                 *00840014
008500*    - IN 5050-GET-DS-RECEIVING-DATE SELECT THE MIN(EFF_BEG_DTE) *00850014
008600*      SO MULTIPLE (PAST,CURRENT,FUTURE) ROWS ARE NOT RETURNED,  *00860014
008700*      CAUSING A -811 SQL RETURN CODE                            *00870014
008800*----------------------------------------------------------------*00880014
008900* 04/18/05 - TCM -  WR NO. 27559                                 *00890014
009000*    - IN 5000-GET-STORE-NAME ADDED PE049-CENT-STK-LOC-TYP-CDE   *00900014
009100*      (CENTRAL STOCK) TO THE TEST THAT DETERMINES WHEN AN       *00910014
009200*      IN-STORE DOCUMENT COULD BE CREATED FOR A NON-DEPARTMENT   *00920014
009300*      STORE LOCATION                                            *00930014
009400*----------------------------------------------------------------*00940014
009500* 05/04/05 - TCM -  WR NO. 27559                                 *00950014
009600*    - CHANGED THE PROGRAM TO PASS ZEROS IN PE064-STORE-NUMBER   *00960014
009700*      IF NO STORE NUMBER IS ENTERED.  THIS WILL RETURN AN ERROR *00970014
009800*      IN THE ADD HEADER PROGRAM BECAUSE A "0" STORE NUMBER      *00980014
009900*      IN-STORE DOCUMENT IS NOT ALLOWED.                         *00990014
010000*----------------------------------------------------------------*01000014
010100* 10/26/05 - TCM -  WR NO. 28048                                 *01010014
010200*    - ADDED THE NEW REASON CODE ("89") FOR                      *01020014
010300*      "MARK OUT-OF-STOCK - SALVAGE" IN-STORE DOCUMENTS          *01030014
010400*----------------------------------------------------------------*01040014
010500* 07/30/09 - DEANNA BRANTNER INC000000888790                     *01050014
010600*    - IN 5050-GET-DS-RECEIVING-DATE, ADDED A CHECK FOR SQLCODE  *01060014
010700*      -305 IN ORDER TO HANDLE NULL VALUES.                      *01070014
010800*----------------------------------------------------------------*01080014
010810*  DATE 10/06/10 JACKIE HELING                                    01081014
010820*  BLOCK CERTAIN LOCATIONS FROM SENDING/RECEIVING TRANSFERS       01082014
010830*----------------------------------------------------------------*01083014
010831* WR39649 -  DAVID WELLER - 03/31/2011                            01083115
010832*            MLOF - DO NOT EXCLUDE LOCATIONS 807, 808 AND 809     01083216
010833***************************************************************** 01083316
010834*---------------------------------------------------------------* 01083416
010835* 09/14/2021 - GERMAN BANDA - CHG0261678                          01083517
010836* DESCRIPTION: CHANGE CALL OF DPKUT100 TO                         01083616
010837*              CALL DP010I-NUMERIC-EDIT-ROUTINE                   01083716
010838*              MAKING THE CALL DYNAMIC VS STATIC                  01083816
010839*---------------------------------------------------------------* 01083919
CICS  *  CHANGED 10/17/2022    BY BARB SCHULTZ    WR: CHG0276658        01084021
CICS  *                                                                 01084119
CICS  *  ADDED COPYBOOK DPWS930 AND MADE THE CICS ARCHITECTURE CALL     01084222
CICS  *  DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.      01084319
CICS  *---------------------------------------------------------------* 01084419
010840 ENVIRONMENT DIVISION.                                            01084619
010850 DATA DIVISION.                                                   01085014
010860                                                                  01086014
010870 WORKING-STORAGE SECTION.                                         01087014
010880*                                                                 01088014
010890 01  DK-DB2-KEYS.                                                 01089014
010900     05  DK-CURRENT-DATE-ISO       PIC  X(10)  VALUE SPACE.       01090014
011000     05  DK-DEPT-NUMBER            PIC  X(03)  VALUE SPACE.       01100014
011100     05  DK-OPERATING-COMPANY      PIC  X(02)  VALUE SPACE.       01110014
011200     05  DK-STORE-NUMBER           PIC S9(04)  VALUE ZEROS        01120014
011300                                               COMP.              01130014
011400     05  DK-USER-ID                PIC  X(08)  VALUE SPACE.       01140014
011500*                                                                 01150014
011600 01  PV-PROGRAM-VARIABLES.                                        01160014
011700     05  PV-CICS-RESPONSE          PIC S9(04)  VALUE  +0          01170014
011800                                               COMP SYNC.         01180014
011900     05  PV-RETRY-COUNTER          PIC S9(04)  VALUE  +0          01190014
012000                                               COMP SYNC.         01200014
012100     05  PV-STORE-NUMBER-N         PIC  9(04)  VALUE 0.           01210014
012200     05  PV-TYPE-REASON-CODE.                                     01220014
012300         10  PV-TYPE-CODE          PIC  9(01)  VALUE 0.           01230014
012400         10  PV-REASON-CODE        PIC  9(02)  VALUE 0.           01240014
012500     05  PV-VARIABLE               PIC S9(04)  VALUE 0.           01250014
012600     05  PV-PERM-RLSE-AVL-NBR      PIC  9(01)  VALUE 0.           01260014
012700*                                                                 01270014
012800 01  PC-PROGRAM-CONSTANTS.                                        01280014
012900     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE  'PE190A  '. 01290014
013000     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE  'PEKM190 '. 01300014
013100     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE  'PEKCS190'. 01310014
013200     05  PC-DEPT                   PIC  X(03)  VALUE  'DPT'.      01320014
013300     05  PC-CURRENT-OPERATING-COMPANY                             01330014
013400                                   PIC  X(03)  VALUE  '03'.       01340014
013500     05  PC-MAX-RETRIES            PIC S9(04)  VALUE  +3          01350014
013600                                               COMP.              01360014
013700     05  PC-PERM                   PIC  X(02)  VALUE  'PE'.       01370014
013800     05  PC-TSYMSG-NUMBERS.                                       01380014
013900         10  PC-TSYMSG-00007       PIC  9(05)  VALUE  00007.      01390014
014000         10  PC-TSYMSG-00008       PIC  9(05)  VALUE  00008.      01400014
014100         10  PC-TSYMSG-00009       PIC  9(05)  VALUE  00009.      01410014
014200         10  PC-TSYMSG-00017       PIC  9(05)  VALUE  00017.      01420014
014300         10  PC-TSYMSG-00022       PIC  9(05)  VALUE  00022.      01430014
014400         10  PC-TSYMSG-00032       PIC  9(05)  VALUE  00032.      01440014
014500         10  PC-TSYMSG-00132       PIC  9(05)  VALUE  00132.      01450014
014600         10  PC-TSYMSG-00395       PIC  9(05)  VALUE  00395.      01460014
014700         10  PC-TSYMSG-00527       PIC  9(05)  VALUE  00527.      01470014
014800         10  PC-TSYMSG-99903       PIC  9(05)  VALUE  99903.      01480014
014900         10  PC-TSYMSG-03685       PIC  9(05)  VALUE  03685.      01490014
015000*                                                                 01500014
015100 01  PS-PROGRAM-SWITCHES.                                         01510014
015200     05  PS-ERROR-SW               PIC  X(01)  VALUE  'N'.        01520014
015300         88  PS-ERROR                          VALUE  'Y'.        01530014
015400         88  PS-NO-ERROR                       VALUE  'N'.        01540014
015500     05  PS-RSN-CDE-SW             PIC  X(01)  VALUE  'N'.        01550014
015600         88  PS-VALID-RSN-CDE                  VALUE  'Y'.        01560014
015700         88  PS-INVALID-RSN-CDE                VALUE  'N'.        01570014
015800     05  PS-TYPE-CDE-SW            PIC  X(01)  VALUE  'N'.        01580014
015900         88  PS-VALID-TYPE-CDE                 VALUE  'Y'.        01590014
016000         88  PS-INVALID-TYPE-CDE               VALUE  'N'.        01600014
016100*---------------------------------------------------------------* 01610014
016200*    SELLING AND CUSTOMER SERVICE LOCATION TABLE                * 01620014
016300*---------------------------------------------------------------* 01630014
016400     EXEC SQL                                                     01640014
016500          INCLUDE XST00001                                        01650014
016600     END-EXEC.                                                    01660014
016700*--------------------------------------------------------------*  01670014
016800*    SELLING AND CUSTOMER SERVICE DC-LOCATION ASSIGNEMENT         01680014
016900*--------------------------------------------------------------*  01690014
017000     EXEC SQL                                                     01700014
017100         INCLUDE XST00020                                         01710014
017200     END-EXEC.                                                    01720014
017300*--------------------------------------------------------------*  01730014
017400*    DB2 MBS APPLICATION AVAILABILITY TABLE                       01740014
017500*--------------------------------------------------------------*  01750014
017600     EXEC SQL                                                     01760014
017700         INCLUDE TAPLAVL                                          01770014
017800     END-EXEC.                                                    01780014
017900*                                                                 01790014
018000*--------------------------------------------------------------*  01800014
018100*    DB2 MBS AREA TABLE                                           01810014
018200*--------------------------------------------------------------*  01820014
018300     EXEC SQL                                                     01830014
018400         INCLUDE TMDSEAR                                          01840014
018500     END-EXEC.                                                    01850014
018600*                                                                 01860014
018700*--------------------------------------------------------------*  01870014
018800*    DB2 COMMUNICATIONS AREA                                      01880014
018900*--------------------------------------------------------------*  01890014
019000     EXEC SQL                                                     01900014
019100         INCLUDE SQLCA                                            01910014
019200     END-EXEC.                                                    01920014
019300*                                                                 01930014
019400*----------------------------------------------------------------*01940014
019500*    MAP LAYOUT                                                  *01950014
019600*----------------------------------------------------------------*01960014
019700     COPY PEKM190.                                                01970014
019800*                                                                 01980014
019900*----------------------------------------------------------------*01990014
020000*    ATTRIBUTE SETTINGS COPYBOOK.                                *02000014
020100*----------------------------------------------------------------*02010014
020200     COPY DPWS015.                                                02020014
020300*                                                                 02030014
020400*----------------------------------------------------------------*02040014
020500*    DATE VALIDATION CALLING PARAMETER LIST                      *02050014
020600*----------------------------------------------------------------*02060014
020700     COPY DPWS500.                                                02070014
020800*                                                                 02080014
020900*----------------------------------------------------------------*02090014
021000*    PERM PC CONSTANT VALUES                                     *02100014
021100*----------------------------------------------------------------*02110014
021200     COPY PEWS049.                                                02120014
021300*----------------------------------------------------------------*02130014
021400*  LIST OF LOCATION EXCLUSIONS                                    02140014
021500*----------------------------------------------------------------*02150014
021600     COPY PEWS006.                                                02160014
021700*----------------------------------------------------------------*02170014
021800*    COMMAREA AND WORKING STORAGE VARIABLES REQUIRED FOR THE     *02180014
021900*    SECURITY SUBROUTINE (CICSAUTH)                              *02190014
022000*----------------------------------------------------------------*02200014
022100     COPY DPWS008.                                                02210014
022200*                                                                 02220014
022300*----------------------------------------------------------------*02230014
022400*    FUNCTION KEYS COPYBOOK                                      *02240014
022500*----------------------------------------------------------------*02250014
022600     COPY DPWS016.                                                02260014
022700*                                                                 02270014
022800*----------------------------------------------------------------*02280014
022900*    CURRENT DATE/TIME COPYBOOK                                  *02290014
023000*----------------------------------------------------------------*02300014
023100     COPY DPWS017.                                                02310014
023200*                                                                 02320014
023300*----------------------------------------------------------------*02330014
023400*  THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT    **02340014
023500*  SUB-ROUTINE (DPKUT100).                                      **02350014
023600*----------------------------------------------------------------*02360014
023700     COPY DPWS010I.                                               02370014
023800*                                                                 02380014
023900*----------------------------------------------------------------*02390014
CICS  *  PARAMETERS FOR CALLING THE CICS ARCHITECTURE API.            **02400019
024200*----------------------------------------------------------------*02420014
024300     COPY DPWS030.                                                02430014
CICS       COPY DPWS930.                                                02431019
024400*                                                                 02440014
024500*----------------------------------------------------------------*02450014
024600*    STANDARD COMMAREA.                                           02460014
024700*----------------------------------------------------------------*02470014
024800     COPY DPWS020.                                                02480014
024900     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                02490014
025000*                                                                 02500014
025100*----------------------------------------------------------------*02510014
025200*    INTER-APPLICATION COMMAREA.                                  02520014
025300*----------------------------------------------------------------*02530014
025400         10  INTER-APPL-COMMAREA  PIC X(200).                     02540014
025500*                                                                 02550014
025600*----------------------------------------------------------------*02560014
025700*    INTER-APPLICATION COMMAREA TO BE PASSED TO THE GO-TO TYPE    02570014
025800*    PROGRAMS.                                                    02580014
025900*----------------------------------------------------------------*02590014
026000     COPY PEWS064.                                                02600014
026100*                                                                 02610014
026200*----------------------------------------------------------------*02620014
026300*    SPECIFIC COMMMAREA FOR PEKCS190.                             02630014
026400*----------------------------------------------------------------*02640014
026500         10  ASC-SPECIFIC-COMMAREA.                               02650014
026600             15  ASC-STORE-NUMBER            PIC  X(04).          02660014
026700             15  FILLER REDEFINES ASC-STORE-NUMBER.               02670014
026800                 20  ASC-STORE-NUMBER-N      PIC  9(04).          02680014
026900             15  ASC-STORE-NAME              PIC  X(25).          02690014
027000             15  ASC-DOCUMENT-NUMBER         PIC  X(07).          02700014
027100             15  FILLER  REDEFINES  ASC-DOCUMENT-NUMBER.          02710014
027200                 20  ASC-DOCUMENT-NUMBER-N   PIC  9(07).          02720014
027300             15  ASC-DEPT-NUMBER             PIC  X(03).          02730014
027400             15  FILLER  REDEFINES  ASC-DEPT-NUMBER.              02740014
027500                 20  ASC-DEPT-NUMBER-N       PIC  9(03).          02750014
027600             15  ASC-DEPT-DESC               PIC  X(14).          02760014
027700             15  ASC-STATUS-CODE             PIC  X(02).          02770014
027800             15  ASC-STATUS-DESC             PIC  X(12).          02780014
027900             15  ASC-REASON-CODE             PIC  X(03).          02790014
028000             15  FILLER  REDEFINES  ASC-REASON-CODE.              02800014
028100                 20  ASC-REASON-CODE-N       PIC  9(03).          02810014
028200             15  ASC-TYPE-DESC               PIC  X(10).          02820014
028300             15  ASC-REASON-DESC             PIC  X(12).          02830014
028400             15  ASC-DATE-RANGE-FROM.                             02840014
028500                 20  ASC-MONTH-FROM          PIC  X(02).          02850014
028600                 20  ASC-DAY-FROM            PIC  X(02).          02860014
028700                 20  ASC-YEAR-FROM           PIC  X(02).          02870014
028800             15  FILLER  REDEFINES  ASC-DATE-RANGE-FROM.          02880014
028900                 20  ASC-MONTH-FROM-N        PIC  9(02).          02890014
029000                 20  ASC-DAY-FROM-N          PIC  9(02).          02900014
029100                 20  ASC-YEAR-FROM-N         PIC  9(02).          02910014
029200             15  ASC-DATE-RANGE-FROM-ISO     PIC  X(10).          02920014
029300             15  ASC-DATE-RANGE-TO.                               02930014
029400                 20  ASC-MONTH-TO            PIC  X(02).          02940014
029500                                                                  02950014
029600                 20  ASC-DAY-TO              PIC  X(02).          02960014
029700                 20  ASC-YEAR-TO             PIC  X(02).          02970014
029800             15  FILLER  REDEFINES  ASC-DATE-RANGE-TO.            02980014
029900                 20  ASC-MONTH-TO-N          PIC  9(02).          02990014
030000                 20  ASC-DAY-TO-N            PIC  9(02).          03000014
030100                 20  ASC-YEAR-TO-N           PIC  9(02).          03010014
030200             15  ASC-DATE-RANGE-TO-ISO       PIC  X(10).          03020014
030300             15  ASC-STORE-TERMIMAL-SW       PIC  X(01).          03030014
030400                 88  ASC-STORE-TERMINAL      VALUE 'Y'.           03040014
030500                 88  ASC-NON-STORE-TERMINAL  VALUE 'N'.           03050014
030600             15  ASC-DATE-FROM-ENTERED-SW    PIC  X(01).          03060014
030700                 88  ASC-DATE-FROM-ENTERED   VALUE 'Y'.           03070014
030800                 88  ASC-DATE-FROM-NOT-ENTERED                    03080014
030900                                             VALUE 'N'.           03090014
031000             15  ASC-DATE-FROM-MO-ENTERED-SW PIC  X(01).          03100014
031100                 88  ASC-DATE-FROM-MO-ENTERED                     03110014
031200                                             VALUE 'Y'.           03120014
031300                 88  ASC-DATE-FROM-MO-NOT-ENTERED                 03130014
031400                                             VALUE 'N'.           03140014
031500             15  ASC-DATE-FROM-DA-ENTERED-SW PIC  X(01).          03150014
031600                 88  ASC-DATE-FROM-DA-ENTERED                     03160014
031700                                             VALUE 'Y'.           03170014
031800                 88  ASC-DATE-FROM-DA-NOT-ENTERED                 03180014
031900                                             VALUE 'N'.           03190014
032000             15  ASC-DATE-FROM-YR-ENTERED-SW PIC  X(01).          03200014
032100                 88  ASC-DATE-FROM-YR-ENTERED                     03210014
032200                                             VALUE 'Y'.           03220014
032300                 88  ASC-DATE-FROM-YR-NOT-ENTERED                 03230014
032400                                             VALUE 'N'.           03240014
032500             15  ASC-DATE-TO-ENTERED-SW      PIC  X(01).          03250014
032600                 88  ASC-DATE-TO-ENTERED     VALUE 'Y'.           03260014
032700                 88  ASC-DATE-TO-NOT-ENTERED VALUE 'N'.           03270014
032800             15  ASC-DATE-TO-MO-ENTERED-SW   PIC  X(01).          03280014
032900                 88  ASC-DATE-TO-MO-ENTERED  VALUE 'Y'.           03290014
033000                 88  ASC-DATE-TO-MO-NOT-ENTERED                   03300014
033100                                             VALUE 'N'.           03310014
033200             15  ASC-DATE-TO-DA-ENTERED-SW   PIC  X(01).          03320014
033300                 88  ASC-DATE-TO-DA-ENTERED  VALUE 'Y'.           03330014
033400                 88  ASC-DATE-TO-DA-NOT-ENTERED                   03340014
033500                                             VALUE 'N'.           03350014
033600             15  ASC-DATE-TO-YR-ENTERED-SW   PIC  X(01).          03360014
033700                 88  ASC-DATE-TO-YR-ENTERED  VALUE 'Y'.           03370014
033800                 88  ASC-DATE-TO-YR-NOT-ENTERED                   03380014
033900                                             VALUE 'N'.           03390014
034000         10  FILLER                          PIC  X(2732).        03400014
034100*                                                                 03410014
034200*----------------------------------------------------------------*03420014
034300*    ABEND PROCESSING COPYBOOK.                                  *03430014
034400*----------------------------------------------------------------*03440014
034500     COPY DPWS013.                                                03450014
034600*                                                                 03460014
034700 LINKAGE SECTION.                                                 03470014
034800                                                                  03480014
034900 01  DFHCOMMAREA.                                                 03490014
035000     05  FILLER                         OCCURS  1 TO 4072 TIMES   03500014
035100                                        DEPENDING ON EIBCALEN.    03510014
035200         10  FILLER                     PIC X.                    03520014
035300                                                                  03530014
035400 PROCEDURE DIVISION.                                              03540014
035500*----------------------------------------------------------------*03550014
035600*  THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** 03560014
035700*  THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  ** 03570014
035800*  MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            ** 03580014
035900*                                                              ** 03590014
036000*  THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  ** 03600014
036100*  LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       ** 03610014
036200*----------------------------------------------------------------*03620014
036300 0000-MAIN-MODULE.                                                03630014
036400                                                                  03640014
036500     INITIALIZE DP030-CICS-API-FIELDS.                            03650014
036600     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       03660014
036700     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          03670014
036800     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         03680014
036900     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       03690014
037000     MOVE LENGTH OF PE190AI        TO DP030-MAP-LENGTH (1).       03700014
037100     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     03710014
037200     PERFORM 0001-CALL-CICS-ARCH-API.                             03720014
037300*                                                                 03730014
037400     PERFORM 1000-CONTROL-PROCESSING                              03740014
037500*                                                                 03750014
037600     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     03760014
037700     PERFORM 0001-CALL-CICS-ARCH-API.                             03770014
037800                                                                  03780014
037900 0001-CALL-CICS-ARCH-API.                                         03790014
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      03800019
038100                                    DFHCOMMAREA                   03810018
038200                                    DP030-CICS-API-FIELDS         03820018
038300                                    DP020-STANDARD-COMMAREA       03830018
038400                                    PE190AI.                      03840018
038500*                                                                 03850014
038600     IF  DP030-RC-CALL-SUCCESSFUL                                 03860014
038700         CONTINUE                                                 03870014
038800     ELSE                                                         03880014
038900         SET DP013-NO-ROLLBACK                                    03890014
039000             DP013-XCTL-DISPLAY-RESTART                           03900014
039100             DP013-CICS-ABEND      TO TRUE                        03910014
039200         MOVE 'BEFORE 0000-MAIN-MODULE'                           03920014
039300                                   TO DP013-PARAGRAPH             03930014
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O03940019
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      03950019
039600         MOVE DP030-RETURN-CODE                                   03960014
039700                                   TO DP013-MESSAGE-TEXT (3)      03970014
039800         PERFORM DP013-0000-PROCESS-ABEND                         03980014
039900     END-IF.                                                      03990014
040000*                                                                 04000014
040100*----------------------------------------------------------------*04010014
040200*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *04020014
040300*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *04030014
040400*----------------------------------------------------------------*04040014
040500 1000-CONTROL-PROCESSING.                                         04050014
040600                                                                  04060014
040700     PERFORM DP017-0000-GET-CURR-DATE-TIME.                       04070014
040800     MOVE DP017-EDITED-DATE-YYYYMMDD                              04080014
040900                                   TO DK-CURRENT-DATE-ISO.        04090014
041000     MOVE DP020-USERID             TO DK-USER-ID.                 04100014
041100     MOVE DP020-OPERATING-COMPANY  TO DK-OPERATING-COMPANY.       04110014
041200     EVALUATE TRUE                                                04120014
041300         WHEN DP020-NEXT-ACT-INITIAL                              04130014
041400             INITIALIZE ASC-SPECIFIC-COMMAREA                     04140014
041500             PERFORM 4000-BUILD-INITIAL-PANEL                     04150014
041600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 04160014
041700                                                                  04170014
041800         WHEN DP020-NEXT-ACT-READ-MAP                             04180014
041900             PERFORM 2000-FKEY-PROCESSING                         04190014
042000                                                                  04200014
042100         WHEN DP020-NEXT-ACT-RETURN                               04210014
042200             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   04220014
042300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 04230014
042400                                                                  04240014
042500         WHEN OTHER                                               04250014
042600             SET DP013-LOGIC-ABEND                                04260014
042700                 DP013-NO-ROLLBACK TO TRUE                        04270014
042800             MOVE '1000-CONTROL-PROCESSING'                       04280014
042900                                   TO  DP013-PARAGRAPH            04290014
043000             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   04300014
043100                                   TO  DP013-MESSAGE-TEXT(1)      04310014
043200             MOVE DP020-NEXT-APPL-ACTIVITY                        04320014
043300                                   TO DP013-MESSAGE-TEXT(2)       04330014
043400             PERFORM DP013-0000-PROCESS-ABEND                     04340014
043500     END-EVALUATE.                                                04350014
043600*                                                                 04360014
043700*----------------------------------------------------------------*04370014
043800* FURTHER DETERMINE PROCESSING PATH BASED ON FUNCTION KEY ACTIONS*04380014
043900* SPECIFIC FUNCTION KEYS LISTED HERE ARE ACTED UPON REGARDLESS OF*04390014
044000* EDITS.                                                         *04400014
044100*----------------------------------------------------------------*04410014
044200 2000-FKEY-PROCESSING.                                            04420014
044300                                                                  04430014
044400     EVALUATE TRUE                                                04440014
044500                                                                  04450014
044600         WHEN DP020-SRC-AID = DP016-CLEAR                         04460014
044700             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   04470014
044800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 04480014
044900                                                                  04490014
045000         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     04500014
045100             INITIALIZE ASC-SPECIFIC-COMMAREA                     04510014
045200             PERFORM 4000-BUILD-INITIAL-PANEL                     04520014
045300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 04530014
045400             PERFORM 3200-RESET-ATTRIBUTES                        04540014
045500                                                                  04550014
045600         WHEN OTHER                                               04560014
045700             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 04570014
045800             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   04580014
045900             PERFORM 2100-CHECK-FUNCTION-KEY                      04590014
046000     END-EVALUATE.                                                04600014
046100*                                                                 04610014
046200*----------------------------------------------------------------*04620014
046300*  ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED     **04630014
046400*  FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED **04640014
046500*  FROM THE CICS ARCHITECTURE API.                              **04650014
046600*----------------------------------------------------------------*04660014
046700 2100-CHECK-FUNCTION-KEY.                                         04670014
046800                                                                  04680014
046900     EVALUATE TRUE                                                04690014
047000         WHEN DP020-FK-LOCAL-GOTO (DP020-SRC-AID)                 04700014
047100             IF PS-NO-ERROR                                       04710014
047200                 SET DP030-CONTINUE-GO TO TRUE                    04720014
047300                 PERFORM 2110-PREPARE-INTER-APPL-COMM             04730014
047400             ELSE                                                 04740014
047500                 SET DP030-OVERRIDE-GO TO TRUE                    04750014
047600             END-IF                                               04760014
047700                                                                  04770014
047800         WHEN DP020-SRC-AID = DP016-ENTER                         04780014
047900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 04790014
048000                                                                  04800014
048100         WHEN OTHER                                               04810014
048200             SET DP013-NO-ROLLBACK                                04820014
048300                 DP013-XCTL-DISPLAY-RESTART                       04830014
048400                 DP013-CICS-ABEND  TO TRUE                        04840014
048500             MOVE '2100-CHECK-FUNCTION-KEY'                       04850014
048600                                   TO DP013-PARAGRAPH             04860014
048700             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      04870014
048800                                   TO DP013-MESSAGE-TEXT (1)      04880014
048900             PERFORM DP013-0000-PROCESS-ABEND                     04890014
049000     END-EVALUATE.                                                04900014
049100*                                                                 04910014
049200*----------------------------------------------------------------*04920014
049300*  MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE   **04930014
049400*  INTER-APPLICATION COMMAREA.                                  **04940014
049500*----------------------------------------------------------------*04950014
049600 2110-PREPARE-INTER-APPL-COMM.                                    04960014
049700                                                                  04970014
049800     INITIALIZE PE064-INTER-APPL-COMMAREA.                        04980014
049900     IF ASC-STORE-NUMBER = SPACES                                 04990014
050000         MOVE ZEROS                TO PE064-STORE-NUMBER          05000014
050100     ELSE                                                         05010014
050200         MOVE ASC-STORE-NUMBER-N   TO PE064-STORE-NUMBER          05020014
050300     END-IF.                                                      05030014
050400     MOVE ASC-STORE-NAME           TO PE064-STORE-NAME.           05040014
050500     MOVE ASC-DOCUMENT-NUMBER      TO PE064-DOCUMENT-NUMBER.      05050014
050600     MOVE ASC-DEPT-NUMBER          TO PE064-DEPT-NUMBER.          05060014
050700     MOVE ASC-STATUS-CODE          TO PE064-STATUS-CODE.          05070014
050800     MOVE ASC-REASON-CODE          TO PE064-REASON-CODE.          05080014
050900     MOVE ASC-DATE-RANGE-FROM-ISO  TO PE064-DATE-FROM.            05090014
051000     MOVE ASC-DATE-RANGE-TO-ISO    TO PE064-DATE-TO.              05100014
051100*                                                                 05110014
051200*----------------------------------------------------------------*05120014
051300* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS IN*05130014
051400* THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN THE  *05140014
051500* APPLICATION-SPECIFIC COMMAREA, NOT ON THE SCREEN.              *05150014
051600*----------------------------------------------------------------*05160014
051700 2200-MOVE-SCREEN-TO-COMMAREA.                                    05170014
051800                                                                  05180014
051900     IF  ASTRNL > ZERO                                            05190014
052000         MOVE ASTRNI               TO ASC-STORE-NUMBER            05200014
052100     ELSE                                                         05210014
052200         IF  ASTRNF = DP015-ERASE-EOF                             05220014
052300             MOVE SPACES           TO ASC-STORE-NUMBER            05230014
052400         END-IF                                                   05240014
052500     END-IF.                                                      05250014
052600                                                                  05260014
052700     IF  ADOCNL > ZERO                                            05270014
052800         MOVE ADOCNI               TO ASC-DOCUMENT-NUMBER         05280014
052900     ELSE                                                         05290014
053000         IF  ADOCNF = DP015-ERASE-EOF                             05300014
053100             MOVE SPACE            TO ASC-DOCUMENT-NUMBER         05310014
053200         END-IF                                                   05320014
053300     END-IF.                                                      05330014
053400                                                                  05340014
053500     IF  ADEPTL > ZERO                                            05350014
053600         MOVE ADEPTI               TO ASC-DEPT-NUMBER             05360014
053700     ELSE                                                         05370014
053800         IF  ADEPTF = DP015-ERASE-EOF                             05380014
053900             MOVE SPACE            TO ASC-DEPT-NUMBER             05390014
054000         END-IF                                                   05400014
054100     END-IF.                                                      05410014
054200                                                                  05420014
054300     IF  ASTATL > ZERO                                            05430014
054400         MOVE ASTATI               TO ASC-STATUS-CODE             05440014
054500     ELSE                                                         05450014
054600         IF  ASTATF = DP015-ERASE-EOF                             05460014
054700             MOVE SPACE            TO ASC-STATUS-CODE             05470014
054800         END-IF                                                   05480014
054900     END-IF.                                                      05490014
055000                                                                  05500014
055100     IF  ARSNL > ZERO                                             05510014
055200         MOVE ARSNI                TO ASC-REASON-CODE             05520014
055300     ELSE                                                         05530014
055400         IF  ARSNF = DP015-ERASE-EOF                              05540014
055500             MOVE SPACE            TO ASC-REASON-CODE             05550014
055600         END-IF                                                   05560014
055700     END-IF.                                                      05570014
055800                                                                  05580014
055900     IF  AMOFRL > ZERO                                            05590014
056000         MOVE AMOFRI               TO ASC-MONTH-FROM              05600014
056100     ELSE                                                         05610014
056200         IF  AMOFRF = DP015-ERASE-EOF                             05620014
056300             MOVE SPACE            TO ASC-MONTH-FROM              05630014
056400         END-IF                                                   05640014
056500     END-IF.                                                      05650014
056600                                                                  05660014
056700     IF  ADAFRL > ZERO                                            05670014
056800         MOVE ADAFRI               TO ASC-DAY-FROM                05680014
056900     ELSE                                                         05690014
057000         IF  ADAFRF = DP015-ERASE-EOF                             05700014
057100             MOVE SPACE            TO ASC-DAY-FROM                05710014
057200         END-IF                                                   05720014
057300     END-IF.                                                      05730014
057400                                                                  05740014
057500     IF  AYRFRL > ZERO                                            05750014
057600         MOVE AYRFRI               TO ASC-YEAR-FROM               05760014
057700     ELSE                                                         05770014
057800         IF  AYRFRF = DP015-ERASE-EOF                             05780014
057900             MOVE SPACE            TO ASC-YEAR-FROM               05790014
058000         END-IF                                                   05800014
058100     END-IF.                                                      05810014
058200                                                                  05820014
058300     IF  AMOTOL > ZERO                                            05830014
058400         MOVE AMOTOI               TO ASC-MONTH-TO                05840014
058500     ELSE                                                         05850014
058600         IF  AMOTOF = DP015-ERASE-EOF                             05860014
058700             MOVE SPACE            TO ASC-MONTH-TO                05870014
058800         END-IF                                                   05880014
058900     END-IF.                                                      05890014
059000                                                                  05900014
059100     IF  ADATOL > ZERO                                            05910014
059200         MOVE ADATOI               TO ASC-DAY-TO                  05920014
059300     ELSE                                                         05930014
059400         IF  ADATOF = DP015-ERASE-EOF                             05940014
059500             MOVE SPACE            TO ASC-DAY-TO                  05950014
059600         END-IF                                                   05960014
059700     END-IF.                                                      05970014
059800                                                                  05980014
059900     IF  AYRTOL > ZERO                                            05990014
060000         MOVE AYRTOI               TO ASC-YEAR-TO                 06000014
060100     ELSE                                                         06010014
060200         IF  AYRTOF = DP015-ERASE-EOF                             06020014
060300             MOVE SPACE            TO ASC-YEAR-TO                 06030014
060400         END-IF                                                   06040014
060500     END-IF.                                                      06050014
060600*                                                                 06060014
060700*----------------------------------------------------------------*06070014
060800* ENSURE THE DATA IS CORRECT.  NOTE THAT IN A CRITERIA SPECIFI-  *06080014
060900* CATION SCREEN ONLY MINIMAL EDITS ARE DONE.  EDITS RELATED TO   *06090014
061000* A SPECIFIC SCREEN THAT THE USER IS GOING TO (LOCAL-GO) ARE DONE*06100014
061100* IN THE DESTINATION PROGRAM, NOT HERE.                          *06110014
061200*----------------------------------------------------------------*06120014
061300 3000-EDIT-DATA-IN-COMMAREA.                                      06130014
061400                                                                  06140014
061500     PERFORM 3200-RESET-ATTRIBUTES.                               06150014
061600*                                                                 06160014
061700     SET ASC-DATE-FROM-NOT-ENTERED                                06170014
061800         ASC-DATE-FROM-MO-NOT-ENTERED                             06180014
061900         ASC-DATE-FROM-DA-NOT-ENTERED                             06190014
062000         ASC-DATE-FROM-YR-NOT-ENTERED                             06200014
062100                                   TO TRUE.                       06210014
062200     IF  ASC-MONTH-FROM > SPACE                                   06220014
062300         MOVE ASC-MONTH-FROM       TO DP010I-UNEDITED-FIELD       06230014
062400         MOVE LENGTH OF ASC-MONTH-FROM                            06240014
062500                                   TO DP010I-MAXIMUM-DIGITS       06250014
062600         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     06260014
062700         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  06270014
062810         CALL DP010I-NUMERIC-EDIT-ROUTINE                         06281016
062820                         USING DP010I-NUMERIC-EDIT-AREA           06282016
062900         IF  DP010I-ERROR-DETECTED                                06290014
063000             SET PS-ERROR                                         06300014
063100                 DP020-MSG-FATAL                                  06310014
063200                 DP030-SET-CURSOR-APPL-1 TO TRUE                  06320014
063300             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            06330014
063400             MOVE DP015-UNP-ALP-BRT-OFF                           06340014
063500                                   TO AMOFRA                      06350014
063600             MOVE DP015-RED        TO AMOFRC                      06360014
063700             MOVE DP015-REVERSE    TO AMOFRH                      06370014
063800             MOVE -1               TO AMOFRL                      06380014
063900         ELSE                                                     06390014
064000             MOVE DP010I-NUMERIC-FIELD                            06400014
064100                                   TO ASC-MONTH-FROM-N            06410014
064200             SET ASC-DATE-FROM-MO-ENTERED                         06420014
064300                                   TO TRUE                        06430014
064400         END-IF                                                   06440014
064500     END-IF.                                                      06450014
064600*                                                                 06460014
064700     IF  ASC-DAY-FROM > SPACE                                     06470014
064800         MOVE ASC-DAY-FROM         TO DP010I-UNEDITED-FIELD       06480014
064900         MOVE LENGTH OF ASC-DAY-FROM                              06490014
065000                                   TO DP010I-MAXIMUM-DIGITS       06500014
065100         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     06510014
065200         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  06520014
065310         CALL DP010I-NUMERIC-EDIT-ROUTINE                         06531016
065320                         USING DP010I-NUMERIC-EDIT-AREA           06532016
065400         IF  DP010I-ERROR-DETECTED                                06540014
065500             SET PS-ERROR                                         06550014
065600                 DP020-MSG-FATAL                                  06560014
065700                 DP030-SET-CURSOR-APPL-1 TO TRUE                  06570014
065800             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            06580014
065900             MOVE DP015-UNP-ALP-BRT-OFF                           06590014
066000                                   TO ADAFRA                      06600014
066100             MOVE DP015-RED        TO ADAFRC                      06610014
066200             MOVE DP015-REVERSE    TO ADAFRH                      06620014
066300             MOVE -1               TO ADAFRL                      06630014
066400         ELSE                                                     06640014
066500             SET ASC-DATE-FROM-DA-ENTERED                         06650014
066600                                   TO TRUE                        06660014
066700             MOVE DP010I-NUMERIC-FIELD                            06670014
066800                                   TO ASC-DAY-FROM-N              06680014
066900         END-IF                                                   06690014
067000     END-IF.                                                      06700014
067100*                                                                 06710014
067200     IF  ASC-YEAR-FROM > SPACE                                    06720014
067300         MOVE ASC-YEAR-FROM        TO DP010I-UNEDITED-FIELD       06730014
067400         MOVE LENGTH OF ASC-YEAR-FROM                             06740014
067500                                   TO DP010I-MAXIMUM-DIGITS       06750014
067600         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     06760014
067700         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  06770014
067810         CALL DP010I-NUMERIC-EDIT-ROUTINE                         06781016
067820                         USING DP010I-NUMERIC-EDIT-AREA           06782016
067900         IF  DP010I-ERROR-DETECTED                                06790014
068000             SET PS-ERROR                                         06800014
068100                 DP020-MSG-FATAL                                  06810014
068200                 DP030-SET-CURSOR-APPL-1 TO TRUE                  06820014
068300             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            06830014
068400             MOVE DP015-UNP-ALP-BRT-OFF                           06840014
068500                                   TO AYRFRA                      06850014
068600             MOVE DP015-RED        TO AYRFRC                      06860014
068700             MOVE DP015-REVERSE    TO AYRFRH                      06870014
068800             MOVE -1               TO AYRFRL                      06880014
068900         ELSE                                                     06890014
069000             SET ASC-DATE-FROM-YR-ENTERED                         06900014
069100                                   TO TRUE                        06910014
069200             MOVE DP010I-NUMERIC-FIELD                            06920014
069300                                   TO ASC-YEAR-FROM-N             06930014
069400         END-IF                                                   06940014
069500     END-IF.                                                      06950014
069600                                                                  06960014
069700     IF (ASC-DATE-FROM-MO-ENTERED                                 06970014
069800     AND ASC-DATE-FROM-DA-ENTERED                                 06980014
069900     AND ASC-DATE-FROM-YR-ENTERED)                                06990014
070000         SET ASC-DATE-FROM-ENTERED TO TRUE                        07000014
070100     ELSE                                                         07010014
070200         IF (ASC-DATE-FROM-MO-NOT-ENTERED                         07020014
070300         AND ASC-DATE-FROM-DA-NOT-ENTERED                         07030014
070400         AND ASC-DATE-FROM-YR-NOT-ENTERED)                        07040014
070500             CONTINUE                                             07050014
070600         ELSE                                                     07060014
070700             SET PS-ERROR                                         07070014
070800                 DP020-MSG-FATAL                                  07080014
070900                 DP030-SET-CURSOR-APPL-1 TO TRUE                  07090014
071000             MOVE PC-TSYMSG-00009  TO DP020-MSG-NUMBER            07100014
071100             MOVE DP015-UNP-ALP-BRT-OFF                           07110014
071200                                   TO AMOFRA                      07120014
071300                                      ADAFRA                      07130014
071400                                      AYRFRA                      07140014
071500             MOVE DP015-RED        TO AMOFRC                      07150014
071600                                      ADAFRC                      07160014
071700                                      AYRFRC                      07170014
071800             MOVE DP015-REVERSE    TO AMOFRH                      07180014
071900                                      ADAFRH                      07190014
072000                                      AYRFRH                      07200014
072100             MOVE -1               TO AMOFRL                      07210014
072200         END-IF                                                   07220014
072300     END-IF.                                                      07230014
072400                                                                  07240014
072500     IF ASC-DATE-FROM-ENTERED                                     07250014
072600         MOVE DP017-CURRENT-DATE-YMD                              07260014
072700                                   TO DPG51-SYSTEM-DATE           07270014
072800         MOVE ASC-DATE-RANGE-FROM  TO DPG52-LK-DATE-INPUT         07280014
072900         SET DPG52-LK-DTE-GREG                                    07290014
073000             DPG51-ACTUAL-CALENDAR-ONLY                           07300014
073100             DPG51-DO-NOT-INCR-DECR-DATE TO TRUE                  07310014
073200                                                                  07320014
073300         CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52      07330014
073400                                                 DPG53 DPG54      07340014
073500                                                 DPG55 DPG56      07350014
073600                                                                  07360014
073700         EVALUATE TRUE                                            07370014
073800             WHEN DPG54-SEVERE-ERROR                              07380014
073900             WHEN DPG54-DATE-INVALID                              07390014
074000                 SET PS-ERROR                                     07400014
074100                     DP020-MSG-FATAL                              07410014
074200                     DP030-SET-CURSOR-APPL-1                      07420014
074300                     ASC-DATE-FROM-NOT-ENTERED                    07430014
074400                                   TO TRUE                        07440014
074500                 MOVE PC-TSYMSG-00009                             07450014
074600                                   TO DP020-MSG-NUMBER            07460014
074700                 MOVE DP015-UNP-ALP-BRT-OFF                       07470014
074800                                   TO AMOFRA                      07480014
074900                                      ADAFRA                      07490014
075000                                      AYRFRA                      07500014
075100                 MOVE DP015-RED    TO AMOFRC                      07510014
075200                                      ADAFRC                      07520014
075300                                      AYRFRC                      07530014
075400                 MOVE DP015-REVERSE                               07540014
075500                                   TO AMOFRH                      07550014
075600                                      ADAFRH                      07560014
075700                                      AYRFRH                      07570014
075800                 MOVE -1           TO AMOFRL                      07580014
075900             WHEN OTHER                                           07590014
076000                 MOVE DPG55-GREG-DATE                             07600014
076100                                   TO ASC-DATE-RANGE-FROM         07610014
076200                 MOVE DPG55-DB2-ISO-DATE-FMT                      07620014
076300                                   TO ASC-DATE-RANGE-FROM-ISO     07630014
076400         END-EVALUATE                                             07640014
076500     ELSE                                                         07650014
076600         MOVE SPACES               TO ASC-DATE-RANGE-FROM-ISO     07660014
076700     END-IF.                                                      07670014
076800*                                                                 07680014
076900     SET ASC-DATE-TO-NOT-ENTERED                                  07690014
077000         ASC-DATE-TO-MO-NOT-ENTERED                               07700014
077100         ASC-DATE-TO-DA-NOT-ENTERED                               07710014
077200         ASC-DATE-TO-YR-NOT-ENTERED                               07720014
077300                                   TO TRUE.                       07730014
077400     IF  ASC-MONTH-TO > SPACE                                     07740014
077500         MOVE ASC-MONTH-TO         TO DP010I-UNEDITED-FIELD       07750014
077600         MOVE LENGTH OF ASC-MONTH-TO                              07760014
077700                                   TO DP010I-MAXIMUM-DIGITS       07770014
077800         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     07780014
077900         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  07790014
078010         CALL DP010I-NUMERIC-EDIT-ROUTINE                         07801016
078020                         USING DP010I-NUMERIC-EDIT-AREA           07802016
078100         IF  DP010I-ERROR-DETECTED                                07810014
078200             SET PS-ERROR                                         07820014
078300                 DP020-MSG-FATAL                                  07830014
078400                 DP030-SET-CURSOR-APPL-1 TO TRUE                  07840014
078500             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            07850014
078600             MOVE DP015-UNP-ALP-BRT-OFF                           07860014
078700                                   TO AMOTOA                      07870014
078800             MOVE DP015-RED        TO AMOTOC                      07880014
078900             MOVE DP015-REVERSE    TO AMOTOH                      07890014
079000             MOVE -1               TO AMOTOL                      07900014
079100         ELSE                                                     07910014
079200             SET ASC-DATE-TO-MO-ENTERED                           07920014
079300                                   TO TRUE                        07930014
079400             MOVE DP010I-NUMERIC-FIELD                            07940014
079500                                   TO ASC-MONTH-TO-N              07950014
079600         END-IF                                                   07960014
079700     END-IF.                                                      07970014
079800*                                                                 07980014
079900     IF  ASC-DAY-TO > SPACE                                       07990014
080000         MOVE ASC-DAY-TO           TO DP010I-UNEDITED-FIELD       08000014
080100         MOVE LENGTH OF ASC-DAY-TO TO DP010I-MAXIMUM-DIGITS       08010014
080200         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     08020014
080300         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  08030014
080410         CALL DP010I-NUMERIC-EDIT-ROUTINE                         08041016
080420                         USING DP010I-NUMERIC-EDIT-AREA           08042016
080500         IF  DP010I-ERROR-DETECTED                                08050014
080600             SET PS-ERROR                                         08060014
080700                 DP020-MSG-FATAL                                  08070014
080800                 DP030-SET-CURSOR-APPL-1 TO TRUE                  08080014
080900             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            08090014
081000             MOVE DP015-UNP-ALP-BRT-OFF                           08100014
081100                                   TO ADATOA                      08110014
081200             MOVE DP015-RED        TO ADATOC                      08120014
081300             MOVE DP015-REVERSE    TO ADATOH                      08130014
081400             MOVE -1               TO ADATOL                      08140014
081500         ELSE                                                     08150014
081600             SET ASC-DATE-TO-DA-ENTERED                           08160014
081700                                   TO TRUE                        08170014
081800             MOVE DP010I-NUMERIC-FIELD                            08180014
081900                                   TO ASC-DAY-TO-N                08190014
082000         END-IF                                                   08200014
082100     END-IF.                                                      08210014
082200*                                                                 08220014
082300     IF  ASC-YEAR-TO > SPACE                                      08230014
082400         MOVE ASC-YEAR-TO          TO DP010I-UNEDITED-FIELD       08240014
082500         MOVE LENGTH OF ASC-YEAR-TO                               08250014
082600                                   TO DP010I-MAXIMUM-DIGITS       08260014
082700         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     08270014
082800         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  08280014
082910         CALL DP010I-NUMERIC-EDIT-ROUTINE                         08291016
082920                         USING DP010I-NUMERIC-EDIT-AREA           08292016
083000         IF  DP010I-ERROR-DETECTED                                08300014
083100             SET PS-ERROR                                         08310014
083200                 DP020-MSG-FATAL                                  08320014
083300                 DP030-SET-CURSOR-APPL-1 TO TRUE                  08330014
083400             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            08340014
083500             MOVE DP015-UNP-ALP-BRT-OFF                           08350014
083600                                   TO AYRTOA                      08360014
083700             MOVE DP015-RED        TO AYRTOC                      08370014
083800             MOVE DP015-REVERSE    TO AYRTOH                      08380014
083900             MOVE -1               TO AYRTOL                      08390014
084000         ELSE                                                     08400014
084100             SET ASC-DATE-TO-YR-ENTERED                           08410014
084200                                   TO TRUE                        08420014
084300             MOVE DP010I-NUMERIC-FIELD                            08430014
084400                                   TO ASC-YEAR-TO-N               08440014
084500         END-IF                                                   08450014
084600     END-IF.                                                      08460014
084700                                                                  08470014
084800     IF (ASC-DATE-TO-MO-ENTERED                                   08480014
084900     AND ASC-DATE-TO-DA-ENTERED                                   08490014
085000     AND ASC-DATE-TO-YR-ENTERED)                                  08500014
085100         SET ASC-DATE-TO-ENTERED   TO TRUE                        08510014
085200     ELSE                                                         08520014
085300         IF (ASC-DATE-TO-MO-NOT-ENTERED                           08530014
085400         AND ASC-DATE-TO-DA-NOT-ENTERED                           08540014
085500         AND ASC-DATE-TO-YR-NOT-ENTERED)                          08550014
085600             CONTINUE                                             08560014
085700         ELSE                                                     08570014
085800             SET PS-ERROR                                         08580014
085900                 DP020-MSG-FATAL                                  08590014
086000                 DP030-SET-CURSOR-APPL-1 TO TRUE                  08600014
086100             MOVE PC-TSYMSG-00009  TO DP020-MSG-NUMBER            08610014
086200             MOVE DP015-UNP-ALP-BRT-OFF                           08620014
086300                                   TO AMOTOA                      08630014
086400                                      ADATOA                      08640014
086500                                      AYRTOA                      08650014
086600             MOVE DP015-RED        TO AMOTOC                      08660014
086700                                      ADATOC                      08670014
086800                                      AYRTOC                      08680014
086900             MOVE DP015-REVERSE    TO AMOTOH                      08690014
087000                                      ADATOH                      08700014
087100                                      AYRTOH                      08710014
087200             MOVE -1               TO AMOTOL                      08720014
087300         END-IF                                                   08730014
087400     END-IF.                                                      08740014
087500                                                                  08750014
087600     IF ASC-DATE-TO-ENTERED                                       08760014
087700         MOVE DP017-CURRENT-DATE-YMD                              08770014
087800                                   TO DPG51-SYSTEM-DATE           08780014
087900         MOVE ASC-DATE-RANGE-TO    TO DPG52-LK-DATE-INPUT         08790014
088000         SET DPG52-LK-DTE-GREG                                    08800014
088100             DPG51-ACTUAL-CALENDAR-ONLY                           08810014
088200             DPG51-DO-NOT-INCR-DECR-DATE TO TRUE                  08820014
088300                                                                  08830014
088400         CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52      08840014
088500                                                 DPG53 DPG54      08850014
088600                                                 DPG55 DPG56      08860014
088700                                                                  08870014
088800         EVALUATE TRUE                                            08880014
088900             WHEN DPG54-SEVERE-ERROR                              08890014
089000             WHEN DPG54-DATE-INVALID                              08900014
089100                 SET PS-ERROR                                     08910014
089200                     DP020-MSG-FATAL                              08920014
089300                     DP030-SET-CURSOR-APPL-1                      08930014
089400                     ASC-DATE-TO-NOT-ENTERED                      08940014
089500                                   TO TRUE                        08950014
089600                 MOVE PC-TSYMSG-00009                             08960014
089700                                   TO DP020-MSG-NUMBER            08970014
089800                 MOVE DP015-UNP-ALP-BRT-OFF                       08980014
089900                                   TO AMOTOA                      08990014
090000                                      ADATOA                      09000014
090100                                      AYRTOA                      09010014
090200                 MOVE DP015-RED    TO AMOTOC                      09020014
090300                                      ADATOC                      09030014
090400                                      AYRTOC                      09040014
090500                 MOVE DP015-REVERSE                               09050014
090600                                   TO AMOTOH                      09060014
090700                                      ADATOH                      09070014
090800                                      AYRTOH                      09080014
090900                 MOVE -1           TO AMOTOL                      09090014
091000             WHEN OTHER                                           09100014
091100                 MOVE DPG55-GREG-DATE                             09110014
091200                                   TO ASC-DATE-RANGE-TO           09120014
091300                 MOVE DPG55-DB2-ISO-DATE-FMT                      09130014
091400                                   TO ASC-DATE-RANGE-TO-ISO       09140014
091500         END-EVALUATE                                             09150014
091600     ELSE                                                         09160014
091700         MOVE SPACES               TO ASC-DATE-RANGE-FROM-ISO     09170014
091800     END-IF.                                                      09180014
091900*                                                                 09190014
092000     IF  (ASC-DATE-TO-ENTERED                                     09200014
092100      AND ASC-DATE-FROM-ENTERED)                                  09210014
092200         IF ASC-DATE-RANGE-TO-ISO < ASC-DATE-RANGE-FROM-ISO       09220014
092300             SET PS-ERROR                                         09230014
092400                 DP020-MSG-FATAL                                  09240014
092500                 DP030-SET-CURSOR-APPL-1 TO TRUE                  09250014
092600             MOVE PC-TSYMSG-00395  TO DP020-MSG-NUMBER            09260014
092700             MOVE DP015-UNP-ALP-BRT-OFF                           09270014
092800                                   TO AMOTOA                      09280014
092900                                      ADATOA                      09290014
093000                                      AYRTOA                      09300014
093100             MOVE DP015-RED        TO AMOTOC                      09310014
093200                                      ADATOC                      09320014
093300                                      AYRTOC                      09330014
093400             MOVE DP015-REVERSE    TO AMOTOH                      09340014
093500                                      ADATOH                      09350014
093600                                      AYRTOH                      09360014
093700             MOVE -1               TO AMOTOL                      09370014
093800         END-IF                                                   09380014
093900     END-IF.                                                      09390014
094000                                                                  09400014
094100     IF PS-NO-ERROR                                               09410014
094200         IF  (ASC-DATE-TO-ENTERED                                 09420014
094300          AND ASC-DATE-FROM-NOT-ENTERED)                          09430014
094400             SET PS-ERROR                                         09440014
094500                 DP020-MSG-FATAL                                  09450014
094600                 DP030-SET-CURSOR-APPL-1 TO TRUE                  09460014
094700             MOVE PC-TSYMSG-00007  TO DP020-MSG-NUMBER            09470014
094800             MOVE DP015-UNP-ALP-BRT-OFF                           09480014
094900                                   TO AMOFRA                      09490014
095000                                      ADAFRA                      09500014
095100                                      AYRFRA                      09510014
095200             MOVE DP015-RED        TO AMOFRC                      09520014
095300                                      ADAFRC                      09530014
095400                                      AYRFRC                      09540014
095500             MOVE DP015-REVERSE    TO AMOFRH                      09550014
095600                                      ADAFRH                      09560014
095700                                      AYRFRH                      09570014
095800             MOVE -1               TO AMOFRL                      09580014
095900         ELSE                                                     09590014
096000             IF (ASC-DATE-TO-NOT-ENTERED                          09600014
096100             AND ASC-DATE-FROM-ENTERED)                           09610014
096200                 SET PS-ERROR                                     09620014
096300                     DP020-MSG-FATAL                              09630014
096400                     DP030-SET-CURSOR-APPL-1                      09640014
096500                                   TO TRUE                        09650014
096600                 MOVE PC-TSYMSG-00007                             09660014
096700                                   TO DP020-MSG-NUMBER            09670014
096800                 MOVE DP015-UNP-ALP-BRT-OFF                       09680014
096900                                   TO AMOTOA                      09690014
097000                                      ADATOA                      09700014
097100                                      AYRTOA                      09710014
097200                 MOVE DP015-RED    TO AMOTOC                      09720014
097300                                      ADATOC                      09730014
097400                                      AYRTOC                      09740014
097500                 MOVE DP015-REVERSE                               09750014
097600                                   TO AMOTOH                      09760014
097700                                      ADATOH                      09770014
097800                                      AYRTOH                      09780014
097900                 MOVE -1           TO AMOTOL                      09790014
098000             END-IF                                               09800014
098100         END-IF                                                   09810014
098200     END-IF.                                                      09820014
098300*                                                                 09830014
098400     IF  ASC-STATUS-CODE > SPACE                                  09840014
098500         MOVE ASC-STATUS-CODE      TO                             09850014
098600                                   PE049-WORKING-INSTR-STATUS-CDE 09860014
098700         EVALUATE TRUE                                            09870014
098800             WHEN PE049-IS-AVAILABLE-STAT-CDE                     09880014
098900                 MOVE PE049-AVAILABLE-STATUS-DESC                 09890014
099000                                   TO ASC-STATUS-DESC             09900014
099100             WHEN PE049-IS-CANCELLED-STAT-CDE                     09910014
099200                 MOVE PE049-CANCELLED-STATUS-DESC                 09920014
099300                                   TO ASC-STATUS-DESC             09930014
099400             WHEN PE049-IS-CNTS-ENTER-STAT-CDE                    09940014
099500                 MOVE PE049-CNTS-ENTERED-STATUS-DESC              09950014
099600                                   TO ASC-STATUS-DESC             09960014
099700             WHEN PE049-IS-COMPLETED-STAT-CDE                     09970014
099800                 MOVE PE049-COMPLETE-STATUS-DESC                  09980014
099900                                   TO ASC-STATUS-DESC             09990014
100000             WHEN PE049-IS-GENERATED-STAT-CDE                     10000014
100100                 MOVE PE049-GENERATED-STATUS-DESC                 10010014
100200                                   TO ASC-STATUS-DESC             10020014
100300             WHEN PE049-IS-DELINQUENT-STAT-CDE                    10030014
100400                 MOVE PE049-DELINQUENT-STATUS-DESC                10040014
100500                                   TO ASC-STATUS-DESC             10050014
100600             WHEN PE049-IS-HISTORY-STAT-CDE                       10060014
100700                 MOVE PE049-HISTORY-STATUS-DESC                   10070014
100800                                   TO ASC-STATUS-DESC             10080014
100900             WHEN OTHER                                           10090014
101000                 SET PS-ERROR                                     10100014
101100                     DP020-MSG-FATAL                              10110014
101200                     DP030-SET-CURSOR-APPL-1                      10120014
101300                                   TO TRUE                        10130014
101400                 MOVE PC-TSYMSG-00132                             10140014
101500                                   TO DP020-MSG-NUMBER            10150014
101600                 MOVE SPACES       TO ASC-STATUS-DESC             10160014
101700                 MOVE DP015-UNP-ALP-BRT-OFF                       10170014
101800                                   TO ASTATA                      10180014
101900                 MOVE DP015-RED    TO ASTATC                      10190014
102000                 MOVE DP015-REVERSE                               10200014
102100                                   TO ASTATH                      10210014
102200                 MOVE -1           TO ASTATL                      10220014
102300         END-EVALUATE                                             10230014
102400     ELSE                                                         10240014
102500         MOVE SPACES               TO ASC-STATUS-DESC             10250014
102600     END-IF.                                                      10260014
102700*                                                                 10270014
102800     IF  ASC-REASON-CODE > SPACE                                  10280014
102900         MOVE ASC-REASON-CODE      TO DP010I-UNEDITED-FIELD       10290014
103000         MOVE LENGTH OF ASC-REASON-CODE                           10300014
103100                                   TO DP010I-MAXIMUM-DIGITS       10310014
103200         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     10320014
103300         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  10330014
103410         CALL DP010I-NUMERIC-EDIT-ROUTINE                         10341016
103420                         USING DP010I-NUMERIC-EDIT-AREA           10342016
103500         IF  DP010I-ERROR-DETECTED                                10350014
103600             SET PS-ERROR                                         10360014
103700                 DP020-MSG-FATAL                                  10370014
103800                 DP030-SET-CURSOR-APPL-1 TO TRUE                  10380014
103900             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            10390014
104000             MOVE SPACES           TO ASC-REASON-DESC             10400014
104100                                      ASC-TYPE-DESC               10410014
104200             MOVE DP015-UNP-ALP-BRT-OFF                           10420014
104300                                   TO ARSNA                       10430014
104400             MOVE DP015-RED        TO ARSNC                       10440014
104500             MOVE DP015-REVERSE    TO ARSNH                       10450014
104600             MOVE -1               TO ARSNL                       10460014
104700         ELSE                                                     10470014
104800             MOVE DP010I-NUMERIC-FIELD                            10480014
104900                                   TO ASC-REASON-CODE-N           10490014
105000             PERFORM 5200-GET-REASON-DESC                         10500014
105100         END-IF                                                   10510014
105200     ELSE                                                         10520014
105300         MOVE SPACES               TO ASC-REASON-DESC             10530014
105400                                      ASC-TYPE-DESC               10540014
105500     END-IF.                                                      10550014
105600*                                                                 10560014
105700     IF  ASC-DEPT-NUMBER > SPACE                                  10570014
105800         MOVE ASC-DEPT-NUMBER      TO DP010I-UNEDITED-FIELD       10580014
105900         MOVE LENGTH OF ASC-DEPT-NUMBER                           10590014
106000                                   TO DP010I-MAXIMUM-DIGITS       10600014
106100         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     10610014
106200         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  10620014
106310         CALL DP010I-NUMERIC-EDIT-ROUTINE                         10631016
106320                         USING DP010I-NUMERIC-EDIT-AREA           10632016
106400         IF  DP010I-ERROR-DETECTED                                10640014
106500             SET PS-ERROR                                         10650014
106600                 DP020-MSG-FATAL                                  10660014
106700                 DP030-SET-CURSOR-APPL-1 TO TRUE                  10670014
106800             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            10680014
106900             MOVE SPACES           TO ASC-DEPT-DESC               10690014
107000             MOVE DP015-UNP-ALP-BRT-OFF                           10700014
107100                                   TO ADEPTA                      10710014
107200             MOVE DP015-RED        TO ADEPTC                      10720014
107300             MOVE DP015-REVERSE    TO ADEPTH                      10730014
107400             MOVE -1               TO ADEPTL                      10740014
107500         ELSE                                                     10750014
107600             MOVE DP010I-NUMERIC-FIELD                            10760014
107700                                   TO ASC-DEPT-NUMBER-N           10770014
107800             MOVE ASC-DEPT-NUMBER  TO DK-DEPT-NUMBER              10780014
107900             PERFORM 5100-GET-DEPT-DESC                           10790014
108000         END-IF                                                   10800014
108100     ELSE                                                         10810014
108200         MOVE SPACES               TO ASC-DEPT-DESC               10820014
108300     END-IF.                                                      10830014
108400*                                                                 10840014
108500     IF  ASC-DOCUMENT-NUMBER > SPACE                              10850014
108600         MOVE ASC-DOCUMENT-NUMBER  TO DP010I-UNEDITED-FIELD       10860014
108700         MOVE LENGTH OF ASC-DOCUMENT-NUMBER                       10870014
108800                                   TO DP010I-MAXIMUM-DIGITS       10880014
108900         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     10890014
109000         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  10900014
109110         CALL DP010I-NUMERIC-EDIT-ROUTINE                         10911016
109120                         USING DP010I-NUMERIC-EDIT-AREA           10912016
109200         IF  DP010I-ERROR-DETECTED                                10920014
109300             SET PS-ERROR                                         10930014
109400                 DP020-MSG-FATAL                                  10940014
109500                 DP030-SET-CURSOR-APPL-1 TO TRUE                  10950014
109600             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            10960014
109700             MOVE DP015-UNP-ALP-BRT-OFF                           10970014
109800                                   TO ADOCNA                      10980014
109900             MOVE DP015-RED        TO ADOCNC                      10990014
110000             MOVE DP015-REVERSE    TO ADOCNH                      11000014
110100             MOVE -1               TO ADOCNL                      11010014
110200         ELSE                                                     11020014
110300             MOVE DP010I-NUMERIC-FIELD                            11030014
110400                                   TO ASC-DOCUMENT-NUMBER-N       11040014
110500         END-IF                                                   11050014
110600     END-IF.                                                      11060014
110700*                                                                 11070014
111010     IF  ASC-STORE-NUMBER > SPACE                                 11101009
111100         MOVE ASC-STORE-NUMBER     TO DP010I-UNEDITED-FIELD       11110009
111200         MOVE LENGTH OF ASC-STORE-NUMBER                          11120009
111300                                   TO DP010I-MAXIMUM-DIGITS       11130009
111400         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     11140009
111500         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  11150009
111610         CALL DP010I-NUMERIC-EDIT-ROUTINE                         11161016
111620                         USING DP010I-NUMERIC-EDIT-AREA           11162016
111700         IF  DP010I-ERROR-DETECTED                                11170009
111800             SET PS-ERROR                                         11180009
111900                 DP020-MSG-FATAL                                  11190009
112000                 DP030-SET-CURSOR-APPL-1                          11200009
112100                                   TO TRUE                        11210009
112200             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            11220009
112300             MOVE DP015-UNP-ALP-BRT-OFF                           11230009
112400                                   TO ASTRNA                      11240009
112500             MOVE SPACES           TO ASC-STORE-NAME              11250009
112600             MOVE DP015-RED        TO ASTRNC                      11260009
112700             MOVE DP015-REVERSE    TO ASTRNH                      11270009
112800             MOVE -1               TO ASTRNL                      11280009
112900         ELSE                                                     11290009
113000             MOVE DP010I-NUMERIC-FIELD                            11300009
113100                                   TO PV-STORE-NUMBER-N           11310009
113200             MOVE PV-STORE-NUMBER-N                               11320009
113300                                   TO DK-STORE-NUMBER             11330009
113400                                      ASC-STORE-NUMBER-N          11340009
113500             PERFORM 5000-GET-STORE-NAME                          11350009
113600             IF SQLCODE = 0                                       11360009
113700                 IF PV-PERM-RLSE-AVL-NBR >=                       11370009
113800                                  PE049-RELEASE-INSTR-PR-CHG      11380009
113900                     CONTINUE                                     11390009
114000                 ELSE                                             11400009
114100                     MOVE -1       TO ASTRNL                      11410009
114200                     SET DP030-SET-CURSOR-APPL-1                  11420009
114300                         DP020-MSG-FATAL                          11430009
114400                         PS-ERROR  TO TRUE                        11440009
114500                     MOVE PC-TSYMSG-99903                         11450009
114600                                   TO DP020-MSG-NUMBER            11460009
114700                 END-IF                                           11470009
114800             END-IF                                               11480009
114900         END-IF                                                   11490009
115000     ELSE                                                         11500009
115100         MOVE SPACES               TO ASC-STORE-NAME              11510009
115200     END-IF.                                                      11520009
115201                                                                  11520114
115210     IF  ASC-STORE-NUMBER > SPACE                                 11521014
115220         MOVE ASC-STORE-NUMBER           TO PV-LOC-EXCLUSION      11522014
115230         IF PV-EXCLUDE                                            11523014
115240             MOVE PC-TSYMSG-03685        TO DP020-MSG-NUMBER      11524014
115250             SET PS-ERROR                                         11525014
115260                 DP020-MSG-FATAL                                  11526014
115270                 DP030-SET-CURSOR-APPL-1 TO TRUE                  11527014
115280             MOVE DP015-UNP-ALP-BRT-OFF  TO ASTRNA                11528014
115290             MOVE SPACES                 TO ASC-STORE-NAME        11529014
115291             MOVE DP015-RED              TO ASTRNC                11529114
115292             MOVE DP015-REVERSE          TO ASTRNH                11529214
115293             MOVE -1                     TO ASTRNL                11529314
115294     END-IF.                                                      11529414
115295                                                                  11529514
115300*                                                                 11530009
115400*----------------------------------------------------------------*11540009
115500*  MOVE THE DEFAULT ATTRIBUTES TO ALL OF THE OPEN FIELDS ON THE **11550009
115600*  MAP.  BASED ON IF THE USER HAS AUTHORITY TO CHANGE STORE     **11560009
115700*  NUMBER, PROTECT OR ALLOW ENTRY OF THE STORE.                 **11570009
115800*----------------------------------------------------------------*11580009
115900 3200-RESET-ATTRIBUTES.                                           11590009
116000                                                                  11600009
116100     IF ASC-NON-STORE-TERMINAL                                    11610009
116200         MOVE DP015-GREEN           TO ASTRNC                     11620009
116300         MOVE DP015-UNDERLINE       TO ASTRNH                     11630009
116400         MOVE DP015-UNP-ALP-NOR-MDT TO ASTRNA                     11640009
116500     ELSE                                                         11650009
116600         MOVE DP015-BLUE            TO ASTRNC                     11660009
116700         MOVE DP015-HL-OFF          TO ASTRNH                     11670009
116800         MOVE DP015-PRO-BRT-OFF     TO ASTRNA                     11680009
116900     END-IF.                                                      11690009
117000                                                                  11700009
117100     MOVE DP015-UNP-ALP-NOR-OFF    TO ADOCNA                      11710009
117200                                      ADEPTA                      11720009
117300                                      ASTATA                      11730009
117400                                      ASTATA                      11740009
117500                                      ARSNA                       11750009
117600                                      AMOFRA                      11760009
117700                                      ADAFRA                      11770009
117800                                      AYRFRA                      11780009
117900                                      AMOTOA                      11790009
118000                                      ADATOA                      11800009
118100                                      AYRTOA.                     11810009
118200     MOVE DP015-GREEN              TO ADOCNC                      11820009
118300                                      ADEPTC                      11830009
118400                                      ASTATC                      11840009
118500                                      ASTATC                      11850009
118600                                      ARSNC                       11860009
118700                                      AMOFRC                      11870009
118800                                      ADAFRC                      11880009
118900                                      AYRFRC                      11890009
119000                                      AMOTOC                      11900009
119100                                      ADATOC                      11910009
119200                                      AYRTOC.                     11920009
119300     MOVE DP015-UNDERLINE          TO ADOCNH                      11930009
119400                                      ADEPTH                      11940009
119500                                      ASTATH                      11950009
119600                                      ASTATH                      11960009
119700                                      ARSNH                       11970009
119800                                      AMOFRH                      11980009
119900                                      ADAFRH                      11990009
120000                                      AYRFRH                      12000009
120100                                      AMOTOH                      12010009
120200                                      ADATOH                      12020009
120300                                      AYRTOH.                     12030009
120400*                                                                 12040009
120500*----------------------------------------------------------------*12050009
120600*  POSITION THE CURSOR AT THE APPROPRIATE FIELD.                 *12060009
120700*  IF THERE IS ANY DATA TO MOVE TO THE SCREEN ON INITIAL, MOVE   *12070009
120800*  IT HERE.                                                      *12080009
120900*  DETERMINE IF THE USER HAS THE AUTHORITY TO ENTER A STORE      *12090009
121000*  NUMBER, OR IF THE STORE NUMBER WILL AUTOMATICALLY BE FILLED   *12100009
121100*  IN FOR THEM.                                                  *12110009
121200*----------------------------------------------------------------*12120009
121300 4000-BUILD-INITIAL-PANEL.                                        12130009
121400                                                                  12140009
121500     SET ASC-STORE-TERMINAL                                       12150009
121600         DP030-SET-CURSOR-APPL-1                                  12160009
121700         DP008-RSRC-TYPE-FUNC                                     12170009
121800         DP008-ACCESS-TYPE-USE     TO TRUE.                       12180009
121900     MOVE PE049-PERM-FUNCTION-NAME TO DP008-FUNCTION-NAME.        12190009
122000                                                                  12200009
122100     PERFORM 9000-LINK-TO-SECURITY-MODULE.                        12210009
122200     IF DP008-CALL-SUCCESSFUL                                     12220009
122300         MOVE ZEROS                TO PV-VARIABLE                 12230009
122400         PERFORM 4200-CONTINUE                                    12240009
122500     ELSE                                                         12250009
122600         SET DP013-SECURITY-ABEND  TO TRUE                        12260009
122700         MOVE '4000-BUILD-INITIAL-PANEL'                          12270009
122800                                   TO DP013-PARAGRAPH             12280009
122900         MOVE DP008-SECURITY-COMMAREA                             12290009
123000                                   TO DP013-SECURITY-INFO         12300009
123100         PERFORM DP013-0000-PROCESS-ABEND                         12310009
123200     END-IF.                                                      12320009
123300                                                                  12330009
123310     IF  ASC-STORE-NUMBER NOT = SPACE                             12331013
123320         MOVE ASC-STORE-NUMBER           TO PV-LOC-EXCLUSION      12332013
123330         IF PV-EXCLUDE                                            12333013
123340             MOVE PC-TSYMSG-03685        TO DP020-MSG-NUMBER      12334013
123350             SET PS-ERROR                                         12335013
123360                 DP020-MSG-FATAL                                  12336013
123370                 DP030-SET-CURSOR-APPL-1 TO TRUE                  12337013
123380             MOVE DP015-UNP-ALP-BRT-OFF  TO ASTRNA                12338013
123390             MOVE SPACES                 TO ASC-STORE-NAME        12339013
123391             MOVE DP015-RED              TO ASTRNC                12339113
123392             MOVE DP015-REVERSE          TO ASTRNH                12339213
123393             MOVE -1                     TO ASTRNL                12339313
123394     END-IF                                                       12339413
123395                                                                  12339512
123400     IF ASC-STORE-NUMBER NOT = SPACES                             12340009
123500         MOVE ASC-STORE-NUMBER-N   TO DK-STORE-NUMBER             12350009
123600         PERFORM 5000-GET-STORE-NAME                              12360009
123700         IF SQLCODE = 0                                           12370009
123800             IF PV-PERM-RLSE-AVL-NBR >= PE049-RELEASE-INSTR-PR-CHG12380009
123900                 MOVE -1           TO ADOCNL                      12390009
124000                 SET DP030-SET-CURSOR-APPL-1                      12400009
124100                                   TO TRUE                        12410009
124200             ELSE                                                 12420009
124300                 MOVE -1           TO ASTRNL                      12430009
124400                 SET DP030-SET-CURSOR-APPL-1                      12440009
124500                     DP020-MSG-FATAL                              12450009
124600                     PS-ERROR      TO TRUE                        12460009
124700                 MOVE PC-TSYMSG-99903                             12470009
124800                                   TO DP020-MSG-NUMBER            12480009
124900             END-IF                                               12490009
125000         END-IF                                                   12500009
125100     ELSE                                                         12510009
125200         SET DP030-SET-CURSOR-APPL-1                              12520009
125300                                   TO TRUE                        12530009
125400         MOVE -1                   TO ASTRNL                      12540009
125500     END-IF.                                                      12550009
125600*                                                                 12560009
125700*----------------------------------------------------------------*12570009
125800*  DETERMINE IF THE USER HAS THE AUTHORITY TO ENTER A STORE      *12580009
125900*  NUMBER, OR IF THE STORE NUMBER WILL AUTOMATICALLY BE FILLED   *12590009
126000*  IN FOR THEM.                                                  *12600009
126100*----------------------------------------------------------------*12610009
126200 4200-CONTINUE.                                                   12620009
126300                                                                  12630009
126400     MOVE DP020-LOCATION-NBR   TO PV-VARIABLE.                    12640009
126500                                                                  12650009
126600     IF DP008-ACCESS-ALLOWED                                      12660009
126700         IF DP020-LOCATION-TYPE = PE049-HQ-LOC-TYP-CDE            12670009
126800             MOVE SPACES       TO ASC-STORE-NUMBER                12680009
126900             SET ASC-NON-STORE-TERMINAL TO TRUE                   12690009
127000         ELSE                                                     12700009
127100             MOVE PV-VARIABLE                                     12710009
127200                               TO ASC-STORE-NUMBER-N              12720009
127300             SET ASC-NON-STORE-TERMINAL TO TRUE                   12730009
127400         END-IF                                                   12740009
127500     ELSE                                                         12750009
127600         IF (DP020-LOCATION-TYPE =                                12760009
127700                                 PE049-HQ-LOC-TYP-CDE             12770009
127800         OR  DP020-LOCATION-TYPE =                                12780009
127900                                 PE049-DISTRB-CNTR-LOC-TYP-CDE    12790009
128000         OR  DP020-LOCATION-TYPE =                                12800009
128100                                 PE049-CENT-STK-LOC-TYP-CDE       12810009
128200         OR  DP020-LOCATION-TYPE =                                12820009
128300                                 PE049-RET-TO-VND-LOC-TYP-CDE)    12830009
128400             SET ASC-NON-STORE-TERMINAL TO TRUE                   12840009
128500             MOVE SPACES       TO ASC-STORE-NUMBER                12850009
128600         ELSE                                                     12860009
128700             MOVE PV-VARIABLE                                     12870009
128800                               TO ASC-STORE-NUMBER-N              12880009
128900         END-IF                                                   12890009
129000     END-IF.                                                      12900009
129100*                                                                 12910009
129200*----------------------------------------------------------------*12920009
129300*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *12930009
129400*----------------------------------------------------------------*12940009
129500 4400-MOVE-COMMAREA-TO-SCREEN.                                    12950009
129600                                                                  12960009
129700     MOVE ASC-STORE-NUMBER         TO ASTRNO.                     12970009
129800     MOVE ASC-STORE-NAME           TO ASTRNMO.                    12980009
129900     MOVE ASC-DOCUMENT-NUMBER      TO ADOCNO.                     12990009
130000     MOVE ASC-DEPT-NUMBER          TO ADEPTO.                     13000009
130100     MOVE ASC-DEPT-DESC            TO ADEPTDO.                    13010009
130200     MOVE ASC-STATUS-CODE          TO ASTATO.                     13020009
130300     MOVE ASC-STATUS-DESC          TO ASTATDO.                    13030009
130400     MOVE ASC-REASON-CODE          TO ARSNO.                      13040009
130500     MOVE ASC-REASON-DESC          TO ARSNDO.                     13050009
130600     MOVE ASC-TYPE-DESC            TO ATYPDO.                     13060009
130700     MOVE ASC-MONTH-FROM           TO AMOFRO.                     13070009
130800     MOVE ASC-DAY-FROM             TO ADAFRO.                     13080009
130900     MOVE ASC-YEAR-FROM            TO AYRFRO.                     13090009
131000     MOVE ASC-MONTH-TO             TO AMOTOO.                     13100009
131100     MOVE ASC-DAY-TO               TO ADATOO.                     13110009
131200     MOVE ASC-YEAR-TO              TO AYRTOO.                     13120009
131300                                                                  13130009
131400     SET DP030-SET-CURSOR-APPL-1    TO TRUE.                      13140009
131500     IF ASC-NON-STORE-TERMINAL                                    13150009
131600         MOVE DP015-GREEN           TO ASTRNC                     13160009
131700         MOVE DP015-UNDERLINE       TO ASTRNH                     13170009
131800         MOVE DP015-UNP-ALP-NOR-MDT TO ASTRNA                     13180009
131900         IF PS-NO-ERROR                                           13190009
132000             MOVE -1                TO ASTRNL                     13200009
132100         END-IF                                                   13210009
132200     ELSE                                                         13220009
132300         MOVE DP015-BLUE            TO ASTRNC                     13230009
132400         MOVE DP015-HL-OFF          TO ASTRNH                     13240009
132500         MOVE DP015-PRO-BRT-OFF     TO ASTRNA                     13250009
132600         IF PS-NO-ERROR                                           13260009
132700             MOVE -1                TO ADOCNL                     13270009
132800         END-IF                                                   13280009
132900     END-IF.                                                      13290009
133000*                                                                 13300009
133100*----------------------------------------------------------------*13310009
133200*    GET THE LOCATION TYPE CODE, LOCATION NAME, AND LOCATION     *13320009
133300*    OPEN DATE.  BASED ON LOCATION TYPE CODE, FOR DCS AND RVS    *13330009
133400*    CALCULATE THE PERM RELEASE AVAILABLE NUMBER FROM THE        *13340009
133500*    XST_LOC.OPN_DTE, FOR ALL OTHER TYPE CODES CALCULATE THE     *13350009
133600*    PERM RELEASE AVAILABLE NUMBER FROM THE OPEN FOR RECEIVING   *13360009
133700*    DATE (XST_DC_LOC_ASGMT.EFF_BEG_DTE) IN                      *13370009
133800*    5050-GET-DS-RECEIVING-DATE.                                 *13380009
133900*----------------------------------------------------------------*13390009
134000 5000-GET-STORE-NAME.                                             13400009
134100                                                                  13410009
134200     PERFORM                                                      13420009
134300       WITH TEST AFTER                                            13430009
134400       VARYING PV-RETRY-COUNTER                                   13440009
134500       FROM 1 BY 1                                                13450009
134600       UNTIL (PV-RETRY-COUNTER > PC-MAX-RETRIES                   13460009
134700          OR  SQLCODE = ZERO                                      13470009
134800          OR  SQLCODE = +100)                                     13480009
134900                                                                  13490009
135000         EXEC SQL                                                 13500009
135100             SELECT LOC_TYP_CDE                                   13510009
135200                  , LOC_NM                                        13520009
135300                  , OPN_DTE                                       13530009
135400             INTO :XST00001-LOC-TYP-CDE                           13540009
135500                , :XST00001-LOC-NM                                13550009
135600                , :XST00001-OPN-DTE                               13560009
135700             FROM XST_LOC                                         13570009
135800                   WHERE LOC_NBR = :DK-STORE-NUMBER               13580009
135900         END-EXEC                                                 13590009
136000                                                                  13600009
136100         EVALUATE TRUE                                            13610009
136200             WHEN SQLCODE = 0                                     13620009
136300                 MOVE XST00001-LOC-NM                             13630009
136400                                     TO ASC-STORE-NAME            13640009
136500                 IF XST00001-LOC-TYP-CDE =                        13650009
136600                     PE049-DISTRB-CNTR-LOC-TYP-CDE OR             13660009
136700                    XST00001-LOC-TYP-CDE =                        13670009
136800                     PE049-RET-TO-VND-LOC-TYP-CDE OR              13680009
136900                    XST00001-LOC-TYP-CDE =                        13690009
137000                     PE049-CENT-STK-LOC-TYP-CDE                   13700009
137100                     IF XST00001-OPN-DTE >                        13710009
137200                         DK-CURRENT-DATE-ISO                      13720009
137300                         MOVE PE049-RELEASE-UNINITIALIZED         13730009
137400                                 TO PV-PERM-RLSE-AVL-NBR          13740009
137500                     ELSE                                         13750009
137600                         MOVE PE049-RELEASE-INSTR-PR-CHG          13760009
137700                                 TO PV-PERM-RLSE-AVL-NBR          13770009
137800                     END-IF                                       13780009
137900                 ELSE                                             13790009
138000                     PERFORM 5050-GET-DS-RECEIVING-DATE           13800009
138100                 END-IF                                           13810009
138200             WHEN SQLCODE = +100                                  13820009
138300                 SET PS-ERROR                                     13830009
138400                     DP020-MSG-FATAL                              13840009
138500                     DP030-SET-CURSOR-APPL-1                      13850009
138600                                     TO TRUE                      13860009
138700                 MOVE SPACES         TO ASC-STORE-NAME            13870009
138800                 MOVE PC-TSYMSG-00017                             13880009
138900                                     TO DP020-MSG-NUMBER          13890009
139000                 MOVE DP015-UNP-ALP-BRT-OFF                       13900009
139100                                     TO ASTRNA                    13910009
139200                 MOVE DP015-RED      TO ASTRNC                    13920009
139300                 MOVE DP015-REVERSE  TO ASTRNH                    13930009
139400                 MOVE -1             TO ASTRNL                    13940009
139500             WHEN SQLCODE = -904                                  13950009
139600             WHEN SQLCODE = -913                                  13960009
139700                 CONTINUE                                         13970009
139800             WHEN OTHER                                           13980009
139900                 MOVE '5000-GET-STORE-NAME'                       13990009
140000                                     TO DP013-PARAGRAPH           14000009
140100                 MOVE 'UNABLE TO SELECT STORE NUMBER'             14010009
140200                                     TO DP013-MESSAGE-TEXT(1)     14020009
140300                 MOVE SQLCA          TO DP013-SQLCA               14030009
140400                 MOVE 'XST_LOC'      TO DP013-DB2-TABLE-NAME(1)   14040009
140500                 MOVE 'XST_DC_LOC_ASGMT'                          14050009
140600                                     TO DP013-DB2-TABLE-NAME(2)   14060009
140700                 SET DP013-DB2-ABEND                              14070009
140800                     DP013-NO-ROLLBACK                            14080009
140900                     DP013-XCTL-DISPLAY-RESTART                   14090009
141000                                     TO TRUE                      14100009
141100                 PERFORM DP013-0000-PROCESS-ABEND                 14110009
141200         END-EVALUATE                                             14120009
141300     END-PERFORM.                                                 14130009
141400                                                                  14140009
141500     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         14150009
141600         MOVE '5000-GET-STORE-NAME'  TO DP013-PARAGRAPH           14160009
141700         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     14170009
141800                                     TO DP013-MESSAGE-TEXT(1)     14180009
141900         MOVE 'STORE NAME FOR STORE: '                            14190009
142000                                     TO DP013-MESSAGE-TEXT(2)     14200009
142100         MOVE DK-STORE-NUMBER        TO DP013-MESSAGE-TEXT(3)     14210009
142200         MOVE SQLCA                  TO DP013-SQLCA               14220009
142300         MOVE 'XST_LOC'              TO DP013-DB2-TABLE-NAME(1)   14230009
142400         MOVE 'XST_DC_LOC_ASGMT'     TO DP013-DB2-TABLE-NAME(2)   14240009
142500         SET DP013-DB2-ABEND                                      14250009
142600             DP013-NO-ROLLBACK                                    14260009
142700             DP013-XCTL-DISPLAY-RESTART                           14270009
142800                                     TO TRUE                      14280009
142900         PERFORM DP013-0000-PROCESS-ABEND                         14290009
143000     END-IF.                                                      14300009
143100*----------------------------------------------------------------*14310009
143200 5050-GET-DS-RECEIVING-DATE.                                      14320009
143300     EXEC SQL                                                     14330009
143400         SELECT MIN(EFF_BEG_DTE)                                  14340009
143500         INTO :XST00020-EFF-BEG-DTE                               14350009
143600         FROM XST_DC_LOC_ASGMT                                    14360009
143700               WHERE LOC_NBR = :DK-STORE-NUMBER                   14370009
143800     END-EXEC.                                                    14380009
143900                                                                  14390009
144000     EVALUATE TRUE                                                14400009
144100         WHEN SQLCODE = 0                                         14410009
144200             IF XST00020-EFF-BEG-DTE >                            14420009
144300                 DK-CURRENT-DATE-ISO                              14430009
144400                 MOVE PE049-RELEASE-UNINITIALIZED                 14440009
144500                                 TO PV-PERM-RLSE-AVL-NBR          14450009
144600             ELSE                                                 14460009
144700                 MOVE PE049-RELEASE-INSTR-PR-CHG                  14470009
144800                                 TO PV-PERM-RLSE-AVL-NBR          14480009
144900             END-IF                                               14490009
145000         WHEN SQLCODE = +100                                      14500009
145100         WHEN SQLCODE = -305                                      14510009
145200             SET PS-ERROR                                         14520009
145300                 DP020-MSG-FATAL                                  14530009
145400                 DP030-SET-CURSOR-APPL-1                          14540009
145500                                 TO TRUE                          14550009
145600             MOVE SPACES         TO ASC-STORE-NAME                14560009
145700             MOVE PC-TSYMSG-00017                                 14570009
145800                                 TO DP020-MSG-NUMBER              14580009
145900             MOVE DP015-UNP-ALP-BRT-OFF                           14590009
146000                                 TO ASTRNA                        14600009
146100             MOVE DP015-RED      TO ASTRNC                        14610009
146200             MOVE DP015-REVERSE  TO ASTRNH                        14620009
146300             MOVE -1             TO ASTRNL                        14630009
146400         WHEN OTHER                                               14640009
146500             MOVE '5050-GET-DS-RECEIVING-DATE'                    14650009
146600                                 TO DP013-PARAGRAPH               14660009
146700             MOVE 'UNABLE TO SELECT AN OPEN FOR RECEIVING DATE'   14670009
146800                                 TO DP013-MESSAGE-TEXT(1)         14680009
146900             MOVE SQLCA          TO DP013-SQLCA                   14690009
147000             MOVE 'XST_DC_LOC_ASGMT'                              14700009
147100                                 TO DP013-DB2-TABLE-NAME(1)       14710009
147200             SET DP013-DB2-ABEND                                  14720009
147300                 DP013-NO-ROLLBACK                                14730009
147400                 DP013-XCTL-DISPLAY-RESTART                       14740009
147500                                 TO TRUE                          14750009
147600             PERFORM DP013-0000-PROCESS-ABEND                     14760009
147700     END-EVALUATE.                                                14770009
147800*----------------------------------------------------------------*14780009
147900*    GET THE DEPT DESC FROM THE MBS TABLES.                      *14790009
148000*----------------------------------------------------------------*14800009
148100 5100-GET-DEPT-DESC.                                              14810009
148200                                                                  14820009
148300     PERFORM                                                      14830009
148400       WITH TEST AFTER                                            14840009
148500       VARYING PV-RETRY-COUNTER                                   14850009
148600       FROM 1 BY 1                                                14860009
148700       UNTIL (PV-RETRY-COUNTER > PC-MAX-RETRIES                   14870009
148800          OR  SQLCODE = ZERO                                      14880009
148900          OR  SQLCODE = +100)                                     14890009
149000                                                                  14900009
149100         EXEC SQL                                                 14910009
149200             SELECT MDSEAR_DESC                                   14920009
149300               INTO :MDSEAR-DESC                                  14930009
149400               FROM TMDSEAR M                                     14940009
149500                  , TAPLAVL A                                     14950009
149600              WHERE (M.OPERCO_NBR = :DK-OPERATING-COMPANY         14960009
149700                AND M.OPERCO_NBR  = A.OPERCO_NBR                  14970009
149800                AND MDSELV_CDE    = :PC-DEPT                      14980009
149900                AND APLSYS_CDE    = :PC-PERM                      14990009
150000                AND DEPT_NBR      = :DK-DEPT-NUMBER               15000009
150100                AND M.MDSEAR_DKEY = A.MDSEAR_DKEY                 15010009
150200                AND (:DK-CURRENT-DATE-ISO                         15020009
150300                    BETWEEN MDSEAR_STRT_DTE AND MDSEAR_END_DTE)   15030009
150400                AND (:DK-CURRENT-DATE-ISO                         15040009
150500                    BETWEEN STRT_DTE AND END_DTE))                15050009
150600         END-EXEC                                                 15060009
150700                                                                  15070009
150800         EVALUATE TRUE                                            15080009
150900             WHEN SQLCODE = 0                                     15090009
151000                 MOVE MDSEAR-DESC    TO ASC-DEPT-DESC             15100009
151100             WHEN SQLCODE = +100                                  15110009
151200                 MOVE SPACES         TO ASC-DEPT-DESC             15120009
151300                 SET PS-ERROR                                     15130009
151400                     DP020-MSG-FATAL                              15140009
151500                     DP030-SET-CURSOR-APPL-1                      15150009
151600                                     TO TRUE                      15160009
151700                 MOVE PC-TSYMSG-00032                             15170009
151800                                     TO DP020-MSG-NUMBER          15180009
151900                 MOVE DP015-UNP-ALP-BRT-OFF                       15190009
152000                                     TO ADEPTA                    15200009
152100                 MOVE DP015-RED      TO ADEPTC                    15210009
152200                 MOVE DP015-REVERSE  TO ADEPTH                    15220009
152300                 MOVE -1             TO ADEPTL                    15230009
152400             WHEN SQLCODE = -904                                  15240009
152500             WHEN SQLCODE = -913                                  15250009
152600                 CONTINUE                                         15260009
152700             WHEN OTHER                                           15270009
152800                 MOVE '5000-GET-DEPT-DESC'                        15280009
152900                                     TO DP013-PARAGRAPH           15290009
153000                 MOVE 'UNABLE TO SELECT DEPARTMENT DESC'          15300009
153100                                     TO DP013-MESSAGE-TEXT(1)     15310009
153200                 MOVE SQLCA          TO DP013-SQLCA               15320009
153300                 MOVE 'TMDSEAR'      TO DP013-DB2-TABLE-NAME(1)   15330009
153400                 SET DP013-DB2-ABEND                              15340009
153500                     DP013-NO-ROLLBACK                            15350009
153600                     DP013-XCTL-DISPLAY-RESTART                   15360009
153700                                     TO TRUE                      15370009
153800                 PERFORM DP013-0000-PROCESS-ABEND                 15380009
153900         END-EVALUATE                                             15390009
154000     END-PERFORM.                                                 15400009
154100                                                                  15410009
154200     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         15420009
154300         MOVE '5100-GET-DEPT-DESC'   TO DP013-PARAGRAPH           15430009
154400         MOVE 'MAXIMUM RETIES EXCEEDED ATTEMPTING TO SELECT'      15440009
154500                                     TO DP013-MESSAGE-TEXT(1)     15450009
154600         MOVE 'DEPT DESC FOR DEPT: ' TO DP013-MESSAGE-TEXT(2)     15460009
154700         MOVE DK-DEPT-NUMBER         TO DP013-MESSAGE-TEXT(3)     15470009
154800         MOVE SQLCA                  TO DP013-SQLCA               15480009
154900         MOVE 'TMDSEAR'              TO DP013-DB2-TABLE-NAME(1)   15490009
155000         SET DP013-DB2-ABEND                                      15500009
155100             DP013-NO-ROLLBACK                                    15510009
155200             DP013-XCTL-DISPLAY-RESTART                           15520009
155300                                     TO TRUE                      15530009
155400         PERFORM DP013-0000-PROCESS-ABEND                         15540009
155500     END-IF.                                                      15550009
155600*                                                                 15560009
155700*----------------------------------------------------------------*15570009
155800*    VALIDATE THE REASON AND TYPE CODE.  IF VALID, RETRIEVE      *15580009
155900*    THE REASON AND TYPE DESCRIPTION ASSOCIATED WITH THE REASON  *15590009
156000*    ENTERED.                                                    *15600009
156100*----------------------------------------------------------------*15610009
156200 5200-GET-REASON-DESC.                                            15620009
156300                                                                  15630009
156400     MOVE PE049-INSTR-RSN-VALUE-TABLE                             15640009
156500                                     TO PE049-INSTR-RSN-TABLE.    15650009
156600     SET PS-VALID-TYPE-CDE                                        15660009
156700         PS-VALID-RSN-CDE            TO TRUE.                     15670009
156800     MOVE ASC-REASON-CODE-N          TO PV-TYPE-REASON-CODE.      15680009
156900                                                                  15690009
157000     MOVE PV-TYPE-CODE               TO PE049-WORKING-TYPE-CDE.   15700009
157100     IF PE049-VALID-TYPE-CDE                                      15710009
157200         SET PS-VALID-TYPE-CDE       TO TRUE                      15720009
157300     ELSE                                                         15730009
157400         SET PS-INVALID-TYPE-CDE     TO TRUE                      15740009
157500         SET PS-ERROR                                             15750009
157600             DP020-MSG-FATAL                                      15760009
157700             DP030-SET-CURSOR-APPL-1 TO TRUE                      15770009
157800* TYPE CODE INVALID                                               15780009
157900         MOVE PC-TSYMSG-00527        TO DP020-MSG-NUMBER          15790009
158000         MOVE SPACES                 TO ASC-TYPE-DESC             15800009
158100         MOVE DP015-UNP-ALP-BRT-OFF  TO ARSNA                     15810009
158200         MOVE DP015-RED              TO ARSNC                     15820009
158300         MOVE DP015-REVERSE          TO ARSNH                     15830009
158400         MOVE -1                     TO ARSNL                     15840009
158500     END-IF.                                                      15850009
158600*                                                                 15860009
158700     MOVE PV-REASON-CODE             TO                           15870009
158800                                     PE049-WORKING-INSTR-RSN-CDE. 15880009
158900     IF PE049-IS-VALID-RSN                                        15890009
159000         SET PS-VALID-RSN-CDE        TO TRUE                      15900009
159100     ELSE                                                         15910009
159200         SET PS-INVALID-RSN-CDE      TO TRUE                      15920009
159300         SET PS-ERROR                                             15930009
159400             DP020-MSG-FATAL                                      15940009
159500             DP030-SET-CURSOR-APPL-1 TO TRUE                      15950009
159600* REASON CODE INVALID                                             15960009
159700         MOVE PC-TSYMSG-00022        TO DP020-MSG-NUMBER          15970009
159800         MOVE SPACES                 TO ASC-REASON-DESC           15980009
159900         MOVE DP015-UNP-ALP-BRT-OFF  TO ARSNA                     15990009
160000         MOVE DP015-RED              TO ARSNC                     16000009
160100         MOVE DP015-REVERSE          TO ARSNH                     16010009
160200         MOVE -1                     TO ARSNL                     16020009
160300     END-IF.                                                      16030009
160400                                                                  16040009
160500     IF (PS-VALID-RSN-CDE                                         16050009
160600     AND PS-VALID-TYPE-CDE)                                       16060009
160700         SET PE049-TYPE-IDX                                       16070009
160800             PE049-RSN-IDX  TO 1                                  16080009
160900         SEARCH PE049-TYPE-CODE-TABLE                             16090009
161000             AT END                                               16100009
161100                 SET PS-INVALID-TYPE-CDE TO TRUE                  16110009
161200                 SET PS-ERROR                                     16120009
161300                     DP020-MSG-FATAL                              16130009
161400                     DP030-SET-CURSOR-APPL-1 TO TRUE              16140009
161500* TYPE CODE INVALID                                               16150009
161600                 MOVE PC-TSYMSG-00527                             16160009
161700                                     TO DP020-MSG-NUMBER          16170009
161800                 MOVE SPACES         TO ASC-TYPE-DESC             16180009
161900                 MOVE DP015-UNP-ALP-BRT-OFF                       16190009
162000                                     TO ARSNA                     16200009
162100                 MOVE DP015-RED      TO ARSNC                     16210009
162200                 MOVE DP015-REVERSE  TO ARSNH                     16220009
162300                 MOVE -1             TO ARSNL                     16230009
162400             WHEN PE049-TYPE-CODE (PE049-TYPE-IDX) =              16240009
162500                                     PV-TYPE-CODE                 16250009
162600                 SET PS-VALID-TYPE-CDE TO TRUE                    16260009
162700                 MOVE PV-TYPE-CODE   TO PE049-WORKING-TYPE-CDE    16270009
162800                 EVALUATE TRUE                                    16280009
162900                     WHEN PE049-MARKDOWN                          16290009
163000                         MOVE PE049-SHORT-MKDN-DESC1              16300009
163100                                     TO ASC-TYPE-DESC             16310009
163200                     WHEN PE049-MARKUP                            16320009
163300                         MOVE PE049-SHORT-MKUP-DESC1              16330009
163400                                     TO ASC-TYPE-DESC             16340009
163500                     WHEN PE049-MARKDOWN-CANCEL                   16350009
163600                         MOVE PE049-SHORT-MKDN-CANCEL-DESC        16360009
163700                                     TO ASC-TYPE-DESC             16370009
163800                     WHEN PE049-MARKUP-CANCEL                     16380009
163900                         MOVE PE049-SHORT-MKUP-CANCEL-DESC        16390009
164000                                     TO ASC-TYPE-DESC             16400009
164100                     WHEN OTHER                                   16410009
164200                         MOVE SPACES TO ASC-TYPE-DESC             16420009
164300                 END-EVALUATE                                     16430009
164400         END-SEARCH                                               16440009
164500                                                                  16450009
164600         IF PS-VALID-TYPE-CDE                                     16460009
164700             SEARCH PE049-REASON-CODE-TABLE                       16470009
164800                 AT END                                           16480009
164900                     SET PS-INVALID-RSN-CDE TO TRUE               16490009
165000                     SET PS-ERROR                                 16500009
165100                         DP020-MSG-FATAL                          16510009
165200                         DP030-SET-CURSOR-APPL-1                  16520009
165300                                     TO TRUE                      16530009
165400* REASON CODE INVALID                                             16540009
165500                     MOVE PC-TSYMSG-00022                         16550009
165600                                     TO DP020-MSG-NUMBER          16560009
165700                     MOVE SPACES     TO ASC-REASON-DESC           16570009
165800                     MOVE DP015-UNP-ALP-BRT-OFF                   16580009
165900                                     TO ARSNA                     16590009
166000                     MOVE DP015-RED  TO ARSNC                     16600009
166100                     MOVE DP015-REVERSE                           16610009
166200                                     TO ARSNH                     16620009
166300                     MOVE -1         TO ARSNL                     16630009
166400                 WHEN PE049-REASON-CODE                           16640009
166500                             (PE049-TYPE-IDX PE049-RSN-IDX)       16650009
166600                                       = PV-REASON-CODE           16660009
166700                     SET PS-VALID-RSN-CDE TO TRUE                 16670009
166800                     MOVE PV-REASON-CODE  TO                      16680009
166900                                       PE049-WORKING-INSTR-RSN-CDE16690009
167000                     EVALUATE TRUE                                16700009
167100                         WHEN PE049-IS-ZERO-OUT-RSN               16710009
167200                             MOVE PE049-IS-SHORT-ZERO-OUT-DESC    16720009
167300                                     TO ASC-REASON-DESC           16730009
167400                         WHEN PE049-IS-RF-ZERO-OUT-RSN            16740009
167500                             MOVE PE049-IS-SHORT-RF-ZERO-OUT      16750009
167600                                     TO ASC-REASON-DESC           16760009
167700                         WHEN PE049-IS-RTN-TO-VNDR-RSN            16770009
167800                             MOVE PE049-IS-SHORT-RTN-TO-VNDR      16780009
167900                                     TO ASC-REASON-DESC           16790009
168000                         WHEN PE049-IS-CORRECTION-RSN             16800009
168100                             MOVE PE049-IS-SHORT-CORRECTION-DESC  16810009
168200                                     TO ASC-REASON-DESC           16820009
168300                         WHEN PE049-IS-BUYER-GEN-MISSED-RSN       16830009
168400                             MOVE PE049-IS-SHORT-BYR-MISSED-DESC  16840009
168500                                     TO ASC-REASON-DESC           16850009
168600                         WHEN PE049-IS-CUSTOMER-RET-RSN           16860009
168700                             MOVE PE049-IS-SHORT-CUST-RET-DESC    16870009
168800                                     TO ASC-REASON-DESC           16880009
168900                         WHEN PE049-IS-KNOWN-THEFT-RSN            16890009
169000                             MOVE PE049-IS-SHORT-THEFT-DESC       16900009
169100                                     TO ASC-REASON-DESC           16910009
169200                         WHEN PE049-IS-INSTR-DAMAGE-RSN           16920009
169300                             MOVE PE049-IS-SHORT-INSTR-DMG-DESC   16930009
169400                                     TO ASC-REASON-DESC           16940009
169500                         WHEN PE049-IS-COSMETICS-TESTER-RSN       16950009
169600                             MOVE PE049-IS-SHORT-CSMTCS-TST-DESC  16960009
169700                                     TO ASC-REASON-DESC           16970009
169800                         WHEN PE049-IS-MOS-SALVAGE-RSN            16980009
169900                             MOVE PE049-IS-SHORT-MOS-SALVAGE      16990009
170000                                     TO ASC-REASON-DESC           17000009
170100                         WHEN PE049-IS-FINANCIAL-ADJ-RSN          17010009
170200                             MOVE PE049-IS-SHORT-FIN-ADJ-DESC     17020009
170300                                     TO ASC-REASON-DESC           17030009
170400                         WHEN PE049-IS-INVENTORY-MISSED-RSN       17040009
170500                             MOVE PE049-IS-SHORT-POSS-INV-MSSD    17050009
170600                                     TO ASC-REASON-DESC           17060009
170700                         WHEN OTHER                               17070009
170800                             MOVE SPACES TO ASC-REASON-DESC       17080009
170900                     END-EVALUATE                                 17090009
171000             END-SEARCH                                           17100009
171100         END-IF                                                   17110009
171200     END-IF.                                                      17120009
171300*                                                                 17130009
171400*----------------------------------------------------------------*17140009
171500*    LINK TO THE SECURITY MODULE TO DETERMINE IF THE USER HAS    *17150009
171600*    SECURITY ACCESS INTO THE FUNCITON SPECIFIED.                *17160009
171700*----------------------------------------------------------------*17170009
171800 9000-LINK-TO-SECURITY-MODULE.                                    17180009
171900                                                                  17190009
172000     EXEC CICS                                                    17200009
172100         LINK                                                     17210009
172200             PROGRAM   (DP008-SECURITY-SUBROUTINE)                17220009
172300             COMMAREA  (DP008-SECURITY-COMMAREA)                  17230009
172400             LENGTH    (DP008-SECURITY-COMMAREA-LENGTH)           17240009
172500             RESP      (PV-CICS-RESPONSE)                         17250009
172600     END-EXEC.                                                    17260009
172700                                                                  17270009
172800     IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                    17280009
172900         SET DP013-CICS-ABEND TO TRUE                             17290009
173000         MOVE '9000-LINE-TO-SECURITY-MODULE'                      17300009
173100                              TO DP013-PARAGRAPH                  17310009
173200         STRING 'ATTEMPTING TO LINK TO THE SECURITY MODULE ('     17320009
173300                                               DELIMITED BY SIZE  17330009
173400               DP008-SECURITY-SUBROUTINE       DELIMITED BY SIZE  17340009
173500               ')'                             DELIMITED BY SIZE  17350009
173600             INTO DP013-MESSAGE-TEXT(1)                           17360009
173700         PERFORM DP013-0000-PROCESS-ABEND                         17370009
173800     END-IF.                                                      17380009
173900                                                                  17390009
174000*----------------------------------------------------------------*17400009
174100*    ABEND PROCESSOR MODULE                                      *17410009
174200*----------------------------------------------------------------*17420009
174300     COPY DPPD013.                                                17430009
174400                                                                  17440009
174500*----------------------------------------------------------------*17450009
174600*    DATE AND TIME MODULE                                        *17460009
174700*----------------------------------------------------------------*17470009
174800     COPY DPPD017.                                                17480009
