000100******************************************************************00010000
000200*  THIS IS A PROGRAM THAT CAN BE USED TO TAKE IN A FILE IN THE    00020000
000300*  RCRD098 FORMAT AND GENERATE RECEIVERS FOR THE PO'S IN THE      00030000
000400*  FILE.                                                          00040000
000411*  THIS PROGRAM WAS COPIED FROM (RCKUP066) NO TROUBLE OR FSA      00041102
000420*                                                                 00042000
000430*  THIS PROGRAM WILL CREATE A NEW "CR" RECEIVER WHENEVER THERE IS 00043000
000440*  A CHANGE IN DC/PO NUMBER ON THE FILE.                          00044000
000450*                                                                 00045000
000460*  INPUT FILE IS CREATED BY RCKUT166, IN RCRD098 FORMAT.          00046000
000470*  THE FILE UPLOADS FROM P2L THAT DID NOT PROCESS SINCE TDISTHD   00047000
000480*  AND TDISTDT PURGEINCL_ADJ)                                     00048000
000490*                                                                 00049000
000491*  FILE COMING INTO THIS PROGRAM SHOULD BE IN PO/DC/LINE SEQUENCE.00049100
000492*                                                                 00049200
000493*  OUTPUT FILE WILL CONTAIN THE NEW RECEIVER NUMBER THAT WAS      00049300
000494*  CREATED.  THIS WILL BE USED FOR REPORTING PURPOSES.            00049400
000495*                                                                 00049500
000496*  THIS PROGRAM WILL DO THE FOLLOWING:                            00049600
000497*       - CREATE CR RECEIVER FOR DC-PO                            00049700
000498*       - BOL ON THE NEW RECEIVER WILL REFERENCE THE ORIG RCVR    00049800
000499*         TSHIPMT                                                 00049900
000500*         EX:   REF10738024-8FSA    OR    REFMULTDWNLDPRG         00050002
000501*       - VERIFY THE CR RECEIVER                                  00050100
000504******************************************************************00050400
000505 IDENTIFICATION DIVISION.                                         00050500
000506 PROGRAM-ID.             RCKUP998.                                00050600
000507 AUTHOR.                 DENISE HAHN.                             00050700
000508 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00050800
000509 DATE-WRITTEN.           MARCH 2017.                              00050900
000510 DATE-COMPILED.                                                   00051000
000520                                                                  00052000
000530******************************************************************00053000
000540*                                                                 00054000
000550                                                                  00055000
000560* GENERAL PROCESSING:                                             00056000
000570* -------------------                                             00057000
000580* 1) INITIALIZE VARIABLES, SET SWITCHES, OPEN INPUT & OUTPUT      00058000
000590*                                                                 00059000
000600* 2) WHEN A ORDER/STORE HAS BEEN PROCESSED, THE DATA WILL BE      00060000
000700*    LOADED TO THE RECEIVER AN PACKSLIP TABLES.                   00070000
000800*                                                                 00080000
000900* 3) EVERYTHING WILL GET INITIALIZED AND RESET - READY FOR THE    00090000
001000*    NEXT RECORD                                                  00100000
001100*                                                                 00110000
001200* ERROR PROCESSING:                                               00120000
001300* -----------------                                               00130000
001400* THIS PRGM IS CODED TO TRAP 23 TYPES OF ERRORS WHICH INCLUDE:    00140000
001500*                                                                 00150000
001600* 1) VALUE 1 - ROW NOT FOUND                                      00160000
001700* 2) VALUE 2 - STYLE ID NOT FOUND                                 00170000
001800* 3) VALUE 3 - DUP INSERT ON STYLE                                00180000
001900* 4) VALUE 4 - DUP INSERT ON SKU                                  00190000
002000* 5) VALUE 5 - SIZE DESC CODE MISMATCH                            00200000
002100* 6) VALUE 6 - DUP UPDATE STYLE                                   00210000
002200* 7) VALUE 7 - DUP INSERT ON UPC                                  00220000
002300* 8) VALUE 8 - UPC ROW NOT FOUND                                  00230000
002400* 9) VALUE 9 - DUP UPDATE UPC                                     00240000
002500* 10)VALUE 10- SKU ROW PROBLEM                                    00250000
002600* 11)VALUE 11- SKU INTR UPC ID NOT FOUND                          00260000
002700* 12)VALUE 12- PK INSERT NOT SUCCESS                              00270000
002800* 13)VALUE 13- PK DELETE NOT SUCCESS                              00280000
002900* 14)VALUE 14- PK UPDATE NOT SUCCESS                              00290000
003000* 15)VALUE 15- PK CPT INSERT NOT SUCCESS                          00300000
003100* 16)VALUE 16- PK CPT DELETE NOT SUCCESS                          00310000
003200* 17)VALUE 17- PK CPT UPDATE NOT SUCCESS                          00320000
003300* 18)VALUE 18- PK UPC INSERT NOT SUCCESS                          00330000
003400* 19)VALUE 19- PK UPC DELETE NOT SUCCESS                          00340000
003500* 20)VALUE 20- PK UPC UPDATE NOT SUCCESS                          00350000
003600* 21)VALUE 21- POPRPK INSERT NOT SUCCESS                          00360000
003700* 22)VALUE 22- POPRPK DELETE NOT SUCCESS                          00370000
003800* 23)VALUE 23- POPRPK UPDATE NOT SUCCESS                          00380000
003900*                                                                 00390000
004000* UNITS OF WORK AND COMMITS:                                      00400000
004100* --------------------------                                      00410000
004200* A UNIT OF WORK FOR A DB2 COMMIT WILL BE COMPLETE WHEN A         00420000
004300* RECORD HAS BEEN READ FROM THE INPUT FILE, AND ALL TABLE         00430000
004400* INSERTS AND UPDATES HAVE BEEN DONE WITH NO ERRORS.              00440000
004500* THE DB2 COMMIT IS PERFORMED.                                    00450000
004600*                                                                 00460000
004700* CHANGE LOG:                                                  *  00470000
004800*                                                              *  00480000
004900******************************************************************00490000
005000 ENVIRONMENT DIVISION.                                            00500000
005100******************************************************************00510000
005200 CONFIGURATION SECTION.                                           00520000
005300 SOURCE-COMPUTER.        IBM-3090.                                00530000
005400 OBJECT-COMPUTER.        IBM-3090.                                00540000
005500                                                                  00550000
005600 INPUT-OUTPUT SECTION.                                            00560000
005700 FILE-CONTROL.                                                    00570000
005800                                                                  00580000
005900* ------------------------------------------------------------- * 00590000
006000     SELECT INPUT-FILE                                            00600000
006100            ASSIGN TO INP01.                                      00610000
006200     SELECT ERROR-FILE                                            00620000
006300            ASSIGN TO OUT01.                                      00630000
006400     SELECT BKUP-FILE                                             00640000
006500            ASSIGN TO OUT02.                                      00650000
006600     SELECT OUTPUT-FILE                                           00660000
006700            ASSIGN TO OUT03.                                      00670000
006800                                                                  00680000
006900******************************************************************00690000
007000 DATA DIVISION.                                                   00700000
007100******************************************************************00710000
007200 FILE SECTION.                                                    00720000
007300                                                                  00730000
007400 FD  INPUT-FILE                                                   00740000
007500     RECORDING MODE F                                             00750000
007600     BLOCK CONTAINS 0 RECORDS                                     00760000
007700     LABEL RECORDS ARE OMITTED.                                   00770000
007800 01  INPUT-RECORD                     PIC  X(200).                00780000
007900                                                                  00790000
008000 FD  ERROR-FILE                                                   00800000
008100     RECORDING MODE F                                             00810000
008200     BLOCK CONTAINS 0 RECORDS                                     00820000
008300     LABEL RECORDS ARE OMITTED.                                   00830000
008400 01  ERROR-RECORD                     PIC  X(200).                00840000
008500                                                                  00850000
008600 FD  BKUP-FILE                                                    00860000
008700     RECORDING MODE F                                             00870000
008800     BLOCK CONTAINS 0 RECORDS                                     00880000
008900     LABEL RECORDS ARE OMITTED.                                   00890000
009000 01  BKUP-RECORD                      PIC  X(080).                00900000
009100                                                                  00910000
009200 FD  OUTPUT-FILE                                                  00920000
009300     RECORDING MODE F                                             00930000
009400     BLOCK CONTAINS 0 RECORDS                                     00940000
009500     LABEL RECORDS ARE OMITTED.                                   00950000
009600 01  OUTPUT-RECORD                    PIC  X(200).                00960000
009610                                                                  00961000
009620******************************************************************00962000
009630 WORKING-STORAGE SECTION.                                         00963000
009640******************************************************************00964000
009650*  COMMUNICATIONS AREA FOR DB2                                    00965000
009660******************************************************************00966000
009670     EXEC SQL                                                     00967000
009680          INCLUDE SQLCA                                           00968000
009690     END-EXEC.                                                    00969000
009700                                                                  00970000
009800                                                                  00980000
009900*----------------------------------------------------------------*00990000
010000*    DB2 DCLGEN FOR THE PURCHASE ITEM TABLE                       01000000
010100*----------------------------------------------------------------*01010000
010200     EXEC SQL                                                     01020000
010300          INCLUDE TPURITM                                         01030000
010400     END-EXEC.                                                    01040000
010500                                                                  01050000
010600*----------------------------------------------------------------*01060000
010700*    DB2 DCLGEN FOR THE RECEIVER NUMBER TABLE                     01070000
010800*----------------------------------------------------------------*01080000
010900     EXEC SQL                                                     01090000
011000          INCLUDE TRECVER                                         01100000
011100     END-EXEC.                                                    01110000
011200                                                                  01120000
011300******************************************************************01130000
011400*    DB2 DCLGEN FOR PURCHASE ORDER TABLE                          01140000
011500******************************************************************01150000
011600     EXEC SQL                                                     01160000
011700          INCLUDE TPURCHS                                         01170000
011800     END-EXEC.                                                    01180000
011900                                                                  01190000
012000*----------------------------------------------------------------*01200000
012100*    DB2 DCLGEN FOR PO AGREEMENT TABLE                            01210000
012200*----------------------------------------------------------------*01220000
012300     EXEC SQL                                                     01230000
012400          INCLUDE TPOAGMT                                         01240000
012500     END-EXEC.                                                    01250000
012600                                                                  01260000
012700*----------------------------------------------------------------*01270000
012800*    DB2 DCLGEN FOR PACK SLIP HEADER TABLE                        01280000
012900*----------------------------------------------------------------*01290000
013000     EXEC SQL                                                     01300000
013100          INCLUDE TPKSLIP                                         01310000
013200     END-EXEC.                                                    01320000
013300                                                                  01330000
013400*----------------------------------------------------------------*01340000
013500*    DB2 DCLGEN FOR PACK SLIP ITEM TABLE                          01350000
013600*----------------------------------------------------------------*01360000
013700     EXEC SQL                                                     01370000
013800          INCLUDE TPKITEM                                         01380000
013900     END-EXEC.                                                    01390000
014000                                                                  01400000
014100*---------------------------------------------------------------* 01410000
014200*    DB2 AREA FOR RECEIVER TABLE                                * 01420000
014300*---------------------------------------------------------------* 01430000
014400     EXEC SQL                                                     01440000
014500          INCLUDE TRECEIV                                         01450000
014600     END-EXEC.                                                    01460000
014700                                                                  01470000
014800******************************************************************01480000
014900*    DB2 DCLGEN FOR THE RECEIVER ITEM TABLE                       01490000
015000******************************************************************01500000
015100     EXEC SQL                                                     01510000
015200          INCLUDE TRECITM                                         01520000
015300     END-EXEC.                                                    01530000
015400                                                                  01540000
015500******************************************************************01550000
015600*    DB2 DCLGEN FOR THE RECEIPT DISTRIBUTION TABLE                01560000
015700******************************************************************01570000
015800     EXEC SQL                                                     01580000
015900          INCLUDE TRECDIS                                         01590000
016000     END-EXEC.                                                    01600000
016100                                                                  01610000
016200******************************************************************01620000
016300*    DB2 DCLGEN FOR THE PARAMETER TABLE                           01630000
016400******************************************************************01640000
016500     EXEC SQL                                                     01650000
016600          INCLUDE TKRPRPM                                         01660000
016700     END-EXEC.                                                    01670000
016800                                                                  01680000
016900*---------------------------------------------------------------* 01690000
017000*    DB2 AREA FOR XLT_MDSE_INV_PARM-INVENTORY PARAMENTERS TABLE * 01700000
017100*---------------------------------------------------------------* 01710000
017200     EXEC SQL                                                     01720000
017300          INCLUDE XLT00025                                        01730000
017400     END-EXEC.                                                    01740000
017500                                                                  01750000
018296******************************************************************01829600
018297*    DB2 DCLGEN WFT_LOD_CNTL                                      01829700
018298******************************************************************01829800
018299     EXEC SQL                                                     01829900
018300          INCLUDE WFT00001                                        01830000
018400     END-EXEC.                                                    01840000
018500                                                                  01850000
018600******************************************************************01860000
018610*    DB2 DCLGEN WFT_LOD_XFER                                      01861000
018620******************************************************************01862000
018630     EXEC SQL                                                     01863000
018640          INCLUDE WFT00002                                        01864000
018650     END-EXEC.                                                    01865000
018660                                                                  01866000
018670*-----------------------------------------------------------------01867000
018680*    TRECVER-CSR                                                  01868000
018690*-----------------------------------------------------------------01869000
018691     EXEC SQL                                                     01869100
018692          DECLARE TRECVER-CSR CURSOR FOR                          01869200
018693           SELECT MAX_RCVR_NBR                                    01869300
018694           FROM   TRECVER                                         01869400
018695           WHERE  OPERCO_NBR = '03'                               01869500
018696           FOR UPDATE OF MAX_RCVR_NBR                             01869600
018697     END-EXEC.                                                    01869700
018698                                                                  01869800
018699                                                                  01869900
018720******************************************************************01872000
018730* INPUT LAYOUT                                                    01873000
018740******************************************************************01874000
018750     COPY RCRD098.                                                01875000
018760                                                                  01876000
018770******************************************************************01877000
018780*  WORK AREA FOR SQL ERROR ROUTINE 'DSNTIAR'.                     01878000
018790******************************************************************01879000
018800     COPY DPWS004.                                                01880000
018900                                                                  01890000
019000*                                                                 01900000
019100 01  PA-PROGRAM-ACCUMULATORS.                                     01910000
019200     05  PA-TO-VERIFY-QTY             PIC S9(09) VALUE +0 COMP-3. 01920000
019300     05  PA-TOTALS.                                               01930000
019400         10 PA-TOTAL-RECORDS-READ     PIC S9(09) VALUE +0 COMP-3. 01940000
019500         10 PA-TOTAL-UNITS-PROCESSED  PIC S9(09) VALUE +0 COMP-3. 01950000
019600                                                                  01960000
019700         10 PA-TOTAL-ERROR-RECS       PIC S9(09) VALUE +0 COMP-3. 01970000
019800         10 PA-TOTAL-PROCESS-RECS     PIC S9(09) VALUE +0 COMP-3. 01980000
019900         10 PA-TOTAL-TPKSLIP-INSERTS  PIC S9(09) VALUE +0 COMP-3. 01990000
020000         10 PA-TOTAL-TPKSLIP-UPDATES  PIC S9(09) VALUE +0 COMP-3. 02000000
020100         10 PA-TOTAL-TPKITEM-INSERTS  PIC S9(09) VALUE +0 COMP-3. 02010000
020200         10 PA-TOTAL-TRECEIV-INSERTS  PIC S9(09) VALUE +0 COMP-3. 02020000
020300         10 PA-TOTAL-TRECEIV-UPDATES  PIC S9(09) VALUE +0 COMP-3. 02030000
020400         10 PA-TOTAL-TRECITM-INSERTS  PIC S9(09) VALUE +0 COMP-3. 02040000
020500         10 PA-TOTAL-TRECDIS-INSERTS  PIC S9(09) VALUE +0 COMP-3. 02050000
020600         10 PA-TOTAL-WFT-CNTL-INSERTS PIC S9(09) VALUE +0 COMP-3. 02060000
020700         10 PA-TOTAL-WFT-XFER-INSERTS PIC S9(09) VALUE +0 COMP-3. 02070000
020800         10 PA-TOTAL-TROUBLE-UPDATES  PIC S9(09) VALUE +0 COMP-3. 02080000
020900         10 PA-TROUBLE-DETAIL-COUNT   PIC S9(09) VALUE +0 COMP-3. 02090000
021000         10 PA-TOTAL-FINCL-ADJ-UPDATE PIC S9(09) VALUE +0 COMP-3. 02100000
021100                                                                  02110000
021200         10 PT-TOTAL-TPKSLIP-INSERTS  PIC S9(09) VALUE +0 COMP-3. 02120000
021300         10 PT-TOTAL-TPKSLIP-UPDATES  PIC S9(09) VALUE +0 COMP-3. 02130000
021400         10 PT-TOTAL-TPKITEM-INSERTS  PIC S9(09) VALUE +0 COMP-3. 02140000
021500         10 PT-TOTAL-TRECEIV-INSERTS  PIC S9(09) VALUE +0 COMP-3. 02150000
021600         10 PT-TOTAL-TRECEIV-UPDATES  PIC S9(09) VALUE +0 COMP-3. 02160000
021700         10 PT-TOTAL-TRECITM-INSERTS  PIC S9(09) VALUE +0 COMP-3. 02170000
021800         10 PT-TOTAL-TRECDIS-INSERTS  PIC S9(09) VALUE +0 COMP-3. 02180000
021900         10 PT-TOTAL-WFT-CNTL-INSERTS PIC S9(09) VALUE +0 COMP-3. 02190000
022000         10 PT-TOTAL-WFT-XFER-INSERTS PIC S9(09) VALUE +0 COMP-3. 02200000
022100         10 PT-TOTAL-TROUBLE-UPDATES  PIC S9(09) VALUE +0 COMP-3. 02210000
022200         10 PT-TROUBLE-DETAIL-COUNT   PIC S9(09) VALUE +0 COMP-3. 02220000
022210         10 PT-TOTAL-FINCL-ADJ-UPDATE PIC S9(09) VALUE +0 COMP-3. 02221000
022220         10 PA-TOTAL-DB2-COMMITS      PIC S9(09) VALUE +0 COMP-3. 02222000
022230                                                                  02223000
022240 01  PS-PROGRAM-SWITCHES.                                         02224000
022250     05  PS-SAME-DC-PO-SW            PIC X(01) VALUE 'N'.         02225000
022260         88  PS-SAME-DC-PO-YES                 VALUE 'Y'.         02226000
022270         88  PS-SAME-DC-PO-NO                  VALUE 'N'.         02227000
022280     05  PS-SAME-DC-PO-LNE-SW        PIC X(01) VALUE 'N'.         02228000
022290         88  PS-SAME-DC-PO-LNE-YES             VALUE 'Y'.         02229000
022300         88  PS-SAME-DC-PO-LNE-NO              VALUE 'N'.         02230000
022400     05  PS-END-OF-INPUT-FILE-SW     PIC X(01) VALUE 'N'.         02240000
022500         88  PS-END-OF-INPUT                   VALUE 'Y'.         02250000
022600         88  PS-NOT-END-OF-INPUT               VALUE 'N'.         02260000
022700     05  PS-EOF-TROUBLE-CSR-SW       PIC X(01) VALUE 'N'.         02270000
022800         88  PS-EOF-TROUBLE                    VALUE 'Y'.         02280000
022900         88  PS-EOF-TROUBLE-NO                 VALUE 'N'.         02290000
023000     05  PS-DC-FLUSH-SW              PIC X(01) VALUE 'N'.         02300000
023100         88  PS-DC-FLUSH-YES                   VALUE 'Y'.         02310000
023200         88  PS-DC-FLUSH-NO                    VALUE 'N'.         02320000
023300                                                                  02330000
023400     05  PS-TRECVER-CURSOR-SW          PIC  X(01)  VALUE 'N'.     02340000
023500         88  PS-EOF-TRECVER-CSR                    VALUE 'Y'.     02350000
023600         88  PS-EOF-TRECVER-NO                     VALUE 'N'.     02360000
023700                                                                  02370000
023800                                                                  02380000
023900     05  PS-PKSLIP-INSERTED-SW         PIC  X(01)  VALUE 'N'.     02390000
024000         88  PS-PKSLIP-NOT-INSERTED                VALUE 'N'.     02400000
024100         88  PS-PKSLIP-INSERTED                    VALUE 'Y'.     02410000
024200     05  PS-ERROR-SW                   PIC  X(01)  VALUE 'N'.     02420000
024300         88  PS-ERROR-YES                          VALUE 'Y'.     02430000
024400         88  PS-ERROR-NO                           VALUE 'N'.     02440000
024500                                                                  02450000
024510     05  PS-FSA-RESOLVED-SW            PIC  X(01)  VALUE 'N'.     02451000
024520         88  PS-FSA-RESOLVED                       VALUE 'Y'.     02452000
024530         88  PS-FSA-RESOLVED-NO                    VALUE 'N'.     02453000
024540                                                                  02454000
024550 01  PC-PROGRAM-CONSTANTS.                                        02455000
024560     05  PC-CURRENT-PROGRAM-NAME    PIC X(08)  VALUE 'RCKUP998'.  02456000
024570     05  PC-DWNLDPRG                PIC X(08)  VALUE 'DWNLDPRG'.  02457002
024580                                                                  02458002
024590 01  DK-DB2-KEYS.                                                 02459000
024600     05  DK-OPER-UNIT-ID              PIC S9(04) COMP VALUE +0.   02460000
024700     05  DK-PO-NBR                    PIC S9(09) COMP VALUE +0.   02470000
024800     05  DK-AGRMT-TYP-ID              PIC X(01)  VALUE SPACES.    02480000
024900     05  DK-TYP-CDE                   PIC S9(04) COMP VALUE +0.   02490000
025000     05  DK-LNE-NBR                   PIC S9(09) COMP VALUE +0.   02500000
025100     05  DK-HOLD-PO-NBR               PIC S9(09) COMP VALUE +0.   02510000
025200     05  DK-HOLD-LNE-NBR              PIC S9(09) COMP VALUE +0.   02520000
025300                                                                  02530000
025400 01  PV-BKUP-RECORDS.                                             02540000
025500     05  PV-BKUP-RECORD-1.                                        02550000
025600         10  FILLER                 PIC X(05)  VALUE 'OPER:'.     02560000
025700         10  PV-BKUP-OPER-UNT-ID    PIC 9(04).                    02570000
025800         10  FILLER                 PIC X(05)  VALUE '  PO:'.     02580000
025900         10  PV-BKUP-PO-NBR-1       PIC 9(09).                    02590000
026000         10  FILLER                 PIC X(06)  VALUE              02600000
026100                                                  '  LNE:'.       02610000
026200         10  PV-BKUP-PO-LNE-1       PIC 9(04).                    02620000
026300         10  FILLER                 PIC X(06)  VALUE              02630000
026400                                                  '  STR:'.       02640000
026500         10  PV-BKUP-STR-NBR-1      PIC 9(05).                    02650000
026600         10  FILLER                 PIC X(09)  VALUE              02660000
026700                                                   '  VE QTY:'.   02670000
026800         10  PV-BKUP-TO-VERIFY-QTY-1 PIC 9(09).                   02680000
026900         10  FILLER                 PIC X(07)  VALUE SPACES.      02690000
027000                                                                  02700000
027100                                                                  02710000
027200     05  PV-BKUP-RECORD-2.                                        02720000
027300         10  FILLER                 PIC X(14)  VALUE              02730000
027400                                              'PO / RECEIVER '.   02740000
027500         10  PV-BKUP-PO-NBR-2       PIC 9(09).                    02750000
027600         10  FILLER                 PIC X(01)  VALUE SPACE.       02760000
027700         10  PV-BKUP-REC-SEQ-2      PIC 9(09).                    02770000
027800         10  FILLER                 PIC X(47)  VALUE SPACE.       02780000
027900                                                                  02790000
028000 01  PV-PROGRAM-VARIABLES.                                        02800000
028100     05  PV-SEQ-NBR-IND             PIC S9(04) VALUE +0           02810000
028200                                                  COMP.           02820000
028300     05  PV-NEXT-SEQ-NBR            PIC S9(04) VALUE +0           02830000
028400                                                 COMP.            02840000
028500     05  PV-SAVE-PKSLIP-SEQ-NBR     PIC S9(04) VALUE +0           02850000
028600                                                 COMP.            02860000
028700     05  PV-MAX-SEQ-NBR             PIC S9(04) VALUE +0           02870000
028800                                                 COMP.            02880000
028900     05  PV-COUNT                   PIC S9(04) VALUE +0           02890000
029000                                                 COMP.            02900000
029100     05  PV-DB2-COUNT               PIC S9(09)  VALUE +0          02910000
029200                                                 COMP-3.          02920000
029300     05  PV-WORK-DATE-PLUS-7        PIC  X(10)  VALUE ZEROS.      02930000
029400     05  PV-DISP-PO                 PIC 9(09).                    02940000
029500     05  PV-DISP-REC-SEQ            PIC 9(09).                    02950000
029600     05  PV-DISP-RCVR               PIC 9(04).                    02960000
029700     05  PV-DISP-LINE-NBR           PIC 9(04).                    02970000
029800     05  PV-DISP-TYP-CDE            PIC 9(04).                    02980000
029900     05  PV-DISP-STR-NBR            PIC 9(04).                    02990000
030000     05  PV-DISP-SQLCODE            PIC -9(09).                   03000000
030100     05  PV-DISP-SEQ                PIC 9(09).                    03010000
030200     05  PV-PARAGRAPH               PIC X(48)  VALUE SPACES.      03020000
030300     05  PV-REC-SEQ-NBR             PIC S9(09) VALUE +0 COMP.     03030000
030400                                                                  03040000
030500     05  PV-EXPTED-ITM-QTY          PIC  S9(9) COMP.              03050000
030600     05  PV-VERIFY-ITM-QTY          PIC  S9(9) COMP.              03060000
030700     05  PV-AP-VERIFY-ITM-QTY       PIC  S9(9) COMP.              03070000
030800                                                                  03080000
030900     05  PW-CONTROL-REC.                                          03090000
031000         10  PW-CONTROL-KEYREC.                                   03100000
031100             20  PW-CONTROL-PANL-NBR.                             03110000
031200                 30  PW-CONTROL-PANEL    PIC 9(05)  VALUE ZERO.   03120000
031300                 30  PW-CONTROL-KEYREC-NBR                        03130000
031400                                         PIC 9(02)  VALUE ZERO.   03140000
031500             20  PW-CONTROL-PANL-NBR-9 REDEFINES                  03150000
031600                                       PW-CONTROL-PANL-NBR        03160000
031700                                         PIC 9(7).                03170000
031800             20  PW-CONTROL-CEHCK-DIG    PIC 9(01)  VALUE ZERO.   03180000
031900         10  PW-CONTROL-KEYREC-9 REDEFINES PW-CONTROL-KEYREC      03190000
032000                                         PIC 9(08).               03200000
032100         10  PW-CONTROL-FILLER           PIC X(73)  VALUE SPACE.  03210000
032200                                                                  03220000
032300     05  PW-QUOTIENT                     PIC S9(7)  VALUE ZERO.   03230000
032400     05  PW-REMAINDER                    PIC S9     VALUE ZERO.   03240000
032500                                                                  03250000
032600     05  PV-RECEIPT-ADJUSTMENT-REC.                               03260000
032700         10  PV-HEADER-DATA.                                      03270000
032800             15  PV-ORDER-NUMBER               PIC 9(09).         03280000
032900             15  PV-RCVR-ID                    PIC 9(09).         03290000
033000             15  PV-DC                         PIC 9(04).         03300000
033100             15  PV-SKU                        PIC 9(08).         03310000
033200             15  PV-VRFY-DATE                  PIC X(14).         03320000
033300             15  PV-STORE-COUNT                PIC 9(04).         03330000
033400             15  FILLER                        PIC X(52).         03340000
033500         10  PV-STORE-DATA OCCURS 1 TO 100 TIMES                  03350000
033600                              DEPENDING ON PV-STORE-COUNT         03360000
033700                              INDEXED BY PV-IDX.                  03370000
033800             15  PV-STORE                      PIC 9(04).         03380000
033900             15  PV-STORE-QTY                  PIC 9(09).         03390000
034000             15  PV-STORE-QTY-SIGN             PIC X(01).         03400000
034100                                                                  03410000
034200 01  PV-DB2-TMST                      PIC X(26).                  03420000
034300 01  FILLER  REDEFINES  PV-DB2-TMST.                              03430000
034400         10  PV-DB2-TMST-CCYY         PIC X(04).                  03440000
034500         10  FILLER                   PIC X(01).                  03450000
034600         10  PV-DB2-TMST-MO           PIC X(02).                  03460000
034700         10  FILLER                   PIC X(01).                  03470000
034800         10  PV-DB2-TMST-DA           PIC X(02).                  03480000
034900         10  FILLER                   PIC X(01).                  03490000
035000         10  PV-DB2-TMST-HH           PIC X(02).                  03500000
035100         10  FILLER                   PIC X(01).                  03510000
035200         10  PV-DB2-TMST-MM           PIC X(02).                  03520000
035300         10  FILLER                   PIC X(01).                  03530000
035400         10  PV-DB2-TMST-SS           PIC X(02).                  03540000
035500             88  PV-DB2-TMST-SS-01               VALUE '01'.      03550000
035600         10  FILLER                   PIC X(01).                  03560000
035700         10  PV-DB2-TMST-MS           PIC X(06).                  03570000
035800             88  PV-DB2-TMST-MS-ZERO             VALUE '000000'.  03580000
035900*PV-MSG IS WHAT GETS BROKEN DOWN INTO DTLS/GFTS/END               03590000
036000*01  PV-MSG.                                                      03600000
036100*    05  PV-MSG-END                 PIC X(18).                    03610000
036200*        88 PV-END-RUN-MSG          VALUE 'END RUN OF PROGRAM'.   03620000
036300*    05  FILLER                     PIC X(432).                   03630000
036400*                                                                 03640000
036500*01  PV-DTL.                                                      03650000
036600*    05  PV-DTL-EVENT               PIC 9(03)   VALUE ZERO.       03660000
036700*    05  FILLER                     PIC X(447)  VALUE SPACE.      03670000
036800                                                                  03680000
036900 01  PV-HOLD-FIELDS.                                              03690000
037000     05  PV-HOLD-OPER-UNT-ID        PIC  9(04).                   03700000
037100     05  PV-HOLD-PO-NBR             PIC  9(09).                   03710000
037200     05  PV-HOLD-CRE-UID            PIC  X(08).                   03720000
037300     05  PV-HOLD-PO-LNE-NBR         PIC  9(04).                   03730000
037400     05  PV-HOLD-REC-SEQ-NBR        PIC S9(09) VALUE +0.          03740000
037500     05  PV-HOLD-SEQ-NBR            PIC S9(04) VALUE +0           03750000
037600                                                 COMP.            03760000
037700                                                                  03770000
037800*01  PV-ABEND-VARIABLES.                                          03780000
037900*    05  PV-ABEND-CODE              PIC S9(04) VALUE +0 COMP SYNC.03790000
038000*    88  ABEND-4001-WRITE-ERROR                      VALUE +4001. 03800000
038100*    88  ABEND-4002-READ-ERROR                       VALUE +4002. 03810000
038200*    88  ABEND-4003-CTRL-CARD-ERROR                  VALUE +4003. 03820000
038300*    88  ABEND-4004-TABLE-ERROR                      VALUE +4004. 03830000
038400*    88  ABEND-4005-OPEN-ERROR                       VALUE +4005. 03840000
038500*    88  ABEND-4006-CLOSE-ERROR                      VALUE +4006. 03850000
038600*    88  ABEND-4007-SEQUENCE-ERROR                   VALUE +4007. 03860000
038700*    88  ABEND-4008-DATA-ERROR                       VALUE +4008. 03870000
038800*    88  ABEND-4009-KEY-DATA-ERROR                   VALUE +4009. 03880000
038900*    88  ABEND-4013-DB2-ERROR                        VALUE +4013. 03890000
039000*    88  ABEND-4019-CAL-SUB-ERROR                    VALUE +4019. 03900000
039100*    88  ABEND-4444-FORCED-ABEND                     VALUE +4444. 03910000
039200*                                                                 03920000
039300*                                                                 03930000
039400*                                                                 03940000
039500****************************************************************  03950000
039600 PROCEDURE DIVISION.                                              03960000
039700******************************************************************03970000
039800 0000-PROGRAM-MAINLINE.                                           03980000
039900     DISPLAY '************ START OF RCKUP998 ***************'     03990000
040000                                                                  04000000
040100*INIT VARIBLES, SET SWITHCES.                                     04010000
040200     PERFORM 1000-INITIALIZE.                                     04020000
040300                                                                  04030000
040400                                                                  04040000
040500     SET PS-NOT-END-OF-INPUT TO TRUE.                             04050000
040600                                                                  04060000
040700     OPEN INPUT  INPUT-FILE.                                      04070000
040800     OPEN OUTPUT ERROR-FILE                                       04080000
040900                 BKUP-FILE                                        04090000
041000                 OUTPUT-FILE.                                     04100000
041100     PERFORM 4000-READ-RECORD.                                    04110000
041200                                                                  04120000
041300     IF NOT PS-END-OF-INPUT                                       04130000
041400         SET PS-SAME-DC-PO-NO                                     04140000
041500             PS-SAME-DC-PO-LNE-YES TO TRUE                        04150000
041600                                                                  04160000
041700         MOVE RC098-OPER-UNIT   TO PV-HOLD-OPER-UNT-ID            04170000
041800         MOVE RC098-PO-NBR      TO PV-HOLD-PO-NBR                 04180000
041900         MOVE PC-DWNLDPRG       TO PV-HOLD-CRE-UID                04190002
042000         MOVE RC098-PO-LNE-NBR  TO PV-HOLD-PO-LNE-NBR             04200000
042100                                                                  04210000
042200         PERFORM 2000-PROCESS-INPUT                               04220000
042300             UNTIL PS-END-OF-INPUT                                04230000
042310         IF PS-ERROR-NO                                           04231000
042320             PERFORM 2200-ADD-TPKITEM                             04232000
042330         END-IF                                                   04233000
042340         IF PS-ERROR-NO                                           04234000
042350             PERFORM 2400-ADD-RECITM                              04235000
042360         END-IF                                                   04236000
042370     END-IF.                                                      04237000
042380                                                                  04238000
042390     PERFORM 5000-END-RUN-ROUTINE.                                04239000
042400                                                                  04240000
042500******************************************************************04250000
042600* INITIALIZE VARIABLES.                                           04260000
042700* SET SWITCHES.                                                   04270000
042800******************************************************************04280000
042900 1000-INITIALIZE.                                                 04290000
043000                                                                  04300000
043100     INITIALIZE   PA-TOTAL-TRECEIV-INSERTS                        04310000
043200                  PA-TOTAL-TRECEIV-UPDATES                        04320000
043300                  PA-TOTAL-TPKITEM-INSERTS                        04330000
043400                  PA-TOTAL-TRECITM-INSERTS                        04340000
043500                  PA-TOTAL-TRECDIS-INSERTS                        04350000
043600                  PA-TOTAL-WFT-CNTL-INSERTS                       04360000
043700                  PA-TOTAL-WFT-XFER-INSERTS                       04370000
043800                  PA-TOTAL-TROUBLE-UPDATES                        04380000
043900                  PA-TOTAL-TPKSLIP-INSERTS                        04390000
044000                  PA-TOTAL-TPKSLIP-UPDATES                        04400000
044100                  PA-TOTAL-DB2-COMMITS                            04410000
044200                  PA-TROUBLE-DETAIL-COUNT                         04420000
044300                  PA-TOTAL-FINCL-ADJ-UPDATE                       04430000
044400                  PV-HOLD-FIELDS.                                 04440000
044500                                                                  04450000
044600*INIT SWITCHES USED FOR EDITING EACH MSG, AND CONTINUING RUN OF   04460000
044700*PROGRAM.                                                         04470000
044800                                                                  04480000
044900****************************************************************  04490000
045000* INIT SOME FIELDS BEFORE THE NEXT ITEM IS PROCESSED.             04500000
045100* RESET SOME SWITCHES.                                            04510000
045200****************************************************************  04520000
045300 1300-REINITIALIZE.                                               04530000
045400                                                                  04540000
045500     SET PS-ERROR-NO  TO TRUE.                                    04550000
045600                                                                  04560000
045700******************************************************************04570000
045800* BREAKDOWN AND EDIT INPUT.                                       04580000
045900* EDIT DB2 TABLES                                                 04590000
046000* GET THE NEXT RECORD                                             04600000
046100******************************************************************04610000
046200 2000-PROCESS-INPUT.                                              04620000
046300                                                                  04630000
047010     PERFORM 2020-PROCESS-FAILED.                                 04701002
047021                                                                  04702100
047022     PERFORM 1300-REINITIALIZE.                                   04702200
047023                                                                  04702300
047024     PERFORM 4000-READ-RECORD                                     04702400
047025     IF NOT PS-END-OF-INPUT                                       04702500
047026         IF  RC098-OPER-UNIT     = DK-OPER-UNIT-ID AND            04702600
047027             RC098-PO-NBR        = DK-PO-NBR                      04702700
047028             SET PS-SAME-DC-PO-YES TO TRUE                        04702800
047029             IF RC098-PO-LNE-NBR = DK-LNE-NBR                     04702900
047030                 SET PS-SAME-DC-PO-LNE-YES TO TRUE                04703000
047031             ELSE                                                 04703100
047032                 SET PS-SAME-DC-PO-LNE-NO TO TRUE                 04703200
047033             END-IF                                               04703300
047034         ELSE                                                     04703400
047035             SET PS-SAME-DC-PO-NO                                 04703500
047036                 PS-SAME-DC-PO-LNE-NO   TO TRUE                   04703600
047037         END-IF                                                   04703700
047038     END-IF.                                                      04703800
047039                                                                  04703900
047040                                                                  04704000
047129******************************************************************04712900
047130* PROCESS RECEIVER CREATE FOR PACK-TO-LIGHT FAILED STORE ADJ      04713000
047131******************************************************************04713100
047132 2020-PROCESS-FAILED.                                             04713202
047133                                                                  04713300
047134     MOVE 0    TO PT-TOTAL-TPKSLIP-INSERTS                        04713400
047135                  PT-TOTAL-TPKSLIP-UPDATES                        04713500
047136                  PT-TOTAL-TPKITEM-INSERTS                        04713600
047137                  PT-TOTAL-TRECEIV-INSERTS                        04713700
047138                  PT-TOTAL-TRECEIV-UPDATES                        04713800
047139                  PT-TOTAL-TRECITM-INSERTS                        04713900
047140                  PT-TOTAL-TRECDIS-INSERTS                        04714000
047150                  PT-TROUBLE-DETAIL-COUNT                         04715000
047160                  PT-TOTAL-FINCL-ADJ-UPDATE.                      04716000
047170                                                                  04717000
047180     MOVE RC098-OPER-UNIT   TO DK-OPER-UNIT-ID.                   04718000
047190     MOVE RC098-PO-NBR      TO DK-PO-NBR.                         04719000
047200     MOVE RC098-PO-LNE-NBR  TO DK-LNE-NBR                         04720000
047300     MOVE RC098-STR-NBR      TO RECDIS-STR-NBR.                   04730000
047400                                                                  04740000
047500     IF PS-SAME-DC-PO-NO                                          04750000
047600         SET PS-DC-FLUSH-NO      TO TRUE                          04760000
047700         PERFORM 2250-CHECK-DC-FLUSH-PARM                         04770000
047800     END-IF.                                                      04780000
047900                                                                  04790000
048000     IF PS-DC-FLUSH-YES                                           04800000
048100         PERFORM 2275-CHECK-INV-IN-PROCESS                        04810000
048200     END-IF.                                                      04820000
048300                                                                  04830000
048400     IF PS-ERROR-NO                                               04840000
048500         IF PS-SAME-DC-PO-NO                                      04850000
048600             PERFORM 2100-ADD-PACK-SLIP-HEADER                    04860000
048700         ELSE                                                     04870000
048800             PERFORM 2160-UPDATE-PACK-SLIP-HEADER                 04880000
048900         END-IF                                                   04890000
049000     END-IF.                                                      04900000
049100                                                                  04910000
049200     IF PS-ERROR-NO                                               04920000
049300         IF PS-SAME-DC-PO-NO                                      04930000
049400             IF PV-HOLD-REC-SEQ-NBR = ZERO                        04940000
049500                 MOVE PV-REC-SEQ-NBR TO PV-HOLD-REC-SEQ-NBR       04950000
049600             END-IF                                               04960000
049700             IF PV-HOLD-SEQ-NBR = ZERO                            04970000
049800                 MOVE PV-NEXT-SEQ-NBR TO PV-HOLD-SEQ-NBR          04980000
049900             END-IF                                               04990000
050000         END-IF                                                   05000000
050100     END-IF.                                                      05010000
050200                                                                  05020000
050300     IF PS-ERROR-NO                                               05030000
050400         IF PS-SAME-DC-PO-NO                                      05040000
050500             PERFORM 2300-BUILD-RECEIVER-INFO                     05050000
050600         ELSE                                                     05060000
050700             PERFORM 2350-UPDATE-RECEIVER-INFO                    05070000
050800     END-IF.                                                      05080000
050900                                                                  05090000
051000     IF PS-SAME-DC-PO-LNE-NO                                      05100000
051100         IF PS-ERROR-NO                                           05110000
051200             PERFORM 2200-ADD-TPKITEM                             05120000
051300         END-IF                                                   05130000
051400         IF PS-ERROR-NO                                           05140000
051500             PERFORM 2400-ADD-RECITM                              05150000
051600         END-IF                                                   05160000
051700         MOVE RC098-PO-NBR        TO PV-HOLD-PO-NBR               05170000
051800         MOVE RC098-OPER-UNIT     TO PV-HOLD-OPER-UNT-ID          05180000
051900         MOVE PC-DWNLDPRG         TO PV-HOLD-CRE-UID              05190002
052000         MOVE RC098-PO-LNE-NBR    TO PV-HOLD-PO-LNE-NBR           05200000
052100         MOVE RC098-TO-VERIFY-QTY TO PA-TO-VERIFY-QTY             05210000
052200         IF PV-REC-SEQ-NBR NOT = PV-HOLD-REC-SEQ-NBR              05220000
052300             MOVE PV-REC-SEQ-NBR  TO PV-HOLD-REC-SEQ-NBR          05230000
052400         END-IF                                                   05240000
052500         IF PV-NEXT-SEQ-NBR NOT = PV-HOLD-SEQ-NBR                 05250000
052600             MOVE PV-NEXT-SEQ-NBR TO PV-HOLD-SEQ-NBR              05260000
052700         END-IF                                                   05270000
052800     ELSE                                                         05280000
052900         ADD RC098-TO-VERIFY-QTY  TO PA-TO-VERIFY-QTY             05290000
053000     END-IF.                                                      05300000
053100                                                                  05310000
053200     IF PS-ERROR-NO                                               05320000
053300         PERFORM 2500-PREPARE-TRECDIS                             05330000
053400     END-IF.                                                      05340000
053500                                                                  05350000
054104     IF PS-ERROR-NO                                               05410400
054105         PERFORM 2600-INSERT-WFT-LOD-CNTL                         05410500
054106     END-IF.                                                      05410600
054107                                                                  05410700
054108     IF PS-ERROR-NO                                               05410800
054109         PERFORM 2700-INSERT-WFT-LOD-XFER                         05410900
054110     END-IF.                                                      05411000
054120                                                                  05412000
054130                                                                  05413000
054140     IF PS-ERROR-NO                                               05414000
054150***      MOVE  PV-HOLD-SEQ-NBR  TO  RC098-NEW-PO-RCVR             05415000
054160         MOVE  PV-REC-SEQ-NBR   TO  RC098-NEW-PO-RCVR             05416000
054170         WRITE OUTPUT-RECORD FROM RC098-ITEM-REC                  05417000
054180         ADD  +1  TO  PA-TOTAL-PROCESS-RECS                       05418000
054181     END-IF.                                                      05418100
054182                                                                  05418200
054183*IF NO ERRORS, JUST CONTINUE,                                     05418300
054184*ELSE REINIT AND RESET SWITCHES AND GO AFTER THE NEXT MSG         05418400
054185*(NEW ITEM) ON THE QUEUE.                                         05418500
054186     IF PS-ERROR-YES                                              05418600
054187         WRITE ERROR-RECORD FROM RC098-ITEM-REC                   05418700
054188         ADD +1 TO PA-TOTAL-ERROR-RECS                            05418800
054189*       PERFORM 7100-ERROR-ROUTINE                                05418900
054190     END-IF.                                                      05419000
054200                                                                  05420000
054300     IF PS-ERROR-NO                                               05430000
054400         PERFORM 6000-DB2-COMMIT                                  05440000
054500         CONTINUE                                                 05450000
054600     ELSE                                                         05460000
054700         PERFORM 6100-DB2-ROLLBACK                                05470000
054800     END-IF.                                                      05480000
054900                                                                  05490000
055000                                                                  05500000
055100******************************************************************05510000
055200* INSERT, UPDATE OR DELETE TABLES.                                05520000
055300* DB2 COMMIT.                                                     05530000
055400******************************************************************05540000
055500 2100-ADD-PACK-SLIP-HEADER.                                       05550000
055600                                                                  05560000
055700     INITIALIZE DCLTPKSLIP.                                       05570000
055800     MOVE RC098-PO-NBR             TO PKSLIP-PO-NBR.              05580000
055900     MOVE RC098-OPER-UNIT          TO PKSLIP-OPER-UNT-ID.         05590000
056000     MOVE 1                        TO PKSLIP-FCLTY-ID.            05600000
056100     MOVE RC098-PO-NBR (3:7)       TO PKSLIP-PKSL-NBR.            05610000
056200     MOVE ZERO                     TO PKSLIP-STR-DEST-NBR.        05620000
056300     MOVE ZERO                     TO PKSLIP-PKSL-PG-CNT.         05630000
056400                                                                  05640000
056500     MOVE 1                        TO PKSLIP-EXPTED-PKG-QTY.      05650000
056600                                                                  05660000
056700     MOVE SPACES                   TO PKSLIP-OWNER-SCAC-ID.       05670000
056800     MOVE SPACES                   TO PKSLIP-ASN-NBR.             05680000
056900     MOVE SPACES                   TO PKSLIP-CONTNR-ID.           05690000
057000     MOVE ZERO                     TO PKSLIP-SHIPT-ID.            05700000
057100     STRING 'REFSEQ'                                              05710000
057200             RC098-ORIG-PO-RCVR                                   05720000
057300            'DWNLDPRG'                DELIMITED BY SIZE           05730002
057400                                 INTO PKSLIP-BOL-NBR.             05740000
057500     MOVE SPACES                   TO PKSLIP-PRO-NBR.             05750000
057600     MOVE SPACES                   TO PKSLIP-CRE-SRC-CDE.         05760000
057700     MOVE 'AC'                     TO PKSLIP-PKSL-STAT-CDE.       05770000
057800     MOVE PC-DWNLDPRG              TO PKSLIP-CRE-UID.             05780002
057900                                                                  05790000
058000*    GET PO VERSION NUMBER                                        05800000
058100     PERFORM 2110-GET-PO-VER-NBR.                                 05810000
058200     IF PS-ERROR-NO                                               05820000
058300         MOVE PURCHS-VER-NBR           TO PKSLIP-PO-VER-NBR       05830000
058400                                                                  05840000
058500*        GET NEXT PACKSLIP SEQUENCE NUMBER OF THE PO              05850000
058600         PERFORM 2120-GET-NEXT-SEQ-NBR                            05860000
058700     END-IF.                                                      05870000
058800                                                                  05880000
058900     IF PS-ERROR-NO                                               05890000
059000         MOVE PV-NEXT-SEQ-NBR          TO PKSLIP-SEQ-NBR          05900000
059100                                                                  05910000
059200         SET PS-PKSLIP-NOT-INSERTED    TO TRUE                    05920000
059300                                                                  05930000
059400*        GET THE NEXT RECEIVER SEQUENCE NUMBER FOR PO             05940000
059500         PERFORM 2130-GET-MAX-SEQ-NBR                             05950000
059600     END-IF.                                                      05960000
059700                                                                  05970000
059800     IF PS-ERROR-NO                                               05980000
059900         MOVE PV-REC-SEQ-NBR           TO PKSLIP-REC-SEQ-NBR      05990000
060000                                                                  06000000
060100         EXEC SQL                                                 06010000
060200              SET :PV-DB2-TMST         =  CURRENT_TIMESTAMP       06020000
060300         END-EXEC                                                 06030000
060400                                                                  06040000
060500         SET PV-DB2-TMST-SS-01                                    06050000
060600             PV-DB2-TMST-MS-ZERO   TO  TRUE                       06060000
060700         PERFORM 2140-INSERT-LOOP                                 06070000
060800             UNTIL PS-PKSLIP-INSERTED                             06080000
060900                OR PS-ERROR-YES                                   06090000
061000     END-IF.                                                      06100000
061100                                                                  06110000
061200 2110-GET-PO-VER-NBR.                                             06120000
061300                                                                  06130000
061400     EXEC SQL                                                     06140000
061500          SELECT VER_NBR                                          06150000
061600            INTO :PURCHS-VER-NBR                                  06160000
061700            FROM TPURCHS                                          06170000
061800           WHERE PO_NBR         = :DK-PO-NBR                      06180000
061900             AND VER_STATUS_CDE = 'A'                             06190000
062000     END-EXEC.                                                    06200000
062100                                                                  06210000
062200     EVALUATE TRUE                                                06220000
062300         WHEN SQLCODE = +0                                        06230000
062400              CONTINUE                                            06240000
062500         WHEN SQLCODE = +100                                      06250000
062600             MOVE DK-PO-NBR   TO PV-DISP-PO                       06260000
062700             MOVE SQLCODE     TO PV-DISP-SQLCODE                  06270000
062800             MOVE '2110-GET-PO-VER-NBR'                           06280000
062900                              TO RC098-ERROR-PARA-NAME            06290000
063000             SET RC098-PO-NOF                                     06300000
063100                 PS-ERROR-YES    TO TRUE                          06310000
063200             DISPLAY '******************************************' 06320000
063300             DISPLAY '*ABEND                                   *' 06330000
063400             DISPLAY '*PROGRAM   = RCKUP998                    *' 06340000
063500             DISPLAY '*DB2 OPER  = SELECT ON TPURCHS           *' 06350000
063600             DISPLAY '*PARAGRAPH = 2110-GET-PO-VER-NBR         *' 06360000
063700             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                06370000
063800             DISPLAY '*PO = ' PV-DISP-PO                          06380000
063900             DISPLAY '******************************************' 06390000
064000                                                                  06400000
064100         WHEN SQLWARN0 NOT = SPACES                               06410000
064200         WHEN SQLCODE < +0                                        06420000
064300         WHEN SQLCODE > +0                                        06430000
064400             MOVE DK-PO-NBR   TO PV-DISP-PO                       06440000
064500             MOVE SQLCODE     TO PV-DISP-SQLCODE                  06450000
064600             MOVE '2110-GET-PO-VER-NBR'                           06460000
064700                              TO RC098-ERROR-PARA-NAME            06470000
064800             SET RC098-DB-ERROR                                   06480000
064900                 PS-ERROR-YES    TO TRUE                          06490000
065000             DISPLAY '******************************************' 06500000
065100             DISPLAY '*ABEND                                   *' 06510000
065200             DISPLAY '*PROGRAM   = RCKUP998                    *' 06520000
065300             DISPLAY '*DB2 OPER  = SELECT ON TPURCHS           *' 06530000
065400             DISPLAY '*PARAGRAPH = 2110-GET-PO-VER-NBR         *' 06540000
065500             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                06550000
065600             DISPLAY '*PO = ' PV-DISP-PO                          06560000
065700             DISPLAY '******************************************' 06570000
065800     END-EVALUATE.                                                06580000
065900                                                                  06590000
066000*---------------------------------------------------------------- 06600000
066100* GET THE NEXT PACKSLIP SEQUENCE NUMBER FOR THE PO                06610000
066200*---------------------------------------------------------------- 06620000
066300 2120-GET-NEXT-SEQ-NBR.                                           06630000
066400                                                                  06640000
066500     MOVE ZEROS                    TO PV-MAX-SEQ-NBR.             06650000
066600                                                                  06660000
066700     EXEC SQL                                                     06670000
066800          SELECT MAX(SEQ_NBR)                                     06680000
066900            INTO :PV-MAX-SEQ-NBR :PV-SEQ-NBR-IND                  06690000
067000            FROM TPKSLIP                                          06700000
067100           WHERE PO_NBR = :DK-PO-NBR                              06710000
067200     END-EXEC.                                                    06720000
067300                                                                  06730000
067400     EVALUATE TRUE                                                06740000
067500         WHEN SQLCODE = +0                                        06750000
067600              COMPUTE PV-NEXT-SEQ-NBR =                           06760000
067700                      PV-MAX-SEQ-NBR + 1                          06770000
067800                                                                  06780000
067900         WHEN SQLCODE = +100                                      06790000
068000              MOVE +1          TO PV-NEXT-SEQ-NBR                 06800000
068100                                                                  06810000
068200         WHEN SQLWARN0 NOT = SPACES                               06820000
068300         WHEN SQLCODE < +0                                        06830000
068400         WHEN SQLCODE > +0                                        06840000
068500             MOVE DK-PO-NBR   TO PV-DISP-PO                       06850000
068600             MOVE SQLCODE     TO PV-DISP-SQLCODE                  06860000
068700             MOVE '2120-GET-NEXT-SEQ-NBR'                         06870000
068800                              TO RC098-ERROR-PARA-NAME            06880000
068900             SET RC098-DB-ERROR                                   06890000
069000                 PS-ERROR-YES    TO TRUE                          06900000
069100             DISPLAY '******************************************' 06910000
069200             DISPLAY '*ABEND                                   *' 06920000
069300             DISPLAY '*PROGRAM   = RCKUP998                    *' 06930000
069400             DISPLAY '*DB2 OPER  = SELECT ON TPKSLIP           *' 06940000
069500             DISPLAY '*PARAGRAPH = 2120-GET-NEXT-SEQ-NBR       *' 06950000
069600             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                06960000
069700             DISPLAY '*PO = ' PV-DISP-PO                          06970000
069800             DISPLAY '******************************************' 06980000
069900     END-EVALUATE.                                                06990000
070000                                                                  07000000
070100*----------------------------------------------------------------*07010000
070200* GET THE NEXT HIGHEST RECEIVER SEQ NBR                          *07020000
070300*----------------------------------------------------------------*07030000
070400 2130-GET-MAX-SEQ-NBR.                                            07040000
070500                                                                  07050000
070600     EXEC SQL                                                     07060000
070700         SELECT MAX(REC_SEQ_NBR)                                  07070000
070800         INTO  :RECEIV-REC-SEQ-NBR                                07080000
070900         FROM   TRECEIV                                           07090000
071000         WHERE  ORD_NBR = :DK-PO-NBR                              07100000
071100     END-EXEC.                                                    07110000
071200                                                                  07120000
071300     EVALUATE TRUE                                                07130000
071400         WHEN SQLCODE = +0                                        07140000
071500             MOVE RECEIV-REC-SEQ-NBR                              07150000
071600                             TO PV-REC-SEQ-NBR                    07160000
071700             ADD +1          TO PV-REC-SEQ-NBR                    07170000
071800         WHEN SQLCODE = +100                                      07180000
071900         WHEN SQLCODE = -305                                      07190000
072000             MOVE +1         TO PV-REC-SEQ-NBR                    07200000
072100                                                                  07210000
072200         WHEN SQLWARN0 NOT = SPACE                                07220000
072300         WHEN SQLCODE < +0                                        07230000
072400         WHEN SQLCODE > +0                                        07240000
072500             MOVE SQLCODE TO PV-DISP-SQLCODE                      07250000
072600             MOVE DK-PO-NBR   TO PV-DISP-PO                       07260000
072700             MOVE '2130-GET-MAX-SEQ-NBR'                          07270000
072800                              TO RC098-ERROR-PARA-NAME            07280000
072900             SET RC098-DB-ERROR                                   07290000
073000                 PS-ERROR-YES    TO TRUE                          07300000
073100             DISPLAY '******************************************' 07310000
073200             DISPLAY '*ABEND                                   *' 07320000
073300             DISPLAY '*PROGRAM   = RCKUP998                    *' 07330000
073400             DISPLAY '*DB2 OPER  = SELECT ON TRECEIV           *' 07340000
073500             DISPLAY '*PARAGRAPH = 2130-GET-MAX-SEQ-NBR        *' 07350000
073600             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                07360000
073700             DISPLAY '*PO = ' PV-DISP-PO                          07370000
073800             DISPLAY '******************************************' 07380000
073900     END-EVALUATE.                                                07390000
074000                                                                  07400000
074100*----------------------------------------------------------------*07410000
074200*    THIS ROUTINE ADDED TO PRECLUDE LOGICAL DUPLICATES FROM      *07420000
074300*    BEING INSERTED.  WHEN 2 USERS ARE ADDING PACK SLIPS TO      *07430000
074400*    THE SAME PO, IT IS POSSIBLE TO OBTAIN THE SAME SEQUENCE     *07440000
074500*    NUMBER (LOGICAL DUPLICATE).  BECAUSE THE TIMESTAMP IS PART  *07450000
074600*    OF THE PHYSICAL KEY, NO -803 OCCURS.  IN 5001, WE FORCE     *07460000
074700*    A 01 IN THE SECONDS FIELD AND ALL ZEROES IN THE MICRO-      *07470000
074800*    SECONDS FIELD.  THIS WILL CAUSE A -803 WHICH IS HANDLED     *07480000
074900*    HERE BY ADDING 1 TO THE SEQUENCE NUMBER.                    *07490000
075000*----------------------------------------------------------------*07500000
075100                                                                  07510000
075200 2140-INSERT-LOOP.                                                07520000
075300                                                                  07530000
075400     MOVE PKSLIP-SEQ-NBR  TO PV-SAVE-PKSLIP-SEQ-NBR.              07540000
075500                                                                  07550000
075600     PERFORM 2150-INSERT-TPKSLIP.                                 07560000
075700                                                                  07570000
075800     EVALUATE TRUE                                                07580000
075900         WHEN SQLCODE EQUAL ZERO                                  07590000
076000              SET PS-PKSLIP-INSERTED                              07600000
076100                                   TO TRUE                        07610000
076200                                                                  07620000
076300         WHEN SQLCODE EQUAL -803                                  07630000
076400              ADD 1                TO PKSLIP-SEQ-NBR              07640000
076500                                                                  07650000
076600     END-EVALUATE.                                                07660000
076700                                                                  07670000
076800                                                                  07680000
076900 2150-INSERT-TPKSLIP.                                             07690000
077000                                                                  07700000
077100     EXEC SQL                                                     07710000
077200          INSERT INTO TPKSLIP                                     07720000
077300                 (PO_NBR                                          07730000
077400               ,  SEQ_NBR                                         07740000
077500               ,  CRE_TMST                                        07750000
077600               ,  VER_STAT_CDE                                    07760000
077700               ,  OPER_UNT_ID                                     07770000
077800               ,  FCLTY_ID                                        07780000
077900               ,  PKSL_NBR                                        07790000
078000               ,  STR_DEST_NBR                                    07800000
078100               ,  REC_SEQ_NBR                                     07810000
078200               ,  SHIPT_ID                                        07820000
078300               ,  BOL_NBR                                         07830000
078400               ,  PRO_NBR                                         07840000
078500               ,  PKSL_STAT_CDE                                   07850000
078600               ,  CRE_UID                                         07860000
078700               ,  PO_VER_NBR                                      07870000
078800               ,  CRE_SRC_CDE                                     07880000
078900               ,  EXPTED_PKG_QTY                                  07890000
079000               ,  OWNER_SCAC_ID                                   07900000
079100               ,  ASN_NBR                                         07910000
079200               ,  VEND_SHIP_DTE                                   07920000
079300               ,  PKSL_PG_CNT                                     07930000
079400               ,  CONTNR_ID                                       07940000
079500               ,  ORIG_PKSL_SEQ_NBR)                              07950000
079600          VALUES (:PKSLIP-PO-NBR                                  07960000
079700               ,  :PKSLIP-SEQ-NBR                                 07970000
079800               ,  :PV-DB2-TMST                                    07980000
079900               ,  'A'                                             07990000
080000               ,  :PKSLIP-OPER-UNT-ID                             08000000
080100               ,  :PKSLIP-FCLTY-ID                                08010000
080200               ,  :PKSLIP-PKSL-NBR                                08020000
080300               ,  :PKSLIP-STR-DEST-NBR                            08030000
080400               ,  :PKSLIP-REC-SEQ-NBR                             08040000
080500               ,  :PKSLIP-SHIPT-ID                                08050000
080600               ,  :PKSLIP-BOL-NBR                                 08060000
080700               ,  :PKSLIP-PRO-NBR                                 08070000
080800               ,  :PKSLIP-PKSL-STAT-CDE                           08080000
080900               ,  :PC-DWNLDPRG                                    08090002
081000               ,  :PKSLIP-PO-VER-NBR                              08100000
081100               ,  :PKSLIP-CRE-SRC-CDE                             08110000
081200               ,  :PKSLIP-EXPTED-PKG-QTY                          08120000
081300               ,  :PKSLIP-OWNER-SCAC-ID                           08130000
081400               ,  :PKSLIP-ASN-NBR                                 08140000
081500               ,  CURRENT_DATE                                    08150000
081600               ,  :PKSLIP-PKSL-PG-CNT                             08160000
081700               ,  :PKSLIP-CONTNR-ID                               08170000
081800               ,  :PKSLIP-ORIG-PKSL-SEQ-NBR)                      08180000
081900     END-EXEC.                                                    08190000
082000                                                                  08200000
082100     EVALUATE TRUE                                                08210000
082200         WHEN SQLCODE = +0                                        08220000
082300              MOVE +1       TO PT-TOTAL-TPKSLIP-INSERTS           08230000
082400         WHEN SQLWARN0 NOT = SPACES                               08240000
082500         WHEN SQLCODE < +0                                        08250000
082600         WHEN SQLCODE > +0                                        08260000
082700             MOVE PKSLIP-PO-NBR   TO PV-DISP-PO                   08270000
082800             MOVE SQLCODE     TO PV-DISP-SQLCODE                  08280000
082900             MOVE '2150-INSERT-TPKSLIP'                           08290000
083000                              TO RC098-ERROR-PARA-NAME            08300000
083100             SET RC098-DB-ERROR                                   08310000
083200                 PS-ERROR-YES    TO TRUE                          08320000
083300             DISPLAY '******************************************' 08330000
083400             DISPLAY '*ABEND                                   *' 08340000
083500             DISPLAY '*PROGRAM   = RCKUP998                    *' 08350000
083600             DISPLAY '*DB2 OPER  = INSERT ON TPKSLIP           *' 08360000
083700             DISPLAY '*PARAGRAPH = 2150-INSERT-TPKSLIP         *' 08370000
083800             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                08380000
083900             DISPLAY '*PO = ' PV-DISP-PO                          08390000
084000             DISPLAY '******************************************' 08400000
084100     END-EVALUATE.                                                08410000
084200                                                                  08420000
084300 2160-UPDATE-PACK-SLIP-HEADER.                                    08430000
084400     PERFORM 2170-SELECT-TPKSLIP.                                 08440000
084500     COMPUTE PKSLIP-EXPTED-PKG-QTY = PKSLIP-EXPTED-PKG-QTY +      08450000
084600                RC098-TO-VERIFY-QTY.                              08460000
084700     PERFORM 2180-UPDATE-TPKSLIP.                                 08470000
084800                                                                  08480000
084900 2170-SELECT-TPKSLIP.                                             08490000
085000                                                                  08500000
085100     EXEC SQL                                                     08510000
085200          SELECT EXPTED_PKG_QTY                                   08520000
085300            INTO :PKSLIP-EXPTED-PKG-QTY                           08530000
085400            FROM TPKSLIP                                          08540000
085500           WHERE PO_NBR       = :DK-PO-NBR                        08550000
085600             AND SEQ_NBR      = :PV-SAVE-PKSLIP-SEQ-NBR           08560000
085700             AND VER_STAT_CDE = 'A'                               08570000
085800     END-EXEC.                                                    08580000
085900                                                                  08590000
086000     EVALUATE TRUE                                                08600000
086100         WHEN SQLCODE = +0                                        08610000
086200              CONTINUE                                            08620000
086300         WHEN SQLWARN0 NOT = SPACES                               08630000
086400         WHEN SQLCODE < +0                                        08640000
086500         WHEN SQLCODE > +0                                        08650000
086600             MOVE DK-PO-NBR       TO PV-DISP-PO                   08660000
086700             MOVE PV-SAVE-PKSLIP-SEQ-NBR                          08670000
086800                                  TO PV-DISP-SEQ                  08680000
086900             MOVE SQLCODE     TO PV-DISP-SQLCODE                  08690000
087000             MOVE '2170-SELECT-TPKSLIP'                           08700000
087100                              TO RC098-ERROR-PARA-NAME            08710000
087200             SET RC098-DB-ERROR                                   08720000
087300                 PS-ERROR-YES    TO TRUE                          08730000
087400             DISPLAY '******************************************' 08740000
087500             DISPLAY '*ABEND                                   *' 08750000
087600             DISPLAY '*PROGRAM   = RCKUP998                    *' 08760000
087700             DISPLAY '*DB2 OPER  = SELECT TPKSLIP              *' 08770000
087800             DISPLAY '*PARAGRAPH = 2170-SELECT-TPKSLIP         *' 08780000
087900             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                08790000
088000             DISPLAY '*PO = ' PV-DISP-PO                          08800000
088100             DISPLAY '*SEQ = ' PV-DISP-SEQ                        08810000
088200             DISPLAY '******************************************' 08820000
088300     END-EVALUATE.                                                08830000
088400                                                                  08840000
088500 2180-UPDATE-TPKSLIP.                                             08850000
088600     EXEC SQL                                                     08860000
088700          UPDATE TPKSLIP                                          08870000
088800             SET EXPTED_PKG_QTY = :PKSLIP-EXPTED-PKG-QTY          08880000
088900           WHERE PO_NBR         = :DK-PO-NBR                      08890000
089000             AND SEQ_NBR        = :PV-SAVE-PKSLIP-SEQ-NBR         08900000
089100             AND VER_STAT_CDE   = 'A'                             08910000
089200     END-EXEC                                                     08920000
089300                                                                  08930000
089400     EVALUATE TRUE                                                08940000
089500         WHEN SQLCODE = +0                                        08950000
089600             MOVE +1       TO PT-TOTAL-TPKSLIP-UPDATES            08960000
089700         WHEN SQLWARN0 NOT = SPACES                               08970000
089800         WHEN SQLCODE < +0                                        08980000
089900         WHEN SQLCODE > +0                                        08990000
090000             MOVE DK-PO-NBR       TO PV-DISP-PO                   09000000
090100             MOVE PV-SAVE-PKSLIP-SEQ-NBR                          09010000
090200                                  TO PV-DISP-SEQ                  09020000
090300             MOVE SQLCODE     TO PV-DISP-SQLCODE                  09030000
090400             MOVE '2180-UPDATE-TPKSLIP'                           09040000
090500                              TO RC098-ERROR-PARA-NAME            09050000
090600             SET RC098-PO-NOF                                     09060000
090700                 PS-ERROR-YES    TO TRUE                          09070000
090800             DISPLAY '******************************************' 09080000
090900             DISPLAY '*ABEND                                   *' 09090000
091000             DISPLAY '*PROGRAM   = RCKUP998                    *' 09100000
091100             DISPLAY '*DB2 OPER  = UPDATE TPKSLIP              *' 09110000
091200             DISPLAY '*PARAGRAPH = 2180-UPDATE-TPKSLIP         *' 09120000
091300             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                09130000
091400             DISPLAY '*PO = ' PV-DISP-PO                          09140000
091500             DISPLAY '*SEQ = ' PV-DISP-SEQ                        09150000
091600             DISPLAY '******************************************' 09160000
091700     END-EVALUATE.                                                09170000
091800*----------------------------------------------------------------*09180000
091900*    INSERT A PACK SLIP ITEM ROW                                 *09190000
092000*----------------------------------------------------------------*09200000
092100                                                                  09210000
092200                                                                  09220000
092300 2200-ADD-TPKITEM.                                                09230000
092400                                                                  09240000
092500     PERFORM 2210-SETUP-TPKITEM-FIELDS.                           09250000
092600     PERFORM 2230-INSERT-TPKITEM.                                 09260000
092700                                                                  09270000
092800 2210-SETUP-TPKITEM-FIELDS.                                       09280000
092900                                                                  09290000
093000     MOVE PV-HOLD-PO-NBR         TO PKITEM-PO-NBR.                09300000
093100     MOVE PV-HOLD-SEQ-NBR        TO PKITEM-SEQ-NBR.               09310000
093200     MOVE PA-TO-VERIFY-QTY       TO PKITEM-PKSL-ITM-QTY.          09320000
093300     MOVE PV-HOLD-CRE-UID        TO PKITEM-CRE-UID.               09330000
093400     MOVE PA-TO-VERIFY-QTY       TO PKITEM-ORIG-PKSL-ITM-QTY.     09340000
093500     MOVE PV-HOLD-PO-NBR         TO DK-HOLD-PO-NBR.               09350000
093600     MOVE PV-HOLD-PO-LNE-NBR     TO DK-HOLD-LNE-NBR.              09360000
093700     PERFORM 2220-SELECT-LINE.                                    09370000
093800     MOVE PURITM-VER-NBR         TO PKITEM-PURITM-VER-NBR.        09380000
093900     MOVE PURITM-APP-PO-LNE-NBR  TO PKITEM-PKSL-LNE-NBR.          09390000
094000                                                                  09400000
094100                                                                  09410000
094200 2220-SELECT-LINE.                                                09420000
094300     EXEC SQL                                                     09430000
094400        SELECT  A.APP_PO_LNE_NBR                                  09440000
094500           ,    A.VER_NBR                                         09450000
094600           ,    A.ITM_NBR                                         09460000
094700           ,    A.PIC_ITM_IND                                     09470000
094800           ,    A.PO_LNE_NBR                                      09480000
094900           ,    A.VEND_STYL_NAME                                  09490000
095000           ,    A.SKU_SEQ_NBR                                     09500000
095100           ,    A.UNT_RTL_PR_AMT                                  09510000
095200           ,    A.UNT_COST_AMT                                    09520000
095300           ,    A.GP_RTL_AMT                                      09530000
095400           ,    A.GP_QTY                                          09540000
095500          INTO :PURITM-APP-PO-LNE-NBR                             09550000
095600           ,    :PURITM-VER-NBR                                   09560000
095700           ,    :PURITM-ITM-NBR                                   09570000
095800           ,    :PURITM-PIC-ITM-IND                               09580000
095900           ,    :PURITM-PO-LNE-NBR                                09590000
096000           ,    :PURITM-VEND-STYL-NAME                            09600000
096100           ,    :PURITM-SKU-SEQ-NBR                               09610000
096200           ,    :PURITM-UNT-RTL-PR-AMT                            09620000
096300           ,    :PURITM-UNT-COST-AMT                              09630000
096400           ,    :PURITM-GP-RTL-AMT                                09640000
096500           ,    :PURITM-GP-QTY                                    09650000
096600          FROM TPURITM A                                          09660000
096700          WHERE A.PO_NBR          = :DK-HOLD-PO-NBR               09670000
096800            AND A.VER_STATUS_CDE  = 'A'                           09680000
096900            AND A.PO_LNE_NBR      = :DK-HOLD-LNE-NBR              09690000
097000     END-EXEC.                                                    09700000
097100                                                                  09710000
097200     EVALUATE TRUE                                                09720000
097300         WHEN SQLCODE = +0                                        09730000
097400         WHEN SQLCODE = -811                                      09740000
097500              CONTINUE                                            09750000
097600         WHEN SQLCODE = +100                                      09760000
097700             MOVE DK-PO-NBR   TO PV-DISP-PO                       09770000
097800             MOVE DK-LNE-NBR  TO PV-DISP-LINE-NBR                 09780000
097900             MOVE SQLCODE     TO PV-DISP-SQLCODE                  09790000
098000             MOVE '2220-SELECT-LINE'                              09800000
098100                              TO RC098-ERROR-PARA-NAME            09810000
098200             SET RC098-ITEM-NOT-ON-PO                             09820000
098300                 PS-ERROR-YES    TO TRUE                          09830000
098400             DISPLAY '******************************************' 09840000
098500             DISPLAY '*ABEND                                   *' 09850000
098600             DISPLAY '*PROGRAM   = RCKUP998                    *' 09860000
098700             DISPLAY '*DB2 OPER  = SELECT ON TPURITM           *' 09870000
098800             DISPLAY '*PARAGRAPH = 2220-SELECT-LINE            *' 09880000
098900             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                09890000
099000             DISPLAY '*PO = ' PV-DISP-PO                          09900000
099100             DISPLAY '*LINE = ' PV-DISP-LINE-NBR                  09910000
099200             DISPLAY '******************************************' 09920000
099300         WHEN SQLWARN0 NOT = SPACES                               09930000
099400         WHEN SQLCODE < +0                                        09940000
099500         WHEN SQLCODE > +0                                        09950000
099600             MOVE DK-PO-NBR   TO PV-DISP-PO                       09960000
099700             MOVE DK-LNE-NBR  TO PV-DISP-LINE-NBR                 09970000
099800             MOVE SQLCODE     TO PV-DISP-SQLCODE                  09980000
099900             MOVE '2220-SELECT-LINE'                              09990000
100000                              TO RC098-ERROR-PARA-NAME            10000000
100100             SET RC098-DB-ERROR                                   10010000
100200                 PS-ERROR-YES    TO TRUE                          10020000
100300             DISPLAY '******************************************' 10030000
100400             DISPLAY '*ABEND                                   *' 10040000
100500             DISPLAY '*PROGRAM   = RCKUP998                    *' 10050000
100600             DISPLAY '*DB2 OPER  = SELECT ON TPURITM           *' 10060000
100700             DISPLAY '*PARAGRAPH = 2220-SELECT-LINE            *' 10070000
100800             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                10080000
100900             DISPLAY '*PO = ' PV-DISP-PO                          10090000
101000             DISPLAY '*LINE = ' PV-DISP-LINE-NBR                  10100000
101100             DISPLAY '******************************************' 10110000
101200     END-EVALUATE.                                                10120000
101300                                                                  10130000
101400 2230-INSERT-TPKITEM.                                             10140000
101500     EXEC SQL                                                     10150000
101600          INSERT INTO TPKITEM                                     10160000
101700                 (PO_NBR                                          10170000
101800              ,   SEQ_NBR                                         10180000
101900              ,   PKSL_LNE_NBR                                    10190000
102000              ,   CRE_TMST                                        10200000
102100              ,   VER_STAT_CDE                                    10210000
102200              ,   PKSL_ITM_QTY                                    10220000
102300              ,   CRE_UID                                         10230000
102400              ,   PURITM_VER_NBR                                  10240000
102500              ,   ORIG_PKSL_ITM_QTY)                              10250000
102600          VALUES (:PKITEM-PO-NBR                                  10260000
102700              ,   :PKITEM-SEQ-NBR                                 10270000
102800              ,   :PKITEM-PKSL-LNE-NBR                            10280000
102900              ,    CURRENT_TIMESTAMP                              10290000
103000              ,    'A'                                            10300000
103100              ,   :PKITEM-PKSL-ITM-QTY                            10310000
103200              ,   :PC-DWNLDPRG                                    10320002
103300              ,   :PKITEM-PURITM-VER-NBR                          10330000
103400              ,   0)                                              10340000
103500     END-EXEC.                                                    10350000
103600                                                                  10360000
103700     EVALUATE TRUE                                                10370000
103800         WHEN SQLCODE = +0                                        10380000
103900*             MOVE +1       TO PT-TOTAL-TPKITEM-INSERTS           10390000
104000              ADD  +1       TO PA-TOTAL-TPKITEM-INSERTS           10400000
104100         WHEN SQLWARN0 NOT = SPACES                               10410000
104200         WHEN SQLCODE < +0                                        10420000
104300         WHEN SQLCODE > +0                                        10430000
104400             MOVE PKITEM-PO-NBR  TO PV-DISP-PO                    10440000
104500             MOVE PKITEM-SEQ-NBR TO PV-DISP-SEQ                   10450000
104600             MOVE SQLCODE     TO PV-DISP-SQLCODE                  10460000
104700             MOVE '2230-INSERT-TPKITEM'                           10470000
104800                              TO RC098-ERROR-PARA-NAME            10480000
104900             SET RC098-DB-ERROR                                   10490000
105000                 PS-ERROR-YES    TO TRUE                          10500000
105100             DISPLAY '******************************************' 10510000
105200             DISPLAY '*ABEND                                   *' 10520000
105300             DISPLAY '*PROGRAM   = RCKUP998                    *' 10530000
105400             DISPLAY '*DB2 OPER  = INSERT ON TPKITEM           *' 10540000
105500             DISPLAY '*PARAGRAPH = 2230-INSERT-TPKITEM         *' 10550000
105600             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                10560000
105700             DISPLAY '*PO = ' PV-DISP-PO                          10570000
105800             DISPLAY '*SEQ = ' PV-DISP-SEQ                        10580000
105900             DISPLAY '******************************************' 10590000
106000     END-EVALUATE.                                                10600000
106100                                                                  10610000
106200/                                                                 10620000
106300*---------------------------------------------------------------* 10630000
106400* CHECK TO SEE IF THE DC SHOULD FLUSH THEIR BUILDING.             10640000
106500*---------------------------------------------------------------* 10650000
106600 2250-CHECK-DC-FLUSH-PARM.                                        10660000
106700                                                                  10670000
106800     EXEC SQL                                                     10680000
106900          SELECT  FUNC_TXT                                        10690000
107000          INTO   :KRPRPM-FUNC-TXT                                 10700000
107100          FROM  TKRPRPM                                           10710000
107200          WHERE LOC_ID            =  90                           10720000
107300            AND SYS_PRC_FUNC_CDE  =  'FLUSH'                      10730000
107400            AND FUNC_PRC_STAT_CDE =  'AC'                         10740000
107500     END-EXEC.                                                    10750000
107600                                                                  10760000
107700     EVALUATE TRUE                                                10770000
107800         WHEN SQLCODE = +0                                        10780000
107900            IF KRPRPM-FUNC-TXT = 'N'                              10790000
108000                SET PS-DC-FLUSH-NO  TO TRUE                       10800000
108100            ELSE                                                  10810000
108200                SET PS-DC-FLUSH-YES TO TRUE                       10820000
108300            END-IF                                                10830000
108400         WHEN OTHER                                               10840000
108500                SET PS-DC-FLUSH-NO  TO TRUE                       10850000
108600     END-EVALUATE.                                                10860000
108700                                                                  10870000
108800*---------------------------------------------------------------* 10880000
108900* CHECK TO SEE IF STORE IS IN INVENTORY CYCLE                     10890000
109000*---------------------------------------------------------------* 10900000
109100 2275-CHECK-INV-IN-PROCESS.                                       10910000
109200                                                                  10920000
109300     EXEC SQL                                                     10930000
109400          SELECT                                                  10940000
109500                 A.DC_CTOFF_DTE                                   10950000
109600             ,   (A.DC_CTOFF_DTE + 7 DAYS)                        10960000
109700          INTO                                                    10970000
109800                 :XLT00025-DC-CTOFF-DTE                           10980000
109900             ,   :PV-WORK-DATE-PLUS-7                             10990000
110000          FROM                                                    11000000
110100                XLT_MDSE_INV_PARM A                               11010000
110200          WHERE A.LOC_NBR           =  :RECDIS-STR-NBR            11020000
110300           AND  A.DC_CTOFF_DTE >= (CURRENT_DATE - 7 DAYS)         11030000
110400           AND  A.DC_CTOFF_DTE <= (CURRENT_DATE + 7 DAYS)         11040000
110500           AND  A.ACTV_IND         = 'Y'                          11050000
110600           AND  A.LOC_INV_STAT_CDE = 'IN'                         11060000
110700     END-EXEC.                                                    11070000
110800                                                                  11080000
110900     EVALUATE TRUE                                                11090000
111000         WHEN SQLCODE = +0                                        11100000
111100            SET RC098-STORE-INV-CYCLE                             11110000
111200                PS-ERROR-YES    TO TRUE                           11120000
111300         WHEN SQLCODE = +100                                      11130000
111400             CONTINUE                                             11140000
111500         WHEN SQLWARN0 NOT = SPACES                               11150000
111600         WHEN SQLCODE < +0                                        11160000
111700         WHEN SQLCODE > +0                                        11170000
111800             MOVE RECDIS-STR-NBR  TO PV-DISP-STR-NBR              11180000
111900             MOVE SQLCODE     TO PV-DISP-SQLCODE                  11190000
112000             MOVE '2275-CHECK-INV-IN-PROCESS'                     11200000
112100                              TO RC098-ERROR-PARA-NAME            11210000
112200             SET RC098-DB-ERROR                                   11220000
112300                 PS-ERROR-YES    TO TRUE                          11230000
112400             DISPLAY '******************************************' 11240000
112500             DISPLAY '*ABEND                                   *' 11250000
112600             DISPLAY '*PROGRAM   = RCKUP998                    *' 11260000
112700             DISPLAY '*DB2 OPER  = SELECT ON XLT_MDSE_INV_PARM *' 11270000
112800             DISPLAY '*PARAGRAPH = 2275-CHECK-INV-IN-PROCESS   *' 11280000
112900             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                11290000
113000             DISPLAY '*STORE = ' PV-DISP-STR-NBR                  11300000
113100             DISPLAY '******************************************' 11310000
113200     END-EVALUATE.                                                11320000
113300                                                                  11330000
113400                                                                  11340000
113500*---------------------------------------------------------------* 11350000
113600* CREATE VERIFIED 'CR' RECEIVER                                   11360000
113700*---------------------------------------------------------------* 11370000
113800 2300-BUILD-RECEIVER-INFO.                                        11380000
113900                                                                  11390000
114000     INITIALIZE DCLTRECEIV.                                       11400000
114100                                                                  11410000
114200     PERFORM 2310-DETERMINE-INDICATORS.                           11420000
114300                                                                  11430000
114400     MOVE RC098-PO-NBR           TO RECEIV-ORD-NBR.               11440000
114500     MOVE PV-REC-SEQ-NBR         TO RECEIV-REC-SEQ-NBR            11450000
114600                                    RECEIV-REFER-BACK-SEQ-NBR.    11460000
114700     MOVE PURCHS-VER-NBR         TO RECEIV-PO-VER-NBR.            11470000
114800                                                                  11480000
114900     MOVE RC098-OPER-UNIT        TO RECEIV-OPER-UNT-ID.           11490000
115000     MOVE 1                      TO RECEIV-FCLTY-ID.              11500000
115100     MOVE 'VE'                   TO RECEIV-STATUS-CDE.            11510000
115200     MOVE 'P'                    TO RECEIV-SYST-CRE-CDE.          11520000
115300     MOVE RC098-REC-TYP-CDE      TO RECEIV-REC-TYP-CDE.           11530000
115400     MOVE 'A'                    TO RECEIV-VER-STATUS-CDE.        11540000
115500     MOVE 1                      TO RECEIV-EXPTED-CART-CNT.       11550000
115600     MOVE 1                      TO RECEIV-ACTL-CART-CNT.         11560000
115700     MOVE RC098-TO-VERIFY-QTY    TO RECEIV-EXPTED-ITM-QTY         11570000
115800                                    RECEIV-ACTL-ITM-QTY.          11580000
115900     MOVE '9999-09-09-09.09.09.999999'                            11590000
116000                                 TO RECEIV-ML-POST-TMST           11600000
116100                                    RECEIV-FS-POST-TMST           11610000
116200                                    RECEIV-IN-TRBL-TMST           11620000
116300                                    RECEIV-MKNG-APRN-PRT-TMST.    11630000
116400     MOVE RC098-OPER-UNIT         TO RECEIV-CURR-OPER-UNT-ID.     11640000
116500                                                                  11650000
116600     MOVE RC098-OPER-UNIT         TO RECEIV-CRE-OPER-UNT-ID.      11660000
116700     MOVE PC-DWNLDPRG             TO RECEIV-CRE-UID.              11670002
116800                                                                  11680000
116900     MOVE 1                       TO RECEIV-CURR-FCLTY-ID.        11690000
117000     MOVE 1                       TO RECEIV-CRE-FCLTY-ID.         11700000
117100     MOVE PC-CURRENT-PROGRAM-NAME TO RECEIV-UPD-PGM-ID.           11710000
117200     MOVE PC-DWNLDPRG             TO RECEIV-UPD-UID               11720002
117300                                     RECEIV-VRFD-USR-ID.          11730000
117400                                                                  11740000
117700     MOVE 'N'                    TO RECEIV-FRE-ASTRA-IND.         11770000
117800                                                                  11780000
117900     PERFORM VARYING PV-COUNT FROM 1 BY 1 UNTIL                   11790000
118000          PV-COUNT > 10                                           11800000
118100         PERFORM 3000-OPEN-TRECVER-CSR                            11810000
118200         PERFORM 3020-FETCH-TRECVER-CSR                           11820000
118300                                                                  11830000
118400         MOVE RECVER-MAX-RCVR-NBR  TO PW-CONTROL-PANL-NBR-9       11840000
118500         DIVIDE PW-CONTROL-PANL-NBR-9 BY 9 GIVING PW-QUOTIENT     11850000
118600                                       REMAINDER  PW-REMAINDER    11860000
118700         COMPUTE PW-CONTROL-CEHCK-DIG = ( 9 - PW-REMAINDER )      11870000
118800         COMPUTE RECEIV-RCVR-NBR = PW-CONTROL-KEYREC-9 * 1        11880000
118900         ADD +1                    TO RECVER-MAX-RCVR-NBR         11890000
119000         PERFORM 3040-DELETE-TRECVER-CSR                          11900000
119100         PERFORM 3060-INSERT-TRECVER                              11910000
119200         PERFORM 3080-CLOSE-TRECVER-CSR                           11920000
119300     END-PERFORM.                                                 11930000
119400                                                                  11940000
119500     PERFORM 2340-INSERT-TRECEIV.                                 11950000
119600                                                                  11960000
119700                                                                  11970000
119800 2310-DETERMINE-INDICATORS.                                       11980000
119900                                                                  11990000
120000* SET PRE TICKET INDICATOR                                        12000000
120100     MOVE 4                      TO DK-AGRMT-TYP-ID.              12010000
120200     MOVE 1                      TO DK-TYP-CDE.                   12020000
120300                                                                  12030000
120400     PERFORM 2320-CHECK-PO-SERVICE-INFO.                          12040000
120500                                                                  12050000
120600     IF  PV-DB2-COUNT > +0                                        12060000
120700         MOVE 'Y'                TO RECEIV-PRE-TKT-IND            12070000
120800     ELSE                                                         12080000
120900         MOVE 'N'                TO RECEIV-PRE-TKT-IND            12090000
121000     END-IF.                                                      12100000
121100                                                                  12110000
121200                                                                  12120000
121300* SET GARMENT ON HANGER (GOH) INDICATOR                           12130000
121400     MOVE 4                      TO DK-AGRMT-TYP-ID.              12140000
121500     MOVE 2                      TO DK-TYP-CDE.                   12150000
121600                                                                  12160000
121700     PERFORM 2320-CHECK-PO-SERVICE-INFO.                          12170000
121800                                                                  12180000
121900     IF  PV-DB2-COUNT > +0                                        12190000
122000         MOVE 'Y'                TO RECEIV-GOH-IND                12200000
122100     ELSE                                                         12210000
122200         MOVE 'N'                TO RECEIV-GOH-IND                12220000
122300     END-IF.                                                      12230000
122400                                                                  12240000
122500* SET PACK BY STORE INDICATOR AND PACKAGING CODE                  12250000
122600     MOVE RC098-PKGNG-CDE        TO RECEIV-PKGNG-CDE              12260000
122700     IF RC098-PKGNG-CDE = SPACE                                   12270000
122800         MOVE 'Y'                TO RECEIV-PACK-BY-ST-IND         12280000
122900     ELSE                                                         12290000
123000         MOVE 'N'                TO RECEIV-PACK-BY-ST-IND         12300000
123100     END-IF.                                                      12310000
123200                                                                  12320000
123300*    MOVE 4                      TO DK-AGRMT-TYP-ID.              12330000
123400*    MOVE 4                      TO DK-TYP-CDE.                   12340000
123500                                                                  12350000
123600*    PERFORM 2320-CHECK-PO-SERVICE-INFO.                          12360000
123700                                                                  12370000
123800*    IF  PV-DB2-COUNT > +0                                        12380000
123900*        MOVE 'Y'                TO RECEIV-PACK-BY-ST-IND         12390000
124000*    ELSE                                                         12400000
124100*        MOVE 'N'                TO RECEIV-PACK-BY-ST-IND         12410000
124200*    END-IF.                                                      12420000
124300                                                                  12430000
124400*    IF RECEIV-PACK-BY-ST-IND NOT = 'Y'                           12440000
124500*        PERFORM 2330-PKGNG-CDE-FROM-PO                           12450000
124600*    ELSE                                                         12460000
124700*        MOVE SPACES                   TO RECEIV-PKGNG-CDE        12470000
124800*    END-IF.                                                      12480000
124900                                                                  12490000
125000 2320-CHECK-PO-SERVICE-INFO.                                      12500000
125100                                                                  12510000
125200     MOVE 0        TO PV-DB2-COUNT.                               12520000
125300                                                                  12530000
125400     EXEC SQL                                                     12540000
125500          SELECT COUNT(*)                                         12550000
125600            INTO :PV-DB2-COUNT                                    12560000
125700            FROM TPOAGMT                                          12570000
125800           WHERE PO_NBR         = :DK-PO-NBR                      12580000
125900             AND AGRMT_TYP_ID   = :DK-AGRMT-TYP-ID                12590000
126000             AND VER_STATUS_CDE = 'A'                             12600000
126100             AND TYP_CDE        = :DK-TYP-CDE                     12610000
126200     END-EXEC.                                                    12620000
126300                                                                  12630000
126400     EVALUATE TRUE                                                12640000
126500         WHEN SQLCODE = +0                                        12650000
126600         WHEN SQLCODE = +100                                      12660000
126700              CONTINUE                                            12670000
126800                                                                  12680000
126900         WHEN SQLWARN0 NOT = SPACES                               12690000
127000         WHEN SQLCODE < +0                                        12700000
127100         WHEN SQLCODE > +0                                        12710000
127200             MOVE DK-PO-NBR   TO PV-DISP-PO                       12720000
127300             MOVE DK-TYP-CDE  TO PV-DISP-TYP-CDE                  12730000
127400             MOVE SQLCODE     TO PV-DISP-SQLCODE                  12740000
127500             MOVE '2320-CHECK-PO-SERVICE-INFO'                    12750000
127600                              TO RC098-ERROR-PARA-NAME            12760000
127700             SET RC098-DB-ERROR                                   12770000
127800                 PS-ERROR-YES    TO TRUE                          12780000
127900             DISPLAY '******************************************' 12790000
128000             DISPLAY '*ABEND                                   *' 12800000
128100             DISPLAY '*PROGRAM   = RCKUP998                    *' 12810000
128200             DISPLAY '*DB2 OPER  = SELECT ON TPOAGMT           *' 12820000
128300             DISPLAY '*PARAGRAPH = 2320-CHECK-PO-SERVICE-INFO  *' 12830000
128400             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                12840000
128500             DISPLAY '*PO = ' PV-DISP-PO                          12850000
128600             DISPLAY '*TYPE = ' PV-DISP-TYP-CDE                   12860000
128700             DISPLAY '*AGRMT TYP ID = ' DK-AGRMT-TYP-ID           12870000
128800             DISPLAY '******************************************' 12880000
128900     END-EVALUATE.                                                12890000
129000                                                                  12900000
129100                                                                  12910000
129200 2340-INSERT-TRECEIV.                                             12920000
129300                                                                  12930000
129400     EXEC SQL                                                     12940000
129500          INSERT INTO TRECEIV                                     12950000
129600                 ( ORD_NBR                                        12960000
129700                ,  REC_SEQ_NBR                                    12970000
129800                ,  CRE_TMST                                       12980000
129900                ,  CRE_UID                                        12990000
130000                ,  PO_VER_NBR                                     13000000
130100                ,  OPER_UNT_ID                                    13010000
130200                ,  FCLTY_ID                                       13020000
130300                ,  STATUS_CDE                                     13030000
130400                ,  SYST_CRE_CDE                                   13040000
130500                ,  REC_TYP_CDE                                    13050000
130600                ,  VER_STATUS_CDE                                 13060000
130700                ,  PACK_BY_ST_IND                                 13070000
130800                ,  REC_TMST                                       13080000
130900                ,  EXPTED_CART_CNT                                13090000
131000                ,  ACTL_CART_CNT                                  13100000
131100                ,  EXPTED_ITM_QTY                                 13110000
131200                ,  ACTL_ITM_QTY                                   13120000
131300                ,  RCVR_NBR                                       13130000
131400                ,  ML_POST_TMST                                   13140000
131500                ,  FS_POST_TMST                                   13150000
131600                ,  PRE_TKT_IND                                    13160000
131700                ,  AD_INFO_DESC                                   13170000
131800                ,  IN_TRBL_TMST                                   13180000
131900                ,  IN_TRBL_MIN_CNT                                13190000
132000                ,  IN_TRBL_HOUR_CNT                               13200000
132100                ,  VERFYD_TMST                                    13210000
132200                ,  RCVG_CLERK_INIT_ID                             13220000
132300                ,  REFER_BACK_SEQ_NBR                             13230000
132400                ,  AP_PRC_CDE                                     13240000
132500                ,  AP_PRC_DTE                                     13250000
132600                ,  MIS_DIRECT_IND                                 13260000
132700                ,  IMPRT_IND                                      13270000
132800                ,  CRE_OPER_UNT_ID                                13280000
132900                ,  CRE_FCLTY_ID                                   13290000
133000                ,  CURR_OPER_UNT_ID                               13300000
133100                ,  CURR_FCLTY_ID                                  13310000
133200                ,  UPD_TMST                                       13320000
133300                ,  UPD_UID                                        13330000
133400                ,  UPD_PGM_ID                                     13340000
133500                ,  MKNG_APRN_PRT_TMST                             13350000
133600                ,  GOH_IND                                        13360000
133700                ,  VRFD_USR_ID                                    13370000
133800                ,  AP_RVRSL_DTE                                   13380000
133900                ,  PKGNG_CDE                                      13390000
134000                ,  FRE_ASTRA_IND                                  13400000
134100                  )                                               13410000
134200         VALUES ( :RECEIV-ORD-NBR                                 13420000
134300                , :RECEIV-REC-SEQ-NBR                             13430000
134400                , CURRENT_TIMESTAMP                               13440000
134500                , :PC-DWNLDPRG                                    13450002
134600                , :RECEIV-PO-VER-NBR                              13460000
134700                , :RECEIV-OPER-UNT-ID                             13470000
134800                , :RECEIV-FCLTY-ID                                13480000
134900                , :RECEIV-STATUS-CDE                              13490000
135000                , :RECEIV-SYST-CRE-CDE                            13500000
135100                , :RECEIV-REC-TYP-CDE                             13510000
135200                , :RECEIV-VER-STATUS-CDE                          13520000
135300                , :RECEIV-PACK-BY-ST-IND                          13530000
135400*               , :RECEIV-REC-TMST                                13540000
135500                , CURRENT_TIMESTAMP                               13550000
135600                , :RECEIV-EXPTED-CART-CNT                         13560000
135700                , :RECEIV-ACTL-CART-CNT                           13570000
135800                , :RECEIV-EXPTED-ITM-QTY                          13580000
135900                , :RECEIV-ACTL-ITM-QTY                            13590000
136000                , :RECEIV-RCVR-NBR                                13600000
136100                , :RECEIV-ML-POST-TMST                            13610000
136200                , :RECEIV-FS-POST-TMST                            13620000
136300                , :RECEIV-PRE-TKT-IND                             13630000
136400                , :RECEIV-AD-INFO-DESC                            13640000
136500                , :RECEIV-IN-TRBL-TMST                            13650000
136600                , :RECEIV-IN-TRBL-MIN-CNT                         13660000
136700                , :RECEIV-IN-TRBL-HOUR-CNT                        13670000
136800                , CURRENT_TIMESTAMP                               13680000
136900                , 'PRG'                                           13690003
137000                , :RECEIV-REFER-BACK-SEQ-NBR                      13700000
137100                , :RECEIV-AP-PRC-CDE                              13710000
137200                , '9999-09-09'                                    13720000
137300                , :RECEIV-MIS-DIRECT-IND                          13730000
137400                , :RECEIV-IMPRT-IND                               13740000
137500                , :RECEIV-CRE-OPER-UNT-ID                         13750000
137600                , :RECEIV-CRE-FCLTY-ID                            13760000
137700                , :RECEIV-CURR-OPER-UNT-ID                        13770000
137800                , :RECEIV-CURR-FCLTY-ID                           13780000
137900                , CURRENT_TIMESTAMP                               13790000
138000                , :PC-DWNLDPRG                                    13800002
138100                , :RECEIV-UPD-PGM-ID                              13810000
138200                , :RECEIV-MKNG-APRN-PRT-TMST                      13820000
138300                , :RECEIV-GOH-IND                                 13830000
138400                , :PC-DWNLDPRG                                    13840002
138500                , '9999-09-09'                                    13850000
138600                , :RECEIV-PKGNG-CDE                               13860000
138700                , :RECEIV-FRE-ASTRA-IND                           13870000
138800                 )                                                13880000
138900     END-EXEC.                                                    13890000
139000                                                                  13900000
139100     EVALUATE TRUE                                                13910000
139200         WHEN SQLCODE = +0                                        13920000
139300              MOVE +1       TO PT-TOTAL-TRECEIV-INSERTS           13930000
139400              MOVE RECEIV-ORD-NBR     TO PV-DISP-PO               13940000
139500              MOVE RECEIV-REC-SEQ-NBR TO PV-DISP-REC-SEQ          13950000
139600              DISPLAY ' PO / RECEIVER '                           13960000
139700                      PV-DISP-PO ' ' PV-DISP-REC-SEQ              13970000
139800              MOVE PV-DISP-PO         TO PV-BKUP-PO-NBR-2         13980000
139900              MOVE PV-DISP-REC-SEQ    TO PV-BKUP-REC-SEQ-2        13990000
140000              WRITE BKUP-RECORD FROM PV-BKUP-RECORD-2             14000000
140100         WHEN SQLWARN0 NOT = SPACE                                14010000
140200         WHEN SQLCODE < +0                                        14020000
140300         WHEN SQLCODE > +0                                        14030000
140400             MOVE RECEIV-ORD-NBR  TO PV-DISP-PO                   14040000
140500             MOVE RECEIV-REC-SEQ-NBR TO PV-DISP-REC-SEQ           14050000
140600             MOVE SQLCODE TO PV-DISP-SQLCODE                      14060000
140700             MOVE '2340-INSERT-TRECEIV'                           14070000
140800                              TO RC098-ERROR-PARA-NAME            14080000
140900             SET RC098-DB-ERROR                                   14090000
141000                 PS-ERROR-YES    TO TRUE                          14100000
141100             DISPLAY '******************************************' 14110000
141200             DISPLAY '*ABEND                                   *' 14120000
141300             DISPLAY '*PROGRAM   = RCKUP998                    *' 14130000
141400             DISPLAY '*DB2 OPER  = INSERT ON TRECEIV           *' 14140000
141500             DISPLAY '*PARAGRAPH = 2340-INSERT-TRECEIV         *' 14150000
141600             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                14160000
141700             DISPLAY '*PO = ' PV-DISP-PO                          14170000
141800             DISPLAY '*RECEIVER = ' PV-DISP-REC-SEQ               14180000
141900             DISPLAY '******************************************' 14190000
142000                                                                  14200000
142100     END-EVALUATE.                                                14210000
142200                                                                  14220000
142300 2350-UPDATE-RECEIVER-INFO.                                       14230000
142400     PERFORM 2360-SELECT-TRECEIV.                                 14240000
142500     COMPUTE RECEIV-EXPTED-ITM-QTY = RECEIV-EXPTED-ITM-QTY +      14250000
142600                RC098-TO-VERIFY-QTY.                              14260000
142700     COMPUTE RECEIV-ACTL-ITM-QTY = RECEIV-ACTL-ITM-QTY +          14270000
142800                RC098-TO-VERIFY-QTY.                              14280000
142900     PERFORM 2370-UPDATE-TRECEIV.                                 14290000
143000                                                                  14300000
143100 2360-SELECT-TRECEIV.                                             14310000
143200     EXEC SQL                                                     14320000
143300          SELECT EXPTED_ITM_QTY                                   14330000
143400                ,ACTL_ITM_QTY                                     14340000
143500            INTO :RECEIV-EXPTED-ITM-QTY                           14350000
143600                ,:RECEIV-ACTL-ITM-QTY                             14360000
143700            FROM TRECEIV                                          14370000
143800           WHERE ORD_NBR     = :DK-PO-NBR                         14380000
143900             AND REC_SEQ_NBR = :PV-REC-SEQ-NBR                    14390000
144000             AND VER_STATUS_CDE = 'A'                             14400000
144100     END-EXEC.                                                    14410000
144200                                                                  14420000
144300     EVALUATE TRUE                                                14430000
144400         WHEN SQLCODE = ZERO                                      14440000
144500              CONTINUE                                            14450000
144600                                                                  14460000
144700         WHEN SQLWARN0 NOT = SPACES                               14470000
144800         WHEN SQLCODE  NOT = ZERO                                 14480000
144900             MOVE DK-PO-NBR         TO PV-DISP-PO                 14490000
145000             MOVE PV-REC-SEQ-NBR     TO PV-DISP-REC-SEQ           14500000
145100             MOVE SQLCODE TO PV-DISP-SQLCODE                      14510000
145200             MOVE '2360-SELECT-TRECEIV'                           14520000
145300                              TO RC098-ERROR-PARA-NAME            14530000
145400             SET RC098-DB-ERROR                                   14540000
145500                 PS-ERROR-YES    TO TRUE                          14550000
145600             DISPLAY '******************************************' 14560000
145700             DISPLAY '*ABEND                                   *' 14570000
145800             DISPLAY '*PROGRAM   = RCKUP998                    *' 14580000
145900             DISPLAY '*DB2 OPER  = SELECT TRECEIV              *' 14590000
146000             DISPLAY '*PARAGRAPH = 2360-SELECT-TRECEIV         *' 14600000
146100             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                14610000
146200             DISPLAY '*PO = ' PV-DISP-PO                          14620000
146300             DISPLAY '*RECEIVER = ' PV-DISP-REC-SEQ               14630000
146400             DISPLAY '******************************************' 14640000
146500     END-EVALUATE.                                                14650000
146600                                                                  14660000
146700 2370-UPDATE-TRECEIV.                                             14670000
146800     EXEC SQL                                                     14680000
146900       UPDATE TRECEIV                                             14690000
147000          SET   EXPTED_ITM_QTY     = :RECEIV-EXPTED-ITM-QTY       14700000
147100              , ACTL_ITM_QTY       = :RECEIV-ACTL-ITM-QTY         14710000
147200           WHERE ORD_NBR        = :DK-PO-NBR                      14720000
147300             AND REC_SEQ_NBR    = :PV-REC-SEQ-NBR                 14730000
147400             AND VER_STATUS_CDE = 'A'                             14740000
147500     END-EXEC.                                                    14750000
147600                                                                  14760000
147700     EVALUATE TRUE                                                14770000
147800         WHEN SQLCODE = ZERO                                      14780000
147900              MOVE +1       TO PT-TOTAL-TRECEIV-UPDATES           14790000
148000                                                                  14800000
148100         WHEN SQLWARN0 NOT = SPACES                               14810000
148200         WHEN SQLCODE  NOT = ZERO                                 14820000
148300             MOVE DK-PO-NBR         TO PV-DISP-PO                 14830000
148400             MOVE PV-REC-SEQ-NBR     TO PV-DISP-REC-SEQ           14840000
148500             MOVE SQLCODE TO PV-DISP-SQLCODE                      14850000
148600             MOVE '2370-UPDATE-TRECEIV'                           14860000
148700                              TO RC098-ERROR-PARA-NAME            14870000
148800             SET RC098-DB-ERROR                                   14880000
148900                 PS-ERROR-YES    TO TRUE                          14890000
149000             DISPLAY '******************************************' 14900000
149100             DISPLAY '*ABEND                                   *' 14910000
149200             DISPLAY '*PROGRAM   = RCKUP998                    *' 14920000
149300             DISPLAY '*DB2 OPER  = UPDATE TRECEIV              *' 14930000
149400             DISPLAY '*PARAGRAPH = 2370-UPDATE-TRECEIV         *' 14940000
149500             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                14950000
149600             DISPLAY '*PO = ' PV-DISP-PO                          14960000
149700             DISPLAY '*RECEIVER = ' PV-DISP-REC-SEQ               14970000
149800             DISPLAY '******************************************' 14980000
149900     END-EVALUATE.                                                14990000
150000                                                                  15000000
150100 2400-ADD-RECITM.                                                 15010000
150200     PERFORM 2410-SETUP-RECITM-FIELDS.                            15020000
150300     PERFORM 2420-INSERT-RECITM.                                  15030000
150400                                                                  15040000
150500 2410-SETUP-RECITM-FIELDS.                                        15050000
150600                                                                  15060000
150700     INITIALIZE DCLTRECITM.                                       15070000
150800                                                                  15080000
150900     MOVE PV-HOLD-PO-NBR         TO RECITM-ORD-NBR.               15090000
151000     MOVE PURITM-APP-PO-LNE-NBR  TO RECITM-ORD-LNE-NBR.           15100000
151100                                                                  15110000
151200     MOVE PV-HOLD-REC-SEQ-NBR    TO RECITM-REC-SEQ-NBR.           15120000
151300     MOVE PV-HOLD-OPER-UNT-ID    TO RECITM-OPER-UNT-ID.           15130000
151400     MOVE 1                      TO RECITM-FCLTY-ID.              15140000
151500                                                                  15150000
151600     MOVE PURITM-VER-NBR         TO RECITM-PO-VER-NBR.            15160000
151700     MOVE PURITM-ITM-NBR         TO RECITM-ITM-NBR.               15170000
151800     MOVE PURITM-UNT-RTL-PR-AMT  TO RECITM-UNT-RTL-AMT            15180000
151900     MOVE PURITM-UNT-COST-AMT    TO RECITM-UNT-COST-AMT           15190000
152000     MOVE PURITM-GP-RTL-AMT      TO RECITM-GP-RTL-AMT             15200000
152100     MOVE PURITM-GP-QTY          TO RECITM-GP-QTY                 15210000
152200     MOVE RECEIV-PRE-TKT-IND     TO RECITM-PRE-TKT-IND.           15220000
152300     MOVE SPACES                 TO RECITM-TKT-FMT-ID.            15230000
152400     MOVE 'VE'                   TO RECITM-STATUS-CDE.            15240000
152500     MOVE 1                      TO RECITM-EXPTED-CART-CNT.       15250000
152600     MOVE PA-TO-VERIFY-QTY       TO RECITM-PKSL-ITM-QTY           15260000
152700                                    RECITM-DTL-CK-ITM-QTY.        15270000
152800     MOVE ZERO                   TO RECITM-ACTL-CART-CNT.         15280000
152900     MOVE '9999-09-09-09.09.09.999999'                            15290000
153000                                 TO RECITM-MKING-APRON-TMST       15300000
153100                                    RECITM-UPD-TMST.              15310000
153200     MOVE PC-DWNLDPRG            TO RECITM-VRFD-USR-ID.           15320002
153300     MOVE PC-DWNLDPRG            TO RECITM-CRE-UID.               15330002
153400                                                                  15340000
153500     INITIALIZE                     RECITM-PREPK-ID               15350000
153600                                    RECITM-PREPK-DRV-LNE-CDE      15360000
153700                                    RECITM-PREPK-RATO-QTY         15370000
153800                                    RECITM-PREPK-ODD-UNT-QTY.     15380000
153900                                                                  15390000
154000 2420-INSERT-RECITM.                                              15400000
154100                                                                  15410000
154200     EXEC SQL                                                     15420000
154300         INSERT INTO TRECITM                                      15430000
154400               (ORD_NBR                                           15440000
154500             ,  ORD_LNE_NBR                                       15450000
154600             ,  REC_SEQ_NBR                                       15460000
154700             ,  OPER_UNT_ID                                       15470000
154800             ,  FCLTY_ID                                          15480000
154900             ,  CRE_TMST                                          15490000
155000             ,  CRE_UID                                           15500000
155100             ,  PO_VER_NBR                                        15510000
155200             ,  ITM_NBR                                           15520000
155300             ,  PRE_TKT_IND                                       15530000
155400             ,  TKT_FMT_ID                                        15540000
155500             ,  RTV_IND                                           15550000
155600             ,  STATUS_CDE                                        15560000
155700             ,  VER_STATUS_CDE                                    15570000
155800             ,  PKSL_ITM_QTY                                      15580000
155900             ,  DTL_CK_ITM_QTY                                    15590000
156000             ,  INNR_PACK_QTY                                     15600000
156100             ,  CASE_PACK_QTY                                     15610000
156200             ,  RTV_QTY                                           15620000
156300             ,  EXPTED_CART_CNT                                   15630000
156400             ,  ACTL_CART_CNT                                     15640000
156500             ,  MKING_APRON_TMST                                  15650000
156600             ,  UNT_COST_AMT                                      15660000
156700             ,  COLOR_DESC                                        15670000
156800             ,  SIZE_DESC                                         15680000
156900             ,  VEND_STYL_NAME                                    15690000
157000             ,  VEND_DESC                                         15700000
157100             ,  VERFYD_TMST                                       15710000
157200             ,  PKSL_NBR                                          15720000
157300             ,  REC_INV_LNE_NBR                                   15730000
157400             ,  DMG_ITM_QTY                                       15740000
157500             ,  UPD_TMST                                          15750000
157600             ,  UPD_UID                                           15760000
157700             ,  UPD_PGM_ID                                        15770000
157800             ,  RCPT_DISTR_UPD_CDE                                15780000
157900             ,  VRFD_USR_ID                                       15790000
158000             ,  LAST_TRSCP_TMST                                   15800000
158100             ,  LAST_TRSCP_USR_ID                                 15810000
158200             ,  PREPK_ID                                          15820000
158300             ,  PREPK_RATO_QTY                                    15830000
158400             ,  PREPK_ODD_UNT_QTY                                 15840000
158500             ,  PREPK_DRV_LNE_CDE                                 15850000
158600             ,  UNT_RTL_AMT                                       15860000
158700             ,  GP_RTL_AMT                                        15870000
158800             ,  GP_QTY                                            15880000
158900             ,  ORIG_PKSL_ITM_QTY)                                15890000
159000        VALUES (:RECITM-ORD-NBR                                   15900000
159100             ,  :RECITM-ORD-LNE-NBR                               15910000
159200             ,  :RECITM-REC-SEQ-NBR                               15920000
159300             ,  :RECITM-OPER-UNT-ID                               15930000
159400             ,  :RECITM-FCLTY-ID                                  15940000
159500             ,   CURRENT_TIMESTAMP                                15950000
159600             ,  :PC-DWNLDPRG                                      15960002
159700             ,  :RECITM-PO-VER-NBR                                15970000
159800             ,  :RECITM-ITM-NBR                                   15980000
159900             ,  :RECITM-PRE-TKT-IND                               15990000
160000             ,  :RECITM-TKT-FMT-ID                                16000000
160100             ,  :RECITM-RTV-IND                                   16010000
160200             ,  :RECITM-STATUS-CDE                                16020000
160300             ,  'A'                                               16030000
160400             ,  :RECITM-PKSL-ITM-QTY                              16040000
160500             ,  :RECITM-DTL-CK-ITM-QTY                            16050000
160600             ,  :RECITM-INNR-PACK-QTY                             16060000
160700             ,  :RECITM-CASE-PACK-QTY                             16070000
160800             ,  :RECITM-RTV-QTY                                   16080000
160900             ,  :RECITM-EXPTED-CART-CNT                           16090000
161000             ,  :RECITM-ACTL-CART-CNT                             16100000
161100             ,  :RECITM-MKING-APRON-TMST                          16110000
161200             ,  :RECITM-UNT-COST-AMT                              16120000
161300             ,  :RECITM-COLOR-DESC                                16130000
161400             ,  :RECITM-SIZE-DESC                                 16140000
161500             ,  :RECITM-VEND-STYL-NAME                            16150000
161600             ,  :RECITM-VEND-DESC                                 16160000
161700             ,  CURRENT_TIMESTAMP                                 16170000
161800             ,  :RECITM-PKSL-NBR                                  16180000
161900             ,  :RECITM-REC-INV-LNE-NBR                           16190000
162000             ,  :RECITM-DMG-ITM-QTY                               16200000
162100             ,  :RECITM-UPD-TMST                                  16210000
162200             ,  :PC-DWNLDPRG                                      16220002
162300             ,  :RECITM-UPD-PGM-ID                                16230000
162400             ,  :RECITM-RCPT-DISTR-UPD-CDE                        16240000
162500             ,  :PC-DWNLDPRG                                      16250002
162600             ,   CURRENT_TIMESTAMP                                16260000
162700             ,  :PC-CURRENT-PROGRAM-NAME                          16270000
162800             ,  :RECITM-PREPK-ID                                  16280000
162900             ,  :RECITM-PREPK-RATO-QTY                            16290000
163000             ,  :RECITM-PREPK-ODD-UNT-QTY                         16300000
163100             ,  :RECITM-PREPK-DRV-LNE-CDE                         16310000
163200             ,  :RECITM-UNT-RTL-AMT                               16320000
163300             ,  :RECITM-GP-RTL-AMT                                16330000
163400             ,  :RECITM-GP-QTY                                    16340000
163500             ,  0)                                                16350000
163600     END-EXEC.                                                    16360000
163700                                                                  16370000
163800     EVALUATE TRUE                                                16380000
163900         WHEN SQLCODE = ZERO                                      16390000
164000*             MOVE +1       TO PT-TOTAL-TRECITM-INSERTS           16400000
164100              ADD  +1       TO PA-TOTAL-TRECITM-INSERTS           16410000
164200                                                                  16420000
164300         WHEN SQLWARN0 NOT = SPACES                               16430000
164400         WHEN SQLCODE  NOT = ZERO                                 16440000
164500             MOVE DK-PO-NBR         TO PV-DISP-PO                 16450000
164600             MOVE RECITM-REC-SEQ-NBR TO PV-DISP-REC-SEQ           16460000
164700             MOVE RECITM-ORD-LNE-NBR TO PV-DISP-LINE-NBR          16470000
164800             MOVE SQLCODE TO PV-DISP-SQLCODE                      16480000
164900             MOVE '2420-INSERT-RECITM'                            16490000
165000                              TO RC098-ERROR-PARA-NAME            16500000
165100             SET RC098-DB-ERROR                                   16510000
165200                 PS-ERROR-YES    TO TRUE                          16520000
165300             DISPLAY '******************************************' 16530000
165400             DISPLAY '*ABEND                                   *' 16540000
165500             DISPLAY '*PROGRAM   = RCKUP998                    *' 16550000
165600             DISPLAY '*DB2 OPER  = INSERT ON TRECITM           *' 16560000
165700             DISPLAY '*PARAGRAPH = 2420-INSERT-RECITM          *' 16570000
165800             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                16580000
165900             DISPLAY '*PO = ' PV-DISP-PO                          16590000
166000             DISPLAY '*RECEIVER = ' PV-DISP-REC-SEQ               16600000
166100             DISPLAY '*LINE = ' PV-DISP-LINE-NBR                  16610000
166200             DISPLAY '******************************************' 16620000
166300     END-EVALUATE.                                                16630000
166400                                                                  16640000
166500 2500-PREPARE-TRECDIS.                                            16650000
166600     PERFORM 2530-SELECT-APP-PO-LINE.                             16660000
166700     IF PS-ERROR-NO                                               16670000
166800         PERFORM 2510-SETUP-TRECDIS-FIELDS                        16680000
166900         PERFORM 2520-INSERT-TRECDIS                              16690000
167000     END-IF.                                                      16700000
167100                                                                  16710000
167200 2510-SETUP-TRECDIS-FIELDS.                                       16720000
167300                                                                  16730000
167400     INITIALIZE DCLTRECDIS.                                       16740000
167500                                                                  16750000
167600     MOVE RC098-PO-NBR       TO RECDIS-ORD-NBR.                   16760000
167700     MOVE PURITM-APP-PO-LNE-NBR                                   16770000
167800                             TO RECDIS-ORD-LNE-NBR.               16780000
167900     MOVE PV-REC-SEQ-NBR     TO RECDIS-REC-SEQ-NBR.               16790000
168000     MOVE RC098-OPER-UNIT    TO RECDIS-OPER-UNT-ID.               16800000
168100     MOVE PC-DWNLDPRG        TO RECDIS-CRE-UID.                   16810002
168200     MOVE 'A'                TO RECDIS-VER-STATUS-CDE.            16820000
168300     MOVE RC098-TO-VERIFY-QTY TO RECDIS-EXPTED-ITM-QTY            16830000
168400                                RECDIS-VERIFY-ITM-QTY             16840000
168500                                RECDIS-AP-VERIFY-ITM-QTY.         16850000
168600     MOVE RC098-STR-NBR      TO RECDIS-STR-NBR.                   16860000
168700     MOVE 1                  TO RECDIS-FCLTY-ID.                  16870000
168800     MOVE 1                  TO RECDIS-STR-FCLTY-ID.              16880000
168900                                                                  16890000
169000     MOVE '9999-09-09'       TO RECDIS-AP-PRC-DTE.                16900000
169100                                                                  16910000
169200                                                                  16920000
169300 2520-INSERT-TRECDIS.                                             16930000
169400                                                                  16940000
169500     EXEC SQL                                                     16950000
169600          INSERT INTO TRECDIS                                     16960000
169700                 (ORD_NBR                                         16970000
169800               ,  ORD_LNE_NBR                                     16980000
169900               ,  REC_SEQ_NBR                                     16990000
170000               ,  OPER_UNT_ID                                     17000000
170100               ,  FCLTY_ID                                        17010000
170200               ,  CRE_TMST                                        17020000
170300               ,  CRE_UID                                         17030000
170400               ,  VER_STATUS_CDE                                  17040000
170500               ,  EXPTED_ITM_QTY                                  17050000
170600               ,  VERIFY_ITM_QTY                                  17060000
170700               ,  AP_VERIFY_ITM_QTY                               17070000
170800               ,  STR_NBR                                         17080000
170900               ,  STR_FCLTY_ID                                    17090000
171000               ,  PLAN_ITM_QTY                                    17100000
171100               ,  AP_PRC_CDE                                      17110000
171200               ,  AP_PRC_DTE)                                     17120000
171300          VALUES (:RECDIS-ORD-NBR                                 17130000
171400               ,  :RECDIS-ORD-LNE-NBR                             17140000
171500               ,  :RECDIS-REC-SEQ-NBR                             17150000
171600               ,  :RECDIS-OPER-UNT-ID                             17160000
171700               ,  :RECDIS-FCLTY-ID                                17170000
171800               ,  CURRENT_TIMESTAMP                               17180000
171900               ,  :PC-DWNLDPRG                                    17190002
172000               ,  :RECDIS-VER-STATUS-CDE                          17200000
172100               ,  :RECDIS-EXPTED-ITM-QTY                          17210000
172200               ,  :RECDIS-VERIFY-ITM-QTY                          17220000
172300               ,  :RECDIS-AP-VERIFY-ITM-QTY                       17230000
172400               ,  :RECDIS-STR-NBR                                 17240000
172500               ,  :RECDIS-STR-FCLTY-ID                            17250000
172600               ,  :RECDIS-PLAN-ITM-QTY                            17260000
172700               ,  :RECDIS-AP-PRC-CDE                              17270000
172800               ,  :RECDIS-AP-PRC-DTE)                             17280000
172900     END-EXEC.                                                    17290000
173000                                                                  17300000
173100     EVALUATE TRUE                                                17310000
173200         WHEN SQLCODE = +0                                        17320000
173300              MOVE +1       TO PT-TOTAL-TRECDIS-INSERTS           17330000
173400                                                                  17340000
173500         WHEN SQLCODE = -803                                      17350000
173600              PERFORM 2523-GET-TRECDIS-UNITS                      17360000
173700              PERFORM 2525-ADD-TRECDIS-UNITS                      17370000
173800                                                                  17380000
173900         WHEN OTHER                                               17390000
174000             MOVE RECDIS-ORD-NBR    TO PV-DISP-PO                 17400000
174100             MOVE RECDIS-REC-SEQ-NBR TO PV-DISP-REC-SEQ           17410000
174200             MOVE RECDIS-ORD-LNE-NBR TO PV-DISP-LINE-NBR          17420000
174300             MOVE RECDIS-STR-NBR     TO PV-DISP-STR-NBR           17430000
174400             MOVE SQLCODE TO PV-DISP-SQLCODE                      17440000
174500             MOVE '2510-INSERT-TRECDIS'                           17450000
174600                              TO RC098-ERROR-PARA-NAME            17460000
174700             SET RC098-DB-ERROR                                   17470000
174800                 PS-ERROR-YES    TO TRUE                          17480000
174900             DISPLAY '******************************************' 17490000
175000             DISPLAY '*ABEND                                   *' 17500000
175100             DISPLAY '*PROGRAM   = RCKUP998                    *' 17510000
175200             DISPLAY '*DB2 OPER  = INSERT TRECDIS              *' 17520000
175300             DISPLAY '*PARAGRAPH = 2520-INSERT-TRECDIS         *' 17530000
175400             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                17540000
175500             DISPLAY '*PO = ' PV-DISP-PO                          17550000
175600             DISPLAY '*RECEIVER = ' PV-DISP-REC-SEQ               17560000
175700             DISPLAY '*LINE = ' PV-DISP-LINE-NBR                  17570000
175800             DISPLAY '*STORE = ' PV-DISP-STR-NBR                  17580000
175900             DISPLAY '******************************************' 17590000
176000     END-EVALUATE.                                                17600000
176100                                                                  17610000
176200 2523-GET-TRECDIS-UNITS.                                          17620000
176300                                                                  17630000
176400     EXEC SQL                                                     17640000
176500          SELECT                                                  17650000
176600                  EXPTED_ITM_QTY                                  17660000
176700               ,  VERIFY_ITM_QTY                                  17670000
176800               ,  AP_VERIFY_ITM_QTY                               17680000
176900            INTO                                                  17690000
177000                 :PV-EXPTED-ITM-QTY                               17700000
177100               , :PV-VERIFY-ITM-QTY                               17710000
177200               , :PV-AP-VERIFY-ITM-QTY                            17720000
177300            FROM TRECDIS                                          17730000
177400           WHERE                                                  17740000
177500                  ORD_NBR       =   :RECDIS-ORD-NBR               17750000
177600             AND  ORD_LNE_NBR   =   :RECDIS-ORD-LNE-NBR           17760000
177700             AND  REC_SEQ_NBR   =   :RECDIS-REC-SEQ-NBR           17770000
177800             AND  OPER_UNT_ID   =   :RECDIS-OPER-UNT-ID           17780000
177900             AND  FCLTY_ID      =   :RECDIS-FCLTY-ID              17790000
178000             AND  STR_NBR       =   :RECDIS-STR-NBR               17800000
178100             AND  STR_FCLTY_ID  =   :RECDIS-STR-FCLTY-ID          17810000
178200     END-EXEC.                                                    17820000
178300                                                                  17830000
178400     EVALUATE TRUE                                                17840000
178500         WHEN SQLCODE = +0                                        17850000
178600              CONTINUE                                            17860000
178700                                                                  17870000
178800         WHEN OTHER                                               17880000
178900             MOVE RECDIS-ORD-NBR    TO PV-DISP-PO                 17890000
179000             MOVE RECDIS-REC-SEQ-NBR TO PV-DISP-REC-SEQ           17900000
179100             MOVE RECDIS-ORD-LNE-NBR TO PV-DISP-LINE-NBR          17910000
179200             MOVE RECDIS-STR-NBR     TO PV-DISP-STR-NBR           17920000
179300             MOVE SQLCODE TO PV-DISP-SQLCODE                      17930000
179400             MOVE '2523-GET-RECDIS-UNITS'                         17940000
179500                              TO RC098-ERROR-PARA-NAME            17950000
179600             SET RC098-DB-ERROR                                   17960000
179700                 PS-ERROR-YES    TO TRUE                          17970000
179800             DISPLAY '******************************************' 17980000
179900             DISPLAY '*ABEND                                   *' 17990000
180000             DISPLAY '*PROGRAM   = RCKUP998                    *' 18000000
180010             DISPLAY '*DB2 OPER  = INSERT TRECDIS              *' 18001000
180020             DISPLAY '*PARAGRAPH = 2520-INSERT-TRECDIS         *' 18002000
180030             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                18003000
180040             DISPLAY '*PO = ' PV-DISP-PO                          18004000
180050             DISPLAY '*RECEIVER = ' PV-DISP-REC-SEQ               18005000
180051             DISPLAY '*LINE = ' PV-DISP-LINE-NBR                  18005100
180052             DISPLAY '*STORE = ' PV-DISP-STR-NBR                  18005200
180053             DISPLAY '******************************************' 18005300
180054     END-EVALUATE.                                                18005400
180055                                                                  18005500
180056                                                                  18005600
180057 2525-ADD-TRECDIS-UNITS.                                          18005700
180058                                                                  18005800
180059     ADD  RC098-TO-VERIFY-QTY  TO  PV-EXPTED-ITM-QTY              18005900
180060                                   PV-VERIFY-ITM-QTY              18006000
180061                                   PV-AP-VERIFY-ITM-QTY.          18006100
180062                                                                  18006200
180063     EXEC SQL                                                     18006300
180064          UPDATE TRECDIS                                          18006400
180065             SET  EXPTED_ITM_QTY    = :PV-EXPTED-ITM-QTY          18006500
180066               ,  VERIFY_ITM_QTY    = :PV-VERIFY-ITM-QTY          18006600
180067               ,  AP_VERIFY_ITM_QTY = :PV-AP-VERIFY-ITM-QTY       18006700
180068           WHERE                                                  18006800
180069                  ORD_NBR       =   :RECDIS-ORD-NBR               18006900
180070             AND  ORD_LNE_NBR   =   :RECDIS-ORD-LNE-NBR           18007000
180080             AND  REC_SEQ_NBR   =   :RECDIS-REC-SEQ-NBR           18008000
180090             AND  OPER_UNT_ID   =   :RECDIS-OPER-UNT-ID           18009000
180100             AND  FCLTY_ID      =   :RECDIS-FCLTY-ID              18010000
180110             AND  STR_NBR       =   :RECDIS-STR-NBR               18011000
180120             AND  STR_FCLTY_ID  =   :RECDIS-STR-FCLTY-ID          18012000
180121     END-EXEC.                                                    18012100
180122                                                                  18012200
180123     EVALUATE TRUE                                                18012300
180124         WHEN SQLCODE = +0                                        18012400
180125              MOVE +1       TO PT-TOTAL-TRECDIS-INSERTS           18012500
180126              MOVE RECDIS-ORD-NBR    TO PV-DISP-PO                18012600
180127              MOVE RECDIS-REC-SEQ-NBR TO PV-DISP-REC-SEQ          18012700
180128              MOVE RECDIS-ORD-LNE-NBR TO PV-DISP-LINE-NBR         18012800
180129              MOVE RECDIS-STR-NBR     TO PV-DISP-STR-NBR          18012900
180130              DISPLAY ' RCKUP998 - '                              18013000
180131                      '*RCVR:' PV-DISP-PO                         18013100
180132                      '-'      PV-DISP-REC-SEQ                    18013200
180133                      '-'      PV-DISP-LINE-NBR                   18013300
180134                      '-'      PV-DISP-STR-NBR                    18013400
180135                      '  -  UNITS ADDED TO EXISTING LINE'         18013500
180136                                                                  18013600
180137         WHEN OTHER                                               18013700
180138             MOVE RECDIS-ORD-NBR    TO PV-DISP-PO                 18013800
180139             MOVE RECDIS-REC-SEQ-NBR TO PV-DISP-REC-SEQ           18013900
180140             MOVE RECDIS-ORD-LNE-NBR TO PV-DISP-LINE-NBR          18014000
180141             MOVE RECDIS-STR-NBR     TO PV-DISP-STR-NBR           18014100
180142             MOVE SQLCODE TO PV-DISP-SQLCODE                      18014200
180143             MOVE '2510-INSERT-TRECDIS'                           18014300
180144                              TO RC098-ERROR-PARA-NAME            18014400
180145             SET RC098-DB-ERROR                                   18014500
180146                 PS-ERROR-YES    TO TRUE                          18014600
180147             DISPLAY '******************************************' 18014700
180148             DISPLAY '*ABEND                                   *' 18014800
180149             DISPLAY '*PROGRAM   = RCKUP998                    *' 18014900
180150             DISPLAY '*DB2 OPER  = INSERT TRECDIS              *' 18015000
180151             DISPLAY '*PARAGRAPH = 2520-INSERT-TRECDIS         *' 18015100
180152             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                18015200
180153             DISPLAY '*PO = ' PV-DISP-PO                          18015300
180154             DISPLAY '*RECEIVER = ' PV-DISP-REC-SEQ               18015400
180155             DISPLAY '*LINE = ' PV-DISP-LINE-NBR                  18015500
180156             DISPLAY '*STORE = ' PV-DISP-STR-NBR                  18015600
180157             DISPLAY '******************************************' 18015700
180158     END-EVALUATE.                                                18015800
180159                                                                  18015900
180160 2530-SELECT-APP-PO-LINE.                                         18016000
180170     EXEC SQL                                                     18017000
180180        SELECT  A.APP_PO_LNE_NBR                                  18018000
180190          INTO :PURITM-APP-PO-LNE-NBR                             18019000
180200          FROM TPURITM A                                          18020000
180300          WHERE A.PO_NBR          = :DK-PO-NBR                    18030000
180400            AND A.VER_STATUS_CDE  = 'A'                           18040000
180500            AND A.PO_LNE_NBR      = :DK-LNE-NBR                   18050000
180600     END-EXEC.                                                    18060000
180700                                                                  18070000
180800     EVALUATE TRUE                                                18080000
180900         WHEN SQLCODE = +0                                        18090000
181000         WHEN SQLCODE = -811                                      18100000
181100              CONTINUE                                            18110000
181200         WHEN SQLCODE = +100                                      18120000
181300             MOVE DK-PO-NBR   TO PV-DISP-PO                       18130000
181400             MOVE DK-LNE-NBR  TO PV-DISP-LINE-NBR                 18140000
181500             MOVE SQLCODE     TO PV-DISP-SQLCODE                  18150000
181600             MOVE '2530-SELECT-APP-PO-LINE'                       18160000
181700                              TO RC098-ERROR-PARA-NAME            18170000
181800             SET RC098-ITEM-NOT-ON-PO                             18180000
181900                 PS-ERROR-YES    TO TRUE                          18190000
182000             DISPLAY '******************************************' 18200000
182100             DISPLAY '*ABEND                                   *' 18210000
182200             DISPLAY '*PROGRAM   = RCKUP998                    *' 18220000
182300             DISPLAY '*DB2 OPER  = SELECT ON TPURITM           *' 18230000
182400             DISPLAY '*PARAGRAPH = 2530-SELECT-APP-PO-LINE     *' 18240000
182500             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                18250000
182600             DISPLAY '*PO = ' PV-DISP-PO                          18260000
182700             DISPLAY '*LINE = ' PV-DISP-LINE-NBR                  18270000
182800             DISPLAY '******************************************' 18280000
182900         WHEN SQLWARN0 NOT = SPACES                               18290000
183000         WHEN SQLCODE < +0                                        18300000
183100         WHEN SQLCODE > +0                                        18310000
183200             MOVE DK-PO-NBR   TO PV-DISP-PO                       18320000
183300             MOVE DK-LNE-NBR  TO PV-DISP-LINE-NBR                 18330000
183400             MOVE SQLCODE     TO PV-DISP-SQLCODE                  18340000
183500             MOVE '2530-SELECT-APP-PO-LINE'                       18350000
183600                              TO RC098-ERROR-PARA-NAME            18360000
183700             SET RC098-DB-ERROR                                   18370000
183800                 PS-ERROR-YES    TO TRUE                          18380000
183900             DISPLAY '******************************************' 18390000
184000             DISPLAY '*ABEND                                   *' 18400000
184100             DISPLAY '*PROGRAM   = RCKUP998                    *' 18410000
184200             DISPLAY '*DB2 OPER  = SELECT ON TPURITM           *' 18420000
184300             DISPLAY '*PARAGRAPH = 2530-SELECT-APP-PO-LINE     *' 18430000
184400             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                18440000
184500             DISPLAY '*PO = ' PV-DISP-PO                          18450000
184600             DISPLAY '*LINE = ' PV-DISP-LINE-NBR                  18460000
184700             DISPLAY '******************************************' 18470000
184800     END-EVALUATE.                                                18480000
184900                                                                  18490000
185000 2600-INSERT-WFT-LOD-CNTL.                                        18500000
185100                                                                  18510000
185200     INITIALIZE DCLWFT00001.                                      18520000
185300     INITIALIZE DCLWFT00002.                                      18530000
185400                                                                  18540000
185500     EXEC SQL                                                     18550000
185600         SET :WFT00002-PRC-CNTL-TMST = CURRENT TIMESTAMP          18560000
185700     END-EXEC.                                                    18570000
185800                                                                  18580000
185810                                                                  18581000
185820     EXEC SQL                                                     18582000
185830         INSERT INTO WFT_LOD_CNTL                                 18583000
185840             ( PRC_CNTL_TMST                                      18584000
185850             , TRN_TYP_CDE                                        18585000
185860             , STAT_CDE                                           18586000
185870             , INIT_PRCG_BEG_TMST                                 18587000
185880             , END_TMST                                           18588000
185890             , ARCH_DAT_IND                                       18589000
185891             , DAT_LOD_VER_NBR                                    18589100
185892             , STR_NBR)                                           18589200
185893         VALUES                                                   18589300
185894             ( :WFT00002-PRC-CNTL-TMST                            18589400
185895             , 'SKUVER'                                           18589500
185896             , 'READY'                                            18589600
185897             , '0001-01-01-00.00.00.000000'                       18589700
185898             , '0001-01-01-00.00.00.000000'                       18589800
185899             , ' '                                                18589900
185900             , 0                                                  18590000
185901             , 0999                                               18590100
185902             )                                                    18590200
185903     END-EXEC.                                                    18590300
185904                                                                  18590400
185905     EVALUATE TRUE                                                18590500
185906        WHEN SQLCODE = +0                                         18590600
185907              MOVE +1       TO PT-TOTAL-WFT-CNTL-INSERTS          18590700
185908        WHEN SQLWARN0 NOT = SPACES                                18590800
185909        WHEN SQLCODE < +0                                         18590900
185910        WHEN SQLCODE > +0                                         18591000
185911             MOVE SQLCODE TO PV-DISP-SQLCODE                      18591100
185912             MOVE '2600-INSERT-WFT-LOD-CNTL'                      18591200
185913                              TO RC098-ERROR-PARA-NAME            18591300
185914             SET RC098-DB-ERROR                                   18591400
185915                 PS-ERROR-YES    TO TRUE                          18591500
185916             DISPLAY '******************************************' 18591600
185917             DISPLAY '*ABEND                                   *' 18591700
185918             DISPLAY '*PROGRAM   = RCKUP009                    *' 18591800
185919             DISPLAY '*DB2 OPER  = INSERT ON WFT_LOD_CNTL      *' 18591900
185920             DISPLAY '*PARAGRAPH = 2600-INSERT-WFT-LOD-CNTL    *' 18592000
185921             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                18592100
185922             DISPLAY '*TIMESTAMP = ' WFT00002-PRC-CNTL-TMST       18592200
185923             DISPLAY '******************************************' 18592300
185924     END-EVALUATE.                                                18592400
185925                                                                  18592500
185926 2700-INSERT-WFT-LOD-XFER.                                        18592600
185927                                                                  18592700
185928     INITIALIZE WFT00002-LOD-DAT-TXT.                             18592800
185929                                                                  18592900
185930     MOVE RC098-PO-NBR      TO PV-ORDER-NUMBER.                   18593000
185931     MOVE RC098-SKU-NBR     TO PV-SKU.                            18593100
185932     MOVE PV-REC-SEQ-NBR    TO PV-RCVR-ID.                        18593200
185933     MOVE RC098-OPER-UNIT   TO PV-DC.                             18593300
185934                                                                  18593400
185935     EXEC SQL                                                     18593500
185936          SET :PV-DB2-TMST         =  CURRENT_TIMESTAMP           18593600
185937     END-EXEC.                                                    18593700
185938                                                                  18593800
185939     MOVE PV-DB2-TMST-CCYY  TO PV-VRFY-DATE (1:4).                18593900
185940     MOVE PV-DB2-TMST-MO    TO PV-VRFY-DATE (5:2).                18594000
185941     MOVE PV-DB2-TMST-DA    TO PV-VRFY-DATE (7:2).                18594100
185942     MOVE PV-DB2-TMST-HH    TO PV-VRFY-DATE (9:2).                18594200
185943     MOVE PV-DB2-TMST-MM    TO PV-VRFY-DATE (11:2).               18594300
185944     MOVE PV-DB2-TMST-SS    TO PV-VRFY-DATE (13:2).               18594400
185945     MOVE 1                 TO PV-STORE-COUNT.                    18594500
185946     MOVE RC098-STR-NBR     TO PV-STORE (1).                      18594600
185947     MOVE RC098-TO-VERIFY-QTY TO PV-STORE-QTY (1).                18594700
185948     MOVE 'P'               TO PV-STORE-QTY-SIGN (1).             18594800
185949     MOVE LENGTH OF PV-RECEIPT-ADJUSTMENT-REC TO                  18594900
185950        WFT00002-LOD-DAT-TXT-LEN.                                 18595000
185951                                                                  18595100
185952     MOVE PV-RECEIPT-ADJUSTMENT-REC TO                            18595200
185953        WFT00002-LOD-DAT-TXT-TEXT.                                18595300
185954                                                                  18595400
185955                                                                  18595500
185956     EXEC SQL                                                     18595600
185957         INSERT INTO WFT_LOD_XFER                                 18595700
185958             ( PRC_CNTL_TMST                                      18595800
185959             , TRN_TYP_CDE                                        18595900
185960             , BTCH_LOD_SEQ_ID                                    18596000
185961             , LOD_DAT_TXT                                        18596100
185962             )                                                    18596200
185963         VALUES                                                   18596300
185964             (:WFT00002-PRC-CNTL-TMST                             18596400
185965             , 'SKUVER'                                           18596500
185966             , 1                                                  18596600
185967             , :WFT00002-LOD-DAT-TXT                              18596700
185968             )                                                    18596800
185969     END-EXEC.                                                    18596900
185970                                                                  18597000
185971     EVALUATE TRUE                                                18597100
185972        WHEN SQLCODE = +0                                         18597200
185973              MOVE +1       TO PT-TOTAL-WFT-XFER-INSERTS          18597300
185974        WHEN SQLWARN0 NOT = SPACES                                18597400
185975        WHEN SQLCODE < +0                                         18597500
185976        WHEN SQLCODE > +0                                         18597600
185977             MOVE SQLCODE TO PV-DISP-SQLCODE                      18597700
185978             MOVE '2700-INSERT-WFT-LOD-XFER'                      18597800
185979                              TO RC098-ERROR-PARA-NAME            18597900
185980             SET RC098-DB-ERROR                                   18598000
185981                 PS-ERROR-YES    TO TRUE                          18598100
185982             DISPLAY '******************************************' 18598200
185983             DISPLAY '*ABEND                                   *' 18598300
185984             DISPLAY '*PROGRAM   = RCKUP009                    *' 18598400
185985             DISPLAY '*DB2 OPER  = INSERT ON WFT_LOD_XFER      *' 18598500
185986             DISPLAY '*PARAGRAPH = 2700-INSERT-WFT-LOD-XFER    *' 18598600
185987             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                18598700
185988             DISPLAY '*TIMESTAMP = ' WFT00002-PRC-CNTL-TMST       18598800
185989             DISPLAY '******************************************' 18598900
185990     END-EVALUATE.                                                18599000
185991                                                                  18599100
185992                                                                  18599200
185993*----------------------------------------------------------------*18599300
185994* OPEN THE TRECVER CURSOR                                        *18599400
185995*----------------------------------------------------------------*18599500
185996                                                                  18599600
185997 3000-OPEN-TRECVER-CSR.                                           18599700
185998                                                                  18599800
185999     EXEC SQL                                                     18599900
186000          OPEN TRECVER-CSR                                        18600000
186100     END-EXEC.                                                    18610000
186200                                                                  18620000
186300     EVALUATE TRUE                                                18630000
186400         WHEN SQLCODE = +0                                        18640000
186500              CONTINUE                                            18650000
186600         WHEN SQLWARN0 NOT = SPACE                                18660000
186700         WHEN SQLCODE  NOT = +0                                   18670000
186800             MOVE SQLCODE TO PV-DISP-SQLCODE                      18680000
186900             MOVE '3000-OPEN-TRECVER-CSR'                         18690000
187000                              TO RC098-ERROR-PARA-NAME            18700000
187100             SET RC098-DB-ERROR                                   18710000
187200                 PS-ERROR-YES    TO TRUE                          18720000
187300             DISPLAY '******************************************' 18730000
187400             DISPLAY '*ABEND                                   *' 18740000
187500             DISPLAY '*PROGRAM   = RCKUP998                    *' 18750000
187600             DISPLAY '*DB2 OPER  = OPEN TRECVER CURSOR         *' 18760000
187700             DISPLAY '*PARAGRAPH = 3000-OPEN-TRECVER-CSR       *' 18770000
187800             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                18780000
187900             DISPLAY '******************************************' 18790000
188000     END-EVALUATE.                                                18800000
188100                                                                  18810000
188200                                                                  18820000
188300*----------------------------------------------------------------*18830000
188400*    FETCH A TRECVER ROW                                         *18840000
188500*----------------------------------------------------------------*18850000
188600                                                                  18860000
188700 3020-FETCH-TRECVER-CSR.                                          18870000
188800                                                                  18880000
188900     EXEC SQL                                                     18890000
189000          FETCH TRECVER-CSR                                       18900000
189100          INTO :RECVER-MAX-RCVR-NBR                               18910000
189200     END-EXEC.                                                    18920000
189300                                                                  18930000
189400     EVALUATE TRUE                                                18940000
189500         WHEN SQLCODE = +0                                        18950000
189600              CONTINUE                                            18960000
189700                                                                  18970000
189800         WHEN SQLCODE = +100                                      18980000
189900              SET PS-EOF-TRECVER-CSR TO TRUE                      18990000
190000                                                                  19000000
190100         WHEN SQLWARN0 NOT = SPACE                                19010000
190200         WHEN SQLCODE < +0                                        19020000
190300         WHEN SQLCODE > +0                                        19030000
190400             MOVE SQLCODE TO PV-DISP-SQLCODE                      19040000
190500             MOVE '3020-FETCH-TRECVER-CSR'                        19050000
190600                              TO RC098-ERROR-PARA-NAME            19060000
190700             SET RC098-DB-ERROR                                   19070000
190800                 PS-ERROR-YES    TO TRUE                          19080000
190900             DISPLAY '******************************************' 19090000
191000             DISPLAY '*ABEND                                   *' 19100000
191100             DISPLAY '*PROGRAM   = RCKUP998                    *' 19110000
191200             DISPLAY '*DB2 OPER  = FETCH TRECVER CURSOR        *' 19120000
191300             DISPLAY '*PARAGRAPH = 3020-FETCH-TRECVER-CSR      *' 19130000
191400             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                19140000
191500             DISPLAY '******************************************' 19150000
191600     END-EVALUATE.                                                19160000
191700                                                                  19170000
191800                                                                  19180000
191900*----------------------------------------------------------------*19190000
192000*    UDPATE CURRENT CURSOR                                       *19200000
192100*----------------------------------------------------------------*19210000
192200                                                                  19220000
192300 3040-DELETE-TRECVER-CSR.                                         19230000
192400                                                                  19240000
192500     EXEC SQL                                                     19250000
192600          DELETE FROM TRECVER                                     19260000
192700            WHERE CURRENT OF TRECVER-CSR                          19270000
192800     END-EXEC                                                     19280000
192900                                                                  19290000
193000     EVALUATE TRUE                                                19300000
193100         WHEN SQLCODE = +0                                        19310000
193200              CONTINUE                                            19320000
193300                                                                  19330000
193400         WHEN SQLWARN0 NOT = SPACE                                19340000
193500         WHEN SQLCODE < +0                                        19350000
193600         WHEN SQLCODE > +0                                        19360000
193700             MOVE SQLCODE TO PV-DISP-SQLCODE                      19370000
193800             MOVE '3040-DELETE-TRECVER-CSR'                       19380000
193900                              TO RC098-ERROR-PARA-NAME            19390000
194000             SET RC098-DB-ERROR                                   19400000
194100                 PS-ERROR-YES    TO TRUE                          19410000
194200             DISPLAY '******************************************' 19420000
194300             DISPLAY '*ABEND                                   *' 19430000
194400             DISPLAY '*PROGRAM   = RCKUP998                    *' 19440000
194500             DISPLAY '*DB2 OPER  = DELETE TRECVER CURSOR       *' 19450000
194600             DISPLAY '*PARAGRAPH = 3040-DELETE-TRECVER-CSR     *' 19460000
194700             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                19470000
194800             DISPLAY '******************************************' 19480000
194900     END-EVALUATE.                                                19490000
195000                                                                  19500000
195100/                                                                 19510000
195200*----------------------------------------------------------------*19520000
195300* INSERT THE TRECVER ROW                                         *19530000
195400*----------------------------------------------------------------*19540000
195500                                                                  19550000
195600 3060-INSERT-TRECVER.                                             19560000
195700                                                                  19570000
195800     EXEC SQL                                                     19580000
195900          INSERT INTO TRECVER                                     19590000
196000                 ( OPERCO_NBR                                     19600000
196100                ,  MAX_RCVR_NBR )                                 19610000
196200          VALUES ( '03'                                           19620000
196300                ,  :RECVER-MAX-RCVR-NBR )                         19630000
196400     END-EXEC.                                                    19640000
196500                                                                  19650000
196600     EVALUATE TRUE                                                19660000
196700         WHEN SQLCODE = +0                                        19670000
196800         WHEN SQLCODE = -904                                      19680000
196900         WHEN SQLCODE = -913                                      19690000
197000             CONTINUE                                             19700000
197100                                                                  19710000
197200         WHEN SQLWARN0 NOT = SPACE                                19720000
197300         WHEN SQLCODE < +0                                        19730000
197400         WHEN SQLCODE > +0                                        19740000
197500             MOVE SQLCODE TO PV-DISP-SQLCODE                      19750000
197600             MOVE '3060-INSERT-TRECVER'                           19760000
197700                              TO RC098-ERROR-PARA-NAME            19770000
197800             SET RC098-DB-ERROR                                   19780000
197900                 PS-ERROR-YES    TO TRUE                          19790000
198000             DISPLAY '******************************************' 19800000
198100             DISPLAY '*ABEND                                   *' 19810000
198200             DISPLAY '*PROGRAM   = RCKUP998                    *' 19820000
198300             DISPLAY '*DB2 OPER  = INSERT TRECVER              *' 19830000
198400             DISPLAY '*PARAGRAPH = 3060-INSERT-TRECVER         *' 19840000
198500             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                19850000
198600             DISPLAY '******************************************' 19860000
198700     END-EVALUATE.                                                19870000
198800                                                                  19880000
198900/                                                                 19890000
199000*----------------------------------------------------------------*19900000
199100* CLOSE THE TRECVER CURSOR                                       *19910000
199200*----------------------------------------------------------------*19920000
199300                                                                  19930000
199400 3080-CLOSE-TRECVER-CSR.                                          19940000
199500                                                                  19950000
199600     EXEC SQL                                                     19960000
199700          CLOSE TRECVER-CSR                                       19970000
199800     END-EXEC                                                     19980000
199900                                                                  19990000
200000     EVALUATE TRUE                                                20000000
200100         WHEN SQLCODE = +0                                        20010000
200200              CONTINUE                                            20020000
200300         WHEN SQLWARN0 NOT = SPACE                                20030000
200400         WHEN SQLCODE  NOT = +0                                   20040000
200500             MOVE SQLCODE TO PV-DISP-SQLCODE                      20050000
200600             MOVE '3080-CLOSE-TRECVER-CSR'                        20060000
200700                              TO RC098-ERROR-PARA-NAME            20070000
200800             SET RC098-DB-ERROR                                   20080000
200900                 PS-ERROR-YES    TO TRUE                          20090000
201000             DISPLAY '******************************************' 20100000
201100             DISPLAY '*ABEND                                   *' 20110000
201200             DISPLAY '*PROGRAM   = RCKUP998                    *' 20120000
201300             DISPLAY '*DB2 OPER  = CLOSE TRECVER CURSOR        *' 20130000
201400             DISPLAY '*PARAGRAPH = 3080-CLOSE-TRECVER-CSR      *' 20140000
201500             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                20150000
201600             DISPLAY '******************************************' 20160000
201700     END-EVALUATE.                                                20170000
201800                                                                  20180000
201900/                                                                 20190000
202000                                                                  20200000
202100 4000-READ-RECORD.                                                20210000
202200     SET PS-NOT-END-OF-INPUT TO TRUE.                             20220000
202300     READ INPUT-FILE  INTO RC098-ITEM-REC                         20230000
202400         AT END                                                   20240000
202500           SET PS-END-OF-INPUT TO TRUE                            20250000
202600         NOT AT END                                               20260000
202700           ADD +1               TO PA-TOTAL-RECORDS-READ          20270000
202800           ADD RC098-TO-VERIFY-QTY                                20280000
202900                                TO PA-TOTAL-UNITS-PROCESSED       20290000
203000                                                                  20300000
203100           DISPLAY ' RCVR:'    RC098-ORIG-OPER-UNIT               20310000
203200                   '-'         RC098-ORIG-PO-NBR                  20320000
203300                   '-'         RC098-ORIG-PO-RCVR                 20330000
203400                   '-'         RC098-ORIG-PO-LNE-NBR              20340000
203500                   ' STR:'     RC098-ORIG-STR-NBR                 20350000
203600                   ' VE QTY:'  RC098-TO-VERIFY-QTY                20360000
203700           DISPLAY ' '                                            20370000
203800                                                                  20380000
203900           MOVE RC098-OPER-UNIT     TO PV-BKUP-OPER-UNT-ID        20390000
204000           MOVE RC098-PO-NBR        TO PV-BKUP-PO-NBR-1           20400000
204100           MOVE RC098-PO-LNE-NBR    TO PV-BKUP-PO-LNE-1           20410000
204200           MOVE RC098-STR-NBR       TO PV-BKUP-STR-NBR-1          20420000
204300           MOVE RC098-TO-VERIFY-QTY TO PV-BKUP-TO-VERIFY-QTY-1    20430000
204400           WRITE BKUP-RECORD FROM PV-BKUP-RECORD-1.               20440000
204500                                                                  20450000
204600****************************************************************  20460000
204700* END RUN OF PROGRAM ROUTINE:                                     20470000
204800* DISPLAY SUMMARY STATISTICS                                      20480000
204900****************************************************************  20490000
205000 5000-END-RUN-ROUTINE.                                            20500000
205100                                                                  20510000
205200     CLOSE INPUT-FILE                                             20520000
205300           ERROR-FILE                                             20530000
205400           BKUP-FILE                                              20540000
205500           OUTPUT-FILE.                                           20550000
205600                                                                  20560000
205700*END OF JOB ROUTINE.                                              20570000
205800     PERFORM 8000-EOJ-ROUTINE.                                    20580000
205900                                                                  20590000
206000*END PROGRAM.                                                     20600000
206100     DISPLAY '************  END OF RCKUP998  ***************'     20610000
206200     STOP RUN.                                                    20620000
206300                                                                  20630000
206400                                                                  20640000
206822******************************************************************20682200
206823* COMMITTED RECORDS WILL REMAIN IN DB2 TABLES AFTER AN ABEND.     20682300
206824******************************************************************20682400
206825 6000-DB2-COMMIT.                                                 20682500
206826                                                                  20682600
206827     EXEC SQL                                                     20682700
206828         COMMIT                                                   20682800
206829     END-EXEC.                                                    20682900
206830                                                                  20683000
206840     EVALUATE TRUE                                                20684000
206850         WHEN SQLCODE = +0                                        20685000
206860              ADD +1  TO PA-TOTAL-DB2-COMMITS                     20686000
206870              ADD PT-TOTAL-TPKSLIP-INSERTS                        20687000
206880                                     TO PA-TOTAL-TPKSLIP-INSERTS  20688000
206890              ADD PT-TOTAL-TPKSLIP-UPDATES                        20689000
206900                                     TO PA-TOTAL-TPKSLIP-UPDATES  20690000
207000              ADD PT-TOTAL-TPKITEM-INSERTS                        20700000
207100                                     TO PA-TOTAL-TPKITEM-INSERTS  20710000
207200              ADD PT-TOTAL-TRECEIV-INSERTS                        20720000
207300                                     TO PA-TOTAL-TRECEIV-INSERTS  20730000
207400              ADD PT-TOTAL-TRECEIV-UPDATES                        20740000
207500                                     TO PA-TOTAL-TRECEIV-UPDATES  20750000
207600              ADD PT-TOTAL-TRECITM-INSERTS                        20760000
207700                                     TO PA-TOTAL-TRECITM-INSERTS  20770000
207800              ADD PT-TOTAL-TRECDIS-INSERTS                        20780000
207900                                     TO PA-TOTAL-TRECDIS-INSERTS  20790000
208000              ADD PT-TOTAL-WFT-CNTL-INSERTS                       20800000
208100                                     TO PA-TOTAL-WFT-CNTL-INSERTS 20810000
208200              ADD PT-TOTAL-WFT-XFER-INSERTS                       20820000
208300                                     TO PA-TOTAL-WFT-XFER-INSERTS 20830000
208400              ADD PT-TOTAL-TROUBLE-UPDATES                        20840000
208500                                     TO PA-TOTAL-TROUBLE-UPDATES  20850000
208600              ADD PT-TROUBLE-DETAIL-COUNT                         20860000
208700                                     TO PA-TROUBLE-DETAIL-COUNT   20870000
208800              ADD PT-TOTAL-FINCL-ADJ-UPDATE                       20880000
208900                                     TO PT-TOTAL-FINCL-ADJ-UPDATE 20890000
209000         WHEN SQLWARN0 NOT = SPACES                               20900000
209100         WHEN SQLCODE  NOT = ZERO                                 20910000
209200         MOVE '6000-DB2-COMMIT'                                   20920000
209300                          TO RC098-ERROR-PARA-NAME                20930000
209400         SET RC098-DB-ERROR                                       20940000
209500             PS-ERROR-YES    TO TRUE                              20950000
209600         DISPLAY '****************************'                   20960000
209700         DISPLAY '** ABEND                  **'                   20970000
209800         DISPLAY '** PROGRAM = RCKUP998     **'                   20980000
209900         DISPLAY '** PARAGRAPH = 6000-COMMIT**'                   20990000
210000         DISPLAY '** UNSUCCESSFUL COMMIT    **'                   21000000
210100         DISPLAY '****************************'                   21010000
210200     END-EVALUATE.                                                21020000
210300                                                                  21030000
210400 6100-DB2-ROLLBACK.                                               21040000
210500                                                                  21050000
210600     EXEC SQL                                                     21060000
210700         ROLLBACK                                                 21070000
210800     END-EXEC.                                                    21080000
210900                                                                  21090000
211000     EVALUATE TRUE                                                21100000
211100         WHEN SQLCODE = +0                                        21110000
211200              CONTINUE                                            21120000
211300         WHEN SQLWARN0 NOT = SPACES                               21130000
211400         WHEN SQLCODE  NOT = ZERO                                 21140000
211500         MOVE '6100-DB2-ROLLBACK'                                 21150000
211600                          TO RC098-ERROR-PARA-NAME                21160000
211700         SET RC098-DB-ERROR                                       21170000
211800             PS-ERROR-YES    TO TRUE                              21180000
211900         DISPLAY '****************************'                   21190000
212000         DISPLAY '** ABEND                  **'                   21200000
212100         DISPLAY '** PROGRAM = RCKUP998     **'                   21210000
212200         DISPLAY '** PARAGRAPH = 6100-ROLLBACK'                   21220000
212300         DISPLAY '** UNSUCCESSFUL ROLLBACK  **'                   21230000
212400         DISPLAY '****************************'                   21240000
212500     END-EVALUATE.                                                21250000
212600                                                                  21260000
212700******************************************************************21270000
212800* UPDATE CHECKPOINT STATUS CODE WITH 0 FOR COMPLETION.            21280000
212900* DISPLAY STATISTICS FOR THE PROGRAM                              21290000
213000******************************************************************21300000
213100 8000-EOJ-ROUTINE.                                                21310000
213200                                                                  21320000
213300                                                                  21330000
213400         DISPLAY ' ********************************************'  21340000
213500         DISPLAY '     * RCKUP998 SUMMARY STATISTICS *         '  21350000
213600         DISPLAY ' '                                              21360000
213700         DISPLAY '       ---------------------------           '  21370000
213800         DISPLAY '          RECEIVER CREATE UPDATES            '  21380000
213900         DISPLAY '       ---------------------------           '  21390000
214000         DISPLAY ' '                                              21400000
214100         DISPLAY ' TOTAL RECORDS READ                :'           21410000
214200                                        PA-TOTAL-RECORDS-READ     21420000
214300         DISPLAY ' TOTAL UNITS PROCESSED             :'           21430000
214400                                        PA-TOTAL-UNITS-PROCESSED  21440000
214500         DISPLAY ' TOTAL MESSAGES PROCESSED          :'           21450000
214600                                        PA-TOTAL-PROCESS-RECS     21460000
214700         DISPLAY ' TOTAL MESSAGES IN ERROR           :'           21470000
214800                                        PA-TOTAL-ERROR-RECS       21480000
214900         DISPLAY ' TOTAL PKSLIP INSERTS              :'           21490000
215000                                        PA-TOTAL-TPKSLIP-INSERTS  21500000
215100         DISPLAY ' TOTAL PKSLIP UPDATES              :'           21510000
215200                                        PA-TOTAL-TPKSLIP-UPDATES  21520000
215300         DISPLAY ' TOTAL PKITEM INSERTS              :'           21530000
215400                                        PA-TOTAL-TPKITEM-INSERTS  21540000
215500         DISPLAY ' TOTAL RECEIVER INSERTS            :'           21550000
215600                                        PA-TOTAL-TRECEIV-INSERTS  21560000
215700         DISPLAY ' TOTAL RECEIVER UPDATES            :'           21570000
215800                                        PA-TOTAL-TRECEIV-UPDATES  21580000
215900         DISPLAY ' TOTAL RECITM INSERTS              :'           21590000
216000                                        PA-TOTAL-TRECITM-INSERTS  21600000
216100         DISPLAY ' TOTAL RECDIS INSERTS              :'           21610000
216200                                        PA-TOTAL-TRECDIS-INSERTS  21620000
216300         DISPLAY ' TOTAL TROUBLE UPDATES             :'           21630000
216400                                        PA-TROUBLE-DETAIL-COUNT   21640000
216500         DISPLAY ' TOTAL SUT_FINCL_ADJ UPDATES       :'           21650000
216600                                        PA-TOTAL-FINCL-ADJ-UPDATE 21660000
216700         DISPLAY ' TOTAL DB2 COMMITS                 :'           21670000
216800                                        PA-TOTAL-DB2-COMMITS      21680000
216900         DISPLAY ' TOTAL WFT_CNTL INSERTS:  '                     21690000
217000                                        PA-TOTAL-WFT-CNTL-INSERTS 21700000
217100         DISPLAY ' TOTAL WFT_XFER INSERTS:  '                     21710000
217200                                        PA-TOTAL-WFT-XFER-INSERTS 21720000
217300         DISPLAY '********************************************'.  21730000
217400                                                                  21740000
217500                                                                  21750000
217600******************************************************************21760000
217700**                      END OF PROGRAM                            21770000
217800*                                                                 21780000
217900******************************************************************21790000
