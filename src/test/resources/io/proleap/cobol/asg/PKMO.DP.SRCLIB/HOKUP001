000100* ------------------------------------------------------------- * 00010096
000200 IDENTIFICATION DIVISION.                                         00020096
000300* ------------------------------------------------------------- * 00030096
000400 PROGRAM-ID.      HOKUP001.                                       00040096
000500 AUTHOR.          BOB MCASEY.                                     00050096
000600 INSTALLATION.    KOHLS DEPARTMENT STORES.                        00060096
000700 DATE-WRITTEN.    10-16-2000.                                     00070096
000800                                                                  00080096
000900***************************************************************** 00090096
001000*  THIS PROGRAM "GETS" MESSAGES OFF THE MQ SERIES DATA QUEUE FOR* 00100096
001100*  RMS ORG HIERARCHY AND UPDATES THE APPROPRIATE DB2 TABLES.    * 00110096
001500***************************************************************** 00120096
002900*---------------------------------------------------------------* 00130096
      *    WR/PITS#     DATE        DESCRIPTION                       * 00140096
      *    --------   ----------   ---------------------------------  * 00150096
      *               07/25/2001   MODIFIED LOGIC FOR DCS TO UPDATE   * 00160096
      *                            THE RECEIPTS ON AN INSERT AND UP-  * 00170096
      *                            DATE.                              * 00180096
      *               08/07/2001   MODIFIED LOGIC FOR DCS TO UPDATE   * 00190096
      *                            THE RECEIPT END DATE AND THE P.O.  * 00200096
      *                            END DATE.  MODIFIED LOGIC TO       * 00210096
      *                            BRIDGE THE FINANCIAL CLOSE DATE.   * 00220096
      *   PM00419674  08/29/2001   ADDED MOVE FOR 10 CHAR STORE NAME  * 00230096
      *                            THIS WAS DONE FOR THE MA TEAM BE-  * 00240096
      *                            CAUSE THEY REQUIRE A 10 CHAR NAME  * 00250096
      *                            ON THEIR BRIDGE BACK TO ORACLE FOR * 00260096
      *                            "OUTLOC" TYPE RECORDS (RECORD TYPE * 00270096
      *                            HQ, OP, AL, DA,ND, VN).            * 00280096
      *   WR22871     08/2001 -    ADDED CODE FOR MOD00019 - FOR      * 00290096
      *               10/2001      FINANCIAL CLOSE DATE, RECEIPT AND  * 00300096
      *                            PO STOP DATES.                     * 00310096
      *                            ADDED CODE FOR MOD00020 - SIGN PRT * 00320096
      *                            FIELDS FROM STORE ATTRIBUTE ARE NO * 00330096
      *                            LONGER PRESENT. MOVE DEFAULT VALUES* 00340096
      *                            ON AN INSERT AND DO NOTHING WITH   * 00350096
      *                            THEM ON AN UPDATE.                 * 00360096
      *                            ADDED CODE FOR MOD00025 - REMOVE   * 00370096
      *                            PRE OPEN PHONE NBRS FROM STORE ATT * 00380096
      *                            AND DC CARRIER ON WEB FROM WH ATTR.* 00390096
      *   WR23470     03/25/2002   MOVE HO100-WHATTR-OCPNC-DTE TO     * 00400096
      *                            TSTR000-OCPNC-DTE IN THE           * 00410096
      *                            6310-UPDATE-WH-ATTR-DATA ROUTINE.  * 00420096
      *   P000458641  03/29/2002   ADD LOGIC TO CHECK IF THE START    * 00430096
      *                            ORDER DAYS CHANGE AND CHANGE THE   * 00440096
      *                            DC1/DC2 RCT START DAYS ACCORDINGLY.* 00450096
      *   WR22160     05/28/2002   CHANGE 6800-PROCESS-PRICE-ZONE TO  * 00460099
      *                            TO HANDLE AD MARKET UPDATES.  ADD  * 00470099
      *                            A NEW 6850-PROCESS-PRICE-ZONE-DATE * 00480099
      *                            ROUTINE TO HANDLE INSERTS, DELETES,* 00490099
      *                            AND DATE UPDATES OF AD MARKETS.    * 00500099
      *   WR23765     09/09/2002   ADD NEW LOGIC TO PROCESS CHANGES IN* 00510099
      *                            WH_STORE_ASSIGN TO DC1 & DC2. PRO- * 00520099
      *                            CESS UPDATES TO RECEIPT DATE AND WH* 00530099
      *                            NUMBERS THRU THE WH_STORE_ASSIGN   * 00540099
      *                            AND COMMENT OUT RECEIPT DATE UPDATE* 00550099
      *                            LOGIC THRU THE STORE UPDATE TXN.   * 00560099
      *   P000509364  11/22/2002   MODIFY TADMRKT UPDATE/DELETE LOGIC * 00570099
      *                            TO ACCOMODATE NEW TABLE THAT HAS   * 00580099
      *                            REFERENTIAL INTEGRITY TO IT.       * 00590099
      *   WR24442     02/03/2003   RECOMPILE TO PICK UP NEW VERSION OF* 00600099
      *                            HORD100.  ADDITIONAL MESSAGES WILL * 00610099
      *                            BE INPUT TO THIS PROGRAM BECAUSE OF* 00620099
      *                            CHANGES TO TRIGGERS. ALL LEVELS OF * 00630099
      *                            PRICE_ZONE MESSSAGES WILL BE INPUT * 00640099
      *                            BUT ONLY THE EXISTING ONES WILL BE * 00650099
      *                            PROCESSED (CHANGES TO ADMARKET 4000* 00660099
      *                            AND CLIMATE (3000) INSERT, UPDATE &* 00670099
      *                            DELETE).                           * 00680099
      *   WR24988     04/16/2003   ADDED THE MQ WAIT TIME TO THE GET. * 00690099
      *                            THIS PREVENTS MESSAGES FROM BEING  * 00700099
      *                            LEFT IN THE QUEUE.                 * 00710099
      *   WR25433     07/15/2003   ENHANCED EDIT ON DELETE OF METRO   * 00720099
      *                            AREA.                              * 00730099
      *   WR27051     05/13/2004   PREVENT 4 DIGIT STORE/WH/OUTLOCS   * 00740099
      *                            FROM BEING PROCESSED.              * 00750099
      *               09/24/2004   COMMENT OUT BANKCARD INFO MOVES    * 00760099
      *                            FROM BEING PROCESSED.              * 00770099
219606*   CHG0219606  03/08/2019   DELETED PARA. 8300-PUT-MSG-ON-DLQ  * 00780099
219606*                            TO PREVENT MESSAGES FROM BEING     * 00790099
219606*                            WRITTEN TO THE DEAD LETTER QUEUE.  * 00800099
219606*                            ALSO, DELETED CALLS IN PARAGRAPH   * 00810099
219606*                            1500-MQ-SETUP TO OPEN QUEUE MANAGER* 00820099
219606*                            AND GET QUEUE NAME FOR DEAD LETTER * 00830099
219606*                            QUEUE.                             * 00840099
219606*   JEAN KURK   01/15/2021   REMOVE TABLES TADMRKT, TSTRMKT,    * 00841099
219606*                            TPMADLC, SIT_SGN_MKT_RLT, TCLIMAT, * 00842099
219606*                            TMETARA, TGRN000, TTER000,         * 00843099
219606*                            TPMITPR, TPMMELC                   * 00844099
001500***************************************************************** 00850099
003000 ENVIRONMENT DIVISION.                                            00860099
003100* ------------------------------------------------------------- * 00870096
003200                                                                  00880096
003300 CONFIGURATION SECTION.                                           00890096
003400                                                                  00900096
003500 SOURCE-COMPUTER.       IBM-3090.                                 00910096
003600 OBJECT-COMPUTER.       IBM-3090.                                 00920096
003700                                                                  00930096
003800 INPUT-OUTPUT SECTION.                                            00940096
003900                                                                  00950096
004000 FILE-CONTROL.                                                    00960096
004200     SELECT CONTROL-CARD-1   ASSIGN TO INP01.                     00970096
004200     SELECT CONTROL-CARD-2   ASSIGN TO INP02.                     00980096
004200     SELECT AUDIT-FILE       ASSIGN TO OUT01.                     00990096
004200     SELECT ERROR-FILE       ASSIGN TO OUT02.                     01000096
004700                                                                  01010096
004700                                                                  01020096
004800                                                                  01030096
004900* ------------------------------------------------------------- * 01040096
005000 DATA DIVISION.                                                   01050096
005100* ------------------------------------------------------------- * 01060096
005200 FILE SECTION.                                                    01070096
005300                                                                  01080096
005400 FD  CONTROL-CARD-1                                               01090096
005500     RECORDING MODE F                                             01100096
005600     BLOCK CONTAINS 0 RECORDS                                     01110096
005700     LABEL RECORDS ARE OMITTED.                                   01120096
005800 01  CONTROL-CARD-1-LINE              PIC  X(80).                 01130096
005900                                                                  01140096
005400 FD  CONTROL-CARD-2                                               01150096
005500     RECORDING MODE F                                             01160096
005600     BLOCK CONTAINS 0 RECORDS                                     01170096
005700     LABEL RECORDS ARE OMITTED.                                   01180096
005800 01  CONTROL-CARD-2-LINE              PIC  X(80).                 01190096
                                                                        01200096
       FD  AUDIT-FILE                                                   01210096
           RECORDING MODE F                                             01220096
           LABEL RECORDS OMITTED                                        01230096
           BLOCK CONTAINS  0 RECORDS.                                   01240096
       01  AUDIT-RECORD                     PIC X(500).                 01250096
005900                                                                  01260096
       FD  ERROR-FILE                                                   01270096
           RECORDING MODE F                                             01280096
           LABEL RECORDS OMITTED                                        01290096
           BLOCK CONTAINS  0 RECORDS.                                   01300096
       01  ERROR-RECORD                     PIC X(500).                 01310096
005900                                                                  01320096
007500* ------------------------------------------------------------- * 01330096
007600 WORKING-STORAGE SECTION.                                         01340096
007700* ------------------------------------------------------------- * 01350096
007800                                                                  01360096
007900 01  WS-MQCONN                 PIC X(8)  VALUE 'CSQBCONN'.        01370096
008000 01  WS-MQOPEN                 PIC X(8)  VALUE 'CSQBOPEN'.        01380096
008100 01  WS-MQINQ                  PIC X(8)  VALUE 'CSQBINQ'.         01390096
008200 01  WS-MQGET                  PIC X(8)  VALUE 'CSQBGET'.         01400096
008300 01  WS-MQPUT1                 PIC X(8)  VALUE 'CSQBPUT1'.        01410096
008400 01  WS-MQBACK                 PIC X(8)  VALUE 'CSQBBACK'.        01420096
008500 01  WS-MQCMIT                 PIC X(8)  VALUE 'CSQBCOMM'.        01430096
008600 01  WS-MQCLOSE                PIC X(8)  VALUE 'CSQBCLOS'.        01440096
008700 01  WS-MQDISC                 PIC X(8)  VALUE 'CSQBDISC'.        01450096
008800 01  WS-GET-MORE-STORES-RETRY  PIC X(1)  VALUE 'N'.               01460096
009000                                                                  01470096
009100*    API CONTROL BLOCKS                                           01480096
009200                                                                  01490096
009300 01  MQM-OBJECT-DESCRIPTOR.                                       01500096
009400     COPY CMQODV.                                                 01510096
009500 01  MQM-MESSAGE-DESCRIPTOR.                                      01520096
009600     COPY CMQMDV.                                                 01530096
009700 01  MQM-GET-MESSAGE-OPTIONS.                                     01540096
009800     COPY CMQGMOV.                                                01550096
009900 01  MQM-PUT-MESSAGE-OPTIONS.                                     01560096
010000     COPY CMQPMOV.                                                01570096
010100                                                                  01580096
010200*    MQV CONTAINS CONSTANTS (FOR FILLING IN THE CONTROL BLOCKS)   01590096
010300*    AND RETURN CODES (FOR TESTING THE RESULT OF A CALL)          01600096
010400                                                                  01610096
010500 01  MQM-CONSTANTS.                                               01620096
010600     COPY CMQV.                                                   01630096
010700*                                                                 01640096
010800*----------------------------------------------------------------*01650096
010900*    CONTROL CARD                                                 01660096
011000*----------------------------------------------------------------*01670096
011100 01  CC-CONTROL-CARD-1.                                           01680096
011200     05  CC-QMGR-NAME              PIC X(48).                     01690096
011300     05  FILLER                    PIC X(32).                     01700096
011400                                                                  01710096
011100 01  CC-CONTROL-CARD-2.                                           01720096
011200     05  CC-ORG-HIERARCHY-QNAME    PIC X(48).                     01730096
011300     05  FILLER                    PIC X(32).                     01740096
011400                                                                  01750096
012200*----------------------------------------------------------------*01760096
012300*    PROGRAM ACCUMULATORS                                         01770096
012400*----------------------------------------------------------------*01780096
012500 01  PA-PROGRAM-ACCUMULATORS.                                     01790096
027400     05  PA-NUMPUTS                PIC S9(07) BINARY VALUE 0.     01800096
           05  PA-MQGET                  PIC 9(07) VALUE 0.             01810096
           05  PA-AUDITS                 PIC 9(07) VALUE 0.             01820096
           05  PA-ERRORS                 PIC 9(07) VALUE 0.             01830096
           05  PA-STORE-MESSAGES         PIC 9(07) VALUE 0.             01840096
           05  PA-STORE-SELECTS          PIC 9(07) VALUE 0.             01850096
           05  PA-STORE-INSERTS          PIC 9(07) VALUE 0.             01860096
           05  PA-STORE-UPDATES          PIC 9(07) VALUE 0.             01870096
           05  PA-STORE-DELETES          PIC 9(07) VALUE 0.             01880096
           05  PA-STORE-ERRORS           PIC 9(07) VALUE 0.             01890096
           05  PA-STORE-ATTRIB-MESSAGES  PIC 9(07) VALUE 0.             01900096
           05  PA-STORE-ATTRIB-INSERTS   PIC 9(07) VALUE 0.             01910096
           05  PA-STORE-ATTRIB-UPDATES   PIC 9(07) VALUE 0.             01920096
           05  PA-STORE-ATTRIB-DELETES   PIC 9(07) VALUE 0.             01930096
           05  PA-STORE-ATTRIB-ERRORS    PIC 9(07) VALUE 0.             01940096
           05  PA-WH-MESSAGES            PIC 9(07) VALUE 0.             01950096
           05  PA-WH-INSERTS             PIC 9(07) VALUE 0.             01960096
           05  PA-WH-UPDATES             PIC 9(07) VALUE 0.             01970096
           05  PA-WH-DELETES             PIC 9(07) VALUE 0.             01980096
           05  PA-WH-ERRORS              PIC 9(07) VALUE 0.             01990096
           05  PA-WH-ATTRIB-MESSAGES     PIC 9(07) VALUE 0.             02000096
           05  PA-WH-ATTRIB-INSERTS      PIC 9(07) VALUE 0.             02010096
           05  PA-WH-ATTRIB-UPDATES      PIC 9(07) VALUE 0.             02020096
           05  PA-WH-ATTRIB-DELETES      PIC 9(07) VALUE 0.             02030096
           05  PA-WH-ATTRIB-ERRORS       PIC 9(07) VALUE 0.             02040096
           05  PA-WH-STR-ASSIGN-MESSAGES PIC 9(07) VALUE 0.             02050096
           05  PA-WH-STR-ASSIGN-INSERTS  PIC 9(07) VALUE 0.             02060096
           05  PA-WH-STR-ASSIGN-UPDATES  PIC 9(07) VALUE 0.             02070096
           05  PA-WH-STR-ASSIGN-DELETES  PIC 9(07) VALUE 0.             02080096
           05  PA-WH-STR-ASSIGN-ERRORS   PIC 9(07) VALUE 0.             02090096
      *JAK 05  PA-AREA-MESSAGES          PIC 9(07) VALUE 0.             02100099
      *JAK 05  PA-AREA-INSERTS           PIC 9(07) VALUE 0.             02110099
      *JAK 05  PA-AREA-UPDATES           PIC 9(07) VALUE 0.             02120099
      *JAK 05  PA-AREA-DELETES           PIC 9(07) VALUE 0.             02130099
      *JAK 05  PA-AREA-ERRORS            PIC 9(07) VALUE 0.             02140099
      *JAK 05  PA-REGION-MESSAGES        PIC 9(07) VALUE 0.             02150099
      *JAK 05  PA-REGION-INSERTS         PIC 9(07) VALUE 0.             02160099
      *JAK 05  PA-REGION-UPDATES         PIC 9(07) VALUE 0.             02170099
      *JAK 05  PA-REGION-DELETES         PIC 9(07) VALUE 0.             02180099
      *JAK 05  PA-REGION-ERRORS          PIC 9(07) VALUE 0.             02190099
           05  PA-DISTRICT-MESSAGES      PIC 9(07) VALUE 0.             02200096
           05  PA-DISTRICT-INSERTS       PIC 9(07) VALUE 0.             02210096
           05  PA-DISTRICT-UPDATES       PIC 9(07) VALUE 0.             02220096
           05  PA-DISTRICT-DELETES       PIC 9(07) VALUE 0.             02230096
           05  PA-DISTRICT-ERRORS        PIC 9(07) VALUE 0.             02240096
           05  PA-OUTLOC-MESSAGES        PIC 9(07) VALUE 0.             02250096
           05  PA-OUTLOC-INSERTS         PIC 9(07) VALUE 0.             02260096
           05  PA-OUTLOC-UPDATES         PIC 9(07) VALUE 0.             02270096
           05  PA-OUTLOC-DELETES         PIC 9(07) VALUE 0.             02280096
           05  PA-OUTLOC-ERRORS          PIC 9(07) VALUE 0.             02290096
           05  PA-PZGS-MSGS              PIC 9(07) VALUE 0.             02300096
           05  PA-PZGS-INSERTS           PIC 9(07) VALUE 0.             02310096
           05  PA-PZGS-UPDATES           PIC 9(07) VALUE 0.             02320096
           05  PA-PZGS-ERRORS            PIC 9(07) VALUE 0.             02330096
      *JAK 05  PA-PZGSS-INSERTS          PIC 9(07) VALUE 0.             02340099
      *JAK 05  PA-PZGSS-ERRORS           PIC 9(07) VALUE 0.             02350099
      *JAK 05  PA-MET-MSGS               PIC 9(07) VALUE 0.             02360099
      *JAK 05  PA-MET-INSERTS            PIC 9(07) VALUE 0.             02370099
      *JAK 05  PA-MET-UPDATES            PIC 9(07) VALUE 0.             02380099
      *JAK 05  PA-MET-DELETES            PIC 9(07) VALUE 0.             02390099
      *JAK 05  PA-MET-ERRORS             PIC 9(07) VALUE 0.             02400099
      *JAK 05  PA-CLIMAT-MSGS            PIC 9(07) VALUE 0.             02410099
      *JAK 05  PA-CLIMAT-INSERTS         PIC 9(07) VALUE 0.             02420099
      *JAK 05  PA-CLIMAT-UPDATES         PIC 9(07) VALUE 0.             02430099
      *JAK 05  PA-CLIMAT-DELETES         PIC 9(07) VALUE 0.             02440099
      *JAK 05  PA-CLIMAT-ERRORS          PIC 9(07) VALUE 0.             02450099
      *JAK 05  PA-ADMRKT-MSGS            PIC 9(07) VALUE 0.             02460099
      *JAK 05  PA-ADMRKT-UPDATES         PIC 9(07) VALUE 0.             02470099
      *JAK 05  PA-ADMRKT-ERRORS          PIC 9(07) VALUE 0.             02480099
      *JAK 05  PA-PZGD-MSGS              PIC 9(07) VALUE 0.             02490099
      *JAK 05  PA-PZGD-ADMRKT-INSERTS    PIC 9(07) VALUE 0.             02500099
      *JAK 05  PA-PZGD-ADMRKT-UPDATES    PIC 9(07) VALUE 0.             02510099
      *JAK 05  PA-PZGD-ADMRKT-DELETES    PIC 9(07) VALUE 0.             02520099
      *JAK 05  PA-PZGD-ERRORS            PIC 9(07) VALUE 0.             02530099
0504RM** WR27051                                                        02540099
0504RM     05  PA-STORE-BYPASS           PIC 9(07) VALUE 0.             02550099
0504RM     05  PA-STRATTR-BYPASS         PIC 9(07) VALUE 0.             02560099
0504RM     05  PA-WH-BYPASS              PIC 9(07) VALUE 0.             02570099
0504RM     05  PA-WHATTR-BYPASS          PIC 9(07) VALUE 0.             02580099
0504RM     05  PA-OUTLOC-BYPASS          PIC 9(07) VALUE 0.             02590099
0504RM     05  PA-WHSTASG-BYPASS         PIC 9(07) VALUE 0.             02600099
0504RM     05  PA-PZGS-BYPASS            PIC 9(07) VALUE 0.             02610099
0504RM     05  PA-MSGS-SKIPPED           PIC 9(07) VALUE 0.             02611099
                                                                        02620099
      *----------------------------------------------------------------*02630096
      *    PROGRAM CONSTANTS                                            02640096
      *----------------------------------------------------------------*02650096
       01  PC-PROGRAM-CONSTANTS.                                        02660096
      *JAK 05  PC-ADMRKT-MARKET          PIC X(01) VALUE 'M'.           02670099
           05  PC-OTHER                  PIC X(01) VALUE 'O'.           02680096
           05  PC-Y                      PIC X(01) VALUE 'Y'.           02690096
           05  PC-F2                     PIC X(02) VALUE 'F2'.          02700096
           05  PC-KOHLS-OP-CO            PIC X(02) VALUE '03'.          02710096
           05  PC-SALVAGE                PIC X(02) VALUE 'AL'.          02720096
           05  PC-CENTRAL-STOCK          PIC X(02) VALUE 'CS'.          02730096
           05  PC-DEPT-STR               PIC X(02) VALUE 'DS'.          02740096
           05  PC-DIST-CTR               PIC X(02) VALUE 'DC'.          02750096
           05  PC-HEADQUARTERS           PIC X(02) VALUE 'HQ'.          02760096
           05  PC-NON-MERCHANDISE        PIC X(02) VALUE 'ND'.          02770096
           05  PC-OPERATIONS             PIC X(02) VALUE 'OP'.          02780096
           05  PC-RETURN-TO-VENDOR       PIC X(02) VALUE 'RV'.          02790096
           05  PC-VENDOR                 PIC X(02) VALUE 'VN'.          02800096
           05  PC-ASTERISKS              PIC X(03) VALUE '***'.         02810096
           05  PC-DC1                    PIC X(03) VALUE 'DC1'.         02820096
           05  PC-DC2                    PIC X(03) VALUE 'DC2'.         02830096
           05  PC-DC3                    PIC X(03) VALUE 'DC3'.         02840096
           05  PC-DC4                    PIC X(03) VALUE 'DC4'.         02850096
           05  PC-DC5                    PIC X(03) VALUE 'DC5'.         02860096
           05  PC-DC6                    PIC X(03) VALUE 'DC6'.         02870096
           05  PC-DC7                    PIC X(03) VALUE 'DC7'.         02880096
           05  PC-DC8                    PIC X(03) VALUE 'DC8'.         02890096
           05  PC-085                    PIC X(03) VALUE '085'.         02900096
           05  PC-810                    PIC X(03) VALUE '810'.         02910096
           05  PC-087                    PIC X(03) VALUE '087'.         02920096
           05  PC-830                    PIC X(03) VALUE '830'.         02930096
           05  PC-840                    PIC X(03) VALUE '840'.         02940096
           05  PC-845                    PIC X(03) VALUE '845'.         02950096
           05  PC-870                    PIC X(03) VALUE '870'.         02960096
           05  PC-801                    PIC X(03) VALUE '801'.         02970096
           05  PC-HOK010-JOB             PIC X(06) VALUE 'HOK010'.      02980096
           05  PC-DPKUT500-PGM           PIC X(08) VALUE 'DPKUT500'.    02990096
           05  PC-PGM-NAME               PIC X(09) VALUE 'HOKUP001 '.   03000096
           05  PC-DEFAULT-DATE           PIC X(10) VALUE '9999-09-09'.  03010096
           05  PC-30-SPACES              PIC X(30) VALUE SPACES.        03020096
           05  PC-STORE-TABLE            PIC X(30) VALUE                03030096
              'STORE                         '.                         03040096
           05  PC-STORE-ATTRIBUTES-TABLE PIC X(30) VALUE                03050096
              'STORE_ATTRIBUTES              '.                         03060096
           05  PC-AREA-TABLE             PIC X(30) VALUE                03070096
              'AREA                          '.                         03080096
           05  PC-REGION-TABLE           PIC X(30) VALUE                03090096
              'REGION                        '.                         03100096
           05  PC-DISTRICT-TABLE         PIC X(30) VALUE                03110096
              'DISTRICT                      '.                         03120096
           05  PC-OUTLOC-TABLE           PIC X(30) VALUE                03130096
              'OUTLOC                        '.                         03140096
           05  PC-WH-TABLE               PIC X(30) VALUE                03150096
              'WH                            '.                         03160096
           05  PC-WH-ATTRIBUTES-TABLE    PIC X(30) VALUE                03170096
              'WH_ATTRIBUTES                 '.                         03180096
           05  PC-WH-STORE-ASSIGN        PIC X(30) VALUE                03190096
              'WH_STORE_ASSIGN               '.                         03200096
           05  PC-PRICE-ZONE             PIC X(30) VALUE                03210096
              'PRICE_ZONE                    '.                         03220096
           05  PC-PRICE-ZN-GRP-STR-TABLE PIC X(30) VALUE                03230096
              'PRICE_ZONE_GROUP_STORE        '.                         03240096
           05  PC-K-EMT-METRO-PRICE-ZONE PIC X(30) VALUE                03250096
              'K_EMT_METRO_PRICE_ZONE        '.                         03260096
           05  PC-K-EMT-PRICE-ZONE-DATE  PIC X(30) VALUE                03270099
              'K_EMT_PRICE_ZONE_DATE         '.                         03280099
           05  PC-FIFTY-STARS            PIC X(50)  VALUE ALL '*'.      03290096
           05  PC-ONE                    PIC 9(01)  VALUE 1.            03300096
           05  PC-NINETY                 PIC 9(02)  VALUE 90.           03310096
           05  PC-8888                   PIC 9(04)  VALUE 8888.         03320099
           05  PC-999                    PIC 9(03)  VALUE 999.          03330099
           05  PC-9999                   PIC 9(04)  VALUE 9999.         03340099
           05  PC-MAX-RETRIES            PIC 9(04)  VALUE 3 COMP.       03350096
           05  PC-ROW-NOT-FOUND          PIC S9(04) VALUE +100.         03360096
           05  PC-DEADLOCK               PIC S9(04) VALUE -913.         03370096
           05  PC-UNAVAILABLE-RESOURCES  PIC S9(04) VALUE -904.         03380096
                                                                        03390096
      *----------------------------------------------------------------*03400096
      *    PROGRAM SWITCHES                                             03410096
      *----------------------------------------------------------------*03420096
       01  PS-PROGRAM-SWITCHES.                                         03430096
           05  PS-CONTROL-CARD-1-SW      PIC X(01) VALUE 'N'.           03440096
               88  PS-CONTROL-CARD-1-END           VALUE 'Y'.           03450096
               88  PS-CONTROL-CARD-1-START         VALUE 'N'.           03460096
           05  PS-CONTROL-CARD-2-SW      PIC X(01) VALUE 'N'.           03470096
               88  PS-CONTROL-CARD-2-END           VALUE 'Y'.           03480096
               88  PS-CONTROL-CARD-2-START         VALUE 'N'.           03490096
           05  PS-MQGET-SUCCESSFUL-SW    PIC X(01) VALUE 'N'.           03500096
               88  PS-MQGET-SUCCESSFUL             VALUE 'Y'.           03510096
           05  PS-END-OF-RECORD-IND      PIC X(01) VALUE 'N'.           03520096
               88  PS-END-OF-RECORD                VALUE 'Y'.           03530096
           05  PS-NO-RECORD-FOUND-IND    PIC X(01) VALUE 'N'.           03540096
               88  PS-NO-RECORD-FOUND              VALUE 'Y'.           03550096
           05  PS-STORE-FOUND-SW         PIC X(01) VALUE 'N'.           03560096
               88  PS-STORE-NOT-FOUND              VALUE 'Y'.           03570096
           05  PS-REGION-FOUND-SW        PIC X(01) VALUE 'N'.           03580096
               88  PS-REGION-NOT-FOUND             VALUE 'Y'.           03590096
           05  PS-TERRITORY-FOUND-SW     PIC X(01) VALUE 'N'.           03600096
               88  PS-REGION-NOT-FOUND             VALUE 'Y'.           03610096
           05  PS-DISTRICT-FOUND-SW      PIC X(01) VALUE 'N'.           03620096
               88  PS-DISTRICT-NOT-FOUND           VALUE 'Y'.           03630096
           05  PS-INPUT-REC-ERR-SW       PIC X(01) VALUE 'N'.           03640096
               88  PS-NO-INPUT-REC-ERROR           VALUE 'N'.           03650096
               88  PS-INPUT-REC-ERROR              VALUE 'Y'.           03660096
                                                                        03670096
      *----------------------------------------------------------------*03680096
      *    PROGRAM VARIABLES                                            03690096
      *----------------------------------------------------------------*03700096
       01  PV-PROGRAM-VARIABLES.                                        03710096
           05  PV-NBR-OF-METROS           PIC S9(4)   VALUE 0 COMP.     03720099
           05  PV-NBR-OF-STORES           PIC S9(4)   VALUE 0 COMP.     03730099
1102RM*JAK 05  PV-NBR-OF-SIGNS            PIC S9(4)   VALUE 0 COMP.     03740099
           05  PV-RETRY-COUNT             PIC S9(03)  VALUE 0 COMP.     03750099
           05  PV-STR-NAME10.                                           03760096
               10  PV-STR-NAME1-5         PIC X(05).                    03770096
               10  FILLER                 PIC X(05).                    03780096
      *JAK 05  PV-ORIG-OPENED-DATE        PIC X(10).                    03790099
      *JAK 05  PV-ORIG-CLOSED-DATE        PIC X(10).                    03800099
           05  PV-CURRENT-DATE.                                         03810096
               10  PV-CURRENT-DATE-CCYY   PIC X(04).                    03820096
               10  FILLER                 PIC X(01)  VALUE '-'.         03830096
               10  PV-CURRENT-DATE-MM     PIC X(02).                    03840096
               10  FILLER                 PIC X(01)  VALUE '-'.         03850096
               10  PV-CURRENT-DATE-DD     PIC X(02).                    03860096
      *JAK 05  PV-STR-OPEN-DT-ISO         PIC X(10)   VALUE SPACES.     03870099
      *JAK 05  PV-STR-MKT-BEG-DTE-ISO     PIC X(10)   VALUE SPACES.     03880099
      *JAK 05  PV-STR-CLOSE-DT-ISO        PIC X(10)   VALUE SPACES.     03890099
      *JAK 05  PV-BEG-DT-ISO-KEY          PIC X(10)   VALUE SPACES.     03900099
           05  PV-KEY-NBR                 PIC X(04).                    03910096
           05  PV-KEY-NBR-ALPHA1 REDEFINES PV-KEY-NBR.                  03920096
               10  PV-KEY-NBR-1-2         PIC X(02).                    03930096
               10  PV-KEY-NBR-3-4         PIC X(02).                    03940096
           05  PV-KEY-NBR-ALPHA2 REDEFINES PV-KEY-NBR.                  03950096
               10  PV-KEY-NBR-1           PIC X(01).                    03960096
               10  PV-KEY-NBR-2-4         PIC X(03).                    03970096
0504RM*** WR27051                                                       03980099
0504RM     05  PV-KEY-NBR-9   REDEFINES PV-KEY-NBR PIC 9(04).           03990099
           05  PV-KEY-NBR-NUM             PIC S9(04) COMP VALUE +0.     04000096
           05  PV-FCLTY-SHT-NAME.                                       04010096
               10  PV-FCLTY-SHT-NAME-1-2  PIC X(02) VALUE SPACES.       04020096
               10  PV-FCLTY-SHT-NAME-3-4  PIC X(02) VALUE SPACES.       04030096
           05  PV-4-BYTE-IN-FLD           PIC X(04).                    04040096
           05  PV-4-BYTE-IN-FLD-RDF REDEFINES PV-4-BYTE-IN-FLD.         04050096
               10  PV-4-BYTE-IN-FLD-1-2   PIC X(02).                    04060096
               10  PV-4-BYTE-IN-FLD-3-4   PIC X(02).                    04070096
           05  PV-4-BYTE-IN-FLD-RDF2 REDEFINES PV-4-BYTE-IN-FLD.        04080096
               10  PV-4-BYTE-IN-FLD-1     PIC X(01).                    04090096
               10  PV-4-BYTE-IN-FLD-2-4   PIC X(03).                    04100096
           05  PV-FCLTY-ID                PIC S9(04) COMP VALUE +1.     04110096
           05  PV-CHAR5.                                                04120096
               10  FILLER                 PIC X(03)   VALUE SPACES.     04130096
               10  PV-CHAR5-4-5           PIC X(02)   VALUE SPACES.     04140096
           05  PV-SQL-SUB                 PIC 9(04)   VALUE 0.          04150096
           05  PV-DAYS                    PIC 9(05)   VALUE 0.          04160096
           05  PV-999                     PIC S9(03)  VALUE 0 COMP-3.   04170096
           05  PV-SUBSCRIPT-NMBR          PIC S9(03)  VALUE 0 COMP-3.   04180096
           05  PV-DATE-DEC-DAYS           PIC X(10).                    04190096
           05  PV-START-DATE              PIC X(10).                    04200096
           05  PV-EFF-DATE                PIC X(10).                    04210096
           05  PV-PHONE-NBR.                                            04220096
               10  FILLER                 PIC X(09).                    04230096
               10  PV-PHONE-NBR10-20      PIC 9(11).                    04240096
           05  PV-ZIP-CODE.                                             04250096
               10  PV-ZIP-CODE1-9         PIC 9(09).                    04260096
               10  FILLER                 PIC X(11).                    04270096
      *JAK 05  PV-ADMRKT-ID.                                            04280099
      *JAK     10  PV-ADMRKT-ID-1         PIC X(01).                    04290099
      *JAK     10  PV-ADMRKT-ID-2-3       PIC X(02).                    04300099
           05  PV-MESSAGE                 PIC X(50).                    04310096
           05  PV-ERROR-MESSAGE           PIC X(48) VALUE SPACES.       04320096
                                                                        04330096
       01  PV-MQ-VARIABLES.                                             04340096
           05  PV-QM-NAME              PIC X(48).                       04350096
           05  PV-PARAGRAPH            PIC X(50).                       04360096
           05  PV-MSGBUFFER            PIC X(500) VALUE SPACES.         04370096
           05  PV-MSGLENGTH            PIC S9(9)  BINARY VALUE +500.    04380096
           05  PV-DATA-LENGTH          PIC S9(9)  BINARY.               04390096
           05  PV-SELECT-COUNT         PIC S9(9)  BINARY VALUE 1.       04400096
           05  PV-SELECTOR-TABLE.                                       04410096
               10  PV-SELECTOR         PIC S9(9)  BINARY OCCURS 1 TIMES.04420096
           05  PV-INT-ATTR-COUNT       PIC S9(9)  BINARY VALUE 0.       04430096
           05  PV-INT-ATTR-TABLE.                                       04440096
               10  PV-INT-ATTR         PIC S9(9)  BINARY OCCURS 1 TIMES.04450096
           05  PV-CHAR-ATTR-LENGTH     PIC S9(9)  BINARY VALUE 48.      04460096
           05  PV-CHAR-ATTRS           PIC X(48).                       04470096
           05  PV-HCONN                PIC S9(9)  BINARY VALUE 0.       04480096
           05  PV-GQ-HANDLE            PIC S9(9)  BINARY VALUE 0.       04490096
           05  PV-OPEN-OPTIONS         PIC S9(9)  BINARY.               04500096
           05  PV-COMPLETION-CODE      PIC S9(9)  BINARY.               04510096
           05  PV-REASON               PIC S9(9)  BINARY.               04520096
           05  PV-CON-REASON           PIC S9(9)  BINARY.               04530096
           05  PV-ISP-QMGR-NAME        PIC X(08).                       04540096
                                                                        04550096
       01  PV-INPUT-NUMBER-IN.                                          04560096
           05  PV-INPUT-NBR-TBL         OCCURS 20 TIMES                 04570096
                   INDEXED BY IN-IDX.                                   04580096
               10  PV-INPUT-DIGIT-IN    PIC X(01).                      04590096
       01  PV-OUTPUT-NUMBER-OUT.                                        04600096
           05  PV-OUTPUT-NBR-TBL        OCCURS 20 TIMES                 04610096
                   INDEXED BY OUT-IDX.                                  04620096
               10  PV-OUTPUT-DIGIT-OUT  PIC X(01).                      04630096
                                                                        04640096
                                                                        04650096
       01  PV-INIT-TSTR000.                                             04660096
           10 PV-INIT-OP-CO-NMBR         PIC X(02)  VALUE '03'.         04670096
           10 PV-INIT-STORE-NMBR         PIC X(03)  VALUE LOW-VALUES.   04680096
           10 PV-INIT-TYPE-CODE          PIC X(02)  VALUE LOW-VALUES.   04690096
           10 PV-INIT-TWO-DIGIT-NMBR     PIC X(02)  VALUE LOW-VALUES.   04700096
           10 PV-INIT-STORE-NAME         PIC X(25)  VALUE LOW-VALUES.   04710096
           10 PV-INIT-CHAR10-ABBR-NAME   PIC X(10)  VALUE LOW-VALUES.   04720096
           10 PV-INIT-CHAR5-ABBR-NAME    PIC X(05)  VALUE LOW-VALUES.   04730096
           10 PV-INIT-MAIL-ADDR-ONE-DESC PIC X(25)  VALUE LOW-VALUES.   04740096
           10 PV-INIT-MAIL-ADDR-TWO-DESC PIC X(25)  VALUE LOW-VALUES.   04750096
           10 PV-INIT-CITY-NAME          PIC X(15)  VALUE LOW-VALUES.   04760096
           10 PV-INIT-STATE-CODE         PIC X(02)  VALUE LOW-VALUES.   04770096
           10 PV-INIT-ZIP-PLUS4-CODE     PIC S9(09)V COMP-3             04780096
                                                    VALUE +0.           04790096
           10 PV-INIT-PHONE-NMBR         PIC S9(11)V COMP-3             04800096
                                                    VALUE +0.           04810096
           10 PV-INIT-TOLLFREE-PHNE-NMBR PIC S9(11)V COMP-3             04820096
                                                     VALUE +0.          04830096
           10 PV-INIT-OPENED-DATE        PIC X(10)  VALUE '9999-09-09'. 04840096
           10 PV-INIT-CLOSED-DATE        PIC X(10)  VALUE '9999-09-09'. 04850096
           10 PV-INIT-SELLING-SQFT-NMBR  PIC S9(07)V COMP-3             04860096
                                                    VALUE +0.           04870096
           10 PV-INIT-FINANCE-CORP-NMBR  PIC X(02)  VALUE '01'.         04880096
           10 PV-INIT-DISTRICT-NMBR      PIC X(02)  VALUE LOW-VALUES.   04890096
           10 PV-INIT-MGR-NAME           PIC X(25)  VALUE LOW-VALUES.   04900096
           10 PV-INIT-DC-CODE            PIC X(03)  VALUE LOW-VALUES.   04910096
           10 PV-INIT-DC1-NMBR           PIC X(03)  VALUE LOW-VALUES.   04920096
           10 PV-INIT-DC1-PO-START-DATE  PIC X(10)  VALUE '9999-09-09'. 04930096
           10 PV-INIT-DC1-PO-STOP-DATE   PIC X(10)  VALUE '9999-09-09'. 04940096
           10 PV-INIT-DC1-RCT-START-DATE PIC X(10)  VALUE '9999-09-09'. 04950096
           10 PV-INIT-DC1-RCT-STOP-DATE  PIC X(10)  VALUE '9999-09-09'. 04960096
           10 PV-INIT-DC2-NMBR           PIC X(03)  VALUE LOW-VALUES.   04970096
           10 PV-INIT-DC2-PO-START-DATE  PIC X(10)  VALUE '9999-09-09'. 04980096
           10 PV-INIT-DC2-PO-STOP-DATE   PIC X(10)  VALUE '9999-09-09'. 04990096
           10 PV-INIT-DC2-RCT-START-DATE PIC X(10)  VALUE '9999-09-09'. 05000096
           10 PV-INIT-DC2-RCT-STOP-DATE  PIC X(10)  VALUE '9999-09-09'. 05010096
           10 PV-INIT-DSCVR-MERCH-NMBR   PIC S9(15)V COMP-3             05020096
                                                    VALUE +0.           05030096
           10 PV-INIT-BNKCD-MERCH-NMBR   PIC S9(07)V COMP-3             05040096
                                                    VALUE +0.           05050096
           10 PV-INIT-SUBSCRIPT-NMBR     PIC S9(03)V COMP-3             05060096
                                                    VALUE +0.           05070096
           10 PV-INIT-AMLOAD-INDCT       PIC X(01)  VALUE 'N'.          05080096
           10 PV-INIT-CK-AUTH-GRP-NMBR   PIC S9(02)V COMP-3             05090096
                                                    VALUE +0.           05100096
           10 PV-INIT-PLU-SYSTEM-CODE    PIC X(01)  VALUE 'S'.          05110096
           10 PV-INIT-FIN-CLS-DTE        PIC X(10)  VALUE '9999-09-09'. 05120096
           10 PV-INIT-CASH-RET-AUTH-NBR  PIC S9(02)V COMP-3             05130096
                                                    VALUE +0.           05140096
           10 PV-INIT-YR-SLS-INCL-DTE    PIC X(10)  VALUE '9999-09-09'. 05150096
           10 PV-INIT-MO-SLS-INCL-DTE    PIC X(10)  VALUE '9999-09-09'. 05160096
           10 PV-INIT-REPL-STORE-NBR     PIC X(03)  VALUE LOW-VALUES.   05170096
           10 PV-INIT-MFST-NBR           PIC S9(09) COMP                05180096
                                                    VALUE +0.           05190096
           10 PV-INIT-POS-CAP-LVL        PIC S9(04) COMP                05200096
                                                    VALUE +0.           05210096
           10 PV-INIT-PERM-RLSE-AVL-NBR  PIC S9(04) COMP                05220096
                                                    VALUE +0.           05230096
           10 PV-INIT-CENPPC-CRE-IND     PIC X(01)  VALUE 'Y'.          05240096
           10 PV-INIT-RF-BEG-IP-ADR      PIC X(15)  VALUE LOW-VALUES.   05250096
           10 PV-INIT-RF-END-IP-ADR      PIC X(15)  VALUE LOW-VALUES.   05260096
           10 PV-INIT-STR-NBR            PIC S9(04) COMP                05270096
                                                    VALUE +0.           05280096
           10 PV-INIT-MET-NBR            PIC S9(04) COMP                05290096
                                                    VALUE +0.           05300096
           10 PV-INIT-LAST-CHG-DTE       PIC X(10)  VALUE '9999-09-09'. 05310096
           10 PV-INIT-QTR-SLS-INCL-DTE   PIC X(10)  VALUE '9999-09-09'. 05320096
           10 PV-INIT-SEA-SLS-INCL-DTE   PIC X(10)  VALUE '9999-09-09'. 05330096
           10 PV-INIT-STR-CMPR-DTE-CDE   PIC X(01)  VALUE SPACE.        05340096
           10 PV-INIT-AMEX-MERCH-NBR     PIC S9(10)V COMP-3             05350096
                                                    VALUE +0.           05360096
           10 PV-INIT-SGN-PRT-LOC-ID     PIC S9(04) COMP                05370096
0901RM*                                             VALUE +0.           05380096
0901RM                                              VALUE +99.          05390096
           10 PV-INIT-SGN-PRT-GRP-ID     PIC S9(04) COMP                05400096
0901RM*                                             VALUE +0.           05410096
0901RM                                              VALUE +99.          05420096
           10 PV-INIT-OCPNC-DTE          PIC X(10)  VALUE '9999-09-09'. 05430096
           10 PV-INIT-LBR-SFWR-LVL-ID    PIC S9(04) COMP                05440096
                                                    VALUE +0.           05450096
           10 PV-INIT-EST-HH-INCM-AMT    PIC S9(07)V99 COMP-3           05460096
                                                    VALUE +0.           05470096
           10 PV-INIT-MEDN-AGE-NBR       PIC S9(02)V99 COMP-3           05480096
                                                    VALUE +0.           05490096
           10 PV-INIT-CNTY-ID            PIC S9(04) COMP                05500096
                                                    VALUE +0.           05510096
           10 PV-INIT-LCLTY-ID           PIC S9(04) COMP                05520096
                                                    VALUE +0.           05530096
           10 PV-INIT-STD-TM-ZN-CDE      PIC X(03)  VALUE LOW-VALUES.   05540096
           10 PV-INIT-DST-CDE            PIC X(01)  VALUE 'N'.          05550096
           10 PV-INIT-E-BUS-LOC-IND      PIC X(01)  VALUE 'N'.          05560096
                                                                        05570096
       01  PH-PROGRAM-HOLD-VARIABLES.                                   05580096
           05  PH-COMPLETION-CODE          PIC  S9(09) BINARY.          05590096
           05  PH-REASON                   PIC  S9(09) BINARY.          05600096
                                                                        05610096
      ***************************************************************** 05620096
      *  RMS TO DB2 MQ SERIES COPYBOOK                                  05630096
      ***************************************************************** 05640096
           COPY HORD100.                                                05650096
                                                                        05660096
      ***************************************************************** 05670096
      *  WORK AREA PASSED TO/FROM DPKUT500                            * 05680096
      ***************************************************************** 05690096
           COPY DPWS500.                                                05700096
                                                                        05710096
      *----------------------------------------------------------------*05720096
      *    ABEND CODES THE ARE APPLICATION DEFINED                      05730096
      *----------------------------------------------------------------*05740096
       01  ABEND-CODE                  PIC S9(4)    VALUE ZEROS         05750096
                                                    COMP SYNC.          05760096
           88  AC-TABLE-OVERFLOW-ERROR              VALUE +4004.        05770096
           88  AC-DB2-ERROR                         VALUE +4013.        05780096
           88  AC-MQ-ERROR                          VALUE +4020.        05790096
                                                                        05800096
      * ------------------------------------------------------------- * 05810096
      *  COMMUNICATION AREAS FOR DB2                                    05820096
      * ------------------------------------------------------------- * 05830096
           EXEC SQL                                                     05840096
               INCLUDE SQLCA                                            05850096
           END-EXEC.                                                    05860096
                                                                        05870096
      * ------------------------------------------------------------- * 05880096
      *  ERROR MESSAGE AREA FOR DB2                                   * 05890096
      * ------------------------------------------------------------- * 05900096
           COPY DPWS004.                                                05910096
                                                                        05920096
      * ------------------------------------------------------------- * 05930096
      *  SQL AND COBOL DECLARATIONS FOR THE STORE TABLE (TSTR000)       05940096
                                                                        05950096
           EXEC SQL                                                     05960099
               INCLUDE TSTR000                                          05970099
           END-EXEC.                                                    05980099
                                                                        05990096
      *  SQL AND COBOL DECLARATIONS FOR TERRITORY TABLE (TTER000)       06000096
                                                                        06010096
      *JAK EXEC SQL                                                     06020099
      *JAK     INCLUDE TTER000                                          06030099
      *JAK END-EXEC.                                                    06040099
                                                                        06050096
      *  SQL AND COBOL DECLARATIONS FOR THE DISTRICT TABLE (TDST000)    06060096
                                                                        06070096
           EXEC SQL                                                     06080096
               INCLUDE TDST000                                          06090096
           END-EXEC.                                                    06100096
                                                                        06110096
      *  SQL AND COBOL DECLARATIONS FOR THE REGION TABLE (TRGN000)      06120096
                                                                        06130096
      *JAK EXEC SQL                                                     06140099
      *JAK     INCLUDE TRGN000                                          06150099
      *JAK END-EXEC.                                                    06160099
                                                                        06170096
                                                                        06180096
      *  SQL AND COBOL DECLARATIONS FOR THE FACILITY TABLE (TFACLTY)    06190096
                                                                        06200096
           EXEC SQL                                                     06210096
               INCLUDE TFACLTY                                          06220096
           END-EXEC.                                                    06230096
                                                                        06240096
      *  SQL AND COBOL DECLARATIONS FOR THE MANIFEST TABLE (TDCSTMF)    06250096
                                                                        06260096
           EXEC SQL                                                     06270096
               INCLUDE TDCSTMF                                          06280096
           END-EXEC.                                                    06290096
                                                                        06300096
      *  SQL AND COBOL DECLARATIONS FOR THE METRO TABLE (TMETARA)       06310096
                                                                        06320096
      *JAK EXEC SQL                                                     06330099
      *JAK     INCLUDE TMETARA                                          06340099
      *JAK END-EXEC.                                                    06350099
                                                                        06360096
      *  SQL AND COBOL DECLARATIONS FOR THE CLIMATE TABLE (TCLIMAT)     06370096
                                                                        06380096
      *JAK EXEC SQL                                                     06390099
      *JAK     INCLUDE TCLIMAT                                          06400099
      *JAK END-EXEC.                                                    06410099
                                                                        06420096
      *  SQL AND COBOL DECLARATIONS FOR THE STORE AD MRKT TBL (TSTRMKT) 06430096
                                                                        06440096
      *JAK EXEC SQL                                                     06450099
      *JAK     INCLUDE TSTRMKT                                          06460099
      *JAK END-EXEC.                                                    06470099
                                                                        06480096
      *  SQL AND COBOL DECLARATIONS FOR THE AD MRKT TBL (TADRMKT)       06490096
                                                                        06500096
      *JAK EXEC SQL                                                     06510099
      *JAK     INCLUDE TADMRKT                                          06520099
      *JAK END-EXEC.                                                    06530099
                                                                        06540096
      *  SQL AND COBOL DECLARATIONS FOR TPMADLC                         06550096
                                                                        06560096
      *JAK EXEC SQL                                                     06570099
      *JAK     INCLUDE TPMADLC                                          06580099
      *JAK END-EXEC.                                                    06590099
                                                                        06600096
      *  SQL AND COBOL DECLARATIONS FOR TPMMELC                         06610096
                                                                        06620096
      *JAK EXEC SQL                                                     06630099
      *JAK     INCLUDE TPMMELC                                          06640099
      *JAK END-EXEC.                                                    06650099
                                                                        06660096
      *  SQL AND COBOL DECLARATIONS FOR TPMITPR                         06670096
                                                                        06680096
      *JAK EXEC SQL                                                     06690099
      *JAK     INCLUDE TPMITPR                                          06700099
      *JAK END-EXEC.                                                    06710099
                                                                        06720096
      *  SQL AND COBOL DECLARATIONS FOR TMITGPL                         06730096
                                                                        06740096
           EXEC SQL                                                     06750096
               INCLUDE TMITGPL                                          06760096
           END-EXEC.                                                    06770096
                                                                        06780096
1102RM*  SQL AND COBOL DECLARATIONS FOR THE SIT_SGN_MKT_RLT TABLE       06790099
1102RM                                                                  06800099
1102RM*JAK EXEC SQL                                                     06810099
1102RM*JAK     INCLUDE SIT00008                                         06820099
1102RM*JAK END-EXEC.                                                    06830099
                                                                        06840099
                                                                        06850096
      * ------------------------------------------------------------- * 06860096
       PROCEDURE DIVISION.                                              06870096
      * ------------------------------------------------------------- * 06880096
       0000-HOKUP001.                                                   06890096
                                                                        06900096
           PERFORM 1000-INITIALIZE.                                     06910096
                                                                        06920096
           IF PS-CONTROL-CARD-1-END                                     06930096
               CONTINUE                                                 06940096
           ELSE                                                         06950096
               PERFORM 2000-PROCESS-MESSAGES UNTIL                      06960096
                     NOT PS-MQGET-SUCCESSFUL                            06970096
           END-IF.                                                      06980096
                                                                        06990096
           PERFORM 2400-EOJ-PROCESSING.                                 07000096
           STOP RUN.                                                    07010096
                                                                        07020096
      *----------------------------------------------------------------*07030096
      *  INITIALIZATION ROUTINE.                                        07040096
      *----------------------------------------------------------------*07050096
       1000-INITIALIZE.                                                 07060096
                                                                        07070096
           SET PS-CONTROL-CARD-1-START TO TRUE.                         07080096
           OPEN INPUT CONTROL-CARD-1                                    07090096
                      CONTROL-CARD-2.                                   07100096
           OPEN OUTPUT AUDIT-FILE                                       07110096
                       ERROR-FILE.                                      07120096
                                                                        07130096
           MOVE FUNCTION CURRENT-DATE (1:4) TO PV-CURRENT-DATE-CCYY.    07140096
           MOVE FUNCTION CURRENT-DATE (5:2) TO PV-CURRENT-DATE-MM.      07150096
           MOVE FUNCTION CURRENT-DATE (7:2) TO PV-CURRENT-DATE-DD.      07160096
           DISPLAY 'CURRENT DATE IS =====> ' PV-CURRENT-DATE.           07170096
                                                                        07180096
           PERFORM 8000-READ-CONTROL-CARD1.                             07190096
                                                                        07200096
           IF PS-CONTROL-CARD-1-END                                     07210096
               DISPLAY PC-PGM-NAME                                      07220096
                    'CONTROL CARD MISSING - FOR QMGR NAME'              07230096
            ELSE                                                        07240096
                DISPLAY PC-PGM-NAME                                     07250096
                        '- '                                            07260096
                        PC-FIFTY-STARS                                  07270096
                DISPLAY PC-PGM-NAME                                     07280096
                        '- CONTROL CARD: '                              07290096
                        CC-CONTROL-CARD-1                               07300096
            END-IF.                                                     07310096
                                                                        07320096
            CLOSE CONTROL-CARD-1.                                       07330096
                                                                        07340096
            PERFORM 8010-READ-CONTROL-CARD2.                            07350096
            IF PS-CONTROL-CARD-2-END                                    07360096
                DISPLAY PC-PGM-NAME                                     07370096
                   'CONTROL CARD MISSING - RMS TO DB2 QUEUE NAME'       07380096
            ELSE                                                        07390096
                DISPLAY PC-PGM-NAME                                     07400096
                        '- '                                            07410096
                        PC-FIFTY-STARS                                  07420096
                DISPLAY PC-PGM-NAME                                     07430096
                        '- CONTROL CARD: '                              07440096
                        CC-CONTROL-CARD-2                               07450096
           END-IF.                                                      07460096
                                                                        07470096
           CLOSE CONTROL-CARD-2.                                        07480096
           IF PS-CONTROL-CARD-1-END                                     07490096
               CONTINUE                                                 07500096
           ELSE                                                         07510096
               PERFORM 1500-MQ-SETUP                                    07520096
               PERFORM 8200-MQGET-MSG                                   07530096
           END-IF.                                                      07540096
                                                                        07550096
                                                                        07560096
                                                                        07570096
      * ------------------------------------------------------------- * 07580096
      *  SETUP MQ VALUES                                                07590096
      * ------------------------------------------------------------- * 07600096
                                                                        07610096
       1500-MQ-SETUP.                                                   07620096
      *    CONNECT TO THE QUEUE MANAGER                                 07630096
                                                                        07640096
           MOVE CC-QMGR-NAME TO PV-QM-NAME.                             07650096
           CALL WS-MQCONN USING PV-QM-NAME                              07660096
                               PV-HCONN                                 07670096
                               PV-COMPLETION-CODE                       07680096
                               PV-REASON.                               07690096
                                                                        07700096
      *    IF CONNECTION FAILED THEN DISPLAY ERROR MESSAGE              07710096
      *    AND EXIT                                                     07720096
                                                                        07730096
           MOVE PV-REASON TO PV-CON-REASON.                             07740096
           IF (PV-COMPLETION-CODE NOT = MQCC-OK) THEN                   07750096
              MOVE 'MQCONN ERROR'   TO PV-ERROR-MESSAGE                 07760096
              PERFORM 9000-DISPLAY-MQ-ERROR                             07770096
           END-IF.                                                      07780096
           DISPLAY 'MQCONN SUCCESSFUL TO ', PV-QM-NAME.                 07790096
                                                                        07800096
      *    OPEN THE RMS ORG HIERCHARCY QUEUE FOR INPUT                  07810096
                                                                        07820096
           COMPUTE PV-OPEN-OPTIONS = MQOO-INPUT-SHARED +                07830096
                                     MQOO-FAIL-IF-QUIESCING.            07840096
           MOVE MQOT-Q                   TO MQOD-OBJECTTYPE.            07850096
           MOVE CC-ORG-HIERARCHY-QNAME   TO MQOD-OBJECTNAME.            07860096
           MOVE PV-QM-NAME               TO MQOD-OBJECTQMGRNAME.        07870096
      *                                                                 07880096
           CALL WS-MQOPEN USING PV-HCONN                                07890096
                               MQM-OBJECT-DESCRIPTOR                    07900096
                               PV-OPEN-OPTIONS                          07910096
                               PV-GQ-HANDLE                             07920096
                               PV-COMPLETION-CODE                       07930096
                               PV-REASON.                               07940096
      *                                                                 07950096
      *    IF OPEN FAILED THEN DISPLAY ERROR MESSAGE                    07960096
      *    AND EXIT.                                                    07970096
      *                                                                 07980096
           IF (PV-COMPLETION-CODE NOT = MQCC-OK) THEN                   07990096
              MOVE 'MQOPEN ERROR'   TO PV-ERROR-MESSAGE                 08000096
              PERFORM 1700-DISCONNECT-QMGR                              08010096
              PERFORM 9000-DISPLAY-MQ-ERROR                             08020096
           END-IF.                                                      08030096
           DISPLAY 'MQOPEN SUCCESSFUL TO ' MQOD-OBJECTNAME.             08040096
                                                                        08050096
                                                                        08060096
      * ------------------------------------------------------------- * 08070096
      *  CLOSE MQ QUEUE                                                 08080096
      * ------------------------------------------------------------- * 08090096
                                                                        08100096
       1600-CLOSE-QUEUE.                                                08110096
                                                                        08120096
           CALL WS-MQCLOSE USING PV-HCONN                               08130096
                                 PV-GQ-HANDLE                           08140096
                                 MQCO-NONE                              08150096
                                 PV-COMPLETION-CODE                     08160096
                                 PV-REASON.                             08170096
           IF (PV-COMPLETION-CODE NOT = MQCC-OK) THEN                   08180096
              MOVE 'MQCLOSE ERROR' TO PV-ERROR-MESSAGE                  08190096
              PERFORM 9000-DISPLAY-MQ-ERROR                             08200096
           ELSE                                                         08210096
              DISPLAY 'MQCLOSE SUCCESSFUL'                              08220096
           END-IF.                                                      08230096
                                                                        08240096
                                                                        08250096
      * ------------------------------------------------------------- * 08260096
      *  DISCONNECT QUEUE MANAGER                                       08270096
      * ------------------------------------------------------------- * 08280096
                                                                        08290096
       1700-DISCONNECT-QMGR.                                            08300096
                                                                        08310096
           IF PV-CON-REASON IS NOT EQUAL TO MQRC-ALREADY-CONNECTED      08320096
              CALL WS-MQDISC USING PV-HCONN                             08330096
                                  PV-COMPLETION-CODE                    08340096
                                  PV-REASON                             08350096
              IF (PV-COMPLETION-CODE NOT = MQCC-OK) THEN                08360096
                 MOVE 'MQDISC ERROR'   TO PV-ERROR-MESSAGE              08370096
                 PERFORM 9000-DISPLAY-MQ-ERROR                          08380096
              ELSE                                                      08390096
                 DISPLAY 'MQDISC SUCCESSFUL'                            08400096
              END-IF                                                    08410096
           END-IF.                                                      08420096
                                                                        08430096
                                                                        08440096
      * ------------------------------------------------------------- * 08450096
      *  PROCESS MESSAGES                                               08460096
      * ------------------------------------------------------------- * 08470096
                                                                        08480096
       2000-PROCESS-MESSAGES.                                           08490096
                                                                        08500096
      * ------------------------------------------------------------- * 08510096
      * CHECK INPUT RECORD REPLACING THE '|' WITH ' '.                  08520096
      * CHECK INPUT RECORD REPLACING THE '_' WITH ' '.                  08530096
      * THE | AND _ ARE ILLEGAL IN THE DW SYSTEM.                       08540096
      * ------------------------------------------------------------- * 08550096
1001RM*    DISPLAY 'TABLE NAME ' HO100-RMS-TBL-NAME.                    08560096
           INSPECT HO100-STORE-DATA REPLACING ALL '|' BY ' '.           08570096
           INSPECT HO100-STORE-DATA REPLACING ALL '_' BY ' '.           08580096
                                                                        08590096
           PERFORM 9910-WRITE-AUDIT-RECORD.                             08600096
                                                                        08610096
           SET PS-NO-INPUT-REC-ERROR TO TRUE.                           08620096
                                                                        08630096
           EVALUATE TRUE                                                08640096
              WHEN HO100-RMS-TBL-NAME = PC-AREA-TABLE                   08650099
                 ADD 1 TO PA-MSGS-SKIPPED                               08650199
                 CONTINUE                                               08651099
      *JAK       PERFORM 3000-PROCESS-AREA-MESSAGES                     08660099
              WHEN HO100-RMS-TBL-NAME = PC-REGION-TABLE                 08670099
                 ADD 1 TO PA-MSGS-SKIPPED                               08670199
                 CONTINUE                                               08671099
      *JAK       PERFORM 4000-PROCESS-REGION-MESSAGES                   08680099
              WHEN HO100-RMS-TBL-NAME = PC-DISTRICT-TABLE               08690096
                 PERFORM 5000-PROCESS-DISTRICT-MESSAGES                 08700096
              WHEN HO100-RMS-TBL-NAME = PC-STORE-TABLE                  08710096
                 PERFORM 6000-PROCESS-STORE                             08720096
              WHEN HO100-RMS-TBL-NAME = PC-STORE-ATTRIBUTES-TABLE       08730096
                 PERFORM 6100-PROCESS-STORE-ATTRIB                      08740096
              WHEN HO100-RMS-TBL-NAME = PC-WH-TABLE                     08750096
                 PERFORM 6200-PROCESS-WH                                08760096
              WHEN HO100-RMS-TBL-NAME = PC-WH-ATTRIBUTES-TABLE          08770096
                 PERFORM 6300-PROCESS-WH-ATTRIB                         08780096
              WHEN HO100-RMS-TBL-NAME = PC-WH-STORE-ASSIGN              08790096
                 PERFORM 6400-PROCESS-WH-STR-ASSIGN                     08800096
              WHEN HO100-RMS-TBL-NAME = PC-OUTLOC-TABLE                 08810096
                 PERFORM 6500-PROCESS-OUTLOC                            08820096
              WHEN HO100-RMS-TBL-NAME = PC-PRICE-ZN-GRP-STR-TABLE       08830096
                 PERFORM 6600-PROCESS-PRICE-ZN-GRP-STR                  08840096
              WHEN HO100-RMS-TBL-NAME = PC-K-EMT-METRO-PRICE-ZONE       08850099
                 ADD 1 TO PA-MSGS-SKIPPED                               08850199
                 CONTINUE                                               08851099
      *JAK       PERFORM 6700-PROCESS-PRICE-METRO-PRICE                 08860099
              WHEN HO100-RMS-TBL-NAME = PC-PRICE-ZONE                   08870099
                 ADD 1 TO PA-MSGS-SKIPPED                               08870199
                 CONTINUE                                               08871099
      *JAK       PERFORM 6800-PROCESS-PRICE-ZONE                        08880099
              WHEN HO100-RMS-TBL-NAME = PC-K-EMT-PRICE-ZONE-DATE        08890099
                 ADD 1 TO PA-MSGS-SKIPPED                               08890199
                 CONTINUE                                               08891099
      *JAK       PERFORM 6850-PROCESS-PRICE-ZONE-DATE                   08900099
              WHEN OTHER                                                08910096
                   DISPLAY '@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@'            08920096
                   DISPLAY ' ERROR IN 2000-PROCESS-MESSAGES'            08930096
                   DISPLAY ' CANNOT PROCESS TABLE NAME     '            08940096
                             HO100-RMS-TBL-NAME                         08950096
                   DISPLAY '@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@'            08960096
                   PERFORM 9920-WRITE-ERROR-RECORD                      08970096
           END-EVALUATE.                                                08980096
                                                                        08990096
           IF PS-NO-INPUT-REC-ERROR                                     09000096
               PERFORM 8400-COMMIT-DB2                                  09010096
           ELSE                                                         09020096
               PERFORM 8410-ROLLBACK-DB2                                09030096
           END-IF.                                                      09040096
           PERFORM 8450-COMMIT-MQ.                                      09050096
           PERFORM 8200-MQGET-MSG.                                      09060096
                                                                        09070096
                                                                        09080096
       2400-EOJ-PROCESSING.                                             09090096
                                                                        09100096
                                                                        09110096
           DISPLAY '*-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-*'    09120096
           DISPLAY 'END OF JOB RECORD COUNTERS'.                        09130096
           DISPLAY 'SUCCESSFUL MQGETS     ' PA-MQGET.                   09140096
           DISPLAY 'AUDIT RECORDS         ' PA-AUDITS.                  09150096
           DISPLAY '*-%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%-*'.             09160096
           DISPLAY 'STORE-MESSAGES        ' PA-STORE-MESSAGES.          09170096
           DISPLAY 'STORE-INSERTS         ' PA-STORE-INSERTS.           09180096
           DISPLAY 'STORE-UPDATES         ' PA-STORE-UPDATES.           09190096
           DISPLAY 'STORE-DELETES         ' PA-STORE-DELETES.           09200096
           DISPLAY 'STORE-ERRORS          ' PA-STORE-ERRORS.            09210096
0504RM*** WR27051 - STORES EXPANSION - BYPASS WAREHOUSES > 999          09220099
0504RM     DISPLAY 'STORE-BYPASSED        ' PA-STORE-BYPASS.            09230099
           DISPLAY 'STORE-ATTRIB-MESGS    ' PA-STORE-ATTRIB-MESSAGES.   09240096
           DISPLAY 'STORE-ATTRIB-INSERTS  ' PA-STORE-ATTRIB-INSERTS.    09250096
           DISPLAY 'STORE-ATTRIB-UPDATES  ' PA-STORE-ATTRIB-UPDATES.    09260096
           DISPLAY 'STORE-ATTRIB-DELETES  ' PA-STORE-ATTRIB-DELETES.    09270096
           DISPLAY 'STORE-ATTRIB-ERRORS   ' PA-STORE-ATTRIB-ERRORS.     09280096
0504RM*** WR27051 - STORES EXPANSION - BYPASS WAREHOUSES > 999          09290099
0504RM     DISPLAY 'STORE-ATTRIB-BYPASSED ' PA-STRATTR-BYPASS.          09300099
           DISPLAY 'WH-MESSAGES           ' PA-WH-MESSAGES.             09310096
           DISPLAY 'WH-INSERTS            ' PA-WH-INSERTS.              09320096
           DISPLAY 'WH-UPDATES            ' PA-WH-UPDATES.              09330096
           DISPLAY 'WH-DELETES            ' PA-WH-DELETES.              09340096
           DISPLAY 'WH-ERRORS             ' PA-WH-ERRORS.               09350096
0504RM*** WR27051 - STORES EXPANSION - BYPASS WAREHOUSES > 999          09360099
0504RM     DISPLAY 'WS-BYPASSED           ' PA-WH-BYPASS.               09370099
           DISPLAY 'WH-ATTRIB-MESSAGES    ' PA-WH-ATTRIB-MESSAGES.      09380096
           DISPLAY 'WH-ATTRIB-INSERTS     ' PA-WH-ATTRIB-INSERTS.       09390096
           DISPLAY 'WH-ATTRIB-UPDATES     ' PA-WH-ATTRIB-UPDATES.       09400096
           DISPLAY 'WH-ATTRIB-DELETES     ' PA-WH-ATTRIB-DELETES.       09410096
           DISPLAY 'WH-ATTRIB-ERRORS      ' PA-WH-ATTRIB-ERRORS.        09420096
0504RM*** WR27051 - STORES EXPANSION - BYPASS WAREHOUSES > 999          09430099
0504RM     DISPLAY 'WH-ATTRIB-BYPASSED    ' PA-WHATTR-BYPASS.           09440099
           DISPLAY 'WH-STR-ASSIGN-MSGS    ' PA-WH-STR-ASSIGN-MESSAGES.  09450096
           DISPLAY 'WH-STR-ASSIGN-INSERTS ' PA-WH-STR-ASSIGN-INSERTS.   09460096
           DISPLAY 'WH-STR-ASSIGN-UPDATES ' PA-WH-STR-ASSIGN-UPDATES.   09470096
           DISPLAY 'WH-STR-ASSIGN-DELETES ' PA-WH-STR-ASSIGN-DELETES.   09480096
           DISPLAY 'WH-STR-ASSIGN-ERRORS  ' PA-WH-STR-ASSIGN-ERRORS.    09490096
0504RM*** WR27051 - STORES EXPANSION - BYPASS WAREHOUSES > 999          09500099
0504RM     DISPLAY 'WS-STR-ASSIGN-BYPASS  ' PA-WHSTASG-BYPASS.          09510099
      *JAK DISPLAY 'AREA-MESSAGES         ' PA-AREA-MESSAGES.           09520099
      *JAK DISPLAY 'AREA-INSERTS          ' PA-AREA-INSERTS.            09530099
      *JAK DISPLAY 'AREA-UPDATES          ' PA-AREA-UPDATES.            09540099
      *JAK DISPLAY 'AREA-DELETES          ' PA-AREA-DELETES.            09550099
      *JAK DISPLAY 'AREA-ERRORS           ' PA-AREA-ERRORS.             09560099
      *JAK DISPLAY 'REGION-MESSAGES       ' PA-REGION-MESSAGES.         09570099
      *JAK DISPLAY 'REGION-INSERTS        ' PA-REGION-INSERTS.          09580099
      *JAK DISPLAY 'REGION-UPDATES        ' PA-REGION-UPDATES.          09590099
      *JAK DISPLAY 'REGION-DELETES        ' PA-REGION-DELETES.          09600099
      *JAK DISPLAY 'REGION-ERRORS         ' PA-REGION-ERRORS.           09610099
           DISPLAY 'DISTRICT-MESSAGES     ' PA-DISTRICT-MESSAGES.       09620096
           DISPLAY 'DISTRICT-INSERTS      ' PA-DISTRICT-INSERTS.        09630096
           DISPLAY 'DISTRICT-UPDATES      ' PA-DISTRICT-UPDATES.        09640096
           DISPLAY 'DISTRICT-DELETES      ' PA-DISTRICT-DELETES.        09650096
           DISPLAY 'DISTRICT-ERRORS       ' PA-DISTRICT-ERRORS.         09660096
           DISPLAY 'OUTLOC-MESSAGES       ' PA-OUTLOC-MESSAGES.         09670096
           DISPLAY 'OUTLOC-INSERTS        ' PA-OUTLOC-INSERTS.          09680096
           DISPLAY 'OUTLOC-UPDATES        ' PA-OUTLOC-UPDATES.          09690096
           DISPLAY 'OUTLOC-DELETES        ' PA-OUTLOC-DELETES.          09700096
           DISPLAY 'OUTLOC-ERRORS         ' PA-OUTLOC-ERRORS.           09710096
0504RM*** WR27051 - STORES EXPANSION - BYPASS WAREHOUSES > 999          09720099
0504RM     DISPLAY 'OUTLOC-BYPASSED       ' PA-OUTLOC-BYPASS.           09730099
      *JAK DISPLAY 'MET-MSGS              ' PA-MET-MSGS.                09740099
      *JAK DISPLAY 'MET-INSERTS           ' PA-MET-INSERTS.             09750099
      *JAK DISPLAY 'MET-UPDATES           ' PA-MET-UPDATES.             09760099
      *JAK DISPLAY 'MET-DELETES           ' PA-MET-DELETES.             09770099
      *JAK DISPLAY 'MET-ERRORS            ' PA-MET-ERRORS.              09780099
      *JAK DISPLAY 'CLIMAT-MSGS           ' PA-CLIMAT-MSGS.             09790099
      *JAK DISPLAY 'CLIMAT-INSERTS        ' PA-CLIMAT-INSERTS.          09800099
      *JAK DISPLAY 'CLIMAT-UPDATES        ' PA-CLIMAT-UPDATES.          09810099
      *JAK DISPLAY 'CLIMAT-DELETES        ' PA-CLIMAT-DELETES.          09820099
      *JAK DISPLAY 'CLIMAT-ERRORS         ' PA-CLIMAT-ERRORS.           09830099
      *JAK DISPLAY 'ADMRKT-MSGS           ' PA-ADMRKT-MSGS.             09840099
      *JAK DISPLAY 'ADMRKT-UPDATES        ' PA-ADMRKT-UPDATES.          09850099
      *JAK DISPLAY 'ADMRKT-ERRORS         ' PA-ADMRKT-ERRORS.           09860099
           DISPLAY 'PZGS-MSGS             ' PA-PZGS-MSGS.               09870096
           DISPLAY 'PZGS-INSERTS          ' PA-PZGS-INSERTS.            09880096
           DISPLAY 'PZGS-UPDATES          ' PA-PZGS-UPDATES.            09890096
           DISPLAY 'PZGS-ERRORS           ' PA-PZGS-ERRORS.             09900096
0504RM*** WR27051 - STORES EXPANSION - BYPASS WAREHOUSES > 999          09910099
0504RM     DISPLAY 'PZGS-BYPASSED         ' PA-PZGS-BYPASS.             09920099
      *JAK DISPLAY 'PZGSSTRMKT-INSERTS    ' PA-PZGSS-INSERTS.           09930099
      *JAK DISPLAY 'PZGSSTRMKT-ERRORS     ' PA-PZGSS-ERRORS.            09940099
      *JAK DISPLAY 'PZGD-MSGS             ' PA-PZGD-MSGS.               09950099
      *JAK DISPLAY 'PZGD-ADMRKT-INSERTS   ' PA-PZGD-ADMRKT-INSERTS.     09960099
      *JAK DISPLAY 'PZGD-ADMRKT-UPDATES   ' PA-PZGD-ADMRKT-UPDATES.     09970099
      *JAK DISPLAY 'PZGD-ADMRKT-DELETES   ' PA-PZGD-ADMRKT-DELETES.     09980099
      *JAK DISPLAY 'PZGD-ERRORS           ' PA-PZGD-ERRORS.             09990099
           DISPLAY 'MSGS SKIPPED          ' PA-MSGS-SKIPPED.            09991099
                                                                        10000099
           DISPLAY 'RECORDS WITH ERRORS   ' PA-ERRORS.                  10010096
           DISPLAY '*-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-*'    10020096
           CLOSE AUDIT-FILE.                                            10030096
           CLOSE ERROR-FILE.                                            10040096
045400     PERFORM 1600-CLOSE-QUEUE.                                    10050096
045500     PERFORM 1700-DISCONNECT-QMGR.                                10060096
                                                                        10070096
      *-- THIS RETURN CODE WILL GENERATE AN EMAIL IN A SUBSEQUENT       10080096
      *-- STEP IN THE JOB                                               10090096
           IF PA-ERRORS > 0                                             10100096
               MOVE 4095 TO RETURN-CODE                                 10110096
           END-IF.                                                      10120096
                                                                        10130096
      * ------------------------------------------------------------- * 10140096
      * PROCESS THE AREA (TERRITORY) MESSAGES                           10150096
      * ------------------------------------------------------------- * 10160096
      *3000-PROCESS-AREA-MESSAGES.                                      10170099
      *                                                                 10180099
      *JAK ADD 1 TO PA-AREA-MESSAGES.                                   10190099
      *                                                                 10200099
      *JAK IF HO100-ACTN-TYP-INSERT                                     10210099
      *JAK     PERFORM 3010-INSERT-TERRITORY-DATA                       10220099
      *JAK     IF PS-INPUT-REC-ERROR                                    10230099
      *JAK         ADD 1 TO PA-AREA-ERRORS                              10240099
      *JAK     ELSE                                                     10250099
      *JAK         ADD 1 TO PA-AREA-INSERTS                             10260099
      *JAK ELSE                                                         10270099
      *JAK     MOVE HO100-AREA-AREA TO PV-KEY-NBR                       10280099
      *JAK     MOVE PV-KEY-NBR-3-4  TO TER000-TERR-NBR                  10290099
      *JAK     IF HO100-ACTN-TYP-UPDATE                                 10300099
      *JAK         PERFORM 3020-UPDATE-TERRITORY-DATA                   10310099
      *JAK         IF PS-INPUT-REC-ERROR                                10320099
      *JAK             ADD 1 TO PA-AREA-ERRORS                          10330099
      *JAK         ELSE                                                 10340099
      *JAK             ADD 1 TO PA-AREA-UPDATES                         10350099
      *JAK     ELSE                                                     10360099
      *JAK         IF HO100-ACTN-TYP-DELETE                             10370099
      *JAK             PERFORM 3030-DELETE-TERRITORY-ROW                10380099
      *JAK             IF PS-INPUT-REC-ERROR                            10390099
      *JAK                 ADD 1 TO PA-AREA-ERRORS                      10400099
      *JAK             ELSE                                             10410099
      *JAK                 ADD 1 TO PA-AREA-DELETES                     10420099
      *JAK             END-IF                                           10430099
      *JAK         END-IF                                               10440099
      *JAK     END-IF                                                   10450099
      *JAK END-IF.                                                      10460099
      * ------------------------------------------------------------- * 10470096
      * INSERT A NEW ROW IN THE TERRITORY TABLE WITH AREA DATA          10480096
      * ------------------------------------------------------------- * 10490096
      *3010-INSERT-TERRITORY-DATA.                                      10500099
      *                                                                 10510099
      *JAK MOVE HO100-AREA-AREA       TO PV-KEY-NBR.                    10520099
      *JAK MOVE PV-KEY-NBR-3-4        TO TER000-TERR-NBR.               10530099
      *JAK MOVE HO100-AREA-NAME       TO TER000-TERR-NM.                10540099
      *JAK MOVE HO100-AREA-MGR-NAME   TO TER000-MGR-NM.                 10550099
      *JAK PERFORM 7000-INSERT-TERRITORY-ROW.                           10560099
      *JAK                                                              10570099
      * ------------------------------------------------------------- * 10580096
      * UPDATE THE TERRITORY TABLE WITH AREA DAAT                       10590096
      * ------------------------------------------------------------- * 10600096
      *3020-UPDATE-TERRITORY-DATA.                                      10610099
      *                                                                 10620099
      *JAK MOVE HO100-AREA-NAME       TO TER000-TERR-NM.                10630099
      *JAK MOVE HO100-AREA-MGR-NAME   TO TER000-MGR-NM.                 10640099
      *JAK PERFORM 7010-UPDATE-TERRITORY-ROW.                           10650099
      *                                                                 10660099
      * ------------------------------------------------------------- * 10670096
      * DELETE THE TERRITORY ROW                                        10680096
      * ------------------------------------------------------------- * 10690096
      *3030-DELETE-TERRITORY-ROW.                                       10700099
      *                                                                 10710099
      *JAK MOVE HO100-AREA-AREA       TO PV-KEY-NBR.                    10720099
      *JAK MOVE PV-KEY-NBR-3-4        TO TER000-TERR-NBR.               10730099
      *JAK PERFORM 7020-DELETE-TERRITORY-ROW.                           10740099
      *JAK                                                              10750099
      * ------------------------------------------------------------- * 10760096
      * PROCESS THE REGION MESSAGES                                     10770096
      * ------------------------------------------------------------- * 10780096
      *4000-PROCESS-REGION-MESSAGES.                                    10790099
      *JAK ADD 1 TO PA-REGION-MESSAGES.                                 10800099
      *                                                                 10810099
      *JAK IF HO100-ACTN-TYP-INSERT                                     10820099
      *JAK     PERFORM 4010-INSERT-REGION-DATA                          10830099
      *JAK     IF PS-INPUT-REC-ERROR                                    10840099
      *JAK         ADD 1 TO PA-REGION-ERRORS                            10850099
      *JAK     ELSE                                                     10860099
      *JAK         ADD 1 TO PA-REGION-INSERTS                           10870099
      *JAK ELSE                                                         10880099
      *JAK     IF HO100-ACTN-TYP-UPDATE                                 10890099
      *JAK         MOVE HO100-REGION TO PV-KEY-NBR                      10900099
      *JAK         MOVE PV-KEY-NBR-3-4 TO RGN000-REGN-NBR               10910099
      *JAK         PERFORM 4020-UPDATE-REGION-DATA                      10920099
      *JAK         IF PS-INPUT-REC-ERROR                                10930099
      *JAK             ADD 1 TO PA-REGION-ERRORS                        10940099
      *JAK         ELSE                                                 10950099
      *JAK             ADD 1 TO PA-REGION-UPDATES                       10960099
      *JAK     ELSE                                                     10970099
      *JAK         IF HO100-ACTN-TYP-DELETE                             10980099
      *JAK             PERFORM 4030-DELETE-REGION-DATA                  10990099
      *JAK             IF PS-INPUT-REC-ERROR                            11000099
      *JAK                 ADD 1 TO PA-REGION-ERRORS                    11010099
      *JAK             ELSE                                             11020099
      *JAK                 ADD 1 TO PA-REGION-DELETES                   11030099
      *JAK             END-IF                                           11040099
      *JAK         END-IF                                               11050099
      *JAK     END-IF                                                   11060099
      *JAK END-IF.                                                      11070099
      * ------------------------------------------------------------- * 11080096
      * INSERT A NEW ROW IN THE REGION TABLE WITH AREA DATA             11090096
      * ------------------------------------------------------------- * 11100096
      *4010-INSERT-REGION-DATA.                                         11110099
      *                                                                 11120099
      *JAK MOVE HO100-REGION            TO  PV-KEY-NBR.                 11130099
      *JAK MOVE PV-KEY-NBR-3-4          TO  RGN000-REGN-NBR.            11140099
      *JAK MOVE HO100-REGION-AREA-NAME  TO  RGN000-REGN-NM.             11150099
      *JAK MOVE HO100-REGION-MGR-NAME   TO  RGN000-MGR-NM.              11160099
      *JAK MOVE HO100-REGION-AREA       TO  PV-KEY-NBR.                 11170099
      *JAK MOVE PV-KEY-NBR-3-4          TO  RGN000-TERR-NBR.            11180099
      *JAK PERFORM 7200-INSERT-REGION-ROW.                              11190099
      * ------------------------------------------------------------- * 11200096
      * UPDATE THE REGION TABLE WITH AREA DATA                          11210096
      * ------------------------------------------------------------- * 11220096
      *4020-UPDATE-REGION-DATA.                                         11230099
      *                                                                 11240099
      *JAK MOVE HO100-REGION-AREA-NAME  TO  RGN000-REGN-NM.             11250099
      *JAK MOVE HO100-REGION-MGR-NAME   TO  RGN000-MGR-NM.              11260099
      *JAK MOVE HO100-REGION-AREA       TO  PV-KEY-NBR.                 11270099
      *JAK MOVE PV-KEY-NBR-3-4          TO  RGN000-TERR-NBR.            11280099
      *JAK MOVE HO100-REGION            TO  PV-KEY-NBR.                 11290099
      *JAK MOVE PV-KEY-NBR-3-4          TO  RGN000-REGN-NBR.            11300099
      *JAK PERFORM 7210-UPDATE-REGION-ROW.                              11310099
      *                                                                 11320099
      * ------------------------------------------------------------- * 11330096
      * DELETE THE REGION DATA                                          11340096
      * ------------------------------------------------------------- * 11350096
      *4030-DELETE-REGION-DATA.                                         11360099
      *                                                                 11370099
      *JAK MOVE HO100-REGION            TO  PV-KEY-NBR.                 11380099
      *JAK MOVE PV-KEY-NBR-3-4          TO  RGN000-REGN-NBR.            11390099
      *JAK PERFORM 7220-DELETE-REGION-ROW.                              11400099
                                                                        11410096
      * ------------------------------------------------------------- * 11420096
      * PROCESS THE DISTRICT MESSAGES                                   11430096
      * ------------------------------------------------------------- * 11440096
       5000-PROCESS-DISTRICT-MESSAGES.                                  11450096
                                                                        11460096
           ADD 1 TO PA-DISTRICT-MESSAGES                                11470096
           MOVE HO100-DISTRICT           TO PV-KEY-NBR.                 11480096
           MOVE PV-KEY-NBR-3-4           TO TDST000-DISTRICT-NMBR.      11490096
           MOVE HO100-DISTRICT-REGION    TO PV-4-BYTE-IN-FLD.           11500096
           MOVE PV-4-BYTE-IN-FLD-3-4     TO TDST000-REGN-NBR.           11510096
           MOVE HO100-DISTRICT-AREA-NAME TO TDST000-DISTRICT-NAME.      11520096
           MOVE HO100-DISTRICT-MGR-NAME  TO TDST000-MGR-NAME.           11530096
                                                                        11540096
           IF HO100-ACTN-TYP-INSERT                                     11550096
               PERFORM 7410-INSERT-DISTRICT-ROW                         11560096
               IF PS-INPUT-REC-ERROR                                    11570096
                   ADD 1 TO PA-DISTRICT-ERRORS                          11580096
               ELSE                                                     11590096
                   ADD 1 TO PA-DISTRICT-INSERTS                         11600096
           ELSE                                                         11610096
               IF HO100-ACTN-TYP-UPDATE                                 11620096
                   PERFORM 7400-UPDATE-DISTRICT-ROW                     11630096
                   IF PS-INPUT-REC-ERROR                                11640096
                       ADD 1 TO PA-DISTRICT-ERRORS                      11650096
                   ELSE                                                 11660096
                       ADD 1 TO PA-DISTRICT-UPDATES                     11670096
               ELSE                                                     11680096
                   IF HO100-ACTN-TYP-DELETE                             11690096
                       PERFORM 7420-DELETE-DISTRICT-ROW                 11700096
                       IF PS-INPUT-REC-ERROR                            11710096
                           ADD 1 TO PA-DISTRICT-ERRORS                  11720096
                       ELSE                                             11730096
                           ADD 1 TO PA-DISTRICT-DELETES                 11740096
                       END-IF                                           11750096
                   END-IF                                               11760096
               END-IF                                                   11770096
           END-IF.                                                      11780096
                                                                        11790096
      * ------------------------------------------------------------- * 11800096
      * PROCESS THE STORE TABLE MESSAGES                              * 11810096
      * - ONLY IF THE INPUT RECORD IS FROM THE RMS STORE TABLE WILL   * 11820096
      * - IT BE AN ACTUAL INSERT.  THE STORE ROW MUST BE ON RMS FIRST * 11830096
      * - BEFORE ANY OTHER STORE-TABLE RELATED ENTRIES CAN BE BUILT   * 11840096
      * ------------------------------------------------------------- * 11850096
       6000-PROCESS-STORE.                                              11860096
           ADD 1                TO PA-STORE-MESSAGES.                   11870096
           MOVE HO100-STR-NBR   TO PV-KEY-NBR                           11880099
                                   PV-KEY-NBR-NUM.                      11890099
0504RM*** WR27051 - STORES EXPANSION - BYPASS STORES > 999              11900099
0504RM     IF PV-KEY-NBR-9 > 999                                        11910099
0504RM         ADD 1            TO PA-STORE-BYPASS                      11920099
0504RM     ELSE                                                         11930099
0504RM         PERFORM 6005-PROCESS-LEGACY-STORE                        11940099
0504RM     END-IF.                                                      11950099
                                                                        11960099
      * ------------------------------------------------------------- * 11970099
      * ONLY PROCESS STORES < 1000                                    * 11980099
      * ------------------------------------------------------------- * 11990099
0504RM 6005-PROCESS-LEGACY-STORE.                                       12000099
                                                                        12010096
           IF HO100-ACTN-TYP-INSERT                                     12020096
               MOVE PV-INIT-TSTR000 TO DCLTSTR000                       12030096
               PERFORM 6010-INS-UPD-STORE-BASE-ROW                      12040096
               IF PS-NO-INPUT-REC-ERROR                                 12050096
                   PERFORM 7620-INSERT-STORE-ROW                        12060096
               END-IF                                                   12070096
               IF PS-INPUT-REC-ERROR                                    12080096
                   ADD 1 TO PA-STORE-ERRORS                             12090096
               ELSE                                                     12100096
                   ADD 1 TO PA-STORE-INSERTS                            12110096
               END-IF                                                   12120096
           ELSE                                                         12130096
               IF HO100-ACTN-TYP-UPDATE                                 12140096
                   PERFORM 7600-SELECT-STORE-ROW                        12150096
                   IF PS-NO-INPUT-REC-ERROR                             12160096
      *JAK             MOVE TSTR000-OPENED-DATE TO PV-ORIG-OPENED-DATE  12170099
      *JAK             MOVE TSTR000-CLOSED-DATE TO PV-ORIG-CLOSED-DATE  12180099
                       PERFORM 6010-INS-UPD-STORE-BASE-ROW              12190096
                       IF PS-NO-INPUT-REC-ERROR                         12200096
                           PERFORM 7610-UPDATE-STORE-ROW                12210096
      *JAK                 IF PS-NO-INPUT-REC-ERROR                     12220099
      *                        IF THE STORE IS OPEN, AND THE OPEN OR    12230096
      *                        CLOSE DATE HAS BEEN UPDATED, THE STORE/  12240096
      *                        MARKET INFORMATION MUST BE UPDATED.      12250096
      *JAK                     IF PV-ORIG-CLOSED-DATE >= HO100-CRE-TMST 12260099
      *JAK                     AND (HO100-STR-OPEN-DATE  NOT =          12270099
      *JAK                          PV-ORIG-OPENED-DATE                 12280099
      *JAK                     OR   HO100-STR-CLOSE-DATE NOT =          12290099
      *JAK                          PV-ORIG-CLOSED-DATE)                12300099
      *JAK                         PERFORM 6020-UPDATE-STR-MKT-1        12310099
      *JAK                     END-IF                                   12320099
      *JAK                 END-IF                                       12330099
                       END-IF                                           12340096
                   END-IF                                               12350096
                   IF PS-INPUT-REC-ERROR                                12360096
                       ADD 1 TO PA-STORE-ERRORS                         12370096
                   ELSE                                                 12380096
                       ADD 1 TO PA-STORE-UPDATES                        12390096
                   END-IF                                               12400096
               ELSE                                                     12410096
                   IF HO100-ACTN-TYP-DELETE                             12420096
                       PERFORM 7630-DELETE-STORE-ROW                    12430096
                       IF PS-INPUT-REC-ERROR                            12440096
                           ADD 1 TO PA-STORE-ERRORS                     12450096
                       ELSE                                             12460096
                           ADD 1 TO PA-STORE-DELETES                    12470096
                       END-IF                                           12480096
                   END-IF                                               12490096
               END-IF                                                   12500096
           END-IF.                                                      12510096
                                                                        12520096
      * ------------------------------------------------------------- * 12530096
      * INSERT - UPDATE THE STORE BASE ROW DATA                       * 12540096
      * ------------------------------------------------------------- * 12550096
       6010-INS-UPD-STORE-BASE-ROW.                                     12560096
                                                                        12570096
           IF HO100-ACTN-TYP-INSERT                                     12580096
               MOVE PC-DEPT-STR               TO TSTR000-TYPE-CODE      12590096
               PERFORM 8800-GET-MAX-SUBSCRIPT                           12600096
               IF PS-NO-INPUT-REC-ERROR                                 12610096
                   MOVE PV-SUBSCRIPT-NMBR     TO TSTR000-SUBSCRIPT-NMBR 12620096
                   MOVE PV-KEY-NBR-2-4        TO TSTR000-STORE-NMBR     12630096
                   MOVE PV-KEY-NBR-3-4        TO TSTR000-TWO-DIGIT-NMBR 12640096
                   MOVE HO100-STR-NBR         TO TSTR000-STR-NBR        12650096
           END-IF.                                                      12660096
                                                                        12670096
           IF PS-NO-INPUT-REC-ERROR                                     12680096
               MOVE PV-KEY-NBR-2-4       TO TSTR000-STORE-NMBR          12690096
                                                                        12700096
      *-       THE FOLLOWING FIELDS MAP DIRECTLY TO THE RMS STORE TABLE 12710096
               MOVE HO100-STR-NAME       TO TSTR000-STORE-NAME          12720096
               MOVE HO100-STR-NAME10     TO TSTR000-CHAR10-ABBR-NAME    12730096
               MOVE HO100-STR-ADD1-1-25  TO TSTR000-MAIL-ADDR-ONE-DESC  12740096
               MOVE HO100-STR-ADD2-1-25  TO TSTR000-MAIL-ADDR-TWO-DESC  12750096
               MOVE HO100-STR-CITY-1-15  TO TSTR000-CITY-NAME           12760096
               MOVE HO100-STR-STATE-1-2  TO TSTR000-STATE-CODE          12770096
                                                                        12780096
      *--      CONVERT THE INPUT ALPHANUMERIC ZIP CODE TO NUMERIC       12790096
               INITIALIZE                   PV-INPUT-NUMBER-IN          12800096
                                            PV-OUTPUT-NUMBER-OUT        12810096
                                            PV-ZIP-CODE1-9              12820096
               MOVE HO100-STR-PCODE      TO PV-INPUT-NUMBER-IN          12830096
               PERFORM 6900-CONVERT-ALPHA-TO-NUMERIC                    12840096
               MOVE PV-OUTPUT-NUMBER-OUT TO PV-ZIP-CODE                 12850096
               INITIALIZE TSTR000-ZIP-PLUS4-CODE                        12860096
               MOVE PV-ZIP-CODE1-9       TO TSTR000-ZIP-PLUS4-CODE      12870096
                                                                        12880096
      *--     CONVERT THE INPUT ALPHANUMERIC PHONE NBR TO NUMERIC       12890096
               INITIALIZE                   PV-INPUT-NUMBER-IN          12900096
                                            PV-OUTPUT-NUMBER-OUT        12910096
                                            PV-PHONE-NBR10-20           12920096
               MOVE HO100-STR-PHONE-NUMBER                              12930096
                                         TO PV-INPUT-NUMBER-IN          12940096
               PERFORM 6910-CONVERT-PHONE-NUMBER                        12950096
               MOVE PV-OUTPUT-NUMBER-OUT TO PV-PHONE-NBR                12960096
               INITIALIZE TSTR000-PHONE-NMBR                            12970096
               MOVE PV-PHONE-NBR10-20    TO TSTR000-PHONE-NMBR          12980096
                                                                        12990099
0902RM* WR23765 - COMMENT RECEIPT START DATE LOGIC                      13000099
0902RM*           THIS WILL NOW BE DONE THRU THE WH-STORE-ASSIGN TXN    13010099
1001RM** SET DC RCT_START DATE WHEN THE STORE OPEN DATE CHANGES         13020096
1001RM*        IF HO100-ACTN-TYP-UPDATE                                 13030099
0302RM* PM00458641 - CHECK IF START ORDER DAYS CHANGED                  13040096
0302RM*            IF HO100-STRT-ORDER-TYP-CHG                          13050099
0302RM*            OR (HO100-STR-OPEN-DATE NOT = TSTR000-OPENED-DATE)   13060099
0302RM*                PERFORM 6498-SET-DC-RCT-START-DATE               13070099
1001RM*             IF HO100-STR-OPEN-DATE = TSTR000-OPENED-DATE        13080096
1001RM*                 CONTINUE                                        13090096
1001RM*            ELSE                                                 13100096
1001RM*                PERFORM 6498-SET-DC-RCT-START-DATE               13110096
1001RM*            END-IF                                               13120099
1001RM*        END-IF                                                   13130099
                                                                        13140096
               MOVE HO100-STR-OPEN-DATE  TO TSTR000-OPENED-DATE         13150096
                                                                        13160096
1001RM** SET DC RCT-STOP & P.O. STOP DATES WHEN A VALID CLOSE DATE OR   13170096
1001RM** THE STOP ORDER DAYS HAVE CHANGED.                              13180096
1001RM         IF HO100-ACTN-TYP-UPDATE                                 13190096
0801RM             IF HO100-STR-CLOSE-DATE = PC-DEFAULT-DATE            13200096
0801RM                 CONTINUE                                         13210096
0801RM             ELSE                                                 13220096
0801RM               IF (HO100-STR-CLOSE-DATE NOT = TSTR000-CLOSED-DATE)13230096
0801RM                 OR (HO100-STR-ACTN-STP-ORD)                      13240096
0801RM                     PERFORM 6490-SET-DC-STOP-DATES               13250096
0801RM                 END-IF                                           13260096
0801RM             END-IF                                               13270096
0801RM         END-IF                                                   13280096
                                                                        13290096
               MOVE HO100-STR-CLOSE-DATE TO TSTR000-CLOSED-DATE         13300096
                                                                        13310096
               MOVE HO100-STR-SELL-SQ-FT TO TSTR000-SELLING-SQFT-NMBR   13320096
                                                                        13330096
               MOVE HO100-STR-DISTRICT   TO PV-4-BYTE-IN-FLD            13340096
               MOVE PV-4-BYTE-IN-FLD-3-4 TO TSTR000-DISTRICT-NMBR       13350096
                                                                        13360096
               MOVE HO100-STR-MGR-NAME   TO TSTR000-MGR-NAME            13370096
                                                                        13380096
      *     -- DO NOT USE DEFAULT WH - IT WILL OVERLAY WHAT IS SET FROM 13390096
      *     -- THE WH_STORE_ASSIGN TABLE                                13400096
      *        MOVE HO100-STR-DEFAULT-WH    TO PV-4-BYTE-IN-FLD         13410096
      *        MOVE PV-4-BYTE-IN-FLD-2-4    TO TSTR000-DC1-NMBR         13420096
                                                                        13430096
               MOVE PV-CURRENT-DATE      TO TSTR000-LAST-CHG-DTE        13440096
                                                                        13450096
               IF TSTR000-TYPE-CODE = PC-DEPT-STR                       13460096
      *--      LOW VALUES IS THE LEGACY DEFAULT OF MAIL-ADDR-TWO-DESC   13470096
                   IF TSTR000-MAIL-ADDR-TWO-DESC = SPACES               13480096
                       MOVE LOW-VALUES   TO TSTR000-MAIL-ADDR-TWO-DESC  13490096
                   END-IF                                               13500096
      *--      LOW VALUES IS THE LEGACY DEFAULT OF MGR-NAME             13510096
                   IF TSTR000-MGR-NAME = SPACES                         13520096
                       MOVE LOW-VALUES   TO TSTR000-MGR-NAME            13530096
                   END-IF                                               13540096
               END-IF                                                   13550096
           END-IF.                                                      13560096
                                                                        13570096
      * ------------------------------------------------------------- * 13580096
      * UPDATE STORE/MARKET RECORD(S) WHEN STORE OPEN/CLOSE DATES ARE   13590096
      * UPDATED.                                                        13600096
      * ------------------------------------------------------------- * 13610096
      *6020-UPDATE-STR-MKT-1.                                           13620099
      *JAK IF HO100-STR-OPEN-DATE < HO100-CRE-TMST                      13630099
      *        FIND STR/MKT RECORD FOR ORIGINAL STORE OPEN DATE         13640096
      *JAK     MOVE HO100-CRE-TMST TO PV-STR-OPEN-DT-ISO                13650099
      *JAK     PERFORM 7840-GET-STR-MKT-BY-OPEN-DT                      13660099
      *JAK ELSE                                                         13670099
      *        FIND STR/MKT RECORD FOR ORIGINAL STORE OPEN DATE FOR A   13680096
      *        FUTURE OPENING STORE                                     13690096
      *JAK     IF HO100-STR-OPEN-DATE < PV-ORIG-OPENED-DATE             13700099
      *JAK         MOVE PV-ORIG-OPENED-DATE TO PV-STR-OPEN-DT-ISO       13710099
      *JAK     ELSE                                                     13720099
      *            FIND STR/MKT RECORD FOR NEW STORE OPEN DATE          13730096
      *JAK         MOVE HO100-STR-OPEN-DATE TO PV-STR-OPEN-DT-ISO       13740099
      *JAK     END-IF                                                   13750099
      *JAK     PERFORM 7840-GET-STR-MKT-BY-OPEN-DT                      13760099
      *JAK END-IF.                                                      13770099
                                                                        13780096
      *JAK IF PS-NO-INPUT-REC-ERROR                                     13790099
      *JAK     PERFORM 6022-UPDATE-STR-MKT-2                            13800099
      *JAK END-IF.                                                      13810099
                                                                        13820096
                                                                        13830096
      *6022-UPDATE-STR-MKT-2.                                           13840099
      *JAK IF HO100-STR-OPEN-DATE NOT = PV-ORIG-OPENED-DATE             13850099
      *JAK     IF HO100-STR-OPEN-DATE < HO100-CRE-TMST                  13860099
      *JAK         MOVE HO100-CRE-TMST TO STRMKT-BEG-DTE                13870099
      *JAK         IF (STRMKT-END-DTE >= HO100-CRE-TMST)                13880099
      *JAK             PERFORM 7846-UPD-BEG-END-DTE                     13890099
      *JAK         END-IF                                               13900099
      *JAK     ELSE                                                     13910099
      *JAK         MOVE HO100-STR-OPEN-DATE TO STRMKT-BEG-DTE           13920099
      *JAK     END-IF                                                   13930099
      *JAK     IF PS-NO-INPUT-REC-ERROR                                 13940099
      *            ONLY DO THE FOLLOWING IF/END-IF WHEN 7840- RETURNS A 13950096
      *            PREVIOUS MARKET (SQLCODE=ZEROS)                      13960096
      *JAK         IF (STRMKT-END-DTE >= HO100-CRE-TMST)                13970099
      *JAK             PERFORM 7842-DELETE-STRMKT-BEG-DTE               13980099
      *JAK             IF PS-NO-INPUT-REC-ERROR                         13990099
      *                    DELETE ANY ADDITIONAL RECORDS THAT MAY FALL  14000096
      *                    OUT OF THE CURRENT-DATE TO NEW STORE OPEN    14010096
      *                    DATE RANGE.                                  14020096
      *JAK                 IF (HO100-STR-OPEN-DATE >= HO100-CRE-TMST)   14030099
      *JAK                     PERFORM 7843-DEL-ADDL-STRMKT             14040099
      *JAK                 END-IF                                       14050099
      *JAK                 IF PS-NO-INPUT-REC-ERROR                     14060099
      *JAK                     PERFORM 7844-ADD-STRMKT-BEG-DTE          14070099
      *JAK                     IF HO100-STR-OPEN-DATE >                 14080099
      *JAK                        PV-ORIG-OPENED-DATE                   14090099
      *JAK                         PERFORM 7851-UPDATE-SUB-TSTRMKT      14100099
      *JAK                     END-IF                                   14110099
      *JAK                 END-IF                                       14120099
      *JAK             END-IF                                           14130099
      *JAK         END-IF                                               14140099
      *JAK     END-IF                                                   14150099
      *JAK ELSE                                                         14160099
      *        NEED TO FILL STRMKT-BEG-DTE BECAUSE END DATE CAN CHANGE. 14170096
      *        7848-UPD-END-END-DTE REQUIRES STRMKT-BEG-DTE FOR         14180096
      *        PROCESSING.                                              14190096
      *JAK     IF (HO100-STR-OPEN-DATE < HO100-CRE-TMST)                14200099
      *JAK         MOVE HO100-CRE-TMST      TO STRMKT-BEG-DTE           14210099
      *JAK     ELSE                                                     14220099
      *JAK         MOVE HO100-STR-OPEN-DATE TO STRMKT-BEG-DTE           14230099
      *JAK     END-IF                                                   14240099
      *JAK END-IF.                                                      14250099
                                                                        14260096
      *JAK IF PS-NO-INPUT-REC-ERROR                                     14270099
      *JAK     PERFORM 6024-UPDATE-STR-MKT-3                            14280099
      *JAK END-IF.                                                      14290099
                                                                        14300096
                                                                        14310096
      *6024-UPDATE-STR-MKT-3.                                           14320099
      *JAK IF HO100-STR-CLOSE-DATE NOT = PV-ORIG-CLOSED-DATE            14330099
      *        FIND STR/MKT RECORD FOR ORIGINAL STORE CLOSE DATE        14340096
      *JAK     MOVE PV-ORIG-CLOSED-DATE TO PV-STR-CLOSE-DT-ISO          14350099
      *JAK     PERFORM 7841-GET-STR-MKT-BY-END-DT                       14360099
      *JAK     IF PS-NO-INPUT-REC-ERROR                                 14370099
      *JAK         PERFORM 6026-UPDATE-STR-MKT-4                        14380099
      *JAK     END-IF                                                   14390099
      *JAK END-IF.                                                      14400099
                                                                        14410096
                                                                        14420096
      *6026-UPDATE-STR-MKT-4.                                           14430099
      *    CODING WHEN A STORE CLOSE DATE IS BROUGHT FORWARD            14440096
      *    (I.E., RE-OPENED)                                            14450096
      *JAK IF (PV-ORIG-CLOSED-DATE <  HO100-CRE-TMST                    14460099
      *JAK AND STRMKT-END-DTE      >= HO100-CRE-TMST)                   14470099
      *JAK     IF (STRMKT-BEG-DTE = HO100-CRE-TMST)                     14480099
      *JAK         MOVE PV-ORIG-OPENED-DATE  TO STRMKT-BEG-DTE          14490099
      *JAK         MOVE HO100-STR-CLOSE-DATE TO STRMKT-END-DTE          14500099
      *JAK         PERFORM 7848-UPD-END-END-DTE                         14510099
      *JAK     ELSE                                                     14520099
      *JAK         MOVE HO100-STR-CLOSE-DATE TO STRMKT-END-DTE          14530099
      *JAK         PERFORM 7844-ADD-STRMKT-BEG-DTE                      14540099
      *JAK     END-IF                                                   14550099
      *JAK ELSE                                                         14560099
      *JAK     IF HO100-STR-CLOSE-DATE < HO100-CRE-TMST                 14570099
      *JAK         MOVE HO100-CRE-TMST       TO STRMKT-END-DTE          14580099
      *JAK     ELSE                                                     14590099
      *JAK         MOVE HO100-STR-CLOSE-DATE TO STRMKT-END-DTE          14600099
      *JAK     END-IF                                                   14610099
      *JAK     PERFORM 7847-DELETE-STRMKT-END-DTE                       14620099
      *JAK     IF PS-NO-INPUT-REC-ERROR                                 14630099
      *            NEED TO UPDATE STR/MKT WHERE IT RESIDES AS OF THE    14640096
      *            NEW CLOSE DATE. BECAUSE THE CLOSE DATE CAN CROSS     14650096
      *            MARKETS, AND 7841 CALL GETS THE STR/MKT RECORD       14660096
      *            FOR THE ORIGINAL ENDING DATE FOR PROCESSING, NEED    14670096
      *            TO RE-READ WHERE THE NEW CLOSE DATE WILL PUT THE     14680096
      *            STORE AND UPDATE THESE STRMKT RECORDS WITH THE       14690096
      *            CORRECT NEW CLOSE DATE.                              14700096
      *JAK         IF HO100-STR-CLOSE-DATE < STRMKT-BEG-DTE             14710099
      *JAK             IF HO100-STR-OPEN-DATE < HO100-CRE-TMST          14720099
      *                    FIND STR/MKT RECORD FOR ORIGINAL STORE OPEN  14730096
      *                    DATE                                         14740096
      *JAK                 MOVE HO100-CRE-TMST TO PV-STR-OPEN-DT-ISO    14750099
      *JAK                 PERFORM 7840-GET-STR-MKT-BY-OPEN-DT          14760099
      *JAK             ELSE                                             14770099
      *                    FIND STR/MKT RECORD FOR ORIGINAL STORE OPEN  14780096
      *                    DATE FOR A FUTURE OPENING STORE              14790096
      *JAK                 IF (HO100-STR-OPEN-DATE <                    14800099
      *JAK                                       PV-ORIG-OPENED-DATE)   14810099
      *JAK                     MOVE PV-ORIG-OPENED-DATE                 14820099
      *JAK                             TO PV-STR-OPEN-DT-ISO            14830099
      *JAK                 ELSE                                         14840099
      *                        FIND STR/MKT RECORD FOR NEW STORE OPEN   14850096
      *                        DATE                                     14860096
      *JAK                     MOVE HO100-STR-OPEN-DATE                 14870099
      *JAK                               TO PV-STR-OPEN-DT-ISO          14880099
      *JAK                 END-IF                                       14890099
      *JAK                 PERFORM 7840-GET-STR-MKT-BY-OPEN-DT          14900099
      *JAK             END-IF                                           14910099
      *JAK             IF HO100-STR-CLOSE-DATE < HO100-CRE-TMST         14920099
      *JAK                 MOVE HO100-CRE-TMST       TO STRMKT-END-DTE  14930099
      *JAK             ELSE                                             14940099
      *JAK                 MOVE HO100-STR-CLOSE-DATE TO STRMKT-END-DTE  14950099
      *JAK             END-IF                                           14960099
      *JAK         END-IF                                               14970099
      *JAK     END-IF                                                   14980099
      *JAK     IF PS-NO-INPUT-REC-ERROR                                 14990099
      *JAK         PERFORM 7848-UPD-END-END-DTE                         15000099
      *            UPDATE SUB-MARKET RECORDS WITH NEW CLOSING DATE      15010096
      *JAK         IF PS-NO-INPUT-REC-ERROR                             15020099
      *JAK             PERFORM 7849-UPD-END-END-DTE-SUB                 15030099
      *JAK         END-IF                                               15040099
      *JAK     END-IF                                                   15050099
      *JAK END-IF.                                                      15060099
                                                                        15070096
                                                                        15080096
      * ------------------------------------------------------------- * 15090096
      * PROCESS THE STORE ATTRIBUTE TABLE MESSAGES                    * 15100096
      * NOTE THAT AN INSERT IS NOT ACTULLY PERFORMED BECAUSE THE      * 15110096
      * ROW SHOULD ALREADY BE PRESENT THRU THE STORE ADD!             * 15120096
      * ------------------------------------------------------------- * 15130096
       6100-PROCESS-STORE-ATTRIB.                                       15140096
           ADD 1 TO PA-STORE-ATTRIB-MESSAGES.                           15150096
           MOVE HO100-SATTR-STR-NBR       TO PV-KEY-NBR.                15160096
0504RM*** WR27051 - STORES EXPANSION - BYPASS STORES > 999              15170099
0504RM     IF PV-KEY-NBR-9 > 999                                        15180099
0504RM         ADD 1            TO PA-STRATTR-BYPASS                    15190099
0504RM     ELSE                                                         15200099
0504RM         PERFORM 6105-PROCESS-LEGACY-STRATTR                      15210099
0504RM     END-IF.                                                      15220099
                                                                        15230096
                                                                        15240099
      * ------------------------------------------------------------- * 15250099
      * ONLY PROCESS STORES < 1000                                    * 15260099
      * ------------------------------------------------------------- * 15270099
0504RM 6105-PROCESS-LEGACY-STRATTR.                                     15280099
                                                                        15290099
           IF HO100-ACTN-TYP-DELETE                                     15300096
               ADD 1 TO PA-STORE-ATTRIB-DELETES                         15310096
           ELSE                                                         15320096
               PERFORM 7600-SELECT-STORE-ROW                            15330096
               IF PS-NO-INPUT-REC-ERROR                                 15340096
                   PERFORM 6110-UPDATE-STORE-ATTR-DATA                  15350096
               END-IF                                                   15360096
               IF PS-INPUT-REC-ERROR                                    15370096
                   ADD 1 TO PA-STORE-ATTRIB-ERRORS                      15380096
               ELSE                                                     15390096
                   IF HO100-ACTN-TYP-INSERT                             15400096
                       ADD 1 TO PA-STORE-ATTRIB-INSERTS                 15410096
                   ELSE                                                 15420096
                       ADD 1 TO PA-STORE-ATTRIB-UPDATES                 15430096
                   END-IF                                               15440096
               END-IF                                                   15450096
           END-IF.                                                      15460096
                                                                        15470096
      * ------------------------------------------------------------- * 15480096
      * UPDATE THE STORE TABLE WITH THE STORE ATTRIBUTE DATA            15490096
      * ------------------------------------------------------------- * 15500096
       6110-UPDATE-STORE-ATTR-DATA.                                     15510096
                                                                        15520096
           MOVE HO100-SATTR-STR-NM-5-ABBR     TO                        15530096
                TSTR000-CHAR5-ABBR-NAME.                                15540096
0904RM** WR27051--                                                      15550099
0904RM*    MOVE HO100-SATTR-DSCVR-MERCH-NBR   TO                        15560099
0904RM*         TSTR000-DSCVR-MERCH-NMBR.                               15570099
0904RM*    MOVE HO100-SATTR-BNKCRD-MRCH-NBR  TO                         15580099
0904RM*         TSTR000-BNKCD-MERCH-NMBR.                               15590099
0904RM*    MOVE HO100-SATTR-AMEX-MERCH-NBR   TO                         15600099
0904RM*         TSTR000-AMEX-MERCH-NBR.                                 15610099
      *-- THE FOLLOWING 2 STORE FIELDS ARE MAINTAINED BY A SEPARATE     15620096
      *-- PROCESS ON THE MAINFRAME THRU A CICS SCREEN.  THEY SHOULD     15630096
      *-- ONLY BE INITIALIZED ON THE ADD USING THE PV-INIT-TSTR000      15640096
      *-- LAYOUT                                                        15650096
      *    MOVE HO100-SATTR-CK-AUTH-GP-NBR   TO                         15660096
      *         TSTR000-CK-AUTH-GRP-NMBR.                               15670096
      *    MOVE HO100-SATTR-CSH-RFND-GP-NBR  TO                         15680096
      *         TSTR000-CASH-RET-AUTH-NBR.                              15690096
           MOVE HO100-SATTR-YR-SLS-INCL-DTE  TO                         15700096
                TSTR000-YR-SLS-INCL-DTE.                                15710096
           MOVE HO100-SATTR-MN-SLS-INCL-DTE  TO                         15720096
                TSTR000-MO-SLS-INCL-DTE.                                15730096
           MOVE HO100-SATTR-REPLT-STR-NBR3-5 TO                         15740096
                TSTR000-REPL-STORE-NBR.                                 15750096
           MOVE HO100-SATTR-POS-CAP-LVL-ID   TO                         15760096
                TSTR000-POS-CAP-LVL.                                    15770096
           MOVE HO100-SATTR-QTR-SLS-INCL-DTE TO                         15780096
                TSTR000-QTR-SLS-INCL-DTE.                               15790096
           MOVE HO100-SATTR-SEA-SLS-INCL-DTE TO                         15800096
                TSTR000-SEA-SLS-INCL-DTE.                               15810096
           MOVE HO100-SATTR-SLS-INCL-DTE-CDE TO                         15820096
                TSTR000-STR-CMPR-DTE-CDE.                               15830096
0901RM** WR 22871                                                       15840096
0901RM*    MOVE HO100-SATTR-SGN-PRT-LOC-ID   TO                         15850096
0901RM*         TSTR000-SGN-PRT-LOC-ID.                                 15860096
0901RM*    MOVE HO100-SATTR-SGN-PRT-GP-ID    TO                         15870096
0901RM*         TSTR000-SGN-PRT-GRP-ID.                                 15880096
           MOVE HO100-SATTR-OCPNC-DTE        TO                         15890096
                TSTR000-OCPNC-DTE.                                      15900096
           MOVE HO100-SATTR-LBR-SFWR-LVL-ID  TO                         15910096
                TSTR000-LBR-SFWR-LVL-ID.                                15920096
           MOVE HO100-SATTR-EST-HH-INCM-AMT  TO                         15930096
                TSTR000-EST-HH-INCM-AMT.                                15940096
0801RM** WR 22871                                                       15950096
0801RM** SET THE STORE'S FINANCIAL CLOSE DATE                           15960096
0801RM     MOVE HO100-SATTR-FINCL-CLO-DTE    TO TSTR000-FIN-CLS-DTE.    15970096
                                                                        15980096
           MOVE HO100-SATTR-MEDN-AGE-NBR-RDF TO TSTR000-MEDN-AGE-NBR.   15990096
           MOVE HO100-SATTR-TM-ZN-CDE        TO TSTR000-STD-TM-ZN-CDE.  16000096
           MOVE HO100-SATTR-DST-IND          TO TSTR000-DST-CDE.        16010096
                                                                        16020098
           IF HO100-SATTR-IN-STR-PRCHG-IND = 'Y'                        16030098
               MOVE 2                       TO TSTR000-PERM-RLSE-AVL-NBR16040098
           ELSE                                                         16050098
               MOVE ZERO                    TO TSTR000-PERM-RLSE-AVL-NBR16060098
           END-IF.                                                      16070098
           MOVE HO100-SATTR-PRCHG-IND        TO TSTR000-CENPPC-CRE-IND. 16080098
                                                                        16090098
           MOVE PV-CURRENT-DATE              TO TSTR000-LAST-CHG-DTE.   16100096
                                                                        16110096
           IF TSTR000-TYPE-CODE = PC-DEPT-STR                           16120096
               IF TSTR000-REPL-STORE-NBR = SPACES OR '000'              16130096
                   MOVE LOW-VALUES TO TSTR000-REPL-STORE-NBR            16140096
               END-IF                                                   16150096
               IF TSTR000-RF-BEG-IP-ADR = LOW-VALUES                    16160096
                   MOVE SPACES     TO TSTR000-RF-BEG-IP-ADR             16170096
               END-IF                                                   16180096
               IF TSTR000-RF-END-IP-ADR = LOW-VALUES                    16190096
                   MOVE SPACES     TO TSTR000-RF-END-IP-ADR             16200096
               END-IF                                                   16210096
           END-IF.                                                      16220096
                                                                        16230096
           PERFORM 7610-UPDATE-STORE-ROW.                               16240096
                                                                        16250096
      * ------------------------------------------------------------- * 16260096
      * PROCESS THE WH TABLE MESSAGES                                   16270096
      * ------------------------------------------------------------- * 16280096
       6200-PROCESS-WH.                                                 16290096
           ADD 1 TO PA-WH-MESSAGES.                                     16300096
           MOVE HO100-WH        TO PV-KEY-NBR                           16310096
                                   PV-KEY-NBR-NUM.                      16320096
0504RM*** WR27051 - STORES EXPANSION - BYPASS STORES > 999              16330099
0504RM     IF PV-KEY-NBR-9 > 999                                        16340099
0504RM         ADD 1            TO PA-WH-BYPASS                         16350099
0504RM     ELSE                                                         16360099
0504RM         PERFORM 6205-PROCESS-LEGACY-WH                           16370099
0504RM     END-IF.                                                      16380099
                                                                        16390099
      * ------------------------------------------------------------- * 16400099
      * ONLY PROCESS WAREHOUSES < 1000                                * 16410099
      * ------------------------------------------------------------- * 16420099
0504RM 6205-PROCESS-LEGACY-WH.                                          16430099
                                                                        16440099
           IF HO100-ACTN-TYP-INSERT                                     16450096
               MOVE PV-INIT-TSTR000 TO DCLTSTR000                       16460096
               PERFORM 6220-LOAD-WH-DATA                                16470096
               IF PS-NO-INPUT-REC-ERROR                                 16480096
                   PERFORM 7620-INSERT-STORE-ROW                        16490096
               END-IF                                                   16500096
               IF PS-INPUT-REC-ERROR                                    16510096
                   ADD 1 TO PA-WH-ERRORS                                16520096
               ELSE                                                     16530096
                   ADD 1 TO PA-WH-INSERTS                               16540096
               END-IF                                                   16550096
           ELSE                                                         16560096
               IF HO100-ACTN-TYP-UPDATE                                 16570096
                   PERFORM 7600-SELECT-STORE-ROW                        16580096
                   IF PS-INPUT-REC-ERROR                                16590096
                       ADD 1 TO PA-WH-ERRORS                            16600096
                   ELSE                                                 16610096
                       PERFORM 6220-LOAD-WH-DATA                        16620096
                       IF PS-NO-INPUT-REC-ERROR                         16630096
                           PERFORM 7610-UPDATE-STORE-ROW                16640096
                       END-IF                                           16650096
                       IF PS-INPUT-REC-ERROR                            16660096
                           ADD 1 TO PA-WH-ERRORS                        16670096
                       ELSE                                             16680096
                           ADD 1 TO PA-WH-UPDATES                       16690096
                       END-IF                                           16700096
                   END-IF                                               16710096
               ELSE                                                     16720096
                   IF HO100-ACTN-TYP-DELETE                             16730096
                       PERFORM 7630-DELETE-STORE-ROW                    16740096
                       IF PS-INPUT-REC-ERROR                            16750096
                           ADD 1 TO PA-WH-ERRORS                        16760096
                       ELSE                                             16770096
                           ADD 1 TO PA-WH-DELETES                       16780096
                   END-IF                                               16790096
               END-IF                                                   16800096
           END-IF.                                                      16810096
                                                                        16820096
      * ------------------------------------------------------------- * 16830096
      * INSERT THE DATA FOR THE WH ROW                                * 16840096
      * ------------------------------------------------------------- * 16850096
       6220-LOAD-WH-DATA.                                               16860096
                                                                        16870096
           IF HO100-ACTN-TYP-INSERT                                     16880096
               MOVE PV-KEY-NBR-2-4        TO TSTR000-STORE-NMBR         16890096
               MOVE PC-DIST-CTR           TO TSTR000-TYPE-CODE          16900096
               PERFORM 8800-GET-MAX-SUBSCRIPT                           16910096
               IF PS-NO-INPUT-REC-ERROR                                 16920096
                   MOVE PV-SUBSCRIPT-NMBR TO TSTR000-SUBSCRIPT-NMBR     16930096
                   MOVE PV-KEY-NBR-3-4    TO TSTR000-TWO-DIGIT-NMBR     16940096
                   MOVE PV-KEY-NBR-NUM    TO TSTR000-STR-NBR            16950096
               END-IF                                                   16960096
           END-IF.                                                      16970096
                                                                        16980096
           IF PS-NO-INPUT-REC-ERROR                                     16990096
      *-       THE FOLLOWING FIELDS ARE DERIVED FROM THE RMS WH TABLE   17000096
               MOVE HO100-WH-NAME        TO TSTR000-STORE-NAME          17010096
                                                                        17020096
               MOVE HO100-WH-ADD1-1-25   TO TSTR000-MAIL-ADDR-ONE-DESC  17030096
               IF TSTR000-MAIL-ADDR-ONE-DESC = SPACES                   17040096
                   MOVE LOW-VALUES       TO TSTR000-MAIL-ADDR-ONE-DESC  17050096
               END-IF                                                   17060096
                                                                        17070096
               MOVE HO100-WH-ADD2-1-25   TO TSTR000-MAIL-ADDR-TWO-DESC  17080096
               IF TSTR000-MAIL-ADDR-TWO-DESC = SPACES                   17090096
                   MOVE LOW-VALUES       TO TSTR000-MAIL-ADDR-TWO-DESC  17100096
               END-IF                                                   17110096
                                                                        17120096
               MOVE HO100-WH-CITY-1-15   TO TSTR000-CITY-NAME           17130096
               MOVE HO100-WH-STATE-1-2   TO TSTR000-STATE-CODE          17140096
                                                                        17150096
      *--     CONVERT THE INPUT ALPHANUMERIC ZIP CODE TO NUMERIC        17160096
               MOVE 0                    TO PV-INPUT-NUMBER-IN          17170096
                                            PV-OUTPUT-NUMBER-OUT        17180096
                                            PV-ZIP-CODE1-9              17190096
               MOVE HO100-WH-PCODE       TO PV-INPUT-NUMBER-IN          17200096
0701RM*        PERFORM 6910-CONVERT-PHONE-NUMBER                        17210096
0701RM         PERFORM 6900-CONVERT-ALPHA-TO-NUMERIC                    17220096
               MOVE PV-OUTPUT-NUMBER-OUT TO PV-ZIP-CODE                 17230096
               MOVE PV-ZIP-CODE1-9       TO TSTR000-ZIP-PLUS4-CODE      17240096
                                                                        17250096
               MOVE PV-CURRENT-DATE      TO TSTR000-LAST-CHG-DTE        17260096
               MOVE LOW-VALUES           TO TSTR000-REPL-STORE-NBR      17270096
      *--      LOW VALUES IS THE LEGACY DEFAULT OF MGR-NAME             17280096
               IF TSTR000-MGR-NAME = SPACES                             17290096
                   MOVE LOW-VALUES       TO TSTR000-MGR-NAME            17300096
               END-IF                                                   17310096
           END-IF.                                                      17320096
                                                                        17330096
      * ------------------------------------------------------------- * 17340096
      * PROCESS THE WH ATTRIB MESSAGES                                * 17350096
      * NOTE THAT AN INSERT IS NOT ACTUALLY PERFORMED BECAUSE THE     * 17360096
      * ROW SHOULD ALREADY BE PRESENT THRU THE WH ADD                 * 17370096
      * ------------------------------------------------------------- * 17380096
       6300-PROCESS-WH-ATTRIB.                                          17390096
           ADD 1 TO PA-WH-ATTRIB-MESSAGES.                              17400096
           MOVE HO100-WHATTR-WH            TO PV-KEY-NBR.               17410096
                                                                        17420099
0504RM*** WR27051 - STORES EXPANSION - BYPASS WAREHOUSES > 999          17430099
0504RM     IF PV-KEY-NBR-9 > 999                                        17440099
0504RM         ADD 1            TO PA-WHATTR-BYPASS                     17450099
0504RM     ELSE                                                         17460099
0504RM         PERFORM 6305-PROCESS-LEGACY-WHATTR                       17470099
0504RM     END-IF.                                                      17480099
                                                                        17490099
      * ------------------------------------------------------------- * 17500099
      * ONLY PROCESS WAREHOUSES < 1000                                * 17510099
      * ------------------------------------------------------------- * 17520099
0504RM 6305-PROCESS-LEGACY-WHATTR.                                      17530099
                                                                        17540096
           IF HO100-ACTN-TYP-DELETE                                     17550096
               ADD 1 TO PA-WH-ATTRIB-DELETES                            17560096
           ELSE                                                         17570096
               PERFORM 7600-SELECT-STORE-ROW                            17580096
               IF PS-INPUT-REC-ERROR                                    17590096
                   ADD 1 TO PA-WH-ATTRIB-ERRORS                         17600096
               ELSE                                                     17610096
                   PERFORM 6310-UPDATE-WH-ATTR-DATA                     17620096
                   PERFORM 7610-UPDATE-STORE-ROW                        17630096
                   IF HO100-ACTN-TYP-INSERT                             17640096
                       IF PS-INPUT-REC-ERROR                            17650096
                           ADD 1 TO PA-WH-ATTRIB-ERRORS                 17660096
                       ELSE                                             17670096
                           ADD 1 TO PA-WH-ATTRIB-INSERTS                17680096
                       END-IF                                           17690096
                   ELSE                                                 17700096
                       IF PS-INPUT-REC-ERROR                            17710096
                           ADD 1 TO PA-WH-ATTRIB-ERRORS                 17720096
                       ELSE                                             17730096
                           ADD 1 TO PA-WH-ATTRIB-UPDATES                17740096
                       END-IF                                           17750096
                   END-IF                                               17760096
               END-IF                                                   17770096
           END-IF.                                                      17780096
                                                                        17790096
      * ------------------------------------------------------------- * 17800096
      * LOAD THE WH-ATTRIBUTE DATA INTO THE STORE ROW                 * 17810096
      * ------------------------------------------------------------- * 17820096
       6310-UPDATE-WH-ATTR-DATA.                                        17830096
           MOVE HO100-WHATTR-LOC-TYP-CDE TO TSTR000-TYPE-CODE.          17840096
           MOVE HO100-WHATTR-NM-5-ABBR   TO TSTR000-CHAR5-ABBR-NAME.    17850096
           MOVE HO100-WHATTR-NM-10-ABBR  TO TSTR000-CHAR10-ABBR-NAME.   17860096
           MOVE HO100-WHATTR-OPN-DTE     TO TSTR000-OPENED-DATE.        17870096
           MOVE HO100-WHATTR-CLO-DTE     TO TSTR000-CLOSED-DATE.        17880096
           MOVE HO100-WHATTR-OCPNC-DTE   TO TSTR000-OCPNC-DTE.          17890097
           IF HO100-WHATTR-IN-STR-PRCHG-IND = 'Y'                       17900098
               MOVE 2                    TO TSTR000-PERM-RLSE-AVL-NBR   17910098
           ELSE                                                         17920098
               MOVE ZERO                 TO TSTR000-PERM-RLSE-AVL-NBR   17930098
           END-IF.                                                      17940098
           MOVE HO100-WHATTR-PRCHG-IND   TO TSTR000-CENPPC-CRE-IND.     17950098
                                                                        17960098
           MOVE HO100-WHATTR-DC-NBR      TO PV-4-BYTE-IN-FLD.           17970096
           MOVE PV-4-BYTE-IN-FLD-2-4     TO TSTR000-DC1-NMBR.           17980096
           PERFORM 6320-DETERMINE-DC-CODE.                              17990096
                                                                        18000096
      * - DEFAULT THE FOLLOWING FIELDS ON AN INSERT OF A WH ATTRIB ROW  18010096
      * - THE RCT START DATE IS 90 DAYS PRIOR TO THE OPEN DATE          18020096
      * - THE PO START DATE IS THE CURRENT DATE (SYSTEM-DATE)           18030096
           IF HO100-ACTN-TYP-INSERT                                     18040096
               MOVE PV-CURRENT-DATE      TO TSTR000-DC1-PO-START-DATE   18050096
                                                                        18060096
0701RM*        MOVE HO100-WHATTR-OPN-DTE TO PV-START-DATE               18070096
0701RM*        MOVE PC-NINETY            TO PV-DAYS                     18080096
0701RM*        PERFORM 8600-DECREMENT-DATE                              18090096
0701RM*        MOVE PV-DATE-DEC-DAYS     TO TSTR000-DC1-RCT-START-DATE  18100096
                                                                        18110096
      * - THE RCT START DATE IS NOW THE WH OPEN DATE                    18120096
0701RM         MOVE HO100-WHATTR-OPN-DTE TO TSTR000-DC1-RCT-START-DATE  18130096
                                                                        18140096
               MOVE PC-DEFAULT-DATE      TO TSTR000-DC2-PO-STOP-DATE    18150096
                                            TSTR000-DC2-RCT-STOP-DATE   18160096
               MOVE PC-OTHER             TO TSTR000-STR-CMPR-DTE-CDE    18170096
               MOVE SPACES               TO TSTR000-STD-TM-ZN-CDE       18180096
           END-IF.                                                      18190096
                                                                        18200096
0701RM     IF HO100-ACTN-TYP-UPDATE                                     18210096
0701RM         MOVE HO100-WHATTR-OPN-DTE TO TSTR000-DC1-RCT-START-DATE  18220096
0701RM     END-IF.                                                      18230096
                                                                        18240096
           MOVE HO100-WHATTR-E-BUS-LOC-IND TO TSTR000-E-BUS-LOC-IND.    18250096
           MOVE HO100-WHATTR-DST-IND       TO TSTR000-DST-CDE.          18260096
                                                                        18270096
      * ------------------------------------------------------------- * 18280096
      * CREATE DC CODE FROM DC NBR.  IF THE DC1 NBR DOES NOT FALL       18290096
      * WITHIN THE RANGE, USE THE LAST 3 BYTES OF THE WHATTR DC NBR     18300096
      * ------------------------------------------------------------- * 18310096
       6320-DETERMINE-DC-CODE.                                          18320096
                                                                        18330096
           EVALUATE TSTR000-DC1-NMBR                                    18340096
              WHEN PC-085                                               18350096
                 MOVE PC-DC1                  TO TSTR000-DC-CODE        18360096
              WHEN PC-810                                               18370096
                 MOVE PC-DC2                  TO TSTR000-DC-CODE        18380096
              WHEN PC-087                                               18390096
                 MOVE PC-DC3                  TO TSTR000-DC-CODE        18400096
              WHEN PC-830                                               18410096
                 MOVE PC-DC4                  TO TSTR000-DC-CODE        18420096
              WHEN PC-840                                               18430096
                 MOVE PC-DC5                  TO TSTR000-DC-CODE        18440096
              WHEN PC-845                                               18450096
                 MOVE PC-DC6                  TO TSTR000-DC-CODE        18460096
              WHEN PC-870                                               18470096
                 MOVE PC-DC7                  TO TSTR000-DC-CODE        18480096
              WHEN PC-801                                               18490096
                 MOVE PC-DC8                  TO TSTR000-DC-CODE        18500096
              WHEN OTHER                                                18510096
                  MOVE HO100-WHATTR-DC-NBR2-4 TO TSTR000-DC-CODE        18520096
           END-EVALUATE.                                                18530096
      * ------------------------------------------------------------- * 18540096
      * PROCESS THE WH STORE ASSIGN MESSAGES                            18550096
      * ------------------------------------------------------------- * 18560096
       6400-PROCESS-WH-STR-ASSIGN.                                      18570096
           ADD 1 TO PA-WH-STR-ASSIGN-MESSAGES.                          18580096
           MOVE HO100-SA-STORE-NUMBER      TO PV-KEY-NBR.               18590096
                                                                        18600096
0504RM*** WR27051 - STORES EXPANSION - BYPASS WAREHOUSES > 999          18610099
0504RM     IF (HO100-SA-STORE-NUMBER > 999) OR                          18620099
0504RM        (HO100-SA-WH           > 999)                             18630099
0504RM         ADD 1            TO PA-WHSTASG-BYPASS                    18640099
0504RM     ELSE                                                         18650099
0504RM         PERFORM 6405-PROCESS-LEGACY-WHSTASG                      18660099
0504RM     END-IF.                                                      18670099
                                                                        18680099
      * ------------------------------------------------------------- * 18690099
      * ONLY PROCESS WAREHOUSE STORE ASSIGN DATA W/ STORES < 1000     * 18700099
      * ------------------------------------------------------------- * 18710099
0504RM 6405-PROCESS-LEGACY-WHSTASG.                                     18720099
           PERFORM 7600-SELECT-STORE-ROW.                               18730096
           IF PS-INPUT-REC-ERROR                                        18740096
               ADD 1 TO PA-WH-STR-ASSIGN-ERRORS                         18750096
           ELSE                                                         18760096
               IF HO100-ACTN-TYP-INSERT                                 18770096
                   PERFORM 6410-UPDATE-WH-ASSIGN-DATA                   18780096
                   IF PS-INPUT-REC-ERROR                                18790096
                       ADD 1 TO PA-WH-STR-ASSIGN-ERRORS                 18800096
                   ELSE                                                 18810096
                       ADD 1 TO PA-WH-STR-ASSIGN-INSERTS                18820096
                   END-IF                                               18830096
               ELSE                                                     18840096
                   IF HO100-ACTN-TYP-DELETE                             18850096
                       PERFORM 6460-DELETE-DC-DATES                     18860096
                       IF PS-INPUT-REC-ERROR                            18870096
                           ADD 1 TO PA-WH-STR-ASSIGN-ERRORS             18880096
                       ELSE                                             18890096
                           ADD 1 TO PA-WH-STR-ASSIGN-DELETES            18900096
                       END-IF                                           18910096
0801RM* WR22871                                                         18920096
0801RM             ELSE                                                 18930099
0801RM                 IF HO100-ACTN-TYP-UPDATE                         18940096
0902RM* WR23765                                                         18950099
0902RM                     IF HO100-REPLACE-DC1 OR HO100-REPLACE-DC2    18960099
0801RM                         PERFORM 6496-REACTIVE-DC                 18970099
0902RM                     ELSE                                         18980099
0902RM                         PERFORM 6415-UPDATE-FUTURE-STORE-WH      18990099
0902RM                     END-IF                                       19000099
                           ADD 1 TO PA-WH-STR-ASSIGN-UPDATES            19010096
                       END-IF                                           19020096
                   END-IF                                               19030096
               END-IF                                                   19040096
           END-IF.                                                      19050096
                                                                        19060096
           IF PS-INPUT-REC-ERROR                                        19070096
               CONTINUE                                                 19080096
           ELSE                                                         19090096
               PERFORM 7610-UPDATE-STORE-ROW                            19100096
           END-IF.                                                      19110096
                                                                        19120096
      * ------------------------------------------------------------- * 19130096
      * UPDATE THE STORE TABLE WITH THE WH STORE ASSIGN DATA            19140096
      * IF DC1 HAS VALID START DATES, SET DC1 STOP DATES AND USE DC2    19150096
      * AREA TO HOLD WH_STORE_ASSIGN DATA.                              19160096
      * IF DC2 HAS VALID START DATES, SET DC2 STOP DATES AND USE DC1    19170096
      * AREA TO HOLD WH_STORE_ASSIGN DATA.                              19180096
      * IF NEITHER HAS VALID START DATES, USE DC1 AREA TO HOLD          19190096
      * WH_STORE_ASSIGN DATA.                                           19200096
      * ------------------------------------------------------------- * 19210096
       6410-UPDATE-WH-ASSIGN-DATA.                                      19220096
0801RM* WR22871                                                         19230096
0801RM*-- ADDED CODE TO CHECK IF THERE IS AN ATTEMPT TO ADD A FUTURE    19240096
0801RM*-- DC TO A CLOSED STORE -- THIS WILL RESULT IN AN ERROR AND      19250096
0801RM*-- THE RECORD WILL NOT BE PROCESSED.                             19260096
0801RM     IF TSTR000-CLOSED-DATE NOT = PC-DEFAULT-DATE                 19270096
0801RM        AND                                                       19280096
0801RM        HO100-SA-ASSIGN-DATE > PV-CURRENT-DATE                    19290096
0801RM         DISPLAY '@@@@@@@@@@@@@@@@@@@@@@@@@@@'                    19300096
0801RM         DISPLAY 'ERROR IN 6410-UPDATE-WH-ASSIGN-DATA'            19310096
0801RM         DISPLAY 'TRYING TO ASSIGN A FUTURE WH ON A CLOSED STORE '19320096
0801RM                   HO100-SA-WH-2-4                                19330096
0801RM         DISPLAY ' FOR STORE ' HO100-SA-STORE-NUMBER              19340096
0801RM         DISPLAY '@@@@@@@@@@@@@@@@@@@@@@@@@@@'                    19350096
0801RM         SET PS-INPUT-REC-ERROR TO TRUE                           19360096
0801RM         PERFORM 9920-WRITE-ERROR-RECORD                          19370096
0801RM     ELSE                                                         19380096
0801RM*-- NEW STORE FIRST DC ASSIGN                                     19390096
0801RM         IF TSTR000-DC1-RCT-STOP-DATE  = PC-DEFAULT-DATE          19400096
0801RM            AND                                                   19410096
0801RM            TSTR000-DC1-RCT-START-DATE = PC-DEFAULT-DATE          19420096
0801RM            AND                                                   19430096
0801RM            TSTR000-DC2-RCT-STOP-DATE  = PC-DEFAULT-DATE          19440096
0801RM            AND                                                   19450096
0801RM            TSTR000-DC2-RCT-START-DATE = PC-DEFAULT-DATE          19460096
0801RM             PERFORM 6450-LOAD-DC1-DATA                           19470096
0801RM         ELSE                                                     19480099
0801RM*-- EXISTING STORE, DC2 NOT ASSIGNED, END DC1 & LOAD DC2          19490096
0801RM             IF TSTR000-DC1-RCT-START-DATE NOT = PC-DEFAULT-DATE  19500096
0801RM                AND                                               19510096
0801RM                TSTR000-DC1-RCT-STOP-DATE = PC-DEFAULT-DATE       19520096
0801RM                AND                                               19530096
0801RM                TSTR000-DC2-RCT-START-DATE = PC-DEFAULT-DATE      19540096
0801RM                 PERFORM 6420-LOAD-DC1-STOP-DATES                 19550096
0801RM                 PERFORM 6430-LOAD-DC2-DATES                      19560096
0801RM             ELSE                                                 19570096
0801RM*-- EXISTING STORE, BOTH DCS ASSIGNED, DC1 DATES < DC2            19580096
0801RM*-- END DC1 AND LOAD DC2                                          19590096
0801RM                 IF TSTR000-DC1-RCT-START-DATE <                  19600096
0801RM                    TSTR000-DC2-RCT-START-DATE                    19610096
0801RM                    AND                                           19620096
0801RM                    TSTR000-DC2-RCT-START-DATE NOT =              19630096
0801RM                    PC-DEFAULT-DATE                               19640096
0801RM                     PERFORM 6440-LOAD-DC2-STOP-DATES             19650096
0801RM                     PERFORM 6450-LOAD-DC1-DATA                   19660096
0801RM                 ELSE                                             19670096
0801RM*-- EXISTING STORE, BOTH DCS ASSIGNED, DC2 DATES > DC1            19680096
0801RM*-- END DC2 AND LOAD DC1                                          19690096
0801RM                     IF TSTR000-DC2-RCT-START-DATE <              19700096
0801RM                        TSTR000-DC1-RCT-START-DATE                19710096
0801RM                        AND                                       19720096
0801RM                        TSTR000-DC1-RCT-START-DATE NOT =          19730096
0801RM                        PC-DEFAULT-DATE                           19740096
0801RM                         PERFORM 6420-LOAD-DC1-STOP-DATES         19750096
0801RM                         PERFORM 6430-LOAD-DC2-DATES              19760096
0801RM                     ELSE                                         19770096
0801RM*-- ERROR CANNOT PROCESS REQUEST                                  19780096
0801RM                         DISPLAY '@@@@@@@@@@@@@@@@@@@@@@@@@@@'    19790096
0801RM                         DISPLAY                                  19800096
0801RM                          'ERROR IN 6410-UPDATE-WH-ASSIGN-DATA'   19810096
0801RM                         DISPLAY 'ERROR ASSIGNING A WH TO STORE ' 19820096
0801RM                                  HO100-SA-WH-2-4                 19830096
0801RM                         DISPLAY ' FOR STORE '                    19840096
0801RM                                 HO100-SA-STORE-NUMBER            19850096
0801RM                         DISPLAY '@@@@@@@@@@@@@@@@@@@@@@@@@@@'    19860096
0801RM                         SET PS-INPUT-REC-ERROR TO TRUE           19870096
0801RM                         PERFORM 9920-WRITE-ERROR-RECORD          19880096
0801RM                     END-IF                                       19890096
0801RM                 END-IF                                           19900096
0801RM             END-IF                                               19910096
0801RM         END-IF                                                   19920096
0801RM     END-IF.                                                      19930096
0801RM*        IF TSTR000-DC1-PO-STOP-DATE = PC-DEFAULT-DATE            19940096
0801RM*           AND                                                   19950096
0801RM*           TSTR000-DC1-PO-START-DATE NOT = PC-DEFAULT-DATE       19960096
0801RM*            PERFORM 6420-LOAD-DC1-STOP-DATES                     19970096
0801RM*            PERFORM 6430-LOAD-DC2-DATES                          19980096
0801RM*        ELSE                                                     19990096
0801RM*            IF TSTR000-DC1-PO-STOP-DATE = PC-DEFAULT-DATE        20000096
0801RM*               AND                                               20010096
0801RM*               TSTR000-DC1-PO-START-DATE = PC-DEFAULT-DATE       20020096
0801RM*               AND                                               20030096
0801RM*               TSTR000-DC2-PO-STOP-DATE = PC-DEFAULT-DATE        20040096
0801RM*               AND                                               20050096
0801RM*               TSTR000-DC2-PO-START-DATE = PC-DEFAULT-DATE       20060096
0801RM*                PERFORM 6450-LOAD-DC1-DATA                       20070096
0801RM*            ELSE                                                 20080096
0801RM*                PERFORM 6440-LOAD-DC2-STOP-DATES                 20090096
0801RM*                PERFORM 6450-LOAD-DC1-DATA                       20100096
0801RM*            END-IF                                               20110096
0801RM*        END-IF                                                   20120096
0801RM*    END-IF.                                                      20130096
                                                                        20140096
0902RM* WR23765                                                         20150099
0902RM* ------------------------------------------------------------- * 20160099
0902RM* UPDATE EITHER WH OR RECEIPT START DATE ON A FUTURE STORE        20170099
0902RM* USING THE 'OLD' VALUES AS A REFERENCE.                          20180099
0902RM* ------------------------------------------------------------- * 20190099
0902RM 6415-UPDATE-FUTURE-STORE-WH.                                     20200099
0902RM*                                                                 20210099
**TEMP*    DISPLAY '6415-UPDATE-FUTURE-STORE-WH.'                       20220099
**TEMP*    DISPLAY 'TSTR000-OPENED-DATE        ' TSTR000-OPENED-DATE.   20230099
**TEMP*    DISPLAY 'TSTR000-DC2-NMBR           ' TSTR000-DC2-NMBR.      20240099
**TEMP*    DISPLAY 'TSTR000-DC1-RCT-START-DATE '                        20250099
**TEMP*             TSTR000-DC1-RCT-START-DATE.                         20260099
**TEMP*    DISPLAY 'HO100-SA-ASSIGN-DATE       ' HO100-SA-ASSIGN-DATE.  20270099
**TEMP*    DISPLAY 'TSTR000-DC1-NMBR           ' TSTR000-DC1-NMBR.      20280099
**TEMP*    DISPLAY 'HO100-SA-WH                ' HO100-SA-WH-2-4.       20290099
**TEMP*    DISPLAY 'HO100-SA-OLD-WH            ' HO100-SA-OLD-WH-2-4.   20300099
**TEMP*    DISPLAY 'HO100-SA-OLD-ASSIGN-DATE   '                        20310099
**TEMP*            HO100-SA-OLD-ASSIGN-DATE.                            20320099
**TEMP*    DISPLAY 'HO100-SA-OLD-PO-STRT-DATE  '                        20330099
**TEMP*            HO100-SA-OLD-PO-STRT-DATE.                           20340099
                                                                        20350099
1002RM     IF HO100-SA-OLD-WH-2-4 = TSTR000-DC1-NMBR                    20360099
1002RM        AND                                                       20370099
1002RM        HO100-SA-OLD-ASSIGN-DATE  = TSTR000-DC1-RCT-START-DATE    20380099
1002RM        AND                                                       20390099
1002RM        HO100-SA-OLD-PO-STRT-DATE = TSTR000-DC1-PO-START-DATE     20400099
1002RM         MOVE HO100-SA-WH-2-4      TO TSTR000-DC1-NMBR            20410099
1002RM         MOVE HO100-SA-ASSIGN-DATE TO                             20420099
1002RM              TSTR000-DC1-RCT-START-DATE                          20430099
1002RM     ELSE                                                         20440099
1002RM         IF HO100-SA-OLD-WH-2-4 = TSTR000-DC2-NMBR                20450099
1002RM            AND                                                   20460099
1002RM            HO100-SA-OLD-ASSIGN-DATE =                            20470099
1002RM            TSTR000-DC2-RCT-START-DATE                            20480099
1002RM            AND                                                   20490099
1002RM            HO100-SA-OLD-PO-STRT-DATE =                           20500099
1002RM            TSTR000-DC2-PO-START-DATE                             20510099
1002RM             MOVE HO100-SA-WH-2-4  TO TSTR000-DC2-NMBR            20520099
1002RM             MOVE HO100-SA-ASSIGN-DATE TO                         20530099
1002RM                  TSTR000-DC2-RCT-START-DATE                      20540099
1002RM         END-IF                                                   20550099
1002RM     END-IF.                                                      20560099
      * ------------------------------------------------------------- * 20570096
      * LOAD STOP DATES ON DC1 DATA                                     20580096
      * ------------------------------------------------------------- * 20590096
       6420-LOAD-DC1-STOP-DATES.                                        20600096
                                                                        20610096
           MOVE HO100-SA-PO-STRT-DTE TO PV-START-DATE.                  20620096
           MOVE PC-ONE               TO PV-DAYS.                        20630096
           PERFORM 8600-DECREMENT-DATE.                                 20640096
           MOVE PV-DATE-DEC-DAYS     TO TSTR000-DC1-PO-STOP-DATE.       20650096
                                                                        20660096
           MOVE HO100-SA-ASSIGN-DATE TO PV-START-DATE                   20670096
           MOVE PC-ONE               TO PV-DAYS.                        20680096
           PERFORM 8600-DECREMENT-DATE.                                 20690096
           MOVE PV-DATE-DEC-DAYS     TO TSTR000-DC1-RCT-STOP-DATE.      20700096
      * ------------------------------------------------------------- * 20710096
      * UPDATE THE DC2 DATA                                             20720096
      * ------------------------------------------------------------- * 20730096
       6430-LOAD-DC2-DATES.                                             20740096
                                                                        20750096
           MOVE PC-DEFAULT-DATE      TO TSTR000-DC2-PO-STOP-DATE        20760096
                                        TSTR000-DC2-RCT-STOP-DATE.      20770096
           MOVE HO100-SA-WH-2-4      TO TSTR000-DC2-NMBR.               20780096
           MOVE HO100-SA-ASSIGN-DATE TO TSTR000-DC2-RCT-START-DATE.     20790096
           MOVE HO100-SA-PO-STRT-DTE TO TSTR000-DC2-PO-START-DATE.      20800096
                                                                        20810096
      * ------------------------------------------------------------- * 20820096
      * UPDATE THE DC2 STOP DATES                                       20830096
      * ------------------------------------------------------------- * 20840096
       6440-LOAD-DC2-STOP-DATES.                                        20850096
           MOVE HO100-SA-PO-STRT-DTE TO PV-START-DATE.                  20860096
           MOVE PC-ONE               TO PV-DAYS.                        20870096
           PERFORM 8600-DECREMENT-DATE.                                 20880096
           MOVE PV-DATE-DEC-DAYS     TO TSTR000-DC2-PO-STOP-DATE.       20890096
                                                                        20900096
           MOVE HO100-SA-ASSIGN-DATE TO PV-START-DATE.                  20910096
           MOVE PC-ONE               TO PV-DAYS.                        20920096
           PERFORM 8600-DECREMENT-DATE.                                 20930096
           MOVE PV-DATE-DEC-DAYS     TO TSTR000-DC2-RCT-STOP-DATE.      20940096
                                                                        20950096
      * ------------------------------------------------------------- * 20960096
      * LOAD THE DC1 DATA                                               20970096
      * ------------------------------------------------------------- * 20980096
       6450-LOAD-DC1-DATA.                                              20990096
                                                                        21000096
           MOVE PC-DEFAULT-DATE      TO TSTR000-DC1-PO-STOP-DATE        21010096
                                        TSTR000-DC1-RCT-STOP-DATE.      21020096
           MOVE HO100-SA-WH-2-4      TO TSTR000-DC1-NMBR.               21030096
           MOVE HO100-SA-ASSIGN-DATE TO TSTR000-DC1-RCT-START-DATE.     21040096
           MOVE HO100-SA-PO-STRT-DTE TO TSTR000-DC1-PO-START-DATE.      21050096
                                                                        21060096
      * ------------------------------------------------------------- * 21070096
      * CONTROLS DELETING OF EXISTING DC DATA                           21080096
      * ------------------------------------------------------------- * 21090096
       6460-DELETE-DC-DATES.                                            21100096
      *-- IF INPUT WH STORE ASSIGN = DC 1 MOVE DC2 DATA TO DC1 AND      21110096
      *-- CLEAR DC2 DATA                                                21120096
      *-- IF INPUT WH STORE ASSIGN = DC 2 MOVE MOVE 9S TO END DATES     21130096
      *-- OF DC1 AND CLEAR DC2 DATA                                     21140096
      *-- IF INPUT WH STORE ASSIGN NOT = DC1 OR DC2 - ERROR OUT.        21150096
           IF HO100-SA-WH-2-4 = TSTR000-DC1-NMBR                        21160096
               PERFORM 6470-CHECK-DC1                                   21170096
           ELSE                                                         21180096
               IF HO100-SA-WH-2-4 = TSTR000-DC2-NMBR                    21190096
                   PERFORM 6480-CHECK-DC2                               21200096
               END-IF                                                   21210096
           END-IF.                                                      21220096
                                                                        21230096
      * ------------------------------------------------------------- * 21240096
      * DELETES EXISTING DC1 DATA AND REPLACES IT WITH DC2 DATA         21250096
      * ------------------------------------------------------------- * 21260096
       6470-CHECK-DC1.                                                  21270096
      *-- IF THERE IS ONLY ONE DC, ERROR OUT - MUST HAVE AT LEAST       21280096
      *-- ONE DC.                                                       21290096
      *-- IF INPUT WH STORE ASSIGN = DC 1 AND RCT DT MATCHES MOVE DC2   21300096
      *-- TO DC 1 AND CLEAR OUT DC2                                     21310096
      *-- IF INPUT WH STORE ASSIGN = DC 2 AND RCT DT DOES NOT MATCH     21320096
      *-- CHECK DC2 WH AND RCT DTE                                      21330096
      *-- IF NEITHER MATCH - BYPASS                                     21340096
           IF TSTR000-DC2-NMBR = SPACES OR LOW-VALUES                   21350096
               DISPLAY '@@@@@@@@@@@@@@@@@@@@@@@@@@@'                    21360096
               DISPLAY ' ERROR IN 6470-CHECK-DC1'                       21370096
               DISPLAY ' TRYING TO DELETE ONLY DC '                     21380096
                         HO100-SA-WH-2-4                                21390096
               DISPLAY ' FOR STORE ' HO100-SA-STORE-NUMBER              21400096
               DISPLAY '@@@@@@@@@@@@@@@@@@@@@@@@@@@@'                   21410096
               PERFORM 9920-WRITE-ERROR-RECORD                          21420096
               SET PS-INPUT-REC-ERROR TO TRUE                           21430096
           ELSE                                                         21440096
               IF HO100-SA-ASSIGN-DATE = TSTR000-DC1-RCT-START-DATE     21450096
                   MOVE TSTR000-DC2-NMBR       TO                       21460096
                        TSTR000-DC1-NMBR                                21470096
                   MOVE TSTR000-DC2-RCT-START-DATE TO                   21480096
                        TSTR000-DC1-RCT-START-DATE                      21490096
                   MOVE TSTR000-DC2-PO-START-DATE TO                    21500096
                        TSTR000-DC1-PO-START-DATE                       21510096
                   MOVE PC-DEFAULT-DATE TO TSTR000-DC1-PO-STOP-DATE     21520096
                                           TSTR000-DC1-RCT-STOP-DATE    21530096
                                           TSTR000-DC2-RCT-START-DATE   21540096
                                           TSTR000-DC2-RCT-STOP-DATE    21550096
                                           TSTR000-DC2-PO-START-DATE    21560096
                                           TSTR000-DC2-PO-STOP-DATE     21570096
                   MOVE LOW-VALUES      TO TSTR000-DC2-NMBR             21580096
               ELSE                                                     21590096
                   IF HO100-SA-ASSIGN-DATE = TSTR000-DC2-RCT-START-DATE 21600096
                       PERFORM 6480-CHECK-DC2                           21610096
                   END-IF                                               21620096
               END-IF                                                   21630096
           END-IF.                                                      21640096
                                                                        21650096
      * ------------------------------------------------------------- * 21660096
      * DELETES EXISTING DC2 DATA                                       21670096
      * ------------------------------------------------------------- * 21680096
       6480-CHECK-DC2.                                                  21690096
      *-- IF INPUT WH STORE ASSIGN = DC 2 CLEAR OUT DC2 AND DC1 END DATE21700096
      *-- IF NEITHER MATCH - BYPASS PROCESSING RECORD                   21710096
           IF HO100-SA-ASSIGN-DATE = TSTR000-DC2-RCT-START-DATE         21720096
               IF HO100-SA-WH-2-4 = TSTR000-DC2-NMBR                    21730096
                   MOVE PC-DEFAULT-DATE TO TSTR000-DC1-PO-STOP-DATE     21740096
                                           TSTR000-DC1-RCT-STOP-DATE    21750096
                                           TSTR000-DC2-RCT-START-DATE   21760096
                                           TSTR000-DC2-RCT-STOP-DATE    21770096
                                           TSTR000-DC2-PO-START-DATE    21780096
                                           TSTR000-DC2-PO-STOP-DATE     21790096
                   MOVE LOW-VALUES  TO TSTR000-DC2-NMBR                 21800096
               END-IF                                                   21810096
           END-IF.                                                      21820096
0801RM* WR22871                                                         21830096
0801RM* ------------------------------------------------------------- * 21840096
0801RM* UPDATE THE DC1 OR DC2 STOP DATES WITH THE STORE CLOSE DATE    * 21850096
0801RM* MINUS THE STOP ORDER DAYS.                                    * 21860096
0801RM* DELETE THE FUTURE DC (IF FOUND)                               * 21870096
0801RM* ------------------------------------------------------------- * 21880096
0801RM 6490-SET-DC-STOP-DATES.                                          21890096
0801RM                                                                  21900096
0801RM     IF HO100-STR-CLOSE-DATE <= PV-CURRENT-DATE                   21910096
0801RM         MOVE PV-CURRENT-DATE           TO PV-DATE-DEC-DAYS       21920096
0801RM     ELSE                                                         21930096
0801RM         MOVE HO100-STR-CLOSE-DATE      TO PV-START-DATE          21940096
0801RM         MOVE HO100-STR-STOP-ORDER-DAYS TO PV-DAYS                21950096
0801RM         PERFORM 8600-DECREMENT-DATE                              21960096
0801RM     END-IF.                                                      21970096
0801RM                                                                  21980096
0801RM*-- IF DC1 RCT/PO START DATES > CURRENT DATE                      21990096
0801RM*--    AND DC1 RCT/PO START DATES > DC2 RCT/PO DATES -            22000096
0801RM*--    DC1 IS A FUTURE ASSIGNMENT                                 22010096
0801RM*--    LOAD DC2 STOP DATES                                        22020096
0801RM*-- ELSE                                                          22030096
0801RM*-- IF DC1 RCT/PO START DATES > DC2 RCT/PO DATES -                22040096
0801RM*--    LOAD DC1 STOP DATES                                        22050096
0801RM*-- ELSE                                                          22060096
0801RM*-- IF DC1 RCT/PO END DATES = 9'S AND                             22070096
0801RM*--    DC1 RCT/PO START DATES NOT = 9'S - LOAD DC1 STOP DATES     22080096
0801RM*-- ELSE                                                          22090096
0801RM*-- IF DC2 START/STOP DATES = 9'S - LOAD DC1 STOP DATES           22100096
0801RM*-- ELSE                                                          22110096
0801RM*-- IF DC1 START DATES <= CURRENT DATE AND                        22120096
0801RM*--    DC1 END DATES > CURRENT DATE  - LOAD DC1 STOP DATES        22130096
0801RM*-- ELSE                                                          22140096
0801RM*-- LOAD DC2 STOP DATES                                           22150096
0801RM     IF (TSTR000-DC1-RCT-START-DATE > PV-CURRENT-DATE)            22160096
0801RM        AND                                                       22170096
0801RM        (TSTR000-DC1-PO-START-DATE  > PV-CURRENT-DATE)            22180096
0801RM        AND                                                       22190096
0801RM        (TSTR000-DC1-RCT-START-DATE > TSTR000-DC2-RCT-STOP-DATE)  22200096
0801RM        AND                                                       22210096
0801RM        (TSTR000-DC1-PO-START-DATE > TSTR000-DC2-PO-STOP-DATE)    22220096
0801RM         PERFORM 6494-LOAD-DC2-STOP-DATES                         22230096
0801RM     ELSE                                                         22240096
0801RM         IF (TSTR000-DC1-RCT-START-DATE >                         22250096
0801RM             TSTR000-DC2-RCT-STOP-DATE)                           22260096
0801RM           AND                                                    22270096
0801RM            (TSTR000-DC1-PO-START-DATE >                          22280096
0801RM             TSTR000-DC2-PO-STOP-DATE)                            22290096
0801RM           AND                                                    22300096
0801RM            (TSTR000-DC1-RCT-START-DATE <=                        22310096
0801RM              PV-CURRENT-DATE)                                    22320096
0801RM           AND                                                    22330096
0801RM            (TSTR000-DC1-PO-START-DATE <=                         22340096
0801RM             PV-CURRENT-DATE)                                     22350096
0801RM             PERFORM 6492-LOAD-DC1-STOP-DATES                     22360096
0801RM         ELSE                                                     22370096
0801RM             IF (TSTR000-DC1-RCT-STOP-DATE =                      22380096
0801RM                  PC-DEFAULT-DATE)                                22390096
0801RM                 AND                                              22400096
0801RM                (TSTR000-DC1-PO-STOP-DATE =                       22410096
0801RM                  PC-DEFAULT-DATE)                                22420096
0801RM                 AND                                              22430096
0801RM                (TSTR000-DC1-RCT-START-DATE NOT =                 22440096
0801RM                  PC-DEFAULT-DATE)                                22450096
0801RM                 AND                                              22460096
0801RM                 (TSTR000-DC1-PO-START-DATE NOT =                 22470096
0801RM                  PC-DEFAULT-DATE)                                22480096
0801RM                 PERFORM 6492-LOAD-DC1-STOP-DATES                 22490096
0801RM             ELSE                                                 22500096
0801RM                 IF (TSTR000-DC2-RCT-START-DATE =                 22510096
0801RM                     PC-DEFAULT-DATE)                             22520096
0801RM                    AND                                           22530096
0801RM                    (TSTR000-DC2-PO-START-DATE =                  22540096
0801RM                     PC-DEFAULT-DATE)                             22550096
0801RM                    AND                                           22560096
0801RM                    (TSTR000-DC2-RCT-STOP-DATE =                  22570096
0801RM                     PC-DEFAULT-DATE)                             22580096
0801RM                    AND                                           22590096
0801RM                    (TSTR000-DC2-PO-STOP-DATE =                   22600096
0801RM                     PC-DEFAULT-DATE)                             22610096
0801RM                     PERFORM 6492-LOAD-DC1-STOP-DATES             22620096
0801RM                 ELSE                                             22630096
0801RM                     IF (TSTR000-DC1-RCT-START-DATE <             22640096
0801RM                         PV-CURRENT-DATE)                         22650096
0801RM                        AND                                       22660096
0801RM                        (TSTR000-DC1-RCT-STOP-DATE >=             22670096
0801RM                         PV-CURRENT-DATE)                         22680096
0801RM                          PERFORM 6492-LOAD-DC1-STOP-DATES        22690096
0801RM                     ELSE                                         22700096
0801RM                          PERFORM 6494-LOAD-DC2-STOP-DATES        22710096
0801RM                     END-IF                                       22720096
0801RM                 END-IF                                           22730096
0801RM             END-IF                                               22740096
0801RM         END-IF                                                   22750096
0801RM     END-IF.                                                      22760096
0801RM                                                                  22770096
0801RM* ------------------------------------------------------------- * 22780096
0801RM* LOAD THE CALCULATED DC1 END DATE TO THE STOP DATES              22790096
0801RM* IF THE CALCULATED END DATE < START DATE, LOAD THE               22800096
0801RM* CURRENT SYSTEM DATE.  INITIALIZE DC2 IF FUTURE ASSIGNMENT       22810096
0801RM* ------------------------------------------------------------- * 22820096
0801RM 6492-LOAD-DC1-STOP-DATES.                                        22830096
0801RM     IF (PV-DATE-DEC-DAYS < TSTR000-DC1-PO-START-DATE)            22840096
0801RM     OR (PV-DATE-DEC-DAYS < PV-CURRENT-DATE)                      22850096
0801RM         MOVE PV-CURRENT-DATE  TO TSTR000-DC1-PO-STOP-DATE        22860096
0801RM     ELSE                                                         22870096
0801RM         MOVE PV-DATE-DEC-DAYS TO TSTR000-DC1-PO-STOP-DATE        22880096
0801RM     END-IF.                                                      22890096
0801RM                                                                  22900096
0801RM     IF (PV-DATE-DEC-DAYS < TSTR000-DC1-RCT-START-DATE)           22910096
0801RM     OR (PV-DATE-DEC-DAYS < PV-CURRENT-DATE)                      22920096
0801RM         MOVE PV-CURRENT-DATE  TO TSTR000-DC1-RCT-STOP-DATE       22930096
0801RM     ELSE                                                         22940096
0801RM         MOVE PV-DATE-DEC-DAYS TO TSTR000-DC1-RCT-STOP-DATE       22950096
0801RM     END-IF.                                                      22960096
0801RM                                                                  22970096
0801RM     IF (TSTR000-DC2-RCT-START-DATE > PV-CURRENT-DATE)            22980096
0801RM     OR (TSTR000-DC2-PO-START-DATE > PV-CURRENT-DATE)             22990096
0801RM         MOVE SPACES          TO TSTR000-DC2-NMBR                 23000096
0801RM         MOVE PC-DEFAULT-DATE TO TSTR000-DC2-RCT-START-DATE       23010096
0801RM                                 TSTR000-DC2-RCT-STOP-DATE        23020096
0801RM                                 TSTR000-DC2-PO-START-DATE        23030096
0801RM                                 TSTR000-DC2-PO-STOP-DATE         23040096
0801RM     END-IF.                                                      23050096
                                                                        23060096
0801RM* ------------------------------------------------------------- * 23070096
0801RM*-- LOAD THE CALCULATED DC2 END DATE TO THE STOP DATES            23080096
0801RM*-- IF THE CALCULATED END DATE < START DATE, LOAD THE             23090096
0801RM*-- CURRENT SYSTEM DATE. INITIALIZE DC1 IF FUTURE ASSIGNMENT      23100096
0801RM*-- IF DC1 IS FUTURE,  MOVE DC2 ASSIGNMENT TO DC1 AND             23110096
0801RM*-- CLEAR OUT DC2                                                 23120096
0801RM* ------------------------------------------------------------- * 23130096
0801RM 6494-LOAD-DC2-STOP-DATES.                                        23140096
0801RM     IF PV-DATE-DEC-DAYS < TSTR000-DC2-PO-START-DATE              23150096
0801RM     OR (PV-DATE-DEC-DAYS < PV-CURRENT-DATE)                      23160096
0801RM         MOVE PV-CURRENT-DATE  TO TSTR000-DC2-PO-STOP-DATE        23170096
0801RM     ELSE                                                         23180096
0801RM         MOVE PV-DATE-DEC-DAYS TO TSTR000-DC2-PO-STOP-DATE        23190096
0801RM     END-IF.                                                      23200096
0801RM                                                                  23210096
0801RM     IF PV-DATE-DEC-DAYS < TSTR000-DC2-RCT-START-DATE             23220096
0801RM     OR (PV-DATE-DEC-DAYS < PV-CURRENT-DATE)                      23230096
0801RM         MOVE PV-CURRENT-DATE  TO TSTR000-DC2-RCT-STOP-DATE       23240096
0801RM     ELSE                                                         23250096
0801RM         MOVE PV-DATE-DEC-DAYS TO TSTR000-DC2-RCT-STOP-DATE       23260096
0801RM     END-IF.                                                      23270096
0801RM                                                                  23280096
0801RM     IF (TSTR000-DC1-RCT-START-DATE > PV-CURRENT-DATE)            23290096
0801RM     OR (TSTR000-DC1-PO-START-DATE > PV-CURRENT-DATE)             23300096
0801RM         MOVE TSTR000-DC2-NMBR           TO                       23310096
0801RM              TSTR000-DC1-NMBR                                    23320096
0801RM         MOVE TSTR000-DC2-RCT-START-DATE TO                       23330096
0801RM              TSTR000-DC1-RCT-START-DATE                          23340096
0801RM         MOVE TSTR000-DC2-RCT-STOP-DATE  TO                       23350096
0801RM              TSTR000-DC1-RCT-STOP-DATE                           23360096
0801RM         MOVE TSTR000-DC2-PO-START-DATE  TO                       23370096
0801RM              TSTR000-DC1-PO-START-DATE                           23380096
0801RM         MOVE TSTR000-DC2-PO-STOP-DATE   TO                       23390096
0801RM              TSTR000-DC1-PO-STOP-DATE                            23400096
0801RM         MOVE SPACES          TO TSTR000-DC2-NMBR                 23410096
0801RM         MOVE PC-DEFAULT-DATE TO TSTR000-DC2-RCT-START-DATE       23420096
0801RM                                 TSTR000-DC2-RCT-STOP-DATE        23430096
0801RM                                 TSTR000-DC2-PO-START-DATE        23440096
0801RM                                 TSTR000-DC2-PO-STOP-DATE         23450096
0801RM     END-IF.                                                      23460096
0801RM* ------------------------------------------------------------- * 23470096
0801RM* REACTIVATE DC1/DC2 WHEN STORE CLOSE DATE IS SET BACK TO 9'S   * 23480096
0801RM* WILL FORCE MOST CURRENT DC ASSIGNMENT TO BE IN DC1. IF        * 23490096
0801RM* DC2 IS REPLACED, IT WILL USE THE DC1 START DATE MINUS 1 DAY   * 23500096
0801RM* FOR THE END DATES OF DC2.                                     * 23510096
0801RM* ------------------------------------------------------------- * 23520096
0801RM 6496-REACTIVE-DC.                                                23530096
0801RM                                                                  23540096
0801RM     IF HO100-REPLACE-DC1                                         23550096
0801RM         PERFORM 6450-LOAD-DC1-DATA                               23560096
0801RM     ELSE                                                         23570096
0801RM         IF HO100-REPLACE-DC2                                     23580096
0801RM             PERFORM 6430-LOAD-DC2-DATES                          23590096
0801RM             MOVE TSTR000-DC1-PO-START-DATE  TO PV-START-DATE     23600096
0801RM             MOVE PC-ONE                     TO PV-DAYS           23610096
0801RM             PERFORM 8600-DECREMENT-DATE                          23620096
0801RM             MOVE PV-DATE-DEC-DAYS           TO                   23630096
0801RM                  TSTR000-DC2-PO-STOP-DATE                        23640096
0801RM             MOVE TSTR000-DC1-RCT-START-DATE TO PV-START-DATE     23650096
0801RM             MOVE PC-ONE                     TO PV-DAYS           23660096
0801RM             PERFORM 8600-DECREMENT-DATE                          23670096
0801RM             MOVE PV-DATE-DEC-DAYS           TO                   23680096
0801RM                  TSTR000-DC2-RCT-STOP-DATE                       23690096
0801RM         END-IF                                                   23700096
0801RM     END-IF.                                                      23710096
0902RM* WR23765 -COMMENT OUT THE FOLLOWING PARAGRAPH. IT IS NOW         23720099
0902RM*           TAKEN CARE OF THRU THE WH_STORE_ASSIGN UPDATE TXN     23730099
1001RM* ------------------------------------------------------------- * 23740096
1001RM* CHANGE THE DC RCT START DATE WHEN THE STORE OPEN DATE CHANGES * 23750096
0302RM* OR WHEN THE START ORDER DAYS CHANGE.                          * 23760096
1001RM* FIND THE EARLIER OF THE TWO DC1/DC2 AND UPDATE THE START DATE * 23770096
1001RM* BY SUBTRACTING THE START ORDER DAYS FROM THE STORE OPEN DATE. * 23780096
1001RM* VERIFY THAT THE START DATE IS NOT AFTER THE END DATE.         * 23790096
1001RM* ------------------------------------------------------------- * 23800096
1001RM*6498-SET-DC-RCT-START-DATE.                                      23810099
1001RM*                                                                 23820099
1001RM*    MOVE HO100-STR-OPEN-DATE         TO PV-START-DATE.           23830099
1001RM*    MOVE HO100-STR-START-ORDER-DAYS  TO PV-DAYS.                 23840099
1001RM*    PERFORM 8600-DECREMENT-DATE.                                 23850099
1001RM*    IF (TSTR000-DC1-RCT-START-DATE < TSTR000-DC2-RCT-START-DATE) 23860099
1001RM*    AND                                                          23870099
1001RM*       (HO100-STR-DEF-WH-CHAR = TSTR000-DC1-NMBR)                23880099
1001RM*        IF PV-DATE-DEC-DAYS < TSTR000-DC1-RCT-STOP-DATE          23890099
1001RM*            MOVE PV-DATE-DEC-DAYS TO TSTR000-DC1-RCT-START-DATE  23900099
1001RM*        ELSE                                                     23910099
1001RM*            DISPLAY '@@@@@@@@@@@@@@@@@@@@@@@@@@@'                23920099
1001RM*            DISPLAY ' ERROR IN 6498-SET-DC-RCT-START-DATE.'      23930099
1001RM*            DISPLAY ' NEW CALCD START DATE > DC1 STOP DATE '     23940099
1001RM*            DISPLAY ' FOR STORE ' HO100-STR-NBR                  23950099
1001RM*            DISPLAY ' FOR DC    ' TSTR000-DC1-NMBR               23960099
1001RM*            DISPLAY ' DC1 START DATE ' TSTR000-DC1-RCT-START-DATE23970099
1001RM*            DISPLAY ' DC1 STOP DATE  ' TSTR000-DC1-RCT-STOP-DATE 23980099
1001RM*            DISPLAY ' CALCD DATE     ' PV-DATE-DEC-DAYS          23990099
1001RM*            DISPLAY '@@@@@@@@@@@@@@@@@@@@@@@@@@@'                24000099
0801RM*            SET PS-INPUT-REC-ERROR TO TRUE                       24010099
0801RM*            PERFORM 9920-WRITE-ERROR-RECORD                      24020099
1001RM*        END-IF                                                   24030099
1001RM*    ELSE                                                         24040099
1001RM*        IF (TSTR000-DC2-RCT-START-DATE <                         24050099
1001RM*            TSTR000-DC1-RCT-START-DATE)                          24060099
1001RM*        AND                                                      24070099
1001RM*           (HO100-STR-DEF-WH-CHAR = TSTR000-DC2-NMBR)            24080099
1001RM*            IF PV-DATE-DEC-DAYS < TSTR000-DC2-RCT-STOP-DATE      24090099
1001RM*                MOVE PV-DATE-DEC-DAYS TO                         24100099
1001RM*                     TSTR000-DC2-RCT-START-DATE                  24110099
1001RM*            ELSE                                                 24120099
1001RM*                DISPLAY '@@@@@@@@@@@@@@@@@@@@@@@@@@@'            24130099
1001RM*                DISPLAY ' ERROR IN 6498-SET-DC-RCT-START-DATE'   24140099
1001RM*                DISPLAY ' NEW CALCD START DATE > DC2 STOP DATE ' 24150099
1001RM*                DISPLAY ' FOR STORE ' HO100-STR-NBR              24160099
1001RM*                DISPLAY ' FOR DC    ' TSTR000-DC2-NMBR           24170099
1001RM*                DISPLAY ' DC2 START DATE '                       24180099
1001RM*                          TSTR000-DC2-RCT-START-DATE             24190099
1001RM*                DISPLAY ' DC2 STOP DATE  '                       24200099
1001RM*                          TSTR000-DC2-RCT-STOP-DATE              24210099
1001RM*                DISPLAY ' CALCD DATE     ' PV-DATE-DEC-DAYS      24220099
1001RM*                DISPLAY '@@@@@@@@@@@@@@@@@@@@@@@@@@@'            24230099
0801RM*                SET PS-INPUT-REC-ERROR TO TRUE                   24240099
0801RM*                PERFORM 9920-WRITE-ERROR-RECORD                  24250099
1001RM*           END-IF                                                24260099
1001RM*        ELSE                                                     24270099
1001RM*            DISPLAY '@@@@@@@@@@@@@@@@@@@@@@@@@@@'                24280099
1001RM*            DISPLAY ' ERROR IN 6498-SET-DC-RCT-START-DATE.'      24290099
1001RM*            DISPLAY ' NEW CALD START DATE DOES NOT FIT DCS'      24300099
1001RM*            DISPLAY ' FOR STORE      ' HO100-STR-NBR             24310099
1001RM*            DISPLAY ' CALCD DATE     ' PV-DATE-DEC-DAYS          24320099
1001RM*            DISPLAY ' RMS DEFAULT WH ' HO100-STR-DEF-WH-CHAR     24330099
1001RM*            DISPLAY ' DC1            ' TSTR000-DC1-NMBR          24340099
1001RM*            DISPLAY ' RCT START DATE ' TSTR000-DC1-RCT-START-DATE24350099
1001RM*            DISPLAY ' RCT STOP DATE  ' TSTR000-DC1-RCT-STOP-DATE 24360099
1001RM*            DISPLAY ' DC2            ' TSTR000-DC2-NMBR          24370099
1001RM*            DISPLAY ' RCT START DATE ' TSTR000-DC2-RCT-START-DATE24380099
1001RM*            DISPLAY ' RCT STOP DATE  ' TSTR000-DC2-RCT-STOP-DATE 24390099
1001RM*            DISPLAY '@@@@@@@@@@@@@@@@@@@@@@@@@@@'                24400099
0801RM*            SET PS-INPUT-REC-ERROR TO TRUE                       24410099
0801RM*            PERFORM 9920-WRITE-ERROR-RECORD                      24420099
1001RM*        END-IF                                                   24430099
1001RM*    END-IF.                                                      24440099
      * ------------------------------------------------------------- * 24450096
      * PROCESS THE OUTLOC MESSAGES                                     24460096
      * ------------------------------------------------------------- * 24470096
       6500-PROCESS-OUTLOC.                                             24480096
           ADD 1 TO PA-OUTLOC-MESSAGES.                                 24490096
           MOVE HO100-OUTLC-ID-3-5   TO PV-KEY-NBR-2-4                  24500096
                                        PV-KEY-NBR-NUM.                 24510096
0504RM*** WR27051 - STORES EXPANSION - BYPASS OUTLOCS > 999             24520099
0504RM     IF HO100-OUTLC-ID-2-5 > 999                                  24530099
0504RM         ADD 1            TO PA-OUTLOC-BYPASS                     24540099
0504RM     ELSE                                                         24550099
0504RM         PERFORM 6505-PROCESS-LEGACY-OUTLOC                       24560099
0504RM     END-IF.                                                      24570099
                                                                        24580099
0504RM 6505-PROCESS-LEGACY-OUTLOC.                                      24590099
                                                                        24600096
           IF HO100-ACTN-TYP-UPDATE                                     24610096
               PERFORM 7600-SELECT-STORE-ROW                            24620096
               IF PS-NO-INPUT-REC-ERROR                                 24630096
                   PERFORM 6510-INS-UPD-STORE-ROW                       24640096
                   IF PS-NO-INPUT-REC-ERROR                             24650096
                       PERFORM 7610-UPDATE-STORE-ROW                    24660096
                   END-IF                                               24670096
               END-IF                                                   24680096
               IF PS-INPUT-REC-ERROR                                    24690096
                   ADD 1 TO PA-OUTLOC-ERRORS                            24700096
               ELSE                                                     24710096
                   ADD 1 TO PA-OUTLOC-UPDATES                           24720096
               END-IF                                                   24730096
           ELSE                                                         24740096
               IF HO100-ACTN-TYP-INSERT                                 24750096
                   MOVE PV-INIT-TSTR000 TO DCLTSTR000                   24760096
                   PERFORM 6510-INS-UPD-STORE-ROW                       24770096
                   IF PS-NO-INPUT-REC-ERROR                             24780096
                       PERFORM 7620-INSERT-STORE-ROW                    24790096
                   END-IF                                               24800096
                   IF PS-INPUT-REC-ERROR                                24810096
                       ADD 1 TO PA-OUTLOC-ERRORS                        24820096
                   ELSE                                                 24830096
                       ADD 1 TO PA-OUTLOC-INSERTS                       24840096
                   END-IF                                               24850096
               ELSE                                                     24860096
                   IF HO100-ACTN-TYP-DELETE                             24870096
                       PERFORM 7630-DELETE-STORE-ROW                    24880096
                       IF PS-INPUT-REC-ERROR                            24890096
                           ADD 1 TO PA-OUTLOC-ERRORS                    24900096
                       ELSE                                             24910096
                           ADD 1 TO PA-OUTLOC-DELETES                   24920096
                       END-IF                                           24930096
                   END-IF                                               24940096
               END-IF                                                   24950096
           END-IF.                                                      24960096
                                                                        24970096
                                                                        24980096
      * ------------------------------------------------------------- * 24990096
      *   UPDATE/INSERT STORE LEVEL DATA WITH OUTLOC DATA               25000096
      * ------------------------------------------------------------- * 25010096
       6510-INS-UPD-STORE-ROW.                                          25020096
                                                                        25030096
           IF HO100-ACTN-TYP-INSERT                                     25040096
               MOVE PV-KEY-NBR-2-4      TO TSTR000-STORE-NMBR           25050096
               MOVE HO100-OTLC-TYPE     TO TSTR000-TYPE-CODE            25060096
               MOVE PC-085              TO TSTR000-DC1-NMBR             25070096
               MOVE PV-CURRENT-DATE     TO TSTR000-DC1-PO-START-DATE    25080096
                                                                        25090096
               MOVE HO100-OTLC-OPN-DTE  TO PV-START-DATE                25100096
               MOVE PC-NINETY           TO PV-DAYS                      25110096
               PERFORM 8600-DECREMENT-DATE                              25120096
               MOVE PV-DATE-DEC-DAYS    TO TSTR000-DC1-RCT-START-DATE   25130096
                                                                        25140096
               MOVE PC-DEFAULT-DATE     TO TSTR000-DC2-PO-STOP-DATE     25150096
                                           TSTR000-DC2-RCT-STOP-DATE    25160096
               MOVE PC-OTHER            TO TSTR000-STR-CMPR-DTE-CDE     25170096
               MOVE PC-Y                TO TSTR000-DST-CDE              25180096
0801RM*-- PM00419674                                                    25190096
0801RM*        MOVE SPACES              TO TSTR000-CHAR10-ABBR-NAME     25200096
               EVALUATE HO100-OTLC-TYPE                                 25210096
                   WHEN PC-VENDOR                                       25220096
                       CONTINUE                                         25230096
                   WHEN PC-HEADQUARTERS                                 25240096
                       CONTINUE                                         25250096
                   WHEN PC-NON-MERCHANDISE                              25260096
                       CONTINUE                                         25270096
                   WHEN PC-SALVAGE                                      25280096
                       CONTINUE                                         25290096
                   WHEN PC-OPERATIONS                                   25300096
                       MOVE PC-999            TO TSTR000-SUBSCRIPT-NMBR 25310096
                   WHEN OTHER                                           25320096
                       PERFORM 8800-GET-MAX-SUBSCRIPT                   25330096
                       MOVE PV-SUBSCRIPT-NMBR TO TSTR000-SUBSCRIPT-NMBR 25340096
               END-EVALUATE                                             25350096
               IF PS-NO-INPUT-REC-ERROR                                 25360096
                   MOVE PV-KEY-NBR-3-4      TO TSTR000-TWO-DIGIT-NMBR   25370096
                   MOVE PV-KEY-NBR-NUM      TO TSTR000-STR-NBR          25380096
               END-IF                                                   25390096
           END-IF.                                                      25400096
                                                                        25410096
           IF PS-NO-INPUT-REC-ERROR                                     25420096
               MOVE HO100-OUTLC-DESC-1-25  TO TSTR000-STORE-NAME        25430096
               MOVE HO100-OTLC-NM-5-ABBR   TO TSTR000-CHAR5-ABBR-NAME   25440096
0801RM*-- PM00419674 -- ADD 10 CHAR STORE DESCRIPTION                   25450096
0801RM         MOVE HO100-OUTLOC-DESC1-10  TO TSTR000-CHAR10-ABBR-NAME  25460096
               MOVE HO100-OTLC-ADD1-1-25   TO TSTR000-MAIL-ADDR-ONE-DESC25470096
               MOVE HO100-OTLC-ADD2-1-25   TO TSTR000-MAIL-ADDR-TWO-DESC25480096
               MOVE HO100-OTLC-CITY-1-15   TO TSTR000-CITY-NAME         25490096
               MOVE HO100-OTLC-STATE-1-2   TO TSTR000-STATE-CODE        25500096
                                                                        25510096
      *--      CONVERT THE INPUT ALPHANUMERIC ZIP CODE TO NUMERIC       25520096
               MOVE 0                      TO PV-INPUT-NUMBER-IN        25530096
                                              PV-OUTPUT-NUMBER-OUT      25540096
                                              PV-ZIP-CODE1-9            25550096
               MOVE HO100-OTLC-POST        TO PV-INPUT-NUMBER-IN        25560096
               PERFORM 6900-CONVERT-ALPHA-TO-NUMERIC                    25570096
               MOVE PV-OUTPUT-NUMBER-OUT   TO PV-ZIP-CODE               25580096
               MOVE PV-ZIP-CODE1-9         TO TSTR000-ZIP-PLUS4-CODE    25590096
                                                                        25600096
      *--      CONVERT THE INPUT ALPHANUMERIC ZIP CODE TO NUMERIC       25610096
               MOVE 0                         TO PV-INPUT-NUMBER-IN     25620096
                                                 PV-OUTPUT-NUMBER-OUT   25630096
                                                 PV-PHONE-NBR10-20      25640096
               MOVE HO100-OTLC-CONTACT-PHONE  TO PV-INPUT-NUMBER-IN     25650096
               PERFORM 6910-CONVERT-PHONE-NUMBER                        25660096
               MOVE PV-OUTPUT-NUMBER-OUT      TO PV-PHONE-NBR           25670096
               MOVE PV-PHONE-NBR10-20         TO TSTR000-PHONE-NMBR     25680096
                                                                        25690096
               MOVE HO100-OTLC-OPN-DTE        TO TSTR000-OPENED-DATE    25700096
               MOVE HO100-OTLC-CLO-DTE        TO TSTR000-CLOSED-DATE    25710096
               MOVE LOW-VALUES                TO TSTR000-REPL-STORE-NBR 25720096
                                                                        25730096
               MOVE 'N'                       TO TSTR000-CENPPC-CRE-IND 25740096
               MOVE PV-CURRENT-DATE           TO TSTR000-LAST-CHG-DTE   25750096
               IF TSTR000-MAIL-ADDR-ONE-DESC = SPACES                   25760096
                   MOVE LOW-VALUES       TO TSTR000-MAIL-ADDR-ONE-DESC  25770096
               END-IF                                                   25780096
      *--      LOW VALUES IS THE LEGACY DEFAULT OF MAIL-ADDR-TWO-DESC   25790096
               IF TSTR000-MAIL-ADDR-TWO-DESC = SPACES                   25800096
                   MOVE LOW-VALUES       TO TSTR000-MAIL-ADDR-TWO-DESC  25810096
               END-IF                                                   25820096
      *--      LOW VALUES IS THE LEGACY DEFAULT OF MGR-NAME             25830096
               IF TSTR000-MGR-NAME = SPACES                             25840096
                   MOVE LOW-VALUES       TO TSTR000-MGR-NAME            25850096
               END-IF                                                   25860096
               IF TSTR000-DISTRICT-NMBR = SPACES                        25870096
                   MOVE LOW-VALUES       TO TSTR000-DISTRICT-NMBR       25880096
               END-IF                                                   25890096
               IF TSTR000-STR-CMPR-DTE-CDE = SPACES                     25900096
                   MOVE LOW-VALUES       TO TSTR000-STR-CMPR-DTE-CDE    25910096
               END-IF                                                   25920096
               IF TSTR000-RF-BEG-IP-ADR = LOW-VALUES                    25930096
                   MOVE SPACES           TO TSTR000-RF-BEG-IP-ADR       25940096
               END-IF                                                   25950096
               IF TSTR000-RF-END-IP-ADR = LOW-VALUES                    25960096
                   MOVE SPACES           TO TSTR000-RF-END-IP-ADR       25970096
               END-IF                                                   25980096
           END-IF.                                                      25990096
                                                                        26000096
      * ------------------------------------------------------------- * 26010096
      *   PROCESS THE PRICE_ZONE_GROUP_STORE DATA                       26020096
      *   PRICE_ZONE_GROUP_STORE DATA CAN BE AT DIFFERENT LEVELS        26030096
      *   THE HO100-PZGS-GROUP-ID-METRO IS THE '2000' ZONE-GROUP-ID     26040096
      *     THIS WILL UPDATE THE METRO NUMBER ON THE STORE TABLE        26050096
      *     IT WILL ONLY BE PROCESSED AS AN UPDATE, BECAUSE THE ROW ON  26060096
      *     TSTR000 WILL ALREADY BE PRESENT.                            26070096
      *   THE HO100-PZGS-GROUP-ID-ADMKT IS THE '4000' ZONE-GROUP-ID     26080096
      *     THIS WILL ONLY BE BRIDGED FOR AN INSERT.  A NEW ROW WILL    26090096
      *     BE INSERTED TO THE TSTRMKT TABLE.  IT WILL USE THE STORE    26100096
      *     OPEN DATE AS THE BEGIN DATE.                                26110096
      * ------------------------------------------------------------- * 26120096
       6600-PROCESS-PRICE-ZN-GRP-STR.                                   26130096
                                                                        26140096
           ADD 1 TO PA-PZGS-MSGS.                                       26150096
0504RM*** WR27051 - STORES EXPANSION - BYPASS STORES > 999              26160099
0504RM     IF HO100-PZG-STORE  > 999                                    26170099
0504RM         ADD 1            TO PA-PZGS-BYPASS                       26180099
0504RM     ELSE                                                         26190099
0504RM         IF HO100-PZGS-GROUP-ID-METRO                             26200099
0504RM             PERFORM 6625-PROCESS-METRO                           26210099
0504RM         ELSE                                                     26220099
0504RM             ADD 1        TO PA-PZGS-BYPASS                       26221099
0504RM*JAK         IF HO100-PZGS-GROUP-ID-ADMKT                         26230099
0504RM*JAK             PERFORM 6650-PROCESS-STRMRKT                     26240099
0504RM*JAK         END-IF                                               26250099
0504RM         END-IF                                                   26260099
0504RM     END-IF.                                                      26270099
0504RM*    IF HO100-PZGS-GROUP-ID-METRO                                 26280099
0504RM*        PERFORM 6625-PROCESS-METRO                               26290099
0504RM*    END-IF.                                                      26300099
0504RM*                                                                 26310099
0504RM*    IF HO100-PZGS-GROUP-ID-ADMKT                                 26320099
0504RM*        PERFORM 6650-PROCESS-STRMRKT                             26330099
0504RM*    END-IF.                                                      26340099
      * ------------------------------------------------------------- * 26350096
      *   PROCESS THE METRO PRICE ZONE GROUP DATA. (GROUP_ID 2000)      26360096
      *   THIS WILL UPDATE THE METRO NUMBER ON THE STORE TABLE          26370096
      *   IT WILL ONLY BE PROCESSED AS AN UPDATE, BECAUSE THE ROW ON    26380096
      *   TSTR000 WILL ALREADY BE PRESENT.                              26390096
      * ------------------------------------------------------------- * 26400096
       6625-PROCESS-METRO.                                              26410096
                                                                        26420096
           MOVE HO100-PZG-STORE   TO PV-KEY-NBR.                        26430096
                                                                        26440096
           PERFORM 7600-SELECT-STORE-ROW.                               26450096
           IF PS-INPUT-REC-ERROR                                        26460096
               ADD 1 TO PA-PZGS-ERRORS                                  26470096
           ELSE                                                         26480096
               MOVE HO100-PZG-ZONE-ID TO TSTR000-MET-NBR                26490096
               MOVE PV-CURRENT-DATE   TO TSTR000-LAST-CHG-DTE           26500096
               PERFORM 7610-UPDATE-STORE-ROW                            26510096
               IF HO100-ACTN-TYP-INSERT                                 26520096
                   IF PS-INPUT-REC-ERROR                                26530096
                       ADD 1 TO PA-PZGS-ERRORS                          26540096
                   ELSE                                                 26550096
                       ADD 1 TO PA-PZGS-INSERTS                         26560096
                   END-IF                                               26570096
               ELSE                                                     26580096
                   IF PS-INPUT-REC-ERROR                                26590096
                       ADD 1 TO PA-PZGS-ERRORS                          26600096
                   ELSE                                                 26610096
                       ADD 1 TO PA-PZGS-UPDATES                         26620096
                   END-IF                                               26630096
               END-IF                                                   26640096
           END-IF.                                                      26650096
                                                                        26660096
      * ------------------------------------------------------------- * 26670096
      *   PROCESS THE AD MARKET PRICE ZONE GROUP DATA. (GROUP_ID 4000)  26680099
      *   THIS WILL INSERT A NEW ROW TO THE TSTRMKT TABLE               26690096
      * ------------------------------------------------------------- * 26700096
      *6650-PROCESS-STRMRKT.                                            26710099
                                                                        26720096
      *    MOVE HO100-PZG-STORE   TO PV-KEY-NBR.                        26730099
      *    PERFORM 7600-SELECT-STORE-ROW.                               26740099
                                                                        26750096
      *JAK IF PS-INPUT-REC-ERROR                                        26760099
      *JAK     ADD 1 TO PA-PZGSS-ERRORS                                 26770099
      *JAK     PERFORM 9920-WRITE-ERROR-RECORD                          26780099
      *JAK     SET PS-INPUT-REC-ERROR TO TRUE                           26790099
      *JAK     DISPLAY '@@@@@@@@@@@@@@@@@@@@@@@@@@@'                    26800099
      *JAK     DISPLAY ' ERROR IN 6650-PROCESS-STRMRKT'                 26810099
      *JAK               HO100-PRICE-ZNE-GRP-STR-DATA                   26820099
      *JAK     DISPLAY ' STORE NOT FOUND ON TSTR000 ' HO100-PZG-STORE   26830099
      *JAK     DISPLAY '@@@@@@@@@@@@@@@@@@@@@@@@@@@@'                   26840099
      *JAK ELSE                                                         26850099
      *JAK     IF HO100-ACTN-TYP-INSERT AND                             26860099
      *JAK       (H0100-PZG-ADMRKT-DESC1-3 NOT = PC-ASTERISKS)          26870099
      *JAK         MOVE PC-KOHLS-OP-CO           TO STRMKT-OPERCO-NBR   26880099
      *JAK         MOVE PV-KEY-NBR-2-4           TO STRMKT-STR-NBR      26890099
      *JAK         MOVE H0100-PZG-ADMRKT-DESC1-3 TO STRMKT-ADMRKT-ID    26900099
      *JAK         MOVE TSTR000-OPENED-DATE      TO STRMKT-BEG-DTE      26910099
      *JAK         MOVE PC-DEFAULT-DATE          TO STRMKT-END-DTE      26920099
      *JAK         PERFORM 7844-ADD-STRMKT-BEG-DTE                      26930099
      *JAK         IF PS-INPUT-REC-ERROR                                26940099
      *JAK             ADD 1 TO PA-PZGSS-ERRORS                         26950099
      *JAK         ELSE                                                 26960099
      *JAK             ADD 1 TO PA-PZGSS-INSERTS                        26970099
      *JAK         END-IF                                               26980099
      *JAK     ELSE                                                     26990099
      *JAK         SET PS-INPUT-REC-ERROR TO TRUE                       27000099
      *JAK         ADD 1 TO PA-PZGSS-ERRORS                             27010099
      *JAK         PERFORM 9920-WRITE-ERROR-RECORD                      27020099
      *JAK         DISPLAY '@@@@@@@@@@@@@@@@@@@@@@@@@@@'                27030099
      *JAK         DISPLAY ' ERROR IN 6650-PROCESS-ADMRKT'              27040099
      *JAK                   HO100-PRICE-ZNE-GRP-STR-DATA               27050099
      *JAK         IF H0100-PZG-ADMRKT-DESC1-3  = PC-ASTERISKS          27060099
      *JAK             DISPLAY 'INVALID AD MARKET '                     27070099
      *JAK                     H0100-PZG-ADMRKT-DESC1-3                 27080099
      *JAK         ELSE                                                 27090099
      *JAK             DISPLAY ' INVALID ACTION  ' HO100-ACTN-TYP-CDE   27100099
      *JAK         END-IF                                               27110099
      *JAK         DISPLAY '@@@@@@@@@@@@@@@@@@@@@@@@@@@@'               27120099
      *JAK     END-IF.                                                  27130099
                                                                        27140096
      *6700-PROCESS-PRICE-METRO-PRICE.                                  27150099
      *JAK ADD 1 TO PA-MET-MSGS.                                        27160099
      *JAK MOVE HO100-METRO-ZONE-ID TO PV-KEY-NBR                       27170099
      *                                PV-KEY-NBR-NUM.                  27180099
0703RM* WR25433                                                         27190099
0703RM*                                                                 27200099
0703RM*       (HO100-METRO-DESCRIP1-3 = PC-ASTERISKS)                   27210099
0703RM*JAK IF ((HO100-METRO-CLIMAT-ID = PC-8888 OR PC-9999) OR          27220099
0703RM*JAK    (HO100-METRO-DESCRIP1-3 = PC-ASTERISKS))                  27230099
0703RM*JAK    AND (HO100-ACTN-TYP-INSERT OR HO100-ACTN-TYP-UPDATE)      27240099
      *JAK     SET PS-INPUT-REC-ERROR TO TRUE                           27250099
      *JAK     PERFORM 9920-WRITE-ERROR-RECORD                          27260099
      *JAK     ADD 1 TO PA-MET-ERRORS                                   27270099
      *JAK     DISPLAY '@@@@@@@@@@@@@@@@@@@@@@@@@@@'                    27280099
      *JAK     DISPLAY ' ERROR IN 6700-PROCESS-PRICE-METRO-PRICE'       27290099
      *JAK     IF (HO100-METRO-CLIMAT-ID = PC-9999)                     27300099
      *JAK         DISPLAY ' INVALID CLIMATE ' HO100-METRO-CLIMAT-ID    27310099
      *JAK     ELSE                                                     27320099
      *JAK         DISPLAY ' INVALID CITY    '                          27330099
      *JAK         HO100-METRO-DESCRIP1-20                              27340099
      *JAK     END-IF                                                   27350099
      *JAK     DISPLAY '@@@@@@@@@@@@@@@@@@@@@@@@@@@@'                   27360099
      *JAK ELSE                                                         27370099
      *JAK     IF HO100-ACTN-TYP-INSERT                                 27380099
      *JAK         INITIALIZE DCLTMETARA                                27390099
      *JAK         PERFORM 6720-LOAD-METRO-DATA                         27400099
      *JAK         PERFORM 7720-INSERT-METRO-ROW                        27410099
      *JAK         IF PS-INPUT-REC-ERROR                                27420099
      *JAK             CONTINUE                                         27430099
      *JAK         ELSE                                                 27440099
      *JAK             ADD 1 TO PA-MET-INSERTS                          27450099
      *JAK     ELSE                                                     27460099
      *JAK         IF HO100-ACTN-TYP-UPDATE                             27470099
      *JAK             PERFORM 7700-SELECT-METRO-ROW                    27480099
      *JAK             IF PS-INPUT-REC-ERROR                            27490099
      *JAK                 CONTINUE                                     27500099
      *JAK             ELSE                                             27510099
      *JAK                 PERFORM 6720-LOAD-METRO-DATA                 27520099
      *JAK                 PERFORM 7710-UPDATE-METRO-ROW                27530099
      *JAK                 IF PS-INPUT-REC-ERROR                        27540099
      *JAK                     CONTINUE                                 27550099
      *JAK                 ELSE                                         27560099
      *JAK                     ADD 1 TO PA-MET-UPDATES                  27570099
      *JAK                 END-IF                                       27580099
      *JAK             END-IF                                           27590099
      *JAK         ELSE                                                 27600099
      *JAK             IF HO100-ACTN-TYP-DELETE                         27610099
      *JAK                 PERFORM 7730-DELETE-METRO-ROW                27620099
      *JAK                 IF PS-INPUT-REC-ERROR                        27630099
      *JAK                     CONTINUE                                 27640099
      *JAK                 ELSE                                         27650099
      *JAK                     ADD 1 TO PA-MET-DELETES                  27660099
      *JAK             END-IF                                           27670099
      *JAK         END-IF                                               27680099
      *JAK     END-IF                                                   27690099
      *JAK END-IF.                                                      27700099
      * ------------------------------------------------------------- * 27710096
      * LOAD THE INPUT METRO DATA TO THE TMETARA FIELDS                 27720096
      * ------------------------------------------------------------- * 27730096
      *6720-LOAD-METRO-DATA.                                            27740099
      *JAK IF HO100-ACTN-TYP-INSERT                                     27750099
      *JAK     MOVE HO100-METRO-ZONE-ID      TO METARA-MET-NBR          27760099
      *JAK END-IF.                                                      27770099
      *JAK MOVE HO100-METRO-ST-CDE           TO METARA-ST-CDE.          27780099
      *JAK MOVE HO100-METRO-RPT-FLSH-SLS-IND TO METARA-RPT-FLSH-SLS-IND.27790099
      *JAK MOVE HO100-METRO-CLIMAT-ID        TO METARA-CLMT-ID.         27800099
      *JAK MOVE HO100-METRO-DESCRIP1-20      TO METARA-CTY-NM.          27810099
      *JAK MOVE +1                           TO METARA-RPT-SEQ-NBR.     27820099
                                                                        27830096
                                                                        27840096
      * ------------------------------------------------------------- * 27850096
      *   PROCESS THE PRICE_ZONE DATA.  RECORDS FOR THE CLIMATE PRICE   27860099
      *   ZONE GROUP (GROUP 3000) ARE PROCESSED. INSERTS CAUSE THE      27870099
      *   CLIMATE TO BE INSERTED TO TCLIMAT. UPDATES CAUSE THE CLIMATE  27880099
      *   TO BE UPDATED ON TCLIMAT.  DELETES CAUSE THE CLIMATE TO BE    27890099
      *   DELETED FROM TCLIMAT, PROVIDED THE CLIMATE IS NOT ASSIGNED    27900099
      *   TO ANY METRO AREAS ON TMETARA.  RECORDS FOR THE AD MARKET     27910099
      *   PRICE ZONE GROUP (GROUP 4000) ARE PROCESSED. UPDATES CAUSE    27920099
      *   THE AD MARKET DESCRIPTION TO BE UPDATED ON TADMRKT.           27930099
      * ------------------------------------------------------------- * 27940096
      *6800-PROCESS-PRICE-ZONE.                                         27950099
      *                                                                 27960099
      *JAK MOVE '6800-PROCESS-PRICE-ZONE' TO PV-PARAGRAPH.              27970099
      *                                                                 27980099
      *JAK IF HO100-PZ-GROUP-ID-CLIMAT                                  27990099
      *JAK     ADD 1 TO PA-CLIMAT-MSGS                                  28000099
      *JAK     MOVE HO100-PZ-ZONE-ID      TO CLIMAT-CLMT-ID             28010099
      *JAK                                   PV-KEY-NBR                 28020099
      *JAK     IF HO100-ACTN-TYP-INSERT                                 28030099
      *JAK         MOVE HO100-PZ-DESCRIPTION TO CLIMAT-CLMT-DESC        28040099
      *JAK         PERFORM 7740-INSERT-CLIMAT-ROW                       28050099
      *JAK         IF PS-INPUT-REC-ERROR                                28060099
      *JAK             ADD 1 TO PA-CLIMAT-ERRORS                        28070099
      *JAK         ELSE                                                 28080099
      *JAK             ADD 1 TO PA-CLIMAT-INSERTS                       28090099
      *JAK         END-IF                                               28100099
      *JAK     ELSE                                                     28110099
      *JAK         IF HO100-ACTN-TYP-UPDATE                             28120099
      *JAK             MOVE HO100-PZ-DESCRIPTION TO CLIMAT-CLMT-DESC    28130099
      *JAK             PERFORM 7750-UPDATE-CLIMAT-ROW                   28140099
      *JAK             IF PS-INPUT-REC-ERROR                            28150099
      *JAK                 ADD 1 TO PA-CLIMAT-ERRORS                    28160099
      *JAK             ELSE                                             28170099
      *JAK                 ADD 1 TO PA-CLIMAT-UPDATES                   28180099
      *JAK             END-IF                                           28190099
      *JAK         ELSE                                                 28200099
      *JAK             IF HO100-ACTN-TYP-DELETE                         28210099
      *                    THE CLIMATE CANNOT BE DELETED IF IT IS       28220096
      *                    ASSIGNED TO ANY METROS ON TMETARA.           28230096
      *JAK                 PERFORM 7760-COUNT-METROS-IN-CLIMAT          28240099
      *JAK                 IF PS-INPUT-REC-ERROR                        28250099
      *JAK                     ADD 1 TO PA-CLIMAT-ERRORS                28260099
      *JAK                 ELSE                                         28270099
      *JAK                     IF PV-NBR-OF-METROS = ZERO               28280099
      *JAK                         PERFORM 7780-DELETE-CLIMAT-ROW       28290099
      *JAK                         IF PS-INPUT-REC-ERROR                28300099
      *JAK                             ADD 1 TO PA-CLIMAT-ERRORS        28310099
      *JAK                         ELSE                                 28320099
      *JAK                             ADD 1 TO PA-CLIMAT-DELETES       28330099
      *JAK                         END-IF                               28340099
      *JAK                     ELSE                                     28350099
      *JAK                         ADD 1 TO PA-CLIMAT-ERRORS            28360099
      *JAK                         MOVE                                 28370099
      *JAK                      'CLIMATE ASSIGNED TO ONE OR MORE METROS'28380099
      *JAK                               TO  PV-MESSAGE                 28390099
      *JAK                         PERFORM 9900-PROCESS-DB2-ERROR       28400099
      *JAK                         SET PS-INPUT-REC-ERROR TO TRUE       28410099
      *JAK                     END-IF                                   28420099
      *JAK                 END-IF                                       28430099
      *JAK             END-IF                                           28440099
      *JAK         END-IF                                               28450099
      *JAK     END-IF                                                   28460099
      *JAK END-IF.                                                      28470099
                                                                        28480099
      *JAK IF HO100-PZ-GROUP-ID-ADMRKT                                  28490099
      *JAK     ADD 1 TO PA-ADMRKT-MSGS                                  28500099
      *JAK     MOVE HO100-PZ-DESCRIP1-3 TO ADMRKT-ADMRKT-ID             28510099
      *JAK                                 PV-KEY-NBR                   28520099
      *JAK     IF HO100-ACTN-TYP-UPDATE                                 28530099
      *JAK         MOVE HO100-PZ-DESCRIP4-18 TO ADMRKT-ADMRKT-DESC      28540099
      *JAK         PERFORM 7770-UPDATE-ADMRKT-DESC                      28550099
      *JAK         IF PS-INPUT-REC-ERROR                                28560099
      *JAK             ADD 1 TO PA-ADMRKT-ERRORS                        28570099
      *JAK         ELSE                                                 28580099
      *JAK             ADD 1 TO PA-ADMRKT-UPDATES                       28590099
      *JAK         END-IF                                               28600099
      *JAK     END-IF                                                   28610099
      *JAK END-IF.                                                      28620099
                                                                        28630096
                                                                        28640099
      * ------------------------------------------------------------- * 28650099
      *   PROCESS THE K_EMT_PRICE_ZONE_DATE DATA. ONLY RECORDS FOR      28660099
      *   THE AD MARKET PRICE ZONE GROUP (GROUP 4000) ARE PROCESSED.    28670099
      *   INSERTS CAUSE THE AD MARKET TO BE INSERTED TO TADMRKT. UPDATES28680099
      *   CAUSE THE AD MARKET EFFECTIVE BEGIN OR END DATES TO BE UPDATED28690099
      *   ON TADMRKT. DELETES CAUSE THE AD MARKET TO BE DELETED FROM    28700099
      *   TADMRKT PROVIDED THE AD MARKET IS NOT ASSIGNED TO ANY SUB     28710099
      *   MARKETS ON TSTRMKT.                                           28720099
      * ------------------------------------------------------------- * 28730099
      *6850-PROCESS-PRICE-ZONE-DATE.                                    28740099
                                                                        28750099
      *JAK MOVE '6850-PROCESS-PRICE-ZONE-DATE' TO PV-PARAGRAPH.         28760099
                                                                        28770099
      *JAK IF HO100-PZD-GROUP-ID-ADMRKT                                 28780099
      *JAK     ADD 1 TO PA-PZGD-MSGS                                    28790099
      *JAK     MOVE HO100-PZD-PZ-DESCRIP1-3    TO ADMRKT-ADMRKT-ID      28800099
      *JAK                                        PV-KEY-NBR            28810099
                                                                        28820099
      *JAK     IF HO100-ACTN-TYP-INSERT                                 28830099
      *JAK         MOVE HO100-PZD-EFF-STRT-DTE-NEW TO ADMRKT-BEG-DTE    28840099
      *JAK         MOVE HO100-PZD-EFF-END-DTE      TO ADMRKT-END-DTE    28850099
      *JAK         MOVE HO100-PZD-PZ-DESCRIP4-18   TO ADMRKT-ADMRKT-DESC28860099
      *JAK         MOVE SPACES                TO ADMRKT-MAJOR-ADMRKT-ID 28870099
      *JAK         MOVE HO100-PZD-PZ-DESCRIP1-3    TO PV-ADMRKT-ID      28880099
      *JAK         IF PV-ADMRKT-ID-1 = 'V'                              28890099
      *JAK             MOVE PV-ADMRKT-ID-2-3  TO ADMRKT-DFLT-VER-ID     28900099
      *JAK         ELSE                                                 28910099
      *JAK             MOVE PV-ADMRKT-ID      TO ADMRKT-DFLT-VER-ID     28920099
      *JAK         END-IF                                               28930099
      *JAK         PERFORM 7100-INSERT-ADMRKT-ROW                       28940099
      *JAK         IF PS-INPUT-REC-ERROR                                28950099
      *JAK             ADD 1 TO PA-PZGD-ERRORS                          28960099
      *JAK         ELSE                                                 28970099
      *JAK             ADD 1 TO PA-PZGD-ADMRKT-INSERTS                  28980099
      *JAK         END-IF                                               28990099
      *JAK     ELSE                                                     29000099
      *JAK         IF HO100-ACTN-TYP-UPDATE                             29010099
      *JAK             MOVE HO100-PZD-EFF-STRT-DTE-NEW TO ADMRKT-BEG-DTE29020099
      *JAK             MOVE HO100-PZD-EFF-STRT-DTE-OLD                  29030099
      *JAK                   TO PV-BEG-DT-ISO-KEY                       29040099
      *JAK             MOVE HO100-PZD-EFF-END-DTE      TO ADMRKT-END-DTE29050099
1102RM*JAK             IF HO100-PZD-EFF-STRT-DTE-OLD =                  29060099
1102RM*JAK                HO100-PZD-EFF-STRT-DTE-NEW                    29070099
      *JAK                 PERFORM 7110-UPDATE-ADMRKT-ROW               29080099
1102RM*JAK             ELSE                                             29090099
1102RM*JAK                 PERFORM 7105-PROCESS-ADMRKT-UPDTS            29100099
1102RM*JAK             END-IF                                           29110099
      *JAK             IF PS-INPUT-REC-ERROR                            29120099
      *JAK                 ADD 1 TO PA-PZGD-ERRORS                      29130099
      *JAK             ELSE                                             29140099
      *JAK                 ADD 1 TO PA-PZGD-ADMRKT-UPDATES              29150099
      *JAK             END-IF                                           29160099
      *JAK         ELSE                                                 29170099
      *JAK             IF HO100-ACTN-TYP-DELETE                         29180099
      *                    THE AD MARKET CANNOT BE DELETED IF IT IS     29190099
      *                    ASSIGNED TO ANY STORES ON TSTRMKT.           29200099
      *JAK                 MOVE ADMRKT-ADMRKT-ID TO STRMKT-ADMRKT-ID    29210099
      *JAK                 PERFORM 7130-COUNT-STORES-IN-ADMRKT          29220099
1102RM*JAK                 PERFORM 7135-COUNT-STORES-IN-SITSGNMK        29230099
      *JAK                 IF PS-INPUT-REC-ERROR                        29240099
      *JAK                     ADD 1 TO PA-PZGD-ERRORS                  29250099
      *JAK                 ELSE                                         29260099
      *JAK                     IF PV-NBR-OF-STORES = ZERO               29270099
1102RM*JAK                     AND (PV-NBR-OF-SIGNS = 0)                29280099
      *JAK                         MOVE HO100-PZD-EFF-STRT-DTE-OLD      29290099
      *JAK                               TO ADMRKT-BEG-DTE              29300099
      *JAK                         PERFORM 7120-DELETE-ADMRKT-ROW       29310099
      *JAK                         IF PS-INPUT-REC-ERROR                29320099
      *JAK                             ADD 1 TO PA-PZGD-ERRORS          29330099
      *JAK                         ELSE                                 29340099
      *JAK                             ADD 1 TO PA-PZGD-ADMRKT-DELETES  29350099
      *JAK                         END-IF                               29360099
      *JAK                     ELSE                                     29370099
      *JAK                         ADD 1 TO PA-PZGD-ERRORS              29380099
      *JAK                         MOVE                                 29390099
1102RM*                       'AD MARKET ASSIGNED TO ONE OR MORE STORES'29400099
1102RM*JAK           'AD MARKET ASSIGNED TO ONE OR MORE STORES OR SIGNS'29410099
      *JAK                               TO  PV-MESSAGE                 29420099
      *JAK                         PERFORM 9900-PROCESS-DB2-ERROR       29430099
      *JAK                         SET PS-INPUT-REC-ERROR TO TRUE       29440099
      *JAK                     END-IF                                   29450099
      *JAK                 END-IF                                       29460099
      *JAK             END-IF                                           29470099
      *JAK         END-IF                                               29480099
      *JAK     END-IF                                                   29490099
      *JAK END-IF.                                                      29500099
                                                                        29510099
                                                                        29520099
      * ------------------------------------------------------------- * 29530099
      * CONVERT INPUT ALPHANUMERIC FIELDS TO NUMERIC                    29540096
      * ------------------------------------------------------------- * 29550096
       6900-CONVERT-ALPHA-TO-NUMERIC.                                   29560096
           SET OUT-IDX TO 1.                                            29570096
           PERFORM                                                      29580096
              VARYING IN-IDX FROM 1 BY 1                                29590096
                 UNTIL IN-IDX > 20                                      29600096
               IF PV-INPUT-DIGIT-IN (IN-IDX) NUMERIC                    29610096
                   MOVE PV-INPUT-DIGIT-IN (IN-IDX) TO                   29620096
                        PV-OUTPUT-DIGIT-OUT (OUT-IDX)                   29630096
                        SET OUT-IDX UP BY 1                             29640096
               END-IF                                                   29650096
           END-PERFORM.                                                 29660096
                                                                        29670096
*********  INSPECT PV-OUTPUT-NUMBER-OUT REPLACING ALL ' ' BY '0'.       29680096
                                                                        29690096
      * ------------------------------------------------------------- * 29700096
      * CONVERT INPUT ALPHANUMERIC FIELDS TO NUMERIC                    29710096
      * ------------------------------------------------------------- * 29720096
       6910-CONVERT-PHONE-NUMBER.                                       29730096
           SET OUT-IDX TO 20.                                           29740096
           PERFORM                                                      29750096
              VARYING IN-IDX FROM 20 BY -1                              29760096
                 UNTIL IN-IDX < 1                                       29770096
               IF PV-INPUT-DIGIT-IN (IN-IDX) NUMERIC                    29780096
                   MOVE PV-INPUT-DIGIT-IN (IN-IDX) TO                   29790096
                        PV-OUTPUT-DIGIT-OUT (OUT-IDX)                   29800096
                        SET OUT-IDX DOWN BY 1                           29810096
               END-IF                                                   29820096
           END-PERFORM.                                                 29830096
                                                                        29840096
           INSPECT PV-OUTPUT-NUMBER-OUT REPLACING ALL ' ' BY '0'.       29850096
                                                                        29860099
      * ------------------------------------------------------------- * 29870096
      * INSERT THE TERRITORY DATA                                       29880096
      * ------------------------------------------------------------- * 29890096
      *7000-INSERT-TERRITORY-ROW.                                       29900099
      *                                                                 29910099
      *JAK MOVE '7000-INSERT-TERRITORY-ROW' TO PV-PARAGRAPH.            29920099
      *                                                                 29930099
      *JAK PERFORM                                                      29940099
      *JAK     WITH TEST AFTER                                          29950099
      *JAK     VARYING PV-SQL-SUB                                       29960099
      *JAK     FROM 1 BY 1                                              29970099
      *JAK     UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        29980099
      *JAK        OR SQLCODE = 0                                        29990099
      *JAK        OR PS-INPUT-REC-ERROR                                 30000099
      *                                                                 30010096
      *JAK       EXEC SQL                                               30020099
      *JAK           INSERT INTO TTER000                                30030099
      *JAK               (TERR_NBR                                      30040099
      *JAK              , TERR_NM                                       30050099
      *JAK              , MGR_NM )                                      30060099
      *JAK           VALUES (: TER000-TERR-NBR                          30070099
      *JAK                 , : TER000-TERR-NM                           30080099
      *JAK                 , : TER000-MGR-NM )                          30090099
      *JAK       END-EXEC                                               30100099
      *                                                                 30110096
      *JAK     EVALUATE TRUE                                            30120099
      *JAK         WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              30130099
      *JAK         WHEN SQLCODE = PC-DEADLOCK                           30140099
      *JAK         WHEN SQLCODE = ZERO                                  30150099
      *JAK              CONTINUE                                        30160099
      *JAK         WHEN SQLWARN0 NOT = SPACE                            30170099
      *JAK         WHEN SQLCODE NOT =  ZERO                             30180099
      *JAK             MOVE 'BAD SQLCODE FOR INSERT TERRITORY'          30190099
      *JAK                           TO  PV-MESSAGE                     30200099
      *JAK             PERFORM 9900-PROCESS-DB2-ERROR                   30210099
      *JAK             SET PS-INPUT-REC-ERROR TO TRUE                   30220099
      *JAK     END-EVALUATE                                             30230099
      *JAK END-PERFORM.                                                 30240099
      *                                                                 30250096
      *JAK IF PV-SQL-SUB > PC-MAX-RETRIES                               30260099
      *JAK     MOVE  'MAX RETRIES EXCEEDED FOR INSERT TERRITORY'        30270099
      *JAK            TO PV-MESSAGE                                     30280099
      *JAK     PERFORM 9900-PROCESS-DB2-ERROR                           30290099
      *JAK     SET PS-INPUT-REC-ERROR TO TRUE                           30300099
      *JAK END-IF.                                                      30310099
      *                                                                 30320099
      *                                                                 30330099
      * ------------------------------------------------------------- * 30340096
      * UPDATE THE TERRITORY DATA                                       30350096
      * ------------------------------------------------------------- * 30360096
      *7010-UPDATE-TERRITORY-ROW.                                       30370099
      *                                                                 30380099
      *JAK MOVE '7010-UPDATE-TERRITORY-ROW' TO  PV-PARAGRAPH.           30390099
      *                                                                 30400099
      *JAK PERFORM                                                      30410099
      *JAK     WITH TEST AFTER                                          30420099
      *JAK     VARYING PV-SQL-SUB                                       30430099
      *JAK     FROM 1 BY 1                                              30440099
      *JAK     UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        30450099
      *JAK        OR SQLCODE = 0                                        30460099
      *JAK        OR SQLCODE = PC-ROW-NOT-FOUND                         30470099
      *JAK        OR PS-INPUT-REC-ERROR                                 30480099
      *                                                                 30490096
      *JAK       EXEC SQL                                               30500099
      *JAK           UPDATE TTER000                                     30510099
      *JAK           SET TERR_NBR   = : TER000-TERR-NBR                 30520099
      *JAK             , TERR_NM    = : TER000-TERR-NM                  30530099
      *JAK             , MGR_NM     = : TER000-MGR-NM                   30540099
      *JAK           WHERE TERR_NBR = : TER000-TERR-NBR                 30550099
      *JAK       END-EXEC                                               30560099
      *                                                                 30570096
      *JAK     EVALUATE TRUE                                            30580099
      *JAK         WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              30590099
      *JAK         WHEN SQLCODE = PC-DEADLOCK                           30600099
      *JAK         WHEN SQLCODE = PC-ROW-NOT-FOUND                      30610099
      *JAK         WHEN SQLCODE = ZERO                                  30620099
      *JAK              CONTINUE                                        30630099
      *JAK         WHEN SQLWARN0 NOT = SPACE                            30640099
      *JAK         WHEN SQLCODE NOT = ZERO                              30650099
      *JAK             MOVE 'BAD SQLCODE FOR UPDATE TERRITORY'          30660099
      *JAK                           TO  PV-MESSAGE                     30670099
      *JAK             PERFORM 9900-PROCESS-DB2-ERROR                   30680099
      *JAK             SET PS-INPUT-REC-ERROR TO TRUE                   30690099
      *JAK     END-EVALUATE                                             30700099
      *JAK END-PERFORM.                                                 30710099
      *                                                                 30720096
      *JAK IF  PV-SQL-SUB > PC-MAX-RETRIES                              30730099
      *JAK     MOVE 'MAX RETRIES EXCEEDED FOR UPDATE TERRITORY'         30740099
      *JAK                           TO  PV-MESSAGE                     30750099
      *JAK     PERFORM 9900-PROCESS-DB2-ERROR                           30760099
      *JAK     SET PS-INPUT-REC-ERROR TO TRUE                           30770099
      *JAK END-IF.                                                      30780099
      *                                                                 30790096
      *JAK IF SQLCODE = PC-ROW-NOT-FOUND                                30800099
      *JAK     MOVE 'TERRITORY ROW NOT FOUND FOR UPDATE'                30810099
      *JAK                           TO  PV-MESSAGE                     30820099
      *JAK     PERFORM 9900-PROCESS-DB2-ERROR                           30830099
      *JAK END-IF.                                                      30840099
      *                                                                 30850099
      * ------------------------------------------------------------- * 30860096
      * DELETE THE TERRITORY DATA                                       30870096
      * ------------------------------------------------------------- * 30880096
      *7020-DELETE-TERRITORY-ROW.                                       30890099
      *                                                                 30900099
      *JAK MOVE '7020-DELETE-TERRITORY-ROW' TO  PV-PARAGRAPH.           30910099
      *                                                                 30920099
      *JAK PERFORM                                                      30930099
      *JAK     WITH TEST AFTER                                          30940099
      *JAK     VARYING PV-SQL-SUB                                       30950099
      *JAK     FROM 1 BY 1                                              30960099
      *JAK     UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        30970099
      *JAK        OR SQLCODE = 0                                        30980099
      *JAK        OR SQLCODE = PC-ROW-NOT-FOUND                         30990099
      *JAK        OR PS-INPUT-REC-ERROR                                 31000099
      *                                                                 31010096
      *JAK       EXEC SQL                                               31020099
      *JAK           DELETE FROM TTER000                                31030099
      *JAK           WHERE TERR_NBR   = : TER000-TERR-NBR               31040099
      *JAK       END-EXEC                                               31050099
      *                                                                 31060096
      *JAK     EVALUATE TRUE                                            31070099
      *JAK         WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              31080099
      *JAK         WHEN SQLCODE = PC-DEADLOCK                           31090099
      *JAK         WHEN SQLCODE = PC-ROW-NOT-FOUND                      31100099
      *JAK         WHEN SQLCODE = ZERO                                  31110099
      *JAK              CONTINUE                                        31120099
      *JAK         WHEN SQLWARN0 NOT = SPACE                            31130099
      *JAK         WHEN SQLCODE NOT = ZERO                              31140099
      *JAK             MOVE 'BAD SQLCODE FOR DELETE TERRITORY'          31150099
      *JAK                           TO  PV-MESSAGE                     31160099
      *JAK             PERFORM 9900-PROCESS-DB2-ERROR                   31170099
      *JAK             SET PS-INPUT-REC-ERROR TO TRUE                   31180099
      *JAK     END-EVALUATE                                             31190099
      *JAK END-PERFORM.                                                 31200099
      *                                                                 31210096
      *JAK IF  PV-SQL-SUB > PC-MAX-RETRIES                              31220099
      *JAK     MOVE 'MAX RETRIES EXCEEDED FOR DELETE TERRITORY'         31230099
      *JAK                           TO  PV-MESSAGE                     31240099
      *JAK     PERFORM 9900-PROCESS-DB2-ERROR                           31250099
      *JAK     SET PS-INPUT-REC-ERROR TO TRUE                           31260099
      *JAK END-IF.                                                      31270099
      *                                                                 31280096
      *JAK IF SQLCODE = PC-ROW-NOT-FOUND                                31290099
      *JAK     MOVE 'TERRITORY ROW NOT FOUND FOR DELETE'                31300099
      *JAK                           TO  PV-MESSAGE                     31310099
      *JAK     PERFORM 9900-PROCESS-DB2-ERROR                           31320099
      *JAK END-IF.                                                      31330099
      *                                                                 31340099
      * ------------------------------------------------------------- * 31350099
      * INSERT THE AD MARKET DATA                                       31360099
      * ------------------------------------------------------------- * 31370099
      *7100-INSERT-ADMRKT-ROW.                                          31380099
      *                                                                 31390099
      *JAK MOVE '7100-INSERT-ADMRKT-ROW' TO PV-PARAGRAPH.               31400099
      *                                                                 31410099
      *JAK PERFORM                                                      31420099
      *JAK     WITH TEST AFTER                                          31430099
      *JAK     VARYING PV-SQL-SUB                                       31440099
      *JAK     FROM 1 BY 1                                              31450099
      *JAK     UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        31460099
      *JAK        OR SQLCODE = 0                                        31470099
      *JAK        OR PS-INPUT-REC-ERROR                                 31480099
      *                                                                 31490099
      *JAK       EXEC SQL                                               31500099
      *JAK           INSERT INTO TADMRKT                                31510099
      *JAK                (OPERCO_NBR,                                  31520099
      *JAK                 ADMRKT_ID,                                   31530099
      *JAK                 BEG_DTE,                                     31540099
      *JAK                 END_DTE,                                     31550099
      *JAK                 ADMRKT_DESC,                                 31560099
      *JAK                 TYPE_CODE,                                   31570099
      *JAK                 MAJOR_ADMRKT_ID,                             31580099
      *JAK                 DFLT_VER_ID)                                 31590099
      *JAK            VALUES                                            31600099
      *JAK                (:PC-KOHLS-OP-CO,                             31610099
      *JAK                 :ADMRKT-ADMRKT-ID,                           31620099
      *JAK                 :ADMRKT-BEG-DTE,                             31630099
      *JAK                 :ADMRKT-END-DTE,                             31640099
      *JAK                 :ADMRKT-ADMRKT-DESC,                         31650099
      *JAK                 :PC-ADMRKT-MARKET,                           31660099
      *JAK                 :ADMRKT-MAJOR-ADMRKT-ID,                     31670099
      *JAK                 :ADMRKT-DFLT-VER-ID)                         31680099
      *JAK       END-EXEC                                               31690099
      *                                                                 31700099
      *JAK     EVALUATE TRUE                                            31710099
      *JAK         WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              31720099
      *JAK         WHEN SQLCODE = PC-DEADLOCK                           31730099
      *JAK         WHEN SQLCODE = ZERO                                  31740099
      *JAK              CONTINUE                                        31750099
      *JAK         WHEN SQLWARN0 NOT = SPACE                            31760099
      *JAK         WHEN SQLCODE NOT =  ZERO                             31770099
      *JAK             MOVE 'BAD SQLCODE FOR INSERT AD MARKET'          31780099
      *JAK                           TO  PV-MESSAGE                     31790099
      *JAK             PERFORM 9900-PROCESS-DB2-ERROR                   31800099
      *JAK             SET PS-INPUT-REC-ERROR TO TRUE                   31810099
      *JAK     END-EVALUATE                                             31820099
      *JAK END-PERFORM.                                                 31830099
      *                                                                 31840099
      *JAK IF PV-SQL-SUB > PC-MAX-RETRIES                               31850099
      *JAK     MOVE  'MAX RETRIES EXCEEDED FOR INSERT AD MARKET'        31860099
      *JAK            TO PV-MESSAGE                                     31870099
      *JAK     PERFORM 9900-PROCESS-DB2-ERROR                           31880099
      *JAK     SET PS-INPUT-REC-ERROR TO TRUE                           31890099
      *JAK END-IF.                                                      31900099
                                                                        31910099
1102RM* ------------------------------------------------------------- * 31920099
1102RM* INSERT A NEW TADMRKT ROW, UPDATE SIT_SGN_MKT_RLT TABLE          31930099
1102RM* AND DELETE THE OLD TADMRKT ROW                                  31940099
1102RM* ------------------------------------------------------------- * 31950099
1102RM*7105-PROCESS-ADMRKT-UPDTS.                                       31960099
1102RM                                                                  31970099
1102RM*JAK PERFORM 7100-INSERT-ADMRKT-ROW.                              31980099
1102RM*JAK PERFORM 7108-UPDATE-SITSGN-TBL.                              31990099
1102RM                                                                  32000099
      *   THE AD MARKET CANNOT BE DELETED IF IT IS                      32010099
      *   ASSIGNED TO ANY STORES ON TSTRMKT OR SIT_SGN_MKT_RLT          32020099
1102RM*JAK MOVE ADMRKT-ADMRKT-ID TO STRMKT-ADMRKT-ID.                   32030099
1102RM*JAK PERFORM 7130-COUNT-STORES-IN-ADMRKT.                         32040099
1102RM*JAK PERFORM 7135-COUNT-STORES-IN-SITSGNMK.                       32050099
1102RM*JAK IF PS-INPUT-REC-ERROR                                        32060099
1102RM*JAK     ADD 1 TO PA-PZGD-ERRORS                                  32070099
1102RM*JAK ELSE                                                         32080099
1102RM*JAK     IF (PV-NBR-OF-STORES = 0)  AND                           32090099
1102RM*JAK        (PV-NBR-OF-SIGNS = 0)                                 32100099
1102RM*JAK         MOVE HO100-PZD-EFF-STRT-DTE-OLD TO ADMRKT-BEG-DTE    32110099
1102RM*JAK         PERFORM 7120-DELETE-ADMRKT-ROW                       32120099
1102RM*JAK         IF PS-INPUT-REC-ERROR                                32130099
1102RM*JAK             ADD 1 TO PA-PZGD-ERRORS                          32140099
1102RM*JAK         ELSE                                                 32150099
1102RM*JAK             ADD 1 TO PA-PZGD-ADMRKT-DELETES                  32160099
1102RM*JAK         END-IF                                               32170099
1102RM*JAK     ELSE                                                     32180099
1102RM*JAK         ADD 1 TO PA-PZGD-ERRORS                              32190099
1102RM*JAK         MOVE                                                 32200099
1102RM*JAK         'AD MARKET ASSIGNED TO ONE OR MORE STORES OR SIGNS'  32210099
1102RM*JAK           TO  PV-MESSAGE                                     32220099
1102RM*JAK         PERFORM 9900-PROCESS-DB2-ERROR                       32230099
1102RM*JAK         SET PS-INPUT-REC-ERROR TO TRUE                       32240099
1102RM*JAK     END-IF                                                   32250099
1102RM*JAK END-IF.                                                      32260099
1102RM                                                                  32270099
1102RM* ------------------------------------------------------------- * 32280099
1102RM* UPDATE THE AD MARKET BEGIN AND END DATES                        32290099
1102RM* ------------------------------------------------------------- * 32300099
1102RM*7108-UPDATE-SITSGN-TBL.                                          32310099
1102RM                                                                  32320099
1102RM*JAK PERFORM                                                      32330099
1102RM*JAK     WITH TEST AFTER                                          32340099
1102RM*JAK     VARYING PV-SQL-SUB                                       32350099
1102RM*JAK     FROM 1 BY 1                                              32360099
1102RM*JAK     UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        32370099
1102RM*JAK        OR SQLCODE = 0                                        32380099
1102RM*JAK        OR SQLCODE = PC-ROW-NOT-FOUND                         32390099
1102RM*JAK        OR PS-INPUT-REC-ERROR                                 32400099
1102RM*                                                                 32410099
1102RM*JAK       EXEC SQL                                               32420099
1102RM*JAK           UPDATE SIT_SGN_MKT_RLT                             32430099
1102RM*JAK           SET  BEG_DTE     = :HO100-PZD-EFF-STRT-DTE-NEW     32440099
1102RM*JAK           WHERE OPERCO_NBR = :PC-KOHLS-OP-CO                 32450099
1102RM*JAK             AND ADMRKT_ID  = :HO100-PZD-PZ-DESCRIP1-3        32460099
1102RM*JAK           AND BEG_DTE    = :HO100-PZD-EFF-STRT-DTE-OLD       32470099
1102RM*JAK     END-EXEC                                                 32480099
1102RM                                                                  32490099
1102RM*JAK   EVALUATE TRUE                                              32500099
1102RM*JAK       WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES                32510099
1102RM*JAK       WHEN SQLCODE = PC-DEADLOCK                             32520099
1102RM*JAK       WHEN SQLCODE = PC-ROW-NOT-FOUND                        32530099
1102RM*JAK       WHEN SQLCODE = ZERO                                    32540099
1102RM*JAK            CONTINUE                                          32550099
1102RM*JAK       WHEN SQLWARN0 NOT = SPACE                              32560099
1102RM*JAK       WHEN SQLCODE NOT = ZERO                                32570099
1102RM*JAK           MOVE 'BAD SQLCODE FOR UPDATE SIT_SGN_MKT_RLT'      32580099
1102RM*JAK                         TO  PV-MESSAGE                       32590099
1102RM*JAK           PERFORM 9900-PROCESS-DB2-ERROR                     32600099
1102RM*JAK           SET PS-INPUT-REC-ERROR TO TRUE                     32610099
1102RM*JAK   END-EVALUATE                                               32620099
1102RM*JAK END-PERFORM.                                                 32630099
1102RM                                                                  32640099
1102RM*JAK IF  PV-SQL-SUB > PC-MAX-RETRIES                              32650099
1102RM*JAK    MOVE 'MAX RETRIES EXCEEDED FOR UPDATE SIT_SGN_MKT_RLT'    32660099
1102RM*JAK                           TO  PV-MESSAGE                     32670099
1102RM*JAK     PERFORM 9900-PROCESS-DB2-ERROR                           32680099
1102RM*JAK     SET PS-INPUT-REC-ERROR TO TRUE                           32690099
1102RM*JAK END-IF.                                                      32700099
1102RM*                                                                 32710099
1102RM*JAK IF SQLCODE = PC-ROW-NOT-FOUND                                32720099
1102RM*JAK     MOVE 'SIT_SGN_MKT_RLT ROWS NOT FOUND FOR UPDATE'         32730099
1102RM*JAK                           TO  PV-MESSAGE                     32740099
1102RM*JAK     PERFORM 9900-PROCESS-DB2-ERROR                           32750099
1102RM*JAK END-IF.                                                      32760099
                                                                        32770099
      * ------------------------------------------------------------- * 32780099
      * UPDATE THE AD MARKET BEGIN AND END DATES                        32790099
      * ------------------------------------------------------------- * 32800099
      *7110-UPDATE-ADMRKT-ROW.                                          32810099
                                                                        32820099
      *JAK MOVE '7110-UPDATE-ADMRKT-ROW'  TO PV-PARAGRAPH.              32830099
                                                                        32840099
      *JAK PERFORM                                                      32850099
      *JAK     WITH TEST AFTER                                          32860099
      *JAK     VARYING PV-SQL-SUB                                       32870099
      *JAK     FROM 1 BY 1                                              32880099
      *JAK     UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        32890099
      *JAK        OR SQLCODE = 0                                        32900099
      *JAK        OR SQLCODE = PC-ROW-NOT-FOUND                         32910099
      *JAK        OR PS-INPUT-REC-ERROR                                 32920099
      *                                                                 32930099
      *JAK       EXEC SQL                                               32940099
      *JAK           UPDATE TADMRKT                                     32950099
      *JAK           SET  BEG_DTE     = :ADMRKT-BEG-DTE                 32960099
      *JAK              , END_DTE     = :ADMRKT-END-DTE                 32970099
      *JAK           WHERE OPERCO_NBR = :PC-KOHLS-OP-CO                 32980099
      *JAK             AND ADMRKT_ID  = :ADMRKT-ADMRKT-ID               32990099
      *JAK             AND BEG_DTE    = :PV-BEG-DT-ISO-KEY              33000099
      *JAK       END-EXEC                                               33010099
      *                                                                 33020099
      *JAK     EVALUATE TRUE                                            33030099
      *JAK         WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              33040099
      *JAK         WHEN SQLCODE = PC-DEADLOCK                           33050099
      *JAK         WHEN SQLCODE = PC-ROW-NOT-FOUND                      33060099
      *JAK         WHEN SQLCODE = ZERO                                  33070099
      *JAK              CONTINUE                                        33080099
      *JAK         WHEN SQLWARN0 NOT = SPACE                            33090099
      *JAK         WHEN SQLCODE NOT = ZERO                              33100099
      *JAK             MOVE 'BAD SQLCODE FOR UPDATE AD MARKET'          33110099
      *JAK                           TO  PV-MESSAGE                     33120099
      *JAK             PERFORM 9900-PROCESS-DB2-ERROR                   33130099
      *JAK             SET PS-INPUT-REC-ERROR TO TRUE                   33140099
      *JAK     END-EVALUATE                                             33150099
      *JAK END-PERFORM.                                                 33160099
      *                                                                 33170099
      *JAK IF  PV-SQL-SUB > PC-MAX-RETRIES                              33180099
      *JAK     MOVE 'MAX RETRIES EXCEEDED FOR UPDATE AD MARKET'         33190099
      *JAK                           TO  PV-MESSAGE                     33200099
      *JAK     PERFORM 9900-PROCESS-DB2-ERROR                           33210099
      *JAK     SET PS-INPUT-REC-ERROR TO TRUE                           33220099
      *JAK END-IF.                                                      33230099
      *                                                                 33240099
      *JAK IF SQLCODE = PC-ROW-NOT-FOUND                                33250099
      *JAK     MOVE 'AD MARKET ROW NOT FOUND FOR UPDATE'                33260099
      *JAK                           TO  PV-MESSAGE                     33270099
      *JAK     PERFORM 9900-PROCESS-DB2-ERROR                           33280099
      *JAK END-IF.                                                      33290099
                                                                        33300099
      * ------------------------------------------------------------- * 33310099
      * DELETE THE AD MARKET DATA                                       33320099
      * ------------------------------------------------------------- * 33330099
      *7120-DELETE-ADMRKT-ROW.                                          33340099
                                                                        33350099
      *JAK MOVE '7120-DELETE-ADMRKT-ROW'  TO PV-PARAGRAPH.              33360099
                                                                        33370099
      *JAK PERFORM                                                      33380099
      *JAK     WITH TEST AFTER                                          33390099
      *JAK     VARYING PV-SQL-SUB                                       33400099
      *JAK     FROM 1 BY 1                                              33410099
      *JAK     UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        33420099
      *JAK        OR SQLCODE = 0                                        33430099
      *JAK        OR SQLCODE = PC-ROW-NOT-FOUND                         33440099
      *JAK        OR PS-INPUT-REC-ERROR                                 33450099
      *                                                                 33460099
      *JAK       EXEC SQL                                               33470099
      *JAK           DELETE FROM TADMRKT                                33480099
      *JAK           WHERE OPERCO_NBR = :PC-KOHLS-OP-CO                 33490099
      *JAK             AND ADMRKT_ID  = :ADMRKT-ADMRKT-ID               33500099
      *JAK             AND BEG_DTE    = :ADMRKT-BEG-DTE                 33510099
      *JAK       END-EXEC                                               33520099
      *                                                                 33530099
      *JAK     EVALUATE TRUE                                            33540099
      *JAK         WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              33550099
      *JAK         WHEN SQLCODE = PC-DEADLOCK                           33560099
      *JAK         WHEN SQLCODE = PC-ROW-NOT-FOUND                      33570099
      *JAK         WHEN SQLCODE = ZERO                                  33580099
      *JAK              CONTINUE                                        33590099
      *JAK         WHEN SQLWARN0 NOT = SPACE                            33600099
      *JAK         WHEN SQLCODE NOT = ZERO                              33610099
      *JAK             MOVE 'BAD SQLCODE FOR DELETE AD MARKET'          33620099
      *JAK                           TO  PV-MESSAGE                     33630099
      *JAK             PERFORM 9900-PROCESS-DB2-ERROR                   33640099
      *JAK             SET PS-INPUT-REC-ERROR TO TRUE                   33650099
      *JAK     END-EVALUATE                                             33660099
      *JAK END-PERFORM.                                                 33670099
      *                                                                 33680099
      *JAK IF  PV-SQL-SUB > PC-MAX-RETRIES                              33690099
      *JAK     MOVE 'MAX RETRIES EXCEEDED FOR DELETE AD MARKET'         33700099
      *JAK                           TO  PV-MESSAGE                     33710099
      *JAK     PERFORM 9900-PROCESS-DB2-ERROR                           33720099
      *JAK     SET PS-INPUT-REC-ERROR TO TRUE                           33730099
      *JAK END-IF.                                                      33740099
      *                                                                 33750099
      *JAK IF SQLCODE = PC-ROW-NOT-FOUND                                33760099
      *JAK     MOVE 'AD MARKET ROW NOT FOUND FOR DELETE'                33770099
      *JAK                           TO  PV-MESSAGE                     33780099
      *JAK     PERFORM 9900-PROCESS-DB2-ERROR                           33790099
      *JAK END-IF.                                                      33800099
                                                                        33810099
                                                                        33820099
      *----------------------------------------------------------------*33830099
      *   SEE IF THE AD MARKET IS ASSIGNED TO ANY STORES.               33840099
      *----------------------------------------------------------------*33850099
      *7130-COUNT-STORES-IN-ADMRKT.                                     33860099
                                                                        33870099
      *JAK MOVE '7130-COUNT-STORES-IN-ADMRKT' TO PV-PARAGRAPH.          33880099
1102RM*JAK MOVE 0 TO PV-NBR-OF-STORES.                                  33890099
                                                                        33900099
      *JAK PERFORM                                                      33910099
      *JAK     WITH TEST AFTER                                          33920099
      *JAK     VARYING PV-SQL-SUB                                       33930099
      *JAK     FROM 1 BY 1                                              33940099
      *JAK     UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        33950099
      *JAK        OR SQLCODE = 0                                        33960099
      *JAK        OR PS-INPUT-REC-ERROR                                 33970099
                                                                        33980099
      *JAK        EXEC SQL                                              33990099
      *JAK            SELECT  COUNT(*)                                  34000099
      *JAK              INTO :PV-NBR-OF-STORES                          34010099
      *JAK              FROM TSTRMKT                                    34020099
      *JAK            WHERE ADMRKT_ID = :STRMKT-ADMRKT-ID               34030099
      *JAK        END-EXEC                                              34040099
                                                                        34050099
      *JAK     EVALUATE TRUE                                            34060099
      *JAK         WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              34070099
      *JAK         WHEN SQLCODE = PC-DEADLOCK                           34080099
      *JAK         WHEN SQLCODE = ZERO                                  34090099
      *JAK              CONTINUE                                        34100099
      *JAK         WHEN SQLWARN0 NOT = SPACE                            34110099
      *JAK         WHEN SQLCODE  NOT = ZERO                             34120099
      *JAK             MOVE 'BAD SQLCODE FOR SELECT TSTRMKT'            34130099
      *JAK                           TO  PV-MESSAGE                     34140099
      *JAK             PERFORM 9900-PROCESS-DB2-ERROR                   34150099
      *JAK             SET PS-INPUT-REC-ERROR TO TRUE                   34160099
      *JAK     END-EVALUATE                                             34170099
      *JAK END-PERFORM.                                                 34180099
                                                                        34190099
      *JAK IF  PV-SQL-SUB > PC-MAX-RETRIES                              34200099
      *JAK     MOVE 'MAX RETRIES EXCEEDED FOR SELECT TSTRMKT'           34210099
      *JAK                           TO  PV-MESSAGE                     34220099
      *JAK     PERFORM 9900-PROCESS-DB2-ERROR                           34230099
      *JAK     SET PS-INPUT-REC-ERROR TO TRUE                           34240099
      *JAK END-IF.                                                      34250099
      *                                                                 34260099
1102RM*----------------------------------------------------------------*34270099
1102RM*   SEE IF THE AD MARKET IS ASSIGNED ANY SIGN RELATIONSHIPS       34280099
1102RM*----------------------------------------------------------------*34290099
1102RM*7135-COUNT-STORES-IN-SITSGNMK.                                   34300099
1102RM                                                                  34310099
1102RM*JAK MOVE '7135-COUNT-STORES-IN-SITSGNMK' TO PV-PARAGRAPH.        34320099
1102RM*JAK MOVE 0 TO PV-NBR-OF-SIGNS.                                   34330099
1102RM                                                                  34340099
1102RM*JAK PERFORM                                                      34350099
1102RM*JAK     WITH TEST AFTER                                          34360099
1102RM*JAK     VARYING PV-SQL-SUB                                       34370099
1102RM*JAK     FROM 1 BY 1                                              34380099
1102RM*JAK     UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        34390099
1102RM*JAK        OR SQLCODE = 0                                        34400099
1102RM*JAK        OR PS-INPUT-REC-ERROR                                 34410099
1102RM                                                                  34420099
1102RM*JAK        EXEC SQL                                              34430099
1102RM*JAK            SELECT  COUNT(*)                                  34440099
1102RM*JAK              INTO :PV-NBR-OF-SIGNS                           34450099
1102RM*JAK              FROM SIT_SGN_MKT_RLT                            34460099
1102RM*JAK             WHERE OPERCO_NBR = :PC-KOHLS-OP-CO               34470099
1102RM*JAK               AND ADMRKT_ID  = :HO100-PZD-PZ-DESCRIP1-3      34480099
1102RM*JAK        END-EXEC                                              34490099
1102RM                                                                  34500099
1102RM*JAK     EVALUATE TRUE                                            34510099
1102RM*JAK         WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              34520099
1102RM*JAK         WHEN SQLCODE = PC-DEADLOCK                           34530099
1102RM*JAK         WHEN SQLCODE = ZERO                                  34540099
1102RM*JAK              CONTINUE                                        34550099
1102RM*JAK         WHEN SQLWARN0 NOT = SPACE                            34560099
1102RM*JAK         WHEN SQLCODE  NOT = ZERO                             34570099
1102RM*JAK             MOVE 'BAD SQLCODE FOR SELECT SIT_SGN_MKT_RLT'    34580099
1102RM*JAK                           TO  PV-MESSAGE                     34590099
1102RM*JAK             PERFORM 9900-PROCESS-DB2-ERROR                   34600099
1102RM*JAK             SET PS-INPUT-REC-ERROR TO TRUE                   34610099
1102RM*JAK     END-EVALUATE                                             34620099
1102RM*JAK END-PERFORM.                                                 34630099
1102RM                                                                  34640099
1102RM*JAK IF  PV-SQL-SUB > PC-MAX-RETRIES                              34650099
1102RM*JAK     MOVE 'MAX RETRIES EXCEEDED FOR SELECT SIT_SGN_MKT_RLT'   34660099
1102RM*JAK                           TO  PV-MESSAGE                     34670099
1102RM*JAK     PERFORM 9900-PROCESS-DB2-ERROR                           34680099
1102RM*JAK     SET PS-INPUT-REC-ERROR TO TRUE                           34690099
1102RM*JAK END-IF.                                                      34700099
      * ------------------------------------------------------------- * 34710096
      * INSERT THE REGION DATA                                          34720096
      * ------------------------------------------------------------- * 34730096
      *7200-INSERT-REGION-ROW.                                          34740099
      *                                                                 34750099
      *JAK MOVE '7200-INSERT-REGION-ROW' TO  PV-PARAGRAPH.              34760099
      *                                                                 34770099
      *JAK PERFORM                                                      34780099
      *JAK     WITH TEST AFTER                                          34790099
      *JAK     VARYING PV-SQL-SUB                                       34800099
      *JAK     FROM 1 BY 1                                              34810099
      *JAK     UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        34820099
      *JAK        OR SQLCODE = 0                                        34830099
      *JAK        OR PS-INPUT-REC-ERROR                                 34840099
      *                                                                 34850096
      *JAK       EXEC SQL                                               34860099
      *JAK           INSERT INTO TRGN000                                34870099
      *JAK                    (REGN_NBR                                 34880099
      *JAK                   , REGN_NM                                  34890099
      *JAK                   , MGR_NM                                   34900099
      *JAK                   , TERR_NBR )                               34910099
      *JAK           VALUES (: RGN000-REGN-NBR                          34920099
      *JAK                 , : RGN000-REGN-NM                           34930099
      *JAK                 , : RGN000-MGR-NM                            34940099
      *JAK                 , : RGN000-TERR-NBR )                        34950099
      *JAK       END-EXEC                                               34960099
      *                                                                 34970096
      *JAK     EVALUATE TRUE                                            34980099
      *JAK         WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              34990099
      *JAK         WHEN SQLCODE = PC-DEADLOCK                           35000099
      *JAK         WHEN SQLCODE = PC-ROW-NOT-FOUND                      35010099
      *JAK         WHEN SQLCODE = ZERO                                  35020099
      *JAK              CONTINUE                                        35030099
      *JAK         WHEN SQLWARN0 NOT = SPACE                            35040099
      *JAK         WHEN SQLCODE NOT = ZERO                              35050099
      *JAK             MOVE 'BAD SQLCODE FOR INSERT REGION'             35060099
      *JAK                           TO  PV-MESSAGE                     35070099
      *JAK             PERFORM 9900-PROCESS-DB2-ERROR                   35080099
      *JAK             SET PS-INPUT-REC-ERROR TO TRUE                   35090099
      *JAK     END-EVALUATE                                             35100099
      *JAK END-PERFORM.                                                 35110099
      *                                                                 35120096
      *JAK IF  PV-SQL-SUB > PC-MAX-RETRIES                              35130099
      *JAK     MOVE 'MAX RETRIES EXCEEDED FOR INSERT REGION'            35140099
      *JAK                           TO  PV-MESSAGE                     35150099
      *JAK     PERFORM 9900-PROCESS-DB2-ERROR                           35160099
      *JAK     SET PS-INPUT-REC-ERROR TO TRUE                           35170099
      *JAK END-IF.                                                      35180099
      *                                                                 35190099
      * ------------------------------------------------------------- * 35200099
      * UPDATE THE REGION DATA                                          35210099
      * ------------------------------------------------------------- * 35220099
      *7210-UPDATE-REGION-ROW.                                          35230099
      *                                                                 35240099
      *JAK MOVE '7210-UPDATE-REGION-ROW' TO  PV-PARAGRAPH.              35250099
      *                                                                 35260099
      *JAK PERFORM                                                      35270099
      *JAK     WITH TEST AFTER                                          35280099
      *JAK     VARYING PV-SQL-SUB                                       35290099
      *JAK     FROM 1 BY 1                                              35300099
      *JAK     UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        35310099
      *JAK        OR SQLCODE = 0                                        35320099
      *JAK        OR SQLCODE = PC-ROW-NOT-FOUND                         35330099
      *JAK        OR PS-INPUT-REC-ERROR                                 35340099
      *                                                                 35350099
      *JAK       EXEC SQL                                               35360099
      *JAK           UPDATE TRGN000                                     35370099
      *JAK           SET REGN_NM       = : RGN000-REGN-NM               35380099
      *JAK             , MGR_NM        = : RGN000-MGR-NM                35390099
      *JAK             , TERR_NBR      = : RGN000-TERR-NBR              35400099
      *JAK           WHERE (REGN_NBR   = : RGN000-REGN-NBR)             35410099
      *JAK       END-EXEC                                               35420099
      *                                                                 35430099
      *JAK     EVALUATE TRUE                                            35440099
      *JAK         WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              35450099
      *JAK         WHEN SQLCODE = PC-DEADLOCK                           35460099
      *JAK         WHEN SQLCODE = PC-ROW-NOT-FOUND                      35470099
      *JAK         WHEN SQLCODE = ZERO                                  35480099
      *JAK              CONTINUE                                        35490099
      *JAK         WHEN SQLWARN0 NOT = SPACE                            35500099
      *JAK         WHEN SQLCODE NOT = ZERO                              35510099
      *JAK             MOVE 'BAD SQLCODE FOR UPDATE REGION'             35520099
      *JAK                           TO  PV-MESSAGE                     35530099
      *JAK             PERFORM 9900-PROCESS-DB2-ERROR                   35540099
      *JAK             SET PS-INPUT-REC-ERROR TO TRUE                   35550099
      *JAK     END-EVALUATE                                             35560099
      *JAK END-PERFORM.                                                 35570099
      *                                                                 35580099
      *JAK IF  PV-SQL-SUB > PC-MAX-RETRIES                              35590099
      *JAK     MOVE 'MAX RETRIES EXCEEDED FOR UPDATE REGION'            35600099
      *JAK                           TO  PV-MESSAGE                     35610099
      *JAK     PERFORM 9900-PROCESS-DB2-ERROR                           35620099
      *JAK     SET PS-INPUT-REC-ERROR TO TRUE                           35630099
      *JAK END-IF.                                                      35640099
      *                                                                 35650099
      *JAK IF SQLCODE = PC-ROW-NOT-FOUND                                35660099
      *JAK     MOVE 'REGION ROW NOT FOUND FOR UPDATE'                   35670099
      *JAK                           TO  PV-MESSAGE                     35680099
      *JAK     PERFORM 9900-PROCESS-DB2-ERROR                           35690099
      *JAK END-IF.                                                      35700099
      *                                                                 35710096
      * ------------------------------------------------------------- * 35720096
      * DELETE THE REGION DATA                                          35730096
      * ------------------------------------------------------------- * 35740096
      *7220-DELETE-REGION-ROW.                                          35750099
      *                                                                 35760099
      *JAK MOVE '7220-DELETE-REGION-ROW' TO  PV-PARAGRAPH.              35770099
      *                                                                 35780099
      *JAK PERFORM                                                      35790099
      *JAK     WITH TEST AFTER                                          35800099
      *JAK     VARYING PV-SQL-SUB                                       35810099
      *JAK     FROM 1 BY 1                                              35820099
      *JAK     UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        35830099
      *JAK        OR SQLCODE = 0                                        35840099
      *JAK        OR SQLCODE = PC-ROW-NOT-FOUND                         35850099
      *JAK        OR PS-INPUT-REC-ERROR                                 35860099
      *                                                                 35870096
      *JAK       EXEC SQL                                               35880099
      *JAK           DELETE FROM TRGN000                                35890099
      *JAK           WHERE REGN_NBR   = : RGN000-REGN-NBR               35900099
      *JAK       END-EXEC                                               35910099
      *                                                                 35920096
      *JAK     EVALUATE TRUE                                            35930099
      *JAK         WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              35940099
      *JAK         WHEN SQLCODE = PC-DEADLOCK                           35950099
      *JAK         WHEN SQLCODE = ZERO                                  35960099
      *JAK              CONTINUE                                        35970099
      *JAK         WHEN SQLWARN0 NOT = SPACE                            35980099
      *JAK         WHEN SQLCODE NOT = ZERO                              35990099
      *JAK             MOVE 'BAD SQLCODE FOR DELETE REGION'             36000099
      *JAK                           TO  PV-MESSAGE                     36010099
      *JAK             PERFORM 9900-PROCESS-DB2-ERROR                   36020099
      *JAK             SET PS-INPUT-REC-ERROR TO TRUE                   36030099
      *JAK     END-EVALUATE                                             36040099
      *JAK END-PERFORM.                                                 36050099
      *                                                                 36060096
      *JAK IF  PV-SQL-SUB > PC-MAX-RETRIES                              36070099
      *JAK     MOVE 'MAX RETRIES EXCEEDED FOR DELETE REGION'            36080099
      *JAK                           TO  PV-MESSAGE                     36090099
      *JAK     PERFORM 9900-PROCESS-DB2-ERROR                           36100099
      *JAK     SET PS-INPUT-REC-ERROR TO TRUE                           36110099
      *JAK END-IF.                                                      36120099
                                                                        36130096
      *                                                                 36140096
      * ------------------------------------------------------------- * 36150096
      * UPDATE THE DISTRICT DATA                                        36160096
      * ------------------------------------------------------------- * 36170096
       7400-UPDATE-DISTRICT-ROW.                                        36180096
                                                                        36190096
           MOVE '7400-UPDATE-DISTRICT-ROW' TO PV-PARAGRAPH.             36200096
                                                                        36210096
           PERFORM                                                      36220096
               WITH TEST AFTER                                          36230096
               VARYING PV-SQL-SUB                                       36240096
               FROM 1 BY 1                                              36250096
               UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        36260096
                  OR SQLCODE = 0                                        36270096
                  OR SQLCODE = PC-ROW-NOT-FOUND                         36280096
                  OR PS-INPUT-REC-ERROR                                 36290096
      *                                                                 36300096
                 EXEC SQL                                               36310096
                     UPDATE TDST000                                     36320096
                     SET DISTRICT_NAME = : TDST000-DISTRICT-NAME        36330096
                       , MGR_NAME      = : TDST000-MGR-NAME             36340096
                       , MGR_LOC_NMBR  = : TDST000-MGR-LOC-NMBR         36350096
                       , REGN_NBR      = : TDST000-REGN-NBR             36360096
                     WHERE ((OP_CO_NMBR    = :PC-KOHLS-OP-CO)           36370096
                       AND  (DISTRICT_NMBR = :TDST000-DISTRICT-NMBR))   36380096
                 END-EXEC                                               36390096
      *                                                                 36400096
               EVALUATE TRUE                                            36410096
                   WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              36420096
                   WHEN SQLCODE = PC-DEADLOCK                           36430096
                   WHEN SQLCODE = PC-ROW-NOT-FOUND                      36440096
                   WHEN SQLCODE = ZERO                                  36450096
                        CONTINUE                                        36460096
                   WHEN SQLWARN0 NOT = SPACE                            36470096
                   WHEN SQLCODE NOT = ZERO                              36480096
                       MOVE 'BAD SQLCODE FOR UPDATE DISTRICT'           36490096
                                     TO  PV-MESSAGE                     36500096
                       PERFORM 9900-PROCESS-DB2-ERROR                   36510096
                       SET PS-INPUT-REC-ERROR TO TRUE                   36520096
               END-EVALUATE                                             36530096
           END-PERFORM.                                                 36540096
      *                                                                 36550096
           IF  PV-SQL-SUB > PC-MAX-RETRIES                              36560096
               MOVE 'MAX RETRIES EXCEEDED FOR UPDATE DISTRICT'          36570096
                                     TO  PV-MESSAGE                     36580096
               PERFORM 9900-PROCESS-DB2-ERROR                           36590096
               SET PS-INPUT-REC-ERROR TO TRUE                           36600096
           END-IF.                                                      36610096
                                                                        36620096
           IF SQLCODE = PC-ROW-NOT-FOUND                                36630096
               MOVE 'DISTRICT ROW NOT FOUND FOR UPDATE'                 36640096
                                     TO  PV-MESSAGE                     36650096
               PERFORM 9900-PROCESS-DB2-ERROR                           36660096
           END-IF.                                                      36670096
      *                                                                 36680096
      * ------------------------------------------------------------- * 36690096
      * INSERT THE DISTRICT ROW                                         36700096
      * ------------------------------------------------------------- * 36710096
       7410-INSERT-DISTRICT-ROW.                                        36720096
                                                                        36730096
           MOVE '7410-INSERT-DISTRICT-ROW' TO  PV-PARAGRAPH.            36740096
                                                                        36750096
           PERFORM                                                      36760096
               WITH TEST AFTER                                          36770096
               VARYING PV-SQL-SUB                                       36780096
               FROM 1 BY 1                                              36790096
               UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        36800096
                  OR SQLCODE = 0                                        36810096
                  OR PS-INPUT-REC-ERROR                                 36820096
      *                                                                 36830096
                 EXEC SQL                                               36840096
                     INSERT INTO TDST000                                36850096
                              (OP_CO_NMBR                               36860096
                             , DISTRICT_NMBR                            36870096
                             , DISTRICT_NAME                            36880096
                             , MGR_NAME                                 36890096
                             , MGR_LOC_NMBR                             36900096
                             , REGN_NBR )                               36910096
                     VALUES (: PC-KOHLS-OP-CO                           36920096
                           , : TDST000-DISTRICT-NMBR                    36930096
                           , : TDST000-DISTRICT-NAME                    36940096
                           , : TDST000-MGR-NAME                         36950096
                           , : TDST000-MGR-LOC-NMBR                     36960096
                           , : TDST000-REGN-NBR )                       36970096
                 END-EXEC                                               36980096
      *                                                                 36990096
               EVALUATE TRUE                                            37000096
                   WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              37010096
                   WHEN SQLCODE = PC-DEADLOCK                           37020096
                   WHEN SQLCODE = PC-ROW-NOT-FOUND                      37030096
                   WHEN SQLCODE = ZERO                                  37040096
                        CONTINUE                                        37050096
                   WHEN SQLWARN0 NOT = SPACE                            37060096
                   WHEN SQLCODE NOT = ZERO                              37070096
                       MOVE 'BAD SQLCODE FOR INSERT DISTRICT'           37080096
                                     TO  PV-MESSAGE                     37090096
                       PERFORM 9900-PROCESS-DB2-ERROR                   37100096
                       SET PS-INPUT-REC-ERROR TO TRUE                   37110096
               END-EVALUATE                                             37120096
           END-PERFORM.                                                 37130096
      *                                                                 37140096
           IF  PV-SQL-SUB > PC-MAX-RETRIES                              37150096
               MOVE 'MAX RETRIES EXCEEDED FOR INSERT DISTRICT'          37160096
                                     TO  PV-MESSAGE                     37170096
               PERFORM 9900-PROCESS-DB2-ERROR                           37180096
               SET PS-INPUT-REC-ERROR TO TRUE                           37190096
           END-IF.                                                      37200096
      *                                                                 37210096
      * ------------------------------------------------------------- * 37220096
      * DELETE THE DISTRICT ROW                                         37230096
      * ------------------------------------------------------------- * 37240096
       7420-DELETE-DISTRICT-ROW.                                        37250096
           MOVE '7420-DELETE-DISTRICT-ROW' TO  PV-PARAGRAPH.            37260096
                                                                        37270096
           PERFORM                                                      37280096
               WITH TEST AFTER                                          37290096
               VARYING PV-SQL-SUB                                       37300096
               FROM 1 BY 1                                              37310096
               UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        37320096
                  OR SQLCODE = 0                                        37330096
                  OR SQLCODE = PC-ROW-NOT-FOUND                         37340096
                  OR PS-INPUT-REC-ERROR                                 37350096
      *                                                                 37360096
                 EXEC SQL                                               37370096
                     DELETE FROM TDST000                                37380096
                   WHERE ((OP_CO_NMBR    = :PC-KOHLS-OP-CO)             37390096
                     AND  (DISTRICT_NMBR = :PV-KEY-NBR-3-4))            37400096
                 END-EXEC                                               37410096
      *                                                                 37420096
               EVALUATE TRUE                                            37430096
                   WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              37440096
                   WHEN SQLCODE = PC-DEADLOCK                           37450096
                   WHEN SQLCODE = PC-ROW-NOT-FOUND                      37460096
                   WHEN SQLCODE = ZERO                                  37470096
                        CONTINUE                                        37480096
                   WHEN SQLWARN0 NOT = SPACE                            37490096
                   WHEN SQLCODE NOT = ZERO                              37500096
                       MOVE 'BAD SQLCODE FOR DELETE DISTRICT'           37510096
                                     TO  PV-MESSAGE                     37520096
                       PERFORM 9900-PROCESS-DB2-ERROR                   37530096
                       SET PS-INPUT-REC-ERROR TO TRUE                   37540096
               END-EVALUATE                                             37550096
           END-PERFORM.                                                 37560096
      *                                                                 37570096
           IF  PV-SQL-SUB > PC-MAX-RETRIES                              37580096
               MOVE 'MAX RETRIES EXCEEDED FOR DELETE DISTRICT'          37590096
                                     TO  PV-MESSAGE                     37600096
               PERFORM 9900-PROCESS-DB2-ERROR                           37610096
               SET PS-INPUT-REC-ERROR TO TRUE                           37620096
           END-IF.                                                      37630096
      *                                                                 37640096
           IF SQLCODE = PC-ROW-NOT-FOUND                                37650096
               MOVE 'DISTRICT ROW NOT FOUND FOR DELETE'                 37660096
                                     TO  PV-MESSAGE                     37670096
               PERFORM 9900-PROCESS-DB2-ERROR                           37680096
           END-IF.                                                      37690096
                                                                        37700096
      * ------------------------------------------------------------- * 37710096
      * SELECT THE STORE ROW                                            37720096
      * ------------------------------------------------------------- * 37730096
       7600-SELECT-STORE-ROW.                                           37740096
      *                                                                 37750096
           MOVE '7600-SELECT-STORE-ROW' TO  PV-PARAGRAPH.               37760096
           PERFORM                                                      37770096
               WITH TEST AFTER                                          37780096
               VARYING PV-SQL-SUB                                       37790096
               FROM 1 BY 1                                              37800096
               UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        37810096
                  OR SQLCODE = ZERO                                     37820096
                  OR SQLCODE = PC-ROW-NOT-FOUND                         37830096
                  OR PS-INPUT-REC-ERROR                                 37840096
      *                                                                 37850096
               EXEC SQL                                                 37860096
                 SELECT                                                 37870096
                     OP_CO_NMBR                                         37880096
                   , STORE_NMBR                                         37890096
                   , TYPE_CODE                                          37900096
                   , TWO_DIGIT_NMBR                                     37910096
                   , STORE_NAME                                         37920096
                   , CHAR10_ABBR_NAME                                   37930096
                   , CHAR5_ABBR_NAME                                    37940096
                   , MAIL_ADDR_ONE_DESC                                 37950096
                   , MAIL_ADDR_TWO_DESC                                 37960096
                   , CITY_NAME                                          37970096
                   , STATE_CODE                                         37980096
                   , ZIP_PLUS4_CODE                                     37990096
                   , PHONE_NMBR                                         38000096
                   , TOLLFREE_PHNE_NMBR                                 38010096
                   , OPENED_DATE                                        38020096
                   , CLOSED_DATE                                        38030096
                   , SELLING_SQFT_NMBR                                  38040096
                   , FINANCE_CORP_NMBR                                  38050096
                   , DISTRICT_NMBR                                      38060096
                   , MGR_NAME                                           38070096
                   , DC_CODE                                            38080096
                   , DC1_NMBR                                           38090096
                   , DC1_PO_START_DATE                                  38100096
                   , DC1_PO_STOP_DATE                                   38110096
                   , DC1_RCT_START_DATE                                 38120096
                   , DC1_RCT_STOP_DATE                                  38130096
                   , DC2_NMBR                                           38140096
                   , DC2_PO_START_DATE                                  38150096
                   , DC2_PO_STOP_DATE                                   38160096
                   , DC2_RCT_START_DATE                                 38170096
                   , DC2_RCT_STOP_DATE                                  38180096
                   , DSCVR_MERCH_NMBR                                   38190096
                   , BNKCD_MERCH_NMBR                                   38200096
                   , SUBSCRIPT_NMBR                                     38210096
                   , AMLOAD_INDCT                                       38220096
                   , CK_AUTH_GRP_NMBR                                   38230096
                   , PLU_SYSTEM_CODE                                    38240096
                   , FIN_CLS_DTE                                        38250096
                   , CASH_RET_AUTH_NBR                                  38260096
                   , YR_SLS_INCL_DTE                                    38270096
                   , MO_SLS_INCL_DTE                                    38280096
                   , REPL_STORE_NBR                                     38290096
                   , MFST_NBR                                           38300096
                   , POS_CAP_LVL                                        38310096
                   , PERM_RLSE_AVL_NBR                                  38320096
                   , CENPPC_CRE_IND                                     38330096
                   , RF_BEG_IP_ADR                                      38340096
                   , RF_END_IP_ADR                                      38350096
                   , STR_NBR                                            38360096
                   , MET_NBR                                            38370096
                   , LAST_CHG_DTE                                       38380096
                   , QTR_SLS_INCL_DTE                                   38390096
                   , SEA_SLS_INCL_DTE                                   38400096
                   , STR_CMPR_DTE_CDE                                   38410096
                   , AMEX_MERCH_NBR                                     38420096
                   , SGN_PRT_LOC_ID                                     38430096
                   , SGN_PRT_GRP_ID                                     38440096
                   , OCPNC_DTE                                          38450096
                   , LBR_SFWR_LVL_ID                                    38460096
                   , EST_HH_INCM_AMT                                    38470096
                   , MEDN_AGE_NBR                                       38480096
                   , CNTY_ID                                            38490096
                   , LCLTY_ID                                           38500096
                   , STD_TM_ZN_CDE                                      38510096
                   , DST_CDE                                            38520096
                   , E_BUS_LOC_IND                                      38530096
             INTO   : TSTR000-OP-CO-NMBR                                38540096
                  , : TSTR000-STORE-NMBR                                38550096
                  , : TSTR000-TYPE-CODE                                 38560096
                  , : TSTR000-TWO-DIGIT-NMBR                            38570096
                  , : TSTR000-STORE-NAME                                38580096
                  , : TSTR000-CHAR10-ABBR-NAME                          38590096
                  , : TSTR000-CHAR5-ABBR-NAME                           38600096
                  , : TSTR000-MAIL-ADDR-ONE-DESC                        38610096
                  , : TSTR000-MAIL-ADDR-TWO-DESC                        38620096
                  , : TSTR000-CITY-NAME                                 38630096
                  , : TSTR000-STATE-CODE                                38640096
                  , : TSTR000-ZIP-PLUS4-CODE                            38650096
                  , : TSTR000-PHONE-NMBR                                38660096
                  , : TSTR000-TOLLFREE-PHNE-NMBR                        38670096
                  , : TSTR000-OPENED-DATE                               38680096
                  , : TSTR000-CLOSED-DATE                               38690096
                  , : TSTR000-SELLING-SQFT-NMBR                         38700096
                  , : TSTR000-FINANCE-CORP-NMBR                         38710096
                  , : TSTR000-DISTRICT-NMBR                             38720096
                  , : TSTR000-MGR-NAME                                  38730096
                  , : TSTR000-DC-CODE                                   38740096
                  , : TSTR000-DC1-NMBR                                  38750096
                  , : TSTR000-DC1-PO-START-DATE                         38760096
                  , : TSTR000-DC1-PO-STOP-DATE                          38770096
                  , : TSTR000-DC1-RCT-START-DATE                        38780096
                  , : TSTR000-DC1-RCT-STOP-DATE                         38790096
                  , : TSTR000-DC2-NMBR                                  38800096
                  , : TSTR000-DC2-PO-START-DATE                         38810096
                  , : TSTR000-DC2-PO-STOP-DATE                          38820096
                  , : TSTR000-DC2-RCT-START-DATE                        38830096
                  , : TSTR000-DC2-RCT-STOP-DATE                         38840096
                  , : TSTR000-DSCVR-MERCH-NMBR                          38850096
                  , : TSTR000-BNKCD-MERCH-NMBR                          38860096
                  , : TSTR000-SUBSCRIPT-NMBR                            38870096
                  , : TSTR000-AMLOAD-INDCT                              38880096
                  , : TSTR000-CK-AUTH-GRP-NMBR                          38890096
                  , : TSTR000-PLU-SYSTEM-CODE                           38900096
                  , : TSTR000-FIN-CLS-DTE                               38910096
                  , : TSTR000-CASH-RET-AUTH-NBR                         38920096
                  , : TSTR000-YR-SLS-INCL-DTE                           38930096
                  , : TSTR000-MO-SLS-INCL-DTE                           38940096
                  , : TSTR000-REPL-STORE-NBR                            38950096
                  , : TSTR000-MFST-NBR                                  38960096
                  , : TSTR000-POS-CAP-LVL                               38970096
                  , : TSTR000-PERM-RLSE-AVL-NBR                         38980096
                  , : TSTR000-CENPPC-CRE-IND                            38990096
                  , : TSTR000-RF-BEG-IP-ADR                             39000096
                  , : TSTR000-RF-END-IP-ADR                             39010096
                  , : TSTR000-STR-NBR                                   39020096
                  , : TSTR000-MET-NBR                                   39030096
                  , : TSTR000-LAST-CHG-DTE                              39040096
                  , : TSTR000-QTR-SLS-INCL-DTE                          39050096
                  , : TSTR000-SEA-SLS-INCL-DTE                          39060096
                  , : TSTR000-STR-CMPR-DTE-CDE                          39070096
                  , : TSTR000-AMEX-MERCH-NBR                            39080096
                  , : TSTR000-SGN-PRT-LOC-ID                            39090096
                  , : TSTR000-SGN-PRT-GRP-ID                            39100096
                  , : TSTR000-OCPNC-DTE                                 39110096
                  , : TSTR000-LBR-SFWR-LVL-ID                           39120096
                  , : TSTR000-EST-HH-INCM-AMT                           39130096
                  , : TSTR000-MEDN-AGE-NBR                              39140096
                  , : TSTR000-CNTY-ID                                   39150096
                  , : TSTR000-LCLTY-ID                                  39160096
                  , : TSTR000-STD-TM-ZN-CDE                             39170096
                  , : TSTR000-DST-CDE                                   39180096
                  , : TSTR000-E-BUS-LOC-IND                             39190096
                         FROM TSTR000                                   39200096
                            WHERE ((OP_CO_NMBR = : PC-KOHLS-OP-CO)      39210096
                               AND (STORE_NMBR = : PV-KEY-NBR-2-4))     39220096
               END-EXEC                                                 39230096
                                                                        39240096
               EVALUATE TRUE                                            39250096
                   WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              39260096
                   WHEN SQLCODE = PC-DEADLOCK                           39270096
                   WHEN SQLCODE = ZERO                                  39280096
                        CONTINUE                                        39290096
                   WHEN SQLWARN0 NOT = SPACE                            39300096
                   WHEN SQLCODE NOT = ZERO                              39310096
                       MOVE 'BAD SQLCODE FOR SELECT STORE'              39320096
                                     TO  PV-MESSAGE                     39330096
                       PERFORM 9900-PROCESS-DB2-ERROR                   39340096
                       SET PS-INPUT-REC-ERROR TO TRUE                   39350096
               END-EVALUATE                                             39360096
           END-PERFORM.                                                 39370096
      *                                                                 39380096
           IF PV-SQL-SUB > PC-MAX-RETRIES                               39390096
               MOVE 'MAX RETRIES EXCEEDED FOR SELECT STORE'             39400096
                                     TO  PV-MESSAGE                     39410096
               PERFORM 9900-PROCESS-DB2-ERROR                           39420096
               SET PS-INPUT-REC-ERROR TO TRUE                           39430096
           END-IF.                                                      39440096
      *                                                                 39450096
      * ------------------------------------------------------------- * 39460096
      * UPDATE THE STORE DATA                                           39470096
      * ------------------------------------------------------------- * 39480096
       7610-UPDATE-STORE-ROW.                                           39490096
                                                                        39500096
           MOVE '7610-UPDATE-STORE-ROW' TO  PV-PARAGRAPH.               39510096
           PERFORM                                                      39520096
            WITH TEST AFTER                                             39530096
            VARYING PV-SQL-SUB                                          39540096
            FROM 1 BY 1                                                 39550096
            UNTIL PV-SQL-SUB > PC-MAX-RETRIES                           39560096
               OR SQLCODE = 0                                           39570096
               OR SQLCODE = PC-ROW-NOT-FOUND                            39580096
               OR PS-INPUT-REC-ERROR                                    39590096
                                                                        39600096
              EXEC SQL                                                  39610096
                UPDATE TSTR000                                          39620096
                SET OP_CO_NMBR         = : TSTR000-OP-CO-NMBR           39630096
                   ,STORE_NMBR         = : TSTR000-STORE-NMBR           39640096
                   ,TYPE_CODE          = : TSTR000-TYPE-CODE            39650096
                   ,TWO_DIGIT_NMBR     = : TSTR000-TWO-DIGIT-NMBR       39660096
                   ,STORE_NAME         = : TSTR000-STORE-NAME           39670096
                   ,CHAR10_ABBR_NAME   = : TSTR000-CHAR10-ABBR-NAME     39680096
                   ,CHAR5_ABBR_NAME    = : TSTR000-CHAR5-ABBR-NAME      39690096
                   ,MAIL_ADDR_ONE_DESC = : TSTR000-MAIL-ADDR-ONE-DESC   39700096
                   ,MAIL_ADDR_TWO_DESC = : TSTR000-MAIL-ADDR-TWO-DESC   39710096
                   ,CITY_NAME          = : TSTR000-CITY-NAME            39720096
                   ,STATE_CODE         = : TSTR000-STATE-CODE           39730096
                   ,ZIP_PLUS4_CODE     = : TSTR000-ZIP-PLUS4-CODE       39740096
                   ,PHONE_NMBR         = : TSTR000-PHONE-NMBR           39750096
                   ,TOLLFREE_PHNE_NMBR = : TSTR000-TOLLFREE-PHNE-NMBR   39760096
                   ,OPENED_DATE        = : TSTR000-OPENED-DATE          39770096
                   ,CLOSED_DATE        = : TSTR000-CLOSED-DATE          39780096
                   ,SELLING_SQFT_NMBR  = : TSTR000-SELLING-SQFT-NMBR    39790096
                   ,FINANCE_CORP_NMBR  = : TSTR000-FINANCE-CORP-NMBR    39800096
                   ,DISTRICT_NMBR      = : TSTR000-DISTRICT-NMBR        39810096
                   ,MGR_NAME           = : TSTR000-MGR-NAME             39820096
                   ,DC_CODE            = : TSTR000-DC-CODE              39830096
                   ,DC1_NMBR           = : TSTR000-DC1-NMBR             39840096
                   ,DC1_PO_START_DATE  = : TSTR000-DC1-PO-START-DATE    39850096
                   ,DC1_PO_STOP_DATE   = : TSTR000-DC1-PO-STOP-DATE     39860096
                   ,DC1_RCT_START_DATE = : TSTR000-DC1-RCT-START-DATE   39870096
                   ,DC1_RCT_STOP_DATE  = : TSTR000-DC1-RCT-STOP-DATE    39880096
                   ,DC2_NMBR           = : TSTR000-DC2-NMBR             39890096
                   ,DC2_PO_START_DATE  = : TSTR000-DC2-PO-START-DATE    39900096
                   ,DC2_PO_STOP_DATE   = : TSTR000-DC2-PO-STOP-DATE     39910096
                   ,DC2_RCT_START_DATE = : TSTR000-DC2-RCT-START-DATE   39920096
                   ,DC2_RCT_STOP_DATE  = : TSTR000-DC2-RCT-STOP-DATE    39930096
                   ,DSCVR_MERCH_NMBR   = : TSTR000-DSCVR-MERCH-NMBR     39940096
                   ,BNKCD_MERCH_NMBR   = : TSTR000-BNKCD-MERCH-NMBR     39950096
                   ,SUBSCRIPT_NMBR     = : TSTR000-SUBSCRIPT-NMBR       39960096
                   ,AMLOAD_INDCT       = : TSTR000-AMLOAD-INDCT         39970096
                   ,CK_AUTH_GRP_NMBR   = : TSTR000-CK-AUTH-GRP-NMBR     39980096
                   ,PLU_SYSTEM_CODE    = : TSTR000-PLU-SYSTEM-CODE      39990096
                   ,FIN_CLS_DTE        = : TSTR000-FIN-CLS-DTE          40000096
                   ,CASH_RET_AUTH_NBR  = : TSTR000-CASH-RET-AUTH-NBR    40010096
                   ,YR_SLS_INCL_DTE    = : TSTR000-YR-SLS-INCL-DTE      40020096
                   ,MO_SLS_INCL_DTE    = : TSTR000-MO-SLS-INCL-DTE      40030096
                   ,REPL_STORE_NBR     = : TSTR000-REPL-STORE-NBR       40040096
                   ,MFST_NBR           = : TSTR000-MFST-NBR             40050096
                   ,POS_CAP_LVL        = : TSTR000-POS-CAP-LVL          40060096
                   ,PERM_RLSE_AVL_NBR  = : TSTR000-PERM-RLSE-AVL-NBR    40070096
                   ,CENPPC_CRE_IND     = : TSTR000-CENPPC-CRE-IND       40080096
                   ,RF_BEG_IP_ADR      = : TSTR000-RF-BEG-IP-ADR        40090096
                   ,RF_END_IP_ADR      = : TSTR000-RF-END-IP-ADR        40100096
                   ,STR_NBR            = : TSTR000-STR-NBR              40110096
                   ,MET_NBR            = : TSTR000-MET-NBR              40120096
                   ,LAST_CHG_DTE       = : TSTR000-LAST-CHG-DTE         40130096
                   ,QTR_SLS_INCL_DTE   = : TSTR000-QTR-SLS-INCL-DTE     40140096
                   ,SEA_SLS_INCL_DTE   = : TSTR000-SEA-SLS-INCL-DTE     40150096
                   ,STR_CMPR_DTE_CDE   = : TSTR000-STR-CMPR-DTE-CDE     40160096
                   ,AMEX_MERCH_NBR     = : TSTR000-AMEX-MERCH-NBR       40170096
                   ,SGN_PRT_LOC_ID     = : TSTR000-SGN-PRT-LOC-ID       40180096
                   ,SGN_PRT_GRP_ID     = : TSTR000-SGN-PRT-GRP-ID       40190096
                   ,OCPNC_DTE          = : TSTR000-OCPNC-DTE            40200096
                   ,LBR_SFWR_LVL_ID    = : TSTR000-LBR-SFWR-LVL-ID      40210096
                   ,EST_HH_INCM_AMT    = : TSTR000-EST-HH-INCM-AMT      40220096
                   ,MEDN_AGE_NBR       = : TSTR000-MEDN-AGE-NBR         40230096
                   ,CNTY_ID            = : TSTR000-CNTY-ID              40240096
                   ,LCLTY_ID           = : TSTR000-LCLTY-ID             40250096
                   ,STD_TM_ZN_CDE      = : TSTR000-STD-TM-ZN-CDE        40260096
                   ,DST_CDE            = : TSTR000-DST-CDE              40270096
                   ,E_BUS_LOC_IND      = : TSTR000-E-BUS-LOC-IND        40280096
                    WHERE ((OP_CO_NMBR = : PC-KOHLS-OP-CO)              40290096
                      AND  (STORE_NMBR = : PV-KEY-NBR-2-4))             40300096
                 END-EXEC                                               40310096
      *                                                                 40320096
               EVALUATE TRUE                                            40330096
                   WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              40340096
                   WHEN SQLCODE = PC-DEADLOCK                           40350096
                   WHEN SQLCODE = ZERO                                  40360096
                        CONTINUE                                        40370096
                   WHEN SQLWARN0 NOT = SPACE                            40380096
                   WHEN SQLCODE NOT = ZERO                              40390096
                       MOVE 'BAD SQLCODE FOR UPDATE STORE'              40400096
                                     TO  PV-MESSAGE                     40410096
                       PERFORM 9900-PROCESS-DB2-ERROR                   40420096
                       SET PS-INPUT-REC-ERROR TO TRUE                   40430096
               END-EVALUATE                                             40440096
           END-PERFORM.                                                 40450096
      *                                                                 40460096
           IF  PV-SQL-SUB > PC-MAX-RETRIES                              40470096
               MOVE 'MAX RETRIES EXCEEDED FOR UPDATE STORE'             40480096
                                     TO  PV-MESSAGE                     40490096
               PERFORM 9900-PROCESS-DB2-ERROR                           40500096
               SET PS-INPUT-REC-ERROR TO TRUE                           40510096
           END-IF.                                                      40520096
                                                                        40530096
           IF  SQLCODE = 0                                              40540096
                IF TSTR000-TYPE-CODE = PC-DEPT-STR                      40550096
                                    OR PC-DIST-CTR                      40560096
                                    OR PC-CENTRAL-STOCK                 40570096
                                    OR PC-RETURN-TO-VENDOR              40580096
                    PERFORM 7640-SELECT-FACILITY                        40590096
                    IF PS-NO-INPUT-REC-ERROR                            40600096
                        PERFORM 7660-SELECT-MANIFEST                    40610096
                    END-IF                                              40620096
               END-IF                                                   40630096
           END-IF.                                                      40640096
                                                                        40650096
      * ------------------------------------------------------------- * 40660096
      * INSERT THE STORE ROW                                            40670096
      * ------------------------------------------------------------- * 40680096
       7620-INSERT-STORE-ROW.                                           40690096
                                                                        40700096
           MOVE '7620-INSERT-STORE-ROW' TO  PV-PARAGRAPH.               40710096
                                                                        40720096
           PERFORM                                                      40730096
            WITH TEST AFTER                                             40740096
            VARYING PV-SQL-SUB                                          40750096
            FROM 1 BY 1                                                 40760096
            UNTIL PV-SQL-SUB > PC-MAX-RETRIES                           40770096
               OR SQLCODE = 0                                           40780096
               OR PS-INPUT-REC-ERROR                                    40790096
                                                                        40800096
              EXEC SQL                                                  40810096
                INSERT INTO TSTR000                                     40820096
                   (OP_CO_NMBR                                          40830096
                   , STORE_NMBR                                         40840096
                   , TYPE_CODE                                          40850096
                   , TWO_DIGIT_NMBR                                     40860096
                   , STORE_NAME                                         40870096
                   , CHAR10_ABBR_NAME                                   40880096
                   , CHAR5_ABBR_NAME                                    40890096
                   , MAIL_ADDR_ONE_DESC                                 40900096
                   , MAIL_ADDR_TWO_DESC                                 40910096
                   , CITY_NAME                                          40920096
                   , STATE_CODE                                         40930096
                   , ZIP_PLUS4_CODE                                     40940096
                   , PHONE_NMBR                                         40950096
                   , TOLLFREE_PHNE_NMBR                                 40960096
                   , OPENED_DATE                                        40970096
                   , CLOSED_DATE                                        40980096
                   , SELLING_SQFT_NMBR                                  40990096
                   , FINANCE_CORP_NMBR                                  41000096
                   , DISTRICT_NMBR                                      41010096
                   , MGR_NAME                                           41020096
                   , DC_CODE                                            41030096
                   , DC1_NMBR                                           41040096
                   , DC1_PO_START_DATE                                  41050096
                   , DC1_PO_STOP_DATE                                   41060096
                   , DC1_RCT_START_DATE                                 41070096
                   , DC1_RCT_STOP_DATE                                  41080096
                   , DC2_NMBR                                           41090096
                   , DC2_PO_START_DATE                                  41100096
                   , DC2_PO_STOP_DATE                                   41110096
                   , DC2_RCT_START_DATE                                 41120096
                   , DC2_RCT_STOP_DATE                                  41130096
                   , DSCVR_MERCH_NMBR                                   41140096
                   , BNKCD_MERCH_NMBR                                   41150096
                   , SUBSCRIPT_NMBR                                     41160096
                   , AMLOAD_INDCT                                       41170096
                   , CK_AUTH_GRP_NMBR                                   41180096
                   , PLU_SYSTEM_CODE                                    41190096
                   , FIN_CLS_DTE                                        41200096
                   , CASH_RET_AUTH_NBR                                  41210096
                   , YR_SLS_INCL_DTE                                    41220096
                   , MO_SLS_INCL_DTE                                    41230096
                   , REPL_STORE_NBR                                     41240096
                   , MFST_NBR                                           41250096
                   , POS_CAP_LVL                                        41260096
                   , PERM_RLSE_AVL_NBR                                  41270096
                   , CENPPC_CRE_IND                                     41280096
                   , RF_BEG_IP_ADR                                      41290096
                   , RF_END_IP_ADR                                      41300096
                   , STR_NBR                                            41310096
                   , MET_NBR                                            41320096
                   , LAST_CHG_DTE                                       41330096
                   , QTR_SLS_INCL_DTE                                   41340096
                   , SEA_SLS_INCL_DTE                                   41350096
                   , STR_CMPR_DTE_CDE                                   41360096
                   , AMEX_MERCH_NBR                                     41370096
                   , SGN_PRT_LOC_ID                                     41380096
                   , SGN_PRT_GRP_ID                                     41390096
                   , OCPNC_DTE                                          41400096
                   , LBR_SFWR_LVL_ID                                    41410096
                   , EST_HH_INCM_AMT                                    41420096
                   , MEDN_AGE_NBR                                       41430096
                   , CNTY_ID                                            41440096
                   , LCLTY_ID                                           41450096
                   , STD_TM_ZN_CDE                                      41460096
                   , DST_CDE                                            41470096
                   , E_BUS_LOC_IND)                                     41480096
           VALUES ( : TSTR000-OP-CO-NMBR                                41490096
                  , : TSTR000-STORE-NMBR                                41500096
                  , : TSTR000-TYPE-CODE                                 41510096
                  , : TSTR000-TWO-DIGIT-NMBR                            41520096
                  , : TSTR000-STORE-NAME                                41530096
                  , : TSTR000-CHAR10-ABBR-NAME                          41540096
                  , : TSTR000-CHAR5-ABBR-NAME                           41550096
                  , : TSTR000-MAIL-ADDR-ONE-DESC                        41560096
                  , : TSTR000-MAIL-ADDR-TWO-DESC                        41570096
                  , : TSTR000-CITY-NAME                                 41580096
                  , : TSTR000-STATE-CODE                                41590096
                  , : TSTR000-ZIP-PLUS4-CODE                            41600096
                  , : TSTR000-PHONE-NMBR                                41610096
                  , : TSTR000-TOLLFREE-PHNE-NMBR                        41620096
                  , : TSTR000-OPENED-DATE                               41630096
                  , : TSTR000-CLOSED-DATE                               41640096
                  , : TSTR000-SELLING-SQFT-NMBR                         41650096
                  , : TSTR000-FINANCE-CORP-NMBR                         41660096
                  , : TSTR000-DISTRICT-NMBR                             41670096
                  , : TSTR000-MGR-NAME                                  41680096
                  , : TSTR000-DC-CODE                                   41690096
                  , : TSTR000-DC1-NMBR                                  41700096
                  , : TSTR000-DC1-PO-START-DATE                         41710096
                  , : TSTR000-DC1-PO-STOP-DATE                          41720096
                  , : TSTR000-DC1-RCT-START-DATE                        41730096
                  , : TSTR000-DC1-RCT-STOP-DATE                         41740096
                  , : TSTR000-DC2-NMBR                                  41750096
                  , : TSTR000-DC2-PO-START-DATE                         41760096
                  , : TSTR000-DC2-PO-STOP-DATE                          41770096
                  , : TSTR000-DC2-RCT-START-DATE                        41780096
                  , : TSTR000-DC2-RCT-STOP-DATE                         41790096
                  , : TSTR000-DSCVR-MERCH-NMBR                          41800096
                  , : TSTR000-BNKCD-MERCH-NMBR                          41810096
                  , : TSTR000-SUBSCRIPT-NMBR                            41820096
                  , : TSTR000-AMLOAD-INDCT                              41830096
                  , : TSTR000-CK-AUTH-GRP-NMBR                          41840096
                  , : TSTR000-PLU-SYSTEM-CODE                           41850096
                  , : TSTR000-FIN-CLS-DTE                               41860096
                  , : TSTR000-CASH-RET-AUTH-NBR                         41870096
                  , : TSTR000-YR-SLS-INCL-DTE                           41880096
                  , : TSTR000-MO-SLS-INCL-DTE                           41890096
                  , : TSTR000-REPL-STORE-NBR                            41900096
                  , : TSTR000-MFST-NBR                                  41910096
                  , : TSTR000-POS-CAP-LVL                               41920096
                  , : TSTR000-PERM-RLSE-AVL-NBR                         41930096
                  , : TSTR000-CENPPC-CRE-IND                            41940096
                  , : TSTR000-RF-BEG-IP-ADR                             41950096
                  , : TSTR000-RF-END-IP-ADR                             41960096
                  , : TSTR000-STR-NBR                                   41970096
                  , : TSTR000-MET-NBR                                   41980096
                  , : TSTR000-LAST-CHG-DTE                              41990096
                  , : TSTR000-QTR-SLS-INCL-DTE                          42000096
                  , : TSTR000-SEA-SLS-INCL-DTE                          42010096
                  , : TSTR000-STR-CMPR-DTE-CDE                          42020096
                  , : TSTR000-AMEX-MERCH-NBR                            42030096
                  , : TSTR000-SGN-PRT-LOC-ID                            42040096
                  , : TSTR000-SGN-PRT-GRP-ID                            42050096
                  , : TSTR000-OCPNC-DTE                                 42060096
                  , : TSTR000-LBR-SFWR-LVL-ID                           42070096
                  , : TSTR000-EST-HH-INCM-AMT                           42080096
                  , : TSTR000-MEDN-AGE-NBR                              42090096
                  , : TSTR000-CNTY-ID                                   42100096
                  , : TSTR000-LCLTY-ID                                  42110096
                  , : TSTR000-STD-TM-ZN-CDE                             42120096
                  , : TSTR000-DST-CDE                                   42130096
                  , : TSTR000-E-BUS-LOC-IND)                            42140096
              END-EXEC                                                  42150096
      *                                                                 42160096
               EVALUATE TRUE                                            42170096
                   WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              42180096
                   WHEN SQLCODE = PC-DEADLOCK                           42190096
                   WHEN SQLCODE = ZERO                                  42200096
                        CONTINUE                                        42210096
                   WHEN SQLWARN0 NOT = SPACE                            42220096
                   WHEN SQLCODE NOT = ZERO                              42230096
                       MOVE 'BAD SQLCODE FOR INSERT STORE'              42240096
                                     TO  PV-MESSAGE                     42250096
                       PERFORM 9900-PROCESS-DB2-ERROR                   42260096
                       SET PS-INPUT-REC-ERROR TO TRUE                   42270096
               END-EVALUATE                                             42280096
           END-PERFORM.                                                 42290096
      *                                                                 42300096
           IF  PV-SQL-SUB > PC-MAX-RETRIES                              42310096
               MOVE 'MAX RETRIES EXCEEDED FOR INSERT STORE'             42320096
                                     TO  PV-MESSAGE                     42330096
               PERFORM 9900-PROCESS-DB2-ERROR                           42340096
               SET PS-INPUT-REC-ERROR TO TRUE                           42350096
           END-IF.                                                      42360096
                                                                        42370096
           IF  SQLCODE = 0                                              42380096
                IF TSTR000-TYPE-CODE = PC-DEPT-STR                      42390096
                                    OR PC-DIST-CTR                      42400096
                                    OR PC-CENTRAL-STOCK                 42410096
                                    OR PC-RETURN-TO-VENDOR              42420096
                    PERFORM 7640-SELECT-FACILITY                        42430096
                    PERFORM 7660-SELECT-MANIFEST                        42440096
                END-IF                                                  42450096
           END-IF.                                                      42460096
                                                                        42470096
      * ------------------------------------------------------------- * 42480096
      * DELETE THE STORE ROW                                            42490096
      * ------------------------------------------------------------- * 42500096
       7630-DELETE-STORE-ROW.                                           42510096
                                                                        42520096
           MOVE '7630-DELETE-STORE-ROW' TO  PV-PARAGRAPH.               42530096
                                                                        42540096
           PERFORM                                                      42550096
            WITH TEST AFTER                                             42560096
            VARYING PV-SQL-SUB                                          42570096
            FROM 1 BY 1                                                 42580096
            UNTIL PV-SQL-SUB > PC-MAX-RETRIES                           42590096
               OR SQLCODE = 0                                           42600096
               OR SQLCODE = PC-ROW-NOT-FOUND                            42610096
               OR PS-INPUT-REC-ERROR                                    42620096
                                                                        42630096
               EXEC SQL                                                 42640096
                   DELETE FROM TSTR000                                  42650096
                   WHERE STORE_NMBR = :PV-KEY-NBR-2-4                   42660096
               END-EXEC                                                 42670096
                                                                        42680096
               EVALUATE TRUE                                            42690096
                   WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              42700096
                   WHEN SQLCODE = PC-DEADLOCK                           42710096
                   WHEN SQLCODE = PC-ROW-NOT-FOUND                      42720096
                   WHEN SQLCODE = ZERO                                  42730096
                        CONTINUE                                        42740096
                   WHEN SQLWARN0 NOT = SPACE                            42750096
                   WHEN SQLCODE NOT = ZERO                              42760096
                       MOVE 'BAD SQLCODE FOR DELETE STORE'              42770096
                                     TO  PV-MESSAGE                     42780096
                       PERFORM 9900-PROCESS-DB2-ERROR                   42790096
                       SET PS-INPUT-REC-ERROR TO TRUE                   42800096
               END-EVALUATE                                             42810096
           END-PERFORM.                                                 42820096
      *                                                                 42830096
           IF  PV-SQL-SUB > PC-MAX-RETRIES                              42840096
               MOVE 'MAX RETRIES EXCEEDED FOR DELETE STORE'             42850096
                                     TO  PV-MESSAGE                     42860096
               PERFORM 9900-PROCESS-DB2-ERROR                           42870096
               SET PS-INPUT-REC-ERROR TO TRUE                           42880096
           END-IF.                                                      42890096
                                                                        42900096
           IF SQLCODE = 0                                               42910096
      *JAK     PERFORM 7860-DELETE-TSTRMKT-STORES                       42920099
      *JAK     PERFORM 7900-DELETE-TPMADLC-STORES                       42930099
      *JAK     PERFORM 7910-DELETE-TPMMELC-STORES                       42940099
      *JAK     PERFORM 7920-DELETE-TPMITPR-STORES                       42950099
               PERFORM 7930-DELETE-TMITGPL-STORES                       42960096
               IF PS-NO-INPUT-REC-ERROR                                 42970096
                   IF TSTR000-TYPE-CODE = PC-DEPT-STR                   42980096
                                       OR PC-DIST-CTR                   42990096
                                       OR PC-CENTRAL-STOCK              43000096
                                       OR PC-RETURN-TO-VENDOR           43010096
                       PERFORM 7646-DELETE-TFACLTY-STORES               43020096
                       PERFORM 7664-DELETE-MANIFEST                     43030096
                   END-IF                                               43040096
               END-IF                                                   43050096
           END-IF.                                                      43060096
                                                                        43070096
      *                                                                 43080096
      ******************************************************************43090096
      *    CHECK TO SEE IF A FACILITY RECORD ALREADY EXISTS BEFORE      43100096
      *    TRYING TO INSERT A FACILITY RECORD FOR A CONSTRUCTION TYPE   43110096
      *    CODE CHANGED TO DEPARTMENT STORE, DISTRIBUTION CENTER,       43120096
      *    CENTRAL STOCK, OR RETURN TO VENDOR.                          43130096
      *                                                                 43140096
      ******************************************************************43150096
      *                                                                 43160096
       7640-SELECT-FACILITY.                                            43170096
           MOVE '7640-SELECT-FACILITY' TO  PV-PARAGRAPH.                43180096
                                                                        43190096
           PERFORM                                                      43200096
            WITH TEST AFTER                                             43210096
            VARYING PV-SQL-SUB                                          43220096
            FROM 1 BY 1                                                 43230096
            UNTIL PV-SQL-SUB > PC-MAX-RETRIES                           43240096
               OR SQLCODE = 0                                           43250096
               OR SQLCODE = PC-ROW-NOT-FOUND                            43260096
               OR PS-INPUT-REC-ERROR                                    43270096
      *                                                                 43280096
                 EXEC SQL                                               43290096
                     SELECT                                             43300096
                            OPER_UNT_ID,                                43310096
                            FCLTY_ID,                                   43320096
                            FCLTY_NME,                                  43330096
                            OPER_UNT_NAME,                              43340096
                            FCLTY_SHT_NME                               43350096
                       INTO                                             43360096
                           :FACLTY-OPER-UNT-ID,                         43370096
                           :FACLTY-FCLTY-ID,                            43380096
                           :FACLTY-FCLTY-NME,                           43390096
                           :FACLTY-OPER-UNT-NAME,                       43400096
                           :FACLTY-FCLTY-SHT-NME                        43410096
                       FROM TFACLTY                                     43420096
                      WHERE OPER_UNT_ID = :TSTR000-STR-NBR              43430096
                        AND FCLTY_ID    = 1                             43440096
                 END-EXEC                                               43450096
      *                                                                 43460096
               EVALUATE TRUE                                            43470096
                   WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              43480096
                   WHEN SQLCODE = PC-DEADLOCK                           43490096
                        CONTINUE                                        43500096
                   WHEN SQLCODE = PC-ROW-NOT-FOUND                      43510096
                        PERFORM 7642-INSERT-FACILITY                    43520096
                   WHEN SQLCODE = ZERO                                  43530096
                        PERFORM 7644-UPDATE-FACILITY                    43540096
                   WHEN SQLWARN0 NOT = SPACE                            43550096
                   WHEN SQLCODE NOT = ZERO                              43560096
                       MOVE 'BAD SQLCODE FOR SELECT TFACLTY'            43570096
                                     TO  PV-MESSAGE                     43580096
                       PERFORM 9900-PROCESS-DB2-ERROR                   43590096
                       SET PS-INPUT-REC-ERROR TO TRUE                   43600096
               END-EVALUATE                                             43610096
           END-PERFORM.                                                 43620096
      *                                                                 43630096
           IF PV-SQL-SUB > PC-MAX-RETRIES                               43640096
               MOVE 'MAX RETRIES EXCEEDED FOR SELECT TFACLTY'           43650096
                                     TO  PV-MESSAGE                     43660096
               PERFORM 9900-PROCESS-DB2-ERROR                           43670096
               SET PS-INPUT-REC-ERROR TO TRUE                           43680096
           END-IF.                                                      43690096
                                                                        43700096
      *    IF SQLCODE = 0                                               43710096
      *        PERFORM 7644-UPDATE-FACILITY                             43720096
      *    END-IF.                                                      43730096
      *                                                                 43740096
       EJECT                                                            43750096
      ******************************************************************43760096
      *    INSERT A FACILITY RECORD FOR A CONSTRUCTION TYPE CODE        43770096
      *    CHANGED TO DEPARTMENT STORE, DISTRIBUTION CENTER, CENTRAL    43780096
      *    STOCK, OR RETURN TO VENDOR.                                  43790096
      *                                                                 43800096
      ******************************************************************43810096
      *                                                                 43820096
       7642-INSERT-FACILITY.                                            43830096
                                                                        43840096
           MOVE '7642-INSERT-FACILITY' TO  PV-PARAGRAPH.                43850096
                                                                        43860096
           INITIALIZE DCLTFACLTY.                                       43870096
           MOVE SPACES                  TO PV-FCLTY-SHT-NAME.           43880096
           IF TSTR000-TYPE-CODE =  PC-DIST-CTR OR                       43890096
              PC-CENTRAL-STOCK OR                                       43900096
              PC-RETURN-TO-VENDOR                                       43910096
               MOVE TSTR000-TYPE-CODE       TO PV-FCLTY-SHT-NAME-3-4    43920096
               MOVE TSTR000-CHAR5-ABBR-NAME TO PV-CHAR5                 43930096
               MOVE PV-CHAR5-4-5            TO PV-FCLTY-SHT-NAME-1-2    43940096
               MOVE PV-FCLTY-SHT-NAME       TO FACLTY-FCLTY-SHT-NME     43950096
           END-IF.                                                      43960096
                                                                        43970096
           PERFORM                                                      43980096
               WITH TEST AFTER                                          43990096
               VARYING PV-SQL-SUB                                       44000096
               FROM 1 BY 1                                              44010096
               UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        44020096
                  OR SQLCODE = 0                                        44030096
                  OR PS-INPUT-REC-ERROR                                 44040096
      *                                                                 44050096
                 EXEC SQL                                               44060096
                     INSERT                                             44070096
                         INTO TFACLTY                                   44080096
                           (OPER_UNT_ID,                                44090096
                            FCLTY_ID,                                   44100096
                            FCLTY_NME,                                  44110096
                            OPER_UNT_NAME,                              44120096
                            FCLTY_SHT_NME)                              44130096
                         VALUES (:TSTR000-STR-NBR                       44140096
                               , :PV-FCLTY-ID                           44150096
                               , :TSTR000-STORE-NAME                    44160096
                               , :FACLTY-OPER-UNT-NAME                  44170096
                               , :FACLTY-FCLTY-SHT-NME)                 44180096
                 END-EXEC                                               44190096
      *                                                                 44200096
               EVALUATE TRUE                                            44210096
                   WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              44220096
                   WHEN SQLCODE = PC-DEADLOCK                           44230096
                   WHEN SQLCODE = ZERO                                  44240096
                        CONTINUE                                        44250096
                   WHEN SQLWARN0 NOT = SPACE                            44260096
                   WHEN SQLCODE NOT = ZERO                              44270096
                       MOVE 'BAD SQLCODE FOR INSERT TFACLTY'            44280096
                                     TO  PV-MESSAGE                     44290096
                       PERFORM 9900-PROCESS-DB2-ERROR                   44300096
                       SET PS-INPUT-REC-ERROR TO TRUE                   44310096
               END-EVALUATE                                             44320096
           END-PERFORM.                                                 44330096
      *                                                                 44340096
           IF  PV-SQL-SUB > PC-MAX-RETRIES                              44350096
               MOVE 'MAX RETRIES EXCEEDED FOR INSERT TFACLTY'           44360096
                                     TO  PV-MESSAGE                     44370096
               PERFORM 9900-PROCESS-DB2-ERROR                           44380096
               SET PS-INPUT-REC-ERROR TO TRUE                           44390096
           END-IF.                                                      44400096
      *                                                                 44410096
      ******************************************************************44420096
      *    UPDATE A FACILITY RECORD FOR A CONSTRUCTION TYPE CODE        44430096
      *    CHANGED TO DEPARTMENT STORE, DISTRIBUTION CENTER, CENTRAL    44440096
      *    STOCK, OR RETURN TO VENDOR.                                  44450096
      *                                                                 44460096
      ******************************************************************44470096
      *                                                                 44480096
       7644-UPDATE-FACILITY.                                            44490096
      *                                                                 44500096
           MOVE '7644-UPDATE-FACILITY' TO  PV-PARAGRAPH.                44510096
                                                                        44520096
           MOVE SPACES                  TO PV-FCLTY-SHT-NAME.           44530096
           IF TSTR000-TYPE-CODE =  PC-DIST-CTR OR                       44540096
                                   PC-CENTRAL-STOCK OR                  44550096
                                   PC-RETURN-TO-VENDOR                  44560096
               MOVE TSTR000-STORE-NAME      TO FACLTY-OPER-UNT-NAME     44570096
               MOVE TSTR000-TYPE-CODE       TO PV-FCLTY-SHT-NAME-3-4    44580096
               MOVE TSTR000-CHAR5-ABBR-NAME TO PV-CHAR5                 44590096
               MOVE PV-CHAR5-4-5            TO PV-FCLTY-SHT-NAME-1-2    44600096
               MOVE PV-FCLTY-SHT-NAME       TO FACLTY-FCLTY-SHT-NME     44610096
           END-IF.                                                      44620096
                                                                        44630096
           PERFORM                                                      44640096
               WITH TEST AFTER                                          44650096
               VARYING PV-SQL-SUB                                       44660096
               FROM 1 BY 1                                              44670096
               UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        44680096
                  OR SQLCODE = 0                                        44690096
                  OR SQLCODE = PC-ROW-NOT-FOUND                         44700096
                  OR PS-INPUT-REC-ERROR                                 44710096
      *                                                                 44720096
                 EXEC SQL                                               44730096
                     UPDATE TFACLTY                                     44740096
                        SET                                             44750096
                            FCLTY_NME     = :TSTR000-STORE-NAME,        44760096
                            OPER_UNT_NAME = :FACLTY-OPER-UNT-NAME,      44770096
                            FCLTY_SHT_NME = :FACLTY-FCLTY-SHT-NME       44780096
                      WHERE OPER_UNT_ID   = :TSTR000-STR-NBR            44790096
                 END-EXEC                                               44800096
      *                                                                 44810096
               EVALUATE TRUE                                            44820096
                   WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              44830096
                   WHEN SQLCODE = PC-DEADLOCK                           44840096
                   WHEN SQLCODE = PC-ROW-NOT-FOUND                      44850096
                   WHEN SQLCODE = ZERO                                  44860096
                        CONTINUE                                        44870096
                   WHEN SQLWARN0 NOT = SPACE                            44880096
                   WHEN SQLCODE NOT = ZERO                              44890096
                       MOVE 'BAD SQLCODE FOR UPDATE TFACLTY'            44900096
                                     TO  PV-MESSAGE                     44910096
                       PERFORM 9900-PROCESS-DB2-ERROR                   44920096
                       SET PS-INPUT-REC-ERROR TO TRUE                   44930096
               END-EVALUATE                                             44940096
           END-PERFORM.                                                 44950096
      *                                                                 44960096
           IF  PV-SQL-SUB > PC-MAX-RETRIES                              44970096
               MOVE 'MAX RETRIES EXCEEDED FOR UPDATE TFACLTY'           44980096
                                     TO  PV-MESSAGE                     44990096
               PERFORM 9900-PROCESS-DB2-ERROR                           45000096
               SET PS-INPUT-REC-ERROR TO TRUE                           45010096
           END-IF.                                                      45020096
      ******************************************************************45030096
      *    DELETE ANY REFERENCES TO THIS STORE IN FACILITY TABLE        45040096
      *    - TFACLTY                                                    45050096
      *                                                                 45060096
      ******************************************************************45070096
       7646-DELETE-TFACLTY-STORES.                                      45080096
                                                                        45090096
           MOVE '7646-DELETE-TFACLTY-STORES' TO PV-PARAGRAPH.           45100096
                                                                        45110096
           MOVE PV-KEY-NBR-2-4 TO FACLTY-OPER-UNT-ID.                   45120096
                                                                        45130096
           PERFORM                                                      45140096
               WITH TEST AFTER                                          45150096
               VARYING PV-SQL-SUB                                       45160096
               FROM 1 BY 1                                              45170096
               UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        45180096
                  OR SQLCODE = PC-ROW-NOT-FOUND                         45190096
                  OR PS-INPUT-REC-ERROR                                 45200096
                                                                        45210096
               EXEC SQL                                                 45220096
                   DELETE FROM TFACLTY                                  45230096
                   WHERE OPER_UNT_ID = :FACLTY-OPER-UNT-ID              45240096
               END-EXEC                                                 45250096
                                                                        45260096
               EVALUATE TRUE                                            45270096
                   WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              45280096
                   WHEN SQLCODE = PC-DEADLOCK                           45290096
                   WHEN SQLCODE = PC-ROW-NOT-FOUND                      45300096
                   WHEN SQLCODE = ZERO                                  45310096
                        CONTINUE                                        45320096
                   WHEN SQLWARN0 NOT = SPACE                            45330096
                   WHEN SQLCODE NOT = ZERO                              45340096
                       MOVE 'BAD SQLCODE FOR DELETE TFACLTY'            45350096
                                     TO  PV-MESSAGE                     45360096
                       PERFORM 9900-PROCESS-DB2-ERROR                   45370096
                       SET PS-INPUT-REC-ERROR TO TRUE                   45380096
               END-EVALUATE                                             45390096
           END-PERFORM.                                                 45400096
                                                                        45410096
           IF  PV-SQL-SUB > PC-MAX-RETRIES                              45420096
               MOVE 'MAX RETRIES EXCEEDED FOR DELETE TFACLTY'           45430096
                                     TO  PV-MESSAGE                     45440096
               PERFORM 9900-PROCESS-DB2-ERROR                           45450096
               SET PS-INPUT-REC-ERROR TO TRUE                           45460096
           END-IF.                                                      45470096
      *                                                                 45480096
      ******************************************************************45490096
      *    CHECK TO SEE IF A STR MANIFEST RECORD ALREADY EXISTS BEFORE  45500096
      *    TRYING TO INSERT A STR MANIFEST RCD FOR A CONSTRUCTION TYPE  45510096
      *    CODE CHANGED TO DEPARTMENT STORE, DISTRIBUTION CENTER,       45520096
      *    CENTRAL STOCK, OR RETURN TO VENDOR.                          45530096
      *                                                                 45540096
      ******************************************************************45550096
       7660-SELECT-MANIFEST.                                            45560096
                                                                        45570096
           MOVE '7660-SELECT-MANIFEST' TO PV-PARAGRAPH.                 45580096
                                                                        45590096
           PERFORM                                                      45600096
               WITH TEST AFTER                                          45610096
               VARYING PV-SQL-SUB                                       45620096
               FROM 1 BY 1                                              45630096
               UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        45640096
                  OR SQLCODE = 0                                        45650096
                  OR SQLCODE = PC-ROW-NOT-FOUND                         45660096
                  OR PS-INPUT-REC-ERROR                                 45670096
      *                                                                 45680096
                 EXEC SQL                                               45690096
                     SELECT                                             45700096
                            STR_NBR                                     45710096
                       INTO                                             45720096
                           :DCSTMF-STR-NBR                              45730096
                       FROM TDCSTMF                                     45740096
                      WHERE STR_NBR = :TSTR000-STR-NBR                  45750096
                 END-EXEC                                               45760096
                                                                        45770096
               EVALUATE TRUE                                            45780096
                   WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              45790096
                   WHEN SQLCODE = PC-DEADLOCK                           45800096
                   WHEN SQLCODE = ZERO                                  45810096
                        CONTINUE                                        45820096
                   WHEN SQLCODE = PC-ROW-NOT-FOUND                      45830096
                        PERFORM 7662-INSERT-MANIFEST                    45840096
                   WHEN SQLWARN0 NOT = SPACE                            45850096
                   WHEN SQLCODE NOT = ZERO                              45860096
                       MOVE 'BAD SQLCODE FOR SELECT TDCSTMF'            45870096
                                     TO  PV-MESSAGE                     45880096
                       PERFORM 9900-PROCESS-DB2-ERROR                   45890096
                       SET PS-INPUT-REC-ERROR TO TRUE                   45900096
               END-EVALUATE                                             45910096
           END-PERFORM.                                                 45920096
      *                                                                 45930096
           IF  PV-SQL-SUB > PC-MAX-RETRIES                              45940096
               MOVE 'MAX RETRIES EXCEEDED FOR SELECT TDCSTMF'           45950096
                                     TO  PV-MESSAGE                     45960096
               PERFORM 9900-PROCESS-DB2-ERROR                           45970096
               SET PS-INPUT-REC-ERROR TO TRUE                           45980096
           END-IF.                                                      45990096
      *                                                                 46000096
      ******************************************************************46010096
      *                                                                 46020096
       7662-INSERT-MANIFEST.                                            46030096
                                                                        46040096
           MOVE '7662-INSERT-MANIFEST' TO PV-PARAGRAPH.                 46050096
                                                                        46060096
           INITIALIZE DCLTDCSTMF.                                       46070096
                                                                        46080096
           PERFORM                                                      46090096
               WITH TEST AFTER                                          46100096
               VARYING PV-SQL-SUB                                       46110096
               FROM 1 BY 1                                              46120096
               UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        46130096
                  OR SQLCODE = 0                                        46140096
                  OR PS-INPUT-REC-ERROR                                 46150096
      *                                                                 46160096
                 EXEC SQL                                               46170096
                     INSERT                                             46180096
                         INTO TDCSTMF                                   46190096
                           (STR_NBR,                                    46200096
                            MFST_NBR)                                   46210096
                         VALUES (:TSTR000-STR-NBR,                      46220096
                                  1)                                    46230096
                 END-EXEC                                               46240096
      *                                                                 46250096
               EVALUATE TRUE                                            46260096
                   WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              46270096
                   WHEN SQLCODE = PC-DEADLOCK                           46280096
                   WHEN SQLCODE = ZERO                                  46290096
                        CONTINUE                                        46300096
                   WHEN SQLWARN0 NOT = SPACE                            46310096
                   WHEN SQLCODE NOT = ZERO                              46320096
                       MOVE 'BAD SQLCODE FOR INSERT TDCSTMF'            46330096
                                     TO  PV-MESSAGE                     46340096
                       PERFORM 9900-PROCESS-DB2-ERROR                   46350096
                       SET PS-INPUT-REC-ERROR TO TRUE                   46360096
               END-EVALUATE                                             46370096
           END-PERFORM.                                                 46380096
      *                                                                 46390096
           IF  PV-SQL-SUB > PC-MAX-RETRIES                              46400096
               MOVE 'MAX RETRIES EXCEEDED FOR INSERT TDCSTMF'           46410096
                                     TO  PV-MESSAGE                     46420096
               PERFORM 9900-PROCESS-DB2-ERROR                           46430096
               SET PS-INPUT-REC-ERROR TO TRUE                           46440096
           END-IF.                                                      46450096
      *                                                                 46460096
      ******************************************************************46470096
      *    DELETE ANY REFERENCES TO THIS STORE IN STORE MANIFEST TABLE  46480096
      *    - TDCSTMF                                                    46490096
      *                                                                 46500096
      ******************************************************************46510096
       7664-DELETE-MANIFEST.                                            46520096
                                                                        46530096
           MOVE '7664-DELETE-MANIFEST' TO PV-PARAGRAPH.                 46540096
                                                                        46550096
           MOVE PV-KEY-NBR-2-4 TO DCSTMF-STR-NBR.                       46560096
           PERFORM                                                      46570096
               WITH TEST AFTER                                          46580096
               VARYING PV-SQL-SUB                                       46590096
               FROM 1 BY 1                                              46600096
               UNTIL PV-SQL-SUB GREATER THAN PC-MAX-RETRIES             46610096
                  OR SQLCODE = +100                                     46620096
                  OR PS-INPUT-REC-ERROR                                 46630096
                                                                        46640096
               EXEC SQL                                                 46650096
                   DELETE FROM TDCSTMF                                  46660096
                   WHERE STR_NBR = :DCSTMF-STR-NBR                      46670096
               END-EXEC                                                 46680096
                                                                        46690096
               EVALUATE TRUE                                            46700096
                   WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              46710096
                   WHEN SQLCODE = PC-DEADLOCK                           46720096
                   WHEN SQLCODE = PC-ROW-NOT-FOUND                      46730096
                   WHEN SQLCODE = ZERO                                  46740096
                        CONTINUE                                        46750096
                   WHEN SQLWARN0 NOT = SPACE                            46760096
                   WHEN SQLCODE NOT = ZERO                              46770096
                       MOVE 'BAD SQLCODE FOR DELETE TDCSTMF'            46780096
                                     TO  PV-MESSAGE                     46790096
                       PERFORM 9900-PROCESS-DB2-ERROR                   46800096
                       SET PS-INPUT-REC-ERROR TO TRUE                   46810096
               END-EVALUATE                                             46820096
           END-PERFORM.                                                 46830096
                                                                        46840096
           IF  PV-SQL-SUB > PC-MAX-RETRIES                              46850096
               MOVE 'MAX RETRIES EXCEEDED FOR DELETE MAINFEST'          46860096
                                     TO  PV-MESSAGE                     46870096
               PERFORM 9900-PROCESS-DB2-ERROR                           46880096
               SET PS-INPUT-REC-ERROR TO TRUE                           46890096
           END-IF.                                                      46900096
      *----------------------------------------------------------------*46910096
      *   RETRIEVE THE METRO ROW                                       *46920096
      *----------------------------------------------------------------*46930096
      *7700-SELECT-METRO-ROW.                                           46940099
      *JAK MOVE '7700-SELECT-METRO-ROW' TO  PV-PARAGRAPH.               46950099
      *JAK PERFORM                                                      46960099
      *JAK     WITH TEST AFTER                                          46970099
      *JAK     VARYING PV-SQL-SUB                                       46980099
      *JAK     FROM 1 BY 1                                              46990099
      *JAK     UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        47000099
      *JAK        OR SQLCODE = 0                                        47010099
      *JAK        OR SQLCODE = PC-ROW-NOT-FOUND                         47020099
      *JAK        OR PS-INPUT-REC-ERROR                                 47030099
      *                                                                 47040096
      *JAK        EXEC SQL                                              47050099
      *JAK            SELECT  MET_NBR                                   47060099
      *JAK                   ,CTY_NM                                    47070099
      *JAK                   ,ST_CDE                                    47080099
      *JAK                   ,RPT_SEQ_NBR                               47090099
      *JAK                   ,CLMT_ID                                   47100099
      *JAK                   ,RPT_FLSH_SLS_IND                          47110099
      *JAK              INTO :METARA-MET-NBR                            47120099
      *JAK                 , :METARA-CTY-NM                             47130099
      *JAK                 , :METARA-ST-CDE                             47140099
      *JAK                 , :METARA-RPT-SEQ-NBR                        47150099
      *JAK                 , :METARA-CLMT-ID                            47160099
      *JAK                 , :METARA-RPT-FLSH-SLS-IND                   47170099
      *JAK              FROM TMETARA                                    47180099
      *JAK            WHERE MET_NBR  = :PV-KEY-NBR-NUM                  47190099
      *JAK        END-EXEC                                              47200099
      *                                                                 47210096
      *JAK     EVALUATE TRUE                                            47220099
      *JAK         WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              47230099
      *JAK         WHEN SQLCODE = PC-DEADLOCK                           47240099
      *JAK         WHEN SQLCODE = ZERO                                  47250099
      *JAK              CONTINUE                                        47260099
      *JAK         WHEN SQLWARN0 NOT = SPACE                            47270099
      *JAK         WHEN SQLCODE NOT = ZERO                              47280099
      *JAK             MOVE 'BAD SQLCODE FOR SELECT TMETARA'            47290099
      *JAK                           TO  PV-MESSAGE                     47300099
      *JAK             PERFORM 9900-PROCESS-DB2-ERROR                   47310099
      *JAK             SET PS-INPUT-REC-ERROR TO TRUE                   47320099
      *JAK     END-EVALUATE                                             47330099
      *JAK END-PERFORM.                                                 47340099
      *                                                                 47350096
      *JAK IF  PV-SQL-SUB > PC-MAX-RETRIES                              47360099
      *JAK     MOVE 'MAX RETRIES EXCEEDED FOR SELECT TMETARA'           47370099
      *JAK                           TO  PV-MESSAGE                     47380099
      *JAK     PERFORM 9900-PROCESS-DB2-ERROR                           47390099
      *JAK     SET PS-INPUT-REC-ERROR TO TRUE                           47400099
      *JAK END-IF.                                                      47410099
      *----------------------------------------------------------------*47420096
      *   UPDATE THE METRO ROW                                         *47430096
      *----------------------------------------------------------------*47440096
      *7710-UPDATE-METRO-ROW.                                           47450099
      *JAK MOVE '7710-UPDATE-METRO-ROW' TO  PV-PARAGRAPH.               47460099
      *                                                                 47470099
      *JAK PERFORM                                                      47480099
      *JAK     WITH TEST AFTER                                          47490099
      *JAK     VARYING PV-SQL-SUB                                       47500099
      *JAK     FROM 1 BY 1                                              47510099
      *JAK     UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        47520099
      *JAK        OR SQLCODE = 0                                        47530099
      *JAK        OR SQLCODE = PC-ROW-NOT-FOUND                         47540099
      *JAK        OR PS-INPUT-REC-ERROR                                 47550099
      *                                                                 47560096
      *JAK       EXEC SQL                                               47570099
      *JAK           UPDATE TMETARA                                     47580099
      *JAK              SET                                             47590099
      *JAK                MET_NBR          = :METARA-MET-NBR            47600099
      *JAK               ,CTY_NM           = :METARA-CTY-NM             47610099
      *JAK               ,ST_CDE           = :METARA-ST-CDE             47620099
      *JAK               ,RPT_SEQ_NBR      = :METARA-RPT-SEQ-NBR        47630099
      *JAK               ,CLMT_ID          = :METARA-CLMT-ID            47640099
      *JAK               ,RPT_FLSH_SLS_IND = :METARA-RPT-FLSH-SLS-IND   47650099
      *JAK            WHERE MET_NBR  = :PV-KEY-NBR-NUM                  47660099
      *JAK       END-EXEC                                               47670099
      *                                                                 47680096
      *JAK     EVALUATE TRUE                                            47690099
      *JAK         WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              47700099
      *JAK         WHEN SQLCODE = PC-DEADLOCK                           47710099
      *JAK         WHEN SQLCODE = PC-ROW-NOT-FOUND                      47720099
      *JAK         WHEN SQLCODE = ZERO                                  47730099
      *JAK              CONTINUE                                        47740099
      *JAK         WHEN SQLWARN0 NOT = SPACE                            47750099
      *JAK         WHEN SQLCODE NOT = ZERO                              47760099
      *JAK             MOVE 'BAD SQLCODE FOR UPDATE TMETARA'            47770099
      *JAK                           TO  PV-MESSAGE                     47780099
      *JAK             PERFORM 9900-PROCESS-DB2-ERROR                   47790099
      *JAK             SET PS-INPUT-REC-ERROR TO TRUE                   47800099
      *JAK     END-EVALUATE                                             47810099
      *JAK END-PERFORM.                                                 47820099
      *                                                                 47830096
      *JAK IF  PV-SQL-SUB > PC-MAX-RETRIES                              47840099
      *JAK     MOVE 'MAX RETRIES EXCEEDED FOR UPDATE TMETARA'           47850099
      *JAK                           TO  PV-MESSAGE                     47860099
      *JAK     PERFORM 9900-PROCESS-DB2-ERROR                           47870099
      *JAK     SET PS-INPUT-REC-ERROR TO TRUE                           47880099
      *JAK END-IF.                                                      47890099
      *----------------------------------------------------------------*47900096
      *   INSERT THE METRO ROW                                         *47910096
      *----------------------------------------------------------------*47920096
      *7720-INSERT-METRO-ROW.                                           47930099
      *JAK MOVE '7720-INSERT-METRO-ROW' TO  PV-PARAGRAPH.               47940099
      *                                                                 47950099
      *JAK PERFORM                                                      47960099
      *JAK     WITH TEST AFTER                                          47970099
      *JAK     VARYING PV-SQL-SUB                                       47980099
      *JAK     FROM 1 BY 1                                              47990099
      *JAK     UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        48000099
      *JAK        OR SQLCODE = 0                                        48010099
      *JAK        OR PS-INPUT-REC-ERROR                                 48020099
      *                                                                 48030096
      *JAK       EXEC SQL                                               48040099
      *JAK           INSERT INTO TMETARA                                48050099
      *JAK                  ( MET_NBR                                   48060099
      *JAK                   ,CTY_NM                                    48070099
      *JAK                   ,ST_CDE                                    48080099
      *JAK                   ,RPT_SEQ_NBR                               48090099
      *JAK                   ,CLMT_ID                                   48100099
      *JAK                   ,RPT_FLSH_SLS_IND)                         48110099
      *JAK           VALUES (:METARA-MET-NBR                            48120099
      *JAK                 , :METARA-CTY-NM                             48130099
      *JAK                 , :METARA-ST-CDE                             48140099
      *JAK                 , :METARA-RPT-SEQ-NBR                        48150099
      *JAK                 , :METARA-CLMT-ID                            48160099
      *JAK                 , :METARA-RPT-FLSH-SLS-IND)                  48170099
      *JAK       END-EXEC                                               48180099
      *                                                                 48190096
      *JAK     EVALUATE TRUE                                            48200099
      *JAK         WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              48210099
      *JAK         WHEN SQLCODE = PC-DEADLOCK                           48220099
      *JAK         WHEN SQLCODE = PC-ROW-NOT-FOUND                      48230099
      *JAK         WHEN SQLCODE = ZERO                                  48240099
      *JAK              CONTINUE                                        48250099
      *JAK         WHEN SQLWARN0 NOT = SPACE                            48260099
      *JAK         WHEN SQLCODE NOT = ZERO                              48270099
      *JAK             MOVE 'BAD SQLCODE FOR INSERT TMETARA'            48280099
      *JAK                           TO  PV-MESSAGE                     48290099
      *JAK             PERFORM 9900-PROCESS-DB2-ERROR                   48300099
      *JAK             SET PS-INPUT-REC-ERROR TO TRUE                   48310099
      *JAK     END-EVALUATE                                             48320099
      *JAK END-PERFORM.                                                 48330099
      *                                                                 48340096
      *JAK IF  PV-SQL-SUB > PC-MAX-RETRIES                              48350099
      *JAK     MOVE 'MAX RETRIES EXCEEDED FOR INSERT TMETARA'           48360099
      *JAK                           TO  PV-MESSAGE                     48370099
      *JAK     PERFORM 9900-PROCESS-DB2-ERROR                           48380099
      *JAK     SET PS-INPUT-REC-ERROR TO TRUE                           48390099
      *JAK END-IF.                                                      48400099
      *                                                                 48410096
      *----------------------------------------------------------------*48420096
      *   DELETE THE METRO ROW                                         *48430096
      *----------------------------------------------------------------*48440096
      *7730-DELETE-METRO-ROW.                                           48450099
      *                                                                 48460099
      *JAK MOVE '7730-DELETE-METRO-ROW' TO  PV-PARAGRAPH.               48470099
      *                                                                 48480099
      *JAK PERFORM                                                      48490099
      *JAK  WITH TEST AFTER                                             48500099
      *JAK  VARYING PV-SQL-SUB                                          48510099
      *JAK  FROM 1 BY 1                                                 48520099
      *JAK  UNTIL PV-SQL-SUB > PC-MAX-RETRIES                           48530099
      *JAK     OR SQLCODE = 0                                           48540099
      *JAK     OR SQLCODE = PC-ROW-NOT-FOUND                            48550099
      *JAK     OR PS-INPUT-REC-ERROR                                    48560099
      *                                                                 48570099
      *JAK     EXEC SQL                                                 48580099
      *JAK         DELETE FROM TMETARA                                  48590099
      *JAK         WHERE MET_NBR = :PV-KEY-NBR-NUM                      48600099
      *JAK     END-EXEC                                                 48610099
      *                                                                 48620099
      *JAK     EVALUATE TRUE                                            48630099
      *JAK         WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              48640099
      *JAK         WHEN SQLCODE = PC-DEADLOCK                           48650099
      *JAK         WHEN SQLCODE = PC-ROW-NOT-FOUND                      48660099
      *JAK         WHEN SQLCODE = ZERO                                  48670099
      *JAK              CONTINUE                                        48680099
      *JAK         WHEN SQLWARN0 NOT = SPACE                            48690099
      *JAK         WHEN SQLCODE NOT = ZERO                              48700099
      *JAK             MOVE 'BAD SQLCODE FOR DELETE TMETARA'            48710099
      *JAK                           TO  PV-MESSAGE                     48720099
      *JAK             PERFORM 9900-PROCESS-DB2-ERROR                   48730099
      *JAK             SET PS-INPUT-REC-ERROR TO TRUE                   48740099
      *JAK     END-EVALUATE                                             48750099
      *JAK END-PERFORM.                                                 48760099
      *                                                                 48770096
      *JAK IF  PV-SQL-SUB > PC-MAX-RETRIES                              48780099
      *JAK     MOVE 'MAX RETRIES EXCEEDED FOR DELETE TMETARA'           48790099
      *JAK                           TO  PV-MESSAGE                     48800099
      *JAK     PERFORM 9900-PROCESS-DB2-ERROR                           48810099
      *JAK     SET PS-INPUT-REC-ERROR TO TRUE                           48820099
      *JAK END-IF.                                                      48830099
                                                                        48840096
                                                                        48850096
      *----------------------------------------------------------------*48860096
      *   INSERT THE CLIMATE ROW                                        48870096
      *----------------------------------------------------------------*48880096
      *7740-INSERT-CLIMAT-ROW.                                          48890099
      *JAK MOVE '7740-INSERT-CLIMAT-ROW' TO  PV-PARAGRAPH.              48900099
      *                                                                 48910099
      *JAK PERFORM                                                      48920099
      *JAK     WITH TEST AFTER                                          48930099
      *JAK     VARYING PV-SQL-SUB                                       48940099
      *JAK     FROM 1 BY 1                                              48950099
      *JAK     UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        48960099
      *JAK        OR SQLCODE = 0                                        48970099
      *JAK        OR PS-INPUT-REC-ERROR                                 48980099
      *                                                                 48990099
      *JAK       EXEC SQL                                               49000099
      *JAK           INSERT INTO TCLIMAT                                49010099
      *JAK                  ( CLMT_ID                                   49020099
      *JAK                   ,CLMT_DESC)                                49030099
      *JAK           VALUES (:CLIMAT-CLMT-ID                            49040099
      *JAK                  ,:CLIMAT-CLMT-DESC)                         49050099
      *JAK       END-EXEC                                               49060099
      *                                                                 49070099
      *JAK     EVALUATE TRUE                                            49080099
      *JAK         WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              49090099
      *JAK         WHEN SQLCODE = PC-DEADLOCK                           49100099
      *JAK         WHEN SQLCODE = ZERO                                  49110099
      *JAK              CONTINUE                                        49120099
      *JAK         WHEN SQLWARN0 NOT = SPACE                            49130099
      *JAK         WHEN SQLCODE  NOT = ZERO                             49140099
      *JAK             MOVE 'BAD SQLCODE FOR INSERT TCLIMAT'            49150099
      *JAK                           TO  PV-MESSAGE                     49160099
      *JAK             PERFORM 9900-PROCESS-DB2-ERROR                   49170099
      *JAK             SET PS-INPUT-REC-ERROR TO TRUE                   49180099
      *JAK     END-EVALUATE                                             49190099
      *JAK END-PERFORM.                                                 49200099
      *                                                                 49210099
      *JAK IF  PV-SQL-SUB > PC-MAX-RETRIES                              49220099
      *JAK     MOVE 'MAX RETRIES EXCEEDED FOR INSERT TCLIMAT'           49230099
      *JAK                           TO  PV-MESSAGE                     49240099
      *JAK     PERFORM 9900-PROCESS-DB2-ERROR                           49250099
      *JAK     SET PS-INPUT-REC-ERROR TO TRUE                           49260099
      *JAK END-IF.                                                      49270099
                                                                        49280096
                                                                        49290096
      *----------------------------------------------------------------*49300096
      *   UPDATE THE CLIMATE ROW.                                      *49310096
      *----------------------------------------------------------------*49320096
      *7750-UPDATE-CLIMAT-ROW.                                          49330099
      *                                                                 49340099
      *JAK MOVE '7750-UPDATE-CLIMAT-ROW' TO  PV-PARAGRAPH.              49350099
      *                                                                 49360099
      *JAK PERFORM                                                      49370099
      *JAK     WITH TEST AFTER                                          49380099
      *JAK     VARYING PV-SQL-SUB                                       49390099
      *JAK     FROM 1 BY 1                                              49400099
      *JAK     UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        49410099
      *JAK        OR SQLCODE = 0                                        49420099
      *JAK        OR PS-INPUT-REC-ERROR                                 49430099
      *                                                                 49440099
      *JAK       EXEC SQL                                               49450099
      *JAK           UPDATE TCLIMAT                                     49460099
      *JAK              SET CLMT_DESC  = :CLIMAT-CLMT-DESC              49470099
      *JAK            WHERE CLMT_ID    = :CLIMAT-CLMT-ID                49480099
      *JAK       END-EXEC                                               49490099
      *                                                                 49500099
      *JAK     EVALUATE TRUE                                            49510099
      *JAK         WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              49520099
      *JAK         WHEN SQLCODE = PC-DEADLOCK                           49530099
      *JAK         WHEN SQLCODE = ZERO                                  49540099
      *JAK              CONTINUE                                        49550099
      *JAK         WHEN SQLWARN0 NOT = SPACE                            49560099
      *JAK         WHEN SQLCODE NOT = ZERO                              49570099
      *JAK             MOVE 'BAD SQLCODE FOR UPDATE TCLIMAT'            49580099
      *JAK                           TO  PV-MESSAGE                     49590099
      *JAK             PERFORM 9900-PROCESS-DB2-ERROR                   49600099
      *JAK             SET PS-INPUT-REC-ERROR TO TRUE                   49610099
      *JAK     END-EVALUATE                                             49620099
      *JAK END-PERFORM.                                                 49630099
      *                                                                 49640099
      *JAK IF  PV-SQL-SUB > PC-MAX-RETRIES                              49650099
      *JAK     MOVE 'MAX RETRIES EXCEEDED FOR UPDATE TCLIMAT'           49660099
      *JAK                           TO  PV-MESSAGE                     49670099
      *JAK     PERFORM 9900-PROCESS-DB2-ERROR                           49680099
      *JAK     SET PS-INPUT-REC-ERROR TO TRUE                           49690099
      *JAK END-IF.                                                      49700099
                                                                        49710096
                                                                        49720096
      *----------------------------------------------------------------*49730096
      *   SEE IF THE CLIMATE IS ASSIGNED TO ANY METRO AREAS.            49740096
      *----------------------------------------------------------------*49750096
      *7760-COUNT-METROS-IN-CLIMAT.                                     49760099
      *                                                                 49770099
      *JAK MOVE '7760-COUNT-METROS-IN-CLIMAT' TO PV-PARAGRAPH.          49780099
      *                                                                 49790099
      *JAK PERFORM                                                      49800099
      *JAK     WITH TEST AFTER                                          49810099
      *JAK     VARYING PV-SQL-SUB                                       49820099
      *JAK     FROM 1 BY 1                                              49830099
      *JAK     UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        49840099
      *JAK        OR SQLCODE = 0                                        49850099
      *JAK        OR PS-INPUT-REC-ERROR                                 49860099
      *                                                                 49870099
      *JAK        EXEC SQL                                              49880099
      *JAK            SELECT  COUNT(*)                                  49890099
      *JAK              INTO :PV-NBR-OF-METROS                          49900099
      *JAK              FROM TMETARA                                    49910099
      *JAK            WHERE CLMT_ID  = :CLIMAT-CLMT-ID                  49920099
      *JAK        END-EXEC                                              49930099
      *                                                                 49940099
      *JAK     EVALUATE TRUE                                            49950099
      *JAK         WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              49960099
      *JAK         WHEN SQLCODE = PC-DEADLOCK                           49970099
      *JAK         WHEN SQLCODE = ZERO                                  49980099
      *JAK              CONTINUE                                        49990099
      *JAK         WHEN SQLWARN0 NOT = SPACE                            50000099
      *JAK         WHEN SQLCODE  NOT = ZERO                             50010099
      *JAK             MOVE 'BAD SQLCODE FOR SELECT TCLIMAT'            50020099
      *JAK                           TO  PV-MESSAGE                     50030099
      *JAK             PERFORM 9900-PROCESS-DB2-ERROR                   50040099
      *JAK             SET PS-INPUT-REC-ERROR TO TRUE                   50050099
      *JAK     END-EVALUATE                                             50060099
      *JAK END-PERFORM.                                                 50070099
      *                                                                 50080099
      *JAK IF  PV-SQL-SUB > PC-MAX-RETRIES                              50090099
      *JAK     MOVE 'MAX RETRIES EXCEEDED FOR SELECT TCLIMAT'           50100099
      *JAK                           TO  PV-MESSAGE                     50110099
      *JAK     PERFORM 9900-PROCESS-DB2-ERROR                           50120099
      *JAK     SET PS-INPUT-REC-ERROR TO TRUE                           50130099
      *JAK END-IF.                                                      50140099
                                                                        50150099
                                                                        50160099
      *----------------------------------------------------------------*50170099
      *   UPDATE THE ADMRKT ROW DESCRIPTION                           * 50180099
      *----------------------------------------------------------------*50190099
      *7770-UPDATE-ADMRKT-DESC.                                         50200099
                                                                        50210099
      *JAK MOVE '7770-UPDATE-ADMRKT-DESC' TO  PV-PARAGRAPH.             50220099
                                                                        50230099
      *JAK PERFORM                                                      50240099
      *JAK     WITH TEST AFTER                                          50250099
      *JAK     VARYING PV-SQL-SUB                                       50260099
      *JAK     FROM 1 BY 1                                              50270099
      *JAK     UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        50280099
      *JAK        OR SQLCODE = 0                                        50290099
      *JAK        OR PS-INPUT-REC-ERROR                                 50300099
                                                                        50310099
      *JAK       EXEC SQL                                               50320099
      *JAK           UPDATE TADMRKT                                     50330099
      *JAK              SET ADMRKT_DESC = :ADMRKT-ADMRKT-DESC           50340099
      *JAK            WHERE OPERCO_NBR  = :PC-KOHLS-OP-CO               50350099
      *JAK              AND ADMRKT_ID   = :ADMRKT-ADMRKT-ID             50360099
      *JAK       END-EXEC                                               50370099
                                                                        50380099
      *JAK     EVALUATE TRUE                                            50390099
      *JAK         WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              50400099
      *JAK         WHEN SQLCODE = PC-DEADLOCK                           50410099
      *JAK         WHEN SQLCODE = ZERO                                  50420099
      *JAK              CONTINUE                                        50430099
      *JAK         WHEN SQLWARN0 NOT = SPACE                            50440099
      *JAK         WHEN SQLCODE NOT = ZERO                              50450099
      *JAK             MOVE 'BAD SQLCODE FOR UPDATE TADMRKT'            50460099
      *JAK                           TO  PV-MESSAGE                     50470099
      *JAK             PERFORM 9900-PROCESS-DB2-ERROR                   50480099
      *JAK             SET PS-INPUT-REC-ERROR TO TRUE                   50490099
      *JAK     END-EVALUATE                                             50500099
      *JAK END-PERFORM.                                                 50510099
                                                                        50520099
      *JAK IF  PV-SQL-SUB > PC-MAX-RETRIES                              50530099
      *JAK     MOVE 'MAX RETRIES EXCEEDED FOR UPDATE TADMRKT'           50540099
      *JAK                           TO  PV-MESSAGE                     50550099
      *JAK     PERFORM 9900-PROCESS-DB2-ERROR                           50560099
      *JAK     SET PS-INPUT-REC-ERROR TO TRUE                           50570099
      *JAK END-IF.                                                      50580099
                                                                        50590096
                                                                        50600096
      *----------------------------------------------------------------*50610096
      *   DELETE THE CLIMATE ROW.                                       50620096
      *----------------------------------------------------------------*50630096
      *7780-DELETE-CLIMAT-ROW.                                          50640099
      *                                                                 50650099
      *JAK MOVE '7780-DELETE-CLIMAT-ROW' TO  PV-PARAGRAPH.              50660099
      *                                                                 50670099
      *JAK PERFORM                                                      50680099
      *JAK  WITH TEST AFTER                                             50690099
      *JAK  VARYING PV-SQL-SUB                                          50700099
      *JAK  FROM 1 BY 1                                                 50710099
      *JAK  UNTIL PV-SQL-SUB > PC-MAX-RETRIES                           50720099
      *JAK     OR SQLCODE = 0                                           50730099
      *JAK     OR SQLCODE = PC-ROW-NOT-FOUND                            50740099
      *JAK     OR PS-INPUT-REC-ERROR                                    50750099
      *                                                                 50760099
      *JAK     EXEC SQL                                                 50770099
      *JAK         DELETE FROM TCLIMAT                                  50780099
      *JAK         WHERE CLMT_ID = :CLIMAT-CLMT-ID                      50790099
      *JAK     END-EXEC                                                 50800099
      *                                                                 50810099
      *JAK     EVALUATE TRUE                                            50820099
      *JAK         WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              50830099
      *JAK         WHEN SQLCODE = PC-DEADLOCK                           50840099
      *JAK         WHEN SQLCODE = PC-ROW-NOT-FOUND                      50850099
      *JAK         WHEN SQLCODE = ZERO                                  50860099
      *JAK              CONTINUE                                        50870099
      *JAK         WHEN SQLWARN0 NOT = SPACE                            50880099
      *JAK         WHEN SQLCODE  NOT = ZERO                             50890099
      *JAK             MOVE 'BAD SQLCODE FOR DELETE TCLIMAT'            50900099
      *JAK                           TO  PV-MESSAGE                     50910099
      *JAK             PERFORM 9900-PROCESS-DB2-ERROR                   50920099
      *JAK             SET PS-INPUT-REC-ERROR TO TRUE                   50930099
      *JAK     END-EVALUATE                                             50940099
      *JAK END-PERFORM.                                                 50950099
      *                                                                 50960099
      *JAK IF  PV-SQL-SUB > PC-MAX-RETRIES                              50970099
      *JAK     MOVE 'MAX RETRIES EXCEEDED FOR DELETE TCLIMAT'           50980099
      *JAK                           TO  PV-MESSAGE                     50990099
      *JAK     PERFORM 9900-PROCESS-DB2-ERROR                           51000099
      *JAK     SET PS-INPUT-REC-ERROR TO TRUE                           51010099
      *JAK END-IF.                                                      51020099
                                                                        51030096
                                                                        51040096
      *----------------------------------------------------------------*51050096
      *    GET STORE/MARKET RELATIONSHIP FOR ORIGINAL OPEN DATE        *51060096
      *----------------------------------------------------------------*51070096
      *7840-GET-STR-MKT-BY-OPEN-DT.                                     51080099
                                                                        51090096
      *JAK MOVE '7840-GET-STR-MKT-BY-OPEN-DT' TO PV-PARAGRAPH.          51100099
                                                                        51110096
      *JAK PERFORM                                                      51120099
      *JAK     WITH TEST AFTER                                          51130099
      *JAK     VARYING PV-SQL-SUB                                       51140099
      *JAK     FROM 1 BY 1                                              51150099
      *JAK     UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        51160099
      *JAK        OR SQLCODE = ZERO                                     51170099
      *JAK        OR SQLCODE = PC-ROW-NOT-FOUND                         51180099
      *JAK        OR PS-INPUT-REC-ERROR                                 51190099
                                                                        51200096
      *JAK         EXEC SQL                                             51210099
      *JAK             SELECT S.OPERCO_NBR                              51220099
      *JAK                  , S.STR_NBR                                 51230099
      *JAK                  , S.ADMRKT_ID                               51240099
      *JAK                  , S.BEG_DTE                                 51250099
      *JAK                  , S.END_DTE                                 51260099
      *JAK             INTO :STRMKT-OPERCO-NBR                          51270099
      *JAK                , :STRMKT-STR-NBR                             51280099
      *JAK                , :STRMKT-ADMRKT-ID                           51290099
      *JAK                , :STRMKT-BEG-DTE                             51300099
      *JAK                , :STRMKT-END-DTE                             51310099
      *JAK             FROM TSTRMKT S                                   51320099
      *JAK                , TADMRKT A                                   51330099
      *JAK             WHERE S.OPERCO_NBR = :PC-KOHLS-OP-CO             51340099
      *JAK               AND S.OPERCO_NBR = A.OPERCO_NBR                51350099
      *JAK               AND S.ADMRKT_ID  = A.ADMRKT_ID                 51360099
      *JAK               AND A.TYPE_CODE  = :PC-ADMRKT-MARKET           51370099
      *JAK               AND S.STR_NBR    = :PV-KEY-NBR-2-4             51380099
      *JAK               AND A.END_DTE   >= :HO100-CRE-TMST             51390099
      *JAK               AND S.BEG_DTE   <= :PV-STR-OPEN-DT-ISO         51400099
      *JAK               AND S.END_DTE   >= :PV-STR-OPEN-DT-ISO         51410099
      *JAK       END-EXEC                                               51420099
                                                                        51430096
      *JAK     EVALUATE TRUE                                            51440099
      *JAK         WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              51450099
      *JAK         WHEN SQLCODE = PC-DEADLOCK                           51460099
      *JAK         WHEN SQLCODE = PC-ROW-NOT-FOUND                      51470099
      *JAK              CONTINUE                                        51480099
      *JAK         WHEN SQLCODE = ZERO                                  51490099
      *JAK              MOVE STRMKT-BEG-DTE TO PV-STR-MKT-BEG-DTE-ISO   51500099
      *JAK         WHEN SQLWARN0 NOT = SPACE                            51510099
      *JAK         WHEN SQLCODE  NOT = ZERO                             51520099
      *JAK              MOVE 'BAD SQLCODE FOR SELECT TSTRMKT'           51530099
      *JAK                           TO  PV-MESSAGE                     51540099
      *JAK              PERFORM 9900-PROCESS-DB2-ERROR                  51550099
      *JAK              SET PS-INPUT-REC-ERROR TO TRUE                  51560099
      *JAK     END-EVALUATE                                             51570099
      *JAK END-PERFORM.                                                 51580099
                                                                        51590096
      *JAK IF  PV-SQL-SUB > PC-MAX-RETRIES                              51600099
      *JAK     MOVE 'MAX RETRIES EXCEEDED FOR SELECT TSTRMKT'           51610099
      *JAK                           TO  PV-MESSAGE                     51620099
      *JAK     PERFORM 9900-PROCESS-DB2-ERROR                           51630099
      *JAK     SET PS-INPUT-REC-ERROR TO TRUE                           51640099
      *JAK END-IF.                                                      51650099
                                                                        51660096
                                                                        51670096
      *----------------------------------------------------------------*51680096
      *    GET STORE/MARKET RELATIONSHIP FOR ORIGINAL END DATE         *51690096
      *----------------------------------------------------------------*51700096
      *7841-GET-STR-MKT-BY-END-DT.                                      51710099
                                                                        51720096
      *JAK MOVE '7841-GET-STR-MKT-BY-END-DT' TO PV-PARAGRAPH.           51730099
                                                                        51740096
      *JAK PERFORM                                                      51750099
      *JAK     WITH TEST AFTER                                          51760099
      *JAK     VARYING PV-SQL-SUB                                       51770099
      *JAK     FROM 1 BY 1                                              51780099
      *JAK     UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        51790099
      *JAK        OR SQLCODE = ZERO                                     51800099
      *JAK        OR SQLCODE = PC-ROW-NOT-FOUND                         51810099
      *JAK        OR PS-INPUT-REC-ERROR                                 51820099
                                                                        51830096
      *JAK         EXEC SQL                                             51840099
      *JAK             SELECT S.OPERCO_NBR                              51850099
      *JAK                , S.STR_NBR                                   51860099
      *JAK                , S.ADMRKT_ID                                 51870099
      *JAK                , S.BEG_DTE                                   51880099
      *JAK                , S.END_DTE                                   51890099
      *JAK             INTO :STRMKT-OPERCO-NBR                          51900099
      *JAK                , :STRMKT-STR-NBR                             51910099
      *JAK                , :STRMKT-ADMRKT-ID                           51920099
      *JAK                , :STRMKT-BEG-DTE                             51930099
      *JAK                , :STRMKT-END-DTE                             51940099
      *JAK             FROM TSTRMKT S                                   51950099
      *JAK                , TADMRKT A                                   51960099
      *JAK             WHERE S.OPERCO_NBR = :PC-KOHLS-OP-CO             51970099
      *JAK               AND S.OPERCO_NBR = A.OPERCO_NBR                51980099
      *JAK               AND S.ADMRKT_ID  = A.ADMRKT_ID                 51990099
      *JAK               AND A.TYPE_CODE  = :PC-ADMRKT-MARKET           52000099
      *JAK               AND S.STR_NBR    = :PV-KEY-NBR-2-4             52010099
      *JAK               AND A.END_DTE   >= :HO100-CRE-TMST             52020099
      *JAK               AND S.END_DTE    = :PV-STR-CLOSE-DT-ISO        52030099
      *JAK       END-EXEC                                               52040099
                                                                        52050096
      *JAK     EVALUATE TRUE                                            52060099
      *JAK         WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              52070099
      *JAK         WHEN SQLCODE = PC-DEADLOCK                           52080099
      *JAK         WHEN SQLCODE = PC-ROW-NOT-FOUND                      52090099
      *JAK              CONTINUE                                        52100099
      *JAK         WHEN SQLCODE = ZERO                                  52110099
      *JAK              MOVE STRMKT-BEG-DTE TO PV-STR-MKT-BEG-DTE-ISO   52120099
      *JAK         WHEN SQLWARN0 NOT = SPACE                            52130099
      *JAK         WHEN SQLCODE  NOT = ZERO                             52140099
      *JAK              MOVE 'BAD SQLCODE FOR SELECT TSTRMKT'           52150099
      *JAK                           TO  PV-MESSAGE                     52160099
      *JAK              PERFORM 9900-PROCESS-DB2-ERROR                  52170099
      *JAK              SET PS-INPUT-REC-ERROR TO TRUE                  52180099
      *JAK     END-EVALUATE                                             52190099
      *JAK END-PERFORM.                                                 52200099
                                                                        52210096
      *JAK IF  PV-SQL-SUB > PC-MAX-RETRIES                              52220099
      *JAK     MOVE 'MAX RETRIES EXCEEDED FOR SELECT TSTRMKT'           52230099
      *JAK                           TO  PV-MESSAGE                     52240099
      *JAK     PERFORM 9900-PROCESS-DB2-ERROR                           52250099
      *JAK     SET PS-INPUT-REC-ERROR TO TRUE                           52260099
      *JAK END-IF.                                                      52270099
                                                                        52280096
                                                                        52290096
      *----------------------------------------------------------------*52300096
      *    DELETE STR/MKT RELATIONSHIP RETRIEVED IN                    *52310096
      *    7840-GET-STR-MKT-BY-OPEN-DT                                 *52320096
      *----------------------------------------------------------------*52330096
      *7842-DELETE-STRMKT-BEG-DTE.                                      52340099
                                                                        52350096
      *JAK MOVE '7842-DELETE-STRMKT-BEG-DTE' TO PV-PARAGRAPH.           52360099
                                                                        52370096
      *JAK PERFORM                                                      52380099
      *JAK     WITH TEST AFTER                                          52390099
      *JAK     VARYING PV-SQL-SUB                                       52400099
      *JAK     FROM 1 BY 1                                              52410099
      *JAK     UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        52420099
      *JAK        OR SQLCODE = ZERO                                     52430099
      *JAK        OR SQLCODE = PC-ROW-NOT-FOUND                         52440099
      *JAK        OR PS-INPUT-REC-ERROR                                 52450099
                                                                        52460096
      *JAK     EXEC SQL                                                 52470099
      *JAK         DELETE FROM TSTRMKT                                  52480099
      *JAK         WHERE OPERCO_NBR = :STRMKT-OPERCO-NBR                52490099
      *JAK           AND STR_NBR    = :STRMKT-STR-NBR                   52500099
      *JAK           AND ADMRKT_ID  = :STRMKT-ADMRKT-ID                 52510099
      *JAK           AND BEG_DTE    = :PV-STR-MKT-BEG-DTE-ISO           52520099
      *JAK     END-EXEC                                                 52530099
                                                                        52540096
      *JAK     EVALUATE TRUE                                            52550099
      *JAK         WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              52560099
      *JAK         WHEN SQLCODE = PC-DEADLOCK                           52570099
      *JAK         WHEN SQLCODE = PC-ROW-NOT-FOUND                      52580099
      *JAK         WHEN SQLCODE = ZERO                                  52590099
      *JAK              CONTINUE                                        52600099
      *JAK         WHEN SQLWARN0 NOT = SPACE                            52610099
      *JAK         WHEN SQLCODE  NOT = ZERO                             52620099
      *JAK              MOVE 'BAD SQLCODE FOR DELETE TSTRMKT'           52630099
      *JAK                           TO  PV-MESSAGE                     52640099
      *JAK              PERFORM 9900-PROCESS-DB2-ERROR                  52650099
      *JAK              SET PS-INPUT-REC-ERROR TO TRUE                  52660099
      *JAK     END-EVALUATE                                             52670099
      *JAK END-PERFORM.                                                 52680099
                                                                        52690096
      *JAK IF  PV-SQL-SUB > PC-MAX-RETRIES                              52700099
      *JAK     MOVE 'MAX RETRIES EXCEEDED FOR DELETE TSTRMKT'           52710099
      *JAK                           TO  PV-MESSAGE                     52720099
      *JAK     PERFORM 9900-PROCESS-DB2-ERROR                           52730099
      *JAK     SET PS-INPUT-REC-ERROR TO TRUE                           52740099
      *JAK END-IF.                                                      52750099
                                                                        52760096
                                                                        52770096
      *----------------------------------------------------------------*52780096
      *    DELETE STR/MKT RELATIONSHIP RETRIEVED IN                    *52790096
      *    7840-GET-STR-MKT-BY-OPEN-DT                                 *52800096
      *----------------------------------------------------------------*52810096
      *7843-DEL-ADDL-STRMKT.                                            52820099
                                                                        52830096
      *JAK MOVE '7843-DEL-ADDL-STRMKT' TO PV-PARAGRAPH.                 52840099
                                                                        52850096
      *JAK PERFORM                                                      52860099
      *JAK     WITH TEST AFTER                                          52870099
      *JAK     VARYING PV-SQL-SUB                                       52880099
      *JAK     FROM 1 BY 1                                              52890099
      *JAK     UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        52900099
      *JAK        OR SQLCODE = ZERO                                     52910099
      *JAK        OR SQLCODE = PC-ROW-NOT-FOUND                         52920099
      *JAK        OR PS-INPUT-REC-ERROR                                 52930099
                                                                        52940096
      *JAK     EXEC SQL                                                 52950099
      *JAK         DELETE FROM TSTRMKT                                  52960099
      *JAK         WHERE OPERCO_NBR = :STRMKT-OPERCO-NBR                52970099
      *JAK           AND STR_NBR    = :STRMKT-STR-NBR                   52980099
      *JAK           AND BEG_DTE   >= :HO100-CRE-TMST                   52990099
      *JAK           AND END_DTE   <= :PV-STR-OPEN-DT-ISO               53000099
      *JAK     END-EXEC                                                 53010099
                                                                        53020096
      *JAK     EVALUATE TRUE                                            53030099
      *JAK         WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              53040099
      *JAK         WHEN SQLCODE = PC-DEADLOCK                           53050099
      *JAK         WHEN SQLCODE = PC-ROW-NOT-FOUND                      53060099
      *JAK         WHEN SQLCODE = ZERO                                  53070099
      *JAK              CONTINUE                                        53080099
      *JAK         WHEN SQLWARN0 NOT = SPACE                            53090099
      *JAK         WHEN SQLCODE  NOT = ZERO                             53100099
      *JAK              MOVE 'BAD SQLCODE FOR DELETE TSTRMKT'           53110099
      *JAK                           TO  PV-MESSAGE                     53120099
      *JAK              PERFORM 9900-PROCESS-DB2-ERROR                  53130099
      *JAK              SET PS-INPUT-REC-ERROR TO TRUE                  53140099
      *JAK     END-EVALUATE                                             53150099
      *JAK END-PERFORM.                                                 53160099
                                                                        53170096
      *JAK IF  PV-SQL-SUB > PC-MAX-RETRIES                              53180099
      *JAK     MOVE 'MAX RETRIES EXCEEDED FOR DELETE TSTRMKT'           53190099
      *JAK                           TO  PV-MESSAGE                     53200099
      *JAK     PERFORM 9900-PROCESS-DB2-ERROR                           53210099
      *JAK     SET PS-INPUT-REC-ERROR TO TRUE                           53220099
      *JAK END-IF.                                                      53230099
                                                                        53240096
                                                                        53250096
      *----------------------------------------------------------------*53260096
      *    ADD NEW STORE/MARKET RELATIONSHIP OPEN DATE                 *53270096
      *----------------------------------------------------------------*53280096
      *7844-ADD-STRMKT-BEG-DTE.                                         53290099
                                                                        53300096
      *JAK MOVE '7844-ADD-STRMKT-BEG-DTE' TO PV-PARAGRAPH.              53310099
                                                                        53320096
      *JAK PERFORM                                                      53330099
      *JAK     WITH TEST AFTER                                          53340099
      *JAK     VARYING PV-SQL-SUB                                       53350099
      *JAK     FROM 1 BY 1                                              53360099
      *JAK     UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        53370099
      *JAK        OR SQLCODE = ZERO                                     53380099
      *JAK        OR PS-INPUT-REC-ERROR                                 53390099
                                                                        53400096
      *JAK         EXEC SQL                                             53410099
      *JAK             INSERT INTO TSTRMKT                              53420099
      *JAK                (OPERCO_NBR,                                  53430099
      *JAK                 STR_NBR,                                     53440099
      *JAK                 ADMRKT_ID,                                   53450099
      *JAK                 BEG_DTE,                                     53460099
      *JAK                 END_DTE)                                     53470099
      *JAK             VALUES                                           53480099
      *JAK                (:STRMKT-OPERCO-NBR,                          53490099
      *JAK                 :STRMKT-STR-NBR,                             53500099
      *JAK                 :STRMKT-ADMRKT-ID,                           53510099
      *JAK                 :STRMKT-BEG-DTE,                             53520099
      *JAK                 :STRMKT-END-DTE)                             53530099
      *JAK         END-EXEC                                             53540099
                                                                        53550096
      *JAK     EVALUATE TRUE                                            53560099
      *JAK         WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              53570099
      *JAK         WHEN SQLCODE = PC-DEADLOCK                           53580099
      *JAK         WHEN SQLCODE = ZERO                                  53590099
      *JAK              CONTINUE                                        53600099
      *JAK         WHEN SQLWARN0 NOT = SPACE                            53610099
      *JAK         WHEN SQLCODE  NOT = ZERO                             53620099
      *JAK              MOVE 'BAD SQLCODE FOR INSERT TSTRMKT'           53630099
      *JAK                           TO  PV-MESSAGE                     53640099
      *JAK              PERFORM 9900-PROCESS-DB2-ERROR                  53650099
      *JAK              SET PS-INPUT-REC-ERROR TO TRUE                  53660099
      *JAK     END-EVALUATE                                             53670099
      *JAK END-PERFORM.                                                 53680099
                                                                        53690096
      *JAK IF  PV-SQL-SUB > PC-MAX-RETRIES                              53700099
      *JAK     MOVE 'MAX RETRIES EXCEEDED FOR INSERT TSTRMKT'           53710099
      *JAK                           TO  PV-MESSAGE                     53720099
      *JAK     PERFORM 9900-PROCESS-DB2-ERROR                           53730099
      *JAK     SET PS-INPUT-REC-ERROR TO TRUE                           53740099
      *JAK END-IF.                                                      53750099
                                                                        53760096
                                                                        53770096
      *----------------------------------------------------------------*53780096
      *    UPDATE STORE/MARKET RELATIONSHIP FOR ORIGINAL OPEN DATE     *53790096
      *----------------------------------------------------------------*53800096
      *7846-UPD-BEG-END-DTE.                                            53810099
                                                                        53820096
      *JAK MOVE '7846-UPD-BEG-END-DTE' TO PV-PARAGRAPH.                 53830099
                                                                        53840096
      *JAK PERFORM                                                      53850099
      *JAK     WITH TEST AFTER                                          53860099
      *JAK     VARYING PV-SQL-SUB                                       53870099
      *JAK     FROM 1 BY 1                                              53880099
      *JAK     UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        53890099
      *JAK        OR SQLCODE = ZERO                                     53900099
      *JAK        OR SQLCODE = PC-ROW-NOT-FOUND                         53910099
      *JAK        OR PS-INPUT-REC-ERROR                                 53920099
                                                                        53930096
      *JAK         EXEC SQL                                             53940099
      *JAK             UPDATE TSTRMKT                                   53950099
      *JAK             SET END_DTE = :STRMKT-END-DTE                    53960099
      *JAK             WHERE OPERCO_NBR = :PC-KOHLS-OP-CO               53970099
      *JAK               AND ADMRKT_ID  = :STRMKT-ADMRKT-ID             53980099
      *JAK               AND STR_NBR    = :STRMKT-STR-NBR               53990099
      *JAK               AND END_DTE   >= :HO100-CRE-TMST               54000099
      *JAK               AND BEG_DTE   <= :STRMKT-BEG-DTE               54010099
      *JAK       END-EXEC                                               54020099
                                                                        54030096
      *JAK     EVALUATE TRUE                                            54040099
      *JAK         WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              54050099
      *JAK         WHEN SQLCODE = PC-DEADLOCK                           54060099
      *JAK         WHEN SQLCODE = PC-ROW-NOT-FOUND                      54070099
      *JAK         WHEN SQLCODE = ZERO                                  54080099
      *JAK              CONTINUE                                        54090099
      *JAK         WHEN SQLWARN0 NOT = SPACE                            54100099
      *JAK         WHEN SQLCODE  NOT = ZERO                             54110099
      *JAK              MOVE 'BAD SQLCODE FOR UPDATE TSTRMKT'           54120099
      *JAK                           TO  PV-MESSAGE                     54130099
      *JAK              PERFORM 9900-PROCESS-DB2-ERROR                  54140099
      *JAK              SET PS-INPUT-REC-ERROR TO TRUE                  54150099
      *JAK     END-EVALUATE                                             54160099
      *JAK END-PERFORM.                                                 54170099
                                                                        54180096
      *JAK IF  PV-SQL-SUB > PC-MAX-RETRIES                              54190099
      *JAK     MOVE 'MAX RETRIES EXCEEDED FOR UDPATE TSTRMKT'           54200099
      *JAK                           TO  PV-MESSAGE                     54210099
      *JAK     PERFORM 9900-PROCESS-DB2-ERROR                           54220099
      *JAK     SET PS-INPUT-REC-ERROR TO TRUE                           54230099
      *JAK END-IF.                                                      54240099
                                                                        54250096
                                                                        54260096
      *----------------------------------------------------------------*54270096
      *    DELETE STR/MKT RELATIONSHIP RETRIEVED IN                    *54280096
      *    7841-GET-STR-MKT-BY-END-DT                                  *54290096
      *----------------------------------------------------------------*54300096
      *7847-DELETE-STRMKT-END-DTE.                                      54310099
                                                                        54320096
      *JAK MOVE '7847-DELETE-STRMKT-END-DTE' TO PV-PARAGRAPH.           54330099
                                                                        54340096
      *JAK PERFORM                                                      54350099
      *JAK     WITH TEST AFTER                                          54360099
      *JAK     VARYING PV-SQL-SUB                                       54370099
      *JAK     FROM 1 BY 1                                              54380099
      *JAK     UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        54390099
      *JAK        OR SQLCODE = ZERO                                     54400099
      *JAK        OR SQLCODE = PC-ROW-NOT-FOUND                         54410099
      *JAK        OR PS-INPUT-REC-ERROR                                 54420099
                                                                        54430096
      *JAK     EXEC SQL                                                 54440099
      *JAK         DELETE FROM TSTRMKT                                  54450099
      *JAK         WHERE OPERCO_NBR = :STRMKT-OPERCO-NBR                54460099
      *JAK           AND STR_NBR    = :STRMKT-STR-NBR                   54470099
      *JAK           AND BEG_DTE   >= :STRMKT-END-DTE                   54480099
      *JAK     END-EXEC                                                 54490099
                                                                        54500096
      *JAK     EVALUATE TRUE                                            54510099
      *JAK         WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              54520099
      *JAK         WHEN SQLCODE = PC-DEADLOCK                           54530099
      *JAK         WHEN SQLCODE = PC-ROW-NOT-FOUND                      54540099
      *JAK         WHEN SQLCODE = ZERO                                  54550099
      *JAK              CONTINUE                                        54560099
      *JAK         WHEN SQLWARN0 NOT = SPACE                            54570099
      *JAK         WHEN SQLCODE  NOT = ZERO                             54580099
      *JAK              MOVE 'BAD SQLCODE FOR DELETE TSTRMKT'           54590099
      *JAK                           TO  PV-MESSAGE                     54600099
      *JAK              PERFORM 9900-PROCESS-DB2-ERROR                  54610099
      *JAK              SET PS-INPUT-REC-ERROR TO TRUE                  54620099
      *JAK     END-EVALUATE                                             54630099
      *JAK END-PERFORM.                                                 54640099
                                                                        54650096
      *JAK IF  PV-SQL-SUB > PC-MAX-RETRIES                              54660099
      *JAK     MOVE 'MAX RETRIES EXCEEDED FOR DELETE TSTRMKT'           54670099
      *JAK                           TO  PV-MESSAGE                     54680099
      *JAK     PERFORM 9900-PROCESS-DB2-ERROR                           54690099
      *JAK     SET PS-INPUT-REC-ERROR TO TRUE                           54700099
      *JAK END-IF.                                                      54710099
                                                                        54720096
                                                                        54730096
      *----------------------------------------------------------------*54740096
      *    UPDATE STORE/MARKET RELATIONSHIP FOR ORIGINAL END DATE      *54750096
      *----------------------------------------------------------------*54760096
      *7848-UPD-END-END-DTE.                                            54770099
                                                                        54780096
      *JAK MOVE '7848-UPD-END-END-DTE' TO PV-PARAGRAPH.                 54790099
                                                                        54800096
      *JAK PERFORM                                                      54810099
      *JAK     WITH TEST AFTER                                          54820099
      *JAK     VARYING PV-SQL-SUB                                       54830099
      *JAK     FROM 1 BY 1                                              54840099
      *JAK     UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        54850099
      *JAK        OR SQLCODE = ZERO                                     54860099
      *JAK        OR SQLCODE = PC-ROW-NOT-FOUND                         54870099
      *JAK        OR PS-INPUT-REC-ERROR                                 54880099
                                                                        54890096
      *JAK         EXEC SQL                                             54900099
      *JAK             UPDATE TSTRMKT                                   54910099
      *JAK             SET END_DTE      = :STRMKT-END-DTE               54920099
      *JAK             WHERE OPERCO_NBR = :PC-KOHLS-OP-CO               54930099
      *JAK               AND ADMRKT_ID  = :STRMKT-ADMRKT-ID             54940099
      *JAK               AND STR_NBR    = :STRMKT-STR-NBR               54950099
      *JAK               AND BEG_DTE    = :STRMKT-BEG-DTE               54960099
      *JAK       END-EXEC                                               54970099
                                                                        54980096
      *JAK     EVALUATE TRUE                                            54990099
      *JAK         WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              55000099
      *JAK         WHEN SQLCODE = PC-DEADLOCK                           55010099
      *JAK         WHEN SQLCODE = PC-ROW-NOT-FOUND                      55020099
      *JAK         WHEN SQLCODE = ZERO                                  55030099
      *JAK              CONTINUE                                        55040099
      *JAK         WHEN SQLWARN0 NOT = SPACE                            55050099
      *JAK         WHEN SQLCODE  NOT = ZERO                             55060099
      *JAK              MOVE 'BAD SQLCODE FOR UDPATE TSTRMKT'           55070099
      *JAK                           TO  PV-MESSAGE                     55080099
      *JAK              PERFORM 9900-PROCESS-DB2-ERROR                  55090099
      *JAK              SET PS-INPUT-REC-ERROR TO TRUE                  55100099
      *JAK     END-EVALUATE                                             55110099
      *JAK END-PERFORM.                                                 55120099
                                                                        55130096
      *JAK IF  PV-SQL-SUB > PC-MAX-RETRIES                              55140099
      *JAK     MOVE 'MAX RETRIES EXCEEDED FOR UPDATE TSTRMKT'           55150099
      *JAK                           TO  PV-MESSAGE                     55160099
      *JAK     PERFORM 9900-PROCESS-DB2-ERROR                           55170099
      *JAK     SET PS-INPUT-REC-ERROR TO TRUE                           55180099
      *JAK END-IF.                                                      55190099
                                                                        55200096
                                                                        55210096
      *----------------------------------------------------------------*55220096
      *    UPDATE STORE/MARKET RELATIONSHIP FOR ORIGINAL END DATE FOR  *55230096
      *    SUB-MARKET RELATIONSHIPS                                    *55240096
      *----------------------------------------------------------------*55250096
      *7849-UPD-END-END-DTE-SUB.                                        55260099
                                                                        55270096
      *JAK MOVE '7849-UPD-END-END-DTE-SUB' TO  PV-PARAGRAPH.            55280099
                                                                        55290096
      *JAK PERFORM                                                      55300099
      *JAK     WITH TEST AFTER                                          55310099
      *JAK     VARYING PV-SQL-SUB                                       55320099
      *JAK     FROM 1 BY 1                                              55330099
      *JAK     UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        55340099
      *JAK        OR SQLCODE = ZERO                                     55350099
      *JAK        OR SQLCODE = PC-ROW-NOT-FOUND                         55360099
      *JAK        OR PS-INPUT-REC-ERROR                                 55370099
                                                                        55380096
      *JAK         EXEC SQL                                             55390099
      *JAK             UPDATE TSTRMKT                                   55400099
      *JAK             SET END_DTE = :STRMKT-END-DTE                    55410099
      *JAK             WHERE OPERCO_NBR = :PC-KOHLS-OP-CO               55420099
      *JAK               AND STR_NBR    = :STRMKT-STR-NBR               55430099
      *JAK               AND END_DTE   >= :HO100-CRE-TMST               55440099
      *JAK               AND END_DTE    > :STRMKT-END-DTE               55450099
      *JAK               AND ADMRKT_ID IN                               55460099
      *JAK                 (SELECT ADMRKT_ID                            55470099
      *JAK                  FROM TADMRKT                                55480099
      *JAK                  WHERE OPERCO_NBR      = :PC-KOHLS-OP-CO     55490099
      *JAK                    AND MAJOR_ADMRKT_ID = :STRMKT-ADMRKT-ID)  55500099
      *JAK       END-EXEC                                               55510099
                                                                        55520096
      *JAK     EVALUATE TRUE                                            55530099
      *JAK         WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              55540099
      *JAK         WHEN SQLCODE = PC-DEADLOCK                           55550099
      *JAK         WHEN SQLCODE = PC-ROW-NOT-FOUND                      55560099
      *JAK         WHEN SQLCODE = ZERO                                  55570099
      *JAK              CONTINUE                                        55580099
      *JAK         WHEN SQLWARN0 NOT = SPACE                            55590099
      *JAK         WHEN SQLCODE  NOT = ZERO                             55600099
      *JAK              MOVE 'BAD SQLCODE FOR UDPATE TSTRMKT'           55610099
      *JAK                           TO  PV-MESSAGE                     55620099
      *JAK              PERFORM 9900-PROCESS-DB2-ERROR                  55630099
      *JAK              SET PS-INPUT-REC-ERROR TO TRUE                  55640099
      *JAK     END-EVALUATE                                             55650099
      *JAK END-PERFORM.                                                 55660099
                                                                        55670096
      *JAK IF  PV-SQL-SUB > PC-MAX-RETRIES                              55680099
      *JAK     MOVE 'MAX RETRIES EXCEEDED FOR UPDATE TSTRMKT'           55690099
      *JAK                           TO  PV-MESSAGE                     55700099
      *JAK     PERFORM 9900-PROCESS-DB2-ERROR                           55710099
      *JAK     SET PS-INPUT-REC-ERROR TO TRUE                           55720099
      *JAK END-IF.                                                      55730099
                                                                        55740096
                                                                        55750096
      *7851-UPDATE-SUB-TSTRMKT.                                         55760099
      *JAK MOVE PC-KOHLS-OP-CO TO STRMKT-OPERCO-NBR.                    55770099
      *JAK PERFORM 7852-APPLY-UPD-TO-SUB-TSTRMKT.                       55780099
                                                                        55790096
                                                                        55800096
      *----------------------------------------------------------------*55810096
      *  UPDATE THE ROW ON THE DB2 TABLE.                              *55820096
      *----------------------------------------------------------------*55830096
      *7852-APPLY-UPD-TO-SUB-TSTRMKT.                                   55840099
                                                                        55850096
      *JAK MOVE '7852-APPLY-UPD-TO-SUB-TSTRMKT' TO PV-PARAGRAPH.        55860099
                                                                        55870096
      *JAK PERFORM                                                      55880099
      *JAK     WITH TEST AFTER                                          55890099
      *JAK     VARYING PV-SQL-SUB                                       55900099
      *JAK     FROM 1 BY 1                                              55910099
      *JAK     UNTIL PV-SQL-SUB >  PC-MAX-RETRIES                       55920099
      *JAK        OR SQLCODE = ZERO                                     55930099
      *JAK        OR SQLCODE = PC-ROW-NOT-FOUND                         55940099
      *JAK        OR PS-INPUT-REC-ERROR                                 55950099
                                                                        55960096
      *JAK         EXEC SQL                                             55970099
      *JAK             UPDATE TSTRMKT                                   55980099
      *JAK               SET BEG_DTE = :STRMKT-BEG-DTE                  55990099
      *JAK             WHERE OPERCO_NBR = :STRMKT-OPERCO-NBR            56000099
      *JAK               AND STR_NBR    = :STRMKT-STR-NBR               56010099
      *JAK               AND BEG_DTE >= :PV-ORIG-OPENED-DATE            56020099
      *JAK               AND BEG_DTE <= :STRMKT-BEG-DTE                 56030099
      *JAK               AND END_DTE <= :STRMKT-END-DTE                 56040099
      *JAK               AND END_DTE >= :STRMKT-BEG-DTE                 56050099
      *JAK               AND ADMRKT_ID IN                               56060099
      *JAK                   (SELECT ADMRKT_ID                          56070099
      *JAK                      FROM TADMRKT                            56080099
      *JAK                     WHERE OPERCO_NBR     = :STRMKT-OPERCO-NBR56090099
      *JAK                      AND MAJOR_ADMRKT_ID = :STRMKT-ADMRKT-ID)56100099
      *JAK         END-EXEC                                             56110099
                                                                        56120096
      *JAK     EVALUATE TRUE                                            56130099
      *JAK         WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              56140099
      *JAK         WHEN SQLCODE = PC-DEADLOCK                           56150099
      *JAK         WHEN SQLCODE = PC-ROW-NOT-FOUND                      56160099
      *JAK              CONTINUE                                        56170099
      *JAK         WHEN SQLCODE = ZERO                                  56180099
      *JAK              MOVE STRMKT-BEG-DTE                             56190099
      *JAK                           TO PV-STR-MKT-BEG-DTE-ISO          56200099
      *JAK         WHEN SQLWARN0 NOT = SPACE                            56210099
      *JAK         WHEN SQLCODE  NOT = ZERO                             56220099
      *JAK              MOVE 'BAD SQLCODE FOR UDPATE TSTRMKT'           56230099
      *JAK                           TO  PV-MESSAGE                     56240099
      *JAK              PERFORM 9900-PROCESS-DB2-ERROR                  56250099
      *JAK              SET PS-INPUT-REC-ERROR TO TRUE                  56260099
      *JAK     END-EVALUATE                                             56270099
      *JAK END-PERFORM.                                                 56280099
                                                                        56290096
      *JAK IF  PV-SQL-SUB > PC-MAX-RETRIES                              56300099
      *JAK     MOVE 'MAX RETRIES EXCEEDED FOR UPDATE TSTRMKT'           56310099
      *JAK                           TO  PV-MESSAGE                     56320099
      *JAK     PERFORM 9900-PROCESS-DB2-ERROR                           56330099
      *JAK     SET PS-INPUT-REC-ERROR TO TRUE                           56340099
      *JAK END-IF.                                                      56350099
                                                                        56360096
                                                                        56370096
      *----------------------------------------------------------------*56380096
      *   DELETE ANY REFERENCES TO THIS STORE AT BOTH THE               56390096
      *   MAJOR/SUB MARKET LEVEL IN TSTRMKT.                            56400096
      *----------------------------------------------------------------*56410096
      *7860-DELETE-TSTRMKT-STORES.                                      56420099
      *JAK MOVE '7860-DELETE-TSTRMKT-STORES' TO PV-PARAGRAPH.           56430099
                                                                        56440096
      *JAK PERFORM                                                      56450099
      *JAK     WITH TEST AFTER                                          56460099
      *JAK     VARYING PV-SQL-SUB                                       56470099
      *JAK     FROM 1 BY 1                                              56480099
      *JAK     UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        56490099
      *JAK        OR SQLCODE = ZERO                                     56500099
      *JAK        OR SQLCODE = PC-ROW-NOT-FOUND                         56510099
      *JAK        OR PS-INPUT-REC-ERROR                                 56520099
                                                                        56530096
      *JAK     EXEC SQL                                                 56540099
      *JAK         DELETE FROM TSTRMKT                                  56550099
      *JAK         WHERE STR_NBR = :PV-KEY-NBR-2-4                      56560099
      *JAK     END-EXEC                                                 56570099
                                                                        56580096
      *JAK     EVALUATE TRUE                                            56590099
      *JAK         WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              56600099
      *JAK         WHEN SQLCODE = PC-DEADLOCK                           56610099
      *JAK         WHEN SQLCODE = PC-ROW-NOT-FOUND                      56620099
      *JAK         WHEN SQLCODE = ZERO                                  56630099
      *JAK             CONTINUE                                         56640099
      *JAK         WHEN SQLWARN0 NOT = SPACE                            56650099
      *JAK         WHEN SQLCODE  NOT = ZERO                             56660099
      *JAK             MOVE 'BAD SQLCODE FOR DELETE TSTRMKT'            56670099
      *JAK                           TO  PV-MESSAGE                     56680099
      *JAK             PERFORM 9900-PROCESS-DB2-ERROR                   56690099
      *JAK             SET PS-INPUT-REC-ERROR TO TRUE                   56700099
      *JAK     END-EVALUATE                                             56710099
      *JAK END-PERFORM.                                                 56720099
                                                                        56730096
      *JAK IF  PV-SQL-SUB > PC-MAX-RETRIES                              56740099
      *JAK     MOVE 'MAX RETRIES EXCEEDED FOR DELETE TSTRMKT'           56750099
      *JAK                           TO  PV-MESSAGE                     56760099
      *JAK     PERFORM 9900-PROCESS-DB2-ERROR                           56770099
      *JAK     SET PS-INPUT-REC-ERROR TO TRUE                           56780099
      *JAK END-IF.                                                      56790099
                                                                        56800096
                                                                        56810096
      *----------------------------------------------------------------*56820096
      *   DELETE THE STORE FROM TPMADLC.                                56830096
      *----------------------------------------------------------------*56840096
      *7900-DELETE-TPMADLC-STORES.                                      56850099
      *JAK MOVE '7900-DELETE-TPMADLC-STORES' TO PV-PARAGRAPH.           56860099
                                                                        56870096
      *JAK PERFORM                                                      56880099
      *JAK     WITH TEST AFTER                                          56890099
      *JAK     VARYING PV-SQL-SUB                                       56900099
      *JAK     FROM 1 BY 1                                              56910099
      *JAK     UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        56920099
      *JAK        OR SQLCODE = ZERO                                     56930099
      *JAK        OR SQLCODE = PC-ROW-NOT-FOUND                         56940099
      *JAK        OR PS-INPUT-REC-ERROR                                 56950099
                                                                        56960096
      *JAK     EXEC SQL                                                 56970099
      *JAK         DELETE FROM TPMADLC                                  56980099
      *JAK         WHERE ADLOC_ID = :PV-KEY-NBR-2-4                     56990099
      *JAK     END-EXEC                                                 57000099
                                                                        57010096
      *JAK     EVALUATE TRUE                                            57020099
      *JAK         WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              57030099
      *JAK         WHEN SQLCODE = PC-DEADLOCK                           57040099
      *JAK         WHEN SQLCODE = PC-ROW-NOT-FOUND                      57050099
      *JAK         WHEN SQLCODE = ZERO                                  57060099
      *JAK             CONTINUE                                         57070099
      *JAK         WHEN SQLWARN0 NOT = SPACE                            57080099
      *JAK         WHEN SQLCODE  NOT = ZERO                             57090099
      *JAK             MOVE 'BAD SQLCODE FOR DELETE TPMADLC'            57100099
      *JAK                           TO  PV-MESSAGE                     57110099
      *JAK             PERFORM 9900-PROCESS-DB2-ERROR                   57120099
      *JAK             SET PS-INPUT-REC-ERROR TO TRUE                   57130099
      *JAK     END-EVALUATE                                             57140099
      *JAK END-PERFORM.                                                 57150099
                                                                        57160096
      *JAK IF  PV-SQL-SUB > PC-MAX-RETRIES                              57170099
      *JAK     MOVE 'MAX RETRIES EXCEEDED FOR DELETE TPMADLC'           57180099
      *JAK                           TO  PV-MESSAGE                     57190099
      *JAK     PERFORM 9900-PROCESS-DB2-ERROR                           57200099
      *JAK     SET PS-INPUT-REC-ERROR TO TRUE                           57210099
      *JAK END-IF.                                                      57220099
                                                                        57230096
                                                                        57240096
      *----------------------------------------------------------------*57250096
      *   DELETE THE STORE FROM TPMMELC.                                57260096
      *----------------------------------------------------------------*57270096
      *7910-DELETE-TPMMELC-STORES.                                      57280099
      *JAK MOVE '7910-DELETE-TPMMELC-STORES' TO PV-PARAGRAPH.           57290099
      *                                                                 57300099
      *JAK PERFORM                                                      57310099
      *JAK     WITH TEST AFTER                                          57320099
      *JAK     VARYING PV-SQL-SUB                                       57330099
      *JAK     FROM 1 BY 1                                              57340099
      *JAK     UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        57350099
      *JAK        OR SQLCODE = ZERO                                     57360099
      *JAK        OR SQLCODE = PC-ROW-NOT-FOUND                         57370099
      *JAK        OR PS-INPUT-REC-ERROR                                 57380099
      *                                                                 57390099
      *JAK     EXEC SQL                                                 57400099
      *JAK         DELETE FROM TPMMELC                                  57410099
      *JAK         WHERE ADLOC_ID = :PV-KEY-NBR-2-4                     57420099
      *JAK     END-EXEC                                                 57430099
      *                                                                 57440099
      *JAK     EVALUATE TRUE                                            57450099
      *JAK         WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              57460099
      *JAK         WHEN SQLCODE = PC-DEADLOCK                           57470099
      *JAK         WHEN SQLCODE = PC-ROW-NOT-FOUND                      57480099
      *JAK         WHEN SQLCODE = ZERO                                  57490099
      *JAK             CONTINUE                                         57500099
      *JAK         WHEN SQLWARN0 NOT = SPACE                            57510099
      *JAK         WHEN SQLCODE  NOT = ZERO                             57520099
      *JAK             MOVE 'BAD SQLCODE FOR DELETE TPMMELC'            57530099
      *JAK                           TO  PV-MESSAGE                     57540099
      *JAK             PERFORM 9900-PROCESS-DB2-ERROR                   57550099
      *JAK             SET PS-INPUT-REC-ERROR TO TRUE                   57560099
      *JAK     END-EVALUATE                                             57570099
      *JAK END-PERFORM.                                                 57580099
      *                                                                 57590099
      *JAK IF  PV-SQL-SUB > PC-MAX-RETRIES                              57600099
      *JAK     MOVE 'MAX RETRIES EXCEEDED FOR DELETE TPMMELC'           57610099
      *JAK                           TO  PV-MESSAGE                     57620099
      *JAK     PERFORM 9900-PROCESS-DB2-ERROR                           57630099
      *JAK     SET PS-INPUT-REC-ERROR TO TRUE                           57640099
      *JAK END-IF.                                                      57650099
                                                                        57660096
                                                                        57670096
      *----------------------------------------------------------------*57680096
      *   DELETE THE STORE FROM TPMITPR.                                57690096
      *----------------------------------------------------------------*57700096
      *7920-DELETE-TPMITPR-STORES.                                      57710099
      *JAK MOVE '7920-DELETE-TPMITPR-STORES' TO PV-PARAGRAPH.           57720099
      *                                                                 57730099
      *JAK PERFORM                                                      57740099
      *JAK     WITH TEST AFTER                                          57750099
      *JAK     VARYING PV-SQL-SUB                                       57760099
      *JAK     FROM 1 BY 1                                              57770099
      *JAK     UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        57780099
      *JAK        OR SQLCODE = ZERO                                     57790099
      *JAK        OR SQLCODE = PC-ROW-NOT-FOUND                         57800099
      *JAK        OR PS-INPUT-REC-ERROR                                 57810099
      *                                                                 57820099
      *JAK     EXEC SQL                                                 57830099
      *JAK         DELETE FROM TPMITPR                                  57840099
      *JAK         WHERE ADLOC_ID = :PV-KEY-NBR-2-4                     57850099
      *JAK     END-EXEC                                                 57860099
      *                                                                 57870099
      *JAK     EVALUATE TRUE                                            57880099
      *JAK         WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              57890099
      *JAK         WHEN SQLCODE = PC-DEADLOCK                           57900099
      *JAK         WHEN SQLCODE = PC-ROW-NOT-FOUND                      57910099
      *JAK         WHEN SQLCODE = ZERO                                  57920099
      *JAK             CONTINUE                                         57930099
      *JAK         WHEN SQLWARN0 NOT = SPACE                            57940099
      *JAK         WHEN SQLCODE  NOT = ZERO                             57950099
      *JAK             MOVE 'BAD SQLCODE FOR DELETE TPMITPR'            57960099
      *JAK                           TO  PV-MESSAGE                     57970099
      *JAK             PERFORM 9900-PROCESS-DB2-ERROR                   57980099
      *JAK             SET PS-INPUT-REC-ERROR TO TRUE                   57990099
      *JAK     END-EVALUATE                                             58000099
      *JAK END-PERFORM.                                                 58010099
      *                                                                 58020099
      *JAK IF  PV-SQL-SUB > PC-MAX-RETRIES                              58030099
      *JAK     MOVE 'MAX RETRIES EXCEEDED FOR DELETE TPMITPR'           58040099
      *JAK                           TO  PV-MESSAGE                     58050099
      *JAK     PERFORM 9900-PROCESS-DB2-ERROR                           58060099
      *JAK     SET PS-INPUT-REC-ERROR TO TRUE                           58070099
      *JAK END-IF.                                                      58080099
                                                                        58090096
                                                                        58100096
      *----------------------------------------------------------------*58110096
      *   DELETE THE STORE FROM TMITGPL.                                58120096
      *----------------------------------------------------------------*58130096
       7930-DELETE-TMITGPL-STORES.                                      58140096
           MOVE '7930-DELETE-TMITGPL-STORES' TO PV-PARAGRAPH.           58150096
                                                                        58160096
           PERFORM                                                      58170096
               WITH TEST AFTER                                          58180096
               VARYING PV-SQL-SUB                                       58190096
               FROM 1 BY 1                                              58200096
               UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        58210096
                  OR SQLCODE = ZERO                                     58220096
                  OR SQLCODE = PC-ROW-NOT-FOUND                         58230096
                  OR PS-INPUT-REC-ERROR                                 58240096
                                                                        58250096
               EXEC SQL                                                 58260096
                   DELETE FROM TMITGPL                                  58270096
                   WHERE ADLOC_ID = :PV-KEY-NBR-2-4                     58280096
               END-EXEC                                                 58290096
                                                                        58300096
               EVALUATE TRUE                                            58310096
                   WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              58320096
                   WHEN SQLCODE = PC-DEADLOCK                           58330096
                   WHEN SQLCODE = PC-ROW-NOT-FOUND                      58340096
                   WHEN SQLCODE = ZERO                                  58350096
                       CONTINUE                                         58360096
                   WHEN SQLWARN0 NOT = SPACE                            58370096
                   WHEN SQLCODE  NOT = ZERO                             58380096
                       MOVE 'BAD SQLCODE FOR DELETE TMITGPL'            58390096
                                     TO  PV-MESSAGE                     58400096
                       PERFORM 9900-PROCESS-DB2-ERROR                   58410096
                       SET PS-INPUT-REC-ERROR TO TRUE                   58420096
               END-EVALUATE                                             58430096
           END-PERFORM.                                                 58440096
                                                                        58450096
           IF  PV-SQL-SUB > PC-MAX-RETRIES                              58460096
               MOVE 'MAX RETRIES EXCEEDED FOR DELETE TMITGPL'           58470096
                                     TO  PV-MESSAGE                     58480096
               PERFORM 9900-PROCESS-DB2-ERROR                           58490096
               SET PS-INPUT-REC-ERROR TO TRUE                           58500096
           END-IF.                                                      58510096
                                                                        58520096
                                                                        58530096
      * ------------------------------------------------------------- * 58540096
      * READ CONTROL CARD 1 TO OBTAIN THE INPUT QUEUE MGR NAME          58550096
      * ------------------------------------------------------------- * 58560096
       8000-READ-CONTROL-CARD1.                                         58570096
            READ CONTROL-CARD-1 INTO CC-CONTROL-CARD-1                  58580096
                AT END                                                  58590096
                    SET PS-CONTROL-CARD-1-END   TO TRUE.                58600096
                                                                        58610096
      * ------------------------------------------------------------- * 58620096
      * READ CONTROL CARD 2 TO OBTAIN THE INPUT QUEUE NAME              58630096
      * ------------------------------------------------------------- * 58640096
       8010-READ-CONTROL-CARD2.                                         58650096
            READ CONTROL-CARD-2 INTO CC-CONTROL-CARD-2                  58660096
                AT END                                                  58670096
                    SET PS-CONTROL-CARD-2-END TO TRUE.                  58680096
                                                                        58690096
      * ------------------------------------------------------------- * 58700096
      * GET RMS ORG HIERARCHY MESSAGES FROM MQ SERIES                   58710096
      * ------------------------------------------------------------- * 58720096
       8200-MQGET-MSG.                                                  58730096
                                                                        58740096
           INITIALIZE PS-MQGET-SUCCESSFUL-SW.                           58750096
           INITIALIZE PV-MSGBUFFER.                                     58760096
           MOVE MQMI-NONE              TO MQMD-MSGID.                   58770096
           MOVE MQCI-NONE              TO MQMD-CORRELID.                58780096
           MOVE CC-ORG-HIERARCHY-QNAME TO MQOD-OBJECTNAME.              58790096
0403RM*WR24988                                                          58800099
0403RM** MESSAGES WERE BEING "LEFT" ON QUEUE AFTER RUN.  THE MESSAGES   58810099
0403RM*  WERE PROBABLY MOVING ACROSS THE NETWORK SLOWER THAN EXPECTED.  58820099
0403RM*  ADDING THE WAIT TIME WILL ENSURE THAT ALL MESSAGES GET         58830099
0403RM*  PROCESSED.                                                     58840099
0403RM*** WAIT TIME IS IN MILLISECONDS (60000 = 1 MINUTE)               58850099
0403RM     MOVE 60000                  TO MQGMO-WAITINTERVAL.           58860099
           COMPUTE MQGMO-OPTIONS  = MQGMO-SYNCPOINT +                   58870096
                                    MQGMO-CONVERT +                     58880096
                                    MQGMO-WAIT.                         58890096
                                                                        58900096
           CALL WS-MQGET USING PV-HCONN                                 58910096
                               PV-GQ-HANDLE                             58920096
                               MQM-MESSAGE-DESCRIPTOR                   58930096
                               MQM-GET-MESSAGE-OPTIONS                  58940096
                               PV-MSGLENGTH                             58950096
                               PV-MSGBUFFER                             58960096
                               PV-DATA-LENGTH                           58970096
                               PV-COMPLETION-CODE                       58980096
                               PV-REASON.                               58990096
                                                                        59000096
      *        IF GET FAILED THEN DISPLAY ERROR MESSAGE                 59010096
      *        AND BREAK OUT OF LOOP                                    59020096
                                                                        59030096
           IF (PV-COMPLETION-CODE NOT = MQCC-OK)                        59040096
              IF (PV-REASON NOT = MQRC-NO-MSG-AVAILABLE)                59050096
                  MOVE PV-COMPLETION-CODE TO PH-COMPLETION-CODE         59060096
                  MOVE PV-REASON          TO PH-REASON                  59070096
                  PERFORM 8500-BACK-OUT-MQ                              59080096
                  PERFORM 1600-CLOSE-QUEUE                              59090096
                  PERFORM 1700-DISCONNECT-QMGR                          59100096
                  MOVE 'MQGET ERROR'      TO PV-ERROR-MESSAGE           59110096
                  MOVE PH-COMPLETION-CODE TO PV-COMPLETION-CODE         59120096
                  MOVE PH-REASON          TO PV-REASON                  59130096
                  PERFORM 9000-DISPLAY-MQ-ERROR                         59140096
              ELSE                                                      59150096
                  DISPLAY 'NO MORE MESSAGES AVAILABLE'                  59160096
              END-IF                                                    59170096
           ELSE                                                         59180096
              MOVE MQMD-REPLYTOQMGR TO PV-ISP-QMGR-NAME                 59190096
      *       DISPLAY "*** REPLY TO QUEUE MANAGER NAME OF MSG : ",      59200096
      *               MQMD-REPLYTOQMGR                                  59210096
              SET PS-MQGET-SUCCESSFUL TO TRUE                           59220096
              ADD 1 TO PA-MQGET                                         59230096
              MOVE PV-MSGBUFFER TO HORD100-RECORD                       59240096
           END-IF.                                                      59250096
                                                                        59260096
      ******************************************************************59270096
      *  COMMIT DB2 PROCESSING SINCE THE POINT OF THE LAST COMMIT      *59280096
      ******************************************************************59290096
                                                                        59300096
       8400-COMMIT-DB2.                                                 59310096
                                                                        59320096
           EXEC SQL                                                     59330096
              COMMIT                                                    59340096
           END-EXEC.                                                    59350096
                                                                        59360096
           IF SQLCODE NOT = +0                                          59370096
              MOVE '8400-COMMIT-DB2'    TO PV-PARAGRAPH                 59380096
              MOVE 'ATTEMPT TO COMMIT UPDATES TO DB2 TABLES'            59390096
                                        TO PV-MESSAGE                   59400096
              PERFORM 8500-BACK-OUT-MQ                                  59410096
              PERFORM 9900-PROCESS-DB2-ERROR                            59420096
           END-IF.                                                      59430096
                                                                        59440096
                                                                        59450096
      ******************************************************************59460096
      *  ROLLBACK DB2 PROCESSING SINCE THE POINT OF THE LAST COMMIT    *59470096
      ******************************************************************59480096
                                                                        59490096
       8410-ROLLBACK-DB2.                                               59500096
                                                                        59510096
           EXEC SQL                                                     59520096
              ROLLBACK                                                  59530096
           END-EXEC.                                                    59540096
                                                                        59550096
           IF SQLCODE NOT = +0                                          59560096
              MOVE '8410-ROLLBACK-DB2'  TO PV-PARAGRAPH                 59570096
              MOVE 'ATTEMPT TO ROLLBACK UPDATES TO DB2 TABLES'          59580096
                                        TO PV-MESSAGE                   59590096
              PERFORM 8500-BACK-OUT-MQ                                  59600096
              PERFORM 9900-PROCESS-DB2-ERROR                            59610096
           END-IF.                                                      59620096
                                                                        59630096
                                                                        59640096
      ******************************************************************59650096
      *  COMMIT MQ PROCESSING SINCE THE POINT OF THE LAST COMMIT       *59660096
      ******************************************************************59670096
                                                                        59680096
       8450-COMMIT-MQ.                                                  59690096
                                                                        59700096
           CALL WS-MQCMIT USING PV-HCONN                                59710096
                                PV-COMPLETION-CODE                      59720096
                                PV-REASON.                              59730096
                                                                        59740096
           IF (PV-COMPLETION-CODE NOT = MQCC-OK)                        59750096
              MOVE '8450-COMMIT-MQ'  TO PV-PARAGRAPH                    59760096
              MOVE 'MQCMIT ERROR'    TO PV-ERROR-MESSAGE                59770096
              PERFORM 8500-BACK-OUT-MQ                                  59780096
              PERFORM 9000-DISPLAY-MQ-ERROR                             59790096
           END-IF.                                                      59800096
                                                                        59810096
      ******************************************************************59820096
      * BACK OUT MQ PROCESSING SINCE THE POINT OF THE LAST COMMIT      *59830096
      ******************************************************************59840096
                                                                        59850096
       8500-BACK-OUT-MQ.                                                59860096
                                                                        59870096
           CALL WS-MQBACK USING PV-HCONN                                59880096
                                PV-COMPLETION-CODE                      59890096
                                PV-REASON.                              59900096
                                                                        59910096
           IF (PV-COMPLETION-CODE NOT = MQCC-OK) THEN                   59920096
              MOVE '8500-BACK-OUT-MQ'  TO PV-PARAGRAPH                  59930096
              MOVE 'MQBACK ERROR'    TO PV-ERROR-MESSAGE                59940096
              PERFORM 9000-DISPLAY-MQ-ERROR                             59950096
           END-IF.                                                      59960096
                                                                        59970096
      * ------------------------------------------------------------- * 59980096
      * DECREMENT THE DATE IN PV-START-DATE BY ONE DAY.  PLACE THE      59990096
      * RESULT IN PV-DATE-DEC-DAYS.                                     60000096
      * ------------------------------------------------------------- * 60010096
       8600-DECREMENT-DATE.                                             60020096
                                                                        60030096
           INITIALIZE DPG51                                             60040096
                      DPG52                                             60050096
                      DPG53                                             60060096
                      DPG54                                             60070096
                      DPG55                                             60080096
                      DPG56.                                            60090096
                                                                        60100096
           MOVE PV-START-DATE         TO DPG52-LK-DATE-INPUT.           60110096
           SET DPG51-DECREMENT-DATE   TO TRUE.                          60120096
           MOVE PV-DAYS               TO DPG51-INCR-DECR-DAYS-9.        60130096
                                                                        60140096
           PERFORM 8700-CALL-DATE-ROUTINE.                              60150096
                                                                        60160096
           MOVE DPG55-DB2-ISO-DATE-FMT TO PV-DATE-DEC-DAYS.             60170096
                                                                        60180096
       8700-CALL-DATE-ROUTINE.                                          60190096
                                                                        60200096
           MOVE PC-F2                 TO DPG51-CALENDAR-TYPE            60210096
           SET  DPG52-LK-DTE-ISO-FMT  TO TRUE.                          60220096
                                                                        60230096
           CALL PC-DPKUT500-PGM                                         60240096
               USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.               60250096
                                                                        60260096
           IF (DPG54-DATE-INVALID OR                                    60270096
               DPG54-SEVERE-ERROR)                                      60280096
               DISPLAY 'DPKUT500 ERROR = ' DPG54-ERROR-MESSAGE          60290096
               DISPLAY '** PROGRAM ERROR **'                            60300096
               DISPLAY 'HOKUP001  - DECREMENT DATE: ' PV-START-DATE     60310096
               PERFORM 9920-WRITE-ERROR-RECORD                          60320096
           END-IF.                                                      60330096
                                                                        60340096
      *----------------------------------------------------------------*60350096
      *   GETS THE MAXIMUM SUBSCRIPT NUMBER ON THE TSTR000 FILE        *60360096
      *----------------------------------------------------------------*60370096
       8800-GET-MAX-SUBSCRIPT.                                          60380096
           MOVE PC-999               TO PV-999.                         60390096
           IF TSTR000-TYPE-CODE = PC-VENDOR                             60400096
                             OR   PC-HEADQUARTERS                       60410096
                             OR   PC-NON-MERCHANDISE                    60420096
                             OR   PC-SALVAGE                            60430096
               MOVE 0                         TO PV-SUBSCRIPT-NMBR      60440096
           ELSE                                                         60450096
               PERFORM                                                  60460096
                   WITH TEST AFTER                                      60470096
                   VARYING PV-SQL-SUB                                   60480096
                   FROM 1 BY 1                                          60490096
                   UNTIL PV-SQL-SUB > PC-MAX-RETRIES                    60500096
                      OR SQLCODE = ZERO                                 60510096
                      OR PS-INPUT-REC-ERROR                             60520096
                                                                        60530096
                     EXEC SQL                                           60540096
                         SELECT MAX(SUBSCRIPT_NMBR)                     60550096
                             INTO :PV-SUBSCRIPT-NMBR                    60560096
                             FROM TSTR000                               60570096
                             WHERE ((OP_CO_NMBR                         60580096
                                           = :PC-KOHLS-OP-CO)           60590096
                               AND (SUBSCRIPT_NMBR                      60600096
                                           ^= :PV-999))                 60610096
                     END-EXEC                                           60620096
                                                                        60630096
                   EVALUATE TRUE                                        60640096
                       WHEN SQLCODE = -911                              60650096
                       WHEN SQLCODE = -913                              60660096
                           ADD +1          TO PV-RETRY-COUNT            60670096
                       WHEN SQLCODE = ZERO                              60680096
                           CONTINUE                                     60690096
                       WHEN OTHER                                       60700096
                            MOVE 'MAX SUBSCRIPT NMBR' TO PV-MESSAGE     60710096
                            SET PS-INPUT-REC-ERROR TO TRUE              60720096
                   END-EVALUATE                                         60730096
               END-PERFORM                                              60740096
                                                                        60750096
               IF PV-SQL-SUB > PC-MAX-RETRIES                           60760096
                   MOVE 'MAX RETRIES EXCEEDED FOR MAX SUBSCRIPT'        60770096
                                         TO PV-MESSAGE                  60780096
                   SET PS-INPUT-REC-ERROR TO TRUE                       60790096
               END-IF                                                   60800096
                                                                        60810096
               IF SQLCODE = ZERO                                        60820096
                   ADD +1            TO PV-SUBSCRIPT-NMBR               60830096
               END-IF                                                   60840096
           END-IF.                                                      60850096
                                                                        60860096
      * ------------------------------------------------------------- * 60870096
      * DISPLAY THE VALUES OF A FAILED MQ API COMMAND                   60880096
      * ------------------------------------------------------------- * 60890096
       9000-DISPLAY-MQ-ERROR.                                           60900096
                                                                        60910096
           DISPLAY '**** ABEND *************************************'.  60920096
           DISPLAY '** MQSERIES ERROR **'                               60930096
           DISPLAY '** PROGRAM:    ', PC-PGM-NAME                       60940096
           DISPLAY '** PARAGRAPH:  ', PV-PARAGRAPH                      60950096
           DISPLAY '** MESSAGE:    ', PV-ERROR-MESSAGE.                 60960096
           DISPLAY '** COMP CODE:  ', PV-COMPLETION-CODE.               60970096
           DISPLAY '** RSN CODE:   ', PV-REASON.                        60980096
           DISPLAY '************************************************'.  60990096
           SET AC-MQ-ERROR TO TRUE.                                     61000096
           CALL 'ILBOABN0' USING ABEND-CODE.                            61010096
                                                                        61020096
      *----------------------------------------------------------------*61030096
      *  FORMAT A DB2 ERROR MESSAGE                                    *61040096
      *----------------------------------------------------------------*61050096
                                                                        61060096
       9900-PROCESS-DB2-ERROR.                                          61070096
                                                                        61080096
           DISPLAY '***************************************************'61090096
           DISPLAY '**  ERROR     **'.                                  61100096
           DISPLAY '**  PROGRAM   **  = ' PC-PGM-NAME.                  61110096
           DISPLAY '**  PARAGRAPH **  = ' PV-PARAGRAPH.                 61120096
           DISPLAY '**  MESSAGE   **  = ' PV-MESSAGE.                   61130096
           DISPLAY '**  KEY       **  = ' PV-KEY-NBR.                   61140096
      *                                                                 61150096
      *  ROUTINE TO CONVERT THE SQLCA INTO A READABLE FORMAT, USING     61160096
      *  THE CALLED MODULE DSNTIAR.                                     61170096
      *                                                                 61180096
           COPY DPPD004.                                                61190096
                                                                        61200096
           PERFORM 9920-WRITE-ERROR-RECORD.                             61210096
                                                                        61220096
      *----------------------------------------------------------------*61230096
      *  WRITE AN AUDIT RECORD - JUST A COPY OF THE INPUT RECORD       *61240096
      *----------------------------------------------------------------*61250096
                                                                        61260096
       9910-WRITE-AUDIT-RECORD.                                         61270096
           WRITE AUDIT-RECORD FROM HORD100-RECORD.                      61280096
           ADD 1 TO PA-AUDITS.                                          61290096
                                                                        61300096
      *----------------------------------------------------------------*61310096
      *  WRITE AN ERROR RECORD, BUT DO NOT ABEND THE PROGARM           *61320096
      *----------------------------------------------------------------*61330096
                                                                        61340096
       9920-WRITE-ERROR-RECORD.                                         61350096
           WRITE ERROR-RECORD FROM HORD100-RECORD.                      61360096
           ADD 1 TO PA-ERRORS.                                          61370096
                                                                        61380096
