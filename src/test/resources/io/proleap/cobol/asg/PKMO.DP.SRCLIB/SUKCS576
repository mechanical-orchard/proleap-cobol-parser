000300*-----------------------*                                         00030000
000400 IDENTIFICATION DIVISION.                                         00040000
000500*-----------------------*                                         00050000
000600 PROGRAM-ID.    SUKCS576.                                         00060000
000700 AUTHOR.        GERMAN BANDA.                                     00070000
000800 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00080000
000900 DATE-WRITTEN.  NOVEMBER 2001.                                    00090000
001000 DATE-COMPILED.                                                   00100000
001100*---------------------------------------------------------------* 00110000
001200*    THE PROGRAM WILL ALLOW THE ASSOCIATE TO ADD OR UPDATE        00120000
001300*    VENDOR PARAMTERS FOR AUDITING.                               00130000
001400*    THE PROGRAM WILL HAVE DIFFERENT EDITS DEPENDING ON WHICH     00140000
001820*    MNEMONIC IS PASSED FROM  THE CICS ARCHITECTURE.              00182000
001830*    WHEN PROCESSING AN 'ADD' THE ONLY VALID KEY IS F13           00183000
001831*    WHICH IS FUNC-01 IN PROGRAM PROCESSING.                      00183100
001832*    WHEN PROCESSING AN 'UPD' F15 (FUNC-02) IS VALID AS WELL      00183200
001833*    AS PREVIOUS AND NEXT KEYS.                                   00183300
001900*---------------------------------------------------------------* 00185000
001500*    CHANGES                                                     *00186000
      *    MADE BY: SHOBHIT BAIJAL       PR#5148D                      *00187000
      *    DATE:    10/07/2013                                         *00188000
      *                                                                *00189000
      *    NEW COLUMN 'RFID' WAS ADDED TO THE SCREEN FOR RFID RANKING  *00189100
      *    PARAMETERS. CHANGES CAN BE FOUND WITH *SB 10/07/13          *00189200
      *                                                                *00189300
001600*----------------------------------------------------------------*00189400
263968* CHANGED 11/15/2021    BY JIM HUNTER      WR: CHG0263968         00189699
263968* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00189799
263968* MAKING THE CALL DYNAMIC VS STATIC.                              00189899
001130*                                                                 00189999
001110* CHANGED 01/09/2023    BY JEAN KURK       WR: CHG0278099         00190099
001120* CHANGE CALL OF DPKCS030 TO BE DYNAMIC                           00190199
263968*---------------------------------------------------------------* 00190299
001900 ENVIRONMENT DIVISION.                                            00191000
002000                                                                  00200000
002100 DATA DIVISION.                                                   00210000
002200                                                                  00220000
002300 WORKING-STORAGE SECTION.                                         00230000
002400                                                                  00240000
002700*                                                                 00270000
002800 01  DK-DB2-KEYS.                                                 00280000
003100     10  DK-VND-RNKG-CDE          PIC   X(6).                     00310000
003300*                                                                 00330000
003400 01  PC-PROGRAM-CONSTANTS.                                        00340000
003500     05  PC-CURRENT-PROGRAM-NAME  PIC  X(08)  VALUE  'SUKCS576'.  00350000
003600     05  PC-CURRENT-MAP-NAME      PIC  X(08)  VALUE  'SU576A  '.  00360000
003700     05  PC-CURRENT-MAPSET-NAME   PIC  X(08)  VALUE  'SUKM576 '.  00370000
003800     05  PC-01                    PIC  X(02)  VALUE  '01'.        00380000
003900     05  PC-APPL-MAP              PIC S9(04)  VALUE  +1           00390000
004000                                              COMP.               00400000
004100     05  PC-MAX-RETRIES           PIC S9(04)  VALUE  +3           00410000
004200                                              COMP.               00420000
004300     05  PC-INTER-APPL-CODES.                                     00430000
004600         10  PC-INTER-APPL-CRIT-SPEC-ADD                          00460000
004700                                  PIC  X(01)  VALUE '1'.          00470000
004710         10  PC-INTER-APPL-CRIT-SPEC-UPD                          00471000
004720                                  PIC  X(01)  VALUE '2'.          00472000
004800         10  PC-INTER-APPL-LIST-ADD                               00480000
004900                                  PIC  X(01)  VALUE '3'.          00490000
005000         10  PC-INTER-APPL-LIST-UPDATE                            00500000
005100                                  PIC  X(01)  VALUE '4'.          00510000
005401     05  PC-LIST-QUEUE-SEQ        PIC  9(01)  VALUE 1.            00540100
005402                                                                  00540200
005403                                                                  00540300
005410     05  PC-VEND-RANK-TYP-BC      PIC  X(02)  VALUE  'BC'.        00541000
005420     05  PC-VEND-RANK-TYP-PP      PIC  X(02)  VALUE  'PP'.        00542000
005430     05  PC-VEND-RANK-TYP-PS      PIC  X(02)  VALUE  'PS'.        00543000
      *SB 10/07/13 - BEGIN PR#5148D                                     00543100
005430     05  PC-VEND-RANK-TYP-RF      PIC  X(02)  VALUE  'RF'.        00544000
      *SB 10/07/13 - END PR#5148D                                       00545000
005500*----------------------------------------------------------------*00550000
005600*  SYSTEM MESSAGES                                                00560000
005700*----------------------------------------------------------------*00570000
005800*   00005 - INVALID VALUE                                         00580000
005900*   00007 - REQUIRED ENTRY                                        00590000
006000*   00008 - MUST BE NUMERIC                                       00600000
006100*   00034 - ADD SUCCESSFUL                                        00610000
006200*   00057 - A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION        00620000
006300*   00059 - UPDATE(S) SUCCESSFUL                                  00630000
006400*   00069 - TOP OF LIST                                           00640000
006500*   00070 - BOTTOM OF LIST                                        00650000
006600*   00095 - APPLICATION SYSTEM DOES NOT EXIST                     00660000
006700*   00115 - DELETE SUCCESSFUL                                     00670000
006800*   00302 - DATA ENTERED IN THE 'KEY' FIELD IS INVALID            00680000
006810*   00308 - AT LEAST ONE ENTRY IS REQUIRED                        00681000
006900*   00354 - DELETE PENDING - PRESS PF2 TO CONFIRM                 00690000
007000*   00527 - TYPE CODE DOES NOT EXIST                              00700000
007400*   99901 - INVALID COMMAND WAS ENTERED                           00740000
007500*----------------------------------------------------------------*00750000
007600     05  PC-TSYMSG-NUMBERS.                                       00760000
007700         10  PC-TSYMSG-00005      PIC  9(05)  VALUE  00005.       00770000
007800         10  PC-TSYMSG-00007      PIC  9(05)  VALUE  00007.       00780000
007900         10  PC-TSYMSG-00008      PIC  9(05)  VALUE  00008.       00790000
008000         10  PC-TSYMSG-00034      PIC  9(05)  VALUE  00034.       00800000
008010         10  PC-TSYMSG-00045      PIC  9(05)  VALUE  00045.       00801000
008100         10  PC-TSYMSG-00057      PIC  9(05)  VALUE  00057.       00810000
008200         10  PC-TSYMSG-00059      PIC  9(05)  VALUE  00059.       00820000
008300         10  PC-TSYMSG-00069      PIC  9(05)  VALUE  00069.       00830000
008400         10  PC-TSYMSG-00070      PIC  9(05)  VALUE  00070.       00840000
008700         10  PC-TSYMSG-00302      PIC  9(05)  VALUE  00302.       00870000
008710         10  PC-TSYMSG-00308      PIC  9(05)  VALUE  00308.       00871000
008800         10  PC-TSYMSG-00342      PIC  9(05)  VALUE  00342.       00880000
009110         10  PC-TSYMSG-02843      PIC  9(05)  VALUE  02843.       00911000
009111         10  PC-TSYMSG-02845      PIC  9(05)  VALUE  02845.       00911100
009112         10  PC-TSYMSG-02846      PIC  9(05)  VALUE  02846.       00911200
009120         10  PC-TSYMSG-02847      PIC  9(05)  VALUE  02847.       00912000
009200         10  PC-TSYMSG-02551      PIC  9(05)  VALUE  02551.       00920000
009300         10  PC-TSYMSG-02889      PIC  9(05)  VALUE  02889.       00930000
009400*                                                                 00940000
009500     05  PC-A                     PIC  X(01)  VALUE  'A'.         00950000
009800     05  PC-N                     PIC  X(01)  VALUE  'N'.         00980000
009810     05  PC-S                     PIC  X(01)  VALUE  'S'.         00981000
009900     05  PC-SPACE                 PIC  X(03)  VALUE  '   '.       00990000
010000*                                                                 01000000
010100 01  PS-PROGRAM-SWITCHES.                                         01010000
010200     05  PS-ERROR-SW              PIC  X(01)  VALUE  'N'.         01020000
010300         88  PS-ERROR                         VALUE  'Y'.         01030000
010400         88  PS-NO-ERROR                      VALUE  'N'.         01040000
010500     05  PS-COMMAREA-SW           PIC  X(01)  VALUE  'N'.         01050000
010600         88  PS-COMMAREA-VALID                VALUE  'Y'.         01060000
010700         88  PS-COMMAREA-NOT-VALID            VALUE  'N'.         01070000
010800     05  PS-LIST-END-SW           PIC  X(01)  VALUE  'N'.         01080000
010900         88  PS-LIST-END                      VALUE  'Y'.         01090000
011000         88  PS-NO-LIST-END                   VALUE  'N'.         01100000
011400     05  PS-EOF-PO-AUD-PARM-CURSOR-SW    PIC  X(01)  VALUE 'N'.   01140000
011500         88  PS-EOF-PO-AUD-PARM-CURSOR               VALUE 'Y'.   01150000
011600         88  PS-NOT-EOF-PO-AUD-PARM-CURSOR           VALUE 'N'.   01160000
011610     05  PS-ACCESS-SW                   PIC  X(01)  VALUE 'N'.    01161000
011620         88  PS-ACCESS-ALLOWED                      VALUE 'Y'.    01162000
011630         88  PS-ACCESS-NOT-ALLOWED                  VALUE 'N'.    01163000
011640     05  PS-PCT-TO-AUD-ZERO-SW          PIC  X(01)  VALUE 'N'.    01164000
011650         88  PS-PCT-TO-AUD-ZERO-YES                 VALUE 'Y'.    01165000
011660         88  PS-PCT-TO-AUD-ZERO-NO                  VALUE 'N'.    01166000
011700*                                                                 01170000
011800 01  PV-PROGRAM-VARIABLES.                                        01180000
011900     05  PV-CICS-RESPONSE         PIC S9(04)  VALUE +0            01190000
012000                                              COMP SYNC.          01200000
012100     05  PV-RETRY-COUNTER         PIC S9(04)  VALUE +0            01210000
012200                                              COMP SYNC.          01220000
013010     05  PV-DECIMAL-COUNT         PIC S9(04)  VALUE ZERO COMP.    01301000
013100                                                                  01310000
013200     05  PV-PKG-TYP-CDE           PIC X(2).                       01320000
013204     05  PV-VND-RNKG-CDE          PIC X(6).                       01320400
013205     05  PV-VEND-RNK-DESC         PIC X(30).                      01320500
013206     05  PV-INT-APPL-FORMAT-IND   PIC X(01).                      01320600
015800*                                                                 01580000
020200*---------------------------------------------------------------* 02020000
020300* SELECTON QUEUE LAYOUT                                         * 02030000
020400*---------------------------------------------------------------* 02040000
020500     COPY SUWS016.                                                02050000
020600                                                                  02060000
020700*----------------------------------------------------------------*02070000
020800*    MAP LAYOUT                                                  *02080000
020900*----------------------------------------------------------------*02090000
021000                                                                  02100000
021100     COPY SUKM576.                                                02110000
021200                                                                  02120000
021210*----------------------------------------------------------------*02121000
021220**  SECURITY SUBROUTINE PARAMETERS                                02122000
021230*----------------------------------------------------------------*02123000
021240     COPY DPWS008.                                                02124000
021250                                                                  02125000
021260                                                                  02126000
021300*----------------------------------------------------------------*02130000
021400*    ATTRIBUTE SETTINGS COPYBOOK.                                *02140000
021500*----------------------------------------------------------------*02150000
021600                                                                  02160000
021700     COPY DPWS015.                                                02170000
021800     COPY DPWS057.                                                02180000
021900                                                                  02190000
022000*----------------------------------------------------------------*02200000
022100*    FUNCTION KEYS COPYBOOK                                      *02210000
022200*----------------------------------------------------------------*02220000
022300                                                                  02230000
022400     COPY DPWS016.                                                02240000
022500                                                                  02250000
022600                                                                  02260000
022700**--------------------------------------------------------------**02270000
022800** THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT    **02280000
022900** SUB-ROUTINE (DPKUT100).                                      **02290000
023000**--------------------------------------------------------------**02300000
023100     COPY DPWS010I.                                               02310000
023200                                                                  02320000
023300**--------------------------------------------------------------**02330000
023400** PARAMETERS FOR CALLING CICS ARCHITECTURE API                  *02340099
023600**--------------------------------------------------------------**02360000
023700     COPY DPWS030.                                                02370000
023700     COPY DPWS930.                                                02371099
023800                                                                  02380000
023900**--------------------------------------------------------------**02390000
024000*    STANDARD COMMAREA.                                           02400000
024100**--------------------------------------------------------------**02410000
024200                                                                  02420000
024300     COPY DPWS020.                                                02430000
024400     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                02440000
024500                                                                  02450000
024600*---------------------------------------------------------------* 02460000
024700* INTER-APPLICATION COMMAREA.                                     02470000
024800*   SUWS014 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 02480000
024900*             SPEC SCREEN.                                        02490000
025000*   SUWS015 - IS THE INPUT LAYOUT THAT WILL BE PASSED FROM        02500000
025100*             THE LIST SCREEN                                     02510000
025200*---------------------------------------------------------------* 02520000
025300                                                                  02530000
025400         10  INTER-APPL-COMM-AREA PIC X(200).                     02540000
025410     COPY SUWS014.                                                02541000
025420     COPY SUWS015.                                                02542000
025700***************************************************************** 02570000
025800*    SPECIFIC COMMMAREA FOR SUKCS576.                             02580000
025900***************************************************************** 02590000
026000         10  ASC-SPECIFIC-COMMAREA.                               02600000
026100             15  ASC-CONFIRMATION-SW       PIC X(01).             02610000
026200                 88  ASC-NEED-CONFIRMATION            VALUE  'Y'. 02620000
026300                 88  ASC-NOT-NEED-CONFIRMATION        VALUE  'N'. 02630000
026700             15  ASC-VEND-RNK-CDE          PIC X(06).             02670000
026800             15  ASC-VEND-RNK-DESC         PIC X(30).             02680000
026801             15  ASC-RACF-AUTHORITY-FOUND-SW PIC  X(01).          02680100
026802                 88  ASC-RACF-AUTHORITY-FOUND    VALUE  'Y'.      02680200
026803                 88  ASC-NO-RACF-AUTH-FOUND      VALUE  'N'.      02680300
026804*                                                                 02680400
026805             15  ASC-SPECIFIC-SCREEN-FIELDS.                      02680500
026806                 20  ASC-PKGNG-TYP-CDE-BC      PIC X(02).         02680600
026807                 20  ASC-PKGNG-TYP-CDE-PP      PIC X(02).         02680700
026808                 20  ASC-PKGNG-TYP-CDE-PS      PIC X(02).         02680800
      *SB 10/07/13 - BEGIN PR#5148D                                     02680900
                       20  ASC-PKGNG-TYP-CDE-RF      PIC X(02).         02681000
      *SB 10/07/13 - END PR#5148D                                       02681100
026810*                                                                 02681200
026820*BULK/CASEPACK FIELDS                                             02682000
027000                 20  ASC-AUD-PCT-BC-X          PIC X(06).         02700000
027010                 20  ASC-AUD-PCT-BC  REDEFINES ASC-AUD-PCT-BC-X   02701000
027020                                               PIC ZZ9.99.        02702000
027030                 20  ASC-CKD-PCT-BC-X          PIC X(06).         02703000
027040                 20  ASC-CKD-PCT-BC  REDEFINES ASC-CKD-PCT-BC-X   02704000
027050                                                  PIC ZZ9.99.     02705000
027200                 20  ASC-MAX-CKD-QTY-BC.                          02720000
027201                     25 ASC-MAX-CKD-QTY-BC-N      PIC ZZZ9.       02720100
027303                 20  ASC-MAX-CART-CKD-QTY-BC.                     02730300
027304                     25 ASC-MAX-CART-CKD-QTY-BC-N PIC ZZZ9.       02730400
027310                 20  ASC-MIN-CART-CKD-QTY-BC.                     02731000
027311                     25 ASC-MIN-CART-CKD-QTY-BC-N PIC ZZZ9.       02731100
027320                 20  ASC-CKD-DC-QTY-BC.                           02732000
027321                     25 ASC-CKD-DC-QTY-BC-N       PIC ZZZ9.       02732100
027330                 20  ASC-MAX-PO-LNE-QTY-BC.                       02733000
027340                     25 ASC-MAX-PO-LNE-QTY-BC-N   PIC ZZZ9.       02734000
027400                 20  ASC-CK-AFT-DAY-QTY-BC.                       02740000
027401                     25 ASC-CK-AFT-DAY-QTY-BC-N   PIC ZZZ9.       02740100
027402*                                                                 02740200
027403*PREPACK FIELDS                                                   02740300
027404                 20  ASC-AUD-PCT-PP-X          PIC X(06).         02740400
027405                 20  ASC-AUD-PCT-PP  REDEFINES ASC-AUD-PCT-PP-X   02740500
027406                                                PIC ZZ9.99.       02740600
027407                 20  ASC-CKD-PCT-PP-X          PIC X(06).         02740700
027408                 20  ASC-CKD-PCT-PP  REDEFINES ASC-CKD-PCT-PP-X   02740800
027409                                                  PIC ZZ9.99.     02740900
027410                 20  ASC-MAX-CKD-QTY-PP.                          02741000
027420                     25 ASC-MAX-CKD-QTY-PP-N      PIC ZZZ9.       02742000
027430                 20  ASC-MAX-CART-CKD-QTY-PP.                     02743000
027440                     25 ASC-MAX-CART-CKD-QTY-PP-N PIC ZZZ9.       02744000
027450                 20  ASC-MIN-CART-CKD-QTY-PP.                     02745000
027460                     25 ASC-MIN-CART-CKD-QTY-PP-N PIC ZZZ9.       02746000
027470                 20  ASC-CKD-DC-QTY-PP.                           02747000
027480                     25 ASC-CKD-DC-QTY-PP-N       PIC ZZZ9.       02748000
027600                 20  ASC-CK-AFT-DAY-QTY-PP.                       02760000
027700                     25 ASC-CK-AFT-DAY-QTY-PP-N   PIC ZZZ9.       02770000
027800*                                                                 02780000
027900*PACK BY STORE FIELDS                                             02790000
028000                 20  ASC-AUD-PCT-PS-X          PIC X(06).         02800000
028100                 20  ASC-AUD-PCT-PS  REDEFINES ASC-AUD-PCT-PS-X   02810000
028200                                                PIC ZZ9.99.       02820000
028800                 20  ASC-MAX-CART-CKD-QTY-PS.                     02880000
028900                     25 ASC-MAX-CART-CKD-QTY-PS-N PIC ZZZ9.       02890000
029000                 20  ASC-MIN-CART-CKD-QTY-PS.                     02900000
029100                     25 ASC-MIN-CART-CKD-QTY-PS-N PIC ZZZ9.       02910000
029200                 20  ASC-CKD-DC-QTY-PS.                           02920000
029300                     25 ASC-CKD-DC-QTY-PS-N       PIC ZZZ9.       02930000
029400                 20  ASC-CK-AFT-DAY-QTY-PS.                       02940000
029500                     25 ASC-CK-AFT-DAY-QTY-PS-N   PIC ZZZ9.       02950000
029510*                                                                 02951000
      *SB 10/07/13 - BEGIN PR#5148D                                     02951100
027900*RFID FIELDS                                                      02951200
028000                 20  ASC-AUD-PCT-RF-X          PIC X(06).         02951300
028100                 20  ASC-AUD-PCT-RF  REDEFINES ASC-AUD-PCT-RF-X   02951400
028200                                                PIC ZZ9.99.       02951500
028800                 20  ASC-MAX-CART-CKD-QTY-RF.                     02951600
028900                     25 ASC-MAX-CART-CKD-QTY-RF-N PIC ZZZ9.       02951700
029000                 20  ASC-MIN-CART-CKD-QTY-RF.                     02951800
029100                     25 ASC-MIN-CART-CKD-QTY-RF-N PIC ZZZ9.       02951900
029200                 20  ASC-CKD-DC-QTY-RF.                           02952000
029300                     25 ASC-CKD-DC-QTY-RF-N       PIC ZZZ9.       02952100
029400                 20  ASC-CK-AFT-DAY-QTY-RF.                       02952200
029500                     25 ASC-CK-AFT-DAY-QTY-RF-N   PIC ZZZ9.       02952300
      *SB 10/07/13 - END PR#5148D                                       02952400
029510*                                                                 02952500
029520                 20  ASC-SELECT-TYPE-BC     PIC X(02).            02952600
029530                     88  ASC-ADD-UPD-BC     VALUE 'BC'.           02953000
029540                 20  ASC-SELECT-TYPE-PP     PIC X(02).            02954000
029550                     88  ASC-ADD-UPD-PP     VALUE 'PP'.           02955000
029560                 20  ASC-SELECT-TYPE-PS     PIC X(02).            02956000
029570                     88  ASC-ADD-UPD-PS     VALUE 'PS'.           02957000
      *SB 10/07/13 - BEGIN PR#5148D                                     02957100
029560                 20  ASC-SELECT-TYPE-RF     PIC X(02).            02957200
029570                     88  ASC-ADD-UPD-RF     VALUE 'RF'.           02957300
      *SB 10/07/13 - END PR#5148D                                       02957400
029580*                                                                 02958000
029581*                                                                 02958100
029582                 20  ASC-VALID-SELECT-BC    PIC X(01).            02958200
029584                 20  ASC-VALID-SELECT-PP    PIC X(01).            02958400
029586                 20  ASC-VALID-SELECT-PS    PIC X(01).            02958600
      *SB 10/07/13 - BEGIN PR#5148D                                     02958700
029586                 20  ASC-VALID-SELECT-RF    PIC X(01).            02958800
      *SB 10/07/13 - END PR#5148D                                       02958900
029588*                                                                 02959000
029590                 20  ASC-VND-RNKG-EXISTS-SW   PIC  X(01).         02959100
029591                     88  ASC-VND-RNKG-EXISTS         VALUE  'Y'.  02959200
029592                     88  ASC-VND-RNKG-NOT-EXISTS     VALUE  'N'.  02959300
029593*                                                                 02959400
029594                 20  ASC-PO-AUD-PARM-INSERTED-SW PIC  X(01).      02959500
029595                     88  ASC-PO-AUD-PARM-INSERTED-Y  VALUE  'Y'.  02959600
029596                     88  ASC-PO-AUD-PARM-INSERTED-N  VALUE  'N'.  02959700
029597                                                                  02959800
029700*                                                                 02970000
031300                                                                  03130000
031400             15  ASC-INT-APPL-FORMAT-IND   PIC X(01).             03140000
031500*SWITCHES                                                         03150000
031600             15  ASC-ACTION-SW          PIC X(03).                03160000
031700                 88  ASC-ADD            VALUE 'ADD'.              03170000
031800                 88  ASC-DELETE         VALUE 'DEL'.              03180000
031900                 88  ASC-UPDATE         VALUE 'UPD'.              03190000
035491*                                                                 03549100
035500             15  ASC-MSG-NUMBER.                                  03550000
035600                 20  ASC-MSG-NUMBER-N      PIC  9(05).            03560000
035700             15  ASC-INT-APPL-FORMAT-SAVE  PIC  X(01).            03570000
035800             15  ASC-SYSTEM-ID             PIC  X(02).            03580000
035900             15  ASC-MSG-TEXT              PIC  X(70).            03590000
036000             15  ASC-USE-SELECTION-QUEUE-IND                      03600000
036100                                           PIC  X(01).            03610000
036200                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 03620000
036300             15  ASC-SEL-QUEUE-NAME        PIC  X(08).            03630000
036400             15  ASC-NUMBER-OF-TS-ITEMS    PIC S9(05)  COMP-3.    03640000
036410             15  ASC-LIST-QUEUE-NAME.                             03641000
036420                 20  ASC-LIST-TERM-ID        PIC X(4).            03642000
036430                 20  ASC-LIST-TASK-NUMBER    PIC S9(5) COMP-3.    03643000
036440                 20  ASC-LIST-SEQ            PIC 9.               03644000
036500             15  ASC-NUMBER-OF-SELECTED-ITEMS                     03650000
036600                                           PIC S9(09)  COMP-3.    03660000
036610             15  ASC-CONFIRM-PROCESSING-SW   PIC  X(1).           03661000
036620                 88  ASC-CONFIRM-FUNC-OFF         VALUE  ' '.     03662000
036621                 88  ASC-CONFIRM-FUNC-01          VALUE  '1'.     03662100
036630                 88  ASC-CONFIRM-FUNC-02          VALUE  '2'.     03663000
037100             15  ASC-ITEM-SUB                 PIC S9(04)  COMP    03710000
037200                                                          SYNC.   03720000
037300             15  ASC-SEL-SUB               PIC S9(04)  COMP.      03730000
037400             15  ASC-SEL-ITEM              PIC S9(04)  COMP.      03740000
037500             15  ASC-TEMP-QUEUE-UPDATE-SW     PIC  X(01).         03750000
037600                 88  ASC-UPDATE-TSQ                VALUE 'Y'.     03760000
037700                 88  ASC-NO-TSQ-UPDATE             VALUE ' '.     03770000
037800                                                                  03780000
037900*----------------------------------------------------------------*03790000
038000*    ABEND PROCESSING COPYBOOK.                                  *03800000
038100*----------------------------------------------------------------*03810000
038200     COPY DPWS013.                                                03820000
038300                                                                  03830000
038400******************************************************************03840000
038900*    DB2 AREA FOR AUDIT RANK CODE TABLE SUT_VND_RNKG_CDE          03890000
038910******************************************************************03891000
039000     EXEC SQL                                                     03900000
039100          INCLUDE SUT00016                                        03910000
039200     END-EXEC.                                                    03920000
039800                                                                  03980000
039900******************************************************************03990000
040000******************************************************************04000000
040100*    DB2 AREA FOR AUDIT PARM TABLE (SUT_PO_AUD_PARM)              04010000
040200******************************************************************04020000
040300     EXEC SQL                                                     04030000
040400          INCLUDE SUT00017                                        04040000
040500     END-EXEC.                                                    04050000
040600                                                                  04060000
040700******************************************************************04070000
040800******************************************************************04080000
040900*    DB2 AREA FOR THE VENDOR PKGNG ASSOCIATION                    04090000
040910*    (SUT_VND_PKGNG_ASSN)                                         04091000
041000******************************************************************04100000
041100     EXEC SQL                                                     04110000
041200          INCLUDE SUT00020                                        04120000
041300     END-EXEC.                                                    04130000
041310                                                                  04131000
041320******************************************************************04132000
041400                                                                  04140000
041500*    DB2 AREA FOR COMMUNICATIONS                                  04150000
041600     EXEC SQL                                                     04160000
041700          INCLUDE SQLCA                                           04170000
041800     END-EXEC.                                                    04180000
041810******************************************************************04181000
041900                                                                  04190000
042000     EXEC SQL                                                     04200000
042100        DECLARE PARM_DATA_CSR CURSOR FOR                          04210000
042200             SELECT                                               04220000
042300                  VND_RNKG_CDE                                    04230000
042490                 ,PKGNG_TYP_CDE                                   04249000
042491                 ,AUD_PCT                                         04249100
042492                 ,CKD_PCT                                         04249200
042493                 ,MAX_CKD_QTY                                     04249300
042494                 ,MAX_CART_CKD_QTY                                04249400
042495                 ,MIN_CART_CKD_QTY                                04249500
042496                 ,CKD_DC_QTY                                      04249600
042497                 ,MAX_PO_LNE_QTY                                  04249700
042498                 ,CK_AFT_DAY_QTY                                  04249800
042499                 ,CK_AFT_RCVR_QTY                                 04249900
042510             FROM  SUT_PO_AUD_PARM A                              04251000
042600             WHERE VND_RNKG_CDE = :DK-VND-RNKG-CDE                04260000
042610              AND  EFF_BEG_TMST IN                                04261000
042620                   (SELECT MAX(B.EFF_BEG_TMST)                    04262000
042630                    FROM SUT_PO_AUD_PARM B                        04263000
042640                    WHERE B.VND_RNKG_CDE = :DK-VND-RNKG-CDE       04264000
042700                    GROUP BY B.VND_RNKG_CDE, B.PKGNG_TYP_CDE)     04270000
042800         END-EXEC                                                 04280000
042900*                                                                 04290000
043000*                                                                 04300000
043100 LINKAGE SECTION.                                                 04310000
043200                                                                  04320000
043300 01  DFHCOMMAREA.                                                 04330000
043400     05  FILLER                         OCCURS  1 TO 4072 TIMES   04340000
043500                                        DEPENDING ON EIBCALEN.    04350000
043600         10  FILLER                     PIC X.                    04360000
043700                                                                  04370000
043800                                                                  04380000
043900 PROCEDURE DIVISION.                                              04390000
044000***************************************************************** 04400000
044100** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** 04410000
044200** THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  ** 04420000
044300** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            ** 04430000
044400**                                                             ** 04440000
044500** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  ** 04450000
044600** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       ** 04460000
044700***************************************************************** 04470000
044800 0000-MAIN-MODULE.                                                04480000
044900     INITIALIZE DP030-CICS-API-FIELDS.                            04490000
045000     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       04500000
045100     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          04510000
045200     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         04520000
045300     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       04530000
045400     MOVE LENGTH OF SU576AI        TO DP030-MAP-LENGTH (1).       04540000
045500     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     04550000
045600     PERFORM 0001-CALL-CICS-ARCH-API.                             04560000
045700                                                                  04570000
045800     PERFORM 1000-CONTROL-PROCESSING                              04580000
045900                                                                  04590000
046000     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     04600000
046100     PERFORM 0001-CALL-CICS-ARCH-API.                             04610000
046200                                                                  04620000
046300 0001-CALL-CICS-ARCH-API.                                         04630000
046400*    CALL 'DPKCS030' USING DFHEIBLK                               04640099
046400     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      04641099
046500                           DFHCOMMAREA                            04650000
046600                           DP030-CICS-API-FIELDS                  04660000
046700                           DP020-STANDARD-COMMAREA                04670000
046800                           SU576AI.                               04680000
046900                                                                  04690000
047000     IF  DP030-RC-CALL-SUCCESSFUL                                 04700000
047100         CONTINUE                                                 04710000
047200     ELSE                                                         04720000
047300         SET DP013-NO-ROLLBACK                                    04730000
047400             DP013-XCTL-DISPLAY-RESTART                           04740000
047500             DP013-CICS-ABEND      TO TRUE                        04750000
047600         MOVE 'BEFORE 0000-MAIN-MODULE'                           04760000
047700                                   TO DP013-PARAGRAPH             04770000
047800*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX04780099
047900*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      04790099
047800         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL. RETURN-CODE O04791099
047900-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      04792099
048000         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      04800000
048100         PERFORM DP013-0000-PROCESS-ABEND                         04810000
048200     END-IF.                                                      04820000
048300*                                                                 04830000
048400*                                                                 04840000
048500*----------------------------------------------------------------*04850000
048600*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *04860000
048700*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *04870000
048800*----------------------------------------------------------------*04880000
048900 1000-CONTROL-PROCESSING.                                         04890000
049000                                                                  04900000
049100     EVALUATE TRUE                                                04910000
049200         WHEN DP020-NEXT-ACT-INITIAL                              04920000
049300              INITIALIZE ASC-SPECIFIC-COMMAREA                    04930000
049400              MOVE EIBTRMID               TO ASC-LIST-TERM-ID     04940000
049500              MOVE DP020-SRC-TASK-NUMBER  TO ASC-LIST-TASK-NUMBER 04950000
049610              MOVE PC-LIST-QUEUE-SEQ                              04961000
049620                                    TO ASC-LIST-SEQ               04962000
049700              PERFORM 1100-PROCESS-INTER-APPL-COMM                04970000
049900                                                                  04990000
050000              IF  PS-COMMAREA-NOT-VALID                           05000000
050100                  SET DP020-NEXT-ACT-APPL-ERROR                   05010000
050200                                    TO TRUE                       05020000
050300              ELSE                                                05030000
050400                  PERFORM 4000-BUILD-INITIAL-PANEL                05040000
050410                  IF ASC-NO-RACF-AUTH-FOUND                       05041000
050411                     PERFORM 3203-RESET-ATTRIBUTES-TO-VIEW        05041100
050420                  ELSE                                            05042000
050500                     PERFORM 3200-RESET-ATTRIBUTES                05050000
050510                  END-IF                                          05051000
050600              END-IF                                              05060000
050700                                                                  05070000
050800         WHEN DP020-NEXT-ACT-READ-MAP                             05080000
050900             PERFORM 2000-PROCESS-PANEL                           05090000
050910             IF ASC-NO-RACF-AUTH-FOUND                            05091000
050920                PERFORM 3203-RESET-ATTRIBUTES-TO-VIEW             05092000
050930             END-IF                                               05093000
051000*F3-END                                                           05100000
051100         WHEN DP020-NEXT-ACT-RETURN                               05110000
051200             PERFORM 4000-BUILD-INITIAL-PANEL                     05120000
051300             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   05130000
051400             MOVE -1                   TO APCAUDBL                05140000
052300                                                                  05230000
052400         WHEN OTHER                                               05240000
052500             SET DP013-LOGIC-ABEND TO TRUE                        05250000
052600             SET DP013-NO-ROLLBACK TO TRUE                        05260000
052700             MOVE '1000-CONTROL-PROCESSING'                       05270000
052800                                   TO DP013-PARAGRAPH             05280000
052900             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    05290000
053000                                   TO DP013-MESSAGE-TEXT(1)       05300000
053100             MOVE DP020-NEXT-APPL-ACTIVITY                        05310000
053200                                   TO DP013-MESSAGE-TEXT(2)       05320000
053300             PERFORM DP013-0000-PROCESS-ABEND                     05330000
053400     END-EVALUATE.                                                05340000
053500*                                                                 05350000
053600*                                                                 05360000
053700******************************************************************05370000
053800** DETERMINE THE KEY OF THE OBJECT TO BE UPDATED BASED ON THE   **05380000
053900** INTER-APPLICATION FORMAT CODE.                               **05390000
054000******************************************************************05400000
054100 1100-PROCESS-INTER-APPL-COMM.                                    05410000
054300     MOVE DP020-INT-APPL-FORMAT-IND                               05430000
054400                                   TO ASC-INT-APPL-FORMAT-IND.    05440000
054500                                                                  05450000
054600     SET PS-COMMAREA-VALID         TO TRUE.                       05460000
054700                                                                  05470000
054800*WHEN COMING FROM CRIT SPEC (SUKCS575- F13=ADDRANK)               05480000
054810*OR FROM THE LIST SCREEN ADD(SUKCS577)                            05481000
054900     EVALUATE ASC-INT-APPL-FORMAT-IND                             05490000
055000         WHEN PC-INTER-APPL-CRIT-SPEC-ADD                         05500000
055001         WHEN PC-INTER-APPL-LIST-ADD                              05500100
055010           IF SU014-VEND-RNK-CDE  > SPACES                        05501000
055100              MOVE SU014-VEND-RNK-CDE   TO ASC-VEND-RNK-CDE       05510000
055200              MOVE SU014-VEND-RNK-DESC  TO ASC-VEND-RNK-DESC      05520000
055300           END-IF                                                 05530000
055900*WHEN COMING FROM CRIT SPEC (SUKCS575- F15=UPDRANK)               05590000
056000         WHEN PC-INTER-APPL-CRIT-SPEC-UPD                         05600000
056010             MOVE SU014-VEND-RNK-CDE   TO ASC-VEND-RNK-CDE        05601000
056011                                          DK-VND-RNKG-CDE         05601100
056020             MOVE SU014-VEND-RNK-DESC  TO ASC-VEND-RNK-DESC       05602000
056030                                                                  05603000
059600*WHEN COMING FROM UPDATE LIST SCREEN (SUKCS577)                   05960000
059700         WHEN PC-INTER-APPL-LIST-UPDATE                           05970000
059800           IF SU015-NUMBER-OF-SELECTED-ITEMS > 0                  05980000
059900             SET ASC-USE-SELECTION-QUEUE TO TRUE                  05990000
060000             MOVE SU015-NUMBER-OF-SELECTED-ITEMS                  06000000
060100                                   TO ASC-NUMBER-OF-SELECTED-ITEMS06010000
060200             MOVE SU015-NUMBER-OF-TS-ITEMS                        06020000
060300                                   TO ASC-NUMBER-OF-TS-ITEMS      06030000
060400             MOVE SU015-SEL-QUEUE-NAME                            06040000
060500                                   TO ASC-SEL-QUEUE-NAME          06050000
060900             MOVE 'UPD' TO  ASC-ACTION-SW                         06090000
061000             PERFORM 1120-PREPARE-LIST-ENTRY                      06100000
061300             PERFORM 3010-FIND-EXISTING-VEND-RNK                  06130000
062300           ELSE                                                   06230000
062400              MOVE PC-TSYMSG-00057       TO DP020-MSG-NUMBER      06240000
062500              SET  PS-COMMAREA-NOT-VALID TO TRUE                  06250000
062600           END-IF                                                 06260000
062700                                                                  06270000
065900     END-EVALUATE.                                                06590000
066000*                                                                 06600000
066100*                                                                 06610000
066200*----------------------------------------------------------------*06620000
066300* ENTRY IS FROM A LIST.  GET THE MESSAGE NUMBER FROM THE TEMP    *06630000
066400* STORAGE QUEUE PASSED FROM THE LIST.                            *06640000
066500*----------------------------------------------------------------*06650000
066600 1120-PREPARE-LIST-ENTRY.                                         06660000
066700     MOVE SU016-MAX-ITEMS          TO ASC-SEL-SUB.                06670000
066800     MOVE ZERO                     TO ASC-SEL-ITEM.               06680000
066900     PERFORM 1130-GET-NEXT-RECORD.                                06690000
067000*                                                                 06700000
067100*                                                                 06710000
067200*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*06720000
067300*    GET THE NEXT RECORD IF A LIST OF RECORDS ARE BEING PROCESSED*06730000
067400*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*06740000
067500 1130-GET-NEXT-RECORD.                                            06750000
067600     ADD +1                        TO ASC-SEL-SUB.                06760000
067700                                                                  06770000
067800     SET ASC-UPDATE-TSQ TO TRUE.                                  06780000
067900                                                                  06790000
068000     IF  ASC-SEL-SUB > SU016-MAX-ITEMS                            06800000
068100         ADD +1                    TO ASC-SEL-ITEM                06810000
068200         MOVE +1                   TO ASC-SEL-SUB                 06820000
068300     END-IF.                                                      06830000
068400                                                                  06840000
068500     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                06850000
068600         PERFORM 9100-READ-SEL-QUEUE                              06860000
068700         IF  SU016-ITEM (ASC-SEL-SUB) > ZERO                      06870000
068710             INITIALIZE  ASC-SPECIFIC-SCREEN-FIELDS               06871000
068720                         SU576AI                                  06872000
068800             MOVE SU016-VEND-RNK-CDE   (ASC-SEL-SUB)              06880000
068900                                   TO ASC-VEND-RNK-CDE            06890000
068910                                      DK-VND-RNKG-CDE             06891000
069000             MOVE SU016-VEND-RNK-DESC  (ASC-SEL-SUB)              06900000
069100                                   TO ASC-VEND-RNK-DESC           06910000
070000                                                                  07000000
070100             SET SU016-INQ (ASC-SEL-SUB) TO TRUE                  07010000
070200             PERFORM 9200-REWRITE-SEL-QUEUE                       07020000
070300         ELSE                                                     07030000
070400             SUBTRACT +1 FROM ASC-SEL-SUB                         07040000
070500             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            07050000
070600             SET DP020-MSG-INFORMATIONAL                          07060000
070700                 PS-LIST-END                                      07070000
070710                 PS-ERROR          TO TRUE                        07071000
070800         END-IF                                                   07080000
070900     ELSE                                                         07090000
071000         SUBTRACT +1 FROM ASC-SEL-ITEM                            07100000
071100         MOVE SU016-MAX-ITEMS      TO ASC-SEL-SUB                 07110000
071200         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            07120000
071300         SET DP020-MSG-INFORMATIONAL                              07130000
071400                 PS-LIST-END                                      07140000
071410                 PS-ERROR          TO TRUE                        07141000
071500     END-IF.                                                      07150000
071600*                                                                 07160000
071700*                                                                 07170000
071800******************************************************************07180000
071900*  GET THE PREVIOUS RECORD IF A LIST OF RECORDS ARE BEING         07190000
072000*  PROCESSED.                                                     07200000
072100******************************************************************07210000
072200 1140-GET-PREV-RECORD.                                            07220000
072300     SUBTRACT +1 FROM ASC-SEL-SUB.                                07230000
072400                                                                  07240000
072500     IF  ASC-SEL-SUB < +1                                         07250000
072600         SUBTRACT +1 FROM ASC-SEL-ITEM                            07260000
072700         MOVE SU016-MAX-ITEMS      TO ASC-SEL-SUB                 07270000
072800     END-IF.                                                      07280000
072900                                                                  07290000
073000     IF  ASC-SEL-ITEM > ZERO                                      07300000
073100         PERFORM 9100-READ-SEL-QUEUE                              07310000
073200         IF  SU016-ITEM (ASC-SEL-SUB) > ZERO                      07320000
073210             INITIALIZE  ASC-SPECIFIC-SCREEN-FIELDS               07321000
073220                         SU576AI                                  07322000
073300             MOVE SU016-VEND-RNK-CDE   (ASC-SEL-SUB)              07330000
073400                                   TO ASC-VEND-RNK-CDE            07340000
073410                                      DK-VND-RNKG-CDE             07341000
073500             MOVE SU016-VEND-RNK-DESC  (ASC-SEL-SUB)              07350000
073600                                   TO ASC-VEND-RNK-DESC           07360000
074500         END-IF                                                   07450000
074600                                                                  07460000
074700         SET SU016-INQ (ASC-SEL-SUB) TO TRUE                      07470000
074800         PERFORM 9200-REWRITE-SEL-QUEUE                           07480000
074900     ELSE                                                         07490000
075000         MOVE +1                   TO ASC-SEL-ITEM                07500000
075100                                      ASC-SEL-SUB                 07510000
075200         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            07520000
075300         SET DP020-MSG-INFORMATIONAL                              07530000
075400             PS-LIST-END                                          07540000
075410             PS-ERROR              TO TRUE                        07541000
075500     END-IF.                                                      07550000
075600*                                                                 07560000
075700*                                                                 07570000
075800*----------------------------------------------------------------*07580000
075900* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *07590000
076000* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *07600000
076100* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *07610000
076200* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *07620000
076300* FUNCTION KEYS CAN GET THIS FAR.                                *07630000
076400*----------------------------------------------------------------*07640000
076500 2000-PROCESS-PANEL.                                              07650000
076600                                                                  07660000
076700     EVALUATE TRUE                                                07670000
076800                                                                  07680000
076900         WHEN DP020-SRC-AID = DP016-CLEAR                         07690000
077000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 07700000
077100             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   07710000
077200                                                                  07720000
077300*F5 REFRESH SCREEN                                                07730000
077500         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     07750000
077510             IF ASC-INT-APPL-FORMAT-IND =                         07751000
077511               (PC-INTER-APPL-CRIT-SPEC-ADD OR                    07751100
077520                  PC-INTER-APPL-LIST-ADD)                         07752000
077521                  MOVE ASC-INT-APPL-FORMAT-IND                    07752100
077522                                TO PV-INT-APPL-FORMAT-IND         07752200
077523                   MOVE PV-INT-APPL-FORMAT-IND                    07752300
077524                                TO ASC-INT-APPL-FORMAT-IND        07752400
077530                  INITIALIZE ASC-SPECIFIC-COMMAREA                07753000
077540             ELSE                                                 07754000
077600                MOVE ASC-VEND-RNK-CDE     TO PV-VND-RNKG-CDE      07760000
077610                MOVE ASC-VEND-RNK-DESC    TO PV-VEND-RNK-DESC     07761000
077700                MOVE ASC-INT-APPL-FORMAT-IND                      07770000
077800                                TO PV-INT-APPL-FORMAT-IND         07780000
077900                INITIALIZE ASC-SPECIFIC-COMMAREA                  07790000
078000                MOVE PV-VND-RNKG-CDE TO  ASC-VEND-RNK-CDE         07800000
078210                                        DK-VND-RNKG-CDE           07821000
078211                MOVE PV-VEND-RNK-DESC TO ASC-VEND-RNK-DESC        07821100
078213                MOVE PV-INT-APPL-FORMAT-IND                       07821300
078214                                TO ASC-INT-APPL-FORMAT-IND        07821400
078215             END-IF                                               07821500
078300                                                                  07830000
078400             PERFORM 4000-BUILD-INITIAL-PANEL                     07840000
078600                                                                  07860000
078700*F20-NEXT SEL                                                     07870000
078800         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             07880000
078900             IF  ASC-USE-SELECTION-QUEUE                          07890000
079000                 PERFORM 1130-GET-NEXT-RECORD                     07900000
079300                 PERFORM 3000-EDIT-DATA-IN-COMMAREA               07930000
079500                 IF PS-LIST-END                                   07950000
079600                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         07960000
079700                     SET PS-NO-LIST-END TO TRUE                   07970000
079800                 ELSE                                             07980000
079810                     PERFORM 2050-DELETE-LIST-QUEUE               07981000
079900                     PERFORM 4000-BUILD-INITIAL-PANEL             07990000
080100                 END-IF                                           08010000
080200             ELSE                                                 08020000
080300*                --- BOTTOM OF LIST ---                           08030000
080400                 MOVE PC-TSYMSG-00070                             08040000
080500                                   TO DP020-MSG-NUMBER            08050000
080600                 SET DP020-MSG-INFORMATIONAL                      08060000
080700                                   TO TRUE                        08070000
080800             END-IF                                               08080000
080900                                                                  08090000
081000*F19-PREV SEL                                                     08100000
081100         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             08110000
081200             IF  ASC-USE-SELECTION-QUEUE                          08120000
081300                 PERFORM 1140-GET-PREV-RECORD                     08130000
081600                 PERFORM 3000-EDIT-DATA-IN-COMMAREA               08160000
081800                 IF PS-LIST-END                                   08180000
081900                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         08190000
082000                     SET PS-NO-LIST-END                           08200000
082100                                   TO TRUE                        08210000
082200                 ELSE                                             08220000
082210                     PERFORM 2050-DELETE-LIST-QUEUE               08221000
082220                     PERFORM 3200-RESET-ATTRIBUTES                08222000
082230                     PERFORM 4000-BUILD-INITIAL-PANEL             08223000
082500                 END-IF                                           08250000
082600             ELSE                                                 08260000
082700                 MOVE PC-TSYMSG-00069                             08270000
082800                                   TO DP020-MSG-NUMBER            08280000
082900                 SET DP020-MSG-INFORMATIONAL                      08290000
083000                                   TO TRUE                        08300000
083100             END-IF                                               08310000
083200                                                                  08320000
083300         WHEN OTHER                                               08330000
083400             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 08340000
083500             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   08350000
083600             IF  PS-NO-ERROR                                      08360000
083700                 SET DP030-CONTINUE-GO                            08370000
083800                                   TO TRUE                        08380000
084000                 PERFORM 2100-CHECK-FUNCTION-KEY                  08400000
084200                 IF DP020-SRC-AID = DP016-ENTER                   08420000
084300                    CONTINUE                                      08430000
084400                 ELSE                                             08440000
084500                    PERFORM 4400-MOVE-COMMAREA-TO-SCREEN          08450000
084600                 END-IF                                           08460000
084700             ELSE                                                 08470000
084800                 SET DP030-OVERRIDE-GO                            08480000
084900                                   TO TRUE                        08490000
085000             END-IF                                               08500000
085100     END-EVALUATE.                                                08510000
085200                                                                  08520000
085300*                                                                 08530000
085310*----------------------------------------------------------------*08531000
085320*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *08532000
085330*----------------------------------------------------------------*08533000
085340 2050-DELETE-LIST-QUEUE.                                          08534000
085350                                                                  08535000
085360     EXEC CICS                                                    08536000
085370         DELETEQ TS                                               08537000
085380             QUEUE (ASC-LIST-QUEUE-NAME)                          08538000
085390             RESP  (PV-CICS-RESPONSE)                             08539000
085391     END-EXEC.                                                    08539100
085392                                                                  08539200
085393     IF (PV-CICS-RESPONSE = DFHRESP(NORMAL)) OR                   08539300
085394        (PV-CICS-RESPONSE = DFHRESP(QIDERR))                      08539400
085395         CONTINUE                                                 08539500
085396     ELSE                                                         08539600
085397         SET DP013-CICS-ABEND      TO TRUE                        08539700
085398         SET DP013-NO-ROLLBACK     TO TRUE                        08539800
085399                                                                  08539900
085400         MOVE '2050-DELETE-LIST-QUEUE'                            08540000
085401                                   TO DP013-PARAGRAPH             08540100
085402         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    08540200
085403                                   TO DP013-MESSAGE-TEXT (1)      08540300
085404         PERFORM DP013-0000-PROCESS-ABEND                         08540400
085405     END-IF.                                                      08540500
085406                                                                  08540600
085408 EJECT                                                            08540800
085410*----------------------------------------------------------------*08541000
085500* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED       *08550000
085600* FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED   *08560000
085700* FROM THE CICS ARCHITECTURE API.                                *08570000
085800*----------------------------------------------------------------*08580000
085900 2100-CHECK-FUNCTION-KEY.                                         08590000
086000     EVALUATE TRUE                                                08600000
087200*--------F13=ADD VEND RANK CDE                                    08720000
087300         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              08730000
087500             PERFORM 3010-FIND-EXISTING-VEND-RNK                  08750000
087600                                                                  08760000
087700             IF ASC-VND-RNKG-NOT-EXISTS                           08770000
087800                PERFORM 5000-PROCESS-ADD-UPD                      08780000
087801                IF ASC-PO-AUD-PARM-INSERTED-Y                     08780100
087810                    MOVE PC-TSYMSG-00034                          08781000
087820                                   TO DP020-MSG-NUMBER            08782000
087830                    SET DP020-MSG-INFORMATIONAL                   08783000
087840                                   TO TRUE                        08784000
087850                END-IF                                            08785000
087851                MOVE SPACES TO   ASC-VALID-SELECT-BC              08785100
087852                                 ASC-VALID-SELECT-PP              08785200
087853                                 ASC-VALID-SELECT-PS              08785300
      *SB 10/07/13 - BEGIN PR#5148D                                     08785400
087853                                 ASC-VALID-SELECT-RF              08785600
      *SB 10/07/13 - END PR#5148D                                       08785700
087854                                 ASC-SELECT-TYPE-BC               08785800
087855                                 ASC-SELECT-TYPE-PP               08785900
087856                                 ASC-SELECT-TYPE-PS               08786000
      *SB 10/07/13 - BEGIN PR#5148D                                     08786100
087856                                 ASC-SELECT-TYPE-RF               08786200
      *SB 10/07/13 - END PR#5148D                                       08786300
087857                MOVE SPACES TO   ABCSELO                          08786400
087858                                 APPSELO                          08786500
087859                                 APSSELO                          08786600
      *SB 10/07/13 - BEGIN PR#5148D                                     08786700
087859                                 ARFSELO                          08786800
      *SB 10/07/13 - END PR#5148D                                       08786900
087860                MOVE ZEROES TO   ABCSELL                          08787000
087861                                 APPSELL                          08787100
087862                                 APSSELL                          08787200
      *SB 10/07/13 - BEGIN PR#5148D                                     08787300
087862                                 ARFSELL                          08788000
      *SB 10/07/13 - END PR#5148D                                       08789000
087900             ELSE                                                 08790000
087901                PERFORM 3020-SEL-EXISTING-RANK-DESC               08790100
087910                SET PS-ERROR                                      08791000
087920                    DP020-MSG-FATAL TO TRUE                       08792000
087930                MOVE PC-TSYMSG-02845                              08793000
087940                                    TO DP020-MSG-NUMBER           08794000
087950                MOVE DP015-UNP-ALP-BRT-OFF                        08795000
087960                                    TO ARANKA                     08796000
087970                MOVE DP015-RED      TO ARANKC                     08797000
087980                MOVE DP015-REVERSE  TO ARANKH                     08798000
087990                MOVE -1             TO ARANKL                     08799000
087991                SET DP030-SET-CURSOR-APPL-1                       08799100
087992                                    TO TRUE                       08799200
087993             END-IF                                               08799300
088000                                                                  08800000
088100*--------F15=UPDATE EXISTING PARAMETER                            08810000
092600*--------F2=CONFIRM (UPDATE)                                      09260000
092700         WHEN DP020-FK-CONFIRM (DP020-SRC-AID)                    09270000
092701         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              09270100
092710             IF ASC-CONFIRM-FUNC-02                               09271000
092730                PERFORM 3010-FIND-EXISTING-VEND-RNK               09273000
092731                MOVE 'SUVNDRKU' TO DP008-FUNCTION-NAME            09273100
092732                PERFORM 2105-RACF-ACCESS                          09273200
092733                IF  PS-ACCESS-NOT-ALLOWED                         09273300
092734                    SET  PS-ERROR                                 09273400
092735                         DP020-MSG-FATAL TO TRUE                  09273500
092736                    MOVE PC-TSYMSG-02843 TO DP020-MSG-NUMBER      09273600
092737                    MOVE -1              TO ARANKL                09273700
092738                    SET  DP030-SET-CURSOR-APPL-1 TO TRUE          09273800
092739                    SET  DP030-OVERRIDE-GO TO TRUE                09273900
092741                END-IF                                            09274100
092742                                                                  09274200
092805                IF ASC-VND-RNKG-EXISTS                            09280500
092806                   PERFORM 5000-PROCESS-ADD-UPD                   09280600
092807                   SET ASC-CONFIRM-FUNC-OFF TO TRUE               09280700
092808                   IF ASC-PO-AUD-PARM-INSERTED-Y                  09280800
092812                      PERFORM 9100-READ-SEL-QUEUE                 09281200
092819                        SET SU016-UPD (ASC-SEL-SUB) TO TRUE       09281900
092820                        MOVE ASC-VEND-RNK-DESC                    09282000
092821                                   TO SU016-VEND-RNK-DESC         09282100
092822                                                (ASC-SEL-SUB)     09282200
092823                        IF ASC-ADD-UPD-BC                         09282300
092824                           SET SU016-PACK-TYPE-BC                 09282400
092825                                                (ASC-SEL-SUB)     09282500
092826                                                 TO TRUE          09282600
092827                        END-IF                                    09282700
092828                        IF ASC-ADD-UPD-PP                         09282800
092829                           SET SU016-PACK-TYPE-PP                 09282900
092830                                                (ASC-SEL-SUB)     09283000
092831                                                 TO TRUE          09283100
092834                        END-IF                                    09283400
092835                        IF ASC-ADD-UPD-PS                         09283500
092836                           SET SU016-PACK-TYPE-PS                 09283600
092837                                                (ASC-SEL-SUB)     09283700
092838                                                 TO TRUE          09283800
092839                        END-IF                                    09283900
      *SB 10/07/13 - BEGIN PR#5148D                                     09284000
092835                        IF ASC-ADD-UPD-RF                         09284100
092836                           SET SU016-PACK-TYPE-RF                 09284200
092837                                                (ASC-SEL-SUB)     09284300
092838                                                 TO TRUE          09284400
092839                        END-IF                                    09284500
      *SB 10/07/13 - END PR#5148D                                       09284600
092840                                                                  09284700
092841                      PERFORM 9200-REWRITE-SEL-QUEUE              09284800
092842                      MOVE SPACES TO   ASC-VALID-SELECT-BC        09284900
092843                                       ASC-VALID-SELECT-PP        09285000
092844                                       ASC-VALID-SELECT-PS        09285100
      *SB 10/07/13 - BEGIN PR#5148D                                     09285200
092844                                       ASC-VALID-SELECT-RF        09285300
      *SB 10/07/13 - END PR#5148D                                       09285400
092845                                       ASC-SELECT-TYPE-BC         09285500
092847                                       ASC-SELECT-TYPE-PP         09285600
092849                                       ASC-SELECT-TYPE-PS         09285700
      *SB 10/07/13 - BEGIN PR#5148D                                     09285800
092849                                       ASC-SELECT-TYPE-RF         09285900
      *SB 10/07/13 - END PR#5148D                                       09286000
092850                      MOVE SPACES TO   ABCSELO                    09286100
092851                                       APPSELO                    09286200
092852                                       APSSELO                    09286300
      *SB 10/07/13 - BEGIN PR#5148D                                     09286400
092852                                       ARFSELO                    09286500
      *SB 10/07/13 - END PR#5148D                                       09286600
092853                      MOVE ZEROES TO   ABCSELL                    09286700
092854                                       APPSELL                    09286800
092855                                       APSSELL                    09286900
      *SB 10/07/13 - BEGIN PR#5148D                                     09287000
092855                                       ARFSELL                    09287100
      *SB 10/07/13 - END PR#5148D                                       09287200
092860                      MOVE PC-TSYMSG-00059                        09287300
092861                                     TO DP020-MSG-NUMBER          09287400
092862                      SET DP020-MSG-INFORMATIONAL                 09287500
092863                                     TO TRUE                      09287600
092864                   END-IF                                         09287700
092865                ELSE                                              09287800
092866                    SET  PS-ERROR                                 09287900
092867                         DP020-MSG-FATAL TO TRUE                  09288000
092868                    MOVE PC-TSYMSG-02846 TO DP020-MSG-NUMBER      09288100
092869                    MOVE -1              TO ARANKL                09288200
092870                    SET  DP030-SET-CURSOR-APPL-1 TO TRUE          09288300
092871                    SET  DP030-OVERRIDE-GO TO TRUE                09288400
092872                END-IF                                            09288500
092873             ELSE                                                 09288600
092874                    SET  PS-ERROR                                 09288700
092875                         DP020-MSG-FATAL TO TRUE                  09288800
092876                    MOVE PC-TSYMSG-00045 TO DP020-MSG-NUMBER      09288900
092877                    MOVE -1              TO ARANKL                09289000
092878                    SET  DP030-SET-CURSOR-APPL-1 TO TRUE          09289100
092879                    SET  DP030-OVERRIDE-GO TO TRUE                09289200
092880             END-IF                                               09289300
092881                                                                  09289400
092882         WHEN DP020-SRC-AID = DP016-ENTER                         09289500
092883             PERFORM 3200-RESET-ATTRIBUTES                        09289600
092884             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   09289700
092890             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09289800
092900                                                                  09290000
094500         WHEN OTHER                                               09450000
094600             SET DP013-NO-ROLLBACK                                09460000
094700                 DP013-XCTL-DISPLAY-RESTART                       09470000
094800                 DP013-CICS-ABEND TO TRUE                         09480000
094900             MOVE '2000-PROCESS-PANEL'                            09490000
095000                                   TO DP013-PARAGRAPH             09500000
095100             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      09510000
095200                                   TO DP013-MESSAGE-TEXT (1)      09520000
095300             PERFORM DP013-0000-PROCESS-ABEND                     09530000
095400     END-EVALUATE.                                                09540000
095500*                                                                 09550000
095600*                                                                 09560000
095610                                                                  09561000
095620*----------------------------------------------------------------*09562000
095630* CHECK TO SEE IF USER HAS RACF AUTHORIZATION                     09563000
095640*----------------------------------------------------------------*09564000
095650 2105-RACF-ACCESS.                                                09565000
095660                                                                  09566000
095670      SET DP008-RSRC-TYPE-FUNC           TO TRUE                  09567000
095680      SET DP008-ACCESS-TYPE-USE          TO TRUE                  09568000
095690                                                                  09569000
095691      EXEC CICS                                                   09569100
095692         LINK PROGRAM (DP008-SECURITY-SUBROUTINE)                 09569200
095693              COMMAREA (DP008-SECURITY-COMMAREA)                  09569300
095694              LENGTH (DP008-SECURITY-COMMAREA-LENGTH)             09569400
095695      END-EXEC                                                    09569500
095696                                                                  09569600
095697      IF DP008-CALL-SUCCESSFUL                                    09569700
095698         IF DP008-ACCESS-ALLOWED                                  09569800
095699             SET PS-ACCESS-ALLOWED TO TRUE                        09569900
095700         ELSE                                                     09570000
095701             SET PS-ACCESS-NOT-ALLOWED TO TRUE                    09570100
095702         END-IF                                                   09570200
095703     ELSE                                                         09570300
095704         MOVE '2105-RACF-ACCESS'                                  09570400
095705                               TO DP013-PARAGRAPH                 09570500
095706          MOVE 'UNABLE TO ACCESS CICS'                            09570600
095707                               TO DP013-MESSAGE-TEXT (1)          09570700
095708          MOVE SQLCA                 TO DP013-SQLCA               09570800
095709          SET DP013-DB2-ABEND                                     09570900
095710              DP013-XCTL-DISPLAY-RESTART                          09571000
095711                               TO TRUE                            09571100
095712          PERFORM DP013-0000-PROCESS-ABEND                        09571200
095713      END-IF.                                                     09571300
095714                                                                  09571400
095715                                                                  09571500
095720*----------------------------------------------------------------*09572000
095800* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS   *09580000
095900* IN THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN   *09590000
096000* THE APPLICATION-SPECIFIC COMMAERA, NOT ON THE SCREEN.          *09600000
096100* THIS PARAGRAPH DOES NOT USE TEMPORARY VARIABLES.               *09610000
096200*----------------------------------------------------------------*09620000
096300 2200-MOVE-SCREEN-TO-COMMAREA.                                    09630000
096400*VENDOR RANK                                                      09640000
096500         IF  ARANKL  > ZERO                                       09650000
096600             MOVE ARANKI              TO ASC-VEND-RNK-CDE         09660000
096800         ELSE                                                     09680000
096900             IF  ARANKF = DP015-ERASE-EOF                         09690000
097000                 MOVE SPACE            TO ASC-VEND-RNK-CDE        09700000
097100             END-IF                                               09710000
097200         END-IF                                                   09720000
097300                                                                  09730000
097400*VENDOR RANK DESCRIPTION                                          09740000
097500         IF  ARNKDSCL > ZERO                                      09750000
097600             MOVE ARNKDSCI             TO ASC-VEND-RNK-DESC       09760000
097700         ELSE                                                     09770000
097800             IF  ARNKDSCF = DP015-ERASE-EOF                       09780000
097900                 MOVE SPACE            TO ASC-VEND-RNK-DESC       09790000
098000             END-IF                                               09800000
098100         END-IF                                                   09810000
098200                                                                  09820000
099001                                                                  09900100
099002*UPDATE BULK/CASE CHECK                                           09900200
099010     IF  ABCSELL > ZERO                                           09901000
099020         IF  ABCSELI > SPACES                                     09902000
099030             SET ASC-ADD-UPD-BC        TO TRUE                    09903000
099031             MOVE ABCSELI              TO ASC-VALID-SELECT-BC     09903100
099040         ELSE                                                     09904000
099050             MOVE SPACES               TO ASC-SELECT-TYPE-BC      09905000
099051                                          ASC-VALID-SELECT-BC     09905100
099060         END-IF                                                   09906000
099070     ELSE                                                         09907000
099080         IF  ABCSELF = DP015-ERASE-EOF                            09908000
099090             MOVE SPACES           TO ASC-SELECT-TYPE-BC          09909000
099091                                      ASC-VALID-SELECT-BC         09909100
099092         END-IF                                                   09909200
099093     END-IF.                                                      09909300
099100                                                                  09910000
099110*UPDATE PREPACK CHECK                                             09911000
099120     IF  APPSELL > ZERO                                           09912000
099130         IF  APPSELI > SPACES                                     09913000
099131             SET ASC-ADD-UPD-PP        TO TRUE                    09913100
099132             MOVE APPSELI              TO ASC-VALID-SELECT-PP     09913200
099150         ELSE                                                     09915000
099160             MOVE SPACES               TO ASC-SELECT-TYPE-PP      09916000
099161                                          ASC-VALID-SELECT-PP     09916100
099170         END-IF                                                   09917000
099180     ELSE                                                         09918000
099190         IF  APPSELF = DP015-ERASE-EOF                            09919000
099191             MOVE SPACES           TO ASC-SELECT-TYPE-PP          09919100
099192                                      ASC-VALID-SELECT-PP         09919200
099193         END-IF                                                   09919300
099194     END-IF.                                                      09919400
099195                                                                  09919500
099196*UPDATE PACK BY STORE CHECK                                       09919600
099197     IF  APSSELL > ZERO                                           09919700
099198         IF  APSSELI > SPACES                                     09919800
099199             SET ASC-ADD-UPD-PS        TO TRUE                    09919900
099200             MOVE APSSELI              TO ASC-VALID-SELECT-PS     09920000
099201         ELSE                                                     09920100
099202             MOVE SPACES               TO ASC-SELECT-TYPE-PS      09920200
099203                                          ASC-VALID-SELECT-PS     09920300
099204         END-IF                                                   09920400
099205     ELSE                                                         09920500
099206         IF  APSSELF = DP015-ERASE-EOF                            09920600
099207             MOVE SPACES               TO ASC-SELECT-TYPE-PS      09920700
099208                                          ASC-VALID-SELECT-PS     09920800
099209         END-IF                                                   09920900
099210     END-IF.                                                      09921000
099211                                                                  09921100
      *SB 10/07/13 - BEGIN PR#5148D                                     09921200
099196*UPDATE RFID CHECK                                                09921300
099197     IF  ARFSELL > ZERO                                           09921400
099198         IF  ARFSELI > SPACES                                     09921500
099199             SET ASC-ADD-UPD-RF        TO TRUE                    09921600
099200             MOVE ARFSELI              TO ASC-VALID-SELECT-RF     09921700
099201         ELSE                                                     09921800
099202             MOVE SPACES               TO ASC-SELECT-TYPE-RF      09921900
099203                                          ASC-VALID-SELECT-RF     09922000
099204         END-IF                                                   09922100
099205     ELSE                                                         09922200
099206         IF  ARFSELF = DP015-ERASE-EOF                            09922300
099207             MOVE SPACES               TO ASC-SELECT-TYPE-RF      09922400
099208                                          ASC-VALID-SELECT-RF     09922500
099209         END-IF                                                   09922600
099210     END-IF.                                                      09922700
      *SB 10/07/13 - END PR#5148D                                       09922800
099211                                                                  09922900
099212******************************************************************09923000
099213**MOVE BULK/CASEPACK SCREEN ENTRIES TO COMMAREA*******************09923100
099214                                                                  09923200
099215*PERCENT TO AUDIT                                                 09923300
099216     IF  APCAUDBL > ZERO                                          09923400
099217         MOVE APCAUDBI               TO ASC-AUD-PCT-BC-X          09923500
099220     ELSE                                                         09923600
099221          IF  APCAUDBF = DP015-ERASE-EOF                          09923700
099230              MOVE SPACES            TO ASC-AUD-PCT-BC-X          09923800
099240                                        APCAUDBO                  09924000
099250          END-IF                                                  09925000
099251     END-IF.                                                      09925100
099253* PERCENT CHECKED TOLERANCE                                       09925300
099254     IF  APCTOLBL > ZERO                                          09925400
099255         MOVE APCTOLBI               TO ASC-CKD-PCT-BC-X          09925500
099256     ELSE                                                         09925600
099257          IF  APCTOLBF = DP015-ERASE-EOF                          09925700
099258              MOVE SPACES            TO ASC-CKD-PCT-BC-X          09925800
099260          END-IF                                                  09926000
099270     END-IF.                                                      09927000
099280*                                                                 09928000
099290*NOT TO EXCEED QUANTITY                                           09929000
099300     IF  ANEXCDBL > ZERO                                          09930000
099400         MOVE ANEXCDBI               TO ASC-MAX-CKD-QTY-BC        09940000
099500     ELSE                                                         09950000
099510         IF  ANEXCDBF = DP015-ERASE-EOF                           09951000
099600             MOVE ZEROES             TO ASC-MAX-CKD-QTY-BC        09960000
099800         END-IF                                                   09980000
099810     END-IF.                                                      09981000
099900*                                                                 09990000
099910*MAX CARTONS CHECKED QUANTITY                                     09991000
099920     IF  AMAXCKBL > ZERO                                          09992000
099930         MOVE AMAXCKBI               TO ASC-MAX-CART-CKD-QTY-BC   09993000
099940     ELSE                                                         09994000
099950         IF  AMAXCKBF = DP015-ERASE-EOF                           09995000
099960             MOVE ZEROES             TO ASC-MAX-CART-CKD-QTY-BC   09996000
099980         END-IF                                                   09998000
099990     END-IF.                                                      09999000
099991*                                                                 09999100
099992*MIN CARTONS CHECKED QUANTITY                                     09999200
099993     IF  AMINCKBL > ZERO                                          09999300
099994         MOVE AMINCKBI               TO ASC-MIN-CART-CKD-QTY-BC   09999400
099995     ELSE                                                         09999500
099996         IF  AMINCKBF = DP015-ERASE-EOF                           09999600
099997             MOVE ZEROES             TO ASC-MIN-CART-CKD-QTY-BC   09999700
099998         END-IF                                                   09999800
099999     END-IF.                                                      09999900
100000*                                                                 10000000
100010*HOW MANY DC'S TO CHECK                                           10001000
100020     IF  ADCCHKBL > ZERO                                          10002000
100030         MOVE ADCCHKBI               TO ASC-CKD-DC-QTY-BC         10003000
100040     ELSE                                                         10004000
100050         IF  ADCCHKBF = DP015-ERASE-EOF                           10005000
100060             MOVE ZEROES             TO ASC-CKD-DC-QTY-BC         10006000
100070         END-IF                                                   10007000
100080     END-IF.                                                      10008000
100090*                                                                 10009000
100091*MAXIMUM PO-LINES TO CHECK                                        10009100
100092     IF  AMXPOLBL > ZERO                                          10009200
100093         MOVE AMXPOLBI               TO ASC-MAX-PO-LNE-QTY-BC     10009300
100094     ELSE                                                         10009400
100095         IF  AMXPOLBF = DP015-ERASE-EOF                           10009500
100096             MOVE ZEROES             TO ASC-MAX-PO-LNE-QTY-BC     10009600
100097         END-IF                                                   10009700
100098     END-IF.                                                      10009800
100099*                                                                 10009900
100100*RECHECK AFTER # OF DAYS                                          10010000
100110     IF  ACHKDYBL > ZERO                                          10011000
100120         MOVE ACHKDYBI               TO ASC-CK-AFT-DAY-QTY-BC     10012000
100130     ELSE                                                         10013000
100140         IF  ACHKDYBF = DP015-ERASE-EOF                           10014000
100150             MOVE ZEROES             TO ASC-CK-AFT-DAY-QTY-BC     10015000
100160         END-IF                                                   10016000
100170     END-IF.                                                      10017000
100180**MOVE PREPACK SCREEN ENTRIES TO COMMAREA*************************10018000
100190*PREPACK                                                          10019000
100191* PERCENT TO AUDIT                                                10019100
100192     IF  APCAUDPL > ZERO                                          10019200
100193         MOVE APCAUDPI               TO ASC-AUD-PCT-PP-X          10019300
100194     ELSE                                                         10019400
100195          IF  APCAUDPF = DP015-ERASE-EOF                          10019500
100196              MOVE SPACES            TO ASC-AUD-PCT-PP-X          10019600
100197                                        APCAUDPO                  10019700
100198          END-IF                                                  10019800
100199     END-IF.                                                      10019900
100200* PERCENT CHECKED TOLERANCE                                       10020000
100201     IF  APCTOLPL > ZERO                                          10020100
100202         MOVE APCTOLPI               TO ASC-CKD-PCT-PP-X          10020200
100203     ELSE                                                         10020300
100204          IF  APCTOLPF = DP015-ERASE-EOF                          10020400
100205              MOVE SPACES            TO ASC-CKD-PCT-PP-X          10020500
100206          END-IF                                                  10020600
100207     END-IF.                                                      10020700
100208*                                                                 10020800
100209*NOT TO EXCEED QUANTITY                                           10020900
100210     IF  ANEXCDPL > ZERO                                          10021000
100211         MOVE ANEXCDPI               TO ASC-MAX-CKD-QTY-PP        10021100
100220     ELSE                                                         10022000
100230         IF  ANEXCDPF = DP015-ERASE-EOF                           10023000
100240             MOVE ZEROES             TO ASC-MAX-CKD-QTY-PP        10024000
100250         END-IF                                                   10025000
100260     END-IF.                                                      10026000
100270*                                                                 10027000
100280*MAX CARTONS CHECKED QUANTITY                                     10028000
100290     IF  AMAXCKPL > ZERO                                          10029000
100291         MOVE AMAXCKPI               TO ASC-MAX-CART-CKD-QTY-PP   10029100
100292     ELSE                                                         10029200
100293         IF  AMAXCKPF = DP015-ERASE-EOF                           10029300
100294             MOVE ZEROES             TO ASC-MAX-CART-CKD-QTY-PP   10029400
100295         END-IF                                                   10029500
100296     END-IF.                                                      10029600
100297*                                                                 10029700
100298*MIN CARTONS CHECKED QUANTITY                                     10029800
100299     IF  AMINCKPL > ZERO                                          10029900
100300         MOVE AMINCKPI               TO ASC-MIN-CART-CKD-QTY-PP   10030000
100310     ELSE                                                         10031000
100320         IF  AMINCKPF = DP015-ERASE-EOF                           10032000
100330             MOVE ZEROES             TO ASC-MIN-CART-CKD-QTY-PP   10033000
100340         END-IF                                                   10034000
100350     END-IF.                                                      10035000
100360*                                                                 10036000
100370*HOW MANY DC'S TO CHECK                                           10037000
100380     IF  ADCCHKPL > ZERO                                          10038000
100390         MOVE ADCCHKPI               TO ASC-CKD-DC-QTY-PP         10039000
100391     ELSE                                                         10039100
100392         IF  ADCCHKPF = DP015-ERASE-EOF                           10039200
100393             MOVE ZEROES             TO ASC-CKD-DC-QTY-PP         10039300
100394         END-IF                                                   10039400
100395     END-IF.                                                      10039500
100396*                                                                 10039600
100460*RECHECK AFTER # OF DAYS                                          10046000
100470     IF  ACHKDYPL > ZERO                                          10047000
100480         MOVE ACHKDYPI               TO ASC-CK-AFT-DAY-QTY-PP     10048000
100490     ELSE                                                         10049000
100491         IF  ACHKDYPF = DP015-ERASE-EOF                           10049100
100492             MOVE ZEROES             TO ASC-CK-AFT-DAY-QTY-PP     10049200
100493         END-IF                                                   10049300
100494     END-IF.                                                      10049400
100500                                                                  10050000
104700*                                                                 10470000
104701**MOVE PACK BY STORE SCREEN ENTRIES TO COMMAREA  ***************  10470100
104710*PERCENT TO AUDIT                                                 10471000
104720     IF  APCAUDSL > ZERO                                          10472000
104730         MOVE APCAUDSI               TO ASC-AUD-PCT-PS-X          10473000
104740     ELSE                                                         10474000
104750          IF  APCAUDSF = DP015-ERASE-EOF                          10475000
104760              MOVE SPACES            TO ASC-AUD-PCT-PS-X          10476000
104770                                        APCAUDSO                  10477000
104780          END-IF                                                  10478000
104790     END-IF.                                                      10479000
104791                                                                  10479100
104808*                                                                 10480800
104809*MAX CARTONS CHECKED QUANTITY                                     10480900
104810     IF  AMAXCKSL > ZERO                                          10481000
104811         MOVE AMAXCKSI               TO ASC-MAX-CART-CKD-QTY-PS   10481100
104812     ELSE                                                         10481200
104813         IF  AMAXCKSF = DP015-ERASE-EOF                           10481300
104814             MOVE ZEROES             TO ASC-MAX-CART-CKD-QTY-PS   10481400
104815         END-IF                                                   10481500
104816     END-IF.                                                      10481600
104817*                                                                 10481700
104818*MIN CARTONS CHECKED QUANTITY                                     10481800
104819     IF  AMINCKSL > ZERO                                          10481900
104820         MOVE AMINCKSI               TO ASC-MIN-CART-CKD-QTY-PS   10482000
104821     ELSE                                                         10482100
104822         IF  AMINCKSF = DP015-ERASE-EOF                           10482200
104823             MOVE ZEROES             TO ASC-MIN-CART-CKD-QTY-PS   10482300
104824         END-IF                                                   10482400
104825     END-IF.                                                      10482500
104826*                                                                 10482600
104827*HOW MANY DC'S TO CHECK                                           10482700
104828     IF  ADCCHKSL > ZERO                                          10482800
104829         MOVE ADCCHKSI               TO ASC-CKD-DC-QTY-PS         10482900
104830     ELSE                                                         10483000
104831         IF  ADCCHKSF = DP015-ERASE-EOF                           10483100
104832             MOVE ZEROES             TO ASC-CKD-DC-QTY-PS         10483200
104833         END-IF                                                   10483300
104834     END-IF.                                                      10483400
104835*                                                                 10483500
104836*RECHECK AFTER # OF DAYS                                          10483600
104837     IF  ACHKDYSL > ZERO                                          10483700
104838         MOVE ACHKDYSI               TO ASC-CK-AFT-DAY-QTY-PS     10483800
104839     ELSE                                                         10483900
104840         IF  ACHKDYSF = DP015-ERASE-EOF                           10484000
104841             MOVE ZEROES             TO ASC-CK-AFT-DAY-QTY-PS     10484100
104842         END-IF                                                   10484200
104843     END-IF.                                                      10484300
104844                                                                  10484400
      *SB 10/07/13 - BEGIN PR#5148D                                     10484500
104701**MOVE RFID SCREEN ENTRIES TO COMMAREA  **************************10484600
104710*PERCENT TO AUDIT                                                 10484700
104720     IF  APCAUDRL > ZERO                                          10484800
104730         MOVE APCAUDRI               TO ASC-AUD-PCT-RF-X          10484900
104740     ELSE                                                         10485000
104750          IF  APCAUDRF = DP015-ERASE-EOF                          10485100
104760              MOVE SPACES            TO ASC-AUD-PCT-RF-X          10485200
104770                                        APCAUDRO                  10485300
104780          END-IF                                                  10485400
104790     END-IF.                                                      10485500
104791                                                                  10485600
104808*                                                                 10485700
104809*MAX CARTONS CHECKED QUANTITY                                     10485800
104810     IF  AMAXCKRL > ZERO                                          10485900
104811         MOVE AMAXCKRI               TO ASC-MAX-CART-CKD-QTY-RF   10486000
104812     ELSE                                                         10486100
104813         IF  AMAXCKRF = DP015-ERASE-EOF                           10486200
104814             MOVE ZEROES             TO ASC-MAX-CART-CKD-QTY-RF   10486300
104815         END-IF                                                   10486400
104816     END-IF.                                                      10486500
104817*                                                                 10486600
104818*MIN CARTONS CHECKED QUANTITY                                     10486700
104819     IF  AMINCKRL > ZERO                                          10486800
104820         MOVE AMINCKRI               TO ASC-MIN-CART-CKD-QTY-RF   10486900
104821     ELSE                                                         10487000
104822         IF  AMINCKRF = DP015-ERASE-EOF                           10487100
104823             MOVE ZEROES             TO ASC-MIN-CART-CKD-QTY-RF   10487200
104824         END-IF                                                   10487300
104825     END-IF.                                                      10487400
104826*                                                                 10487500
104827*HOW MANY DC'S TO CHECK                                           10487600
104828     IF  ADCCHKRL > ZERO                                          10487700
104829         MOVE ADCCHKRI               TO ASC-CKD-DC-QTY-RF         10487800
104830     ELSE                                                         10487900
104831         IF  ADCCHKRF = DP015-ERASE-EOF                           10488000
104832             MOVE ZEROES             TO ASC-CKD-DC-QTY-RF         10488100
104833         END-IF                                                   10488200
104834     END-IF.                                                      10488300
104835*                                                                 10488400
104836*RECHECK AFTER # OF DAYS                                          10488500
104837     IF  ACHKDYRL > ZERO                                          10488600
104838         MOVE ACHKDYRI               TO ASC-CK-AFT-DAY-QTY-RF     10488700
104839     ELSE                                                         10488800
104840         IF  ACHKDYRF = DP015-ERASE-EOF                           10488900
104841             MOVE ZEROES             TO ASC-CK-AFT-DAY-QTY-RF     10489000
104842         END-IF                                                   10489100
104843     END-IF.                                                      10489200
      *SB 10/07/13 - END PR#5148D                                       10489300
104844                                                                  10489400
104850*----------------------------------------------------------------*10489500
104900* PERFORM EDITS ON EACH FIELD ENTERED BY THE USER.  IF AN ERROR  *10490000
105000* IS FOUND, THE CURSOR IS POSITIONED AT THAT FIELD AND AN        *10500000
105100* APPROPRIATE ERROR MESSAGE IS DISPLAYED.                        *10510000
105200*----------------------------------------------------------------*10520000
105300 3000-EDIT-DATA-IN-COMMAREA.                                      10530000
105310     IF ASC-RACF-AUTHORITY-FOUND                                  10531000
105402         PERFORM 3200-RESET-ATTRIBUTES                            10540200
105403                                                                  10540300
105404         IF PS-NO-ERROR                                           10540400
105405            IF ASC-VEND-RNK-CDE  > SPACES                         10540500
105406               IF ASC-VEND-RNK-DESC > SPACES                      10540600
105407                    CONTINUE                                      10540700
105408               ELSE                                               10540800
105409                  SET PS-ERROR                                    10540900
105410                      DP020-MSG-FATAL TO TRUE                     10541000
105411                  MOVE PC-TSYMSG-00007                            10541100
105412                                      TO DP020-MSG-NUMBER         10541200
105413                  MOVE DP015-UNP-ALP-BRT-OFF                      10541300
105414                                      TO ARNKDSCA                 10541400
105415                  MOVE DP015-RED      TO ARNKDSCC                 10541500
105416                  MOVE DP015-REVERSE  TO ARNKDSCH                 10541600
105417                  MOVE -1             TO ARNKDSCL                 10541700
105418                  SET DP030-SET-CURSOR-APPL-1                     10541800
105419                                      TO TRUE                     10541900
105420               END-IF                                             10542000
105421            ELSE                                                  10542100
105422               SET PS-ERROR                                       10542200
105423                   DP020-MSG-FATAL TO TRUE                        10542300
105424               MOVE PC-TSYMSG-00007                               10542400
105425                                   TO DP020-MSG-NUMBER            10542500
105426               MOVE DP015-UNP-ALP-BRT-OFF                         10542600
105427                                   TO ARANKA                      10542700
105428               MOVE DP015-RED      TO ARANKC                      10542800
105429               MOVE DP015-REVERSE  TO ARANKH                      10542900
105430               MOVE -1             TO ARANKL                      10543000
105431               SET DP030-SET-CURSOR-APPL-1                        10543100
105432                                   TO TRUE                        10543200
105433            END-IF                                                10543300
105434         END-IF                                                   10543400
105435                                                                  10543500
105436         IF PS-NO-ERROR                                           10543600
105437            IF (DP020-FK-PREV-SELECTION (DP020-SRC-AID) OR        10543700
105438                DP020-FK-NEXT-SELECTION (DP020-SRC-AID))          10543800
105439                  CONTINUE                                        10543900
105440            ELSE                                                  10544000
105441               IF ASC-ADD-UPD-BC  OR                              10544100
105442                  ASC-ADD-UPD-PP  OR                              10544200
105443                  ASC-ADD-UPD-PS  OR                              10544300
      *SB 10/07/13 - BEGIN PR#5148D                                     10544400
105443                  ASC-ADD-UPD-RF                                  10544500
      *SB 10/07/13 - END PR#5148D                                       10544600
105444                    CONTINUE                                      10544700
105445               ELSE                                               10544800
105446                   SET PS-ERROR                                   10544900
105447                       DP020-MSG-FATAL TO TRUE                    10545000
105448                   MOVE PC-TSYMSG-00308                           10545100
105449                                       TO DP020-MSG-NUMBER        10545200
105450                   MOVE DP015-UNP-ALP-BRT-OFF                     10545300
105451                                       TO ABCSELA                 10545400
105452                                          APPSELA                 10545500
105453                                          APSSELA                 10545600
      *SB 10/07/13 - BEGIN PR#5148D                                     10545700
105453                                          ARFSELA                 10545800
      *SB 10/07/13 - END PR#5148D                                       10545900
105454                   MOVE DP015-RED      TO ABCSELC                 10546000
105455                                          APPSELC                 10546100
105456                                          APSSELC                 10546200
      *SB 10/07/13 - BEGIN PR#5148D                                     10546300
105456                                          ARFSELC                 10546400
      *SB 10/07/13 - END PR#5148D                                       10546500
105457                   MOVE DP015-REVERSE  TO ABCSELH                 10546600
105458                                          APPSELH                 10546700
105459                                          APSSELH                 10546800
      *SB 10/07/13 - BEGIN PR#5148D                                     10546900
105459                                          ARFSELH                 10547000
      *SB 10/07/13 - END PR#5148D                                       10547100
105460                   MOVE -1             TO ABCSELL                 10547200
105461                   SET DP030-SET-CURSOR-APPL-1                    10547300
105462                                       TO TRUE                    10547400
105463               END-IF                                             10547500
105464            END-IF                                                10547600
105465         END-IF                                                   10547700
105466                                                                  10547800
105467         IF PS-NO-ERROR                                           10547900
105468            IF ASC-ADD-UPD-BC                                     10548000
105469               PERFORM 3205-NUMERIC-EDITS-BULK-CSPK               10548100
105470            END-IF                                                10548200
105471                                                                  10548300
105472            IF ASC-ADD-UPD-PP                                     10548400
105473               PERFORM 3210-NUMERIC-EDITS-PREPK                   10548500
105474            END-IF                                                10548600
105475                                                                  10548700
105476            IF ASC-ADD-UPD-PS                                     10548800
105480               PERFORM 3215-NUMERIC-EDITS-PBS                     10549000
105500            END-IF                                                10550000
105475                                                                  10551000
      *SB 10/07/13 - BEGIN PR#5148D                                     10551100
105476            IF ASC-ADD-UPD-RF                                     10552000
105480               PERFORM 3220-NUMERIC-EDITS-RFID                    10553000
105500            END-IF                                                10554000
      *SB 10/07/13 - END PR#5148D                                       10555000
105600         END-IF                                                   10560000
118700                                                                  11870000
123500                                                                  12350000
123600         IF DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)                12360000
123700             IF PS-NO-ERROR                                       12370000
123800               IF ASC-CONFIRM-FUNC-02                             12380000
123900                 CONTINUE                                         12390000
123910               ELSE                                               12391000
124000                  SET PS-ERROR                                    12400000
124110                      DP020-MSG-WARNING                           12411000
124120                      ASC-CONFIRM-FUNC-02 TO TRUE                 12412000
124200                  MOVE PC-TSYMSG-02847                            12420000
124300                                      TO DP020-MSG-NUMBER         12430000
124900                  SET DP030-SET-CURSOR-APPL-1                     12490000
125000                                      TO TRUE                     12500000
125100               END-IF                                             12510000
125110             END-IF                                               12511000
125200         END-IF                                                   12520000
125300     ELSE                                                         12530000
125400         PERFORM 3203-RESET-ATTRIBUTES-TO-VIEW                    12540000
125500     END-IF.                                                      12550000
142600*----------------------------------------------------------------*14260000
142700* CHECK TO SEE IF VEND RANK ENTERED EXISTS ON TABLE               14270000
142800*----------------------------------------------------------------*14280000
142900 3010-FIND-EXISTING-VEND-RNK.                                     14290000
142910                                                                  14291000
142920     MOVE ASC-VEND-RNK-CDE    TO    DK-VND-RNKG-CDE.              14292000
142930                                                                  14293000
142940         EXEC SQL                                                 14294000
142950             SELECT  PKGNG_TYP_CDE                                14295000
142960               INTO  :PV-PKG-TYP-CDE                              14296000
142970               FROM SUT_PO_AUD_PARM                               14297000
142980             WHERE  VND_RNKG_CDE     = :DK-VND-RNKG-CDE           14298000
142990         END-EXEC                                                 14299000
145610                                                                  14561000
145700         EVALUATE TRUE                                            14570000
145800             WHEN SQLCODE = +0                                    14580000
145810             WHEN SQLCODE = -811                                  14581000
145900                 SET ASC-VND-RNKG-EXISTS   TO TRUE                14590000
149500             WHEN SQLCODE = +100                                  14950000
149600             WHEN SQLCODE = -904                                  14960000
149700             WHEN SQLCODE = -913                                  14970000
149800                 SET ASC-VND-RNKG-NOT-EXISTS    TO TRUE           14980000
149900             WHEN SQLWARN0 NOT = SPACES                           14990000
150000             WHEN SQLCODE < +0                                    15000000
150100             WHEN SQLCODE > +0                                    15010000
150200                     MOVE '3010-FIND-EXISTING-VEND-RNK'           15020000
150300                                       TO DP013-PARAGRAPH         15030000
150400                     MOVE 'ERROR FINDING THE PARAMETER'           15040000
150500                                       TO DP013-MESSAGE-TEXT (1)  15050000
150600                     MOVE SQLCA        TO DP013-SQLCA             15060000
150700                     MOVE 'SUT_PO_AUD_PARM'                       15070000
150710                                       TO DP013-DB2-TABLE-NAME (1)15071000
150800                     SET DP013-DB2-ABEND                          15080000
150900                         DP013-XCTL-DISPLAY-RESTART TO TRUE       15090000
151000                     PERFORM DP013-0000-PROCESS-ABEND             15100000
151100         END-EVALUATE.                                            15110000
152800*                                                                 15280000
152900*                                                                 15290000
175400*                                                                 17540000
175500*----------------------------------------------------------------*17550000
175600* CHECK TO SEE IF VEND RANK ENTERED EXISTS ON TABLE               17560000
175700*----------------------------------------------------------------*17570000
175800 3020-SEL-EXISTING-RANK-DESC.                                     17580000
175900                                                                  17590000
176000     MOVE ASC-VEND-RNK-CDE    TO    DK-VND-RNKG-CDE.              17600000
176100                                                                  17610000
176200         EXEC SQL                                                 17620000
176300             SELECT  VND_RNKG_DESC                                17630000
176400               INTO  :SUT00016-VND-RNKG-DESC                      17640000
176500               FROM SUT_VND_RNKG_CDE                              17650000
176600             WHERE  VND_RNKG_CDE     = :DK-VND-RNKG-CDE           17660000
176700         END-EXEC                                                 17670000
176800                                                                  17680000
176900         EVALUATE TRUE                                            17690000
177000             WHEN SQLCODE = +0                                    17700000
177100                 CONTINUE                                         17710000
177300             WHEN SQLCODE = +100                                  17730000
177400             WHEN SQLCODE = -904                                  17740000
177500             WHEN SQLCODE = -913                                  17750000
177600                 SET ASC-VND-RNKG-NOT-EXISTS    TO TRUE           17760000
177700             WHEN SQLWARN0 NOT = SPACES                           17770000
177800             WHEN SQLCODE < +0                                    17780000
177900             WHEN SQLCODE > +0                                    17790000
178000                     MOVE '3010-FIND-EXISTING-VEND-RNK'           17800000
178100                                       TO DP013-PARAGRAPH         17810000
178200                     MOVE 'ERROR FINDING THE PARAMETER'           17820000
178300                                       TO DP013-MESSAGE-TEXT (1)  17830000
178400                     MOVE SQLCA        TO DP013-SQLCA             17840000
178500                     MOVE 'SUT_PO_AUD_PARM'                       17850000
178600                                       TO DP013-DB2-TABLE-NAME (1)17860000
178700                     SET DP013-DB2-ABEND                          17870000
178800                         DP013-XCTL-DISPLAY-RESTART TO TRUE       17880000
178900                     PERFORM DP013-0000-PROCESS-ABEND             17890000
179000         END-EVALUATE.                                            17900000
179100*                                                                 17910000
179200*                                                                 17920000
179300*                                                                 17930000
188900*----------------------------------------------------------------*18890000
189000* MOVE THE DEFAULT ATTRIBUTE VALUES TO THE ENTERABLE FIELDS ON   *18900000
189100* MAP.                                                           *18910000
189200*----------------------------------------------------------------*18920000
189300 3200-RESET-ATTRIBUTES.                                           18930000
189400     MOVE DP015-UNP-ALP-NOR-OFF    TO APCAUDBA                    18940000
189500                                      APCAUDPA                    18950000
189600                                      APCAUDSA                    18960000
      *SB 10/07/13 - BEGIN PR#5148D                                     18960100
189600                                      APCAUDRA                    18961000
      *SB 10/07/13 - END PR#5148D                                       18962000
189700                                      APCTOLBA                    18970000
189800                                      APCTOLPA                    18980000
189910                                      ANEXCDBA                    18991000
189920                                      ANEXCDPA                    18992000
189940                                      AMAXCKBA                    18994000
189950                                      AMAXCKPA                    18995000
189960                                      AMAXCKSA                    18996000
      *SB 10/07/13 - BEGIN PR#5148D                                     18996100
189960                                      AMAXCKRA                    18996200
      *SB 10/07/13 - END PR#5148D                                       18996300
189970                                      AMINCKBA                    18997000
189980                                      AMINCKPA                    18998000
189990                                      AMINCKSA                    18999000
      *SB 10/07/13 - BEGIN PR#5148D                                     18999100
189990                                      AMINCKRA                    18999200
      *SB 10/07/13 - END PR#5148D                                       18999300
189991                                      ADCCHKBA                    18999400
189992                                      ADCCHKPA                    18999500
189993                                      ADCCHKSA                    18999600
      *SB 10/07/13 - BEGIN PR#5148D                                     18999700
189993                                      ADCCHKRA                    18999800
      *SB 10/07/13 - END PR#5148D                                       18999900
189994                                      AMXPOLBA                    19000000
189997                                      ACHKDYBA                    19000100
189998                                      ACHKDYPA                    19000200
189999                                      ACHKDYSA                    19000300
      *SB 10/07/13 - BEGIN PR#5148D                                     19000400
189999                                      ACHKDYRA                    19000500
      *SB 10/07/13 - END PR#5148D                                       19000600
190000                                      ABCSELA                     19000700
190001                                      APPSELA                     19000800
190002                                      APSSELA                     19000900
      *SB 10/07/13 - BEGIN PR#5148D                                     19001000
190002                                      ARFSELA                     19001100
      *SB 10/07/13 - END PR#5148D                                       19001200
190003                                      ARNKDSCA.                   19001300
190010     MOVE DP015-GREEN              TO APCAUDBC                    19002000
190100                                      APCAUDPC                    19010000
190110                                      APCAUDSC                    19011000
      *SB 10/07/13 - BEGIN PR#5148D                                     19011100
190110                                      APCAUDRC                    19011200
      *SB 10/07/13 - END PR#5148D                                       19011300
190120                                      APCTOLBC                    19012000
190130                                      APCTOLPC                    19013000
190150                                      ANEXCDBC                    19015000
190160                                      ANEXCDPC                    19016000
190180                                      AMAXCKBC                    19018000
190190                                      AMAXCKPC                    19019000
190191                                      AMAXCKSC                    19019100
      *SB 10/07/13 - BEGIN PR#5148D                                     19019200
190191                                      AMAXCKRC                    19019300
      *SB 10/07/13 - END PR#5148D                                       19019400
190192                                      AMINCKBC                    19019500
190193                                      AMINCKPC                    19019600
190194                                      AMINCKSC                    19019700
      *SB 10/07/13 - BEGIN PR#5148D                                     19019800
190194                                      AMINCKRC                    19019900
      *SB 10/07/13 - END PR#5148D                                       19020000
190195                                      ADCCHKBC                    19020100
190196                                      ADCCHKPC                    19020200
190197                                      ADCCHKSC                    19020300
      *SB 10/07/13 - BEGIN PR#5148D                                     19020400
190197                                      ADCCHKRC                    19020500
      *SB 10/07/13 - END PR#5148D                                       19020600
190198                                      AMXPOLBC                    19020700
190201                                      ACHKDYBC                    19020800
190202                                      ACHKDYPC                    19020900
190203                                      ACHKDYSC                    19021000
      *SB 10/07/13 - BEGIN PR#5148D                                     19021100
190203                                      ACHKDYRC                    19021200
      *SB 10/07/13 - END PR#5148D                                       19021300
190204                                      ABCSELC                     19021400
190205                                      APPSELC                     19021500
190206                                      APSSELC                     19021600
      *SB 10/07/13 - BEGIN PR#5148D                                     19021700
190206                                      ARFSELC                     19021800
      *SB 10/07/13 - END PR#5148D                                       19021900
190207                                      ARNKDSCC.                   19022000
190208     MOVE DP015-UNDERLINE          TO APCAUDBH                    19022100
190209                                      APCAUDPH                    19022200
190210                                      APCAUDSH                    19022300
      *SB 10/07/13 - BEGIN PR#5148D                                     19022400
190210                                      APCAUDRH                    19022500
      *SB 10/07/13 - END PR#5148D                                       19022600
190211                                      APCTOLBH                    19022700
190212                                      APCTOLPH                    19022800
190213                                      ANEXCDBH                    19022900
190220                                      ANEXCDPH                    19023000
190240                                      AMAXCKBH                    19024000
190250                                      AMAXCKPH                    19025000
190260                                      AMAXCKSH                    19026000
      *SB 10/07/13 - BEGIN PR#5148D                                     19026100
190260                                      AMAXCKRH                    19026200
      *SB 10/07/13 - END PR#5148D                                       19026300
190270                                      AMINCKBH                    19027000
190280                                      AMINCKPH                    19028000
190290                                      AMINCKSH                    19029000
      *SB 10/07/13 - BEGIN PR#5148D                                     19029100
190290                                      AMINCKRH                    19029200
      *SB 10/07/13 - END PR#5148D                                       19029300
190300                                      ADCCHKBH                    19030000
190400                                      ADCCHKPH                    19040000
190500                                      ADCCHKSH                    19050000
      *SB 10/07/13 - BEGIN PR#5148D                                     19050100
190500                                      ADCCHKRH                    19051000
      *SB 10/07/13 - END PR#5148D                                       19052000
190600                                      AMXPOLBH                    19060000
190900                                      ACHKDYBH                    19090000
190910                                      ACHKDYPH                    19091000
190920                                      ACHKDYSH                    19092000
      *SB 10/07/13 - BEGIN PR#5148D                                     19092100
190920                                      ACHKDYRH                    19092200
      *SB 10/07/13 - END PR#5148D                                       19092300
190930                                      ABCSELH                     19093000
190940                                      APPSELH                     19094000
190950                                      APSSELH                     19095000
      *SB 10/07/13 - BEGIN PR#5148D                                     19095100
190950                                      ARFSELH                     19095200
      *SB 10/07/13 - END PR#5148D                                       19095300
190960                                      ARNKDSCH.                   19096000
191800     EVALUATE ASC-INT-APPL-FORMAT-IND                             19180000
191900         WHEN PC-INTER-APPL-CRIT-SPEC-ADD                         19190000
192000         WHEN PC-INTER-APPL-LIST-ADD                              19200000
192100            MOVE DP015-UNP-ALP-NOR-OFF    TO ARANKA               19210000
192200            MOVE DP015-GREEN              TO ARANKC               19220000
192300            MOVE DP015-UNDERLINE          TO ARANKH               19230000
192310            MOVE DP015-UNP-ALP-NOR-OFF    TO ARNKDSCA             19231000
192320            MOVE DP015-GREEN              TO ARNKDSCC             19232000
192330            MOVE DP015-UNDERLINE          TO ARNKDSCH             19233000
192400     END-EVALUATE.                                                19240000
192500*                                                                 19250000
192510*----------------------------------------------------------------*19251000
192520* IF THE ASSOCIATE DOES NOT HAVE RACF AUTHORITY, THE SCREEN FIELDS19252000
192530* WILL BE PROTECTED.                                             *19253000
192540*----------------------------------------------------------------*19254000
192550 3203-RESET-ATTRIBUTES-TO-VIEW.                                   19255000
192560     MOVE DP015-ASK-NOR-OFF        TO APCAUDBA                    19256000
192570                                      APCAUDPA                    19257000
192580                                      APCAUDSA                    19258000
192580                                      APCAUDRA                    19258100
192590                                      APCTOLBA                    19259000
192591                                      APCTOLPA                    19259100
192592                                      ANEXCDBA                    19259200
192593                                      ANEXCDPA                    19259300
192594                                      AMAXCKBA                    19259400
192595                                      AMAXCKPA                    19259500
192596                                      AMAXCKSA                    19259600
192596                                      AMAXCKRA                    19259700
192597                                      AMINCKBA                    19259800
192598                                      AMINCKPA                    19259900
192599                                      AMINCKSA                    19260000
192599                                      AMINCKRA                    19260100
192600                                      ADCCHKBA                    19260200
192601                                      ADCCHKPA                    19260300
192602                                      ADCCHKSA                    19260400
192602                                      ADCCHKRA                    19260500
192603                                      AMXPOLBA                    19260600
192604                                      ACHKDYBA                    19260700
192605                                      ACHKDYPA                    19260800
192606                                      ACHKDYSA                    19260900
192606                                      ACHKDYRA                    19261000
192607                                      ABCSELA                     19261100
192608                                      APPSELA                     19261200
192609                                      APSSELA                     19261300
192609                                      ARFSELA                     19261400
192610                                      ARNKDSCA.                   19261500
192611     MOVE DP015-BLUE               TO APCAUDBC                    19261600
192612                                      APCAUDPC                    19261700
192613                                      APCAUDSC                    19261800
192613                                      APCAUDRC                    19261900
192614                                      APCTOLBC                    19262000
192615                                      APCTOLPC                    19262100
192616                                      ANEXCDBC                    19262200
192617                                      ANEXCDPC                    19262300
192618                                      AMAXCKBC                    19262400
192619                                      AMAXCKPC                    19262500
192620                                      AMAXCKSC                    19262600
192620                                      AMAXCKRC                    19262700
192621                                      AMINCKBC                    19262800
192622                                      AMINCKPC                    19262900
192623                                      AMINCKSC                    19263000
192623                                      AMINCKRC                    19263100
192624                                      ADCCHKBC                    19263200
192625                                      ADCCHKPC                    19263300
192626                                      ADCCHKSC                    19263400
192626                                      ADCCHKRC                    19263500
192627                                      AMXPOLBC                    19263600
192628                                      ACHKDYBC                    19263700
192629                                      ACHKDYPC                    19263800
192630                                      ACHKDYSC                    19263900
192630                                      ACHKDYRC                    19264000
192631                                      ABCSELC                     19264100
192632                                      APPSELC                     19264200
192633                                      APSSELC                     19264300
192633                                      ARFSELC                     19264400
192634                                      ARNKDSCC.                   19264500
192635     MOVE DP015-UNDERLINE          TO APCAUDBH                    19264600
192636                                      APCAUDPH                    19264700
192637                                      APCAUDSH                    19264800
192637                                      APCAUDRH                    19264900
192638                                      APCTOLBH                    19265000
192639                                      APCTOLPH                    19265100
192640                                      ANEXCDBH                    19265200
192641                                      ANEXCDPH                    19265300
192642                                      AMAXCKBH                    19265400
192643                                      AMAXCKPH                    19265500
192644                                      AMAXCKSH                    19265600
192644                                      AMAXCKRH                    19265700
192645                                      AMINCKBH                    19265800
192646                                      AMINCKPH                    19265900
192647                                      AMINCKSH                    19266000
192647                                      AMINCKRH                    19266100
192648                                      ADCCHKBH                    19266200
192649                                      ADCCHKPH                    19266300
192650                                      ADCCHKSH                    19266400
192650                                      ADCCHKRH                    19266500
192651                                      AMXPOLBH                    19266600
192652                                      ACHKDYBH                    19266700
192653                                      ACHKDYPH                    19266800
192654                                      ACHKDYSH                    19266900
192654                                      ACHKDYRH                    19267000
192655                                      ABCSELH                     19267100
192656                                      APPSELH                     19267200
192657                                      APSSELH                     19267300
192657                                      ARFSELH                     19267400
192658                                      ARNKDSCH.                   19267500
192669*                                                                 19267600
192670*                                                                 19267700
192671 3205-NUMERIC-EDITS-BULK-CSPK.                                    19267800
192672*BULK/CASE SELECTION                                              19267900
192673     IF  ASC-VALID-SELECT-BC = PC-S                               19268000
192674         SET PS-PCT-TO-AUD-ZERO-NO TO TRUE                        19268100
192675     ELSE                                                         19268200
192676         SET PS-ERROR                                             19268300
192677             DP020-MSG-FATAL TO TRUE                              19268400
192678         MOVE PC-TSYMSG-00005                                     19268500
192679                             TO DP020-MSG-NUMBER                  19268600
192680         MOVE DP015-UNP-ALP-BRT-OFF                               19268700
192681                             TO ABCSELA                           19268800
192682         MOVE DP015-RED      TO ABCSELC                           19268900
192683         MOVE DP015-REVERSE  TO ABCSELH                           19269000
192684         MOVE -1             TO ABCSELL                           19269100
192685         SET DP030-SET-CURSOR-APPL-1                              19269200
192686                             TO TRUE                              19269300
192687     END-IF                                                       19269400
192688*                                                                 19269500
192689*    DETERMINE IF THERE IS A DECIMAL POINT OR NOT, AND VALIDATE   19269600
192690*    NUMERIC ACCORDINGLY                                          19269700
192691     MOVE +0                      TO PV-DECIMAL-COUNT.            19269800
192692     INSPECT ASC-AUD-PCT-BC-X TALLYING PV-DECIMAL-COUNT           19269900
192693            FOR ALL '.'.                                          19270000
192694                                                                  19270100
192695*    CHECK TO MAKE SURE THE RETAIL IS NUMERIC                     19270200
192696     INITIALIZE DP010I-NUMERIC-EDIT-AREA.                         19270300
192697     MOVE ASC-AUD-PCT-BC-X        TO DP010I-UNEDITED-FIELD.       19270400
192698                                                                  19270500
192699*    IF THERE IS A DECIMAL POINT, VALIDATE FOR 2 DECIMALS         19270600
192700     IF PV-DECIMAL-COUNT > 0                                      19270700
192701         MOVE 4                   TO DP010I-MAXIMUM-DIGITS        19270800
192702         MOVE 2                   TO DP010I-MAXIMUM-DECIMALS      19270900
192703     ELSE                                                         19271000
192704         MOVE 6                   TO DP010I-MAXIMUM-DIGITS        19271100
192705         MOVE 0                   TO DP010I-MAXIMUM-DECIMALS      19271200
192706     END-IF.                                                      19271300
192707                                                                  19271400
192708     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     19271500
192709                                                                  19271600
263968     CALL DP010I-NUMERIC-EDIT-ROUTINE                             19271899
263968          USING DP010I-NUMERIC-EDIT-AREA.                         19271999
192711                                                                  19272000
192712     IF  DP010I-ERROR-DETECTED                                    19272100
192713         SET PS-ERROR                                             19272200
192714             DP020-MSG-FATAL TO TRUE                              19272300
192715         MOVE PC-TSYMSG-00008                                     19272400
192716                             TO DP020-MSG-NUMBER                  19272500
192717         MOVE DP015-UNP-ALP-BRT-OFF                               19272600
192718                             TO APCAUDBA                          19272700
192719         MOVE DP015-RED      TO APCAUDBC                          19272800
192720         MOVE DP015-REVERSE  TO APCAUDBH                          19272900
192721         MOVE -1             TO APCAUDBL                          19273000
192722         SET DP030-SET-CURSOR-APPL-1                              19273100
192723                             TO TRUE                              19273200
192724     ELSE                                                         19273300
192725         MOVE DP010I-NUMERIC-FIELD  TO ASC-AUD-PCT-BC             19273400
192726         MOVE ASC-AUD-PCT-BC-X          TO APCAUDBO               19273500
192727         IF PS-NO-ERROR                                           19273600
192728           IF  DP010I-NUMERIC-FIELD  = 0                          19273700
192729               SET PS-PCT-TO-AUD-ZERO-YES TO TRUE                 19273800
192730           ELSE                                                   19273900
192731              IF  DP010I-NUMERIC-FIELD  > 0                       19274000
192732                  IF  DP010I-NUMERIC-FIELD  > 100                 19274100
192733                      SET PS-ERROR                                19274200
192734                          DP020-MSG-FATAL TO TRUE                 19274300
192735                      MOVE PC-TSYMSG-00005                        19274400
192736                                          TO DP020-MSG-NUMBER     19274500
192737                      MOVE DP015-UNP-ALP-BRT-OFF                  19274600
192738                                          TO APCAUDBA             19274700
192739                      MOVE DP015-RED      TO APCAUDBC             19274800
192740                      MOVE DP015-REVERSE  TO APCAUDBH             19274900
192741                      MOVE -1             TO APCAUDBL             19275000
192742                      SET DP030-SET-CURSOR-APPL-1                 19275100
192743                                          TO TRUE                 19275200
192744                 END-IF                                           19275300
192745              ELSE                                                19275400
192746                 SET PS-ERROR                                     19275500
192747                     DP020-MSG-FATAL TO TRUE                      19275600
192748                 MOVE PC-TSYMSG-00342                             19275700
192749                                     TO DP020-MSG-NUMBER          19275800
192750                 MOVE DP015-UNP-ALP-BRT-OFF                       19275900
192751                                     TO APCAUDBA                  19276000
192752                 MOVE DP015-RED      TO APCAUDBC                  19276100
192753                 MOVE DP015-REVERSE  TO APCAUDBH                  19276200
192754                 MOVE -1             TO APCAUDBL                  19276300
192755                 SET DP030-SET-CURSOR-APPL-1                      19276400
192756                                     TO TRUE                      19276500
192757              END-IF                                              19276600
192758           END-IF                                                 19276700
192759         END-IF                                                   19276800
192760     END-IF.                                                      19276900
192761                                                                  19277000
192762**CHECK PERCENT TOLERANCE ****************************************19277100
192763                                                                  19277200
192764     MOVE +0                      TO PV-DECIMAL-COUNT.            19277300
192765     INSPECT ASC-CKD-PCT-BC-X TALLYING PV-DECIMAL-COUNT           19277400
192766            FOR ALL '.'.                                          19277500
192767                                                                  19277600
192768*    CHECK TO MAKE SURE THE RETAIL IS NUMERIC                     19277700
192769     INITIALIZE DP010I-NUMERIC-EDIT-AREA.                         19277800
192770     MOVE ASC-CKD-PCT-BC-X        TO DP010I-UNEDITED-FIELD.       19277900
192771                                                                  19278000
192772*    IF THERE IS A DECIMAL POINT, VALIDATE FOR 2 DECIMALS         19278100
192773     IF PV-DECIMAL-COUNT > 0                                      19278200
192774         MOVE 4                   TO DP010I-MAXIMUM-DIGITS        19278300
192775         MOVE 2                   TO DP010I-MAXIMUM-DECIMALS      19278400
192776     ELSE                                                         19278500
192777         MOVE 6                   TO DP010I-MAXIMUM-DIGITS        19278600
192778         MOVE 0                   TO DP010I-MAXIMUM-DECIMALS      19278700
192779     END-IF.                                                      19278800
192780                                                                  19278900
192781     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     19279000
192782                                                                  19279100
263968     CALL DP010I-NUMERIC-EDIT-ROUTINE                             19279399
263968          USING DP010I-NUMERIC-EDIT-AREA.                         19279499
192784                                                                  19279500
192785     IF  DP010I-ERROR-DETECTED                                    19279600
192786         SET PS-ERROR                                             19279700
192787             DP020-MSG-FATAL TO TRUE                              19279800
192788         MOVE PC-TSYMSG-00008                                     19279900
192789                             TO DP020-MSG-NUMBER                  19280000
192790         MOVE DP015-UNP-ALP-BRT-OFF                               19280100
192791                             TO APCTOLBA                          19280200
192792         MOVE DP015-RED      TO APCTOLBC                          19280300
192793         MOVE DP015-REVERSE  TO APCTOLBH                          19280400
192794         MOVE -1             TO APCTOLBL                          19280500
192795         SET DP030-SET-CURSOR-APPL-1                              19280600
192796                             TO TRUE                              19280700
192797     ELSE                                                         19280800
192798         MOVE DP010I-NUMERIC-FIELD  TO ASC-CKD-PCT-BC             19280900
192799                                                                  19281000
192800         IF  DP010I-NUMERIC-FIELD  > 100                          19281100
192801              SET PS-ERROR                                        19281200
192802                  DP020-MSG-FATAL TO TRUE                         19281300
192803              MOVE PC-TSYMSG-00005                                19281400
192804                                  TO DP020-MSG-NUMBER             19281500
192805              MOVE DP015-UNP-ALP-BRT-OFF                          19281600
192806                                  TO APCTOLBA                     19281700
192807              MOVE DP015-RED      TO APCTOLBC                     19281800
192808              MOVE DP015-REVERSE  TO APCTOLBH                     19281900
192809              MOVE -1             TO APCTOLBL                     19282000
192810              SET DP030-SET-CURSOR-APPL-1                         19282100
192811                                  TO TRUE                         19282200
192812         END-IF                                                   19282300
192813         MOVE ASC-CKD-PCT-BC-X          TO APCTOLBO               19282400
192814     END-IF.                                                      19282500
192815                                                                  19282600
192816*NOT TO EXCEED QUANTITY                                           19282700
192817     IF  ASC-MAX-CKD-QTY-BC   NOT  = SPACES                       19282800
192818         MOVE ASC-MAX-CKD-QTY-BC       TO DP010I-UNEDITED-FIELD   19282900
192819         MOVE LENGTH OF ASC-MAX-CKD-QTY-BC                        19283000
192820                                       TO DP010I-MAXIMUM-DIGITS   19283100
192821         MOVE ZERO                     TO DP010I-MAXIMUM-DECIMALS 19283200
192822         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  19283300
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         19283599
263968              USING DP010I-NUMERIC-EDIT-AREA                      19283699
192824*                                                                 19283700
192825         IF  DP010I-ERROR-DETECTED                                19283800
192826             SET PS-ERROR                                         19283900
192827                 DP020-MSG-FATAL TO TRUE                          19284000
192828             MOVE PC-TSYMSG-00008                                 19284100
192829                                 TO DP020-MSG-NUMBER              19284200
192830             MOVE DP015-UNP-ALP-BRT-OFF                           19284300
192831                                 TO ANEXCDBA                      19284400
192832             MOVE DP015-RED      TO ANEXCDBC                      19284500
192833             MOVE DP015-REVERSE  TO ANEXCDBH                      19284600
192834             MOVE -1             TO ANEXCDBL                      19284700
192835             SET DP030-SET-CURSOR-APPL-1                          19284800
192836                                 TO TRUE                          19284900
192837         ELSE                                                     19285000
192838           IF DP010I-NUMERIC-FIELD NOT > 0                        19285100
192839               SET PS-ERROR                                       19285200
192840                   DP020-MSG-FATAL TO TRUE                        19285300
192841               MOVE PC-TSYMSG-00342                               19285400
192842                                   TO DP020-MSG-NUMBER            19285500
192843               MOVE DP015-UNP-ALP-BRT-OFF                         19285600
192844                                   TO ANEXCDBA                    19285700
192845               MOVE DP015-RED      TO ANEXCDBC                    19285800
192846               MOVE DP015-REVERSE  TO ANEXCDBH                    19285900
192847               MOVE -1             TO ANEXCDBL                    19286000
192848               SET DP030-SET-CURSOR-APPL-1                        19286100
192849                                   TO TRUE                        19286200
192850           ELSE                                                   19286300
192851               MOVE DP010I-NUMERIC-FIELD TO  ASC-MAX-CKD-QTY-BC-N 19286400
192852               MOVE ASC-MAX-CKD-QTY-BC   TO  ANEXCDBO             19286500
192853           END-IF                                                 19286600
192854         END-IF.                                                  19286700
192855*                                                                 19286800
192856*MAXIMUM CARTONS CHECKED QTY                                      19286900
192857     IF  ASC-MAX-CART-CKD-QTY-BC  NOT = SPACES                    19287000
192858         MOVE ASC-MAX-CART-CKD-QTY-BC  TO DP010I-UNEDITED-FIELD   19287100
192859         MOVE LENGTH OF ASC-MAX-CART-CKD-QTY-BC                   19287200
192860                                       TO DP010I-MAXIMUM-DIGITS   19287300
192861         MOVE ZERO                     TO DP010I-MAXIMUM-DECIMALS 19287400
192862         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  19287500
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         19287799
263968              USING DP010I-NUMERIC-EDIT-AREA                      19287899
192864*                                                                 19287900
192865         IF  DP010I-ERROR-DETECTED                                19288000
192866             SET PS-ERROR                                         19288100
192867                 DP020-MSG-FATAL TO TRUE                          19288200
192868             MOVE PC-TSYMSG-00008                                 19288300
192869                                 TO DP020-MSG-NUMBER              19288400
192870             MOVE DP015-UNP-ALP-BRT-OFF                           19288500
192871                                 TO AMAXCKBA                      19288600
192872             MOVE DP015-RED      TO AMAXCKBC                      19288700
192873             MOVE DP015-REVERSE  TO AMAXCKBH                      19288800
192874             MOVE -1             TO AMAXCKBL                      19288900
192875             SET DP030-SET-CURSOR-APPL-1                          19289000
192876                                 TO TRUE                          19289100
192877         ELSE                                                     19289200
192878           IF PS-PCT-TO-AUD-ZERO-NO                               19289300
192879               IF DP010I-NUMERIC-FIELD NOT > 0                    19289400
192880                   SET PS-ERROR                                   19289500
192881                       DP020-MSG-FATAL TO TRUE                    19289600
192882                   MOVE PC-TSYMSG-00342                           19289700
192883                                       TO DP020-MSG-NUMBER        19289800
192884                   MOVE DP015-UNP-ALP-BRT-OFF                     19289900
192885                                       TO AMAXCKBA                19290000
192886                   MOVE DP015-RED      TO AMAXCKBC                19290100
192887                   MOVE DP015-REVERSE  TO AMAXCKBH                19290200
192888                   MOVE -1             TO AMAXCKBL                19290300
192889                   SET DP030-SET-CURSOR-APPL-1                    19290400
192890                                       TO TRUE                    19290500
192891               ELSE                                               19290600
192892                   MOVE DP010I-NUMERIC-FIELD TO                   19290700
192893                                     ASC-MAX-CART-CKD-QTY-BC-N    19290800
192894                   MOVE ASC-MAX-CART-CKD-QTY-BC TO  AMAXCKBO      19290900
192895               END-IF                                             19291000
192896           ELSE                                                   19291100
192897              IF DP010I-NUMERIC-FIELD NOT = 0                     19291200
192898                 SET PS-ERROR                                     19291300
192899                     DP020-MSG-FATAL TO TRUE                      19291400
192900                 MOVE PC-TSYMSG-02889                             19291500
192901                                     TO DP020-MSG-NUMBER          19291600
192902*                                                                 19291700
192903                 MOVE DP015-UNP-ALP-BRT-OFF                       19291800
192904                                     TO AMAXCKBA                  19291900
192905                 MOVE DP015-RED      TO AMAXCKBC                  19292000
192906                 MOVE DP015-REVERSE  TO AMAXCKBH                  19292100
192907                 MOVE -1             TO AMAXCKBL                  19292200
192908*                                                                 19292300
192909                 MOVE DP015-UNP-ALP-BRT-OFF                       19292400
192910                                     TO AMINCKBA                  19292500
192911                 MOVE DP015-RED      TO AMINCKBC                  19292600
192912                 MOVE DP015-REVERSE  TO AMINCKBH                  19292700
192913*                                                                 19292800
192914                 MOVE DP015-UNP-ALP-BRT-OFF                       19292900
192915                                     TO APCAUDBA                  19293000
192916                 MOVE DP015-RED      TO APCAUDBC                  19293100
192917                 MOVE DP015-REVERSE  TO APCAUDBH                  19293200
192918                 SET DP030-SET-CURSOR-APPL-1                      19293300
192919                                     TO TRUE                      19293400
192920              ELSE                                                19293500
192921                   MOVE DP010I-NUMERIC-FIELD TO                   19293600
192922                                     ASC-MAX-CART-CKD-QTY-BC-N    19293700
192923                   MOVE ASC-MAX-CART-CKD-QTY-BC TO  AMAXCKBO      19293800
192924              END-IF                                              19293900
192925           END-IF                                                 19294000
192926         END-IF                                                   19294100
192927     END-IF.                                                      19294200
192928*                                                                 19294300
192929*MINIMUM CARTONS CHECKED QTY                                      19294400
192930     IF  PS-NO-ERROR                                              19294500
192931       IF  ASC-MIN-CART-CKD-QTY-BC  NOT = SPACES                  19294600
192932           MOVE ASC-MIN-CART-CKD-QTY-BC  TO DP010I-UNEDITED-FIELD 19294700
192933           MOVE LENGTH OF ASC-MIN-CART-CKD-QTY-BC                 19294800
192934                                 TO DP010I-MAXIMUM-DIGITS         19294900
192935           MOVE ZERO             TO DP010I-MAXIMUM-DECIMALS       19295000
192936           SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                19295100
263968           CALL DP010I-NUMERIC-EDIT-ROUTINE                       19295399
263968                USING DP010I-NUMERIC-EDIT-AREA                    19295499
192938*                                                                 19295500
192939           IF  DP010I-ERROR-DETECTED                              19295600
192940               SET PS-ERROR                                       19295700
192941                   DP020-MSG-FATAL TO TRUE                        19295800
192942               MOVE PC-TSYMSG-00008                               19295900
192943                                   TO DP020-MSG-NUMBER            19296000
192944               MOVE DP015-UNP-ALP-BRT-OFF                         19296100
192945                                   TO AMINCKBA                    19296200
192946               MOVE DP015-RED      TO AMINCKBC                    19296300
192947               MOVE DP015-REVERSE  TO AMINCKBH                    19296400
192948               MOVE -1             TO AMINCKBL                    19296500
192949               SET DP030-SET-CURSOR-APPL-1                        19296600
192950                                   TO TRUE                        19296700
192951           ELSE                                                   19296800
192952             IF PS-PCT-TO-AUD-ZERO-NO                             19296900
192953                 IF DP010I-NUMERIC-FIELD NOT > 0                  19297000
192954                     SET PS-ERROR                                 19297100
192955                         DP020-MSG-FATAL TO TRUE                  19297200
192956                     MOVE PC-TSYMSG-00342                         19297300
192957                                         TO DP020-MSG-NUMBER      19297400
192958                     MOVE DP015-UNP-ALP-BRT-OFF                   19297500
192959                                         TO AMINCKBA              19297600
192960                     MOVE DP015-RED      TO AMINCKBC              19297700
192961                     MOVE DP015-REVERSE  TO AMINCKBH              19297800
192962                     MOVE -1             TO AMINCKBL              19297900
192963                     SET DP030-SET-CURSOR-APPL-1                  19298000
192964                                         TO TRUE                  19298100
192965                 ELSE                                             19298200
192966                     MOVE DP010I-NUMERIC-FIELD TO                 19298300
192967                                       ASC-MIN-CART-CKD-QTY-BC-N  19298400
192968                     MOVE ASC-MIN-CART-CKD-QTY-BC TO  AMINCKBO    19298500
192969                 END-IF                                           19298600
192970             ELSE                                                 19298700
192971              IF DP010I-NUMERIC-FIELD NOT = 0                     19298800
192972                 SET PS-ERROR                                     19298900
192973                     DP020-MSG-FATAL TO TRUE                      19299000
192974                 MOVE PC-TSYMSG-02889                             19299100
192975                                     TO DP020-MSG-NUMBER          19299200
192976*                                                                 19299300
192977                 MOVE DP015-UNP-ALP-BRT-OFF                       19299400
192978                                     TO AMINCKBA                  19299500
192979                 MOVE DP015-RED      TO AMINCKBC                  19299600
192980                 MOVE DP015-REVERSE  TO AMINCKBH                  19299700
192981                 MOVE -1             TO AMINCKBL                  19299800
192982*                                                                 19299900
192983                 MOVE DP015-UNP-ALP-BRT-OFF                       19300000
192984                                     TO AMAXCKBA                  19300100
192985                 MOVE DP015-RED      TO AMAXCKBC                  19300200
192986                 MOVE DP015-REVERSE  TO AMAXCKBH                  19300300
192987*                                                                 19300400
192988                 MOVE DP015-UNP-ALP-BRT-OFF                       19300500
192989                                     TO APCAUDBA                  19300600
192990                 MOVE DP015-RED      TO APCAUDBC                  19300700
192991                 MOVE DP015-REVERSE  TO APCAUDBH                  19300800
192992                 SET DP030-SET-CURSOR-APPL-1                      19300900
192993                                     TO TRUE                      19301000
192994              ELSE                                                19301100
192995                     MOVE DP010I-NUMERIC-FIELD TO                 19301200
192996                                       ASC-MIN-CART-CKD-QTY-BC-N  19301300
192997                     MOVE ASC-MIN-CART-CKD-QTY-BC TO  AMINCKBO    19301400
192998              END-IF                                              19301500
192999             END-IF                                               19301600
193000           END-IF                                                 19301700
193001       END-IF                                                     19301800
193002     END-IF.                                                      19301900
193003* HOW MANY DC'S TO CHECK                                          19302000
193004     IF  PS-NO-ERROR                                              19302100
193005       IF  ASC-CKD-DC-QTY-BC    NOT = SPACES                      19302200
193006           MOVE ASC-CKD-DC-QTY-BC     TO DP010I-UNEDITED-FIELD    19302300
193007           MOVE LENGTH OF ASC-CKD-DC-QTY-BC                       19302400
193008                                      TO DP010I-MAXIMUM-DIGITS    19302500
193009           MOVE ZERO                  TO DP010I-MAXIMUM-DECIMALS  19302600
193010           SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                19302700
263968           CALL DP010I-NUMERIC-EDIT-ROUTINE                       19302999
263968                USING DP010I-NUMERIC-EDIT-AREA                    19303099
193012**                                                                19303100
193013           IF  DP010I-ERROR-DETECTED                              19303200
193014               SET PS-ERROR                                       19303300
193015                   DP020-MSG-FATAL TO TRUE                        19303400
193016               MOVE PC-TSYMSG-00008                               19303500
193017                                   TO DP020-MSG-NUMBER            19303600
193018               MOVE DP015-UNP-ALP-BRT-OFF                         19303700
193019                                   TO ADCCHKBA                    19303800
193020               MOVE DP015-RED      TO ADCCHKBC                    19303900
193021               MOVE DP015-REVERSE  TO ADCCHKBH                    19304000
193022               MOVE -1             TO ADCCHKBL                    19304100
193023               SET DP030-SET-CURSOR-APPL-1                        19304200
193024                                   TO TRUE                        19304300
193025           ELSE                                                   19304400
193026             IF DP010I-NUMERIC-FIELD NOT > 0                      19304500
193027                 SET PS-ERROR                                     19304600
193028                     DP020-MSG-FATAL TO TRUE                      19304700
193029                 MOVE PC-TSYMSG-00342                             19304800
193030                                     TO DP020-MSG-NUMBER          19304900
193031                 MOVE DP015-UNP-ALP-BRT-OFF                       19305000
193032                                     TO ADCCHKBA                  19305100
193033                 MOVE DP015-RED      TO ADCCHKBC                  19305200
193034                 MOVE DP015-REVERSE  TO ADCCHKBH                  19305300
193035                 MOVE -1             TO ADCCHKBL                  19305400
193036                 SET DP030-SET-CURSOR-APPL-1                      19305500
193037                                     TO TRUE                      19305600
193038             ELSE                                                 19305700
193039               MOVE DP010I-NUMERIC-FIELD TO  ASC-CKD-DC-QTY-BC-N  19305800
193040               MOVE ASC-CKD-DC-QTY-BC    TO  ADCCHKBO             19305900
193041             END-IF                                               19306000
193042           END-IF                                                 19306100
193043     END-IF.                                                      19306200
193044*                                                                 19306300
193045*                                                                 19306400
193046     IF  PS-NO-ERROR                                              19306500
193047      IF  ASC-MAX-PO-LNE-QTY-BC   NOT = SPACES                    19306600
193048          MOVE ASC-MAX-PO-LNE-QTY-BC TO DP010I-UNEDITED-FIELD     19306700
193049          MOVE LENGTH OF ASC-MAX-PO-LNE-QTY-BC                    19306800
193050                                     TO DP010I-MAXIMUM-DIGITS     19306900
193051          MOVE ZERO                  TO DP010I-MAXIMUM-DECIMALS   19307000
193052          SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                 19307100
263968          CALL DP010I-NUMERIC-EDIT-ROUTINE                        19307399
263968               USING DP010I-NUMERIC-EDIT-AREA                     19307499
193054**                                                                19307500
193055          IF  DP010I-ERROR-DETECTED                               19307600
193056              SET PS-ERROR                                        19307700
193057                  DP020-MSG-FATAL TO TRUE                         19307800
193058              MOVE PC-TSYMSG-00008                                19307900
193059                                  TO DP020-MSG-NUMBER             19308000
193060              MOVE DP015-UNP-ALP-BRT-OFF                          19308100
193061                                  TO AMXPOLBA                     19308200
193062              MOVE DP015-RED      TO AMXPOLBC                     19308300
193063              MOVE DP015-REVERSE  TO AMXPOLBH                     19308400
193064              MOVE -1             TO AMXPOLBL                     19308500
193065              SET DP030-SET-CURSOR-APPL-1                         19308600
193066                                  TO TRUE                         19308700
193067          ELSE                                                    19308800
193068            IF DP010I-NUMERIC-FIELD NOT > 0                       19308900
193069                SET PS-ERROR                                      19309000
193070                    DP020-MSG-FATAL TO TRUE                       19309100
193071                MOVE PC-TSYMSG-00342                              19309200
193072                                    TO DP020-MSG-NUMBER           19309300
193073                MOVE DP015-UNP-ALP-BRT-OFF                        19309400
193074                                    TO AMXPOLBA                   19309500
193075                MOVE DP015-RED      TO AMXPOLBC                   19309600
193076                MOVE DP015-REVERSE  TO AMXPOLBH                   19309700
193077                MOVE -1             TO AMXPOLBL                   19309800
193078                SET DP030-SET-CURSOR-APPL-1                       19309900
193079                                    TO TRUE                       19310000
193080            ELSE                                                  19310100
193081                MOVE DP010I-NUMERIC-FIELD                         19310200
193082                                   TO  ASC-MAX-PO-LNE-QTY-BC-N    19310300
193083                MOVE ASC-MAX-PO-LNE-QTY-BC TO AMXPOLBO            19310400
193084            END-IF                                                19310500
193085          END-IF                                                  19310600
193086     END-IF.                                                      19310700
193087                                                                  19310800
193088* RECHECK AFTER # OF DAYS                                         19310900
193089     IF  PS-NO-ERROR                                              19311000
193090       IF  ASC-CK-AFT-DAY-QTY-BC   NOT = SPACES                   19311100
193091           MOVE ASC-CK-AFT-DAY-QTY-BC  TO DP010I-UNEDITED-FIELD   19311200
193092           MOVE LENGTH OF ASC-CK-AFT-DAY-QTY-BC                   19311300
193093                                       TO DP010I-MAXIMUM-DIGITS   19311400
193094           MOVE ZERO                   TO DP010I-MAXIMUM-DECIMALS 19311500
193095           SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                19311600
263968           CALL DP010I-NUMERIC-EDIT-ROUTINE                       19311899
263968                USING DP010I-NUMERIC-EDIT-AREA                    19311999
193097*                                                                 19312000
193098           IF  DP010I-ERROR-DETECTED                              19312100
193099               SET PS-ERROR                                       19312200
193100                   DP020-MSG-FATAL TO TRUE                        19312300
193101               MOVE PC-TSYMSG-00008                               19312400
193102                                   TO DP020-MSG-NUMBER            19312500
193103               MOVE DP015-UNP-ALP-BRT-OFF                         19312600
193104                                   TO ACHKDYBA                    19312700
193105               MOVE DP015-RED      TO ACHKDYBC                    19312800
193106               MOVE DP015-REVERSE  TO ACHKDYBH                    19312900
193107               MOVE -1             TO ACHKDYBL                    19313000
193108               SET DP030-SET-CURSOR-APPL-1                        19313100
193109                                   TO TRUE                        19313200
193110           ELSE                                                   19313300
193111             IF DP010I-NUMERIC-FIELD NOT > 0                      19313400
193112                 SET PS-ERROR                                     19313500
193113                     DP020-MSG-FATAL TO TRUE                      19313600
193114                 MOVE PC-TSYMSG-00342                             19313700
193115                                     TO DP020-MSG-NUMBER          19313800
193116                 MOVE DP015-UNP-ALP-BRT-OFF                       19313900
193117                                     TO ACHKDYBA                  19314000
193118                 MOVE DP015-RED      TO ACHKDYBC                  19314100
193119                 MOVE DP015-REVERSE  TO ACHKDYBH                  19314200
193120                 MOVE -1             TO ACHKDYBL                  19314300
193121                 SET DP030-SET-CURSOR-APPL-1                      19314400
193122                                     TO TRUE                      19314500
193123             ELSE                                                 19314600
193124                 MOVE DP010I-NUMERIC-FIELD TO                     19314700
193125                                         ASC-CK-AFT-DAY-QTY-BC-N  19314800
193126                 MOVE ASC-CK-AFT-DAY-QTY-BC TO ACHKDYBO           19314900
193127             END-IF                                               19315000
193128           END-IF                                                 19315100
193129     END-IF.                                                      19315200
193130*                                                                 19315300
193131*                                                                 19315400
193132 3210-NUMERIC-EDITS-PREPK.                                        19315500
193133*PREPACK SELECTION                                                19315600
193134     IF  ASC-VALID-SELECT-PP = PC-S                               19315700
193135         SET PS-PCT-TO-AUD-ZERO-NO TO TRUE                        19315800
193136     ELSE                                                         19315900
193137         SET PS-ERROR                                             19316000
193138             DP020-MSG-FATAL TO TRUE                              19316100
193139         MOVE PC-TSYMSG-00005                                     19316200
193140                             TO DP020-MSG-NUMBER                  19316300
193141         MOVE DP015-UNP-ALP-BRT-OFF                               19316400
193142                             TO APPSELA                           19316500
193143         MOVE DP015-RED      TO APPSELC                           19316600
193144         MOVE DP015-REVERSE  TO APPSELH                           19316700
193145         MOVE -1             TO APPSELL                           19316800
193146         SET DP030-SET-CURSOR-APPL-1                              19316900
193147                             TO TRUE                              19317000
193148     END-IF                                                       19317100
193149                                                                  19317200
193150*    DETERMINE IF THERE IS A DECIMAL POINT OR NOT, AND VALIDATE   19317300
193151*    NUMERIC ACCORDINGLY                                          19317400
193152     MOVE +0                      TO PV-DECIMAL-COUNT.            19317500
193153     INSPECT ASC-AUD-PCT-PP-X TALLYING PV-DECIMAL-COUNT           19317600
193154            FOR ALL '.'.                                          19317700
193155                                                                  19317800
193156*    CHECK TO MAKE SURE THE RETAIL IS NUMERIC                     19317900
193157     INITIALIZE DP010I-NUMERIC-EDIT-AREA.                         19318000
193158     MOVE ASC-AUD-PCT-PP-X        TO DP010I-UNEDITED-FIELD.       19318100
193159                                                                  19318200
193160*    IF THERE IS A DECIMAL POINT, VALIDATE FOR 2 DECIMALS         19318300
193161     IF PV-DECIMAL-COUNT > 0                                      19318400
193162         MOVE 4                   TO DP010I-MAXIMUM-DIGITS        19318500
193163         MOVE 2                   TO DP010I-MAXIMUM-DECIMALS      19318600
193164     ELSE                                                         19318700
193165         MOVE 6                   TO DP010I-MAXIMUM-DIGITS        19318800
193166         MOVE 0                   TO DP010I-MAXIMUM-DECIMALS      19318900
193167     END-IF.                                                      19319000
193168                                                                  19319100
193169     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     19319200
193170                                                                  19319300
263968     CALL DP010I-NUMERIC-EDIT-ROUTINE                             19319599
263968          USING DP010I-NUMERIC-EDIT-AREA.                         19319699
193172                                                                  19319700
193173     IF  DP010I-ERROR-DETECTED                                    19319800
193174         SET PS-ERROR                                             19319900
193175             DP020-MSG-FATAL TO TRUE                              19320000
193176         MOVE PC-TSYMSG-00008                                     19320100
193177                             TO DP020-MSG-NUMBER                  19320200
193178         MOVE DP015-UNP-ALP-BRT-OFF                               19320300
193179                             TO APCAUDPA                          19320400
193180         MOVE DP015-RED      TO APCAUDPC                          19320500
193181         MOVE DP015-REVERSE  TO APCAUDPH                          19320600
193182         MOVE -1             TO APCAUDPL                          19320700
193183         SET DP030-SET-CURSOR-APPL-1                              19320800
193184                             TO TRUE                              19320900
193185     ELSE                                                         19321000
193186         MOVE DP010I-NUMERIC-FIELD  TO ASC-AUD-PCT-PP             19321100
193187         MOVE ASC-AUD-PCT-PP-X          TO APCAUDPO               19321200
193188         IF PS-NO-ERROR                                           19321300
193189           IF  DP010I-NUMERIC-FIELD  = 0                          19321400
193190               SET PS-PCT-TO-AUD-ZERO-YES TO TRUE                 19321500
193191           ELSE                                                   19321600
193192              IF  DP010I-NUMERIC-FIELD  > 0                       19321700
193193                  IF  DP010I-NUMERIC-FIELD  > 100                 19321800
193194                      SET PS-ERROR                                19321900
193195                          DP020-MSG-FATAL TO TRUE                 19322000
193196                      MOVE PC-TSYMSG-00005                        19322100
193197                                          TO DP020-MSG-NUMBER     19322200
193198                      MOVE DP015-UNP-ALP-BRT-OFF                  19322300
193199                                          TO APCAUDPA             19322400
193200                      MOVE DP015-RED      TO APCAUDPC             19322500
193201                      MOVE DP015-REVERSE  TO APCAUDPH             19322600
193202                      MOVE -1             TO APCAUDPL             19322700
193203                      SET DP030-SET-CURSOR-APPL-1                 19322800
193204                                          TO TRUE                 19322900
193205                 END-IF                                           19323000
193206              ELSE                                                19323100
193207                 SET PS-ERROR                                     19323200
193208                     DP020-MSG-FATAL TO TRUE                      19323300
193209                 MOVE PC-TSYMSG-00342                             19323400
193210                                     TO DP020-MSG-NUMBER          19323500
193211                 MOVE DP015-UNP-ALP-BRT-OFF                       19323600
193212                                     TO APCAUDPA                  19323700
193213                 MOVE DP015-RED      TO APCAUDPC                  19323800
193214                 MOVE DP015-REVERSE  TO APCAUDPH                  19323900
193215                 MOVE -1             TO APCAUDPL                  19324000
193216                 SET DP030-SET-CURSOR-APPL-1                      19324100
193217                                     TO TRUE                      19324200
193218              END-IF                                              19324300
193219           END-IF                                                 19324400
193220         END-IF                                                   19324500
193221     END-IF.                                                      19324600
193222                                                                  19324700
193223**CHECK PERCENT TOLERANCE ****************************************19324800
193224                                                                  19324900
193225     MOVE +0                      TO PV-DECIMAL-COUNT.            19325000
193226     INSPECT ASC-CKD-PCT-PP-X TALLYING PV-DECIMAL-COUNT           19325100
193227            FOR ALL '.'.                                          19325200
193228                                                                  19325300
193229*    CHECK TO MAKE SURE THE RETAIL IS NUMERIC                     19325400
193230     INITIALIZE DP010I-NUMERIC-EDIT-AREA.                         19325500
193231     MOVE ASC-CKD-PCT-PP-X        TO DP010I-UNEDITED-FIELD.       19325600
193232                                                                  19325700
193233*    IF THERE IS A DECIMAL POINT, VALIDATE FOR 2 DECIMALS         19325800
193234     IF PV-DECIMAL-COUNT > 0                                      19325900
193235         MOVE 4                   TO DP010I-MAXIMUM-DIGITS        19326000
193236         MOVE 2                   TO DP010I-MAXIMUM-DECIMALS      19326100
193237     ELSE                                                         19326200
193238         MOVE 6                   TO DP010I-MAXIMUM-DIGITS        19326300
193239         MOVE 0                   TO DP010I-MAXIMUM-DECIMALS      19326400
193240     END-IF.                                                      19326500
193241                                                                  19326600
193242     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     19326700
193243                                                                  19326800
263968     CALL DP010I-NUMERIC-EDIT-ROUTINE                             19327099
263968          USING DP010I-NUMERIC-EDIT-AREA.                         19327199
193245                                                                  19327200
193246     IF  DP010I-ERROR-DETECTED                                    19327300
193247         SET PS-ERROR                                             19327400
193248             DP020-MSG-FATAL TO TRUE                              19327500
193249         MOVE PC-TSYMSG-00008                                     19327600
193250                             TO DP020-MSG-NUMBER                  19327700
193251         MOVE DP015-UNP-ALP-BRT-OFF                               19327800
193252                             TO APCTOLPA                          19327900
193253         MOVE DP015-RED      TO APCTOLPC                          19328000
193254         MOVE DP015-REVERSE  TO APCTOLPH                          19328100
193255         MOVE -1             TO APCTOLPL                          19328200
193256         SET DP030-SET-CURSOR-APPL-1                              19328300
193257                             TO TRUE                              19328400
193258     ELSE                                                         19328500
193259         MOVE DP010I-NUMERIC-FIELD  TO ASC-CKD-PCT-PP             19328600
193260         IF  DP010I-NUMERIC-FIELD  > 100                          19328700
193261              SET PS-ERROR                                        19328800
193262                  DP020-MSG-FATAL TO TRUE                         19328900
193263              MOVE PC-TSYMSG-00005                                19329000
193264                                  TO DP020-MSG-NUMBER             19329100
193265              MOVE DP015-UNP-ALP-BRT-OFF                          19329200
193266                                  TO APCTOLPA                     19329300
193267              MOVE DP015-RED      TO APCTOLPC                     19329400
193268              MOVE DP015-REVERSE  TO APCTOLPH                     19329500
193269              MOVE -1             TO APCTOLPL                     19329600
193270              SET DP030-SET-CURSOR-APPL-1                         19329700
193271                                  TO TRUE                         19329800
193272         END-IF                                                   19329900
193273         MOVE ASC-CKD-PCT-PP-X          TO APCTOLPO               19330000
193274     END-IF.                                                      19330100
193275                                                                  19330200
193276****NOT TO EXCEED QUANTITY                                        19330300
193277*                                                                 19330400
193278     IF  ASC-MAX-CKD-QTY-PP NOT = SPACES                          19330500
193279         MOVE ASC-MAX-CKD-QTY-PP       TO DP010I-UNEDITED-FIELD   19330600
193280         MOVE LENGTH OF ASC-MAX-CKD-QTY-PP                        19330700
193281                                       TO DP010I-MAXIMUM-DIGITS   19330800
193282         MOVE ZERO                     TO DP010I-MAXIMUM-DECIMALS 19330900
193283         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  19331000
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         19331299
263968              USING DP010I-NUMERIC-EDIT-AREA                      19331399
193285*                                                                 19331400
193286         IF  DP010I-ERROR-DETECTED                                19331500
193287             SET PS-ERROR                                         19331600
193288                 DP020-MSG-FATAL TO TRUE                          19331700
193289             MOVE PC-TSYMSG-00008                                 19331800
193290                                 TO DP020-MSG-NUMBER              19331900
193291             MOVE DP015-UNP-ALP-BRT-OFF                           19332000
193292                                 TO ANEXCDPA                      19332100
193293             MOVE DP015-RED      TO ANEXCDPC                      19332200
193294             MOVE DP015-REVERSE  TO ANEXCDPH                      19332300
193295             MOVE -1             TO ANEXCDPL                      19332400
193296             SET DP030-SET-CURSOR-APPL-1                          19332500
193297                                 TO TRUE                          19332600
193298         ELSE                                                     19332700
193299           IF DP010I-NUMERIC-FIELD NOT > 0                        19332800
193300               SET PS-ERROR                                       19332900
193301                   DP020-MSG-FATAL TO TRUE                        19333000
193302               MOVE PC-TSYMSG-00342                               19333100
193303                                   TO DP020-MSG-NUMBER            19333200
193304               MOVE DP015-UNP-ALP-BRT-OFF                         19333300
193305                                   TO ANEXCDPA                    19333400
193306               MOVE DP015-RED      TO ANEXCDPC                    19333500
193307               MOVE DP015-REVERSE  TO ANEXCDPH                    19333600
193308               MOVE -1             TO ANEXCDPL                    19333700
193309               SET DP030-SET-CURSOR-APPL-1                        19333800
193310                                   TO TRUE                        19333900
193311           ELSE                                                   19334000
193312               MOVE DP010I-NUMERIC-FIELD TO  ASC-MAX-CKD-QTY-PP-N 19334100
193313               MOVE ASC-MAX-CKD-QTY-PP   TO ANEXCDPO              19334200
193314           END-IF                                                 19334300
193315         END-IF.                                                  19334400
193316*                                                                 19334500
193317*MAX CARTONS CHECKED QUANTITY                                     19334600
193318*                                                                 19334700
193319     IF  PS-NO-ERROR                                              19334800
193320       IF  ASC-MAX-CART-CKD-QTY-PP NOT = SPACES                   19334900
193321           MOVE ASC-MAX-CART-CKD-QTY-PP  TO DP010I-UNEDITED-FIELD 19335000
193322           MOVE LENGTH OF ASC-MAX-CART-CKD-QTY-PP                 19335100
193323                                      TO DP010I-MAXIMUM-DIGITS    19335200
193324           MOVE ZERO                  TO DP010I-MAXIMUM-DECIMALS  19335300
193325           SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                19335400
263968           CALL DP010I-NUMERIC-EDIT-ROUTINE                       19335699
263968                USING DP010I-NUMERIC-EDIT-AREA                    19335799
193327**                                                                19335800
193328           IF  DP010I-ERROR-DETECTED                              19335900
193329               SET PS-ERROR                                       19336000
193330                   DP020-MSG-FATAL TO TRUE                        19336100
193331               MOVE PC-TSYMSG-00008                               19336200
193332                                   TO DP020-MSG-NUMBER            19336300
193333               MOVE DP015-UNP-ALP-BRT-OFF                         19336400
193334                                   TO AMAXCKPA                    19336500
193335               MOVE DP015-RED      TO AMAXCKPC                    19336600
193336               MOVE DP015-REVERSE  TO AMAXCKPH                    19336700
193337               MOVE -1             TO AMAXCKPL                    19336800
193338               SET DP030-SET-CURSOR-APPL-1                        19336900
193339                                   TO TRUE                        19337000
193340           ELSE                                                   19337100
193341             IF PS-PCT-TO-AUD-ZERO-NO                             19337200
193342                 IF DP010I-NUMERIC-FIELD NOT > 0                  19337300
193343                     SET PS-ERROR                                 19337400
193344                         DP020-MSG-FATAL TO TRUE                  19337500
193345                     MOVE PC-TSYMSG-00342                         19337600
193346                                         TO DP020-MSG-NUMBER      19337700
193347                     MOVE DP015-UNP-ALP-BRT-OFF                   19337800
193348                                         TO AMAXCKPA              19337900
193349                     MOVE DP015-RED      TO AMAXCKPC              19338000
193350                     MOVE DP015-REVERSE  TO AMAXCKPH              19338100
193351                     MOVE -1             TO AMAXCKPL              19338200
193352                     SET DP030-SET-CURSOR-APPL-1                  19338300
193353                                         TO TRUE                  19338400
193354                 ELSE                                             19338500
193355                     MOVE DP010I-NUMERIC-FIELD TO                 19338600
193356                                    ASC-MAX-CART-CKD-QTY-PP-N     19338700
193357                     MOVE ASC-MAX-CART-CKD-QTY-PP TO  AMAXCKPO    19338800
193358                 END-IF                                           19338900
193359             ELSE                                                 19339000
193360                IF DP010I-NUMERIC-FIELD NOT = 0                   19339100
193361                   SET PS-ERROR                                   19339200
193362                       DP020-MSG-FATAL TO TRUE                    19339300
193363                   MOVE PC-TSYMSG-02889                           19339400
193364                                       TO DP020-MSG-NUMBER        19339500
193365*                                                                 19339600
193366                   MOVE DP015-UNP-ALP-BRT-OFF                     19339700
193367                                       TO AMAXCKPA                19339800
193368                   MOVE DP015-RED      TO AMAXCKPC                19339900
193369                   MOVE DP015-REVERSE  TO AMAXCKPH                19340000
193370                   MOVE -1             TO AMAXCKPL                19340100
193371*                                                                 19340200
193372                   MOVE DP015-UNP-ALP-BRT-OFF                     19340300
193373                                       TO AMINCKPA                19340400
193374                   MOVE DP015-RED      TO AMINCKPC                19340500
193375                   MOVE DP015-REVERSE  TO AMINCKPH                19340600
193376*                                                                 19340700
193377                   MOVE DP015-UNP-ALP-BRT-OFF                     19340800
193378                                       TO APCAUDPA                19340900
193379                   MOVE DP015-RED      TO APCAUDPC                19341000
193380                   MOVE DP015-REVERSE  TO APCAUDPH                19341100
193381                   SET DP030-SET-CURSOR-APPL-1                    19341200
193382                                       TO TRUE                    19341300
193383                ELSE                                              19341400
193384                     MOVE DP010I-NUMERIC-FIELD TO                 19341500
193385                                       ASC-MAX-CART-CKD-QTY-PP-N  19341600
193386                     MOVE ASC-MAX-CART-CKD-QTY-PP TO  AMAXCKPO    19341700
193387                END-IF                                            19341800
193388             END-IF                                               19341900
193389           END-IF                                                 19342000
193390       END-IF                                                     19342100
193391     END-IF.                                                      19342200
193392*                                                                 19342300
193393*MIN CARTONS CHECKED QUANTITY                                     19342400
193394*                                                                 19342500
193395     IF  PS-NO-ERROR                                              19342600
193396       IF  ASC-MIN-CART-CKD-QTY-PP NOT = SPACES                   19342700
193397           MOVE ASC-MIN-CART-CKD-QTY-PP  TO DP010I-UNEDITED-FIELD 19342800
193398           MOVE LENGTH OF ASC-MIN-CART-CKD-QTY-PP                 19342900
193399                                      TO DP010I-MAXIMUM-DIGITS    19343000
193400           MOVE ZERO                  TO DP010I-MAXIMUM-DECIMALS  19343100
193401           SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                19343200
263968           CALL DP010I-NUMERIC-EDIT-ROUTINE                       19343499
263968                USING DP010I-NUMERIC-EDIT-AREA                    19343599
193403**                                                                19343600
193404           IF  DP010I-ERROR-DETECTED                              19343700
193405               SET PS-ERROR                                       19343800
193406                   DP020-MSG-FATAL TO TRUE                        19343900
193407               MOVE PC-TSYMSG-00008                               19344000
193408                                   TO DP020-MSG-NUMBER            19344100
193409               MOVE DP015-UNP-ALP-BRT-OFF                         19344200
193410                                   TO AMINCKPA                    19344300
193411               MOVE DP015-RED      TO AMINCKPC                    19344400
193412               MOVE DP015-REVERSE  TO AMINCKPH                    19344500
193413               MOVE -1             TO AMINCKPL                    19344600
193414               SET DP030-SET-CURSOR-APPL-1                        19344700
193415                                   TO TRUE                        19344800
193416           ELSE                                                   19344900
193417             IF PS-PCT-TO-AUD-ZERO-NO                             19345000
193418                 IF DP010I-NUMERIC-FIELD NOT > 0                  19345100
193419                     SET PS-ERROR                                 19345200
193420                         DP020-MSG-FATAL TO TRUE                  19345300
193421                     MOVE PC-TSYMSG-00342                         19345400
193422                                         TO DP020-MSG-NUMBER      19345500
193423                     MOVE DP015-UNP-ALP-BRT-OFF                   19345600
193424                                         TO AMINCKPA              19345700
193425                     MOVE DP015-RED      TO AMINCKPC              19345800
193426                     MOVE DP015-REVERSE  TO AMINCKPH              19345900
193427                     MOVE -1             TO AMINCKPL              19346000
193428                     SET DP030-SET-CURSOR-APPL-1                  19346100
193429                                         TO TRUE                  19346200
193430                 ELSE                                             19346300
193431                     MOVE DP010I-NUMERIC-FIELD TO                 19346400
193432                                       ASC-MIN-CART-CKD-QTY-PP-N  19346500
193433                     MOVE ASC-MIN-CART-CKD-QTY-PP TO  AMINCKPO    19346600
193434                 END-IF                                           19346700
193435             ELSE                                                 19346800
193436              IF DP010I-NUMERIC-FIELD NOT = 0                     19346900
193437                 SET PS-ERROR                                     19347000
193438                     DP020-MSG-FATAL TO TRUE                      19347100
193439                 MOVE PC-TSYMSG-02889                             19347200
193440                                     TO DP020-MSG-NUMBER          19347300
193441*                                                                 19347400
193442                 MOVE DP015-UNP-ALP-BRT-OFF                       19347500
193443                                     TO AMINCKPA                  19347600
193444                 MOVE DP015-RED      TO AMINCKPC                  19347700
193445                 MOVE DP015-REVERSE  TO AMINCKPH                  19347800
193446                 MOVE -1             TO AMINCKPL                  19347900
193447*                                                                 19348000
193448                 MOVE DP015-UNP-ALP-BRT-OFF                       19348100
193449                                     TO AMAXCKPA                  19348200
193450                 MOVE DP015-RED      TO AMAXCKPC                  19348300
193451                 MOVE DP015-REVERSE  TO AMAXCKPH                  19348400
193452*                                                                 19348500
193453                 MOVE DP015-UNP-ALP-BRT-OFF                       19348600
193454                                     TO APCAUDPA                  19348700
193455                 MOVE DP015-RED      TO APCAUDPC                  19348800
193456                 MOVE DP015-REVERSE  TO APCAUDPH                  19348900
193457                 SET DP030-SET-CURSOR-APPL-1                      19349000
193458                                     TO TRUE                      19349100
193459              ELSE                                                19349200
193460                     MOVE DP010I-NUMERIC-FIELD TO                 19349300
193461                                       ASC-MIN-CART-CKD-QTY-PP-N  19349400
193462                     MOVE ASC-MIN-CART-CKD-QTY-PP TO  AMINCKPO    19349500
193463              END-IF                                              19349600
193464             END-IF                                               19349700
193465           END-IF                                                 19349800
193466       END-IF                                                     19349900
193467     END-IF.                                                      19350000
193468*                                                                 19350100
193469*HOW MANY DC'S TO CHECK                                           19350200
193470*                                                                 19350300
193471     IF  ASC-CKD-DC-QTY-PP    NOT = SPACES                        19350400
193472         MOVE ASC-CKD-DC-QTY-PP        TO DP010I-UNEDITED-FIELD   19350500
193473         MOVE LENGTH OF ASC-CKD-DC-QTY-PP                         19350600
193474                                       TO DP010I-MAXIMUM-DIGITS   19350700
193475         MOVE ZERO                     TO DP010I-MAXIMUM-DECIMALS 19350800
193476         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  19350900
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         19351199
263968              USING DP010I-NUMERIC-EDIT-AREA                      19351299
193478*                                                                 19351300
193479         IF  DP010I-ERROR-DETECTED                                19351400
193480             SET PS-ERROR                                         19351500
193481                 DP020-MSG-FATAL TO TRUE                          19351600
193482             MOVE PC-TSYMSG-00008                                 19351700
193483                                 TO DP020-MSG-NUMBER              19351800
193484             MOVE DP015-UNP-ALP-BRT-OFF                           19351900
193485                                 TO ADCCHKPA                      19352000
193486             MOVE DP015-RED      TO ADCCHKPC                      19352100
193487             MOVE DP015-REVERSE  TO ADCCHKPH                      19352200
193488             MOVE -1             TO ADCCHKPL                      19352300
193489             SET DP030-SET-CURSOR-APPL-1                          19352400
193490                                 TO TRUE                          19352500
193491         ELSE                                                     19352600
193492           IF DP010I-NUMERIC-FIELD NOT > 0                        19352700
193493               SET PS-ERROR                                       19352800
193494                   DP020-MSG-FATAL TO TRUE                        19352900
193495               MOVE PC-TSYMSG-00342                               19353000
193496                                   TO DP020-MSG-NUMBER            19353100
193497               MOVE DP015-UNP-ALP-BRT-OFF                         19353200
193498                                   TO ADCCHKPA                    19353300
193499               MOVE DP015-RED      TO ADCCHKPC                    19353400
193500               MOVE DP015-REVERSE  TO ADCCHKPH                    19353500
193501               MOVE -1             TO ADCCHKPL                    19353600
193502               SET DP030-SET-CURSOR-APPL-1                        19353700
193503                                   TO TRUE                        19353800
193504           ELSE                                                   19353900
193505               MOVE DP010I-NUMERIC-FIELD TO                       19354000
193506                                      ASC-CKD-DC-QTY-PP-N         19354100
193507               MOVE ASC-CKD-DC-QTY-PP  TO  ADCCHKPO               19354200
193508           END-IF                                                 19354300
193509         END-IF.                                                  19354400
193510*                                                                 19354500
193511*RECHECK AFTER NUMBER OF DAYS                                     19354600
193512*                                                                 19354700
193513     IF  ASC-CK-AFT-DAY-QTY-PP   NOT = SPACES                     19354800
193514         MOVE ASC-CK-AFT-DAY-QTY-PP    TO DP010I-UNEDITED-FIELD   19354900
193515         MOVE LENGTH OF ASC-CK-AFT-DAY-QTY-PP                     19355000
193516                                       TO DP010I-MAXIMUM-DIGITS   19355100
193517         MOVE ZERO                     TO DP010I-MAXIMUM-DECIMALS 19355200
193518         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  19355300
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         19355599
263968              USING DP010I-NUMERIC-EDIT-AREA                      19355699
193520*                                                                 19355700
193521         IF  DP010I-ERROR-DETECTED                                19355800
193522             SET PS-ERROR                                         19355900
193523                 DP020-MSG-FATAL TO TRUE                          19356000
193524             MOVE PC-TSYMSG-00008                                 19356100
193525                                 TO DP020-MSG-NUMBER              19356200
193526             MOVE DP015-UNP-ALP-BRT-OFF                           19356300
193527                                 TO ACHKDYPA                      19356400
193528             MOVE DP015-RED      TO ACHKDYPC                      19356500
193529             MOVE DP015-REVERSE  TO ACHKDYPH                      19356600
193530             MOVE -1             TO ACHKDYPL                      19356700
193531             SET DP030-SET-CURSOR-APPL-1                          19356800
193532                                 TO TRUE                          19356900
193533         ELSE                                                     19357000
193534           IF DP010I-NUMERIC-FIELD NOT > 0                        19357100
193535               SET PS-ERROR                                       19357200
193536                   DP020-MSG-FATAL TO TRUE                        19357300
193537               MOVE PC-TSYMSG-00342                               19357400
193538                                   TO DP020-MSG-NUMBER            19357500
193539               MOVE DP015-UNP-ALP-BRT-OFF                         19357600
193540                                   TO ACHKDYPA                    19357700
193541               MOVE DP015-RED      TO ACHKDYPC                    19357800
193542               MOVE DP015-REVERSE  TO ACHKDYPH                    19357900
193543               MOVE -1             TO ACHKDYPL                    19358000
193544               SET DP030-SET-CURSOR-APPL-1                        19358100
193545                                   TO TRUE                        19358200
193546           ELSE                                                   19358300
193547               MOVE DP010I-NUMERIC-FIELD TO                       19358400
193548                                      ASC-CK-AFT-DAY-QTY-PP-N     19358500
193549               MOVE ASC-CK-AFT-DAY-QTY-PP TO  ACHKDYPO            19358600
193550           END-IF                                                 19358700
193551         END-IF.                                                  19358800
193552*                                                                 19358900
193553*                                                                 19359000
193554 3215-NUMERIC-EDITS-PBS.                                          19359100
193555     IF  ASC-VALID-SELECT-PS = PC-S                               19359200
193556         SET PS-PCT-TO-AUD-ZERO-NO TO TRUE                        19359300
193557     ELSE                                                         19359400
193558         SET PS-ERROR                                             19359500
193559             DP020-MSG-FATAL TO TRUE                              19359600
193560         MOVE PC-TSYMSG-00005                                     19359700
193561                             TO DP020-MSG-NUMBER                  19359800
193562         MOVE DP015-UNP-ALP-BRT-OFF                               19359900
193563                             TO APSSELA                           19360000
193564         MOVE DP015-RED      TO APSSELC                           19360100
193565         MOVE DP015-REVERSE  TO APSSELH                           19360200
193566         MOVE -1             TO APSSELL                           19360300
193567         SET DP030-SET-CURSOR-APPL-1                              19360400
193568                             TO TRUE                              19360500
193569     END-IF                                                       19360600
193570*PERCENT TO AUDIT                                                 19360700
193571*    DETERMINE IF THERE IS A DECIMAL POINT OR NOT, AND VALIDATE   19360800
193572*    NUMERIC ACCORDINGLY                                          19360900
193573     MOVE +0                      TO PV-DECIMAL-COUNT.            19361000
193574     INSPECT ASC-AUD-PCT-PS-X TALLYING PV-DECIMAL-COUNT           19361100
193575            FOR ALL '.'.                                          19361200
193576                                                                  19361300
193577*    CHECK TO MAKE SURE THE RETAIL IS NUMERIC                     19361400
193578     INITIALIZE DP010I-NUMERIC-EDIT-AREA.                         19361500
193579     MOVE ASC-AUD-PCT-PS-X        TO DP010I-UNEDITED-FIELD.       19361600
193580                                                                  19361700
193581*    IF THERE IS A DECIMAL POINT, VALIDATE FOR 2 DECIMALS         19361800
193582     IF PV-DECIMAL-COUNT > 0                                      19361900
193583         MOVE 4                   TO DP010I-MAXIMUM-DIGITS        19362000
193584         MOVE 2                   TO DP010I-MAXIMUM-DECIMALS      19362100
193585     ELSE                                                         19362200
193586         MOVE 6                   TO DP010I-MAXIMUM-DIGITS        19362300
193587         MOVE 0                   TO DP010I-MAXIMUM-DECIMALS      19362400
193588     END-IF.                                                      19362500
193589                                                                  19362600
193590     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     19362700
193591                                                                  19362800
263968     CALL DP010I-NUMERIC-EDIT-ROUTINE                             19363099
263968          USING DP010I-NUMERIC-EDIT-AREA.                         19363199
193593                                                                  19363200
193594     IF  DP010I-ERROR-DETECTED                                    19363300
193595         SET PS-ERROR                                             19363400
193596             DP020-MSG-FATAL TO TRUE                              19363500
193597         MOVE PC-TSYMSG-00008                                     19363600
193598                             TO DP020-MSG-NUMBER                  19363700
193599         MOVE DP015-UNP-ALP-BRT-OFF                               19363800
193600                             TO APCAUDSA                          19363900
193601         MOVE DP015-RED      TO APCAUDSC                          19364000
193602         MOVE DP015-REVERSE  TO APCAUDSH                          19364100
193603         MOVE -1             TO APCAUDSL                          19364200
193604         SET DP030-SET-CURSOR-APPL-1                              19364300
193605                             TO TRUE                              19364400
193606     ELSE                                                         19364500
193607         MOVE DP010I-NUMERIC-FIELD  TO ASC-AUD-PCT-PS             19364600
193608         MOVE ASC-AUD-PCT-PS-X          TO APCAUDSO               19364700
193611         IF PS-NO-ERROR                                           19364800
193613           IF  DP010I-NUMERIC-FIELD  = 0                          19364900
193614               SET PS-PCT-TO-AUD-ZERO-YES TO TRUE                 19365000
193615           ELSE                                                   19365100
193616              IF  DP010I-NUMERIC-FIELD  > 0                       19365200
193617                  IF  DP010I-NUMERIC-FIELD  > 100                 19365300
193618                      SET PS-ERROR                                19365400
193619                          DP020-MSG-FATAL TO TRUE                 19365500
193620                      MOVE PC-TSYMSG-00005                        19365600
193621                                          TO DP020-MSG-NUMBER     19365700
193622                      MOVE DP015-UNP-ALP-BRT-OFF                  19365800
193623                                          TO APCAUDSA             19365900
193624                      MOVE DP015-RED      TO APCAUDSC             19366000
193625                      MOVE DP015-REVERSE  TO APCAUDSH             19366100
193626                      MOVE -1             TO APCAUDSL             19366200
193627                      SET DP030-SET-CURSOR-APPL-1                 19366300
193628                                          TO TRUE                 19366400
193629                 END-IF                                           19366500
193630              ELSE                                                19366600
193631                 SET PS-ERROR                                     19366700
193632                     DP020-MSG-FATAL TO TRUE                      19366800
193633                 MOVE PC-TSYMSG-00342                             19366900
193634                                     TO DP020-MSG-NUMBER          19367000
193635                 MOVE DP015-UNP-ALP-BRT-OFF                       19367100
193636                                     TO APCAUDSA                  19367200
193637                 MOVE DP015-RED      TO APCAUDSC                  19367300
193638                 MOVE DP015-REVERSE  TO APCAUDSH                  19367400
193639                 MOVE -1             TO APCAUDSL                  19367500
193640                 SET DP030-SET-CURSOR-APPL-1                      19367600
193641                                     TO TRUE                      19367700
193642              END-IF                                              19367800
193643           END-IF                                                 19367900
193644         END-IF                                                   19368000
193645     END-IF.                                                      19368100
193646*                                                                 19368200
193687*MAX CARTONS CHECKED QUANTITY                                     19368700
193688*                                                                 19368800
193689     IF  PS-NO-ERROR                                              19368900
193690       IF  ASC-MAX-CART-CKD-QTY-PS NOT = SPACES                   19369000
193691           MOVE ASC-MAX-CART-CKD-QTY-PS TO DP010I-UNEDITED-FIELD  19369100
193692           MOVE LENGTH OF ASC-MAX-CART-CKD-QTY-PS                 19369200
193693                                       TO DP010I-MAXIMUM-DIGITS   19369300
193694           MOVE ZERO                   TO DP010I-MAXIMUM-DECIMALS 19369400
193695           SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                19369500
263968           CALL DP010I-NUMERIC-EDIT-ROUTINE                       19369799
263968                USING DP010I-NUMERIC-EDIT-AREA                    19369899
193697***                                                               19369900
193698           IF  DP010I-ERROR-DETECTED                              19370000
193699               SET PS-ERROR                                       19370100
193700                   DP020-MSG-FATAL TO TRUE                        19370200
193701               MOVE PC-TSYMSG-00008                               19370300
193702                                   TO DP020-MSG-NUMBER            19370400
193703               MOVE DP015-UNP-ALP-BRT-OFF                         19370500
193704                                   TO AMAXCKSA                    19370600
193705               MOVE DP015-RED      TO AMAXCKSC                    19370700
193706               MOVE DP015-REVERSE  TO AMAXCKSH                    19370800
193707               MOVE -1             TO AMAXCKSL                    19370900
193708               SET DP030-SET-CURSOR-APPL-1                        19371000
193709                                   TO TRUE                        19371100
193710           ELSE                                                   19371200
193711             IF PS-PCT-TO-AUD-ZERO-NO                             19371300
193712                 IF DP010I-NUMERIC-FIELD NOT > 0                  19371400
193713                     SET PS-ERROR                                 19371500
193714                         DP020-MSG-FATAL TO TRUE                  19371600
193715                     MOVE PC-TSYMSG-00342                         19371700
193716                                         TO DP020-MSG-NUMBER      19371800
193717                     MOVE DP015-UNP-ALP-BRT-OFF                   19371900
193718                                         TO AMAXCKSA              19372000
193719                     MOVE DP015-RED      TO AMAXCKSC              19372100
193720                     MOVE DP015-REVERSE  TO AMAXCKSH              19372200
193721                     MOVE -1             TO AMAXCKSL              19372300
193722                     SET DP030-SET-CURSOR-APPL-1                  19372400
193723                                         TO TRUE                  19372500
193724                 ELSE                                             19372600
193725                     MOVE DP010I-NUMERIC-FIELD TO                 19372700
193726                                     ASC-MAX-CART-CKD-QTY-PS-N    19372800
193727                     MOVE ASC-MAX-CART-CKD-QTY-PS TO  AMAXCKSO    19372900
193728                 END-IF                                           19373000
193729             ELSE                                                 19373100
193730                IF DP010I-NUMERIC-FIELD NOT = 0                   19373200
193731                   SET PS-ERROR                                   19373300
193732                       DP020-MSG-FATAL TO TRUE                    19373400
193733                   MOVE PC-TSYMSG-02889                           19373500
193734                                       TO DP020-MSG-NUMBER        19373600
193735***                                                               19373700
193736                   MOVE DP015-UNP-ALP-BRT-OFF                     19373800
193737                                       TO AMAXCKSA                19373900
193738                   MOVE DP015-RED      TO AMAXCKSC                19374000
193739                   MOVE DP015-REVERSE  TO AMAXCKSH                19374100
193740                   MOVE -1             TO AMAXCKSL                19374200
193741*                                                                 19374300
193742                   MOVE DP015-UNP-ALP-BRT-OFF                     19374400
193743                                       TO AMINCKSA                19374500
193744                   MOVE DP015-RED      TO AMINCKSC                19374600
193745                   MOVE DP015-REVERSE  TO AMINCKSH                19374700
193746*                                                                 19374800
193747                   MOVE DP015-UNP-ALP-BRT-OFF                     19374900
193748                                       TO APCAUDSA                19375000
193749                   MOVE DP015-RED      TO APCAUDSC                19375100
193750                   MOVE DP015-REVERSE  TO APCAUDSH                19375200
193751                   SET DP030-SET-CURSOR-APPL-1                    19375300
193752                                       TO TRUE                    19375400
193753                ELSE                                              19375500
193754                     MOVE DP010I-NUMERIC-FIELD TO                 19375600
193755                                    ASC-MAX-CART-CKD-QTY-PS-N     19375700
193756                     MOVE ASC-MAX-CART-CKD-QTY-PS TO  AMAXCKSO    19375800
193757                END-IF                                            19375900
193758             END-IF                                               19376000
193759           END-IF                                                 19376100
193760       END-IF                                                     19376200
193761     END-IF.                                                      19376300
193762*                                                                 19376400
193763*MIN CARTONS CHECKED QUANTITY                                     19376500
193764*                                                                 19376600
193765     IF  PS-NO-ERROR                                              19376700
193766       IF  ASC-MIN-CART-CKD-QTY-PS NOT = SPACES                   19376800
193767           MOVE ASC-MIN-CART-CKD-QTY-PS TO DP010I-UNEDITED-FIELD  19376900
193768           MOVE LENGTH OF ASC-MIN-CART-CKD-QTY-PS                 19377000
193769                                      TO DP010I-MAXIMUM-DIGITS    19377100
193770           MOVE ZERO                  TO DP010I-MAXIMUM-DECIMALS  19377200
193771           SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                19377300
263968           CALL DP010I-NUMERIC-EDIT-ROUTINE                       19377599
263968                USING DP010I-NUMERIC-EDIT-AREA                    19377699
193773*                                                                 19377700
193774           IF  DP010I-ERROR-DETECTED                              19377800
193775               SET PS-ERROR                                       19377900
193776                   DP020-MSG-FATAL TO TRUE                        19378000
193777               MOVE PC-TSYMSG-00008                               19378100
193778                                   TO DP020-MSG-NUMBER            19378200
193779               MOVE DP015-UNP-ALP-BRT-OFF                         19378300
193780                                   TO AMINCKSA                    19378400
193781               MOVE DP015-RED      TO AMINCKSC                    19378500
193782               MOVE DP015-REVERSE  TO AMINCKSH                    19378600
193783               MOVE -1             TO AMINCKSL                    19378700
193784               SET DP030-SET-CURSOR-APPL-1                        19378800
193785                                   TO TRUE                        19378900
193786           ELSE                                                   19379000
193787             IF PS-PCT-TO-AUD-ZERO-NO                             19379100
193788                 IF DP010I-NUMERIC-FIELD NOT > 0                  19379200
193789                     SET PS-ERROR                                 19379300
193790                         DP020-MSG-FATAL TO TRUE                  19379400
193791                     MOVE PC-TSYMSG-00342                         19379500
193800                                         TO DP020-MSG-NUMBER      19380000
193801                     MOVE DP015-UNP-ALP-BRT-OFF                   19380100
193802                                         TO AMINCKSA              19380200
193803                     MOVE DP015-RED      TO AMINCKSC              19380300
193804                     MOVE DP015-REVERSE  TO AMINCKSH              19380400
193805                     MOVE -1             TO AMINCKSL              19380500
193806                     SET DP030-SET-CURSOR-APPL-1                  19380600
193807                                         TO TRUE                  19380700
193808                 ELSE                                             19380800
193809                     MOVE DP010I-NUMERIC-FIELD TO                 19380900
193810                                       ASC-MIN-CART-CKD-QTY-PS-N  19381000
193811                     MOVE ASC-MIN-CART-CKD-QTY-PS TO  AMINCKSO    19381100
193812                 END-IF                                           19381200
193813             ELSE                                                 19381300
193814              IF DP010I-NUMERIC-FIELD NOT = 0                     19381400
193815                 SET PS-ERROR                                     19381500
193816                     DP020-MSG-FATAL TO TRUE                      19381600
193817                 MOVE PC-TSYMSG-02889                             19381700
193818                                     TO DP020-MSG-NUMBER          19381800
193819*                                                                 19381900
193820                 MOVE DP015-UNP-ALP-BRT-OFF                       19382000
193821                                     TO AMINCKSA                  19382100
193822                 MOVE DP015-RED      TO AMINCKSC                  19382200
193823                 MOVE DP015-REVERSE  TO AMINCKSH                  19382300
193824                 MOVE -1             TO AMINCKSL                  19382400
193825*                                                                 19382500
193826                 MOVE DP015-UNP-ALP-BRT-OFF                       19382600
193827                                     TO AMAXCKSA                  19382700
193828                 MOVE DP015-RED      TO AMAXCKSC                  19382800
193829                 MOVE DP015-REVERSE  TO AMAXCKSH                  19382900
193830*                                                                 19383000
193831                 MOVE DP015-UNP-ALP-BRT-OFF                       19383100
193832                                     TO APCAUDSA                  19383200
193833                 MOVE DP015-RED      TO APCAUDSC                  19383300
193834                 MOVE DP015-REVERSE  TO APCAUDSH                  19383400
193835                 SET DP030-SET-CURSOR-APPL-1                      19383500
193836                                     TO TRUE                      19383600
193837              ELSE                                                19383700
193838                     MOVE DP010I-NUMERIC-FIELD TO                 19383800
193839                                       ASC-MIN-CART-CKD-QTY-PS-N  19383900
193840                     MOVE ASC-MIN-CART-CKD-QTY-PS TO  AMINCKSO    19384000
193841              END-IF                                              19384100
193842             END-IF                                               19384200
193843           END-IF                                                 19384300
193844       END-IF                                                     19384400
193845     END-IF.                                                      19384500
193846*                                                                 19384600
193847*HOW MANY DC'S TO CHECK                                           19384700
193848*                                                                 19384800
193849     IF  ASC-CKD-DC-QTY-PS    NOT = SPACES                        19384900
193850         MOVE ASC-CKD-DC-QTY-PS        TO DP010I-UNEDITED-FIELD   19385000
193851         MOVE LENGTH OF ASC-CKD-DC-QTY-PS                         19385100
193852                                       TO DP010I-MAXIMUM-DIGITS   19385200
193853         MOVE ZERO                     TO DP010I-MAXIMUM-DECIMALS 19385300
193854         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  19385400
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         19385699
263968              USING DP010I-NUMERIC-EDIT-AREA                      19385799
193856*                                                                 19385800
193857         IF  DP010I-ERROR-DETECTED                                19385900
193858             SET PS-ERROR                                         19386000
193859                 DP020-MSG-FATAL TO TRUE                          19386100
193860             MOVE PC-TSYMSG-00008                                 19386200
193861                                 TO DP020-MSG-NUMBER              19386300
193862             MOVE DP015-UNP-ALP-BRT-OFF                           19386400
193863                                 TO ADCCHKSA                      19386500
193864             MOVE DP015-RED      TO ADCCHKSC                      19386600
193865             MOVE DP015-REVERSE  TO ADCCHKSH                      19386700
193866             MOVE -1             TO ADCCHKSL                      19386800
193867             SET DP030-SET-CURSOR-APPL-1                          19386900
193868                                 TO TRUE                          19387000
193869         ELSE                                                     19387100
193870           IF DP010I-NUMERIC-FIELD NOT > 0                        19387200
193871               SET PS-ERROR                                       19387300
193872                   DP020-MSG-FATAL TO TRUE                        19387400
193873               MOVE PC-TSYMSG-00342                               19387500
193874                                   TO DP020-MSG-NUMBER            19387600
193875               MOVE DP015-UNP-ALP-BRT-OFF                         19387700
193876                                   TO ADCCHKSA                    19387800
193877               MOVE DP015-RED      TO ADCCHKSC                    19387900
193878               MOVE DP015-REVERSE  TO ADCCHKSH                    19388000
193879               MOVE -1             TO ADCCHKSL                    19388100
193880               SET DP030-SET-CURSOR-APPL-1                        19388200
193881                                   TO TRUE                        19388300
193882           ELSE                                                   19388400
193883               MOVE DP010I-NUMERIC-FIELD TO                       19388500
193884                                      ASC-CKD-DC-QTY-PS-N         19388600
193885               MOVE ASC-CKD-DC-QTY-PS  TO  ADCCHKSO               19388700
193886           END-IF                                                 19388800
193887         END-IF.                                                  19388900
193888*                                                                 19389000
193889*RECHECK AFTER NUMBER OF DAYS                                     19389100
193890*                                                                 19389200
193891     IF  ASC-CK-AFT-DAY-QTY-PS   NOT = SPACES                     19389300
193892         MOVE ASC-CK-AFT-DAY-QTY-PS    TO DP010I-UNEDITED-FIELD   19389400
193893         MOVE LENGTH OF ASC-CK-AFT-DAY-QTY-PS                     19389500
193894                                       TO DP010I-MAXIMUM-DIGITS   19389600
193895         MOVE ZERO                     TO DP010I-MAXIMUM-DECIMALS 19389700
193896         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  19389800
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         19390099
263968              USING DP010I-NUMERIC-EDIT-AREA                      19390199
193898*                                                                 19390200
193899         IF  DP010I-ERROR-DETECTED                                19390300
193900             SET PS-ERROR                                         19390400
193901                 DP020-MSG-FATAL TO TRUE                          19390500
193902             MOVE PC-TSYMSG-00008                                 19390600
193903                                 TO DP020-MSG-NUMBER              19390700
193904             MOVE DP015-UNP-ALP-BRT-OFF                           19390800
193905                                 TO ACHKDYSA                      19390900
193906             MOVE DP015-RED      TO ACHKDYSC                      19391000
193907             MOVE DP015-REVERSE  TO ACHKDYSH                      19391100
193908             MOVE -1             TO ACHKDYSL                      19391200
193909             SET DP030-SET-CURSOR-APPL-1                          19391300
193910                                 TO TRUE                          19391400
193911         ELSE                                                     19391500
193912           IF DP010I-NUMERIC-FIELD NOT > 0                        19391600
193913               SET PS-ERROR                                       19391700
193914                   DP020-MSG-FATAL TO TRUE                        19391800
193915               MOVE PC-TSYMSG-00342                               19391900
193916                                   TO DP020-MSG-NUMBER            19392000
193917               MOVE DP015-UNP-ALP-BRT-OFF                         19392100
193918                                   TO ACHKDYSA                    19392200
193919               MOVE DP015-RED      TO ACHKDYSC                    19392300
193920               MOVE DP015-REVERSE  TO ACHKDYSH                    19392400
193921               MOVE -1             TO ACHKDYSL                    19392500
193922               SET DP030-SET-CURSOR-APPL-1                        19392600
193923                                   TO TRUE                        19392700
193924           ELSE                                                   19392800
193925               MOVE DP010I-NUMERIC-FIELD TO                       19392900
193926                                      ASC-CK-AFT-DAY-QTY-PS-N     19393000
193927               MOVE ASC-CK-AFT-DAY-QTY-PS TO  ACHKDYSO            19393100
193928           END-IF                                                 19393200
193929         END-IF.                                                  19393300
193930*                                                                 19393400
      *SB 10/07/13 - BEGIN PR#5148D                                     19393500
193554 3220-NUMERIC-EDITS-RFID.                                         19393600
193555     IF  ASC-VALID-SELECT-RF = PC-S                               19393700
193556         SET PS-PCT-TO-AUD-ZERO-NO TO TRUE                        19393800
193557     ELSE                                                         19393900
193558         SET PS-ERROR                                             19394000
193559             DP020-MSG-FATAL TO TRUE                              19394100
193560         MOVE PC-TSYMSG-00005                                     19394200
193561                             TO DP020-MSG-NUMBER                  19394300
193562         MOVE DP015-UNP-ALP-BRT-OFF                               19394400
193563                             TO ARFSELA                           19394500
193564         MOVE DP015-RED      TO ARFSELC                           19394600
193565         MOVE DP015-REVERSE  TO ARFSELH                           19394700
193566         MOVE -1             TO ARFSELL                           19394800
193567         SET DP030-SET-CURSOR-APPL-1                              19394900
193568                             TO TRUE                              19395000
193569     END-IF                                                       19395100
193570*PERCENT TO AUDIT                                                 19395200
193571*    DETERMINE IF THERE IS A DECIMAL POINT OR NOT, AND VALIDATE   19395300
193572*    NUMERIC ACCORDINGLY                                          19395400
193573     MOVE +0                      TO PV-DECIMAL-COUNT.            19395500
193574     INSPECT ASC-AUD-PCT-RF-X TALLYING PV-DECIMAL-COUNT           19395600
193575            FOR ALL '.'.                                          19395700
193576                                                                  19395800
193577*    CHECK TO MAKE SURE THE RETAIL IS NUMERIC                     19395900
193578     INITIALIZE DP010I-NUMERIC-EDIT-AREA.                         19396000
193579     MOVE ASC-AUD-PCT-RF-X        TO DP010I-UNEDITED-FIELD.       19396100
193580                                                                  19396200
193581*    IF THERE IS A DECIMAL POINT, VALIDATE FOR 2 DECIMALS         19396300
193582     IF PV-DECIMAL-COUNT > 0                                      19396400
193583         MOVE 4                   TO DP010I-MAXIMUM-DIGITS        19396500
193584         MOVE 2                   TO DP010I-MAXIMUM-DECIMALS      19396600
193585     ELSE                                                         19396700
193586         MOVE 6                   TO DP010I-MAXIMUM-DIGITS        19396800
193587         MOVE 0                   TO DP010I-MAXIMUM-DECIMALS      19396900
193588     END-IF.                                                      19397000
193589                                                                  19397100
193590     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     19397200
193591                                                                  19397300
263968     CALL DP010I-NUMERIC-EDIT-ROUTINE                             19397599
263968          USING DP010I-NUMERIC-EDIT-AREA.                         19397699
193593                                                                  19397700
193594     IF  DP010I-ERROR-DETECTED                                    19397800
193595         SET PS-ERROR                                             19397900
193596             DP020-MSG-FATAL TO TRUE                              19398000
193597         MOVE PC-TSYMSG-00008                                     19398100
193598                             TO DP020-MSG-NUMBER                  19398200
193599         MOVE DP015-UNP-ALP-BRT-OFF                               19398300
193600                             TO APCAUDRA                          19398400
193601         MOVE DP015-RED      TO APCAUDRC                          19398500
193602         MOVE DP015-REVERSE  TO APCAUDRH                          19398600
193603         MOVE -1             TO APCAUDRL                          19398700
193604         SET DP030-SET-CURSOR-APPL-1                              19398800
193605                             TO TRUE                              19398900
193606     ELSE                                                         19399000
193607         MOVE DP010I-NUMERIC-FIELD  TO ASC-AUD-PCT-RF             19399100
193608         MOVE ASC-AUD-PCT-RF-X          TO APCAUDRO               19399200
193611         IF PS-NO-ERROR                                           19399300
193613           IF  DP010I-NUMERIC-FIELD  = 0                          19399400
193614               SET PS-PCT-TO-AUD-ZERO-YES TO TRUE                 19399500
193615           ELSE                                                   19399600
193616              IF  DP010I-NUMERIC-FIELD  > 0                       19399700
193617                  IF  DP010I-NUMERIC-FIELD  > 100                 19399800
193618                      SET PS-ERROR                                19399900
193619                          DP020-MSG-FATAL TO TRUE                 19400000
193620                      MOVE PC-TSYMSG-00005                        19400100
193621                                          TO DP020-MSG-NUMBER     19400200
193622                      MOVE DP015-UNP-ALP-BRT-OFF                  19400300
193623                                          TO APCAUDRA             19400400
193624                      MOVE DP015-RED      TO APCAUDRC             19400500
193625                      MOVE DP015-REVERSE  TO APCAUDRH             19400600
193626                      MOVE -1             TO APCAUDRL             19400700
193627                      SET DP030-SET-CURSOR-APPL-1                 19400800
193628                                          TO TRUE                 19400900
193629                 END-IF                                           19401000
193630              ELSE                                                19401100
193631                 SET PS-ERROR                                     19401200
193632                     DP020-MSG-FATAL TO TRUE                      19401300
193633                 MOVE PC-TSYMSG-00342                             19401400
193634                                     TO DP020-MSG-NUMBER          19401500
193635                 MOVE DP015-UNP-ALP-BRT-OFF                       19401600
193636                                     TO APCAUDRA                  19401700
193637                 MOVE DP015-RED      TO APCAUDRC                  19401800
193638                 MOVE DP015-REVERSE  TO APCAUDRH                  19401900
193639                 MOVE -1             TO APCAUDRL                  19402000
193640                 SET DP030-SET-CURSOR-APPL-1                      19402100
193641                                     TO TRUE                      19402200
193642              END-IF                                              19402300
193643           END-IF                                                 19402400
193644         END-IF                                                   19402500
193645     END-IF.                                                      19402600
193646*                                                                 19402700
193687*MAX CARTONS CHECKED QUANTITY                                     19402800
193688*                                                                 19402900
193689     IF  PS-NO-ERROR                                              19403000
193690       IF  ASC-MAX-CART-CKD-QTY-RF NOT = SPACES                   19403100
193691           MOVE ASC-MAX-CART-CKD-QTY-RF TO DP010I-UNEDITED-FIELD  19403200
193692           MOVE LENGTH OF ASC-MAX-CART-CKD-QTY-RF                 19403300
193693                                       TO DP010I-MAXIMUM-DIGITS   19403400
193694           MOVE ZERO                   TO DP010I-MAXIMUM-DECIMALS 19403500
193695           SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                19403600
263968           CALL DP010I-NUMERIC-EDIT-ROUTINE                       19403899
263968                USING DP010I-NUMERIC-EDIT-AREA                    19403999
193697***                                                               19404000
193698           IF  DP010I-ERROR-DETECTED                              19404100
193699               SET PS-ERROR                                       19404200
193700                   DP020-MSG-FATAL TO TRUE                        19404300
193701               MOVE PC-TSYMSG-00008                               19404400
193702                                   TO DP020-MSG-NUMBER            19404500
193703               MOVE DP015-UNP-ALP-BRT-OFF                         19404600
193704                                   TO AMAXCKRA                    19404700
193705               MOVE DP015-RED      TO AMAXCKRC                    19404800
193706               MOVE DP015-REVERSE  TO AMAXCKRH                    19404900
193707               MOVE -1             TO AMAXCKRL                    19405000
193708               SET DP030-SET-CURSOR-APPL-1                        19405100
193709                                   TO TRUE                        19405200
193710           ELSE                                                   19405300
193711             IF PS-PCT-TO-AUD-ZERO-NO                             19405400
193712                 IF DP010I-NUMERIC-FIELD NOT > 0                  19405500
193713                     SET PS-ERROR                                 19405600
193714                         DP020-MSG-FATAL TO TRUE                  19405700
193715                     MOVE PC-TSYMSG-00342                         19405800
193716                                         TO DP020-MSG-NUMBER      19405900
193717                     MOVE DP015-UNP-ALP-BRT-OFF                   19406000
193718                                         TO AMAXCKRA              19406100
193719                     MOVE DP015-RED      TO AMAXCKRC              19406200
193720                     MOVE DP015-REVERSE  TO AMAXCKRH              19406300
193721                     MOVE -1             TO AMAXCKRL              19406400
193722                     SET DP030-SET-CURSOR-APPL-1                  19406500
193723                                         TO TRUE                  19406600
193724                 ELSE                                             19406700
193725                     MOVE DP010I-NUMERIC-FIELD TO                 19406800
193726                                     ASC-MAX-CART-CKD-QTY-RF-N    19406900
193727                     MOVE ASC-MAX-CART-CKD-QTY-RF TO  AMAXCKRO    19407000
193728                 END-IF                                           19407100
193729             ELSE                                                 19407200
193730                IF DP010I-NUMERIC-FIELD NOT = 0                   19407300
193731                   SET PS-ERROR                                   19407400
193732                       DP020-MSG-FATAL TO TRUE                    19407500
193733                   MOVE PC-TSYMSG-02889                           19407600
193734                                       TO DP020-MSG-NUMBER        19407700
193735***                                                               19407800
193736                   MOVE DP015-UNP-ALP-BRT-OFF                     19407900
193737                                       TO AMAXCKRA                19408000
193738                   MOVE DP015-RED      TO AMAXCKRC                19408100
193739                   MOVE DP015-REVERSE  TO AMAXCKRH                19408200
193740                   MOVE -1             TO AMAXCKRL                19408300
193741*                                                                 19408400
193742                   MOVE DP015-UNP-ALP-BRT-OFF                     19408500
193743                                       TO AMINCKRA                19408600
193744                   MOVE DP015-RED      TO AMINCKRC                19408700
193745                   MOVE DP015-REVERSE  TO AMINCKRH                19408800
193746*                                                                 19408900
193747                   MOVE DP015-UNP-ALP-BRT-OFF                     19409000
193748                                       TO APCAUDRA                19409100
193749                   MOVE DP015-RED      TO APCAUDRC                19409200
193750                   MOVE DP015-REVERSE  TO APCAUDRH                19409300
193751                   SET DP030-SET-CURSOR-APPL-1                    19409400
193752                                       TO TRUE                    19409500
193753                ELSE                                              19409600
193754                     MOVE DP010I-NUMERIC-FIELD TO                 19409700
193755                                    ASC-MAX-CART-CKD-QTY-RF-N     19409800
193756                     MOVE ASC-MAX-CART-CKD-QTY-RF TO  AMAXCKRO    19409900
193757                END-IF                                            19410000
193758             END-IF                                               19410100
193759           END-IF                                                 19410200
193760       END-IF                                                     19410300
193761     END-IF.                                                      19410400
193762*                                                                 19410500
193763*MIN CARTONS CHECKED QUANTITY                                     19410600
193764*                                                                 19410700
193765     IF  PS-NO-ERROR                                              19410800
193766       IF  ASC-MIN-CART-CKD-QTY-RF NOT = SPACES                   19410900
193767           MOVE ASC-MIN-CART-CKD-QTY-RF TO DP010I-UNEDITED-FIELD  19411000
193768           MOVE LENGTH OF ASC-MIN-CART-CKD-QTY-RF                 19411100
193769                                      TO DP010I-MAXIMUM-DIGITS    19411200
193770           MOVE ZERO                  TO DP010I-MAXIMUM-DECIMALS  19411300
193771           SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                19411400
263968           CALL DP010I-NUMERIC-EDIT-ROUTINE                       19411699
263968                USING DP010I-NUMERIC-EDIT-AREA                    19411799
193773*                                                                 19411800
193774           IF  DP010I-ERROR-DETECTED                              19411900
193775               SET PS-ERROR                                       19412000
193776                   DP020-MSG-FATAL TO TRUE                        19412100
193777               MOVE PC-TSYMSG-00008                               19412200
193778                                   TO DP020-MSG-NUMBER            19412300
193779               MOVE DP015-UNP-ALP-BRT-OFF                         19412400
193780                                   TO AMINCKRA                    19412500
193781               MOVE DP015-RED      TO AMINCKRC                    19412600
193782               MOVE DP015-REVERSE  TO AMINCKRH                    19412700
193783               MOVE -1             TO AMINCKRL                    19412800
193784               SET DP030-SET-CURSOR-APPL-1                        19412900
193785                                   TO TRUE                        19413000
193786           ELSE                                                   19413100
193787             IF PS-PCT-TO-AUD-ZERO-NO                             19413200
193788                 IF DP010I-NUMERIC-FIELD NOT > 0                  19413300
193789                     SET PS-ERROR                                 19413400
193790                         DP020-MSG-FATAL TO TRUE                  19413500
193791                     MOVE PC-TSYMSG-00342                         19413600
193800                                         TO DP020-MSG-NUMBER      19413700
193801                     MOVE DP015-UNP-ALP-BRT-OFF                   19413800
193802                                         TO AMINCKRA              19413900
193803                     MOVE DP015-RED      TO AMINCKRC              19414000
193804                     MOVE DP015-REVERSE  TO AMINCKRH              19414100
193805                     MOVE -1             TO AMINCKRL              19414200
193806                     SET DP030-SET-CURSOR-APPL-1                  19414300
193807                                         TO TRUE                  19414400
193808                 ELSE                                             19414500
193809                     MOVE DP010I-NUMERIC-FIELD TO                 19414600
193810                                       ASC-MIN-CART-CKD-QTY-RF-N  19414700
193811                     MOVE ASC-MIN-CART-CKD-QTY-RF TO  AMINCKRO    19414800
193812                 END-IF                                           19414900
193813             ELSE                                                 19415000
193814              IF DP010I-NUMERIC-FIELD NOT = 0                     19415100
193815                 SET PS-ERROR                                     19415200
193816                     DP020-MSG-FATAL TO TRUE                      19415300
193817                 MOVE PC-TSYMSG-02889                             19415400
193818                                     TO DP020-MSG-NUMBER          19415500
193819*                                                                 19415600
193820                 MOVE DP015-UNP-ALP-BRT-OFF                       19415700
193821                                     TO AMINCKRA                  19415800
193822                 MOVE DP015-RED      TO AMINCKRC                  19415900
193823                 MOVE DP015-REVERSE  TO AMINCKRH                  19416000
193824                 MOVE -1             TO AMINCKRL                  19416100
193825*                                                                 19416200
193826                 MOVE DP015-UNP-ALP-BRT-OFF                       19416300
193827                                     TO AMAXCKRA                  19416400
193828                 MOVE DP015-RED      TO AMAXCKRC                  19416500
193829                 MOVE DP015-REVERSE  TO AMAXCKRH                  19416600
193830*                                                                 19416700
193831                 MOVE DP015-UNP-ALP-BRT-OFF                       19416800
193832                                     TO APCAUDRA                  19416900
193833                 MOVE DP015-RED      TO APCAUDRC                  19417000
193834                 MOVE DP015-REVERSE  TO APCAUDRH                  19417100
193835                 SET DP030-SET-CURSOR-APPL-1                      19417200
193836                                     TO TRUE                      19417300
193837              ELSE                                                19417400
193838                     MOVE DP010I-NUMERIC-FIELD TO                 19417500
193839                                       ASC-MIN-CART-CKD-QTY-RF-N  19417600
193840                     MOVE ASC-MIN-CART-CKD-QTY-RF TO  AMINCKRO    19417700
193841              END-IF                                              19417800
193842             END-IF                                               19417900
193843           END-IF                                                 19418000
193844       END-IF                                                     19418100
193845     END-IF.                                                      19418200
193846*                                                                 19418300
193847*HOW MANY DC'S TO CHECK                                           19418400
193848*                                                                 19418500
193849     IF  ASC-CKD-DC-QTY-RF    NOT = SPACES                        19418600
193850         MOVE ASC-CKD-DC-QTY-RF        TO DP010I-UNEDITED-FIELD   19418700
193851         MOVE LENGTH OF ASC-CKD-DC-QTY-RF                         19418800
193852                                       TO DP010I-MAXIMUM-DIGITS   19418900
193853         MOVE ZERO                     TO DP010I-MAXIMUM-DECIMALS 19419000
193854         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  19419100
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         19419399
263968              USING DP010I-NUMERIC-EDIT-AREA                      19419499
193856*                                                                 19419500
193857         IF  DP010I-ERROR-DETECTED                                19419600
193858             SET PS-ERROR                                         19419700
193859                 DP020-MSG-FATAL TO TRUE                          19419800
193860             MOVE PC-TSYMSG-00008                                 19419900
193861                                 TO DP020-MSG-NUMBER              19420000
193862             MOVE DP015-UNP-ALP-BRT-OFF                           19420100
193863                                 TO ADCCHKRA                      19420200
193864             MOVE DP015-RED      TO ADCCHKRC                      19420300
193865             MOVE DP015-REVERSE  TO ADCCHKRH                      19420400
193866             MOVE -1             TO ADCCHKRL                      19420500
193867             SET DP030-SET-CURSOR-APPL-1                          19420600
193868                                 TO TRUE                          19420700
193869         ELSE                                                     19420800
193870           IF DP010I-NUMERIC-FIELD NOT > 0                        19420900
193871               SET PS-ERROR                                       19421000
193872                   DP020-MSG-FATAL TO TRUE                        19421100
193873               MOVE PC-TSYMSG-00342                               19421200
193874                                   TO DP020-MSG-NUMBER            19421300
193875               MOVE DP015-UNP-ALP-BRT-OFF                         19421400
193876                                   TO ADCCHKRA                    19421500
193877               MOVE DP015-RED      TO ADCCHKRC                    19421600
193878               MOVE DP015-REVERSE  TO ADCCHKRH                    19421700
193879               MOVE -1             TO ADCCHKRL                    19421800
193880               SET DP030-SET-CURSOR-APPL-1                        19421900
193881                                   TO TRUE                        19422000
193882           ELSE                                                   19422100
193883               MOVE DP010I-NUMERIC-FIELD TO                       19422200
193884                                      ASC-CKD-DC-QTY-RF-N         19422300
193885               MOVE ASC-CKD-DC-QTY-RF  TO  ADCCHKRO               19422400
193886           END-IF                                                 19422500
193887         END-IF.                                                  19422600
193888*                                                                 19422700
193889*RECHECK AFTER NUMBER OF DAYS                                     19422800
193890*                                                                 19422900
193891     IF  ASC-CK-AFT-DAY-QTY-RF   NOT = SPACES                     19423000
193892         MOVE ASC-CK-AFT-DAY-QTY-RF    TO DP010I-UNEDITED-FIELD   19423100
193893         MOVE LENGTH OF ASC-CK-AFT-DAY-QTY-RF                     19423200
193894                                       TO DP010I-MAXIMUM-DIGITS   19423300
193895         MOVE ZERO                     TO DP010I-MAXIMUM-DECIMALS 19423400
193896         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  19423500
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         19423799
263968              USING DP010I-NUMERIC-EDIT-AREA                      19423899
193898*                                                                 19423900
193899         IF  DP010I-ERROR-DETECTED                                19424000
193900             SET PS-ERROR                                         19424100
193901                 DP020-MSG-FATAL TO TRUE                          19424200
193902             MOVE PC-TSYMSG-00008                                 19424300
193903                                 TO DP020-MSG-NUMBER              19424400
193904             MOVE DP015-UNP-ALP-BRT-OFF                           19424500
193905                                 TO ACHKDYRA                      19424600
193906             MOVE DP015-RED      TO ACHKDYRC                      19424700
193907             MOVE DP015-REVERSE  TO ACHKDYRH                      19424800
193908             MOVE -1             TO ACHKDYRL                      19424900
193909             SET DP030-SET-CURSOR-APPL-1                          19425000
193910                                 TO TRUE                          19425100
193911         ELSE                                                     19425200
193912           IF DP010I-NUMERIC-FIELD NOT > 0                        19425300
193913               SET PS-ERROR                                       19425400
193914                   DP020-MSG-FATAL TO TRUE                        19425500
193915               MOVE PC-TSYMSG-00342                               19425600
193916                                   TO DP020-MSG-NUMBER            19425700
193917               MOVE DP015-UNP-ALP-BRT-OFF                         19425800
193918                                   TO ACHKDYRA                    19425900
193919               MOVE DP015-RED      TO ACHKDYRC                    19426000
193920               MOVE DP015-REVERSE  TO ACHKDYRH                    19426100
193921               MOVE -1             TO ACHKDYRL                    19426200
193922               SET DP030-SET-CURSOR-APPL-1                        19426300
193923                                   TO TRUE                        19426400
193924           ELSE                                                   19426500
193925               MOVE DP010I-NUMERIC-FIELD TO                       19426600
193926                                      ASC-CK-AFT-DAY-QTY-RF-N     19426700
193927               MOVE ASC-CK-AFT-DAY-QTY-RF TO  ACHKDYRO            19426800
193928           END-IF                                                 19426900
193929         END-IF.                                                  19427000
      *SB 10/07/13 - END PR#5148D                                       19427100
193930*                                                                 19427200
193931*----------------------------------------------------------------*19427300
193932*    VALIDATE THE QUEUE WAS PASSED AND DISPLAY FOR THE FIRST     *19427400
193933*    ENTRY.                                                      *19427500
193934*----------------------------------------------------------------*19427600
193935 4000-BUILD-INITIAL-PANEL.                                        19427700
193936                                                                  19427800
193937                                                                  19427900
193938     PERFORM 4010-OPEN-CURSOR                                     19428000
193939     PERFORM 4310-FETCH                                           19428100
193940        UNTIL PS-EOF-PO-AUD-PARM-CURSOR                           19428200
193941     PERFORM 4020-CLOSE-CURSOR                                    19428300
193942                                                                  19428400
193943                                                                  19428500
193944     EVALUATE ASC-INT-APPL-FORMAT-IND                             19428600
193945         WHEN PC-INTER-APPL-CRIT-SPEC-UPD                         19428700
193946         WHEN PC-INTER-APPL-LIST-UPDATE                           19428800
193947             SET DP030-SET-CURSOR-APPL-1     TO TRUE              19428900
193948             MOVE -1                         TO ABCSELL           19429000
193949         WHEN PC-INTER-APPL-CRIT-SPEC-ADD                         19429100
193950         WHEN PC-INTER-APPL-LIST-ADD                              19429200
194000             SET DP030-SET-CURSOR-APPL-1     TO TRUE              19429300
194100             MOVE -1                         TO ARANKL            19430000
194800     END-EVALUATE                                                 19480000
194900                                                                  19490000
195000     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        19500000
195100*                                                                 19510000
195110     MOVE 'SUVNDRKU' TO DP008-FUNCTION-NAME                       19511000
195120     PERFORM 2105-RACF-ACCESS                                     19512000
195130     IF  PS-ACCESS-NOT-ALLOWED                                    19513000
195140         SET  ASC-NO-RACF-AUTH-FOUND TO TRUE                      19514000
195150     ELSE                                                         19515000
195160         SET  ASC-RACF-AUTHORITY-FOUND TO TRUE                    19516000
195170     END-IF.                                                      19517000
195200*                                                                 19520000
195300*----------------------------------------------------------------*19530000
195400* OPEN CURSOR                                                     19540000
195500*----------------------------------------------------------------*19550000
195600 4010-OPEN-CURSOR.                                                19560000
195700     PERFORM                                                      19570000
195800         WITH TEST AFTER                                          19580000
195900         VARYING PV-RETRY-COUNTER                                 19590000
196000         FROM 1 BY 1                                              19600000
196100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               19610000
196200                   OR (SQLCODE = ZERO))                           19620000
196300                                                                  19630000
196400         EXEC SQL                                                 19640000
196500              OPEN PARM_DATA_CSR                                  19650000
196600         END-EXEC                                                 19660000
196700                                                                  19670000
196800         EVALUATE TRUE                                            19680000
196900             WHEN SQLCODE = ZERO                                  19690000
197000             WHEN SQLCODE = -904                                  19700000
197100             WHEN SQLCODE = -913                                  19710000
197200                 CONTINUE                                         19720000
197300             WHEN SQLWARN0 NOT = SPACES                           19730000
197400             WHEN SQLCODE < ZERO                                  19740000
197500             WHEN SQLCODE > ZERO                                  19750000
197600                 MOVE '4010-OPEN-CURSOR'                          19760000
197700                                   TO DP013-PARAGRAPH             19770000
197800                 MOVE 'OPEN CURSOR - '                            19780000
197900                                   TO DP013-MESSAGE-TEXT (1)      19790000
198000                 MOVE SQLCA        TO DP013-SQLCA                 19800000
198100                 MOVE 'TPRTRTK '   TO DP013-DB2-TABLE-NAME (1)    19810000
198200                 SET DP013-DB2-ABEND                              19820000
198300                     DP013-XCTL-DISPLAY-RESTART TO TRUE           19830000
198400                 PERFORM DP013-0000-PROCESS-ABEND                 19840000
198500         END-EVALUATE                                             19850000
198600     END-PERFORM                                                  19860000
198700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        19870000
198800         MOVE '4010-OPEN-CURSOR'   TO DP013-PARAGRAPH             19880000
198900         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   19890000
199000                                   TO DP013-MESSAGE-TEXT (1)      19900000
199100         MOVE SQLCA                TO DP013-SQLCA                 19910000
199200         MOVE 'TPRTRTK '           TO DP013-DB2-TABLE-NAME (1)    19920000
199300         SET DP013-DB2-ABEND                                      19930000
199400             DP013-XCTL-DISPLAY-RESTART                           19940000
199500                                   TO TRUE                        19950000
199600         PERFORM DP013-0000-PROCESS-ABEND                         19960000
199700     END-IF.                                                      19970000
199800                                                                  19980000
199900 EJECT                                                            19990000
200000*                                                                 20000000
200100*                                                                 20010000
200200*----------------------------------------------------------------*20020000
200300* CLOSE CURSOR                                                    20030000
200400*----------------------------------------------------------------*20040000
200500 4020-CLOSE-CURSOR.                                               20050000
200600     EXEC SQL                                                     20060000
200700          CLOSE PARM_DATA_CSR                                     20070000
200800     END-EXEC                                                     20080000
200900                                                                  20090000
201000     EVALUATE TRUE                                                20100000
201100         WHEN SQLCODE = ZERO                                      20110000
201200             CONTINUE                                             20120000
201300         WHEN SQLWARN0 NOT = SPACES                               20130000
201400         WHEN SQLCODE < ZERO                                      20140000
201500         WHEN SQLCODE > ZERO                                      20150000
201600             MOVE '4020-CLOSE-CURSOR'                             20160000
201700                               TO DP013-PARAGRAPH                 20170000
201800             MOVE 'CLOSE CURSOR '                                 20180000
201900                               TO DP013-MESSAGE-TEXT (1)          20190000
202000             MOVE SQLCA        TO DP013-SQLCA                     20200000
202100             MOVE 'TPRTRTK '   TO DP013-DB2-TABLE-NAME (1)        20210000
202200             SET DP013-DB2-ABEND                                  20220000
202300                 DP013-XCTL-DISPLAY-RESTART TO TRUE               20230000
202400             PERFORM DP013-0000-PROCESS-ABEND                     20240000
202500     END-EVALUATE.                                                20250000
202600                                                                  20260000
202700 EJECT                                                            20270000
202800*                                                                 20280000
202900*                                                                 20290000
203000*----------------------------------------------------------------*20300000
203100*    FETCH THE PACK TYPE                                          20310000
203200*----------------------------------------------------------------*20320000
203300 4310-FETCH.                                                      20330000
203400           EXEC SQL                                               20340000
203500                FETCH PARM_DATA_CSR                               20350000
203600                  INTO :SUT00017-VND-RNKG-CDE                     20360000
203700                     , :SUT00017-PKGNG-TYP-CDE                    20370000
203710                     , :SUT00017-AUD-PCT                          20371000
203720                     , :SUT00017-CKD-PCT                          20372000
203730                     , :SUT00017-MAX-CKD-QTY                      20373000
203740                     , :SUT00017-MAX-CART-CKD-QTY                 20374000
203750                     , :SUT00017-MIN-CART-CKD-QTY                 20375000
203760                     , :SUT00017-CKD-DC-QTY                       20376000
203770                     , :SUT00017-MAX-PO-LNE-QTY                   20377000
203780                     , :SUT00017-CK-AFT-DAY-QTY                   20378000
203800           END-EXEC                                               20380000
203900                                                                  20390000
204000           EVALUATE TRUE                                          20400000
204100               WHEN SQLCODE = ZERO                                20410000
204110                  PERFORM 4320-EVALUATE-PKGNG-TYP-CDE             20411000
206900               WHEN SQLCODE = +100                                20690000
207000                   SET PS-EOF-PO-AUD-PARM-CURSOR TO TRUE          20700000
207100               WHEN SQLWARN0 NOT = SPACE                          20710000
207200               WHEN SQLCODE NOT = ZERO                            20720000
207300                    MOVE '4310-FETCH-CURSOR'                      20730000
207400                                     TO DP013-PARAGRAPH           20740000
207500                    MOVE 'FETCH MESSAGE CURSOR'                   20750000
207600                                     TO DP013-MESSAGE-TEXT (1)    20760000
207700                    MOVE SQLCA       TO DP013-SQLCA               20770000
207800                    SET DP013-DB2-ABEND                           20780000
207900                                     TO TRUE                      20790000
208000                    PERFORM DP013-0000-PROCESS-ABEND              20800000
208100           END-EVALUATE.                                          20810000
208200*                                                                 20820000
208300*                                                                 20830000
208310 4320-EVALUATE-PKGNG-TYP-CDE.                                     20831000
208311                                                                  20831100
208321           EVALUATE SUT00017-PKGNG-TYP-CDE                        20832100
208322               WHEN PC-VEND-RANK-TYP-BC                           20832200
208340                  MOVE SUT00017-PKGNG-TYP-CDE                     20834000
208341                                       TO ASC-PKGNG-TYP-CDE-BC    20834100
208342                  MOVE SUT00017-AUD-PCT                           20834200
208343                                       TO ASC-AUD-PCT-BC          20834300
208350                  MOVE SUT00017-CKD-PCT                           20835000
208351                                       TO ASC-CKD-PCT-BC          20835100
208360                  MOVE SUT00017-MAX-CKD-QTY                       20836000
208361                                       TO ASC-MAX-CKD-QTY-BC-N    20836100
208370                  MOVE SUT00017-MAX-CART-CKD-QTY                  20837000
208371                                   TO ASC-MAX-CART-CKD-QTY-BC-N   20837100
208380                  MOVE SUT00017-MIN-CART-CKD-QTY                  20838000
208381                                   TO ASC-MIN-CART-CKD-QTY-BC-N   20838100
208390                  MOVE SUT00017-CKD-DC-QTY                        20839000
208391                                   TO ASC-CKD-DC-QTY-BC-N         20839100
208392                  MOVE SUT00017-MAX-PO-LNE-QTY                    20839200
208393                                   TO ASC-MAX-PO-LNE-QTY-BC-N     20839300
208394                  MOVE SUT00017-CK-AFT-DAY-QTY                    20839400
208395                                   TO ASC-CK-AFT-DAY-QTY-BC-N     20839500
208399               WHEN PC-VEND-RANK-TYP-PP                           20839900
208400                  MOVE SUT00017-PKGNG-TYP-CDE                     20840000
208401                                       TO ASC-PKGNG-TYP-CDE-PP    20840100
208402                  MOVE SUT00017-AUD-PCT                           20840200
208403                                    TO ASC-AUD-PCT-PP             20840300
208404                  MOVE SUT00017-CKD-PCT                           20840400
208405                                    TO ASC-CKD-PCT-PP             20840500
208406                  MOVE SUT00017-MAX-CKD-QTY                       20840600
208407                                    TO ASC-MAX-CKD-QTY-PP-N       20840700
208408                  MOVE SUT00017-MAX-CART-CKD-QTY                  20840800
208409                                    TO ASC-MAX-CART-CKD-QTY-PP-N  20840900
208410                  MOVE SUT00017-MIN-CART-CKD-QTY                  20841000
208411                                    TO ASC-MIN-CART-CKD-QTY-PP-N  20841100
208412                  MOVE SUT00017-CKD-DC-QTY                        20841200
208413                                    TO ASC-CKD-DC-QTY-PP-N        20841300
208414                  MOVE SUT00017-CK-AFT-DAY-QTY                    20841400
208415                                    TO ASC-CK-AFT-DAY-QTY-PP-N    20841500
208416               WHEN  PC-VEND-RANK-TYP-PS                          20841600
208417                  MOVE SUT00017-PKGNG-TYP-CDE                     20841700
208418                                       TO ASC-PKGNG-TYP-CDE-PS    20841800
208419                  MOVE SUT00017-AUD-PCT                           20841900
208420                                    TO ASC-AUD-PCT-PS             20842000
208423                  MOVE SUT00017-MAX-CART-CKD-QTY                  20842300
208424                                    TO ASC-MAX-CART-CKD-QTY-PS-N  20842400
208425                  MOVE SUT00017-MIN-CART-CKD-QTY                  20842500
208426                                    TO ASC-MIN-CART-CKD-QTY-PS-N  20842600
208427                  MOVE SUT00017-CKD-DC-QTY                        20842700
208428                                    TO ASC-CKD-DC-QTY-PS-N        20842800
208429                  MOVE SUT00017-CK-AFT-DAY-QTY                    20842900
208430                                    TO ASC-CK-AFT-DAY-QTY-PS-N    20843000
      *SB 10/07/13 - BEGIN PR#5148D                                     20843100
208416               WHEN  PC-VEND-RANK-TYP-RF                          20843200
208417                  MOVE SUT00017-PKGNG-TYP-CDE                     20843300
208418                                       TO ASC-PKGNG-TYP-CDE-RF    20843400
208419                  MOVE SUT00017-AUD-PCT                           20843500
208420                                    TO ASC-AUD-PCT-RF             20843600
208423                  MOVE SUT00017-MAX-CART-CKD-QTY                  20843700
208424                                    TO ASC-MAX-CART-CKD-QTY-RF-N  20843800
208425                  MOVE SUT00017-MIN-CART-CKD-QTY                  20843900
208426                                    TO ASC-MIN-CART-CKD-QTY-RF-N  20844000
208427                  MOVE SUT00017-CKD-DC-QTY                        20844100
208428                                    TO ASC-CKD-DC-QTY-RF-N        20844200
208429                  MOVE SUT00017-CK-AFT-DAY-QTY                    20844300
208430                                    TO ASC-CK-AFT-DAY-QTY-RF-N    20844400
      *SB 10/07/13 - END PR#5148D                                       20844500
208431           END-EVALUATE.                                          20845000
208499*----------------------------------------------------------------*20849900
208500*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *20850000
208600*----------------------------------------------------------------*20860000
208700 4400-MOVE-COMMAREA-TO-SCREEN.                                    20870000
209200                                                                  20920000
209600         EVALUATE ASC-INT-APPL-FORMAT-IND                         20960000
209700             WHEN PC-INTER-APPL-CRIT-SPEC-ADD                     20970000
209800             WHEN PC-INTER-APPL-LIST-ADD                          20980000
209900                IF ASC-VEND-RNK-CDE > SPACES                      20990000
210000                   MOVE ASC-VEND-RNK-CDE         TO ARANKO        21000000
210010                   MOVE ASC-VEND-RNK-DESC        TO ARNKDSCO      21001000
210100                END-IF                                            21010000
212600             WHEN PC-INTER-APPL-CRIT-SPEC-UPD                     21260000
212610             WHEN PC-INTER-APPL-LIST-UPDATE                       21261000
212700                IF ASC-AUD-PCT-BC > SPACES                        21270000
213300                   MOVE ASC-AUD-PCT-BC           TO APCAUDBO      21330000
213400                   MOVE ASC-CKD-PCT-BC           TO APCTOLBO      21340000
213500                   MOVE ASC-MAX-CKD-QTY-BC       TO ANEXCDBO      21350000
213600                   MOVE ASC-MAX-CART-CKD-QTY-BC  TO AMAXCKBO      21360000
213700                   MOVE ASC-MIN-CART-CKD-QTY-BC  TO AMINCKBO      21370000
213800                   MOVE ASC-CKD-DC-QTY-BC        TO ADCCHKBO      21380000
213900                   MOVE ASC-MAX-PO-LNE-QTY-BC    TO AMXPOLBO      21390000
213910                   MOVE ASC-CK-AFT-DAY-QTY-BC    TO ACHKDYBO      21391000
214010                END-IF                                            21401000
214011                                                                  21401100
214020                IF ASC-AUD-PCT-PP > SPACES                        21402000
214030                   MOVE ASC-AUD-PCT-PP           TO APCAUDPO      21403000
214040                   MOVE ASC-CKD-PCT-PP           TO APCTOLPO      21404000
214050                   MOVE ASC-MAX-CKD-QTY-PP       TO ANEXCDPO      21405000
214060                   MOVE ASC-MAX-CART-CKD-QTY-PP  TO AMAXCKPO      21406000
214070                   MOVE ASC-MIN-CART-CKD-QTY-PP  TO AMINCKPO      21407000
214080                   MOVE ASC-CKD-DC-QTY-PP        TO ADCCHKPO      21408000
214091                   MOVE ASC-CK-AFT-DAY-QTY-PP    TO ACHKDYPO      21409100
214093                END-IF                                            21409300
214094                                                                  21409400
214095                IF ASC-AUD-PCT-PS > SPACES                        21409500
214096                   MOVE ASC-AUD-PCT-PS           TO APCAUDSO      21409600
214099                   MOVE ASC-MAX-CART-CKD-QTY-PS  TO AMAXCKSO      21409900
214100                   MOVE ASC-MIN-CART-CKD-QTY-PS  TO AMINCKSO      21410000
214101                   MOVE ASC-CKD-DC-QTY-PS        TO ADCCHKSO      21410100
214103                   MOVE ASC-CK-AFT-DAY-QTY-PS    TO ACHKDYSO      21410300
214105                END-IF                                            21410500
214094                                                                  21410600
      *SB 10/07/13 - BEGIN PR#5148D                                     21410700
214095                IF ASC-AUD-PCT-RF > SPACES                        21410800
214096                   MOVE ASC-AUD-PCT-RF           TO APCAUDRO      21410900
214099                   MOVE ASC-MAX-CART-CKD-QTY-RF  TO AMAXCKRO      21411000
214100                   MOVE ASC-MIN-CART-CKD-QTY-RF  TO AMINCKRO      21411100
214101                   MOVE ASC-CKD-DC-QTY-RF        TO ADCCHKRO      21411200
214103                   MOVE ASC-CK-AFT-DAY-QTY-RF    TO ACHKDYRO      21411300
214105                END-IF                                            21411400
      *SB 10/07/13 - END PR#5148D                                       21411500
214110         END-EVALUATE                                             21412000
218200*                                                                 21820000
218300*WHEN UPD VEND RNK UPDATE SCREEN, PROTECT AUDIT RANK CODE FIELD   21830000
218400*                                                                 21840000
218500     EVALUATE ASC-INT-APPL-FORMAT-IND                             21850000
218600         WHEN PC-INTER-APPL-CRIT-SPEC-UPD                         21860000
218700         WHEN PC-INTER-APPL-LIST-UPDATE                           21870000
218710             MOVE ASC-VEND-RNK-CDE           TO ARANKO            21871000
218720             MOVE ASC-VEND-RNK-DESC          TO ARNKDSCO          21872000
218800             SET DP030-SET-CURSOR-APPL-1     TO TRUE              21880000
218900             MOVE -1                         TO APCAUDBL          21890000
219000             MOVE DP015-ASK-NOR-OFF          TO ARANKA            21900000
219100             MOVE DP015-BLUE                 TO ARANKC            21910000
219200             MOVE DP015-HL-OFF               TO ARANKH            21920000
220500     END-EVALUATE.                                                22050000
220600*                                                                 22060000
220700*                                                                 22070000
225000*                                                                 22500000
225100*----------------------------------------------------------------*22510000
225200* PROCESS TABLE INSERTS                                          *22520000
225210* ADD PROCESSING WILL INSERT A ROW TO SUT_VND_RNKNG_CDE,          22521000
225220* SUT_VND_PKGNG_ASSN, AND A ROW FOR EACH TYPE (BULK/CASEPACK (BC)*22522000
225221* (PREPACK (PP) PACK BY STORE (PS) OR RFID (RF) TO SUT_PO_AUD_PARM22522100
225230* UPDATE PROCESSING INSERTS A ROW TO SUT_PO_AUD_PARM FOR          22523000
225240* EACH TYPE SELECTED BY THE ASSOCIATE. THERE ARE ACTUALLY NO      22524000
225250* DB2 UPDATES, ONLY INSERTS.                                      22525000
225300*----------------------------------------------------------------*22530000
225400 5000-PROCESS-ADD-UPD.                                            22540000
225410                                                                  22541000
225420**FUNC-01 ADD FUNCTION                                            22542000
225430         IF DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)                22543000
225501            PERFORM 6100-INSERT-VND-RNKG-CDE                      22550100
225502                                                                  22550200
225503            IF ASC-ADD-UPD-BC                                     22550300
225507               MOVE PC-VEND-RANK-TYP-BC                           22550700
225508                                     TO SUT00020-PKGNG-TYP-CDE    22550800
225509                                        ASC-PKGNG-TYP-CDE-BC      22550900
225510               PERFORM 6200-INSERT-VND-PKGNG-ASSN                 22551000
225511            END-IF                                                22551100
225512                                                                  22551200
225513            IF ASC-ADD-UPD-PP                                     22551300
225517                  MOVE PC-VEND-RANK-TYP-PP                        22551700
225518                                        TO SUT00020-PKGNG-TYP-CDE 22551800
225519                                           ASC-PKGNG-TYP-CDE-PP   22551900
225520                  PERFORM 6200-INSERT-VND-PKGNG-ASSN              22552000
225522            END-IF                                                22552200
225523                                                                  22552300
225524            IF ASC-ADD-UPD-PS                                     22552400
225528                  MOVE PC-VEND-RANK-TYP-PS                        22552800
225529                                        TO SUT00020-PKGNG-TYP-CDE 22552900
225530                                           ASC-PKGNG-TYP-CDE-PS   22553000
225531                  PERFORM 6200-INSERT-VND-PKGNG-ASSN              22553100
225534            END-IF                                                22553400
225536                                                                  22553600
      *SB 10/07/13 - BEGIN PR#5148D                                     22553700
225524            IF ASC-ADD-UPD-RF                                     22553800
225528                  MOVE PC-VEND-RANK-TYP-RF                        22553900
225529                                        TO SUT00020-PKGNG-TYP-CDE 22554000
225530                                           ASC-PKGNG-TYP-CDE-RF   22554100
225531                  PERFORM 6200-INSERT-VND-PKGNG-ASSN              22554200
225534            END-IF                                                22554300
      *SB 10/07/13 - END PR#5148D                                       22554400
225535         END-IF.                                                  22554500
225536                                                                  22554600
225537**INSERT ROW FOR THE PKGNG TYPE CODE IF IT DOES NOT EXIST         22554700
225538**AND INSERT UPDATE ROW TO PO AUD PARM TABLE                      22554800
225539         IF ASC-CONFIRM-FUNC-02                                   22554900
225540            PERFORM 6000-UPD-VND-RNKG-CDE-DESC                    22555000
225541         END-IF                                                   22555100
225542                                                                  22555200
225543         IF ASC-ADD-UPD-BC                                        22555300
225544            IF ASC-PKGNG-TYP-CDE-BC > SPACES                      22555400
225545               CONTINUE                                           22555500
225546            ELSE                                                  22555600
225547               MOVE PC-VEND-RANK-TYP-BC                           22555700
225548                                     TO SUT00020-PKGNG-TYP-CDE    22555800
225549                                        ASC-PKGNG-TYP-CDE-BC      22555900
225550               PERFORM 6200-INSERT-VND-PKGNG-ASSN                 22556000
225551            END-IF                                                22556100
225552                                                                  22556200
225553            PERFORM 5300-FIELD-MOVES-FOR-BC                       22556300
225554            PERFORM 6300-INSERT-PO-AUD-PARM                       22556400
225555            MOVE DP015-ASK-NOR-OFF          TO APCAUDBA           22556500
225556                                               APCTOLBA           22556600
225557                                               ANEXCDBA           22556700
225558                                               AMAXCKBA           22556800
225559                                               AMINCKBA           22556900
225560                                               ADCCHKBA           22557000
225561                                               AMXPOLBA           22557100
225562                                               ACHKDYBA           22557200
225563            MOVE DP015-BLUE                 TO APCAUDBC           22557300
225564                                               APCTOLBC           22557400
225565                                               ANEXCDBC           22557500
225566                                               AMAXCKBC           22557600
225567                                               AMINCKBC           22557700
225568                                               ADCCHKBC           22557800
225569                                               AMXPOLBC           22557900
225570                                               ACHKDYBC           22558000
225571            MOVE DP015-HL-OFF               TO APCAUDBH           22558100
225572                                               APCTOLBH           22559000
225591                                               ANEXCDBH           22559100
225592                                               AMAXCKBH           22559200
225593                                               AMINCKBH           22559300
225594                                               ADCCHKBH           22559400
225598                                               AMXPOLBH           22559800
225599                                               ACHKDYBH           22559900
225601         END-IF                                                   22560100
225610         IF ASC-ADD-UPD-PP                                        22561000
225612            IF ASC-PKGNG-TYP-CDE-PP > SPACES                      22561200
225613               CONTINUE                                           22561300
225614            ELSE                                                  22561400
225615               MOVE PC-VEND-RANK-TYP-PP                           22561500
225616                                     TO SUT00020-PKGNG-TYP-CDE    22561600
225617                                        ASC-PKGNG-TYP-CDE-PP      22561700
225618               PERFORM 6200-INSERT-VND-PKGNG-ASSN                 22561800
225619            END-IF                                                22561900
225620            PERFORM 5400-FIELD-MOVES-FOR-PP                       22562000
225621            PERFORM 6300-INSERT-PO-AUD-PARM                       22562100
225625            MOVE DP015-ASK-NOR-OFF          TO APCAUDPA           22562500
225626                                               APCTOLPA           22562600
225627                                               ANEXCDPA           22562700
225628                                               AMAXCKPA           22562800
225629                                               AMINCKPA           22562900
225630                                               ADCCHKPA           22563000
225632                                               ACHKDYPA           22563200
225633            MOVE DP015-BLUE                 TO APCAUDPC           22563300
225634                                               APCTOLPC           22563400
225635                                               ANEXCDPC           22563500
225636                                               AMAXCKPC           22563600
225637                                               AMINCKPC           22563700
225638                                               ADCCHKPC           22563800
225640                                               ACHKDYPC           22564000
225641            MOVE DP015-HL-OFF               TO APCAUDPH           22564100
225642                                               APCTOLPH           22564200
225643                                               ANEXCDPH           22564300
225644                                               AMAXCKPH           22564400
225645                                               AMINCKPH           22564500
225646                                               ADCCHKPH           22564600
225648                                               ACHKDYPH           22564800
225649         END-IF                                                   22564900
225650                                                                  22565000
225651         IF ASC-ADD-UPD-PS                                        22565100
225652            IF ASC-PKGNG-TYP-CDE-PS > SPACES                      22565200
225653               CONTINUE                                           22565300
225654            ELSE                                                  22565400
225655               MOVE PC-VEND-RANK-TYP-PS                           22565500
225656                                     TO SUT00020-PKGNG-TYP-CDE    22565600
225657                                        ASC-PKGNG-TYP-CDE-PS      22565700
225658               PERFORM 6200-INSERT-VND-PKGNG-ASSN                 22565800
225659            END-IF                                                22565900
225660            PERFORM 5500-FIELD-MOVES-FOR-PS                       22566000
225661            PERFORM 6300-INSERT-PO-AUD-PARM                       22566100
225662            MOVE DP015-ASK-NOR-OFF          TO APCAUDSA           22566200
225664                                               AMAXCKSA           22566400
225665                                               AMINCKSA           22566500
225666                                               ADCCHKSA           22566600
225668                                               ACHKDYSA           22566800
225669            MOVE DP015-BLUE                 TO APCAUDSC           22566900
225672                                               AMAXCKSC           22567200
225673                                               AMINCKSC           22567300
225674                                               ADCCHKSC           22567400
225676                                               ACHKDYSC           22567600
225677            MOVE DP015-HL-OFF               TO APCAUDSH           22567700
225680                                               AMAXCKSH           22568000
225681                                               AMINCKSH           22568100
225682                                               ADCCHKSH           22568200
225684                                               ACHKDYSH           22568400
225690         END-IF.                                                  22569000
225650                                                                  22570000
      *SB 10/07/13 - BEGIN PR#5148D                                     22570100
225651         IF ASC-ADD-UPD-RF                                        22571000
225652            IF ASC-PKGNG-TYP-CDE-RF > SPACES                      22572000
225653               CONTINUE                                           22573000
225654            ELSE                                                  22574000
225655               MOVE PC-VEND-RANK-TYP-RF                           22575000
225656                                     TO SUT00020-PKGNG-TYP-CDE    22576000
225657                                        ASC-PKGNG-TYP-CDE-RF      22577000
225658               PERFORM 6200-INSERT-VND-PKGNG-ASSN                 22578000
225659            END-IF                                                22579000
225660            PERFORM 5600-FIELD-MOVES-FOR-RF                       22579100
225661            PERFORM 6300-INSERT-PO-AUD-PARM                       22579200
225662            MOVE DP015-ASK-NOR-OFF          TO APCAUDRA           22579300
225664                                               AMAXCKRA           22579400
225665                                               AMINCKRA           22579500
225666                                               ADCCHKRA           22579600
225668                                               ACHKDYRA           22579700
225669            MOVE DP015-BLUE                 TO APCAUDRC           22579800
225672                                               AMAXCKRC           22579900
225673                                               AMINCKRC           22580000
225674                                               ADCCHKRC           22581000
225676                                               ACHKDYRC           22582000
225677            MOVE DP015-HL-OFF               TO APCAUDRH           22583000
225680                                               AMAXCKRH           22584000
225681                                               AMINCKRH           22585000
225682                                               ADCCHKRH           22586000
225684                                               ACHKDYRH           22587000
225690         END-IF.                                                  22588000
      *SB 10/07/13 - END PR#5148D                                       22589000
225800                                                                  22590000
229400*                                                                 22940000
229500******************************************************************22950000
229600 5300-FIELD-MOVES-FOR-BC.                                         22960000
229601******************************************************************22960100
229602                                                                  22960200
229610       MOVE ASC-VEND-RNK-CDE        TO   SUT00017-VND-RNKG-CDE    22961000
229620       MOVE PC-VEND-RANK-TYP-BC     TO   SUT00017-PKGNG-TYP-CDE   22962000
229631                                                                  22963100
229640       MOVE ASC-AUD-PCT-BC          TO   SUT00017-AUD-PCT         22964000
229650       MOVE ASC-CKD-PCT-BC          TO   SUT00017-CKD-PCT         22965000
229660       MOVE ASC-MAX-CKD-QTY-BC-N    TO   SUT00017-MAX-CKD-QTY     22966000
229670       MOVE ASC-MAX-CART-CKD-QTY-BC-N                             22967000
229671                                    TO   SUT00017-MAX-CART-CKD-QTY22967100
229680       MOVE ASC-MIN-CART-CKD-QTY-BC-N                             22968000
229681                                    TO   SUT00017-MIN-CART-CKD-QTY22968100
229690       MOVE ASC-CKD-DC-QTY-BC-N     TO   SUT00017-CKD-DC-QTY      22969000
229691       MOVE ASC-MAX-PO-LNE-QTY-BC-N                               22969100
229692                                    TO   SUT00017-MAX-PO-LNE-QTY  22969200
229693       MOVE ASC-CK-AFT-DAY-QTY-BC-N                               22969300
229694                                    TO   SUT00017-CK-AFT-DAY-QTY  22969400
229695       MOVE ZEROES                  TO   SUT00017-CK-AFT-RCVR-QTY.22969500
229696                                                                  22969600
229700 5400-FIELD-MOVES-FOR-PP.                                         22970000
229701                                                                  22970100
229710       MOVE ASC-VEND-RNK-CDE        TO   SUT00017-VND-RNKG-CDE    22971000
229720       MOVE PC-VEND-RANK-TYP-PP     TO   SUT00017-PKGNG-TYP-CDE   22972000
229730                                                                  22973000
229740       MOVE ASC-AUD-PCT-PP          TO   SUT00017-AUD-PCT         22974000
229750       MOVE ASC-CKD-PCT-PP          TO   SUT00017-CKD-PCT         22975000
229760       MOVE ASC-MAX-CKD-QTY-PP-N    TO   SUT00017-MAX-CKD-QTY     22976000
229770       MOVE ASC-MAX-CART-CKD-QTY-PP-N                             22977000
229771                                    TO   SUT00017-MAX-CART-CKD-QTY22977100
229780       MOVE ASC-MIN-CART-CKD-QTY-PP-N                             22978000
229781                                    TO   SUT00017-MIN-CART-CKD-QTY22978100
229790       MOVE ASC-CKD-DC-QTY-PP-N     TO   SUT00017-CKD-DC-QTY      22979000
229792       MOVE ASC-CK-AFT-DAY-QTY-PP-N TO   SUT00017-CK-AFT-DAY-QTY  22979200
229793       MOVE ZEROES                  TO   SUT00017-CK-AFT-RCVR-QTY.22979300
229794                                                                  22979400
229800 5500-FIELD-MOVES-FOR-PS.                                         22980000
229900                                                                  22990000
230000       MOVE ASC-VEND-RNK-CDE        TO   SUT00017-VND-RNKG-CDE    23000000
230100       MOVE PC-VEND-RANK-TYP-PS     TO   SUT00017-PKGNG-TYP-CDE   23010000
230200                                                                  23020000
230300       MOVE ASC-AUD-PCT-PS          TO   SUT00017-AUD-PCT         23030000
230400       MOVE ZEROES                  TO   SUT00017-CKD-PCT.        23040000
230600       MOVE ASC-MAX-CART-CKD-QTY-PS-N                             23060000
230610                                    TO   SUT00017-MAX-CART-CKD-QTY23061000
230620                                         SUT00017-MAX-CKD-QTY     23062000
230700       MOVE ASC-MIN-CART-CKD-QTY-PS-N                             23070000
230710                                    TO   SUT00017-MIN-CART-CKD-QTY23071000
230800       MOVE ASC-CKD-DC-QTY-PS-N     TO   SUT00017-CKD-DC-QTY      23080000
231000       MOVE ASC-CK-AFT-DAY-QTY-PS-N TO   SUT00017-CK-AFT-DAY-QTY  23100000
231110       MOVE ZEROES                  TO   SUT00017-CK-AFT-RCVR-QTY.23111000
229794                                                                  23112000
      *SB 10/07/13 - BEGIN PR#5148D                                     23112100
229800 5600-FIELD-MOVES-FOR-RF.                                         23113000
229900                                                                  23114000
230000       MOVE ASC-VEND-RNK-CDE        TO   SUT00017-VND-RNKG-CDE    23115000
230100       MOVE PC-VEND-RANK-TYP-RF     TO   SUT00017-PKGNG-TYP-CDE   23116000
230200                                                                  23117000
230300       MOVE ASC-AUD-PCT-RF          TO   SUT00017-AUD-PCT         23118000
230400       MOVE ZEROES                  TO   SUT00017-CKD-PCT.        23119000
230600       MOVE ASC-MAX-CART-CKD-QTY-RF-N                             23119100
230610                                    TO   SUT00017-MAX-CART-CKD-QTY23119200
230620                                         SUT00017-MAX-CKD-QTY     23119300
230700       MOVE ASC-MIN-CART-CKD-QTY-RF-N                             23119400
230710                                    TO   SUT00017-MIN-CART-CKD-QTY23119500
230800       MOVE ASC-CKD-DC-QTY-RF-N     TO   SUT00017-CKD-DC-QTY      23119600
231000       MOVE ASC-CK-AFT-DAY-QTY-RF-N TO   SUT00017-CK-AFT-DAY-QTY  23119700
231110       MOVE ZEROES                  TO   SUT00017-CK-AFT-RCVR-QTY.23119800
      *SB 10/07/13 - END PR#5148D                                       23119900
231200*                                                                 23120000
231300*----------------------------------------------------------------*23130000
231400* INSERT A ROW INTO THE SUT_VND_RNKG_CDE (SUT00016)              *23140000
231500*----------------------------------------------------------------*23150000
231600 6000-UPD-VND-RNKG-CDE-DESC.                                      23160000
231700                                                                  23170000
232300     MOVE ASC-VEND-RNK-CDE    TO SUT00016-VND-RNKG-CDE.           23230000
232600     MOVE ASC-VEND-RNK-DESC   TO SUT00016-VND-RNKG-DESC.          23260000
232601                                                                  23260100
232610     EXEC SQL                                                     23261000
232620         UPDATE SUT_VND_RNKG_CDE                                  23262000
232630         SET                                                      23263000
232640             VND_RNKG_DESC   =  :SUT00016-VND-RNKG-DESC           23264000
232660          WHERE                                                   23266000
232670             VND_RNKG_CDE    =  :SUT00016-VND-RNKG-CDE            23267000
232680     END-EXEC.                                                    23268000
232700                                                                  23270000
237300                                                                  23730000
237400       EVALUATE TRUE                                              23740000
237500           WHEN SQLCODE = +0                                      23750000
237510               CONTINUE                                           23751000
237600           WHEN SQLCODE = -904                                    23760000
237700           WHEN SQLCODE = -913                                    23770000
238500           WHEN SQLWARN0 NOT = SPACES                             23850000
238600           WHEN SQLCODE < +0                                      23860000
238700           WHEN SQLCODE > +0                                      23870000
238800               MOVE '6000-UPD-VND-RNKG-CDE-DESC'                  23880000
238900                                 TO DP013-PARAGRAPH               23890000
239000               MOVE 'ERR UPDATING DESC TO SUT_VND_RNKG_CDE'       23900000
239100                                 TO DP013-MESSAGE-TEXT (1)        23910000
239200               MOVE SQLCA        TO DP013-SQLCA                   23920000
239300               MOVE 'SUT_VND_RNKG_CDE'                            23930000
239310                                 TO DP013-DB2-TABLE-NAME (1)      23931000
239400               SET DP013-DB2-ABEND                                23940000
239500                   DP013-XCTL-DISPLAY-RESTART TO TRUE             23950000
239600               PERFORM DP013-0000-PROCESS-ABEND                   23960000
239700       END-EVALUATE.                                              23970000
241400*                                                                 24140000
241410*----------------------------------------------------------------*24141000
241420* INSERT A ROW INTO THE SUT_VND_RNKG_CDE (SUT00016)              *24142000
241430*----------------------------------------------------------------*24143000
241440 6100-INSERT-VND-RNKG-CDE.                                        24144000
241450     MOVE ASC-VEND-RNK-CDE    TO SUT00016-VND-RNKG-CDE.           24145000
241460     MOVE ASC-VEND-RNK-DESC   TO SUT00016-VND-RNKG-DESC.          24146000
241470                                                                  24147000
241480       EXEC SQL                                                   24148000
241490           INSERT INTO SUT_VND_RNKG_CDE                           24149000
241491           (                                                      24149100
241492            VND_RNKG_CDE                                          24149200
241493           ,VND_RNKG_DESC                                         24149300
241494           )                                                      24149400
241495           VALUES                                                 24149500
241496           (                                                      24149600
241497            :SUT00016-VND-RNKG-CDE                                24149700
241498           ,:SUT00016-VND-RNKG-DESC                               24149800
241499           )                                                      24149900
241500       END-EXEC                                                   24150000
241501                                                                  24150100
241502       EVALUATE TRUE                                              24150200
241503           WHEN SQLCODE = +0                                      24150300
241504               CONTINUE                                           24150400
241505           WHEN SQLCODE = -904                                    24150500
241506           WHEN SQLCODE = -913                                    24150600
241507           WHEN SQLWARN0 NOT = SPACES                             24150700
241508           WHEN SQLCODE < +0                                      24150800
241509           WHEN SQLCODE > +0                                      24150900
241510               MOVE '6100-INSERT-VND-RNKG-CDE'                    24151000
241511                                 TO DP013-PARAGRAPH               24151100
241512               MOVE 'ERR INSERTING ROW TO SUT_VND_RNKG_CDE'       24151200
241513                                 TO DP013-MESSAGE-TEXT (1)        24151300
241514               MOVE SQLCA        TO DP013-SQLCA                   24151400
241515               MOVE 'SUT_VND_RNKG_CDE'                            24151500
241516                                 TO DP013-DB2-TABLE-NAME (1)      24151600
241517               SET DP013-DB2-ABEND                                24151700
241518                   DP013-XCTL-DISPLAY-RESTART TO TRUE             24151800
241519               PERFORM DP013-0000-PROCESS-ABEND                   24151900
241520       END-EVALUATE.                                              24152000
241521*                                                                 24152100
241530*                                                                 24153000
241600*----------------------------------------------------------------*24160000
241700* INSERT A ROW INTO THE  SUT_VND_PKGNG_ASSN  (SUT00020)          *24170000
241800*----------------------------------------------------------------*24180000
241900 6200-INSERT-VND-PKGNG-ASSN.                                      24190000
242600                                                                  24260000
242610     MOVE ASC-VEND-RNK-CDE    TO SUT00020-VND-RNKG-CDE            24261000
242630                                                                  24263000
242640                                                                  24264000
242700     PERFORM                                                      24270000
242710         WITH TEST AFTER                                          24271000
242720         VARYING PV-RETRY-COUNTER                                 24272000
242730         FROM 1 BY 1                                              24273000
242740         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               24274000
242750         OR      SQLCODE = ZERO)                                  24275000
242760                                                                  24276000
242770                                                                  24277000
242800         EXEC SQL                                                 24280000
242900             INSERT INTO SUT_VND_PKGNG_ASSN                       24290000
243000             (                                                    24300000
243100                  VND_RNKG_CDE                                    24310000
243200                 ,PKGNG_TYP_CDE                                   24320000
243700             )                                                    24370000
243800             VALUES                                               24380000
243900             (                                                    24390000
244000                  :SUT00020-VND-RNKG-CDE                          24400000
244100                 ,:SUT00020-PKGNG-TYP-CDE                         24410000
244600             )                                                    24460000
244700         END-EXEC                                                 24470000
244900*                                                                 24490000
249500                                                                  24950000
249600         EVALUATE TRUE                                            24960000
249700             WHEN SQLCODE = +0                                    24970000
249800             WHEN SQLCODE = -904                                  24980000
249900             WHEN SQLCODE = -913                                  24990000
249910                 CONTINUE                                         24991000
250100             WHEN SQLWARN0 NOT = SPACES                           25010000
250200             WHEN SQLCODE < +0                                    25020000
250300             WHEN SQLCODE > +0                                    25030000
250400                MOVE '6200-INSERT-VND-PKGNG-ASSN'                 25040000
250500                                   TO DP013-PARAGRAPH             25050000
250600                MOVE 'ERROR INSERTING ROW INTO VND_PKGNG_ASSN '   25060000
250700                                   TO DP013-MESSAGE-TEXT (1)      25070000
250800                MOVE SQLCA        TO DP013-SQLCA                  25080000
250900                MOVE 'VND_PKGNG_ASSN' TO DP013-DB2-TABLE-NAME (1) 25090000
251000                SET DP013-DB2-ABEND                               25100000
251100                     DP013-XCTL-DISPLAY-RESTART TO TRUE           25110000
251200                PERFORM DP013-0000-PROCESS-ABEND                  25120000
251300         END-EVALUATE                                             25130000
251400     END-PERFORM.                                                 25140000
251500     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         25150000
251600         MOVE '6200-INSERT-VND-PKGNG-ASSN'                        25160000
251700                             TO DP013-PARAGRAPH                   25170000
251800         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     25180000
251900                             TO DP013-MESSAGE-TEXT (1)            25190000
252000         MOVE 'APPLICATION SYS ID FOR SYS ID: '                   25200000
252100                             TO DP013-MESSAGE-TEXT (2)            25210000
252200         MOVE SQLCA          TO DP013-SQLCA                       25220000
252300         MOVE 'TPRTRTK'      TO DP013-DB2-TABLE-NAME (1)          25230000
252400         SET DP013-DB2-ABEND                                      25240000
252500             DP013-XCTL-DISPLAY-RESTART                           25250000
252600                             TO TRUE                              25260000
252700         PERFORM DP013-0000-PROCESS-ABEND                         25270000
252800     END-IF.                                                      25280000
252900     MOVE +0 TO PV-RETRY-COUNTER.                                 25290000
253000*                                                                 25300000
253100*                                                                 25310000
253110*----------------------------------------------------------------*25311000
253120* INSERT A ROW INTO THE SUT_PO_AUD_PARM  (SUT00017)               25312000
253130*----------------------------------------------------------------*25313000
253140 6300-INSERT-PO-AUD-PARM.                                         25314000
253150     PERFORM                                                      25315000
253160         WITH TEST AFTER                                          25316000
253170         VARYING PV-RETRY-COUNTER                                 25317000
253180         FROM 1 BY 1                                              25318000
253190         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               25319000
253191         OR      SQLCODE = ZERO)                                  25319100
253192                                                                  25319200
253193             EXEC SQL                                             25319300
253194                 INSERT INTO SUT_PO_AUD_PARM                      25319400
253195                  ( VND_RNKG_CDE                                  25319500
253196                   ,PKGNG_TYP_CDE                                 25319600
253197                   ,EFF_BEG_TMST                                  25319700
253198                   ,AUD_PCT                                       25319800
253199                   ,CKD_PCT                                       25319900
253200                   ,MAX_CKD_QTY                                   25320000
253201                   ,MAX_CART_CKD_QTY                              25320100
253202                   ,MIN_CART_CKD_QTY                              25320200
253203                   ,CKD_DC_QTY                                    25320300
253204                   ,MAX_PO_LNE_QTY                                25320400
253205                   ,CK_AFT_DAY_QTY                                25320500
253206                   ,CK_AFT_RCVR_QTY                               25320600
253207                  )                                               25320700
253212                 VALUES                                           25321200
253213                 ( :SUT00017-VND-RNKG-CDE                         25321300
253214                 , :SUT00017-PKGNG-TYP-CDE                        25321400
253215                 ,  CURRENT TIMESTAMP                             25321500
253216                 , :SUT00017-AUD-PCT                              25321600
253217                 , :SUT00017-CKD-PCT                              25321700
253218                 , :SUT00017-MAX-CKD-QTY                          25321800
253219                 , :SUT00017-MAX-CART-CKD-QTY                     25321900
253220                 , :SUT00017-MIN-CART-CKD-QTY                     25322000
253221                 , :SUT00017-CKD-DC-QTY                           25322100
253222                 , :SUT00017-MAX-PO-LNE-QTY                       25322200
253223                 , :SUT00017-CK-AFT-DAY-QTY                       25322300
253224                 , :SUT00017-CK-AFT-RCVR-QTY                      25322400
253225                 )                                                25322500
253230             END-EXEC                                             25323000
253232*                                                                 25323200
253233                                                                  25323300
253234         EVALUATE TRUE                                            25323400
253235             WHEN SQLCODE = +0                                    25323500
253236             WHEN SQLCODE = -904                                  25323600
253237             WHEN SQLCODE = -913                                  25323700
253239                 SET ASC-PO-AUD-PARM-INSERTED-Y TO TRUE           25323900
253240             WHEN SQLWARN0 NOT = SPACES                           25324000
253241             WHEN SQLCODE < +0                                    25324100
253242             WHEN SQLCODE > +0                                    25324200
253243                 SET ASC-PO-AUD-PARM-INSERTED-N TO TRUE           25324300
253244                 MOVE '6300-INSERT-PO-AUD-PARM'                   25324400
253245                                   TO DP013-PARAGRAPH             25324500
253246                 MOVE 'ERROR INSERTING ROW '                      25324600
253247                                   TO DP013-MESSAGE-TEXT (1)      25324700
253248                 MOVE SQLCA        TO DP013-SQLCA                 25324800
253249                 MOVE 'SUT_PO_AUD_PARM'                           25324900
253250                                   TO DP013-DB2-TABLE-NAME (1)    25325000
253251                 SET DP013-DB2-ABEND                              25325100
253252                     DP013-XCTL-DISPLAY-RESTART TO TRUE           25325200
253253                 PERFORM DP013-0000-PROCESS-ABEND                 25325300
253254         END-EVALUATE                                             25325400
253255     END-PERFORM.                                                 25325500
253256     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         25325600
253257         SET ASC-PO-AUD-PARM-INSERTED-N TO TRUE                   25325700
253258         MOVE '6300-INSERT-PO-AUD-PARM'                           25325800
253259                             TO DP013-PARAGRAPH                   25325900
253260         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     25326000
253261                             TO DP013-MESSAGE-TEXT (1)            25326100
253262         MOVE 'APPLICATION SYS ID FOR SYS ID: '                   25326200
253263                             TO DP013-MESSAGE-TEXT (2)            25326300
253264         MOVE SQLCA          TO DP013-SQLCA                       25326400
253265         MOVE 'SUT_PO_AUD_PARM'  TO DP013-DB2-TABLE-NAME (1)      25326500
253266         SET DP013-DB2-ABEND                                      25326600
253267             DP013-XCTL-DISPLAY-RESTART                           25326700
253268                             TO TRUE                              25326800
253269         PERFORM DP013-0000-PROCESS-ABEND                         25326900
253270     END-IF.                                                      25327000
253271     MOVE +0 TO PV-RETRY-COUNTER.                                 25327100
253272*                                                                 25327200
253280*                                                                 25328000
285565*                                                                 28556500
285570*----------------------------------------------------------------*28557000
285600* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *28560000
285700*----------------------------------------------------------------*28570000
285800 9100-READ-SEL-QUEUE.                                             28580000
285900     EXEC CICS                                                    28590000
286000         READQ TS                                                 28600000
286100             QUEUE (ASC-SEL-QUEUE-NAME)                           28610000
286200             INTO  (SU016-SELECT-RECORD)                          28620000
286300             ITEM  (ASC-SEL-ITEM)                                 28630000
286400             RESP  (PV-CICS-RESPONSE)                             28640000
286500     END-EXEC.                                                    28650000
286600                                                                  28660000
286700     IF  PV-CICS-RESPONSE = DFHRESP(NORMAL)  OR                   28670000
286710        (PV-CICS-RESPONSE = DFHRESP(QIDERR))                      28671000
286800            CONTINUE                                              28680000
286900     ELSE                                                         28690000
287000         SET DP013-LOGIC-ABEND                                    28700000
287100             DP013-NO-ROLLBACK     TO TRUE                        28710000
287200         MOVE '9100-READ-SEL-QUEUE'                               28720000
287300                                   TO DP013-PARAGRAPH             28730000
287400         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   28740000
287500                                   TO DP013-MESSAGE-TEXT (1)      28750000
287600         PERFORM DP013-0000-PROCESS-ABEND                         28760000
287700     END-IF.                                                      28770000
287800*                                                                 28780000
287900*                                                                 28790000
288000*----------------------------------------------------------------*28800000
288100* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *28810000
288200*----------------------------------------------------------------*28820000
288300 9200-REWRITE-SEL-QUEUE.                                          28830000
288400     EXEC CICS                                                    28840000
288500          WRITEQ TS                                               28850000
288600              QUEUE  (ASC-SEL-QUEUE-NAME)                         28860000
288700              FROM   (SU016-SELECT-RECORD)                        28870000
288800              ITEM   (ASC-SEL-ITEM)                               28880000
288900              RESP   (PV-CICS-RESPONSE)                           28890000
289000              REWRITE                                             28900000
289100     END-EXEC.                                                    28910000
289200                                                                  28920000
289210     IF  PV-CICS-RESPONSE = DFHRESP(NORMAL)  OR                   28921000
289220        (PV-CICS-RESPONSE = DFHRESP(QIDERR))                      28922000
289230            CONTINUE                                              28923000
289240     ELSE                                                         28924000
289400         SET DP013-CICS-ABEND                                     28940000
289500             DP013-NO-ROLLBACK     TO TRUE                        28950000
289600         MOVE '9200-REWRITE-SEL-QUEUE'                            28960000
289700                                   TO DP013-PARAGRAPH             28970000
289800         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   28980000
289900                                   TO DP013-MESSAGE-TEXT (1)      28990000
290000         PERFORM DP013-0000-PROCESS-ABEND                         29000000
290100     END-IF.                                                      29010000
290200*                                                                 29020000
290300*                                                                 29030000
290400     COPY DPPD013.                                                29040000
290500*----------------------------------------------------------------*29050000
290600*    ABEND PROCESSOR MODULE                                      *29060000
290700*----------------------------------------------------------------*29070000
