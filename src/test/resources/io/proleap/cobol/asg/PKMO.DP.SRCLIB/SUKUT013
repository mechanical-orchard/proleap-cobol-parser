000100******************************************************************00010060
000200 IDENTIFICATION DIVISION.                                         00020060
000300******************************************************************00030060
000400 PROGRAM-ID.    SUKUT013.                                         00040060
000500 AUTHOR.        DEANNA BRANTNER                                   00050060
000600 INSTALLATION.  KOHLS.                                            00060060
000700 DATE-WRITTEN   MARCH, 2002.                                      00070060
000800 DATE-COMPILED.                                                   00080060
000900******************************************************************00090060
001000*  THIS PROGRAM WILL READ THE INPUT FILE, PKMT.SU.TSUOBTS.UNLOAD, 00100060
001100*  AND RETRIEVE CARTON DATA WHICH WILL BE USED TO UPDATE IN-      00110060
001200*  TRANSIT TABLES.                                                00120060
001300*  IT WILL ALSO CREATE AN OUTPUT FILE WHICH WILL BE USED TO UPDATE00130060
001400*  SUT_OTBND_CART WITH OUTBOUND TRIP ID USING PROGRAM SUKUP013.   00140060
001500******************************************************************00150060
001600******************************************************************00160060
001700*  CHANGE LOG                                                     00170060
001800*  DATE       CHANGED BY    DESC                                  00180060
001900*  ---------- ------------- --------------------------------------00190060
002000*  03-12-2010 B. GRAHAM - KFORCE                                  00200060
002100*                         WR 38216 EFC2 CHANGES                   00210060
002200*                         TRANSLATE EFC2 NUMBER BACK TO EFC1      00220060
002300*                         NUMBER.                                 00230060
002400*                         ALL CHANGES TO THE PROGRAM CAN BE FOUND 00240060
002500*                         BY SEARCHING FOR 'W38216' IN COLUMNS    00250060
002600*                         1 THRU 6                                00260060
002700*  09-22-2011 CHRISTINE TWIEHAUS                                  00270060
002800*             MLOF WR38972 REVERSE OUT STORE TRANSLATION          00280060
002900*  06-17-2013 RAVI GUNTHA (COGNIZANT) - INC0155049/CHG0056161     00290060
003000*             CHANGES MADE TO PARA 8000-WRITE-OUTPUT TO WRITE     00300060
003100*             SU103-EXTRACT-RECORD (MLS RECORD) ONLY IF           00310060
003200*             PC010-SHIPPD-DC IS SET.                             00320060
003300*             ALL CHANGES CAN BE FOUND BY SEARCHING FOR 'C56161'  00330060
003400*  02-25-2016 CHERI PARMLEY                                       00340060
003500*             CREATE NEW OUTPUT FILE SIMILAR TO THE SURD103       00350060
003600*             WITH ADDED FIELDS FOR TRAILER ID, SERIAL ID SEAL ID,00360060
003700*             SHIPPING RDC AND SCAC. FILE WILL BE NEEDED FOR      00370060
003800*             OMS/GIV.                                            00380060
003900*  07-07-2016 CHERI PARMLEY                                       00390099
004000*             ADDED 4 NEW FIELDS TO THE OFRD011 COPYBOOK FOR      00400060
004100*             OMS/GIV. PO, REC SEQ NBR, COST AND RETAIL.          00410060
004200*             CHANGES BEGIN IN 5250-FETCH-CSR AND THEN INCLUDE    00420060
004300*             NEW PARA 5251-GET-COST-RETAIL.                      00430060
004400*  01-06-2017 CHERI PARMLEY                                       00440060
004500*             DO NOT SEND FAST TRANSFERS TO THE OFRD011 OMS FILE  00450060
004600*             AND THE SURD103 MLS FILE. THIS CHECK IS IN          00460062
004700*             8000-WRITE-OUTPUT.                                  00470062
004800*  02-17-2017 CHERI PARMLEY                                       00480084
004900*             FAST TRANSFERS WILL NOW BE SENT TO OMS AND MLS      00490066
005000*             NEW COMBINED FILE IS CREATED IN PLACE OF OUT04 AND  00500066
005100*             OUT05 FOR OMS AND MLS. NEW FIELDS HAVE BEEN ADDED   00510066
005200*             THEY INCLUDE: (NEW COPYBOOK SURD136)                00520069
005300*                       SML TYPE                                  00530066
005400*                       SML TIMESTAMP ON TRAILER                  00540066
005500*                       SML CREATE TIMESTAMP AT DC                00550066
005510*  05-17-2017 GERMAN BANDA                                        00551099
005520*             CHANGED PROGRAM TO SEND FAST TRANSFERS BASED ON     00552099
005530*             STORE RECEIVING PARM ('STOTBNDUPD' ) IF STORE IS    00553099
005540*             ACTIVE, THE FXR RECORDS WILL BE WRITTEN, OTHERWISE  00554099
005550*             THEY WILL NOT BE WRITTEN TO THE MANIFEST FILE       00555099
005560*             PARAS 3620-CHECK-SEND-FXR 8120-CHECK-STR-SCANNING   00556099
005550*                                                                 00556199
005510*  07-25-2017 RONALD KRIER                                        00557099
005520*             MADE A CHANGE TO 8110 TO HANDLE THE                 00558099
005530*             PC046-CRTN-STAT-ERROR RETURN CODE TO GO AND GET THE 00559099
005540*             MOST RECENT DIVERT FOR THE CARTON. THIS WAS DONE TO 00560099
005550*             PREVENT SUK060 FROM FAILING.                        00561099
005550*             ADDED 2 NEW PARAS 8111-EXEC-MODULE-CALL AND         00562099
005550*             8112-GET-ON-TRLR-TIMESTAMP.                         00563099
005700******************************************************************00570060
005800 ENVIRONMENT DIVISION.                                            00580060
005900 CONFIGURATION SECTION.                                           00590060
006000                                                                  00600060
006100 SOURCE-COMPUTER.        IBM-3090.                                00610060
006200 OBJECT-COMPUTER.        IBM-3090.                                00620060
006300                                                                  00630060
006400 INPUT-OUTPUT SECTION.                                            00640060
006500 FILE-CONTROL.                                                    00650060
006600                                                                  00660060
006700     SELECT TSUOBTS-UNLOAD-FILE                                   00670060
006800         ASSIGN TO IN01.                                          00680060
006900                                                                  00690060
007000     SELECT CARTON-DETAIL-FILE                                    00700060
007100         ASSIGN TO OUT01.                                         00710060
007200                                                                  00720060
007300     SELECT CARTON-TRIP-FILE                                      00730060
007400         ASSIGN TO OUT02.                                         00740060
007500                                                                  00750060
007600     SELECT EMPTY-CARTON-FILE                                     00760060
007700         ASSIGN TO OUT03.                                         00770060
007800                                                                  00780060
007900***  ADDED 2/17/17 CLP                                            00790067
008000     SELECT COMB-OMS-MLS-FILE                                     00800067
008100         ASSIGN TO OUT04.                                         00810099
008200******************************************************************00820060
008300 DATA DIVISION.                                                   00830060
008400 FILE SECTION.                                                    00840060
008500                                                                  00850060
008600 FD  TSUOBTS-UNLOAD-FILE                                          00860060
008700     RECORDING MODE IS F                                          00870060
008800     LABEL RECORDS ARE STANDARD                                   00880060
008900     BLOCK CONTAINS 0 RECORDS.                                    00890060
009000                                                                  00900060
009100 01  TSUOBTS-UNLOAD-RECORD   PIC  X(13).                          00910060
009200*                                                                 00920060
009300 FD  CARTON-DETAIL-FILE                                           00930060
009400     RECORDING MODE IS F                                          00940060
009500     LABEL RECORDS ARE STANDARD                                   00950060
009600     BLOCK CONTAINS 0 RECORDS.                                    00960060
009700                                                                  00970060
009800 01  CARTON-DETAIL-RECORD   PIC  X(100).                          00980060
009900*                                                                 00990060
010000 FD  CARTON-TRIP-FILE                                             01000060
010100     RECORDING MODE IS F                                          01010060
010200     LABEL RECORDS ARE STANDARD                                   01020060
010300     BLOCK CONTAINS 0 RECORDS.                                    01030060
010400                                                                  01040060
010500 01  CARTON-TRIP-RECORD   PIC  X(050).                            01050060
010600*                                                                 01060060
010700 FD  EMPTY-CARTON-FILE                                            01070060
010800     RECORDING MODE IS F                                          01080060
010900     LABEL RECORDS ARE STANDARD                                   01090060
011000     BLOCK CONTAINS 0 RECORDS.                                    01100060
011100                                                                  01110060
011200 01  EMPTY-CARTON-RECORD   PIC  X(125).                           01120060
011300*                                                                 01130060
011400*** ADDED 2/17/17 CLP                                             01140067
011500*                                                                 01150067
011600 FD  COMB-OMS-MLS-FILE                                            01160067
011700     RECORDING MODE IS F                                          01170067
011800     LABEL RECORDS ARE STANDARD                                   01180067
011900     BLOCK CONTAINS 0 RECORDS.                                    01190067
012000                                                                  01200067
012100 01  OMS-MLS-RECORD        PIC  X(200).                           01210067
012200******************************************************************01220060
012300 WORKING-STORAGE SECTION.                                         01230060
012400******************************************************************01240060
012500******************************************************************01250060
012600*  INPUT FILE LAYOUT                                              01260060
012700******************************************************************01270060
012800     COPY SURD012.                                                01280060
012900*                                                                 01290060
013000******************************************************************01300060
013100*  CARTON OUTPUT FILE LAYOUT                                      01310060
013200******************************************************************01320060
013300     COPY PCRD010.                                                01330060
013400                                                                  01340060
013500***********************************************************       01350060
013600*  RECORD LAYOUT FOR THE CARTON TRIP EXTRACT FILE                 01360060
013700***********************************************************       01370060
013800     COPY SURD043.                                                01380060
013900                                                                  01390060
014000*    EMPTY CARTON FILE                                            01400060
014100 01  PV-EMPTY-CARTON-REC.                                         01410060
014200     COPY SURD056.                                                01420060
014300                                                                  01430060
014400***********************************************************       01440067
014500*  RECORD LAYOUT FOR THE COMBINED OMS-MLS EXTRACT FILE            01450067
014600*  ADDED 2/17/17 CLP                                              01460067
014700***********************************************************       01470067
014800     COPY SURD136.                                                01480067
014900                                                                  01490067
015000*  ADDED 2/17/17 CLP                                              01500079
015100*COPYBOOK FOR CARTON STATUS MODULE - PCKUT713                     01510079
015200     COPY PCWS046.                                                01520079
015300                                                                  01530079
015400******************************************************************01540060
015500*  DB2 FORMATTED MESSAGE AREA                                     01550060
015600******************************************************************01560060
015700     COPY DPWS004.                                                01570060
015800*                                                                 01580060
015900******************************************************************01590060
016000*  COMMUNICATIONS AREA FOR DB2                                    01600060
016100******************************************************************01610060
016200     EXEC SQL                                                     01620060
016300          INCLUDE SQLCA                                           01630060
016400     END-EXEC.                                                    01640060
016500*                                                                 01650060
016600*---------------------------------------------------------------* 01660060
016700*    TSUOBTR - OUTBOUND TRAILER TRIP                            * 01670060
016800*---------------------------------------------------------------* 01680060
016900     EXEC SQL                                                     01690060
017000          INCLUDE TSUOBTR                                         01700060
017100     END-EXEC.                                                    01710060
017200                                                                  01720060
017300*---------------------------------------------------------------* 01730060
017400*    TSUOBTS - OUTBOUND TRAILER TRIP STATUS                     * 01740060
017500*---------------------------------------------------------------* 01750060
017600     EXEC SQL                                                     01760060
017700          INCLUDE TSUOBTS                                         01770060
017800     END-EXEC.                                                    01780060
017900                                                                  01790060
018000*---------------------------------------------------------------* 01800060
018100*    TSUOBSC - TRIP STATUS CODE DESCRIPTION                       01810060
018200*---------------------------------------------------------------* 01820060
018300     EXEC SQL                                                     01830060
018400          INCLUDE TSUOBSC                                         01840060
018500     END-EXEC.                                                    01850060
018600                                                                  01860060
018700*---------------------------------------------------------------* 01870060
018800*    TSUCDOT - CARTON DIVERT - TRIP ASSOCIATION TABLE             01880060
018900*---------------------------------------------------------------* 01890060
019000     EXEC SQL                                                     01900060
019100          INCLUDE TSUCDOT                                         01910060
019200     END-EXEC.                                                    01920060
019300                                                                  01930060
019400*---------------------------------------------------------------* 01940060
019500*    TSUCRDV - CARTON DIVERT TABLE                                01950060
019600*---------------------------------------------------------------* 01960060
019700     EXEC SQL                                                     01970060
019800          INCLUDE TSUCRDV                                         01980060
019900     END-EXEC.                                                    01990060
020000                                                                  02000060
020100*---------------------------------------------------------------* 02010060
020200*    TSHUNLO SHIPPING UNIT LOCATION TABLE                         02020060
020300*---------------------------------------------------------------* 02030060
020400     EXEC SQL                                                     02040060
020500          INCLUDE SUT00027                                        02050060
020600     END-EXEC.                                                    02060060
020700                                                                  02070060
020800*---------------------------------------------------------------* 02080060
020900*    SUT_OTBND_CART CROSS REFERENCE TABLE                         02090060
021000*---------------------------------------------------------------* 02100060
021100     EXEC SQL                                                     02110060
021200          INCLUDE SUT00024                                        02120060
021300     END-EXEC.                                                    02130060
021400                                                                  02140060
021500*---------------------------------------------------------------* 02150060
021600*    SUT_OTBND_UPC UPC TABLE                                      02160060
021700*---------------------------------------------------------------* 02170060
021800     EXEC SQL                                                     02180060
021900          INCLUDE SUT00028                                        02190060
022000     END-EXEC.                                                    02200060
022100                                                                  02210060
022200*---------------------------------------------------------------* 02220060
022300*    XLT_UPC  TABLE                                               02230060
022400*    ADDED 8/1/11 DMH                                             02240060
022500*---------------------------------------------------------------* 02250060
022600     EXEC SQL                                                     02260060
022700          INCLUDE XLT00006                                        02270060
022800     END-EXEC.                                                    02280060
022900                                                                  02290060
023000*---------------------------------------------------------------* 02300060
023100*    XLT_SKU  TABLE                                               02310060
023200*    ADDED 8/1/11 DMH                                             02320060
023300*---------------------------------------------------------------* 02330060
023400     EXEC SQL                                                     02340060
023500          INCLUDE XLT00003                                        02350060
023600     END-EXEC.                                                    02360060
023700                                                                  02370060
023800*---------------------------------------------------------------* 02380060
023900*    TCNDCDR - DC TO DOOR ASSIGNMENT                            * 02390060
024000*---------------------------------------------------------------* 02400060
024100     EXEC SQL                                                     02410060
024200          INCLUDE TCNDCDR                                         02420060
024300     END-EXEC.                                                    02430060
024400                                                                  02440060
024500*---------------------------------------------------------------* 02450060
024600*   TCNDRST - DC DOOR TO STORE ASSOCIATION TABLE                * 02460060
024700*---------------------------------------------------------------* 02470060
024800     EXEC SQL                                                     02480060
024900          INCLUDE TCNDRST                                         02490060
025000     END-EXEC.                                                    02500060
025100                                                                  02510060
025200*---------------------------------------------------------------* 02520060
025300*    TCNTRID - TRAILIER ID TABLE                                  02530060
025400*---------------------------------------------------------------* 02540060
025500     EXEC SQL                                                     02550060
025600          INCLUDE TCNTRID                                         02560060
025700     END-EXEC.                                                    02570060
025800                                                                  02580060
025900*---------------------------------------------------------------* 02590060
026000*    SUT_OTBND_VND TABLE                                          02600060
026100*---------------------------------------------------------------* 02610060
026200     EXEC SQL                                                     02620060
026300          INCLUDE SUT00026                                        02630060
026400     END-EXEC.                                                    02640060
026500                                                                  02650060
026600*---------------------------------------------------------------* 02660060
026700*    TPKSLIP TABLE                                                02670060
026800*---------------------------------------------------------------* 02680060
026900     EXEC SQL                                                     02690060
027000          INCLUDE TPKSLIP                                         02700060
027100     END-EXEC.                                                    02710060
027200                                                                  02720060
027300* ADDED -07/07/2016 CLP                                           02730060
027400*---------------------------------------------------------------* 02740060
027500*    TRECITM TABLE                                                02750060
027600*---------------------------------------------------------------* 02760060
027700     EXEC SQL                                                     02770060
027800          INCLUDE TRECITM                                         02780060
027900     END-EXEC.                                                    02790060
028000                                                                  02800060
028100*---------------------------------------------------------------* 02810099
028200*    TMDARVS TABLE                                                02820099
028300*---------------------------------------------------------------* 02830099
028400     EXEC SQL                                                     02840099
028500          INCLUDE TMDARVS                                         02850099
028600     END-EXEC.                                                    02860099
028700                                                                  02870099
028800*---------------------------------------------------------------* 02880060
028900*    TPURITM TABLE                                                02890060
029000*---------------------------------------------------------------* 02900060
029100     EXEC SQL                                                     02910060
029200          INCLUDE TPURITM                                         02920060
029300     END-EXEC.                                                    02930060
029400                                                                  02940060
028800*---------------------------------------------------------------* 02941099
028900*    TPURCHS TABLE                                                02942099
029000*---------------------------------------------------------------* 02943099
029100     EXEC SQL                                                     02944099
029200          INCLUDE TPURCHS                                         02945099
029300     END-EXEC.                                                    02946099
029400                                                                  02947099
028800*---------------------------------------------------------------* 02948099
028900*    TSEASET TABLE                                                02949099
029000*---------------------------------------------------------------* 02949199
029100     EXEC SQL                                                     02949299
029200          INCLUDE TSEASET                                         02949399
029300     END-EXEC.                                                    02949499
029400                                                                  02949599
029500*---------------------------------------------------------------* 02950060
029600*    XLV_SKU_STR TABLE                                            02960060
029700*---------------------------------------------------------------* 02970060
029800     EXEC SQL                                                     02980060
029900          INCLUDE XLV00002                                        02990060
030000     END-EXEC.                                                    03000060
030100                                                                  03010060
030200*---------------------------------------------------------------* 03020060
030300*    TKRPRPM  TABLE                                               03030060
030400*---------------------------------------------------------------* 03040060
030500     EXEC SQL                                                     03050060
030600          INCLUDE TKRPRPM                                         03060060
030700     END-EXEC.                                                    03070060
030701                                                                  03070199
030710*---------------------------------------------------------------* 03071099
030720*    WST_INTGRTN_TYP TABLE                                        03072099
030730*---------------------------------------------------------------* 03073099
030740     EXEC SQL                                                     03074099
030750          INCLUDE WST00008                                        03075099
030760     END-EXEC.                                                    03076099
030770                                                                  03077099
030780*---------------------------------------------------------------* 03078099
030790*    WST_ATTR_DEFN TABLE                                          03079099
030791*---------------------------------------------------------------* 03079199
030792     EXEC SQL                                                     03079299
030793          INCLUDE WST00009                                        03079399
030794     END-EXEC.                                                    03079499
030795                                                                  03079599
030796*---------------------------------------------------------------* 03079699
030797*    WST_ATTR_ELEM TABLE                                          03079799
030798*---------------------------------------------------------------* 03079899
030799     EXEC SQL                                                     03079999
030800          INCLUDE WST00010                                        03080099
030801     END-EXEC.                                                    03080199
030810******************************************************************03081099
030900* VARIOUS CURSORS, SELECTS, AND WORKING STORAGE AREAS FOR         03090060
031000* RETRIEVING CARTONS                                              03100060
031100******************************************************************03110060
031200     COPY PCWS049.                                                03120060
031300     COPY PCWS050.                                                03130060
031400                                                                  03140060
031500******************************************************************03150060
031600 01  ABEND-CODE                      PIC S9(04)    VALUE +0       03160060
031700                                                   COMP SYNC.     03170060
031800                                                                  03180060
031900 01  PS-PROGRAM-SWITCHES.                                         03190060
032000     05  PS-END-OF-FILE-SW           PIC  X(01)    VALUE 'N'.     03200060
032100         88  PS-END-OF-FILE                        VALUE 'Y'.     03210060
032200         88  PS-NOT-END-OF-FILE                    VALUE 'N'.     03220060
032300     05  PS-END-OF-CSR-SW            PIC  X(01)    VALUE 'N'.     03230060
032400         88  PS-END-OF-CSR                         VALUE 'Y'.     03240060
032500         88  PS-NOT-END-OF-CSR                     VALUE 'N'.     03250060
032600     05  PS-PROCESS-CRTN-SW          PIC  X(01)    VALUE 'Y'.     03260060
032700         88  PS-PRCSS-CRTN                         VALUE 'Y'.     03270060
032800         88  PS-DONT-PRCSS-CRTN                    VALUE 'N'.     03280060
032900     05  PS-SEND-MANIFEST-TO-MLS-SW  PIC  X(01)    VALUE 'N'.     03290060
033000         88  PS-SEND-MANIFEST-TO-MLS-YES           VALUE 'Y'.     03300060
033100         88  PS-SEND-MANIFEST-TO-MLS-NO            VALUE 'N'.     03310060
033200*ADDED 2/25/16 CLP                                                03320060
033300     05  PS-SEND-MANIFEST-TO-OMS-SW  PIC  X(01)    VALUE 'N'.     03330060
033400         88  PS-SEND-MANIFEST-TO-OMS-YES           VALUE 'Y'.     03340060
033500         88  PS-SEND-MANIFEST-TO-OMS-NO            VALUE 'N'.     03350060
033600*ADDED 1/6/17 CLP                                                 03360060
033700     05  PS-FAST-TRANSFER-SW         PIC  X(01)    VALUE 'N'.     03370060
033800         88  PS-FAST-TRANSFER-YES                  VALUE 'Y'.     03380060
033900         88  PS-FAST-TRANSFER-NO                   VALUE 'N'.     03390060
033910     05  PS-FAST-TRSFR-SEND-SW       PIC  X(01)    VALUE 'N'.     03391099
033920         88  PS-FAST-TRSFR-NNE                     VALUE 'N'.     03392099
033930         88  PS-FAST-TRSFR-EXC                     VALUE 'E'.     03393099
033940         88  PS-FAST-TRSFR-ALL                     VALUE 'A'.     03394099
033950     05  PS-STORE-SCANNING-SW        PIC  X(01)    VALUE 'N'.     03395099
033951         88  PS-SCANNING-STORE                     VALUE 'Y'.     03395199
033960         88  PS-NON-SCANNING-STORE                 VALUE 'N'.     03396099
034000                                                                  03400060
034100 01  PC-PROGRAM-CONSTANTS.                                        03410060
034200     05  PC-A                        PIC  X(01)    VALUE 'A'.     03420060
034300     05  PC-Y                        PIC  X(01)    VALUE 'Y'.     03430099
034400     05  PC-DS                       PIC  X(02)    VALUE 'DS'.    03440060
034500     05  PC-SU                       PIC  X(02)    VALUE 'SU'.    03450060
034600     05  PC-SH                       PIC  X(02)    VALUE 'SH'.    03460060
034700     05  PC-UN                       PIC  X(02)    VALUE 'UN'.    03470060
034800     05  PC-ROW-NOT-FOUND            PIC S9(04)    VALUE +100     03480060
034900                                                   COMP SYNC.     03490060
035000     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08) VALUE 'SUKUT013'. 03500060
035100     05  PC-CURRENT-OPERATING-COMPANY PIC  X(02) VALUE '03'.      03510060
035200     05  PC-MAX-RETRIES              PIC S9(04)    VALUE +3       03520060
035300                                                   COMP SYNC.     03530060
035400     05  PC-CURRENT-TIMESTAMP        PIC  X(26)    VALUE SPACES.  03540060
035500     05  PC-DEFAULT-TIMESTAMP         PIC X(26)   VALUE           03550060
035600                                   '9999-09-09-09.09.09.999999'.  03560060
035700*ADDED CLP 2/17/17                                                03570079
035800     05  PC-CRTN-STATUS-PGM          PIC  X(08)    VALUE          03580079
035900         'PCKUT713'.                                              03590079
036000                                                                  03600060
036100 01  PV-PROGRAM-VARIABLES.                                        03610060
036200     05  PV-ITEM-NBR                 PIC  9(15)    VALUE ZERO.    03620060
036300     05  PV-PARAGRAPH-NAME           PIC  X(30)    VALUE SPACES.  03630060
036400     05  PV-DB2-OPERATION-ATTEMPTED  PIC  X(30)    VALUE SPACES.  03640060
036500     05  PV-CARTON-CDE.                                           03650060
036600         10  FILLER                  PIC X(2)      VALUE '00'.    03660060
036700         10  PV-CARTON-ID            PIC X(18)     VALUE SPACES.  03670060
036800         10  FILLER                  PIC X(2)      VALUE SPACES.  03680060
036900     05  PV-CARTON REDEFINES PV-CARTON-CDE                        03690060
037000                                     PIC X(22).                   03700060
037100     05  PV-PO-NBR                   PIC S9(9) COMP.              03710060
037100     05  PV-SAVE-PO-NBR              PIC S9(9) COMP VALUE ZEROES. 03711099
037100     05  PV-SAVE-PO-DISP             PIC  9(9) COMP VALUE ZEROES. 03712099
037200     05  PV-RCVR-SEQ-NBR             PIC S9(9) COMP.              03720060
037300     05  PV-TRIP-ID                  PIC S9(9) COMP.              03730060
037400     05  PV-STAT-CDE                 PIC  X(2) VALUE SPACES.      03740060
037400     05  PV-SAVE-OPC-SET-IND         PIC  X(1) VALUE SPACE.       03741099
037500     05  PV-SHIPT-UNT-ID             PIC S9(18)V VALUE ZERO       03750060
037600                                                 COMP-3.          03760060
037700     05  PV-KOHLS-SML-HOLD           PIC S9(18)V VALUE ZERO       03770060
037800                                                 COMP-3.          03780060
037900     05  PV-SHIPT-UNT-ID-NUM         PIC 9(18) VALUE ZERO.        03790060
038000     05  PV-DISPLAY-COUNT            PIC ZZZ,ZZZ,ZZ9.             03800060
038010     05  PV-DISPLAY-SQLCODE          PIC -9(05) VALUE ZEROES.     03801099
038100     05  PV-TRLR-SRL-NBR-DISP        PIC  9(9).                   03810060
038200     05  PV-OTBND-STAT-TMST          PIC  X(26).                  03820060
038300     05  PV-OTBND-STAT-TMST-1        PIC  X(26).                  03830060
038400     05  PV-DISPLAY-CARTON           PIC  9(20).                  03840060
038500     05  PV-DISP-CARTON-TRIP         PIC  Z(09).                  03850060
038600*** ADDED 2/25/16 CLP                                             03860060
038700     05  PV-TRLR-SRL-NBR             PIC  S9(9) COMP.             03870060
038800     05  PV-SHIP-SCAC-CDE            PIC  X(4) VALUE SPACES.      03880060
038900*** ADDED 1/17/17 CLP                                             03890073
039000     05  PV-SHIPPED-TMST             PIC  X(26) VALUE SPACE.      03900073
039010     05  PV-DIVERT-TMST              PIC  X(26) VALUE SPACES.     03901099
039100     05  PV-ORGN-OPER-UNT-ID         PIC S9(04) VALUE 0 COMP.     03910073
039200     05  PV-TRLR-ID                  PIC X(12)  VALUE SPACES.     03920073
039300     05  PV-TRN-NBR                  PIC S9(09) VALUE 0 COMP.     03930073
039400     05  PV-UNIT-RETAIL              PIC S9(08)V99 VALUE 0.       03940073
039500     05  PV-COST-AMT                 PIC S9(07)V99 VALUE 0.       03950073
039600     05  PV-TMST-ON-TRLR             PIC  X(26) VALUE SPACES.     03960082
039700     05  PV-DTE-AT-DC                PIC  X(10) VALUE SPACES.     03970077
039800     05  PV-TM-AT-DC                 PIC  X(08) VALUE SPACES.     03980077
039810     05  PV-PREV-SU136-SHIPT-UNT-ID  PIC  S9(18)V VALUE 0 COMP-3. 03981099
039820     05  PV-SAVED-TMST               PIC  X(26) VALUE SPACES.     03982099
039900                                                                  03990060
040000 01  PV-DB2-NULL-INDICATORS.                                      04000060
040100     05  PV-OTBND-TRIP-ID            PIC S9(04) COMP VALUE +0.    04010060
040200                                                                  04020060
040300 01  COUNTERS.                                                    04030060
040400     05  PV-READ-COUNTER             PIC  S9(9) COMP-3.           04040060
040500     05  PV-UPC-COUNT                PIC  S9(9) COMP-3.           04050060
040600     05  PV-CARTON-COUNT             PIC  S9(9) COMP-3.           04060060
040700     05  PV-EMPTY-CARTON-COUNT       PIC  S9(9) COMP-3.           04070060
040800** ADDED 8/1/11 DMH                                               04080060
040900     05  PV-MANIFEST-EXT-COUNT       PIC  S9(9) COMP-3.           04090060
041000**                                                                04100060
041100** ADDED 2/25/16 CLP                                              04110060
041200     05  PV-OMS-EXT-COUNT            PIC  S9(9) COMP-3.           04120060
041300     05  PV-DB2-COUNT                PIC S9(09)    VALUE ZERO     04130060
041400                                                   COMP-3.        04140060
041500** ADDED 2/17/17 CLP                                              04150068
041600     05  PV-OMS-MLS-EXT-COUNT        PIC  S9(9) COMP-3.           04160068
041700                                                                  04170060
041800** ADDED 07/07/2016 CLP                                           04180060
041900  01 DB2-KEYS.                                                    04190060
042000     05  DK-PO-NBR                PIC S9(09)  COMP.               04200060
042100     05  DK-TRN-LNE-NBR           PIC S9(09)  COMP.               04210060
042200     05  DK-RCVR-SEQ-NBR          PIC S9(09)  COMP.               04220060
042300     05  DK-INTR-UPC-ID           PIC S9(09)  COMP.               04230060
042400     05  DK-STR-NBR               PIC S9(04)  COMP.               04240060
042410     05  DK-CARTON-ID             PIC S9(18)V COMP-3.             04241099
042500                                                                  04250060
042600*---------------------------------------------------------------* 04260060
042700*    PO-RCVR CURSOR                                               04270060
042800*    ADDED XLT_UPC & XLT_SKU TO CURSOR 8/1/11 DMH                 04280060
042900*---------------------------------------------------------------* 04290060
043000     EXEC SQL                                                     04300060
043100         DECLARE PO-RCVR-CSR CURSOR FOR                           04310060
043200         SELECT  SUM(A.SHPD_UNT_QTY)                              04320060
043300                ,A.UPC_NBR                                        04330060
043400                ,A.TRN_LNE_NBR                                    04340060
043500                ,A.TRN_NBR                                        04350060
043600                ,A.RCVR_SEQ_NBR                                   04360060
043700                ,A.TRN_TYP_CDE                                    04370060
043800                ,C.SKU_NBR                                        04380060
043900                ,C.INTR_UPC_ID                                    04390060
044000          FROM  SUT_OTBND_UPC A                                   04400060
044100               ,XLT_UPC B                                         04410060
044200               ,XLT_SKU C                                         04420060
044300         WHERE  A.SHIPT_UNT_ID  =  :PV-SHIPT-UNT-ID               04430060
044400           AND  A.UPC_NBR       =  B.UPC_NBR                      04440060
044500           AND  B.INTR_UPC_ID   =  C.INTR_UPC_ID                  04450060
044600          GROUP BY A.UPC_NBR, A.TRN_LNE_NBR, A.TRN_NBR,           04460060
044700                   A.RCVR_SEQ_NBR, A.TRN_TYP_CDE,                 04470060
044800                   C.SKU_NBR, C.INTR_UPC_ID                       04480060
044900          ORDER BY A.TRN_NBR, A.RCVR_SEQ_NBR                      04490060
045000          WITH UR                                                 04500060
045100     END-EXEC.                                                    04510060
045200                                                                  04520060
045300******************************************************************04530060
045400 PROCEDURE DIVISION.                                              04540060
045500******************************************************************04550060
045600******************************************************************04560060
045700* 0000-PROGRAM-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE     04570060
045800*      PROGRAM.                                                   04580060
045900******************************************************************04590060
046000 0000-PROGRAM-MAINLINE.                                           04600060
046100                                                                  04610060
046200     DISPLAY '***** SUKUT013 STARTED *****'.                      04620060
046300                                                                  04630060
046400     PERFORM 1000-INITIALIZE.                                     04640060
046500     IF PS-NOT-END-OF-FILE                                        04650060
046600         PERFORM 2000-PROCESS-TSUOBTS-FILE                        04660060
046700            UNTIL PS-END-OF-FILE                                  04670060
046800     END-IF.                                                      04680060
046900     PERFORM 9000-EOJ-ROUTINE.                                    04690060
047000                                                                  04700060
047100     STOP RUN.                                                    04710060
047200                                                                  04720060
047300******************************************************************04730060
047400*  DO FIRST TIME PROGRAM INITIALIZATION TASKS.                    04740060
047500*    -- OPEN INPUT FILE                                           04750060
047600*    -- OPEN OUTPUT FILE                                          04760060
047700*    -- READ INPUT FILE                                           04770060
047800******************************************************************04780060
047900 1000-INITIALIZE.                                                 04790060
048000                                                                  04800060
048100     INITIALIZE COUNTERS.                                         04810060
048200     OPEN INPUT  TSUOBTS-UNLOAD-FILE.                             04820060
048300     OPEN OUTPUT CARTON-DETAIL-FILE                               04830060
048400                 CARTON-TRIP-FILE                                 04840060
048500                 EMPTY-CARTON-FILE                                04850060
048600* ADDED 2/17/17 CLP                                               04860068
048700                 COMB-OMS-MLS-FILE                                04870068
048800     PERFORM 3600-CHECK-SEND-MLS.                                 04880060
048900* ADDED 2/25/16 CLP                                               04890060
049000     PERFORM 3610-CHECK-SEND-OMS.                                 04900060
049001* ADDED 3/17/17 GB                                                04900199
049010     PERFORM 3620-CHECK-SEND-FXR.                                 04901099
049100                                                                  04910060
049200     PERFORM 7000-READ-FILE.                                      04920060
049300******************************************************************04930060
049400*  BEGIN RETRIEVING THE NECESSARY DATA                            04940060
049500******************************************************************04950060
049600 2000-PROCESS-TSUOBTS-FILE.                                       04960060
049700                                                                  04970060
049800     INITIALIZE PC010-PCT-INTRANSIT-REC                           04980060
049900                SU043-RECORD                                      04990060
050000                SU136-EXTRACT-RECORD                              05000068
050100                PC049-DB2-KEYS.                                   05010060
050200                                                                  05020060
050300     DISPLAY 'TRIP ID BEING PROCESSED IS ' SU012-TRIP-ID          05030060
050400     PERFORM 3000-RETRIEVE-TRIP.                                  05040060
050500                                                                  05050060
050600     INITIALIZE PC049-DOOR-STR-CNT.                               05060060
050700                                                                  05070060
050800     MOVE SU012-TRIP-ID           TO  PC049-DK-OTBND-TRIP-ID      05080060
050900                                      PC010-TRIP-ID.              05090060
051000     IF SU012-SHIPPED-FROM-DC                                     05100060
051100         MOVE SU012-TRIP-ID       TO  SU043-OTBND-TRIP-ID         05110060
051200* ADDED 2/17/17 CLP                                               05120067
051300                                      SU136-OTBND-TRIP-ID         05130067
051400         MOVE SUOBTR-DEST-OPER-UNT-ID TO                          05140099
051500* ADDED 2/17/17 CLP                                               05150067
051600                                      SU136-DEST-LOC-NBR          05160067
051700         PERFORM 3130-RETRIEVE-SHIPPED-TMST                       05170060
051800* ADDED 2/17/17 CLP                                               05180067
051900         MOVE PV-SHIPPED-TMST     TO  SU136-SHIPPED-TMST          05190099
052000                                                                  05200060
052100         MOVE SUOBTR-ORGN-OPER-UNT-ID TO PV-ORGN-OPER-UNT-ID      05210099
052200         MOVE CNTRID-TRLR-ID       TO  PV-TRLR-ID                 05220099
052300         MOVE CNTRID-SCAC-CDE      TO  PV-SHIP-SCAC-CDE           05230099
052400         MOVE SUOBTR-TRLR-SRL-NBR  TO  PV-TRLR-SRL-NBR            05240099
052500         MOVE SUOBTS-TRLR-SEAL-ID  TO  SU136-TRLR-SEAL-ID         05250099
052600* ADDED 8/1/11 DMH                                                05260060
052700     END-IF                                                       05270060
052800     MOVE PC-CURRENT-PROGRAM-NAME TO  PC010-UPD-USR-ID.           05280060
052900     MOVE SUOBTR-ORGN-OPER-UNT-ID TO  PC049-DK-OPER-UNT-ID.       05290060
053000     MOVE SUOBTS-DOOR-ID          TO  PC049-DK-DOOR-ID.           05300060
053100     MOVE SUOBTR-DEST-OPER-UNT-ID TO  PC049-DK-TRLR-DEST          05310060
053200                                      PC010-STR-NBR.              05320060
053300                                                                  05330060
053400     MOVE PV-OTBND-STAT-TMST-1    TO  PC010-EVENT-TMST.           05340060
053500                                                                  05350060
053600     PERFORM P4000-STRT-END-DVRT.                                 05360060
053700     PERFORM P3000-DOOR-STR-CSR.                                  05370060
053800     IF  PC049-DIVERT-CUTOFFS-YES                                 05380060
053900         PERFORM P7120-OPEN-SHP-ACTV-CRTN-CSR                     05390060
054000         IF  PC049-NOT-EOF-SHP-ACTV-CRTN                          05400060
054100             PERFORM 4000-FETCH-SHP-ACTV-CRTN-CSR                 05410060
054200                 UNTIL PC049-EOF-SHP-ACTV-CRTN                    05420060
054300             PERFORM P7130-CLOSE-SHP-ACTV-CRTN-CSR                05430060
054400         END-IF                                                   05440060
054500     ELSE                                                         05450060
054600******    WR # 20694 - START                                      05460060
054700*        MOVE PC-DEFAULT-TIMESTAMP     TO PC049-DK-START-TMST     05470060
054800*                                         PC049-DK-END-TMST       05480060
054900*        PERFORM P7120-OPEN-SHP-ACTV-CRTN-CSR                     05490060
055000*        IF  PC049-NOT-EOF-SHP-ACTV-CRTN                          05500060
055100*            PERFORM 4000-FETCH-SHP-ACTV-CRTN-CSR                 05510060
055200*                UNTIL PC049-EOF-SHP-ACTV-CRTN                    05520060
055300*            PERFORM P7130-CLOSE-SHP-ACTV-CRTN-CSR                05530060
055400*        END-IF                                                   05540060
055500         PERFORM P7000-OPEN-SCAN-CRTN-CSR                         05550060
055600         IF  PC049-NOT-EOF-SCAN-CRTN                              05560060
055700             PERFORM 4100-FETCH-SCAN-CRTN-CSR                     05570060
055800                 UNTIL PC049-EOF-SCAN-CRTN                        05580060
055900             PERFORM P7020-CLOSE-SCAN-CRTN-CSR                    05590060
056000         END-IF                                                   05600060
056100******    WR # 20694 - END                                        05610060
056200     END-IF.                                                      05620060
056300                                                                  05630060
056400     PERFORM 7000-READ-FILE.                                      05640060
056500                                                                  05650060
056600                                                                  05660060
056700******************************************************************05670060
056800*  RETRIEVE TRIP INFORMATION NECESSARY TO USE THE CARTON CURSORS. 05680060
056900******************************************************************05690060
057000 3000-RETRIEVE-TRIP.                                              05700060
057100     MOVE SU012-TRIP-ID  TO  PV-TRIP-ID.                          05710060
057200     IF SU012-SHIPPED-FROM-DC AND SU012-NOT-UNLOADED-AT-STORE     05720060
057300         MOVE PC-DS TO PV-STAT-CDE                                05730060
057400     ELSE                                                         05740060
057500         IF SU012-NOT-SHIPPED-FROM-DC AND SU012-UNLOADED-AT-STORE 05750060
057600             MOVE PC-SU TO PV-STAT-CDE                            05760060
057700         ELSE                                                     05770060
057800             MOVE PC-DS TO PV-STAT-CDE                            05780060
057900         END-IF                                                   05790060
058000     END-IF.                                                      05800060
058100                                                                  05810060
058200     PERFORM 3010-RETRIEVE-TRIP-INFO.                             05820060
058300*** ADDED 2/25/16 CLP                                             05830060
058400     MOVE SUOBTR-TRLR-SRL-NBR  TO PV-TRLR-SRL-NBR.                05840060
058500     MOVE SUOBTS-SHIP-SCAC-CDE TO PV-SHIP-SCAC-CDE.               05850060
058600                                                                  05860060
058700     PERFORM 3140-RETRIEVE-TRAILER-ID.                            05870060
058800                                                                  05880060
058900                                                                  05890060
059000******************************************************************05900060
059100*  RETRIEVE TRIP INFORMATION NECESSARY TO USE THE CARTON CURSORS. 05910060
059200******************************************************************05920060
059300 3010-RETRIEVE-TRIP-INFO.                                         05930060
059400                                                                  05940060
059500     EXEC SQL                                                     05950060
059600         SELECT  A.ORGN_OPER_UNT_ID                               05960060
059700                ,A.DEST_OPER_UNT_ID                               05970060
059800* ADDED 2/25/16 CLP                                               05980060
059900                ,A.TRLR_SRL_NBR                                   05990060
060000                ,B.SHIP_SCAC_CDE                                  06000060
060100                ,B.TRLR_SEAL_ID                                   06010060
060200                ,B.DOOR_ID                                        06020060
060300                ,B.OTBND_STAT_TMST                                06030060
060400          INTO  :SUOBTR-ORGN-OPER-UNT-ID                          06040060
060500               ,:SUOBTR-DEST-OPER-UNT-ID                          06050060
060600               ,:SUOBTR-TRLR-SRL-NBR                              06060060
060700               ,:SUOBTS-SHIP-SCAC-CDE                             06070060
060800               ,:SUOBTS-TRLR-SEAL-ID                              06080060
060900               ,:SUOBTS-DOOR-ID                                   06090060
061000               ,:PV-OTBND-STAT-TMST-1                             06100060
061100          FROM  TSUOBTR A                                         06110060
061200               ,TSUOBTS B                                         06120060
061300         WHERE  A.OTBND_TRIP_ID     = :PV-TRIP-ID                 06130060
061400           AND  A.OTBND_TRIP_ID     = B.OTBND_TRIP_ID             06140060
061500           AND  B.TRIP_STAT_CDE     = :PV-STAT-CDE                06150060
061600              AND B.OTBND_STAT_TMST IN                            06160060
061700                  (SELECT MAX(C.OTBND_STAT_TMST)                  06170060
061800                    FROM TSUOBTS C                                06180060
061900               WHERE B.OTBND_TRIP_ID  =  C.OTBND_TRIP_ID          06190060
062000                  AND  C.TRIP_STAT_CDE = :PV-STAT-CDE)            06200060
062100           WITH UR                                                06210060
062200     END-EXEC.                                                    06220060
062300                                                                  06230060
062400     EVALUATE TRUE                                                06240060
062500         WHEN SQLCODE = ZERO                                      06250060
062600          DISPLAY 'RDC      = '                                   06260060
062700                 SUOBTR-ORGN-OPER-UNT-ID                          06270060
062800          DISPLAY 'TRLR-SRL = ' SUOBTR-TRLR-SRL-NBR               06280060
062900          DISPLAY 'SCAC     = ' SUOBTS-SHIP-SCAC-CDE              06290060
063000          DISPLAY 'SEAL-ID  = ' SUOBTS-TRLR-SEAL-ID               06300060
063100             CONTINUE                                             06310060
063200         WHEN SQLWARN0 NOT = SPACES                               06320060
063300         WHEN SQLCODE < ZERO                                      06330060
063400         WHEN SQLCODE > ZERO                                      06340060
063500             MOVE '3010-RETRIEVE-TRIP-INFO '                      06350060
063600                                        TO PV-PARAGRAPH-NAME      06360060
063700             MOVE 'SELECT TSUOBTS ' TO PV-DB2-OPERATION-ATTEMPTED 06370060
063800             DISPLAY 'TRIP ID BEING PROCESSED IS ' SU012-TRIP-ID  06380060
063900             PERFORM 9100-SQL-ABEND                               06390060
064000     END-EVALUATE.                                                06400060
064100                                                                  06410060
064200                                                                  06420060
064300******************************************************************06430060
064400*  GET UNLOADED TIMESTAMP WHEN TRIP IS SHIPPED AND UNLOADED ON    06440060
064500*  THE SAME DAY                                                   06450060
064600******************************************************************06460060
064700 3020-RETRIEVE-TRIP-INFO.                                         06470060
064800                                                                  06480060
064900     MOVE PC010-TRIP-ID  TO  PV-TRIP-ID                           06490060
065000                                                                  06500060
065100     EXEC SQL                                                     06510060
065200         SELECT  B.OTBND_STAT_TMST                                06520060
065300          INTO  :PV-OTBND-STAT-TMST                               06530060
065400          FROM  TSUOBTR A                                         06540060
065500               ,TSUOBTS B                                         06550060
065600         WHERE  A.OTBND_TRIP_ID     = :PV-TRIP-ID                 06560060
065700           AND  A.OTBND_TRIP_ID     = B.OTBND_TRIP_ID             06570060
065800           AND  B.TRIP_STAT_CDE     = 'SU'                        06580060
065900              AND B.OTBND_STAT_TMST IN                            06590060
066000                  (SELECT MAX(C.OTBND_STAT_TMST)                  06600060
066100                    FROM TSUOBTS C                                06610060
066200               WHERE B.OTBND_TRIP_ID  =  C.OTBND_TRIP_ID          06620060
066300                  AND  C.TRIP_STAT_CDE = 'SU')                    06630060
066400           WITH UR                                                06640060
066500     END-EXEC.                                                    06650060
066600                                                                  06660060
066700     EVALUATE TRUE                                                06670060
066800         WHEN SQLCODE = ZERO                                      06680060
066900             CONTINUE                                             06690060
067000         WHEN SQLWARN0 NOT = SPACES                               06700060
067100         WHEN SQLCODE < ZERO                                      06710060
067200         WHEN SQLCODE > ZERO                                      06720060
067300             MOVE '3020-RETRIEVE-TRIP-INFO '                      06730060
067400                                        TO PV-PARAGRAPH-NAME      06740060
067500             MOVE 'SELECT TSUOBTS ' TO PV-DB2-OPERATION-ATTEMPTED 06750060
067600             DISPLAY 'TRIP ID BEING PROCESSED IS ' SU012-TRIP-ID  06760060
067700             PERFORM 9100-SQL-ABEND                               06770060
067800     END-EVALUATE.                                                06780060
067900                                                                  06790060
068000                                                                  06800060
068100******************************************************************06810060
068200*  RETRIEVE SHIPPED TMST FOR MANIFEST EXTRACT OUTPUT FILE.        06820060
068300*  ADDED 8/1/11 DMH                                               06830060
068400******************************************************************06840060
068500 3130-RETRIEVE-SHIPPED-TMST.                                      06850060
068600                                                                  06860060
068700*CLP CHANGED TO PV-SHIPPED-TMST 2/17/17                           06870067
068800     EXEC SQL                                                     06880060
068900         SELECT B.OTBND_STAT_TMST                                 06890060
069000          INTO  :PV-SHIPPED-TMST                                  06900067
069100          FROM  TSUOBTR A                                         06910060
069200               ,TSUOBTS B                                         06920060
069300         WHERE  A.OTBND_TRIP_ID     = :PV-TRIP-ID                 06930060
069400           AND  A.OTBND_TRIP_ID     = B.OTBND_TRIP_ID             06940060
069500           AND  B.TRIP_STAT_CDE     = :PC-DS                      06950060
069600              AND B.OTBND_STAT_TMST IN                            06960060
069700                  (SELECT MAX(C.OTBND_STAT_TMST)                  06970060
069800                    FROM TSUOBTS C                                06980060
069900               WHERE B.OTBND_TRIP_ID  =  C.OTBND_TRIP_ID          06990060
070000                  AND  C.TRIP_STAT_CDE = :PC-DS)                  07000060
070100           WITH UR                                                07010060
070200     END-EXEC.                                                    07020060
070300                                                                  07030060
070400     EVALUATE TRUE                                                07040060
070500         WHEN SQLCODE = ZERO                                      07050060
070600             CONTINUE                                             07060060
070700         WHEN SQLWARN0 NOT = SPACES                               07070060
070800         WHEN SQLCODE < ZERO                                      07080060
070900         WHEN SQLCODE > ZERO                                      07090060
071000             MOVE '3130-RETRIEVE-SHIPPED-TMST'                    07100060
071100                                        TO PV-PARAGRAPH-NAME      07110060
071200             MOVE 'SELECT TSUOBTS ' TO PV-DB2-OPERATION-ATTEMPTED 07120060
071300             DISPLAY 'TRIP ID BEING PROCESSED IS ' SU012-TRIP-ID  07130060
071400             PERFORM 9100-SQL-ABEND                               07140060
071500     END-EVALUATE.                                                07150060
071600                                                                  07160060
071700                                                                  07170060
071800******************************************************************07180060
071900*  RETRIEVE TRAILER INFO FOR THE OMS-GIV FILE                     07190060
072000*  ADDED 2/25/16 CLP                                              07200060
072100******************************************************************07210060
072200 3140-RETRIEVE-TRAILER-ID.                                        07220060
072300                                                                  07230060
072400     EXEC SQL                                                     07240060
072500         SELECT  A.TRLR_ID                                        07250060
072600                ,A.SCAC_CDE                                       07260060
072700          INTO  :CNTRID-TRLR-ID                                   07270060
072800               ,:CNTRID-SCAC-CDE                                  07280060
072900          FROM  TCNTRID A                                         07290060
073000         WHERE  A.TRLR_SRL_NBR      = :PV-TRLR-SRL-NBR            07300060
073100           WITH UR                                                07310060
073200     END-EXEC.                                                    07320060
073300                                                                  07330060
073400     EVALUATE TRUE                                                07340060
073500         WHEN SQLCODE = ZERO                                      07350060
073600          DISPLAY 'TRLR-ID = ' CNTRID-TRLR-ID                     07360060
073700             CONTINUE                                             07370060
073800         WHEN SQLWARN0 NOT = SPACES                               07380060
073900         WHEN SQLCODE < ZERO                                      07390060
074000         WHEN SQLCODE > ZERO                                      07400060
074100             MOVE '3140-RETRIEVE-TRAILER-ID'                      07410060
074200                                        TO PV-PARAGRAPH-NAME      07420060
074300             MOVE 'SELECT TCNTRID ' TO PV-DB2-OPERATION-ATTEMPTED 07430060
074400             MOVE PV-TRLR-SRL-NBR TO PV-TRLR-SRL-NBR-DISP         07440060
074500             DISPLAY 'TRIP ID BEING PROCESSED IS ' SU012-TRIP-ID  07450060
074600             DISPLAY 'TRLR SRL NUMBER IS ' PV-TRLR-SRL-NBR-DISP   07460060
074700             PERFORM 9100-SQL-ABEND                               07470060
074800     END-EVALUATE.                                                07480060
074900                                                                  07490060
075000                                                                  07500060
075100******************************************************************07510060
075200* CHECK IF WE ARE SENDING TRAILER MANIFEST INFORMATION TO THE    *07520060
075300* MLS (MERCHANDISE LOCATION SYSTEM)                              *07530060
075400* ADDED 8/1/11 DMH                                               *07540060
075500******************************************************************07550060
075600 3600-CHECK-SEND-MLS.                                             07560060
075700     EXEC SQL                                                     07570060
075800         SELECT FUNC_TXT                                          07580060
075900           INTO :KRPRPM-FUNC-TXT                                  07590060
076000           FROM TKRPRPM                                           07600060
076100          WHERE LOC_ID            =  90                           07610060
076200            AND INTFC_SYS_CDE     = 'KHL'                         07620060
076300            AND FUNC_PRC_STAT_CDE = 'AC'                          07630060
076400            AND SYS_PRC_FUNC_CDE  = 'MLSMFS'                      07640060
076500            AND FUNC_BEG_TMST    <=  CURRENT TIMESTAMP            07650060
076600            AND FUNC_END_TMST    >=  CURRENT TIMESTAMP            07660060
076700         WITH UR                                                  07670060
076800     END-EXEC.                                                    07680060
076900                                                                  07690060
077000     EVALUATE TRUE                                                07700060
077100         WHEN SQLCODE = ZERO                                      07710060
077200              IF  KRPRPM-FUNC-TXT  = 'Y'                          07720060
077300                  SET PS-SEND-MANIFEST-TO-MLS-YES TO TRUE         07730060
077400                  DISPLAY 'SEND TRAILER MANIFEST TO MLS'          07740060
077500              ELSE                                                07750060
077600                  SET PS-SEND-MANIFEST-TO-MLS-NO  TO TRUE         07760060
077700                  DISPLAY 'DONT SEND TRAILER MANIFEST TO MLS'     07770060
077800              END-IF                                              07780060
077900                                                                  07790060
078000         WHEN SQLCODE = +100                                      07800060
078100              SET PS-SEND-MANIFEST-TO-MLS-NO  TO TRUE             07810060
078200              DISPLAY 'DONT SEND TRAILER MANIFEST TO MLS'         07820060
078300                                                                  07830060
078400         WHEN SQLWARN0 NOT = SPACE                                07840060
078500         WHEN SQLCODE  NOT = ZERO                                 07850060
078600              SET PS-SEND-MANIFEST-TO-MLS-NO  TO TRUE             07860060
078700              MOVE '3600-CHECK-SEND-MLS'                          07870060
078800                      TO PV-PARAGRAPH-NAME                        07880060
078900              MOVE 'SELECT TKRPRPM '                              07890060
079000                      TO PV-DB2-OPERATION-ATTEMPTED               07900060
079100              DISPLAY 'TRIP ID BEING PROCESSED IS '               07910060
079200              SU012-TRIP-ID                                       07920060
079300                                                                  07930060
079400             PERFORM 9100-SQL-ABEND                               07940060
079500                                                                  07950060
079600     END-EVALUATE.                                                07960060
079700                                                                  07970060
079800                                                                  07980060
079900******************************************************************07990060
080000* CHECK IF WE ARE SENDING TRAILER MANIFEST INFORMATION TO OMS    *08000060
080100* (ORDER MANAGEMENT SYSTEM)                                      *08010060
080200* ADDED 2/26/16 CLP                                              *08020060
080300******************************************************************08030060
080400 3610-CHECK-SEND-OMS.                                             08040060
080500     EXEC SQL                                                     08050060
080600         SELECT FUNC_TXT                                          08060060
080700           INTO :KRPRPM-FUNC-TXT                                  08070060
080800           FROM TKRPRPM                                           08080060
080900          WHERE LOC_ID            =  90                           08090060
081000            AND INTFC_SYS_CDE     = 'KHL'                         08100060
081100            AND FUNC_PRC_STAT_CDE = 'AC'                          08110060
081200            AND SYS_PRC_FUNC_CDE  = 'OMSMFS'                      08120060
081300            AND FUNC_BEG_TMST    <=  CURRENT TIMESTAMP            08130060
081400            AND FUNC_END_TMST    >=  CURRENT TIMESTAMP            08140060
081500         WITH UR                                                  08150060
081600     END-EXEC.                                                    08160060
081700                                                                  08170060
081800     EVALUATE TRUE                                                08180060
081900         WHEN SQLCODE = ZERO                                      08190060
082000              IF  KRPRPM-FUNC-TXT  = 'Y'                          08200060
082100                  SET PS-SEND-MANIFEST-TO-OMS-YES TO TRUE         08210060
082200                  DISPLAY 'SEND TRAILER MANIFEST TO OMS'          08220060
082300              ELSE                                                08230060
082400                  SET PS-SEND-MANIFEST-TO-OMS-NO  TO TRUE         08240060
082500                  DISPLAY 'DONT SEND TRAILER MANIFEST TO OMS'     08250060
082600              END-IF                                              08260060
082700                                                                  08270060
082800         WHEN SQLCODE = +100                                      08280060
082900              SET PS-SEND-MANIFEST-TO-OMS-NO  TO TRUE             08290060
083000              DISPLAY 'DONT SEND TRAILER MANIFEST TO OMS'         08300060
083100                                                                  08310060
083200         WHEN SQLWARN0 NOT = SPACE                                08320060
083300         WHEN SQLCODE  NOT = ZERO                                 08330060
083400              SET PS-SEND-MANIFEST-TO-OMS-NO  TO TRUE             08340060
083500              MOVE '3610-CHECK-SEND-OMS'                          08350060
083600                      TO PV-PARAGRAPH-NAME                        08360060
083700              MOVE 'SELECT TKRPRPM '                              08370060
083800                      TO PV-DB2-OPERATION-ATTEMPTED               08380060
083900              DISPLAY 'TRIP ID BEING PROCESSED IS '               08390060
084000              SU012-TRIP-ID                                       08400060
084100                                                                  08410060
084200             PERFORM 9100-SQL-ABEND                               08420060
084300                                                                  08430060
084400     END-EVALUATE.                                                08440060
084500                                                                  08450060
084510******************************************************************08451099
084520* HIGH LEVEL CHECK TO SEE IF STORES ARE ACTIVE FOR STORE RECEIVING08452099
084530* 'A' ALL STORES 'E' EXCEPTION OR 'N' NO STORES                   08453099
084531*  IF 'A' OR 'E' PERFORM STORE LEVEL CHECK                        08453199
084540* ADDED 5/17/17 GB                                               *08454099
084550******************************************************************08455099
084560 3620-CHECK-SEND-FXR.                                             08456099
084570     EXEC SQL                                                     08457099
084571         SELECT  FUNC_TXT                                         08457199
084572           INTO  :KRPRPM-FUNC-TXT                                 08457299
084573           FROM  TKRPRPM                                          08457399
084574          WHERE  LOC_ID            = 90                           08457499
084575            AND  INTFC_SYS_CDE     = 'KHL'                        08457599
084576            AND  SYS_PRC_FUNC_CDE  = 'STRSCN'                     08457699
084577            AND  FUNC_PRC_STAT_CDE = 'AC'                         08457799
084598         WITH UR                                                  08459899
084599     END-EXEC.                                                    08459999
084600                                                                  08460099
084602     EVALUATE TRUE                                                08460299
084603         WHEN SQLCODE = ZERO                                      08460399
084604             MOVE KRPRPM-FUNC-TXT TO PS-FAST-TRSFR-SEND-SW        08460499
084615         WHEN SQLCODE = +100                                      08461599
084616                 DISPLAY 'PARA 3620-CHECK-SEND-FXR '              08461699
084617                         'PARM NOT FOUND'                         08461799
084618                 DISPLAY 'SYS_PRC_FUNC_CDE = STRSCN'              08461899
084620                 MOVE 'E' TO PS-FAST-TRSFR-SEND-SW                08462099
084621         WHEN SQLWARN0 NOT = SPACE                                08462199
084622         WHEN SQLCODE  NOT = ZERO                                 08462299
084624              MOVE '3620-CHECK-SEND-FXR'                          08462499
084625                      TO PV-PARAGRAPH-NAME                        08462599
084626              MOVE 'SELECT TKRPRPM '                              08462699
084627                      TO PV-DB2-OPERATION-ATTEMPTED               08462799
084628              DISPLAY 'TRIP ID BEING PROCESSED IS '               08462899
084629              SU012-TRIP-ID                                       08462999
084630                                                                  08463099
084631             PERFORM 9100-SQL-ABEND                               08463199
084632                                                                  08463299
084633     END-EVALUATE.                                                08463399
084634                                                                  08463499
084640******************************************************************08464099
084700*  FETCH THE CARTONS.                                             08470060
084800*  8/2005 DEANNA BRANTNER                                         08480060
084900*    CHECK SUT_OTBND_CART TO SEE IF THERE IS A VALUE IN TRIP ID.  08490060
085000*    THIS CARTON WAS ALREADY PROCESSED SO DON'T PROCESS IT AGAIN. 08500060
085100******************************************************************08510060
085200 4000-FETCH-SHP-ACTV-CRTN-CSR.                                    08520060
085300     SET PS-PRCSS-CRTN  TO TRUE.                                  08530060
085400     PERFORM P7125-FETCH-SHP-ACTV-CRTN-CSR.                       08540060
085500                                                                  08550060
085600     IF PC049-EOF-SHP-ACTV-CRTN                                   08560060
085700         CONTINUE                                                 08570060
085800     ELSE                                                         08580060
085900         IF PC049-PV-TYP-ASSM                                     08590060
086000             CONTINUE                                             08600060
086100         ELSE                                                     08610060
086200             MOVE SUCRDV-SHIPT-UNT-ID TO PV-SHIPT-UNT-ID          08620060
086300                                         SU043-SHIPT-UNT-ID       08630060
086400             PERFORM 4010-RETRIEVE-CARTON-INFO                    08640060
086500             IF PS-DONT-PRCSS-CRTN                                08650060
086600                 SET PS-END-OF-CSR TO TRUE                        08660060
086700             ELSE                                                 08670060
086800                 PERFORM 5100-OPEN-CSR                            08680060
086900                 SET PS-NOT-END-OF-CSR TO TRUE                    08690060
087000                 PERFORM 5250-FETCH-CSR                           08700060
087100                 IF PS-END-OF-CSR                                 08710060
087200                     PERFORM 5500-EMPTY-CARTON                    08720060
087300                 ELSE                                             08730060
087400                     PERFORM 5200-PROCESS-CSR UNTIL               08740060
087500                         PS-END-OF-CSR                            08750060
087600                 END-IF                                           08760060
087700                 PERFORM 5300-CLOSE-CSR                           08770060
087800             END-IF                                               08780060
087900         END-IF                                                   08790060
088000     END-IF.                                                      08800060
088100                                                                  08810060
088200******************************************************************08820060
088300*  RETRIEVE OTBND_CART INFO                                       08830060
088400*  CHECK IF CARTON ALREADY ATTACHED TO A TRAILER IF SO OK PROCESS 08840060
088500*  ELSE DONT ATTACH TO A NEW TRAILER                              08850060
088600******************************************************************08860060
088700 4010-RETRIEVE-CARTON-INFO.                                       08870060
088800                                                                  08880060
088900     INITIALIZE PV-OTBND-TRIP-ID.                                 08890060
089000                                                                  08900060
089100     EXEC SQL                                                     08910060
089200         SELECT  ACTV_IND                                         08920060
089300                ,OTBND_TRIP_ID                                    08930060
089400*ADDED CLP 2/17/17 -                                              08940069
089500                ,CART_SRC_CDE                                     08950069
089600                ,CRE_DTE                                          08960077
089700                ,CRE_TM                                           08970077
089700                ,ORIG_CART_ID                                     08971099
089800          INTO  :SUT00024-ACTV-IND                                08980060
089900               ,:SUT00024-OTBND-TRIP-ID  :PV-OTBND-TRIP-ID        08990060
090000               ,:SUT00024-CART-SRC-CDE                            09000069
090100               ,:SUT00024-CRE-DTE                                 09010077
090200               ,:SUT00024-CRE-TM                                  09020077
090200               ,:SUT00024-ORIG-CART-ID                            09021099
090300          FROM  SUT_OTBND_CART                                    09030060
090400         WHERE  SHIPT_UNT_ID = :PV-SHIPT-UNT-ID                   09040060
090500           WITH UR                                                09050060
090600     END-EXEC.                                                    09060060
090700                                                                  09070060
090800     EVALUATE TRUE                                                09080060
090900         WHEN SQLCODE = ZERO                                      09090060
091000             IF PV-OTBND-TRIP-ID = -1                             09100060
091100                 SET PS-PRCSS-CRTN  TO TRUE                       09110060
091200*ADDED CLP 2/17/17                                                09120069
091300                MOVE SUT00024-CART-SRC-CDE TO SU136-SML-TYPE      09130083
091400                MOVE SUT00024-CRE-DTE      TO PV-DTE-AT-DC        09140078
091500                MOVE SUT00024-CRE-TM       TO PV-TM-AT-DC         09150078
091500                MOVE SUT00024-ORIG-CART-ID TO                     09151099
                                               SU136-VENDOR-CART-ID     09152099
091600             ELSE                                                 09160060
091700                 SET PS-DONT-PRCSS-CRTN  TO TRUE                  09170060
091800                 MOVE PV-SHIPT-UNT-ID  TO  PV-DISPLAY-CARTON      09180060
091900                 MOVE SUT00024-OTBND-TRIP-ID                      09190060
092000                   TO PV-DISP-CARTON-TRIP                         09200060
092100                 DISPLAY 'CARTON BEING THROWN AWAY IS '           09210060
092200                                                 PV-DISPLAY-CARTON09220060
092300                         ' MANIFESTED TO TRAILER - '              09230060
092400                         PV-DISP-CARTON-TRIP                      09240060
092500             END-IF                                               09250060
092600         WHEN SQLCODE = +100                                      09260060
092700             CONTINUE                                             09270060
092800         WHEN SQLWARN0 NOT = SPACES                               09280060
092900         WHEN SQLCODE < ZERO                                      09290060
093000         WHEN SQLCODE > ZERO                                      09300060
093100            MOVE '4010-RETRIEVE-CART-INFO ' TO PV-PARAGRAPH-NAME  09310060
093200            MOVE 'SELECT OTBNDCART' TO PV-DB2-OPERATION-ATTEMPTED 09320060
093300            MOVE PV-SHIPT-UNT-ID  TO  PV-DISPLAY-CARTON           09330060
093400            DISPLAY 'CARTON BEING PROCESSED IS ' PV-DISPLAY-CARTON09340060
093500            PERFORM 9100-SQL-ABEND                                09350060
093600     END-EVALUATE.                                                09360060
093700                                                                  09370060
093800******************************************************************09380060
093900*  FETCH THE SCANNED CARTONS.                                     09390060
094000******************************************************************09400060
094100******    WR # 20694 - START                                      09410060
094200 4100-FETCH-SCAN-CRTN-CSR.                                        09420060
094300     PERFORM P7010-FETCH-SCAN-CRTN-CSR.                           09430060
094400                                                                  09440060
094500     IF PC049-EOF-SCAN-CRTN                                       09450060
094600         CONTINUE                                                 09460060
094700     ELSE                                                         09470060
094800         MOVE SUT00027-SHIPT-UNT-ID TO PV-SHIPT-UNT-ID            09480060
094900                                       SU043-SHIPT-UNT-ID         09490060
095000         PERFORM 4010-RETRIEVE-CARTON-INFO                        09500060
095100         IF PS-DONT-PRCSS-CRTN                                    09510060
095200             SET PS-END-OF-CSR TO TRUE                            09520060
095300         ELSE                                                     09530060
095400             PERFORM 5100-OPEN-CSR                                09540060
095500             SET PS-NOT-END-OF-CSR TO TRUE                        09550060
095600             PERFORM 5250-FETCH-CSR                               09560060
095700             IF PS-END-OF-CSR                                     09570060
095800                 PERFORM 5500-EMPTY-CARTON                        09580060
095900             ELSE                                                 09590060
096000                 PERFORM 5200-PROCESS-CSR UNTIL                   09600060
096100                     PS-END-OF-CSR                                09610060
096200             END-IF                                               09620060
096300             PERFORM 5300-CLOSE-CSR                               09630060
096400         END-IF                                                   09640060
096500     END-IF.                                                      09650060
096600                                                                  09660060
096700******    WR # 20694 - END                                        09670060
096800*----------------------------------------------------------------*09680060
096900* OPEN CURSOR                                                     09690060
097000*----------------------------------------------------------------*09700060
097100 5100-OPEN-CSR.                                                   09710060
097200     INITIALIZE DCLSUT00028.                                      09720060
097300     EXEC SQL                                                     09730060
097400         OPEN PO-RCVR-CSR                                         09740060
097500     END-EXEC.                                                    09750060
097600                                                                  09760060
097700     EVALUATE TRUE                                                09770060
097800         WHEN SQLCODE = ZERO                                      09780060
097900             CONTINUE                                             09790060
098000         WHEN SQLWARN0 NOT = SPACES                               09800060
098100         WHEN SQLCODE < ZERO                                      09810060
098200         WHEN SQLCODE > ZERO                                      09820060
098300             MOVE '5100-OPEN-CSR' TO PV-PARAGRAPH-NAME            09830060
098400             MOVE 'SELECT SUT_OTBND_UPC '                         09840060
098500                                    TO PV-DB2-OPERATION-ATTEMPTED 09850060
098600             DISPLAY 'TRIP ID BEING PROCESSED IS ' SU012-TRIP-ID  09860060
098700             PERFORM 9100-SQL-ABEND                               09870060
098800     END-EVALUATE.                                                09880060
098900                                                                  09890060
099000*----------------------------------------------------------------*09900060
099100* PROCESS CURSOR                                                  09910060
099200*----------------------------------------------------------------*09920060
099300 5200-PROCESS-CSR.                                                09930060
099400     IF SUT00028-TRN-TYP-CDE = 'CS'                               09940060
099500***      SET PS-END-OF-CSR TO TRUE                                09950060
099600         CONTINUE                                                 09960060
099700     ELSE                                                         09970060
099800         IF SUT00028-TRN-TYP-CDE = 'FX'                           09980060
099900                                AND SU012-UNLOADED-AT-STORE       09990060
100000             SET PS-END-OF-CSR TO TRUE                            10000060
100100         ELSE                                                     10010060
100200             IF SUT00028-TRN-NBR    = PV-PO-NBR AND               10020060
100300                 SUT00028-RCVR-SEQ-NBR = PV-RCVR-SEQ-NBR          10030060
100400                 MOVE SUT00028-RCVR-SEQ-NBR TO PC010-RCVR-SEQ-NBR 10040060
100500             ELSE                                                 10050060
100600                 IF SUT00028-TRN-NBR = ZERO                       10060060
100700                   MOVE SUT00028-RCVR-SEQ-NBR                     10070060
100800                                            TO PC010-RCVR-SEQ-NBR 10080060
100900                 ELSE                                             10090060
101000                     IF SUT00028-TRN-TYP-CDE = 'FX' AND           10100060
101100                                            SU012-SHIPPED-FROM-DC 10110060
101200                        MOVE SUT00028-RCVR-SEQ-NBR TO             10120060
101300                                                PC010-RCVR-SEQ-NBR10130060
101400                     ELSE                                         10140060
101500                         IF SUT00028-RCVR-SEQ-NBR = ZERO          10150060
101600                             PERFORM 5400-GET-REC-SEQ-NBR         10160060
101700                         ELSE                                     10170060
101800                             MOVE SUT00028-RCVR-SEQ-NBR TO        10180060
101900                                               PC010-RCVR-SEQ-NBR 10190060
102000                         END-IF                                   10200060
102100                     END-IF                                       10210060
102200                 END-IF                                           10220060
102300             END-IF                                               10230060
102400         END-IF                                                   10240060
102500     END-IF.                                                      10250060
102600                                                                  10260060
102700     IF PS-NOT-END-OF-CSR                                         10270060
102800         IF PC010-UPC-NBR NOT = ZEROES                            10280060
102900             IF SU012-SHIPPED-FROM-DC                             10290060
103000                                  AND SU012-NOT-UNLOADED-AT-STORE 10300060
103100                 MOVE PC-SH TO PC010-TRN-TYP-CDE                  10310060
103200             ELSE                                                 10320060
103300                 IF SU012-NOT-SHIPPED-FROM-DC                     10330060
103400                                  AND SU012-UNLOADED-AT-STORE     10340060
103500                     MOVE PC-UN TO PC010-TRN-TYP-CDE              10350060
103600                 ELSE                                             10360060
103700                     IF SU012-SHIPPED-FROM-DC                     10370060
103800                                  AND SU012-UNLOADED-AT-STORE     10380060
103900                         MOVE PC-SH TO PC010-TRN-TYP-CDE          10390060
104000                         MOVE  PV-OTBND-STAT-TMST-1               10400060
104100                           TO  PC010-EVENT-TMST                   10410060
104200                         PERFORM 8000-WRITE-OUTPUT                10420060
104300                         MOVE PC-UN TO PC010-TRN-TYP-CDE          10430060
104400                         PERFORM 3020-RETRIEVE-TRIP-INFO          10440060
104500                         MOVE  PV-OTBND-STAT-TMST                 10450060
104600                           TO  PC010-EVENT-TMST                   10460060
104700                     END-IF                                       10470060
104800                 END-IF                                           10480060
104900             END-IF                                               10490060
105000         END-IF                                                   10500060
105100         PERFORM 8000-WRITE-OUTPUT                                10510060
105200         MOVE SUT00028-TRN-NBR    TO PV-PO-NBR                    10520060
105300         MOVE SUT00028-RCVR-SEQ-NBR TO PV-RCVR-SEQ-NBR            10530060
105400         PERFORM 5250-FETCH-CSR                                   10540060
105500     END-IF.                                                      10550060
105600                                                                  10560060
105700*----------------------------------------------------------------*10570060
105800* FETCH CURSOR                                                    10580060
105900*----------------------------------------------------------------*10590060
106000 5250-FETCH-CSR.                                                  10600060
106100     EXEC SQL                                                     10610060
106200        FETCH PO-RCVR-CSR                                         10620060
106300         INTO   :SUT00028-SHPD-UNT-QTY                            10630060
106400               ,:SUT00028-UPC-NBR                                 10640060
106500               ,:SUT00028-TRN-LNE-NBR                             10650060
106600               ,:SUT00028-TRN-NBR                                 10660060
106700               ,:SUT00028-RCVR-SEQ-NBR                            10670060
106800               ,:SUT00028-TRN-TYP-CDE                             10680060
106900               ,:XLT00003-SKU-NBR                                 10690060
107000               ,:XLT00003-INTR-UPC-ID                             10700060
107100     END-EXEC.                                                    10710060
107200                                                                  10720060
107300     EVALUATE TRUE                                                10730060
107400         WHEN SQLCODE = ZERO                                      10740060
107500             MOVE SUT00028-SHPD-UNT-QTY TO  PC010-IN-TRNST-QTY    10750060
107600             MOVE SUT00028-UPC-NBR      TO  PC010-UPC-NBR         10760060
107700             MOVE SUT00028-TRN-NBR      TO  PC010-PO-NBR          10770060
107800             MOVE SUT00028-TRN-LNE-NBR  TO  PC010-TRN-LNE-NBR     10780060
107900                                            DK-TRN-LNE-NBR        10790060
108000             MOVE SUT00028-TRN-TYP-CDE  TO  PC010-OTB-TYP-CDE     10800060
108100*  ADDED 2/25/16 CLP                                              10810060
108200*  ADDED 1/17/17 CLP                                              10820067
108300             MOVE PV-SHIPT-UNT-ID       TO  SU136-SHIPT-UNT-ID    10830099
108400             MOVE XLT00003-SKU-NBR      TO  SU136-SKU-NBR         10840099
108500             MOVE SUT00028-SHPD-UNT-QTY TO  SU136-SHPD-UNT-QTY    10850099
108600* ADDED 07/07/2016 CLP                                            10860060
108700             MOVE SUT00028-TRN-NBR      TO PV-TRN-NBR             10870099
108800                                           DK-PO-NBR              10880060
108900             MOVE SUT00028-RCVR-SEQ-NBR TO PV-RCVR-SEQ-NBR        10890099
109000                                           DK-RCVR-SEQ-NBR        10900060
109100             MOVE SU136-SHIPT-UNT-ID TO PV-SHIPT-UNT-ID-NUM       10910067
109200                                                                  10920067
109300             PERFORM 5251-GET-COST-RETAIL                         10930067
109400             PERFORM 5260-GET-CAT-STYLE                           10940099
                   IF DK-PO-NBR = PV-SAVE-PO-NBR                        10940199
                                                                        10940299
                      MOVE PV-SAVE-OPC-SET-IND TO SU136-OPC-SET-IND     10940399
                                                                        10940499
                   ELSE                                                 10940599
                      MOVE DK-PO-NBR           TO PV-SAVE-PO-NBR        10940699
109400                PERFORM 5280-GET-OPC-SET-CDE                      10941099
                                                                        10941199
                   END-IF                                               10942099
109500                                                                  10950085
109600         WHEN SQLCODE = +100                                      10960085
109700             MOVE ZEROES            TO  PC010-IN-TRNST-QTY        10970085
109800                                        PC010-UPC-NBR             10980085
109900                                        PC010-PO-NBR              10990085
110000                                        PC010-RCVR-SEQ-NBR        11000085
110100                                        PC010-TRN-LNE-NBR         11010085
110200*  ADDED 2/17/17 CLP                                              11020067
110300                                        SU136-SKU-NBR             11030067
110400                                        SU136-SHPD-UNT-QTY        11040067
110500                                        SU136-VENDOR-STYLE        11050099
110600                                        SU136-CATEGORY            11060099
110700             MOVE PV-SHIPT-UNT-ID   TO  SU136-SHIPT-UNT-ID        11070099
110800             SET PS-END-OF-CSR      TO  TRUE                      11080060
110900         WHEN SQLWARN0 NOT = SPACES                               11090060
111000         WHEN SQLCODE < ZERO                                      11100060
111100         WHEN SQLCODE > ZERO                                      11110060
111200             MOVE '5200-FETCH-CSR' TO PV-PARAGRAPH-NAME           11120060
111300             MOVE 'SELECT SUT_OTBND_UPC'                          11130060
111400                                   TO PV-DB2-OPERATION-ATTEMPTED  11140060
111500             DISPLAY 'TRIP ID BEING PROCESSED IS ' SU012-TRIP-ID  11150060
111600             PERFORM 9100-SQL-ABEND                               11160060
111700     END-EVALUATE.                                                11170060
111800                                                                  11180060
111900***************************************************************   11190060
112000* GET COST AND RETAIL IT ALL DEPENDS ON IF YOUR AN ASN OR IR  *   11200060
112100* CARTON AS TO WHERE TO GET THE PRICES FROM                   *   11210060
112200***************************************************************   11220060
112300 5251-GET-COST-RETAIL.                                            11230060
112400*   'IMPORT REPLEN CARTON'                                        11240060
112500     IF PV-SHIPT-UNT-ID-NUM(1:2) = 42                             11250060
112600         PERFORM 6000-GET-COST-RETAIL                             11260060
112700         MOVE XLV00002-UNT-COST-AMT TO PV-COST-AMT                11270072
112800         MOVE XLV00002-UNT-RTL-AMT  TO PV-UNIT-RETAIL             11280072
112900     ELSE                                                         11290060
113000         PERFORM 5600-GET-COST                                    11300060
113100         MOVE PURITM-UNT-COST-AMT   TO PV-COST-AMT                11310072
113200         PERFORM 5700-GET-RETAIL                                  11320060
113300         MOVE XLV00002-UNT-RTL-AMT  TO PV-UNIT-RETAIL             11330072
113400     END-IF.                                                      11340060
113500                                                                  11350060
113600***************************************************************   11360099
113700 5260-GET-CAT-STYLE.                                              11370099
113800                                                                  11380099
113900     EXEC SQL                                                     11390099
114000         SELECT MAX(B.CTG_SEQ_NBR)                                11400099
114100                ,B.RMS_STYL_ID                                    11410099
114200          INTO  :MDARVS-CTG-SEQ-NBR                               11420099
114300               ,:MDARVS-RMS-STYL-ID                               11430099
114400          FROM  XLT_SKU A                                         11440099
114500               ,TMDARVS B                                         11450099
114600         WHERE  A.SKU_NBR    = :XLT00003-SKU-NBR                  11460099
114700           AND  A.STYL_ID    = B.RMS_STYL_ID                      11470099
114800           AND  B.ACTV_IND   = :PC-Y                              11480099
114900           GROUP BY B.RMS_STYL_ID                                 11490099
115000          WITH UR                                                 11500099
115100     END-EXEC.                                                    11510099
115200                                                                  11520099
115300     EVALUATE TRUE                                                11530099
115400         WHEN SQLCODE = ZERO                                      11540099
115500         WHEN SQLCODE = -811                                      11550099
115600             MOVE MDARVS-RMS-STYL-ID    TO SU136-VENDOR-STYLE     11560099
115700             MOVE MDARVS-CTG-SEQ-NBR    TO SU136-CATEGORY         11570099
115800                                                                  11580099
115900         WHEN SQLCODE = +100                                      11590099
116000             MOVE ZEROES                TO SU136-CATEGORY         11600099
116100             PERFORM 5270-GET-STYL-ID                             11610099
116200                                                                  11620099
116300         WHEN SQLWARN0 NOT = SPACES                               11630099
116400         WHEN SQLCODE < ZERO                                      11640099
116500         WHEN SQLCODE > ZERO                                      11650099
116600             MOVE '5260-GET-CAT-STYLE'  TO PV-PARAGRAPH-NAME      11660099
116700             MOVE 'SELECT CAT/STYLE'    TO                        11670099
116800                                        PV-DB2-OPERATION-ATTEMPTED11680099
116900             DISPLAY 'SKU NBR BEING PROCESSED IS '                11690099
117000                                        XLT00003-SKU-NBR          11700099
117100             PERFORM 9100-SQL-ABEND                               11710099
117200     END-EVALUATE.                                                11720099
117300                                                                  11730099
117400                                                                  11740099
117500***************************************************************   11750099
117600 5270-GET-STYL-ID.                                                11760099
117700                                                                  11770099
117800     EXEC SQL                                                     11780099
117900         SELECT STYL_ID                                           11790099
118000           INTO :XLT00003-STYL-ID                                 11800099
118100           FROM XLT_SKU                                           11810099
118200          WHERE SKU_NBR  = :XLT00003-SKU-NBR                      11820099
118300           WITH UR                                                11830099
118400     END-EXEC.                                                    11840099
118500                                                                  11850099
118600     EVALUATE TRUE                                                11860099
118700         WHEN SQLCODE = ZERO                                      11870099
118800             MOVE XLT00003-STYL-ID      TO SU136-VENDOR-STYLE     11880099
118900                                                                  11890099
119000         WHEN SQLWARN0 NOT = SPACES                               11900099
119100         WHEN SQLCODE < ZERO                                      11910099
119200         WHEN SQLCODE > ZERO                                      11920099
119300             MOVE '5270-GET-STYL-ID'    TO PV-PARAGRAPH-NAME      11930099
119400             MOVE 'SELECT STYL-ID '     TO                        11940099
119500                                        PV-DB2-OPERATION-ATTEMPTED11950099
119600             DISPLAY 'SKU NBR BEING PROCESSED IS '                11960099
119700                                        XLT00003-SKU-NBR          11970099
119800             PERFORM 9100-SQL-ABEND                               11980099
119900     END-EVALUATE.                                                11990099
120000                                                                  12000099
113600***************************************************************   12001099
113700 5280-GET-OPC-SET-CDE.                                            12002099
113800                                                                  12003099
113900     EXEC SQL                                                     12004099
114000         SELECT G.SEASET_SHRT_NM                                  12005099
114100           INTO :SEASET-SEASET-SHRT-NM                            12006099
114200           FROM  WST_INTGRTN_TYP  A                               12007099
114300                ,WST_ATTR_DEFN    B                               12008099
114400                ,WST_ATTR_ELEM    C                               12009099
114500                ,WST_ATTR_ELEM    D                               12009199
114600                ,WST_ATTR_ELEM    E                               12009299
114700                ,WST_ATTR_ELEM    F                               12009399
114800                ,TSEASET          G                               12009499
114900                ,TPURCHS          H                               12009599
115000            WHERE A.INTGRTN_TYP_CDE   = 'OPCMFST'                 12009699
                    AND A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE         12009799
                    AND B.ATTR_DEFN_SEQ_NBR = 1                         12009899
                    AND B.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE         12009999
                    AND C.ATTR_DEFN_SEQ_NBR = 1                         12010099
                    AND B.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE         12010199
                    AND D.ATTR_DEFN_SEQ_NBR = 2                         12010299
                    AND B.INTGRTN_TYP_CDE   = E.INTGRTN_TYP_CDE         12010399
                    AND E.ATTR_DEFN_SEQ_NBR = 3                         12010499
                    AND B.INTGRTN_TYP_CDE   = F.INTGRTN_TYP_CDE         12010599
                    AND F.ATTR_DEFN_SEQ_NBR = 4                         12010699
                    AND C.ATTR_ELEM_SEQ_NBR = D.ATTR_ELEM_SEQ_NBR       12010799
                    AND C.ATTR_ELEM_SEQ_NBR = E.ATTR_ELEM_SEQ_NBR       12010899
                    AND C.ATTR_ELEM_SEQ_NBR = F.ATTR_ELEM_SEQ_NBR       12010999
                    AND C.ATTR_ELEM_TXT     = G.SEASET_TYP_CDE          12011099
                    AND D.ATTR_ELEM_TXT     = 'ACTIVE'                  12011199
                    AND E.ATTR_ELEM_TMST   <= CURRENT TIMESTAMP         12011299
                    AND F.ATTR_ELEM_TMST   >= CURRENT TIMESTAMP         12011399
                    AND G.SEASET_SHRT_NM    = H.SEASET_SHRT_NM          12011499
                    AND G.SEASET_YR         = H.SEASET_YR               12011599
                    AND H.PO_NBR            = :DK-PO-NBR                12011699
                    AND H.VER_STATUS_CDE    = 'A'                       12011799
115100     END-EXEC.                                                    12011899
115200                                                                  12011999
115300     EVALUATE TRUE                                                12012099
115400         WHEN SQLCODE = ZERO                                      12012199
115500         WHEN SQLCODE = -811                                      12012299
115600             MOVE 'Y'                   TO SU136-OPC-SET-IND      12012399
                                                 PV-SAVE-OPC-SET-IND    12012499
115800                                                                  12012599
115900         WHEN SQLCODE = +100                                      12012699
116000             MOVE 'N'                   TO SU136-OPC-SET-IND      12012799
                                                 PV-SAVE-OPC-SET-IND    12012899
116200                                                                  12012999
116300         WHEN SQLWARN0 NOT = SPACES                               12013099
116400         WHEN SQLCODE < ZERO                                      12013199
116500         WHEN SQLCODE > ZERO                                      12013299
116600             MOVE '5280-GET-OPC-SET-CDE' TO PV-PARAGRAPH-NAME     12013399
116700             MOVE 'SELECT OPC SET CODE'     TO                    12013499
116800                                       PV-DB2-OPERATION-ATTEMPTED 12013599
116900             DISPLAY 'PO NBR BEING PROCESSED IS '                 12013699
117000                                        XLT00003-SKU-NBR          12013799
117100             PERFORM 9100-SQL-ABEND                               12013899
117200     END-EVALUATE.                                                12013999
117300                                                                  12014099
120200*----------------------------------------------------------------*12020085
120300* CLOSE CURSOR                                                    12030085
120400*----------------------------------------------------------------*12040085
120500 5300-CLOSE-CSR.                                                  12050060
120600     EXEC SQL                                                     12060060
120700        CLOSE PO-RCVR-CSR                                         12070060
120800     END-EXEC.                                                    12080060
120900                                                                  12090060
121000     EVALUATE TRUE                                                12100060
121100         WHEN SQLCODE = ZERO                                      12110060
121200             CONTINUE                                             12120060
121300         WHEN SQLWARN0 NOT = SPACES                               12130060
121400         WHEN SQLCODE < ZERO                                      12140060
121500         WHEN SQLCODE > ZERO                                      12150060
121600             MOVE '5300-CLOSE-CSR' TO PV-PARAGRAPH-NAME           12160060
121700             MOVE 'SELECT SUT_OTBND_UPC'                          12170060
121800                                   TO PV-DB2-OPERATION-ATTEMPTED  12180060
121900             DISPLAY 'TRIP ID BEING PROCESSED IS ' SU012-TRIP-ID  12190060
122000             PERFORM 9100-SQL-ABEND                               12200060
122100     END-EVALUATE.                                                12210060
122200                                                                  12220060
122300*----------------------------------------------------------------*12230060
122400* GET REC SEQ NBR                                                 12240060
122500*----------------------------------------------------------------*12250060
122600 5400-GET-REC-SEQ-NBR.                                            12260060
122700     EXEC SQL                                                     12270060
122800         SELECT  B.REC_SEQ_NBR                                    12280060
122900          INTO   :PKSLIP-REC-SEQ-NBR                              12290060
123000          FROM  SUT_OTBND_VND A                                   12300060
123100               ,TPKSLIP B                                         12310060
123200         WHERE  A.SHIPT_UNT_ID  =  :PV-SHIPT-UNT-ID               12320060
123300           AND  A.PO_NBR        =  B.PO_NBR                       12330060
123400           AND  A.PKSL_SEQ_NBR  =  B.SEQ_NBR                      12340060
123500           AND  B.VER_STAT_CDE  =  :PC-A                          12350060
123600           WITH UR                                                12360060
123700     END-EXEC.                                                    12370060
123800                                                                  12380060
123900     EVALUATE TRUE                                                12390060
124000         WHEN SQLCODE = ZERO                                      12400060
124100             MOVE PKSLIP-REC-SEQ-NBR  TO  PC010-RCVR-SEQ-NBR      12410060
124200                                          SUT00028-RCVR-SEQ-NBR   12420060
124300         WHEN SQLCODE = +100                                      12430060
124400             MOVE ZERO                TO  PC010-RCVR-SEQ-NBR      12440060
124500                                          SUT00028-RCVR-SEQ-NBR   12450060
124600         WHEN SQLWARN0 NOT = SPACES                               12460060
124700         WHEN SQLCODE < ZERO                                      12470060
124800         WHEN SQLCODE > ZERO                                      12480060
124900             MOVE '5400-GET-REC-SEQ-NBR ' TO PV-PARAGRAPH-NAME    12490060
125000             MOVE 'SELECT TPKSLIP ' TO PV-DB2-OPERATION-ATTEMPTED 12500060
125100             DISPLAY 'TRIP ID BEING PROCESSED IS ' SU012-TRIP-ID  12510060
125200             PERFORM 9100-SQL-ABEND                               12520060
125300     END-EVALUATE.                                                12530060
125400                                                                  12540060
125500 5500-EMPTY-CARTON.                                               12550060
125600                                                                  12560060
125700     INITIALIZE PV-EMPTY-CARTON-REC.                              12570060
125800                                                                  12580060
125900     MOVE PV-SHIPT-UNT-ID             TO SU056-SHIPT-UNT-ID       12590060
126000     MOVE SU012-TRIP-ID               TO SU056-OTBND-TRIP-ID      12600060
126100     EXEC SQL                                                     12610060
126200         SET :SU056-PROCESS-TIMESTAMP = CURRENT TIMESTAMP         12620060
126300     END-EXEC.                                                    12630060
126400                                                                  12640060
126500     EVALUATE TRUE                                                12650060
126600        WHEN SU012-SHIPPED-FROM-DC AND SU012-UNLOADED-AT-STORE    12660060
126700             PERFORM 3020-RETRIEVE-TRIP-INFO                      12670060
126800             MOVE PV-OTBND-STAT-TMST   TO SU056-EVENT-TMST-SU     12680060
126900             MOVE PV-OTBND-STAT-TMST-1 TO SU056-EVENT-TMST-DS     12690060
127000         WHEN SU012-NOT-UNLOADED-AT-STORE                         12700060
127100             MOVE PV-OTBND-STAT-TMST-1 TO SU056-EVENT-TMST-DS     12710060
127200         WHEN OTHER                                               12720060
127300             MOVE PV-OTBND-STAT-TMST-1 TO SU056-EVENT-TMST-SU     12730060
127400     END-EVALUATE.                                                12740060
127500                                                                  12750060
127600     MOVE SUOBTR-DEST-OPER-UNT-ID     TO SU056-STR-NBR.           12760060
127700     MOVE PC010-TRN-TYP-CDE           TO SU056-TRN-TYP-CDE        12770060
127800     MOVE SU012-STAT-CDE-DS           TO SU056-STAT-CDE-DS        12780060
127900     MOVE SU012-STAT-CDE-SU           TO SU056-STAT-CDE-SU        12790060
128000     MOVE 'IT'                        TO SU056-TRN-CLSN-CDE       12800060
128100*    MOVE SU012-INTRNST-SW            TO SU056-INTRNST-SW         12810060
128200                                                                  12820060
128300     PERFORM 8100-WRITE-EMPTY-CARTON-REC.                         12830060
128400                                                                  12840060
128500                                                                  12850060
128600*ADDED 5600-6100 07/07/2016 CLP                                   12860060
128700***************************************************************** 12870060
128800*GET THE COST OF THE ITEM WHEN PO WAS CREATED                     12880060
128900* FOR ASN CARTON                                                  12890060
129000***************************************************************** 12900060
129100                                                                  12910060
129200 5600-GET-COST.                                                   12920060
129300                                                                  12930060
129400     EXEC SQL                                                     12940060
129500        SELECT B.UNT_COST_AMT                                     12950060
129600          INTO  :PURITM-UNT-COST-AMT                              12960060
129700          FROM  TRECITM A                                         12970060
129800               ,TPURITM B                                         12980060
129900         WHERE A.ORD_NBR             = :DK-PO-NBR                 12990060
130000           AND A.REC_SEQ_NBR         = :DK-RCVR-SEQ-NBR           13000060
130100           AND A.ORD_LNE_NBR         = :DK-TRN-LNE-NBR            13010060
130200           AND A.ORD_NBR             = B.PO_NBR                   13020060
130300           AND A.PO_VER_NBR          = B.VER_NBR                  13030060
130400           AND A.ORD_LNE_NBR         = B.APP_PO_LNE_NBR           13040060
130500           AND A.VER_STATUS_CDE      = 'A'                        13050060
130600          WITH UR                                                 13060060
130700     END-EXEC.                                                    13070060
130800                                                                  13080060
130900     EVALUATE TRUE                                                13090060
131000         WHEN SQLCODE = ZERO                                      13100060
131100             CONTINUE                                             13110060
131200         WHEN SQLCODE = +100                                      13120060
131300             MOVE ZERO TO PURITM-UNT-COST-AMT                     13130060
131400         WHEN SQLWARN0 NOT = SPACES                               13140060
131500         WHEN SQLCODE < ZERO                                      13150060
131600         WHEN SQLCODE > ZERO                                      13160060
131700             MOVE '5600-GET-COST'                                 13170060
131800                                        TO PV-PARAGRAPH-NAME      13180060
131900             MOVE 'SELECT TPURITM ' TO PV-DB2-OPERATION-ATTEMPTED 13190060
132000             MOVE PV-TRLR-SRL-NBR TO PV-TRLR-SRL-NBR-DISP         13200060
132100             DISPLAY 'TRIP ID BEING PROCESSED IS ' SU012-TRIP-ID  13210060
132200             DISPLAY 'TRLR SRL NUMBER IS ' PV-TRLR-SRL-NBR-DISP   13220060
132300             DISPLAY 'PO IS    ' SUT00028-TRN-NBR                 13230060
132400             DISPLAY 'RECV IS  ' SUT00028-RCVR-SEQ-NBR            13240060
132500             DISPLAY 'LINE# IS ' SUT00028-TRN-LNE-NBR             13250060
132600             PERFORM 9100-SQL-ABEND                               13260060
132700     END-EVALUATE.                                                13270060
132800                                                                  13280060
132900**************************************************************    13290060
133000*   FOR ASN                                                       13300060
133100************************************************************      13310060
133200*GET THE RETAIL FOR THE EXPECTED STORE-IF NOT THERE GET THE       13320060
133300*RETAIL FOR THE '0' STR                                           13330060
133400**************************************************************    13340060
133500                                                                  13350060
133600 5700-GET-RETAIL.                                                 13360060
133700     MOVE XLT00003-INTR-UPC-ID TO DK-INTR-UPC-ID.                 13370060
133800     MOVE SU136-DEST-LOC-NBR   TO DK-STR-NBR.                     13380067
133900                                                                  13390067
134000     EXEC SQL                                                     13400067
134100        SELECT A.UNT_RTL_AMT                                      13410067
134200          INTO  :XLV00002-UNT-RTL-AMT                             13420067
134300          FROM  XLV_SKU_STR A                                     13430067
134400         WHERE A.INTR_UPC_ID         = :DK-INTR-UPC-ID            13440067
134500           AND A.STR_NBR             = :DK-STR-NBR                13450067
134600          WITH UR                                                 13460067
134700     END-EXEC.                                                    13470067
134800                                                                  13480067
134900     EVALUATE TRUE                                                13490067
135000         WHEN SQLCODE = ZERO                                      13500067
135100             CONTINUE                                             13510067
135200         WHEN SQLCODE = +100                                      13520067
135300             PERFORM 5900-GET-0RETAIL                             13530067
135400         WHEN SQLWARN0 NOT = SPACES                               13540067
135500         WHEN SQLCODE < ZERO                                      13550067
135600         WHEN SQLCODE > ZERO                                      13560067
135700             MOVE '5700-GET-RETAIL     '                          13570067
135800                                        TO PV-PARAGRAPH-NAME      13580067
135900             MOVE 'SELECT XLV_SKU_STR' TO                         13590067
136000                                        PV-DB2-OPERATION-ATTEMPTED13600067
136100             MOVE PV-TRLR-SRL-NBR TO PV-TRLR-SRL-NBR-DISP         13610067
136200             DISPLAY 'TRIP ID BEING PROCESSED IS ' SU012-TRIP-ID  13620067
136300             DISPLAY 'TRLR SRL NUMBER IS ' PV-TRLR-SRL-NBR-DISP   13630067
136400             DISPLAY 'PO IS    ' SUT00028-TRN-NBR                 13640067
136500             DISPLAY 'RECV IS  ' SUT00028-RCVR-SEQ-NBR            13650067
136600             DISPLAY 'LINE# IS ' SUT00028-TRN-LNE-NBR             13660067
136700             PERFORM 9100-SQL-ABEND                               13670067
136800     END-EVALUATE.                                                13680067
136900                                                                  13690060
137000                                                                  13700060
137100************************************************************      13710060
137200*   FOR ASN CARTON                                                13720060
137300************************************************************      13730060
137400 5900-GET-0RETAIL.                                                13740060
137500     MOVE XLT00003-INTR-UPC-ID TO DK-INTR-UPC-ID.                 13750060
137600                                                                  13760060
137700     EXEC SQL                                                     13770060
137800        SELECT A.UNT_RTL_AMT                                      13780060
137900          INTO  :XLV00002-UNT-RTL-AMT                             13790060
138000          FROM  XLV_SKU_STR A                                     13800060
138100         WHERE A.INTR_UPC_ID         = :DK-INTR-UPC-ID            13810060
138200           AND A.STR_NBR             = 0                          13820060
138300          WITH UR                                                 13830060
138400     END-EXEC.                                                    13840060
138500                                                                  13850060
138600     EVALUATE TRUE                                                13860060
138700         WHEN SQLCODE = ZERO                                      13870060
138800             CONTINUE                                             13880060
138900         WHEN SQLCODE = +100                                      13890060
139000             MOVE ZERO TO XLV00002-UNT-RTL-AMT                    13900060
139100         WHEN SQLWARN0 NOT = SPACES                               13910060
139200         WHEN SQLCODE < ZERO                                      13920060
139300         WHEN SQLCODE > ZERO                                      13930060
139400             MOVE '5900-GET-0RETAIL'                              13940060
139500                                        TO PV-PARAGRAPH-NAME      13950060
139600             MOVE 'SELECT XLV_SKU_STR' TO                         13960060
139700                                        PV-DB2-OPERATION-ATTEMPTED13970060
139800             MOVE PV-TRLR-SRL-NBR TO PV-TRLR-SRL-NBR-DISP         13980060
139900             DISPLAY 'TRIP ID BEING PROCESSED IS ' SU012-TRIP-ID  13990060
140000             DISPLAY 'TRLR SRL NUMBER IS ' PV-TRLR-SRL-NBR-DISP   14000060
140100             DISPLAY 'PO IS    ' SUT00028-TRN-NBR                 14010060
140200             DISPLAY 'RECV IS  ' SUT00028-RCVR-SEQ-NBR            14020060
140300             DISPLAY 'LINE# IS ' SUT00028-TRN-LNE-NBR             14030060
140400             PERFORM 9100-SQL-ABEND                               14040060
140500     END-EVALUATE.                                                14050060
140600                                                                  14060060
140700************************************************************      14070060
140800*   FOR IR  CARTON                                                14080060
140900************************************************************      14090060
141000 6000-GET-COST-RETAIL.                                            14100060
141100     MOVE XLT00003-INTR-UPC-ID TO DK-INTR-UPC-ID.                 14110060
141200     MOVE SU136-DEST-LOC-NBR   TO DK-STR-NBR.                     14120067
141300                                                                  14130060
141400     EXEC SQL                                                     14140060
141500        SELECT A.UNT_COST_AMT                                     14150060
141600               ,A.UNT_RTL_AMT                                     14160060
141700          INTO  :XLV00002-UNT-COST-AMT                            14170060
141800               ,:XLV00002-UNT-RTL-AMT                             14180060
141900          FROM  XLV_SKU_STR A                                     14190060
142000         WHERE A.INTR_UPC_ID         = :DK-INTR-UPC-ID            14200060
142100           AND A.STR_NBR             = :DK-STR-NBR                14210060
142200          WITH UR                                                 14220060
142300     END-EXEC.                                                    14230060
142400                                                                  14240060
142500     EVALUATE TRUE                                                14250060
142600         WHEN SQLCODE = ZERO                                      14260060
142700             CONTINUE                                             14270060
142800         WHEN SQLCODE = +100                                      14280060
142900             PERFORM 6100-GET-0COST                               14290060
143000         WHEN SQLWARN0 NOT = SPACES                               14300060
143100         WHEN SQLCODE < ZERO                                      14310060
143200         WHEN SQLCODE > ZERO                                      14320060
143300             MOVE '6000-GET-COST-RETAIL'                          14330060
143400                                        TO PV-PARAGRAPH-NAME      14340060
143500             MOVE 'SELECT XLV_SKU_STR' TO                         14350060
143600                                        PV-DB2-OPERATION-ATTEMPTED14360060
143700             MOVE PV-TRLR-SRL-NBR TO PV-TRLR-SRL-NBR-DISP         14370060
143800             DISPLAY 'TRIP ID BEING PROCESSED IS ' SU012-TRIP-ID  14380060
143900             DISPLAY 'TRLR SRL NUMBER IS ' PV-TRLR-SRL-NBR-DISP   14390060
144000             DISPLAY 'PO IS    ' SUT00028-TRN-NBR                 14400060
144100             DISPLAY 'RECV IS  ' SUT00028-RCVR-SEQ-NBR            14410060
144200             DISPLAY 'LINE# IS ' SUT00028-TRN-LNE-NBR             14420060
144300             PERFORM 9100-SQL-ABEND                               14430060
144400     END-EVALUATE.                                                14440060
144500                                                                  14450060
144600************************************************************      14460060
144700*   FOR IR  CARTON                                                14470060
144800************************************************************      14480060
144900 6100-GET-0COST.                                                  14490060
145000     MOVE XLT00003-INTR-UPC-ID TO DK-INTR-UPC-ID.                 14500060
145100                                                                  14510060
145200** START CHG0149828                                               14520060
145300                                                                  14530060
145400     EXEC SQL                                                     14540060
145500        SELECT  A.UNT_COST_AMT                                    14550060
145600               ,A.UNT_RTL_AMT                                     14560060
145700          INTO  :XLV00002-UNT-COST-AMT                            14570060
145800               ,:XLV00002-UNT-RTL-AMT                             14580060
145900          FROM  XLV_SKU_STR A                                     14590060
146000         WHERE A.INTR_UPC_ID         = :DK-INTR-UPC-ID            14600060
146100           AND A.STR_NBR             = 0                          14610060
146200          WITH UR                                                 14620060
146300     END-EXEC.                                                    14630060
146400                                                                  14640060
146500** END CHG0149828                                                 14650060
146600                                                                  14660060
146700     EVALUATE TRUE                                                14670060
146800         WHEN SQLCODE = ZERO                                      14680060
146900             CONTINUE                                             14690060
147000         WHEN SQLCODE = +100                                      14700060
147100             MOVE ZERO TO XLV00002-UNT-COST-AMT                   14710060
147200                          XLV00002-UNT-RTL-AMT                    14720060
147300         WHEN SQLWARN0 NOT = SPACES                               14730060
147400         WHEN SQLCODE < ZERO                                      14740060
147500         WHEN SQLCODE > ZERO                                      14750060
147600             MOVE '6100-GET-0COST'                                14760060
147700                                        TO PV-PARAGRAPH-NAME      14770060
147800             MOVE 'SELECT XLV_SKU_STR' TO                         14780060
147900                                        PV-DB2-OPERATION-ATTEMPTED14790060
148000             MOVE PV-TRLR-SRL-NBR TO PV-TRLR-SRL-NBR-DISP         14800060
148100             DISPLAY 'TRIP ID BEING PROCESSED IS ' SU012-TRIP-ID  14810060
148200             DISPLAY 'TRLR SRL NUMBER IS ' PV-TRLR-SRL-NBR-DISP   14820060
148300             DISPLAY 'PO IS    ' SUT00028-TRN-NBR                 14830060
148400             DISPLAY 'RECV IS  ' SUT00028-RCVR-SEQ-NBR            14840060
148500             DISPLAY 'LINE# IS ' SUT00028-TRN-LNE-NBR             14850060
148600             PERFORM 9100-SQL-ABEND                               14860060
148700     END-EVALUATE.                                                14870060
148800                                                                  14880060
148900******************************************************************14890060
149000*  READ INPUT FILE.                                               14900060
149100******************************************************************14910060
149200 7000-READ-FILE.                                                  14920060
149300      INITIALIZE SU012-EXTRACT-RECORD.                            14930060
149400      READ TSUOBTS-UNLOAD-FILE INTO                               14940060
149500          SU012-EXTRACT-RECORD                                    14950060
149600            AT END SET PS-END-OF-FILE TO TRUE.                    14960060
149700                                                                  14970060
149800      IF PS-END-OF-FILE                                           14980060
149900         CONTINUE                                                 14990060
150000      ELSE                                                        15000060
150100         ADD +1 TO PV-READ-COUNTER                                15010060
150200      END-IF.                                                     15020060
150300                                                                  15030060
150400******************************************************************15040060
150500*  WRITE OUTPUT FILE.                                             15050060
150600******************************************************************15060060
150700 8000-WRITE-OUTPUT.                                               15070060
150800                                                                  15080060
150900     MOVE SU012-STAT-CDE-DS           TO PC010-STAT-CDE-DS        15090060
151000     MOVE SU012-STAT-CDE-SU           TO PC010-STAT-CDE-SU        15100060
151100     MOVE 'IT'                        TO PC010-TRN-CLSN-CDE       15110060
151200* 1/6/17 CLP ADDED                                                15120060
151210                                                                  15121099
151300     SET PS-FAST-TRANSFER-NO          TO TRUE.                    15130060
151400**IF PS-FAST-TRANSFER-NO  - THEN SEND FXR                         15140099
151600     IF  SUT00028-TRN-TYP-CDE = 'FX'                              15160060
151610          IF PS-FAST-TRSFR-ALL                                    15161099
151700             CONTINUE                                             15170099
151710          ELSE                                                    15171099
151712             IF PS-FAST-TRSFR-EXC                                 15171299
151713               PERFORM 8120-CHECK-STR-SCANNING                    15171399
151714               IF PS-NON-SCANNING-STORE                           15171499
151715                  SET PS-FAST-TRANSFER-YES TO TRUE                15171599
151716               END-IF                                             15171699
151717             ELSE                                                 15171799
151718***NO STORES ON                                                   15171899
151719                  SET PS-FAST-TRANSFER-YES TO TRUE                15171999
151720             END-IF                                               15172099
151730          END-IF                                                  15173099
151800     ELSE                                                         15180060
151900          WRITE  CARTON-DETAIL-RECORD                             15190060
152000          FROM  PC010-PCT-INTRANSIT-REC                           15200060
152100          ADD    +1   TO PV-UPC-COUNT                             15210060
152200     END-IF.                                                      15220060
152300                                                                  15230099
152400     IF SU012-SHIPPED-FROM-DC                                     15240060
152500* ADDED 8/1/11 DMH                                                15250060
152600* UPDATED IF COND TO ADD 'AND PC010-SHIPPD-DC' TO FIX INC0155049  15260060
152700* 1/6/17 CLP - DONT SEND FAST TRANSFERS (FX) TO MLS               15270062
152800         IF  PS-SEND-MANIFEST-TO-MLS-YES                          15280060
152900         AND PC010-SHIPPD-DC                                      15290060
153000         AND PS-FAST-TRANSFER-NO                                  15300099
153100* ADDED 2/17/17 CLP                                               15310067
153200             SET SU136-MLS-RECORD TO TRUE                         15320069
153300             INITIALIZE SU136-ORGN-OPER-UNT-ID                    15330075
153400                        SU136-TRLR-ID                             15340075
153500                        SU136-TRLR-SRL-NBR                        15350075
153600                        SU136-SHIP-SCAC-CDE                       15360075
153700                        SU136-TRN-NBR                             15370075
153800                        SU136-RCVR-SEQ-NBR                        15380075
153900                        SU136-UNIT-RETAIL                         15390075
154000                        SU136-COST-AMT                            15400077
154100                        SU136-TMST-ON-TRLR                        15410082
154200                        SU136-DTE-AT-DC                           15420077
154300                        SU136-TM-AT-DC                            15430077
154400             WRITE OMS-MLS-RECORD                                 15440077
154500              FROM SU136-EXTRACT-RECORD                           15450067
154600               ADD    +1   TO PV-OMS-MLS-EXT-COUNT                15460067
154700* ADDED 2/25/16 CLP                                               15470060
154800* 1/6/17 CLP - DONT SEND FAST TRANSFERS (FX) TO OMS               15480060
154900             IF  PS-SEND-MANIFEST-TO-OMS-YES                      15490067
155000                 AND PS-FAST-TRANSFER-NO                          15500099
155100* ADDED 2/17/17 CLP                                               15510067
155200                SET SU136-OMS-RECORD TO TRUE                      15520099
155300                MOVE PV-ORGN-OPER-UNT-ID TO SU136-ORGN-OPER-UNT-ID15530072
155400                MOVE PV-TRLR-ID          TO SU136-TRLR-ID         15540072
155500                MOVE PV-TRLR-SRL-NBR     TO SU136-TRLR-SRL-NBR    15550072
155600                MOVE PV-SHIP-SCAC-CDE    TO SU136-SHIP-SCAC-CDE   15560072
155700                MOVE PV-TRN-NBR          TO SU136-TRN-NBR         15570072
155800                MOVE PV-RCVR-SEQ-NBR     TO SU136-RCVR-SEQ-NBR    15580072
155900                MOVE PV-UNIT-RETAIL      TO SU136-UNIT-RETAIL     15590072
156000                MOVE PV-COST-AMT         TO SU136-COST-AMT        15600072
156100                MOVE PV-DTE-AT-DC        TO SU136-DTE-AT-DC       15610077
156200                MOVE PV-TM-AT-DC         TO SU136-TM-AT-DC        15620077
156300                PERFORM 8110-SELECT-CARTON                        15630080
156400                MOVE PV-TMST-ON-TRLR     TO SU136-TMST-ON-TRLR    15640082
156500                 WRITE OMS-MLS-RECORD                             15650077
156600                  FROM SU136-EXTRACT-RECORD                       15660077
156700                  ADD    +1   TO PV-OMS-MLS-EXT-COUNT             15670077
156800             END-IF                                               15680077
156900         END-IF                                                   15690060
157000*                                                                 15700060
157100         IF SU043-SHIPT-UNT-ID  >  0                              15710060
157200             IF  SU043-SHIPT-UNT-ID  =  PV-KOHLS-SML-HOLD         15720060
157300                 CONTINUE                                         15730060
157400             ELSE                                                 15740060
157500                 WRITE CARTON-TRIP-RECORD                         15750060
157600                  FROM SU043-RECORD                               15760060
157700                 MOVE  SU043-SHIPT-UNT-ID                         15770060
157800                   TO  PV-KOHLS-SML-HOLD                          15780060
157900                 ADD    +1   TO  PV-CARTON-COUNT                  15790060
158000             END-IF                                               15800060
158100         END-IF                                                   15810060
158200     END-IF.                                                      15820060
158300                                                                  15830060
160500 8100-WRITE-EMPTY-CARTON-REC.                                     16050060
160600                                                                  16060060
160700     WRITE EMPTY-CARTON-RECORD FROM PV-EMPTY-CARTON-REC           16070060
160800     ADD 1                            TO PV-EMPTY-CARTON-COUNT.   16080060
160900/                                                                 16090060
160940***********************************************************       16094099
160941* GETS THE TSUCRDV - SUCRDV-DIVERT-TMST FOR THE CARTON            16094199
160942*                                                                 16094299
160943* PARAGRAPH WILL CHECK TO SEE IF THE SML BEING PROCESSED          16094399
160944* IS THE SAME AS THE PREVIOUS SML AND IF SO, WILL JUST            16094499
160945* USE THE TIMESTAMP FROM THE PREVIOUS CALL TO THE MODULE,         16094599
160946* OTHERWISE IF A DIFFERENT SML, THEN IT WILL CALL THE             16094699
160947* PCKUT713 MODULE IN PARAGRAPH 8111-EXEC-MODULE-CALL              16094799
160948***********************************************************       16094899
160950 8110-SELECT-CARTON.                                              16095099
160960                                                                  16096099
161010     IF  SU136-SHIPT-UNT-ID = PV-PREV-SU136-SHIPT-UNT-ID          16101099
161020         MOVE PV-SAVED-TMST TO PV-TMST-ON-TRLR                    16102099
161040     ELSE                                                         16104099
161060         PERFORM 8111-EXEC-MODULE-CALL                            16106099
161061         MOVE SU136-SHIPT-UNT-ID TO                               16106199
161062              PV-PREV-SU136-SHIPT-UNT-ID                          16106299
161063         MOVE PV-TMST-ON-TRLR TO                                  16106399
161064              PV-SAVED-TMST                                       16106499
161065     END-IF.                                                      16106599
161066                                                                  16106699
161067 8111-EXEC-MODULE-CALL.                                           16106799
161068                                                                  16106899
161071     MOVE SPACES TO PC046-CRA-RET-MSG                             16107199
161072                    PC046-CRA-REQ-ID.                             16107299
161073     MOVE '00'   TO PC046-CRA-RET-CDE.                            16107399
161074                                                                  16107499
161075     MOVE PC-CURRENT-PROGRAM-NAME TO PC046-CALLING-PGM-NME.       16107599
161076     MOVE SU136-SHIPT-UNT-ID      TO PC046-CARTON-ID.             16107699
161077     CALL PC-CRTN-STATUS-PGM                                      16107799
161078        USING PC046-COMMAREA-REC.                                 16107899
161085                                                                  16108599
161086     IF  PC046-SUCCESSFUL                                         16108699
161087         MOVE PC046-CRTN-STAT-TMST TO PV-TMST-ON-TRLR             16108799
161088     ELSE                                                         16108899
161089         IF  PC046-CRTN-STAT-ERROR                                16108999
161090             PERFORM 8112-GET-ON-TRLR-TIMESTAMP                   16109099
161091             MOVE PV-DIVERT-TMST TO PV-TMST-ON-TRLR               16109199
161092         ELSE                                                     16109299
161093             DISPLAY '** ABEND - PROGRAM ' PC-CURRENT-PROGRAM-NAME16109399
161094             DISPLAY '** BAD CALL TO CRTN STATUS PGM PCKUT713'    16109499
161095             DISPLAY 'PC046-CRA-RET-CDE = ' PC046-CRA-RET-CDE     16109599
161096             DISPLAY PC046-CRA-RET-MSG                            16109699
161097             MOVE +4019 TO ABEND-CODE                             16109799
161098             CALL 'ILBOABN0' USING ABEND-CODE                     16109899
161099         END-IF                                                   16109999
161100     END-IF.                                                      16110099
161101                                                                  16110199
161102******************************************************************16110299
161103*  THIS PARAGRAPH WILL BE USED TO GET THE DIVERT TIMESTAMP FOR    16110399
161104*  THE CARTON WHEN THE CALL TO PCKUT713 RETURNS A CODE INDICATING 16110499
161105*  THAT FOR THE CARTON BEING PROCESSED, THERE WAS AN ACTIVE SCAN  16110599
161106*  ON FOR THE CARTON FOLLOWED BY AN ACTIVE DIVERT ROW FOR THE     16110699
161107*  CARTON THAT WAS MORE RECENT THEN THE SCAN ON.  THIS CAN HAPPEN 16110799
161108*  IF THE CARTON THAT HAS AN ACTIVE SCAN ON ALSO WAS DIVERTED ON  16110899
161109*  THE DAY THAT SUK060 IS RUNNING AND SUK060 IS RUNNING BEFORE    16110999
161110*  JOB SUK015 (PROGRAM SUKP020) WOULD HAVE BEEN ABLE TO           16111099
161111*  INACTIVATE THE SCAN ON ENTRY.                                  16111199
161112******************************************************************16111299
161113 8112-GET-ON-TRLR-TIMESTAMP.                                      16111399
161114                                                                  16111499
161116     MOVE SU136-SHIPT-UNT-ID      TO DK-CARTON-ID.                16111699
161119                                                                  16111999
161120     EXEC SQL                                                     16112099
161121          SELECT  DIVERT_TMST                                     16112199
161122            INTO :PV-DIVERT-TMST                                  16112299
161123            FROM  TSUCRDV                                         16112399
161124           WHERE  SHIPT_UNT_ID = :DK-CARTON-ID                    16112499
161125             AND  ACTV_CDE     = 'A'                              16112599
161126             AND  DIVERT_TMST =                                   16112699
161127                   (SELECT MAX(B.DIVERT_TMST)                     16112799
161128                      FROM TSUCRDV B                              16112899
161129                     WHERE B.SHIPT_UNT_ID = :DK-CARTON-ID)        16112999
161130          WITH UR                                                 16113099
161131     END-EXEC.                                                    16113199
161132                                                                  16113299
161133     EVALUATE TRUE                                                16113399
161134         WHEN SQLCODE = ZERO                                      16113499
161135         WHEN SQLCODE = -811                                      16113599
161136              CONTINUE                                            16113699
161137         WHEN SQLWARN0 NOT = SPACES                               16113799
161138         WHEN SQLCODE < ZERO                                      16113899
161139         WHEN SQLCODE > ZERO                                      16113999
161140             MOVE '8112-GET-ON-TRLR-TIMESTAMP' TO                 16114099
161141                  PV-PARAGRAPH-NAME                               16114199
161142             MOVE 'SELECT TSUCRDV         ' TO                    16114299
161143                  PV-DB2-OPERATION-ATTEMPTED                      16114399
161144             MOVE DK-CARTON-ID TO PV-DISPLAY-CARTON               16114499
161145             MOVE SQLCODE TO PV-DISPLAY-SQLCODE                   16114599
161146             DISPLAY 'TRIP ID BEING PROCESSED IS ' SU012-TRIP-ID  16114699
161147             DISPLAY 'TRLR SRL NUMBER IS ' PV-TRLR-SRL-NBR-DISP   16114799
161148             DISPLAY 'CARTON IS ' PV-DISPLAY-CARTON               16114899
161149             DISPLAY 'SQLCODE IS ' PV-DISPLAY-SQLCODE             16114999
161150             PERFORM 9100-SQL-ABEND                               16115099
161151     END-EVALUATE.                                                16115199
161152                                                                  16115299
161156******************************************************************16115699
161157*  CHECK IF SCANNING HAS BEEN TURNED ON FOR THE STORE.            16115799
161158******************************************************************16115899
161159 8120-CHECK-STR-SCANNING.                                         16115999
161160     MOVE SU012-TRIP-ID  TO SUOBTS-OTBND-TRIP-ID.                 16116099
161161                                                                  16116199
161162     EXEC SQL                                                     16116299
161163        SELECT  E.OTBND_STAT_TMST                                 16116399
161164          INTO :SUOBTS-OTBND-STAT-TMST                            16116499
161165          FROM  WST_INTGRTN_TYP   A                               16116599
161166             ,  WST_ATTR_DEFN     B                               16116699
161167             ,  WST_ATTR_ELEM     C                               16116799
161168             ,  WST_ATTR_ELEM     D                               16116899
161169             ,  TSUOBTS           E                               16116999
161170             ,  TSUOBTR           F                               16117099
161171         WHERE  C.ATTR_ELEM_NBR      = F.DEST_OPER_UNT_ID         16117199
161172           AND  A.INTGRTN_TYP_CDE    = 'STOTBNDUPD'               16117299
161173           AND  A.INTGRTN_TYP_CDE    = B.INTGRTN_TYP_CDE          16117399
161174           AND  B.ATTR_DEFN_SEQ_NBR  = 1                          16117499
161175           AND  B.INTGRTN_TYP_CDE    = C.INTGRTN_TYP_CDE          16117599
161176           AND  C.ATTR_DEFN_SEQ_NBR  = 1                          16117699
161177           AND  B.INTGRTN_TYP_CDE    = D.INTGRTN_TYP_CDE          16117799
161178           AND  D.ATTR_DEFN_SEQ_NBR  = 2                          16117899
161179           AND  C.INTGRTN_TYP_CDE    = D.INTGRTN_TYP_CDE          16117999
161180           AND  C.ATTR_ELEM_SEQ_NBR  = D.ATTR_ELEM_SEQ_NBR        16118099
161181           AND  E.OTBND_TRIP_ID      = :SUOBTS-OTBND-TRIP-ID      16118199
161182           AND  E.OTBND_TRIP_ID      = F.OTBND_TRIP_ID            16118299
161183           AND  E.TRIP_STAT_CDE      = 'DS'                       16118399
161184           AND  D.ATTR_ELEM_TMST     <= E.OTBND_STAT_TMST         16118499
161185         WITH UR                                                  16118599
161186       END-EXEC.                                                  16118699
161187                                                                  16118799
161188     EVALUATE TRUE                                                16118899
161189         WHEN SQLCODE = ZERO                                      16118999
161190         WHEN SQLCODE = -811                                      16119099
161191              SET PS-SCANNING-STORE      TO TRUE                  16119199
161192         WHEN SQLCODE = +100                                      16119299
161193              SET PS-NON-SCANNING-STORE  TO TRUE                  16119399
161194         WHEN SQLWARN0 NOT = SPACES                               16119499
161195         WHEN SQLCODE < ZERO                                      16119599
161196         WHEN SQLCODE > ZERO                                      16119699
161197             MOVE '8120-CHECK-STR-SCANNING' TO PV-PARAGRAPH-NAME  16119799
161198             MOVE 'SELECT WST STR SCANNING' TO                    16119899
161199                                        PV-DB2-OPERATION-ATTEMPTED16119999
161200             PERFORM 9100-SQL-ABEND                               16120099
161201     END-EVALUATE.                                                16120199
161202                                                                  16120299
161203                                                                  16120399
161204                                                                  16120499
161205******************************************************************16120599
161206*  CLOSE INPUT FILE.  DISPLAY COUNTERS.                           16120660
161210******************************************************************16121060
161300 9000-EOJ-ROUTINE.                                                16130060
161400     CLOSE TSUOBTS-UNLOAD-FILE                                    16140060
161500           CARTON-DETAIL-FILE                                     16150060
161600           CARTON-TRIP-FILE                                       16160060
161700           EMPTY-CARTON-FILE                                      16170060
161800*ADDED 2/17/17 CLP                                                16180068
161900           COMB-OMS-MLS-FILE                                      16190068
162000                                                                  16200060
162100     MOVE PV-READ-COUNTER TO PV-DISPLAY-COUNT.                    16210060
162200     DISPLAY 'TOTAL RECORDS READ.: '  PV-DISPLAY-COUNT.           16220060
162300     MOVE PV-UPC-COUNT    TO PV-DISPLAY-COUNT.                    16230060
162400     DISPLAY 'TOTAL CARTON DETAIL: '  PV-DISPLAY-COUNT.           16240060
162500     MOVE PV-CARTON-COUNT TO PV-DISPLAY-COUNT.                    16250060
162600     DISPLAY 'TOTAL TRIP CARTONS.: '  PV-DISPLAY-COUNT.           16260060
162700                                                                  16270060
162800     MOVE PV-EMPTY-CARTON-COUNT TO PV-DISPLAY-COUNT.              16280060
162900     DISPLAY 'TOTAL EMPTY CARTONS.: '  PV-DISPLAY-COUNT.          16290060
163000                                                                  16300060
163100     MOVE PV-OMS-MLS-EXT-COUNT TO PV-DISPLAY-COUNT.               16310068
163200     DISPLAY 'TOTAL OMS-MLS  EXT.: '  PV-DISPLAY-COUNT.           16320068
163300                                                                  16330068
163400     DISPLAY '*****  SUKUT013 ENDED  *****'.                      16340060
163500                                                                  16350060
163600******************************************************************16360060
163700*  PERFORMS THE ABEND FOR THE PROGRAM IN THE EVENT THAT AN SQL    16370060
163800*  ERROR OR WARNING CODE OCCURS.                                  16380060
163900******************************************************************16390060
164000 9100-SQL-ABEND.                                                  16400060
164100     DISPLAY '9100-SQL-ABEND'.                                    16410060
164200     DISPLAY '** ABEND     **'.                                   16420060
164300     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        16430060
164400     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.              16440060
164500     DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION-ATTEMPTED.     16450060
164600     DISPLAY '** TRIP ID   ** = ' SU012-TRIP-ID.                  16460060
164700                                                                  16470060
164800******************************************************************16480060
164900* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-    16490060
165000* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE         16500060
165100* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE     16510060
165200* FORMAT.                                                         16520060
165300******************************************************************16530060
165400     COPY DPPD004.                                                16540060
165500                                                                  16550060
165600     MOVE +4013                  TO ABEND-CODE.                   16560060
165700     CALL 'ILBOABN0' USING ABEND-CODE.                            16570060
165800                                                                  16580060
165900***************************************************************** 16590060
166000* PCPD049 - PROCEDURE DIVISION USED TO DETERMINE TRAILER CONTENTS 16600060
166100***************************************************************** 16610060
166200     COPY PCPD049.                                                16620060
166300                                                                  16630060
