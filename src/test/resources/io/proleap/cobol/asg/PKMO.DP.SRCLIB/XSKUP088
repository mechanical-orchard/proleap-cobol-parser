       IDENTIFICATION DIVISION.                                         00010003
       PROGRAM-ID.      XSKUP088.                                       00020003
       AUTHOR.          KOHLS DEPARTMENT STORES.                        00030003
       INSTALLATION.    KOHLS DEPARTMENT STORES.                        00040003
       DATE-WRITTEN.     9/28/2004.                                     00050003
       DATE-COMPILED.                                                   00060003
      ******************************************************************00070003
      **XS DOMAIN TABLE LOAD - INITIAL LOAD/RECOVERY FOR TABLE          00080003
      **                       XST_STR_GP_PRCHG                         00090003
      ******************************************************************00100003
      **THIS PROGRAM USES THE NEW PERM SYSTEM EXTRACT TO LOAD THE       00110003
      **XS DOMAIN TABLE.                                                00120003
      ******************************************************************00130003
      *DATE: 9/28/2004   MADE BY:NANCY MARTIN  INITIAL PROGRAM WRITE    00140003
      ******************************************************************00150003
       ENVIRONMENT DIVISION.                                            00160003
       CONFIGURATION SECTION.                                           00170003
       SOURCE-COMPUTER.        IBM-3090.                                00180003
       OBJECT-COMPUTER.        IBM-3090.                                00190003
       INPUT-OUTPUT SECTION.                                            00200003
       FILE-CONTROL.                                                    00210003
                                                                        00220003
           SELECT CONTROL-CARD                                          00230003
                  ASSIGN TO INP00.                                      00240003
                                                                        00250003
           SELECT INPUT-FILE                                            00251003
                  ASSIGN TO INP01.                                      00252003
                                                                        00253003
           SELECT OUTPUT-FILE                                           00254003
                  ASSIGN TO OUT01.                                      00255003
                                                                        00256003
       DATA DIVISION.                                                   00260003
       FILE SECTION.                                                    00270003
                                                                        00280003
       FD  CONTROL-CARD                                                 00281003
           RECORDING MODE F                                             00282003
           BLOCK CONTAINS 0 RECORDS                                     00283003
           LABEL RECORDS ARE OMITTED                                    00284003
           DATA RECORD IS CONTROL-RECORD.                               00285003
       01  CONTROL-RECORD                  PIC X(080).                  00286003
                                                                        00287003
       FD  INPUT-FILE                                                   00290003
           RECORDING MODE F                                             00300003
           BLOCK CONTAINS 0 RECORDS                                     00310003
           LABEL RECORDS ARE OMITTED                                    00320003
           DATA RECORD IS INPUT-RECORD.                                 00330003
       01  INPUT-RECORD                    PIC X(200).                  00340003
                                                                        00350003
       FD  OUTPUT-FILE                                                  00351003
           RECORDING MODE F                                             00352003
           BLOCK CONTAINS 0 RECORDS                                     00353003
           LABEL RECORDS ARE OMITTED                                    00354003
           DATA RECORD IS OUTPUT-RECORD.                                00355003
       01  OUTPUT-RECORD                   PIC X(200).                  00356003
                                                                        00357003
       WORKING-STORAGE SECTION.                                         00360003
      ******************************************************************00370003
      **SWITCHES                                                        00380003
      ******************************************************************00381003
       01  PS-PROGRAM-SWITCHES.                                         00382003
           05  PS-END-OF-INPUT-FILE-SW         PIC X(01)   VALUE 'N'.   00383003
               88  PS-END-OF-INPUT-FILE                    VALUE 'Y'.   00384003
               88  PS-MORE-INPUT-FILE                      VALUE 'N'.   00385005
           05  PS-END-OF-CNTL-CRD-SW           PIC X(01)   VALUE 'N'.   00385103
               88  PS-END-OF-CNTL-CRD-FILE                 VALUE 'Y'.   00385203
               88  PS-NOT-END-OF-CNTL-CRD-FILE             VALUE 'N'.   00385305
      ******************************************************************00386003
      **TIMESTAMP AND DATE VARIABLES                                    00387003
      ******************************************************************00388003
       01  SD-TIMESTAMP                        PIC  X(26)  VALUE SPACES.00389003
       01  FILLER REDEFINES SD-TIMESTAMP.                               00390003
           05  SD-CURR-DTE                     PIC  X(10).              00400003
           05  FILLER                          PIC  X(01).              00410003
           05  SD-HOUR                         PIC  X(02).              00420003
           05  FILLER                          PIC  X(01).              00430003
           05  SD-MINUTE                       PIC  X(02).              00440003
           05  FILLER                          PIC  X(01).              00450003
           05  SD-SECOND                       PIC  X(02).              00460003
           05  FILLER                          PIC  X(01).              00470003
           05  SD-MICROSEC                     PIC  X(06).              00480003
       01  PV-DATE.                                                     00481003
           05  PV-DT-CC                        PIC  XX.                 00483003
           05  PV-DT-YY                        PIC  XX.                 00483103
           05  FILLER                          PIC  X(01) VALUE '-'.    00484003
           05  PV-DT-MM                        PIC  X(02).              00485003
           05  FILLER                          PIC  X(01) VALUE '-'.    00485103
           05  PV-DT-DD                        PIC  X(02).              00487003
      ******************************************************************00490003
      **PROGRAM CONSTANTS                                               00500003
      ******************************************************************00510003
       01  PC-PROGRAM-CONSTANTS.                                        00520003
           05  PC-PROGRAM-NAME     PIC X(08)   VALUE 'XSKUP088'.        00530004
      ******************************************************************00540003
      **COPYBOOKS                                                       00550003
      ******************************************************************00560003
      *** CONTROL CARD LAYOUT - ERROR LIMIT                             00570003
           COPY XSWS107.                                                00580003
                                                                        00590003
      ***INPUT FILE LAYOUT - NEW PERM EXTRACT                           00591003
           COPY PERD104.                                                00592003
                                                                        00593003
      ***VARIABLES REQUIRED FOR THE FORMAT SQLCA ROUTINE DPPD004        00600003
           COPY DPWS004.                                                00610003
      ***DB2 ABEND COPYBOOK                                             00620003
           COPY DPWS900.                                                00630003
      ***DB2 MESSAGE AREA                                               00640003
           COPY SQLCA2.                                                 00650003
      ******************************************************************00660003
      **TABLE INCLUSIONS                                                00670003
      ******************************************************************00680003
                                                                        00690003
      ***DB2 COMMUNICATIONS AREA                                        00700003
           EXEC SQL                                                     00710003
                INCLUDE SQLCA                                           00720003
           END-EXEC.                                                    00730003
                                                                        00740003
      ***TABLE XST_STR_GP_PRCHG                                         00750003
           EXEC SQL                                                     00760003
                INCLUDE XST00064                                        00770003
           END-EXEC.                                                    00780003
                                                                        00790003
      * PC- PROGRAM CONSTANTS                                           00800003
                                                                        00810003
      *----------------------------------------------------------       00820003
      * PV- PROGRAM VARIABLES                                           00830003
      *----------------------------------------------------------       00840003
       01  PV-DB2-FIELDS.                                               00850003
           05  PV-DB2-PRCHG-ID              PIC S9(11) COMP   VALUE 0.  00860003
      ******************************************************************00930003
      **PROGRAM COUNTERS                                                00940003
      ******************************************************************00950003
       01  PV-PROGRAM-COUNTER.                                          00960003
           05  PV-INPUT-RECORDS-READ      PIC 9(09)   VALUE ZEROS.      00970003
           05  PV-PRCHG-CNT               PIC 9(09)   VALUE ZEROS.      00971003
           05  PV-REDO-CNT                PIC 9(09)   VALUE ZEROS.      00971103
           05  PV-COMMIT-COUNTER          PIC 9(09)   VALUE ZEROS.      00972003
           05  PV-ERROR-COUNTER           PIC 9(09)   VALUE ZEROS.      00972103
      ******************************************************************00973003
      **ERROR HANDLING                                                  00974003
      ******************************************************************00975003
       01  PV-MISC-ABEND-FIELDS.                                        00976003
           05  PV-PARAGRAPH-NAME            PIC X(30) VALUE SPACE.      00977003
           05  PV-OPERATION-MSG-1           PIC X(40) VALUE SPACE.      00978003
           05  PV-OPERATION-MSG-2           PIC X(40) VALUE SPACE.      00979003
           05  PV-DB2-OPERATION             PIC X(30) VALUE SPACE.      00980003
       01  ABEND-CODE                  PIC S9(4) VALUE ZEROS COMP SYNC. 00990003
           88  ABEND-4001-WRITE-ERROR            VALUE +4001.           01000003
           88  ABEND-4002-READ-ERROR             VALUE +4002.           01010003
           88  ABEND-4003-CTRL-CARD-ERROR        VALUE +4003.           01020003
           88  ABEND-4004-TABLE-ERROR            VALUE +4004.           01030003
           88  ABEND-4005-OPEN-ERROR             VALUE +4005.           01040003
           88  ABEND-4006-CLOSE-ERROR            VALUE +4006.           01050003
           88  ABEND-4007-SEQUENCE-ERROR         VALUE +4007.           01060003
           88  ABEND-4008-DATA-ERROR             VALUE +4008.           01070003
           88  ABEND-4009-KEY-DATA-ERROR         VALUE +4009.           01080003
           88  ABEND-4013-DB2-ERROR              VALUE +4013.           01090003
           88  ABEND-4019-CAL-SUB-ERROR          VALUE +4019.           01100003
           88  ABEND-4444-FORCED-ABEND           VALUE +4444.           01110003
                                                                        01120003
       PROCEDURE DIVISION.                                              01130003
      ***************************************************************** 01140003
                                                                        01150003
           PERFORM 1000-INITIALIZATION.                                 01160003
                                                                        01170003
           PERFORM 2000-PROCESS-RECORDS                                 01180003
                   UNTIL PS-END-OF-INPUT-FILE.                          01190003
                                                                        01200003
           PERFORM 9999-WRAPUP.                                         01210003
           GOBACK.                                                      01220003
                                                                        01230003
       EJECT.                                                           01240003
      ******************************************************************01250003
      **INITIALIZATION AREA                                             01260003
      ******************************************************************01270003
       1000-INITIALIZATION.                                             01280003
                                                                        01290003
           MOVE '1000-INITIALIZATION' TO PV-PARAGRAPH-NAME.             01300003
                                                                        01310003
           OPEN INPUT CONTROL-CARD                                      01320003
                      INPUT-FILE                                        01321003
           OPEN OUTPUT OUTPUT-FILE                                      01322003
                                                                        01330003
           PERFORM 1100-SELECT-DB2-TIME.                                01340003
           DISPLAY ' XSKUP088 START CURRENT TMST-', SD-TIMESTAMP.       01350003
                                                                        01360003
      *    * READ CONTROL CARD FOR ERROR THRESHOLD NUMBER               01361003
           PERFORM 1200-READ-CONTROL-CARD.                              01362003
                                                                        01363003
      *    * READ FIRST EXTRACT RECORD *                                01370003
           PERFORM 7000-READ-INPUT-FILE.                                01380003
                                                                        01390003
       EJECT.                                                           01400003
      ******************************************************************01410003
      **RETRIEVE TIME FROM DB2                                          01420003
      ******************************************************************01440003
       1100-SELECT-DB2-TIME.                                            01450003
                                                                        01460003
           MOVE '1100-SELECT-DB2-TIME' TO PV-PARAGRAPH-NAME.            01470003
                                                                        01480003
           EXEC SQL                                                     01490003
                SELECT CURRENT TIMESTAMP                                01500003
                INTO  :SD-TIMESTAMP                                     01510003
                FROM   SYSIBM.SYSDUMMY1                                 01520003
           END-EXEC.                                                    01530003
                                                                        01540003
           IF  SQLCODE NOT EQUAL ZERO                                   01550003
               PERFORM 9999-SQL-ABEND-ROUTINE                           01560003
           END-IF.                                                      01570003
                                                                        01580003
       EJECT.                                                           01590003
064800*--------------------------------------------------------------*  01591003
064900* 1200-READ-CONTROL-CARD.                                         01592003
065000*     READ CONTROL CARD XSCC107. THIS CONTROL CARD CONTAINS       01593003
065100*     THE NUMBER OF ACCEPTABLE ERRORS (PROCESSING CONTINUES).     01594003
065200*--------------------------------------------------------------*  01595003
065300 1200-READ-CONTROL-CARD.                                          01596003
065400                                                                  01597003
065500     READ CONTROL-CARD INTO CC-XSCC107-CONTROL-CARD               01598004
065600       AT END                                                     01599003
065700          SET PS-END-OF-CNTL-CRD-FILE TO TRUE.                    01599103
065800                                                                  01599203
065900     IF PS-END-OF-CNTL-CRD-FILE                                   01599303
066000       DISPLAY ' '                                                01599403
066100       DISPLAY '** ABEND     **'                                  01599503
066200       DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME              01599603
066300       DISPLAY '** PARAGRAPH **  = 1200-READ-CONTROL-CARD'        01599803
066400       DISPLAY '** MISSING ERROR LIMIT CONTROL CARD - 107'        01599903
066500       DISPLAY ' '                                                01600003
066600       MOVE +4002 TO ABEND-CODE                                   01600103
066700       CALL 'ILBOABN0' USING ABEND-CODE                           01600203
066800     ELSE                                                         01600303
066900       DISPLAY '** ERROR THRESHOLD CONTROL CARD  = '              01600403
067000                CC-XSCC107-CONTROL-CARD,  ' **'                   01600504
067100       DISPLAY '** XSCC107 CARD LABEL NAME = '                    01600604
067200                CC-XSCC107-CONTROL-NM, ' **'                      01600704
067300       DISPLAY '** XSCC107 MAX ERRORS = '                         01600804
067400                CC-XSCC107-MAX-ERRORS, ' **'                      01600903
067500       DISPLAY ' '                                                01601003
067600     END-IF.                                                      01601103
067700                                                                  01601203
067800*1200-EXIT.                                                       01601303
067900                                                                  01601403
      ******************************************************************01602003
      **PROCESSES INPUT FILE                                            01610003
      ******************************************************************01620003
       2000-PROCESS-RECORDS.                                            01630003
                                                                        01640003
           MOVE '2000-PROCESS-RECORDS' TO PV-PARAGRAPH-NAME.            01650003
                                                                        01670003
           INITIALIZE DCLXST00064                                       01680003
           MOVE PE104-STR-GP-TYP-CDE   TO XST00064-STR-GP-TYP-CDE       01690003
           MOVE PE104-STR-GP-ID        TO XST00064-STR-GP-ID            01690103
           MOVE PE104-PRCHG-ID         TO PV-DB2-PRCHG-ID               01691003
           MOVE PV-DB2-PRCHG-ID        TO XST00064-PRCHG-ID             01700003
                                                                        01780003
           MOVE PE104-OH-AUTO-CNT-IND  TO XST00064-OH-AUTO-CNT-IND      01830003
           MOVE PE104-PRCHG-EFF-CC     TO PV-DT-CC                      01840003
           MOVE PE104-PRCHG-EFF-YY     TO PV-DT-YY                      01840103
           MOVE PE104-PRCHG-EFF-MM     TO PV-DT-MM                      01840203
           MOVE PE104-PRCHG-EFF-DD     TO PV-DT-DD                      01840303
           MOVE PV-DATE                TO XST00064-PRCHG-EFF-DTE        01850004
                                                                        01910003
           MOVE PE104-SOR-LAST-UPD-TMST TO XST00064-SOR-LAST-UPD-TMST   01931003
                                                                        01940003
           PERFORM 2100-INSERT-ROW                                      01950003
                                                                        01970003
           IF  PV-ERROR-COUNTER >= CC-XSCC107-MAX-ERRORS                01971003
               DISPLAY '***** XSKUP088 LOAD OF XST_STR_GP_PRCHG '       01972003
                       ' ENCOUNTERED MORE ERRORS THAN ALLOWED - '       01972103
                        CC-XSCC107-MAX-ERRORS, '** TERMINATING **'      01972203
               PERFORM 9999-DISPLAY-STATISTICS                          01972303
               PERFORM 9999-SQL-ABEND-ROUTINE                           01972403
           END-IF.                                                      01974003
                                                                        01975003
           IF  PV-COMMIT-COUNTER >= 3000                                01980003
               PERFORM 9999-COMMIT-DATA                                 01990003
               INITIALIZE PV-COMMIT-COUNTER                             02000003
           END-IF.                                                      02010003
                                                                        02020003
           PERFORM 7000-READ-INPUT-FILE.                                02030003
                                                                        02040003
       EJECT.                                                           02050003
      ***************************************************************** 02060003
      **INSERT ROW INTO TABLE XST_STR_GP_PRCHG                          02070003
      ***************************************************************** 02080003
       2100-INSERT-ROW.                                                 02090003
                                                                        02100003
           MOVE '2100-INSERT-ROW' TO PV-PARAGRAPH-NAME.                 02110003
                                                                        02120003
           EXEC SQL                                                     02130003
           INSERT INTO XST_STR_GP_PRCHG                                 02140003
                        (  STR_GP_TYP_CDE                               02141003
                         , STR_GP_ID                                    02141103
                         , PRCHG_ID                                     02142003
                         , PRCHG_EFF_DTE                                02180003
                         , OH_AUTO_CNT_IND                              02200003
                         , SOR_LAST_UPD_TMST                            02220003
                         , LAST_UPD_TMST                                02230003
                         , LAST_ACTN_CDE)                               02240003
           VALUES        ( :XST00064-STR-GP-TYP-CDE                     02250003
                         , :XST00064-STR-GP-ID                          02250103
                         , :XST00064-PRCHG-ID                           02251003
                         , :XST00064-PRCHG-EFF-DTE                      02290003
                         , :XST00064-OH-AUTO-CNT-IND                    02310003
                         , :XST00064-SOR-LAST-UPD-TMST                  02330003
                         , CURRENT TIMESTAMP                            02340003
                         , 'A')                                         02350003
           END-EXEC.                                                    02360003
                                                                        02370003
           EVALUATE TRUE                                                02380003
              WHEN SQLCODE = ZERO                                       02390003
                   ADD +1                       TO PV-PRCHG-CNT         02400003
                   ADD +1                       TO PV-COMMIT-COUNTER    02410003
              WHEN SQLCODE = -530                                       02411003
                   ADD +1                       TO PV-ERROR-COUNTER     02413003
                   PERFORM 8000-WRITE-REDO-RECORD                       02414004
              WHEN OTHER                                                02420003
                 DISPLAY '** NON ZERO SQL CODE ON INSERT FOR ---'       02430003
                 DISPLAY 'PRICE STR GP TYP: '                           02431003
                                 XST00064-STR-GP-TYP-CDE                02432003
                 DISPLAY 'PRICE STR GP ID:  '                           02433003
                                 XST00064-STR-GP-ID                     02434004
                 DISPLAY 'PRICE CHANGE ID:  '                           02440003
                                 XST00064-PRCHG-ID                      02450003
                 DISPLAY 'OH AUTO CNT IND: '                            02570003
                                 XST00064-OH-AUTO-CNT-IND               02580003
                 DISPLAY 'EFFECTIVE DATE:   '                           02590003
                                 XST00064-PRCHG-EFF-DTE                 02600004
                 DISPLAY 'SOR LAST MSG TMST:'                           02620003
                                 XST00064-SOR-LAST-UPD-TMST             02630003
                 DISPLAY 'LAST UPD TMST:    '                           02640003
                                 XST00064-LAST-UPD-TMST                 02650003
                                 '--- DB2 TMST VALUE'                   02660003
                 DISPLAY 'LAST ACTION CODE: ', 'A',                     02670003
                                 '--- HARD CODED VALUE'                 02680003
                 PERFORM 9999-DISPLAY-STATISTICS                        02690003
                 PERFORM 9999-SQL-ABEND-ROUTINE                         02700003
           END-EVALUATE.                                                02710003
                                                                        02720003
       EJECT.                                                           02730003
      ***************************************************************** 02740003
      **READ INPUT FILE                                                 02750003
      ***************************************************************** 02760003
       7000-READ-INPUT-FILE.                                            02770003
                                                                        02780003
           READ INPUT-FILE INTO PE104-RECORD                            02790003
                AT END                                                  02800003
                   SET PS-END-OF-INPUT-FILE TO TRUE                     02810003
           END-READ.                                                    02820003
                                                                        02830003
           IF PS-MORE-INPUT-FILE                                        02840003
              ADD +1 TO PV-INPUT-RECORDS-READ                           02850003
           END-IF.                                                      02860003
                                                                        02870003
       EJECT.                                                           02880003
      *--------------------------------------------------------------*  02881003
      * 8000-WRITE-REDO-RECORD.                                         02882003
      *--------------------------------------------------------------*  02883003
       8000-WRITE-REDO-RECORD.                                          02884003
                                                                        02885003
           MOVE '8500-WRITE-REDO-RECORD' TO PV-PARAGRAPH-NAME.          02886003
                                                                        02887003
           WRITE OUTPUT-RECORD FROM PE104-RECORD.                       02888003
NEMTST**** DISPLAY '*** WRITING REDO-', PE104-FPLU-RECORD.              02889006
                                                                        02889103
           ADD 1           TO PV-REDO-CNT.                              02889304
                                                                        02889403
      *8000-EXIT.                                                       02889503
                                                                        02889603
      ****************************************************************  02890003
      *END OF PROGRAM ROUTINE                                           02900003
      ****************************************************************  02910003
       9999-WRAPUP.                                                     02920003
                                                                        02930003
           PERFORM 9999-COMMIT-DATA.                                    02940003
                                                                        02950003
           CLOSE INPUT-FILE.                                            02960003
                                                                        02970003
           PERFORM 9999-DISPLAY-STATISTICS.                             02980003
                                                                        02990003
       EJECT.                                                           03000003
      ****************************************************************  03010003
      *COMMIT DATA TO DB                                                03020003
      ****************************************************************  03030003
       9999-COMMIT-DATA.                                                03040003
                                                                        03050003
           EXEC SQL                                                     03060003
                COMMIT                                                  03070003
           END-EXEC.                                                    03080003
                                                                        03090003
103002     EVALUATE TRUE                                                03100003
103002        WHEN SQLCODE = ZERO                                       03110003
103002             CONTINUE                                             03120003
103002        WHEN OTHER                                                03130003
103002             PERFORM 9999-DISPLAY-STATISTICS                      03140003
103002             PERFORM 9999-SQL-ABEND-ROUTINE                       03150003
103002     END-EVALUATE.                                                03160003
                                                                        03170003
       EJECT.                                                           03180003
      ****************************************************************  03190003
      *DISPLAY PROGRAM STATISTICS                                       03200003
      ****************************************************************  03210003
       9999-DISPLAY-STATISTICS.                                         03220003
                                                                        03230003
           DISPLAY '*************************************************'. 03240003
           DISPLAY '* PROGRAM...............: ' PC-PROGRAM-NAME.        03250004
           DISPLAY '* DATE/TIMESTAMP........: ' SD-TIMESTAMP.           03260003
           DISPLAY '* TOTAL RECORDS READ....: ' PV-INPUT-RECORDS-READ.  03270003
           DISPLAY '* STR GP PRCHG INSERTS .: ' PV-PRCHG-CNT.           03280004
           DISPLAY '* RECORDS TO REDO.......: ' PV-REDO-CNT.            03281004
           DISPLAY '* ERROR COUNTER ........: ' PV-ERROR-COUNTER.       03282004
           DISPLAY '*************************************************'. 03290003
                                                                        03300003
       EJECT.                                                           03310003
                                                                        03320003
      *----------------------------------------------------------       03330003
      * 9999-ABEND-ROUTINE.                                             03340003
      *     ABEND PROGRAM WHEN A NON-DB2 ERROR OCCURS.                  03350003
      *----------------------------------------------------------       03360003
       9999-ABEND-ROUTINE.                                              03370003
                                                                        03380003
           DISPLAY '** ABEND           **'.                             03390003
           DISPLAY '** PROGRAM         ** = ' PC-PROGRAM-NAME.          03400004
           DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        03410003
           DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG-1.       03420003
           DISPLAY '**                 ** = ' PV-OPERATION-MSG-2.       03430003
           CALL 'ILBOABN0' USING ABEND-CODE.                            03440003
                                                                        03450003
      *9999-EXIT.                                                       03460003
       EJECT.                                                           03470003
                                                                        03480003
      ******************************************************************03490003
      **SQL ABEND ROUTINE                                               03500003
      ******************************************************************03510003
       9999-SQL-ABEND-ROUTINE.                                          03520003
                                                                        03530003
           DISPLAY '** ABEND     **'.                                   03540003
           DISPLAY '** PROGRAM   ** = ' PC-PROGRAM-NAME.                03550004
           DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.              03560003
           DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION.               03570003
      ******************************************************************03580003
      * COPY BOOK CONTAINING PROCEDURE DIVISION STATEMENTS REQUIRED     03590003
      * TO UTILIZE SQLCA MESSAGE DISPLAY MODULE 'DSNTIAR' FOLLOWS.      03600003
      ******************************************************************03610003
           COPY DPPD004.                                                03620003
           SET ABEND-4013-DB2-ERROR TO TRUE.                            03630003
           CALL 'ILBOABN0' USING ABEND-CODE.                            03640003
                                                                        03650003
       EJECT.                                                           03660003
