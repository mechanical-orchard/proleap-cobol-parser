       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.    INKRP210.                                                 
       AUTHOR.        RYAN STAUFFACHER.                                         
       INSTALLATION.  KOHLS DEPARTMENT STORES.                                  
       DATE-WRITTEN.  09-04-08.                                                 
       DATE-COMPILED.                                                           
      ******************************************************************        
      *                                                                         
      * INKRP210 -                                                              
      *                                                                         
      * THIS PROGRAM WILL READ A DATA INTEGRITY REPORT FILE AND CREATE          
      * A DATA INTEGRITY REPORT.                                                
      ******************************************************************        
W34517* CHANGE:    CHG ID:  W34517    S. JACKSON   04/10/2009                   
W34517**   MODIFIED PROCESS TO NOT PROCESS THE ML DATE CARD (INP02)             
W34517**   FEEDING PROGRAM PASSES IN RECS IN DISCREPANCY WITH FISCAL            
W34517**   MONTH END DATE INFORMATION FROM TABLE ATTACHED                       
W33304******************************************************************        
W33304* CHANGE:    CHG ID:  W33304    K. PETERSON  05/31/2009                   
W33304**   CHANGES FOR HILO PROJECT - HOLDING INVENTORY LEDGER OPEN.            
W33304**   CHANGES REQUIRED DUE TO REMOVAL OF COLUMNS KNW_THFT_RTL_AMT          
W33304**   AND CTOFF_KNW_THFT_AMT FROM TABLE TINSCLS.                           
      ******************************************************************        
       ENVIRONMENT DIVISION.                                                    
      *                                                                         
       CONFIGURATION SECTION.                                                   
      *                                                                         
       SOURCE-COMPUTER.        IBM-3090.                                        
       OBJECT-COMPUTER.        IBM-3090.                                        
      *                                                                         
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT COMPARE-TABLES-CTL-FILE                                       
               ASSIGN TO INP01.                                                 
                                                                                
W34517*    SELECT DATA-INTEGRITY-CTL-FILE                                       
W34517*        ASSIGN TO INP02.                                                 
                                                                                
           SELECT DATA-INTEGRITY-DIFF-FILE                                      
               ASSIGN TO INP03.                                                 
                                                                                
           SELECT DATA-INTEGRITY-REPORT                                         
               ASSIGN TO RPT01.                                                 
                                                                                
      ******************************************************************        
       DATA DIVISION.                                                           
      ******************************************************************        
                                                                                
       FILE SECTION.                                                            
                                                                                
       FD  COMPARE-TABLES-CTL-FILE                                              
           LABEL RECORDS ARE STANDARD                                           
           RECORDING MODE IS F                                                  
           BLOCK CONTAINS 0 RECORDS.                                            
       01  COMPARE-TABLES-CTL-REC      PIC X(80).                               
                                                                                
W34517*FD  DATA-INTEGRITY-CTL-FILE                                              
W34517*    LABEL RECORDS ARE STANDARD                                           
W34517*    RECORDING MODE IS F                                                  
W34517*    BLOCK CONTAINS 0 RECORDS.                                            
W34517*01  DATA-INTEGRITY-CTL-REC      PIC X(80).                               
                                                                                
       FD  DATA-INTEGRITY-DIFF-FILE                                             
           RECORDING MODE IS F                                                  
           LABEL RECORDS ARE STANDARD                                           
           BLOCK CONTAINS 0 RECORDS.                                            
                                                                                
       01  DATA-INTEGRITY-DIFF-REC     PIC X(80).                               
                                                                                
       FD  DATA-INTEGRITY-REPORT                                                
           LABEL RECORDS ARE OMITTED                                            
           RECORDING MODE IS F                                                  
           BLOCK CONTAINS 0 RECORDS.                                            
       01  DATA-INTEGRITY-REC          PIC X(150).                              
                                                                                
      *                                                                         
      ******************************************************************        
       WORKING-STORAGE SECTION.                                                 
      ******************************************************************        
                                                                                
       01  PS-PROGRAM-SWITCHES.                                                 
           05  PS-MORE-DIFF-RECS-SW                                             
                                       PIC X       VALUE 'Y'.                   
               88  PS-MORE-DIFF-RECS               VALUE 'Y'.                   
               88  PS-NO-MORE-DIFF-RECS            VALUE 'N'.                   
                                                                                
       01  PA-PROGRAM-ACCUMULATORS                 COMP-3.                      
           05  PA-DIFF-RECORDS-READ    PIC S9(13)  VALUE ZERO.                  
           05  PA-REPORT-LINES-WRITTEN PIC S9(13)  VALUE ZERO.                  
                                                                                
       01  CD-COUNTER-DISPLAY.                                                  
           05  CD-COUNT-HOLD1          PIC Z,ZZZ,ZZZ,ZZZ,ZZ9.                   
                                                                                
       01  PC-PROGRAM-CONSTANTS.                                                
           05  PC-MAX-LINE-COUNT       PIC S9(3) COMP-3 VALUE +55.              
W33304     05  PC-ERR-IDX-MAX          PIC S9(3) COMP-3 VALUE +19.              
           05  PC-BOOKING-AMT          PIC X(23) VALUE                          
                                              'BOOKING AMT            '.        
           05  PC-SHORTAGE-AMT         PIC X(23) VALUE                          
                                              'SHORTAGE AMT           '.        
           05  PC-IN-SUB-CLS           PIC X(23) VALUE                          
                                              'TINSCLS SUB_CL_INV_LDGR'.        
       01  PV-PROGRAM-VARIABLES.                                                
           05  PV-LINE-COUNT           PIC S9(3) COMP-3.                        
           05  PV-PAGE-COUNT           PIC S9(7) COMP-3.                        
                                                                                
           05  PV-DATE-YYMMDD.                                                  
               10  PV-DATE-YYMMDD-YY   PIC XX.                                  
               10  PV-DATE-YYMMDD-MM   PIC XX.                                  
               10  PV-DATE-YYMMDD-DD   PIC XX.                                  
           05  PV-TIME-HHMMSS.                                                  
               10  PV-TIME-HHMMSS-HH   PIC XX.                                  
               10  PV-TIME-HHMMSS-MM   PIC XX.                                  
               10  PV-TIME-HHMMSS-SS   PIC XX.                                  
                                                                                
           05  PV-SPLIT-DATE.                                                   
               10  PV-SPLIT-DATE-CCYY  PIC X(4).                                
               10  PV-HYPHEN-1         PIC X.                                   
               10  PV-SPLIT-DATE-MM    PIC X(2).                                
               10  PV-HYPHEN-2         PIC X.                                   
               10  PV-SPLIT-DATE-DD    PIC X(2).                                
           05  PV-FRMT-DATE.                                                    
               10  PV-FRMT-DATE-MM     PIC X(2).                                
               10  PV-HYPHEN-1ST       PIC X.                                   
               10  PV-FRMT-DATE-DD     PIC X(2).                                
               10  PV-HYPHEN-2ND       PIC X.                                   
               10  PV-FRMT-DATE-CCYY   PIC X(4).                                
                                                                                
           05  PV-DIFFERENCE           PIC S9(9)V99 COMP-3.                     
                                                                                
       01  TABLE-ERROR-DESC.                                                    
           05  FILLER                  PIC 9(02)   VALUE 1.                     
           05  FILLER                  PIC X(39)   VALUE                        
           'CORRESPONDING DATA NOT FOUND ON IN.    '.                           
           05  FILLER                  PIC S9(13)  COMP-3  VALUE 0.             
           05  FILLER                  PIC 9(02)   VALUE 2.                     
           05  FILLER                  PIC X(39)   VALUE                        
           'CORRESPONDING DATA NOT FOUND ON VA.    '.                           
           05  FILLER                  PIC S9(13)  COMP-3  VALUE 0.             
           05  FILLER                  PIC 9(02)   VALUE 3.                     
           05  FILLER                  PIC X(39)   VALUE                        
           'ADJ-AT-RTL-AMT DOES NOT MATCH.         '.                           
           05  FILLER                  PIC S9(13)  COMP-3  VALUE 0.             
           05  FILLER                  PIC 9(02)   VALUE 4.                     
           05  FILLER                  PIC X(39)   VALUE                        
           'ADJ-AT-COST-AMT DOES NOT MATCH.        '.                           
           05  FILLER                  PIC S9(13)  COMP-3  VALUE 0.             
           05  FILLER                  PIC 9(02)   VALUE 5.                     
           05  FILLER                  PIC X(39)   VALUE                        
           'SHORTAGE-RTL-AMT DOES NOT MATCH.       '.                           
           05  FILLER                  PIC S9(13)  COMP-3  VALUE 0.             
           05  FILLER                  PIC 9(02)   VALUE 6.                     
           05  FILLER                  PIC X(39)   VALUE                        
           'SLS-RTL-AMT DOES NOT MATCH.            '.                           
           05  FILLER                  PIC S9(13)  COMP-3  VALUE 0.             
           05  FILLER                  PIC 9(02)   VALUE 7.                     
           05  FILLER                  PIC X(39)   VALUE                        
           'MKDN-RTL-AMT DOES NOT MATCH.           '.                           
           05  FILLER                  PIC S9(13)  COMP-3  VALUE 0.             
           05  FILLER                  PIC 9(02)   VALUE 8.                     
           05  FILLER                  PIC X(39)   VALUE                        
           'MKUP-RTL-AMT DOES NOT MATCH.           '.                           
           05  FILLER                  PIC S9(13)  COMP-3  VALUE 0.             
           05  FILLER                  PIC 9(02)   VALUE 9.                     
           05  FILLER                  PIC X(39)   VALUE                        
           'XFER-IN-RTL-AMT DOES NOT MATCH.        '.                           
           05  FILLER                  PIC S9(13)  COMP-3  VALUE 0.             
           05  FILLER                  PIC 9(02)   VALUE 10.                    
           05  FILLER                  PIC X(39)   VALUE                        
           'XFER-OUT-RTL-AMT DOES NOT MATCH.       '.                           
           05  FILLER                  PIC S9(13)  COMP-3  VALUE 0.             
           05  FILLER                  PIC 9(02)   VALUE 11.                    
           05  FILLER                  PIC X(39)   VALUE                        
           'RCPT-RTL-AMT DOES NOT MATCH.           '.                           
           05  FILLER                  PIC S9(13)  COMP-3  VALUE 0.             
           05  FILLER                  PIC 9(02)   VALUE 12.                    
           05  FILLER                  PIC X(39)   VALUE                        
           'PADJ-RTL-AMT DOES NOT MATCH.           '.                           
           05  FILLER                  PIC S9(13)  COMP-3  VALUE 0.             
           05  FILLER                  PIC 9(02)   VALUE 13.                    
           05  FILLER                  PIC X(39)   VALUE                        
           'SHNK-RTL-AMT DOES NOT MATCH.           '.                           
           05  FILLER                  PIC S9(13)  COMP-3  VALUE 0.             
           05  FILLER                  PIC 9(02)   VALUE 14.                    
           05  FILLER                  PIC X(39)   VALUE                        
           'END-INV-RTL-AMT DOES NOT MATCH..       '.                           
           05  FILLER                  PIC S9(13)  COMP-3  VALUE 0.             
           05  FILLER                  PIC 9(02)   VALUE 15.                    
           05  FILLER                  PIC X(39)   VALUE                        
           'CTOFF-SLS-AMT DOES NOT MATCH.          '.                           
           05  FILLER                  PIC S9(13)  COMP-3  VALUE 0.             
           05  FILLER                  PIC 9(02)   VALUE 16.                    
           05  FILLER                  PIC X(39)   VALUE                        
           'CTOFF-SHNK-AMT DOES NOT MATCH.         '.                           
           05  FILLER                  PIC S9(13)  COMP-3  VALUE 0.             
           05  FILLER                  PIC 9(02)   VALUE 17.                    
           05  FILLER                  PIC X(39)   VALUE                        
           'CTOFF-END-INV-AMT DOES NOT MATCH.      '.                           
           05  FILLER                  PIC S9(13)  COMP-3  VALUE 0.             
           05  FILLER                  PIC 9(02)   VALUE 18.                    
           05  FILLER                  PIC X(39)   VALUE                        
OCFSFS     'STR-PARL-SHIP-RTL-AMT DOES NOT MATCH.  '.                           
           05  FILLER                  PIC S9(13)  COMP-3  VALUE 0.             
           05  FILLER                  PIC 9(02)   VALUE 19.                    
           05  FILLER                  PIC X(39)   VALUE                        
           'STR-EXPTED-RTL-AMT DOES NOT MATCH.     '.                           
           05  FILLER                  PIC S9(13)  COMP-3  VALUE 0.             
       01  TABLE-FOR-ERROR-TEXT.                                                
W33304     05  TABLE-ERROR-ENTRIES     OCCURS 19 TIMES                          
                                       INDEXED BY ERR-IDX.                      
               10  TBL-ERR-NBR         PIC 9(02).                               
               10  TBL-ERR-MSG         PIC X(39).                               
               10  TBL-ERR-TOTAL       PIC S9(13)  COMP-3.                      
                                                                                
       EJECT                                                                    
                                                                                
       01 ABEND-AREAS.                                                          
           05 ABEND-CODE               PIC S9(04)  VALUE ZERO                   
                                                   COMP SYNC.                   
               88  AC-BAD-DATA                     VALUE +4003.                 
               88  AC-DB2-ERROR                    VALUE +4013.                 
           05  AA-ABEND-LIT            PIC X(40)   VALUE                        
                 '*****       ABEND'.                                           
           05  AA-PROGRAM-LIT          PIC X(40)   VALUE                        
                   '*****   PROGRAM: INKRP210'.                                 
           05  AA-PARAGRAPH-LIT.                                                
               10  FILLER              PIC X(17)   VALUE                        
                   '***** PARAGRAPH: '.                                         
               10  AA-PARAGRAPH-NAME   PIC X(35)   VALUE SPACES.                
           05  AA-MESSAGE-LINE.                                                 
               10  FILLER              PIC X(06)   VALUE '*****'.               
               10  AA-MESSAGE          PIC X(127)  VALUE SPACES.                
           05  AA-DB2-ERROR-LIT        PIC X(40)   VALUE                        
                   '*****    DB2 ERROR'.                                        
           05  AA-DB2-OPERATION-LIT.                                            
               10  FILLER              PIC X(17)   VALUE                        
                   '***** OPERATION: '.                                         
               10  AA-DB2-OPERATION.                                            
                   15  AA-DB2-OP-1     PIC X(25)   VALUE SPACES.                
                   15  AA-DB2-OP-2     PIC X(25)   VALUE SPACES.                
           05  AA-DB2-TABLE-1          PIC X(08)   VALUE SPACES.                
           05  AA-DB2-TABLE-2          PIC X(08)   VALUE SPACES.                
           05  AA-DB2-TABLE-3          PIC X(08)   VALUE SPACES.                
           05  AA-DB2-TABLE-4          PIC X(08)   VALUE SPACES.                
                                                                                
       EJECT                                                                    
                                                                                
      *** DATA INTEGRITY COMPARE TABLES CONTROL CARD                            
       01  CC-CONTROL-CARD-REC.                                                 
           05  CC-DI-DESC              PIC X(23).                               
           05  FILLER                  PIC X(57).                               
                                                                                
W34517*** DATA INTEGRITY CONTROL CARD                                           
W34517*    COPY MLRD110.                                                        
                                                                                
      *** DATA INTEGRITY DIFFERENCE REPORT FILE                                 
           COPY INRD900.                                                        
                                                                                
       EJECT                                                                    
                                                                                
      ******************************************************************        
      ***  STANDARD REPORT HEADING                                              
      ******************************************************************        
                                                                                
           COPY DPWS150O.                                                       
                                                                                
      ******************************************************************        
      ***  REPORT TITLE LINES                                                   
      ******************************************************************        
       01  HD-REPORT-TITLE-2.                                                   
           05  FILLER                  PIC X       VALUE SPACE.                 
           05  FILLER                  PIC X(43)   VALUE SPACES.                
           05  FILLER                  PIC X(15)                                
                                       VALUE 'DATA INTEGRITY '.                 
           05  HD-DI-DESC              PIC X(23).                               
           05  FILLER                  PIC X(13)                                
                                       VALUE ' ERROR REPORT'.                   
           05  FILLER                  PIC X(37)   VALUE SPACES.                
                                                                                
       01  HD-REPORT-TITLE-3.                                                   
           05  FILLER                  PIC X       VALUE SPACE.                 
           05  FILLER                  PIC X(49)   VALUE SPACES.                
           05  FILLER                  PIC X(04)   VALUE 'FOR '.                
           05  HD-T3-FROM-MM-DD-CCYY   PIC X(10).                               
           05  FILLER                  PIC X(09)                                
                                       VALUE ' THROUGH '.                       
           05  HD-T3-THRU-MM-DD-CCYY   PIC X(10).                               
           05  FILLER                  PIC X(49)   VALUE SPACES.                
                                                                                
      ******************************************************************        
      ***  REPORT COLUMN HEADING LINES                                          
      ******************************************************************        
       01  HD-COLUMN-HEADING-1.                                                 
           05  FILLER                  PIC X       VALUE SPACE.                 
           05  FILLER                  PIC X(12)   VALUE 'FSCL MN     '.        
           05  FILLER                  PIC X(08)   VALUE 'FSCL MN '.            
           05  FILLER                  PIC X(06)   VALUE 'DEPT  '.              
           05  FILLER                  PIC X(05)   VALUE 'MCL  '.               
           05  FILLER                  PIC X(04)   VALUE 'SCL '.                
           05  FILLER                  PIC X(06)   VALUE 'STORE '.              
           05  FILLER                  PIC X(03)   VALUE SPACES.                
           05  HD-C1-IN                PIC X(07).                               
           05  FILLER                  PIC X(06)   VALUE ' AMT  '.              
           05  FILLER                  PIC X(06)   VALUE SPACES.                
           05  HD-C1-VA                PIC X(07).                               
           05  FILLER                  PIC X(07)   VALUE ' AMT   '.             
           05  FILLER                  PIC X(05)   VALUE SPACES.                
           05  FILLER                  PIC X(15)                                
                                       VALUE '   DIFFERENCE  '.                 
           05  FILLER                  PIC X(05)   VALUE SPACES.                
           05  FILLER                  PIC X(38)                                
                                       VALUE '      ERROR MESSAGE'.             
           05  FILLER                  PIC X(09)   VALUE SPACES.                
                                                                                
       01  HD-COLUMN-HEADING-2.                                                 
           05  FILLER                  PIC X       VALUE SPACE.                 
           05  FILLER                  PIC X(10)   VALUE 'END DATE  '.          
           05  FILLER                  PIC X(04)   VALUE SPACES.                
           05  FILLER                  PIC X(03)   VALUE 'NBR'.                 
           05  FILLER                  PIC X(114)  VALUE SPACES.                
           05  FILLER                  PIC X(18)   VALUE SPACES.                
                                                                                
       01  HD-COLUMN-HEADING-3.                                                 
           05  FILLER                  PIC X       VALUE SPACE.                 
           05  FILLER                  PIC X(10)   VALUE SPACES.                
           05  FILLER                  PIC X(39)   VALUE                        
                                       'ERROR DESCRIPTION'.                     
           05  FILLER                  PIC X(10)   VALUE SPACES.                
           05  FILLER                  PIC X(17)   VALUE SPACES.                
           05  FILLER                  PIC X(05)   VALUE 'COUNT'.               
           05  FILLER                  PIC X(50)   VALUE SPACES.                
           05  FILLER                  PIC X(18)   VALUE SPACES.                
                                                                                
      ******************************************************************        
      ***  REPORT DETAIL LINES                                                  
      ******************************************************************        
       01  DL-LINE-1.                                                           
           05  FILLER                  PIC X       VALUE SPACE.                 
           05  DL-FSCL-MN-END-DTE      PIC X(10).                               
           05  FILLER                  PIC X(04)   VALUE SPACE.                 
           05  DL-FSCL-MN-NBR          PIC X(02).                               
           05  FILLER                  PIC X(04)   VALUE SPACE.                 
           05  DL-DEPT                 PIC X(03).                               
           05  FILLER                  PIC X(04)   VALUE SPACE.                 
           05  DL-MCL                  PIC Z(02).                               
           05  FILLER                  PIC X(03)   VALUE SPACE.                 
           05  DL-SCL                  PIC Z(02).                               
           05  FILLER                  PIC X(02)   VALUE SPACE.                 
           05  DL-STORE                PIC Z(04).                               
           05  FILLER                  PIC X(02)   VALUE SPACE.                 
           05  DL-IN-AMT               PIC ZZ,ZZZ,ZZZ,ZZZ.99-                   
                                       BLANK WHEN ZERO.                         
           05  FILLER                  PIC X(01)   VALUE SPACE.                 
           05  DL-VA-AMT               PIC ZZ,ZZZ,ZZZ,ZZZ.99-                   
                                       BLANK WHEN ZERO.                         
           05  FILLER                  PIC X(03)   VALUE SPACE.                 
           05  DL-DIFFERENCE-AMT       PIC ZZ,ZZZ,ZZZ,ZZZ.99-                   
                                       BLANK WHEN ZERO.                         
           05  FILLER                  PIC X(02)   VALUE SPACES.                
           05  DL-ERROR-MESSAGE        PIC X(39).                               
           05  FILLER                  PIC X(08).                               
                                                                                
       01  DL-LINE-2.                                                           
           05  FILLER                  PIC X       VALUE SPACE.                 
           05  FILLER                  PIC X(10)   VALUE SPACE.                 
           05  DL-ERR-DESC             PIC X(39).                               
           05  FILLER                  PIC X(10)   VALUE SPACES.                
           05  FILLER                  PIC X(05)   VALUE SPACE.                 
           05  DL-ERR-COUNT            PIC Z,ZZZ,ZZZ,ZZZ,ZZ9.                   
           05  FILLER                  PIC X(50)   VALUE SPACE.                 
           05  FILLER                  PIC X(18).                               
                                                                                
      ******************************************************************        
      ***  REPORT END OF REPORT LINE                                            
      ******************************************************************        
       01  ER-END-OF-REPORT-LINE.                                               
           05  FILLER                  PIC X(21)   VALUE                        
                                          '*** END OF REPORT ***'.              
                                                                                
       EJECT                                                                    
                                                                                
      ******************************************************************        
       PROCEDURE DIVISION.                                                      
      ******************************************************************        
                                                                                
      ******************************************************************        
       0000-MAINLINE-MLKRP210.                                                  
      ******************************************************************        
      *                                                                         
           PERFORM 1000-INITIALIZATION.                                         
                                                                                
           PERFORM 2000-MAIN-PROCESS.                                           
                                                                                
           PERFORM 8000-EOJ.                                                    
                                                                                
           IF PA-DIFF-RECORDS-READ > ZERO                                       
              MOVE 4095 TO RETURN-CODE                                          
           ELSE                                                                 
              MOVE 0    TO RETURN-CODE                                          
           END-IF.                                                              
                                                                                
           STOP RUN.                                                            
                                                                                
       EJECT                                                                    
                                                                                
      ******************************************************************        
       1000-INITIALIZATION.                                                     
      ******************************************************************        
      *                                                                         
           OPEN INPUT  COMPARE-TABLES-CTL-FILE                                  
W34517*                DATA-INTEGRITY-CTL-FILE                                  
                       DATA-INTEGRITY-DIFF-FILE.                                
           OPEN OUTPUT DATA-INTEGRITY-REPORT.                                   
                                                                                
           PERFORM 4000-READ-COMPARE-TABLES-CTL.                                
                                                                                
           DISPLAY ' '.                                                         
           DISPLAY '*** INKRP210 COMPARISON VALUES ***'                         
           DISPLAY CC-CONTROL-CARD-REC.                                         
                                                                                
W34517*    PERFORM 4100-READ-DATA-INTEGRITY-CTL.                                
W34517*                                                                         
W34517*    DISPLAY ' '.                                                         
W34517*    DISPLAY '*** INKRP210 DATA INTEGRITY CTL VALUES ***'                 
W34517*    DISPLAY ML110-DATA-INTEGRITY-CC-REC.                                 
                                                                                
           INITIALIZE PV-PROGRAM-VARIABLES.                                     
                                                                                
           ACCEPT PV-DATE-YYMMDD FROM DATE.                                     
           MOVE PV-DATE-YYMMDD-YY      TO DP150O-RUN-YEAR.                      
           MOVE PV-DATE-YYMMDD-MM      TO DP150O-RUN-MONTH.                     
           MOVE PV-DATE-YYMMDD-DD      TO DP150O-RUN-DAY.                       
           ACCEPT PV-TIME-HHMMSS FROM TIME.                                     
           MOVE PV-TIME-HHMMSS-HH      TO DP150O-RUN-HOUR.                      
           MOVE PV-TIME-HHMMSS-MM      TO DP150O-RUN-MINUTE.                    
           MOVE 'INKRP210'             TO DP150O-PROGRAM-NAME.                  
           EVALUATE TRUE                                                        
               WHEN CC-DI-DESC = PC-BOOKING-AMT                                 
                   MOVE '0'            TO DP150O-REPORT-NUMBER-CHAR             
               WHEN CC-DI-DESC = PC-SHORTAGE-AMT                                
                   MOVE '1'            TO DP150O-REPORT-NUMBER-CHAR             
               WHEN CC-DI-DESC = PC-IN-SUB-CLS                                  
                   MOVE '2'            TO DP150O-REPORT-NUMBER-CHAR             
           END-EVALUATE.                                                        
                                                                                
           MOVE CC-DI-DESC             TO HD-DI-DESC.                           
                                                                                
W34517*    MOVE ML110-STRT-DTE         TO PV-SPLIT-DATE.                        
W34517*    MOVE PV-SPLIT-DATE-CCYY     TO PV-FRMT-DATE-CCYY.                    
W34517*    MOVE PV-SPLIT-DATE-MM       TO PV-FRMT-DATE-MM.                      
W34517*    MOVE PV-SPLIT-DATE-DD       TO PV-FRMT-DATE-DD.                      
W34517*    MOVE '-'                    TO PV-HYPHEN-1ST                         
W34517*                                   PV-HYPHEN-2ND.                        
W34517*    MOVE PV-FRMT-DATE           TO HD-T3-FROM-MM-DD-CCYY.                
W34517*    MOVE ML110-END-DTE          TO PV-SPLIT-DATE.                        
W34517*    MOVE PV-SPLIT-DATE-CCYY     TO PV-FRMT-DATE-CCYY.                    
W34517*    MOVE PV-SPLIT-DATE-MM       TO PV-FRMT-DATE-MM.                      
W34517*    MOVE PV-SPLIT-DATE-DD       TO PV-FRMT-DATE-DD.                      
W34517*    MOVE PV-FRMT-DATE           TO HD-T3-THRU-MM-DD-CCYY.                
                                                                                
      *TEMPMOVE CC-LOW-TABLE           TO HD-C1-IN.                             
      *TEMPMOVE CC-HIGH-TABLE          TO HD-C1-VA.                             
                                                                                
           PERFORM 6000-WRITE-REPORT-TITLE.                                     
                                                                                
           MOVE TABLE-ERROR-DESC       TO TABLE-FOR-ERROR-TEXT.                 
                                                                                
       EJECT                                                                    
                                                                                
      ******************************************************************        
       2000-MAIN-PROCESS.                                                       
      ******************************************************************        
      *                                                                         
           PERFORM 4200-READ-DIFF-REPORT-FILE.                                  
                                                                                
           PERFORM                                                              
             UNTIL PS-NO-MORE-DIFF-RECS                                         
               PERFORM 6100-CREATE-REPORT                                       
               PERFORM 4200-READ-DIFF-REPORT-FILE                               
           END-PERFORM.                                                         
                                                                                
       EJECT                                                                    
                                                                                
      ******************************************************************        
       4000-READ-COMPARE-TABLES-CTL.                                            
      ******************************************************************        
      *                                                                         
           READ COMPARE-TABLES-CTL-FILE                                         
             INTO CC-CONTROL-CARD-REC                                           
               AT END                                                           
                   MOVE '4000-READ-COMPARE-TABLES-CTL'                          
                                       TO AA-PARAGRAPH-NAME                     
                   MOVE 'COMPARE TABLES CONTROL CARD IS MISSING'                
                                       TO AA-MESSAGE                            
                   MOVE +4001          TO ABEND-CODE                            
                   PERFORM 9900-COMMON-ABEND-ROUTINE                            
           END-READ.                                                            
                                                                                
       EJECT                                                                    
                                                                                
W34517******************************************************************        
W34517*4100-READ-DATA-INTEGRITY-CTL.                                            
W34517******************************************************************        
W34517*                                                                         
W34517*    READ DATA-INTEGRITY-CTL-FILE                                         
W34517*      INTO ML110-DATA-INTEGRITY-CC-REC                                   
W34517*        AT END                                                           
W34517*            MOVE '4100-READ-DATA-INTEGRITY-CTL'                          
W34517*                                TO AA-PARAGRAPH-NAME                     
W34517*            MOVE 'DATA INTEGRITY CONTROL CARD IS MISSING'                
W34517*                                TO AA-MESSAGE                            
W34517*            MOVE +4002          TO ABEND-CODE                            
W34517*            PERFORM 9900-COMMON-ABEND-ROUTINE                            
W34517*    END-READ.                                                            
W34517*                                                                         
       EJECT                                                                    
                                                                                
      ******************************************************************        
       4200-READ-DIFF-REPORT-FILE.                                              
      ******************************************************************        
      *                                                                         
           READ DATA-INTEGRITY-DIFF-FILE                                        
             INTO IN900-DATA-INTEGRITY-DIFF-REC                                 
               AT END                                                           
                   SET PS-NO-MORE-DIFF-RECS                                     
                                       TO TRUE                                  
           END-READ.                                                            
                                                                                
           IF PS-MORE-DIFF-RECS                                                 
               ADD 1                   TO PA-DIFF-RECORDS-READ                  
           END-IF.                                                              
                                                                                
       EJECT                                                                    
                                                                                
      ******************************************************************        
       6000-WRITE-REPORT-TITLE.                                                 
      ******************************************************************        
      *                                                                         
           ADD 1                       TO PV-PAGE-COUNT.                        
           MOVE PV-PAGE-COUNT          TO DP150O-PAGE-NUMBER.                   
                                                                                
           WRITE DATA-INTEGRITY-REC FROM DP150O-STANDRD-HEADER-150-COLS         
               AFTER ADVANCING PAGE.                                            
                                                                                
           WRITE DATA-INTEGRITY-REC FROM HD-REPORT-TITLE-2                      
               AFTER ADVANCING 1 LINE.                                          
                                                                                
W34517*    WRITE DATA-INTEGRITY-REC FROM HD-REPORT-TITLE-3                      
W34517*        AFTER ADVANCING 1 LINE.                                          
                                                                                
           WRITE DATA-INTEGRITY-REC FROM HD-COLUMN-HEADING-1                    
               AFTER ADVANCING 2 LINES.                                         
                                                                                
           WRITE DATA-INTEGRITY-REC FROM HD-COLUMN-HEADING-2                    
               AFTER ADVANCING 1 LINE.                                          
                                                                                
           MOVE SPACES                 TO DATA-INTEGRITY-REC.                   
           WRITE DATA-INTEGRITY-REC                                             
               AFTER ADVANCING 1 LINE.                                          
                                                                                
           MOVE +7                     TO PV-LINE-COUNT.                        
                                                                                
       EJECT                                                                    
                                                                                
      ******************************************************************        
       6100-CREATE-REPORT.                                                      
      ******************************************************************        
      *                                                                         
           IF PV-LINE-COUNT > PC-MAX-LINE-COUNT                                 
               PERFORM 6000-WRITE-REPORT-TITLE.                                 
                                                                                
           MOVE IN900-FSCL-MN-END-DTE  TO DL-FSCL-MN-END-DTE.                   
           MOVE IN900-FSCL-MN-NBR      TO DL-FSCL-MN-NBR.                       
           MOVE IN900-DEPT-NBR         TO DL-DEPT.                              
           MOVE IN900-MAJ-CL-NBR       TO DL-MCL.                               
           MOVE IN900-SUB-CL-NBR       TO DL-SCL.                               
           MOVE IN900-STR-NBR          TO DL-STORE.                             
           MOVE IN900-IN-AMT           TO DL-IN-AMT.                            
           MOVE IN900-VA-AMT           TO DL-VA-AMT.                            
           COMPUTE PV-DIFFERENCE =                                              
               IN900-IN-AMT - IN900-VA-AMT.                                     
           MOVE PV-DIFFERENCE          TO DL-DIFFERENCE-AMT.                    
                                                                                
           SET ERR-IDX                 TO 1.                                    
           SEARCH TABLE-ERROR-ENTRIES                                           
               AT END                                                           
                   MOVE 'NO ERROR MESSAGE'                                      
                                       TO DL-ERROR-MESSAGE                      
               WHEN TBL-ERR-NBR (ERR-IDX) = IN900-ERR-MSG-NBR                   
                   MOVE TBL-ERR-MSG (ERR-IDX)                                   
                                       TO DL-ERROR-MESSAGE                      
                   ADD +1              TO TBL-ERR-TOTAL (ERR-IDX)               
           END-SEARCH.                                                          
                                                                                
                                                                                
           WRITE DATA-INTEGRITY-REC FROM DL-LINE-1                              
               AFTER ADVANCING 1 LINE.                                          
           ADD 1                       TO PV-LINE-COUNT.                        
           ADD 1                       TO PA-REPORT-LINES-WRITTEN.              
                                                                                
       EJECT                                                                    
                                                                                
      ******************************************************************        
       8000-EOJ.                                                                
      ******************************************************************        
      *                                                                         
           PERFORM 8100-WRITE-RPT-ERR-SUMMARY.                                  
      *                                                                         
           WRITE DATA-INTEGRITY-REC FROM ER-END-OF-REPORT-LINE                  
               AFTER ADVANCING 3 LINES.                                         
      *                                                                         
           PERFORM 8200-DISPLAY-RPT-ERR-SUMMARY.                                
                                                                                
           CLOSE COMPARE-TABLES-CTL-FILE.                                       
W34517*    CLOSE DATA-INTEGRITY-CTL-FILE.                                       
           CLOSE DATA-INTEGRITY-DIFF-FILE.                                      
           CLOSE DATA-INTEGRITY-REPORT.                                         
                                                                                
       EJECT                                                                    
                                                                                
      ******************************************************************        
       8100-WRITE-RPT-ERR-SUMMARY.                                              
      ******************************************************************        
      *                                                                         
           ADD 1                       TO PV-PAGE-COUNT.                        
           MOVE PV-PAGE-COUNT          TO DP150O-PAGE-NUMBER.                   
                                                                                
           WRITE DATA-INTEGRITY-REC FROM DP150O-STANDRD-HEADER-150-COLS         
               AFTER ADVANCING PAGE.                                            
                                                                                
           WRITE DATA-INTEGRITY-REC FROM HD-REPORT-TITLE-2                      
               AFTER ADVANCING 1 LINE.                                          
                                                                                
W34517*    WRITE DATA-INTEGRITY-REC FROM HD-REPORT-TITLE-3                      
W34517*        AFTER ADVANCING 1 LINE.                                          
                                                                                
           WRITE DATA-INTEGRITY-REC FROM HD-COLUMN-HEADING-3                    
               AFTER ADVANCING 2 LINES.                                         
                                                                                
           MOVE SPACES                 TO DATA-INTEGRITY-REC.                   
           WRITE DATA-INTEGRITY-REC                                             
               AFTER ADVANCING 1 LINE.                                          
                                                                                
           PERFORM 8110-WRITE-ERR-COUNTS                                        
               VARYING ERR-IDX FROM 1 BY 1                                      
               UNTIL ERR-IDX GREATER THAN PC-ERR-IDX-MAX.                       
                                                                                
       EJECT                                                                    
                                                                                
      ******************************************************************        
       8110-WRITE-ERR-COUNTS.                                                   
      ******************************************************************        
      *                                                                         
           MOVE TBL-ERR-MSG (ERR-IDX)  TO DL-ERR-DESC.                          
           MOVE TBL-ERR-TOTAL (ERR-IDX)                                         
                                       TO DL-ERR-COUNT.                         
                                                                                
           WRITE DATA-INTEGRITY-REC FROM DL-LINE-2                              
               AFTER ADVANCING 2 LINE.                                          
                                                                                
       EJECT                                                                    
                                                                                
      ******************************************************************        
       8200-DISPLAY-RPT-ERR-SUMMARY.                                            
      ******************************************************************        
      *                                                                         
           DISPLAY ' '.                                                         
           DISPLAY '  PROGRAM INKRP210 PROCESSING SUMMARY'.                     
           DISPLAY '  -----------------------------------'.                     
           DISPLAY ' '.                                                         
      *                                                                         
           MOVE PA-DIFF-RECORDS-READ TO CD-COUNT-HOLD1.                         
           DISPLAY 'DIFFERENCE RECORDS READ = ' CD-COUNT-HOLD1.                 
      *                                                                         
           MOVE PA-REPORT-LINES-WRITTEN TO CD-COUNT-HOLD1.                      
           DISPLAY 'REPORT RECORDS WRITTEN =  ' CD-COUNT-HOLD1.                 
      *                                                                         
           DISPLAY ' '.                                                         
                                                                                
       EJECT                                                                    
                                                                                
      ******************************************************************        
       9900-COMMON-ABEND-ROUTINE.                                               
      ******************************************************************        
      *                                                                         
           DISPLAY AA-ABEND-LIT.                                                
           DISPLAY AA-PROGRAM-LIT.                                              
           DISPLAY AA-PARAGRAPH-LIT.                                            
           DISPLAY AA-MESSAGE-LINE.                                             
           DISPLAY ABEND-CODE.                                                  
                                                                                
           CALL 'ILBOABN0' USING ABEND-CODE.                                    
