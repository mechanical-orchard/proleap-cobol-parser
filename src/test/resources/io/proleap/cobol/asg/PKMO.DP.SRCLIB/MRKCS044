000100*-----------------------*                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*-----------------------*                                         00030000
000400 PROGRAM-ID.    MRKCS044.                                         00040000
000500 AUTHOR.        KOHLS DEPARTMENT STORES.                          00050000
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060000
000700 DATE-WRITTEN.  11-15-93.                                         00070000
000800 DATE-COMPILED.                                                   00080000
000900*----------------------------------------------------------------*00090000
001000*    Y044 - MDSE REPL ITEM/PTAG CRIT SPEC                        *00100001
001100*                                                                *00110000
001200*    THIS PROGRAM IS THE CRITERIA SPECIFICATION SCREEN           *00120001
001300*    FOR THE ITEM/PTAG INQUIRY SCREENS.                          *00130001
001700*----------------------------------------------------------------*00170000
001710******************************************************************00171005
001711* NOTE * THERE IS NO DB2 IN THIS PROGRAM, WATCH COMPILE SCREEN !!*00171106
001712******************************************************************00171206
001720* 08/08/01 - THERESE RAMSEYER - COMPUWARE   WR #21601            *00172005
001730*    - UPDATED PROGRAM FOR CHANGEOVER TO NI-SKU.                 *00173005
001740*    - INCREASED LENGTH OF DEPT, CLASS, AND SKU. ADDED SUBCLASS. *00174005
001770*    - ELIMINATED WORKING STORAGE VARIABLES AND PARAGRAPHS FROM  *00177005
001780*      THE TEMPLATE THAT WERE NEVER REFERENCED.                  *00178005
001790*    - ELIMINATED SOME DOCUMENTATION THAT REFERRED TO THE        *00179005
001791*      SYSTEM MESSAGE SCREEN TEMPLATE, NOT THE CURRENT PROGRAM.  *00179105
001791*                                                                *00179213
001720* 04/29/02 - L. FRIESS      PITS #464976                         *00179313
001720*            CORRECTED LOGIC THAT MOVES ENTERED DEPT (LENGTH 3)  *00179413
001720*            TO COMMAREA (LENGTH 4), SO IT WILL BE RIGHT         *00179513
001720*            JUSTIFIED.  CHANGED DEPT LOGIC IN PARA. 4400 ALSO.  *00179614
001792******************************************************************00179713
CICS  * CHANGED 10/28/2022    BY JIM HUNTER      WR: CHG0277420         00179815
CICS  * ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL        00179915
CICS  * DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.       00180015
CICS  ******************************************************************00190015
002000                                                                  00200000
002100 ENVIRONMENT DIVISION.                                            00210000
002400                                                                  00240000
002500 DATA DIVISION.                                                   00250000
002700                                                                  00270000
002800 WORKING-STORAGE SECTION.                                         00280000
002900                                                                  00290000
003000 01  PV-PROGRAM-VARIABLES.                                        00300000
003300     05  PV-USER-ID1                    PIC X(8)     VALUE SPACE. 00330000
003400     05  PV-CICS-RESPONSE               PIC S9(08)   VALUE +0     00340000
003500                                                     COMP SYNC.   00350000
004300     05  PV-TYPE                        PIC  X(03).               00430000
004400     05  PV-PROCESS-DATE.                                         00440000
004500         10  PV-PROCESS-DATE-CENT       PIC  X(02).               00450000
004600         10  PV-PROCESS-DATE-YY         PIC  X(02).               00460000
004700         10  FILLER                     PIC  X(01) VALUE '-'.     00470000
004800         10  PV-PROCESS-DATE-MM         PIC  X(02).               00480000
004900         10  FILLER                     PIC  X(01) VALUE '-'.     00490000
005000         10  PV-PROCESS-DATE-DD         PIC  X(02).               00500000
005100     05  PV-PROCESS-DATE-R REDEFINES PV-PROCESS-DATE              00510000
005200                                        PIC  X(10).               00520000
006200     05  PV-DB2-DATE                    PIC X(10).                00620000
006300     05  PV-STORE-NMBR                  PIC X(03).                00630000
006400     05  FILLER REDEFINES PV-STORE-NMBR.                          00640000
006500         10  PV-STORE-NMBR-N            PIC 9(03).                00650000
006700     05  PV-CURRENT-DATE                PIC  X(10).               00670000
006800     05  FILLER REDEFINES PV-CURRENT-DATE.                        00680000
006900         10  PV-CD-CCYY.                                          00690000
007000             15  PV-CD-CC               PIC  XX.                  00700000
007100             15  PV-CD-YY               PIC  XX.                  00710000
007200         10  FILLER                     PIC  X.                   00720000
007300         10  PV-CD-MM                   PIC  XX.                  00730000
007400         10  FILLER                     PIC  X.                   00740000
007500         10  PV-CD-DD                   PIC  XX.                  00750000
004400     05  PV-DEPT.                                                 00751014
004500         10  FILLER                     PIC  X(01).               00752014
004500         10  PV-DEPT-X3                 PIC  X(03).               00753014
007600                                                                  00760000
007700 01  PC-PROGRAM-CONSTANTS.                                        00770000
007900     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE  'MR044A  '. 00790000
008000     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE  'MRKM044 '. 00800000
008100     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE  'MRKCS044'. 00810000
009910                                                                  00991003
010000 EJECT                                                            01000000
013000                                                                  01300000
013100 01  PS-PROGRAM-SWITCHES.                                         01310000
013200     05  PS-ERROR-SW                    PIC  X(01)  VALUE  'N'.   01320000
013300         88  PS-ERROR                               VALUE  'Y'.   01330000
013400         88  PS-NO-ERROR                            VALUE  'N'.   01340000
015900                                                                  01590000
016000 01  ST-SYSTEM-TIME-AREA.                                         01600000
016100     05  ST-ABSTIME                PIC S9(16)  COMP.              01610000
016200     05  ST-TIME-EDIT.                                            01620000
016300         10  ST-TIME-HHMM          PIC X(05).                     01630000
016400         10  FILLER                PIC X(03).                     01640000
016500     05  ST-DATE                   PIC X(08).                     01650000
016600     05  FILLER  REDEFINES  ST-DATE.                              01660000
016700         10  ST-MM                 PIC XX.                        01670000
016800         10  FILLER                PIC X.                         01680000
016900         10  ST-DD                 PIC XX.                        01690000
017000         10  FILLER                PIC X.                         01700000
017100         10  ST-YY                 PIC XX.                        01710000
017200                                                                  01720000
017300*----------------------------------------------------------------*01730000
017400*    MAP LAYOUT                                                  *01740000
017500*----------------------------------------------------------------*01750000
017600                                                                  01760000
017700     COPY MRKM044.                                                01770000
017800     EJECT                                                        01780000
017900                                                                  01790000
018000*----------------------------------------------------------------*01800000
018100*    ATTRIBUTE SETTINGS COPYBOOK.                                *01810000
018200*----------------------------------------------------------------*01820000
018300                                                                  01830000
018400     COPY DPWS015.                                                01840000
018500                                                                  01850000
018600*----------------------------------------------------------------*01860000
018700*    FUNCTION KEYS COPYBOOK                                      *01870000
018800*----------------------------------------------------------------*01880000
018900                                                                  01890000
019000     COPY DPWS016.                                                01900000
019100 EJECT                                                            01910000
019200******************************************************************01920000
019300** THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT    **01930000
019400** SUB-ROUTINE (DPKUT100).                                      **01940000
019500******************************************************************01950000
019600     COPY DPWS010I.                                               01960000
019700 EJECT                                                            01970000
019800******************************************************************01980000
019900** THE CALLING PARAMETER LIST (DPWS030) FOR THE CICS            **01990000
020000** ARCHITECTURE API (BLACK BOX) SUB-ROUTINE.                    **02000000
020100******************************************************************02010000
020200     COPY DPWS030.                                                02020000
CICS       COPY DPWS930.                                                02021015
020300 EJECT                                                            02030000
020400***************************************************************** 02040000
020500*    STANDARD COMMAREA.                                           02050000
020600***************************************************************** 02060000
020700                                                                  02070000
020800     COPY DPWS020.                                                02080000
020900     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                02090000
021000                                                                  02100000
021100***************************************************************** 02110000
021200*    INTER-APPLICATION COMMAREA.                                  02120000
021300***************************************************************** 02130000
021400                                                                  02140000
021500         10  INTER-APPL-COMM-AREA PIC X(200).                     02150000
021600     COPY MRWS114.                                                02160000
021700***************************************************************** 02170000
021800*    SPECIFIC COMMMAREA FOR MRKCS044.                             02180000
021900***************************************************************** 02190000
022000         10  ASC-SPECIFIC-COMMAREA.                               02200000
022600             15  ASC-DEPT-NUM                PIC  X(04).          02260002
022700             15  ASC-DEPT-NUM-N REDEFINES                         02270000
022800                 ASC-DEPT-NUM                PIC  9(04).          02280002
022900             15  ASC-CLASS-NUM               PIC  X(04).          02290002
023000             15  ASC-CLASS-NUM-N REDEFINES                        02300000
023100                 ASC-CLASS-NUM               PIC  9(04).          02310002
023200             15  ASC-SUBCLASS-NUM            PIC  X(04).          02320002
023300             15  ASC-SUBCLASS-NUM-N REDEFINES                     02330002
023400                 ASC-SUBCLASS-NUM            PIC  9(04).          02340002
023500             15  ASC-SKU-NUM                 PIC  X(08).          02350002
023600             15  ASC-SKU-NUM-N REDEFINES                          02360000
023700                 ASC-SKU-NUM                 PIC  9(08).          02370002
023800             15  ASC-PTAG                    PIC  X(07).          02380000
023900             15  FILLER                      PIC  X(10).          02390002
024000     EJECT                                                        02400000
024100*----------------------------------------------------------------*02410000
024200*    ABEND PROCESSING COPYBOOK.                                  *02420000
024300*----------------------------------------------------------------*02430000
024400                                                                  02440000
024500     COPY DPWS013.                                                02450000
024600                                                                  02460000
024700*----------------------------------------------------------------*02470000
024800*    WORK AREA FOR DB2 TABLES.                                   *02480000
024900*----------------------------------------------------------------*02490000
025000                                                                  02500000
026400 EJECT                                                            02640000
026500 LINKAGE SECTION.                                                 02650000
026600                                                                  02660000
026700 01  DFHCOMMAREA.                                                 02670000
026800     05  FILLER                         OCCURS  1 TO 4072 TIMES   02680000
026900                                        DEPENDING ON EIBCALEN.    02690000
027000         10  FILLER                     PIC X.                    02700000
027100                                                                  02710000
027200                                                                  02720000
027300 PROCEDURE DIVISION.                                              02730000
027400***************************************************************** 02740000
027500** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** 02750000
027600** THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  ** 02760000
027700** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            ** 02770000
027800**                                                             ** 02780000
027900** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  ** 02790000
028000** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       ** 02800000
028100***************************************************************** 02810000
028200 0000-MAIN-MODULE.                                                02820000
028300     INITIALIZE DP030-CICS-API-FIELDS.                            02830000
028400     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       02840000
028500     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          02850000
028600     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         02860000
028700     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       02870000
028800     MOVE LENGTH OF MR044AI        TO DP030-MAP-LENGTH (1).       02880000
028900     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     02890000
029000     PERFORM 0001-CALL-CICS-ARCH-API.                             02900000
029100     PERFORM 1100-PREPARE-DATE-MODULE.                            02910000
029200                                                                  02920000
029300     PERFORM 1000-CONTROL-PROCESSING                              02930000
029400                                                                  02940000
029500     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     02950000
029600     PERFORM 0001-CALL-CICS-ARCH-API.                             02960000
029700                                                                  02970000
029800 0001-CALL-CICS-ARCH-API.                                         02980000
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      02990015
030000                                    DFHCOMMAREA                   03000015
030100                                    DP030-CICS-API-FIELDS         03010015
030200                                    DP020-STANDARD-COMMAREA       03020015
030300                                    MR044AI.                      03030015
030400                                                                  03040000
030500     IF  DP030-RC-CALL-SUCCESSFUL                                 03050000
030600         CONTINUE                                                 03060000
030700     ELSE                                                         03070000
030800         SET DP013-NO-ROLLBACK                                    03080000
030900             DP013-XCTL-DISPLAY-RESTART                           03090000
031000             DP013-CICS-ABEND      TO TRUE                        03100000
031100         MOVE 'BEFORE 0000-MAIN-MODULE'                           03110000
031200                                   TO DP013-PARAGRAPH             03120000
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O03121015
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      03122015
031500         MOVE DP030-RETURN-CODE                                   03150000
031600                                   TO DP013-MESSAGE-TEXT (3)      03160000
031700         PERFORM DP013-0000-PROCESS-ABEND                         03170000
031800     END-IF.                                                      03180000
031900 EJECT                                                            03190000
032000*----------------------------------------------------------------*03200000
032100*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *03210000
032200*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *03220000
032300*----------------------------------------------------------------*03230000
032400                                                                  03240000
032500 1000-CONTROL-PROCESSING.                                         03250000
032600                                                                  03260000
032700     EVALUATE TRUE                                                03270000
032800         WHEN DP020-NEXT-ACT-INITIAL                              03280000
032900             INITIALIZE ASC-SPECIFIC-COMMAREA                     03290000
033000             PERFORM 4000-BUILD-INITIAL-PANEL                     03300000
033100                                                                  03310000
033200         WHEN DP020-NEXT-ACT-READ-MAP                             03320000
033300             PERFORM 2000-FKEY-PROCESSING                         03330000
033400                                                                  03340000
033500         WHEN DP020-NEXT-ACT-RETURN                               03350000
033600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 03360000
033700             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   03370000
033800                                                                  03380000
033900         WHEN OTHER                                               03390000
034000             SET DP013-LOGIC-ABEND                                03400000
034100                 DP013-NO-ROLLBACK TO TRUE                        03410000
034200             MOVE '1000-CONTROL-PROCESSING'                       03420000
034300                                   TO  DP013-PARAGRAPH            03430000
034400             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   03440000
034500                                   TO  DP013-MESSAGE-TEXT(1)      03450000
034600             MOVE DP020-NEXT-APPL-ACTIVITY                        03460000
034700                                   TO DP013-MESSAGE-TEXT(2)       03470000
034800             PERFORM DP013-0000-PROCESS-ABEND                     03480000
034900     END-EVALUATE.                                                03490000
035000                                                                  03500000
035100 1100-PREPARE-DATE-MODULE.                                        03510000
035200*----------------------------------------------------------------*03520000
035300*                                                                *03530000
035400*     LOAD THE CURRENT DATE TO A WORK AREA.                      *03540000
035500*                                                                *03550000
035600*----------------------------------------------------------------*03560000
035700                                                                  03570000
035800     EXEC CICS ASKTIME                                            03580000
035900               ABSTIME(ST-ABSTIME)                                03590000
036000     END-EXEC.                                                    03600000
036100                                                                  03610000
036200     EXEC CICS FORMATTIME                                         03620000
036300               ABSTIME (ST-ABSTIME)                               03630000
036400               MMDDYY  (ST-DATE)                                  03640000
036500               DATESEP                                            03650000
036600               TIME    (ST-TIME-EDIT)                             03660000
036700               TIMESEP                                            03670000
036800     END-EXEC.                                                    03680000
036900                                                                  03690000
037000     MOVE ST-MM                    TO  PV-PROCESS-DATE-MM.        03700000
037100     MOVE ST-DD                    TO  PV-PROCESS-DATE-DD.        03710000
037200     MOVE ST-YY                    TO  PV-PROCESS-DATE-YY.        03720000
037300                                                                  03730000
037400     IF ST-YY > 90                                                03740000
037500         MOVE 19                 TO PV-PROCESS-DATE-CENT          03750000
037600     ELSE                                                         03760000
037700         MOVE 20                 TO PV-PROCESS-DATE-CENT          03770000
037800     END-IF.                                                      03780000
037900                                                                  03790000
038000                                                                  03800000
038100*----------------------------------------------------------------*03810000
038200* FURTHER DETERMINE PROCESSING PATH BASED ON FUNCTION KEY ACTIONS*03820000
038300* SPECIFIC FUNCTION KEYS LISTED HERE ARE ACTED UPON REGARDLESS OF*03830000
038400* EDITS.                                                         *03840000
038500*----------------------------------------------------------------*03850000
038600                                                                  03860000
038700 2000-FKEY-PROCESSING.                                            03870000
038800                                                                  03880000
038900     EVALUATE TRUE                                                03890000
039000                                                                  03900000
039100         WHEN DP020-SRC-AID = DP016-CLEAR                         03910000
039200             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   03920000
039300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 03930000
039400                                                                  03940000
039500         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     03950000
039600             INITIALIZE ASC-SPECIFIC-COMMAREA                     03960000
039700             PERFORM 4000-BUILD-INITIAL-PANEL                     03970000
039800             PERFORM 3200-RESET-ATTRIBUTES                        03980000
039900                                                                  03990000
040000         WHEN OTHER                                               04000000
040100             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 04010000
040200             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   04020000
040300             IF  PS-NO-ERROR                                      04030000
040400                 SET DP030-CONTINUE-GO TO TRUE                    04040000
040500                 PERFORM 2100-CHECK-FUNCTION-KEY                  04050000
040800             END-IF                                               04080000
040900     END-EVALUATE.                                                04090000
041000******************************************************************04100000
041100** ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED     **04110000
041200** FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED **04120000
041300** FROM THE CICS ARCHITECTURE API.                              **04130000
041400******************************************************************04140000
041500 2100-CHECK-FUNCTION-KEY.                                         04150000
041600     EVALUATE TRUE                                                04160000
041700         WHEN DP020-FK-LOCAL-GOTO (DP020-SRC-AID)                 04170000
041800             PERFORM 2110-PREPARE-INTER-APPL-COMM                 04180000
041900                                                                  04190000
042000         WHEN DP020-SRC-AID = DP016-ENTER                         04200000
042100             CONTINUE                                             04210000
042200                                                                  04220000
042300         WHEN OTHER                                               04230000
042400             SET DP013-NO-ROLLBACK                                04240000
042500                 DP013-XCTL-DISPLAY-RESTART                       04250000
042600                 DP013-CICS-ABEND  TO TRUE                        04260000
042700             MOVE '2100-CHECK-FUNCTION-KEY'                       04270000
042800                                   TO DP013-PARAGRAPH             04280000
042900             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      04290000
043000                                   TO DP013-MESSAGE-TEXT (1)      04300000
043100             PERFORM DP013-0000-PROCESS-ABEND                     04310000
043200     END-EVALUATE.                                                04320000
043300******************************************************************04330000
043400** MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE   **04340000
043500** INTER-APPLICATION COMMAREA.                                  **04350000
043600******************************************************************04360000
043700 2110-PREPARE-INTER-APPL-COMM.                                    04370000
043800     INITIALIZE MR114-INTER-APPL-COMMAREA.                        04380000
043900     MOVE ASC-DEPT-NUM             TO MR114-DEPT.                 04390000
044000     MOVE ASC-CLASS-NUM            TO MR114-CLASS.                04400000
044010     MOVE ASC-SUBCLASS-NUM         TO MR114-SUBCLASS.             04401002
044100     MOVE ASC-SKU-NUM              TO MR114-SKU.                  04410002
044200     MOVE ASC-PTAG                 TO MR114-PTAG.                 04420000
044300 EJECT                                                            04430000
044400*----------------------------------------------------------------*04440000
044500* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS IN*04450000
044600* THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN THE  *04460000
044700* APPLICATION-SPECIFIC COMMAREA, NOT ON THE SCREEN.              *04470000
044800*----------------------------------------------------------------*04480000
044900                                                                  04490000
045000 2200-MOVE-SCREEN-TO-COMMAREA.                                    04500000
045100     IF  DEPTL > ZERO                                             04510000
045200         MOVE DEPTI                TO ASC-DEPT-NUM-N              04520012
045300     ELSE                                                         04530000
045400         IF  DEPTF = DP015-ERASE-EOF                              04540000
045500             MOVE SPACE            TO ASC-DEPT-NUM                04550000
045600         END-IF                                                   04560000
045700     END-IF.                                                      04570000
045800                                                                  04580000
045900     IF  CLASSL > ZERO                                            04590000
046000         MOVE CLASSI               TO ASC-CLASS-NUM               04600000
046100     ELSE                                                         04610000
046200         IF  CLASSF = DP015-ERASE-EOF                             04620000
046300             MOVE SPACE            TO ASC-CLASS-NUM               04630000
046400         END-IF                                                   04640000
046500     END-IF.                                                      04650000
046600                                                                  04660000
046610     IF  SCLASSL > ZERO                                           04661003
046620         MOVE SCLASSI              TO ASC-SUBCLASS-NUM            04662003
046630     ELSE                                                         04663003
046640         IF  SCLASSF = DP015-ERASE-EOF                            04664003
046650             MOVE SPACE            TO ASC-SUBCLASS-NUM            04665003
046660         END-IF                                                   04666003
046670     END-IF.                                                      04667003
046680                                                                  04668003
046700     IF  SKUL > ZERO                                              04670000
046800         MOVE SKUI                 TO ASC-SKU-NUM                 04680000
046900     ELSE                                                         04690000
047000         IF  SKUF = DP015-ERASE-EOF                               04700000
047100             MOVE SPACE            TO ASC-SKU-NUM                 04710000
047200         END-IF                                                   04720000
047300     END-IF.                                                      04730000
047400                                                                  04740000
047500     IF  PTAGL > ZERO                                             04750000
047600         MOVE PTAGI                TO ASC-PTAG                    04760000
047700     ELSE                                                         04770000
047800         IF  PTAGF = DP015-ERASE-EOF                              04780000
047900             MOVE SPACE            TO ASC-PTAG                    04790000
048000         END-IF                                                   04800000
048100     END-IF.                                                      04810000
048200                                                                  04820000
048300*----------------------------------------------------------------*04830000
048400* ENSURE THE DATA IS CORRECT.  NOTE THAT IN A CRITERIA SPECIFI-  *04840000
048500* CATION SCREEN ONLY MINIMAL EDITS ARE DONE.  EDITS RELATED TO   *04850000
048600* A SPECIFIC SCREEN THAT THE USER IS GOING TO (LOCAL-GO) ARE DONE*04860000
048700* IN THE DESTINATION PROGRAM, NOT HERE.                          *04870000
048800*----------------------------------------------------------------*04880000
048900                                                                  04890000
049000 3000-EDIT-DATA-IN-COMMAREA.                                      04900000
049100     PERFORM 3200-RESET-ATTRIBUTES.                               04910000
049200                                                                  04920000
066600******************************************************************06660000
066700** MOVE THE DEFAULT ATTRIBUTES TO ALL OF THE OPEN FIELDS ON THE **06670000
066800** MAP.                                                         **06680000
066900******************************************************************06690000
067000 3200-RESET-ATTRIBUTES.                                           06700000
067100     MOVE DP015-UNP-ALP-NOR-OFF    TO DEPTA                       06710000
067200                                      CLASSA                      06720000
067210                                      SCLASSA                     06721003
067300                                      SKUA                        06730000
067400                                      PTAGA.                      06740000
067500     MOVE DP015-GREEN              TO DEPTC                       06750000
067600                                      CLASSC                      06760000
067610                                      SCLASSC                     06761003
067700                                      SKUC                        06770000
067800                                      PTAGC.                      06780000
067900     MOVE DP015-UNDERLINE          TO DEPTH                       06790000
068000                                      CLASSH                      06800000
068010                                      SCLASSH                     06801003
068100                                      SKUH                        06810000
068200                                      PTAGH.                      06820000
068300                                                                  06830000
068400*----------------------------------------------------------------*06840000
068500*  POSITION THE CURSOR AT THE APPROPRIATE FIELD.                 *06850000
068600*  IF THERE IS ANY DATA TO MOVE TO THE SCREEN ON INITIAL, MOVE   *06860000
068700*  IT HERE.                                                      *06870000
068800*----------------------------------------------------------------*06880000
068900 4000-BUILD-INITIAL-PANEL.                                        06890000
069000     SET DP030-SET-CURSOR-APPL-1   TO TRUE                        06900000
069100     MOVE -1                       TO DEPTL.                      06910000
069200                                                                  06920000
069300*----------------------------------------------------------------*06930000
069400*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *06940000
069500*----------------------------------------------------------------*06950000
069600 4400-MOVE-COMMAREA-TO-SCREEN.                                    06960000
069700     MOVE ASC-DEPT-NUM             TO PV-DEPT.                    06970014
069700     MOVE PV-DEPT-X3               TO DEPTO.                      06971014
069800     MOVE ASC-CLASS-NUM            TO CLASSO.                     06980000
069810     MOVE ASC-SUBCLASS-NUM         TO SCLASSO.                    06981003
069900     MOVE ASC-SKU-NUM-N            TO SKUO.                       06990000
070000     MOVE ASC-PTAG                 TO PTAGO.                      07000000
070200                                                                  07020000
074700*----------------------------------------------------------------*07470000
074800*    ABEND PROCESSOR MODULE                                      *07480000
074900*----------------------------------------------------------------*07490000
075000                                                                  07500000
075100     COPY DPPD013.                                                07510000
