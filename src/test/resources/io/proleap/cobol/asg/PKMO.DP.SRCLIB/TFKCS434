      *-----------------------*                                         00010099
       IDENTIFICATION DIVISION.                                         00020099
      *-----------------------*                                         00030099
       PROGRAM-ID.    TFKCS434.                                         00040099
       AUTHOR.        JACK KRAMER.                                      00050099
       INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060099
       DATE-WRITTEN.  SEPTEMBER 1996.                                   00070099
       DATE-COMPILED.                                                   00080099
                                                                        00090099
      *---------------------------------------------------------------* 00100099
      *    P434 - TRANSFER DISCREPANCY INQUIRY.                       * 00110099
      *                                                               * 00120099
      *    THIS PROGRAM GENERATES A LIST OF ALL LINES WITH            * 00130099
      *    DISCREPANCIES FOR A SPECIFIED TRANSFER.                    * 00140099
      *    THERE IS AN AVAILABLE PRINT REQUEST FUNCTION WHICH USES    * 00150099
      *    THE DRS FACILITY.                                          * 00160099
      *---------------------------------------------------------------* 00170099
      *  1/20/2003 - RAY GRAF                                           00171099
      *   PROCESS NONINTELLIGENT SKU.                                   00172099
      ******************************************************************00173099
080204**DATE:08/02/2004 CHANGED BY: RAY GRAF                            00174099
080204**     CHANGE PRINTER DESTINATION TO NEW 8 CHARACTER FORMAT       00175099
      ***************************************************************** 00176099
100404**DATE:10/04/2004 CHANGED BY: RAY GRAF                            00177099
100404**     EXPAND STORE NUMBER. MAKE DOMAIN COMPLIANT.                00178099
      ***************************************************************** 00179099
SR3403**DATE:02/24/2012 CHANGED BY: TEJA KARWEER                        00179199
SR3403**     EXPAND AMOUNT FIELD FROM 4 DIGIT TO 5 DIGITS               00179299
SR3403***************************************************************** 00179399
      * DATE:        09/24/2021                                         00179499
      * WR/IR#:      CHG0261678                                         00179599
      * PROGRAMMER:  GERMAN BANDA                                       00179699
      * DESCRIPTION: CHANGE CALL OF DPKUT100 TO                         00179799
      *              CALL DP010I-NUMERIC-EDIT-ROUTINE                   00179899
      *              MAKING THE CALL DYNAMIC VS STATIC                  00179999
      *----------------------------------------------------------------*00180099
CICS  * CHANGED 11/17/2022    BY JIM HUNTER      WR: CHG0278345         00180199
CICS  * ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL        00180299
CICS  * DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.       00180399
CICS  *-----------------------------------------------------------------00180499
       EJECT                                                            00181099
       ENVIRONMENT DIVISION.                                            00190099
                                                                        00200099
       DATA DIVISION.                                                   00210099
                                                                        00220099
       WORKING-STORAGE SECTION.                                         00230099
                                                                        00240099
       01  DK-DB2-KEYS.                                                 00250099
           05  DK-STORE-NBR             PIC S9(04)  COMP  VALUE +0.     00260099
           05  DK-XFER-SEQ-NBR          PIC S9(09)  COMP  VALUE +0.     00270099
           05  DK-XFER-DKEY-ID          PIC S9(09)  COMP  VALUE +0.     00280099
                                                                        00290099
       01  PC-PROGRAM-CONSTANTS.                                        00300099
           05 PC-099                    PIC  9(03)  VALUE 099.          00301099
           05 PC-100                    PIC  9(03)  VALUE 100.          00302099
           05 PC-INIT                   PIC  X(04)  VALUE 'INIT'.       00310099
           05 PC-PUT                    PIC  X(04)  VALUE 'PUT'.        00320099
           05 PC-TERM                   PIC  X(04)  VALUE 'TERM'.       00330099
           05 PC-TOP-OF-PAGE            PIC  X(01)  VALUE '1'.          00340099
           05 PC-SINGLE-SPACE           PIC  X(01)  VALUE ' '.          00350099
           05 PC-DOUBLE-SPACE           PIC  X(01)  VALUE '0'.          00360099
           05 PC-TRAILER                PIC  X(02)  VALUE '04'.         00370099
           05 PC-TRAILER-SEAL-LIT       PIC  X(15)  VALUE               00380099
                'TRAILER SEAL  :'.                                      00390099
           05 PC-TRAILER-NBR-LIT        PIC  X(15)  VALUE               00400099
                'TRAILER NBR   :'.                                      00410099
           05  PC-LINE-MAX                    PIC S9(02)  VALUE +60     00420099
                                                          COMP-3.       00430099
           05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         00440099
                                                          'TF434A  '.   00450099
           05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         00460099
                                                          'TFKM434 '.   00470099
           05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         00480099
                                                          'TFKCS434'.   00490099
           05  PC-LIST-QUEUE-SEQ              PIC  9(01)  VALUE 1.      00500099
           05  PC-SEL-QUEUE-SEQ               PIC  9(01)  VALUE 3.      00510099
           05  PC-CRIT-SPEC-FORMAT            PIC  X(01)  VALUE '1'.    00520099
           05  PC-POSITIVE-RECEIPT            PIC X(02)    VALUE 'PR'.  00530099
           05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +11     00540099
                                                          COMP SYNC.    00550099
           05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      00560099
                                                          COMP SYNC.    00570099
           05  PC-MAX-ITEMS                   PIC S9(09)  VALUE         00580099
                                                          +1000000      00590099
                                                          COMP-3.       00600099
           05  PC-MSG-NUMBER-LENGTH           PIC S9(04)  VALUE +5      00610099
                                                          COMP SYNC.    00620099
           05  PC-MAX-RETRIES                 PIC S9(03)  VALUE 3       00630099
                                                          COMP-3.       00640099
           05  PC-PERCENT                     PIC  X(01)  VALUE '%'.    00650099
           05  PC-INQ                         PIC  X(03)  VALUE 'INQ'.  00660099
           05  PC-UPD                         PIC  X(03)  VALUE 'UPD'.  00670099
           05  PC-DEL                         PIC  X(03)  VALUE 'DEL'.  00680099
           05  PC-ERR                         PIC  X(03)  VALUE 'ERR'.  00690099
      *                                                                 00700099
           05  PC-TSYMSG-NUMBERS.                                       00710099
               10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  00720099
               10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  00730099
               10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  00740099
               10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  00750099
               10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  00760099
               10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  00770099
               10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  00780099
               10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  00790099
               10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  00800099
               10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  00810099
               10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  00820099
               10  PC-TSYMSG-00098            PIC  9(05)  VALUE 00098.  00830099
               10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  00840099
               10  PC-TSYMSG-00148            PIC  9(05)  VALUE 00148.  00850099
               10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  00860099
               10  PC-TSYMSG-99901            PIC  9(05)  VALUE 99901.  00870099
      *                                                                 00880099
       01  PS-PROGRAM-SWITCHES.                                         00890099
           05  PS-TRANSFER-FOUND-SW     PIC X.                          00900099
               88  PS-TRANSFER-FOUND             VALUE 'Y'.             00910099
               88  PS-TRANSFER-NOT-FOUND         VALUE 'N'.             00920099
           05  PS-DISCREPANCY-FOUND-SW  PIC X.                          00930099
               88  PS-DISCREPANCY-FOUND          VALUE 'Y'.             00940099
               88  PS-DISCREPANCY-NOT-FOUND      VALUE 'N'.             00950099
           05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    00960099
               88  PS-NO-ERROR                            VALUE 'Y'.    00970099
               88  PS-ERROR                               VALUE 'N'.    00980099
           05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    00990099
               88  PS-COMMAREA-VALID                      VALUE 'Y'.    01000099
               88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    01010099
           05  PS-DONE-SW                     PIC  X(01)  VALUE 'N'.    01020099
               88  PS-DONE                                VALUE 'Y'.    01030099
               88  PS-NOT-DONE                            VALUE 'N'.    01040099
           05  PS-FIRST-LINE-SW               PIC  X(01)  VALUE 'N'.    01050099
               88  PS-FIRST-LINE                          VALUE 'Y'.    01060099
               88  PS-NOT-FIRST-LINE                      VALUE 'N'.    01070099
           05  PS-FIRST-TIME-SW               PIC  X(01)  VALUE 'Y'.    01080099
               88  PS-FIRST-TIME                          VALUE 'Y'.    01090099
               88  PS-NOT-FIRST-TIME                      VALUE 'N'.    01100099
      *                                                                 01110099
       01  PV-PROGRAM-VARIABLES.                                        01120099
           05  PV-ABSTIME                      PIC S9(16)  VALUE +0.    01130099
           05  PV-LINE-COUNT                  PIC  S9(03)  VALUE +0.    01140099
           05  PV-PAGE-COUNT                  PIC  S9(03)  VALUE +0.    01150099
           05  PV-XFER-NBR.                                             01190099
100404*        10  PV-XFER-FROM-STORE-NBR     PIC 9(03).                01200099
100404         10  PV-XFER-FROM-STORE-NBR     PIC 9(04).                01201099
               10                             PIC X    VALUE '-'.       01210099
               10  PV-XFER-SEQ-NBR            PIC 9(06).                01220099
           05  PV-DPT-CL-SUBCL.                                         01230099
               10  PV-DEPT                    PIC 999.                  01240099
               10  FILLER                     PIC X(01)   VALUE SPACE.  01250099
               10  PV-GROUP-1.                                          01260099
                   15 PV-CLASS-1              PIC 99      VALUE ZEROS.  01270099
                   15 FILLER                  PIC X(01)   VALUE SPACE.  01280099
                   15 PV-SUBCLASS-1           PIC 99      VALUE ZEROS.  01281099
                   15 FILLER                  PIC X(02)   VALUE SPACE.  01282099
               10  PV-GROUP-2 REDEFINES PV-GROUP-1.                     01283099
                   15 PV-CLASS-2              PIC  99.                  01284099
                   15 PV-FILLER-2A            PIC  X(01).               01285099
                   15 PV-SUBCLASS-2           PIC  999.                 01286099
                   15 PV-FILLER-2B            PIC  X(01).               01287099
               10  PV-GROUP-3 REDEFINES PV-GROUP-1.                     01288099
                   15 PV-CLASS-3              PIC  999.                 01289099
                   15 PV-FILLER-3A            PIC  X(01).               01289199
                   15 PV-SUBCLASS-3           PIC  99.                  01289299
                   15 PV-FILLER-3B            PIC  X(01).               01289399
               10  PV-GROUP-4 REDEFINES PV-GROUP-1.                     01289499
                   15 PV-CLASS-4              PIC  999.                 01289599
                   15 PV-FILLER-4A            PIC  X(01).               01289699
                   15 PV-SUBCLASS-4           PIC  999.                 01289799
           05  PV-UPC                         PIC 99B99999B99999B9.     01290099
           05  FILLER REDEFINES PV-UPC.                                 01300099
               10                             PIC X(02).                01310099
               10  PV-UPC-DASH-1              PIC X.                    01320099
               10                             PIC X(05).                01330099
               10  PV-UPC-DASH-2              PIC X.                    01340099
               10                             PIC X(05).                01350099
               10  PV-UPC-DASH-3              PIC X.                    01360099
               10                             PIC X.                    01370099
           05  PV-HOLD-UPC-NBR.                                         01371099
               10  FILLER                      PIC X(03).               01372099
               10  PV-KOHLS-UPC-DIGIT          PIC X(01).               01373099
               10  FILLER                      PIC X(02).               01374099
               10  PV-KOHLS-DEPT               PIC 9(03).               01375099
               10  PV-KOHLS-CL.                                         01376099
                   15  PV-KOHLS-CL-1           PIC X(01).               01377099
                   15  PV-KOHLS-CL-2           PIC X(01).               01378099
               10  PV-KOHLS-CL-9 REDEFINES PV-KOHLS-CL                  01379099
                                               PIC 9(02).               01379199
               10  PV-KOHLS-DUMMY-SKU          PIC X(03).               01379299
               10  PV-KOHLS-CHECKDIGIT         PIC X(01).               01379399
           05  PV-HOLD-UPC-NBR-9 REDEFINES PV-HOLD-UPC-NBR              01379499
                                               PIC 9(15).               01379599
           05  PV-XFER-TOTAL                  PIC S9(08)V99  VALUE +0   01380099
                                                          COMP-3.       01390099
           05  PV-RCVD-TOTAL                  PIC S9(08)V99  VALUE +0   01400099
                                                          COMP-3.       01410099
           05  PV-XFER-IND                    PIC S9(04)  VALUE +0      01420099
                                                    COMP SYNC.          01430099
           05  PV-RCVD-IND                    PIC S9(04)  VALUE +0      01440099
                                                    COMP SYNC.          01450099
           05  PV-VARIANCE                    PIC S9(08)V99  VALUE +0   01460099
                                                          COMP-3.       01470099
           05  PV-EDITTED-VARIANCE-FIELD.                               01480099
               10  PV-EDIT-V-PAREN-1          PIC X       VALUE SPACE.  01490099
SR3403         10  PV-EDITTED-VARIANCE        PIC ZZZZ9.99.             01501099
               10  PV-EDIT-V-PAREN-2          PIC X       VALUE SPACE.  01510099
           05  PV-EDITTED-NET-DISCREP-FIELD.                            01520099
               10  PV-EDIT-D-PAREN-1          PIC X       VALUE SPACE.  01530099
               10  PV-EDITTED-NET-DISCREP     PIC ZZZZZ9.99.            01540099
               10  PV-EDIT-D-PAREN-2          PIC X       VALUE SPACE.  01550099
           05  PV-SUB                         PIC S9(04)  VALUE +0      01560099
                                                          COMP SYNC.    01570099
           05  PV-SAVE-SUB                    PIC S9(04)  VALUE +0      01580099
                                                          COMP SYNC.    01590099
           05  PV-REMAINDER                   PIC S9(04)  VALUE +0      01600099
                                                          COMP SYNC.    01610099
           05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      01620099
                                                          COMP-3.       01630099
           05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      01640099
                                                          COMP-3.       01650099
           05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      01660099
                                                          COMP-3.       01670099
           05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      01680099
                                                          COMP-3.       01690099
           05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      01700099
                                                          COMP-3.       01710099
           05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      01720099
                                                          COMP-3.       01730099
           05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      01740099
                                                          COMP-3.       01750099
           05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      01760099
                                                          COMP SYNC.    01770099
           05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      01780099
                                                          COMP SYNC.    01790099
           05  PV-ITEM                        PIC S9(04)  VALUE +0      01800099
                                                          COMP SYNC.    01810099
           05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      01820099
                                                          COMP SYNC.    01830099
           05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      01840099
                                                          COMP SYNC.    01850099
           05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      01860099
                                                          COMP SYNC.    01870099
           05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      01880099
                                                          COMP SYNC.    01890099
           05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      01900099
                                                          COMP SYNC.    01910099
           05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01920099
                                                          COMP SYNC.    01930099
           05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01940099
                                                          COMP SYNC.    01950099
           05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      01960099
                                                          COMP SYNC.    01970099
           05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      01980099
                                                          COMP SYNC.    01990099
           05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      02000099
                                                          COMP SYNC.    02010099
           05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      02020099
                                                          COMP SYNC.    02030099
           05  PV-SQL-SUB                     PIC S9(04)  VALUE +0      02040099
                                                          COMP SYNC.    02050099
           05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      02060099
                                                          COMP SYNC.    02070099
      *                                                                 02080099
           COPY DPWS132O.                                               02090099
       01  HL2-HEADING-LINE-2.                                          02100099
           05  FILLER                          PIC  X(55)  VALUE SPACE. 02110099
           05  FILLER                          PIC  X(30)  VALUE        02120099
               'TRANSFER DISCREPANCY'.                                  02130099
      *                                                                 02140099
       01  HL3-HEADING-LINE-3.                                          02150099
           05  FILLER                          PIC  X(02)  VALUE SPACE. 02160099
           05  FILLER                          PIC  X(17)  VALUE        02170099
                'TRANSFER NO....:'.                                     02180099
100404*    05  HL3-XFER-NBR                    PIC  999B999999.         02190099
100404     05  HL3-XFER-NBR                    PIC  9999B999999.        02191099
           05  FILLER REDEFINES HL3-XFER-NBR.                           02200099
100404*        10                              PIC X(03).               02210099
100404         10                              PIC X(04).               02211099
               10  HL3-XFER-NBR-DASH           PIC X.                   02220099
               10                              PIC X(06).               02230099
           05  FILLER                          PIC  X(24)  VALUE SPACE. 02240099
           05  FILLER                          PIC  X(15)  VALUE        02250099
               'FROM    STORE:'.                                        02260099
100404*    05  HL3-FR-STORE-NBR                PIC  999.                02270099
100404     05  HL3-FR-STORE-NBR                PIC  9(04).              02271099
           05  FILLER                          PIC  X      VALUE SPACE. 02280099
           05  HL3-FR-STORE-NAME               PIC  X(10).              02290099
           05  FILLER                          PIC  X(20)  VALUE SPACE. 02300099
           05  HL3-SEAL-LITERAL1               PIC  X(10)  VALUE        02310099
               'TRANSFERED'.                                            02320099
           05  FILLER                          PIC  X(01)  VALUE SPACE. 02330099
           05  HL3-SEAL-LITERAL2               PIC  X(10)  VALUE        02340099
               'RECEIVED'.                                              02350099
       01  HL4-HEADING-LINE-4.                                          02360099
100404*    05  FILLER                          PIC  X(53)  VALUE SPACE. 02370099
100404     05  FILLER                          PIC  X(54)  VALUE SPACE. 02371099
100404     05  FILLER                          PIC  X(15)  VALUE        02380099
               'TO      STORE:'.                                        02390099
100404*    05  HL4-TO-STORE-NBR                PIC  999.                02400099
100404     05  HL4-TO-STORE-NBR                PIC  9(04).              02401099
           05  FILLER                          PIC  X      VALUE SPACE. 02410099
           05  HL4-TO-STORE-NAME               PIC  X(10).              02420099
           05  FILLER                          PIC  X(05)  VALUE SPACE. 02430099
           05  HL4-SEAL-LITERAL                PIC  X(15)  VALUE        02440099
                'LG TOTE SEAL 1:'.                                      02450099
           05  FILLER                          PIC  X(01)  VALUE SPACE. 02460099
           05  HL4-SEAL-1                      PIC  X(08)  VALUE SPACE. 02470099
           05  FILLER                          PIC  X(02)  VALUE SPACE. 02480099
           05  HL4-SEAL-2                      PIC  X(08)  VALUE SPACE. 02490099
       01  HL5-HEADING-LINE-5.                                          02500099
           05  FILLER                          PIC  X(02)  VALUE SPACE. 02510099
           05  FILLER                          PIC  X(24)  VALUE        02520099
                'NET RETAIL DISCREPANCY:'.                              02530099
           05  HL5-NET-DISCREP                 PIC  X(11).              02540099
100404*    05  FILLER                          PIC  X(16)  VALUE SPACE. 02550099
100404     05  FILLER                          PIC  X(17)  VALUE SPACE. 02551099
           05  FILLER                          PIC  X(15)  VALUE        02560099
               'RECEIVE STORE:'.                                        02570099
100404*    05  HL5-RC-STORE-NBR                PIC  999.                02580099
100404     05  HL5-RC-STORE-NBR                PIC  9(04).              02581099
           05  FILLER                          PIC  X      VALUE SPACE. 02590099
           05  HL5-RC-STORE-NAME               PIC  X(10).              02600099
           05  FILLER                          PIC  X(05)  VALUE SPACE. 02610099
           05  HL5-SEAL-LITERAL                PIC  X(15)  VALUE        02620099
                'LG TOTE SEAL 2:'.                                      02630099
           05  FILLER                          PIC  X(01)  VALUE SPACE. 02640099
           05  HL5-SEAL-1                      PIC  X(08)  VALUE SPACE. 02650099
           05  FILLER                          PIC  X(02)  VALUE SPACE. 02660099
           05  HL5-SEAL-2                      PIC  X(08)  VALUE SPACE. 02670099
       01  HL6-HEADING-LINE-6.                                          02680099
100404*    05  FILLER                          PIC  X(87)  VALUE SPACE. 02690099
100404     05  FILLER                          PIC  X(89)  VALUE SPACE. 02691099
           05  HL6-SEAL-LITERAL                PIC  X(15)  VALUE        02700099
                'SM TOTE SEAL  :'.                                      02710099
           05  FILLER                          PIC  X(01)  VALUE SPACE. 02720099
           05  HL6-SEAL-1                      PIC  X(08)  VALUE SPACE. 02730099
           05  FILLER                          PIC  X(02)  VALUE SPACE. 02740099
           05  HL6-SEAL-2                      PIC  X(08)  VALUE SPACE. 02750099
       01  HL7-HEADING-LINE-7.                                          02760099
           05  FILLER                          PIC  X(44)  VALUE SPACE. 02770099
           05  FILLER                          PIC  X(15)  VALUE        02780099
             '--TRANSFER--'.                                            02790099
           05  FILLER                          PIC  X(13)  VALUE        02800099
             '--RECEIVED--'.                                            02810099
       01  HL8-HEADING-LINE-8.                                          02820099
SR3403     05  FILLER                          PIC  X(08)  VALUE SPACE. 02831099
           05  FILLER                          PIC  X(05)  VALUE 'LN'.  02840099
           05  FILLER                          PIC  X(14)  VALUE        02850099
             'D/M/S     '.                                              02860099
SR3403     05  FILLER                          PIC  X(17)  VALUE 'UPC'. 02870099
           05  FILLER                          PIC  X(15)  VALUE        02880099
             'QTY    PRICE'.                                            02890099
           05  FILLER                          PIC  X(16)  VALUE        02900099
             'QTY    PRICE'.                                            02910099
SR3403     05  FILLER                          PIC  X(11)  VALUE        02921099
             'VARIANCE'.                                                02930099
       01  DL1-DETAIL-LINE-1.                                           02940099
           05  FILLER                          PIC  X(04)  VALUE SPACE. 02950099
           05  DL1-ACTION                      PIC  X(03)  VALUE SPACE. 02960099
           05  FILLER                          PIC  X(01)  VALUE SPACE. 02970099
           05  DL1-LINE                        PIC  ZZ9.                02980099
           05  FILLER                          PIC  X(03)  VALUE SPACE. 02990099
           05  DL1-DPT-CL-SUBCL.                                        02991199
               10  DL1-DEPT                   PIC 999.                  02991299
               10  FILLER                     PIC X(01)   VALUE SPACE.  02991399
               10  DL1-GROUP-1.                                         02991499
                   15 DL1-CLASS-1             PIC 99      VALUE ZEROS.  02991599
                   15 FILLER                  PIC X(01)   VALUE SPACE.  02991699
                   15 DL1-SUBCLASS-1          PIC 99      VALUE ZEROS.  02991799
                   15 FILLER                  PIC X(02)   VALUE SPACE.  02991899
               10  DL1-GROUP-2 REDEFINES DL1-GROUP-1.                   02991999
                   15 DL1-CLASS-2             PIC  99.                  02992099
                   15 DL1-FILLER-2A           PIC  X(01).               02992199
                   15 DL1-SUBCLASS-2          PIC  999.                 02992299
                   15 DL1-FILLER-2B           PIC  X(01).               02992399
               10  DL1-GROUP-3 REDEFINES DL1-GROUP-1.                   02992499
                   15 DL1-CLASS-3             PIC  999.                 02992599
                   15 DL1-FILLER-3A           PIC  X(01).               02992699
                   15 DL1-SUBCLASS-3          PIC  99.                  02992799
                   15 DL1-FILLER-3B           PIC  X(01).               02992899
               10  DL1-GROUP-4 REDEFINES DL1-GROUP-1.                   02992999
                   15 DL1-CLASS-4             PIC  999.                 02993099
                   15 DL1-FILLER-4A           PIC  X(01).               02993199
                   15 DL1-SUBCLASS-4          PIC  999.                 02993299
           05  FILLER                         PIC  X(02)  VALUE SPACE.  03050099
           05  DL1-UPC                         PIC  99B99999B99999B9.   03060099
           05  FILLER REDEFINES DL1-UPC.                                03070099
               10                              PIC X(02).               03080099
               10  DL1-UPC-DASH-1              PIC X.                   03090099
               10                              PIC X(05).               03100099
               10  DL1-UPC-DASH-2              PIC X.                   03110099
               10                              PIC X(05).               03120099
               10  DL1-UPC-DASH-3              PIC X.                   03130099
               10                              PIC X(01).               03140099
           05  FILLER                          PIC  X(01)  VALUE SPACE. 03150099
           05  DL1-TQTY                        PIC  ZZZ.                03160099
SR3403     05  FILLER                          PIC  X(01)  VALUE SPACE. 03171099
SR3403     05  DL1-TPRICE                      PIC  ZZZZZ.ZZ.           03181099
           05  FILLER                          PIC  X(03)  VALUE SPACE. 03190099
           05  DL1-RQTY                        PIC  ZZZ.                03200099
SR3403     05  FILLER                          PIC  X(01)  VALUE SPACE. 03211099
SR3403     05  DL1-RPRICE                      PIC  ZZZZZ.ZZ.           03221099
           05  FILLER                          PIC  X(03)  VALUE SPACE. 03230099
           05  DL1-VARIANCE                    PIC  X(11).              03240099
SR3403     05  FILLER                          PIC  X(01)  VALUE SPACE. 03251099
       01  ND-NO-DETAIL-LINE.                                           03260099
           05  FILLER                          PIC  X(35)  VALUE SPACE. 03270099
           05  FILLER                          PIC  X(50)  VALUE        03280099
             'NO DETAIL DISCREPANCIES EXIST FOR THIS TRANSFER'.         03290099
       01  BL-BLANK-LINE.                                               03300099
           05  FILLER                          PIC  X(80)  VALUE SPACE. 03310099
      ******************************************************************03320099
      **  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **03330099
      **  THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           **03340099
      **  APPLICATION-SPECIFIC COMMAREA.                              **03350099
      ******************************************************************03360099
       01  LQW-LIST-QUEUE-WORK-AREA.                                    03370099
           05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  03380099
           05  LQW-ITEM-ENTRIES               OCCURS 11 TIMES           03390099
                                              INDEXED BY LQW-IDX.       03400099
               10  LQW-LIST-ITEM-NUMBER                                 03410099
                                                           PIC S9(09)   03420099
                                                           COMP-3.      03430099
               10  LQW-TEMP-SELECTED-SW       PIC  X(01).               03440099
               10  LQW-SELECTED-SW            PIC  X(01).               03450099
                   88  LQW-SELECT                         VALUE 'S'.    03460099
                   88  LQW-DESELECT                       VALUE ' '.    03470099
               10  LQW-ACTION                 PIC  X(03).               03480099
               10  LQW-LINE-NBR               PIC S9(05)                03490099
                                                  COMP-3.               03500099
               10  LQW-DPT-CL-SUBCL.                                    03510099
                   15  LQW-DEPT               PIC 9(03).                03520099
                   15  LQW-CLASS              PIC 9(03).                03530099
                   15  LQW-SUBCLASS           PIC 9(03).                03540099
               10  LQW-UPC                    PIC 9(13).                03550099
               10  LQW-TQTY                   PIC 9(03).                03560099
               10  LQW-RQTY                   PIC 9(03).                03570099
SR3403         10  LQW-TPRICE                 PIC 9(05)V99.             03581099
SR3403         10  LQW-RPRICE                 PIC 9(05)V99.             03591099
SR3403         10  LQW-VARIANCE               PIC X(10).                03601099
           EJECT                                                        03610099
                                                                        03611099
      *----------------------------------------------------------------*03612099
      *  RF COPYBOOK TO FORMAT PRINTER DESTINATION                      03613099
      *----------------------------------------------------------------*03614099
080204     COPY RFWS009.                                                03615099
                                                                        03616099
      *---------------------------------------------------------------* 03620099
      *  RECORD LAYOUT FOR THE TRANSFER SELECTION TEMP STORAGE QUEUE. * 03630099
      *---------------------------------------------------------------* 03640099
                                                                        03650099
           COPY TFWS002.                                                03660099
                                                                        03670099
           EJECT                                                        03680099
      *---------------------------------------------------------------* 03690099
      *    MAP LAYOUT                                                 * 03700099
      *---------------------------------------------------------------* 03710099
                                                                        03720099
           COPY TFKM434.                                                03730099
      *                                                                 03740099
       01  MR-MAP-REDEFINITION                REDEFINES  TF434AO.       03750099
           05 FILLER                          PIC X(12).                03760099
      *                                                                 03770099
           05 MR-XFER-NBRL                    PIC S9(04) COMP.          03780099
           05 MR-XFER-NBRA                    PIC  X(01).               03790099
           05 MR-XFER-NBRC                    PIC  X(01).               03800099
           05 MR-XFER-NBRH                    PIC  X(01).               03810099
100404*    05 MR-XFER-NBR                     PIC X(10).                03820099
100404     05 MR-XFER-NBR                     PIC X(11).                03821099
      *                                                                 03830099
           05  MR-FROM-STORE-NBRL    PIC S9(04) COMP.                   03840099
           05  MR-FROM-STORE-NBRA    PIC  X(01).                        03850099
           05  MR-FROM-STORE-NBRC    PIC  X(01).                        03860099
           05  MR-FROM-STORE-NBRH    PIC  X(01).                        03870099
100404*    05  MR-FROM-STORE-NBR     PIC  9(03).                        03880099
100404     05  MR-FROM-STORE-NBR     PIC  9(04).                        03881099
      *                                                                 03890099
           05  MR-FROM-STORE-NAMEL   PIC S9(04) COMP.                   03900099
           05  MR-FROM-STORE-NAMEA   PIC  X(01).                        03910099
           05  MR-FROM-STORE-NAMEC   PIC  X(01).                        03920099
           05  MR-FROM-STORE-NAMEH   PIC  X(01).                        03930099
           05  MR-FROM-STORE-NAME    PIC  X(10).                        03940099
      *                                                                 03950099
           05  MR-NET-DISCREPL       PIC S9(04) COMP.                   03960099
           05  MR-NET-DISCREPA       PIC  X(01).                        03970099
           05  MR-NET-DISCREPC       PIC  X(01).                        03980099
           05  MR-NET-DISCREPH       PIC  X(01).                        03990099
           05  MR-NET-DISCREP        PIC  X(11).                        04000099
      *                                                                 04010099
           05  MR-TO-STORE-NBRL      PIC S9(04) COMP.                   04020099
           05  MR-TO-STORE-NBRA      PIC  X(01).                        04030099
           05  MR-TO-STORE-NBRC      PIC  X(01).                        04040099
           05  MR-TO-STORE-NBRH      PIC  X(01).                        04050099
100404*    05  MR-TO-STORE-NBR       PIC  9(03).                        04060099
100404     05  MR-TO-STORE-NBR       PIC  9(04).                        04061099
      *                                                                 04070099
           05  MR-TO-STORE-NAMEL     PIC S9(04) COMP.                   04080099
           05  MR-TO-STORE-NAMEA     PIC  X(01).                        04090099
           05  MR-TO-STORE-NAMEC     PIC  X(01).                        04100099
           05  MR-TO-STORE-NAMEH     PIC  X(01).                        04110099
           05  MR-TO-STORE-NAME      PIC  X(10).                        04120099
      *                                                                 04130099
           05  MR-RECV-STORE-NBRL    PIC S9(04) COMP.                   04140099
           05  MR-RECV-STORE-NBRA    PIC  X(01).                        04150099
           05  MR-RECV-STORE-NBRC    PIC  X(01).                        04160099
           05  MR-RECV-STORE-NBRH    PIC  X(01).                        04170099
100404*    05  MR-RECV-STORE-NBR     PIC  9(03).                        04180099
100404     05  MR-RECV-STORE-NBR     PIC  9(04).                        04181099
      *                                                                 04190099
           05  MR-RECV-STORE-NAMEL   PIC S9(04) COMP.                   04200099
           05  MR-RECV-STORE-NAMEA   PIC  X(01).                        04210099
           05  MR-RECV-STORE-NAMEC   PIC  X(01).                        04220099
           05  MR-RECV-STORE-NAMEH   PIC  X(01).                        04230099
           05  MR-RECV-STORE-NAME    PIC  X(10).                        04240099
      *                                                                 04250099
           05 MR-SEAL-LIT1L                   PIC S9(04) COMP.          04260099
           05 MR-SEAL-LIT1A                   PIC  X(01).               04270099
           05 MR-SEAL-LIT1C                   PIC  X(01).               04280099
           05 MR-SEAL-LIT1H                   PIC  X(01).               04290099
           05 MR-SEAL-LIT1                    PIC X(15).                04300099
      *                                                                 04310099
           05 MR-CMP-LG-SEAL1L                PIC S9(04) COMP.          04320099
           05 MR-CMP-LG-SEAL1A                PIC  X(01).               04330099
           05 MR-CMP-LG-SEAL1C                PIC  X(01).               04340099
           05 MR-CMP-LG-SEAL1H                PIC  X(01).               04350099
           05 MR-CMP-LG-SEAL1                 PIC X(07).                04360099
      *                                                                 04370099
           05 MR-RCV-LG-SEAL1L                PIC S9(04) COMP.          04380099
           05 MR-RCV-LG-SEAL1A                PIC  X(01).               04390099
           05 MR-RCV-LG-SEAL1C                PIC  X(01).               04400099
           05 MR-RCV-LG-SEAL1H                PIC  X(01).               04410099
           05 MR-RCV-LG-SEAL1                 PIC X(07).                04420099
      *                                                                 04430099
           05 MR-SEAL-LIT2L                   PIC S9(04) COMP.          04440099
           05 MR-SEAL-LIT2A                   PIC  X(01).               04450099
           05 MR-SEAL-LIT2C                   PIC  X(01).               04460099
           05 MR-SEAL-LIT2H                   PIC  X(01).               04470099
           05 MR-SEAL-LIT2                    PIC X(15).                04480099
      *                                                                 04490099
           05 MR-CMP-LG-SEAL2L                PIC S9(04) COMP.          04500099
           05 MR-CMP-LG-SEAL2A                PIC  X(01).               04510099
           05 MR-CMP-LG-SEAL2C                PIC  X(01).               04520099
           05 MR-CMP-LG-SEAL2H                PIC  X(01).               04530099
           05 MR-CMP-LG-SEAL2                 PIC X(08).                04540099
      *                                                                 04550099
           05 MR-RCV-LG-SEAL2L                PIC S9(04) COMP.          04560099
           05 MR-RCV-LG-SEAL2A                PIC  X(01).               04570099
           05 MR-RCV-LG-SEAL2C                PIC  X(01).               04580099
           05 MR-RCV-LG-SEAL2H                PIC  X(01).               04590099
           05 MR-RCV-LG-SEAL2                 PIC X(08).                04600099
      *                                                                 04610099
           05 MR-SEAL-LIT3L                   PIC S9(04) COMP.          04620099
           05 MR-SEAL-LIT3A                   PIC  X(01).               04630099
           05 MR-SEAL-LIT3C                   PIC  X(01).               04640099
           05 MR-SEAL-LIT3H                   PIC  X(01).               04650099
           05 MR-SEAL-LIT3                    PIC X(15).                04660099
      *                                                                 04670099
           05 MR-CMP-SM-SEALL                 PIC S9(04) COMP.          04680099
           05 MR-CMP-SM-SEALA                 PIC  X(01).               04690099
           05 MR-CMP-SM-SEALC                 PIC  X(01).               04700099
           05 MR-CMP-SM-SEALH                 PIC  X(01).               04710099
           05 MR-CMP-SM-SEAL                  PIC X(07).                04720099
      *                                                                 04730099
           05 MR-RCV-SM-SEALL                 PIC S9(04) COMP.          04740099
           05 MR-RCV-SM-SEALA                 PIC  X(01).               04750099
           05 MR-RCV-SM-SEALC                 PIC  X(01).               04760099
           05 MR-RCV-SM-SEALH                 PIC  X(01).               04770099
           05 MR-RCV-SM-SEAL                  PIC X(07).                04780099
      *                                                                 04790099
           05 MR-STARTL                       PIC S9(04) COMP.          04800099
           05 MR-STARTA                       PIC  X(01).               04810099
           05 MR-STARTC                       PIC  X(01).               04820099
           05 MR-STARTH                       PIC  X(01).               04830099
           05 MR-START                        PIC 9(05).                04840099
      *                                                                 04850099
           05 MR-ENDL                         PIC S9(04) COMP.          04860099
           05 MR-ENDA                         PIC  X(01).               04870099
           05 MR-ENDC                         PIC  X(01).               04880099
           05 MR-ENDH                         PIC  X(01).               04890099
           05 MR-END                          PIC 9(05).                04900099
      *                                                                 04910099
           05 MR-TOTALL                       PIC S9(04) COMP.          04920099
           05 MR-TOTALA                       PIC  X(01).               04930099
           05 MR-TOTALC                       PIC  X(01).               04940099
           05 MR-TOTALH                       PIC  X(01).               04950099
           05 MR-TOTAL                        PIC 9(05).                04960099
      *                                                                 04970099
           05  MR-SCROLL-AREA               OCCURS 11 TIMES.            04980099
               10 MR-SELECTL                  PIC S9(04) COMP.          04990099
               10 MR-SELECTA                  PIC  X(01).               05000099
               10 MR-SELECTC                  PIC  X(01).               05010099
               10 MR-SELECTH                  PIC  X(01).               05020099
               10 MR-SELECT                   PIC  X(01).               05030099
                                                                        05040099
               10 MR-ACTIONL                  PIC S9(04) COMP.          05050099
               10 MR-ACTIONA                  PIC  X(01).               05060099
               10 MR-ACTIONC                  PIC  X(01).               05070099
               10 MR-ACTIONH                  PIC  X(01).               05080099
               10 MR-ACTION                   PIC  X(03).               05090099
                                                                        05100099
               10 MR-LINE-NBRL                PIC S9(04) COMP.          05110099
               10 MR-LINE-NBRA                PIC  X(01).               05120099
               10 MR-LINE-NBRC                PIC  X(01).               05130099
               10 MR-LINE-NBRH                PIC  X(01).               05140099
               10 MR-LINE-NBR-X.                                        05150099
                  15 MR-LINE-NBR              PIC ZZ9.                  05160099
                                                                        05170099
               10 MR-DPT-CL-SUBCLL              PIC S9(04) COMP.        05180099
               10 MR-DPT-CL-SUBCLA              PIC  X(01).             05190099
               10 MR-DPT-CL-SUBCLC              PIC  X(01).             05200099
               10 MR-DPT-CL-SUBCLH              PIC  X(01).             05210099
               10 MR-DPT-CL-SUBCL               PIC  X(11).             05220099
                                                                        05230099
               10 MR-UPCL                     PIC S9(04) COMP.          05240099
               10 MR-UPCA                     PIC  X(01).               05250099
               10 MR-UPCC                     PIC  X(01).               05260099
               10 MR-UPCH                     PIC  X(01).               05270099
               10 MR-UPC                      PIC  X(16).               05280099
                                                                        05290099
               10 MR-TQTYL                    PIC S9(04) COMP.          05300099
               10 MR-TQTYA                    PIC  X(01).               05310099
               10 MR-TQTYC                    PIC  X(01).               05320099
               10 MR-TQTYH                    PIC  X(01).               05330099
               10 MR-TQTY-X.                                            05340099
                  15 MR-TQTY                  PIC  ZZZ.                 05350099
                                                                        05360099
               10 MR-TPRICEL                  PIC S9(04) COMP.          05370099
               10 MR-TPRICEA                  PIC  X(01).               05380099
               10 MR-TPRICEC                  PIC  X(01).               05390099
               10 MR-TPRICEH                  PIC  X(01).               05400099
               10 MR-TPRICE-X.                                          05410099
SR3403            15 MR-TPRICE                PIC  ZZZZZ.ZZ.            05421099
                                                                        05430099
               10 MR-RQTYL                    PIC S9(04) COMP.          05440099
               10 MR-RQTYA                    PIC  X(01).               05450099
               10 MR-RQTYC                    PIC  X(01).               05460099
               10 MR-RQTYH                    PIC  X(01).               05470099
               10 MR-RQTY-X.                                            05480099
                  15 MR-RQTY                  PIC  ZZZ.                 05490099
                                                                        05500099
               10 MR-RPRICEL                  PIC S9(04) COMP.          05510099
               10 MR-RPRICEA                  PIC  X(01).               05520099
               10 MR-RPRICEC                  PIC  X(01).               05530099
               10 MR-RPRICEH                  PIC  X(01).               05540099
               10 MR-RPRICE-X.                                          05550099
SR3403            15 MR-RPRICE                PIC  ZZZZZ.ZZ.            05561099
                                                                        05570099
               10 MR-VARIANCEL                PIC S9(04) COMP.          05580099
               10 MR-VARIANCEA                PIC  X(01).               05590099
               10 MR-VARIANCEC                PIC  X(01).               05600099
               10 MR-VARIANCEH                PIC  X(01).               05610099
SR3403         10 MR-VARIANCE                 PIC X(10).                05621099
           EJECT                                                        05630099
      *---------------------------------------------------------------* 05640099
      *    ATTRIBUTE SETTINGS COPYBOOK.                               * 05650099
      *---------------------------------------------------------------* 05660099
                                                                        05670099
           COPY DPWS015.                                                05680099
                                                                        05690099
      *---------------------------------------------------------------* 05700099
      *    FUNCTION KEYS COPYBOOK.                                    * 05710099
      *---------------------------------------------------------------* 05720099
                                                                        05730099
           COPY DPWS016.                                                05740099
                                                                        05750099
      *---------------------------------------------------------------* 05760099
      *    NUMERIC EDIT LAYOUT.                                       * 05770099
      *---------------------------------------------------------------* 05780099
                                                                        05790099
           COPY DPWS010I.                                               05800099
       EJECT                                                            05810099
      *---------------------------------------------------------------* 05820099
      *    PARAMETERS FOR CALLING THE CICS ARCHITECTURE API.          * 05830099
      *---------------------------------------------------------------* 05840099
                                                                        05850099
           COPY DPWS030.                                                05860099
CICS       COPY DPWS930.                                                05861099
       EJECT                                                            05870099
      *---------------------------------------------------------------* 05880099
      *    STANDARD COMMAREA.                                         * 05890099
      *---------------------------------------------------------------* 05900099
                                                                        05910099
           COPY DPWS020.                                                05920099
           05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                05930099
                                                                        05940099
      *---------------------------------------------------------------* 05950099
      * INTER-APPLICATION COMMAREA.                                   * 05960099
      *   TFWS001 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 05970099
      *             SPEC SCREEN.                                      * 05980099
      *   TFWS003 - IS THE OUTPUT LAYOUT PASSED FOR A LOCAL-GO        * 05990099
      *             FUNCTION.                                         * 06000099
      *---------------------------------------------------------------* 06010099
                                                                        06020099
               10  INTER-APPL-COMM-AREA       PIC X(200).               06030099
           COPY TFWS001.                                                06040099
           COPY TFWS003.                                                06050099
      *---------------------------------------------------------------* 06060099
      *  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 06070099
      *---------------------------------------------------------------* 06080099
               10  ASC-SPECIFIC-COMMAREA.                               06090099
                   15  ASC-INTER-APPL-CRITERIA.                         06100099
                       20  ASC-CRIT-INT-APPL-FORMAT-IND                 06110099
                                                 PIC X.                 06120099
100404*                20  ASC-CRIT-XFER-NBR-9   PIC 9(09).             06130099
100404                 20  ASC-CRIT-XFER-NBR-9   PIC 9(10).             06131099
                       20  ASC-CRIT-XFER-NBR                            06140099
                              REDEFINES ASC-CRIT-XFER-NBR-9.            06150099
100404*                    25  ASC-CRIT-XFER-FROM-STORE   PIC 9(03).    06160099
100404                     25  ASC-CRIT-XFER-FROM-STORE   PIC 9(04).    06161099
                           25  ASC-CRIT-XFER-SEQ-NBR      PIC 9(06).    06170099
                       20  ASC-CRIT-XFER-TYPE    PIC X(02).             06180099
                       20  ASC-CRIT-XFER-STAT    PIC X(02).             06190099
100404*>               20  ASC-CRIT-XFER-FROM    PIC 9(03).             06200099
100404*>               20  ASC-CRIT-XFER-FROM    PIC 9(04).             06201099
100404*>               20  ASC-CRIT-XFER-TO      PIC 9(03).             06210099
100404*>               20  ASC-CRIT-XFER-TO      PIC 9(04).             06211099
                       20  ASC-CRIT-COMP-FROM-DATE                      06220099
                                                 PIC X(08).             06230099
                       20  ASC-CRIT-COMP-TO-DATE                        06240099
                                                 PIC X(08).             06250099
                       20  ASC-CRIT-RECV-FROM-DATE                      06260099
                                                 PIC X(08).             06270099
                       20  ASC-CRIT-RECV-TO-DATE                        06280099
                                                 PIC X(08).             06290099
                       20  ASC-CRIT-DEPT         PIC X(03).             06300099
                       20  ASC-CRIT-CLASS        PIC X(03).             06310099
                       20  ASC-CRIT-UPC          PIC X(13).             06311099
                       20  ASC-CRIT-CALLBACK-NBR PIC 9(04).             06320099
                       20  ASC-CRIT-APPROVAL-NBR PIC 9(09).             06330099
                       20  ASC-CRIT-COMP-BY-INIT PIC X.                 06340099
                       20  ASC-CRIT-COMP-BY-NM   PIC X(20).             06350099
                       20  ASC-CRIT-RECV-BY-INIT PIC X.                 06360099
                       20  ASC-CRIT-RECV-BY-NM   PIC X(20).             06370099
                       20  ASC-CRIT-DISPLAY-TOT  PIC X.                 06380099
                       20  ASC-CRIT-CRIT-SORT-ORDER.                    06390099
                           25 ASC-CRIT-TYPE-SORT-NR       PIC 9(01).    06400099
                           25 ASC-CRIT-STATUS-SORT-NR     PIC 9(01).    06410099
                           25 ASC-CRIT-FROM-STR-SORT-NR PIC 9(01).      06420099
                           25 ASC-CRIT-TO-STR-SORT-NR     PIC 9(01).    06430099
                           25 ASC-CRIT-COMP-DTE-SORT-NR PIC 9(01).      06440099
                           25 ASC-CRIT-RECV-DTE-SORT-NR PIC 9(01).      06450099
                           25 ASC-CRIT-CALLBCK-NR-SORT-NR               06460099
                                                      PIC 9(01).        06470099
                           25 ASC-CRIT-APPRV-NR-SORT-NR PIC 9(01).      06480099
                           25                             PIC X(03).    06490099
                       20  ASC-CRIT-ORIG-APPL-FORMAT-IND                06500099
                                                 PIC X.                 06510099
                   15  ASC-PRINT-REQUEST-SW      PIC X(01).             06520099
                       88  ASC-PRINT-LIST-REQUEST       VALUE 'L'.      06530099
                       88  ASC-NO-PRINT-REQUEST         VALUE 'N'.      06540099
                   15  ASC-DISCREPANCY-SW        PIC X(01).             06550099
                       88  ASC-DISCREPANCY-EXISTS       VALUE 'Y'.      06560099
                       88  ASC-NO-DISCREPANCY-EXISTS    VALUE 'N'.      06570099
                   15  ASC-REDIRECT-SW           PIC X(01).             06580099
                       88  ASC-XFER-WAS-REDIRECTED      VALUE 'Y'.      06590099
                       88  ASC-XFER-WAS-NOT-REDIRECTED  VALUE 'N'.      06600099
                   15  ASC-XFER-STATUS           PIC X(02).             06610099
                   15  ASC-XFER-STATUS-DESC      PIC X(20).             06620099
                   15  ASC-NET-DISCREPANCY       PIC X(11).             06630099
                   15  ASC-XFER-TYPE             PIC 9(02).             06640099
                   15  ASC-XFER-DKEY-ID          PIC S9(09) COMP.       06650099
                   15  ASC-XFER-DESC             PIC X(19).             06660099
                   15  ASC-XFER-NBR.                                    06670099
100404*                20  ASC-FROM-STORE-NBR              PIC 9(03).   06680099
100404                 20  ASC-FROM-STORE-NBR              PIC 9(04).   06681099
                       20  ASC-XFER-SEQ-NBR                PIC 9(06).   06690099
                   15  ASC-FROM-STORE-NAME                 PIC X(10).   06700099
100404*            15  ASC-TO-STORE-NBR                    PIC 9(03).   06710099
100404             15  ASC-TO-STORE-NBR                    PIC 9(04).   06711099
                   15  ASC-TO-STORE-NAME                   PIC X(10).   06720099
100404*            15  ASC-RECV-STORE-NBR                  PIC 9(03).   06730099
100404             15  ASC-RECV-STORE-NBR                  PIC 9(04).   06731099
                   15  ASC-RECV-STORE-NAME                 PIC X(10).   06740099
                   15  ASC-CONTNR-TYP-CDE                  PIC X(02).   06750099
                   15  ASC-XFER-LG-SEAL1-TRLR              PIC X(07).   06760099
                   15  ASC-XFER-LG-SEAL2-TRLR              PIC X(08).   06770099
                   15  ASC-XFER-SM-SEAL                    PIC X(07).   06780099
                   15  ASC-RECV-LG-SEAL1-TRLR              PIC X(07).   06790099
                   15  ASC-RECV-LG-SEAL2-TRLR              PIC X(08).   06800099
                   15  ASC-RECV-SM-SEAL                    PIC X(07).   06810099
                   15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                06820099
                       20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  06830099
                           88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   06840099
                           88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   06850099
                                                                        06860099
                       20  ASC-ITEM-ARRAY.                              06870099
                           25  ASC-ITEM-ENTRIES OCCURS 11 TIMES.        06880099
                               30  ASC-LIST-ITEM-NUMBER                 06890099
                                                           PIC S9(09)   06900099
                                                           COMP-3.      06910099
                               30  ASC-TEMP-SELECTED-SW    PIC  X(01).  06920099
                                   88  ASC-VALID-SELECT    VALUE ' '    06930099
                                                                 'S'    06940099
                                                                 'B'    06950099
                                                                 'E'.   06960099
                                   88  ASC-TEMP-NO-SELECT  VALUE ' '.   06970099
                                   88  ASC-TEMP-SELECT     VALUE 'S'.   06980099
                                   88  ASC-TEMP-BEGIN      VALUE 'B'.   06990099
                                   88  ASC-TEMP-END        VALUE 'E'.   07000099
                               30  ASC-SELECTED-SW         PIC  X(01).  07010099
                                   88  ASC-NO-SELECT       VALUE ' '.   07020099
                                   88  ASC-SELECT          VALUE 'S'.   07030099
                                   88  ASC-BEGIN           VALUE 'B'.   07040099
                                   88  ASC-END             VALUE 'E'.   07050099
                               30  ASC-ACTION              PIC  X(03).  07060099
                               30  ASC-LINE-NBR            PIC S9(05)   07070099
                                                                COMP-3. 07080099
                               30  ASC-DPT-CL-SUBCL.                    07090099
                                   35  ASC-DEPT            PIC 9(03).   07100099
                                   35  ASC-CLASS           PIC 9(03).   07110099
                                   35  ASC-SUBCLASS        PIC 9(03).   07120099
                               30  ASC-UPC-X.                           07130099
                                   35  ASC-UPC             PIC 9(13).   07140099
                               30  ASC-TQTY-X.                          07150099
                                   35  ASC-TQTY            PIC 9(03).   07160099
                               30  ASC-RQTY-X.                          07170099
                                   35  ASC-RQTY            PIC 9(03).   07180099
                               30  ASC-TPRICE-X.                        07190099
SR3403                             35  ASC-TPRICE          PIC 9(05)V99.07201099
                               30  ASC-RPRICE-X.                        07210099
SR3403                             35  ASC-RPRICE          PIC 9(05)V99.07221099
SR3403                         30  ASC-VARIANCE            PIC X(10).   07231099
                                                                        07240099
                   15  ASC-BLK-SUB                         PIC S9(04)   07250099
                                                                COMP    07260099
                                                                SYNC.   07270099
                   15  ASC-ITEM-SUB                        PIC S9(04)   07280099
                                                                COMP    07290099
                                                                SYNC.   07300099
                   15  ASC-NUMBER-OF-ITEMS-READ            PIC S9(09)   07310099
                                                                COMP-3. 07320099
                   15  ASC-NUMBER-OF-SELECTED-ITEMS        PIC S9(09)   07330099
                                                                COMP-3. 07340099
                   15  ASC-ITEMS-DISPLAYED                 PIC S9(03)   07350099
                                                                COMP-3. 07360099
                   15  ASC-ITEM-AT-TOP-OF-PANEL            PIC S9(09)   07370099
                                                                COMP-3. 07380099
                   15  ASC-ITEM-AT-BOT-OF-PANEL            PIC S9(09)   07390099
                                                                COMP-3. 07400099
                   15  ASC-HIGHEST-BLOCK-WRITTEN           PIC S9(04)   07410099
                                                                COMP    07420099
                                                                SYNC.   07430099
                   15  ASC-START-OF-SELECTED-RANGE         PIC S9(09)   07440099
                                                                COMP-3. 07450099
                   15  ASC-END-OF-SELECTED-RANGE           PIC S9(09)   07460099
                                                                COMP-3. 07470099
                   15  ASC-ITEMS-LEFT-INDICATOR            PIC  X(01).  07480099
                       88  ASC-ITEMS-LEFT-ON-DB            VALUE 'Y'.   07490099
                       88  ASC-NO-ITEMS-LEFT-ON-DB         VALUE 'N'.   07500099
                   15  ASC-ITEMS-LEFT-INDICATOR-2          PIC  X(01).  07510099
                       88  ASC-ITEMS-LEFT-ON-DB-2          VALUE 'Y'.   07520099
                       88  ASC-NO-ITEMS-LEFT-ON-DB-2       VALUE 'N'.   07530099
                   15  ASC-TEMP-QUEUE-UPDATE-SW            PIC  X(01).  07540099
                       88  ASC-UPDATE-TSQ                  VALUE 'Y'.   07550099
                       88  ASC-NO-TSQ-UPDATE               VALUE ' '.   07560099
                   15  ASC-LIST-QUEUE-NAME.                             07570099
                       20  ASC-LIST-TERM-ID                PIC  X(04).  07580099
                       20  ASC-LIST-TASK-NUMBER            PIC S9(05)   07590099
                                                                COMP-3. 07600099
                       20  ASC-LIST-SEQ                    PIC  9(01).  07610099
                   15  ASC-SEL-QUEUE-NAME.                              07620099
                       20  ASC-SEL-TERM-ID                 PIC  X(04).  07630099
                       20  ASC-SEL-TASK-NUMBER             PIC S9(05)   07640099
                                                                COMP-3. 07650099
                       20  ASC-SEL-SEQ                     PIC  9(01).  07660099
                                                                        07670099
                   15  ASC-START-ITEM-REQUEST.                          07680099
                       20  ASC-START-ITEM-REQUEST-N        PIC  9(05).  07690099
           EJECT                                                        07700099
      *                                                                 07710099
      *  LAYOUT FOR THE DRS (DYNAMIC REPORT SYSTEM) COMMAREA            07720099
      *                                                                 07730099
           COPY DRRD001O.                                               07740099
                                                                        07750099
      *                                                                 07760099
      *  LAYOUT FOR THE DRS (DYNAMIC REPORT SYSTEM) DETAIL LINES        07770099
      *                                                                 07780099
           COPY DRRD002O.                                               07790099
                                                                        07800099
           EJECT                                                        07810099
      *---------------------------------------------------------------* 07820099
      *    ABEND PROCESSING COPYBOOK.                                 * 07830099
      *---------------------------------------------------------------* 07840099
                                                                        07850099
           COPY DPWS013.                                                07860099
                                                                        07870099
       EJECT                                                            07880099
      *---------------------------------------------------------------* 07890099
      *    DB2 AREA FOR THE TRANSFER TABLE                            * 07900099
      *---------------------------------------------------------------* 07910099
           EXEC SQL                                                     07920099
                INCLUDE TTFMSTR                                         07930099
           END-EXEC.                                                    07940099
      *---------------------------------------------------------------* 07950099
      *    DB2 AREA FOR THE TRANSFER ITEM TABLE                       * 07960099
      *---------------------------------------------------------------* 07970099
           EXEC SQL                                                     07980099
                INCLUDE TTFITEM                                         07990099
           END-EXEC.                                                    08000099
      *---------------------------------------------------------------* 08010099
      *    DB2 AREA FOR THE TRANSFER ITEM RECEIPT TABLE               * 08020099
      *---------------------------------------------------------------* 08030099
           EXEC SQL                                                     08040099
                INCLUDE TTFITRC                                         08050099
           END-EXEC.                                                    08060099
      *---------------------------------------------------------------* 08070099
      *    DB2 AREA FOR THE TRANSFER STATUS TABLE                     * 08080099
      *---------------------------------------------------------------* 08090099
           EXEC SQL                                                     08100099
                INCLUDE TTFSTAT                                         08110099
           END-EXEC.                                                    08120099
      *---------------------------------------------------------------* 08130099
      *    DB2 AREA FOR THE TRANSFER ADJUSTMENT REASON CODE TABLE.    * 08140099
      *---------------------------------------------------------------* 08150099
           EXEC SQL                                                     08160099
                INCLUDE TTFAJRS                                         08170099
           END-EXEC.                                                    08180099
      *---------------------------------------------------------------* 08190099
      *    DB2 AREA FOR THE TRANSFER ITEM POSTING TABLE.              * 08200099
      *---------------------------------------------------------------* 08210099
           EXEC SQL                                                     08220099
                INCLUDE TTFITPS                                         08230099
           END-EXEC.                                                    08240099
      *---------------------------------------------------------------* 08250099
      *    DB2 AREA FOR THE TRANSFER RECEIPT TABLE                    * 08260099
      *---------------------------------------------------------------* 08270099
           EXEC SQL                                                     08280099
                INCLUDE TTFRCPT                                         08290099
           END-EXEC.                                                    08300099
      *---------------------------------------------------------------* 08310099
      *    DB2 AREA FOR THE TRANSFER DISCREPANCY TABLE                * 08320099
      *---------------------------------------------------------------* 08330099
           EXEC SQL                                                     08340099
                INCLUDE TTFDSCP                                         08350099
           END-EXEC.                                                    08360099
      *---------------------------------------------------------------* 08370099
      *    DB2 AREA FOR THE XST_LOC TABLE                             * 08380099
      *---------------------------------------------------------------* 08390099
           EXEC SQL                                                     08400099
                INCLUDE XST00001                                        08410099
           END-EXEC.                                                    08420099
      *---------------------------------------------------------------* 08421099
      *    DB2 AREA FOR THE SKU CROSS REFERENCE TABLE                 * 08422099
      *---------------------------------------------------------------* 08423099
           EXEC SQL                                                     08424099
                INCLUDE TSKXREF                                         08425099
           END-EXEC.                                                    08426099
      *---------------------------------------------------------------* 08430099
      *    DB2 AREA FOR COMMUNICATIONS                                * 08440099
      *---------------------------------------------------------------* 08450099
           EXEC SQL                                                     08460099
                INCLUDE SQLCA                                           08470099
           END-EXEC.                                                    08480099
                                                                        08490099
      *---------------------------------------------------------------* 08500099
      *    DISCREPANCY CURSOR                                         * 08510099
      *---------------------------------------------------------------* 08520099
                                                                        08530099
           EXEC SQL                                                     08540099
                DECLARE DISCREP-CSR CURSOR                              08550099
                FOR SELECT  DISTINCT                                    08560099
                      I.XFER_LNE_NBR                                    08570099
                    , KOHLS_UPC_NBR                                     08610099
                    , XFER_PRIC_AMT                                     08620099
                    , XFER_QTY                                          08630099
                    , I.ITM_NBR                                         08631099
                FROM                                                    08640099
                      TTFITEM I                                         08650099
                    , TTFITRC R                                         08660099
                    , TTFSTAT S                                         08670099
                WHERE                                                   08680099
                      I.XFER_DKEY_ID    = :DK-XFER-DKEY-ID        AND   08690099
                      R.XFER_DKEY_ID    = :DK-XFER-DKEY-ID        AND   08700099
                      S.XFER_DKEY_ID    = :DK-XFER-DKEY-ID        AND   08710099
                      S.XFER_STAT_CDE   = :PC-POSITIVE-RECEIPT    AND   08720099
                      S.XFER_STAT_TMST  = R.XFER_RCPT_TMST        AND   08730099
                      R.XFER_LNE_NBR    = I.XFER_LNE_NBR          AND   08740099
                      R.XFER_ITM_DSCRP_IND = 'Y'                        08750099
                ORDER BY                                                08760099
                      I.XFER_LNE_NBR                                    08770099
100404          WITH UR                                                 08771099
           END-EXEC.                                                    08780099
                                                                        08790099
      *---------------------------------------------------------------* 08800099
      *    CURSOR TO RETRIEVE TRANSFER RECEIPT ITEMS                  * 08810099
      *---------------------------------------------------------------* 08820099
                                                                        08830099
           EXEC SQL                                                     08840099
                DECLARE XFER-RECEIPT-CSR CURSOR                         08850099
                FOR SELECT                                              08860099
                      RCVD_XFER_PRIC_AMT                                08870099
                    , RCVD_XFER_QTY                                     08880099
                FROM                                                    08890099
                      TTFITRC I                                         08900099
                     ,TTFSTAT S                                         08910099
                WHERE                                                   08920099
                      I.XFER_DKEY_ID     = :DK-XFER-DKEY-ID        AND  08930099
                      S.XFER_DKEY_ID     = :DK-XFER-DKEY-ID        AND  08940099
                      S.XFER_STAT_CDE    = :PC-POSITIVE-RECEIPT    AND  08950099
                      S.XFER_STAT_TMST   = I.XFER_RCPT_TMST        AND  08960099
                      RCVD_XFER_PRIC_AMT <> :TFITEM-XFER-PRIC-AMT  AND  08970099
                      XFER_LNE_NBR       = :TFITEM-XFER-LNE-NBR         08980099
                ORDER BY                                                08990099
                      RCVD_XFER_PRIC_AMT                                09000099
100404          WITH UR                                                 09001099
           END-EXEC.                                                    09010099
                                                                        09020099
       EJECT                                                            09030099
       LINKAGE SECTION.                                                 09040099
                                                                        09050099
       01  DFHCOMMAREA.                                                 09060099
           05  FILLER                         OCCURS  1 TO 4072 TIMES   09070099
                                              DEPENDING ON EIBCALEN.    09080099
               10  FILLER                     PIC X.                    09090099
                                                                        09100099
       EJECT                                                            09110099
       PROCEDURE DIVISION.                                              09120099
      ******************************************************************09130099
      **  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **09140099
      **  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **09150099
      **  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **09160099
      ******************************************************************09170099
       0000-MAIN-MODULE.                                                09180099
           INITIALIZE DP030-CICS-API-FIELDS.                            09190099
           MOVE +1                       TO DP030-NUMBER-OF-MAPS.       09200099
           MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          09210099
           MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         09220099
           SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       09230099
           MOVE LENGTH OF TF434AI        TO DP030-MAP-LENGTH (1).       09240099
           MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     09250099
           PERFORM 0001-CALL-CICS-ARCH-API.                             09260099
      *                                                                 09270099
           PERFORM 1000-CONTROL-PROCESSING                              09280099
      *                                                                 09290099
           MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     09300099
           PERFORM 0001-CALL-CICS-ARCH-API.                             09310099
                                                                        09320099
      ******************************************************************09330099
      **  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **09340099
      **  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **09350099
      ******************************************************************09360099
       0001-CALL-CICS-ARCH-API.                                         09370099
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      09380099
                                          DFHCOMMAREA                   09390099
                                          DP030-CICS-API-FIELDS         09400099
                                          DP020-STANDARD-COMMAREA       09410099
                                          TF434AI.                      09420099
      *                                                                 09430099
           IF  DP030-RC-CALL-SUCCESSFUL                                 09440099
               CONTINUE                                                 09450099
           ELSE                                                         09460099
               SET DP013-NO-ROLLBACK                                    09470099
                   DP013-XCTL-DISPLAY-RESTART                           09480099
                   DP013-CICS-ABEND      TO TRUE                        09490099
               MOVE '0001-CALL-CICS-ARCH-API'                           09500099
                                         TO DP013-PARAGRAPH             09510099
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O09511099
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      09512099
               MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      09540099
               PERFORM DP013-0000-PROCESS-ABEND                         09550099
           END-IF.                                                      09560099
      *----------------------------------------------------------------*09570099
      * PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *09580099
      * COURSE OF ACTION IS FOR THIS TRANSACTION.                      *09590099
      *                                                                *09600099
      * NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *09610099
      *  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *09620099
      *  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *09630099
      *  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *09640099
      *----------------------------------------------------------------*09650099
                                                                        09660099
       1000-CONTROL-PROCESSING.                                         09670099
                                                                        09680099
           EVALUATE TRUE                                                09690099
               WHEN DP020-NEXT-ACT-INITIAL                              09700099
                   INITIALIZE ASC-SPECIFIC-COMMAREA                     09710099
                   MOVE EIBTRMID         TO ASC-LIST-TERM-ID            09720099
                                            ASC-SEL-TERM-ID             09730099
                   MOVE DP020-SRC-TASK-NUMBER                           09740099
                                         TO ASC-LIST-TASK-NUMBER        09750099
                                            ASC-SEL-TASK-NUMBER         09760099
                   MOVE PC-LIST-QUEUE-SEQ                               09770099
                                         TO ASC-LIST-SEQ                09780099
                   MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                 09790099
                   PERFORM 1100-PROCESS-INTER-APPL-COMM                 09800099
      ***-----$TEMPLATE NOTE$-------------------------------------------09810099
      *** IF THE DATA EXPECTED IS NOT RECEIVED FROM CALLING APPLICATION,09820099
      *** SETUP APPROPRIATE MESSAGE AND SEVERITY AND SET APPL-ERROR TO  09830099
      *** TRUE, THIS WILL RETURN TO CALLING APPLICATION WHEN API CALLED.09840099
      ***---------------------------------------------------------------09850099
                   IF  PS-COMMAREA-NOT-VALID                            09860099
      ***              MOVE PC-TSYMSG-99901                             09870099
      ***                                TO DP020-MSG-NUMBER            09880099
      ***              SET DP020-MSG-FATAL                              09890099
      ***                                TO TRUE                        09900099
                       SET DP020-NEXT-ACT-APPL-ERROR                    09910099
                                         TO TRUE                        09920099
                   ELSE                                                 09930099
                       SET PS-TRANSFER-NOT-FOUND  TO TRUE               09940099
                       PERFORM 4100-GET-TRANSFER                        09950099
                       IF PS-TRANSFER-FOUND                             09960099
                           PERFORM 4000-BUILD-INITIAL-PANEL             09970099
                       ELSE                                             09980099
                           MOVE PC-TSYMSG-00148                         09990099
                                     TO DP020-MSG-NUMBER                10000099
                           SET DP020-MSG-FATAL                          10010099
                           DP020-NEXT-ACT-APPL-ERROR  TO TRUE           10020099
                       END-IF                                           10030099
                   END-IF                                               10040099
                                                                        10050099
               WHEN DP020-NEXT-ACT-READ-MAP                             10060099
                   MOVE ASC-ITEM-AT-TOP-OF-PANEL                        10070099
                                         TO PV-TOP-ITEM                 10080099
                   PERFORM 2000-PROCESS-PANEL                           10090099
      *                                                                 10100099
      *  IF RETURN IS FROM THE PRINTER SELECTION SCREEN AND REPORT      10110099
      *  PRINT WAS REQUESTED, GENERATE THE DRS REPORT                   10120099
      *                                                                 10130099
               WHEN DP020-NEXT-ACT-RETURN                               10140099
                   IF ASC-PRINT-LIST-REQUEST        AND                 10150099
                         TF001-PRINT-YES            AND                 10160099
                         TF001-PRINTER-DEST NOT = SPACES                10170099
                       PERFORM 6300-PRINT-LIST                          10180099
                       MOVE PC-TSYMSG-00098                             10190099
                                         TO DP020-MSG-NUMBER            10200099
                       SET DP020-MSG-INFORMATIONAL  TO TRUE             10210099
                   END-IF                                               10220099
                   SET ASC-NO-PRINT-REQUEST         TO TRUE             10230099
                   MOVE ASC-ITEM-AT-TOP-OF-PANEL                        10240099
                                         TO PV-TOP-ITEM                 10250099
                   MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    10260099
                   PERFORM 6000-REFRESH-PANEL-FROM-TEMP                 10270099
                   PERFORM 3000-EDIT-DATA-IN-COMMAREA                   10280099
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10290099
                                                                        10300099
               WHEN OTHER                                               10310099
                   SET DP013-LOGIC-ABEND TO TRUE                        10320099
                   SET DP013-NO-ROLLBACK TO TRUE                        10330099
                   MOVE '1000-CONTROL-PROCESSING'                       10340099
                                         TO DP013-PARAGRAPH             10350099
                   MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    10360099
                                         TO DP013-MESSAGE-TEXT(1)       10370099
                   PERFORM DP013-0000-PROCESS-ABEND                     10380099
           END-EVALUATE.                                                10390099
                                                                        10400099
       EJECT                                                            10410099
      *----------------------------------------------------------------*10420099
      * DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *10430099
      * IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *10440099
      *----------------------------------------------------------------*10450099
                                                                        10460099
       1100-PROCESS-INTER-APPL-COMM.                                    10470099
                                                                        10480099
           SET PS-COMMAREA-VALID         TO TRUE.                       10490099
           MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     10500099
      *    IF  DP020-INT-APPL-FORMAT-IND = PC-CRIT-SPEC-FORMAT          10510099
           MOVE TF001-INTER-APPL-COMMAREA                               10520099
                                         TO ASC-INTER-APPL-CRITERIA     10530099
           MOVE TF001-DKEY-ID                                           10540099
                                         TO ASC-XFER-DKEY-ID            10550099
                                            DK-XFER-DKEY-ID.            10560099
      *    ELSE                                                         10570099
      *        IF  DP020-NAV-KEY-DATA > SPACE                           10580099
      *            MOVE DP020-NAV-KEY-DATA                              10590099
      *                                  TO DK-MESSAGE-TEXT             10600099
      *                                     ASC-KEY-MESSAGE-TEXT        10610099
      *        END-IF                                                   10620099
      *    END-IF.                                                      10630099
                                                                        10640099
       EJECT                                                            10650099
      *----------------------------------------------------------------*10660099
      * DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *10670099
      * ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *10680099
      * USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *10690099
      * OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *10700099
      * FUNCTION KEYS CAN GET THIS FAR.                                *10710099
      *----------------------------------------------------------------*10720099
                                                                        10730099
       2000-PROCESS-PANEL.                                              10740099
           EVALUATE TRUE                                                10750099
               WHEN DP020-SRC-AID = DP016-CLEAR                         10760099
                   MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    10770099
                   PERFORM 3000-EDIT-DATA-IN-COMMAREA                   10780099
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10790099
                                                                        10800099
               WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    10810099
                   MOVE ASC-XFER-DKEY-ID                                10820099
                                         TO DK-XFER-DKEY-ID             10830099
                   PERFORM 2050-DELETE-LIST-QUEUE                       10840099
                   PERFORM 4000-BUILD-INITIAL-PANEL                     10850099
                                                                        10860099
               WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    10870099
                   PERFORM 2140-DESELECT-ALL-ITEMS                      10880099
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10890099
                                                                        10900099
               WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  10910099
                   PERFORM 2150-SELECT-ALL-ITEMS                        10920099
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10930099
                                                                        10940099
               WHEN OTHER                                               10950099
                   PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 10960099
                   PERFORM 3000-EDIT-DATA-IN-COMMAREA                   10970099
                   IF  PS-NO-ERROR                                      10980099
                       SET DP030-CONTINUE-GO                            10990099
                                       TO TRUE                          11000099
                       PERFORM 2100-CHECK-FUNCTION-KEY                  11010099
                   ELSE                                                 11020099
                       SET DP030-OVERRIDE-GO                            11030099
                                       TO TRUE                          11040099
                       PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             11050099
                   END-IF                                               11060099
           END-EVALUATE.                                                11070099
       EJECT                                                            11080099
      *----------------------------------------------------------------*11090099
      *  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *11100099
      *----------------------------------------------------------------*11110099
       2050-DELETE-LIST-QUEUE.                                          11120099
                                                                        11130099
           EXEC CICS                                                    11140099
               DELETEQ TS                                               11150099
                   QUEUE (ASC-LIST-QUEUE-NAME)                          11160099
                   RESP  (PV-CICS-RESP)                                 11170099
           END-EXEC.                                                    11180099
                                                                        11190099
           IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       11200099
              (PV-CICS-RESP = DFHRESP(QIDERR))                          11210099
               CONTINUE                                                 11220099
           ELSE                                                         11230099
               SET DP013-CICS-ABEND      TO TRUE                        11240099
               SET DP013-NO-ROLLBACK     TO TRUE                        11250099
                                                                        11260099
               MOVE '2050-DELETE-LIST-QUEUE'                            11270099
                                         TO DP013-PARAGRAPH             11280099
               MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    11290099
                                         TO DP013-MESSAGE-TEXT (1)      11300099
               PERFORM DP013-0000-PROCESS-ABEND                         11310099
           END-IF.                                                      11320099
                                                                        11330099
           MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  11340099
       EJECT                                                            11350099
      *----------------------------------------------------------------*11360099
      * ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*11370099
      * NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *11380099
      * CICS ARCHITECTURE API.                                         *11390099
      *----------------------------------------------------------------*11400099
       2100-CHECK-FUNCTION-KEY.                                         11410099
           EVALUATE TRUE                                                11420099
                                                                        11430099
      *---  HDR INQ  -----------------------------------------------*   11440099
               WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              11450099
                   SET DP030-CONTINUE-GO TO TRUE                        11460099
                   INITIALIZE TF001-INTER-APPL-COMMAREA                 11470099
                   MOVE ASC-INTER-APPL-CRITERIA                         11480099
                                         TO TF001-INTER-APPL-COMMAREA   11490099
                   MOVE ASC-XFER-NBR     TO TF001-XFER-NBR              11500099
                                                                        11510099
      *---  ITEM INQ  ----------------------------------------------*   11520099
               WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              11530099
                   SET DP030-CONTINUE-GO TO TRUE                        11540099
                   INITIALIZE TF001-INTER-APPL-COMMAREA                 11550099
                   MOVE ASC-INTER-APPL-CRITERIA                         11560099
                                         TO TF001-INTER-APPL-COMMAREA   11570099
                   MOVE ASC-XFER-NBR     TO TF001-XFER-NBR              11580099
                                                                        11590099
      *---  LINE DTL  ----------------------------------------------*   11600099
               WHEN DP020-FK-LOCAL-FUNC-03(DP020-SRC-AID)               11610099
                   IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              11620099
                       INITIALIZE TF003-INTER-APPL-COMMAREA             11630099
                       MOVE ASC-NUMBER-OF-SELECTED-ITEMS                11640099
                                      TO TF003-NUMBER-OF-SELECTED-ITEMS 11650099
                       MOVE ASC-XFER-DKEY-ID                            11660099
                                      TO TF003-XFER-DKEY-ID             11670099
                       PERFORM 5000-PREPARE-SEL-QUEUE                   11680099
                   ELSE                                                 11690099
                       SET DP030-OVERRIDE-GO                            11700099
                                         TO TRUE                        11710099
                       MOVE PC-TSYMSG-00057                             11720099
                                         TO DP020-MSG-NUMBER            11730099
                       SET DP020-MSG-WARNING                            11740099
                                         TO TRUE                        11750099
                       PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             11760099
                   END-IF                                               11770099
                                                                        11780099
      *---  PRINT LIST  --------------------------------------------*   11790099
      *  INTER-APPLICATION COMMAREA IS SETUP TO PASS THE DEFAULT STORE  11800099
      *  PRINTER DESTINATION TO THE PRINTER SELECTION SCREEN            11810099
      *                                                                 11820099
               WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              11830099
                   SET ASC-PRINT-LIST-REQUEST TO TRUE                   11840099
                   INITIALIZE TF001-DRS-DATA                            11850099
080204             MOVE DP020-LOCATION-NBR    TO RFWS009-STORE-NBR      11871099
080204             MOVE RFWS009-STORE-PRINTER-DEST                      11873099
080204                                        TO TF001-PRINTER-DEST     11874099
                                                                        11880099
               WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  11890099
                   MOVE +1               TO PV-TOP-ITEM                 11900099
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11910099
                                                                        11920099
               WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   11930099
                   PERFORM 2110-BROWSE-BACKWARD                         11940099
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11950099
                                                                        11960099
               WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   11970099
                   PERFORM 2120-BROWSE-FORWARD                          11980099
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11990099
                                                                        12000099
               WHEN DP020-SRC-AID = DP016-ENTER                         12010099
                   PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   12020099
                   IF  PS-ERROR                                         12030099
                       CONTINUE                                         12040099
                   ELSE                                                 12050099
                       PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             12060099
                   END-IF                                               12070099
                                                                        12080099
               WHEN OTHER                                               12090099
                   SET DP013-NO-ROLLBACK                                12100099
                       DP013-XCTL-DISPLAY-RESTART                       12110099
                       DP013-CICS-ABEND  TO TRUE                        12120099
                   MOVE '2100-CHECK-FUNCTION-KEY'                       12130099
                                         TO DP013-PARAGRAPH             12140099
                   MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      12150099
                                         TO DP013-MESSAGE-TEXT (1)      12160099
                   PERFORM DP013-0000-PROCESS-ABEND                     12170099
           END-EVALUATE.                                                12180099
      *                                                                 12190099
      *----------------------------------------------------------------*12200099
      *    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *12210099
      *    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *12220099
      *    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *12230099
      *    MESSAGE.                                                    *12240099
      *----------------------------------------------------------------*12250099
                                                                        12260099
       2110-BROWSE-BACKWARD.                                            12270099
           SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    12280099
               GIVING PV-TOP-ITEM.                                      12290099
      *                                                                 12300099
           IF  ((PV-TOP-ITEM < +1)                                      12310099
             OR (PV-TOP-ITEM = +1))                                     12320099
               MOVE +1                   TO PV-TOP-ITEM                 12330099
      *        -- TOP OF LIST --                                        12340099
               MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            12350099
               SET DP020-MSG-INFORMATIONAL TO TRUE                      12360099
           END-IF.                                                      12370099
                                                                        12380099
       EJECT                                                            12390099
      *----------------------------------------------------------------*12400099
      *    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *12410099
      *    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *12420099
      *    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *12430099
      *----------------------------------------------------------------*12440099
                                                                        12450099
       2120-BROWSE-FORWARD.                                             12460099
                                                                        12470099
           ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              12480099
               GIVING PV-TOP-ITEM.                                      12490099
           IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   12500099
               MOVE ASC-ITEM-AT-TOP-OF-PANEL                            12510099
                                         TO PV-TOP-ITEM                 12520099
      *        -- BOTTOM OF LIST --                                     12530099
               MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            12540099
               SET DP020-MSG-INFORMATIONAL                              12550099
                                         TO TRUE                        12560099
           ELSE                                                         12570099
               COMPUTE PV-BOTTOM-ITEM =                                 12580099
                   PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 12590099
               IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            12600099
      *            -- BOTTOM OF LIST --                                 12610099
                   MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            12620099
                   SET DP020-MSG-INFORMATIONAL                          12630099
                                         TO TRUE                        12640099
               END-IF                                                   12650099
           END-IF.                                                      12660099
       EJECT                                                            12670099
      *----------------------------------------------------------------*12680099
      *    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *12690099
      *    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *12700099
      *    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *12710099
      *    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *12720099
      *    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *12730099
      *    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *12740099
      *----------------------------------------------------------------*12750099
                                                                        12760099
       2130-CHECK-FOR-JUMP-BROWSE.                                      12770099
           SET PS-NO-ERROR               TO TRUE.                       12780099
           IF (ASC-START-ITEM-REQUEST = SPACE)                          12790099
               MOVE ASC-ITEM-AT-TOP-OF-PANEL                            12800099
                                         TO PV-TOP-ITEM                 12810099
           ELSE                                                         12820099
               MOVE ASC-START-ITEM-REQUEST                              12830099
                                         TO DP010I-UNEDITED-FIELD       12840099
               MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       12850099
               MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     12860099
               SET DP010I-NEGATIVE-NOT-ALLOWED                          12870099
                                         TO TRUE                        12880099
               CALL DP010I-NUMERIC-EDIT-ROUTINE                         12891099
                         USING DP010I-NUMERIC-EDIT-AREA                 12892099
                                                                        12900099
               IF  NOT DP010I-ERROR-DETECTED                            12910099
                   MOVE DP010I-NUMERIC-FIELD                            12920099
                                         TO  ASC-START-ITEM-REQUEST-N   12930099
                   IF  ASC-START-ITEM-REQUEST-N > ZERO                  12940099
                       IF  ASC-START-ITEM-REQUEST-N >                   12950099
                                                ASC-NUMBER-OF-ITEMS-READ12960099
                           MOVE SPACE TO ASC-START-ITEM-REQUEST         12970099
                           COMPUTE PV-TOP-ITEM =                        12980099
                                   ASC-NUMBER-OF-ITEMS-READ             12990099
                                   - PC-ITEMS-PER-PANEL + 1             13000099
                           IF  PV-TOP-ITEM < +1                         13010099
                               MOVE +1   TO PV-TOP-ITEM                 13020099
                               MOVE PC-TSYMSG-00070                     13030099
                                         TO DP020-MSG-NUMBER            13040099
                               SET DP020-MSG-INFORMATIONAL              13050099
                                         TO TRUE                        13060099
                           END-IF                                       13070099
                       ELSE                                             13080099
                           MOVE ASC-START-ITEM-REQUEST-N                13090099
                                         TO PV-TOP-ITEM                 13100099
                           MOVE SPACE    TO ASC-START-ITEM-REQUEST      13110099
                           COMPUTE PV-BOTTOM-ITEM =                     13120099
                               PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     13130099
                           IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ13140099
      *                        -- BOTTOM OF LIST --                     13150099
                               MOVE PC-TSYMSG-00070                     13160099
                                         TO DP020-MSG-NUMBER            13170099
                               SET DP020-MSG-INFORMATIONAL              13180099
                                         TO TRUE                        13190099
                           END-IF                                       13200099
                       END-IF                                           13210099
                   ELSE                                                 13220099
      *                --- VALUE OUT OF RANGE ----                      13230099
                       MOVE PC-TSYMSG-00101                             13240099
                                         TO DP020-MSG-NUMBER            13250099
                       MOVE -1           TO MR-STARTL                   13260099
                       SET DP030-SET-CURSOR-APPL-1                      13270099
                                         TO TRUE                        13280099
                       MOVE DP015-REVERSE                               13290099
                                         TO MR-STARTH                   13300099
                       MOVE DP015-RED    TO MR-STARTC                   13310099
                       MOVE DP015-UNP-NUM-BRT-MDT                       13320099
                                         TO MR-STARTA                   13330099
                       SET DP020-MSG-FATAL                              13340099
                                         TO TRUE                        13350099
                       SET PS-ERROR      TO TRUE                        13360099
                   END-IF                                               13370099
                                                                        13380099
               ELSE                                                     13390099
                   MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            13400099
                   MOVE -1               TO MR-STARTL                   13410099
                   SET DP030-SET-CURSOR-APPL-1 TO TRUE                  13420099
                   MOVE DP015-REVERSE    TO MR-STARTH                   13430099
                   MOVE DP015-RED        TO MR-STARTC                   13440099
                   MOVE DP015-UNP-NUM-BRT-MDT                           13450099
                                         TO MR-STARTA                   13460099
                   SET DP020-MSG-FATAL   TO TRUE                        13470099
                   SET PS-ERROR          TO TRUE                        13480099
               END-IF                                                   13490099
           END-IF.                                                      13500099
       EJECT                                                            13510099
      *----------------------------------------------------------------*13520099
      *    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *13530099
      *    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *13540099
      *----------------------------------------------------------------*13550099
       2140-DESELECT-ALL-ITEMS.                                         13560099
           MOVE +1                       TO ASC-BLK-SUB.                13570099
                                                                        13580099
           PERFORM 2141-CLEAR-SELECTED-INDS                             13590099
               VARYING ASC-ITEM-SUB                                     13600099
               FROM 1 BY 1                                              13610099
               UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 13620099
                                                                        13630099
           ADD +1                        TO ASC-BLK-SUB.                13640099
                                                                        13650099
           PERFORM 2141-CLEAR-SELECTED-INDS                             13660099
               VARYING ASC-ITEM-SUB                                     13670099
               FROM 1 BY 1                                              13680099
               UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 13690099
                                                                        13700099
           MOVE ASC-LIST-ITEM-NUMBER(1 1)                               13710099
                                         TO PV-LIST-ITEM-NUMBER.        13720099
                                                                        13730099
           COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            13740099
               1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    13750099
                                                                        13760099
           IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     13770099
              (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      13780099
               MOVE +1                   TO ASC-BLK-SUB                 13790099
                                                                        13800099
               PERFORM 5100-WRITE-TEMP-STORAGE                          13810099
                                                                        13820099
               MOVE +1                   TO PV-BLOCK-NUMBER             13830099
                                                                        13840099
               COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         13850099
                   PV-FIRST-BLOCK-IN-ARRAY - 1                          13860099
                                                                        13870099
               PERFORM                                                  13880099
                   UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       13890099
                                                                        13900099
                   PERFORM 4410-READ-TEMP-STORAGE                       13910099
                                                                        13920099
                   PERFORM 2141-CLEAR-SELECTED-INDS                     13930099
                       VARYING ASC-ITEM-SUB FROM 1 BY 1                 13940099
                       UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          13950099
                                                                        13960099
                   PERFORM 5100-WRITE-TEMP-STORAGE                      13970099
                                                                        13980099
                   ADD +1                TO PV-BLOCK-NUMBER             13990099
                                                                        14000099
               END-PERFORM                                              14010099
                                                                        14020099
               COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         14030099
                   PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     14040099
                                                                        14050099
               PERFORM                                                  14060099
                   UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       14070099
                         ASC-HIGHEST-BLOCK-WRITTEN                      14080099
                                                                        14090099
                   MOVE PV-NEXT-BLOCK-IN-ARRAY                          14100099
                                         TO PV-BLOCK-NUMBER             14110099
                                                                        14120099
                   PERFORM 4410-READ-TEMP-STORAGE                       14130099
                                                                        14140099
                   PERFORM 2141-CLEAR-SELECTED-INDS                     14150099
                       VARYING ASC-ITEM-SUB                             14160099
                       FROM 1 BY 1                                      14170099
                       UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          14180099
                                                                        14190099
                   PERFORM 5100-WRITE-TEMP-STORAGE                      14200099
                                                                        14210099
                   ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      14220099
                                                                        14230099
               END-PERFORM                                              14240099
                                                                        14250099
               MOVE PV-FIRST-BLOCK-IN-ARRAY                             14260099
                                         TO PV-BLOCK-NUMBER             14270099
                                                                        14280099
               PERFORM 4410-READ-TEMP-STORAGE                           14290099
           END-IF.                                                      14300099
                                                                        14310099
                                                                        14320099
           MOVE +0                     TO ASC-NUMBER-OF-SELECTED-ITEMS. 14330099
           MOVE +0                       TO ASC-START-OF-SELECTED-RANGE.14340099
           MOVE +0                       TO ASC-END-OF-SELECTED-RANGE.  14350099
                                                                        14360099
           PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        14370099
                                                                        14380099
       EJECT                                                            14390099
      *----------------------------------------------------------------*14400099
      *    MARK EACH ITEM AS BEING NOT SELECTED.                       *14410099
      *----------------------------------------------------------------*14420099
                                                                        14430099
       2141-CLEAR-SELECTED-INDS.                                        14440099
                                                                        14450099
           IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           14460099
                   NOT EQUAL ZERO                                       14470099
               IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          14480099
                   SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          14490099
                       ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    14500099
                       ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  14510099
                                         TO TRUE                        14520099
               END-IF                                                   14530099
           END-IF.                                                      14540099
                                                                        14550099
       EJECT                                                            14560099
      *----------------------------------------------------------------*14570099
      *  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *14580099
      *  FOR ALL ITEMS.                                                *14590099
      *----------------------------------------------------------------*14600099
                                                                        14610099
       2150-SELECT-ALL-ITEMS.                                           14620099
                                                                        14630099
           MOVE +1                       TO ASC-BLK-SUB.                14640099
                                                                        14650099
           PERFORM 2151-SET-SELECTED-INDS                               14660099
               VARYING ASC-ITEM-SUB                                     14670099
               FROM 1 BY 1                                              14680099
               UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 14690099
                                                                        14700099
           ADD +1                        TO ASC-BLK-SUB.                14710099
                                                                        14720099
           PERFORM 2151-SET-SELECTED-INDS                               14730099
               VARYING ASC-ITEM-SUB                                     14740099
               FROM 1 BY 1                                              14750099
               UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 14760099
                                                                        14770099
           MOVE ASC-LIST-ITEM-NUMBER(1 1)                               14780099
                                         TO PV-LIST-ITEM-NUMBER.        14790099
                                                                        14800099
           COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            14810099
               1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    14820099
                                                                        14830099
           IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     14840099
              (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    14850099
               MOVE +1                   TO ASC-BLK-SUB                 14860099
                                                                        14870099
               PERFORM 5100-WRITE-TEMP-STORAGE                          14880099
                                                                        14890099
               MOVE +1                   TO PV-BLOCK-NUMBER             14900099
                                                                        14910099
               COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         14920099
                   PV-FIRST-BLOCK-IN-ARRAY - 1                          14930099
                                                                        14940099
               PERFORM                                                  14950099
                   UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       14960099
                                                                        14970099
                   PERFORM 4410-READ-TEMP-STORAGE                       14980099
                                                                        14990099
                   PERFORM 2151-SET-SELECTED-INDS                       15000099
                       VARYING ASC-ITEM-SUB                             15010099
                       FROM 1 BY 1                                      15020099
                       UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          15030099
                                                                        15040099
                   PERFORM 5100-WRITE-TEMP-STORAGE                      15050099
                                                                        15060099
                   ADD +1                TO PV-BLOCK-NUMBER             15070099
                                                                        15080099
               END-PERFORM                                              15090099
                                                                        15100099
               COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         15110099
                   PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     15120099
                                                                        15130099
               PERFORM                                                  15140099
                   UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       15150099
                         ASC-HIGHEST-BLOCK-WRITTEN                      15160099
                                                                        15170099
                   MOVE PV-NEXT-BLOCK-IN-ARRAY                          15180099
                                         TO PV-BLOCK-NUMBER             15190099
                                                                        15200099
                   PERFORM 4410-READ-TEMP-STORAGE                       15210099
                                                                        15220099
                   PERFORM 2151-SET-SELECTED-INDS                       15230099
                       VARYING ASC-ITEM-SUB                             15240099
                       FROM 1 BY 1                                      15250099
                       UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          15260099
                                                                        15270099
                   PERFORM 5100-WRITE-TEMP-STORAGE                      15280099
                                                                        15290099
                   ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      15300099
                                                                        15310099
               END-PERFORM                                              15320099
                                                                        15330099
               MOVE PV-FIRST-BLOCK-IN-ARRAY                             15340099
                                         TO PV-BLOCK-NUMBER             15350099
                                                                        15360099
               PERFORM 4410-READ-TEMP-STORAGE                           15370099
           END-IF.                                                      15380099
                                                                        15390099
                                                                        15400099
      *    MOVE ASC-NUMBER-OF-ITEMS-READ TO                             15410099
      *                      ASC-NUMBER-OF-SELECTED-ITEMS.              15420099
                                                                        15430099
           PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        15440099
                                                                        15450099
       EJECT                                                            15460099
      *----------------------------------------------------------------*15470099
      *    MARK EACH ITEM AS BEING SELECTED.                           *15480099
      *----------------------------------------------------------------*15490099
                                                                        15500099
       2151-SET-SELECTED-INDS.                                          15510099
                                                                        15520099
           IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           15530099
                   NOT EQUAL ZERO                                       15540099
                 IF NOT (ASC-TPRICE (ASC-BLK-SUB ASC-ITEM-SUB)          15550099
                       NOT = ASC-RPRICE  (ASC-BLK-SUB ASC-ITEM-SUB)     15560099
                    AND (ASC-RPRICE    (ASC-BLK-SUB ASC-ITEM-SUB)       15570099
                       NOT = ZERO                                       15580099
                    OR  ASC-RQTY      (ASC-BLK-SUB ASC-ITEM-SUB)        15590099
                       NOT = ZERO))                                     15600099
                   IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          15610099
                       SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   15620099
                           ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   15630099
                                     TO TRUE                            15640099
                       SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              15650099
                                     TO TRUE                            15660099
                       ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    15670099
                   END-IF                                               15680099
                 END-IF                                                 15690099
           END-IF.                                                      15700099
      ******************************************************************15710099
      ** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **15720099
      ** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **15730099
      ******************************************************************15740099
       2200-MOVE-SCREEN-TO-COMMAREA.                                    15750099
                                                                        15760099
           MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             15770099
           MOVE +1                       TO PV-SUB.                     15780099
      *                                                                 15790099
           PERFORM 3100-SET-SUBSCRIPTS.                                 15800099
           IF  MR-STARTL > ZERO                                         15810099
               MOVE MR-START        TO ASC-START-ITEM-REQUEST           15820099
           ELSE                                                         15830099
               IF  MR-STARTA = DP015-ERASE-EOF                          15840099
                   INITIALIZE ASC-START-ITEM-REQUEST                    15850099
               END-IF                                                   15860099
           END-IF.                                                      15870099
           PERFORM 2210-MOVE-LINES-TO-COMMAREA                          15880099
               VARYING PV-SUB                                           15890099
               FROM 1 BY 1                                              15900099
               UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      15910099
      ******************************************************************15920099
      ** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**15930099
      ******************************************************************15940099
       2210-MOVE-LINES-TO-COMMAREA.                                     15950099
           IF  MR-SELECTL (PV-SUB) > ZERO                               15960099
               SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             15970099
               MOVE MR-SELECT (PV-SUB)                                  15980099
                                         TO ASC-TEMP-SELECTED-SW        15990099
                                       (ASC-BLK-SUB, ASC-ITEM-SUB)      16000099
           ELSE                                                         16010099
               IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                16020099
                       SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     16030099
                       MOVE SPACE        TO ASC-TEMP-SELECTED-SW        16040099
                                       (ASC-BLK-SUB, ASC-ITEM-SUB)      16050099
               END-IF                                                   16060099
           END-IF.                                                      16070099
           ADD +1                        TO ASC-ITEM-SUB.               16080099
           IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        16090099
               ADD +1                    TO ASC-BLK-SUB                 16100099
               MOVE +1                   TO ASC-ITEM-SUB                16110099
           END-IF.                                                      16120099
      ******************************************************************16130099
      ** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **16140099
      ** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **16150099
      ******************************************************************16160099
       3000-EDIT-DATA-IN-COMMAREA.                                      16170099
           SET PS-NO-ERROR               TO TRUE.                       16180099
           PERFORM 3200-RESET-ATTRIBUTES.                               16190099
           MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     16200099
      **                                                                16210099
      * CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              16220099
      * EDITTING IS DONE FROM THE BOTTOM UP.                            16230099
      **                                                                16240099
           COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       16250099
               ASC-ITEMS-DISPLAYED - 1.                                 16260099
           PERFORM 3100-SET-SUBSCRIPTS.                                 16270099
           PERFORM 3300-EDIT-SELECTIONS                                 16280099
               VARYING PV-SUB                                           16290099
               FROM PV-SUB BY -1                                        16300099
               UNTIL PV-SUB < +1                                        16310099
      *                                                                 16320099
           IF  PS-NO-ERROR                                              16330099
               PERFORM 3400-CHECK-RANGE-SEQUENCE                        16340099
           END-IF.                                                      16350099
      *                                                                 16360099
           IF  ((PS-NO-ERROR)                                           16370099
             AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   16380099
             AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    16390099
                   PERFORM 3500-MARK-RANGE-AS-SELECTED                  16400099
           END-IF.                                                      16410099
       EJECT                                                            16420099
      *----------------------------------------------------------------*16430099
      *    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *16440099
      *    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*16450099
      *    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *16460099
      *                                                                *16470099
      *    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *16480099
      *    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *16490099
      *    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *16500099
      *    US IN THE 2ND BLOCK OF THE ARRAY.                           *16510099
      *----------------------------------------------------------------*16520099
                                                                        16530099
       3100-SET-SUBSCRIPTS.                                             16540099
                                                                        16550099
           COMPUTE ASC-ITEM-SUB =                                       16560099
               (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        16570099
                                                                        16580099
           IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         16590099
               PERFORM                                                  16600099
                 UNTIL ASC-ITEM-SUB NOT > PC-ITEMS-PER-PANEL            16610099
                   SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB        16620099
               END-PERFORM                                              16630099
               MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               16640099
           ELSE                                                         16650099
               MOVE +1                     TO ASC-BLK-SUB               16660099
           END-IF.                                                      16670099
      ******************************************************************16680099
      ** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **16690099
      ******************************************************************16700099
                                                                        16710099
       3200-RESET-ATTRIBUTES.                                           16720099
           MOVE DP015-UNP-ALP-NOR-OFF    TO MR-STARTA.                  16730099
           MOVE DP015-GREEN              TO MR-STARTC.                  16740099
           MOVE DP015-UNDERLINE          TO MR-STARTH.                  16750099
      *                                                                 16760099
           PERFORM                                                      16770099
               VARYING PV-SUB                                           16780099
               FROM 1 BY 1                                              16790099
               UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        16800099
               MOVE DP015-UNP-ALP-NOR-OFF                               16810099
                                         TO MR-SELECTA (PV-SUB)         16820099
               MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)         16830099
               MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)         16840099
           END-PERFORM.                                                 16850099
      ******************************************************************16860099
      ** EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS    **16870099
      ** WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'   **16880099
      ** IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR    **16890099
      ** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **16900099
      ******************************************************************16910099
       3300-EDIT-SELECTIONS.                                            16920099
           EVALUATE TRUE                                                16930099
               WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     16940099
                   = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         16950099
                       CONTINUE                                         16960099
               WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         16970099
                   IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        16980099
                       ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   16990099
                       MOVE ASC-TEMP-SELECTED-SW                        17000099
                                            (ASC-BLK-SUB ASC-ITEM-SUB)  17010099
                                      TO ASC-SELECTED-SW                17020099
                                            (ASC-BLK-SUB ASC-ITEM-SUB)  17030099
                   END-IF                                               17040099
               WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     17050099
                       = SPACE                                          17060099
                   EVALUATE TRUE                                        17070099
                       WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       17080099
                           SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS17090099
                           MOVE SPACE TO ASC-SELECTED-SW                17100099
                                            (ASC-BLK-SUB ASC-ITEM-SUB)  17110099
                       WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        17120099
                           MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    17130099
                           MOVE SPACE TO ASC-SELECTED-SW                17140099
                                            (ASC-BLK-SUB ASC-ITEM-SUB)  17150099
                       WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          17160099
                           MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      17170099
                           MOVE SPACE TO ASC-SELECTED-SW                17180099
                                            (ASC-BLK-SUB ASC-ITEM-SUB)  17190099
                   END-EVALUATE                                         17200099
               WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           17210099
                   IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            17220099
                       SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    17230099
                   END-IF                                               17240099
                   PERFORM 3310-EDIT-RANGE                              17250099
               WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             17260099
                   IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            17270099
                       SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    17280099
                   END-IF                                               17290099
                   PERFORM 3310-EDIT-RANGE                              17300099
               WHEN OTHER                                               17310099
                   MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           17320099
                   SET DP020-MSG-FATAL    TO TRUE                       17330099
                   MOVE -1                TO MR-SELECTL (PV-SUB)        17340099
                   SET DP030-SET-CURSOR-APPL-1                          17350099
                                          TO TRUE                       17360099
                   MOVE DP015-RED         TO MR-SELECTC (PV-SUB)        17370099
                   MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)        17380099
                   SET PS-ERROR TO TRUE                                 17390099
                   IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            17400099
                       SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     17410099
                       MOVE SPACE         TO ASC-SELECTED-SW            17420099
                                              (ASC-BLK-SUB ASC-ITEM-SUB)17430099
                   END-IF                                               17440099
           END-EVALUATE.                                                17450099
                                                                        17460099
           SUBTRACT +1             FROM PV-ITEM-IN-USE.                 17470099
           SUBTRACT +1 FROM ASC-ITEM-SUB.                               17480099
           IF  ASC-ITEM-SUB < 1                                         17490099
               SUBTRACT +1 FROM ASC-BLK-SUB                             17500099
               MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                17510099
           END-IF.                                                      17520099
      ******************************************************************17530099
      ** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **17540099
      ** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **17550099
      ** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**17560099
      ** THE ENDING.                                                  **17570099
      ******************************************************************17580099
       3310-EDIT-RANGE.                                                 17590099
           IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                17600099
               IF  ASC-START-OF-SELECTED-RANGE = ZERO                   17610099
                   MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)17620099
                                         TO ASC-SELECTED-SW             17630099
                                              (ASC-BLK-SUB ASC-ITEM-SUB)17640099
                   MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 17650099
               ELSE                                                     17660099
                   IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     17670099
                       CONTINUE                                         17680099
                   ELSE                                                 17690099
      *                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        17700099
                       MOVE PC-TSYMSG-00054                             17710099
                                         TO DP020-MSG-NUMBER            17720099
                       SET DP020-MSG-FATAL                              17730099
                                         TO TRUE                        17740099
                       MOVE -1           TO MR-SELECTL (PV-SUB)         17750099
                       SET DP030-SET-CURSOR-APPL-1                      17760099
                                         TO TRUE                        17770099
                       MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         17780099
                       MOVE DP015-UNDERLINE                             17790099
                                         TO MR-SELECTH (PV-SUB)         17800099
                       SET PS-ERROR      TO TRUE                        17810099
                   END-IF                                               17820099
               END-IF                                                   17830099
           ELSE                                                         17840099
               IF  ASC-END-OF-SELECTED-RANGE = ZERO                     17850099
                   MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 17860099
                                         TO ASC-SELECTED-SW             17870099
                                           (ASC-BLK-SUB ASC-ITEM-SUB)   17880099
                   MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   17890099
               ELSE                                                     17900099
                   IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       17910099
                       CONTINUE                                         17920099
                   ELSE                                                 17930099
      *                -- ONLY ONE END-OF-RANGE ALLOWED --              17940099
                       MOVE PC-TSYMSG-00055                             17950099
                                         TO DP020-MSG-NUMBER            17960099
                       SET DP020-MSG-FATAL                              17970099
                                         TO TRUE                        17980099
                       MOVE -1           TO MR-SELECTL (PV-SUB)         17990099
                       SET DP030-SET-CURSOR-APPL-1                      18000099
                                         TO TRUE                        18010099
                       SET PS-ERROR      TO TRUE                        18020099
                   END-IF                                               18030099
               END-IF                                                   18040099
           END-IF.                                                      18050099
      *                                                                 18060099
      ******************************************************************18070099
      ** IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,    **18080099
      ** MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.  **18090099
      ******************************************************************18100099
       3400-CHECK-RANGE-SEQUENCE.                                       18110099
           IF  ASC-START-OF-SELECTED-RANGE > ZERO                       18120099
             AND  ASC-END-OF-SELECTED-RANGE > ZERO                      18130099
             AND  ASC-START-OF-SELECTED-RANGE >                         18140099
                                               ASC-END-OF-SELECTED-RANGE18150099
      *        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                18160099
               MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 18170099
               SET DP020-MSG-FATAL TO TRUE                              18180099
               SET PS-ERROR TO TRUE                                     18190099
               PERFORM 3410-POSITION-AT-ERROR                           18200099
           END-IF.                                                      18210099
      ******************************************************************18220099
      ** BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE    **18230099
      ** PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR **18240099
      ** SHOULD BE POSITIONED ON A RANGE ERROR.                       **18250099
      ******************************************************************18260099
       3410-POSITION-AT-ERROR.                                          18270099
           SET DP030-SET-CURSOR-APPL-1                                  18280099
                                         TO TRUE.                       18290099
           COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 18300099
                          - PV-TOP-ITEM + 1.                            18310099
           IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      18320099
               CONTINUE                                                 18330099
           ELSE                                                         18340099
               MOVE -1                   TO MR-SELECTL (PV-SUB)         18350099
               MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         18360099
               MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         18370099
           END-IF.                                                      18380099
      *                                                                 18390099
           COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   18400099
                          - PV-TOP-ITEM + 1.                            18410099
           IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      18420099
               CONTINUE                                                 18430099
           ELSE                                                         18440099
               MOVE -1                   TO MR-SELECTL (PV-SUB)         18450099
               MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         18460099
               MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         18470099
           END-IF.                                                      18480099
       EJECT                                                            18490099
      *----------------------------------------------------------------*18500099
      *    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *18510099
      *    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *18520099
      *    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *18530099
      *----------------------------------------------------------------*18540099
                                                                        18550099
       3500-MARK-RANGE-AS-SELECTED.                                     18560099
           MOVE +1                       TO  ASC-BLK-SUB.               18570099
           PERFORM 3510-MARK-SELECTED-INDS                              18580099
               VARYING ASC-ITEM-SUB                                     18590099
               FROM 1 BY 1                                              18600099
               UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 18610099
                                                                        18620099
           ADD +1                        TO ASC-BLK-SUB.                18630099
           PERFORM 3510-MARK-SELECTED-INDS                              18640099
               VARYING ASC-ITEM-SUB                                     18650099
               FROM 1 BY 1                                              18660099
               UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 18670099
                                                                        18680099
           MOVE ASC-LIST-ITEM-NUMBER(1 1)                               18690099
                                         TO  PV-LIST-ITEM-NUMBER.       18700099
           COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            18710099
               1 + ((PV-LIST-ITEM-NUMBER - 1) /                         18720099
                     PC-ITEMS-PER-PANEL).                               18730099
                                                                        18740099
           MOVE ASC-START-OF-SELECTED-RANGE                             18750099
                                         TO PV-START-OF-SELECTED-RANGE. 18760099
           COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            18770099
               1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  18780099
                     PC-ITEMS-PER-PANEL).                               18790099
                                                                        18800099
           MOVE ASC-END-OF-SELECTED-RANGE                               18810099
                                         TO  PV-END-OF-SELECTED-RANGE.  18820099
           COMPUTE PV-LAST-BLOCK-IN-RANGE =                             18830099
               1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    18840099
                     PC-ITEMS-PER-PANEL).                               18850099
           COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             18860099
               PV-FIRST-BLOCK-IN-ARRAY + 1.                             18870099
                                                                        18880099
           IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    18890099
              (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        18900099
               MOVE +1                   TO ASC-BLK-SUB                 18910099
               PERFORM 5100-WRITE-TEMP-STORAGE                          18920099
               COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         18930099
                   PV-FIRST-BLOCK-IN-ARRAY - 1                          18940099
                                                                        18950099
               PERFORM                                                  18960099
                   UNTIL PV-FIRST-BLOCK-IN-RANGE >                      18970099
                         PV-PREV-BLOCK-IN-ARRAY                         18980099
                   MOVE PV-FIRST-BLOCK-IN-RANGE                         18990099
                                         TO PV-BLOCK-NUMBER             19000099
                   PERFORM 4410-READ-TEMP-STORAGE                       19010099
                   PERFORM 3510-MARK-SELECTED-INDS                      19020099
                       VARYING ASC-ITEM-SUB                             19030099
                       FROM 1 BY 1                                      19040099
                       UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          19050099
                   PERFORM 5100-WRITE-TEMP-STORAGE                      19060099
                   ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     19070099
               END-PERFORM                                              19080099
                                                                        19090099
               COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         19100099
                   PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     19110099
               PERFORM                                                  19120099
                   UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       19130099
                         PV-LAST-BLOCK-IN-RANGE                         19140099
                   MOVE PV-NEXT-BLOCK-IN-ARRAY                          19150099
                                         TO PV-BLOCK-NUMBER             19160099
                   PERFORM 4410-READ-TEMP-STORAGE                       19170099
                   PERFORM 3510-MARK-SELECTED-INDS                      19180099
                       VARYING ASC-ITEM-SUB                             19190099
                       FROM 1 BY 1                                      19200099
                       UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          19210099
                   PERFORM 5100-WRITE-TEMP-STORAGE                      19220099
                   ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      19230099
               END-PERFORM                                              19240099
                                                                        19250099
               MOVE PV-FIRST-BLOCK-IN-ARRAY                             19260099
                                         TO PV-BLOCK-NUMBER             19270099
               PERFORM 4410-READ-TEMP-STORAGE                           19280099
           END-IF.                                                      19290099
                                                                        19300099
           MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 19310099
                                            ASC-END-OF-SELECTED-RANGE.  19320099
                                                                        19330099
       EJECT                                                            19340099
      *----------------------------------------------------------------*19350099
      * SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *19360099
      *----------------------------------------------------------------*19370099
                                                                        19380099
       3510-MARK-SELECTED-INDS.                                         19390099
                                                                        19400099
           IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         19410099
                                      ASC-ITEM-SUB) >                   19420099
               ASC-START-OF-SELECTED-RANGE)                             19430099
           OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         19440099
                                      ASC-ITEM-SUB) =                   19450099
               ASC-START-OF-SELECTED-RANGE)                             19460099
                                                                        19470099
               IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     19480099
                                          ASC-ITEM-SUB) <               19490099
                   ASC-END-OF-SELECTED-RANGE)                           19500099
               OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     19510099
                                          ASC-ITEM-SUB) =               19520099
                   ASC-END-OF-SELECTED-RANGE)                           19530099
                                                                        19540099
                 IF NOT (ASC-TPRICE (ASC-BLK-SUB ASC-ITEM-SUB)          19550099
                       NOT = ASC-RPRICE  (ASC-BLK-SUB ASC-ITEM-SUB)     19560099
                    AND (ASC-RPRICE    (ASC-BLK-SUB ASC-ITEM-SUB)       19570099
                       NOT = ZERO                                       19580099
                    OR  ASC-RQTY      (ASC-BLK-SUB ASC-ITEM-SUB)        19590099
                       NOT = ZERO))                                     19600099
                   IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          19610099
                       SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   19620099
                           ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   19630099
                                     TO TRUE                            19640099
                       SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              19650099
                                     TO TRUE                            19660099
                       ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    19670099
                   END-IF                                               19680099
                 END-IF                                                 19690099
               END-IF                                                   19700099
           END-IF.                                                      19710099
                                                                        19720099
       EJECT                                                            19730099
      *----------------------------------------------------------------*19740099
      *    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *19750099
      *    INITIALIZE ALL COUNTERS AND FLAGS.                          *19760099
      *    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *19770099
      *    DISPLAY THE PANEL TO USER.                                  *19780099
      *----------------------------------------------------------------*19790099
                                                                        19800099
       4000-BUILD-INITIAL-PANEL.                                        19810099
                                                                        19820099
           INITIALIZE                  ASC-BLOCK-ENTRIES (1)            19830099
                                       ASC-BLOCK-ENTRIES (2).           19840099
           MOVE +1                 TO ASC-BLK-SUB.                      19850099
           SET ASC-ITEMS-LEFT-ON-DB                                     19860099
                                   TO TRUE.                             19870099
                                                                        19880099
           MOVE +0                 TO ASC-ITEM-SUB                      19890099
                                      ASC-NUMBER-OF-ITEMS-READ          19900099
                                      ASC-NUMBER-OF-SELECTED-ITEMS      19910099
                                      ASC-HIGHEST-BLOCK-WRITTEN         19920099
                                      ASC-START-OF-SELECTED-RANGE       19930099
                                      ASC-END-OF-SELECTED-RANGE         19940099
                                      ASC-ITEM-AT-TOP-OF-PANEL.         19950099
                                                                        19960099
           PERFORM 4010-OPEN-CURSOR.                                    19970099
                                                                        19980099
           PERFORM 4300-READ-ITEMS-FROM-DB.                             19990099
                                                                        20000099
           PERFORM 4020-CLOSE-CURSOR.                                   20010099
                                                                        20020099
           MOVE +1                   TO  PV-TOP-ITEM.                   20030099
           IF  ASC-NUMBER-OF-ITEMS-READ = ZERO     AND                  20040099
               PS-DISCREPANCY-NOT-FOUND                                 20050099
               SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    20060099
               SET DP020-MSG-FATAL   TO  TRUE                           20070099
               MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               20080099
           ELSE                                                         20090099
               MOVE -1               TO MR-SELECTL (1)                  20100099
               SET DP030-SET-CURSOR-APPL-1                              20110099
                                     TO TRUE                            20120099
               PERFORM 3200-RESET-ATTRIBUTES                            20130099
               PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     20140099
           END-IF.                                                      20150099
       EJECT                                                            20160099
      *----------------------------------------------------------------*20170099
      * OPEN THE DISCREPANCY CURSOR.                                   *20180099
      *----------------------------------------------------------------*20190099
                                                                        20200099
       4010-OPEN-CURSOR.                                                20210099
           PERFORM                                                      20220099
               WITH TEST AFTER                                          20230099
               VARYING PV-RETRY-COUNTER                                 20240099
               FROM 1 BY 1                                              20250099
               UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               20260099
                         OR (SQLCODE = ZERO))                           20270099
               EXEC SQL                                                 20280099
                   OPEN DISCREP-CSR                                     20290099
               END-EXEC                                                 20300099
                                                                        20310099
               EVALUATE TRUE                                            20320099
                   WHEN SQLCODE = ZERO                                  20330099
                   WHEN SQLCODE = -904                                  20340099
                   WHEN SQLCODE = -913                                  20350099
                       CONTINUE                                         20360099
                   WHEN OTHER                                           20370099
                       MOVE '4010-OPEN-CURSOR'                          20400099
                                         TO DP013-PARAGRAPH             20410099
                       MOVE 'OPEN DISCREPANCY CURSOR - '                20420099
                                         TO DP013-MESSAGE-TEXT (1)      20430099
                       MOVE SQLCA        TO DP013-SQLCA                 20440099
                       MOVE 'TTFITEM '   TO DP013-DB2-TABLE-NAME (1)    20450099
                       SET DP013-DB2-ABEND                              20460099
                           DP013-XCTL-DISPLAY-RESTART TO TRUE           20470099
                       PERFORM DP013-0000-PROCESS-ABEND                 20480099
               END-EVALUATE                                             20490099
           END-PERFORM.                                                 20500099
      *                                                                 20510099
           IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        20520099
               MOVE '4010-OPEN-CURSOR'   TO DP013-PARAGRAPH             20530099
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   20540099
                                         TO DP013-MESSAGE-TEXT (1)      20550099
               MOVE SQLCA                TO DP013-SQLCA                 20560099
               MOVE 'TTFITEM '           TO DP013-DB2-TABLE-NAME (1)    20570099
               SET DP013-DB2-ABEND                                      20580099
                   DP013-XCTL-DISPLAY-RESTART                           20590099
                                         TO TRUE                        20600099
               PERFORM DP013-0000-PROCESS-ABEND                         20610099
           END-IF.                                                      20620099
                                                                        20630099
       EJECT                                                            20640099
      *----------------------------------------------------------------*20650099
      * CLOSE THE DISCREPANCY CURSOR.                                  *20660099
      *----------------------------------------------------------------*20670099
                                                                        20680099
       4020-CLOSE-CURSOR.                                               20690099
           EXEC SQL                                                     20700099
               CLOSE DISCREP-CSR                                        20710099
           END-EXEC                                                     20720099
      *                                                                 20730099
           EVALUATE TRUE                                                20740099
               WHEN SQLCODE = ZERO                                      20750099
                   CONTINUE                                             20760099
               WHEN OTHER                                               20770099
                   MOVE '4020-CLOSE-CURSOR'                             20800099
                                     TO DP013-PARAGRAPH                 20810099
                   MOVE 'CLOSE DISCREPANCY CURSOR '                     20820099
                                     TO DP013-MESSAGE-TEXT (1)          20830099
                   MOVE SQLCA        TO DP013-SQLCA                     20840099
                   MOVE 'TTFITEM '   TO DP013-DB2-TABLE-NAME (1)        20850099
                   SET DP013-DB2-ABEND                                  20860099
                       DP013-XCTL-DISPLAY-RESTART TO TRUE               20870099
                   PERFORM DP013-0000-PROCESS-ABEND                     20880099
           END-EVALUATE.                                                20890099
                                                                        20900099
       EJECT                                                            20910099
      *----------------------------------------------------------------*20920099
      * SELECT DATA FROM THE TRANSFER TABLES                            20930099
      *----------------------------------------------------------------*20940099
       4100-GET-TRANSFER.                                               20950099
           PERFORM                                                      20960099
               WITH TEST AFTER                                          20970099
               VARYING PV-RETRY-COUNTER                                 20980099
               FROM 1 BY 1                                              20990099
               UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               21000099
                         OR (SQLCODE = ZERO)                            21010099
                         OR (SQLCODE = +100))                           21020099
      *                                                                 21030099
               EXEC SQL                                                 21040099
                   SELECT CONTNR_TYP_CDE                                21050099
                         ,FR_STR_NBR                                    21060099
                         ,XFER_SEQ_NBR                                  21070099
                         ,TO_STR_NBR                                    21080099
                         ,LG_TTE_1ST_SEAL_ID                            21090099
                         ,LG_TTE_2ND_SEAL_ID                            21100099
                         ,SM_TTE_BAG_SEAL_ID                            21110099
                         ,TRLR_NBR                                      21120099
                         ,TRLR_SEAL_ID                                  21130099
                   INTO   :TFMSTR-CONTNR-TYP-CDE                        21140099
                         ,:TFMSTR-FR-STR-NBR                            21150099
                         ,:TFMSTR-XFER-SEQ-NBR                          21160099
                         ,:TFMSTR-TO-STR-NBR                            21170099
                         ,:TFMSTR-LG-TTE-1ST-SEAL-ID                    21180099
                         ,:TFMSTR-LG-TTE-2ND-SEAL-ID                    21190099
                         ,:TFMSTR-SM-TTE-BAG-SEAL-ID                    21200099
                         ,:TFMSTR-TRLR-NBR                              21210099
                         ,:TFMSTR-TRLR-SEAL-ID                          21220099
                   FROM   TTFMSTR                                       21230099
                   WHERE  XFER_DKEY_ID     = :DK-XFER-DKEY-ID           21240099
               END-EXEC                                                 21250099
                                                                        21260099
               EVALUATE TRUE                                            21270099
                   WHEN SQLCODE = ZERO                                  21280099
                      SET PS-TRANSFER-FOUND     TO TRUE                 21290099
                      MOVE TFMSTR-FR-STR-NBR    TO ASC-FROM-STORE-NBR   21300099
                      MOVE TFMSTR-XFER-SEQ-NBR  TO ASC-XFER-SEQ-NBR     21310099
                      MOVE TFMSTR-TO-STR-NBR    TO ASC-TO-STORE-NBR     21320099
                      MOVE TFMSTR-CONTNR-TYP-CDE TO                     21330099
                                                ASC-CONTNR-TYP-CDE      21340099
                      IF TFMSTR-CONTNR-TYP-CDE = PC-TRAILER             21350099
                          MOVE TFMSTR-TRLR-SEAL-ID       TO             21360099
                                  ASC-XFER-LG-SEAL1-TRLR                21370099
                                  ASC-RECV-LG-SEAL1-TRLR                21380099
                          MOVE TFMSTR-TRLR-NBR           TO             21390099
                                  ASC-XFER-LG-SEAL2-TRLR                21400099
                                  ASC-RECV-LG-SEAL2-TRLR                21410099
                      ELSE                                              21420099
                          MOVE TFMSTR-LG-TTE-1ST-SEAL-ID TO             21430099
                                  ASC-XFER-LG-SEAL1-TRLR                21440099
                                  ASC-RECV-LG-SEAL1-TRLR                21450099
                          MOVE TFMSTR-LG-TTE-2ND-SEAL-ID TO             21460099
                                  ASC-XFER-LG-SEAL2-TRLR                21470099
                                  ASC-RECV-LG-SEAL2-TRLR                21480099
                          MOVE TFMSTR-SM-TTE-BAG-SEAL-ID TO             21490099
                                  ASC-XFER-SM-SEAL                      21500099
                                  ASC-RECV-SM-SEAL                      21510099
                      END-IF                                            21520099
                   WHEN SQLCODE = +100                                  21530099
                   WHEN SQLCODE = -904                                  21540099
                   WHEN SQLCODE = -913                                  21550099
                       CONTINUE                                         21560099
                   WHEN OTHER                                           21570099
                       MOVE '4100-GET-TRANSFER'                         21600099
                                         TO DP013-PARAGRAPH             21610099
                       MOVE 'SELECT TRANSFER DATA'                      21620099
                                         TO DP013-MESSAGE-TEXT (1)      21630099
                       MOVE SQLCA        TO DP013-SQLCA                 21640099
                       MOVE 'TTFMSTR'    TO DP013-DB2-TABLE-NAME (1)    21650099
                       SET DP013-DB2-ABEND                              21660099
                           DP013-XCTL-DISPLAY-RESTART                   21670099
                                         TO TRUE                        21680099
                       PERFORM DP013-0000-PROCESS-ABEND                 21690099
               END-EVALUATE                                             21700099
           END-PERFORM.                                                 21710099
      *                                                                 21720099
           IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        21730099
               MOVE '4100-GET-TRANSFER'                                 21740099
                                         TO DP013-PARAGRAPH             21750099
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     21760099
                                         TO DP013-MESSAGE-TEXT (1)      21770099
               MOVE 'TRANSFER DATA'      TO DP013-MESSAGE-TEXT (2)      21780099
               MOVE SQLCA                TO DP013-SQLCA                 21790099
               MOVE 'TTFMSTR'            TO DP013-DB2-TABLE-NAME (1)    21800099
               SET DP013-DB2-ABEND                                      21810099
                   DP013-XCTL-DISPLAY-RESTART                           21820099
                                         TO TRUE                        21830099
               PERFORM DP013-0000-PROCESS-ABEND                         21840099
           END-IF.                                                      21850099
                                                                        21860099
           IF SQLCODE = ZERO                                            21870099
               PERFORM 4200-GET-DISCREPANCY                             21880099
               PERFORM 5500-GET-STORE-NAMES                             21890099
               PERFORM 6200-READ-TRANSFER-RECEIPT                       21900099
               PERFORM 7000-READ-TOT-TRANSFER-AMT                       21910099
               PERFORM 7100-READ-TOT-RECEIPT-AMT                        21920099
               COMPUTE PV-VARIANCE =                                    21930099
                         (PV-XFER-TOTAL - PV-RCVD-TOTAL)                21940099
               END-COMPUTE                                              21950099
               MOVE PV-VARIANCE      TO PV-EDITTED-NET-DISCREP          21960099
               IF PV-VARIANCE < ZERO                                    21970099
                   MOVE '('          TO PV-EDIT-D-PAREN-1               21980099
                   MOVE ')'          TO PV-EDIT-D-PAREN-2               21990099
               ELSE                                                     22000099
                   MOVE SPACE        TO PV-EDIT-D-PAREN-1               22010099
                                        PV-EDIT-D-PAREN-2               22020099
               END-IF                                                   22030099
               MOVE PV-EDITTED-NET-DISCREP-FIELD                        22040099
                                     TO ASC-NET-DISCREPANCY             22050099
           END-IF.                                                      22060099
       EJECT                                                            22070099
      *----------------------------------------------------------------*22080099
      *    DETERMINE WHETHER THERE IS A TRANSFER HEADER DISCREPANCY    *22090099
      *----------------------------------------------------------------*22100099
                                                                        22110099
       4200-GET-DISCREPANCY.                                            22120099
           SET PS-DISCREPANCY-NOT-FOUND TO TRUE.                        22130099
           PERFORM                                                      22140099
               WITH TEST AFTER                                          22150099
               VARYING PV-RETRY-COUNTER                                 22160099
               FROM 1 BY 1                                              22170099
               UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               22180099
                         OR (SQLCODE = ZERO)                            22190099
                         OR (SQLCODE = +100))                           22200099
      *                                                                 22210099
               EXEC SQL                                                 22220099
                   SELECT LG_TTE_1ST_SEAL_ID                            22230099
                         ,LG_TTE_2ND_SEAL_ID                            22240099
                         ,SM_TTE_BG_SEAL_ID                             22250099
                         ,TRLR_NBR                                      22260099
                         ,TRLR_SEAL_ID                                  22270099
                   INTO   :TFDSCP-LG-TTE-1ST-SEAL-ID                    22280099
                         ,:TFDSCP-LG-TTE-2ND-SEAL-ID                    22290099
                         ,:TFDSCP-SM-TTE-BG-SEAL-ID                     22300099
                         ,:TFDSCP-TRLR-NBR                              22310099
                         ,:TFDSCP-TRLR-SEAL-ID                          22320099
                   FROM   TTFDSCP D                                     22330099
                         ,TTFSTAT S                                     22340099
                   WHERE D.XFER_DKEY_ID   = :DK-XFER-DKEY-ID     AND    22350099
                         S.XFER_DKEY_ID   = :DK-XFER-DKEY-ID     AND    22360099
                         S.XFER_STAT_CDE  = :PC-POSITIVE-RECEIPT AND    22370099
                         S.XFER_STAT_TMST =  D.RCV_XFER_BEG_TMST        22380099
               END-EXEC                                                 22390099
                                                                        22400099
               EVALUATE TRUE                                            22410099
                   WHEN SQLCODE = ZERO                                  22420099
                      SET PS-DISCREPANCY-FOUND   TO TRUE                22430099
                      IF ASC-CONTNR-TYP-CDE = PC-TRAILER                22440099
                          MOVE TFDSCP-TRLR-SEAL-ID       TO             22450099
                                  ASC-RECV-LG-SEAL1-TRLR                22460099
                          MOVE TFDSCP-TRLR-NBR           TO             22470099
                                  ASC-RECV-LG-SEAL2-TRLR                22480099
                      ELSE                                              22490099
                          MOVE TFDSCP-LG-TTE-1ST-SEAL-ID TO             22500099
                                  ASC-RECV-LG-SEAL1-TRLR                22510099
                          MOVE TFDSCP-LG-TTE-2ND-SEAL-ID TO             22520099
                                  ASC-RECV-LG-SEAL2-TRLR                22530099
                          MOVE TFDSCP-SM-TTE-BG-SEAL-ID TO              22540099
                                  ASC-RECV-SM-SEAL                      22550099
                      END-IF                                            22560099
                   WHEN SQLCODE = +100                                  22570099
                   WHEN SQLCODE = -904                                  22580099
                   WHEN SQLCODE = -913                                  22590099
                       CONTINUE                                         22600099
                   WHEN OTHER                                           22610099
                       MOVE '4200-GET-DISCREPANCY'                      22670099
                                         TO DP013-PARAGRAPH             22680099
                       MOVE 'SELECT TRANSFER DISCREPANCY DATA'          22690099
                                         TO DP013-MESSAGE-TEXT (1)      22700099
                       MOVE SQLCA        TO DP013-SQLCA                 22710099
                       MOVE 'TTFDSCP'    TO DP013-DB2-TABLE-NAME (1)    22720099
                       MOVE 'TTFSTAT'    TO DP013-DB2-TABLE-NAME (2)    22730099
                       SET DP013-DB2-ABEND                              22740099
                           DP013-XCTL-DISPLAY-RESTART                   22750099
                                         TO TRUE                        22760099
                       PERFORM DP013-0000-PROCESS-ABEND                 22770099
               END-EVALUATE                                             22780099
           END-PERFORM.                                                 22790099
      *                                                                 22800099
           IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        22810099
               MOVE '4200-GET-DISCREPANCY'                              22820099
                                         TO DP013-PARAGRAPH             22830099
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     22840099
                                         TO DP013-MESSAGE-TEXT (1)      22850099
               MOVE 'TRANSFER DISCREPANCY DATA'                         22860099
                                         TO DP013-MESSAGE-TEXT (2)      22870099
               MOVE SQLCA                TO DP013-SQLCA                 22880099
               MOVE 'TTFDSCP'            TO DP013-DB2-TABLE-NAME (1)    22890099
               MOVE 'TTFSTAT'            TO DP013-DB2-TABLE-NAME (2)    22900099
               SET DP013-DB2-ABEND                                      22910099
                   DP013-XCTL-DISPLAY-RESTART                           22920099
                                         TO TRUE                        22930099
               PERFORM DP013-0000-PROCESS-ABEND                         22940099
           END-IF.                                                      22950099
       EJECT                                                            22960099
      *----------------------------------------------------------------*22970099
      *    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *22980099
      *    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *22990099
      *    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *23000099
      *    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *23010099
      *    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *23020099
      *                                                                *23030099
      *    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *23040099
      *    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *23050099
      *    UPON INITIALIZATION.                                        *23060099
      *----------------------------------------------------------------*23070099
                                                                        23080099
       4300-READ-ITEMS-FROM-DB.                                         23090099
                                                                        23100099
           PERFORM                                                      23110099
               VARYING PV-READ-COUNT                                    23120099
               FROM 1 BY 1                                              23130099
               UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    23140099
                  OR (ASC-NO-ITEMS-LEFT-ON-DB))                         23150099
                                                                        23160099
               PERFORM 4310-FETCH                                       23170099
                                                                        23180099
               IF  ASC-ITEMS-LEFT-ON-DB                                 23190099
                   IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                23200099
                       ADD +1            TO ASC-ITEM-SUB                23210099
                   ELSE                                                 23220099
                       ADD +1            TO ASC-BLK-SUB                 23230099
                       MOVE +1           TO ASC-ITEM-SUB                23240099
                                                                        23250099
                       IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         23260099
                           MOVE +1       TO ASC-BLK-SUB                 23270099
                           SET ASC-BLOCK-MODIFIED (1)                   23280099
                                         TO TRUE                        23290099
                           PERFORM 5100-WRITE-TEMP-STORAGE              23300099
                           MOVE ASC-BLOCK-ENTRIES                       23310099
                                     (PC-MAX-BLOCKS-IN-ARRAY)           23320099
                                      TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 23330099
                           ADD +1        TO ASC-BLK-SUB                 23340099
                           INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   23350099
                           SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      23360099
                                         TO TRUE                        23370099
                       END-IF                                           23380099
                   END-IF                                               23390099
                   ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    23400099
                   MOVE ASC-NUMBER-OF-ITEMS-READ                        23410099
                                         TO ASC-LIST-ITEM-NUMBER        23420099
                                            (ASC-BLK-SUB ASC-ITEM-SUB)  23430099
                   MOVE TFITEM-XFER-LNE-NBR                             23440099
                                         TO ASC-LINE-NBR                23450099
                                            (ASC-BLK-SUB ASC-ITEM-SUB)  23460099
                   MOVE SKXREF-DEPT                                     23470099
                                         TO ASC-DEPT                    23480099
                                            (ASC-BLK-SUB ASC-ITEM-SUB)  23490099
                   MOVE SKXREF-CLASS                                    23500099
                                         TO ASC-CLASS                   23510099
                                            (ASC-BLK-SUB ASC-ITEM-SUB)  23520099
                   MOVE SKXREF-SUBCLASS                                 23530099
                                         TO ASC-SUBCLASS                23540099
                                            (ASC-BLK-SUB ASC-ITEM-SUB)  23550099
                   MOVE TFITEM-KOHLS-UPC-NBR                            23560099
                                         TO ASC-UPC                     23570099
                                            (ASC-BLK-SUB ASC-ITEM-SUB)  23580099
                   MOVE TFITEM-XFER-PRIC-AMT                            23590099
                                         TO ASC-TPRICE                  23600099
                                            (ASC-BLK-SUB ASC-ITEM-SUB)  23610099
                   MOVE TFITEM-XFER-QTY                                 23620099
                                         TO ASC-TQTY                    23630099
                                            (ASC-BLK-SUB ASC-ITEM-SUB)  23640099
      *            MOVE TFITEM-RCVD-XFER-QTY                            23650099
      *                                  TO ASC-RQTY                    23660099
      *                                     (ASC-BLK-SUB ASC-ITEM-SUB)  23670099
      *            MOVE TFITEM-RCVD-XFER-PRIC-AMT                       23680099
      *                                  TO ASC-RPRICE                  23690099
      *                                     (ASC-BLK-SUB ASC-ITEM-SUB)  23700099
                   PERFORM 5300-READ-ADJUSTMENTS                        23710099
                   PERFORM 5400-READ-ITEM-RECEIPT                       23720099
                   MOVE TFITRC-RCVD-XFER-QTY             TO             23730099
                           ASC-RQTY      (ASC-BLK-SUB ASC-ITEM-SUB)     23740099
                   MOVE TFITRC-RCVD-XFER-PRIC-AMT        TO             23750099
                           ASC-RPRICE    (ASC-BLK-SUB ASC-ITEM-SUB)     23760099
                   COMPUTE PV-VARIANCE =                                23770099
                    ((TFITEM-XFER-QTY * TFITEM-XFER-PRIC-AMT)   -       23780099
                     (TFITRC-RCVD-XFER-QTY * TFITRC-RCVD-XFER-PRIC-AMT))23790099
                   END-COMPUTE                                          23800099
                   MOVE PV-VARIANCE      TO PV-EDITTED-VARIANCE         23810099
                   IF PV-VARIANCE < ZERO                                23820099
                       MOVE '('          TO PV-EDIT-V-PAREN-1           23830099
                       MOVE ')'          TO PV-EDIT-V-PAREN-2           23840099
                   ELSE                                                 23850099
                       MOVE SPACE        TO PV-EDIT-V-PAREN-1           23860099
                                            PV-EDIT-V-PAREN-2           23870099
                   END-IF                                               23880099
                   MOVE PV-EDITTED-VARIANCE-FIELD                       23890099
                                         TO ASC-VARIANCE                23900099
                                            (ASC-BLK-SUB ASC-ITEM-SUB)  23910099
                                                                        23920099
                   SET ASC-ITEMS-LEFT-ON-DB-2            TO TRUE        23930099
                                                                        23940099
                   PERFORM 5600-OPEN-RECEIPT-CURSOR                     23950099
                                                                        23960099
                   PERFORM 5700-READ-RECEIPT-ITEMS                      23970099
                                                                        23980099
                   PERFORM 5800-CLOSE-RECEIPT-CURSOR                    23990099
                                                                        24000099
               END-IF                                                   24010099
           END-PERFORM.                                                 24020099
                                                                        24030099
           IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          24040099
               MOVE +1               TO ASC-BLK-SUB                     24050099
               PERFORM 5100-WRITE-TEMP-STORAGE                          24060099
               ADD +1                TO ASC-BLK-SUB                     24070099
               PERFORM 5100-WRITE-TEMP-STORAGE                          24080099
                                                                        24090099
               MOVE 1                TO ASC-BLK-SUB                     24100099
                                        PV-BLOCK-NUMBER                 24110099
               PERFORM 4410-READ-TEMP-STORAGE                           24120099
               IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             24130099
                   MOVE 2            TO ASC-BLK-SUB                     24140099
                                        PV-BLOCK-NUMBER                 24150099
                   PERFORM 4410-READ-TEMP-STORAGE                       24160099
               END-IF                                                   24170099
           END-IF.                                                      24180099
       EJECT                                                            24190099
      *----------------------------------------------------------------*24200099
      *    FETCH THE DISCREPANCY CURSOR.                               *24210099
      *----------------------------------------------------------------*24220099
                                                                        24230099
       4310-FETCH.                                                      24240099
                                                                        24250099
           PERFORM                                                      24260099
               WITH TEST AFTER                                          24270099
               VARYING PV-SQL-SUB                                       24280099
               FROM 1 BY 1                                              24290099
               UNTIL PV-SQL-SUB GREATER THAN PC-MAX-RETRIES             24300099
                  OR SQLCODE = 0                                        24310099
                  OR SQLCODE = +100                                     24320099
                 EXEC SQL                                               24330099
                   FETCH DISCREP-CSR                                    24340099
                   INTO  :TFITEM-XFER-LNE-NBR                           24350099
                       , :TFITEM-KOHLS-UPC-NBR                          24390099
                       , :TFITEM-XFER-PRIC-AMT                          24400099
                       , :TFITEM-XFER-QTY                               24410099
                       , :TFITEM-ITM-NBR                                24411099
      *                , :TFITEM-RCVD-XFER-QTY                          24420099
      *                , :TFITEM-RCVD-XFER-PRIC-AMT                     24430099
                 END-EXEC                                               24440099
                                                                        24450099
               EVALUATE TRUE                                            24460099
                   WHEN SQLCODE = ZERO                                  24470099
                       PERFORM 4320-SELECT-DEPT-CLASS                   24471099
                   WHEN SQLCODE = +100                                  24480099
                       SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE              24481099
                   WHEN OTHER                                           24500099
                       MOVE '4310-FETCH-CURSOR'                         24520099
                                        TO DP013-PARAGRAPH              24530099
                       MOVE 'FETCH DISCREPANCY CURSOR'                  24540099
                                        TO DP013-MESSAGE-TEXT (1)       24550099
                       MOVE SQLCA       TO DP013-SQLCA                  24560099
                       SET DP013-DB2-ABEND                              24570099
                                        TO TRUE                         24580099
                       PERFORM DP013-0000-PROCESS-ABEND                 24590099
               END-EVALUATE                                             24600099
           END-PERFORM.                                                 24610099
                                                                        24620099
                                                                        24670099
       EJECT                                                            24680099
                                                                        24681099
       4320-SELECT-DEPT-CLASS.                                          24682099
           INITIALIZE DCLTSKXREF.                                       24683099
                                                                        24684099
           EXEC SQL                                                     24685099
               SELECT  DEPT                                             24686099
                      ,CLASS                                            24687099
                      ,SUBCLASS                                         24688099
                 INTO  :SKXREF-DEPT                                     24689099
                      ,:SKXREF-CLASS                                    24689199
                      ,:SKXREF-SUBCLASS                                 24689299
                 FROM  TSKXREF                                          24689399
                WHERE  ITM_NBR  =  :TFITEM-ITM-NBR                      24689499
           END-EXEC.                                                    24689599
                                                                        24689699
           EVALUATE TRUE                                                24689799
               WHEN SQLCODE = ZERO                                      24689899
                    CONTINUE                                            24689999
               WHEN SQLCODE = +100                                      24690099
                   MOVE TFITEM-KOHLS-UPC-NBR TO PV-HOLD-UPC-NBR-9       24690199
                   MOVE PV-KOHLS-DEPT TO SKXREF-DEPT                    24690299
                   MOVE PV-KOHLS-CL-9 TO SKXREF-SUBCLASS                24690399
                   MOVE ZERO          TO PV-KOHLS-CL-2                  24690499
                   MOVE PV-KOHLS-CL-9 TO SKXREF-CLASS                   24690599
               WHEN OTHER                                               24690699
                    MOVE '4320-SELECT-DEPT-CLASS'                       24690899
                                     TO DP013-PARAGRAPH                 24690999
                    MOVE 'SELECT DEPARTMENT'                            24691099
                                     TO DP013-MESSAGE-TEXT (1)          24691199
                    MOVE 'TSKXREF '  TO DP013-DB2-TABLE-NAME (1)        24691299
                    MOVE SQLCA       TO DP013-SQLCA                     24691399
                    SET DP013-DB2-ABEND                                 24691499
                                     TO TRUE                            24691599
                    PERFORM DP013-0000-PROCESS-ABEND                    24691699
           END-EVALUATE.                                                24691799
                                                                        24691899
      *----------------------------------------------------------------*24692099
      * MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *24700099
      *----------------------------------------------------------------*24710099
                                                                        24720099
       4400-MOVE-COMMAREA-TO-SCREEN.                                    24730099
           MOVE ASC-FROM-STORE-NBR     TO MR-FROM-STORE-NBR             24740099
                                          PV-XFER-FROM-STORE-NBR.       24750099
           MOVE ASC-XFER-SEQ-NBR       TO PV-XFER-SEQ-NBR.              24760099
           MOVE PV-XFER-NBR            TO MR-XFER-NBR.                  24770099
           MOVE ASC-NET-DISCREPANCY    TO MR-NET-DISCREP.               24780099
           MOVE ASC-TO-STORE-NBR       TO MR-TO-STORE-NBR.              24790099
           MOVE ASC-RECV-STORE-NBR     TO MR-RECV-STORE-NBR.            24800099
           MOVE ASC-FROM-STORE-NAME    TO MR-FROM-STORE-NAME.           24810099
           MOVE ASC-TO-STORE-NAME      TO MR-TO-STORE-NAME.             24820099
           MOVE ASC-RECV-STORE-NAME    TO MR-RECV-STORE-NAME.           24830099
           MOVE ASC-RECV-STORE-NAME    TO MR-RECV-STORE-NAME.           24840099
           IF ASC-CONTNR-TYP-CDE = PC-TRAILER                           24850099
               MOVE PC-TRAILER-SEAL-LIT     TO MR-SEAL-LIT1             24860099
               MOVE PC-TRAILER-NBR-LIT      TO MR-SEAL-LIT2             24870099
               MOVE SPACES                  TO MR-SEAL-LIT3             24880099
           END-IF.                                                      24890099
           MOVE ASC-RECV-LG-SEAL1-TRLR      TO MR-RCV-LG-SEAL1.         24900099
           MOVE ASC-RECV-LG-SEAL2-TRLR      TO MR-RCV-LG-SEAL2.         24910099
           MOVE ASC-RECV-SM-SEAL            TO MR-RCV-SM-SEAL.          24920099
           MOVE ASC-XFER-LG-SEAL1-TRLR      TO MR-CMP-LG-SEAL1.         24930099
           MOVE ASC-XFER-LG-SEAL2-TRLR      TO MR-CMP-LG-SEAL2.         24940099
           MOVE ASC-XFER-SM-SEAL            TO MR-CMP-SM-SEAL.          24950099
           IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             24960099
               AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          24970099
               OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          24980099
                   MOVE +1    TO ASC-BLK-SUB                            24990099
                   PERFORM 5100-WRITE-TEMP-STORAGE                      25000099
                   ADD +1     TO ASC-BLK-SUB                            25010099
                   PERFORM 5100-WRITE-TEMP-STORAGE                      25020099
                   DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             25030099
                       GIVING PV-BLOCK-NUMBER                           25040099
                       REMAINDER PV-REMAINDER                           25050099
                   IF  PV-REMAINDER > ZERO                              25060099
                       ADD +1 TO PV-BLOCK-NUMBER                        25070099
                   END-IF                                               25080099
                   MOVE +1    TO ASC-BLK-SUB                            25090099
                   PERFORM 4410-READ-TEMP-STORAGE                       25100099
                   ADD +1     TO ASC-BLK-SUB                            25110099
                                 PV-BLOCK-NUMBER                        25120099
                   PERFORM 4410-READ-TEMP-STORAGE                       25130099
           END-IF.                                                      25140099
           MOVE +1            TO ASC-BLK-SUB.                           25150099
           COMPUTE ASC-ITEM-SUB =                                       25160099
               ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              25170099
               + PC-ITEMS-PER-PANEL).                                   25180099
      *                                                                 25190099
           IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        25200099
               ADD +1         TO ASC-BLK-SUB                            25210099
               SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            25220099
           END-IF.                                                      25230099
      *                                                                 25240099
           COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           25250099
               ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                25260099
           PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        25270099
           MOVE +1                       TO PV-SAVE-SUB.                25280099
           PERFORM 4420-FORMAT-LIST-LINES                               25290099
               VARYING PV-SUB                                           25300099
               FROM PC-ITEMS-PER-PANEL BY -1                            25310099
               UNTIL PV-SUB < +1.                                       25320099
      *                                                                 25330099
           COMPUTE ASC-ITEMS-DISPLAYED =                                25340099
               ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          25350099
           MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    25360099
                                            MR-START.                   25370099
           MOVE ASC-ITEM-AT-BOT-OF-PANEL TO MR-END.                     25380099
           MOVE ASC-NUMBER-OF-ITEMS-READ TO MR-TOTAL.                   25390099
      *                                                                 25400099
           IF  DP020-MSG-NUMBER-X = SPACE                               25410099
               IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  25420099
      *            --- MORE ITEMS TO DISPLAY ----                       25430099
                   MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            25440099
                   SET DP020-MSG-INFORMATIONAL TO TRUE                  25450099
               END-IF                                                   25460099
           END-IF.                                                      25470099
      *----------------------------------------------------------------*25480099
      *    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *25490099
      *----------------------------------------------------------------*25500099
                                                                        25510099
       4410-READ-TEMP-STORAGE.                                          25520099
                                                                        25530099
           EXEC CICS                                                    25540099
               READQ TS                                                 25550099
                   QUEUE (ASC-LIST-QUEUE-NAME)                          25560099
                   INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               25570099
                   ITEM  (PV-BLOCK-NUMBER)                              25580099
                   RESP  (PV-CICS-RESP)                                 25590099
           END-EXEC.                                                    25600099
                                                                        25610099
           IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       25620099
             OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     25630099
               CONTINUE                                                 25640099
           ELSE                                                         25650099
               SET DP013-CICS-ABEND     TO TRUE                         25660099
               SET DP013-NO-ROLLBACK    TO TRUE                         25670099
               MOVE '4410-READ-TEMP-STORAGE'                            25680099
                                        TO DP013-PARAGRAPH              25690099
               MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      25700099
                                        TO DP013-MESSAGE-TEXT(1)        25710099
               PERFORM DP013-0000-PROCESS-ABEND                         25720099
           END-IF.                                                      25730099
                                                                        25740099
           SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             25750099
      *                                                                 25760099
           IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         25770099
               INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               25780099
           END-IF.                                                      25790099
       EJECT                                                            25800099
      *----------------------------------------------------------------*25810099
      *    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *25820099
      *----------------------------------------------------------------*25830099
                                                                        25840099
       4420-FORMAT-LIST-LINES.                                          25850099
           IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      25860099
               SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                25870099
               MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           25880099
               MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)           25890099
               MOVE SPACE              TO MR-SELECT           (PV-SUB)  25900099
                                          MR-ACTION           (PV-SUB)  25910099
                                          MR-LINE-NBR-X       (PV-SUB)  25920099
                                          MR-DPT-CL-SUBCL     (PV-SUB)  25930099
                                          MR-UPC              (PV-SUB)  25940099
                                          MR-TQTY-X           (PV-SUB)  25950099
                                          MR-RQTY-X           (PV-SUB)  25960099
                                          MR-TPRICE-X         (PV-SUB)  25970099
                                          MR-RPRICE-X         (PV-SUB)  25980099
                                          MR-VARIANCE         (PV-SUB)  25990099
           ELSE                                                         26000099
               IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      26010099
                                                         > SPACE        26020099
                   MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 26030099
                                       TO MR-SELECT (PV-SUB)            26040099
               ELSE                                                     26050099
                   MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      26060099
                                       TO MR-SELECT (PV-SUB)            26070099
               END-IF                                                   26080099
      *                                                                 26090099
               IF  PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL           26100099
                   MOVE ASC-ACTION   (ASC-BLK-SUB ASC-ITEM-SUB)         26110099
                                       TO MR-ACTION (PV-SUB)            26120099
                   IF ASC-TPRICE    (ASC-BLK-SUB ASC-ITEM-SUB)          26130099
                      = ASC-RPRICE  (ASC-BLK-SUB ASC-ITEM-SUB)          26140099
                   OR (ASC-RPRICE    (ASC-BLK-SUB ASC-ITEM-SUB)         26150099
                          = ZERO                                        26160099
                   AND ASC-RQTY      (ASC-BLK-SUB ASC-ITEM-SUB)         26170099
                          = ZERO)                                       26180099
                   OR PV-SUB = 1                                        26190099
                       MOVE ASC-LINE-NBR (ASC-BLK-SUB ASC-ITEM-SUB)     26200099
                                       TO MR-LINE-NBR (PV-SUB)          26210099
                       MOVE ASC-DEPT     (ASC-BLK-SUB ASC-ITEM-SUB)     26220099
                                       TO PV-DEPT                       26230099
                       IF ASC-CLASS (ASC-BLK-SUB ASC-ITEM-SUB)          26233099
                                                   < PC-100 AND         26234099
                        ASC-SUBCLASS (ASC-BLK-SUB ASC-ITEM-SUB)         26235099
                                                   < PC-100             26236099
                        MOVE ASC-CLASS                                  26237099
                        (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-CLASS-1        26238099
                        MOVE ASC-SUBCLASS                               26239099
                        (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-SUBCLASS-1     26240099
                       ELSE IF                                          26250099
                        ASC-CLASS (ASC-BLK-SUB ASC-ITEM-SUB)            26260099
                                                   < PC-100 AND         26270099
                        ASC-SUBCLASS (ASC-BLK-SUB ASC-ITEM-SUB)         26270199
                                                   > PC-099             26270299
                        MOVE ASC-CLASS                                  26270399
                        (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-CLASS-2        26270499
                        MOVE ASC-SUBCLASS                               26270599
                        (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-SUBCLASS-2     26270699
                        MOVE SPACES TO PV-FILLER-2A                     26270799
                                       PV-FILLER-2B                     26270899
                       ELSE IF                                          26270999
                        ASC-CLASS (ASC-BLK-SUB ASC-ITEM-SUB)            26271099
                                                   > PC-099 AND         26271199
                        ASC-SUBCLASS (ASC-BLK-SUB ASC-ITEM-SUB)         26271299
                                                   < PC-100             26271399
                        MOVE ASC-CLASS                                  26271499
                        (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-CLASS-3        26271599
                        MOVE ASC-SUBCLASS                               26271699
                        (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-SUBCLASS-3     26271799
                        MOVE SPACES TO PV-FILLER-3A                     26271899
                                       PV-FILLER-3B                     26271999
                       ELSE IF                                          26272099
                        ASC-CLASS (ASC-BLK-SUB ASC-ITEM-SUB)            26272199
                                                   > PC-099 AND         26272299
                        ASC-SUBCLASS (ASC-BLK-SUB ASC-ITEM-SUB)         26272399
                                                   > PC-099             26272499
                        MOVE ASC-CLASS                                  26272599
                        (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-CLASS-4        26272699
                        MOVE ASC-SUBCLASS                               26272799
                        (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-SUBCLASS-4     26272899
                        MOVE SPACES TO PV-FILLER-4A                     26272999
                       END-IF                                           26273099
                       END-IF                                           26273199
                       END-IF                                           26273299
                       END-IF                                           26273399
                       MOVE PV-DPT-CL-SUBCL TO MR-DPT-CL-SUBCL (PV-SUB) 26280099
                       MOVE ASC-UPC      (ASC-BLK-SUB ASC-ITEM-SUB)     26290099
                                       TO PV-UPC                        26300099
                       MOVE '-'            TO PV-UPC-DASH-1             26310099
                                          PV-UPC-DASH-2                 26320099
                                          PV-UPC-DASH-3                 26330099
                       MOVE PV-UPC         TO MR-UPC (PV-SUB)           26340099
                       IF (ASC-TPRICE   (ASC-BLK-SUB ASC-ITEM-SUB)      26350099
                          = ASC-RPRICE  (ASC-BLK-SUB ASC-ITEM-SUB)      26360099
                       OR ASC-RPRICE    (ASC-BLK-SUB ASC-ITEM-SUB)      26370099
                          = ZERO)                                       26380099
                        AND ASC-TQTY    (ASC-BLK-SUB ASC-ITEM-SUB)      26390099
                          > ZERO                                        26400099
                           MOVE ASC-TQTY   (ASC-BLK-SUB ASC-ITEM-SUB)   26410099
                                       TO MR-TQTY     (PV-SUB)          26420099
                           MOVE ASC-TPRICE (ASC-BLK-SUB ASC-ITEM-SUB)   26430099
                                       TO MR-TPRICE   (PV-SUB)          26440099
                       ELSE                                             26450099
                           MOVE SPACE  TO MR-TQTY-X   (PV-SUB)          26460099
                                          MR-TPRICE-X (PV-SUB)          26470099
                       END-IF                                           26480099
                   ELSE                                                 26490099
                       MOVE SPACE      TO MR-LINE-NBR-X   (PV-SUB)      26500099
                                          MR-DPT-CL-SUBCL (PV-SUB)      26510099
                                          MR-UPC      (PV-SUB)          26520099
                                          MR-TQTY-X   (PV-SUB)          26530099
                                          MR-TPRICE-X (PV-SUB)          26540099
                   END-IF                                               26550099
                   IF ASC-RQTY     (ASC-BLK-SUB ASC-ITEM-SUB) > 0       26560099
                       MOVE ASC-RQTY (ASC-BLK-SUB ASC-ITEM-SUB)         26570099
                                       TO MR-RQTY     (PV-SUB)          26580099
                       MOVE ASC-RPRICE (ASC-BLK-SUB ASC-ITEM-SUB)       26590099
                                       TO MR-RPRICE   (PV-SUB)          26600099
                   ELSE                                                 26610099
                       MOVE SPACE      TO MR-RQTY-X   (PV-SUB)          26620099
                                          MR-RPRICE-X (PV-SUB)          26630099
                   END-IF                                               26640099
                   MOVE ASC-VARIANCE (ASC-BLK-SUB ASC-ITEM-SUB)         26650099
                                       TO MR-VARIANCE (PV-SUB)          26660099
               END-IF                                                   26670099
               IF ASC-TPRICE    (ASC-BLK-SUB ASC-ITEM-SUB)              26680099
                      NOT = ASC-RPRICE  (ASC-BLK-SUB ASC-ITEM-SUB)      26690099
                 AND (ASC-RPRICE    (ASC-BLK-SUB ASC-ITEM-SUB)          26700099
                      NOT = ZERO                                        26710099
                 OR  ASC-RQTY      (ASC-BLK-SUB ASC-ITEM-SUB)           26720099
                      NOT = ZERO)                                       26730099
                   MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)       26740099
                   MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)       26750099
               ELSE                                                     26760099
                   MOVE PV-SUB             TO PV-SAVE-SUB               26770099
               END-IF                                                   26780099
      *                                                                 26790099
               IF  DP030-SET-CURSOR-TRAILER                             26800099
                   IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)26810099
                       > SPACE)                                         26820099
                     OR (PV-SUB = 1))                                   26830099
                      SET DP030-SET-CURSOR-APPL-1 TO TRUE               26840099
                      MOVE -1          TO MR-SELECTL (PV-SAVE-SUB)      26850099
                   END-IF                                               26860099
               END-IF                                                   26870099
           END-IF.                                                      26880099
           SUBTRACT +1 FROM ASC-ITEM-SUB                                26890099
           IF  ASC-ITEM-SUB < + 1                                       26900099
               MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  26910099
               MOVE +1                 TO ASC-BLK-SUB                   26920099
           END-IF.                                                      26930099
      ******************************************************************26940099
      ** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **26950099
      ** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **26960099
      ** ISSUE A WARNING.                                             **26970099
      ******************************************************************26980099
       4430-CHECK-FOR-BEGIN-AND-END.                                    26990099
           IF  ASC-START-OF-SELECTED-RANGE > ZERO                       27000099
               IF  ASC-END-OF-SELECTED-RANGE = ZERO                     27010099
      *            -- NO END-OF-RANGE SPECFIED ---                      27020099
                   MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            27030099
                   SET DP020-MSG-WARNING TO TRUE                        27040099
                   PERFORM 4431-POSITION-AT-WARNING                     27050099
               END-IF                                                   27060099
           ELSE                                                         27070099
               IF  ASC-END-OF-SELECTED-RANGE > ZERO                     27080099
      *            -- NO BEGINNING-OF-RANGE SPECFIED ---                27090099
                   MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            27100099
                   SET DP020-MSG-WARNING TO TRUE                        27110099
                   PERFORM 4431-POSITION-AT-WARNING                     27120099
               END-IF                                                   27130099
           END-IF.                                                      27140099
      ******************************************************************27150099
      ** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **27160099
      ** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **27170099
      ** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **27180099
      ** POSITION THE CURSOR THERE.                                   **27190099
      ******************************************************************27200099
       4431-POSITION-AT-WARNING.                                        27210099
           COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 27220099
                          - PV-TOP-ITEM + 1.                            27230099
           IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      27240099
               CONTINUE                                                 27250099
           ELSE                                                         27260099
               SET DP030-SET-CURSOR-APPL-1                              27270099
                                         TO TRUE                        27280099
               MOVE -1                   TO MR-SELECTL (PV-SUB)         27290099
               MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         27300099
               MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         27310099
           END-IF.                                                      27320099
      *                                                                 27330099
           COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   27340099
                          - PV-TOP-ITEM + 1.                            27350099
           IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      27360099
               CONTINUE                                                 27370099
           ELSE                                                         27380099
               SET DP030-SET-CURSOR-APPL-1                              27390099
                                         TO TRUE                        27400099
               MOVE -1                   TO MR-SELECTL (PV-SUB)         27410099
               MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         27420099
               MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         27430099
           END-IF.                                                      27440099
       EJECT                                                            27450099
      *----------------------------------------------------------------*27460099
      * PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *27470099
      * ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *27480099
      * FOR THE SELECTED ITEMS QUEUE.                                  *27490099
      *                                                                *27500099
      * FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *27510099
      * QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *27520099
      * THE ARRAY IS FULL.                                             *27530099
      *----------------------------------------------------------------*27540099
                                                                        27550099
       5000-PREPARE-SEL-QUEUE.                                          27560099
                                                                        27570099
           MOVE +1                   TO  ASC-BLK-SUB.                   27580099
           PERFORM 5100-WRITE-TEMP-STORAGE.                             27590099
           ADD +1                    TO  ASC-BLK-SUB.                   27600099
           PERFORM 5100-WRITE-TEMP-STORAGE.                             27610099
                                                                        27620099
           MOVE ASC-SEL-QUEUE-NAME   TO  TF003-SEL-QUEUE-NAME.          27630099
           PERFORM 6010-DELETE-SEL-QUEUE.                               27640099
                                                                        27650099
           SET ASC-UPDATE-TSQ        TO  TRUE.                          27660099
                                                                        27670099
           SET TF002-IDX             TO  1.                             27680099
           MOVE ZERO                 TO TF003-NUMBER-OF-TS-ITEMS.       27690099
           INITIALIZE TF002-SELECTED-ITEM-ARRAY.                        27700099
           PERFORM 5200-FILL-SEL-QUEUE-RECORD                           27710099
                   VARYING PV-ITEM                                      27720099
                   FROM 1 BY 1                                          27730099
                   UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     27740099
                                                                        27750099
           IF  TF002-IDX > 1                                            27760099
               PERFORM 5205-WRITE-SEL-QUEUE                             27770099
               ADD +1                TO TF003-NUMBER-OF-TS-ITEMS        27780099
           END-IF.                                                      27790099
       EJECT                                                            27800099
      *----------------------------------------------------------------*27810099
      *    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *27820099
      *    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *27830099
      *----------------------------------------------------------------*27840099
                                                                        27850099
       5100-WRITE-TEMP-STORAGE.                                         27860099
           MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     27870099
                                         TO PV-LIST-ITEM-NUMBER.        27880099
           COMPUTE PV-BLOCK-NUMBER =                                    27890099
               1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    27900099
                                                                        27910099
           IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             27920099
           OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             27930099
               IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      27940099
                   PERFORM 5105-REWRITE-ASC-LISTQ                       27950099
               END-IF                                                   27960099
           ELSE                                                         27970099
               COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       27980099
               ASC-HIGHEST-BLOCK-WRITTEN + 1                            27990099
               PERFORM 5110-WRITE-ASC-LISTQ                             28000099
               ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   28010099
           END-IF.                                                      28020099
                                                                        28030099
           SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             28040099
      ******************************************************************28050099
      ** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **28060099
      ** SPECIFIC COMMAREA.                                           **28070099
      ******************************************************************28080099
       5105-REWRITE-ASC-LISTQ.                                          28090099
           EXEC CICS                                                    28100099
               WRITEQ TS                                                28110099
                   QUEUE (ASC-LIST-QUEUE-NAME)                          28120099
                   FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               28130099
                   ITEM  (PV-BLOCK-NUMBER)                              28140099
                   REWRITE                                              28150099
                   RESP  (PV-CICS-RESP)                                 28160099
           END-EXEC.                                                    28170099
                                                                        28180099
           IF  PV-CICS-RESP = DFHRESP(NORMAL)                           28190099
               CONTINUE                                                 28200099
           ELSE                                                         28210099
               SET DP013-CICS-ABEND            TO TRUE                  28220099
               SET DP013-NO-ROLLBACK           TO TRUE                  28230099
               MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       28240099
               MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     28250099
                                               TO DP013-MESSAGE-TEXT(1) 28260099
               PERFORM DP013-0000-PROCESS-ABEND                         28270099
           END-IF.                                                      28280099
                                                                        28290099
      ******************************************************************28300099
      ** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **28310099
      ** SPECIFIC COMMAREA.                                           **28320099
      ******************************************************************28330099
       5110-WRITE-ASC-LISTQ.                                            28340099
           EXEC CICS                                                    28350099
               WRITEQ TS                                                28360099
                   QUEUE (ASC-LIST-QUEUE-NAME)                          28370099
                   FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               28380099
                   ITEM  (PV-BLOCK-NUMBER)                              28390099
                   RESP  (PV-CICS-RESP)                                 28400099
           END-EXEC.                                                    28410099
           IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      28420099
               SET DP013-CICS-ABEND      TO TRUE                        28430099
               SET DP013-NO-ROLLBACK     TO TRUE                        28440099
               MOVE '5110-WRITE-ASC-LISTQ'                              28450099
                                         TO DP013-PARAGRAPH             28460099
               MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           28470099
                                         TO DP013-MESSAGE-TEXT(1)       28480099
               PERFORM DP013-0000-PROCESS-ABEND                         28490099
           END-IF.                                                      28500099
       EJECT                                                            28510099
      *----------------------------------------------------------------*28520099
      * READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *28530099
      * TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *28540099
      *----------------------------------------------------------------*28550099
                                                                        28560099
       5200-FILL-SEL-QUEUE-RECORD.                                      28570099
                                                                        28580099
           PERFORM 6112-READ-LIST-QUEUE.                                28590099
                                                                        28600099
           IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       28610099
               PERFORM                                                  28620099
               VARYING LQW-IDX                                          28630099
               FROM 1 BY 1                                              28640099
               UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            28650099
                 OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          28660099
                                                                        28670099
                   IF  LQW-SELECT (LQW-IDX)                             28680099
                       MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              28690099
                                         TO TF002-ITEM (TF002-IDX)      28700099
                       MOVE LQW-LINE-NBR  (LQW-IDX)                     28710099
                                         TO TF002-LINE-NBR              28720099
                                              (TF002-IDX)               28730099
                       MOVE SPACE        TO TF002-ACTION-SW (TF002-IDX) 28740099
                       SET TF002-IDX UP BY 1                            28750099
                       IF  TF002-IDX > TF002-MAX-ITEMS                  28760099
                           PERFORM 5205-WRITE-SEL-QUEUE                 28770099
                           ADD +1        TO TF003-NUMBER-OF-TS-ITEMS    28780099
                           INITIALIZE TF002-SELECTED-ITEM-ARRAY         28790099
                           SET TF002-IDX TO  1                          28800099
                       END-IF                                           28810099
                   END-IF                                               28820099
               END-PERFORM                                              28830099
           END-IF.                                                      28840099
                                                                        28850099
      *----------------------------------------------------------------*28860099
      *    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *28870099
      *----------------------------------------------------------------*28880099
                                                                        28890099
       5205-WRITE-SEL-QUEUE.                                            28900099
                                                                        28910099
           MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            28920099
                                         TO TF002-SELECTED-ITEMS.       28930099
                                                                        28940099
           EXEC CICS                                                    28950099
                WRITEQ TS                                               28960099
                    QUEUE (ASC-SEL-QUEUE-NAME)                          28970099
                    FROM  (TF002-TRANSFER-SEL-REC)                      28980099
                    ITEM  (PV-SEL-QUEUE-ITEM)                           28990099
                    RESP  (PV-CICS-RESP)                                29000099
           END-EXEC.                                                    29010099
                                                                        29020099
           IF  PV-CICS-RESP = DFHRESP (NORMAL)                          29030099
               CONTINUE                                                 29040099
           ELSE                                                         29050099
               SET DP013-CICS-ABEND      TO TRUE                        29060099
               SET DP013-NO-ROLLBACK     TO TRUE                        29070099
               MOVE '5205-WRITE-SEL-QUEUE'                              29080099
                                         TO DP013-PARAGRAPH             29090099
               MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          29100099
                                         TO DP013-MESSAGE-TEXT(1)       29110099
               PERFORM DP013-0000-PROCESS-ABEND                         29120099
           END-IF.                                                      29130099
       EJECT                                                            29140099
      *----------------------------------------------------------------*29150099
      *  READ THE TRANSFER ITEM POSTING TABLE TO DETERMINE IF THE LINE *29160099
      *  BEING PROCESSED HAS A MANUAL ADJUSTMENT.                      *29170099
      *----------------------------------------------------------------*29180099
       5300-READ-ADJUSTMENTS.                                           29190099
           PERFORM                                                      29200099
               WITH TEST AFTER                                          29210099
               VARYING PV-RETRY-COUNTER                                 29220099
               FROM 1 BY 1                                              29230099
               UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               29240099
                         OR (SQLCODE = ZERO)                            29250099
                         OR (SQLCODE = +100))                           29260099
      *                                                                 29270099
               EXEC SQL                                                 29280099
                   SELECT DISTINCT P.XFER_LNE_NBR                       29290099
                       INTO  :TFITPS-XFER-LNE-NBR                       29300099
                       FROM  TTFITPS P                                  29310099
                           , TTFAJRS A                                  29320099
                       WHERE P.XFER_LNE_NBR  = :TFITEM-XFER-LNE-NBR AND 29330099
                             P.ADJ_RSN_CDE   = A.ADJ_RSN_CDE  AND       29340099
                             P.XFER_DKEY_ID  = :DK-XFER-DKEY-ID AND     29350099
                             A.SYS_RSN_IND   = 'N'                      29360099
               END-EXEC                                                 29370099
                                                                        29380099
               EVALUATE TRUE                                            29390099
                   WHEN SQLCODE = ZERO                                  29400099
                      MOVE 'ADJ'         TO ASC-ACTION                  29410099
                                         (ASC-BLK-SUB ASC-ITEM-SUB)     29420099
                   WHEN SQLCODE = +100                                  29430099
                   WHEN SQLCODE = -904                                  29440099
                   WHEN SQLCODE = -913                                  29450099
                       CONTINUE                                         29460099
                   WHEN OTHER                                           29470099
                       MOVE '5300-READ-ADJUSTMENTS'                     29500099
                                         TO DP013-PARAGRAPH             29510099
                       MOVE 'SELECT TRANSFER DATA'                      29520099
                                         TO DP013-MESSAGE-TEXT (1)      29530099
                       MOVE SQLCA        TO DP013-SQLCA                 29540099
                       MOVE 'TTFITEM'    TO DP013-DB2-TABLE-NAME (1)    29550099
                       MOVE 'TTFAJRS'    TO DP013-DB2-TABLE-NAME (2)    29560099
                       MOVE 'TTFITPS'    TO DP013-DB2-TABLE-NAME (3)    29570099
                       SET DP013-DB2-ABEND                              29580099
                           DP013-XCTL-DISPLAY-RESTART                   29590099
                                         TO TRUE                        29600099
                       PERFORM DP013-0000-PROCESS-ABEND                 29610099
               END-EVALUATE                                             29620099
           END-PERFORM.                                                 29630099
      *                                                                 29640099
           IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        29650099
               MOVE '5300-READ-ADJUSTMENTS'                             29660099
                                         TO DP013-PARAGRAPH             29670099
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     29680099
                                         TO DP013-MESSAGE-TEXT (1)      29690099
               MOVE 'TRANSFER DATA'      TO DP013-MESSAGE-TEXT (2)      29700099
               MOVE SQLCA                TO DP013-SQLCA                 29710099
               MOVE 'TTFITEM '           TO DP013-DB2-TABLE-NAME (1)    29720099
               MOVE 'TTFAJRS'            TO DP013-DB2-TABLE-NAME (2)    29730099
               MOVE 'TTFITPS'            TO DP013-DB2-TABLE-NAME (3)    29740099
               SET DP013-DB2-ABEND                                      29750099
                   DP013-XCTL-DISPLAY-RESTART                           29760099
                                         TO TRUE                        29770099
               PERFORM DP013-0000-PROCESS-ABEND                         29780099
           END-IF.                                                      29790099
       EJECT                                                            29800099
      *----------------------------------------------------------------*29810099
      *  GET THE TOTAL RECIEVED QTY & PRICE.                           *29820099
      *----------------------------------------------------------------*29830099
       5400-READ-ITEM-RECEIPT.                                          29840099
           PERFORM WITH TEST AFTER                                      29850099
               VARYING PV-RETRY-COUNTER FROM 1 BY 1                     29860099
                 UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES                29870099
                    OR SQLCODE = ZERO                                   29880099
                    OR SQLCODE = +100                                   29890099
               EXEC SQL                                                 29900099
                   SELECT  RCVD_XFER_PRIC_AMT                           29910099
                         , RCVD_XFER_QTY                                29920099
                       INTO :TFITRC-RCVD-XFER-PRIC-AMT                  29930099
                           ,:TFITRC-RCVD-XFER-QTY                       29940099
                       FROM TTFITRC I                                   29950099
                           ,TTFSTAT S                                   29960099
                   WHERE                                                29970099
                      I.XFER_DKEY_ID     = :DK-XFER-DKEY-ID        AND  29980099
                      S.XFER_DKEY_ID     = I.XFER_DKEY_ID          AND  29990099
                      S.XFER_STAT_CDE    = :PC-POSITIVE-RECEIPT    AND  30000099
                      S.XFER_STAT_TMST   = I.XFER_RCPT_TMST        AND  30010099
                      RCVD_XFER_PRIC_AMT = :TFITEM-XFER-PRIC-AMT   AND  30020099
                      XFER_LNE_NBR       = :TFITEM-XFER-LNE-NBR         30030099
               END-EXEC                                                 30040099
               EVALUATE TRUE                                            30050099
                   WHEN SQLCODE = ZERO                                  30060099
                   WHEN SQLCODE = +100                                  30070099
                   WHEN SQLCODE = -904                                  30080099
                   WHEN SQLCODE = -913                                  30090099
                       CONTINUE                                         30100099
                   WHEN OTHER                                           30110099
                       MOVE '5400-READ-ITEM-RECEIPT'                    30140099
                                         TO DP013-PARAGRAPH             30150099
                       MOVE 'READ DATA FROM TTFITRC'                    30160099
                                         TO DP013-MESSAGE-TEXT (1)      30170099
                       MOVE SQLCA        TO DP013-SQLCA                 30180099
                       MOVE 'TTFITRC'    TO DP013-DB2-TABLE-NAME (1)    30190099
                       SET DP013-DB2-ABEND                              30200099
                           DP013-XCTL-DISPLAY-RESTART                   30210099
                                         TO TRUE                        30220099
                       PERFORM DP013-0000-PROCESS-ABEND                 30230099
               END-EVALUATE                                             30240099
           END-PERFORM.                                                 30250099
      *                                                                 30260099
           IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        30270099
               MOVE '5400-READ-ITEM-RECEIPT'                            30280099
                                         TO DP013-PARAGRAPH             30290099
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     30300099
                                         TO DP013-MESSAGE-TEXT (1)      30310099
               MOVE 'DATA FROM TTFITRC'  TO DP013-MESSAGE-TEXT (2)      30320099
               MOVE SQLCA                TO DP013-SQLCA                 30330099
               MOVE 'TTFITRC'            TO DP013-DB2-TABLE-NAME (1)    30340099
               SET DP013-DB2-ABEND                                      30350099
                   DP013-XCTL-DISPLAY-RESTART                           30360099
                                         TO TRUE                        30370099
               PERFORM DP013-0000-PROCESS-ABEND                         30380099
           END-IF.                                                      30390099
           IF SQLCODE = +100                                            30400099
               MOVE ZEROES               TO TFITRC-RCVD-XFER-QTY        30410099
                                            TFITRC-RCVD-XFER-PRIC-AMT   30420099
           END-IF.                                                      30430099
       EJECT                                                            30440099
      *----------------------------------------------------------------*30450099
      *  GET THE FROM AND TO STORE NAMES FOR DISPLAY.                  *30460099
      *----------------------------------------------------------------*30470099
       5500-GET-STORE-NAMES.                                            30480099
           MOVE ASC-FROM-STORE-NBR       TO DK-STORE-NBR.               30490099
100404     PERFORM 5550-READ-XST-LOC.                                   30500099
100404     MOVE XST00001-LOC-10-ABBR-NM  TO ASC-FROM-STORE-NAME.        30510099
           MOVE ASC-TO-STORE-NBR         TO DK-STORE-NBR.               30520099
100404     PERFORM 5550-READ-XST-LOC.                                   30530099
100404     MOVE XST00001-LOC-10-ABBR-NM  TO ASC-TO-STORE-NAME.          30540099
       EJECT                                                            30550099
      *----------------------------------------------------------------*30560099
      *  GET THE 10 CHARACTER ABBREVIATED STORE NAME.                  *30570099
      *----------------------------------------------------------------*30580099
100404 5550-READ-XST-LOC.                                               30590099
           PERFORM WITH TEST AFTER                                      30600099
               VARYING PV-RETRY-COUNTER                                 30610099
               FROM 1 BY 1                                              30620099
               UNTIL (PV-RETRY-COUNTER > PC-MAX-RETRIES)                30630099
                    OR SQLCODE = ZERO                                   30640099
                    OR SQLCODE = +100                                   30650099
               EXEC SQL                                                 30651099
100404             SELECT LOC_10_ABBR_NM                                30652099
100404                 INTO :XST00001-LOC-10-ABBR-NM                    30653099
100404                 FROM XST_LOC                                     30654099
100404                 WHERE (LOC_NBR  = :DK-STORE-NBR)                 30655099
               END-EXEC                                                 30656099
               EVALUATE TRUE                                            30720099
                   WHEN SQLCODE = ZERO                                  30721099
                   WHEN SQLCODE = -904                                  30721199
                   WHEN SQLCODE = -913                                  30721299
                       CONTINUE                                         30722099
                   WHEN SQLCODE = +100                                  30750099
100404                 MOVE 'INVALID'     TO XST00001-LOC-10-ABBR-NM    30760099
                   WHEN OTHER                                           30790099
                       MOVE '5550-READ-XST-LOC'                         30820099
                                         TO DP013-PARAGRAPH             30830099
                       MOVE 'SELECT A ROW FROM XST-LOC'                 30840099
                                         TO DP013-MESSAGE-TEXT (1)      30850099
                       MOVE SQLCA        TO DP013-SQLCA                 30860099
                       MOVE 'XST_LOC'    TO DP013-DB2-TABLE-NAME (1)    30870099
                       SET DP013-DB2-ABEND                              30880099
                           DP013-XCTL-DISPLAY-RESTART                   30890099
                                         TO TRUE                        30900099
                       PERFORM DP013-0000-PROCESS-ABEND                 30910099
               END-EVALUATE                                             30920099
           END-PERFORM.                                                 30930099
                                                                        30940099
      *                                                                 30950099
           IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        30960099
               MOVE '5550-READ-XST-LOC'                                 30970099
                                         TO DP013-PARAGRAPH             30980099
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     30990099
                                         TO DP013-MESSAGE-TEXT (1)      31000099
               MOVE 'A ROW FROM XST_LOC' TO DP013-MESSAGE-TEXT (2)      31010099
               MOVE SQLCA                TO DP013-SQLCA                 31020099
               MOVE 'XST_LOC'            TO DP013-DB2-TABLE-NAME (1)    31030099
               SET DP013-DB2-ABEND                                      31040099
                   DP013-XCTL-DISPLAY-RESTART                           31050099
                                         TO TRUE                        31060099
               PERFORM DP013-0000-PROCESS-ABEND                         31070099
           END-IF.                                                      31080099
       EJECT                                                            31090099
      *----------------------------------------------------------------*31100099
      * OPEN THE TRANSFER RECEIPT CURSOR.                              *31110099
      *----------------------------------------------------------------*31120099
                                                                        31130099
       5600-OPEN-RECEIPT-CURSOR.                                        31140099
           PERFORM                                                      31150099
               WITH TEST AFTER                                          31160099
               VARYING PV-RETRY-COUNTER                                 31170099
               FROM 1 BY 1                                              31180099
               UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               31190099
                         OR (SQLCODE = ZERO))                           31200099
                   EXEC SQL                                             31210099
                        OPEN XFER-RECEIPT-CSR                           31220099
                   END-EXEC                                             31230099
                                                                        31240099
               EVALUATE TRUE                                            31250099
                   WHEN SQLCODE = ZERO                                  31260099
                   WHEN SQLCODE = -904                                  31270099
                   WHEN SQLCODE = -913                                  31280099
                       CONTINUE                                         31290099
                   WHEN OTHER                                           31300099
                       MOVE '5600-OPEN-RECEIPT-CURSOR'                  31330099
                                         TO DP013-PARAGRAPH             31340099
                       MOVE 'OPEN TRANSFER ITEM RECEIPT CURSOR - '      31350099
                                         TO DP013-MESSAGE-TEXT (1)      31360099
                       MOVE SQLCA        TO DP013-SQLCA                 31370099
                       MOVE 'TTFITRC '   TO DP013-DB2-TABLE-NAME (1)    31380099
                       SET DP013-DB2-ABEND                              31390099
                           DP013-XCTL-DISPLAY-RESTART TO TRUE           31400099
                       PERFORM DP013-0000-PROCESS-ABEND                 31410099
               END-EVALUATE                                             31420099
           END-PERFORM.                                                 31430099
      *                                                                 31440099
           IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        31450099
               MOVE '5600-OPEN-RECEIPT-CURSOR'                          31460099
                                         TO DP013-PARAGRAPH             31470099
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   31480099
                                         TO DP013-MESSAGE-TEXT (1)      31490099
               MOVE SQLCA                TO DP013-SQLCA                 31500099
               MOVE 'TTFITRC '           TO DP013-DB2-TABLE-NAME (1)    31510099
               SET DP013-DB2-ABEND                                      31520099
                   DP013-XCTL-DISPLAY-RESTART                           31530099
                                         TO TRUE                        31540099
               PERFORM DP013-0000-PROCESS-ABEND                         31550099
           END-IF.                                                      31560099
                                                                        31570099
       EJECT                                                            31580099
      *----------------------------------------------------------------*31590099
      *    READ THE ITEMS FROM THE TRANSFER RECEIPT DATABASE WHERE     *31600099
      *    THE RECEIPT PRICE IS NOT EQUAL TO THE TRANSFER PRICE AND    *31610099
      *    CONTINUE BUILDING THE BLOCKS IN THE ARRAY.                  *31620099
      *----------------------------------------------------------------*31630099
                                                                        31640099
       5700-READ-RECEIPT-ITEMS.                                         31650099
                                                                        31660099
           PERFORM                                                      31670099
               VARYING PV-READ-COUNT                                    31680099
               FROM 1 BY 1                                              31690099
               UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    31700099
                  OR (ASC-NO-ITEMS-LEFT-ON-DB-2))                       31710099
                                                                        31720099
               PERFORM 5750-FETCH-RECEIPT-CURSOR                        31730099
                                                                        31740099
               IF  ASC-ITEMS-LEFT-ON-DB-2                               31750099
                   IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                31760099
                       ADD +1            TO ASC-ITEM-SUB                31770099
                   ELSE                                                 31780099
                       ADD +1            TO ASC-BLK-SUB                 31790099
                       MOVE +1           TO ASC-ITEM-SUB                31800099
                                                                        31810099
                       IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         31820099
                           MOVE +1       TO ASC-BLK-SUB                 31830099
                           SET ASC-BLOCK-MODIFIED (1)                   31840099
                                         TO TRUE                        31850099
                           PERFORM 5100-WRITE-TEMP-STORAGE              31860099
                           MOVE ASC-BLOCK-ENTRIES                       31870099
                                     (PC-MAX-BLOCKS-IN-ARRAY)           31880099
                                      TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 31890099
                           ADD +1        TO ASC-BLK-SUB                 31900099
                           INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   31910099
                           SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      31920099
                                         TO TRUE                        31930099
                       END-IF                                           31940099
                   END-IF                                               31950099
                   ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    31960099
                   MOVE ASC-NUMBER-OF-ITEMS-READ                        31970099
                                         TO ASC-LIST-ITEM-NUMBER        31980099
                                             (ASC-BLK-SUB ASC-ITEM-SUB) 31990099
                   MOVE TFITEM-XFER-LNE-NBR              TO             32000099
                           ASC-LINE-NBR      (ASC-BLK-SUB ASC-ITEM-SUB) 32010099
                   MOVE SKXREF-DEPT                      TO             32020099
                           ASC-DEPT          (ASC-BLK-SUB ASC-ITEM-SUB) 32030099
                   MOVE SKXREF-CLASS                     TO             32040099
                           ASC-CLASS         (ASC-BLK-SUB ASC-ITEM-SUB) 32050099
                   MOVE SKXREF-SUBCLASS                  TO             32060099
                           ASC-SUBCLASS      (ASC-BLK-SUB ASC-ITEM-SUB) 32070099
                   MOVE TFITEM-KOHLS-UPC-NBR             TO             32080099
                           ASC-UPC           (ASC-BLK-SUB ASC-ITEM-SUB) 32090099
                   MOVE TFITEM-XFER-QTY                  TO             32100099
                           ASC-TQTY          (ASC-BLK-SUB ASC-ITEM-SUB) 32110099
                   MOVE TFITRC-RCVD-XFER-QTY             TO             32120099
                           ASC-RQTY          (ASC-BLK-SUB ASC-ITEM-SUB) 32130099
                   MOVE TFITEM-XFER-PRIC-AMT             TO             32140099
                           ASC-TPRICE        (ASC-BLK-SUB ASC-ITEM-SUB) 32150099
                   MOVE TFITRC-RCVD-XFER-PRIC-AMT        TO             32160099
                           ASC-RPRICE        (ASC-BLK-SUB ASC-ITEM-SUB) 32170099
                   COMPUTE PV-VARIANCE =                                32180099
                     ((0) -                                             32190099
                     (TFITRC-RCVD-XFER-QTY * TFITRC-RCVD-XFER-PRIC-AMT))32200099
                   END-COMPUTE                                          32210099
                   MOVE PV-VARIANCE      TO PV-EDITTED-VARIANCE         32220099
                   IF PV-VARIANCE < ZERO                                32230099
                       MOVE '('          TO PV-EDIT-V-PAREN-1           32240099
                       MOVE ')'          TO PV-EDIT-V-PAREN-2           32250099
                   ELSE                                                 32260099
                       MOVE SPACE        TO PV-EDIT-V-PAREN-1           32270099
                                            PV-EDIT-V-PAREN-2           32280099
                   END-IF                                               32290099
                   MOVE PV-EDITTED-VARIANCE-FIELD                       32300099
                                         TO ASC-VARIANCE                32310099
                                            (ASC-BLK-SUB ASC-ITEM-SUB)  32320099
               END-IF                                                   32330099
           END-PERFORM.                                                 32340099
      *----------------------------------------------------------------*32350099
      *    FETCH THE TRANSFER RECEIPT CURSOR.                          *32360099
      *----------------------------------------------------------------*32370099
                                                                        32380099
       5750-FETCH-RECEIPT-CURSOR.                                       32390099
                                                                        32400099
           EXEC SQL                                                     32410099
               FETCH XFER-RECEIPT-CSR                                   32420099
               INTO   :TFITRC-RCVD-XFER-PRIC-AMT                        32430099
                    , :TFITRC-RCVD-XFER-QTY                             32440099
           END-EXEC                                                     32450099
                                                                        32460099
           EVALUATE TRUE                                                32470099
               WHEN SQLCODE = ZERO                                      32480099
                    CONTINUE                                            32490099
               WHEN SQLCODE = +100                                      32500099
                    SET ASC-NO-ITEMS-LEFT-ON-DB-2                       32510099
                                         TO TRUE                        32520099
               WHEN OTHER                                               32530099
                    MOVE '5750-FETCH-RECEIPT-CURSOR'                    32550099
                                     TO DP013-PARAGRAPH                 32560099
                    MOVE 'FETCH TRANSFER ITEM CURSOR'                   32570099
                                     TO DP013-MESSAGE-TEXT (1)          32580099
                    MOVE 'TTFITEM '  TO DP013-DB2-TABLE-NAME (1)        32590099
                    MOVE SQLCA       TO DP013-SQLCA                     32600099
                    SET DP013-DB2-ABEND                                 32610099
                                     TO TRUE                            32620099
                    PERFORM DP013-0000-PROCESS-ABEND                    32630099
           END-EVALUATE.                                                32640099
                                                                        32650099
       EJECT                                                            32660099
      *----------------------------------------------------------------*32670099
      * CLOSE THE TRANSFER RECEIPT CURSOR.                             *32680099
      *----------------------------------------------------------------*32690099
                                                                        32700099
       5800-CLOSE-RECEIPT-CURSOR.                                       32710099
           EXEC SQL                                                     32720099
               CLOSE XFER-RECEIPT-CSR                                   32730099
           END-EXEC                                                     32740099
      *                                                                 32750099
           EVALUATE TRUE                                                32760099
               WHEN SQLCODE = ZERO                                      32770099
                   CONTINUE                                             32780099
               WHEN OTHER                                               32790099
                   MOVE '5800-CLOSE-RECEIPT-CURSOR'                     32820099
                                     TO DP013-PARAGRAPH                 32830099
                   MOVE 'CLOSE TRANSFER RECEIPT CURSOR '                32840099
                                     TO DP013-MESSAGE-TEXT (1)          32850099
                   MOVE SQLCA        TO DP013-SQLCA                     32860099
                   MOVE 'TTFITRC '   TO DP013-DB2-TABLE-NAME (1)        32870099
                   SET DP013-DB2-ABEND                                  32880099
                       DP013-XCTL-DISPLAY-RESTART TO TRUE               32890099
                   PERFORM DP013-0000-PROCESS-ABEND                     32900099
           END-EVALUATE.                                                32910099
                                                                        32920099
       EJECT                                                            32930099
      ******************************************************************32940099
      ** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **32950099
      ** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **32960099
      ** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **32970099
      ** THE USER.                                                    **32980099
      ******************************************************************32990099
       6000-REFRESH-PANEL-FROM-TEMP.                                    33000099
           IF  ASC-UPDATE-TSQ                                           33010099
               SET ASC-NO-TSQ-UPDATE TO TRUE                            33020099
               MOVE ZERO                 TO PV-SAVE-ITEM                33030099
                                            PV-SEL-QUEUE-ITEM           33040099
               MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        33050099
                                         TO PV-HOLD-SELECTED-ITEMS      33060099
               MOVE +1                   TO PV-ITEMS-PROCESSED          33070099
               PERFORM 6100-UPDATE-TSQ                                  33080099
                   UNTIL PV-ITEMS-PROCESSED >                           33090099
                                           PV-HOLD-SELECTED-ITEMS       33100099
               PERFORM 6010-DELETE-SEL-QUEUE                            33110099
               INITIALIZE ASC-BLOCK-ENTRIES (1)                         33120099
                          ASC-BLOCK-ENTRIES (2)                         33130099
           END-IF.                                                      33140099
                                                                        33150099
      *----------------------------------------------------------------*33160099
      *    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *33170099
      *----------------------------------------------------------------*33180099
       6010-DELETE-SEL-QUEUE.                                           33190099
                                                                        33200099
           EXEC CICS                                                    33210099
               DELETEQ TS                                               33220099
                   QUEUE (ASC-SEL-QUEUE-NAME)                           33230099
                   RESP  (PV-CICS-RESP)                                 33240099
           END-EXEC.                                                    33250099
      *                                                                 33260099
           IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      33270099
              (PV-CICS-RESP = DFHRESP(QIDERR)))                         33280099
               CONTINUE                                                 33290099
           ELSE                                                         33300099
               SET DP013-CICS-ABEND TO TRUE                             33310099
               SET DP013-NO-ROLLBACK TO TRUE                            33320099
               MOVE '6010-DELETE-SEL-QUEUE'                             33330099
                              TO DP013-PARAGRAPH                        33340099
               MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         33350099
                              TO DP013-MESSAGE-TEXT (1)                 33360099
               PERFORM DP013-0000-PROCESS-ABEND                         33370099
           END-IF.                                                      33380099
                                                                        33390099
      *----------------------------------------------------------------*33400099
      *    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *33410099
      *    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *33420099
      *    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *33430099
      *    THE TEMP QUEUE.                                             *33440099
      *----------------------------------------------------------------*33450099
                                                                        33460099
       6100-UPDATE-TSQ.                                                 33470099
                                                                        33480099
           ADD 1                     TO  PV-SEL-QUEUE-ITEM.             33490099
           PERFORM 6105-READ-SEL-QUEUE.                                 33500099
           PERFORM                                                      33510099
               VARYING TF002-IDX                                        33520099
               FROM 1 BY 1                                              33530099
               UNTIL ((PV-ITEMS-PROCESSED >                             33540099
                                    PV-HOLD-SELECTED-ITEMS)             33550099
               OR (TF002-IDX GREATER THAN TF002-MAX-ITEMS))             33560099
               IF  TF002-ACTION-SW (TF002-IDX) > SPACE                  33570099
                   PERFORM 6110-PROCESS-ITEMS                           33580099
               END-IF                                                   33590099
               ADD +1                TO PV-ITEMS-PROCESSED              33600099
           END-PERFORM.                                                 33610099
           PERFORM 6111-WRITE-LIST-QUEUE.                               33620099
      *----------------------------------------------------------------*33630099
      *    READ THE LIST QUEUE RECORD.                                 *33640099
      *----------------------------------------------------------------*33650099
                                                                        33660099
       6105-READ-SEL-QUEUE.                                             33670099
                                                                        33680099
           EXEC CICS                                                    33690099
                READQ TS                                                33700099
                    QUEUE (ASC-SEL-QUEUE-NAME)                          33710099
                    INTO  (TF002-TRANSFER-SEL-REC)                      33720099
                    ITEM  (PV-SEL-QUEUE-ITEM)                           33730099
                    RESP  (PV-CICS-RESP)                                33740099
           END-EXEC.                                                    33750099
      *                                                                 33760099
           IF  PV-CICS-RESP = DFHRESP (NORMAL)                          33770099
               CONTINUE                                                 33780099
           ELSE                                                         33790099
               SET DP013-CICS-ABEND      TO  TRUE                       33800099
               SET DP013-NO-ROLLBACK     TO  TRUE                       33810099
               MOVE '6105-READ-SEL-QUEUE'                               33820099
                                         TO  DP013-PARAGRAPH            33830099
               MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           33840099
                                         TO  DP013-MESSAGE-TEXT(1)      33850099
               PERFORM DP013-0000-PROCESS-ABEND                         33860099
           END-IF.                                                      33870099
       EJECT                                                            33880099
      *----------------------------------------------------------------*33890099
      *    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*33900099
      *    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*33910099
      *    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *33920099
      *----------------------------------------------------------------*33930099
                                                                        33940099
       6110-PROCESS-ITEMS.                                              33950099
                                                                        33960099
           COMPUTE PV-ITEM = 1 + ((TF002-ITEM (TF002-IDX) - 1)          33970099
                           / PC-ITEMS-PER-PANEL).                       33980099
                                                                        33990099
           IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           34000099
               IF  PV-SAVE-ITEM NOT EQUAL ZERO                          34010099
                   PERFORM 6111-WRITE-LIST-QUEUE                        34020099
               END-IF                                                   34030099
               MOVE PV-ITEM          TO PV-SAVE-ITEM                    34040099
                                                                        34050099
               PERFORM 6112-READ-LIST-QUEUE                             34060099
               IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               34070099
                   CONTINUE                                             34080099
               END-IF                                                   34090099
           END-IF.                                                      34100099
                                                                        34110099
           COMPUTE PV-SUB = (TF002-ITEM (TF002-IDX)                     34120099
                          - LQW-LIST-ITEM-NUMBER (1)) + 1.              34130099
           SET LQW-DESELECT (PV-SUB) TO    TRUE                         34140099
           MOVE LQW-SELECTED-SW (PV-SUB)                                34150099
                                     TO LQW-TEMP-SELECTED-SW (PV-SUB).  34160099
      *    EVALUATE TRUE                                                34170099
      *        WHEN TF002-INQ (TF002-IDX)                               34180099
      *             MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             34190099
      *                                                                 34200099
      *        WHEN TF002-UPD (TF002-IDX)                               34210099
      *             MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             34220099
      *                                                                 34230099
      *        WHEN TF002-DEL (TF002-IDX)                               34240099
      *             MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             34250099
      *                                                                 34260099
      *        WHEN TF002-ERR (TF002-IDX)                               34270099
      *             MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             34280099
      *    END-EVALUATE.                                                34290099
                                                                        34300099
           SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                34310099
                                                                        34320099
      *----------------------------------------------------------------*34330099
      *    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *34340099
      *----------------------------------------------------------------*34350099
                                                                        34360099
       6111-WRITE-LIST-QUEUE.                                           34370099
                                                                        34380099
           EXEC CICS                                                    34390099
               WRITEQ TS                                                34400099
                   QUEUE (ASC-LIST-QUEUE-NAME)                          34410099
                   FROM  (LQW-LIST-QUEUE-WORK-AREA)                     34420099
                   ITEM  (PV-SAVE-ITEM)                                 34430099
                   REWRITE                                              34440099
                   RESP  (PV-CICS-RESP)                                 34450099
           END-EXEC.                                                    34460099
      *                                                                 34470099
           IF  PV-CICS-RESP = DFHRESP (NORMAL)                          34480099
               CONTINUE                                                 34490099
           ELSE                                                         34500099
               SET DP013-CICS-ABEND  TO  TRUE                           34510099
               SET DP013-NO-ROLLBACK TO  TRUE                           34520099
               MOVE '6111-WRITE-LIST-QUEUE'                             34530099
                                     TO  DP013-PARAGRAPH                34540099
               MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  34550099
                                     TO  DP013-MESSAGE-TEXT(1)          34560099
               PERFORM DP013-0000-PROCESS-ABEND                         34570099
           END-IF.                                                      34580099
                                                                        34590099
       EJECT                                                            34600099
      *----------------------------------------------------------------*34610099
      *    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*34620099
      *----------------------------------------------------------------*34630099
                                                                        34640099
       6112-READ-LIST-QUEUE.                                            34650099
                                                                        34660099
           EXEC CICS                                                    34670099
               READQ TS                                                 34680099
                   QUEUE (ASC-LIST-QUEUE-NAME)                          34690099
                   INTO  (LQW-LIST-QUEUE-WORK-AREA)                     34700099
                   ITEM  (PV-ITEM)                                      34710099
                   RESP  (PV-CICS-RESP)                                 34720099
           END-EXEC.                                                    34730099
      *                                                                 34740099
           IF  PV-CICS-RESP = DFHRESP (NORMAL)                          34750099
               CONTINUE                                                 34760099
           ELSE                                                         34770099
               SET DP013-CICS-ABEND        TO TRUE                      34780099
               SET DP013-NO-ROLLBACK       TO TRUE                      34790099
               MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           34800099
               MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    34810099
                                           TO DP013-MESSAGE-TEXT(1)     34820099
               PERFORM DP013-0000-PROCESS-ABEND                         34830099
           END-IF.                                                      34840099
                                                                        34850099
       EJECT                                                            34860099
      *----------------------------------------------------------------*34870099
      *  READ THE TRANSFER RECEIPT TABLE FOR THE RECEIVED STORE NUMBER.*34880099
      *----------------------------------------------------------------*34890099
       6200-READ-TRANSFER-RECEIPT.                                      34900099
           PERFORM WITH TEST AFTER                                      34910099
               VARYING PV-RETRY-COUNTER FROM 1 BY 1                     34920099
                 UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES                34930099
                    OR SQLCODE = ZERO                                   34940099
                    OR SQLCODE = +100                                   34950099
               EXEC SQL                                                 34960099
                   SELECT  R.STR_NBR                                    34970099
100404                   , S.LOC_10_ABBR_NM                             34980099
                      INTO :TFRCPT-STR-NBR                              34990099
100404                   , :XST00001-LOC-10-ABBR-NM                     35000099
                      FROM TTFRCPT R                                    35010099
100404                   , XST_LOC S                                    35020099
                         , TTFSTAT ST                                   35030099
                      WHERE ST.XFER_STAT_CDE = :PC-POSITIVE-RECEIPT AND 35040099
                            ST.XFER_STAT_TMST = R.RCV_XFER_BEG_TMST AND 35050099
                            R.XFER_DKEY_ID   = :DK-XFER-DKEY-ID     AND 35060099
                            ST.XFER_DKEY_ID  = :DK-XFER-DKEY-ID     AND 35070099
100404                      S.LOC_NBR        = R.STR_NBR                35080099
               END-EXEC                                                 35090099
               EVALUATE TRUE                                            35100099
                   WHEN SQLCODE = -904                                  35110099
                   WHEN SQLCODE = -913                                  35120099
                   WHEN SQLCODE = +100                                  35130099
                       CONTINUE                                         35140099
                   WHEN SQLCODE = ZERO                                  35150099
                       MOVE TFRCPT-STR-NBR                              35160099
                                          TO ASC-RECV-STORE-NBR         35170099
100404                 MOVE XST00001-LOC-10-ABBR-NM                     35180099
                                          TO ASC-RECV-STORE-NAME        35190099
                   WHEN OTHER                                           35200099
                       MOVE '6200-READ-TRANSFER-RECEIPT'                35230099
                                         TO DP013-PARAGRAPH             35240099
                       MOVE 'SELECT DATA FROM TTFRCPT'                  35250099
                                         TO DP013-MESSAGE-TEXT (1)      35260099
                       MOVE SQLCA        TO DP013-SQLCA                 35270099
                       MOVE 'TTFRCPT'    TO DP013-DB2-TABLE-NAME (1)    35280099
                       MOVE 'XST_LOC'    TO DP013-DB2-TABLE-NAME (2)    35290099
                       MOVE 'TTFSTAT'    TO DP013-DB2-TABLE-NAME (3)    35300099
                       SET DP013-DB2-ABEND                              35310099
                           DP013-XCTL-DISPLAY-RESTART                   35320099
                                         TO TRUE                        35330099
                       PERFORM DP013-0000-PROCESS-ABEND                 35340099
               END-EVALUATE                                             35350099
           END-PERFORM.                                                 35360099
      *                                                                 35370099
           IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        35380099
               MOVE '6200-READ-TRANSFER-RECEIPT'                        35390099
                                         TO DP013-PARAGRAPH             35400099
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     35410099
                                         TO DP013-MESSAGE-TEXT (1)      35420099
               MOVE 'DATA FROM TTFRCPT'  TO DP013-MESSAGE-TEXT (2)      35430099
               MOVE SQLCA                TO DP013-SQLCA                 35440099
               MOVE 'TTFRCPT'            TO DP013-DB2-TABLE-NAME (1)    35450099
               MOVE 'XST_LOC'            TO DP013-DB2-TABLE-NAME (2)    35460099
               MOVE 'TTFSTAT'            TO DP013-DB2-TABLE-NAME (3)    35470099
               SET DP013-DB2-ABEND                                      35480099
                   DP013-XCTL-DISPLAY-RESTART                           35490099
                                         TO TRUE                        35500099
               PERFORM DP013-0000-PROCESS-ABEND                         35510099
           END-IF.                                                      35520099
       EJECT                                                            35530099
      *----------------------------------------------------------------*35540099
      *  PRODUCE THE DRS REPORT.                                       *35550099
      *----------------------------------------------------------------*35560099
       6300-PRINT-LIST.                                                 35570099
                                                                        35580099
           PERFORM 6310-INITIALIZE.                                     35590099
           MOVE PC-PUT                 TO DRS01-DRRB-FUNC.              35600099
           SET PS-FIRST-LINE           TO TRUE.                         35610099
           PERFORM 6320-READ-LIST-QUEUE                                 35620099
                   VARYING PV-ITEM                                      35630099
                   FROM 1 BY 1                                          35640099
                   UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     35650099
           IF PS-FIRST-TIME                                             35660099
               PERFORM 8200-PRINT-HEADINGS                              35670099
               MOVE ND-NO-DETAIL-LINE      TO DRS01-COMM-DATA           35680099
               MOVE PC-DOUBLE-SPACE        TO DRS01-COMM-CTL            35690099
               PERFORM 8000-LINK-TO-DRS                                 35700099
           END-IF.                                                      35710099
                                                                        35720099
           MOVE PC-TERM                TO DRS01-DRRB-FUNC.              35730099
           PERFORM 8000-LINK-TO-DRS.                                    35740099
                                                                        35750099
      *----------------------------------------------------------------*35760099
      *  INITIALIZE VARIABLES FOR THE DRS FACILITY.                    *35770099
      *----------------------------------------------------------------*35780099
       6310-INITIALIZE.                                                 35790099
           PERFORM 8100-FORMAT-TIME.                                    35800099
                                                                        35810099
           IF TF001-PRINTER-DEST = 'XXXX'                               35820099
               MOVE 'R'                TO DRS02-DRIB-CLASS              35830099
               MOVE 'N'                TO DRS02-DRIB-HOLD               35840099
               MOVE 'LOCAL'            TO DRS02-DRIB-DEST               35850099
           ELSE                                                         35860099
               MOVE 'A'                TO DRS02-DRIB-CLASS              35870099
               MOVE 'N'                TO DRS02-DRIB-HOLD               35880099
               MOVE TF001-PRINTER-DEST TO DRS02-DRIB-DEST               35890099
           END-IF.                                                      35900099
                                                                        35910099
           MOVE PC-INIT                TO DRS01-DRRB-FUNC.              35920099
           MOVE DRS02-DRIB-HEADER      TO DRS01-COMM-DRIB-HDR.          35930099
           MOVE DRS02-DRIB-ATTRIB      TO DRS01-COMM-DRIB-AT1.          35940099
                                                                        35950099
           PERFORM 8000-LINK-TO-DRS.                                    35960099
                                                                        35970099
           MOVE PC-CURRENT-PROGRAM-NAME TO DP132O-PROGRAM-NAME.         35980099
           MOVE 1                       TO DP132O-REPORT-NUMBER.        35990099
           MOVE ASC-NET-DISCREPANCY     TO HL5-NET-DISCREP.             36000099
           MOVE ASC-CRIT-XFER-NBR-9     TO HL3-XFER-NBR.                36010099
           MOVE '-'                     TO HL3-XFER-NBR-DASH.           36020099
           MOVE ASC-FROM-STORE-NBR      TO HL3-FR-STORE-NBR.            36030099
           MOVE ASC-FROM-STORE-NAME     TO HL3-FR-STORE-NAME.           36040099
           MOVE ASC-TO-STORE-NBR        TO HL4-TO-STORE-NBR.            36050099
           MOVE ASC-TO-STORE-NAME       TO HL4-TO-STORE-NAME.           36060099
           MOVE ASC-RECV-STORE-NBR      TO HL5-RC-STORE-NBR.            36070099
           MOVE ASC-RECV-STORE-NAME     TO HL5-RC-STORE-NAME.           36080099
           MOVE ASC-XFER-LG-SEAL1-TRLR         TO HL4-SEAL-1.           36090099
           MOVE ASC-XFER-LG-SEAL2-TRLR         TO HL5-SEAL-1.           36100099
           MOVE ASC-RECV-LG-SEAL1-TRLR         TO HL4-SEAL-2.           36110099
           MOVE ASC-RECV-LG-SEAL2-TRLR         TO HL5-SEAL-2.           36120099
           EVALUATE ASC-CONTNR-TYP-CDE                                  36130099
               WHEN PC-TRAILER                                          36140099
                   MOVE PC-TRAILER-NBR-LIT     TO HL4-SEAL-LITERAL      36150099
                   MOVE PC-TRAILER-SEAL-LIT    TO HL5-SEAL-LITERAL      36160099
                   MOVE SPACES                 TO HL6-SEAL-LITERAL      36170099
               WHEN OTHER                                               36180099
                   MOVE ASC-XFER-SM-SEAL       TO HL6-SEAL-1            36190099
                   MOVE ASC-RECV-SM-SEAL       TO HL6-SEAL-2            36200099
           END-EVALUATE.                                                36210099
           MOVE 99                      TO PV-LINE-COUNT.               36220099
           MOVE 0                       TO PV-PAGE-COUNT.               36230099
      *----------------------------------------------------------------*36240099
      * READ A LIST QUEUE RECORD AND GENERATE THE DRS DETAIL LINE FOR  *36250099
      * EACH LINE IN THE BLOCK.                                        *36260099
      *----------------------------------------------------------------*36270099
                                                                        36280099
       6320-READ-LIST-QUEUE.                                            36290099
                                                                        36300099
           PERFORM 6112-READ-LIST-QUEUE.                                36310099
                                                                        36320099
           IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       36330099
               PERFORM 6330-PRINT-REPORT                                36340099
                 VARYING LQW-IDX                                        36350099
                   FROM 1 BY 1                                          36360099
                   UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL        36370099
                     OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO      36380099
           END-IF.                                                      36390099
       EJECT                                                            36400099
      *----------------------------------------------------------------*36410099
      * MOVE THE DATA TO THE DETAIL LINE AND PRINT.                    *36420099
      *----------------------------------------------------------------*36430099
       6330-PRINT-REPORT.                                               36440099
           IF PV-LINE-COUNT > PC-LINE-MAX                               36450099
               PERFORM 8200-PRINT-HEADINGS                              36460099
           END-IF.                                                      36470099
           MOVE SPACES                   TO DL1-DETAIL-LINE-1.          36480099
           IF LQW-TPRICE (LQW-IDX) = LQW-RPRICE (LQW-IDX)   OR          36490099
              LQW-RPRICE (LQW-IDX) = ZERO                   OR          36500099
              PS-FIRST-LINE                                             36510099
               MOVE LQW-LINE-NBR            (LQW-IDX)                   36520099
                                         TO DL1-LINE                    36530099
               MOVE LQW-ACTION              (LQW-IDX)                   36540099
                                         TO DL1-ACTION                  36550099
               MOVE LQW-DEPT                (LQW-IDX)                   36560099
                                         TO DL1-DEPT                    36570099
               IF LQW-CLASS (LQW-IDX) < PC-100 AND                      36570199
                  LQW-SUBCLASS (LQW-IDX) < PC-100                       36570299
                   MOVE LQW-CLASS (LQW-IDX) TO DL1-CLASS-1              36570399
                   MOVE LQW-SUBCLASS (LQW-IDX) TO DL1-SUBCLASS-1        36570499
               ELSE IF                                                  36570599
                  LQW-CLASS (LQW-IDX) < PC-100 AND                      36570699
                  LQW-SUBCLASS (LQW-IDX) > PC-099                       36570799
                   MOVE LQW-CLASS (LQW-IDX)        TO DL1-CLASS-2       36570899
                   MOVE LQW-SUBCLASS (LQW-IDX) TO DL1-SUBCLASS-2        36570999
                   MOVE SPACES TO DL1-FILLER-2A                         36571099
                                  DL1-FILLER-2B                         36571199
               ELSE IF                                                  36571299
                  LQW-CLASS (LQW-IDX) > PC-099 AND                      36571399
                  LQW-SUBCLASS (LQW-IDX) < PC-100                       36571499
                   MOVE LQW-CLASS (LQW-IDX)        TO DL1-CLASS-3       36571599
                   MOVE LQW-SUBCLASS (LQW-IDX) TO DL1-SUBCLASS-3        36571699
                   MOVE SPACES TO DL1-FILLER-3A                         36571799
                                  DL1-FILLER-3B                         36571899
               ELSE IF                                                  36571999
                  LQW-CLASS (LQW-IDX) > PC-099 AND                      36572099
                  LQW-SUBCLASS (LQW-IDX) > PC-099                       36572199
                   MOVE LQW-CLASS (LQW-IDX)        TO DL1-CLASS-4       36572299
                   MOVE LQW-SUBCLASS (LQW-IDX) TO DL1-SUBCLASS-4        36572399
                   MOVE SPACES TO DL1-FILLER-4A                         36572499
               END-IF                                                   36572599
               END-IF                                                   36572699
               END-IF                                                   36572799
               END-IF                                                   36572899
               MOVE LQW-UPC                 (LQW-IDX)                   36620099
                                         TO DL1-UPC                     36630099
               MOVE '-'                  TO DL1-UPC-DASH-1              36640099
                                            DL1-UPC-DASH-2              36650099
                                            DL1-UPC-DASH-3              36660099
               IF LQW-TQTY (LQW-IDX) > 0                                36690099
                   MOVE LQW-TQTY            (LQW-IDX)                   36700099
                                         TO DL1-TQTY                    36710099
                   MOVE LQW-TPRICE          (LQW-IDX)                   36720099
                                         TO DL1-TPRICE                  36730099
               END-IF                                                   36740099
           END-IF.                                                      36750099
           IF LQW-RQTY (LQW-IDX) > 0                                    36760099
               MOVE LQW-RQTY            (LQW-IDX)                       36770099
                                         TO DL1-RQTY                    36780099
               MOVE LQW-RPRICE          (LQW-IDX)                       36790099
                                         TO DL1-RPRICE                  36800099
           END-IF.                                                      36810099
           MOVE LQW-VARIANCE            (LQW-IDX)                       36820099
                                         TO DL1-VARIANCE                36830099
           MOVE DL1-DETAIL-LINE-1                                       36840099
                                         TO DRS01-COMM-DATA             36850099
           MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               36860099
           PERFORM 8000-LINK-TO-DRS.                                    36870099
           ADD 1                       TO PV-LINE-COUNT.                36880099
           IF PS-FIRST-LINE                                             36890099
               SET PS-NOT-FIRST-LINE   TO TRUE                          36900099
           END-IF.                                                      36910099
       EJECT                                                            36920099
      *----------------------------------------------------------------*36930099
      * READ THE TRANSFER ITEM DISCREPANCY TABLE TO DETERMINE THE TOTAL*36940099
      * TRANSFER AMOUNT.                                               *36950099
      *----------------------------------------------------------------*36960099
       7000-READ-TOT-TRANSFER-AMT.                                      36970099
           PERFORM WITH TEST AFTER                                      36980099
               VARYING PV-RETRY-COUNTER FROM 1 BY 1                     36990099
                 UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES                37000099
                    OR SQLCODE = ZERO                                   37010099
                    OR SQLCODE = +100                                   37020099
               EXEC SQL                                                 37030099
                   SELECT SUM(XFER_PRIC_AMT * XFER_QTY)                 37040099
                    INTO :PV-XFER-TOTAL                                 37050099
                         :PV-XFER-IND                                   37060099
                    FROM  TTFITEM I                                     37070099
                        , TTFITRC R                                     37080099
                        , TTFSTAT S                                     37090099
                    WHERE                                               37100099
                      S.XFER_DKEY_ID     = :DK-XFER-DKEY-ID     AND     37110099
                      I.XFER_DKEY_ID     = :DK-XFER-DKEY-ID     AND     37120099
                      R.XFER_DKEY_ID     = :DK-XFER-DKEY-ID     AND     37130099
                      S.XFER_STAT_CDE    = :PC-POSITIVE-RECEIPT AND     37140099
                      S.XFER_STAT_TMST   = R.XFER_RCPT_TMST     AND     37150099
                      R.XFER_LNE_NBR     = I.XFER_LNE_NBR       AND     37160099
                      R.XFER_LNE_SEQ_NBR = 1                    AND     37170099
                      EXISTS                                            37180099
                           (SELECT *                                    37190099
                            FROM TTFITRC A                              37200099
                            WHERE                                       37210099
                          A.XFER_DKEY_ID    = :DK-XFER-DKEY-ID     AND  37220099
                          S.XFER_STAT_CDE   = :PC-POSITIVE-RECEIPT AND  37230099
                          S.XFER_STAT_TMST  = A.XFER_RCPT_TMST     AND  37240099
                          A.XFER_LNE_NBR    = I.XFER_LNE_NBR       AND  37250099
                          A.XFER_ITM_DSCRP_IND = 'Y')                   37260099
               END-EXEC                                                 37270099
               EVALUATE TRUE                                            37280099
                   WHEN SQLCODE = -904                                  37290099
                   WHEN SQLCODE = -913                                  37300099
                   WHEN SQLCODE = +100                                  37310099
                   WHEN SQLCODE = ZERO                                  37320099
                       CONTINUE                                         37330099
                   WHEN OTHER                                           37340099
                       MOVE '7000-READ-TOT-TRANSFER-AMT'                37370099
                                         TO DP013-PARAGRAPH             37380099
                       MOVE 'SUMMARIZE DATA FROM TTFITEM'               37390099
                                         TO DP013-MESSAGE-TEXT (1)      37400099
                       MOVE SQLCA        TO DP013-SQLCA                 37410099
                       MOVE 'TTFITEM'    TO DP013-DB2-TABLE-NAME (1)    37420099
                       SET DP013-DB2-ABEND                              37430099
                           DP013-XCTL-DISPLAY-RESTART                   37440099
                                         TO TRUE                        37450099
                       PERFORM DP013-0000-PROCESS-ABEND                 37460099
               END-EVALUATE                                             37470099
           END-PERFORM.                                                 37480099
      *                                                                 37490099
           IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        37500099
               MOVE '7000-READ-TOT-TRANSFER-AMT'                        37510099
                                         TO DP013-PARAGRAPH             37520099
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     37530099
                                         TO DP013-MESSAGE-TEXT (1)      37540099
               MOVE 'DATA FROM TTFITEM'  TO DP013-MESSAGE-TEXT (2)      37550099
               MOVE SQLCA                TO DP013-SQLCA                 37560099
               MOVE 'TTFITEM'            TO DP013-DB2-TABLE-NAME (1)    37570099
               SET DP013-DB2-ABEND                                      37580099
                   DP013-XCTL-DISPLAY-RESTART                           37590099
                                         TO TRUE                        37600099
               PERFORM DP013-0000-PROCESS-ABEND                         37610099
           END-IF.                                                      37620099
           IF PV-XFER-IND < 0                                           37630099
               MOVE ZEROES            TO PV-XFER-TOTAL                  37640099
           END-IF.                                                      37650099
      *----------------------------------------------------------------*37660099
      * READ THE TRANSFER ITEM RECEIPT TABLE TO DETERMINE THE TOTAL    *37670099
      * RECEIVED AMOUNT.                                               *37680099
      *----------------------------------------------------------------*37690099
       7100-READ-TOT-RECEIPT-AMT.                                       37700099
           PERFORM WITH TEST AFTER                                      37710099
               VARYING PV-RETRY-COUNTER FROM 1 BY 1                     37720099
                 UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES                37730099
                    OR SQLCODE = ZERO                                   37740099
                    OR SQLCODE = +100                                   37750099
               EXEC SQL                                                 37760099
                   SELECT SUM(RCVD_XFER_PRIC_AMT * RCVD_XFER_QTY)       37770099
                    INTO :PV-RCVD-TOTAL                                 37780099
                         :PV-RCVD-IND                                   37790099
                    FROM  TTFITEM I                                     37800099
                        , TTFITRC R                                     37810099
                        , TTFSTAT S                                     37820099
                    WHERE                                               37830099
                      S.XFER_DKEY_ID     = :DK-XFER-DKEY-ID     AND     37840099
                      I.XFER_DKEY_ID     = :DK-XFER-DKEY-ID     AND     37850099
                      R.XFER_DKEY_ID     = :DK-XFER-DKEY-ID     AND     37860099
                      S.XFER_STAT_CDE    = :PC-POSITIVE-RECEIPT AND     37870099
                      S.XFER_STAT_TMST   = R.XFER_RCPT_TMST     AND     37880099
                      R.XFER_LNE_NBR     = I.XFER_LNE_NBR       AND     37890099
                      EXISTS                                            37900099
                           (SELECT *                                    37910099
                            FROM TTFITRC R                              37920099
                            WHERE                                       37930099
                          S.XFER_DKEY_ID    = :DK-XFER-DKEY-ID     AND  37940099
                          I.XFER_DKEY_ID    = :DK-XFER-DKEY-ID     AND  37950099
                          R.XFER_DKEY_ID    = :DK-XFER-DKEY-ID     AND  37960099
                          S.XFER_STAT_CDE   = :PC-POSITIVE-RECEIPT AND  37970099
                          S.XFER_STAT_TMST  = R.XFER_RCPT_TMST     AND  37980099
                          R.XFER_LNE_NBR    = I.XFER_LNE_NBR       AND  37990099
                          R.XFER_ITM_DSCRP_IND = 'Y')                   38000099
               END-EXEC                                                 38010099
               EVALUATE TRUE                                            38020099
                   WHEN SQLCODE = -904                                  38030099
                   WHEN SQLCODE = -913                                  38040099
                   WHEN SQLCODE = +100                                  38050099
                   WHEN SQLCODE = ZERO                                  38060099
                       CONTINUE                                         38070099
                   WHEN OTHER                                           38080099
                       MOVE '7100-READ-TOT-RECEIPT-AMT'                 38110099
                                         TO DP013-PARAGRAPH             38120099
                       MOVE 'SUMMARIZE DATA FROM TTFITRC'               38130099
                                         TO DP013-MESSAGE-TEXT (1)      38140099
                       MOVE SQLCA        TO DP013-SQLCA                 38150099
                       MOVE 'TTFITRC'    TO DP013-DB2-TABLE-NAME (1)    38160099
                       SET DP013-DB2-ABEND                              38170099
                           DP013-XCTL-DISPLAY-RESTART                   38180099
                                         TO TRUE                        38190099
                       PERFORM DP013-0000-PROCESS-ABEND                 38200099
               END-EVALUATE                                             38210099
           END-PERFORM.                                                 38220099
      *                                                                 38230099
           IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        38240099
               MOVE '7100-READ-TOT-RECEIPT-AMT'                         38250099
                                         TO DP013-PARAGRAPH             38260099
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     38270099
                                         TO DP013-MESSAGE-TEXT (1)      38280099
               MOVE 'DATA FROM TTFITRC'  TO DP013-MESSAGE-TEXT (2)      38290099
               MOVE SQLCA                TO DP013-SQLCA                 38300099
               MOVE 'TTFITRC'            TO DP013-DB2-TABLE-NAME (1)    38310099
               SET DP013-DB2-ABEND                                      38320099
                   DP013-XCTL-DISPLAY-RESTART                           38330099
                                         TO TRUE                        38340099
               PERFORM DP013-0000-PROCESS-ABEND                         38350099
           END-IF.                                                      38360099
           IF PV-RCVD-IND < 0                                           38370099
               MOVE ZEROES            TO PV-RCVD-TOTAL                  38380099
           END-IF.                                                      38390099
      ******************************************************************38400099
      * THIS MODULE EXECUTES A LINK TO DRS (DYNAMIC REPORT SYSTEM).     38410099
      ******************************************************************38420099
       8000-LINK-TO-DRS.                                                38430099
                                                                        38440099
           EXEC CICS                                                    38450099
               LINK                                                     38460099
                   PROGRAM   ('DRS1INTC')                               38470099
                   COMMAREA  (DRS01-COMMAREA)                           38480099
           END-EXEC.                                                    38490099
                                                                        38500099
      ******************************************************************38510099
      * FORMAT THE REPORT HEADING DATE AND TIME FIELDS.                 38520099
      ******************************************************************38530099
       8100-FORMAT-TIME.                                                38540099
                                                                        38550099
           EXEC CICS                                                    38560099
               ASKTIME ABSTIME (PV-ABSTIME)                             38570099
           END-EXEC.                                                    38580099
                                                                        38590099
           EXEC CICS                                                    38600099
               FORMATTIME ABSTIME  (PV-ABSTIME)                         38610099
                          MMDDYY   (DP132O-RUN-DATE)                    38620099
                          DATESEP  ('/')                                38630099
                          TIME     (DP132O-RUN-TIME)                    38640099
                          TIMESEP  (':')                                38650099
           END-EXEC.                                                    38660099
                                                                        38670099
       EJECT                                                            38680099
      ******************************************************************38690099
      *  PRINT THE REPORT HEADING LINES.                                38700099
      ******************************************************************38710099
       8200-PRINT-HEADINGS.                                             38720099
           IF PS-FIRST-TIME                                             38730099
               SET PS-NOT-FIRST-TIME   TO TRUE                          38740099
           END-IF.                                                      38750099
           ADD 1                       TO PV-PAGE-COUNT.                38760099
           MOVE PV-PAGE-COUNT          TO DP132O-PAGE-NUMBER.           38770099
           MOVE DP132O-STANDRD-HEADER-132-COLS                          38780099
                                       TO DRS01-COMM-DATA.              38790099
           MOVE PC-TOP-OF-PAGE         TO DRS01-COMM-CTL.               38800099
           PERFORM 8000-LINK-TO-DRS.                                    38810099
                                                                        38820099
           MOVE HL2-HEADING-LINE-2     TO DRS01-COMM-DATA.              38830099
           MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               38840099
           PERFORM 8000-LINK-TO-DRS.                                    38850099
                                                                        38860099
           MOVE HL3-HEADING-LINE-3     TO DRS01-COMM-DATA.              38870099
           MOVE PC-DOUBLE-SPACE        TO DRS01-COMM-CTL.               38880099
           PERFORM 8000-LINK-TO-DRS.                                    38890099
                                                                        38900099
           MOVE HL4-HEADING-LINE-4     TO DRS01-COMM-DATA.              38910099
           MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               38920099
           PERFORM 8000-LINK-TO-DRS.                                    38930099
                                                                        38940099
           MOVE HL5-HEADING-LINE-5     TO DRS01-COMM-DATA.              38950099
           MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               38960099
           PERFORM 8000-LINK-TO-DRS.                                    38970099
                                                                        38980099
           MOVE HL6-HEADING-LINE-6     TO DRS01-COMM-DATA.              38990099
           MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               39000099
           PERFORM 8000-LINK-TO-DRS.                                    39010099
                                                                        39020099
           MOVE HL7-HEADING-LINE-7     TO DRS01-COMM-DATA.              39030099
           MOVE PC-DOUBLE-SPACE        TO DRS01-COMM-CTL.               39040099
           PERFORM 8000-LINK-TO-DRS.                                    39050099
                                                                        39060099
           MOVE HL8-HEADING-LINE-8     TO DRS01-COMM-DATA.              39070099
           MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               39080099
           PERFORM 8000-LINK-TO-DRS.                                    39090099
                                                                        39100099
           MOVE BL-BLANK-LINE          TO DRS01-COMM-DATA.              39110099
           MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               39120099
           PERFORM 8000-LINK-TO-DRS.                                    39130099
           MOVE 09                       TO PV-LINE-COUNT.              39140099
           SET PS-FIRST-LINE           TO TRUE.                         39150099
                                                                        39160099
      *----------------------------------------------------------------*39170099
      *    ABEND PROCESSOR MODULE                                      *39180099
      *----------------------------------------------------------------*39190099
                                                                        39200099
           COPY DPPD013.                                                39210099
