       IDENTIFICATION DIVISION.                                         00010000
       PROGRAM-ID.    SUKCS806.                                         00020000
       AUTHOR.        Cognizant.                                        00030000
       INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040000
       DATE-WRITTEN.  MAY 2016.                                         00050000
       DATE-COMPILED.                                                   00060000
      *---------------------------------------------------------------  00070000
      *    S806 - getMasterCartonDetails  WEBSERVICE TRANSACTION        00080000
      *---------------------------------------------------------------  00090000
                                                                        00100000
       ENVIRONMENT DIVISION.                                            00110000
                                                                        00120000
       DATA DIVISION.                                                   00130000
                                                                        00140000
       WORKING-STORAGE SECTION.                                         00150000
         01  DK-DB2-KEYS.                                               00160000
             15  DK-SHIPT-UNT-ID           PIC S9(18)V COMP-3.          00161000
             15  DK-CHLD-MSTR-SHIPT-ID     PIC S9(18)V COMP-3.          00162000
             15  DK-UPC-NBR                PIC S9(15)V COMP-3.          00163000
             15  DK-STORE-NBR              PIC S9(04)  COMP SYNC.       00164000
                                                                        00165000
         01  PS-PROGRAM-SWITCHES.                                       00166000
           05  PS-EO-CTN-CONTENTS-CSR-SW   PIC  X(01) VALUE 'N'.        00167000
               88 PS-EO-CTN-CONTENTS-CSR              VALUE 'Y'.        00168000
               88 PS-NO-EO-CTN-CONTENTS-CSR           VALUE 'N'.        00169000
           05  PS-EO-CHILD-CARTON-CSR-SW   PIC  X(01) VALUE 'N'.        00170000
               88 PS-EO-CHILD-CARTON-CSR              VALUE 'Y'.        00170100
               88 PS-NO-EO-CHILD-CARTON-CSR           VALUE 'N'.        00170200
           05  PS-FIRST-READ-SW            PIC  X(01) VALUE 'N'.        00170300
               88 PS-FIRST-READ                       VALUE 'Y'.        00170400
               88 PS-NO-FIRST-READ                    VALUE 'N'.        00170500
           05  PS-FIRST-READ1-SW           PIC  X(01) VALUE 'N'.        00170600
               88 PS-FIRST-READ1                      VALUE 'Y'.        00170700
               88 PS-NO-FIRST-READ1                   VALUE 'N'.        00170800
           05  PS-NO-MORE-MSTR-SW          PIC  X(01) VALUE 'N'.        00170900
               88 PS-NO-MORE-MSTR                     VALUE 'Y'.        00171000
               88 PS-MORE-MSTR                        VALUE 'N'.        00171100
           05  PS-NO-MORE-CHLD-SW          PIC  X(01) VALUE 'N'.        00171200
               88 PS-NO-MORE-CHLD                     VALUE 'Y'.        00171300
               88 PS-MORE-CHLD                        VALUE 'N'.        00171400
           05  PS-TSQ-EXISTS-SW            PIC  X(01) VALUE 'N'.        00171500
               88 PS-TSQ-EXISTS                       VALUE 'Y'.        00171600
               88 PS-NO-TSQ-EXISTS                    VALUE 'N'.        00171700
         01  PC-PROGRAM-CONSTANTS.                                      00171800
      ******************************************************************00171900
      * 1044.  RESPONSE SUCCESSFUL                                      00172000
      * 1570.  A SYSTEM ERROR HAS OCCURRED - CONTACT HELP DESK          00172100
      * 3781.  MORE UPC NUMBERS AVAILABLE                               00172200
      * 3782.  CARTON ID REQUIRED                                       00172300
      * 3783.  UPC DETAILS NOT FOUND FOR THE INPUT CARTON ID            00172400
      * 3784.  INVALID CARTON ID                                        00172500
      * 3786.  MULTIPLE CARTONS ASSIGNED - PLEASE SCAN BARCODE ON 4X4   00172600
      *        LABEL                                                    00172700
      * 3787.  FUNCTION IS CURRENTLY UNAVAILABLE                        00172800
      * 3386.  MASTER CONTAINER - NO CHILD CARTONS ARE ATTACHED         00172900
      * 3387.  ERROR - MUST BE A MASTER CONTAINER TO PERFORM THIS       00173000
      *        FUNCTION.                                                00173100
      ******************************************************************00173200
           05  PC-TSYMSG-NUMBERS.                                       00173300
               10  PC-TSYMSG-01044         PIC  9(05) VALUE  01044.     00173400
               10  PC-TSYMSG-01570         PIC  9(05) VALUE  01570.     00173500
               10  PC-TSYMSG-03386         PIC  9(05) VALUE  03386.     00173600
               10  PC-TSYMSG-03781         PIC  9(05) VALUE  03781.     00173700
               10  PC-TSYMSG-03782         PIC  9(05) VALUE  03782.     00173800
               10  PC-TSYMSG-03783         PIC  9(05) VALUE  03783.     00173900
               10  PC-TSYMSG-03784         PIC  9(05) VALUE  03784.     00174000
               10  PC-TSYMSG-03786         PIC  9(05) VALUE  03786.     00174100
               10  PC-TSYMSG-03787         PIC  9(05) VALUE  03787.     00174200
               10  PC-TSYMSG-03387         PIC  9(05) VALUE  03387.     00174300
           05  PC-MAX-ITEMS                PIC S9(04)  VALUE +3000      00174400
                                                           COMP SYNC.   00174500
         01  PV-PROGRAM-VARIABLES.                                      00174600
           05  PV-TSYMSG-NUMBER            PIC  9(05) VALUE  0.         00174700
           05  PV-CARTON-DISP              PIC  9(20) VALUE  0.         00174800
           05  PV-TRIP-DISP                PIC  9(09) VALUE  0.         00174900
           05  PV-SQLCODE                  PIC  9(09) VALUE  0.         00175000
           05  PV-PO-DISP                  PIC  9(09) VALUE  0.         00176000
           05  PV-XFER-ID-DISP             PIC  9(09) VALUE  0.         00177000
           05  PV-UPC-DISP                 PIC  9(15) VALUE  0.         00178000
           05  PV-INT-UPC-DISP             PIC  9(09) VALUE  0.         00179000
           05  PV-STYLID-DISP              PIC  9(09) VALUE  0.         00180000
           05  PV-SAVE-XFER-IND            PIC  X(01).                  00190000
           05  PV-SAVE-XFER-NBR            PIC S9(09) COMP.             00191000
           05  PV-SAVE-CUST-REQ-IND        PIC  X(01).                  00192000
           05  PV-SAVE-CUST-NAME           PIC  X(20).                  00192100
           05  PV-SAVE-TRN-NBR             PIC S9(09) COMP VALUE +0.    00192200
           05  PV-SAVE-CART-ID             PIC S9(18)V COMP-3           00192300
                                               VALUE +0.                00192400
           05  PV-TRN-NBR-COMP             PIC S9(10) COMP VALUE        00192500
                                                            ZEROES.     00192600
           05  PV-TRN-NBR                  PIC 9(10) VALUE ZEROES.      00192700
           05  PV-TRN-NBR-N REDEFINES PV-TRN-NBR.                       00192800
               10  PV-TRN-STORE             PIC 9(04).                  00192900
               10  PV-TRN-SEQUENCE          PIC 9(06).                  00193000
           05  PV-TRIP-NULL-IND            PIC S9(04)  VALUE ZEROS      00193100
                                               COMP.                    00193200
           05  PV-MSTR-NULL-IND            PIC S9(04)  VALUE ZEROS      00193300
                                               COMP.                    00193400
           05  PV-CHLD-NULL-IND            PIC S9(04)  VALUE ZEROS      00193500
                                               COMP.                    00193600
           05  PV-SHIPT-UNT-ID             PIC S9(18)V COMP-3.          00193700
           05  PV-PRNT-CART-ID             PIC S9(18)V COMP-3.          00193800
           05  PV-MSTR-CART-TBL OCCURS 1000 TIMES.                      00193900
               10 PV-MSTR-CART-ID          PIC S9(18)V COMP-3           00194000
                                               VALUE +0.                00194100
           05 PV-CHILD-CART-TBL OCCURS 5000 TIMES                       00194200
                                      INDEXED BY PV-CART-IDX.           00194300
               10 PV-CHILD-CART-ID         PIC S9(18)V COMP-3           00194400
                                               VALUE +0.                00194500
               10 PV-CART-SEQ-NO           PIC S9(04) COMP VALUE 0.     00194600
           05  PV-MSTR-CART-TBL            PIC S9(18)V COMP-3.          00194700
           05  PV-CICS-MSG-AREA.                                        00194800
               10 PV-PROGRAM-NAME          PIC  X(10) VALUE             00194900
                                                     ' SUKCS806 '.      00195000
               10 PV-LOG-TIME              PIC  X(15) VALUE SPACES.     00195100
               10 PV-PARA-NAME             PIC  X(25) VALUE SPACES.     00195200
               10 PV-ERROR-MSG             PIC  X(78) VALUE SPACES.     00195300
           05  PV-COMMAREA-LENGTH          PIC S9(04)  VALUE +0         00195400
                                                           COMP SYNC.   00195500
           05  PV-CICS-RESPONSE            PIC S9(08)  VALUE ZEROS      00195600
                                                        COMP SYNC.      00195700
           05  PV-RESP-DISP                PIC  9(08)  VALUE ZEROS.     00195800
           05  PV-ITEM-IDX                 PIC S9(04)  VALUE ZEROS      00195900
                                                           COMP SYNC.   00196000
           05  PV-MSTR-IDX1                PIC S9(04)  VALUE ZEROS      00196100
                                                           COMP SYNC.   00196200
           05  PV-MSTR-IDX2                PIC S9(04)  VALUE ZEROS      00196300
                                                           COMP SYNC.   00196400
           05  PV-CHLD-IDX                 PIC S9(04)  VALUE ZEROS      00196500
                                                           COMP SYNC.   00196600
           05  PV-READ-COUNT               PIC S9(04)  VALUE +0         00196700
                                                           COMP SYNC.   00196800
           05  PV-TMST.                                                 00196900
               10 PV-TMST-DATE             PIC X(10).                   00197000
               10 PV-TMST-T                PIC X(01) VALUE 'T'.         00197100
               10 PV-TMST-TIME             PIC X(08).                   00197200
           05  PV-SAVE-TRLR-TMST           PIC X(19).                   00197300
           05  PV-SAVE-RCVD-FLAG           PIC X(01).                   00197400
           05  PV-TRLR-TMST.                                            00197500
               10 PV-TRLR-DATE             PIC X(10).                   00197600
               10 PV-TRLR-FIL1             PIC X(01).                   00197700
               10 PV-TRLR-TIME             PIC X(08).                   00197800
               10 PV-TRLR-DOT              PIC X(01).                   00197900
               10 PV-TRLR-MS               PIC X(06).                   00198000
           05  PV-CURR-TIMESTAMP           PIC X(26).                   00198100
           05  PV-CURR-TMST-DATE-HHMM   REDEFINES                       00198200
               PV-CURR-TIMESTAMP.                                       00198300
               10  PV-CURR-YEAR            PIC X(04).                   00198400
               10  FILLER                  PIC X(01).                   00198500
               10  PV-CURR-MONTH           PIC X(02).                   00198600
               10  FILLER                  PIC X(01).                   00198700
               10  PV-CURR-DAY             PIC X(02).                   00198800
               10  FILLER                  PIC X(01).                   00198900
               10  PV-CURR-HOUR            PIC X(02).                   00199000
               10  FILLER                  PIC X(01).                   00199100
               10  PV-CURR-MIN             PIC X(02).                   00199200
               10  FILLER                  PIC X(01).                   00199300
               10  PV-CURR-SEC             PIC X(02).                   00199400
               10  FILLER                  PIC X(07).                   00199500
           05  PV-CSSL-TMST.                                            00199600
               10  PV-CSSL-MONTH           PIC X(02).                   00199700
               10  FILLER                  PIC X(01) VALUE '-'.         00199800
               10  PV-CSSL-DAY             PIC X(02).                   00199900
               10  FILLER                  PIC X(01) VALUE SPACE.       00200000
               10  PV-CSSL-HOUR            PIC X(02).                   00200100
               10  FILLER                  PIC X(01) VALUE ':'.         00200200
               10  PV-CSSL-MIN             PIC X(02).                   00200300
               10  FILLER                  PIC X(01) VALUE ':'.         00200400
               10  PV-CSSL-SEC             PIC X(02).                   00200500
               10  FILLER                  PIC X(01) VALUE SPACE.       00200600
                                                                        00200700
      *INPUT                                                            00200800
            COPY SURD140.                                               00200900
      *OUTPUT                                                           00201000
            COPY SURD141.                                               00202000
                                                                        00203000
            COPY DPRD507I.                                              00204000
                                                                        00205000
           EXEC SQL                                                     00206000
               INCLUDE SQLCA                                            00207000
           END-EXEC.                                                    00208000
                                                                        00209000
                                                                        00210000
           EXEC SQL                                                     00220000
                INCLUDE TKRPRPM                                         00230000
           END-EXEC.                                                    00240000
                                                                        00250000
           EXEC SQL                                                     00260000
                INCLUDE TPURITM                                         00270000
           END-EXEC.                                                    00280000
                                                                        00290000
           EXEC SQL                                                     00300000
                INCLUDE TTFMSTR                                         00310000
           END-EXEC.                                                    00320000
                                                                        00330000
           EXEC SQL                                                     00340000
                INCLUDE TTFCUST                                         00350000
           END-EXEC.                                                    00360000
                                                                        00370000
           EXEC SQL                                                     00380000
                INCLUDE XLV00000                                        00390000
           END-EXEC.                                                    00400000
                                                                        00410000
           EXEC SQL                                                     00420000
                INCLUDE XLV00002                                        00430000
           END-EXEC.                                                    00440000
                                                                        00450000
           EXEC SQL                                                     00460000
                INCLUDE XLT00006                                        00470000
           END-EXEC.                                                    00480000
                                                                        00490000
           EXEC SQL                                                     00500000
                INCLUDE SUT00024                                        00510000
           END-EXEC.                                                    00520000
                                                                        00530000
           EXEC SQL                                                     00540000
                INCLUDE SUT00027                                        00550000
           END-EXEC.                                                    00560000
                                                                        00570000
           EXEC SQL                                                     00580000
                INCLUDE TSUCRDV                                         00590000
           END-EXEC.                                                    00600000
                                                                        00610000
           EXEC SQL                                                     00620000
                INCLUDE TSUCDOT                                         00630000
           END-EXEC.                                                    00640000
                                                                        00650000
           EXEC SQL                                                     00660000
                INCLUDE TSUOBTS                                         00670000
           END-EXEC.                                                    00680000
                                                                        00690000
           EXEC SQL                                                     00700000
                INCLUDE TSUOBTR                                         00710000
           END-EXEC.                                                    00720000
                                                                        00730000
           EXEC SQL                                                     00740000
                INCLUDE TCNTRID                                         00750000
           END-EXEC.                                                    00760000
                                                                        00770000
           EXEC SQL                                                     00780000
                INCLUDE SUT00028                                        00790000
           END-EXEC.                                                    00800000
                                                                        00810000
           EXEC SQL                                                     00820000
                INCLUDE SUT00099                                        00830000
           END-EXEC.                                                    00840000
                                                                        00850000
           EXEC SQL                                                     00860000
                INCLUDE SUT00121                                        00870000
           END-EXEC.                                                    00880000
                                                                        00890000
           EXEC SQL                                                     00900000
                INCLUDE TMDARVS                                         00910000
           END-EXEC.                                                    00920000
                                                                        00930000
           EXEC SQL                                                     00940000
               DECLARE CTN-CONTENTS-CSR CURSOR FOR                      00950000
               SELECT                                                   00960000
                    A.UPC_NBR                                           00970000
               ,    A.SHPD_UNT_QTY                                      00980000
               ,    A.TRN_NBR                                           00990000
               ,    A.TRN_LNE_NBR                                       01000000
               ,    A.RCVR_SEQ_NBR                                      01010000
               ,    A.TRN_TYP_CDE                                       01020000
               ,    B.DEST_LOC_NBR                                      01030000
               ,    B.CART_SRC_CDE                                      01040000
               ,    B.OTBND_TRIP_ID                                     01050000
               ,    B.CRE_DTE                                           01060000
               ,    B.CRE_TM                                            01070000
               ,    B.ORIG_CART_ID                                      01071001
               FROM                                                     01080000
                     SUT_OTBND_UPC  A                                   01090000
                   , SUT_OTBND_CART B                                   01100000
              WHERE  A.SHIPT_UNT_ID      = :DK-SHIPT-UNT-ID             01110000
                AND  A.SHIPT_UNT_ID      =   B.SHIPT_UNT_ID             01120000
                AND  A.UPC_NBR          >= :DK-UPC-NBR                  01130000
                AND  A.SHPD_UNT_QTY      > 0                            01140000
             ORDER BY 1                                                 01150000
             WITH UR                                                    01160000
           END-EXEC.                                                    01170000
                                                                        01180000
           EXEC SQL                                                     01190000
              DECLARE CHILD-CARTON-CSR CURSOR FOR                       01200000
                 SELECT A.MSTR_SHIPT_UNT_ID                             01210000
                      , A.ACTN_TYP_CDE                                  01220000
                      , A.CHLD_MSTR_SHIPT_ID                            01230000
                      , A.CHLD_SHIPT_UNT_ID                             01240000
                  FROM  SUT_MSTR_SHIPT_CNT A                            01250000
                   WHERE  A.MSTR_SHIPT_UNT_ID = :DK-SHIPT-UNT-ID        01260000
                     AND  A.ACTN_TYP_CDE     IN ('ACM' , 'RTM')         01270000
                     AND  A.CRE_TMST IN                                 01280000
                         (SELECT MAX(B.CRE_TMST)                        01290000
                          FROM SUT_MSTR_SHIPT_CNT B                     01300000
                           WHERE                                        01310000
                          A.CHLD_SHIPT_UNT_ID = B.CHLD_SHIPT_UNT_ID)    01320000
                 UNION                                                  01330000
                 SELECT A.MSTR_SHIPT_UNT_ID                             01340000
                      , A.ACTN_TYP_CDE                                  01350000
                      , A.CHLD_MSTR_SHIPT_ID                            01360000
                      , A.CHLD_SHIPT_UNT_ID                             01370000
                  FROM  SUT_MSTR_SHIPT_CNT A                            01380000
                 WHERE  A.MSTR_SHIPT_UNT_ID = :DK-SHIPT-UNT-ID          01390000
                   AND  A.ACTN_TYP_CDE      = 'AMM'                     01400000
                   AND  A.CRE_TMST IN                                   01410000
                       (SELECT MAX(B.CRE_TMST)                          01420000
                        FROM SUT_MSTR_SHIPT_CNT B                       01430000
                       WHERE                                            01440000
                         A.MSTR_SHIPT_UNT_ID = B.MSTR_SHIPT_UNT_ID AND  01450000
                         A.CHLD_MSTR_SHIPT_ID = B.CHLD_MSTR_SHIPT_ID)   01460000
                 ORDER BY 1, 2                                          01470000
                WITH UR                                                 01480000
           END-EXEC.                                                    01490000
                                                                        01500000
      *----------------------------------------------------------------*01510000
       LINKAGE SECTION.                                                 01520000
                                                                        01530000
       01  DFHCOMMAREA.                                                 01540000
           05  FILLER                         OCCURS  1 TO 5072 TIMES   01550000
                                              DEPENDING ON EIBCALEN.    01560000
               10  FILLER                     PIC X.                    01570000
                                                                        01580000
       PROCEDURE DIVISION.                                              01590000
      ***************************************************************** 01600000
      ** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** 01610000
      ***************************************************************** 01620000
       0000-MAIN-MODULE.                                                01630000
                                                                        01640000
           PERFORM 1000-INITIALIZE.                                     01650000
           PERFORM 1100-CHECK-WEBSERV-AVAIL.                            01660000
           PERFORM 1200-GET-CONTAINER.                                  01670000
                                                                        01680000
           IF SU140-CARTON-ID GREATER THAN ZEROES                       01690000
                                                                        01700000
              PERFORM 1500-CHECK-MASTER-CARTON                          01710000
              PERFORM 2000-GET-PARENT-SML                               01720000
              PERFORM 2200-GET-CHILD-CARTONS                            01730000
                                                                        01740000
              IF PV-CHILD-CART-ID(1) > 0                                01750000
                                                                        01760000
                 PERFORM 2500-GET-CTN-CONTENTS                          01770000
                                                                        01780000
              ELSE                                                      01790000
                                                                        01800000
                 MOVE PC-TSYMSG-03386       TO PV-TSYMSG-NUMBER         01810000
                 MOVE SU140-CARTON-ID       TO PV-CARTON-DISP           01820000
                                                                        01830000
                 STRING 'NO CHILD CARTON FOUND - MASTER CARTON ID:'     01840000
                 PV-CARTON-DISP  DELIMITED BY SIZE INTO                 01850000
                                              PV-ERROR-MSG              01860000
                 MOVE '0000-MAIN-MODULE  '  TO PV-PARA-NAME             01870000
                 PERFORM 9995-CSSL-LOG-RETURN                           01880000
                                                                        01890000
              END-IF                                                    01900000
                                                                        01910000
           ELSE                                                         01920000
                                                                        01930000
                 MOVE PC-TSYMSG-03782       TO PV-TSYMSG-NUMBER         01940000
                 MOVE 'CARTON ID REQUIRED'  TO PV-ERROR-MSG             01950000
                 MOVE '0000-MAIN-MODULE  '  TO PV-PARA-NAME             01960000
                 PERFORM 9995-CSSL-LOG-RETURN                           01970000
                                                                        01980000
           END-IF.                                                      01990000
                                                                        02000000
           PERFORM 9000-RETURN-TRAN                                     02010000
              .                                                         02020000
      *----------------------------------------------------------------*02030000
      *    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *02040000
      *    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *02050000
      *----------------------------------------------------------------*02060000
                                                                        02070000
       1000-INITIALIZE.                                                 02080000
           INITIALIZE SU140-GET-MSTR-CRTN-DETAILS                       02090000
                      SU141-OUT-MSTR-CRTN-DETAILS                       02100000
                      PV-SAVE-TRN-NBR.                                  02110000
                                                                        02120000
            EXEC SQL                                                    02130000
              SELECT                                                    02140000
                    CURRENT TIMESTAMP                                   02150000
              INTO                                                      02160000
                   :PV-CURR-TIMESTAMP                                   02170000
              FROM SYSIBM.SYSDUMMY1                                     02180000
            END-EXEC.                                                   02190000
                                                                        02200000
           EVALUATE TRUE                                                02210000
                                                                        02220000
               WHEN SQLCODE = ZERO                                      02230000
                                                                        02240000
                  MOVE  PV-CURR-MONTH    TO PV-CSSL-MONTH               02250000
                  MOVE  PV-CURR-DAY      TO PV-CSSL-DAY                 02260000
                  MOVE  PV-CURR-HOUR     TO PV-CSSL-HOUR                02270000
                  MOVE  PV-CURR-MIN      TO PV-CSSL-MIN                 02280000
                  MOVE  PV-CURR-SEC      TO PV-CSSL-SEC                 02290000
                  MOVE  PV-CSSL-TMST     TO PV-LOG-TIME                 02300000
                                                                        02310000
               WHEN SQLCODE NOT = ZERO                                  02320000
                                                                        02330000
                    MOVE PC-TSYMSG-01570            TO PV-TSYMSG-NUMBER 02340000
                    MOVE SQLCODE                    TO PV-SQLCODE       02350000
                    MOVE '1000-INITIALIZE '         TO PV-PARA-NAME     02360000
                                                                        02370000
                    STRING 'DB2 IS NOT ACTIVE, SQLCODE:'                02380000
                    PV-SQLCODE DELIMITED BY SIZE INTO  PV-ERROR-MSG     02390000
                                                                        02400000
                    PERFORM 9995-CSSL-LOG-RETURN                        02410000
                                                                        02420000
           END-EVALUATE.                                                02421000
       1100-CHECK-WEBSERV-AVAIL.                                        02422000
                                                                        02423000
            EXEC SQL                                                    02424000
              SELECT FUNC_TXT                                           02425000
                INTO :KRPRPM-FUNC-TXT                                   02426000
                FROM TKRPRPM                                            02427000
              WHERE LOC_ID            = 90                              02427100
                AND INTFC_SYS_CDE     = 'KHL'                           02427200
                AND SYS_PRC_FUNC_CDE  = 'STWEB6'                        02427300
                AND FUNC_PRC_STAT_CDE = 'AC'                            02427400
                AND FUNC_BEG_TMST    <=  CURRENT TIMESTAMP              02427500
                AND FUNC_END_TMST    >=  CURRENT TIMESTAMP              02427600
                AND FUNC_TXT          = 'Y'                             02427700
              WITH UR                                                   02427800
            END-EXEC.                                                   02427900
                                                                        02428000
           EVALUATE TRUE                                                02428100
               WHEN SQLCODE = ZERO                                      02428200
                                                                        02428300
                        CONTINUE                                        02428400
                                                                        02428500
               WHEN SQLCODE = +100                                      02428600
                                                                        02428700
                    MOVE PC-TSYMSG-03787           TO PV-TSYMSG-NUMBER  02428800
                    MOVE                                                02428900
                    'WEB SERVICE getMasterCartonDetails NOT AVAILABLE'  02429000
                                                     TO PV-ERROR-MSG    02429100
                    MOVE '1100-CHECK-WEBSERV-AVAIL ' TO PV-PARA-NAME    02429200
                    PERFORM 9995-CSSL-LOG-RETURN                        02429300
                                                                        02429400
               WHEN SQLCODE NOT = ZERO                                  02429500
                                                                        02429600
                    MOVE PC-TSYMSG-01570            TO PV-TSYMSG-NUMBER 02429700
                    MOVE SQLCODE                    TO PV-SQLCODE       02429800
                    MOVE '1100-CHECK-WEBSERV-AVAIL' TO PV-PARA-NAME     02429900
                    STRING 'SELECT TKRPRPM FAILED WITH SQLCODE:'        02430000
                    PV-SQLCODE DELIMITED BY SIZE INTO  PV-ERROR-MSG     02430100
                    PERFORM 9995-CSSL-LOG-RETURN                        02430200
                                                                        02430300
           END-EVALUATE.                                                02430400
      *----------------------------------------------------------------*02430500
      *    GET INPUT FROM THE CONTAINER(XML TO COPYBOOK SURD140)       *02430600
      *----------------------------------------------------------------*02430700
       1200-GET-CONTAINER.                                              02430800
                                                                        02430900
            EXEC CICS                                                   02431000
              GET CONTAINER('DFHWS-DATA')                               02431100
              INTO(SU140-GET-MSTR-CRTN-DETAILS)                         02431200
              RESP(PV-CICS-RESPONSE)                                    02431300
            END-EXEC.                                                   02431400
                                                                        02431500
            EVALUATE PV-CICS-RESPONSE                                   02431600
                                                                        02431700
               WHEN DFHRESP(NORMAL)                                     02431800
                                                                        02431900
                  CONTINUE                                              02432000
                                                                        02432100
               WHEN OTHER                                               02432200
                                                                        02432300
                  MOVE PV-CICS-RESPONSE TO  PV-RESP-DISP                02432400
                                                                        02432500
                  MOVE PC-TSYMSG-01570          TO PV-TSYMSG-NUMBER     02432600
                  STRING 'GET CONTAINER FAILED CICS RESP CODE:'         02432700
                   PV-RESP-DISP DELIMITED BY SIZE INTO PV-ERROR-MSG     02432800
                                                                        02432900
                  MOVE '1200-GET-CONTAINER   '      TO PV-PARA-NAME     02433000
                  PERFORM 9995-CSSL-LOG-RETURN                          02433100
                                                                        02433200
            END-EVALUATE.                                               02433300
                                                                        02433400
       1500-CHECK-MASTER-CARTON.                                        02433500
                                                                        02433600
            MOVE SU140-CARTON-ID      TO DK-SHIPT-UNT-ID                02433700
                                         PV-CARTON-DISP                 02433800
                                                                        02433900
            EXEC SQL                                                    02434000
                SELECT                                                  02434100
                        A.CART_SRC_CDE                                  02434200
                  INTO                                                  02434300
                        :SUT00024-CART-SRC-CDE                          02434400
                  FROM  SUT_OTBND_CART A                                02434500
                 WHERE  A.SHIPT_UNT_ID  = :DK-SHIPT-UNT-ID              02434600
                   AND  A.MSTR_CART_IND = 'Y'                           02434700
                WITH UR                                                 02434800
            END-EXEC.                                                   02434900
                                                                        02435000
            EVALUATE TRUE                                               02435100
               WHEN SQLCODE = ZERO                                      02435200
                                                                        02435300
                    CONTINUE                                            02435400
                                                                        02435500
               WHEN SQLCODE = 100                                       02435600
                                                                        02435700
                  MOVE PC-TSYMSG-03387        TO PV-TSYMSG-NUMBER       02435800
                                                                        02435900
                  STRING 'INPUT CARTON IS NOT A MASTER CARTON CARTON:'  02436000
                      PV-CARTON-DISP     DELIMITED BY SIZE INTO         02437000
                                                       PV-ERROR-MSG     02437100
                  MOVE '1500-CHECK-MASTER-CARTON' TO PV-PARA-NAME       02437200
                  PERFORM 9995-CSSL-LOG-RETURN                          02437300
                                                                        02437400
                                                                        02437500
               WHEN SQLCODE NOT = ZERO                                  02437600
                                                                        02437700
                  MOVE SQLCODE    TO PV-SQLCODE                         02437800
                                                                        02437900
                  STRING 'SELECT SUT_OTBND_CART FAILED WITH SQLCODE:'   02438000
                         PV-SQLCODE ' SML#' PV-CARTON-DISP              02438100
                       DELIMITED BY SIZE INTO       PV-ERROR-MSG        02438200
                                                                        02438300
                  MOVE ' 1500-CHECK-MASTER-CARTON' TO PV-PARA-NAME      02438400
                  PERFORM 9995-CSSL-LOG-RETURN                          02438500
                                                                        02438600
            END-EVALUATE                                                02438700
            .                                                           02438800
      *----------------------------------------------------------------*02438900
      *    GET PARENT CARTON FOR INPUT MASTER CARTON                   *02439000
      *----------------------------------------------------------------*02439100
       2000-GET-PARENT-SML.                                             02439200
                                                                        02439300
            MOVE SU140-CARTON-ID      TO DK-SHIPT-UNT-ID                02439400
                                         PV-CARTON-DISP                 02439500
                                         DK-CHLD-MSTR-SHIPT-ID          02439600
                                         PV-PRNT-CART-ID.               02439700
            MOVE SU140-LAST-UPC-NBR   TO DK-UPC-NBR.                    02439800
                                                                        02439900
            IF SU140-LAST-UPC-NBR > 0                                   02440000
               ADD +1                 TO DK-UPC-NBR                     02441000
            END-IF.                                                     02442000
                                                                        02443000
            MOVE 'N'                  TO PS-NO-MORE-MSTR-SW             02444000
                                                                        02445000
            PERFORM 4100-FIND-PRNT-CART-ID UNTIL PS-NO-MORE-MSTR        02446000
                                                                        02447000
            MOVE PV-PRNT-CART-ID      TO SU141-PARENT-SML               02448000
                                                                        02449000
            .                                                           02450000
      *----------------------------------------------------------------*02460000
      *    GET LIST OF CHILD CARTON                                    *02470000
      *    FIRST IT WILL GET CHILD MASTER AND CHILD CARTON USING       *02480000
      *    INPUT MASTER CARTON. THEN IT WILL FIND THE CHILD CARTONS    *02490000
      *    OF CHILD MASTER CARTONS                                      02500000
      *----------------------------------------------------------------*02510000
       2200-GET-CHILD-CARTONS.                                          02520000
                                                                        02530000
            MOVE +1                       TO PV-MSTR-IDX1               02540000
                                             PV-MSTR-IDX2               02550000
                                             PV-CHLD-IDX.               02560000
            SET PS-FIRST-READ1            TO TRUE                       02570000
            PERFORM 2300-FIND-LEVEL1-CHILDS.                            02580000
                                                                        02590000
            MOVE 'N'                      TO PS-NO-MORE-CHLD-SW.        02600000
            PERFORM 2320-FIND-LEVEL2-CHILDS UNTIL PS-NO-MORE-CHLD.      02610000
                                                                        02620000
      *----------------------------------------------------------------*02630000
      *    GET LIST OF CHILD CARTONS OF EVERY CHILD MASTER CARTONS     *02640000
      *----------------------------------------------------------------*02650000
       2320-FIND-LEVEL2-CHILDS.                                         02660000
                                                                        02670000
            IF PV-MSTR-CART-ID(PV-MSTR-IDX2) > 0.0                      02680000
                                                                        02690000
               MOVE PV-MSTR-CART-ID(PV-MSTR-IDX2) TO DK-SHIPT-UNT-ID    02700000
                                                                        02710000
               PERFORM 2300-FIND-LEVEL1-CHILDS                          02720000
                                                                        02730000
               ADD +1                             TO PV-MSTR-IDX2       02740000
                                                                        02740100
            ELSE                                                        02740200
                                                                        02740300
               SET PS-NO-MORE-CHLD                TO TRUE               02740400
                                                                        02740500
            END-IF.                                                     02740600
      *----------------------------------------------------------------*02740700
      *    GET LIST OF CHILD CARTONS OF A MASTER CARTON                *02740800
      *----------------------------------------------------------------*02740900
       2300-FIND-LEVEL1-CHILDS.                                         02741000
                                                                        02741100
               MOVE 'N'            TO  PS-EO-CHILD-CARTON-CSR-SW        02741200
                                                                        02741300
               PERFORM 2400-OPEN-CHILD-CARTON-CSR.                      02741400
               PERFORM 2410-FETCH-CHILD-CARTON-CSR UNTIL                02741500
                                           PS-EO-CHILD-CARTON-CSR.      02741600
                                                                        02741700
               PERFORM 2420-CLOSE-CHILD-CARTON-CSR.                     02741800
                                                                        02741900
      *----------------------------------------------------------------*02742000
      *    OPEN CHILD-CARTON-CSR CURSOR                                *02742100
      *----------------------------------------------------------------*02742200
       2400-OPEN-CHILD-CARTON-CSR.                                      02742300
                                                                        02742400
               EXEC SQL                                                 02742500
                  OPEN CHILD-CARTON-CSR                                 02742600
               END-EXEC.                                                02742700
                                                                        02742800
            EVALUATE TRUE                                               02742900
               WHEN SQLCODE = ZERO                                      02743000
                                                                        02743100
                  CONTINUE                                              02743200
                                                                        02743300
               WHEN SQLCODE NOT = ZERO                                  02743400
                                                                        02743500
                  MOVE SQLCODE    TO PV-SQLCODE                         02743600
                                                                        02743700
                  MOVE PC-TSYMSG-01570          TO PV-TSYMSG-NUMBER     02743800
                  STRING 'OPEN CTN-CONTENTS-CSR FAILED WITH SQLCODE:'   02743900
                   PV-SQLCODE DELIMITED BY SIZE INTO PV-ERROR-MSG       02744000
                                                                        02744100
                  MOVE '2400-OPEN-CHILD-CARTON-CSR' TO PV-PARA-NAME     02744200
                  PERFORM 9995-CSSL-LOG-RETURN                          02744300
                                                                        02744400
            END-EVALUATE                                                02744500
            .                                                           02744600
      *----------------------------------------------------------------*02744700
      *   FETCH CHILD-CARTON-CSR CURSOR                                *02744800
      *   IF SUT00099-ACTN-TYP-CDE = 'ACM' OR 'RTM' FILL CHILD CARTON  *02744900
      *   TABLE PV-CHILD-CART-TBL                                      *02745000
      *   IF SUT00099-ACTN-TYP-CDE = 'AMM' FILL CHILD MASTER CARTON    *02745100
      *   TABLE PV-MSTR-CART-TBL                                       *02745200
      *----------------------------------------------------------------*02745300
       2410-FETCH-CHILD-CARTON-CSR.                                     02745400
                                                                        02745500
            EXEC SQL                                                    02745600
               FETCH CHILD-CARTON-CSR                                   02745700
                INTO  :SUT00099-MSTR-SHIPT-UNT-ID                       02745800
                    , :SUT00099-ACTN-TYP-CDE                            02745900
                    , :SUT00099-CHLD-MSTR-SHIPT-ID :PV-MSTR-NULL-IND    02746000
                    , :SUT00099-CHLD-SHIPT-UNT-ID  :PV-CHLD-NULL-IND    02746100
               END-EXEC.                                                02746200
                                                                        02746300
            EVALUATE TRUE                                               02746400
               WHEN SQLCODE = ZERO                                      02746500
                                                                        02746600
                  SET PS-NO-FIRST-READ1 TO TRUE                         02746700
                                                                        02746800
                  IF SUT00099-ACTN-TYP-CDE = 'AMM'                      02746900
                                                                        02747000
                     MOVE SUT00099-CHLD-MSTR-SHIPT-ID TO                02747100
                                        PV-MSTR-CART-ID(PV-MSTR-IDX1)   02747200
                     ADD +1                     TO PV-MSTR-IDX1         02747300
                                                                        02747400
                  ELSE                                                  02747500
                                                                        02747600
                     MOVE SUT00099-CHLD-SHIPT-UNT-ID TO                 02747700
                                        PV-CHILD-CART-ID(PV-CHLD-IDX)   02747800
                     MOVE PV-CHLD-IDX           TO PV-CART-SEQ-NO       02747900
                                                        (PV-CHLD-IDX)   02748000
                     ADD +1                     TO PV-CHLD-IDX          02748100
                                                                        02748200
                  END-IF                                                02748300
               WHEN SQLCODE = 100                                       02748400
                                                                        02748500
                  IF PS-FIRST-READ1                                     02748600
                                                                        02748700
                     MOVE PC-TSYMSG-03386      TO PV-TSYMSG-NUMBER      02748800
                     STRING 'NO CHILD CARTON FOUND - MASTER CARTON ID:' 02748900
                     PV-CARTON-DISP  DELIMITED BY SIZE INTO             02749000
                                                  PV-ERROR-MSG          02749100
                     MOVE ' 2410-FETCH-CHILD-CARTON-CSR '               02749200
                                               TO PV-PARA-NAME          02749300
                     PERFORM 2420-CLOSE-CHILD-CARTON-CSR                02749400
                     PERFORM 9995-CSSL-LOG-RETURN                       02749500
                                                                        02749600
                  END-IF                                                02749700
                                                                        02749800
                  SET PS-EO-CHILD-CARTON-CSR   TO TRUE                  02749900
                                                                        02750000
               WHEN SQLCODE NOT = ZERO                                  02750100
                                                                        02750200
                  MOVE SQLCODE    TO PV-SQLCODE                         02750300
                                                                        02750400
                  MOVE PC-TSYMSG-01570          TO PV-TSYMSG-NUMBER     02750500
                  STRING 'FETCH CHILD-CARTON-CSR FAILED WITH SQLCODE:'  02750600
                   PV-SQLCODE ' SML#' PV-CARTON-DISP                    02750700
                              DELIMITED BY SIZE INTO PV-ERROR-MSG       02750800
                                                                        02750900
                  MOVE '2410-FETCH-CHILD-CARTON-CSR' TO PV-PARA-NAME    02751000
                  PERFORM 9995-CSSL-LOG-RETURN                          02751100
                                                                        02751200
            END-EVALUATE                                                02751300
            .                                                           02751400
      *----------------------------------------------------------------*02751500
      *   CLOSE CHILD-CARTON-CSR CURSOR                                *02751600
      *----------------------------------------------------------------*02751700
       2420-CLOSE-CHILD-CARTON-CSR.                                     02751800
                                                                        02751900
               EXEC SQL                                                 02752000
                 CLOSE CHILD-CARTON-CSR                                 02752100
               END-EXEC.                                                02752200
                                                                        02752300
            EVALUATE TRUE                                               02752400
               WHEN SQLCODE = ZERO                                      02752500
                                                                        02752600
                  CONTINUE                                              02752700
                                                                        02752800
               WHEN SQLCODE NOT = ZERO                                  02752900
                                                                        02753000
                  MOVE SQLCODE    TO PV-SQLCODE                         02753100
                                                                        02753200
                  MOVE PC-TSYMSG-01570          TO PV-TSYMSG-NUMBER     02753300
                  STRING 'CLOSE CHILD-CARTON-CSR FAILED WITH SQLCODE:'  02753400
                   PV-SQLCODE DELIMITED BY SIZE INTO PV-ERROR-MSG       02753500
                                                                        02753600
                  MOVE '2420-CLOSE-CHILD-CARTON-CSR' TO PV-PARA-NAME    02753700
                  PERFORM 9995-CSSL-LOG-RETURN                          02753800
                                                                        02753900
            END-EVALUATE                                                02754000
            .                                                           02754100
      *----------------------------------------------------------------*02754200
      *   GET THE CARTON CONTENTS                                      *02754300
      *----------------------------------------------------------------*02754400
       2500-GET-CTN-CONTENTS.                                           02754500
                                                                        02754600
            MOVE +1                       TO PV-CHLD-IDX                02754700
                                             PV-ITEM-IDX                02754800
                                             PV-READ-COUNT.             02754900
            MOVE 'N'                      TO PS-NO-MORE-CHLD-SW.        02755000
                                                                        02755100
            IF SU140-LAST-CARTON > 0                                    02755200
                                                                        02755300
               SEARCH PV-CHILD-CART-TBL                                 02755400
                 WHEN SU140-LAST-CARTON = PV-CHILD-CART-ID(PV-CART-IDX) 02755500
                     MOVE PV-CART-SEQ-NO(PV-CART-IDX) TO PV-CHLD-IDX    02755600
               END-SEARCH                                               02755700
                                                                        02755800
            ELSE                                                        02755900
                                                                        02756000
               SET PS-FIRST-READ             TO TRUE                    02756100
                                                                        02756200
            END-IF                                                      02756300
            PERFORM 2550-GET-UPC-DETAILS UNTIL ((PS-NO-MORE-CHLD)       02756400
                                    OR (PV-READ-COUNT > PC-MAX-ITEMS))  02756500
            .                                                           02756600
      *----------------------------------------------------------------*02756700
      *   GET THE CARTON CONTENTS OF EVERY CHILD CARTONS               *02756800
      *----------------------------------------------------------------*02756900
       2550-GET-UPC-DETAILS.                                            02757000
                                                                        02757100
            IF PV-CHILD-CART-ID(PV-CHLD-IDX) > 0                        02757200
                                                                        02757300
               MOVE PV-CHILD-CART-ID(PV-CHLD-IDX) TO DK-SHIPT-UNT-ID    02757400
                                                     PV-CARTON-DISP     02757500
                                                                        02757600
               PERFORM 2600-OPEN-CTN-CONTENTS-CSR                       02757700
               PERFORM 2700-FETCH-UPC-FROM-DB                           02757800
               PERFORM 2800-CLOSE-CTN-CONTENTS-CSR                      02757900
                                                                        02758000
               ADD +1                             TO PV-CHLD-IDX        02758100
               MOVE 0                             TO DK-UPC-NBR         02758200
                                                                        02758300
            ELSE                                                        02758400
                                                                        02758500
               SET PS-NO-MORE-CHLD                TO TRUE               02758600
                                                                        02758700
            END-IF.                                                     02758800
                                                                        02758900
      *----------------------------------------------------------------*02759000
      *   OPEN CTN-CONTENTS-CSR CURSOR                                 *02759100
      *----------------------------------------------------------------*02759200
       2600-OPEN-CTN-CONTENTS-CSR.                                      02759300
                                                                        02759400
               EXEC SQL                                                 02759500
                  OPEN CTN-CONTENTS-CSR                                 02759600
               END-EXEC.                                                02759700
                                                                        02759800
            EVALUATE TRUE                                               02759900
               WHEN SQLCODE = ZERO                                      02760000
                                                                        02760100
                  CONTINUE                                              02760200
                                                                        02760300
               WHEN SQLCODE NOT = ZERO                                  02760400
                                                                        02760500
                  MOVE SQLCODE    TO PV-SQLCODE                         02760600
                                                                        02760700
                  MOVE PC-TSYMSG-01570          TO PV-TSYMSG-NUMBER     02760800
                  STRING 'OPEN CTN-CONTENTS-CSR FAILED WITH SQLCODE:'   02760900
                   PV-SQLCODE DELIMITED BY SIZE INTO PV-ERROR-MSG       02761000
                                                                        02761100
                  MOVE '2600-OPEN-CTN-CONTENTS-CSR' TO PV-PARA-NAME     02761200
                  PERFORM 9995-CSSL-LOG-RETURN                          02761300
                                                                        02761400
            END-EVALUATE                                                02761500
            .                                                           02761600
      *----------------------------------------------------------------*02761700
      *   ISSUE FETCH CTN-CONTENTS-CSR UNTIL NOMORE ITEMS ON THE CARTON*02761800
      *----------------------------------------------------------------*02761900
       2700-FETCH-UPC-FROM-DB.                                          02762000
                                                                        02762100
            SET PS-NO-EO-CTN-CONTENTS-CSR TO TRUE                       02762200
             PERFORM 2750-FETCH-CTN-CONTENTS-CSR                        02762300
                 UNTIL ((PS-EO-CTN-CONTENTS-CSR)                        02762400
                          OR (PV-READ-COUNT > PC-MAX-ITEMS))            02762500
             .                                                          02762600
                                                                        02762700
            IF PS-NO-EO-CTN-CONTENTS-CSR                                02762800
                                                                        02762900
                MOVE PC-TSYMSG-03781      TO PV-TSYMSG-NUMBER           02763000
                                                                        02763100
            END-IF.                                                     02763200
                                                                        02763300
      *----------------------------------------------------------------*02763400
      *   FETCH CTN-CONTENTS-CSR CURSOR                                *02763500
      *----------------------------------------------------------------*02763600
       2750-FETCH-CTN-CONTENTS-CSR.                                     02763700
                                                                        02763800
               EXEC SQL                                                 02763900
                 FETCH CTN-CONTENTS-CSR                                 02764000
                  INTO  :SUT00028-UPC-NBR                               02764100
                      , :SUT00028-SHPD-UNT-QTY                          02764200
                      , :SUT00028-TRN-NBR                               02764300
                      , :SUT00028-TRN-LNE-NBR                           02764400
                      , :SUT00028-RCVR-SEQ-NBR                          02764500
                      , :SUT00028-TRN-TYP-CDE                           02764600
                      , :SUT00024-DEST-LOC-NBR                          02764700
                      , :SUT00024-CART-SRC-CDE                          02764800
                      , :SUT00024-OTBND-TRIP-ID :PV-TRIP-NULL-IND       02764900
                      , :SUT00024-CRE-DTE                               02765000
                      , :SUT00024-CRE-TM                                02765100
                      , :SUT00024-ORIG-CART-ID                          02765201
               END-EXEC.                                                02765301
                                                                        02765401
            EVALUATE TRUE                                               02765501
               WHEN SQLCODE = ZERO                                      02765601
                                                                        02765701
                  SET PS-NO-FIRST-READ  TO TRUE                         02765801
                  MOVE DK-SHIPT-UNT-ID  TO                              02765901
                                   SU141-CHLD-CARTON-ID (PV-ITEM-IDX)   02766001
                  MOVE SUT00024-DEST-LOC-NBR TO                         02766101
                                        SU141-STORE-NBR (PV-ITEM-IDX)   02766201
                  MOVE SUT00024-CART-SRC-CDE TO                         02766301
                                        SU141-SML-TYPE(PV-ITEM-IDX)     02766401
                  MOVE SUT00024-ORIG-CART-ID TO                         02766501
                                  SU141-VENDOR-CART-ID(PV-ITEM-IDX)     02766601
                                                                        02766701
                  IF PV-TRIP-NULL-IND = -1                              02766801
                                                                        02766901
                     MOVE 0        TO SU141-TRIP-ID(PV-ITEM-IDX)        02767001
                                      SU141-SHIP-NODE(PV-ITEM-IDX)      02767101
                                      SU141-TRLR-SRL-NBR(PV-ITEM-IDX)   02767201
                     MOVE SPACES   TO SU141-TRLR-SEAL-ID(PV-ITEM-IDX)   02767301
                                      SU141-TRAILER-ID(PV-ITEM-IDX)     02768000
                                      SU141-TRLR-SCAC-CDE(PV-ITEM-IDX)  02768100
                                                                        02768200
                  ELSE                                                  02768300
                                                                        02768400
                     MOVE SUT00024-OTBND-TRIP-ID TO                     02768500
                                           SU141-TRIP-ID(PV-ITEM-IDX)   02768600
                     PERFORM 3050-FIND-TRAILER-ID                       02768700
                                                                        02768800
                  END-IF                                                02768900
                  MOVE SUT00024-CRE-DTE TO PV-TMST-DATE                 02769000
                  MOVE SUT00024-CRE-TM  TO PV-TMST-TIME                 02769100
                  MOVE PV-TMST          TO                              02769200
                                   SU141-SML-CRE-TMST(PV-ITEM-IDX)      02769300
                                                                        02769400
                  IF DK-SHIPT-UNT-ID = PV-SAVE-CART-ID                  02769500
                                                                        02769600
                     MOVE PV-SAVE-TRLR-TMST  TO                         02769700
                                   SU141-SML-TRLR-TMST(PV-ITEM-IDX)     02769800
                     MOVE PV-SAVE-RCVD-FLAG  TO                         02769900
                                   SU141-CARTON-RECEIVED(PV-ITEM-IDX)   02770000
                                                                        02770100
                  ELSE                                                  02770200
                                                                        02770300
                     MOVE DK-SHIPT-UNT-ID TO PV-SAVE-CART-ID            02770400
                     PERFORM 4200-GET-TRLR-TMST                         02770500
                     PERFORM 4400-CHECK-CARTON-RECEIVED                 02770600
                                                                        02770700
                  END-IF                                                02770800
                                                                        02770900
                  MOVE SUT00028-UPC-NBR TO SU141-UPC-NBR(PV-ITEM-IDX)   02771000
                  MOVE SUT00028-SHPD-UNT-QTY                            02771100
                                        TO SU141-QUANTITY(PV-ITEM-IDX)  02771200
                  MOVE SUT00028-TRN-NBR TO SU141-PO-NUMBER(PV-ITEM-IDX) 02771300
                  MOVE SUT00028-TRN-LNE-NBR                             02771400
                                      TO SU141-PO-LNE-NBR(PV-ITEM-IDX)  02771500
                  MOVE SUT00028-RCVR-SEQ-NBR                            02771600
                                      TO SU141-RCVR-SEQ-NBR(PV-ITEM-IDX)02771700
                                                                        02771800
                  PERFORM 2850-FIND-SKU-INTR-UPC                        02771900
                                                                        02772000
                  IF SUT00028-TRN-TYP-CDE = 'PO'                        02772100
                                                                        02772200
                     MOVE 'N'           TO SU141-XFER-IND(PV-ITEM-IDX)  02772300
                                                                        02772400
                     PERFORM 2900-SELECT-TPURITM                        02772500
                     PERFORM 2910-SELECT-RETAIL-AMT                     02772600
                                                                        02772700
                  ELSE                                                  02772800
                                                                        02772900
                     PERFORM 2950-SELECT-COST-RETAIL                    02773000
                                                                        02773100
                     IF SUT00028-TRN-TYP-CDE = 'FX'                     02773200
                                                                        02773300
                        MOVE 'Y'        TO SU141-XFER-IND(PV-ITEM-IDX)  02773400
                                                                        02773500
                        PERFORM 3000-FIND-XFER-ID                       02773600
                                                                        02773700
                     ELSE                                               02773800
                                                                        02773900
                        MOVE 'N'        TO SU141-XFER-IND(PV-ITEM-IDX)  02774000
                                                                        02774100
                     END-IF                                             02774200
                  END-IF                                                02774300
                                                                        02774400
                  MOVE PC-TSYMSG-01044  TO PV-TSYMSG-NUMBER             02774500
                  ADD +1    TO SU141-UPC-COUNT                          02774600
                  ADD +1                   TO PV-ITEM-IDX               02774700
                  ADD +1                   TO PV-READ-COUNT             02774800
                                                                        02774900
               WHEN SQLCODE = 100                                       02775000
                                                                        02775100
                  IF PS-FIRST-READ                                      02775200
                                                                        02775300
                     MOVE PC-TSYMSG-03783      TO PV-TSYMSG-NUMBER      02775400
                     STRING 'UPC DETAILS NOT FOUND FOR CARTON ID:'      02775500
                     PV-CARTON-DISP  DELIMITED BY SIZE INTO             02775600
                                                  PV-ERROR-MSG          02775700
                     MOVE ' 2750-FETCH-CTN-CONTENTS-CSR'                02775800
                                               TO PV-PARA-NAME          02775900
                     PERFORM 2800-CLOSE-CTN-CONTENTS-CSR                02776000
                     PERFORM 9995-CSSL-LOG-RETURN                       02776100
                                                                        02776200
                  END-IF                                                02776300
                                                                        02776400
                  SET PS-EO-CTN-CONTENTS-CSR   TO TRUE                  02776500
                                                                        02776600
               WHEN SQLCODE NOT = ZERO                                  02776700
                                                                        02776800
                  MOVE SQLCODE    TO PV-SQLCODE                         02776900
                                                                        02777000
                  MOVE PC-TSYMSG-01570          TO PV-TSYMSG-NUMBER     02777100
                  STRING 'FETCH CTN-CONTENTS-CSR FAILED WITH SQLCODE:'  02777200
                   PV-SQLCODE ' SML#' PV-CARTON-DISP                    02777300
                              DELIMITED BY SIZE INTO PV-ERROR-MSG       02777400
                                                                        02777500
                  MOVE '2750-FETCH-CTN-CONTENTS-CSR' TO PV-PARA-NAME    02777600
                  PERFORM 9995-CSSL-LOG-RETURN                          02777700
                                                                        02777800
            END-EVALUATE                                                02777900
            .                                                           02778000
      *----------------------------------------------------------------*02778100
      *   CLOSE CTN-CONTENTS-CSR CURSOR                                *02778200
      *----------------------------------------------------------------*02778300
       2800-CLOSE-CTN-CONTENTS-CSR.                                     02778400
                                                                        02778500
               EXEC SQL                                                 02778600
                 CLOSE CTN-CONTENTS-CSR                                 02778700
               END-EXEC.                                                02778800
                                                                        02778900
            EVALUATE TRUE                                               02779000
               WHEN SQLCODE = ZERO                                      02779100
                                                                        02779200
                  CONTINUE                                              02779300
                                                                        02779400
               WHEN SQLCODE NOT = ZERO                                  02779500
                                                                        02779600
                  MOVE SQLCODE    TO PV-SQLCODE                         02779700
                                                                        02779800
                  MOVE PC-TSYMSG-01570          TO PV-TSYMSG-NUMBER     02779900
                  STRING 'CLOSE CTN-CONTENTS-CSR FAILED WITH SQLCODE:'  02780000
                   PV-SQLCODE DELIMITED BY SIZE INTO PV-ERROR-MSG       02780100
                                                                        02780200
                  MOVE '2800-CLOSE-CTN-CONTENTS-CSR' TO PV-PARA-NAME    02780300
                  PERFORM 9995-CSSL-LOG-RETURN                          02780400
                                                                        02780500
            END-EVALUATE                                                02780600
            .                                                           02780700
      *----------------------------------------------------------------*02780800
      *   FIND SKU NUMBER AND INTR_UPC_ID FOR THE FETCHED UPC NUMBER   *02780900
      *----------------------------------------------------------------*02781000
       2850-FIND-SKU-INTR-UPC.                                          02781100
                                                                        02781200
            EXEC SQL                                                    02781300
               SELECT                                                   02781400
                   XSKU.SKU_NBR                                         02781500
                 , XSKU.STYL_ID                                         02781600
                 , XUPC.INTR_UPC_ID                                     02781700
                INTO                                                    02781800
                   :XLV00000-SKU-NBR                                    02781900
                 , :XLV00000-STYL-ID                                    02782000
                 , :XLT00006-INTR-UPC-ID                                02782100
                FROM                                                    02782200
                      XLT_UPC       XUPC                                02782300
                     ,XLV_SKU       XSKU                                02782400
                WHERE                                                   02782500
                     XUPC.UPC_NBR          = :SUT00028-UPC-NBR          02782600
                 AND XUPC.INTR_UPC_ID      = XSKU.INTR_UPC_ID           02782700
                 AND NOT XSKU.SKU_STAT_CDE IN ('00', '98')              02782800
                 WITH UR                                                02782900
            END-EXEC.                                                   02783000
                                                                        02783100
            EVALUATE TRUE                                               02783200
               WHEN SQLCODE = ZERO                                      02783300
                                                                        02783400
                  MOVE XLV00000-SKU-NBR TO SU141-SKU-NBR (PV-ITEM-IDX)  02783500
                  MOVE XLV00000-STYL-ID TO SU141-STYL-ID (PV-ITEM-IDX)  02783600
                                                                        02783700
                  PERFORM 2860-FIND-STYL-CTG                            02783800
                                                                        02783900
               WHEN SQLCODE = 100                                       02784000
                                                                        02784100
                  MOVE 0             TO SU141-SKU-NBR (PV-ITEM-IDX)     02784200
                                        XLT00006-INTR-UPC-ID            02784300
                                        SU141-STYL-ID (PV-ITEM-IDX)     02784400
                                        SU141-CTG-SEQ-NBR (PV-ITEM-IDX) 02784500
                                                                        02784600
               WHEN SQLCODE NOT = ZERO                                  02784700
                                                                        02784800
                  MOVE SQLCODE                  TO PV-SQLCODE           02784900
                  MOVE SUT00028-UPC-NBR         TO PV-UPC-DISP          02785000
                  MOVE PC-TSYMSG-01570          TO PV-TSYMSG-NUMBER     02785100
                                                                        02785200
                  STRING 'SELECT XLT_UPC FAILED WITH SQLCODE:'          02785300
                   PV-SQLCODE ' UPC:' PV-UPC-DISP                       02785400
                            DELIMITED BY SIZE INTO PV-ERROR-MSG         02785500
                                                                        02785600
                  MOVE '2850-FIND-SKU-INTR-UPC' TO PV-PARA-NAME         02785700
                  PERFORM 9995-CSSL-LOG-RETURN                          02785800
                                                                        02785900
            END-EVALUATE                                                02786000
            .                                                           02786100
       2860-FIND-STYL-CTG.                                              02786200
                                                                        02786300
            EXEC SQL                                                    02786400
               SELECT DISTINCT                                          02786500
                   A.RMS_STYL_ID                                        02786600
                 , A.CTG_SEQ_NBR                                        02786700
                INTO                                                    02786800
                   :MDARVS-RMS-STYL-ID                                  02786900
                 , :MDARVS-CTG-SEQ-NBR                                  02787000
                FROM                                                    02787100
                      TMDARVS A                                         02787200
                WHERE                                                   02787300
                     A.RMS_STYL_ID   = :XLV00000-STYL-ID                02787400
                 AND A.ACTV_IND      = 'Y'                              02787500
                 WITH UR                                                02787600
            END-EXEC.                                                   02787700
                                                                        02787800
            EVALUATE TRUE                                               02787900
               WHEN SQLCODE = ZERO                                      02788000
                                                                        02788100
                  MOVE MDARVS-CTG-SEQ-NBR TO                            02788200
                                        SU141-CTG-SEQ-NBR (PV-ITEM-IDX) 02788300
                                                                        02788400
               WHEN SQLCODE = 100                                       02788500
                                                                        02788600
                  MOVE 0             TO SU141-CTG-SEQ-NBR (PV-ITEM-IDX) 02788700
                                                                        02788800
                                                                        02788900
               WHEN SQLCODE NOT = ZERO                                  02789000
                                                                        02789100
                  MOVE SQLCODE                  TO PV-SQLCODE           02789200
                  MOVE XLV00000-STYL-ID         TO PV-STYLID-DISP       02789300
                  MOVE PC-TSYMSG-01570          TO PV-TSYMSG-NUMBER     02789400
                                                                        02789500
                  STRING 'SELECT TMDARVS FAILED WITH SQLCODE:'          02789600
                   PV-SQLCODE ' STYL ID:' PV-STYLID-DISP                02789700
                            DELIMITED BY SIZE INTO PV-ERROR-MSG         02789800
                                                                        02789900
                  MOVE '2860-FIND-STYL-CTG' TO PV-PARA-NAME             02790000
                  PERFORM 9995-CSSL-LOG-RETURN                          02790100
                                                                        02790200
            END-EVALUATE                                                02790300
            .                                                           02790400
      *----------------------------------------------------------------*02790500
      *   FIND UNIT COST AMOUNT FOR PO TRANSACTION UPC NUMBERS         *02790600
      *----------------------------------------------------------------*02790700
       2900-SELECT-TPURITM.                                             02790800
                                                                        02790900
               EXEC SQL                                                 02791000
                 SELECT                                                 02791100
                      UNT_COST_AMT                                      02791200
                   INTO                                                 02791300
                      :PURITM-UNT-COST-AMT                              02791400
                   FROM TPURITM                                         02791500
                   WHERE PO_NBR              = :SUT00028-TRN-NBR        02791600
                     AND APP_PO_LNE_NBR      = :SUT00028-TRN-LNE-NBR    02791700
                     AND VER_STATUS_CDE      = 'A'                      02791800
                 WITH UR                                                02791900
               END-EXEC.                                                02792000
                                                                        02792100
            EVALUATE TRUE                                               02792200
               WHEN SQLCODE = ZERO                                      02792300
                                                                        02792400
                  MOVE PURITM-UNT-COST-AMT                              02792500
                                     TO SU141-UNT-COST-AMT(PV-ITEM-IDX) 02792600
                                                                        02792700
               WHEN SQLCODE = 100                                       02792800
                                                                        02792900
                  MOVE 0             TO SU141-UNT-COST-AMT(PV-ITEM-IDX) 02793000
                                                                        02793100
               WHEN SQLCODE NOT = ZERO                                  02793200
                                                                        02793300
                  MOVE SQLCODE                  TO PV-SQLCODE           02793400
                  MOVE SUT00028-TRN-NBR         TO PV-PO-DISP           02793500
                  MOVE PC-TSYMSG-01570          TO PV-TSYMSG-NUMBER     02793600
                                                                        02793700
                  STRING 'SELECT TPURITM FAILED WITH SQLCODE:'          02793800
                   PV-SQLCODE ' PO:' PV-PO-DISP                         02793900
                            DELIMITED BY SIZE INTO PV-ERROR-MSG         02794000
                                                                        02794100
                  MOVE '2900-SELECT-TPURITM ' TO PV-PARA-NAME           02794200
                  PERFORM 9995-CSSL-LOG-RETURN                          02794300
                                                                        02794400
            END-EVALUATE                                                02794500
            .                                                           02794600
      *----------------------------------------------------------------*02794700
      *   FIND UNIT RETAIL AMOUNT FOR UPC NUMBERS                      *02794800
      *----------------------------------------------------------------*02794900
       2910-SELECT-RETAIL-AMT.                                          02795000
                                                                        02795100
               EXEC SQL                                                 02795200
                 SELECT                                                 02795300
                      UNT_RTL_AMT                                       02795400
                   INTO                                                 02795500
                      :XLV00002-UNT-RTL-AMT                             02795600
                   FROM XLV_SKU_STR                                     02795700
                   WHERE INTR_UPC_ID         = :XLT00006-INTR-UPC-ID    02795800
                     AND STR_NBR             = :DK-STORE-NBR            02795900
                 WITH UR                                                02796000
               END-EXEC.                                                02796100
                                                                        02796200
            EVALUATE TRUE                                               02796300
               WHEN SQLCODE = ZERO                                      02796400
                                                                        02796500
                  MOVE XLV00002-UNT-RTL-AMT                             02796600
                                      TO SU141-UNT-RTL-AMT(PV-ITEM-IDX) 02796700
                                                                        02796800
               WHEN SQLCODE = 100                                       02796900
                                                                        02797000
                  PERFORM 2920-SELECT-RTL-CORP                          02797100
                                                                        02797200
               WHEN SQLCODE NOT = ZERO                                  02797300
                                                                        02797400
                  MOVE SQLCODE                  TO PV-SQLCODE           02797500
                  MOVE XLT00006-INTR-UPC-ID     TO PV-INT-UPC-DISP      02797600
                  MOVE PC-TSYMSG-01570          TO PV-TSYMSG-NUMBER     02797700
                                                                        02797800
                  STRING 'SELECT XLV_SKU_STR FAILED WITH SQLCODE:'      02797900
                   PV-SQLCODE ' INTR UPC:' PV-INT-UPC-DISP              02798000
                            DELIMITED BY SIZE INTO PV-ERROR-MSG         02798100
                                                                        02798200
                  MOVE '2910-SELECT-RETAIL-AMT ' TO PV-PARA-NAME        02798300
                  PERFORM 9995-CSSL-LOG-RETURN                          02798400
                                                                        02798500
            END-EVALUATE                                                02798600
            .                                                           02798700
      *----------------------------------------------------------------*02798800
      *   FIND UNIT RETAIL AMOUNT(CORPORATE LOCATION)                  *02798900
      *----------------------------------------------------------------*02799000
       2920-SELECT-RTL-CORP.                                            02799100
                                                                        02799200
               EXEC SQL                                                 02799300
                 SELECT                                                 02799400
                      UNT_RTL_AMT                                       02799500
                   INTO                                                 02799600
                      :XLV00002-UNT-RTL-AMT                             02799700
                   FROM XLV_SKU_STR                                     02799800
                   WHERE INTR_UPC_ID         = :XLT00006-INTR-UPC-ID    02799900
                     AND STR_NBR             = 0                        02800000
                 WITH UR                                                02800100
               END-EXEC.                                                02800200
                                                                        02800300
            EVALUATE TRUE                                               02800400
               WHEN SQLCODE = ZERO                                      02800500
                                                                        02800600
                  MOVE XLV00002-UNT-RTL-AMT                             02800700
                                     TO SU141-UNT-RTL-AMT(PV-ITEM-IDX)  02800800
                                                                        02800900
               WHEN SQLCODE = 100                                       02801000
                                                                        02801100
                  MOVE 0             TO SU141-UNT-RTL-AMT(PV-ITEM-IDX)  02801200
                                                                        02801300
               WHEN SQLCODE NOT = ZERO                                  02801400
                                                                        02801500
                  MOVE SQLCODE                  TO PV-SQLCODE           02801600
                  MOVE XLT00006-INTR-UPC-ID     TO PV-INT-UPC-DISP      02801700
                  MOVE PC-TSYMSG-01570          TO PV-TSYMSG-NUMBER     02801800
                                                                        02801900
                  STRING 'SELECT XLV_SKU_STR FAILED WITH SQLCODE:'      02802000
                   PV-SQLCODE ' INTR UPC:' PV-INT-UPC-DISP              02802100
                            DELIMITED BY SIZE INTO PV-ERROR-MSG         02802200
                                                                        02802300
                  MOVE '2920-SELECT-RTL-CORP  ' TO PV-PARA-NAME         02802400
                  PERFORM 9995-CSSL-LOG-RETURN                          02802500
                                                                        02802600
            END-EVALUATE                                                02802700
            .                                                           02802800
      *----------------------------------------------------------------*02802900
      *   FIND UNIT RETAIL AMOUNT & UNIT COST AMOUNT                   *02803000
      *----------------------------------------------------------------*02803100
       2950-SELECT-COST-RETAIL.                                         02803200
                                                                        02803300
               EXEC SQL                                                 02803400
                 SELECT                                                 02803500
                      UNT_COST_AMT                                      02803600
                    , UNT_RTL_AMT                                       02803700
                   INTO                                                 02803800
                      :XLV00002-UNT-COST-AMT                            02803900
                    , :XLV00002-UNT-RTL-AMT                             02804000
                   FROM XLV_SKU_STR                                     02804100
                   WHERE INTR_UPC_ID         = :XLT00006-INTR-UPC-ID    02804200
                     AND STR_NBR             = :DK-STORE-NBR            02804300
                 WITH UR                                                02804400
               END-EXEC.                                                02804500
                                                                        02804600
            EVALUATE TRUE                                               02804700
               WHEN SQLCODE = ZERO                                      02804800
                                                                        02804900
                  MOVE XLV00002-UNT-COST-AMT                            02805000
                                      TO SU141-UNT-COST-AMT(PV-ITEM-IDX)02805100
                  MOVE XLV00002-UNT-RTL-AMT                             02805200
                                      TO SU141-UNT-RTL-AMT(PV-ITEM-IDX) 02805300
                                                                        02805400
               WHEN SQLCODE = 100                                       02805500
                                                                        02805600
                  PERFORM 2960-SELECT-CORP-COST-RTL                     02805700
                                                                        02805800
               WHEN SQLCODE NOT = ZERO                                  02805900
                                                                        02806000
                  MOVE SQLCODE                  TO PV-SQLCODE           02806100
                  MOVE XLT00006-INTR-UPC-ID     TO PV-INT-UPC-DISP      02806200
                  MOVE PC-TSYMSG-01570          TO PV-TSYMSG-NUMBER     02806300
                                                                        02806400
                  STRING 'SELECT XLV_SKU_STR FAILED WITH SQLCODE:'      02806500
                   PV-SQLCODE ' INTR UPC:' PV-INT-UPC-DISP              02806600
                            DELIMITED BY SIZE INTO PV-ERROR-MSG         02806700
                                                                        02806800
                  MOVE '2950-SELECT-COST-RETAIL ' TO PV-PARA-NAME       02806900
                  PERFORM 9995-CSSL-LOG-RETURN                          02807000
                                                                        02807100
            END-EVALUATE                                                02807200
            .                                                           02807300
      *----------------------------------------------------------------*02807400
      *   FIND UNIT RETAIL AMOUNT & UNIT COST AMOUNT (CORP LOC)        *02807500
      *----------------------------------------------------------------*02807600
       2960-SELECT-CORP-COST-RTL.                                       02807700
                                                                        02807800
               EXEC SQL                                                 02807900
                 SELECT                                                 02808000
                      UNT_COST_AMT                                      02808100
                    , UNT_RTL_AMT                                       02808200
                   INTO                                                 02808300
                      :XLV00002-UNT-COST-AMT                            02808400
                    , :XLV00002-UNT-RTL-AMT                             02808500
                   FROM XLV_SKU_STR                                     02808600
                   WHERE INTR_UPC_ID         = :XLT00006-INTR-UPC-ID    02808700
                     AND STR_NBR             = 0                        02808800
                  WITH UR                                               02808900
               END-EXEC.                                                02809000
                                                                        02809100
            EVALUATE TRUE                                               02809200
               WHEN SQLCODE = ZERO                                      02809300
                                                                        02809400
                  MOVE XLV00002-UNT-COST-AMT                            02809500
                                      TO SU141-UNT-COST-AMT(PV-ITEM-IDX)02809600
                  MOVE XLV00002-UNT-RTL-AMT                             02809700
                                      TO SU141-UNT-RTL-AMT(PV-ITEM-IDX) 02809800
                                                                        02809900
               WHEN SQLCODE = 100                                       02810000
                                                                        02810100
                  MOVE 0             TO SU141-UNT-COST-AMT(PV-ITEM-IDX) 02810200
                                        SU141-UNT-RTL-AMT(PV-ITEM-IDX)  02810300
                                                                        02810400
               WHEN SQLCODE NOT = ZERO                                  02810500
                                                                        02810600
                  MOVE SQLCODE                  TO PV-SQLCODE           02810700
                  MOVE XLT00006-INTR-UPC-ID     TO PV-INT-UPC-DISP      02810800
                  MOVE PC-TSYMSG-01570          TO PV-TSYMSG-NUMBER     02810900
                                                                        02811000
                  STRING 'SELECT XLV_SKU_STR FAILED WITH SQLCODE:'      02811100
                   PV-SQLCODE ' INTR UPC:' PV-INT-UPC-DISP              02811200
                            DELIMITED BY SIZE INTO PV-ERROR-MSG         02811300
                                                                        02811400
                  MOVE '2960-SELECT-CORP-COST-RTL' TO PV-PARA-NAME      02811500
                  PERFORM 9995-CSSL-LOG-RETURN                          02811600
                                                                        02811700
            END-EVALUATE                                                02811800
            .                                                           02811900
      *----------------------------------------------------------------*02812000
      *   FIND TRANSFER REQUEST NUMBER FOR TRANSFER TYPE CORTANS       *02812100
      *----------------------------------------------------------------*02812200
       3000-FIND-XFER-ID.                                               02812300
                                                                        02812400
             IF SUT00028-TRN-NBR = PV-SAVE-TRN-NBR                      02812500
                                                                        02812600
                MOVE PV-SAVE-XFER-IND  TO SU141-XFER-IND(PV-ITEM-IDX)   02812700
                MOVE PV-SAVE-XFER-NBR  TO SU141-XFER-NBR(PV-ITEM-IDX)   02812800
                MOVE PV-SAVE-CUST-REQ-IND TO                            02812900
                                       SU141-CUST-REQ-IND(PV-ITEM-IDX)  02813000
                MOVE PV-SAVE-CUST-NAME TO SU141-CUST-NAME(PV-ITEM-IDX)  02813100
                                                                        02813200
             ELSE                                                       02813300
                                                                        02813400
                MOVE SUT00028-TRN-NBR    TO PV-TRN-NBR-COMP             02813500
                                            PV-SAVE-TRN-NBR             02813600
                MOVE PV-TRN-NBR-COMP     TO PV-TRN-NBR                  02813700
                MOVE PV-TRN-STORE        TO TFMSTR-FR-STR-NBR           02813800
                MOVE PV-TRN-SEQUENCE     TO TFMSTR-XFER-SEQ-NBR         02813900
                                                                        02814000
                PERFORM 3100-READ-TTFMSTR                               02814100
                                                                        02814200
             END-IF.                                                    02814300
                                                                        02814400
      *----------------------------------------------------------------*02814500
      *   FIND TRAILER ID                                              *02814600
      *----------------------------------------------------------------*02814700
       3050-FIND-TRAILER-ID.                                            02814800
                                                                        02814900
            MOVE SUT00024-OTBND-TRIP-ID  TO SUOBTS-OTBND-TRIP-ID        02815000
                                            PV-TRIP-DISP.               02815100
                                                                        02815200
            EXEC SQL                                                    02815300
               SELECT                                                   02815400
                  OBTS.TRLR_SEAL_ID                                     02815500
                 ,OBTR.ORGN_OPER_UNT_ID                                 02815600
                 ,OBTR.TRLR_SRL_NBR                                     02815700
                 ,TRID.SCAC_CDE                                         02815800
                 ,TRID.TRLR_ID                                          02815900
               INTO                                                     02816000
                  :SUOBTS-TRLR-SEAL-ID                                  02816100
                 ,:SUOBTR-ORGN-OPER-UNT-ID                              02816200
                 ,:SUOBTR-TRLR-SRL-NBR                                  02816300
                 ,:CNTRID-SCAC-CDE                                      02816400
                 ,:CNTRID-TRLR-ID                                       02816500
               FROM                                                     02816600
                   TSUOBTS OBTS                                         02816700
                 , TSUOBTR OBTR                                         02816800
                 , TCNTRID TRID                                         02816900
               WHERE                                                    02817000
                     OBTS.OTBND_TRIP_ID = :SUOBTS-OTBND-TRIP-ID         02817100
                 AND OBTS.OTBND_TRIP_ID = OBTR.OTBND_TRIP_ID            02817200
                 AND OBTR.TRIP_ACTV_CDE = 'A'                           02817300
                 AND OBTS.TRIP_STAT_CDE = 'DS'                          02817400
                 AND OBTR.TRLR_SRL_NBR  = TRID.TRLR_SRL_NBR             02817500
               WITH UR                                                  02817600
           END-EXEC.                                                    02817700
                                                                        02817800
           EVALUATE TRUE                                                02817900
              WHEN SQLCODE = ZERO                                       02818000
                                                                        02818100
                 MOVE SUOBTS-TRLR-SEAL-ID     TO                        02818200
                                      SU141-TRLR-SEAL-ID(PV-ITEM-IDX)   02818300
                 MOVE SUOBTR-ORGN-OPER-UNT-ID TO                        02818400
                                      SU141-SHIP-NODE(PV-ITEM-IDX)      02818500
                 MOVE SUOBTR-TRLR-SRL-NBR     TO                        02818600
                                      SU141-TRLR-SRL-NBR(PV-ITEM-IDX)   02818700
                 MOVE CNTRID-SCAC-CDE         TO                        02818800
                                      SU141-TRLR-SCAC-CDE(PV-ITEM-IDX)  02818900
                 MOVE CNTRID-TRLR-ID          TO                        02819000
                                      SU141-TRAILER-ID(PV-ITEM-IDX)     02819100
                                                                        02819200
              WHEN SQLCODE = 100                                        02819300
                                                                        02819400
                 MOVE SPACES       TO SU141-TRLR-SEAL-ID(PV-ITEM-IDX)   02819500
                 MOVE 0            TO SU141-SHIP-NODE(PV-ITEM-IDX)      02819600
                                      SU141-TRLR-SRL-NBR(PV-ITEM-IDX)   02819700
                 MOVE SPACES       TO SU141-TRLR-SCAC-CDE(PV-ITEM-IDX)  02819800
                                      SU141-TRAILER-ID(PV-ITEM-IDX)     02819900
                                                                        02820000
              WHEN SQLCODE NOT = ZERO                                   02820100
                                                                        02820200
                 MOVE SQLCODE    TO PV-SQLCODE                          02820300
                                                                        02820400
                 STRING 'SELECT TSUOBTS FAILED WITH SQLCODE:'           02820500
                        PV-SQLCODE ' TRIP#' PV-TRIP-DISP                02820600
                      DELIMITED BY SIZE INTO       PV-ERROR-MSG         02820700
                                                                        02820800
                 MOVE ' 3050-FIND-TRAILER-ID '  TO PV-PARA-NAME         02820900
                 PERFORM 9995-CSSL-LOG-RETURN                           02821000
                                                                        02821100
           END-EVALUATE.                                                02821200
                                                                        02821300
      *----------------------------------------------------------------*02821400
      *   FIND TRANSFER REQUEST NUMBER USING TTFMSTR TABLE             *02821500
      *----------------------------------------------------------------*02821600
       3100-READ-TTFMSTR.                                               02821700
                                                                        02821800
               EXEC SQL                                                 02821900
                 SELECT                                                 02822000
                      XFER_DKEY_ID                                      02822100
                    , XFER_TYP_CDE                                      02822200
                   INTO                                                 02822300
                      :TFMSTR-XFER-DKEY-ID                              02822400
                    , :TFMSTR-XFER-TYP-CDE                              02822500
                   FROM TTFMSTR                                         02822600
                   WHERE FR_STR_NBR   = :TFMSTR-FR-STR-NBR              02822700
                     AND XFER_SEQ_NBR = :TFMSTR-XFER-SEQ-NBR            02822800
                  WITH UR                                               02822900
               END-EXEC.                                                02823000
                                                                        02823100
            EVALUATE TRUE                                               02823200
               WHEN SQLCODE = ZERO                                      02823300
                                                                        02823400
                  MOVE TFMSTR-XFER-DKEY-ID TO                           02823500
                                        SU141-XFER-NBR (PV-ITEM-IDX)    02823600
                                        PV-SAVE-XFER-NBR                02823700
                  IF TFMSTR-XFER-TYP-CDE = 05                           02823800
                                                                        02823900
                     MOVE 'Y'        TO SU141-CUST-REQ-IND(PV-ITEM-IDX) 02824000
                                        PV-SAVE-CUST-REQ-IND            02824100
                                                                        02824200
                     PERFORM 3200-READ-TTFCUST                          02824300
                                                                        02824400
                  ELSE                                                  02824500
                                                                        02824600
                     MOVE 'N'        TO SU141-CUST-REQ-IND(PV-ITEM-IDX) 02824700
                                        PV-SAVE-CUST-REQ-IND            02824800
                                                                        02824900
                  END-IF                                                02825000
                                                                        02825100
               WHEN SQLCODE = 100                                       02825200
                                                                        02825300
                  MOVE 0             TO SU141-XFER-NBR(PV-ITEM-IDX)     02825400
                                        PV-SAVE-XFER-NBR                02825500
                  MOVE SPACES        TO SU141-CUST-REQ-IND(PV-ITEM-IDX) 02825600
                                        PV-SAVE-CUST-REQ-IND            02825700
                                        SU141-CUST-NAME(PV-ITEM-IDX)    02825800
                                        PV-SAVE-CUST-NAME               02825900
                                                                        02826000
               WHEN SQLCODE NOT = ZERO                                  02826100
                                                                        02826200
                  MOVE SQLCODE                  TO PV-SQLCODE           02826300
                  MOVE PC-TSYMSG-01570          TO PV-TSYMSG-NUMBER     02826400
                                                                        02826500
                  STRING 'SELECT TTFMSTR FAILED WITH SQLCODE:'          02826600
                   PV-SQLCODE 'TRN NBR:' PV-TRN-NBR                     02826700
                            DELIMITED BY SIZE INTO PV-ERROR-MSG         02826800
                                                                        02826900
                  MOVE '3100-READ-TTFMSTR'      TO PV-PARA-NAME         02827000
                  PERFORM 9995-CSSL-LOG-RETURN                          02827100
                                                                        02827200
            END-EVALUATE                                                02827300
            .                                                           02827400
      *----------------------------------------------------------------*02827500
      *   FIND CUSTOMER NAME OF THE CUSTOMER REQUESTED TRANSFER        *02827600
      *----------------------------------------------------------------*02827700
       3200-READ-TTFCUST.                                               02827800
                                                                        02827900
               EXEC SQL                                                 02828000
                 SELECT                                                 02828100
                      CUST_NM                                           02828200
                   INTO                                                 02828300
                      :TFCUST-CUST-NM                                   02828400
                   FROM TTFCUST                                         02828500
                   WHERE XFER_DKEY_ID = :TFMSTR-XFER-DKEY-ID            02828600
                  WITH UR                                               02828700
               END-EXEC.                                                02828800
                                                                        02828900
            EVALUATE TRUE                                               02829000
               WHEN SQLCODE = ZERO                                      02829100
                                                                        02829200
                  MOVE TFCUST-CUST-NM TO SU141-CUST-NAME(PV-ITEM-IDX)   02829300
                                         PV-SAVE-CUST-NAME              02829400
                                                                        02829500
               WHEN SQLCODE = 100                                       02829600
                                                                        02829700
                  MOVE SPACES         TO SU141-CUST-NAME(PV-ITEM-IDX)   02829800
                                         PV-SAVE-CUST-NAME              02829900
                                                                        02830000
               WHEN SQLCODE NOT = ZERO                                  02830100
                                                                        02830200
                  MOVE SQLCODE                  TO PV-SQLCODE           02830300
                  MOVE TFMSTR-XFER-DKEY-ID      TO PV-XFER-ID-DISP      02830400
                  MOVE PC-TSYMSG-01570          TO PV-TSYMSG-NUMBER     02830500
                                                                        02830600
                  STRING 'SELECT TTFCUST FAILED WITH SQLCODE:'          02830700
                   PV-SQLCODE 'XFER ID:' PV-XFER-ID-DISP                02830800
                            DELIMITED BY SIZE INTO PV-ERROR-MSG         02830900
                                                                        02831000
                  MOVE '3200-READ-TTFCUST'      TO PV-PARA-NAME         02831100
                  PERFORM 9995-CSSL-LOG-RETURN                          02831200
                                                                        02831300
            END-EVALUATE                                                02831400
            .                                                           02831500
      *----------------------------------------------------------------*02831600
      *   FIND PARENT CARTON ID OF THE INPUT MASTER CARTON             *02831700
      *   IF NO VALUE FOUND, THE INPUT CARTON WILL BE THE PARENT CARTON*02831800
      *----------------------------------------------------------------*02831900
       4100-FIND-PRNT-CART-ID.                                          02832000
                                                                        02832100
            EXEC SQL                                                    02832200
               SELECT                                                   02832300
                   A.MSTR_SHIPT_UNT_ID                                  02832400
                 , A.ACTN_TYP_CDE                                       02832500
                INTO                                                    02832600
                    :SUT00099-MSTR-SHIPT-UNT-ID                         02832700
                  , :SUT00099-ACTN-TYP-CDE                              02832800
                FROM                                                    02832900
                      SUT_MSTR_SHIPT_CNT A                              02833000
                WHERE                                                   02833100
                     A.CHLD_MSTR_SHIPT_ID  = :DK-CHLD-MSTR-SHIPT-ID     02833200
                 AND A.CRE_TMST IN                                      02833300
                   (SELECT MAX(B.CRE_TMST)                              02833400
                    FROM SUT_MSTR_SHIPT_CNT B                           02833500
                    WHERE                                               02833600
                         A.CHLD_MSTR_SHIPT_ID = B.CHLD_MSTR_SHIPT_ID)   02833700
                 WITH UR                                                02833800
            END-EXEC.                                                   02833900
                                                                        02834000
            EVALUATE TRUE                                               02834100
               WHEN SQLCODE = ZERO                                      02834200
                                                                        02834300
                  IF SUT00099-ACTN-TYP-CDE = 'AMM'                      02834400
                                                                        02834500
                     MOVE SUT00099-MSTR-SHIPT-UNT-ID TO                 02834600
                                               DK-CHLD-MSTR-SHIPT-ID    02834700
                                               PV-PRNT-CART-ID          02834800
                                                                        02834900
                  ELSE                                                  02835000
                                                                        02835100
                     SET PS-NO-MORE-MSTR TO TRUE                        02835200
                                                                        02835300
                  END-IF                                                02835400
                                                                        02835500
               WHEN SQLCODE = +100                                      02835600
                                                                        02835700
                  SET PS-NO-MORE-MSTR TO TRUE                           02835800
                                                                        02835900
               WHEN SQLCODE NOT = ZERO                                  02836000
                                                                        02836100
                  MOVE SQLCODE                  TO PV-SQLCODE           02836200
                  MOVE DK-CHLD-MSTR-SHIPT-ID    TO PV-CARTON-DISP       02836300
                  MOVE PC-TSYMSG-01570          TO PV-TSYMSG-NUMBER     02836400
                                                                        02836500
                  STRING                                                02836600
                  'SELECT SUT_MSTR_SHIPT_CNT FAILED WITH SQLCODE:'      02836700
                   PV-SQLCODE ' CARTON:' PV-CARTON-DISP                 02836800
                            DELIMITED BY SIZE INTO PV-ERROR-MSG         02836900
                                                                        02837000
                  MOVE '4100-FIND-PRNT-CART-ID' TO PV-PARA-NAME         02837100
                  PERFORM 9995-CSSL-LOG-RETURN                          02837200
                                                                        02837300
            END-EVALUATE                                                02837400
            .                                                           02837500
      *----------------------------------------------------------------*02837600
      *   FIND CARTON-TRAILER ATTACHED TIMESTAMP FROM SUT_OTBND_LOC    *02837700
      *   IF NO VALUE FOUND, FIND DIVERT TIMESTAMP FROM TSUCRDV TABLE  *02837800
      *----------------------------------------------------------------*02837900
       4200-GET-TRLR-TMST.                                              02838000
                                                                        02838100
            EXEC SQL                                                    02838200
               SELECT                                                   02838300
                   A.CRE_TMST                                           02838400
                INTO                                                    02838500
                    :SUT00027-CRE-TMST                                  02838600
                FROM                                                    02838700
                      SUT_OTBND_LOC A                                   02838800
                WHERE                                                   02838900
                     A.SHIPT_UNT_ID   = :DK-SHIPT-UNT-ID                02839000
                 AND A.SCN_CDE        = 'SHON'                          02839100
                 AND A.ACTV_CDE       = 'A'                             02839200
                 WITH UR                                                02839300
            END-EXEC.                                                   02839400
                                                                        02839500
            EVALUATE TRUE                                               02839600
               WHEN SQLCODE = ZERO                                      02839700
                                                                        02839800
                  MOVE SUT00027-CRE-TMST TO PV-TRLR-TMST                02839900
                  MOVE PV-TRLR-DATE      TO PV-TMST-DATE                02840000
                  MOVE PV-TRLR-TIME      TO PV-TMST-TIME                02840100
                  MOVE PV-TMST           TO PV-SAVE-TRLR-TMST           02840200
                                     SU141-SML-TRLR-TMST(PV-ITEM-IDX)   02840300
                                                                        02840400
               WHEN SQLCODE = +100                                      02840500
                                                                        02840600
                  PERFORM 4300-GET-TRLR-DVRT-TMST                       02840700
                                                                        02840800
               WHEN SQLCODE NOT = ZERO                                  02840900
                                                                        02841000
                  MOVE SQLCODE                  TO PV-SQLCODE           02841100
                  MOVE PC-TSYMSG-01570          TO PV-TSYMSG-NUMBER     02841200
                                                                        02841300
                  STRING 'SELECT SUT_OTBND_LOC FAILED WITH SQLCODE:'    02841400
                   PV-SQLCODE ' CARTON:' PV-CARTON-DISP                 02841500
                            DELIMITED BY SIZE INTO PV-ERROR-MSG         02841600
                                                                        02841700
                  MOVE '4200-GET-TRLR-TMST' TO PV-PARA-NAME             02841800
                  PERFORM 9995-CSSL-LOG-RETURN                          02841900
                                                                        02842000
            END-EVALUATE                                                02842100
            .                                                           02842200
      *----------------------------------------------------------------*02842300
      *   FIND DIVERT TIMESTAMP FROM TSUCRDV TABLE                     *02842400
      *----------------------------------------------------------------*02842500
       4300-GET-TRLR-DVRT-TMST.                                         02842600
                                                                        02842700
            EXEC SQL                                                    02842800
               SELECT                                                   02842900
                   A.DIVERT_TMST                                        02843000
                INTO                                                    02843100
                    :SUCRDV-DIVERT-TMST                                 02843200
                FROM                                                    02843300
                      TSUCRDV A                                         02843400
                    , TSUCDOT B                                         02843500
                WHERE                                                   02843600
                      A.SHIPT_UNT_ID   = :DK-SHIPT-UNT-ID               02843700
                 AND  A.ACTV_CDE       = 'A'                            02843800
                 AND  B.OTBND_TRIP_ID  = :SUT00024-OTBND-TRIP-ID        02843900
                 AND  A.DIVERT_TMST   >= B.STRT_DIVERT_TMST             02844000
                 AND  A.DIVERT_TMST   <= B.END_DIVERT_TMST              02844100
                 AND  A.DOOR_ID        = B.DOOR_ID                      02844200
                 AND  A.DIVERT_TMST    =                                02844300
                          (SELECT MAX(C.DIVERT_TMST)                    02844400
                      FROM  TSUCRDV C                                   02844500
                      WHERE A.SHIPT_UNT_ID = C.SHIPT_UNT_ID             02844600
                        AND C.DIVERT_TMST >= B.STRT_DIVERT_TMST         02844700
                        AND c.DIVERT_TMST <= B.END_DIVERT_TMST)         02844800
                 WITH UR                                                02844900
            END-EXEC.                                                   02845000
                                                                        02845100
            EVALUATE TRUE                                               02845200
               WHEN SQLCODE = ZERO                                      02845300
                                                                        02845400
                  MOVE SUCRDV-DIVERT-TMST TO PV-TRLR-TMST               02845500
                  MOVE PV-TRLR-DATE       TO PV-TMST-DATE               02845600
                  MOVE PV-TRLR-TIME       TO PV-TMST-TIME               02845700
                  MOVE PV-TMST            TO PV-SAVE-TRLR-TMST          02845800
                                     SU141-SML-TRLR-TMST(PV-ITEM-IDX)   02845900
                                                                        02846000
               WHEN SQLCODE = +100                                      02846100
                                                                        02846200
                  MOVE SPACES             TO PV-SAVE-TRLR-TMST          02846300
                                       SU141-SML-TRLR-TMST(PV-ITEM-IDX) 02846400
                                                                        02846500
               WHEN SQLCODE NOT = ZERO                                  02846600
                                                                        02846700
                  MOVE SQLCODE                  TO PV-SQLCODE           02846800
                  MOVE PC-TSYMSG-01570          TO PV-TSYMSG-NUMBER     02846900
                                                                        02847000
                  STRING 'SELECT TSUCRDV FAILED WITH SQLCODE:'          02847100
                   PV-SQLCODE ' CARTON:' PV-CARTON-DISP                 02847200
                            DELIMITED BY SIZE INTO PV-ERROR-MSG         02847300
                                                                        02847400
                  MOVE '4300-GET-TRLR-DVRT-TMST' TO PV-PARA-NAME        02847500
                  PERFORM 9995-CSSL-LOG-RETURN                          02847600
                                                                        02847700
            END-EVALUATE                                                02847800
            .                                                           02847900
       4400-CHECK-CARTON-RECEIVED.                                      02848000
                                                                        02848100
            EXEC SQL                                                    02848200
                SELECT                                                  02848300
                        A.SHIPT_UNT_ID                                  02848400
                  INTO                                                  02848500
                        :SUT00121-SHIPT-UNT-ID                          02848600
                  FROM  SUT_OTBND_STR_SCN A                             02848700
                 WHERE  A.SHIPT_UNT_ID  = :DK-SHIPT-UNT-ID              02848800
                   AND  A.ACTV_IND      = 'Y'                           02848900
                WITH UR                                                 02849000
            END-EXEC.                                                   02849100
                                                                        02849200
            EVALUATE TRUE                                               02849300
               WHEN SQLCODE = ZERO                                      02849400
                                                                        02849500
                  MOVE 'Y'        TO SU141-CARTON-RECEIVED(PV-ITEM-IDX) 02849600
                                     PV-SAVE-RCVD-FLAG                  02849700
               WHEN SQLCODE = 100                                       02849800
                                                                        02849900
                  MOVE 'N'        TO SU141-CARTON-RECEIVED(PV-ITEM-IDX) 02850000
                                     PV-SAVE-RCVD-FLAG                  02850100
               WHEN SQLCODE = -811                                      02850200
                                                                        02850300
                  MOVE 'Y'        TO SU141-CARTON-RECEIVED(PV-ITEM-IDX) 02850400
                                     PV-SAVE-RCVD-FLAG                  02850500
               WHEN SQLCODE NOT = ZERO                                  02850600
                                                                        02850700
                  MOVE SQLCODE    TO PV-SQLCODE                         02850800
                  MOVE PC-TSYMSG-01570         TO PV-TSYMSG-NUMBER      02850900
                  STRING                                                02851000
                   'SELECT SUT_OTBND_STR_SCAN FAILED WITH SQLCODE:'     02851100
                         PV-SQLCODE ' SML#' PV-CARTON-DISP              02851200
                       DELIMITED BY SIZE INTO       PV-ERROR-MSG        02851300
                                                                        02851400
                  MOVE '4400-CHECK-CARTON-RECEIVED' TO PV-PARA-NAME     02851500
                  PERFORM 9995-CSSL-LOG-RETURN                          02851600
                                                                        02851700
            END-EVALUATE                                                02851800
            .                                                           02851900
      *----------------------------------------------------------------*02852000
      *   LOG ERROR MESSAGES IN CICS CSSL                              *02852100
      *----------------------------------------------------------------*02852200
       9990-CSSL-LOG.                                                   02852300
                                                                        02852400
            MOVE LENGTH OF PV-CICS-MSG-AREA  TO PV-COMMAREA-LENGTH.     02852500
                                                                        02852600
            EXEC CICS                                                   02852700
                 WRITEQ TD                                              02852800
                  QUEUE   ('CSSL')                                      02852900
                   FROM   (PV-CICS-MSG-AREA)                            02853000
                   NOHANDLE                                             02853100
            END-EXEC.                                                   02853200
                                                                        02853300
      *----------------------------------------------------------------*02853400
      *   LOG ERROR MESSAGES IN CICS CSSL AND RETURN THE TRAN          *02853500
      *----------------------------------------------------------------*02853600
       9995-CSSL-LOG-RETURN.                                            02853700
                                                                        02853800
           PERFORM 9990-CSSL-LOG.                                       02853900
                                                                        02854000
           PERFORM 9000-RETURN-TRAN.                                    02854100
                                                                        02854200
      *----------------------------------------------------------------*02854300
      *   FIND THE MESSAGE FROM MESSAGE MODULE USING MESSAGE NUMBER,   *02854400
      *   SEND THE OUTPUT TO PIPELINE THEN RETURN THE TRANSACTION      *02854500
      *----------------------------------------------------------------*02854600
       9000-RETURN-TRAN.                                                02854700
                                                                        02854800
           MOVE PV-TSYMSG-NUMBER         TO DP507I-MSG-NUMBER           02854900
                                            SU141-MSG-ID.               02855000
                                                                        02855100
           PERFORM 9010-READ-SYSTEM-MESSAGE.                            02855200
           MOVE DP507I-MSG-TEXT          TO SU141-MSG-TEXT.             02855300
           MOVE SU141-OUT-MSTR-CRTN-DETAILS TO DFHCOMMAREA.             02855400
           PERFORM 9999-PUT-CONTAINER.                                  02855500
                                                                        02855600
           EXEC CICS RETURN END-EXEC.                                   02855700
                                                                        02855800
      *----------------------------------------------------------------*02855900
      *   FIND THE MESSAGE FROM MESSAGE MODULE USING MESSAGE NUMBER    *02856000
      *----------------------------------------------------------------*02856100
       9010-READ-SYSTEM-MESSAGE.                                        02856200
           EXEC CICS READ                                               02856300
                     DATASET ('DPSYSMSG')                               02856400
                     RIDFLD  (DP507I-MSG-NUMBER)                        02856500
                     INTO    (DP507I-MESSAGES-INPUT-RECORD)             02856600
                     RESP    (PV-CICS-RESPONSE)                         02856700
           END-EXEC.                                                    02856800
      *                                                                 02856900
           IF  PV-CICS-RESPONSE NOT = 0                                 02857000
               MOVE ' ** ABEND **   UNABLE TO TRANSLATE MESSAGE NUMBER' 02858000
                                      TO DP507I-MSG-TEXT                02859000
           END-IF.                                                      02860000
                                                                        02870000
      *----------------------------------------------------------------*02880000
      *   PUT THE OUTPUT TO CONTAINER                                  *02890000
      *----------------------------------------------------------------*02900000
       9999-PUT-CONTAINER.                                              02910000
                                                                        02920000
            EXEC CICS                                                   02930000
              PUT CONTAINER('DFHWS-DATA')                               02940000
              FROM(SU141-OUT-MSTR-CRTN-DETAILS)                         02950000
              RESP(PV-CICS-RESPONSE)                                    02960000
            END-EXEC.                                                   02970000
                                                                        02980000
            EVALUATE PV-CICS-RESPONSE                                   02990000
                                                                        03000000
               WHEN DFHRESP(NORMAL)                                     03010000
                                                                        03020000
                  CONTINUE                                              03030000
                                                                        03040000
               WHEN OTHER                                               03050000
                                                                        03060000
                  MOVE PV-CICS-RESPONSE TO  PV-RESP-DISP                03070000
                                                                        03080000
                  MOVE PC-TSYMSG-01570          TO PV-TSYMSG-NUMBER     03090000
                  STRING 'PUT CONTAINER FAILED CICS RESP CODE:'         03100000
                   PV-RESP-DISP DELIMITED BY SIZE INTO PV-ERROR-MSG     03110000
                                                                        03120000
                  MOVE '9999-PUT-CONTAINER   '      TO PV-PARA-NAME     03130000
                  PERFORM 9995-CSSL-LOG-RETURN                          03140000
                                                                        03150000
            END-EVALUATE.                                               03160000
                                                                        03170000
