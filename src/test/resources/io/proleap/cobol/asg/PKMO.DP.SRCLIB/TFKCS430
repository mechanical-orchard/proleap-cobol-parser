      *-----------------------*                                         00010000
       IDENTIFICATION DIVISION.                                         00020000
      *-----------------------*                                         00030000
       PROGRAM-ID.    TFKCS430.                                         00040000
       AUTHOR.        JACK KRAMER.                                      00050000
       INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060000
       DATE-WRITTEN.  SEPTEMBER 1996.                                   00070000
       DATE-COMPILED.                                                   00080000
      *----------------------------------------------------------------*00090000
      *    P430 - TRANSFER HEADER INQUIRY                              *00100000
      *                                                                *00110000
      *    THIS PROGRAM DISPLAYS HEADER INFORMATION FOR A              *00120000
      *    SELECTED STORE TRANSFER.                                    *00130000
      *----------------------------------------------------------------*00160000
      *  1/20/2003 - RAY GRAF                                           00170000
      *   PROCESS NONINTELLIGENT SKU.                                   00180000
111703******************************************************************00190000
111703* 11/17/2003 - RAY GRAF                                           00200000
111703*   SORT1/SORT2 TRANSFER TYPES.                                   00210000
111703*     REJECT SORT1 ITEMS FOR DEF/DAM SORT 2 TRANSFER TYPE         00220000
111703*     REJECT SORT2 ITEMS FOR DEF/DAM SORT 1 TRANSFER TYPE         00230000
111703*     REJECT DEPT 127 AND 427 FOR EITHER DEF/DAM TRANSFER TYPE    00240000
111703*         WHEN THE 'TO' STORE IS 811 (FINDLAY)                    00250000
111703******************************************************************00260000
080204**DATE:08/02/2004 CHANGED BY: RAY GRAF                            00270000
080204**     CHANGE PRINTER DESTINATION TO NEW 8 CHARACTER FORMAT       00280000
      ***************************************************************** 00280100
100404** 10/04/2004 CHANGED BY: RAY GRAF                                00280200
100404**     EXPAND STORE NUMBER. MAKE DOMAIN COMPLIANT.                00280300
      ***************************************************************** 00280400
SR3403*  DATE 03/19/12 JALAJ KUMAR                WR#SR3403             00280500
SR3403*  PRICE FIELD EXPANSIONS FOR LARGE RETAIL PROJECT                00280600
SR3403******************************************************************00280700
CICS  * CHANGED 11/17/2022    BY JIM HUNTER      WR: CHG0278345         00280801
CICS  * ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL        00280901
CICS  * DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.       00281001
CICS  *-----------------------------------------------------------------00281101
                                                                        00281200
       ENVIRONMENT DIVISION.                                            00281300
                                                                        00281400
                                                                        00281500
       DATA DIVISION.                                                   00281600
                                                                        00281700
                                                                        00281800
       WORKING-STORAGE SECTION.                                         00281900
                                                                        00282000
       01  DK-DB2-KEYS.                                                 00290000
           05  DK-STORE-NBR             PIC S9(04)  COMP  VALUE +0.     00291000
           05  DK-FROM-STORE            PIC S9(04)  COMP  VALUE +0.     00292000
           05  DK-XFER-SEQ-NBR          PIC S9(09)  COMP  VALUE +0.     00300000
      *                                                                 00340000
       01  PC-PROGRAM-CONSTANTS.                                        00350000
           05  PC-CURRENT-PROGRAM-NAME  PIC  X(08)  VALUE  'TFKCS430'.  00360000
           05  PC-CURRENT-MAP-NAME      PIC  X(08)  VALUE  'TF430A  '.  00370000
           05  PC-CURRENT-MAPSET-NAME   PIC  X(08)  VALUE  'TFKM430 '.  00380000
           05  PC-COMMON-HEADER-MAP-NAME      PIC  X(08)  VALUE         00580000
                                                          'TF430A  '.   00590000
           05  PC-RECEIVED-MAP-NAME           PIC  X(08)  VALUE         00600000
                                                          'TF430B  '.   00610000
           05  PC-COMMENTS-MAP-NAME           PIC  X(08)  VALUE         00610100
                                                          'TF430C  '.   00610200
           05  PC-TRAILER-CONTAINER     PIC  X(02)  VALUE '04'.         00610300
           05  PC-POSITIVE-RECEIPT      PIC  X(02)  VALUE 'PR'.         00610400
           05  PC-ASSUMPTIVE-RECEIPT    PIC  X(02)  VALUE 'AR'.         00610500
           05  PC-INTERMEDIATE-RECEIPT  PIC  X(02)  VALUE 'IR'.         00610600
           05  PC-VOIDED                PIC  X(02)  VALUE 'VD'.         00610700
111703*    05  PC-DEFECTIVE-DAMAGE      PIC  9(01)  VALUE  1.           00610800
111703     05  PC-DEFECTIVE-DAMAGE-SORT1 PIC  9(01)  VALUE  0.          00610900
111703     05  PC-DEFECTIVE-DAMAGE-SORT2 PIC  9(01)  VALUE  1.          00611000
           05  PC-CALLBACK              PIC  9(01)  VALUE  2.           00611100
           05  PC-STOCK-BALANCE-CORP    PIC  9(01)  VALUE  3.           00611200
           05  PC-STOCK-BALANCE-STORE   PIC  9(01)  VALUE  4.           00611300
           05  PC-CUSTOMER              PIC  9(01)  VALUE  5.           00611400
           05  PC-NON-RETAIL            PIC  9(01)  VALUE  6.           00611500
           05  PC-OFFSITE-STORAGE       PIC  9(01)  VALUE  7.           00611600
           05  PC-YES                   PIC  X(01)  VALUE  'Y'.         00611700
           05  PC-NO                    PIC  X(01)  VALUE  'N'.         00611800
           05  PC-MAX-RETRIES           PIC S9(04)  VALUE  +3           00611900
                                                    COMP.               00612000
           05  PC-INTER-APPL-CODES.                                     00612100
               10  PC-INTER-APPL-CRIT-SPEC                              00612200
                                        PIC  X(01)  VALUE '1'.          00612300
               10  PC-INTER-APPL-LIST   PIC  X(01)  VALUE '2'.          00612400
               10  PC-INTER-APPL-DSCR   PIC  X(01)  VALUE '4'.          00612500
               10  PC-INTER-APPL-ITEM   PIC  X(01)  VALUE '3'.          00612600
           05  PC-TSYMSG-NUMBERS.                                       00612700
               10  PC-TSYMSG-00004      PIC  9(05)  VALUE  00004.       00612800
               10  PC-TSYMSG-00045      PIC  9(05)  VALUE  00045.       00612900
               10  PC-TSYMSG-00069      PIC  9(05)  VALUE  00069.       00613000
               10  PC-TSYMSG-00070      PIC  9(05)  VALUE  00070.       00613100
               10  PC-TSYMSG-00098      PIC  9(05)  VALUE  00098.       00613200
               10  PC-TSYMSG-00148      PIC  9(05)  VALUE  00148.       00613300
               10  PC-TSYMSG-00302      PIC  9(05)  VALUE  00302.       00613400
               10  PC-TSYMSG-01399      PIC  9(05)  VALUE  01399.       00613500
               10  PC-TSYMSG-01400      PIC  9(05)  VALUE  01400.       00613600
               10  PC-TSYMSG-01403      PIC  9(05)  VALUE  01403.       00613700
               10  PC-TSYMSG-01414      PIC  9(05)  VALUE  01414.       00613800
               10  PC-TSYMSG-01415      PIC  9(05)  VALUE  01415.       00613900
               10  PC-TSYMSG-01416      PIC  9(05)  VALUE  01416.       00614000
               10  PC-TSYMSG-01572      PIC  9(05)  VALUE  01572.       00614100
               10  PC-TSYMSG-01581      PIC  9(05)  VALUE  01581.       00614200
           05  PC-CHECK-ROUTE-DISCREP-TEXT                              00614300
                                        PIC X(29)   VALUE               00614400
                     'CHECK ROUTING AND DISCREPANCY'.                   00614500
           05  PC-CHECK-ROUTING-TEXT    PIC  X(13)  VALUE               00614600
                     'CHECK ROUTING'.                                   00614700
           05  PC-CHECK-DISCREPANCY-TEXT                                00614800
                                        PIC X(17)   VALUE               00614900
                     'CHECK DISCREPANCY'.                               00615000
           05  PC-TRAILER-SEAL-LITERAL  PIC X(15)   VALUE               00615100
                     'TRAILER SEAL..:'.                                 00615200
           05  PC-ATTENTION-LITERAL     PIC X(15)   VALUE               00615300
                     'ATTENTION TO..:'.                                 00615400
           05  PC-CUSTOMER-LITERAL      PIC X(15)   VALUE               00615500
                     'CUSTOMER NAME.:'.                                 00615600
           05  PC-OFFSITE-NAME-LITERAL  PIC X(15)   VALUE               00615700
                     'WAREHOUSE NAME:'.                                 00615800
           05  PC-LARGE-TOTE-LITERAL    PIC X(15)   VALUE               00615900
                     'LG TOTE SEAL..:'.                                 00616000
           05  PC-OFFSITE-PHON-LITERAL  PIC X(16)   VALUE               00616100
                     'WAREHOUSE PHONE:'.                                00616200
           05  PC-SMALL-TOTE-LITERAL    PIC X(16)   VALUE               00616300
                     'SM TOTE SEAL...:'.                                00616400
           05  PC-CALLBACK-LITERAL      PIC X(16)   VALUE               00616500
                     'CALLBACK NO....:'.                                00616600
           05  PC-APPROVAL-LITERAL      PIC X(16)   VALUE               00616700
                     'APPROVAL NO....:'.                                00616800
           05  PC-REQUESTED-BY-LITERAL  PIC X(16)   VALUE               00616900
                     'REQUESTED BY...:'.                                00617000
           05  PC-TRAILER-NBR-LITERAL   PIC X(16)   VALUE               00617100
                     'TRAILER NO.....:'.                                00617200
      *                                                                 00617300
       01  PS-PROGRAM-SWITCHES.                                         00617400
           05  PS-TRANSFER-FOUND-SW     PIC X.                          00617500
               88  PS-TRANSFER-FOUND             VALUE 'Y'.             00617600
               88  PS-TRANSFER-NOT-FOUND         VALUE 'N'.             00617700
           05  PS-LIST-END-SW                 PIC X(01)    VALUE 'N'.   00617800
               88  PS-LIST-END                             VALUE 'Y'.   00617900
               88  PS-NO-LIST-END                          VALUE 'N'.   00618000
      *                                                                 00620000
       01  PV-PROGRAM-VARIABLES.                                        00670000
           05  PV-XFER-QTY              PIC S9(07)    VALUE +0 COMP-3.  00700000
           05  PV-XFER-PRICE            PIC S9(09)V99 VALUE +0 COMP-3.  00700100
           05  PV-RCVD-QTY              PIC S9(07)    VALUE +0 COMP-3.  00700200
           05  PV-RCVD-PRICE            PIC S9(09)V99 VALUE +0 COMP-3.  00700300
           05  PV-XFER-QTY-IND          PIC S9(04)  VALUE +0            00700400
                                                    COMP SYNC.          00700500
           05  PV-XFER-PRICE-IND        PIC S9(04)  VALUE +0            00700600
                                                    COMP SYNC.          00700700
           05  PV-RCVD-QTY-IND          PIC S9(04)  VALUE +0            00700800
                                                    COMP SYNC.          00700900
           05  PV-RCVD-PRICE-IND        PIC S9(04)  VALUE +0            00701000
                                                    COMP SYNC.          00701100
           05  PV-RETRY-COUNTER         PIC S9(04)  VALUE +0            00701200
                                                    COMP SYNC.          00701300
           05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      00701400
                                                          COMP SYNC.    00701500
           05  PV-SUB                         PIC S9(04)  VALUE +0      01360600
                                                          COMP SYNC.    01360700
           05  PV-MAP-START-BYTE              PIC S9(04)  VALUE ZERO    01365000
                                                          COMP SYNC.    01366000
           05  PV-XFER-NBR.                                             01367000
100404*        10  PV-XFER-FROM-STORE-NBR     PIC 9(03).                01368000
100404         10  PV-XFER-FROM-STORE-NBR     PIC 9(04).                01368100
               10                             PIC X    VALUE '-'.       01369000
               10  PV-XFER-SEQ-NBR            PIC 9(06).                01369100
           05  PV-PHONE                 PIC 9999BB999B9999.             01369200
           05  FILLER REDEFINES PV-PHONE.                               01369300
               10  PV-PHONE-LIT1        PIC X.                          01369400
               10                       PIC X(03).                      01369500
               10  PV-PHONE-LIT2        PIC X(02).                      01369600
               10                       PIC X(03).                      01369700
               10  PV-PHONE-LIT3        PIC X.                          01369800
               10                       PIC X(04).                      01369900
           05  PV-DATE.                                                 01370000
               10  PV-MONTH             PIC 9(02).                      01370100
               10                       PIC X      VALUE '/'.           01370200
               10  PV-DAY               PIC 9(02).                      01370300
               10                       PIC X      VALUE '/'.           01370400
               10  PV-YEAR              PIC 9(04).                      01370500
           05  PV-STATE-ZIP.                                            01370600
               10  PV-STATE             PIC X(02).                      01370700
               10                       PIC X      VALUE SPACE.         01370800
               10  PV-ZIP               PIC 9(05).                      01370900
               10  PV-ZIP-EXTENSION.                                    01371000
                   15  PV-ZIP-DASH      PIC X.                          01371100
                   15  PV-ZIP-EXT       PIC 9(04).                      01371200
           EJECT                                                        01371300
                                                                        01371400
      *----------------------------------------------------------------*01371500
      *  RF COPYBOOK TO FORMAT PRINTER DESTINATION                      01371600
      *----------------------------------------------------------------*01371700
080204     COPY RFWS009.                                                01371800
                                                                        01371900
      *----------------------------------------------------------------*01372000
      *    MAP LAYOUT                                                  *01372100
      *----------------------------------------------------------------*01372200
                                                                        01372300
           COPY TFKM430.                                                01372400
      *                                                                 01372500
       EJECT                                                            01372600
      ******************************************************************01372700
      *  ** NOTE **                                                    *01372800
      *      THE FOLLOWING IS A REDEFINITION OF THE TFKM430 MAP DSECT. *01372900
      *  ANY CHANGES TO THE MAP/DSECT MUST ALSO BE REFLECTED IN THIS   *01373000
      *  REDEFINITION.                                                 *01373100
      *  THE SCREEN IS OUTPUT ONLY AND DISPLAYS VARYING FIELDS         *01373200
      *  DEPENDING ON THE TRANSFER TYPE AND CONTAINER TYPE.            *01373300
      ******************************************************************01373400
      *                                                                 01373500
       01  MR-MAP-REDEFINITION.                                         01373600
           05  MR-A-COMMON.                                             01890000
               10  FILLER                     PIC  X(12).               01890100
      *                                                                 01890200
               10  MR-A-MESSAGE-LEN           PIC S9(04) COMP.          01890300
               10  MR-A-MESSAGE-FLAG          PIC  X(01).               01890400
               10  MR-A-MESSAGE-ATTRIB REDEFINES MR-A-MESSAGE-FLAG      01890500
                                              PIC  X(01).               01890600
               10  MR-A-MESSAGE-COLOR         PIC  X(01).               01890700
               10  MR-A-MESSAGE-HILITE        PIC  X(01).               01890800
               10  MR-A-MESSAGE               PIC  X(29).               01890900
      *                                                                 01891000
               10  MR-A-XFER-NBR-LEN          PIC S9(04) COMP.          01891100
               10  MR-A-XFER-NBR-FLAG         PIC  X(01).               01891200
               10  MR-A-XFER-NBR-ATTRIB REDEFINES MR-A-XFER-NBR-FLAG    01891300
                                              PIC  X(01).               01891400
               10  MR-A-XFER-NBR-COLOR        PIC  X(01).               01891500
               10  MR-A-XFER-NBR-HILITE       PIC  X(01).               01891600
               10  MR-A-XFER-NBR.                                       01891700
100404*            15  MR-A-XFER-FROM-STORE   PIC  999.                 01891800
100404             15  MR-A-XFER-FROM-STORE   PIC  9(4).                01891900
               10  MR-A-XFER-NBR-DASH         PIC  X.                   01892000
               10  MR-A-XFER-SEQ-NBR          PIC  9(06).               01892100
      *                                                                 01892200
               10  MR-A-STATUS-LEN            PIC S9(04) COMP.          01892300
               10  MR-A-STATUS-FLAG           PIC  X(01).               01892400
               10  MR-A-STATUS-ATTRIB REDEFINES MR-A-STATUS-FLAG        01892500
                                              PIC  X(01).               01892600
               10  MR-A-STATUS-COLOR          PIC  X(01).               01892700
               10  MR-A-STATUS-HILITE         PIC  X(01).               01892800
               10  MR-A-STATUS                PIC  X(20).               01892900
      *                                                                 01893000
               10  MR-A-LIN5-LITERAL-LEN      PIC S9(04) COMP.          01893100
               10  MR-A-LIN5-LITERAL-FLAG     PIC  X(01).               01893200
               10  MR-A-LIN5-LITERAL-ATTRIB REDEFINES                   01893300
                   MR-A-LIN5-LITERAL-FLAG     PIC  X(01).               01893400
               10  MR-A-LIN5-LITERAL-COLOR    PIC  X(01).               01893500
               10  MR-A-LIN5-LITERAL-HILITE   PIC  X(01).               01893600
               10  MR-A-LIN5-LITERAL          PIC  X(16).               01893700
      *                                                                 01893800
               10  MR-A-LIN5-FIELD-LEN        PIC S9(04) COMP.          01893900
               10  MR-A-LIN5-FIELD-FLAG       PIC  X(01).               01894000
               10  MR-A-LIN5-FIELD-ATTRIB REDEFINES                     01894100
                   MR-A-LIN5-FIELD-FLAG       PIC  X(01).               01894200
               10  MR-A-LIN5-FIELD-COLOR      PIC  X(01).               01894300
               10  MR-A-LIN5-FIELD-HILITE     PIC  X(01).               01894400
               10  MR-A-LIN5-FIELD            PIC  X(22).               01894500
      *                                                                 01894600
               10  MR-A-XFER-TYPE-LEN         PIC S9(04) COMP.          01894700
               10  MR-A-XFER-TYPE-FLAG        PIC  X(01).               01894800
               10  MR-A-XFER-TYPE-ATTRIB REDEFINES MR-A-XFER-TYPE-FLAG  01894900
                                              PIC  X(01).               01895000
               10  MR-A-XFER-TYPE-COLOR       PIC  X(01).               01895100
               10  MR-A-XFER-TYPE-HILITE      PIC  X(01).               01895200
               10  MR-A-XFER-TYPE             PIC  X(02).               01895300
      *                                                                 01895400
               10  MR-A-XFER-DESC-LEN         PIC S9(04) COMP.          01895500
               10  MR-A-XFER-DESC-FLAG        PIC  X(01).               01895600
               10  MR-A-XFER-DESC-ATTRIB REDEFINES MR-A-XFER-DESC-FLAG  01895700
                                              PIC  X(01).               01895800
               10  MR-A-XFER-DESC-COLOR       PIC  X(01).               01895900
               10  MR-A-XFER-DESC-HILITE      PIC  X(01).               01896000
               10  MR-A-XFER-DESC             PIC  X(19).               01896100
      *                                                                 01896200
               10  MR-A-CONTAINER-TYPE-LEN    PIC S9(04) COMP.          01896300
               10  MR-A-CONTAINER-TYPE-FLAG   PIC  X(01).               01896400
               10  MR-A-CONTAINER-TYPE-ATTRIB REDEFINES                 01896500
                   MR-A-CONTAINER-TYPE-FLAG   PIC  X(01).               01896600
               10  MR-A-CONTAINER-TYPE-COLOR  PIC  X(01).               01896700
               10  MR-A-CONTAINER-TYPE-HILITE PIC  X(01).               01896800
               10  MR-A-CONTAINER-TYPE        PIC  X(02).               01896900
      *                                                                 01897000
               10  MR-A-CONTAINER-DESC-LEN    PIC S9(04) COMP.          01897100
               10  MR-A-CONTAINER-DESC-FLAG   PIC  X(01).               01897200
               10  MR-A-CONTAINER-DESC-ATTRIB REDEFINES                 01897300
                   MR-A-CONTAINER-DESC-FLAG   PIC  X(01).               01897400
               10  MR-A-CONTAINER-DESC-COLOR  PIC  X(01).               01897500
               10  MR-A-CONTAINER-DESC-HILITE PIC  X(01).               01897600
               10  MR-A-CONTAINER-DESC        PIC  X(18).               01897700
      *                                                                 01897800
               10  MR-A-LIN7-LITERAL1-LEN     PIC S9(04) COMP.          01897900
               10  MR-A-LIN7-LITERAL1-FLAG    PIC  X(01).               01898000
               10  MR-A-LIN7-LITERAL1-ATTRIB REDEFINES                  01898100
                   MR-A-LIN7-LITERAL1-FLAG    PIC  X(01).               01898200
               10  MR-A-LIN7-LITERAL1-COLOR   PIC  X(01).               01898300
               10  MR-A-LIN7-LITERAL1-HILITE  PIC  X(01).               01898400
               10  MR-A-LIN7-LITERAL1         PIC  X(15).               01898500
      *                                                                 01898600
               10  MR-A-LIN7-FIELD1-LEN       PIC S9(04) COMP.          01898700
               10  MR-A-LIN7-FIELD1-FLAG      PIC  X(01).               01898800
               10  MR-A-LIN7-FIELD1-ATTRIB REDEFINES                    01898900
                   MR-A-LIN7-FIELD1-FLAG      PIC  X(01).               01899000
               10  MR-A-LIN7-FIELD1-COLOR     PIC  X(01).               01899100
               10  MR-A-LIN7-FIELD1-HILITE    PIC  X(01).               01899200
               10  MR-A-LIN7-FIELD1.                                    01899300
                   15  MR-A-LIN7-SEAL1        PIC X(07).                01899400
                   15                         PIC X.                    01899500
                   15  MR-A-LIN7-SEAL2        PIC X(07).                01899600
      *                                                                 01899700
               10  MR-A-LIN7-LITERAL2-LEN     PIC S9(04) COMP.          01899800
               10  MR-A-LIN7-LITERAL2-FLAG    PIC  X(01).               01899900
               10  MR-A-LIN7-LITERAL2-ATTRIB REDEFINES                  01900000
                   MR-A-LIN7-LITERAL2-FLAG    PIC  X(01).               01900100
               10  MR-A-LIN7-LITERAL2-COLOR   PIC  X(01).               01900200
               10  MR-A-LIN7-LITERAL2-HILITE  PIC  X(01).               01900300
               10  MR-A-LIN7-LITERAL2         PIC  X(16).               01900400
      *                                                                 01900500
               10  MR-A-LIN7-FIELD2-LEN       PIC S9(04) COMP.          01900600
               10  MR-A-LIN7-FIELD2-FLAG      PIC  X(01).               01900700
               10  MR-A-LIN7-FIELD2-ATTRIB REDEFINES                    01900800
                   MR-A-LIN7-FIELD2-FLAG      PIC  X(01).               01900900
               10  MR-A-LIN7-FIELD2-COLOR     PIC  X(01).               01901000
               10  MR-A-LIN7-FIELD2-HILITE    PIC  X(01).               01901100
               10  MR-A-LIN7-FIELD2           PIC  X(08).               01901200
      *                                                                 01901300
               10  MR-A-LIN8-LITERAL-LEN      PIC S9(04) COMP.          01901400
               10  MR-A-LIN8-LITERAL-FLAG     PIC  X(01).               01901500
               10  MR-A-LIN8-LITERAL-ATTRIB REDEFINES                   01901600
                   MR-A-LIN8-LITERAL-FLAG     PIC  X(01).               01901700
               10  MR-A-LIN8-LITERAL-COLOR    PIC  X(01).               01901800
               10  MR-A-LIN8-LITERAL-HILITE   PIC  X(01).               01901900
               10  MR-A-LIN8-LITERAL          PIC  X(15).               01902000
      *                                                                 01902100
               10  MR-A-LIN8-FIELD-LEN        PIC S9(04) COMP.          01902200
               10  MR-A-LIN8-FIELD-FLAG       PIC  X(01).               01902300
               10  MR-A-LIN8-FIELD-ATTRIB REDEFINES                     01902400
                   MR-A-LIN8-FIELD-FLAG      PIC  X(01).                01902500
               10  MR-A-LIN8-FIELD-COLOR      PIC  X(01).               01902600
               10  MR-A-LIN8-FIELD-HILITE     PIC  X(01).               01902700
               10  MR-A-LIN8-FIELD            PIC  X(20).               01902800
      *                                                                 01902900
               10  MR-A-PHONE-LITERAL-LEN     PIC S9(04) COMP.          01903000
               10  MR-A-PHONE-LITERAL-FLAG    PIC  X(01).               01903100
               10  MR-A-PHONE-LITERAL-ATTRIB REDEFINES                  01903200
                   MR-A-PHONE-LITERAL-FLAG    PIC  X(01).               01903300
               10  MR-A-PHONE-LITERAL-COLOR   PIC  X(01).               01903400
               10  MR-A-PHONE-LITERAL-HILITE  PIC  X(01).               01903500
               10  MR-A-PHONE-LITERAL         PIC  X(16).               01903600
      *                                                                 01903700
               10  MR-A-PHONE-LEN             PIC S9(04) COMP.          01903800
               10  MR-A-PHONE-FLAG            PIC  X(01).               01903900
               10  MR-A-PHONE-ATTRIB REDEFINES MR-A-PHONE-FLAG          01904000
                                              PIC  X(01).               01904100
               10  MR-A-PHONE-COLOR           PIC  X(01).               01904200
               10  MR-A-PHONE-HILITE          PIC  X(01).               01904300
               10  MR-A-PHONE                 PIC  X(14).               01904400
      *                                                                 01904500
               10  MR-A-ADDR-LITERAL-LEN      PIC S9(04) COMP.          01904600
               10  MR-A-ADDR-LITERAL-FLAG     PIC  X(01).               01904700
               10  MR-A-ADDR-LITERAL-ATTRIB REDEFINES                   01904800
                   MR-A-ADDR-LITERAL-FLAG     PIC  X(01).               01904900
               10  MR-A-ADDR-LITERAL-COLOR    PIC  X(01).               01905000
               10  MR-A-ADDR-LITERAL-HILITE   PIC  X(01).               01905100
               10  MR-A-ADDR-LITERAL          PIC  X(12).               01905200
      *                                                                 01905300
               10  MR-A-ADDR-LEN              PIC S9(04) COMP.          01905400
               10  MR-A-ADDR-FLAG             PIC  X(01).               01905500
               10  MR-A-ADDR-ATTRIB REDEFINES MR-A-ADDR-FLAG            01905600
                                              PIC  X(01).               01905700
               10  MR-A-ADDR-COLOR            PIC  X(01).               01905800
               10  MR-A-ADDR-HILITE           PIC  X(01).               01905900
               10  MR-A-ADDR                  PIC  X(20).               01906000
      *                                                                 01906100
               10  MR-A-CITY-LITERAL-LEN   PIC S9(04) COMP.             01906200
               10  MR-A-CITY-LITERAL-FLAG  PIC  X(01).                  01906300
               10  MR-A-CITY-LITERAL-ATTRIB REDEFINES                   01906400
                   MR-A-CITY-LITERAL-FLAG     PIC  X(01).               01906500
               10  MR-A-CITY-LITERAL-COLOR    PIC  X(01).               01906600
               10  MR-A-CITY-LITERAL-HILITE   PIC  X(01).               01906700
               10  MR-A-CITY-LITERAL          PIC  X(13).               01906800
      *                                                                 01906900
               10  MR-A-CITY-LEN              PIC S9(04) COMP.          01907000
               10  MR-A-CITY-FLAG             PIC  X(01).               01907100
               10  MR-A-CITY-ATTRIB REDEFINES MR-A-CITY-FLAG            01907200
                                              PIC  X(01).               01907300
               10  MR-A-CITY-COLOR            PIC  X(01).               01907400
               10  MR-A-CITY-HILITE           PIC  X(01).               01907500
               10  MR-A-CITY                  PIC  X(20).               01907600
      *                                                                 01907700
               10  MR-A-STATE-LITERAL-LEN  PIC S9(04) COMP.             01907800
               10  MR-A-STATE-LITERAL-FLAG PIC  X(01).                  01907900
               10  MR-A-STATE-LITERAL-ATTRIB REDEFINES                  01908000
                   MR-A-STATE-LITERAL-FLAG    PIC  X(01).               01908100
               10  MR-A-STATE-LITERAL-COLOR   PIC  X(01).               01908200
               10  MR-A-STATE-LITERAL-HILITE  PIC  X(01).               01908300
               10  MR-A-STATE-LITERAL         PIC  X(13).               01908400
      *                                                                 01908500
               10  MR-A-STATE-ZIP-LEN         PIC S9(04) COMP.          01908600
               10  MR-A-STATE-ZIP-FLAG        PIC  X(01).               01908700
               10  MR-A-STATE-ZIP-ATTRIB REDEFINES MR-A-STATE-ZIP-FLAG  01908800
                                              PIC  X(01).               01908900
               10  MR-A-STATE-ZIP-COLOR       PIC  X(01).               01909000
               10  MR-A-STATE-ZIP-HILITE      PIC  X(01).               01909100
               10  MR-A-STATE-ZIP             PIC  X(13).               01909200
      *                                                                 01909300
               10  MR-A-FROM-NBR-LEN       PIC S9(04) COMP.             01909400
               10  MR-A-FROM-NBR-FLAG      PIC  X(01).                  01909500
               10  MR-A-FROM-NBR-ATTRIB REDEFINES MR-A-FROM-NBR-FLAG    01909600
                                              PIC  X(01).               01909700
               10  MR-A-FROM-NBR-COLOR        PIC  X(01).               01909800
               10  MR-A-FROM-NBR-HILITE       PIC  X(01).               01909900
100404*        10  MR-A-FROM-NBR              PIC  X(03).               01910000
100404         10  MR-A-FROM-NBR              PIC  X(04).               01910100
      *                                                                 01910200
               10  MR-A-FROM-NAME-LEN      PIC S9(04) COMP.             01910300
               10  MR-A-FROM-NAME-FLAG     PIC  X(01).                  01910400
               10  MR-A-FROM-NAME-ATTRIB REDEFINES MR-A-FROM-NAME-FLAG  01910500
                                              PIC  X(01).               01910600
               10  MR-A-FROM-NAME-COLOR       PIC  X(01).               01910700
               10  MR-A-FROM-NAME-HILITE      PIC  X(01).               01910800
               10  MR-A-FROM-NAME             PIC  X(10).               01910900
      *                                                                 01911000
               10  MR-A-FROM-SCAN-LEN      PIC S9(04) COMP.             01911100
               10  MR-A-FROM-SCAN-FLAG     PIC  X(01).                  01911200
               10  MR-A-FROM-SCAN-ATTRIB REDEFINES MR-A-FROM-SCAN-FLAG  01911300
                                              PIC  X(01).               01911400
               10  MR-A-FROM-SCAN-COLOR       PIC  X(01).               01911500
               10  MR-A-FROM-SCAN-HILITE      PIC  X(01).               01911600
               10  MR-A-FROM-SCAN             PIC  X(01).               01911700
      *                                                                 01911800
               10  MR-A-COMP-BY-LEN        PIC S9(04) COMP.             01911900
               10  MR-A-COMP-BY-FLAG       PIC  X(01).                  01912000
               10  MR-A-COMP-BY-ATTRIB REDEFINES MR-A-COMP-BY-FLAG      01912100
                                              PIC  X(01).               01912200
               10  MR-A-COMP-BY-COLOR         PIC  X(01).               01912300
               10  MR-A-COMP-BY-HILITE        PIC  X(01).               01912400
               10  MR-A-COMP-BY               PIC  X(22).               01912500
      *                                                                 01912600
               10  MR-A-COMP-DATE-LEN      PIC S9(04) COMP.             01912700
               10  MR-A-COMP-DATE-FLAG     PIC  X(01).                  01912800
               10  MR-A-COMP-DATE-ATTRIB REDEFINES MR-A-COMP-DATE-FLAG  01912900
                                              PIC  X(01).               01913000
               10  MR-A-COMP-DATE-COLOR       PIC  X(01).               01913100
               10  MR-A-COMP-DATE-HILITE      PIC  X(01).               01913200
               10  MR-A-COMP-DATE             PIC  X(10).               01913300
      *                                                                 01913400
               10  MR-A-COMP-QTY-LEN       PIC S9(04) COMP.             01913500
               10  MR-A-COMP-QTY-FLAG      PIC  X(01).                  01913600
               10  MR-A-COMP-QTY-ATTRIB REDEFINES MR-A-COMP-QTY-FLAG    01913700
                                              PIC  X(01).               01913800
               10  MR-A-COMP-QTY-COLOR        PIC  X(01).               01913900
               10  MR-A-COMP-QTY-HILITE       PIC  X(01).               01914000
               10  MR-A-COMP-QTY              PIC  ZZZZ9.               01914100
      *                                                                 01914200
               10  MR-A-COMP-LITERAL-LEN      PIC S9(04) COMP.          01914300
               10  MR-A-COMP-LITERAL-FLAG     PIC  X(01).               01914400
               10  MR-A-COMP-LITERAL-ATTRIB REDEFINES                   01914500
                   MR-A-COMP-LITERAL-FLAG     PIC  X(01).               01914600
               10  MR-A-COMP-LITERAL-COLOR    PIC  X(01).               01914700
               10  MR-A-COMP-LITERAL-HILITE   PIC  X(01).               01914800
               10  MR-A-COMP-LITERAL          PIC  X(16).               01914900
      *                                                                 01915000
               10  MR-A-COMP-RETAIL-LEN       PIC S9(04) COMP.          01915100
               10  MR-A-COMP-RETAIL-FLAG      PIC  X(01).               01915200
               10  MR-A-COMP-RETAIL-ATTRIB REDEFINES                    01915300
                   MR-A-COMP-RETAIL-FLAG                                01915400
                                              PIC  X(01).               01915500
               10  MR-A-COMP-RETAIL-COLOR     PIC  X(01).               01915600
               10  MR-A-COMP-RETAIL-HILITE    PIC  X(01).               01915700
               10  MR-A-COMP-RETAIL-X.                                  01915800
SR3403             15  MR-A-COMP-RETAIL       PIC  Z(09).99.            01916000
      *                                                                 01916100
           05  MR-B-RECEIVED.                                           01916200
               10  FILLER                     PIC  X(12).               01916300
      *                                                                 01916400
               10  MR-B-TO-NBR-LEN         PIC S9(04) COMP.             01916500
               10  MR-B-TO-NBR-FLAG        PIC  X(01).                  01916600
               10  MR-B-TO-NBR-ATTRIB REDEFINES MR-B-TO-NBR-FLAG        01916700
                                              PIC  X(01).               01916800
               10  MR-B-TO-NBR-COLOR          PIC  X(01).               01916900
               10  MR-B-TO-NBR-HILITE         PIC  X(01).               01917000
100404*        10  MR-B-TO-NBR                PIC  X(03).               01917100
100404         10  MR-B-TO-NBR                PIC  X(04).               01917200
      *                                                                 01917300
               10  MR-B-TO-NAME-LEN        PIC S9(04) COMP.             01917400
               10  MR-B-TO-NAME-FLAG       PIC  X(01).                  01917500
               10  MR-B-TO-NAME-ATTRIB REDEFINES MR-B-TO-NAME-FLAG      01917600
                                              PIC  X(01).               01917700
               10  MR-B-TO-NAME-COLOR         PIC  X(01).               01917800
               10  MR-B-TO-NAME-HILITE        PIC  X(01).               01917900
               10  MR-B-TO-NAME               PIC  X(10).               01918000
      *                                                                 01918100
               10  MR-B-TO-SCAN-LEN        PIC S9(04) COMP.             01918200
               10  MR-B-TO-SCAN-FLAG       PIC  X(01).                  01918300
               10  MR-B-TO-SCAN-ATTRIB REDEFINES MR-B-TO-SCAN-FLAG      01918400
                                              PIC  X(01).               01918500
               10  MR-B-TO-SCAN-COLOR         PIC  X(01).               01918600
               10  MR-B-TO-SCAN-HILITE        PIC  X(01).               01918700
               10  MR-B-TO-SCAN               PIC  X(01).               01918800
      *                                                                 01918900
               10  MR-B-RECV-BY-LEN        PIC S9(04) COMP.             01919000
               10  MR-B-RECV-BY-FLAG       PIC  X(01).                  01919100
               10  MR-B-RECV-BY-ATTRIB REDEFINES MR-B-RECV-BY-FLAG      01919200
                                              PIC  X(01).               01919300
               10  MR-B-RECV-BY-COLOR         PIC  X(01).               01919400
               10  MR-B-RECV-BY-HILITE        PIC  X(01).               01919500
               10  MR-B-RECV-BY               PIC  X(22).               01919600
      *                                                                 01919700
               10  MR-B-RECV-DATE-LEN      PIC S9(04) COMP.             01919800
               10  MR-B-RECV-DATE-FLAG     PIC  X(01).                  01919900
               10  MR-B-RECV-DATE-ATTRIB REDEFINES MR-B-RECV-DATE-FLAG  01920000
                                              PIC  X(01).               01920100
               10  MR-B-RECV-DATE-COLOR       PIC  X(01).               01920200
               10  MR-B-RECV-DATE-HILITE      PIC  X(01).               01920300
               10  MR-B-RECV-DATE             PIC  X(10).               01920400
      *                                                                 01920500
               10  MR-B-RECV-QTY-LEN       PIC S9(04) COMP.             01920600
               10  MR-B-RECV-QTY-FLAG      PIC  X(01).                  01920700
               10  MR-B-RECV-QTY-ATTRIB REDEFINES MR-B-RECV-QTY-FLAG    01920800
                                              PIC  X(01).               01920900
               10  MR-B-RECV-QTY-COLOR        PIC  X(01).               01921000
               10  MR-B-RECV-QTY-HILITE       PIC  X(01).               01921100
               10  MR-B-RECV-QTY-X.                                     01921200
                   15  MR-B-RECV-QTY          PIC  ZZZZ9.               01921300
      *                                                                 01921400
               10  MR-B-RECV-LITERAL-LEN      PIC S9(04) COMP.          01921500
               10  MR-B-RECV-LITERAL-FLAG     PIC  X(01).               01921600
               10  MR-B-RECV-LITERAL-ATTRIB REDEFINES                   01921700
                   MR-B-RECV-LITERAL-FLAG     PIC  X(01).               01921800
               10  MR-B-RECV-LITERAL-COLOR    PIC  X(01).               01921900
               10  MR-B-RECV-LITERAL-HILITE   PIC  X(01).               01922000
               10  MR-B-RECV-LITERAL          PIC  X(16).               01922100
      *                                                                 01922200
               10  MR-B-RECV-RETAIL-LEN       PIC S9(04) COMP.          01922300
               10  MR-B-RECV-RETAIL-FLAG      PIC  X(01).               01922400
               10  MR-B-RECV-RETAIL-ATTRIB REDEFINES                    01922500
                   MR-B-RECV-RETAIL-FLAG      PIC  X(01).               01922600
               10  MR-B-RECV-RETAIL-COLOR     PIC  X(01).               01922700
               10  MR-B-RECV-RETAIL-HILITE    PIC  X(01).               01922800
               10  MR-B-RECV-RETAIL-X.                                  01922900
SR3403             15  MR-B-RECV-RETAIL       PIC  Z(9).99.             01923100
      *                                                                 01923200
      *                                                                 01923300
           05  MR-C-COMMENTS.                                           01923400
               10  FILLER                     PIC  X(12).               01923500
      *                                                                 01924000
               10  MR-C-USERID-L     PIC S9(04) COMP.                   01925000
               10  MR-C-USERID-A     PIC  X(01).                        01926000
               10  MR-C-USERID-C     PIC  X(01).                        01927000
               10  MR-C-USERID-H     PIC  X(01).                        01928000
               10  MR-C-USERID       PIC  X(08).                        01929000
                                                                        01930000
               10  MR-C-COMMENTS-AREA OCCURS 4 TIMES.                   01940000
                   15  MR-C-COMMENT-L PIC S9(04) COMP.                  01950000
                   15  MR-C-COMMENT-A PIC X(01).                        01960000
                   15  MR-C-COMMENT-C PIC X(01).                        01970000
                   15  MR-C-COMMENT-H PIC X(01).                        01980000
                   15  MR-C-COMMENT  PIC  X(79).                        01990000
      *                                                                 05230000
       01  MD-MAP-DATA-AREA                      PIC X(3000).           05240000
      *                                                                 05250000
      *                                                                 05250100
       EJECT                                                            05250200
      *----------------------------------------------------------------*05250300
      *    ATTRIBUTE SETTINGS COPYBOOK.                                *05250400
      *----------------------------------------------------------------*05250500
                                                                        05250600
           COPY DPWS015.                                                05250700
                                                                        05250800
      *----------------------------------------------------------------*05250900
      *    FUNCTION KEYS COPYBOOK                                      *05251000
      *----------------------------------------------------------------*05251100
                                                                        05251200
           COPY DPWS016.                                                05251300
                                                                        05251400
       EJECT                                                            05251500
      **--------------------------------------------------------------**05251600
      ** THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT    **05251700
      ** SUB-ROUTINE (DPKUT100).                                      **05251800
      **--------------------------------------------------------------**05251900
           COPY DPWS010I.                                               05252000
       EJECT                                                            05252100
      **--------------------------------------------------------------**05252200
      ** THE CALLING PARAMETER LIST (DPWS030) FOR THE CICS ARCHITECTURE*05252300
      ** APPLICATION PROGRAMMING INTERFACE MODULE.                    **05252401
      **--------------------------------------------------------------**05252500
           COPY DPWS030.                                                05252600
CICS       COPY DPWS930.                                                05252701
       EJECT                                                            05252801
      **--------------------------------------------------------------**05252901
      *    STANDARD COMMAREA.                                           05253001
      **--------------------------------------------------------------**05253101
                                                                        05253201
           COPY DPWS020.                                                05253301
           05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                05253401
                                                                        05253501
      ***************************************************************** 05253601
      *    INTER-APPLICATION COMMAREA.                                  05253701
      ***************************************************************** 05253801
                                                                        05253901
               10  INTER-APPL-COMM-AREA PIC X(200).                     05254001
           COPY TFWS001.                                                05254101
      ***************************************************************** 05254201
      *    SPECIFIC COMMMAREA FOR TFKCS430.                             05254301
      ***************************************************************** 05254401
               10  ASC-SPECIFIC-COMMAREA.                               05254501
                   15  ASC-INT-APPL-FORMAT-IND   PIC  X(01).            05254601
                   15  ASC-PRINT-REQUEST-SW      PIC X(01).             05254701
                       88  ASC-PRINT-DOC-REQUEST        VALUE 'D'.      05254801
                       88  ASC-NO-PRINT-REQUEST         VALUE 'N'.      05254901
                   15  ASC-DISCREPANCY-SW        PIC X(01).             05255001
                       88  ASC-DISCREPANCY-EXISTS       VALUE 'Y'.      05255101
                       88  ASC-NO-DISCREPANCY-EXISTS    VALUE 'N'.      05255201
                   15  ASC-REDIRECT-SW           PIC X(01).             05255301
                       88  ASC-XFER-WAS-REDIRECTED      VALUE 'Y'.      05255401
                       88  ASC-XFER-WAS-NOT-REDIRECTED  VALUE 'N'.      05255501
                   15  ASC-INTER-APPL-CRITERIA.                         05255601
                       20  ASC-CRIT-INT-APPL-FORMAT-IND                 05255701
                                                 PIC X.                 05255801
100404*                20  ASC-CRIT-XFER-NBR-9   PIC 9(09).             05255901
100404                 20  ASC-CRIT-XFER-NBR-9   PIC 9(10).             05256001
                       20  ASC-CRIT-XFER-NBR                            05256101
                              REDEFINES ASC-CRIT-XFER-NBR-9.            05256201
100404*                    25  ASC-CRIT-XFER-FROM-STORE   PIC 9(03).    05256301
100404                     25  ASC-CRIT-XFER-FROM-STORE   PIC 9(04).    05256401
                           25  ASC-CRIT-XFER-SEQ-NBR      PIC 9(06).    05256501
                       20  ASC-CRIT-XFER-TYPE    PIC X(02).             05256800
                       20  ASC-CRIT-XFER-STAT    PIC X(02).             05256900
                       20  ASC-CRIT-XFER-FROM    PIC 9(03).             05257000
                       20  ASC-CRIT-XFER-TO      PIC 9(03).             05257100
                       20  ASC-CRIT-COMP-FROM-DATE                      05257200
                                                 PIC X(08).             05257300
                       20  ASC-CRIT-COMP-TO-DATE                        05257400
                                                 PIC X(08).             05257500
                       20  ASC-CRIT-RECV-FROM-DATE                      05257600
                                                 PIC X(08).             05257700
                       20  ASC-CRIT-RECV-TO-DATE                        05257800
                                                 PIC X(08).             05257900
                       20  ASC-CRIT-DEPT         PIC X(03).             05258000
                       20  ASC-CRIT-CLASS        PIC X(03).             05258100
                       20  ASC-CRIT-UPC          PIC X(13).             05258200
                       20  ASC-CRIT-CALLBACK-NBR PIC 9(04).             05258300
                       20  ASC-CRIT-APPROVAL-NBR PIC 9(09).             05258400
                       20  ASC-CRIT-COMP-BY-INIT PIC X.                 05258500
                       20  ASC-CRIT-COMP-BY-NM   PIC X(20).             05258600
                       20  ASC-CRIT-RECV-BY-INIT PIC X.                 05258700
                       20  ASC-CRIT-RECV-BY-NM   PIC X(20).             05258800
                       20  ASC-CRIT-DISPLAY-TOT  PIC X.                 05258900
                       20  ASC-CRIT-CRIT-SORT-ORDER.                    05259000
                           25 ASC-CRIT-TYPE-SORT-NR       PIC 9(01).    05259100
                           25 ASC-CRIT-STATUS-SORT-NR     PIC 9(01).    05259200
                           25 ASC-CRIT-FROM-STR-SORT-NR   PIC 9(01).    05259300
                           25 ASC-CRIT-TO-STR-SORT-NR     PIC 9(01).    05259400
                           25 ASC-CRIT-COMP-DTE-SORT-NR   PIC 9(01).    05259500
                           25 ASC-CRIT-RECV-DTE-SORT-NR   PIC 9(01).    05260000
                           25 ASC-CRIT-CALLBCK-NR-SORT-NR               05270000
                                                          PIC 9(01).    05280000
                           25 ASC-CRIT-APPRV-NR-SORT-NR PIC 9(01).      05290000
                           25                             PIC X(03).    05290100
                       20  ASC-CRIT-ORIG-APPL-FORMAT-IND                05290200
                                                 PIC X.                 05290300
                   15  ASC-XFER-STATUS           PIC X(02).             05290400
                   15  ASC-XFER-STATUS-DESC      PIC X(20).             05290500
                   15  ASC-XFER-TYPE             PIC 9(02).             05290600
                   15  ASC-XFER-DKEY-ID          PIC S9(09) COMP.       05290700
                   15  ASC-XFER-DESC             PIC X(19).             05290800
                   15  ASC-ENTRY-METHOD          PIC X(02).             05290900
                       88  ASC-ENTRY-SCANNED          VALUE '01'.       05291000
                   15  ASC-RECV-METHOD           PIC X(02).             05291100
                       88  ASC-RECV-SCANNED           VALUE '01'.       05291200
                   15  ASC-CALLBACK-NBR          PIC 9(04).             05291300
                   15  ASC-APPROVAL-NBR          PIC 9(09).             05291400
                   15  ASC-CONTAINER-TYPE        PIC X(02).             05291500
                   15  ASC-CONTAINER-DESC        PIC X(20).             05291600
                   15  ASC-LARGE-TOTE-SEAL1      PIC X(07).             05291700
                   15  ASC-LARGE-TOTE-SEAL2      PIC X(07).             05291800
                   15  ASC-SMALL-TOTE-SEAL       PIC X(07).             05291900
                   15  ASC-TRAILER-NBR           PIC X(08).             05292000
                   15  ASC-TRAILER-SEAL          PIC X(07).             05292100
                   15  ASC-CUST-NAME             PIC X(20).             05292200
                   15  ASC-CUST-ADDRESS          PIC X(20).             05292300
                   15  ASC-CUST-PHONE            PIC 9(10).             05292400
                   15  ASC-CUST-CITY             PIC X(20).             05292500
                   15  ASC-CUST-STATE            PIC X(02).             05292600
                   15  ASC-CUST-ZIP              PIC 9(05).             05292700
                   15  ASC-CUST-ZIP-EXT          PIC 9(04).             05292800
100404*            15  ASC-FROM-STORE-NBR        PIC 9(03).             05292900
100404             15  ASC-FROM-STORE-NBR        PIC 9(04).             05293000
                   15  ASC-FROM-STORE-NAME       PIC X(10).             05293100
                   15  ASC-XFER-SEQ-NBR          PIC 9(06).             05293200
                   15  ASC-ATTENTION.                                   05293300
                       20  ASC-ATTENTION-INIT    PIC X(01).             05293400
                       20                        PIC X(01).             05293500
                       20  ASC-ATTENTION-NAME    PIC X(20).             05293600
                   15  ASC-REQUESTOR.                                   05293700
                       20  ASC-REQUESTOR-INIT    PIC X(01).             05293800
                       20                        PIC X(01).             05293900
                       20  ASC-REQUESTOR-NAME    PIC X(20).             05294000
                   15  ASC-COMPLETED-BY.                                05294100
                       20  ASC-COMPLETED-INIT    PIC X(01).             05294200
                       20                        PIC X(01).             05294300
                       20  ASC-COMPLETED-NAME    PIC X(20).             05294400
                   15  ASC-COMPLETION-DATE.                             05294500
                       20  ASC-COMP-YEAR         PIC 9(04).             05294600
                       20                        PIC X(01).             05294700
                       20  ASC-COMP-MONTH        PIC 9(02).             05294800
                       20                        PIC X(01).             05294900
                       20  ASC-COMP-DAY          PIC 9(02).             05295000
                   15  ASC-COMPLETED-QTY         PIC 9(05).             05295100
SR3403             15  ASC-COMPLETED-RETAIL      PIC 9(09)V99.          05295300
100404*            15  ASC-TO-STORE-NBR          PIC 9(03).             05295400
100404             15  ASC-TO-STORE-NBR          PIC 9(04).             05295500
                   15  ASC-TO-STORE-NAME         PIC X(10).             05295600
                   15  ASC-RECEIVED-BY.                                 05295700
                       20  ASC-RECEIVED-INIT     PIC X(01).             05295800
                       20                        PIC X(01).             05295900
                       20  ASC-RECEIVED-NAME     PIC X(20).             05296000
                   15  ASC-RECEIVED-DATE.                               05296100
                       20  ASC-RECV-YEAR         PIC X(04).             05296200
                       20  FILLER                PIC X(01).             05296300
                       20  ASC-RECV-MONTH        PIC X(02).             05296400
                       20  FILLER                PIC X(01).             05296500
                       20  ASC-RECV-DAY          PIC X(02).             05296600
                   15  ASC-RECEIVED-QTY          PIC 9(05).             05296700
SR3403             15  ASC-RECEIVED-RETAIL       PIC 9(09)V99.          05296900
                   15  ASC-SEL-SUB               PIC S9(04)  COMP.      05297000
                   15  ASC-SEL-ITEM              PIC S9(04)  COMP.      05297100
                   15  ASC-NUMBER-OF-TS-ITEMS    PIC S9(05)  COMP-3.    05297200
                   15  ASC-USE-SELECTION-QUEUE-IND         PIC  X(01).  05297300
                       88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 05297400
                   15  ASC-SEL-QUEUE-NAME.                              05298000
                       20  ASC-SEL-TERM-ID                 PIC  X(04).  05299000
                       20  ASC-SEL-TASK-NUMBER             PIC S9(05)   05300000
                                                                COMP-3. 05310000
                       20  ASC-SEL-SEQ                     PIC  9(01).  05320000
                   15  ASC-USERID                 PIC X(08).            05330000
                   15  ASC-COMMENT-ARRAY.                               05340000
                       20  ASC-COMMENT OCCURS 4 TIMES  PIC X(79).       05350000
                                                                        05350100
           EJECT                                                        05350200
      *---------------------------------------------------------------* 05350300
      *   TFWS002 - IS THE INPUT TEMP STORAGE LAYOUT.                 * 05350400
      *---------------------------------------------------------------* 05350500
      *                                                                 05350600
           COPY TFWS002.                                                05350700
      *----------------------------------------------------------------*05350800
      *    ABEND PROCESSING COPYBOOK.                                  *05350900
      *----------------------------------------------------------------*05351000
                                                                        05351100
           COPY DPWS013.                                                05351200
                                                                        05351300
           EJECT                                                        05351400
                                                                        05351500
      *    DB2 AREA FOR TTFMSTR (TRANSFER TABLE)                        05351600
                                                                        05351700
           EXEC SQL                                                     05351800
                INCLUDE TTFMSTR                                         05351900
           END-EXEC.                                                    05352000
                                                                        05352100
      *    DB2 AREA FOR TTFITEM  (TRANSFER ITEM TABLE)                  05352200
                                                                        05352300
           EXEC SQL                                                     05352400
                INCLUDE TTFITEM                                         05352500
           END-EXEC.                                                    05352600
                                                                        05352700
      *    DB2 AREA FOR TTFITRC  (TRANSFER ITEM RECEIPT TABLE)          05352800
                                                                        05352900
           EXEC SQL                                                     05353000
                INCLUDE TTFITRC                                         05353100
           END-EXEC.                                                    05353200
                                                                        05353300
      *    DB2 AREA FOR TTFRCPT (TRANSFER RECEIPT TABLE)                05353400
                                                                        05353500
           EXEC SQL                                                     05353600
                INCLUDE TTFRCPT                                         05353700
           END-EXEC.                                                    05353800
                                                                        05353900
      *    DB2 AREA FOR TTFTYCD  (TRANSFER TYPE TABLE)                  05354000
                                                                        05354100
           EXEC SQL                                                     05354200
                INCLUDE TTFTYCD                                         05354300
           END-EXEC.                                                    05354400
                                                                        05354500
      *    DB2 AREA FOR TTFSTAT  (TRANSFER STATUS TABLE)                05354600
                                                                        05354700
           EXEC SQL                                                     05354800
                INCLUDE TTFSTAT                                         05354900
           END-EXEC.                                                    05355000
                                                                        05355100
      *    DB2 AREA FOR TTFDSCP  (TRANSFER DISCREPANCY TABLE)           05355200
                                                                        05355300
           EXEC SQL                                                     05355400
                INCLUDE TTFDSCP                                         05355500
           END-EXEC.                                                    05355600
                                                                        05355700
      *    DB2 AREA FOR TTFSTCD  (TRANSFER STATUS CODE TABLE)           05355800
                                                                        05355900
           EXEC SQL                                                     05356000
                INCLUDE TTFSTCD                                         05356100
           END-EXEC.                                                    05356200
                                                                        05356300
      *    DB2 AREA FOR TTFCUST  (TRANSFER CUSTOMER TABLE)              05356400
                                                                        05356500
           EXEC SQL                                                     05356600
                INCLUDE TTFCUST                                         05356700
           END-EXEC.                                                    05356800
                                                                        05356900
      *    DB2 AREA FOR TTFSHCT  (CONTAINER CODE TABLE)                 05357000
                                                                        05357100
           EXEC SQL                                                     05357200
                INCLUDE TTFSHCT                                         05357300
           END-EXEC.                                                    05357400
                                                                        05357500
100404*    DB2 AREA FOR XST_LOC (STORE TABLE)                           05357600
                                                                        05357700
           EXEC SQL                                                     05357800
100404          INCLUDE XST00001                                        05357900
           END-EXEC.                                                    05358000
                                                                        05358100
      *    DB2 AREA FOR COMMUNICATIONS                                  05358200
                                                                        05358300
           EXEC SQL                                                     05358400
                INCLUDE SQLCA                                           05358500
           END-EXEC.                                                    05358600
                                                                        05358700
       EJECT                                                            05358800
       LINKAGE SECTION.                                                 05358900
                                                                        05359000
       01  DFHCOMMAREA.                                                 05359100
           05  FILLER                         OCCURS  1 TO 4072 TIMES   05359200
                                              DEPENDING ON EIBCALEN.    05359300
               10  FILLER                     PIC X.                    05359400
                                                                        05359500
                                                                        05359600
       PROCEDURE DIVISION.                                              05359700
      ***************************************************************** 05359800
      ** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** 05359900
      ** THE SETUP AND PERFORM OF PARAGRAPH 001-CALL-CICS-ARCH-API   ** 05360000
      ** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            ** 05360100
      **                                                             ** 05360200
      ** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  ** 05360300
      ** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       ** 05360400
      ***************************************************************** 05360500
       0000-MAIN-MODULE.                                                05360600
           INITIALIZE DP030-CICS-API-FIELDS.                            05360700
           MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          05360800
           SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       05360900
           MOVE +2                       TO DP030-NUMBER-OF-MAPS.       05361000
           MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     05361100
           PERFORM 0001-CALL-CICS-ARCH-API.                             05361200
      *                                                                 05361300
           MOVE 1                      TO PV-MAP-START-BYTE.            07840000
           MOVE LENGTH OF MR-A-COMMON  TO DP030-MAP-LENGTH (1).         07850000
           MOVE MD-MAP-DATA-AREA                                        07860000
                      (PV-MAP-START-BYTE:DP030-MAP-LENGTH (1))          07870000
                                       TO MR-A-COMMON.                  07880000
           ADD DP030-MAP-LENGTH (1)                                     07890000
                                       TO PV-MAP-START-BYTE.            07900000
           EVALUATE ASC-XFER-STATUS                                     07910000
               WHEN PC-VOIDED                                           07920000
                   MOVE LENGTH OF MR-C-COMMENTS                         07940000
                                       TO DP030-MAP-LENGTH (2)          07950000
                   MOVE MD-MAP-DATA-AREA                                07960000
                      (PV-MAP-START-BYTE:DP030-MAP-LENGTH (2))          07970000
                                       TO MR-C-COMMENTS                 07980000
                   ADD DP030-MAP-LENGTH (2)                             07990000
                                       TO PV-MAP-START-BYTE             08000000
               WHEN OTHER                                               08010000
                   MOVE LENGTH OF MR-B-RECEIVED                         08020000
                                       TO DP030-MAP-LENGTH (2)          08030000
                   MOVE MD-MAP-DATA-AREA                                08040000
                      (PV-MAP-START-BYTE:DP030-MAP-LENGTH (2))          08050000
                                       TO MR-B-RECEIVED                 08060000
                   ADD DP030-MAP-LENGTH (2)                             08070000
                                       TO PV-MAP-START-BYTE             08080000
           END-EVALUATE.                                                08330000
           PERFORM 1000-CONTROL-PROCESSING                              08330100
      *                                                                 08330200
           MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     08330300
           PERFORM 0001-CALL-CICS-ARCH-API.                             08330400
                                                                        08330500
       0001-CALL-CICS-ARCH-API.                                         08330600
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      08330701
                                          DFHCOMMAREA                   08330801
                                          DP030-CICS-API-FIELDS         08330901
                                          DP020-STANDARD-COMMAREA       08331001
                                          MD-MAP-DATA-AREA.             08820001
      *                                                                 08820100
           IF  DP030-RC-CALL-SUCCESSFUL                                 08820200
               CONTINUE                                                 08820300
           ELSE                                                         08820400
               SET DP013-NO-ROLLBACK                                    08820500
                   DP013-XCTL-DISPLAY-RESTART                           08820600
                   DP013-CICS-ABEND      TO TRUE                        08820700
               MOVE 'BEFORE 0000-MAIN-MODULE'                           08820800
                                         TO DP013-PARAGRAPH             08820900
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O08821001
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      08821101
               MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      08821400
               PERFORM DP013-0000-PROCESS-ABEND                         08821500
           END-IF.                                                      08821600
       EJECT                                                            08821700
      *----------------------------------------------------------------*08821800
      *    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *08821900
      *    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *08822000
      *----------------------------------------------------------------*08822100
                                                                        08822200
       1000-CONTROL-PROCESSING.                                         08822300
                                                                        08822400
           EVALUATE TRUE                                                08822500
               WHEN DP020-NEXT-ACT-INITIAL                              08822600
                    SET PS-TRANSFER-NOT-FOUND         TO TRUE           08822700
                    PERFORM 1100-FIND-OBJECT-KEYS                       08822800
                    PERFORM 4000-BUILD-INITIAL-PANEL                    08822900
                    IF PS-TRANSFER-NOT-FOUND                            08823000
                        SET DP020-NEXT-ACT-APPL-ERROR TO TRUE           08823100
                        MOVE PC-TSYMSG-00148                            08823200
                                         TO DP020-MSG-NUMBER            08823300
                        SET DP020-MSG-WARNING TO TRUE                   08823400
                    END-IF                                              08823500
                                                                        08823600
               WHEN DP020-NEXT-ACT-READ-MAP                             08823700
                   PERFORM 2000-PROCESS-PANEL                           08823800
                                                                        08823900
               WHEN DP020-NEXT-ACT-RETURN                               08824000
                   IF ASC-PRINT-DOC-REQUEST     AND                     08824100
                         TF001-PRINT-DOC                                08824200
                       MOVE PC-TSYMSG-01400        TO DP020-MSG-NUMBER  08825000
                       SET DP020-MSG-INFORMATIONAL TO TRUE              08826000
                   END-IF                                               08826100
                   SET ASC-NO-PRINT-REQUEST        TO TRUE              08826200
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08826300
                                                                        08826400
               WHEN OTHER                                               08826500
                   SET DP013-LOGIC-ABEND TO TRUE                        08826600
                   SET DP013-NO-ROLLBACK TO TRUE                        08826700
                   MOVE '1000-CONTROL-PROCESSING'                       08826800
                                         TO DP013-PARAGRAPH             08826900
                   MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   08827000
                                         TO DP013-MESSAGE-TEXT(1)       08827100
                   MOVE DP020-NEXT-APPL-ACTIVITY                        08827200
                                         TO DP013-MESSAGE-TEXT(2)       08827300
                   PERFORM DP013-0000-PROCESS-ABEND                     08827400
           END-EVALUATE.                                                08827500
      ******************************************************************08827600
      ** DETERMINE THE TRANSFER TO BE DISPLAYED BASED ON THE          **08827700
      ** INTER-APPLICATION AREA.                                      **08827800
      ******************************************************************08827900
       1100-FIND-OBJECT-KEYS.                                           08828000
           MOVE SPACES                TO ASC-SPECIFIC-COMMAREA.         08829000
           EVALUATE DP020-INT-APPL-FORMAT-IND                           08830000
               WHEN PC-INTER-APPL-LIST                                  08840000
                   SET ASC-USE-SELECTION-QUEUE TO TRUE                  08850000
                   IF TF001-XFER-NBR > ZERO                             08860000
                       MOVE TF001-INTER-APPL-COMMAREA                   08870000
                                         TO ASC-INTER-APPL-CRITERIA     08880000
                   END-IF                                               08890000
                   MOVE TF001-NUMBER-OF-TS-ITEMS                        08900000
                                     TO ASC-NUMBER-OF-TS-ITEMS          08910000
                   MOVE TF001-SEL-QUEUE-NAME                            08920000
                                     TO ASC-SEL-QUEUE-NAME              08930000
                   PERFORM 1120-PREPARE-LIST-ENTRY                      08940000
               WHEN PC-INTER-APPL-CRIT-SPEC                             08950000
               WHEN PC-INTER-APPL-ITEM                                  08960000
               WHEN PC-INTER-APPL-DSCR                                  08970000
                   IF TF001-XFER-NBR > ZERO                             08980000
                       MOVE TF001-INTER-APPL-COMMAREA                   08990000
                                         TO ASC-INTER-APPL-CRITERIA     09000000
                       MOVE ASC-CRIT-XFER-FROM-STORE TO DK-FROM-STORE   09010000
                                                    ASC-FROM-STORE-NBR  09020000
                       MOVE ASC-CRIT-XFER-SEQ-NBR    TO DK-XFER-SEQ-NBR 09030000
                                                    ASC-XFER-SEQ-NBR    09040000
                   ELSE                                                 09050000
                       MOVE PC-TSYMSG-00148                             09060000
                                         TO DP020-MSG-NUMBER            09070000
                       SET DP020-MSG-FATAL                              09080000
                           DP020-NEXT-ACT-APPL-ERROR                    09090000
                                         TO TRUE                        09100000
                   END-IF                                               09110000
               WHEN OTHER                                               09120000
                   MOVE PC-TSYMSG-00148                                 09130000
                                         TO DP020-MSG-NUMBER            09140000
                   SET DP020-MSG-FATAL                                  09150000
                           DP020-NEXT-ACT-APPL-ERROR                    09160000
                                         TO TRUE                        09170000
           END-EVALUATE.                                                09170100
      ******************************************************************09170200
      ** EDIT THE KEY ENTERED BY THE USER INTO THE KEY FIELD OF THE   **09170300
      ** COMMAND LINE.  A VALID MESSAGE NUMBER IS THE ONLY KEY        **09170400
      ** ACCEPTED.                                                    **09170500
      ******************************************************************09170600
      *1110-EDIT-NAV-KEY.                                               09170700
      *    IF  ASC-CRIT-XFER-NBR-9 > ZERO                               09170800
      *        MOVE DP020-NAV-KEY-DATA   TO DP010I-UNEDITED-FIELD       09170900
      *        MOVE LENGTH OF ASC-CRIT-XFER-NBR                         09171000
      *                                  TO DP010I-MAXIMUM-DIGITS       09171100
      *        MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     09171200
      *        SET DP010I-NEGATIVE-NOT-ALLOWED                          09171300
      *                                  TO TRUE                        09171400
      *        CALL 'DPKUT100' USING DP010I-NUMERIC-EDIT-AREA           09171500
      *        IF  DP010I-ERROR-DETECTED                                09171600
      *            SET DP020-MSG-FATAL   TO TRUE                        09171700
      *            -- INVALID DATA IN KEY FIELD ---                     09171800
      *            MOVE PC-TSYMSG-00302  TO DP020-MSG-NUMBER            09171900
      *            SET DP020-NEXT-ACT-APPL-ERROR                        09172000
      *                                  TO TRUE                        09172100
      *        ELSE                                                     09172200
      *            MOVE DP010I-NUMERIC-FIELD                            09172300
      *                                  TO ASC-CRIT-XFER-NBR-9         09172400
      *        END-IF                                                   09172500
      *    END-IF.                                                      09172600
      *----------------------------------------------------------------*09172700
      *    GET READY TO START AT THE FIRST ITEM ON THE LIST.           *09172800
      *----------------------------------------------------------------*09172900
                                                                        09173000
       1120-PREPARE-LIST-ENTRY.                                         09174000
                                                                        09175000
           MOVE TF002-MAX-ITEMS TO ASC-SEL-SUB.                         09176000
           MOVE ZERO            TO ASC-SEL-ITEM.                        09177000
           PERFORM 2160-GET-NEXT-TRANSFER.                              09177100
      *----------------------------------------------------------------*09177200
      * DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *09177300
      * ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *09177400
      * USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *09177500
      * OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *09177600
      * FUNCTION KEYS CAN GET THIS FAR.                                *09177700
      *----------------------------------------------------------------*09177800
       2000-PROCESS-PANEL.                                              09177900
                                                                        09178000
           EVALUATE TRUE                                                09178100
                                                                        09178200
               WHEN DP020-SRC-AID = DP016-ENTER                         09178300
               WHEN DP020-SRC-AID = DP016-CLEAR                         09178400
               WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     09178500
                   SET ASC-NO-PRINT-REQUEST TO TRUE                     09178600
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09178700
                                                                        09178800
               WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             09178900
                   IF  ASC-USE-SELECTION-QUEUE                          09179000
                       PERFORM 2160-GET-NEXT-TRANSFER                   09180000
                       IF PS-LIST-END                                   09190000
                           PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         09200000
                           SET PS-NO-LIST-END TO TRUE                   09210000
                       ELSE                                             09220000
                           PERFORM 4000-BUILD-INITIAL-PANEL             09230000
                       END-IF                                           09240000
                   ELSE                                                 09250000
                       MOVE PC-TSYMSG-00070                             09260000
                                        TO DP020-MSG-NUMBER             09270000
                       SET DP020-MSG-INFORMATIONAL TO TRUE              09280000
                   END-IF                                               09290000
                                                                        09300000
               WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             09310000
                   IF  ASC-USE-SELECTION-QUEUE                          09320000
                       PERFORM 2170-GET-PREV-TRANSFER                   09330000
                       IF PS-LIST-END                                   09340000
                           PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         09350000
                           SET PS-NO-LIST-END TO TRUE                   09360000
                       ELSE                                             09370000
                           PERFORM 4000-BUILD-INITIAL-PANEL             09380000
                       END-IF                                           09390000
                   ELSE                                                 09400000
                       MOVE PC-TSYMSG-00069                             09410000
                                        TO DP020-MSG-NUMBER             09420000
                       SET DP020-MSG-INFORMATIONAL TO TRUE              09430000
                   END-IF                                               09430100
                                                                        09430200
               WHEN OTHER                                               09430300
                   SET DP030-CONTINUE-GO                                09430400
                                         TO TRUE                        09430500
                   PERFORM 2100-CHECK-FUNCTION-KEY                      09430600
           END-EVALUATE.                                                09430700
      *----------------------------------------------------------------*09430800
      * ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED       *09430900
      * FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED   *09431000
      * FROM THE CICS ARCHITECTURE API.                                *09431100
      *----------------------------------------------------------------*09431200
                                                                        09431300
       2100-CHECK-FUNCTION-KEY.                                         09431400
           EVALUATE TRUE                                                09431500
                                                                        09431600
      *---  PRINT DOC  ---------------------------------------------*   09431700
               WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              09431800
                   IF ASC-XFER-STATUS = PC-VOIDED                       09431900
                       SET ASC-NO-PRINT-REQUEST                         09432000
                           DP030-OVERRIDE-GO                            09432100
                           DP020-MSG-WARNING      TO TRUE               09432200
                       MOVE PC-TSYMSG-01399       TO DP020-MSG-NUMBER   09432300
                   ELSE                                                 09432400
                       SET ASC-PRINT-DOC-REQUEST  TO TRUE               09432500
                       INITIALIZE TF001-INTER-APPL-COMMAREA             09432600
080204                 MOVE DP020-LOCATION-NBR                          09432700
080204                                    TO RFWS009-STORE-NBR          09432800
080204                 MOVE RFWS009-STORE-PRINTER-DEST                  09432900
080204                                    TO TF001-PRINTER-DEST         09433000
                       MOVE ASC-FROM-STORE-NBR                          09434000
                                          TO ASC-CRIT-XFER-FROM-STORE   09435000
                       MOVE ASC-XFER-SEQ-NBR                            09436000
                                          TO ASC-CRIT-XFER-SEQ-NBR      09437000
                       MOVE ASC-CRIT-XFER-NBR-9   TO TF001-XFER-NBR     09437100
                   END-IF                                               09437200
                                                                        09437300
      *---  DISCREPANCY  -------------------------------------------*   09437400
               WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              09437500
                   SET ASC-NO-PRINT-REQUEST TO TRUE                     09437600
                   EVALUATE ASC-XFER-STATUS                             09437700
                     WHEN PC-POSITIVE-RECEIPT                           09437800
                       IF ASC-XFER-TYPE = PC-NON-RETAIL                 09437900
                           SET DP030-OVERRIDE-GO TO TRUE                09438000
      *   DISCREPANCY SCREEN IS NOT AVAILABLE FOR NON-RETAIL            09438100
                           MOVE PC-TSYMSG-01572  TO DP020-MSG-NUMBER    09438200
                           SET DP020-MSG-WARNING TO TRUE                09438300
                       ELSE                                             09438400
                           IF ASC-DISCREPANCY-EXISTS                    09438500
                               SET DP030-CONTINUE-GO TO TRUE            09438600
                               INITIALIZE TF001-INTER-APPL-COMMAREA     09438700
                               MOVE ASC-FROM-STORE-NBR                  09438800
                                            TO ASC-CRIT-XFER-FROM-STORE 09438900
                               MOVE ASC-XFER-SEQ-NBR                    09439000
                                            TO ASC-CRIT-XFER-SEQ-NBR    09439100
                               MOVE ASC-INTER-APPL-CRITERIA             09439200
                                         TO TF001-INTER-APPL-COMMAREA   09439300
                               MOVE ASC-XFER-DKEY-ID                    09439400
                                         TO TF001-DKEY-ID               09439500
                           ELSE                                         09439600
                               SET DP030-OVERRIDE-GO TO TRUE            09439700
      *   TRANSFER HAS NO DISCREPANCIES                                 09439800
                               MOVE PC-TSYMSG-01414 TO DP020-MSG-NUMBER 09439900
                               SET DP020-MSG-WARNING TO TRUE            09440000
                           END-IF                                       09440100
                       END-IF                                           09440200
                                                                        09440300
                     WHEN PC-VOIDED                                     09440400
                       SET DP030-OVERRIDE-GO TO TRUE                    09440500
      *   INVALID REQUEST; TRANSFER IS IN VOIDED STATUS                 09440600
                       MOVE ASC-XFER-STATUS  TO DP020-MSG-TEXT          09440700
                       MOVE PC-TSYMSG-01581  TO DP020-MSG-NUMBER        09440800
                       SET DP020-MSG-WARNING TO TRUE                    09440900
                                                                        09441000
                     WHEN OTHER                                         09441100
                       SET DP030-OVERRIDE-GO TO TRUE                    09441200
      *   TRANSFER HAS NOT REACHED ITS DESTINATION                      09441300
                       MOVE ASC-XFER-STATUS  TO DP020-MSG-TEXT          09441400
                       MOVE PC-TSYMSG-01416  TO DP020-MSG-NUMBER        09441500
                       SET DP020-MSG-WARNING TO TRUE                    09441600
                   END-EVALUATE                                         09441700
                                                                        09441800
      *---  ITEM INQ  ----------------------------------------------*   09441900
               WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              09442000
                   SET ASC-NO-PRINT-REQUEST TO TRUE                     09442100
                   SET DP030-CONTINUE-GO TO TRUE                        09442200
                   INITIALIZE TF001-INTER-APPL-COMMAREA                 09442300
                   MOVE ASC-FROM-STORE-NBR  TO ASC-CRIT-XFER-FROM-STORE 09442400
                   MOVE ASC-XFER-SEQ-NBR  TO ASC-CRIT-XFER-SEQ-NBR      09442500
                   MOVE ASC-INTER-APPL-CRITERIA                         09442600
                                         TO TF001-INTER-APPL-COMMAREA   09442700
                   MOVE ASC-XFER-DKEY-ID  TO TF001-DKEY-ID              09442800
                                                                        09442900
      *---  ROUTING  -----------------------------------------------*   09443000
               WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              09443100
                   SET ASC-NO-PRINT-REQUEST TO TRUE                     09443200
                   IF ASC-XFER-WAS-REDIRECTED                           09443300
                       SET DP030-CONTINUE-GO TO TRUE                    09443400
                       INITIALIZE TF001-INTER-APPL-COMMAREA             09443500
                       MOVE ASC-INTER-APPL-CRITERIA                     09443600
                                         TO TF001-INTER-APPL-COMMAREA   09443700
                       MOVE ASC-XFER-DKEY-ID                            09443800
                                         TO TF001-DKEY-ID               09443900
                   ELSE                                                 09444000
                       SET DP030-OVERRIDE-GO TO TRUE                    09444100
                       MOVE PC-TSYMSG-01415  TO DP020-MSG-NUMBER        09444200
                       SET DP020-MSG-WARNING TO TRUE                    09444300
                   END-IF                                               09444400
                                                                        09444500
      *---  CRITERIA LIST  -----------------------------------------*   09444600
               WHEN DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)              09444700
                   SET ASC-NO-PRINT-REQUEST TO TRUE                     09444800
                   IF ASC-CRIT-ORIG-APPL-FORMAT-IND =                   09444900
                                       PC-INTER-APPL-CRIT-SPEC          09445000
                       MOVE PC-TSYMSG-00148                             09445100
                                         TO DP020-MSG-NUMBER            09445200
                       SET DP020-MSG-WARNING TO TRUE                    09445300
                       SET DP030-OVERRIDE-GO TO TRUE                    09445400
                   ELSE                                                 09445500
                       SET DP030-CONTINUE-GO TO TRUE                    09445600
                       INITIALIZE TF001-INTER-APPL-COMMAREA             09445700
                       MOVE ASC-INTER-APPL-CRITERIA                     09445800
                                         TO TF001-INTER-APPL-COMMAREA   09445900
                   END-IF                                               09446000
                                                                        09446100
               WHEN OTHER                                               09446200
                   SET DP013-NO-ROLLBACK                                09446300
                       DP013-XCTL-DISPLAY-RESTART                       09446400
                       DP013-CICS-ABEND  TO TRUE                        09446500
                   MOVE '2100-CHECK-FUNCTION-KEY'                       09446600
                                         TO DP013-PARAGRAPH             09446700
                   MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      09446800
                                         TO DP013-MESSAGE-TEXT (1)      09446900
                   PERFORM DP013-0000-PROCESS-ABEND                     09447000
           END-EVALUATE.                                                09447100
                                                                        09447200
       EJECT                                                            09447300
      *----------------------------------------------------------------*09447400
      *    GET THE NEXT TRANSFER NBR IF A LIST OF TRTANSFERS IS BEING  *09447500
      *    PROCESSED.                                                  *09447600
      *----------------------------------------------------------------*09447700
                                                                        09447800
       2160-GET-NEXT-TRANSFER.                                          09447900
                                                                        09448000
           ADD +1                       TO ASC-SEL-SUB.                 09449000
           IF  ASC-SEL-SUB > TF002-MAX-ITEMS                            09450000
               ADD +1                   TO ASC-SEL-ITEM                 09460000
               MOVE +1                  TO ASC-SEL-SUB                  09470000
           END-IF.                                                      09480000
           IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                09490000
               PERFORM 9100-READ-SEL-QUEUE                              09500000
               IF  TF002-ITEM (ASC-SEL-SUB) > ZERO                      09510000
                   MOVE TF002-TRANSFER-NBR (ASC-SEL-SUB)                09520000
                                        TO PV-XFER-NBR                  09530000
                   MOVE PV-XFER-FROM-STORE-NBR TO DK-FROM-STORE         09540000
                                                  ASC-FROM-STORE-NBR    09550000
                   MOVE PV-XFER-SEQ-NBR       TO DK-XFER-SEQ-NBR        09560000
                                                  ASC-XFER-SEQ-NBR      09570000
                   SET TF002-INQ (ASC-SEL-SUB) TO TRUE                  09580000
                   PERFORM 9200-REWRITE-SEL-QUEUE                       09590000
               ELSE                                                     09600000
                   SUBTRACT +1 FROM ASC-SEL-SUB                         09610000
                   MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER             09620000
                   SET DP020-MSG-INFORMATIONAL TO TRUE                  09630000
                   SET PS-LIST-END             TO TRUE                  09640000
               END-IF                                                   09650000
           ELSE                                                         09660000
               SUBTRACT +1 FROM ASC-SEL-ITEM                            09670000
               MOVE TF002-MAX-ITEMS     TO ASC-SEL-SUB                  09680000
               MOVE PC-TSYMSG-00070     TO DP020-MSG-NUMBER             09690000
               SET DP020-MSG-INFORMATIONAL TO TRUE                      09700000
               SET PS-LIST-END             TO TRUE                      09710000
           END-IF.                                                      09720000
      *----------------------------------------------------------------*09730000
      *    GET THE PREVIOUS TRANSFER IF A LIST OF TRANSFERS IS BEING   *09740000
      *    PROCESSED.                                                  *09750000
      *----------------------------------------------------------------*09760000
                                                                        09770000
       2170-GET-PREV-TRANSFER.                                          09780000
                                                                        09790000
           SUBTRACT +1 FROM ASC-SEL-SUB.                                09800000
           IF  ASC-SEL-SUB < +1                                         09810000
               SUBTRACT +1 FROM ASC-SEL-ITEM                            09820000
               MOVE TF002-MAX-ITEMS     TO ASC-SEL-SUB                  09830000
           END-IF.                                                      09840000
                                                                        09850000
           IF  ASC-SEL-ITEM > ZERO                                      09860000
               PERFORM 9100-READ-SEL-QUEUE                              09870000
               MOVE TF002-TRANSFER-NBR (ASC-SEL-SUB)                    09880000
                                        TO PV-XFER-NBR                  09890000
               MOVE PV-XFER-FROM-STORE-NBR TO DK-FROM-STORE             09900000
                                              ASC-FROM-STORE-NBR        09910000
               MOVE PV-XFER-SEQ-NBR       TO DK-XFER-SEQ-NBR            09920000
                                              ASC-XFER-SEQ-NBR          09930000
           ELSE                                                         09940000
               MOVE +1                  TO ASC-SEL-ITEM                 09950000
                                           ASC-SEL-SUB                  09960000
               MOVE PC-TSYMSG-00069     TO DP020-MSG-NUMBER             09970000
               SET DP020-MSG-INFORMATIONAL TO TRUE                      09980000
               SET PS-LIST-END             TO TRUE                      09990000
           END-IF.                                                      10000000
       EJECT                                                            10000100
      *                                                                 10000200
      *----------------------------------------------------------------*10000300
      *    READ THE TABLES FOR THE TRANSFER NUMBER TO BE DISPLAYED.    *10000400
      *----------------------------------------------------------------*10000500
                                                                        10000600
       4000-BUILD-INITIAL-PANEL.                                        10000700
           SET DP030-SET-CURSOR-TRAILER  TO TRUE                        10000800
           PERFORM 4100-GET-TRANSFER.                                   10000900
           IF PS-TRANSFER-FOUND                                         10001000
               PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     10001100
           END-IF.                                                      10001200
                                                                        10001300
      *----------------------------------------------------------------*10001400
      * SELECT DATA FROM THE TRANSFER TABLES                            10001500
      *----------------------------------------------------------------*10001600
       4100-GET-TRANSFER.                                               10001700
           PERFORM                                                      10001800
               WITH TEST AFTER                                          10001900
               VARYING PV-RETRY-COUNTER                                 10002000
               FROM 1 BY 1                                              10002100
               UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               10002200
                         OR (SQLCODE = ZERO)                            10002300
                         OR (SQLCODE = +100))                           10002400
      *                                                                 10002500
               EXEC SQL                                                 10002600
                   SELECT X.XFER_DKEY_ID                                10002700
                         ,X.ENTR_MTHD_TYP_CDE                           10002800
                         ,X.XFER_TYP_CDE                                10002900
                         ,X.CONTNR_TYP_CDE                              10003000
                         ,X.TO_STR_NBR                                  10003100
                         ,X.CMPT_XFER_END_TMST                          10003200
                         ,X.CPLD_INIT_1ST_NM                            10003300
                         ,X.CPLD_LAST_NM                                10003400
                         ,X.LG_TTE_1ST_SEAL_ID                          10003500
                         ,X.LG_TTE_2ND_SEAL_ID                          10003600
                         ,X.SM_TTE_BAG_SEAL_ID                          10003700
                         ,X.TRLR_NBR                                    10003800
                         ,X.TRLR_SEAL_ID                                10003900
                         ,X.CLBK_NBR                                    10004000
                         ,X.STK_BAL_APVL_NBR                            10004100
                         ,X.RQSTR_INIT_1ST_NM                           10004200
                         ,X.RQSTR_LAST_NM                               10004300
                         ,X.ATTN_INIT_1ST_NM                            10004400
                         ,X.ATTN_LAST_NM                                10004500
                         ,CT.CONTNR_TYP_DESC                            10004600
                         ,XT.TYP_1ST_LNE_DESC                           10004700
                         ,XT.TYP_2ND_LNE_DESC                           10004800
                         ,S.XFER_STAT_CDE                               10004900
                         ,SC.XFER_STAT_DESC                             10005000
                   INTO   :TFMSTR-XFER-DKEY-ID                          10005100
                         ,:TFMSTR-ENTR-MTHD-TYP-CDE                     10005200
                         ,:TFMSTR-XFER-TYP-CDE                          10005300
                         ,:TFMSTR-CONTNR-TYP-CDE                        10005400
                         ,:TFMSTR-TO-STR-NBR                            10005500
                         ,:TFMSTR-CMPT-XFER-END-TMST                    10005600
                         ,:TFMSTR-CPLD-INIT-1ST-NM                      10005700
                         ,:TFMSTR-CPLD-LAST-NM                          10005800
                         ,:TFMSTR-LG-TTE-1ST-SEAL-ID                    10005900
                         ,:TFMSTR-LG-TTE-2ND-SEAL-ID                    10006000
                         ,:TFMSTR-SM-TTE-BAG-SEAL-ID                    10006100
                         ,:TFMSTR-TRLR-NBR                              10006200
                         ,:TFMSTR-TRLR-SEAL-ID                          10006300
                         ,:TFMSTR-CLBK-NBR                              10006400
                         ,:TFMSTR-STK-BAL-APVL-NBR                      10006500
                         ,:TFMSTR-RQSTR-INIT-1ST-NM                     10006600
                         ,:TFMSTR-RQSTR-LAST-NM                         10006700
                         ,:TFMSTR-ATTN-INIT-1ST-NM                      10006800
                         ,:TFMSTR-ATTN-LAST-NM                          10006900
                         ,:TFSHCT-CONTNR-TYP-DESC                       10007000
                         ,:TFTYCD-TYP-1ST-LNE-DESC                      10007100
                         ,:TFTYCD-TYP-2ND-LNE-DESC                      10007200
                         ,:TFSTAT-XFER-STAT-CDE                         10007300
                         ,:TFSTCD-XFER-STAT-DESC                        10007400
                   FROM   TTFMSTR X                                     10007500
                         ,TTFSHCT CT                                    10007600
                         ,TTFTYCD XT                                    10007700
                         ,TTFSTAT S                                     10007800
                         ,TTFSTCD SC                                    10007900
                   WHERE  X.XFER_SEQ_NBR   = :DK-XFER-SEQ-NBR     AND   10008000
                          X.FR_STR_NBR     = :DK-FROM-STORE       AND   10008100
                          S.XFER_DKEY_ID   = X.XFER_DKEY_ID       AND   10008200
                          X.CONTNR_TYP_CDE = CT.CONTNR_TYP_CDE    AND   10008300
                          X.XFER_TYP_CDE   = XT.XFER_TYP_CDE      AND   10008400
                          S.XFER_STAT_CDE  = SC.XFER_STAT_CDE     AND   10008500
                          S.XFER_STAT_TMST =                            10008600
                  (SELECT                                               10008700
                   MAX(S.XFER_STAT_TMST)                                10008800
                   FROM TTFSTAT S                                       10008900
                       ,TTFMSTR X                                       10009000
                   WHERE  X.XFER_SEQ_NBR   = :DK-XFER-SEQ-NBR     AND   10009100
                          X.FR_STR_NBR     = :DK-FROM-STORE       AND   10009200
                          S.XFER_DKEY_ID   = X.XFER_DKEY_ID       AND   10009300
                          S.XFER_STAT_CDE  IN ('PR', 'AR', 'CM', 'VD')) 10009400
               END-EXEC                                                 10009500
                                                                        10009600
               EVALUATE TRUE                                            10009700
                   WHEN SQLCODE = ZERO                                  10009800
                   WHEN SQLCODE = +100                                  10009900
                   WHEN SQLCODE = -904                                  10010000
                   WHEN SQLCODE = -913                                  10010100
                       CONTINUE                                         10010200
                   WHEN OTHER                                           10010300
                       MOVE '4100-GET-TRANSFER'                         10010600
                                         TO DP013-PARAGRAPH             10010700
                       MOVE 'SELECT TRANSFER DATA'                      10010800
                                         TO DP013-MESSAGE-TEXT (1)      10010900
                       MOVE SQLCA        TO DP013-SQLCA                 10011000
                       MOVE 'TTFMSTR'    TO DP013-DB2-TABLE-NAME (1)    10011100
                       MOVE 'TTFSHCT'    TO DP013-DB2-TABLE-NAME (2)    10011200
                       MOVE 'TTFTYCD'    TO DP013-DB2-TABLE-NAME (3)    10011300
                       SET DP013-DB2-ABEND                              10011400
                           DP013-XCTL-DISPLAY-RESTART                   10011500
                                         TO TRUE                        10011600
                       PERFORM DP013-0000-PROCESS-ABEND                 10011700
               END-EVALUATE                                             10011800
           END-PERFORM.                                                 10011900
      *                                                                 10012000
           IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        10012100
               MOVE '4100-GET-TRANSFER'                                 10012200
                                         TO DP013-PARAGRAPH             10012300
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     10012400
                                         TO DP013-MESSAGE-TEXT (1)      10012500
               MOVE 'TRANSFER DATA'      TO DP013-MESSAGE-TEXT (2)      10012600
               MOVE SQLCA                TO DP013-SQLCA                 10012700
               MOVE 'TTFMSTR'            TO DP013-DB2-TABLE-NAME (1)    10012800
               MOVE 'TTFSHCT'            TO DP013-DB2-TABLE-NAME (2)    10012900
               MOVE 'TTFTYCD'            TO DP013-DB2-TABLE-NAME (3)    10013000
               SET DP013-DB2-ABEND                                      10013100
                   DP013-XCTL-DISPLAY-RESTART                           10013200
                                         TO TRUE                        10013300
               PERFORM DP013-0000-PROCESS-ABEND                         10013400
           END-IF.                                                      10013500
           IF SQLCODE = ZERO                                            10013600
               SET PS-TRANSFER-FOUND            TO TRUE                 10013700
               MOVE TFMSTR-XFER-DKEY-ID         TO ASC-XFER-DKEY-ID     10013800
               MOVE TFMSTR-ENTR-MTHD-TYP-CDE    TO ASC-ENTRY-METHOD     10013900
               MOVE TFMSTR-XFER-TYP-CDE         TO ASC-XFER-TYPE        10014000
               MOVE TFMSTR-CONTNR-TYP-CDE       TO ASC-CONTAINER-TYPE   10014100
               MOVE TFMSTR-TO-STR-NBR           TO ASC-TO-STORE-NBR     10014200
               MOVE TFMSTR-CMPT-XFER-END-TMST   TO ASC-COMPLETION-DATE  10014300
               MOVE SPACES                      TO ASC-COMPLETED-BY     10014400
               MOVE TFMSTR-CPLD-INIT-1ST-NM     TO ASC-COMPLETED-INIT   10014500
               MOVE TFMSTR-CPLD-LAST-NM         TO ASC-COMPLETED-NAME   10014600
               MOVE TFMSTR-LG-TTE-1ST-SEAL-ID   TO ASC-LARGE-TOTE-SEAL1 10014700
               MOVE TFMSTR-LG-TTE-2ND-SEAL-ID   TO ASC-LARGE-TOTE-SEAL2 10014800
               MOVE TFMSTR-SM-TTE-BAG-SEAL-ID   TO ASC-SMALL-TOTE-SEAL  10014900
               MOVE TFMSTR-TRLR-NBR             TO ASC-TRAILER-NBR      10015000
               MOVE TFMSTR-TRLR-SEAL-ID         TO ASC-TRAILER-SEAL     10015100
               MOVE TFMSTR-CLBK-NBR             TO ASC-CALLBACK-NBR     10015200
               MOVE TFMSTR-STK-BAL-APVL-NBR     TO ASC-APPROVAL-NBR     10015300
               MOVE SPACES                      TO ASC-REQUESTOR        10015400
               MOVE TFMSTR-RQSTR-INIT-1ST-NM    TO ASC-REQUESTOR-INIT   10015500
               MOVE TFMSTR-RQSTR-LAST-NM        TO ASC-REQUESTOR-NAME   10015600
               MOVE SPACES                      TO ASC-ATTENTION        10015700
               MOVE TFMSTR-ATTN-INIT-1ST-NM     TO ASC-ATTENTION-INIT   10015800
               MOVE TFMSTR-ATTN-LAST-NM         TO ASC-ATTENTION-NAME   10015900
               MOVE TFSHCT-CONTNR-TYP-DESC      TO ASC-CONTAINER-DESC   10016000
               IF TFTYCD-TYP-2ND-LNE-DESC = SPACES                      10017000
                   MOVE TFTYCD-TYP-1ST-LNE-DESC TO ASC-XFER-DESC        10018000
               ELSE                                                     10019000
                   STRING TFTYCD-TYP-1ST-LNE-DESC DELIMITED BY '  '     10020000
                          TFTYCD-TYP-2ND-LNE-DESC DELIMITED BY '  '     10030000
                                         INTO ASC-XFER-DESC             10040000
               END-IF                                                   10040100
               MOVE TFSTAT-XFER-STAT-CDE        TO ASC-XFER-STATUS      10040200
               MOVE TFSTCD-XFER-STAT-DESC       TO ASC-XFER-STATUS-DESC 10040300
               PERFORM 4200-CHECK-REDIRECT                              10040400
               EVALUATE ASC-XFER-STATUS                                 10040500
                  WHEN PC-POSITIVE-RECEIPT                              10040600
                       PERFORM 4300-CHECK-XFER-DISCREPANCY              10040700
                  WHEN PC-VOIDED                                        10040800
                       PERFORM 4150-GET-COMMENTS                        10040900
               END-EVALUATE                                             10041000
               PERFORM 5200-READ-TRANSFER-RECEIPT                       10041100
               PERFORM 5000-GET-STORE-NAMES                             10041200
               PERFORM 5300-READ-TRANSFER-ITEM                          10041300
               PERFORM 5350-READ-ITEM-RECEIPT                           10041400
               IF ASC-XFER-TYPE = PC-CUSTOMER OR                        10041500
                  ASC-XFER-TYPE = PC-OFFSITE-STORAGE                    10041600
                   PERFORM 5400-READ-CUSTOMER                           10041700
               END-IF                                                   10041800
           END-IF.                                                      10041900
       EJECT                                                            10042000
      *----------------------------------------------------------------*10042100
      *    GET COMMENTS AND USERID FOR VOIDED TRANSFER.                *10042200
      *----------------------------------------------------------------*10042300
                                                                        10042400
       4150-GET-COMMENTS.                                               10042500
           PERFORM                                                      10042600
               WITH TEST AFTER                                          10042700
               VARYING PV-RETRY-COUNTER                                 10042800
               FROM 1 BY 1                                              10042900
               UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               10043000
                         OR (SQLCODE = ZERO)                            10043100
                         OR (SQLCODE = +100))                           10043200
      *                                                                 10043300
               EXEC SQL                                                 10043400
                  SELECT                                                10043500
                      CMNT_BY_USR_ID                                    10043600
                     ,CMNT_TXT                                          10043700
                  INTO                                                  10043800
                      :TFSTAT-CMNT-BY-USR-ID                            10043900
                     ,:TFSTAT-CMNT-TXT                                  10044000
                  FROM   TTFSTAT                                        10044100
                  WHERE  XFER_DKEY_ID   = :ASC-XFER-DKEY-ID      AND    10044200
                         XFER_STAT_CDE  = :PC-VOIDED                    10044300
               END-EXEC                                                 10044400
                                                                        10044500
               EVALUATE TRUE                                            10044600
                   WHEN SQLCODE = ZERO                                  10044700
                       MOVE TFSTAT-CMNT-TXT-TEXT TO ASC-COMMENT-ARRAY   10044800
                       MOVE TFSTAT-CMNT-BY-USR-ID TO ASC-USERID         10044900
                   WHEN SQLCODE = +100                                  10045000
                   WHEN SQLCODE = -904                                  10045100
                   WHEN SQLCODE = -913                                  10045200
                       CONTINUE                                         10045300
                   WHEN OTHER                                           10045400
                       MOVE '4150-GET-COMMENTS'                         10045700
                                         TO DP013-PARAGRAPH             10045800
                       MOVE 'SELECT STATUS COMMENTS'                    10045900
                                         TO DP013-MESSAGE-TEXT (1)      10046000
                       MOVE SQLCA        TO DP013-SQLCA                 10046100
                       MOVE 'TTFSTAT'    TO DP013-DB2-TABLE-NAME (1)    10046200
                       SET DP013-DB2-ABEND                              10046300
                           DP013-XCTL-DISPLAY-RESTART                   10046400
                                         TO TRUE                        10046500
                       PERFORM DP013-0000-PROCESS-ABEND                 10046600
               END-EVALUATE                                             10046700
           END-PERFORM.                                                 10046800
      *                                                                 10046900
           IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        10047000
               MOVE '4150-GET-COMMENTS'  TO DP013-PARAGRAPH             10047100
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     10047200
                                         TO DP013-MESSAGE-TEXT (1)      10047300
               MOVE 'STATUS COMMENTS'    TO DP013-MESSAGE-TEXT (2)      10047400
               MOVE SQLCA                TO DP013-SQLCA                 10047500
               MOVE 'TTFSTAT'            TO DP013-DB2-TABLE-NAME (1)    10047600
               SET DP013-DB2-ABEND                                      10047700
                   DP013-XCTL-DISPLAY-RESTART                           10047800
                                         TO TRUE                        10047900
               PERFORM DP013-0000-PROCESS-ABEND                         10048000
           END-IF.                                                      10048100
       EJECT                                                            10048200
      *----------------------------------------------------------------*10048300
      *    DETERMINE WHETHER THE TRANSFER HAS BEEN REDIRECTED.         *10048400
      *----------------------------------------------------------------*10048500
                                                                        10048600
       4200-CHECK-REDIRECT.                                             10048700
           SET ASC-XFER-WAS-NOT-REDIRECTED TO TRUE.                     10048800
           PERFORM                                                      10048900
               WITH TEST AFTER                                          10049000
               VARYING PV-RETRY-COUNTER                                 10049100
               FROM 1 BY 1                                              10049200
               UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               10049300
                         OR (SQLCODE = ZERO)                            10049400
                         OR (SQLCODE = +100))                           10049500
      *                                                                 10049600
               EXEC SQL                                                 10049700
                   SELECT DISTINCT XFER_STAT_CDE                        10049800
                   INTO   :TFSTAT-XFER-STAT-CDE                         10049900
                   FROM   TTFSTAT                                       10050000
                   WHERE  XFER_DKEY_ID   = :ASC-XFER-DKEY-ID      AND   10050100
                          XFER_STAT_CDE  = :PC-INTERMEDIATE-RECEIPT     10050200
               END-EXEC                                                 10050300
                                                                        10050400
               EVALUATE TRUE                                            10050500
                   WHEN SQLCODE = ZERO                                  10050600
                       SET ASC-XFER-WAS-REDIRECTED                      10050700
                                         TO TRUE                        10050800
                   WHEN SQLCODE = +100                                  10050900
                   WHEN SQLCODE = -904                                  10051000
                   WHEN SQLCODE = -913                                  10051100
                       CONTINUE                                         10051200
                   WHEN OTHER                                           10051300
                       MOVE '4200-CHECK-REDIRECT'                       10051600
                                         TO DP013-PARAGRAPH             10051700
                       MOVE 'SELECT STATUS ROW'                         10051800
                                         TO DP013-MESSAGE-TEXT (1)      10051900
                       MOVE SQLCA        TO DP013-SQLCA                 10052000
                       MOVE 'TTFSTAT'    TO DP013-DB2-TABLE-NAME (1)    10052100
                       SET DP013-DB2-ABEND                              10052200
                           DP013-XCTL-DISPLAY-RESTART                   10052300
                                         TO TRUE                        10052400
                       PERFORM DP013-0000-PROCESS-ABEND                 10052500
               END-EVALUATE                                             10052600
           END-PERFORM.                                                 10052700
      *                                                                 10052800
           IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        10052900
               MOVE '4200-CHECK-REDIRECT'                               10053000
                                         TO DP013-PARAGRAPH             10053100
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     10053200
                                         TO DP013-MESSAGE-TEXT (1)      10053300
               MOVE 'STATUS DATA'        TO DP013-MESSAGE-TEXT (2)      10053400
               MOVE SQLCA                TO DP013-SQLCA                 10053500
               MOVE 'TTFSTAT'            TO DP013-DB2-TABLE-NAME (1)    10053600
               SET DP013-DB2-ABEND                                      10053700
                   DP013-XCTL-DISPLAY-RESTART                           10053800
                                         TO TRUE                        10053900
               PERFORM DP013-0000-PROCESS-ABEND                         10054000
           END-IF.                                                      10054100
       EJECT                                                            10054200
      *----------------------------------------------------------------*10054300
      *    DETERMINE WHETHER THERE IS A TRANSFER DISCREPANCY.          *10054400
      *----------------------------------------------------------------*10054500
                                                                        10054600
       4300-CHECK-XFER-DISCREPANCY.                                     10054700
           SET ASC-NO-DISCREPANCY-EXISTS  TO TRUE.                      10054800
           PERFORM                                                      10054900
               WITH TEST AFTER                                          10055000
               VARYING PV-RETRY-COUNTER                                 10055100
               FROM 1 BY 1                                              10055200
               UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               10055300
                         OR (SQLCODE = ZERO)                            10055400
                         OR (SQLCODE = +100))                           10055500
      *                                                                 10055600
               EXEC SQL                                                 10055700
                   SELECT RCVD_AT_STR_NBR                               10055800
                         ,LG_TTE_1ST_SEAL_ID                            10055900
                         ,LG_TTE_2ND_SEAL_ID                            10056000
                         ,SM_TTE_BG_SEAL_ID                             10056100
                   INTO   :TFDSCP-RCVD-AT-STR-NBR                       10056200
                         ,:TFDSCP-LG-TTE-1ST-SEAL-ID                    10056300
                         ,:TFDSCP-LG-TTE-2ND-SEAL-ID                    10056400
                         ,:TFDSCP-SM-TTE-BG-SEAL-ID                     10056500
                   FROM   TTFDSCP D                                     10056600
                         ,TTFSTAT S                                     10056700
                   WHERE  D.XFER_DKEY_ID   = :ASC-XFER-DKEY-ID  AND     10056800
                          S.XFER_DKEY_ID   = D.XFER_DKEY_ID     AND     10056900
                          S.XFER_STAT_CDE  = :PC-POSITIVE-RECEIPT       10057000
                                                                AND     10058000
                          S.XFER_STAT_TMST = D.RCV_XFER_BEG_TMST        10058100
               END-EXEC                                                 10058200
                                                                        10058300
               EVALUATE TRUE                                            10058400
                   WHEN SQLCODE = ZERO                                  10058500
                      SET ASC-DISCREPANCY-EXISTS TO TRUE                10058600
                      IF ASC-XFER-STATUS = PC-POSITIVE-RECEIPT          10058700
                          IF TFDSCP-LG-TTE-1ST-SEAL-ID NOT = SPACES     10058800
                                 AND                                    10058900
                             TFDSCP-LG-TTE-1ST-SEAL-ID NOT =            10059000
                             TFMSTR-LG-TTE-1ST-SEAL-ID                  10060000
                              MOVE TFDSCP-LG-TTE-1ST-SEAL-ID            10060100
                                                TO ASC-LARGE-TOTE-SEAL1 10060200
                          END-IF                                        10060300
                          IF TFDSCP-LG-TTE-2ND-SEAL-ID NOT = SPACES     10060400
                                 AND                                    10060500
                             TFDSCP-LG-TTE-2ND-SEAL-ID NOT =            10060600
                             TFMSTR-LG-TTE-2ND-SEAL-ID                  10060700
                              MOVE TFDSCP-LG-TTE-2ND-SEAL-ID            10060800
                                                TO ASC-LARGE-TOTE-SEAL2 10060900
                          END-IF                                        10061000
                          IF TFDSCP-SM-TTE-BG-SEAL-ID NOT = SPACES      10062000
                                 AND                                    10063000
                             TFDSCP-SM-TTE-BG-SEAL-ID NOT =             10064000
                             TFMSTR-SM-TTE-BAG-SEAL-ID                  10065000
                              MOVE TFDSCP-SM-TTE-BG-SEAL-ID             10065100
                                                TO ASC-SMALL-TOTE-SEAL  10065200
                          END-IF                                        10065300
                      END-IF                                            10065400
                   WHEN SQLCODE = +100                                  10065500
                       PERFORM 4350-CHECK-ITEM-DISCREPANCY              10065600
                   WHEN SQLCODE = -904                                  10065700
                   WHEN SQLCODE = -913                                  10065800
                       CONTINUE                                         10065900
                   WHEN OTHER                                           10066000
                       MOVE '4300-CHECK-XFER-DISCREPANCY'               10066300
                                         TO DP013-PARAGRAPH             10066400
                       MOVE 'SELECT DISCREPANCY ROW'                    10066500
                                         TO DP013-MESSAGE-TEXT (1)      10066600
                       MOVE SQLCA        TO DP013-SQLCA                 10066700
                       MOVE 'TTFDSCP'    TO DP013-DB2-TABLE-NAME (1)    10066800
                       SET DP013-DB2-ABEND                              10066900
                           DP013-XCTL-DISPLAY-RESTART                   10067000
                                         TO TRUE                        10067100
                       PERFORM DP013-0000-PROCESS-ABEND                 10067200
               END-EVALUATE                                             10067300
           END-PERFORM.                                                 10067400
      *                                                                 10067500
           IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        10067600
               MOVE '4300-CHECK-XFER-DISCREPANCY'                       10067700
                                         TO DP013-PARAGRAPH             10067800
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     10067900
                                         TO DP013-MESSAGE-TEXT (1)      10068000
               MOVE 'DISCREPANCY DATA'   TO DP013-MESSAGE-TEXT (2)      10068100
               MOVE SQLCA                TO DP013-SQLCA                 10068200
               MOVE 'TTFDSCP'            TO DP013-DB2-TABLE-NAME (1)    10068300
               SET DP013-DB2-ABEND                                      10068400
                   DP013-XCTL-DISPLAY-RESTART                           10068500
                                         TO TRUE                        10068600
               PERFORM DP013-0000-PROCESS-ABEND                         10068700
           END-IF.                                                      10068800
       EJECT                                                            10068900
      *----------------------------------------------------------------*10069000
      *    DETERMINE WHETHER THERE IS A TRANSFER ITEM DISCREPANCY.     *10069100
      *----------------------------------------------------------------*10069200
                                                                        10069300
       4350-CHECK-ITEM-DISCREPANCY.                                     10069400
           PERFORM                                                      10069500
               WITH TEST AFTER                                          10069600
               VARYING PV-RETRY-COUNTER                                 10069700
               FROM 1 BY 1                                              10069800
               UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               10069900
                         OR (SQLCODE = ZERO)                            10070000
                         OR (SQLCODE = +100))                           10070100
      *                                                                 10070200
               EXEC SQL                                                 10070300
                   SELECT DISTINCT R.XFER_DKEY_ID                       10070400
                   INTO   :TFITRC-XFER-DKEY-ID                          10070500
                   FROM                                                 10070600
                         TTFITRC R                                      10070700
                       , TTFSTAT S                                      10070800
                   WHERE                                                10070900
                       R.XFER_DKEY_ID    = :ASC-XFER-DKEY-ID       AND  10071000
                       S.XFER_DKEY_ID    = :ASC-XFER-DKEY-ID       AND  10071100
                       S.XFER_STAT_CDE   = :PC-POSITIVE-RECEIPT    AND  10071200
                       S.XFER_STAT_TMST  = R.XFER_RCPT_TMST        AND  10071300
                       R.XFER_ITM_DSCRP_IND = 'Y'                       10071400
               END-EXEC                                                 10071500
                                                                        10071600
               EVALUATE TRUE                                            10071700
                   WHEN SQLCODE = ZERO                                  10071800
                       SET ASC-DISCREPANCY-EXISTS                       10071900
                                         TO TRUE                        10072000
                   WHEN SQLCODE = +100                                  10072100
                   WHEN SQLCODE = -904                                  10072200
                   WHEN SQLCODE = -913                                  10072300
                       CONTINUE                                         10072400
                   WHEN OTHER                                           10072500
                       MOVE '4350-CHECK-ITEM-DISCREPANCY'               10072800
                                         TO DP013-PARAGRAPH             10072900
                       MOVE 'SELECT ITEM RECEIPT ROW'                   10073000
                                         TO DP013-MESSAGE-TEXT (1)      10073100
                       MOVE SQLCA        TO DP013-SQLCA                 10073200
                       MOVE 'TTFITRC'    TO DP013-DB2-TABLE-NAME (1)    10073300
                       MOVE 'TTFSTAT'    TO DP013-DB2-TABLE-NAME (2)    10073400
                       SET DP013-DB2-ABEND                              10073500
                           DP013-XCTL-DISPLAY-RESTART                   10073600
                                         TO TRUE                        10073700
                       PERFORM DP013-0000-PROCESS-ABEND                 10073800
               END-EVALUATE                                             10073900
           END-PERFORM.                                                 10074000
      *                                                                 10074100
           IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        10074200
               MOVE '4350-CHECK-ITEM-DISCREPANCY'                       10074300
                                         TO DP013-PARAGRAPH             10074400
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     10074500
                                         TO DP013-MESSAGE-TEXT (1)      10074600
               MOVE 'ITEM RECEIPT DATA'  TO DP013-MESSAGE-TEXT (2)      10074700
               MOVE SQLCA                TO DP013-SQLCA                 10074800
               MOVE 'TTFITRC'            TO DP013-DB2-TABLE-NAME (1)    10074900
               MOVE 'TTFSTAT'            TO DP013-DB2-TABLE-NAME (2)    10075000
               SET DP013-DB2-ABEND                                      10075100
                   DP013-XCTL-DISPLAY-RESTART                           10075200
                                         TO TRUE                        10075300
               PERFORM DP013-0000-PROCESS-ABEND                         10075400
           END-IF.                                                      10075500
       EJECT                                                            10075600
      *----------------------------------------------------------------*10075700
      *    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *10075800
      *----------------------------------------------------------------*10075900
                                                                        10076000
       4400-MOVE-COMMAREA-TO-SCREEN.                                    10076100
           SET ASC-NO-PRINT-REQUEST      TO TRUE.                       10076200
           MOVE ASC-XFER-STATUS-DESC     TO MR-A-STATUS.                10076300
           MOVE ASC-XFER-TYPE            TO MR-A-XFER-TYPE.             10076400
           MOVE ASC-XFER-SEQ-NBR         TO MR-A-XFER-SEQ-NBR.          10076500
           MOVE '-'                      TO MR-A-XFER-NBR-DASH.         10076600
           MOVE ASC-FROM-STORE-NBR       TO MR-A-XFER-FROM-STORE.       10076700
           MOVE ASC-XFER-DESC            TO MR-A-XFER-DESC.             10076800
           MOVE ASC-CONTAINER-TYPE       TO MR-A-CONTAINER-TYPE.        10076900
           MOVE ASC-CONTAINER-DESC       TO MR-A-CONTAINER-DESC.        10077000
           MOVE ASC-FROM-STORE-NBR       TO MR-A-FROM-NBR.              10077100
           MOVE ASC-FROM-STORE-NAME      TO MR-A-FROM-NAME.             10077200
           IF   ASC-ENTRY-SCANNED                                       10077300
              MOVE 'Y'                   TO MR-A-FROM-SCAN              10077400
           ELSE                                                         10077500
              MOVE 'N'                   TO MR-A-FROM-SCAN              10077600
           END-IF                                                       10077700
           MOVE ASC-COMPLETED-BY         TO MR-A-COMP-BY.               10077800
           MOVE ASC-COMPLETED-QTY        TO MR-A-COMP-QTY.              10077900
           MOVE ASC-COMPLETED-RETAIL     TO MR-A-COMP-RETAIL            10078000
           MOVE ASC-COMP-YEAR            TO PV-YEAR.                    10078100
           MOVE ASC-COMP-MONTH           TO PV-MONTH.                   10078200
           MOVE ASC-COMP-DAY             TO PV-DAY.                     10078300
           MOVE PV-DATE                  TO MR-A-COMP-DATE.             10078400
           EVALUATE ASC-XFER-TYPE                                       10078500
111703*        WHEN PC-DEFECTIVE-DAMAGE                                 10078600
111703         WHEN PC-DEFECTIVE-DAMAGE-SORT1                           10078700
111703         WHEN PC-DEFECTIVE-DAMAGE-SORT2                           10078800
               WHEN PC-STOCK-BALANCE-STORE                              10078900
                   MOVE DP015-ASK-DRK-OFF                               10079000
                                         TO MR-A-LIN5-LITERAL-ATTRIB    10079100
                                            MR-A-LIN5-FIELD-ATTRIB      10079200
                                            MR-A-LIN8-LITERAL-ATTRIB    10079300
                                            MR-A-LIN8-FIELD-ATTRIB      10079400
                                            MR-A-PHONE-LITERAL-ATTRIB   10079500
                                            MR-A-PHONE-ATTRIB           10079600
                                            MR-A-ADDR-LITERAL-ATTRIB    10079700
                                            MR-A-ADDR-ATTRIB            10079800
                                            MR-A-CITY-LITERAL-ATTRIB    10079900
                                            MR-A-CITY-ATTRIB            10080000
                                            MR-A-STATE-LITERAL-ATTRIB   10080100
                                            MR-A-STATE-ZIP-ATTRIB       10080200
               WHEN PC-CALLBACK                                         10080300
                   MOVE PC-CALLBACK-LITERAL                             10080400
                                         TO MR-A-LIN5-LITERAL           10080500
                   MOVE ASC-CALLBACK-NBR TO MR-A-LIN5-FIELD             10080600
                   MOVE DP015-ASK-DRK-OFF                               10080700
                                         TO MR-A-LIN8-LITERAL-ATTRIB    10080800
                                            MR-A-LIN8-FIELD-ATTRIB      10080900
                                            MR-A-PHONE-LITERAL-ATTRIB   10081000
                                            MR-A-PHONE-ATTRIB           10081100
                                            MR-A-ADDR-LITERAL-ATTRIB    10081200
                                            MR-A-ADDR-ATTRIB            10081300
                                            MR-A-CITY-LITERAL-ATTRIB    10081400
                                            MR-A-CITY-ATTRIB            10081500
                                            MR-A-STATE-LITERAL-ATTRIB   10081600
                                            MR-A-STATE-ZIP-ATTRIB       10081700
               WHEN PC-STOCK-BALANCE-CORP                               10081800
                   MOVE PC-APPROVAL-LITERAL                             10081900
                                         TO MR-A-LIN5-LITERAL           10082000
                   MOVE ASC-APPROVAL-NBR TO MR-A-LIN5-FIELD             10082100
                   MOVE DP015-ASK-DRK-OFF                               10082200
                                         TO MR-A-LIN8-LITERAL-ATTRIB    10082300
                                            MR-A-LIN8-FIELD-ATTRIB      10082400
                                            MR-A-PHONE-LITERAL-ATTRIB   10082500
                                            MR-A-PHONE-ATTRIB           10082600
                                            MR-A-ADDR-LITERAL-ATTRIB    10082700
                                            MR-A-ADDR-ATTRIB            10082800
                                            MR-A-CITY-LITERAL-ATTRIB    10082900
                                            MR-A-CITY-ATTRIB            10083000
                                            MR-A-STATE-LITERAL-ATTRIB   10083100
                                            MR-A-STATE-ZIP-ATTRIB       10083200
               WHEN PC-NON-RETAIL                                       10083300
                   MOVE PC-REQUESTED-BY-LITERAL                         10083400
                                         TO MR-A-LIN5-LITERAL           10083500
                   MOVE ASC-REQUESTOR    TO MR-A-LIN5-FIELD             10083600
                   MOVE PC-ATTENTION-LITERAL                            10083700
                                         TO MR-A-LIN8-LITERAL           10083800
                   MOVE ASC-ATTENTION    TO MR-A-LIN8-FIELD             10083900
                   MOVE DP015-ASK-DRK-OFF                               10084000
                                         TO MR-A-PHONE-LITERAL-ATTRIB   10084100
                                            MR-A-PHONE-ATTRIB           10084200
                                            MR-A-ADDR-LITERAL-ATTRIB    10084300
                                            MR-A-ADDR-ATTRIB            10084400
                                            MR-A-CITY-LITERAL-ATTRIB    10084500
                                            MR-A-CITY-ATTRIB            10084600
                                            MR-A-STATE-LITERAL-ATTRIB   10084700
                                            MR-A-STATE-ZIP-ATTRIB       10084800
                   MOVE SPACES           TO MR-A-COMP-RETAIL-X          10084900
               WHEN PC-CUSTOMER                                         10085000
               WHEN PC-OFFSITE-STORAGE                                  10085100
                   MOVE PC-REQUESTED-BY-LITERAL                         10085200
                                         TO MR-A-LIN5-LITERAL           10085300
                   MOVE ASC-REQUESTOR    TO MR-A-LIN5-FIELD             10085400
                   IF ASC-XFER-TYPE = PC-CUSTOMER                       10085500
                       MOVE PC-CUSTOMER-LITERAL                         10085600
                                         TO MR-A-LIN8-LITERAL           10085700
                   ELSE                                                 10085800
                       MOVE PC-OFFSITE-NAME-LITERAL                     10085900
                                         TO MR-A-LIN8-LITERAL           10086000
                       MOVE PC-OFFSITE-PHON-LITERAL                     10086100
                                         TO MR-A-PHONE-LITERAL          10086200
                   END-IF                                               10086300
                   MOVE ASC-CUST-NAME    TO MR-A-LIN8-FIELD             10086400
                   IF ASC-CUST-PHONE > ZERO                             10086500
                       MOVE ASC-CUST-PHONE   TO PV-PHONE                10086600
                       MOVE '('              TO PV-PHONE-LIT1           10086700
                       MOVE ')-'             TO PV-PHONE-LIT2           10086800
                       MOVE '-'              TO PV-PHONE-LIT3           10086900
                       MOVE PV-PHONE     TO MR-A-PHONE                  10087000
                   END-IF                                               10087100
                   MOVE ASC-CUST-ADDRESS TO MR-A-ADDR                   10087200
                   MOVE ASC-CUST-CITY    TO MR-A-CITY                   10087300
                   MOVE ASC-CUST-STATE   TO PV-STATE                    10087400
                   IF ASC-CUST-ZIP > 0                                  10087500
                       MOVE ASC-CUST-ZIP TO PV-ZIP                      10087600
                       IF ASC-CUST-ZIP-EXT > 0                          10087700
                           MOVE ASC-CUST-ZIP-EXT TO PV-ZIP-EXT          10087800
                           MOVE '-'              TO PV-ZIP-DASH         10087900
                       ELSE                                             10088000
                           MOVE SPACES TO PV-ZIP-EXTENSION              10088100
                       END-IF                                           10088200
                   END-IF                                               10088300
                   MOVE PV-STATE-ZIP     TO MR-A-STATE-ZIP              10088400
                   MOVE DP015-ASK-NOR-OFF                               10088500
                                         TO MR-A-LIN8-LITERAL-ATTRIB    10088600
                                            MR-A-LIN8-FIELD-ATTRIB      10088700
                                            MR-A-PHONE-LITERAL-ATTRIB   10088800
                                            MR-A-PHONE-ATTRIB           10088900
                                            MR-A-ADDR-LITERAL-ATTRIB    10089000
                                            MR-A-ADDR-ATTRIB            10089100
                                            MR-A-CITY-LITERAL-ATTRIB    10089200
                                            MR-A-CITY-ATTRIB            10089300
                                            MR-A-STATE-LITERAL-ATTRIB   10089400
                                            MR-A-STATE-ZIP-ATTRIB       10089500
           END-EVALUATE.                                                10089600
           EVALUATE ASC-CONTAINER-TYPE                                  10089700
               WHEN PC-TRAILER-CONTAINER                                10089800
                   MOVE PC-TRAILER-SEAL-LITERAL                         10089900
                                         TO MR-A-LIN7-LITERAL1          10090000
                   MOVE PC-TRAILER-NBR-LITERAL                          10090100
                                         TO MR-A-LIN7-LITERAL2          10090200
                   MOVE ASC-TRAILER-SEAL TO MR-A-LIN7-FIELD1            10090300
                   MOVE ASC-TRAILER-NBR  TO MR-A-LIN7-FIELD2            10090400
               WHEN OTHER                                               10090500
                   MOVE PC-LARGE-TOTE-LITERAL                           10090600
                                         TO MR-A-LIN7-LITERAL1          10090700
                   MOVE PC-SMALL-TOTE-LITERAL                           10090800
                                         TO MR-A-LIN7-LITERAL2          10090900
                   MOVE ASC-LARGE-TOTE-SEAL1                            10091000
                                         TO MR-A-LIN7-SEAL1             10091100
                   MOVE ASC-LARGE-TOTE-SEAL2                            10091200
                                         TO MR-A-LIN7-SEAL2             10091300
                   MOVE ASC-SMALL-TOTE-SEAL                             10091400
                                         TO MR-A-LIN7-FIELD2            10091500
           END-EVALUATE.                                                10091600
           EVALUATE ASC-XFER-STATUS ALSO ASC-DISCREPANCY-SW             10091700
                           ALSO ASC-XFER-TYPE                           10091800
               WHEN PC-POSITIVE-RECEIPT ALSO PC-YES                     10091900
                           ALSO PC-NON-RETAIL                           10092000
                   IF ASC-XFER-WAS-REDIRECTED                           10092100
                       MOVE PC-CHECK-ROUTING-TEXT                       10092200
                                         TO MR-A-MESSAGE                10092300
                   END-IF                                               10092400
               WHEN PC-POSITIVE-RECEIPT ALSO PC-YES                     10092500
                           ALSO ANY                                     10092600
                   IF ASC-XFER-WAS-REDIRECTED                           10092700
                       MOVE PC-CHECK-ROUTE-DISCREP-TEXT                 10092800
                                         TO MR-A-MESSAGE                10092900
                   ELSE                                                 10093000
                       MOVE PC-CHECK-DISCREPANCY-TEXT                   10093100
                                         TO MR-A-MESSAGE                10093200
                   END-IF                                               10093300
               WHEN OTHER                                               10093400
                   IF ASC-XFER-WAS-REDIRECTED                           10093500
                       MOVE PC-CHECK-ROUTING-TEXT                       10093600
                                         TO MR-A-MESSAGE                10093700
                   ELSE                                                 10093800
                       MOVE SPACES       TO MR-A-MESSAGE                10093900
                   END-IF                                               10094000
           END-EVALUATE.                                                10095000
           SET DP030-ERASE                                              28470000
               DP030-SEND-MAP-AND-DATA (1)                              28480000
               DP030-SEND-MAP-AND-DATA (2)     TO TRUE.                 28490000
           MOVE PC-COMMON-HEADER-MAP-NAME      TO DP030-MAP-NAME (1).   28520000
           MOVE 1                              TO PV-MAP-START-BYTE.    28530000
           MOVE MR-A-COMMON                    TO MD-MAP-DATA-AREA.     28540000
           MOVE LENGTH OF MR-A-COMMON          TO DP030-MAP-LENGTH (1). 28550000
           ADD DP030-MAP-LENGTH (1)            TO PV-MAP-START-BYTE.    28560000
           EVALUATE ASC-XFER-STATUS                                     28570000
               WHEN PC-VOIDED                                           28580000
                   MOVE ASC-USERID             TO MR-C-USERID           28590000
                   PERFORM                                              28600000
                     VARYING PV-SUB                                     28610000
                     FROM 1 BY 1                                        28620000
                     UNTIL PV-SUB > 4                                   28630000
                       MOVE ASC-COMMENT (PV-SUB)                        28640000
                                              TO MR-C-COMMENT (PV-SUB)  28650000
                   END-PERFORM                                          28650100
                   MOVE PC-COMMENTS-MAP-NAME  TO DP030-MAP-NAME (2)     28650200
                   MOVE LENGTH OF MR-C-COMMENTS                         28650300
                                               TO DP030-MAP-LENGTH (2)  28650400
                   MOVE MR-C-COMMENTS          TO MD-MAP-DATA-AREA      28660000
                             (PV-MAP-START-BYTE:DP030-MAP-LENGTH (2))   28670000
                   ADD DP030-MAP-LENGTH (2)    TO PV-MAP-START-BYTE     28680000
                                                                        28690000
               WHEN OTHER                                               28690100
                   MOVE ASC-TO-STORE-NBR         TO MR-B-TO-NBR         28690200
                   MOVE ASC-TO-STORE-NAME        TO MR-B-TO-NAME        28690300
                   MOVE ASC-RECEIVED-BY          TO MR-B-RECV-BY        28690400
                   IF ASC-RECEIVED-DATE > SPACES                        28690500
                       MOVE ASC-RECV-YEAR        TO PV-YEAR             28690600
                       MOVE ASC-RECV-MONTH       TO PV-MONTH            28690700
                       MOVE ASC-RECV-DAY         TO PV-DAY              28690800
                       MOVE PV-DATE              TO MR-B-RECV-DATE      28690900
                       IF   ASC-RECV-SCANNED                            28691000
                           MOVE 'Y'               TO MR-B-TO-SCAN       28691100
                       ELSE                                             28691200
                           MOVE 'N'               TO MR-B-TO-SCAN       28691300
                       END-IF                                           28691400
                       MOVE ASC-RECEIVED-QTY     TO MR-B-RECV-QTY       28691500
                       MOVE ASC-RECEIVED-RETAIL  TO MR-B-RECV-RETAIL    28691600
                   END-IF                                               28691700
                   IF ASC-XFER-TYPE = PC-NON-RETAIL                     28691800
                       MOVE SPACES           TO MR-B-RECV-RETAIL-X      28691900
                   END-IF                                               28692000
                   MOVE PC-RECEIVED-MAP-NAME  TO DP030-MAP-NAME (2)     28692100
                   MOVE LENGTH OF MR-B-RECEIVED                         28692200
                                               TO DP030-MAP-LENGTH (2)  28692300
                   MOVE MR-B-RECEIVED          TO MD-MAP-DATA-AREA      28692400
                             (PV-MAP-START-BYTE:DP030-MAP-LENGTH (2))   28692500
                   ADD DP030-MAP-LENGTH (2)    TO PV-MAP-START-BYTE     28692600
           END-EVALUATE.                                                28692700
                                                                        28692800
       EJECT                                                            28692900
       5000-GET-STORE-NAMES.                                            28693000
           MOVE ASC-FROM-STORE-NBR       TO DK-STORE-NBR.               28693100
           PERFORM 5100-READ-XST-LOC.                                   28693200
100404     MOVE XST00001-LOC-10-ABBR-NM  TO ASC-FROM-STORE-NAME.        28693300
           MOVE ASC-TO-STORE-NBR         TO DK-STORE-NBR.               28693400
           PERFORM 5100-READ-XST-LOC.                                   28693500
100404     MOVE XST00001-LOC-10-ABBR-NM  TO ASC-TO-STORE-NAME.          28693600
       EJECT                                                            28693700
      *----------------------------------------------------------------*28693800
      *    GET THE 10 CHARACTER ABBREVIATED STORE NAME.                *28693900
      *----------------------------------------------------------------*28694000
100404 5100-READ-XST-LOC.                                               28694100
           PERFORM WITH TEST AFTER                                      28694200
               VARYING PV-RETRY-COUNTER                                 28694300
               FROM 1 BY 1                                              28694400
               UNTIL (PV-RETRY-COUNTER > PC-MAX-RETRIES)                28694500
                    OR SQLCODE = ZERO                                   28694600
                    OR SQLCODE = +100                                   28694700
               EXEC SQL                                                 28694800
100404             SELECT LOC_10_ABBR_NM                                28694900
100404                 INTO :XST00001-LOC-10-ABBR-NM                    28695000
100404                 FROM XST_LOC                                     28695100
100404                 WHERE (LOC_NBR  = :DK-STORE-NBR)                 28695200
               END-EXEC                                                 28695300
               EVALUATE TRUE                                            28695400
                   WHEN SQLCODE = ZERO                                  28695500
                   WHEN SQLCODE = -904                                  28695600
                   WHEN SQLCODE = -913                                  28695700
                       CONTINUE                                         28695800
                   WHEN SQLCODE = +100                                  28695900
100404                 MOVE 'INVALID'    TO XST00001-LOC-10-ABBR-NM     28696000
                   WHEN OTHER                                           28696100
100404                 MOVE '5100-READ-XST-LOC'                         28696400
                                         TO DP013-PARAGRAPH             28696500
100404                 MOVE 'SELECT A ROW FROM XST_LOC'                 28696600
                                         TO DP013-MESSAGE-TEXT (1)      28696700
                       MOVE SQLCA        TO DP013-SQLCA                 28696800
100404                 MOVE 'XST_LOC'    TO DP013-DB2-TABLE-NAME (1)    28696900
                       SET DP013-DB2-ABEND                              28697000
                           DP013-XCTL-DISPLAY-RESTART                   28697100
                                         TO TRUE                        28697200
                       PERFORM DP013-0000-PROCESS-ABEND                 28697300
               END-EVALUATE                                             28697400
           END-PERFORM.                                                 28697500
                                                                        28697600
      *                                                                 28697700
           IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        28697800
100404         MOVE '5100-READ-XST-LOC'                                 28697900
                                         TO DP013-PARAGRAPH             28698000
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     28698100
                                         TO DP013-MESSAGE-TEXT (1)      28698200
100404         MOVE 'A ROW FROM XST_LOC' TO DP013-MESSAGE-TEXT (2)      28698300
               MOVE SQLCA                TO DP013-SQLCA                 28698400
100404         MOVE 'XST_LOC'            TO DP013-DB2-TABLE-NAME (1)    28698500
               SET DP013-DB2-ABEND                                      28698600
                   DP013-XCTL-DISPLAY-RESTART                           28698700
                                         TO TRUE                        28698800
               PERFORM DP013-0000-PROCESS-ABEND                         28698900
           END-IF.                                                      28699000
       EJECT                                                            28699100
      *----------------------------------------------------------------*28699200
      *    GET THE TRANSFER RECEIPT INFORMATION.                       *28699300
      *----------------------------------------------------------------*28699400
       5200-READ-TRANSFER-RECEIPT.                                      28699500
           PERFORM WITH TEST AFTER                                      28699600
               VARYING PV-RETRY-COUNTER FROM 1 BY 1                     28699700
                 UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES                28699800
                    OR SQLCODE = ZERO                                   28699900
                    OR SQLCODE = +100                                   28700000
               EXEC SQL                                                 28700100
                   SELECT RCV_XFER_BEG_TMST                             28700200
                         ,RCPT_MTHD_CDE                                 28700300
                         ,STR_NBR                                       28700400
                         ,RCVR_INIT_1ST_NM                              28700500
                         ,RCVR_LAST_NM                                  28700600
                       INTO :TFRCPT-RCV-XFER-BEG-TMST                   28700700
                           ,:TFRCPT-RCPT-MTHD-CDE                       28700800
                           ,:TFRCPT-STR-NBR                             28700900
                           ,:TFRCPT-RCVR-INIT-1ST-NM                    28701000
                           ,:TFRCPT-RCVR-LAST-NM                        28701100
                       FROM TTFRCPT R                                   28701200
                       WHERE R.XFER_DKEY_ID  = :ASC-XFER-DKEY-ID  AND   28701300
      *                      STR_NBR         = :TFMSTR-TO-STR-NBR AND   28701400
                             RCV_XFER_BEG_TMST =                        28701500
                      (SELECT                                           28701600
                       MAX(RCV_XFER_BEG_TMST)                           28701700
                       FROM TTFRCPT R                                   28701800
                           ,TTFSTAT S                                   28701900
                       WHERE R.XFER_DKEY_ID  = :ASC-XFER-DKEY-ID  AND   28702000
                             S.XFER_DKEY_ID  = :ASC-XFER-DKEY-ID  AND   28702100
      *                      STR_NBR         = :TFMSTR-TO-STR-NBR AND   28702200
                             RCV_XFER_BEG_TMST = XFER_STAT_TMST   AND   28702300
                            (XFER_STAT_CDE = :PC-POSITIVE-RECEIPT OR    28702400
                             XFER_STAT_CDE = :PC-ASSUMPTIVE-RECEIPT))   28702500
               END-EXEC                                                 28702600
               EVALUATE TRUE                                            28702700
                   WHEN SQLCODE = -904                                  28702800
                   WHEN SQLCODE = -913                                  28702900
                   WHEN SQLCODE = +100                                  28703000
                       CONTINUE                                         28703100
                   WHEN SQLCODE = ZERO                                  28703200
                       MOVE TFRCPT-STR-NBR    TO ASC-TO-STORE-NBR       28703300
                       IF ASC-XFER-STATUS = PC-ASSUMPTIVE-RECEIPT       28703400
                           MOVE SPACES    TO ASC-RECEIVED-BY            28703500
                                             ASC-RECEIVED-DATE          28703600
                           MOVE 'ASSUMPTIVE'                            28703700
                                          TO ASC-RECEIVED-NAME          28703800
                       ELSE                                             28703900
                           MOVE SPACES    TO ASC-RECEIVED-BY            28704000
                           MOVE TFRCPT-RCVR-INIT-1ST-NM                 28704100
                                          TO ASC-RECEIVED-INIT          28704200
                           MOVE TFRCPT-RCVR-LAST-NM                     28704300
                                          TO ASC-RECEIVED-NAME          28704400
                           MOVE TFRCPT-RCPT-MTHD-CDE                    28704500
                                          TO ASC-RECV-METHOD            28704600
                           MOVE TFRCPT-RCV-XFER-BEG-TMST                28704700
                                          TO ASC-RECEIVED-DATE          28704800
                       END-IF                                           28704900
                   WHEN OTHER                                           28705000
                       MOVE '5200-READ-TRANSFER-RECEIPT'                28705300
                                         TO DP013-PARAGRAPH             28705400
                       MOVE 'SELECT DATA FROM TTFRCPT'                  28705500
                                         TO DP013-MESSAGE-TEXT (1)      28705600
                       MOVE SQLCA        TO DP013-SQLCA                 28705700
                       MOVE 'TTFRCPT'    TO DP013-DB2-TABLE-NAME (1)    28705800
                       SET DP013-DB2-ABEND                              28705900
                           DP013-XCTL-DISPLAY-RESTART                   28706000
                                         TO TRUE                        28706100
                       PERFORM DP013-0000-PROCESS-ABEND                 28706200
               END-EVALUATE                                             28706300
           END-PERFORM.                                                 28706400
      *                                                                 28706500
           IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        28706600
               MOVE '5200-READ-TRANSFER-RECEIPT'                        28706700
                                         TO DP013-PARAGRAPH             28706800
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     28706900
                                         TO DP013-MESSAGE-TEXT (1)      28707000
               MOVE 'DATA FROM TTFRCPT'  TO DP013-MESSAGE-TEXT (2)      28707100
               MOVE SQLCA                TO DP013-SQLCA                 28707200
               MOVE 'TTFRCPT'            TO DP013-DB2-TABLE-NAME (1)    28707300
               SET DP013-DB2-ABEND                                      28707400
                   DP013-XCTL-DISPLAY-RESTART                           28707500
                                         TO TRUE                        28707600
               PERFORM DP013-0000-PROCESS-ABEND                         28707700
           END-IF.                                                      28707800
       EJECT                                                            28707900
      *----------------------------------------------------------------*28708000
      *  GET THE TOTAL XFER QTY & PRICE.                               *28708100
      *----------------------------------------------------------------*28708200
       5300-READ-TRANSFER-ITEM.                                         28708300
           PERFORM WITH TEST AFTER                                      28708400
               VARYING PV-RETRY-COUNTER FROM 1 BY 1                     28708500
                 UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES                28708600
                    OR SQLCODE = ZERO                                   28708700
                    OR SQLCODE = +100                                   28708800
               EXEC SQL                                                 28708900
                   SELECT SUM(XFER_PRIC_AMT * XFER_QTY)                 28709000
                         ,SUM(XFER_QTY)                                 28709100
                       INTO :PV-XFER-PRICE                              28709200
                            :PV-XFER-PRICE-IND                          28709300
                           ,:PV-XFER-QTY                                28709400
                            :PV-XFER-QTY-IND                            28709500
                       FROM TTFITEM                                     28709600
                       WHERE XFER_DKEY_ID  = :ASC-XFER-DKEY-ID          28709700
               END-EXEC                                                 28709800
               EVALUATE TRUE                                            28709900
                   WHEN SQLCODE = ZERO                                  28710000
                   WHEN SQLCODE = +100                                  28710100
                   WHEN SQLCODE = -904                                  28710200
                   WHEN SQLCODE = -913                                  28710300
                       CONTINUE                                         28710400
                   WHEN OTHER                                           28710500
                       MOVE '5300-READ-TRANSFER-ITEM'                   28710800
                                         TO DP013-PARAGRAPH             28710900
                       MOVE 'SUMMARIZE DATA FROM TTFITEM'               28711000
                                         TO DP013-MESSAGE-TEXT (1)      28711100
                       MOVE SQLCA        TO DP013-SQLCA                 28711200
                       MOVE 'TTFITEM'    TO DP013-DB2-TABLE-NAME (1)    28711300
                       SET DP013-DB2-ABEND                              28711400
                           DP013-XCTL-DISPLAY-RESTART                   28711500
                                         TO TRUE                        28711600
                       PERFORM DP013-0000-PROCESS-ABEND                 28711700
               END-EVALUATE                                             28711800
           END-PERFORM.                                                 28711900
      *                                                                 28712000
           IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        28712100
               MOVE '5300-READ-TRANSFER-ITEM'                           28712200
                                         TO DP013-PARAGRAPH             28712300
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     28712400
                                         TO DP013-MESSAGE-TEXT (1)      28712500
               MOVE 'DATA FROM TTFITEM'  TO DP013-MESSAGE-TEXT (2)      28712600
               MOVE SQLCA                TO DP013-SQLCA                 28712700
               MOVE 'TTFITEM'            TO DP013-DB2-TABLE-NAME (1)    28712800
               SET DP013-DB2-ABEND                                      28712900
                   DP013-XCTL-DISPLAY-RESTART                           28713000
                                         TO TRUE                        28713100
               PERFORM DP013-0000-PROCESS-ABEND                         28713200
           END-IF.                                                      28713300
           IF SQLCODE = +100                                            28713400
               MOVE ZEROES                TO ASC-COMPLETED-RETAIL       28713500
                                             ASC-COMPLETED-QTY          28713600
           ELSE                                                         28713700
      *        IF PV-XFER-PRICE-IND < 0                                 28713800
      *            MOVE ZEROES            TO ASC-COMPLETED-RETAIL       28713900
      *        ELSE                                                     28714000
                   MOVE PV-XFER-PRICE                                   28714100
                                          TO ASC-COMPLETED-RETAIL       28714200
      *        END-IF                                                   28714300
      *        IF PV-XFER-QTY-IND < 0                                   28714400
      *            MOVE ZEROES            TO ASC-COMPLETED-QTY          28714500
      *        ELSE                                                     28714600
                   MOVE PV-XFER-QTY                                     28714700
                                          TO ASC-COMPLETED-QTY          28714800
      *        END-IF                                                   28714900
           END-IF.                                                      28715000
       EJECT                                                            28715100
      *----------------------------------------------------------------*28715200
      *  GET THE TOTAL RECIEVED QTY & PRICE.                           *28715300
      *----------------------------------------------------------------*28715400
       5350-READ-ITEM-RECEIPT.                                          28715500
           PERFORM WITH TEST AFTER                                      28715600
               VARYING PV-RETRY-COUNTER FROM 1 BY 1                     28715700
                 UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES                28715800
                    OR SQLCODE = ZERO                                   28715900
                    OR SQLCODE = +100                                   28716000
               EXEC SQL                                                 28716100
                   SELECT SUM(RCVD_XFER_PRIC_AMT * RCVD_XFER_QTY)       28716200
                         ,SUM(RCVD_XFER_QTY)                            28716300
                       INTO :PV-RCVD-PRICE                              28716400
                            :PV-RCVD-PRICE-IND                          28716500
                           ,:PV-RCVD-QTY                                28716600
                            :PV-RCVD-QTY-IND                            28716700
                       FROM TTFITRC I                                   28716800
                           ,TTFSTAT S                                   28716900
                       WHERE I.XFER_DKEY_ID   = :ASC-XFER-DKEY-ID  AND  28717000
                             S.XFER_DKEY_ID   = :ASC-XFER-DKEY-ID  AND  28717100
                             S.XFER_STAT_CDE  = :PC-POSITIVE-RECEIPT    28717200
                                                                   AND  28717300
                             S.XFER_STAT_TMST = I.XFER_RCPT_TMST        28717400
               END-EXEC                                                 28717500
               EVALUATE TRUE                                            28717600
                   WHEN SQLCODE = ZERO                                  28717700
                   WHEN SQLCODE = +100                                  28717800
                   WHEN SQLCODE = -904                                  28717900
                   WHEN SQLCODE = -913                                  28718000
                       CONTINUE                                         28718100
                   WHEN OTHER                                           28718200
                       MOVE '5350-READ-ITEM-RECEIPT'                    28718500
                                         TO DP013-PARAGRAPH             28718600
                       MOVE 'SUMMARIZE DATA FROM TTFITEM'               28718700
                                         TO DP013-MESSAGE-TEXT (1)      28718800
                       MOVE SQLCA        TO DP013-SQLCA                 28718900
                       MOVE 'TTFITRC'    TO DP013-DB2-TABLE-NAME (1)    28719000
                       SET DP013-DB2-ABEND                              28719100
                           DP013-XCTL-DISPLAY-RESTART                   28719200
                                         TO TRUE                        28719300
                       PERFORM DP013-0000-PROCESS-ABEND                 28719400
               END-EVALUATE                                             28719500
           END-PERFORM.                                                 28719600
      *                                                                 28719700
           IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        28719800
               MOVE '5350-READ-ITEM-RECEIPT'                            28719900
                                         TO DP013-PARAGRAPH             28720000
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     28720100
                                         TO DP013-MESSAGE-TEXT (1)      28720200
               MOVE 'DATA FROM TTFITRC'  TO DP013-MESSAGE-TEXT (2)      28720300
               MOVE SQLCA                TO DP013-SQLCA                 28720400
               MOVE 'TTFITRC'            TO DP013-DB2-TABLE-NAME (1)    28720500
               SET DP013-DB2-ABEND                                      28720600
                   DP013-XCTL-DISPLAY-RESTART                           28720700
                                         TO TRUE                        28720800
               PERFORM DP013-0000-PROCESS-ABEND                         28720900
           END-IF.                                                      28721000
           IF SQLCODE = +100                                            28721100
               MOVE ZEROES               TO  ASC-RECEIVED-RETAIL        28721200
                                             ASC-RECEIVED-QTY           28721300
           ELSE                                                         28721400
                   MOVE PV-RCVD-PRICE                                   28721500
                                          TO ASC-RECEIVED-RETAIL        28721600
                   MOVE PV-RCVD-QTY                                     28721700
                                          TO ASC-RECEIVED-QTY           28721800
           END-IF.                                                      28721900
       EJECT                                                            28722000
      *----------------------------------------------------------------*28722100
      *  GET THE CUSTOMER INFORMATION FOR CUSTOMER TRANSFERS.          *28722200
      *----------------------------------------------------------------*28722300
       5400-READ-CUSTOMER.                                              28722400
           PERFORM WITH TEST AFTER                                      28722500
               VARYING PV-RETRY-COUNTER FROM 1 BY 1                     28722600
                 UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES                28722700
                    OR SQLCODE = ZERO                                   28722800
                    OR SQLCODE = +100                                   28722900
               EXEC SQL                                                 28723000
                   SELECT CUST_NM                                       28723100
                         ,CUST_1ST_LNE_ADDR                             28723200
                         ,CTY_NM                                        28723300
                         ,ST_CDE                                        28723400
                         ,ZIP_CDE                                       28723500
                         ,ZIP_EXT_CDE                                   28723600
                         ,PHN_NBR                                       28723700
                       INTO :TFCUST-CUST-NM                             28723800
                           ,:TFCUST-CUST-1ST-LNE-ADDR                   28723900
                           ,:TFCUST-CTY-NM                              28724000
                           ,:TFCUST-ST-CDE                              28724100
                           ,:TFCUST-ZIP-CDE                             28724200
                           ,:TFCUST-ZIP-EXT-CDE                         28724300
                           ,:TFCUST-PHN-NBR                             28724400
                       FROM TTFCUST                                     28724500
                       WHERE XFER_DKEY_ID  = :ASC-XFER-DKEY-ID          28724600
               END-EXEC                                                 28724700
               EVALUATE TRUE                                            28724800
                   WHEN SQLCODE = ZERO                                  28724900
                       MOVE TFCUST-CUST-NM                              28725000
                                          TO ASC-CUST-NAME              28725100
                       MOVE TFCUST-CUST-1ST-LNE-ADDR                    28725200
                                          TO ASC-CUST-ADDRESS           28725300
                       MOVE TFCUST-CTY-NM                               28725400
                                          TO ASC-CUST-CITY              28725500
                       MOVE TFCUST-ST-CDE                               28725600
                                          TO ASC-CUST-STATE             28725700
                       MOVE TFCUST-ZIP-CDE                              28725800
                                          TO ASC-CUST-ZIP               28725900
                       MOVE TFCUST-ZIP-EXT-CDE                          28726000
                                          TO ASC-CUST-ZIP-EXT           28726100
                       MOVE TFCUST-PHN-NBR                              28726200
                                          TO ASC-CUST-PHONE             28726300
                   WHEN SQLCODE = +100                                  28726400
                       MOVE 'NOT FOUND'   TO ASC-CUST-NAME              28726500
                   WHEN SQLCODE = -904                                  28726600
                   WHEN SQLCODE = -913                                  28726700
                       CONTINUE                                         28726800
                   WHEN OTHER                                           28727000
                       MOVE '5400-READ-CUSTOMER'                        28727200
                                         TO DP013-PARAGRAPH             28727300
                       MOVE 'READ DATA FROM TTFCUST'                    28727400
                                         TO DP013-MESSAGE-TEXT (1)      28727500
                       MOVE SQLCA        TO DP013-SQLCA                 28727600
                       MOVE 'TTFCUST'    TO DP013-DB2-TABLE-NAME (1)    28727700
                       SET DP013-DB2-ABEND                              28727800
                           DP013-XCTL-DISPLAY-RESTART                   28727900
                                         TO TRUE                        28728000
                       PERFORM DP013-0000-PROCESS-ABEND                 28728100
               END-EVALUATE                                             28728200
           END-PERFORM.                                                 28728300
      *                                                                 28728400
           IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        28728500
               MOVE '5400-READ-CUSTOMER'                                28728600
                                         TO DP013-PARAGRAPH             28728700
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     28728800
                                         TO DP013-MESSAGE-TEXT (1)      28728900
               MOVE 'DATA FROM TTFCUST'  TO DP013-MESSAGE-TEXT (2)      28729000
               MOVE SQLCA                TO DP013-SQLCA                 28729100
               MOVE 'TTFCUST'            TO DP013-DB2-TABLE-NAME (1)    28729200
               SET DP013-DB2-ABEND                                      28729300
                   DP013-XCTL-DISPLAY-RESTART                           28729400
                                         TO TRUE                        28729500
               PERFORM DP013-0000-PROCESS-ABEND                         28729600
           END-IF.                                                      28729700
           EJECT                                                        28729800
      *----------------------------------------------------------------*28729900
      * READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *28730000
      *----------------------------------------------------------------*28740000
                                                                        28750000
       9100-READ-SEL-QUEUE.                                             28760000
           EXEC CICS                                                    28770000
               READQ TS                                                 28780000
                   QUEUE (ASC-SEL-QUEUE-NAME)                           28790000
                   INTO  (TF002-TRANSFER-SEL-REC)                       28800000
                   ITEM  (ASC-SEL-ITEM)                                 28810000
                   RESP  (PV-CICS-RESP)                                 28820000
           END-EXEC.                                                    28830000
                                                                        28840000
           IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       28850000
               CONTINUE                                                 28860000
           ELSE                                                         28870000
               SET DP013-LOGIC-ABEND                                    28880000
                   DP013-NO-ROLLBACK     TO TRUE                        28890000
               MOVE '9100-READ-SEL-QUEUE'                               28900000
                                         TO DP013-PARAGRAPH             28910000
               MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   28920000
                                         TO DP013-MESSAGE-TEXT (1)      28930000
               PERFORM DP013-0000-PROCESS-ABEND                         28940000
           END-IF.                                                      28950000
      *----------------------------------------------------------------*28960000
      * UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *28970000
      *----------------------------------------------------------------*28980000
       9200-REWRITE-SEL-QUEUE.                                          28990000
           EXEC CICS                                                    29000000
                WRITEQ TS                                               29010000
                    QUEUE  (ASC-SEL-QUEUE-NAME)                         29020000
                    FROM   (TF002-TRANSFER-SEL-REC)                     29030000
                    ITEM   (ASC-SEL-ITEM)                               29040000
                    RESP   (PV-CICS-RESP)                               29050000
                    REWRITE                                             29060000
           END-EXEC.                                                    29070000
                                                                        29080000
           IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   29090000
               SET DP013-CICS-ABEND                                     29100000
                   DP013-NO-ROLLBACK     TO TRUE                        29110000
               MOVE '9200-REWRITE-SEL-QUEUE'                            29120000
                                         TO DP013-PARAGRAPH             29130000
               MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   29140000
                                         TO DP013-MESSAGE-TEXT (1)      29150000
               PERFORM DP013-0000-PROCESS-ABEND                         29160000
           END-IF.                                                      29170000
                                                                        29180000
       EJECT                                                            29180100
      *----------------------------------------------------------------*29180200
      *    ABEND PROCESSOR MODULE                                      *29180300
      *----------------------------------------------------------------*29180400
                                                                        29180500
           COPY DPPD013.                                                29180600
