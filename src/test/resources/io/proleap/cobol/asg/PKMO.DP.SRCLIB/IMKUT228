000100******************************************************************00010062
000200 IDENTIFICATION DIVISION.                                         00020062
000300******************************************************************00030062
000400                                                                  00040062
000500 PROGRAM-ID.     IMKUT228.                                        00050062
000600 AUTHOR.         MARK A FRAMNESS.                                 00060062
000700 INSTALLATION.   KOHLS DEPARTMENT STORES.                         00070062
000800 DATE-WRITTEN.   01/07/11.                                        00080062
000900 DATE-COMPILED.                                                   00090062
001000                                                                  00100062
001100******************************************************************00110062
001600******************************************************************00160062
001700*    CHANGED: 08/20/04    BY: THOMAS DUFFY                        00170062
001800*      LOCATION DIMENSION - CHANGE LRECL FOR INPUT RECORDS        00180062
001900*               FROM 687 TO 900, AND OUTPUT RECORD FROM           00190062
002000*               688 TO 905 TO USE V3 OF LOCATION EXTRACTS.        00200062
002100*               ADDRESS OUTPUT DECREASED TO 97.                   00210062
002101*                                                                         
002110*    CHANGED 03/02/2011   BY: MARK A FRAMNESS                             
002120*      CLONED FROM IMKUT227 WHICH IN TURN WAS CLONED FROM CWKUT010        
002130*  TUPC DAILY & ONE TIME DELTA GENERATOR                                62
002140*  THIS PROGRAM GENERATES CHANGED RECORDS BY COMPARING YETERDAY'S       62
002150*  SORTED UNLOAD FILE WITH TODAY'S SORTED UNLOAD FILE                   62
002160*  IT WRITES AN INSERT FILE AND A DELETE FILE WITH UPDATE RECORDS      062
002170*  HAVING THE OLD VERSION OUTPUT TO THE DELETE FILE AND THE               
      *  NEW RECORD VERSION OUTPUT TO THE INSERT FILE                           
MAF212*                                                                         
MAF212*    CHANGED 10/11/2011   BY: MARK A FRAMNESS                             
MAF212*      CONVERT TO COMMUNICATE DELTAS WITH I/U/D INDICATOR INSTEAD OF      
MAF212*      THE TECHNIQUE ORIGINALLY SETUP WITH.                               
      ******************************************************************00220062
002300                                                                  00230062
002400******************************************************************00240062
002500 ENVIRONMENT DIVISION.                                            00250062
002600******************************************************************00260062
002700                                                                  00270062
002800 CONFIGURATION SECTION.                                           00280062
002900                                                                  00290062
003000 SOURCE-COMPUTER.        IBM-3090.                                00300062
003100 OBJECT-COMPUTER.        IBM-3090.                                00310062
003200                                                                  00320062
003300 INPUT-OUTPUT SECTION.                                            00330062
003400                                                                  00340062
003500 FILE-CONTROL.                                                    00350062
003600                                                                  00360062
003700     SELECT CW-CURRENT-FILE                                       00370062
003800         ASSIGN TO INP01.                                         00380062
003900                                                                  00390062
004000     SELECT CW-PREVIOUS-FILE                                      00400062
004100         ASSIGN TO INP02.                                         00410062
004200                                                                  00420062
004300     SELECT CW-DELTA-FILE                                         00430062
004400         ASSIGN TO OUT01.                                         00440062
004500                                                                  00450062
004900     SELECT CW-COUNT-FILE                                         00490062
005000         ASSIGN TO OUT02.                                         00500062
005100                                                                  00510062
005200******************************************************************00520062
005300 DATA DIVISION.                                                   00530062
005400******************************************************************00540062
005500                                                                  00550062
005600 FILE SECTION.                                                    00560062
005700                                                                  00570062
005800 FD  CW-CURRENT-FILE                                              00580062
005900     RECORDING MODE IS F                                          00590062
006000     LABEL RECORDS ARE STANDARD                                   00600062
006100     BLOCK CONTAINS 0 RECORDS.                                    00610062
006200 01  CW-CURRENT-RECORD                  PIC X(220).               00620064
006300                                                                  00630062
006400 FD  CW-PREVIOUS-FILE                                             00640062
006500     RECORDING MODE IS F                                          00650062
006600     LABEL RECORDS ARE STANDARD                                   00660062
006700     BLOCK CONTAINS 0 RECORDS.                                    00670062
006800 01  CW-PREVIOUS-RECORD                 PIC X(220).               00680064
006900                                                                  00690062
007000 FD  CW-DELTA-FILE                                                00700062
007100     RECORDING MODE IS F                                          00710062
007200     LABEL RECORDS ARE STANDARD                                   00720062
007300     BLOCK CONTAINS 0 RECORDS.                                    00730062
007400 01  CW-DELTA-RECORD                    PIC   X(350).             00740064
007500                                                                  00750062
008200 FD  CW-COUNT-FILE                                                00820062
008300     RECORDING MODE IS F                                          00830062
008400     LABEL RECORDS ARE STANDARD                                   00840062
008500     BLOCK CONTAINS 0 RECORDS.                                    00850062
008600 01  CW-COUNT-RECORD                   PIC   X(15).               00860062
008700                                                                  00870062
008800 WORKING-STORAGE SECTION.                                         00880062
008900 01 DEBUG-STUFF-HEAD.                                             00890062
009000     05  FILLER                         PIC   X(35)               00900062
009100     VALUE '*** WORKING-STORAGE STARTS HERE ***'.                 00910062
009200                                                                  00920062
009300 01  CURRENT-REC.                                                 00930062
009400     05  CR-CURR-KEY                    PIC   X(04).              00940064
009500     05  CR-CURR-DATA                   PIC   X(216).             00950064
009600                                                                  00960062
009700 01  PREVIOUS-REC.                                                00970062
009800     05  PR-PREV-KEY                    PIC   X(04).              00980064
009900     05  PR-PREV-DATA                   PIC   X(216).             00990064
010000                                                                  01000062
010100                                                                  01010062
010200 01  PC-PROGRAM-CONSTANTS.                                        01020062
010300     05  PC-PROGRAM-NAME           PIC X(08) VALUE 'IMKUT228'.    01030062
010400     05  PC-OPERCO                 PIC X(02) VALUE '03'.          01040062
010500                                                                  01050062
010510******************************************************************        
010520*FIELDS FOR UNPACKING NUMERIC INPUT FIELDS                       *        
010530*NUMBERS COMING IN AS COMP REQUIRE SPECIAL TREATMENT AS THEY CAN *        
010540*POTENTIALLY BE ONE DIGIT MORE THAN THEIR COBOL DEFINITION       *        
010550*IMPLIES. MOVE INTEGERS TO PF-S910-COMP PIC S9(10) COMP AND      *        
010560*UNPACK AS IF THEY WERE A TEN DIGIT FIELD. DO SIMILARLY FOR      *        
010570*SMALLINT FIELDS                                                 *        
010580******************************************************************        
010600 01  PV-NUMERIC-UNPCK-FLDS.                                       01060062
011700     05  PF-S99-UNPACK             PIC  S9(9)      VALUE ZEROS.   01170062
011701     05  PF-99-UNPACK              PIC  S9(9)      VALUE ZEROS.   01170062
011702     05  PF-S910-UNPACK            PIC  S9(10)     VALUE ZEROS.   01170062
011703     05  PF-910-UNPACK             PIC  9(10)      VALUE ZEROS.         62
011710     05  PF-S915-UNPACK            PIC  S9(15)     VALUE ZEROS.   01171064
011720     05  PF-S96-UNPACK             PIC  S9(06)     VALUE ZEROS.   01172064
011730     05  PF-S97V3-UNPACK           PIC  S9(7)V9(3) VALUE ZEROS.           
011740     05  PF-S94-UNPACK             PIC  S9(4)      VALUE ZEROS.           
011741     05  PF-S95-UNPACK             PIC  S9(5)      VALUE ZEROS.           
011750     05  PF-S94V3-UNPACK           PIC  S9(4)V9(3) VALUE ZEROS.           
011760     05  PF-S95V3-UNPACK           PIC  S9(5)V9(3) VALUE ZEROS.           
011761******************************************************************        
011762*PF-S910-COMP FOR INTEGETERS                                     *        
011763*PF-S95-COMP FOR SMALLINTS                                       *        
011764******************************************************************        
011770     05  PF-S910-COMP              PIC  S9(10) COMP VALUE ZEROS.          
011780     05  PF-S95-COMP               PIC  S9(05) COMP VALUE ZEROS.          
011800                                                                  01180062
011900 01  PA-PROGRAM-ACCUMULATORS.                                     01190062
012000     05  PA-INPUT-RECORDS          PIC  9(15)       VALUE ZERO.   01200062
012100     05  PA-INPUT-PRE-RECORDS      PIC  9(15)       VALUE ZERO.   01210062
012200     05  PA-INPUT-CUR-RECORDS      PIC  9(15)       VALUE ZERO.   01220062
012300     05  PA-OUTPUT-RECORDS         PIC  9(15)       VALUE ZERO.   01230062
012400     05  PA-INSERT-RECORDS         PIC  9(15)       VALUE ZERO.   01240062
012500     05  PA-UPDATE-RECORDS         PIC  9(15)       VALUE ZERO.   01250062
012600     05  PA-DELETE-RECORDS         PIC  9(15)       VALUE ZERO.   01260062
012700     05  PA-NO-CHANGE-RECORDS      PIC  9(15)       VALUE ZERO.   01270062
012800******************************************************************01280062
012900* OUTPUT LAYOUT FOR COUNT FILE                                    01290062
013000 01 COUNT-RECORD.                                                 01300062
013100     05 COUNT-REC-9          PIC ZZZZZZZZZZZZZZ9.                 01310062
013200******************************************************************01320062
013390******************************************************************01330062
013400* OUTPUT LAYOUT FOR DELTA FILES -- BOTH DELETE & INSERT           01340062
013500******************************************************************01350062
013600 01  DELTA-RECORD.                                                01360064
013700     10 OUT-UPC-UPC-ID                PIC  9999999999 VALUE ZEROS.01370064
013800     10 OUT-UPC-UPC-ID-SGN            PIC   X(1) VALUE '+'.       01380062
013900     10 FILLER                        PIC   X(1) VALUE '|'.       01390062
014000     10 OUT-UPC-UPC-NBR               PIC  999999999999999        01400064
014010                                                      VALUE ZEROS.01401064
014100     10 FILLER                        PIC   X(1) VALUE '+'.       01410062
014200     10 FILLER                        PIC   X(1) VALUE '|'.       01420062
014300     10 OUT-UPC-SUB-CL-MDSEAR-ID      PIC  9999999    VALUE ZEROS.01430064
014400     10 OUT-UPC-SUB-CL-MDSEAR-ID-SGN  PIC   X(1).                 01440062
014500     10 FILLER                        PIC   X(1) VALUE '|'.       01450062
014600     10 OUT-UPC-VS-ID                 PIC  9999999999 VALUE ZEROS.01460064
014700     10 OUT-UPC-VS-ID-SGN             PIC   X(1).                 01470062
014800     10 FILLER                        PIC   X(1) VALUE '|'.       01480062
014900     10 OUT-UPC-INTR-UPC-ID           PIC  9999999999 VALUE ZEROS.01490064
015000     10 OUT-UPC-INTR-UPC-ID-SGN       PIC   X(1) VALUE '+'.             62
015100     10 FILLER                        PIC   X(1) VALUE '|'.       01510062
015200     10 OUT-UPC-EFF-BEG-DTE           PIC   X(10) VALUE SPACES.   01520064
015300     10 FILLER                        PIC   X(1) VALUE '|'.       01530062
015400     10 OUT-UPC-EFF-END-DTE           PIC   X(10) VALUE SPACES.   01540064
015410     10 FILLER                        PIC   X(1) VALUE '|'.       01541063
015500     10 OUT-UPC-UPC-TYP-CDE           PIC   X(1) VALUE SPACE.     01550064
015510     10 FILLER                        PIC   X(1) VALUE '|'.       01551063
015600     10 OUT-UPC-KOHLS-SIZE-CDE        PIC  9999999999 VALUE ZEROS.01560064
015601     10 OUT-UPC-KOHLS-SIZE-CDE-SGN    PIC   X(1).                 01560163
015610     10 FILLER                        PIC   X(1) VALUE '|'.       01561063
015700     10 OUT-UPC-NRF-SIZE-IND          PIC   X(1) VALUE SPACE.     01570064
015710     10 FILLER                        PIC   X(1) VALUE '|'.       01571063
015800     10 OUT-UPC-NRF-CLOR-CDE          PIC   X(3) VALUE SPACE.     01580064
015810     10 FILLER                        PIC   X(1) VALUE '|'.       01581063
015900     10 OUT-UPC-NRF-CLOR-IND          PIC   X(1) VALUE SPACE.     01590064
015910     10 FILLER                        PIC   X(1) VALUE '|'.       01591063
016000     10 OUT-UPC-CSTM-CLOR-DESC        PIC   X(10) VALUE SPACE.    01600064
016010     10 FILLER                        PIC   X(1) VALUE '|'.       01601063
016100     10 OUT-UPC-EDI-ORD-IND           PIC   X(1) VALUE SPACE.     01610064
016110     10 FILLER                        PIC   X(1) VALUE '|'.       01611063
016200     10 OUT-UPC-PREPK-IND             PIC   X(1) VALUE SPACE.     01620064
016210     10 FILLER                        PIC   X(1) VALUE '|'.       01621063
016300     10 OUT-UPC-GP-CDE                PIC   X(3) VALUE SPACES.    01630064
016310     10 FILLER                        PIC   X(1) VALUE '|'.       01631063
016400     10 OUT-UPC-CERTD-IND             PIC   X(1) VALUE SPACE.     01640064
016410     10 FILLER                        PIC   X(1) VALUE '|'.       01641063
016500     10 OUT-UPC-CERTD-DTE             PIC   X(10) VALUE SPACES.   01650064
016510     10 FILLER                        PIC   X(1) VALUE '|'.       01651063
016600     10 OUT-UPC-RPLNMT-IND            PIC   X(1) VALUE SPACE.     01660064
016610     10 FILLER                        PIC   X(1) VALUE '|'.       01661063
016700     10 OUT-UPC-KY-ITM-IND            PIC   X(1) VALUE SPACE.     01670064
016710     10 FILLER                        PIC   X(1) VALUE '|'.       01671063
016800     10 OUT-UPC-UNT-COST-1ST-AMT      PIC   9999999.999           01680064
016801                                                 VALUE ZEROS.     01680164
016802     10 OUT-UPC-UNT-COST-1ST-AMT-SGN  PIC   X(1).                 01680263
016810     10 FILLER                        PIC   X(1) VALUE '|'.       01681063
016900     10 OUT-UPC-UPC-SRC-CDE           PIC   X(1) VALUE SPACE.     01690064
016910     10 FILLER                        PIC   X(1) VALUE '|'.       01691063
017000     10 OUT-UPC-INNR-PK-QTY           PIC   99999 VALUE ZEROS.    01700064
017001     10 OUT-UPC-INNR-PK-QTY-SGN       PIC   X(1).                 01700163
017010     10 FILLER                        PIC   X(1) VALUE '|'.       01701063
017100     10 OUT-UPC-OUTR-PK-QTY           PIC   99999 VALUE ZEROS.    01710064
017101     10 OUT-UPC-OUTR-PK-QTY-SGN       PIC   X(1).                 01710163
017110     10 FILLER                        PIC   X(1) VALUE '|'.       01711063
017200     10 OUT-UPC-SEA-SEQ-NBR           PIC   99999 VALUE ZEROS.    01720064
017201     10 OUT-UPC-SEA-SEQ-NBR-SGN       PIC   X(1) VALUE SPACE.     01720164
017210     10 FILLER                        PIC   X(1) VALUE '|'.       01721063
017300     10 OUT-UPC-CRE-BY-USR-ID         PIC   X(8) VALUE SPACES.    01730064
017310     10 FILLER                        PIC   X(1) VALUE '|'.       01731063
017400     10 OUT-UPC-LAST-UPD-BY-USR-ID    PIC   X(8) VALUE SPACES.    01740064
017410     10 FILLER                        PIC   X(1) VALUE '|'.       01741063
017500     10 OUT-UPC-LAST-UPD-TMST         PIC   X(26) VALUE SPACES.   01750064
017510     10 FILLER                        PIC   X(1) VALUE '|'.       01751063
017600     10 OUT-UPC-WD-UM-QTY             PIC   9999.999 VALUE ZEROS. 01760064
017601     10 OUT-UPC-WD-UM-QTY-SGN         PIC   X(1).                 01760163
017610     10 FILLER                        PIC   X(1) VALUE '|'.       01761063
017700     10 OUT-UPC-DPTH-UM-QTY           PIC   9999.999 VALUE ZEROS.       64
017701     10 OUT-UPC-DPTH-UM-QTY-SGN       PIC   X(1).                 01770163
017710     10 FILLER                        PIC   X(1) VALUE '|'.       01771063
017800     10 OUT-UPC-HT-UM-QTY             PIC   9999.999 VALUE ZEROS.       64
017801     10 OUT-UPC-HT-UM-QTY-SGN         PIC   X(1).                 01780163
017810     10 FILLER                        PIC   X(1) VALUE '|'.       01781063
017900     10 OUT-UPC-SIZE-UM-CDE           PIC   X(2) VALUE SPACES.    01790064
017910     10 FILLER                        PIC   X(1) VALUE '|'.       01791063
018000     10 OUT-UPC-WT-UM-QTY             PIC   99999.999 VALUE ZEROS.01800064
018001     10 OUT-UPC-WT-UM-QTY-SGN         PIC   X(1).                 01800163
018010     10 FILLER                        PIC   X(1) VALUE '|'.       01801063
018100     10 OUT-UPC-WT-UM-CDE             PIC   X(2) VALUE SPACES.    01810064
018110     10 FILLER                        PIC   X(1) VALUE '|'.       01811063
018200     10 OUT-UPC-POG-IND               PIC   X(1) VALUE SPACES.    01820064
018210     10 FILLER                        PIC   X(1) VALUE '|'.       01821063
018300     10 OUT-UPC-REGN-PRIC-IND         PIC   X(1) VALUE SPACES.    01830064
018310     10 FILLER                        PIC   X(1) VALUE '|'.       01831063
018400     10 OUT-UPC-TX-PRD-CDE-SEQ-NBR    PIC   99999 VALUE ZEROS.    01840064
018401     10 OUT-UPCTX-PRDCDE-SEQNBR-SGN   PIC   X(1) VALUE SPACE.     01840164
018410     10 FILLER                        PIC   X(1) VALUE '|'.       01841063
018500     10 OUT-UPC-CUSTFACG-CLOR-DESC    PIC   X(22) VALUE SPACES.   01850064
018510     10 FILLER                        PIC   X(1) VALUE '|'.       01851063
018600     10 OUT-UPC-INTR-UPC-DESC         PIC   X(30) VALUE SPACES.   01860064
018610     10 FILLER                        PIC   X(1) VALUE '|'.       01861063
018700     10 OUT-UPC-TRNSTN-IND            PIC   X(1) VALUE SPACE.     01870064
018710     10 FILLER                        PIC   X(1) VALUE '|'.       01871063
018800     10 OUT-UPC-PO-SHRT-CYC-IND       PIC   X(1) VALUE SPACE.     01880064
018810     10 FILLER                        PIC   X(1) VALUE '|'.       01881063
018900     10 OUT-UPC-TST-PRD-TYP-SEQ-NBR   PIC   99999 VALUE ZEROS.          62
018901     10 OUT-UPCTST-PRDTYP-SEQNBR-SGN  PIC   X(1) VALUE SPACE.     01890164
018910     10 FILLER                        PIC   X(1) VALUE '|'.       01891063
019000     10 OUT-UPC-WHSE-RPLNT-IND        PIC   X(1) VALUE SPACE.     01900064
019010     10 FILLER                        PIC   X(1) VALUE '|'.       01901063
MAF212     10 OUT-IUD-IND                   PIC   X(1).                         
MAF212        88 INSERT-RECORD                              VALUE 'I'.          
MAF212        88 UPDATE-RECORD                              VALUE 'U'.          
MAF212        88 DELETE-RECORD                              VALUE 'D'.          
MAF212     10 FILLER                        PIC   X(1) VALUE '|'.       01390062
019100******************************************************************01910062
019200* INPUT LAYOUT FOR TUPC UNLOAD FILE                               01920062
019300******************************************************************01930062
019400******************************************************************01940062
019500* COBOL DECLARATION FOR TABLE TUPC                                01950062
019600******************************************************************01960062
019700 01  IN-TUPC.                                                     01970062
019800     10 IN-UPC-UPC-ID                 PIC  S9(9) COMP.            01980062
019900     10 IN-UPC-UPC-NBR                PIC  S9(15)V COMP-3.        01990062
020000     10 IN-UPC-SUB-CL-MDSEAR-ID       PIC  S9(6)V COMP-3.         02000062
020100     10 IN-UPC-VS-ID                  PIC  S9(9) COMP.            02010062
020200     10 IN-UPC-INTR-UPC-ID            PIC  S9(9) COMP.                  62
020300     10 IN-UPC-EFF-BEG-DTE            PIC   X(10).                02030062
020310     10 IN-UPC-EFFEND-DTE-NI          PIC   X(1).                 02031063
020400     10 IN-UPC-EFF-END-DTE            PIC   X(10).                02040062
020500     10 IN-UPC-UPC-TYP-CDE            PIC   X(1).                 02050062
020600     10 IN-UPC-KOHLS-SIZE-CDE         PIC  S9(9) COMP.            02060062
020700     10 IN-UPC-NRF-SIZE-IND           PIC   X(1).                 02070062
020800     10 IN-UPC-NRF-CLOR-CDE           PIC   X(3).                 02080062
020900     10 IN-UPC-NRF-CLOR-IND           PIC   X(1).                 02090062
021000     10 IN-UPC-CSTM-CLOR-DESC         PIC   X(10).                02100062
021100     10 IN-UPC-EDI-ORD-IND            PIC   X(1).                 02110062
021200     10 IN-UPC-PREPK-IND              PIC   X(1).                 02120062
021300     10 IN-UPC-GP-CDE                 PIC   X(3).                 02130062
021400     10 IN-UPC-CERTD-IND              PIC   X(1).                 02140062
021500     10 IN-UPC-CERTD-DTE              PIC   X(10).                02150062
021600     10 IN-UPC-RPLNMT-IND             PIC   X(1).                 02160062
021700     10 IN-UPC-KY-ITM-IND             PIC   X(1).                 02170062
021800     10 IN-UPC-UNT-COST-1ST-AMT       PIC  S9(7)V9(3) COMP-3.     02180062
021900     10 IN-UPC-UPC-SRC-CDE            PIC   X(1).                 02190062
022000     10 IN-UPC-INNR-PK-QTY            PIC  S9(4) COMP.            02200062
022100     10 IN-UPC-OUTR-PK-QTY            PIC  S9(4) COMP.            02210062
022200     10 IN-UPC-SEA-SEQ-NBR            PIC  S9(4) COMP.            02220062
022300     10 IN-UPC-CRE-BY-USR-ID          PIC   X(8).                 02230062
022400     10 IN-UPC-LAST-UPD-BY-USR-ID     PIC   X(8).                 02240062
022500     10 IN-UPC-LAST-UPD-TMST          PIC   X(26).                02250062
022600     10 IN-UPC-WD-UM-QTY              PIC  S9(4)V9(3) COMP-3.     02260062
022700     10 IN-UPC-DPTH-UM-QTY            PIC  S9(4)V9(3) COMP-3.     02270062
022800     10 IN-UPC-HT-UM-QTY              PIC  S9(4)V9(3) COMP-3.     02280062
022900     10 IN-UPC-SIZE-UM-CDE            PIC   X(2).                 02290062
023000     10 IN-UPC-WT-UM-QTY              PIC  S9(5)V9(3) COMP-3.     02300062
023100     10 IN-UPC-WT-UM-CDE              PIC   X(2).                 02310062
023200     10 IN-UPC-POG-IND                PIC   X(1).                 02320062
023300     10 IN-UPC-REGN-PRIC-IND          PIC   X(1).                 02330062
023400     10 IN-UPC-TX-PRD-CDE-SEQ-NBR     PIC  S9(4) COMP.            02340062
023500     10 IN-UPC-CUSTFACG-CLOR-DESC     PIC   X(22).                02350062
023600     10 IN-UPC-INTR-UPC-DESC          PIC   X(30).                02360062
023700     10 IN-UPC-TRNSTN-IND             PIC   X(1).                 02370062
023800     10 IN-UPC-PO-SHRT-CYC-IND        PIC   X(1).                 02380062
023900     10 IN-UPC-TST-PRD-TYP-SEQ-NBR    PIC  S9(4) COMP.            02390062
024000     10 IN-UPC-WHSE-RPLNT-IND         PIC   X(1).                 02400062
024400                                                                  02440062
031800                                                                  03180062
048800                                                                  04880062
048900*****************************************************             04890062
049000                                                                  04900062
049100 01 DEBUG-STUFF-HEAD.                                             04910062
049200     05  FILLER                         PIC   X(35)               04920062
049300     VALUE '*** WORKING-STORAGE ENDS   HERE ***'.                 04930062
049400                                                                  04940062
049500******************************************************************04950062
049600 PROCEDURE DIVISION.                                              04960062
049700******************************************************************04970062
049800                                                                  04980062
049900 0000-MAINLINE.                                                   04990062
050000                                                                  05000062
050100     PERFORM 1000-INITIALIZE.                                     05010062
050200                                                                  05020062
050300     PERFORM 2000-MAIN-ROUTINE                                    05030062
050400         UNTIL CR-CURR-KEY = HIGH-VALUES                          05040062
050500               AND                                                05050062
050600               PR-PREV-KEY = HIGH-VALUES.                         05060062
050700                                                                  05070062
050800     PERFORM 9000-EOJ-ROUTINE.                                    05080062
050900                                                                  05090062
051000     GOBACK.                                                      05100062
051100                                                                  05110062
051200******************************************************************05120062
051300*  INITIALIZE                                                     05130062
051400******************************************************************05140062
051500                                                                  05150062
051600 1000-INITIALIZE.                                                 05160062
051700                                                                  05170062
051800     OPEN INPUT  CW-CURRENT-FILE                                  05180062
051900                 CW-PREVIOUS-FILE                                 05190062
052000          OUTPUT CW-DELTA-FILE.                                   05200062
052200                                                                  05220062
052300     DISPLAY '   '.                                               05230062
052400     DISPLAY '** PROGRAM: ' PC-PROGRAM-NAME.                      05240062
052500                                                                  05250062
052600     PERFORM 8000-READ-CURRENT.                                   05260062
052700     PERFORM 8100-READ-PREVIOUS.                                  05270062
052800                                                                  05280062
052900                                                                  05290062
053000******************************************************************05300062
053100* MAIN PROCESSING.                                                05310062
053200******************************************************************05320062
053300 2000-MAIN-ROUTINE.                                               05330062
053400                                                                  05340062
053500     IF CR-CURR-KEY  =  PR-PREV-KEY                               05350062
053600        PERFORM 2100-CHECK-EQUALITY                               05360062
053700     ELSE                                                         05370062
053800         IF CR-CURR-KEY  <  PR-PREV-KEY                           05380062
053900*            INSERT RECORD                                        05390062
054000*            WRITE RECORD FROM NEW FILE                           05400062
054100             INITIALIZE            IN-TUPC                        05410062
054200             MOVE CURRENT-REC   TO IN-TUPC                        05420062
054300             PERFORM 3000-PREPARE-OUTPUT                          05430062
MAF212             MOVE 'I' TO OUT-IUD-IND                                      
MAF212             PERFORM 7100-WRITE-DELTA                             05440062
054500             ADD +1             TO PA-INSERT-RECORDS              05450062
054600             PERFORM 8000-READ-CURRENT                            05460062
054700         ELSE                                                     05470062
054800*            DELETE RECORD                                        05480062
054900*            FORMAT & WRITE PREV RECORD TO DELETE FILE            05490062
055000             INITIALIZE            IN-TUPC                        05500062
055100             MOVE PREVIOUS-REC  TO IN-TUPC                        05510062
055200             PERFORM 3000-PREPARE-OUTPUT                          05520062
MAF212             MOVE 'D' TO OUT-IUD-IND                                      
MAF212             PERFORM 7100-WRITE-DELTA                             05530062
055400             ADD +1             TO PA-DELETE-RECORDS              05540062
055500             PERFORM 8100-READ-PREVIOUS                           05550062
055600         END-IF                                                   05560062
055700     END-IF.                                                      05570062
055800                                                                  05580062
055900******************************************************************05590062
056000*  CHECKS RECORD FOR EQUALITY                                     05600062
056100*  IF DATA IS NOT EQUAL, THEN RECORD IS AN UPDATE                 05610062
056200******************************************************************05620062
056300 2100-CHECK-EQUALITY.                                             05630062
056400     IF CR-CURR-DATA  =  PR-PREV-DATA                             05640062
056500*       RECORDS IDENTICAL BYPASS                                  05650062
056600         ADD +1                 TO PA-NO-CHANGE-RECORDS           05660062
056700         PERFORM 8000-READ-CURRENT                                05670062
056800         PERFORM 8100-READ-PREVIOUS                               05680062
056900     ELSE                                                         05690062
057000*        UPDATE RECORD                                            05700062
058100         INITIALIZE            IN-TUPC                            05810062
058200         MOVE CURRENT-REC   TO IN-TUPC                            05820062
058300         PERFORM 3000-PREPARE-OUTPUT                              05830062
MAF212         MOVE 'U' TO OUT-IUD-IND                                          
MAF212         PERFORM 7100-WRITE-DELTA                                 05840062
058600         ADD +1              TO PA-UPDATE-RECORDS                 05860062
058700                                                                  05870062
058800*        READ IN NEXT CURRENT & NEXT PREVIOUS RECORDS             05880062
058900         PERFORM 8000-READ-CURRENT                                05890062
059000         PERFORM 8100-READ-PREVIOUS                               05900062
059100     END-IF.                                                      05910062
059200                                                                  05920062
059300                                                                  05930062
059400******************************************************************05940062
059500*  UNPACK NUMERICS AND MOVE ALL FIELDS TO OUTPUT RECORD           05950062
059600******************************************************************05960062
059700 3000-PREPARE-OUTPUT.                                             05970062
059800*REQUIRES DELTA-RECORD RECORD TO BE LOADED                        05980064
059900*PROMISES TO UNPACK NUMERICS,  AND PREPARE SIGNS                  05990062
060000* FOR WRITING TO DELETE & INSERT DATASETS                         06000062
060100                                                                  06010062
060200* FIRST TRANSFER TEXT FIELDS TO OUTPUT RECORD                     06020062
060300* SECOND UNPACK NUMERICS AND IF APPROPRIATE CHECK SIGN & SET      06030062
060400*TEXT/CHAR FIELDS                                                 06040062
060500************************************************************      06050062
060600                                                                  06060062
060700     INITIALIZE DELTA-RECORD                                      06070064
060701                                                                  06070164
060710*    MOVE IN-UPC-UPC-ID              TO PF-S99-UNPACK             06071064
060711     MOVE IN-UPC-UPC-ID              TO PF-S910-COMP              06071064
060712     MOVE PF-S910-COMP               TO PF-910-UNPACK                     
060713     MOVE PF-910-UNPACK              TO OUT-UPC-UPC-ID            06071164
060714     MOVE '+'                        TO OUT-UPC-UPC-ID-SGN                
060715                                                                  06071264
060720     MOVE IN-UPC-UPC-NBR             TO PF-S915-UNPACK            06072064
060721     MOVE PF-S915-UNPACK             TO OUT-UPC-UPC-NBR           06072164
060722                                                                  06072264
060730     MOVE IN-UPC-SUB-CL-MDSEAR-ID    TO PF-S96-UNPACK             06073064
060731     MOVE PF-S96-UNPACK              TO OUT-UPC-SUB-CL-MDSEAR-ID  06073164
060732     IF PF-S96-UNPACK > 0 OR = 0                                  06073264
060733        MOVE '+'                     TO                           06073364
060734                                 OUT-UPC-SUB-CL-MDSEAR-ID-SGN     06073464
060735     ELSE                                                         06073564
060736        MOVE '-'                     TO                           06073664
060737                                 OUT-UPC-SUB-CL-MDSEAR-ID-SGN     06073764
060738     END-IF                                                       06073864
060739                                                                  06073964
060740     MOVE IN-UPC-VS-ID               TO PF-S910-COMP              06074064
060741     MOVE PF-S910-COMP               TO PF-910-UNPACK                   64
060742     MOVE PF-910-UNPACK              TO OUT-UPC-VS-ID             06074164
060744     MOVE '+'                        TO OUT-UPC-VS-ID-SGN         06074364
060748                                                                  06074764
060753     MOVE IN-UPC-INTR-UPC-ID         TO PF-S910-COMP                    64
060755     MOVE PF-S910-COMP               TO PF-910-UNPACK                     
060761     MOVE PF-910-UNPACK             TO OUT-UPC-INTR-UPC-ID              64
060762     MOVE '+'                       TO OUT-UPC-INTR-UPC-ID-SGN            
060763                                                                  06075764
060764     MOVE IN-UPC-EFF-BEG-DTE         TO OUT-UPC-EFF-BEG-DTE       06076064
060765                                                                  06076164
060770     IF IN-UPC-EFFEND-DTE-NI = HIGH-VALUES                        06077064
060771*       VALUE IS NULL                                             06077164
060772        MOVE SPACES                  TO OUT-UPC-EFF-END-DTE       06077264
060773     ELSE                                                         06077364
060774*       VALUE IS NOT NULL                                         06077465
060775        MOVE IN-UPC-EFF-END-DTE      TO OUT-UPC-EFF-END-DTE       06077564
060776     END-IF                                                       06077664
060777                                                                  06077764
060790     MOVE IN-UPC-UPC-TYP-CDE         TO OUT-UPC-UPC-TYP-CDE       06079064
060791                                                                          
060792     MOVE IN-UPC-KOHLS-SIZE-CDE      TO PF-S910-COMP              06079165
060793     MOVE PF-S910-COMP               TO PF-910-UNPACK             06079265
060794     MOVE PF-910-UNPACK              TO OUT-UPC-KOHLS-SIZE-CDE    06079265
060796     MOVE '+'                        TO OUT-UPC-KOHLS-SIZE-CDE-SGN      65
060800                                                                  06079865
060801     MOVE IN-UPC-NRF-SIZE-IND        TO OUT-UPC-NRF-SIZE-IND      06079965
060802     MOVE IN-UPC-NRF-CLOR-CDE        TO OUT-UPC-NRF-CLOR-CDE      06080065
060803     MOVE IN-UPC-NRF-CLOR-IND        TO OUT-UPC-NRF-CLOR-IND      06080165
060804     MOVE IN-UPC-CSTM-CLOR-DESC      TO OUT-UPC-CSTM-CLOR-DESC    06080265
060805     MOVE IN-UPC-EDI-ORD-IND         TO OUT-UPC-EDI-ORD-IND       06080365
060806     MOVE IN-UPC-PREPK-IND           TO OUT-UPC-PREPK-IND         06080465
060807     MOVE IN-UPC-GP-CDE              TO OUT-UPC-GP-CDE            06080565
060808     MOVE IN-UPC-CERTD-IND           TO OUT-UPC-CERTD-IND         06080665
060809     MOVE IN-UPC-CERTD-DTE           TO OUT-UPC-CERTD-DTE         06080765
060810     MOVE IN-UPC-RPLNMT-IND          TO OUT-UPC-RPLNMT-IND        06081065
060820     MOVE IN-UPC-KY-ITM-IND          TO OUT-UPC-KY-ITM-IND        06082065
060821                                                                          
060830     MOVE IN-UPC-UNT-COST-1ST-AMT    TO PF-S97V3-UNPACK           06083064
060840     MOVE PF-S97V3-UNPACK            TO                                   
060850                                   OUT-UPC-UNT-COST-1ST-AMT               
060860     IF PF-S97V3-UNPACK > 0 OR = 0                                        
060870        MOVE '+'                     TO                                   
060880                                   OUT-UPC-UNT-COST-1ST-AMT-SGN           
060890     ELSE                                                                 
060900        MOVE '-'                     TO                                   
061000                                   OUT-UPC-UNT-COST-1ST-AMT-SGN           
061001     END-IF                                                               
061002                                                                          
061003     MOVE IN-UPC-UPC-SRC-CDE         TO OUT-UPC-UPC-SRC-CDE       06084065
061004                                                                          
061006     MOVE IN-UPC-INNR-PK-QTY         TO PF-S95-COMP                       
061007     MOVE PF-S95-COMP                TO PF-S95-UNPACK                     
061008     MOVE PF-S95-UNPACK              TO OUT-UPC-INNR-PK-QTY               
061010     MOVE '+'                        TO OUT-UPC-INNR-PK-QTY-SGN           
061014                                                                          
061015     MOVE IN-UPC-OUTR-PK-QTY         TO PF-S95-COMP                     64
061016     MOVE PF-S95-COMP                TO PF-S95-UNPACK                     
061017     MOVE PF-S95-UNPACK              TO OUT-UPC-OUTR-PK-QTY               
061019     MOVE '+'                        TO OUT-UPC-OUTR-PK-QTY-SGN           
061023                                                                          
061024     MOVE IN-UPC-SEA-SEQ-NBR         TO PF-S95-COMP               06087064
061025     MOVE PF-S95-COMP                TO PF-S95-UNPACK                     
061026     MOVE PF-S95-UNPACK              TO OUT-UPC-SEA-SEQ-NBR               
061028     MOVE '+'                        TO OUT-UPC-SEA-SEQ-NBR-SGN           
061032                                                                          
061033     MOVE IN-UPC-CRE-BY-USR-ID       TO OUT-UPC-CRE-BY-USR-ID     06088065
061034     MOVE IN-UPC-LAST-UPD-BY-USR-ID  TO OUT-UPC-LAST-UPD-BY-USR-ID06089065
061035     MOVE IN-UPC-LAST-UPD-TMST       TO OUT-UPC-LAST-UPD-TMST     06089165
061036                                                                          
061037     MOVE IN-UPC-WD-UM-QTY           TO PF-S94V3-UNPACK           06089264
061038     MOVE PF-S94V3-UNPACK            TO OUT-UPC-WD-UM-QTY                 
061039     IF PF-S94V3-UNPACK > 0 OR = 0                                        
061040        MOVE '+'                     TO OUT-UPC-WD-UM-QTY-SGN             
061041     ELSE                                                                 
061042        MOVE '-'                     TO OUT-UPC-WD-UM-QTY-SGN             
061043     END-IF                                                               
061044                                                                          
061045     MOVE IN-UPC-DPTH-UM-QTY         TO PF-S94V3-UNPACK                 64
061046     MOVE PF-S94V3-UNPACK            TO OUT-UPC-DPTH-UM-QTY               
061047     IF PF-S94V3-UNPACK > 0 OR = 0                                        
061048        MOVE '+'                     TO OUT-UPC-DPTH-UM-QTY-SGN           
061049     ELSE                                                                 
061050        MOVE '-'                     TO OUT-UPC-DPTH-UM-QTY-SGN           
061051     END-IF                                                               
061052                                                                          
061053     MOVE IN-UPC-HT-UM-QTY           TO PF-S94V3-UNPACK                 64
061054     MOVE PF-S94V3-UNPACK            TO OUT-UPC-HT-UM-QTY                 
061055     IF PF-S94V3-UNPACK > 0 OR = 0                                        
061056        MOVE '+'                     TO OUT-UPC-HT-UM-QTY-SGN             
061057     ELSE                                                                 
061058        MOVE '-'                     TO OUT-UPC-HT-UM-QTY-SGN             
061059     END-IF                                                               
061060                                                                          
061061     MOVE IN-UPC-SIZE-UM-CDE         TO OUT-UPC-SIZE-UM-CDE       06089565
061062                                                                          
061063     MOVE IN-UPC-WT-UM-QTY           TO PF-S95V3-UNPACK           06089664
061064     MOVE PF-S95V3-UNPACK            TO OUT-UPC-WT-UM-QTY                 
061065     IF PF-S95V3-UNPACK > 0 OR = 0                                        
061066        MOVE '+'                     TO OUT-UPC-WT-UM-QTY-SGN             
061067     ELSE                                                                 
061068        MOVE '-'                     TO OUT-UPC-WT-UM-QTY-SGN             
061069     END-IF                                                               
061070                                                                          
061071     MOVE IN-UPC-WT-UM-CDE           TO OUT-UPC-WT-UM-CDE         06089765
061072     MOVE IN-UPC-POG-IND             TO OUT-UPC-POG-IND           06089865
061073     MOVE IN-UPC-REGN-PRIC-IND       TO OUT-UPC-REGN-PRIC-IND     06089965
061074                                                                          
061075     MOVE IN-UPC-TX-PRD-CDE-SEQ-NBR  TO PF-S95-COMP               06090064
061076     MOVE PF-S95-COMP                TO PF-S95-UNPACK                     
061078     MOVE PF-S95-UNPACK              TO                                   
061079                               OUT-UPC-TX-PRD-CDE-SEQ-NBR                 
061081     MOVE '+'                     TO                                      
061082                               OUT-UPCTX-PRDCDE-SEQNBR-SGN                
061087                                                                          
061088     MOVE IN-UPC-CUSTFACG-CLOR-DESC  TO OUT-UPC-CUSTFACG-CLOR-DESC      65
061089     MOVE IN-UPC-INTR-UPC-DESC       TO OUT-UPC-INTR-UPC-DESC     06092065
061090     MOVE IN-UPC-TRNSTN-IND          TO OUT-UPC-TRNSTN-IND        06093065
061091     MOVE IN-UPC-PO-SHRT-CYC-IND     TO OUT-UPC-PO-SHRT-CYC-IND   06094065
061092                                                                          
061093     MOVE IN-UPC-TST-PRD-TYP-SEQ-NBR TO PF-S95-COMP                     64
061094     MOVE PF-S95-COMP                TO PF-S95-UNPACK                     
061096     MOVE PF-S95-UNPACK              TO                                   
061097                                     OUT-UPC-TST-PRD-TYP-SEQ-NBR          
061099     MOVE '+'                     TO                                      
061100                                     OUT-UPCTST-PRDTYP-SEQNBR-SGN         
061110                                                                          
061200     MOVE IN-UPC-WHSE-RPLNT-IND      TO OUT-UPC-WHSE-RPLNT-IND    06096065
092716                                                                  09271662
098400************************************************************      09840062
098500     .                                                            09850062
098600******************************************************************09860062
098700*  WRITE THE INSERT RECORD                                        09870062
098800******************************************************************09880062
MAF212 7100-WRITE-DELTA.                                                09890062
MAF212     WRITE  CW-DELTA-RECORD  FROM DELTA-RECORD.                   09900064
MAF212     ADD +1 TO PA-OUTPUT-RECORDS.                                 09910062
MAF212                                                                  09920062
100000******************************************************************10000062
100100*  WRITE THE COUNT FILE                                           10010062
100200******************************************************************10020062
100300 7300-WRITE-COUNT.                                                10030062
100400     WRITE  CW-COUNT-RECORD FROM COUNT-RECORD.                    10040062
100500                                                                  10050062
100600******************************************************************10060062
100700*  READ THE CURRENT FILE.                                        *10070062
100800******************************************************************10080062
100900 8000-READ-CURRENT.                                               10090062
101000     READ CW-CURRENT-FILE                                         10100062
101100         INTO CURRENT-REC                                         10110062
101200         AT END                                                   10120062
101300             MOVE HIGH-VALUES  TO  CR-CURR-KEY                    10130062
101400         NOT AT END                                               10140062
101500             ADD 1           TO  PA-INPUT-RECORDS                 10150062
101600             ADD 1           TO  PA-INPUT-CUR-RECORDS             10160062
101700     END-READ.                                                    10170062
101800                                                                  10180062
101900******************************************************************10190062
102000*  READ THE PREVIOUS FILE.                                        10200062
102100******************************************************************10210062
102200 8100-READ-PREVIOUS.                                              10220062
102300     READ CW-PREVIOUS-FILE                                        10230062
102400         INTO PREVIOUS-REC                                        10240062
102500         AT END                                                   10250062
102600             MOVE HIGH-VALUES  TO  PR-PREV-KEY                    10260062
102700         NOT AT END                                               10270062
102800             ADD 1           TO  PA-INPUT-RECORDS                 10280062
102900             ADD 1           TO  PA-INPUT-PRE-RECORDS             10290062
103000     END-READ.                                                    10300062
103100                                                                  10310062
103200******************************************************************10320062
103300 9000-EOJ-ROUTINE.                                                10330062
                                                                        10340062
MAF212     DISPLAY '   '.                                               10350062
MAF212     DISPLAY '** RECORDS COUNTS FOR PROGRAM: ' PC-PROGRAM-NAME.   10360062
MAF212     DISPLAY '   '.                                               10370062
MAF212                                                                  10380062
MAF212     DISPLAY 'INPUT SECTION'                                      10340062
MAF212     DISPLAY 'INPUT PREVIOUS RECS  : ' PA-INPUT-PRE-RECORDS.      10340062
MAF212     DISPLAY 'INPUT CURRENT RECS   : ' PA-INPUT-CUR-RECORDS.      10340062
MAF212     DISPLAY '========================================'           10340062
MAF212     DISPLAY 'TOTAL INPUT RECS READ: ' PA-INPUT-RECORDS.          10340062
MAF212     DISPLAY '   '.                                               10420062
MAF212     DISPLAY 'OUTPUT SECTION'                                     10340062
MAF212     DISPLAY 'DELETE RECS WRITTEN  : ' PA-DELETE-RECORDS.         10340062
MAF212     DISPLAY 'INSERT RECS WRITTEN  : ' PA-INSERT-RECORDS.         10340062
MAF212     DISPLAY 'UPDATE RECS WRITTEN  : ' PA-UPDATE-RECORDS.         10340062
MAF212     DISPLAY '========================================'                   
MAF212     DISPLAY 'TOTAL OUTPUT RECORDS : ' PA-OUTPUT-RECORDS.               62
MAF212     DISPLAY '   '.                                                     62
MAF212     DISPLAY 'OTHER SECTION'                                              
MAF212     DISPLAY 'MATCHING RECORDS     : ' PA-NO-CHANGE-RECORDS.            62
MAF212     DISPLAY '   '.                                               10480062
                                                                        10490062
105000     OPEN OUTPUT CW-COUNT-FILE.                                   10500062
105100     MOVE PA-OUTPUT-RECORDS TO COUNT-REC-9.                       10510062
105200     PERFORM 7300-WRITE-COUNT.                                    10520062
105300     CLOSE CW-CURRENT-FILE                                        10530062
105400           CW-PREVIOUS-FILE                                       10540062
105500           CW-DELTA-FILE                                          10550062
105700           CW-COUNT-FILE.                                         10570062
105800******************************************************************10580062
105900******************************************************************10590062
