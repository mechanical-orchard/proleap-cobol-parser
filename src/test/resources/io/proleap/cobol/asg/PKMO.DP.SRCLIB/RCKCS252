000100 IDENTIFICATION DIVISION.                                         00010039
000200 PROGRAM-ID.    RCKCS252.                                         00020039
000300 AUTHOR.        ANNE RECKNAGEL.                                   00030039
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040039
000500 DATE-WRITTEN.  05-08-94                                          00050039
000600 DATE-COMPILED.                                                   00060039
000700******************************************************************00070039
000800*    E252 - PACK SLIP LINE BY STYLE ADD (FREE-FORM)               00080039
000900*                                                                 00090039
001000*    DISPLAYS AN EMPTY SCREEN IN WHICH THE USER CAN ENTER STYLES  00100039
001100*    AND QUANTITIES.  THE PROGRAM WILL MATCH THEM TO THE PURCHASE 00110039
001200*    ORDER LINE AND DISPLAY WHICH LINE NUMBER, IT'S COST AND THE  00120039
001300*    DESCRIPTION.  THE USER CAN SELECT LINES AND ADD THEM TO THE  00130039
001400*    PACK SLIP                                                    00140039
001500*                                                                 00150039
001600*    THE DP030-OVERRIDE-APPL-ERROR SWITCH IS SET TO TRUE WHEN     00160039
001700*        ENTERING THE PROGRAM IN ORDER TO GIVE CONTROL BACK TO THE00170039
001800*        LIST WHEN A NEXT-ACT-APPL-ERROR IS SENT BACK FROM THE    00180039
001900*        UPDATE.  THE DP030-RC-APPL-ERROR IS CHECKED TO DETERMINE 00190039
002000*        IF A NEXT-ACT-APPL-ERROR IS BEING RETURNED TO THE LIST.  00200039
002100*                                                                 00210039
002200******************************************************************00220039
002210*---------------------------------------------------------------* 00221044
002220* CHANGED 11/10/2021    BY JIM HUNTER      WR: CHG0263784         00222045
002230* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00223045
002240* MAKING THE CALL DYNAMIC VS STATIC.                              00224045
002250*---------------------------------------------------------------* 00225045
002300 ENVIRONMENT DIVISION.                                            00230039
002400 DATA DIVISION.                                                   00240039
002500 WORKING-STORAGE SECTION.                                         00250039
002600                                                                  00260039
002700 01  PC-PROGRAM-CONSTANTS.                                        00270039
002800     05  PC-CURRENT-MAP-NAME          PIC X(8)  VALUE 'RC252A  '. 00280039
002900     05  PC-CURRENT-MAPSET-NAME       PIC X(8)  VALUE 'RCKM252 '. 00290039
003000     05  PC-CURRENT-PROGRAM-NAME      PIC X(8)  VALUE 'RCKCS252'. 00300039
003100     05  PC-RCKUP006                  PIC X(08) VALUE 'RCKUP006'. 00310045
003200     05  PC-LIST-QUEUE-SEQ            PIC 9     VALUE 1.          00320039
003300     05  PC-SEL-QUEUE-SEQ             PIC 9     VALUE 2.          00330039
003400     05  PC-PACK-SLIP-SUMMARY         PIC 9     VALUE 1.          00340039
003500     05  PC-PACK-SLIP-HEADER          PIC 9     VALUE 2.          00350039
003600     05  PC-ITEMS-PER-PANEL           PIC S9(4) VALUE +12         00360039
003700                                                COMP SYNC.        00370039
003800     05  PC-ITEMS-IN-ARRAY            PIC S9(4) VALUE +24         00380039
003900                                                COMP SYNC.        00390039
004000     05  PC-MAX-BLOCKS-IN-ARRAY       PIC S9(4) VALUE +2          00400039
004100                                                COMP SYNC.        00410039
004200     05  PC-MAX-ITEMS                 PIC S9(4) VALUE +999        00420039
004300                                                COMP SYNC.        00430039
004400     05  PC-MAX-RETRIES               PIC S9(4) VALUE +3          00440039
004500                                                COMP SYNC.        00450039
004600     05  PC-01                        PIC X(02) VALUE '01'.       00460039
004700     05  PC-AC                        PIC X(02) VALUE 'AC'.       00470039
004800     05  PC-CA                        PIC X(02) VALUE 'CA'.       00480039
004900     05  PC-CB                        PIC X(02) VALUE 'CB'.       00490039
005000     05  PC-CM                        PIC X(02) VALUE 'CM'.       00500039
005100     05  PC-IN                        PIC X(02) VALUE 'IN'.       00510039
005200     05  PC-IP                        PIC X(02) VALUE 'IP'.       00520039
005300     05  PC-VE                        PIC X(02) VALUE 'VE'.       00530039
005400     05  PC-RV                        PIC X(02) VALUE 'RV'.       00540039
005500     05  PC-ACTIVE                    PIC X(01) VALUE 'A'.        00550039
005600     05  PC-A                         PIC X(01) VALUE 'A'.        00560041
005700     05  PC-INACTIVE                  PIC X(01) VALUE 'I'.        00570039
005800     05  PC-STYL-CLR-SIZE             PIC X(01) VALUE '1'.        00580039
005900     05  PC-STYL-SIZE-CLR             PIC X(01) VALUE '2'.        00590039
006000     05  PC-NOT-FOUND-MSG             PIC X(25)                   00600039
006100                                      VALUE 'NOT FOUND'.          00610039
006200     05  PC-MULTIPLE-LINE-MSG         PIC X(25)                   00620039
006300                                      VALUE 'MULTIPLE LINES'.     00630039
006400     05  PC-DUPLICATE-MSG             PIC X(25)                   00640039
006500                                      VALUE 'DUPLICATE STYLE'.    00650039
006600     05  PC-REC-ALREADY-EXISTS        PIC X(25)                   00660039
006700                           VALUE 'RECORD ALREADY EXISTS'.         00670039
006800     05  PC-LINE-IN-RV-STATUS         PIC X(25)                   00680039
006900                                      VALUE 'LINE IN RV STATUS'.  00690039
007000                                                                  00700039
007100     05  PC-TSYMSG-NUMBERS.                                       00710039
007200         10  PC-TSYMSG-00005          PIC 9(5)  VALUE 00005.      00720039
007300*            INVALID VALUE                                        00730039
007400         10  PC-TSYMSG-00007          PIC 9(5)  VALUE 00007.      00740039
007500*            REQUIRED ENTRY                                       00750039
007600         10  PC-TSYMSG-00008          PIC 9(5)  VALUE 00008.      00760039
007700*            MUST BE NUMERIC                                      00770039
007800         10  PC-TSYMSG-00034          PIC 9(5)  VALUE 00034.      00780039
007900*            ADD(S) SUCCESSFUL                                    00790039
008000         10  PC-TSYMSG-00050          PIC 9(5)  VALUE 00050.      00800039
008100*            NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED  00810039
008200         10  PC-TSYMSG-00051          PIC 9(5)  VALUE 00051.      00820039
008300*            NO END OF RANGE HAS BEEN SPECIFIED                   00830039
008400         10  PC-TSYMSG-00052          PIC 9(5)  VALUE 00052.      00840039
008500*            END OF RANGE PRECEDES START OF RANGE                 00850039
008600         10  PC-TSYMSG-00053          PIC 9(5)  VALUE 00053.      00860039
008700*            NO START OF RANGE HAS BEEN SPECIFIED                 00870039
008800         10  PC-TSYMSG-00054          PIC 9(5)  VALUE 00054.      00880039
008900*            ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED   00890039
009000         10  PC-TSYMSG-00055          PIC 9(5)  VALUE 00055.      00900039
009100*            ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED     00910039
009200         10  PC-TSYMSG-00057          PIC 9(5)  VALUE 00057.      00920039
009300*            A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION       00930039
009400         10  PC-TSYMSG-00069          PIC 9(5)  VALUE 00069.      00940039
009500*            TOP OF LIST                                          00950039
009600         10  PC-TSYMSG-00070          PIC 9(5)  VALUE 00070.      00960039
009700*            BOTTOM OF LIST                                       00970039
009800         10  PC-TSYMSG-00101          PIC 9(5)  VALUE 00101.      00980039
009900*            VALUE MUST BE GREATER THAN ZERO AND < 1,000,000      00990039
010000         10  PC-TSYMSG-00117          PIC 9(05)  VALUE 00117.     01000039
010100*            CANNOT ADD - RECORD ALREADY EXISTS                   01010039
010200         10  PC-TSYMSG-00148          PIC 9(5)  VALUE 00148.      01020039
010300*            DATA DOES NOT EXIST                                  01030039
010400         10  PC-TSYMSG-00168          PIC 9(5)  VALUE 00168.      01040039
010500*            INVALID PURCHASE ORDER STATUS FOR THIS FUNCTION      01050039
010600         10  PC-TSYMSG-00279          PIC 9(5)  VALUE 00279.      01060039
010700*            MORE ITEMS TO DISPLAY                                01070039
010800         10  PC-TSYMSG-00726          PIC 9(5)  VALUE 00726.      01080039
010900*            PURCHASE ORDER NOT FOUND                             01090039
011000         10  PC-TSYMSG-00906          PIC 9(5)  VALUE 00906.      01100039
011100*            DUPLICATE STYLE HAS BEEN ENTERED FOR THIS PO         01110039
011200         10  PC-TSYMSG-02762          PIC 9(5)  VALUE 02762.      01120039
011300*            PACK IS NOT CONFIRMED                                01130039
011400                                                                  01140039
011500 01  PS-PROGRAM-SWITCHES.                                         01150039
011600     05  PS-ERROR-SW                  PIC  X    VALUE 'N'.        01160039
011700         88  PS-NO-ERROR                        VALUE 'N'.        01170039
011800         88  PS-ERROR                           VALUE 'Y'.        01180039
011900     05  PS-ORIG-ASN-PKSLIP-SW        PIC  X    VALUE 'N'.        01190041
012000         88  PS-ORIG-ASN-PKSLIP-YES             VALUE 'Y'.        01200041
012100         88  PS-ORIG-ASN-PKSLIP-NO              VALUE 'N'.        01210041
012200     05  PS-SEARCH-STYLE-SW           PIC  X    VALUE 'N'.        01220039
012300         88  PS-INVALID-SEARCH-STYLE            VALUE 'N'.        01230039
012400         88  PS-VALID-SEARCH-STYLE              VALUE 'Y'.        01240039
012500     05  PS-PKITEM-SW                 PIC  X    VALUE 'N'.        01250039
012600         88  PS-PKITEM-NOT-FOUND                VALUE 'N'.        01260039
012700         88  PS-PKITEM-FOUND                    VALUE 'Y'.        01270039
012800     05  PS-PLAN-FOUND-SW             PIC  X    VALUE 'N'.        01280039
012900         88  PS-PLAN-NOT-FOUND                  VALUE 'N'.        01290039
013000         88  PS-PLAN-FOUND                      VALUE 'Y'.        01300039
013100     05  PS-PROCESS-PO-SW             PIC  X    VALUE 'Y'.        01310039
013200         88  PS-PROCESS-PO                      VALUE 'Y'.        01320039
013300         88  PS-DONT-PROCESS-PO                 VALUE 'N'.        01330039
013400     05  PS-STYLE-NUMBER-CHANGED-SW   PIC  X    VALUE 'N'.        01340039
013500         88  PS-STYLE-NUMBER-CHANGED            VALUE 'Y'.        01350039
013600     05  PS-FOUND-UNUSED-BLOCK-SW     PIC  X    VALUE 'N'.        01360039
013700         88  PS-FOUND-UNUSED-BLOCK              VALUE 'Y'.        01370039
013800                                                                  01380039
013900 01  DK-DB2-KEYS.                                                 01390039
014000     05  DK-PO-NBR                    PIC S9(9) COMP VALUE +0.    01400039
014100     05  DK-STR-NBR-B                 PIC S9(4) COMP VALUE +0.    01410039
014200     05  DK-STR-NBR-E                 PIC S9(4) COMP VALUE +9999. 01420039
014300     05  DK-VEND-STYL-NAME            PIC X(20).                  01430039
014400                                                                  01440039
014500 01  PV-PROGRAM-VARIABLES.                                        01450039
014600     05  PV-MAX-LIST-ITEM-NBR         PIC S9(4) VALUE ZERO        01460039
014700                                                COMP SYNC.        01470039
014800     05  PV-SUB                       PIC S9(4) VALUE ZERO        01480039
014900                                                COMP SYNC.        01490039
015000     05  PV-SUB-ADJUST                PIC S9(4) VALUE ZERO        01500039
015100                                                COMP SYNC.        01510039
015200     05  PV-ITEM-SUB                  PIC S9(4) VALUE ZERO        01520039
015300                                                COMP SYNC.        01530039
015400     05  PV-SAVE-BLOCK-SUB            PIC S9(4) VALUE ZERO        01540039
015500                                                COMP SYNC.        01550039
015600     05  PV-SAVE-ITEM-SUB             PIC S9(4) VALUE ZERO        01560039
015700                                                COMP SYNC.        01570039
015800     05  PV-REMAINDER                 PIC S9(4) VALUE ZERO        01580039
015900                                                COMP SYNC.        01590039
016000     05  PV-READ-COUNT                PIC S9(9) VALUE ZERO        01600039
016100                                                COMP-3.           01610039
016200     05  PV-ITEMS-PROCESSED           PIC S9(9) VALUE ZERO        01620039
016300                                                COMP-3.           01630039
016400     05  PV-HOLD-SELECTED-ITEMS       PIC S9(9) VALUE ZERO        01640039
016500                                                COMP-3.           01650039
016600     05  PV-ITEM-IN-USE               PIC S9(9) VALUE ZERO        01660039
016700                                                COMP-3.           01670039
016800     05  PV-TOP-ITEM                  PIC S9(9) VALUE ZERO        01680039
016900                                                COMP-3.           01690039
017000     05  PV-BOTTOM-ITEM               PIC S9(9) VALUE ZERO        01700039
017100                                                COMP-3.           01710039
017200     05  PV-TEMP-BLOCK-NUMBER         PIC S9(9) VALUE ZERO        01720039
017300                                                COMP-3.           01730039
017400     05  PV-BLOCK-NUMBER              PIC S9(4) VALUE ZERO        01740039
017500                                                COMP SYNC.        01750039
017600     05  PV-CICS-RESP                 PIC S9(4) VALUE ZERO        01760039
017700                                                COMP SYNC.        01770039
017800     05  PV-COUNTER                   PIC S9(04) VALUE +0         01780042
017900                                                 COMP SYNC.       01790042
018000     05  PV-NULL-IND                  PIC S9(04) VALUE +0         01800042
018100                                                 COMP SYNC.       01810042
018200     05  PV-ITEM                      PIC S9(4) VALUE ZERO        01820039
018300                                                COMP SYNC.        01830039
018400     05  PV-SEL-QUEUE-ITEM            PIC S9(4) VALUE ZERO        01840039
018500                                                COMP SYNC.        01850039
018600     05  PV-SAVE-ITEM                 PIC S9(4) VALUE ZERO        01860039
018700                                                COMP SYNC.        01870039
018800     05  PV-HIGHEST-BLOCK-WRITTEN     PIC S9(4) VALUE ZERO        01880039
018900                                                COMP SYNC.        01890039
019000     05  PV-LIST-ITEM-NUMBER          PIC S9(4) VALUE ZERO        01900039
019100                                                COMP SYNC.        01910039
019200     05  PV-FIRST-BLOCK-IN-ARRAY      PIC S9(4) VALUE ZERO        01920039
019300                                                COMP SYNC.        01930039
019400     05  PV-NEXT-BLOCK-IN-ARRAY       PIC S9(4) VALUE ZERO        01940039
019500                                                COMP SYNC.        01950039
019600     05  PV-PREV-BLOCK-IN-ARRAY       PIC S9(4) VALUE ZERO        01960039
019700                                                COMP SYNC.        01970039
019800     05  PV-FIRST-BLOCK-IN-RANGE      PIC S9(4) VALUE ZERO        01980039
019900                                                COMP SYNC.        01990039
020000     05  PV-LAST-BLOCK-IN-RANGE       PIC S9(4) VALUE ZERO        02000039
020100                                                COMP SYNC.        02010039
020200     05  PV-START-OF-SELECTED-RANGE   PIC S9(4) VALUE ZERO        02020039
020300                                                COMP SYNC.        02030039
020400     05  PV-END-OF-SELECTED-RANGE     PIC S9(4) VALUE ZERO        02040039
020500                                                COMP SYNC.        02050039
020600     05  PV-SQL-SUB                   PIC S9(4) VALUE ZERO        02060039
020700                                                COMP SYNC.        02070039
020800     05  PV-RETRY-COUNTER             PIC S9(4) VALUE ZERO        02080039
020900                                                COMP SYNC.        02090039
021000     05  PV-REC-IND                   PIC S9(4) VALUE ZERO        02100039
021100                                                COMP SYNC.        02110039
021200     05  PV-DISTRO-IND                PIC S9(4) VALUE ZERO        02120039
021300                                                COMP SYNC.        02130039
021400     05  PV-EXPTED-IND                PIC S9(4) VALUE ZERO        02140039
021500                                                COMP SYNC.        02150039
021600     05  PV-VERIFIED-IND              PIC S9(4) VALUE ZERO        02160039
021700                                                COMP SYNC.        02170039
021800     05  PV-REC-ITEMS                 PIC S9(9) VALUE ZERO        02180039
021900                                                COMP SYNC.        02190039
022000     05  PV-SUM-EXPTED-QTY            PIC S9(9) VALUE ZERO        02200039
022100                                                COMP SYNC.        02210039
022200     05  PV-SUM-VERIFIED-QTY          PIC S9(9) VALUE ZERO        02220039
022300                                                COMP SYNC.        02230039
022400     05  PV-SUM-DISTRO-QTY            PIC S9(9) VALUE ZERO        02240039
022500                                                COMP SYNC.        02250039
022600     05  PV-SUM-STR-DISTRO-QTY        PIC S9(9) VALUE ZERO        02260039
022700                                                COMP SYNC.        02270039
022800     05  PV-ORIG-PKSL-ITM-QTY         PIC S9(9) VALUE +0 COMP.    02280041
022900     05  PV-OPEN-TO-REC               PIC  9(6) VALUE ZERO.       02290039
023000     05  PV-STATUS-CDE                PIC X(02) VALUE SPACES.     02300039
023100         88  PV-VALID-STATUS-CDE                VALUES 'AP', 'AC'.02310039
023200     05  PV-PO-REC-SEQ-NBR.                                       02320039
023300         10  PV-PO-NBR                PIC 9(08).                  02330039
023400         10  FILLER                   PIC X(01) VALUE '-'.        02340039
023500         10  PV-REC-SEQ-NBR           PIC 9(04).                  02350039
023600                                                                  02360039
023700 01  LQW-LIST-QUEUE-WORK-AREA.                                    02370039
023800     05  LQW-BLOCK-MODIFIED           PIC X(01)  VALUE SPACE.     02380039
023900     05  LQW-BLOCK-USED-SW            PIC X.                      02390039
024000         88  LQW-BLOCK-NOT-USED       VALUE 'N'.                  02400039
024100         88  LQW-BLOCK-USED           VALUE 'Y'.                  02410039
024200     05  LQW-ITEM-ENTRIES             OCCURS 12 TIMES             02420039
024300                                      INDEXED BY LQW-IDX.         02430039
024400         10  LQW-LIST-ITEM-NUMBER     PIC S9(9)  COMP-3.          02440039
024500         10  LQW-TEMP-SELECTED-SW     PIC X(01).                  02450039
024600         10  LQW-SELECTED-SW          PIC X(01).                  02460039
024700             88  LQW-SELECT                      VALUE 'S'.       02470039
024800             88  LQW-DESELECT                    VALUE ' '.       02480039
024900         10  LQW-VEND-STYL-NAME       PIC X(20).                  02490039
025000         10  LQW-STYLE-MODIFIED-SW    PIC X(01).                  02500039
025100             88  LQW-STYLE-MODIFIED   VALUE 'Y'.                  02510039
025200             88  LQW-STYLE-NOT-MODIFIED                           02520039
025300                                      VALUE 'N'.                  02530039
025400         10  LQW-UNIT-QTY             PIC 9(06).                  02540039
025500         10  LQW-PURITM-KEY.                                      02550039
025600             15  LQW-PO-NBR           PIC 9(09).                  02560039
025700             15  LQW-VER-NBR          PIC 9(09).                  02570039
025800             15  LQW-PO-LINE-NBR      PIC 9(04).                  02580039
025900         10  LQW-UNT-COST-AMT.                                    02590039
026000             15  LQW-UNT-COST-AMT-N   PIC 9(5)V9(3).              02600039
026100         10  LQW-DESC                 PIC X(25).                  02610039
026200         10  LQW-PURITM-VER-NBR       PIC S9(09)                  02620039
026300                                      COMP.                       02630039
026400                                                                  02640039
026500******************************************************************02650039
026600*    SELECTED ITEMS TEMPORARY STORAGE QUEUE ITEM LAYOUT           02660039
026700******************************************************************02670039
026800     COPY RCWS013.                                                02680039
026900                                                                  02690039
027000******************************************************************02700039
027100*    BMS MAP                                                      02710039
027200******************************************************************02720039
027300     COPY RCKM252.                                                02730039
027400                                                                  02740039
027500 01  MR-OCCURS-LAYOUT                 REDEFINES RC252AO.          02750039
027600     05  FILLER                       PIC X(122).                 02760039
027700     05  MR-SCROLL-AREA               OCCURS 12 TIMES.            02770039
027800         10  MR-SELECTL               PIC S9(4) COMP.             02780039
027900         10  MR-SELECTA               PIC X.                      02790039
028000         10  MR-SELECTC               PIC X.                      02800039
028100         10  MR-SELECTH               PIC X.                      02810039
028200         10  MR-SELECTI               PIC X.                      02820039
028300                                                                  02830039
028400         10  MR-ACT-L                 PIC S9(4) COMP.             02840039
028500         10  MR-ACT-A                 PIC X.                      02850039
028600         10  MR-ACT-C                 PIC X.                      02860039
028700         10  MR-ACT-H                 PIC X.                      02870039
028800         10  MR-ACT                   PIC XXX.                    02880039
028900                                                                  02890039
029000         10  MR-VEND-STYL-NAME-L      PIC S9(4) COMP.             02900039
029100         10  MR-VEND-STYL-NAME-A      PIC X.                      02910039
029200         10  MR-VEND-STYL-NAME-C      PIC X.                      02920039
029300         10  MR-VEND-STYL-NAME-H      PIC X.                      02930039
029400         10  MR-VEND-STYL-NAME        PIC X(20).                  02940039
029500                                                                  02950039
029600         10  MR-UNIT-QTY-L            PIC S9(4) COMP.             02960039
029700         10  MR-UNIT-QTY-A            PIC X.                      02970039
029800         10  MR-UNIT-QTY-C            PIC X.                      02980039
029900         10  MR-UNIT-QTY-H            PIC X.                      02990039
030000         10  MR-UNIT-QTY.                                         03000039
030100             15  MR-UNIT-QTY-EDITED                               03010039
030200                                      PIC ZZZZZZ.                 03020039
030300                                                                  03030039
030400         10  MR-PO-LINE-NBR-L         PIC S9(4) COMP.             03040039
030500         10  MR-PO-LINE-NBR-A         PIC X.                      03050039
030600         10  MR-PO-LINE-NBR-C         PIC X.                      03060039
030700         10  MR-PO-LINE-NBR-H         PIC X.                      03070039
030800         10  MR-PO-LINE-NBR.                                      03080039
030900             15  MR-PO-LINE-NBR-EDITED                            03090039
031000                                      PIC ZZZ9.                   03100039
031100                                                                  03110039
031200         10  MR-UNT-COST-AMT-L        PIC S9(4) COMP.             03120039
031300         10  MR-UNT-COST-AMT-A        PIC X.                      03130039
031400         10  MR-UNT-COST-AMT-C        PIC X.                      03140039
031500         10  MR-UNT-COST-AMT-H        PIC X.                      03150039
031600         10  MR-UNT-COST-AMT.                                     03160039
031700             15  MR-UNT-COST-AMT-EDITED                           03170039
031800                                      PIC ZZ,ZZZ.999.             03180039
031900                                                                  03190039
032000         10  MR-DESC-L                PIC S9(4) COMP.             03200039
032100         10  MR-DESC-A                PIC X.                      03210039
032200         10  MR-DESC-C                PIC X.                      03220039
032300         10  MR-DESC-H                PIC X.                      03230039
032400         10  MR-DESC                  PIC X(25).                  03240039
032500                                                                  03250039
032600                                                                  03260039
032700******************************************************************03270039
032800*    BMS ATTRIBUTES                                               03280039
032900******************************************************************03290039
033000     COPY DPWS015.                                                03300039
033100                                                                  03310039
033200******************************************************************03320039
033300*    FUNCTION KEYS                                                03330039
033400******************************************************************03340039
033500     COPY DPWS016.                                                03350039
033600                                                                  03360039
033700******************************************************************03370039
033800*    PARAMETER LIST FOR NUMERIC EDIT SUBROUTINE                   03380039
033900******************************************************************03390039
034000     COPY DPWS010I.                                               03400039
034100                                                                  03410039
034200******************************************************************03420039
034300*    PARAMETER LIST FOR CICS API                                  03430039
034400******************************************************************03440039
034500     COPY DPWS030.                                                03450039
034510     COPY DPWS930.                                                03451045
034600                                                                  03460039
034700******************************************************************03470039
034800*    GLOBAL COMMUNICATION AREA                                    03480039
034900******************************************************************03490039
035000     COPY DPWS020.                                                03500039
035100     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                03510039
035200                                                                  03520039
035300******************************************************************03530039
035400*    INTER-APPLICATION COMMUNICATION AREA                         03540039
035500*    RCWS015 = INPUT FROM PACK SLIP HEADER MAINTENANCE PROGRAM    03550039
035600******************************************************************03560039
035700         10  INTER-APPL-COMM-AREA       PIC X(200).               03570039
035800     COPY RCWS015.                                                03580039
035900     COPY RCWS012.                                                03590039
036000                                                                  03600039
036100******************************************************************03610039
036200*    APPLICATION SPECIFIC COMMUNICATION AREA                      03620039
036300******************************************************************03630039
036400         10  ASC-SPECIFIC-COMMAREA.                               03640039
036500             15  ASC-LIST-HEADER-INFO.                            03650039
036600                 20  ASC-KEY-SEARCH-STYLE       PIC X(20).        03660039
036700                 20  ASC-KEY-PO-NBR.                              03670039
036800** CHG0094517  CHANGED PO-NBR LENGTH FROM 7 TO 8                  03680043
036900                     25  ASC-KEY-PO-NBR-N       PIC 9(08).        03690043
037000                 20  ASC-KEY-PKSL-NBR           PIC X(10).        03700039
037100                 20  ASC-KEY-VENDOR-NAME        PIC X(30).        03710039
037200                 20  ASC-KEY-SEQ-NBR            PIC S9(4) COMP.   03720039
037300                 20  ASC-KEY-OPER-UNT-ID        PIC S9(4) COMP.   03730039
037400                 20  ASC-KEY-FCLTY-ID           PIC S9(4) COMP.   03740039
037500                 20  ASC-KEY-STR-NBR            PIC S9(4) COMP.   03750039
037600                 20  ASC-KEY-REC-SEQ-NBR        PIC S9(9) COMP.   03760039
037700             15  ASC-BLOCK-ENTRIES  OCCURS 2 TIMES.               03770039
037800                 20  ASC-BLOCK-MODIFIED-SW           PIC X.       03780039
037900                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   03790039
038000                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   03800039
038100                 20  ASC-BLOCK-USED-SW               PIC X.       03810039
038200                     88  ASC-BLOCK-NOT-USED          VALUE 'N'.   03820039
038300                     88  ASC-BLOCK-USED              VALUE 'Y'.   03830039
038400                                                                  03840039
038500                 20  ASC-ITEM-ARRAY.                              03850039
038600                     25  ASC-ITEM-ENTRIES  OCCURS 12 TIMES.       03860039
038700                         30  ASC-LIST-ITEM-NUMBER    PIC S9(9)    03870039
038800                                                     COMP-3.      03880039
038900                         30  ASC-TEMP-SELECTED-SW    PIC X.       03890039
039000                             88  ASC-VALID-SELECT    VALUE ' '    03900039
039100                                                           'S'    03910039
039200                                                           'B'    03920039
039300                                                           'E'.   03930039
039400                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   03940039
039500                             88  ASC-TEMP-SELECT     VALUE 'S'.   03950039
039600                             88  ASC-TEMP-BEGIN      VALUE 'B'.   03960039
039700                             88  ASC-TEMP-END        VALUE 'E'.   03970039
039800                         30  ASC-SELECTED-SW         PIC  X.      03980039
039900                             88  ASC-NO-SELECT       VALUE ' '.   03990039
040000                             88  ASC-SELECT          VALUE 'S'.   04000039
040100                             88  ASC-BEGIN           VALUE 'B'.   04010039
040200                             88  ASC-END             VALUE 'E'.   04020039
040300                         30  ASC-VEND-STYL-NAME      PIC X(20).   04030039
040400                         30  ASC-STYLE-MODIFIED-SW   PIC X(01).   04040039
040500                             88  ASC-STYLE-MODIFIED  VALUE 'Y'.   04050039
040600                             88  ASC-STYLE-NOT-MODIFIED           04060039
040700                                                     VALUE 'N'.   04070039
040800                         30  ASC-UNIT-QTY.                        04080039
040900                             35  ASC-UNIT-QTY-N      PIC 9(06).   04090039
041000                         30  ASC-PURITM-KEY.                      04100039
041100                             35  ASC-PO-NBR          PIC 9(09).   04110039
041200                             35  ASC-VER-NBR         PIC 9(09).   04120039
041300                             35  ASC-PO-LINE-NBR     PIC 9(04).   04130039
041400                         30  ASC-UNT-COST-AMT.                    04140039
041500                             35  ASC-UNT-COST-AMT-N PIC 9(5)V9(3).04150039
041600                         30  ASC-DESC                PIC X(25).   04160039
041700                         30  ASC-PURITM-VER-NBR      PIC S9(09)   04170039
041800                                                     COMP.        04180039
041900                                                                  04190039
042000             15  ASC-BLK-SUB                         PIC S9(4)    04200039
042100                                                     COMP SYNC.   04210039
042200             15  ASC-ITEM-SUB                        PIC S9(4)    04220039
042300                                                     COMP SYNC.   04230039
042400             15  ASC-NUMBER-OF-ITEMS-READ            PIC S9(9)    04240039
042500                                                     COMP-3.      04250039
042600             15  ASC-NUMBER-OF-SELECTED-ITEMS        PIC S9(9)    04260039
042700                                                     COMP-3.      04270039
042800             15  ASC-ITEMS-DISPLAYED                 PIC S999     04280039
042900                                                     COMP-3.      04290039
043000             15  ASC-ITEM-AT-TOP-OF-PANEL            PIC S9(9)    04300039
043100                                                     COMP-3.      04310039
043200             15  ASC-ITEM-AT-BOT-OF-PANEL            PIC S9(9)    04320039
043300                                                     COMP-3.      04330039
043400             15  ASC-HIGHEST-BLOCK-WRITTEN           PIC S9(4)    04340039
043500                                                     COMP SYNC.   04350039
043600             15  ASC-START-OF-SELECTED-RANGE         PIC S9(9)    04360039
043700                                                     COMP-3.      04370039
043800             15  ASC-END-OF-SELECTED-RANGE           PIC S9(9)    04380039
043900                                                     COMP-3.      04390039
044000             15  ASC-TEMP-QUEUE-UPDATE-SW            PIC X.       04400039
044100                 88  ASC-UPDATE-TSQ                  VALUE 'Y'.   04410039
044200                 88  ASC-NO-TSQ-UPDATE               VALUE ' '.   04420039
044300             15  ASC-LIST-QUEUE-NAME.                             04430039
044400                 20  ASC-LIST-TERM-ID                PIC X(4).    04440039
044500                 20  ASC-LIST-TASK-NUMBER            PIC S9(5)    04450039
044600                                                     COMP-3.      04460039
044700                 20  ASC-LIST-SEQ                    PIC 9.       04470039
044800             15  ASC-SEL-QUEUE-NAME.                              04480039
044900                 20  ASC-SEL-TERM-ID                 PIC X(4).    04490039
045000                 20  ASC-SEL-TASK-NUMBER             PIC S9(5)    04500039
045100                                                     COMP-3.      04510039
045200                 20  ASC-SEL-SEQ                     PIC 9.       04520039
045300             15  ASC-START-ITEM-REQUEST.                          04530039
045400                 20  ASC-START-ITEM-REQUEST-N        PIC 9(5).    04540039
045500             15  ASC-PO-ITEMS-SW                     PIC X.       04550039
045600                 88  ASC-MORE-PO-ITEMS               VALUE 'Y'.   04560039
045700                 88  ASC-NO-MORE-PO-ITEMS            VALUE 'N'.   04570039
045800             15  ASC-HOLD-INTER-APPL                 PIC X(200).  04580039
045900                                                                  04590039
046000******************************************************************04600039
046100*    ABEND PROCESSING                                             04610039
046200******************************************************************04620039
046300     COPY DPWS013.                                                04630039
046400                                                                  04640039
046500******************************************************************04650039
046600*    DB2 SQL COMMUNICATION AREA                                   04660039
046700******************************************************************04670039
046800     EXEC SQL                                                     04680039
046900          INCLUDE SQLCA                                           04690039
047000     END-EXEC.                                                    04700039
047100                                                                  04710039
047200******************************************************************04720039
047300*    DB2 DCLGEN FOR PACK SLIP HEADER TABLE                        04730039
047400******************************************************************04740039
047500     EXEC SQL                                                     04750039
047600          INCLUDE TPKSLIP                                         04760039
047700     END-EXEC.                                                    04770039
047800                                                                  04780039
047900******************************************************************04790039
048000*    DB2 DCLGEN FOR PACK SLIP ITEM TABLE                          04800039
048100******************************************************************04810039
048200     EXEC SQL                                                     04820039
048300          INCLUDE TPKITEM                                         04830039
048400     END-EXEC.                                                    04840039
048500                                                                  04850039
048600******************************************************************04860039
048700*    DB2 DCLGEN FOR PURCHASE ORDER TABLE                          04870039
048800******************************************************************04880039
048900     EXEC SQL                                                     04890039
049000          INCLUDE TPURCHS                                         04900039
049100     END-EXEC.                                                    04910039
049200                                                                  04920039
049300******************************************************************04930039
049400*    DB2 DCLGEN FOR PURCHASE ORDER ITEM TABLE                     04940039
049500******************************************************************04950039
049600     EXEC SQL                                                     04960039
049700          INCLUDE TPURITM                                         04970039
049800     END-EXEC.                                                    04980039
049900                                                                  04990039
050000******************************************************************05000039
050100*    DB2 DCLGEN FOR RECEIVER TABLE                                05010039
050200******************************************************************05020039
050300     EXEC SQL                                                     05030039
050400          INCLUDE TRECEIV                                         05040039
050500     END-EXEC.                                                    05050039
050600                                                                  05060039
050700                                                                  05070039
050800******************************************************************05080039
050900*    DB2 DCLGEN FOR RECEIVER DISTRIBUTION TABLE                   05090039
051000******************************************************************05100039
051100     EXEC SQL                                                     05110039
051200          INCLUDE TRECDIS                                         05120039
051300     END-EXEC.                                                    05130039
051400                                                                  05140039
051500                                                                  05150039
051600******************************************************************05160039
051700*    DB2 DCLGEN FOR MERCHANDISE DISTRIBUTION TABLE                05170039
051800******************************************************************05180039
051900     EXEC SQL                                                     05190039
052000          INCLUDE TMESTDS                                         05200039
052100     END-EXEC.                                                    05210039
052200                                                                  05220039
052300                                                                  05230039
052400******************************************************************05240039
052500*    DB2 DCLGEN FOR THE ALLOCATION PLAN TABLE                     05250039
052600******************************************************************05260039
052700     EXEC SQL                                                     05270039
052800          INCLUDE TALLPLN                                         05280039
052900     END-EXEC.                                                    05290039
053000                                                                  05300039
053100******************************************************************05310039
053200*    DB2 DCLGEN FOR VENDOR ENTERPRISE NAME TABLE                  05320039
053300******************************************************************05330039
053400     EXEC SQL                                                     05340039
053500          INCLUDE TENTNME                                         05350039
053600     END-EXEC.                                                    05360039
053700******************************************************************05370039
053800******************************************************************05380039
053900                                                                  05390039
054000 LINKAGE SECTION.                                                 05400039
054100                                                                  05410039
054200 01  DFHCOMMAREA.                                                 05420039
054300     05  FILLER                       OCCURS 1 TO 4072 TIMES      05430039
054400                                      DEPENDING ON EIBCALEN.      05440039
054500         10  FILLER                   PIC X.                      05450039
054600                                                                  05460039
054700                                                                  05470039
054800 PROCEDURE DIVISION.                                              05480039
054900                                                                  05490039
055000 0000-MAIN-MODULE.                                                05500039
055100                                                                  05510039
055200     INITIALIZE DP030-CICS-API-FIELDS.                            05520039
055300                                                                  05530039
055400     MOVE +1                     TO DP030-NUMBER-OF-MAPS.         05540039
055500     MOVE PC-CURRENT-MAPSET-NAME TO DP030-MAPSET-NAME.            05550039
055600     MOVE PC-CURRENT-MAP-NAME    TO DP030-MAP-NAME (1).           05560039
055700     SET DP030-RECEIVE-APPL-MAP  TO TRUE.                         05570039
055800     MOVE LENGTH OF RC252AI      TO DP030-MAP-LENGTH (1).         05580039
055900     MOVE 'PROGRAM ENTRY CALL'   TO DP013-MESSAGE-TEXT (1).       05590039
056000     SET DP030-OVERRIDE-APPL-ERROR                                05600039
056100                                 TO TRUE.                         05610039
056200                                                                  05620039
056300     PERFORM 0001-CALL-CICS-ARCH-API.                             05630039
056400                                                                  05640039
056500     PERFORM 1000-CONTROL-PROCESSING.                             05650039
056600                                                                  05660039
056700     MOVE 'PROGRAM EXIT CALL'    TO DP013-MESSAGE-TEXT (1).       05670039
056800                                                                  05680039
056900     PERFORM 0001-CALL-CICS-ARCH-API.                             05690039
057000                                                                  05700039
057100 0001-CALL-CICS-ARCH-API.                                         05710039
057200                                                                  05720039
057310     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      05731045
057400                                    DFHCOMMAREA                   05740045
057500                                    DP030-CICS-API-FIELDS         05750045
057600                                    DP020-STANDARD-COMMAREA       05760045
057700                                    RC252AI.                      05770045
057800                                                                  05780039
057900     IF DP030-RC-CALL-SUCCESSFUL OR                               05790039
058000        DP030-RC-APPL-ERROR                                       05800039
058100         CONTINUE                                                 05810039
058200     ELSE                                                         05820039
058300         SET DP013-CICS-ABEND                                     05830039
058400             DP013-NO-ROLLBACK                                    05840039
058500             DP013-XCTL-DISPLAY-RESTART                           05850039
058600                                 TO TRUE                          05860039
058700         MOVE '0001-CALL-CICS-ARCH-API'                           05870039
058800                                 TO DP013-PARAGRAPH               05880039
058820         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN CODE O05882045
058830-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      05883045
059100         MOVE DP030-RETURN-CODE  TO DP013-MESSAGE-TEXT (3)        05910039
059200                                                                  05920039
059300         PERFORM DP013-0000-PROCESS-ABEND.                        05930039
059400                                                                  05940039
059500 1000-CONTROL-PROCESSING.                                         05950039
059600                                                                  05960039
059700     EVALUATE TRUE                                                05970039
059800                                                                  05980039
059900         WHEN DP030-RC-APPL-ERROR                                 05990039
060000              MOVE ASC-ITEM-AT-TOP-OF-PANEL                       06000039
060100                                 TO PV-TOP-ITEM                   06010039
060200              MOVE ZERO          TO ASC-ITEM-AT-TOP-OF-PANEL      06020039
060300                                                                  06030039
060400              PERFORM 6000-REFRESH-PANEL-FROM-TEMP                06040039
060500                                                                  06050039
060600              PERFORM 3000-EDIT-DATA-IN-COMMAREA                  06060039
060700                                                                  06070039
060800              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                06080039
060900                                                                  06090039
061000                                                                  06100039
061100         WHEN DP020-NEXT-ACT-INITIAL                              06110039
061200              INITIALIZE ASC-SPECIFIC-COMMAREA                    06120039
061300              MOVE EIBTRMID      TO ASC-LIST-TERM-ID              06130039
061400                                    ASC-SEL-TERM-ID               06140039
061500              MOVE DP020-SRC-TASK-NUMBER                          06150039
061600                                 TO ASC-LIST-TASK-NUMBER          06160039
061700                                    ASC-SEL-TASK-NUMBER           06170039
061800              MOVE PC-LIST-QUEUE-SEQ                              06180039
061900                                 TO ASC-LIST-SEQ                  06190039
062000              MOVE PC-SEL-QUEUE-SEQ                               06200039
062100                                 TO ASC-SEL-SEQ                   06210039
062200              SET PS-NO-ERROR    TO TRUE                          06220039
062300                                                                  06230039
062400              PERFORM 1100-PROCESS-INTER-APPL-COMM                06240039
062500                                                                  06250039
062600              IF PS-NO-ERROR                                      06260039
062700                  MOVE INTER-APPL-COMM-AREA                       06270039
062800                                 TO ASC-HOLD-INTER-APPL           06280039
062900                  PERFORM 4000-BUILD-INITIAL-PANEL                06290039
063000              END-IF                                              06300039
063100                                                                  06310039
063200                                                                  06320039
063300         WHEN DP020-NEXT-ACT-READ-MAP                             06330039
063400              MOVE ASC-ITEM-AT-TOP-OF-PANEL                       06340039
063500                                 TO PV-TOP-ITEM                   06350039
063600                                                                  06360039
063700              PERFORM 2000-PROCESS-PANEL                          06370039
063800                                                                  06380039
063900                                                                  06390039
064000         WHEN DP020-NEXT-ACT-RETURN                               06400039
064100              MOVE ASC-ITEM-AT-TOP-OF-PANEL                       06410039
064200                                 TO PV-TOP-ITEM                   06420039
064300              MOVE ZERO          TO ASC-ITEM-AT-TOP-OF-PANEL      06430039
064400              MOVE ASC-HOLD-INTER-APPL                            06440039
064500                                 TO INTER-APPL-COMM-AREA          06450039
064600                                                                  06460039
064700              PERFORM 6000-REFRESH-PANEL-FROM-TEMP                06470039
064800                                                                  06480039
064900              PERFORM 3000-EDIT-DATA-IN-COMMAREA                  06490039
065000                                                                  06500039
065100              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                06510039
065200                                                                  06520039
065300                                                                  06530039
065400         WHEN OTHER                                               06540039
065500              SET DP013-LOGIC-ABEND                               06550039
065600                  DP013-NO-ROLLBACK                               06560039
065700                                 TO TRUE                          06570039
065800              MOVE '1000-CONTROL-PROCESSING'                      06580039
065900                                 TO DP013-PARAGRAPH               06590039
066000              MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'   06600039
066100                                 TO DP013-MESSAGE-TEXT(1)         06610039
066200                                                                  06620039
066300              PERFORM DP013-0000-PROCESS-ABEND                    06630039
066400                                                                  06640039
066500     END-EVALUATE.                                                06650039
066600                                                                  06660039
066700 1100-PROCESS-INTER-APPL-COMM.                                    06670039
066800                                                                  06680039
066900     MOVE SPACE                  TO ASC-START-ITEM-REQUEST.       06690039
067000     IF DP020-INT-APPL-FORMAT-IND = PC-PACK-SLIP-SUMMARY          06700039
067100         MOVE RC015-PO-NBR           TO ASC-KEY-PO-NBR-N          06710039
067200         MOVE RC015-SEQ-NBR          TO ASC-KEY-SEQ-NBR           06720039
067300         MOVE RC015-OPER-UNT-ID      TO ASC-KEY-OPER-UNT-ID       06730039
067400         MOVE RC015-FCLTY-ID         TO ASC-KEY-FCLTY-ID          06740039
067500         MOVE RC015-STR-NBR          TO ASC-KEY-STR-NBR           06750039
067600         MOVE RC015-REC-SEQ-NBR      TO ASC-KEY-REC-SEQ-NBR       06760039
067700     ELSE                                                         06770039
067800         MOVE RC012-PO-NBR           TO ASC-KEY-PO-NBR-N          06780039
067900         MOVE RC012-SEQ-NBR          TO ASC-KEY-SEQ-NBR           06790039
068000         MOVE RC012-OPER-UNT-ID      TO ASC-KEY-OPER-UNT-ID       06800039
068100         MOVE RC012-FCLTY-ID         TO ASC-KEY-FCLTY-ID          06810039
068200         MOVE RC012-STR-NBR          TO ASC-KEY-STR-NBR           06820039
068300         MOVE RC012-REC-SEQ-NBR      TO ASC-KEY-REC-SEQ-NBR       06830039
068400     END-IF.                                                      06840039
068500                                                                  06850039
068600 2000-PROCESS-PANEL.                                              06860039
068700                                                                  06870039
068800     EVALUATE TRUE                                                06880039
068900                                                                  06890039
069000         WHEN DP020-SRC-AID = DP016-CLEAR                         06900039
069100              MOVE ZERO          TO ASC-ITEM-AT-TOP-OF-PANEL      06910039
069200                                                                  06920039
069300              PERFORM 3000-EDIT-DATA-IN-COMMAREA                  06930039
069400                                                                  06940039
069500              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                06950039
069600                                                                  06960039
069700                                                                  06970039
069800         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    06980039
069900                                                                  06990039
070000              PERFORM 2050-DELETE-LIST-QUEUE                      07000039
070100                                                                  07010039
070200              PERFORM 4000-BUILD-INITIAL-PANEL                    07020039
070300                                                                  07030039
070400                                                                  07040039
070500         WHEN DP020-FK-DESELECT (DP020-SRC-AID)                   07050039
070600                                                                  07060039
070700              PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                07070039
070800                                                                  07080039
070900              PERFORM 3000-EDIT-DATA-IN-COMMAREA                  07090039
071000                                                                  07100039
071100              IF PS-NO-ERROR                                      07110039
071200                  PERFORM 2140-DESELECT-ALL-ITEMS                 07120039
071300                                                                  07130039
071400                  PERFORM 4400-MOVE-COMMAREA-TO-SCREEN            07140039
071500                                                                  07150039
071600              END-IF                                              07160039
071700                                                                  07170039
071800         WHEN DP020-FK-SELECT-ALL (DP020-SRC-AID)                 07180039
071900                                                                  07190039
072000              PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                07200039
072100                                                                  07210039
072200              PERFORM 3000-EDIT-DATA-IN-COMMAREA                  07220039
072300                                                                  07230039
072400              IF PS-NO-ERROR                                      07240039
072500                  PERFORM 2150-SELECT-ALL-ITEMS                   07250039
072600                                                                  07260039
072700                  PERFORM 4400-MOVE-COMMAREA-TO-SCREEN            07270039
072800              END-IF                                              07280039
072900                                                                  07290039
073000                                                                  07300039
073100         WHEN OTHER                                               07310039
073200                                                                  07320039
073300              PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                07330039
073400                                                                  07340039
073500              PERFORM 3000-EDIT-DATA-IN-COMMAREA                  07350039
073600                                                                  07360039
073700              IF PS-NO-ERROR                                      07370039
073800                  SET DP030-CONTINUE-GO                           07380039
073900                                 TO TRUE                          07390039
074000                                                                  07400039
074100                  PERFORM 2100-CHECK-FUNCTION-KEY                 07410039
074200                                                                  07420039
074300              ELSE                                                07430039
074400                  PERFORM 4400-MOVE-COMMAREA-TO-SCREEN            07440039
074500                  SET DP030-OVERRIDE-GO                           07450039
074600                                 TO TRUE                          07460039
074700              END-IF                                              07470039
074800                                                                  07480039
074900     END-EVALUATE.                                                07490039
075000                                                                  07500039
075100 2050-DELETE-LIST-QUEUE.                                          07510039
075200                                                                  07520039
075300     EXEC CICS DELETEQ TS QUEUE (ASC-LIST-QUEUE-NAME)             07530039
075400                          RESP  (PV-CICS-RESP)                    07540039
075500                          END-EXEC.                               07550039
075600                                                                  07560039
075700     IF (PV-CICS-RESP = DFHRESP (NORMAL)) OR                      07570039
075800        (PV-CICS-RESP = DFHRESP (QIDERR))                         07580039
075900         CONTINUE                                                 07590039
076000     ELSE                                                         07600039
076100         SET DP013-CICS-ABEND                                     07610039
076200             DP013-NO-ROLLBACK   TO TRUE                          07620039
076300         MOVE '2050-DELETE-LIST-QUEUE'                            07630039
076400                                 TO DP013-PARAGRAPH               07640039
076500         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE DELETE' 07650039
076600                                 TO DP013-MESSAGE-TEXT (1)        07660039
076700                                                                  07670039
076800         PERFORM DP013-0000-PROCESS-ABEND                         07680039
076900     END-IF.                                                      07690039
077000                                                                  07700039
077100     MOVE ZERO                   TO ASC-HIGHEST-BLOCK-WRITTEN.    07710039
077200                                                                  07720039
077300 2100-CHECK-FUNCTION-KEY.                                         07730039
077400                                                                  07740039
077500     EVALUATE TRUE                                                07750039
077600*        WHEN DP020-FK-LOCAL-GOTO (DP020-SRC-AID)                 07760039
077700*             INITIALIZE RC015-INTER-APPL-COMMAREA                07770039
077800*             MOVE ASC-NUMBER-OF-SELECTED-ITEMS                   07780039
077900*                                TO RC015-NUMBER-OF-SELECTED-ITEMS07790039
078000*             MOVE ASC-KEY-PO-NBR-N                               07800039
078100*                                TO RC015-PO-NBR                  07810039
078200*             PERFORM 5000-PREPARE-SEL-QUEUE                      07820039
078300*             IF ASC-NUMBER-OF-SELECTED-ITEMS = ZERO              07830039
078400*                 SET ASC-NO-TSQ-UPDATE                           07840039
078500*                                TO TRUE                          07850039
078600*             END-IF                                              07860039
078700                                                                  07870039
078800         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              07880039
078900              IF ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              07890039
079000                  INITIALIZE RC015-INTER-APPL-COMMAREA            07900039
079100                  MOVE ASC-NUMBER-OF-SELECTED-ITEMS               07910039
079200                                 TO RC015-NUMBER-OF-SELECTED-ITEMS07920039
079300                  MOVE ASC-KEY-PO-NBR-N                           07930039
079400                                 TO RC015-PO-NBR                  07940039
079500                  MOVE ASC-KEY-PKSL-NBR                           07950039
079600                                 TO RC015-PKSL-NBR                07960039
079700                  PERFORM 5000-PREPARE-SEL-QUEUE                  07970039
079800                  PERFORM 4400-MOVE-COMMAREA-TO-SCREEN            07980039
079900              ELSE                                                07990039
080000                  IF ASC-NUMBER-OF-SELECTED-ITEMS = ZERO          08000039
080100                      SET ASC-NO-TSQ-UPDATE                       08010039
080200                                 TO TRUE                          08020039
080300                      SET DP030-OVERRIDE-GO                       08030039
080400                          DP020-MSG-WARNING                       08040039
080500                                 TO TRUE                          08050039
080600                      MOVE PC-TSYMSG-00057                        08060039
080700                                 TO DP020-MSG-NUMBER              08070039
080800                  END-IF                                          08080039
080900                  PERFORM 4400-MOVE-COMMAREA-TO-SCREEN            08090039
081000              END-IF                                              08100039
081100                                                                  08110039
081200         WHEN DP020-FK-FIRST-PAGE (DP020-SRC-AID)                 08120039
081300             MOVE +1             TO PV-TOP-ITEM                   08130039
081400                                                                  08140039
081500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08150039
081600                                                                  08160039
081700             PERFORM 3200-RESET-ATTRIBUTES                        08170039
081800                                                                  08180039
081900                                                                  08190039
082000         WHEN DP020-FK-PREV-PAGE (DP020-SRC-AID)                  08200039
082100                                                                  08210039
082200             PERFORM 2110-BROWSE-BACKWARD                         08220039
082300                                                                  08230039
082400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08240039
082500                                                                  08250039
082600             PERFORM 3200-RESET-ATTRIBUTES                        08260039
082700                                                                  08270039
082800                                                                  08280039
082900         WHEN DP020-FK-NEXT-PAGE (DP020-SRC-AID)                  08290039
083000                                                                  08300039
083100             PERFORM 2120-BROWSE-FORWARD                          08310039
083200                                                                  08320039
083300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08330039
083400                                                                  08340039
083500             PERFORM 3200-RESET-ATTRIBUTES                        08350039
083600                                                                  08360039
083700                                                                  08370039
083800         WHEN DP020-SRC-AID = DP016-ENTER                         08380039
083900                                                                  08390039
084000             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   08400039
084100                                                                  08410039
084200             IF PS-NO-ERROR                                       08420039
084300                                                                  08430039
084400                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             08440039
084500             END-IF                                               08450039
084600                                                                  08460039
084700                                                                  08470039
084800         WHEN OTHER                                               08480039
084900             SET DP013-CICS-ABEND                                 08490039
085000                 DP013-NO-ROLLBACK                                08500039
085100                 DP013-XCTL-DISPLAY-RESTART                       08510039
085200                                 TO TRUE                          08520039
085300             MOVE '2100-CHECK-FUNCTION-KEY'                       08530039
085400                                 TO DP013-PARAGRAPH               08540039
085500             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      08550039
085600                                 TO DP013-MESSAGE-TEXT (1)        08560039
085700                                                                  08570039
085800             PERFORM DP013-0000-PROCESS-ABEND                     08580039
085900     END-EVALUATE.                                                08590039
086000                                                                  08600039
086100 2110-BROWSE-BACKWARD.                                            08610039
086200                                                                  08620039
086300     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    08630039
086400         GIVING PV-TOP-ITEM.                                      08640039
086500                                                                  08650039
086600     IF PV-TOP-ITEM NOT > +1                                      08660039
086700         MOVE +1                 TO PV-TOP-ITEM                   08670039
086800         MOVE PC-TSYMSG-00069    TO DP020-MSG-NUMBER              08680039
086900         SET DP020-MSG-INFORMATIONAL                              08690039
087000                                 TO TRUE.                         08700039
087100                                                                  08710039
087200 2120-BROWSE-FORWARD.                                             08720039
087300                                                                  08730039
087400     PERFORM 3100-SET-SUBSCRIPTS.                                 08740039
087500                                                                  08750039
087600     IF ASC-VEND-STYL-NAME (ASC-BLK-SUB PC-ITEMS-PER-PANEL) =     08760039
087700                                    SPACES                        08770039
087800         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            08780039
087900                                 TO PV-TOP-ITEM                   08790039
088000         MOVE PC-TSYMSG-00070    TO DP020-MSG-NUMBER              08800039
088100         SET DP020-MSG-INFORMATIONAL                              08810039
088200                                 TO TRUE                          08820039
088300     ELSE                                                         08830039
088400                                                                  08840039
088500         ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL          08850039
088600             GIVING PV-TOP-ITEM                                   08860039
088700                                                                  08870039
088800**   IF PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                    08880039
088900**       MOVE ASC-ITEM-AT-TOP-OF-PANEL                            08890039
089000**                               TO PV-TOP-ITEM                   08900039
089100**       MOVE PC-TSYMSG-00070    TO DP020-MSG-NUMBER              08910039
089200**       SET DP020-MSG-INFORMATIONAL                              08920039
089300**                               TO TRUE                          08930039
089400**   ELSE                                                         08940039
089500         COMPUTE PV-BOTTOM-ITEM =                                 08950039
089600             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 08960039
089700**       IF PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ             08970039
089800**           MOVE PC-TSYMSG-00070                                 08980039
089900**                               TO DP020-MSG-NUMBER              08990039
090000**           SET DP020-MSG-INFORMATIONAL                          09000039
090100**                               TO TRUE.                         09010039
090200     END-IF.                                                      09020039
090300                                                                  09030039
090400 2130-CHECK-FOR-JUMP-BROWSE.                                      09040039
090500                                                                  09050039
090600     SET PS-NO-ERROR             TO TRUE.                         09060039
090700                                                                  09070039
090800     IF ASC-START-ITEM-REQUEST = SPACE                            09080039
090900         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            09090039
091000                                 TO PV-TOP-ITEM                   09100039
091100     ELSE                                                         09110039
091200         MOVE ASC-START-ITEM-REQUEST                              09120039
091300                                 TO DP010I-UNEDITED-FIELD         09130039
091400         MOVE +5                 TO DP010I-MAXIMUM-DIGITS         09140039
091500         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       09150039
091600         SET DP010I-NEGATIVE-NOT-ALLOWED                          09160039
091700                                 TO TRUE                          09170039
091800                                                                  09180039
091910         CALL DP010I-NUMERIC-EDIT-ROUTINE                         09191044
091920              USING DP010I-NUMERIC-EDIT-AREA                      09192044
092000                                                                  09200039
092100         IF NOT DP010I-ERROR-DETECTED                             09210039
092200             MOVE DP010I-NUMERIC-FIELD                            09220039
092300                                 TO ASC-START-ITEM-REQUEST-N      09230039
092400             IF ASC-START-ITEM-REQUEST-N > ZERO                   09240039
092500                IF ASC-START-ITEM-REQUEST-N >                     09250039
092600                                          ASC-NUMBER-OF-ITEMS-READ09260039
092700                    MOVE SPACE   TO ASC-START-ITEM-REQUEST        09270039
092800                    COMPUTE PV-TOP-ITEM = ASC-NUMBER-OF-ITEMS-READ09280039
092900                                          - PC-ITEMS-PER-PANEL + 109290039
093000                    IF PV-TOP-ITEM < +1                           09300039
093100                        MOVE +1  TO PV-TOP-ITEM                   09310039
093200                        MOVE PC-TSYMSG-00070                      09320039
093300                                 TO DP020-MSG-NUMBER              09330039
093400                        SET DP020-MSG-INFORMATIONAL               09340039
093500                                 TO TRUE                          09350039
093600                    END-IF                                        09360039
093700                ELSE                                              09370039
093800                    MOVE ASC-START-ITEM-REQUEST-N                 09380039
093900                                 TO PV-TOP-ITEM                   09390039
094000                    MOVE SPACE   TO ASC-START-ITEM-REQUEST        09400039
094100                    COMPUTE PV-BOTTOM-ITEM = PV-TOP-ITEM +        09410039
094200                                            PC-ITEMS-PER-PANEL - 109420039
094300                    IF PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ  09430039
094400                         MOVE PC-TSYMSG-00070                     09440039
094500                                 TO DP020-MSG-NUMBER              09450039
094600                         SET DP020-MSG-INFORMATIONAL              09460039
094700                                 TO TRUE                          09470039
094800                    END-IF                                        09480039
094900                END-IF                                            09490039
095000             ELSE                                                 09500039
095100                 MOVE PC-TSYMSG-00101                             09510039
095200                                 TO DP020-MSG-NUMBER              09520039
095300                 SET DP030-SET-CURSOR-APPL-1                      09530039
095400                                 TO TRUE                          09540039
095500                 MOVE -1         TO ASTRTITL                      09550039
095600                 MOVE DP015-UNP-NUM-BRT-MDT                       09560039
095700                                 TO ASTRTITA                      09570039
095800                 MOVE DP015-RED  TO ASTRTITC                      09580039
095900                 MOVE DP015-REVERSE                               09590039
096000                                 TO ASTRTITH                      09600039
096100                 SET PS-ERROR                                     09610039
096200                     DP020-MSG-FATAL                              09620039
096300                                 TO TRUE                          09630039
096400             END-IF                                               09640039
096500         ELSE                                                     09650039
096600             MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER             09660039
096700             SET DP030-SET-CURSOR-APPL-1                          09670039
096800                                 TO TRUE                          09680039
096900             MOVE -1             TO ASTRTITL                      09690039
097000             MOVE DP015-UNP-NUM-BRT-MDT                           09700039
097100                                 TO ASTRTITA                      09710039
097200             MOVE DP015-RED      TO ASTRTITC                      09720039
097300             MOVE DP015-REVERSE  TO ASTRTITH                      09730039
097400             SET PS-ERROR                                         09740039
097500                 DP020-MSG-FATAL TO TRUE                          09750039
097600         END-IF                                                   09760039
097700     END-IF.                                                      09770039
097800                                                                  09780039
097900 2140-DESELECT-ALL-ITEMS.                                         09790039
098000                                                                  09800039
098100     MOVE +1                     TO ASC-BLK-SUB.                  09810039
098200                                                                  09820039
098300     PERFORM 2141-CLEAR-SELECTED-INDS                             09830039
098400             VARYING ASC-ITEM-SUB  FROM 1 BY 1                    09840039
098500             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           09850039
098600                                                                  09860039
098700     ADD +1                      TO ASC-BLK-SUB.                  09870039
098800                                                                  09880039
098900     PERFORM 2141-CLEAR-SELECTED-INDS                             09890039
099000             VARYING ASC-ITEM-SUB  FROM 1 BY 1                    09900039
099100             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           09910039
099200                                                                  09920039
099300     MOVE ASC-LIST-ITEM-NUMBER (1 1)                              09930039
099400                                 TO PV-LIST-ITEM-NUMBER.          09940039
099500                                                                  09950039
099600     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            09960039
099700             1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).09970039
099800                                                                  09980039
099900     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     09990039
100000              (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)10000039
100100         MOVE +1                 TO ASC-BLK-SUB                   10010039
100200                                                                  10020039
100300         PERFORM 5100-WRITE-TEMP-STORAGE                          10030039
100400                                                                  10040039
100500         MOVE +1                 TO PV-BLOCK-NUMBER               10050039
100600                                                                  10060039
100700         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         10070039
100800                                       PV-FIRST-BLOCK-IN-ARRAY - 110080039
100900                                                                  10090039
101000         PERFORM                                                  10100039
101100           UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY         10110039
101200                                                                  10120039
101300                 PERFORM 4410-READ-TEMP-STORAGE                   10130039
101400                                                                  10140039
101500                 PERFORM 2141-CLEAR-SELECTED-INDS                 10150039
101600                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        10160039
101700                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL10170039
101800                                                                  10180039
101900                 PERFORM 5100-WRITE-TEMP-STORAGE                  10190039
102000                                                                  10200039
102100                 ADD +1          TO PV-BLOCK-NUMBER               10210039
102200                                                                  10220039
102300         END-PERFORM                                              10230039
102400                                                                  10240039
102500         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         10250039
102600                  PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY10260039
102700                                                                  10270039
102800         PERFORM                                                  10280039
102900           UNTIL PV-NEXT-BLOCK-IN-ARRAY >                         10290039
103000                                         ASC-HIGHEST-BLOCK-WRITTEN10300039
103100                                                                  10310039
103200                 MOVE PV-NEXT-BLOCK-IN-ARRAY                      10320039
103300                                 TO PV-BLOCK-NUMBER               10330039
103400                                                                  10340039
103500                 PERFORM 4410-READ-TEMP-STORAGE                   10350039
103600                                                                  10360039
103700                 PERFORM 2141-CLEAR-SELECTED-INDS                 10370039
103800                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        10380039
103900                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL10390039
104000                                                                  10400039
104100                 PERFORM 5100-WRITE-TEMP-STORAGE                  10410039
104200                                                                  10420039
104300                 ADD +1          TO PV-NEXT-BLOCK-IN-ARRAY        10430039
104400                                                                  10440039
104500         END-PERFORM                                              10450039
104600                                                                  10460039
104700         MOVE PV-FIRST-BLOCK-IN-ARRAY                             10470039
104800                                 TO PV-BLOCK-NUMBER               10480039
104900                                                                  10490039
105000         PERFORM 4410-READ-TEMP-STORAGE                           10500039
105100                                                                  10510039
105200     END-IF.                                                      10520039
105300                                                                  10530039
105400     MOVE ZERO                   TO ASC-NUMBER-OF-SELECTED-ITEMS  10540039
105500                                    ASC-START-OF-SELECTED-RANGE   10550039
105600                                    ASC-END-OF-SELECTED-RANGE.    10560039
105700                                                                  10570039
105800     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        10580039
105900                                                                  10590039
106000 2141-CLEAR-SELECTED-INDS.                                        10600039
106100                                                                  10610039
106200     IF ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB) NOT = ZERO10620039
106300        IF NOT ASC-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)           10630039
106400            SET ASC-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)          10640039
106500                ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)     10650039
106600                ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                  10660039
106700                                 TO TRUE.                         10670039
106800                                                                  10680039
106900 2150-SELECT-ALL-ITEMS.                                           10690039
107000                                                                  10700039
107100     MOVE +1                     TO ASC-BLK-SUB.                  10710039
107200                                                                  10720039
107300     PERFORM 2151-SET-SELECTED-INDS                               10730039
107400             VARYING ASC-ITEM-SUB FROM 1 BY 1                     10740039
107500             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           10750039
107600                                                                  10760039
107700     ADD +1                      TO ASC-BLK-SUB.                  10770039
107800                                                                  10780039
107900     PERFORM 2151-SET-SELECTED-INDS                               10790039
108000             VARYING ASC-ITEM-SUB FROM 1 BY 1                     10800039
108100             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           10810039
108200                                                                  10820039
108300     MOVE ASC-LIST-ITEM-NUMBER (1 1)                              10830039
108400                                 TO PV-LIST-ITEM-NUMBER.          10840039
108500                                                                  10850039
108600     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            10860039
108700             1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).10870039
108800                                                                  10880039
108900     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     10890039
109000              (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)10900039
109100         MOVE +1                 TO ASC-BLK-SUB                   10910039
109200                                                                  10920039
109300         PERFORM 5100-WRITE-TEMP-STORAGE                          10930039
109400                                                                  10940039
109500         MOVE +1                 TO PV-BLOCK-NUMBER               10950039
109600                                                                  10960039
109700         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         10970039
109800                                       PV-FIRST-BLOCK-IN-ARRAY - 110980039
109900                                                                  10990039
110000         PERFORM                                                  11000039
110100           UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY         11010039
110200                                                                  11020039
110300                 PERFORM 4410-READ-TEMP-STORAGE                   11030039
110400                                                                  11040039
110500                 PERFORM 2151-SET-SELECTED-INDS                   11050039
110600                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        11060039
110700                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL11070039
110800                                                                  11080039
110900                 PERFORM 5100-WRITE-TEMP-STORAGE                  11090039
111000                                                                  11100039
111100                 ADD +1          TO PV-BLOCK-NUMBER               11110039
111200                                                                  11120039
111300         END-PERFORM                                              11130039
111400                                                                  11140039
111500         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         11150039
111600                  PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY11160039
111700                                                                  11170039
111800         PERFORM                                                  11180039
111900           UNTIL PV-NEXT-BLOCK-IN-ARRAY >                         11190039
112000                                         ASC-HIGHEST-BLOCK-WRITTEN11200039
112100                                                                  11210039
112200                 MOVE PV-NEXT-BLOCK-IN-ARRAY                      11220039
112300                                 TO PV-BLOCK-NUMBER               11230039
112400                                                                  11240039
112500                 PERFORM 4410-READ-TEMP-STORAGE                   11250039
112600                                                                  11260039
112700                 PERFORM 2151-SET-SELECTED-INDS                   11270039
112800                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        11280039
112900                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL11290039
113000                                                                  11300039
113100                 PERFORM 5100-WRITE-TEMP-STORAGE                  11310039
113200                                                                  11320039
113300                 ADD +1          TO PV-NEXT-BLOCK-IN-ARRAY        11330039
113400                                                                  11340039
113500         END-PERFORM                                              11350039
113600                                                                  11360039
113700         MOVE PV-FIRST-BLOCK-IN-ARRAY                             11370039
113800                                 TO PV-BLOCK-NUMBER               11380039
113900                                                                  11390039
114000         PERFORM 4410-READ-TEMP-STORAGE                           11400039
114100     END-IF.                                                      11410039
114200                                                                  11420039
114300     MOVE ASC-NUMBER-OF-ITEMS-READ                                11430039
114400                                 TO ASC-NUMBER-OF-SELECTED-ITEMS. 11440039
114500                                                                  11450039
114600     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        11460039
114700                                                                  11470039
114800 2151-SET-SELECTED-INDS.                                          11480039
114900                                                                  11490039
115000     IF ASC-VEND-STYL-NAME (ASC-BLK-SUB ASC-ITEM-SUB) NOT = SPACES11500039
115100        IF NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)              11510039
115200            SET ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)             11520039
115300                ASC-TEMP-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        11530039
115400                ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                  11540039
115500                                 TO TRUE                          11550039
115600        END-IF                                                    11560039
115700     END-IF.                                                      11570039
115800                                                                  11580039
115900 2200-MOVE-SCREEN-TO-COMMAREA.                                    11590039
116000                                                                  11600039
116100     MOVE PV-TOP-ITEM            TO PV-ITEM-IN-USE.               11610039
116200     MOVE +1                     TO PV-SUB.                       11620039
116300                                                                  11630039
116400     PERFORM 3100-SET-SUBSCRIPTS.                                 11640039
116500                                                                  11650039
116600                                                                  11660039
116700     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          11670039
116800             VARYING PV-SUB  FROM 1 BY 1                          11680039
116900             UNTIL   PV-SUB > PC-ITEMS-PER-PANEL.                 11690039
117000                                                                  11700039
117100 2210-MOVE-LINES-TO-COMMAREA.                                     11710039
117200                                                                  11720039
117300     IF MR-SELECTL (PV-SUB) > ZERO                                11730039
117400         SET ASC-BLOCK-MODIFIED    (ASC-BLK-SUB)                  11740039
117500                                 TO TRUE                          11750039
117600         MOVE MR-SELECTI (PV-SUB)                                 11760039
117700                                 TO ASC-TEMP-SELECTED-SW          11770039
117800                                   (ASC-BLK-SUB ASC-ITEM-SUB)     11780039
117900     ELSE                                                         11790039
118000         IF MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                 11800039
118100             SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                 11810039
118200                                 TO TRUE                          11820039
118300             MOVE SPACE          TO ASC-TEMP-SELECTED-SW          11830039
118400                                   (ASC-BLK-SUB ASC-ITEM-SUB)     11840039
118500         END-IF                                                   11850039
118600     END-IF.                                                      11860039
118700                                                                  11870039
118800     IF MR-VEND-STYL-NAME-L (PV-SUB) > ZERO                       11880039
118900         SET ASC-BLOCK-MODIFIED    (ASC-BLK-SUB)                  11890039
119000             ASC-STYLE-MODIFIED    (ASC-BLK-SUB ASC-ITEM-SUB)     11900039
119100                                 TO TRUE                          11910039
119200         MOVE MR-VEND-STYL-NAME (PV-SUB)                          11920039
119300                                 TO ASC-VEND-STYL-NAME            11930039
119400                                   (ASC-BLK-SUB ASC-ITEM-SUB)     11940039
119500     ELSE                                                         11950039
119600         IF MR-VEND-STYL-NAME-A (PV-SUB) = DP015-ERASE-EOF        11960039
119700             SET ASC-BLOCK-MODIFIED    (ASC-BLK-SUB)              11970039
119800                 ASC-STYLE-MODIFIED    (ASC-BLK-SUB ASC-ITEM-SUB) 11980039
119900                                 TO TRUE                          11990039
120000             MOVE SPACES         TO ASC-VEND-STYL-NAME            12000039
120100                                   (ASC-BLK-SUB ASC-ITEM-SUB)     12010039
120200         END-IF                                                   12020039
120300     END-IF.                                                      12030039
120400                                                                  12040039
120500     IF MR-UNIT-QTY-L (PV-SUB) > ZERO                             12050039
120600         SET ASC-BLOCK-MODIFIED    (ASC-BLK-SUB)                  12060039
120700                                 TO TRUE                          12070039
120800         MOVE MR-UNIT-QTY (PV-SUB)                                12080039
120900                                 TO ASC-UNIT-QTY                  12090039
121000                                   (ASC-BLK-SUB ASC-ITEM-SUB)     12100039
121100     ELSE                                                         12110039
121200         IF MR-UNIT-QTY-A (PV-SUB) = DP015-ERASE-EOF              12120039
121300             SET ASC-BLOCK-MODIFIED    (ASC-BLK-SUB)              12130039
121400                                 TO TRUE                          12140039
121500             MOVE ZEROS          TO ASC-UNIT-QTY-N                12150039
121600                                   (ASC-BLK-SUB ASC-ITEM-SUB)     12160039
121700         END-IF                                                   12170039
121800     END-IF.                                                      12180039
121900                                                                  12190039
122000     ADD +1                      TO ASC-ITEM-SUB.                 12200039
122100                                                                  12210039
122200     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         12220039
122300         ADD  +1                 TO ASC-BLK-SUB                   12230039
122400         MOVE +1                 TO ASC-ITEM-SUB                  12240039
122500     END-IF.                                                      12250039
122600                                                                  12260039
122700 3000-EDIT-DATA-IN-COMMAREA.                                      12270039
122800                                                                  12280039
122900     PERFORM 3100-SET-SUBSCRIPTS.                                 12290039
123000     MOVE ASC-BLK-SUB TO PV-SAVE-BLOCK-SUB.                       12300039
123100     MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)                    12310039
123200                             TO PV-LIST-ITEM-NUMBER.              12320039
123300     COMPUTE PV-SAVE-ITEM-SUB = 1 +                               12330039
123400             ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    12340039
123500     PERFORM 3050-FILL-SPACES                                     12350039
123600             VARYING PV-SUB  FROM 1 BY +1                         12360039
123700             UNTIL   PV-SUB > PC-ITEMS-PER-PANEL.                 12370039
123800                                                                  12380039
123900     SET PS-NO-ERROR             TO TRUE.                         12390039
124000                                                                  12400039
124100     PERFORM 3200-RESET-ATTRIBUTES.                               12410039
124200                                                                  12420039
124300*    MOVE ASC-ITEMS-DISPLAYED    TO PV-SUB.                       12430039
124400                                                                  12440039
124500     IF PS-NO-ERROR                                               12450039
124600         MOVE PC-ITEMS-PER-PANEL     TO PV-SUB                    12460039
124700         COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                   12470039
124800                                     PC-ITEMS-PER-PANEL - 1       12480039
124900         PERFORM 3100-SET-SUBSCRIPTS                              12490039
125000                                                                  12500039
125100         MOVE ASC-KEY-PO-NBR-N       TO DK-PO-NBR                 12510039
125200                                                                  12520039
125300         PERFORM 3300-EDIT-SELECTIONS                             12530039
125400                 VARYING PV-SUB  FROM PV-SUB BY -1                12540039
125500                 UNTIL   PV-SUB < +1                              12550039
125600     END-IF.                                                      12560039
125700                                                                  12570039
125800     IF PS-NO-ERROR                                               12580039
125900         PERFORM 3400-CHECK-RANGE-SEQUENCE                        12590039
126000     END-IF.                                                      12600039
126100                                                                  12610039
126200     IF PS-NO-ERROR AND                                           12620039
126300        ASC-START-OF-SELECTED-RANGE > ZERO AND                    12630039
126400        ASC-END-OF-SELECTED-RANGE > ZERO                          12640039
126500                                                                  12650039
126600         PERFORM 3500-MARK-RANGE-AS-SELECTED                      12660039
126700     END-IF.                                                      12670039
126800                                                                  12680039
126900                                                                  12690039
127000*    PERFORM 3100-SET-SUBSCRIPTS.                                 12700039
127100*    MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)                    12710039
127200*                            TO PV-LIST-ITEM-NUMBER.              12720039
127300*    COMPUTE PV-SAVE-ITEM-SUB = 1 +                               12730039
127400*            ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    12740039
127500     PERFORM 3600-SEARCH-LIST-QUEUE.                              12750039
127600                                                                  12760039
127700 3050-FILL-SPACES.                                                12770039
127800                                                                  12780039
127900     IF ASC-VEND-STYL-NAME (ASC-BLK-SUB PV-SUB) = SPACES          12790039
128000         IF PV-SUB NOT = PC-ITEMS-PER-PANEL                       12800039
128100             COMPUTE PV-SUB-ADJUST = PV-SUB + 1                   12810039
128200             PERFORM 3060-MOVE-TO-OPEN-SPOT                       12820039
128300                 VARYING PV-SUB-ADJUST FROM PV-SUB-ADJUST BY 1    12830039
128400                 UNTIL  PV-SUB-ADJUST > PC-ITEMS-PER-PANEL        12840039
128500         END-IF                                                   12850039
128600     END-IF.                                                      12860039
128700                                                                  12870039
128800 3060-MOVE-TO-OPEN-SPOT.                                          12880039
128900     IF ASC-VEND-STYL-NAME (ASC-BLK-SUB PV-SUB-ADJUST)            12890039
129000               NOT = SPACES                                       12900039
129100         MOVE ASC-VEND-STYL-NAME                                  12910039
129200                     (ASC-BLK-SUB PV-SUB-ADJUST) TO               12920039
129300             ASC-VEND-STYL-NAME (ASC-BLK-SUB       PV-SUB)        12930039
129400             MR-VEND-STYL-NAME (PV-SUB)                           12940039
129500         MOVE ASC-UNIT-QTY                                        12950039
129600                     (ASC-BLK-SUB PV-SUB-ADJUST) TO               12960039
129700             ASC-UNIT-QTY       (ASC-BLK-SUB       PV-SUB)        12970039
129800             MR-UNIT-QTY-EDITED (PV-SUB)                          12980039
129900         MOVE SPACES TO ASC-VEND-STYL-NAME                        12990039
130000                     (ASC-BLK-SUB PV-SUB-ADJUST)                  13000039
130100                        ASC-UNIT-QTY                              13010039
130200                     (ASC-BLK-SUB PV-SUB-ADJUST)                  13020039
130300         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO                  13030039
130400              TRUE                                                13040039
130500         MOVE PC-ITEMS-PER-PANEL TO PV-SUB-ADJUST                 13050039
130600     END-IF.                                                      13060039
130700                                                                  13070039
130800 3100-SET-SUBSCRIPTS.                                             13080039
130900                                                                  13090039
131000     COMPUTE ASC-ITEM-SUB =                                       13100039
131100                (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER (1 1)) + 1.13110039
131200                                                                  13120039
131300     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         13130039
131400         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            13140039
131500         MOVE PC-MAX-BLOCKS-IN-ARRAY                              13150039
131600                                 TO ASC-BLK-SUB                   13160039
131700     ELSE                                                         13170039
131800         MOVE +1                 TO ASC-BLK-SUB                   13180039
131900     END-IF.                                                      13190039
132000                                                                  13200039
132100 3200-RESET-ATTRIBUTES.                                           13210039
132200                                                                  13220039
132300     MOVE DP015-UNP-ALP-NOR-OFF  TO ASTRTITA.                     13230039
132400     MOVE DP015-GREEN            TO ASTRTITC.                     13240039
132500     MOVE DP015-UNDERLINE        TO ASTRTITH.                     13250039
132600                                                                  13260039
132700     IF DP020-NEXT-ACT-RETURN OR                                  13270039
132800        DP020-NEXT-ACT-READ-MAP                                   13280039
132900         PERFORM VARYING PV-SUB  FROM 1 BY 1                      13290039
133000*                UNTIL   PV-SUB > ASC-ITEMS-DISPLAYED             13300039
133100                 UNTIL   PV-SUB > PC-ITEMS-PER-PANEL              13310039
133200                 MOVE DP015-PRO-NOR-OFF                           13320039
133300                                 TO MR-SELECTA (PV-SUB)           13330039
133400                 MOVE DP015-UNP-ALP-NOR-OFF                       13340039
133500                                 TO MR-VEND-STYL-NAME-A (PV-SUB)  13350039
133600                 MOVE DP015-UNP-NUM-NOR-OFF                       13360039
133700                                 TO MR-UNIT-QTY-A       (PV-SUB)  13370039
133800                 MOVE DP015-GREEN                                 13380039
133900                                 TO MR-SELECTC (PV-SUB)           13390039
134000                                    MR-VEND-STYL-NAME-C (PV-SUB)  13400039
134100                                    MR-UNIT-QTY-C       (PV-SUB)  13410039
134200                 MOVE DP015-UNDERLINE                             13420039
134300                                 TO MR-SELECTH (PV-SUB)           13430039
134400                                    MR-VEND-STYL-NAME-H (PV-SUB)  13440039
134500                                    MR-UNIT-QTY-H       (PV-SUB)  13450039
134600         END-PERFORM                                              13460039
134700     ELSE                                                         13470039
134800         PERFORM VARYING PV-SUB  FROM 1 BY 1                      13480039
134900                 UNTIL   PV-SUB > PC-ITEMS-PER-PANEL              13490039
135000                 MOVE DP015-PRO-NOR-OFF                           13500039
135100                                 TO MR-SELECTA (PV-SUB)           13510039
135200                 MOVE DP015-UNP-ALP-NOR-OFF                       13520039
135300                                 TO MR-VEND-STYL-NAME-A (PV-SUB)  13530039
135400                 MOVE DP015-UNP-NUM-NOR-OFF                       13540039
135500                                 TO MR-UNIT-QTY-A       (PV-SUB)  13550039
135600                 MOVE DP015-GREEN                                 13560039
135700                                 TO MR-SELECTC (PV-SUB)           13570039
135800                                    MR-VEND-STYL-NAME-C (PV-SUB)  13580039
135900                                    MR-UNIT-QTY-C       (PV-SUB)  13590039
136000                 MOVE DP015-UNDERLINE                             13600039
136100                                 TO MR-SELECTH (PV-SUB)           13610039
136200                                    MR-VEND-STYL-NAME-H (PV-SUB)  13620039
136300                                    MR-UNIT-QTY-H       (PV-SUB)  13630039
136400         END-PERFORM                                              13640039
136500     END-IF.                                                      13650039
136600                                                                  13660039
136700 3300-EDIT-SELECTIONS.                                            13670039
136800                                                                  13680039
136900     EVALUATE TRUE                                                13690039
137000         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) =   13700039
137100                   ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     13710039
137200              CONTINUE                                            13720039
137300                                                                  13730039
137400         WHEN ASC-TEMP-SELECT   (ASC-BLK-SUB ASC-ITEM-SUB)        13740039
137500              IF NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        13750039
137600                  ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS  13760039
137700                  MOVE ASC-TEMP-SELECTED-SW                       13770039
137800                                        (ASC-BLK-SUB ASC-ITEM-SUB)13780039
137900                                 TO ASC-SELECTED-SW               13790039
138000                                        (ASC-BLK-SUB ASC-ITEM-SUB)13800039
138100              END-IF                                              13810039
138200                                                                  13820039
138300         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) =   13830039
138400                                                             SPACE13840039
138500              EVALUATE TRUE                                       13850039
138600                  WHEN ASC-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)     13860039
138700                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS13870039
138800                     MOVE SPACE  TO ASC-SELECTED-SW               13880039
138900                                   (ASC-BLK-SUB ASC-ITEM-SUB)     13890039
139000                                                                  13900039
139100                  WHEN ASC-BEGIN   (ASC-BLK-SUB ASC-ITEM-SUB)     13910039
139200                       MOVE ZERO TO ASC-START-OF-SELECTED-RANGE   13920039
139300                       MOVE SPACE                                 13930039
139400                                 TO ASC-SELECTED-SW               13940039
139500                                   (ASC-BLK-SUB ASC-ITEM-SUB)     13950039
139600                                                                  13960039
139700                  WHEN ASC-END     (ASC-BLK-SUB ASC-ITEM-SUB)     13970039
139800                       MOVE ZERO TO ASC-END-OF-SELECTED-RANGE     13980039
139900                       MOVE SPACE                                 13990039
140000                                 TO ASC-SELECTED-SW               14000039
140100                                   (ASC-BLK-SUB ASC-ITEM-SUB)     14010039
140200             END-EVALUATE                                         14020039
140300                                                                  14030039
140400         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           14040039
140500              IF ASC-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)           14050039
140600                  SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS   14060039
140700              END-IF                                              14070039
140800                                                                  14080039
140900              PERFORM 3310-EDIT-RANGE                             14090039
141000                                                                  14100039
141100         WHEN ASC-TEMP-END  (ASC-BLK-SUB ASC-ITEM-SUB)            14110039
141200              IF ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            14120039
141300                  SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS   14130039
141400              END-IF                                              14140039
141500                                                                  14150039
141600              PERFORM 3310-EDIT-RANGE                             14160039
141700                                                                  14170039
141800         WHEN OTHER                                               14180039
141900              MOVE PC-TSYMSG-00005                                14190039
142000                                 TO DP020-MSG-NUMBER              14200039
142100              SET PS-ERROR                                        14210039
142200                  DP020-MSG-FATAL                                 14220039
142300                  DP030-SET-CURSOR-APPL-1                         14230039
142400                                 TO TRUE                          14240039
142500              MOVE -1            TO MR-VEND-STYL-NAME-L (PV-SUB)  14250039
142600              MOVE DP015-RED     TO MR-VEND-STYL-NAME-C (PV-SUB)  14260039
142700              MOVE DP015-REVERSE TO MR-VEND-STYL-NAME-H (PV-SUB)  14270039
142800              IF ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            14280039
142900                  SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    14290039
143000                  MOVE SPACE     TO ASC-SELECTED-SW               14300039
143100                                   (ASC-BLK-SUB ASC-ITEM-SUB)     14310039
143200              END-IF                                              14320039
143300     END-EVALUATE.                                                14330039
143400                                                                  14340039
143500     IF ASC-STYLE-MODIFIED    (ASC-BLK-SUB ASC-ITEM-SUB)          14350039
143600         SET PS-STYLE-NUMBER-CHANGED TO TRUE                      14360039
143700     END-IF.                                                      14370039
143800                                                                  14380039
143900                                                                  14390039
144000     IF ASC-VEND-STYL-NAME (ASC-BLK-SUB ASC-ITEM-SUB) NOT =       14400039
144100                                         SPACES                   14410039
144200         MOVE ASC-VEND-STYL-NAME (ASC-BLK-SUB ASC-ITEM-SUB) TO    14420039
144300                                        DK-VEND-STYL-NAME         14430039
144400         PERFORM 3350-SELECT-TPURITM-DATA                         14440039
144500         PERFORM 5400-SELECT-TPKITEM                              14450039
144600         IF PS-PKITEM-FOUND                                       14460039
144700             SET DP030-SET-CURSOR-APPL-1                          14470039
144800                 PS-ERROR                                         14480039
144900                 DP020-MSG-FATAL TO TRUE                          14490039
145000             MOVE PC-REC-ALREADY-EXISTS TO ASC-DESC               14500039
145100                                   (ASC-BLK-SUB ASC-ITEM-SUB)     14510039
145200                                    MR-DESC            (PV-SUB)   14520039
145300             MOVE -1              TO                              14530039
145400                              MR-VEND-STYL-NAME-L (PV-SUB)        14540039
145500             MOVE DP015-RED       TO                              14550039
145600                              MR-VEND-STYL-NAME-C (PV-SUB)        14560039
145700             MOVE DP015-UNDERLINE TO                              14570039
145800                              MR-VEND-STYL-NAME-H (PV-SUB)        14580039
145900             MOVE PC-TSYMSG-00148                                 14590039
146000                                 TO DP020-MSG-NUMBER              14600039
146100             MOVE ZERO           TO ASC-PO-NBR                    14610039
146200                                  (ASC-BLK-SUB ASC-ITEM-SUB)      14620039
146300             MOVE ZERO           TO ASC-VER-NBR                   14630039
146400                                  (ASC-BLK-SUB ASC-ITEM-SUB)      14640039
146500             MOVE ZERO           TO ASC-PO-LINE-NBR               14650039
146600                                  (ASC-BLK-SUB ASC-ITEM-SUB)      14660039
146700                                   MR-PO-LINE-NBR-EDITED          14670039
146800                                                      (PV-SUB)    14680039
146900             MOVE ZERO           TO ASC-UNT-COST-AMT              14690039
147000                                  (ASC-BLK-SUB ASC-ITEM-SUB)      14700039
147100                                   MR-UNT-COST-AMT-EDITED         14710039
147200                                                      (PV-SUB)    14720039
147300         END-IF                                                   14730039
147400     ELSE                                                         14740039
147500         MOVE ZERO                TO ASC-PO-NBR                   14750039
147600                                   (ASC-BLK-SUB ASC-ITEM-SUB)     14760039
147700         MOVE ZERO                TO ASC-VER-NBR                  14770039
147800                                   (ASC-BLK-SUB ASC-ITEM-SUB)     14780039
147900         MOVE ZERO                TO ASC-PO-LINE-NBR              14790039
148000                                   (ASC-BLK-SUB ASC-ITEM-SUB)     14800039
148100                                    MR-PO-LINE-NBR-EDITED         14810039
148200                                                       (PV-SUB)   14820039
148300         MOVE ZERO                TO ASC-UNT-COST-AMT             14830039
148400                                   (ASC-BLK-SUB ASC-ITEM-SUB)     14840039
148500                                    MR-UNT-COST-AMT-EDITED        14850039
148600                                                       (PV-SUB)   14860039
148700         MOVE SPACES              TO ASC-DESC                     14870039
148800                                   (ASC-BLK-SUB ASC-ITEM-SUB)     14880039
148900                                    MR-DESC            (PV-SUB)   14890039
149000     END-IF.                                                      14900039
149100                                                                  14910039
149200     IF ASC-UNIT-QTY (ASC-BLK-SUB ASC-ITEM-SUB) > ZERO            14920039
149300         IF ASC-VEND-STYL-NAME (ASC-BLK-SUB ASC-ITEM-SUB) =       14930039
149400                                    SPACES                        14940039
149500             MOVE ASC-UNIT-QTY-N   (ASC-BLK-SUB ASC-ITEM-SUB)     14950039
149600                               TO   MR-UNIT-QTY-EDITED (PV-SUB)   14960039
149700             SET PS-ERROR                                         14970039
149800                 DP020-MSG-FATAL                                  14980039
149900                 DP030-SET-CURSOR-APPL-1                          14990039
150000                               TO TRUE                            15000039
150100             MOVE PC-TSYMSG-00005                                 15010039
150200                               TO DP020-MSG-NUMBER                15020039
150300             MOVE DP015-UNP-NUM-BRT-OFF                           15030039
150400                               TO MR-UNIT-QTY-A (PV-SUB)          15040039
150500             MOVE -1           TO MR-UNIT-QTY-L (PV-SUB)          15050039
150600             MOVE DP015-RED    TO MR-UNIT-QTY-C (PV-SUB)          15060039
150700             MOVE DP015-REVERSE                                   15070039
150800                               TO MR-UNIT-QTY-H (PV-SUB)          15080039
150900             SET DP030-SET-CURSOR-APPL-1                          15090039
151000                               TO TRUE                            15100039
151100         ELSE                                                     15110039
151200             MOVE ASC-UNIT-QTY (ASC-BLK-SUB ASC-ITEM-SUB)         15120039
151300                                       TO DP010I-UNEDITED-FIELD   15130039
151400             MOVE LENGTH OF ASC-UNIT-QTY                          15140039
151500                                   (ASC-BLK-SUB ASC-ITEM-SUB)     15150039
151600                                   TO DP010I-MAXIMUM-DIGITS       15160039
151700             MOVE ZERO             TO DP010I-MAXIMUM-DECIMALS     15170039
151800             SET DP010I-NEGATIVE-NOT-ALLOWED                      15180039
151900                                   TO TRUE                        15190039
152010             CALL DP010I-NUMERIC-EDIT-ROUTINE                     15201044
152020                  USING DP010I-NUMERIC-EDIT-AREA                  15202044
152100                                                                  15210039
152200             IF  DP010I-ERROR-DETECTED                            15220039
152300                 SET PS-ERROR                                     15230039
152400                     DP020-MSG-FATAL                              15240039
152500                     DP030-SET-CURSOR-APPL-1                      15250039
152600                                   TO TRUE                        15260039
152700                 MOVE PC-TSYMSG-00005                             15270039
152800                                   TO DP020-MSG-NUMBER            15280039
152900                 MOVE DP015-UNP-NUM-BRT-OFF                       15290039
153000                                   TO MR-UNIT-QTY-A (PV-SUB)      15300039
153100                 MOVE -1           TO MR-UNIT-QTY-L (PV-SUB)      15310039
153200                 MOVE DP015-RED    TO MR-UNIT-QTY-C (PV-SUB)      15320039
153300                 MOVE DP015-REVERSE                               15330039
153400                                   TO MR-UNIT-QTY-H (PV-SUB)      15340039
153500                 SET DP030-SET-CURSOR-APPL-1                      15350039
153600                                   TO TRUE                        15360039
153700                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     15370039
153800             ELSE                                                 15380039
153900                 MOVE DP010I-NUMERIC-FIELD                        15390039
154000                                   TO ASC-UNIT-QTY-N              15400039
154100                                     (ASC-BLK-SUB ASC-ITEM-SUB)   15410039
154200                                      MR-UNIT-QTY-EDITED (PV-SUB) 15420039
154300             END-IF                                               15430039
154400     ELSE                                                         15440039
154500         IF ASC-VEND-STYL-NAME (ASC-BLK-SUB ASC-ITEM-SUB) NOT =   15450039
154600                                    SPACES                        15460039
154700*            PERFORM 4200-CALC-OPEN-TO-REC                        15470039
154800*            MOVE PV-OPEN-TO-REC  TO ASC-UNIT-QTY-N               15480039
154900*                                  (ASC-BLK-SUB ASC-ITEM-SUB)     15490039
155000*                                   MR-UNIT-QTY-EDITED (PV-SUB)   15500039
155100             SET PS-ERROR                                         15510039
155200                 DP020-MSG-FATAL                                  15520039
155300                 DP030-SET-CURSOR-APPL-1                          15530039
155400                               TO TRUE                            15540039
155500             MOVE PC-TSYMSG-00007                                 15550039
155600                               TO DP020-MSG-NUMBER                15560039
155700             MOVE DP015-UNP-NUM-BRT-OFF                           15570039
155800                               TO MR-UNIT-QTY-A (PV-SUB)          15580039
155900             MOVE -1           TO MR-UNIT-QTY-L (PV-SUB)          15590039
156000             MOVE DP015-RED    TO MR-UNIT-QTY-C (PV-SUB)          15600039
156100             MOVE DP015-REVERSE                                   15610039
156200                               TO MR-UNIT-QTY-H (PV-SUB)          15620039
156300             SET DP030-SET-CURSOR-APPL-1                          15630039
156400                               TO TRUE                            15640039
156500             SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS         15650039
156600         END-IF                                                   15660039
156700     END-IF.                                                      15670039
156800                                                                  15680039
156900     SUBTRACT +1 FROM PV-ITEM-IN-USE                              15690039
157000                      ASC-ITEM-SUB.                               15700039
157100                                                                  15710039
157200     IF ASC-ITEM-SUB < 1                                          15720039
157300         SUBTRACT +1 FROM ASC-BLK-SUB                             15730039
157400         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  15740039
157500     END-IF.                                                      15750039
157600                                                                  15760039
157700 3310-EDIT-RANGE.                                                 15770039
157800                                                                  15780039
157900     IF ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                 15790039
158000        IF ASC-START-OF-SELECTED-RANGE = ZERO                     15800039
158100            MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)  15810039
158200                   TO ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)  15820039
158300            MOVE PV-ITEM-IN-USE  TO ASC-START-OF-SELECTED-RANGE   15830039
158400        ELSE                                                      15840039
158500            IF ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE       15850039
158600                CONTINUE                                          15860039
158700            ELSE                                                  15870039
158800                MOVE PC-TSYMSG-00054                              15880039
158900                                 TO DP020-MSG-NUMBER              15890039
159000                SET DP020-MSG-FATAL                               15900039
159100                    PS-ERROR                                      15910039
159200                    DP030-SET-CURSOR-APPL-1                       15920039
159300                                 TO TRUE                          15930039
159400                MOVE -1          TO MR-VEND-STYL-NAME-L (PV-SUB)  15940039
159500                MOVE DP015-RED   TO MR-VEND-STYL-NAME-C (PV-SUB)  15950039
159600                MOVE DP015-UNDERLINE                              15960039
159700                                 TO MR-VEND-STYL-NAME-H (PV-SUB)  15970039
159800            END-IF                                                15980039
159900        END-IF                                                    15990039
160000     ELSE                                                         16000039
160100         IF ASC-END-OF-SELECTED-RANGE = ZERO                      16010039
160200             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 16020039
160300                    TO ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 16030039
160400             MOVE PV-ITEM-IN-USE TO ASC-END-OF-SELECTED-RANGE     16040039
160500         ELSE                                                     16050039
160600             IF ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE        16060039
160700                 CONTINUE                                         16070039
160800             ELSE                                                 16080039
160900                MOVE PC-TSYMSG-00055                              16090039
161000                                 TO DP020-MSG-NUMBER              16100039
161100                SET DP020-MSG-FATAL                               16110039
161200                    PS-ERROR                                      16120039
161300                    DP030-SET-CURSOR-APPL-1                       16130039
161400                                 TO TRUE                          16140039
161500                MOVE -1          TO MR-VEND-STYL-NAME-L (PV-SUB)  16150039
161600             END-IF                                               16160039
161700         END-IF                                                   16170039
161800     END-IF.                                                      16180039
161900                                                                  16190039
162000                                                                  16200039
162100 3350-SELECT-TPURITM-DATA.                                        16210039
162200                                                                  16220039
162300     PERFORM WITH TEST AFTER                                      16230039
162400         VARYING PV-RETRY-COUNTER  FROM 1 BY 1                    16240039
162500         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR             16250039
162600                 SQLCODE = ZERO OR                                16260039
162700                 SQLCODE = +100 OR                                16270039
162800                 SQLCODE = -811                                   16280039
162900                                                                  16290039
163000         EXEC SQL                                                 16300039
163100               SELECT PO_NBR,                                     16310039
163200                      VER_NBR,                                    16320039
163300                      UNT_QTY,                                    16330039
163400                      UNT_COST_AMT,                               16340039
163500                      SKU_DESC,                                   16350039
163600                      STATUS_CDE,                                 16360039
163700                      APP_PO_LNE_NBR                              16370039
163800                 INTO :PURITM-PO-NBR,                             16380039
163900                      :PURITM-VER-NBR,                            16390039
164000                      :PURITM-UNT-QTY,                            16400039
164100                      :PURITM-UNT-COST-AMT,                       16410039
164200                      :PURITM-SKU-DESC,                           16420039
164300                      :PURITM-STATUS-CDE,                         16430039
164400                      :PURITM-APP-PO-LNE-NBR                      16440039
164500                 FROM TPURITM                                     16450039
164600                WHERE PO_NBR         = :DK-PO-NBR                 16460039
164700                  AND VEND_STYL_NAME = :DK-VEND-STYL-NAME         16470039
164800                  AND VER_STATUS_CDE = :PC-ACTIVE                 16480039
164900                  AND (STATUS_CDE   ^= :PC-CA                     16490039
165000                  AND  STATUS_CDE   ^= :PC-CB                     16500039
165100                  AND  STATUS_CDE   ^= :PC-CM)                    16510039
165200         END-EXEC                                                 16520039
165300                                                                  16530039
165400         EVALUATE TRUE                                            16540039
165500             WHEN SQLCODE = ZERO                                  16550039
165600             WHEN SQLCODE = +100                                  16560039
165700             WHEN SQLCODE = -811                                  16570039
165800             WHEN SQLCODE = -904                                  16580039
165900             WHEN SQLCODE = -913                                  16590039
166000                  CONTINUE                                        16600039
166100                                                                  16610039
166200             WHEN SQLWARN0 NOT = SPACES                           16620039
166300             WHEN SQLCODE  NOT = ZERO                             16630039
166400                  MOVE '3350-SELECT-TPURITM-DATA'                 16640039
166500                                 TO DP013-PARAGRAPH               16650039
166600                  MOVE 'UNSUCCESSFUL SELECT OF TPURITM DATA'      16660039
166700                                 TO DP013-MESSAGE-TEXT (1)        16670039
166800                  MOVE SQLCA     TO DP013-SQLCA                   16680039
166900                  MOVE 'TPURITM' TO DP013-DB2-TABLE-NAME (1)      16690039
167000                  SET DP013-DB2-ABEND                             16700039
167100                      DP013-XCTL-DISPLAY-RESTART                  16710039
167200                                 TO TRUE                          16720039
167300                                                                  16730039
167400                  PERFORM DP013-0000-PROCESS-ABEND                16740039
167500         END-EVALUATE                                             16750039
167600     END-PERFORM.                                                 16760039
167700                                                                  16770039
167800     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         16780039
167900         MOVE '3350-SELECT-TPURITM-DATA'                          16790039
168000                                 TO DP013-PARAGRAPH               16800039
168100         MOVE 'MAX RETRIES EXCEEDED ON SELECT PO STATUS'          16810039
168200                                 TO DP013-MESSAGE-TEXT (1)        16820039
168300         MOVE SQLCA              TO DP013-SQLCA                   16830039
168400         MOVE 'TPURITM '         TO DP013-DB2-TABLE-NAME (1)      16840039
168500         SET DP013-XCTL-DISPLAY-RESTART                           16850039
168600             DP013-DB2-ABEND     TO TRUE                          16860039
168700                                                                  16870039
168800         PERFORM DP013-0000-PROCESS-ABEND                         16880039
168900     END-IF.                                                      16890039
169000                                                                  16900039
169100     IF SQLCODE = ZERO                                            16910039
169200         IF PURITM-STATUS-CDE = PC-RV                             16920039
169300             SET DP030-SET-CURSOR-APPL-1                          16930039
169400                 PS-ERROR                                         16940039
169500                 DP020-MSG-FATAL   TO TRUE                        16950039
169600             MOVE PC-LINE-IN-RV-STATUS TO ASC-DESC                16960039
169700                                 (ASC-BLK-SUB ASC-ITEM-SUB)       16970039
169800                                 MR-DESC           (PV-SUB)       16980039
169900             MOVE -1              TO MR-VEND-STYL-NAME-L (PV-SUB) 16990039
170000             MOVE DP015-RED       TO MR-VEND-STYL-NAME-C (PV-SUB) 17000039
170100             MOVE DP015-UNDERLINE TO MR-VEND-STYL-NAME-H (PV-SUB) 17010039
170200             MOVE PC-TSYMSG-02762 TO DP020-MSG-NUMBER             17020039
170300         ELSE                                                     17030039
170400             SET ASC-BLOCK-USED (ASC-BLK-SUB) TO TRUE             17040039
170500             MOVE PURITM-PO-NBR       TO ASC-PO-NBR               17050039
170600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 17060039
170700             MOVE PURITM-VER-NBR      TO ASC-VER-NBR              17070039
170800                                       (ASC-BLK-SUB ASC-ITEM-SUB) 17080039
170900             MOVE PURITM-SKU-DESC     TO ASC-DESC                 17090039
171000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 17100039
171100                                       MR-DESC           (PV-SUB) 17110039
171200             MOVE PURITM-VER-NBR      TO ASC-PURITM-VER-NBR       17120039
171300                                       (ASC-BLK-SUB ASC-ITEM-SUB) 17130039
171400         END-IF                                                   17140039
171500         MOVE PURITM-APP-PO-LNE-NBR TO ASC-PO-LINE-NBR            17150039
171600                                        (ASC-BLK-SUB ASC-ITEM-SUB)17160039
171700                                       MR-PO-LINE-NBR-EDITED      17170039
171800                                        (PV-SUB)                  17180039
171900         MOVE PURITM-UNT-COST-AMT   TO ASC-UNT-COST-AMT-N         17190039
172000                                        (ASC-BLK-SUB ASC-ITEM-SUB)17200039
172100                                       MR-UNT-COST-AMT-EDITED     17210039
172200                                        (PV-SUB)                  17220039
172300     ELSE                                                         17230039
172400         MOVE ZERO                TO ASC-PO-NBR                   17240039
172500                                   (ASC-BLK-SUB ASC-ITEM-SUB)     17250039
172600         MOVE ZERO                TO ASC-VER-NBR                  17260039
172700                                   (ASC-BLK-SUB ASC-ITEM-SUB)     17270039
172800         MOVE ZERO                TO ASC-PO-LINE-NBR              17280039
172900                                   (ASC-BLK-SUB ASC-ITEM-SUB)     17290039
173000                                    MR-PO-LINE-NBR-EDITED         17300039
173100                                                       (PV-SUB)   17310039
173200         MOVE ZERO                TO ASC-UNT-COST-AMT             17320039
173300                                   (ASC-BLK-SUB ASC-ITEM-SUB)     17330039
173400                                    MR-UNT-COST-AMT-EDITED        17340039
173500                                                       (PV-SUB)   17350039
173600         MOVE SPACES              TO ASC-DESC                     17360039
173700                                   (ASC-BLK-SUB ASC-ITEM-SUB)     17370039
173800                                    MR-DESC            (PV-SUB)   17380039
173900         IF SQLCODE = +100                                        17390039
174000             SET DP030-SET-CURSOR-APPL-1                          17400039
174100                 PS-ERROR                                         17410039
174200                 DP020-MSG-FATAL TO TRUE                          17420039
174300             MOVE PC-NOT-FOUND-MSG TO ASC-DESC                    17430039
174400                                   (ASC-BLK-SUB ASC-ITEM-SUB)     17440039
174500                                    MR-DESC            (PV-SUB)   17450039
174600             MOVE -1              TO                              17460039
174700                              MR-VEND-STYL-NAME-L (PV-SUB)        17470039
174800             MOVE DP015-RED       TO                              17480039
174900                              MR-VEND-STYL-NAME-C (PV-SUB)        17490039
175000             MOVE DP015-UNDERLINE TO                              17500039
175100                              MR-VEND-STYL-NAME-H (PV-SUB)        17510039
175200             MOVE PC-TSYMSG-00148                                 17520039
175300                                 TO DP020-MSG-NUMBER              17530039
175400         ELSE                                                     17540039
175500             IF SQLCODE = -811                                    17550039
175600                 SET DP030-SET-CURSOR-APPL-1                      17560039
175700                     PS-ERROR                                     17570039
175800                     DP020-MSG-FATAL TO TRUE                      17580039
175900                 MOVE PC-MULTIPLE-LINE-MSG TO ASC-DESC            17590039
176000                                   (ASC-BLK-SUB ASC-ITEM-SUB)     17600039
176100                                    MR-DESC            (PV-SUB)   17610039
176200                 MOVE -1              TO                          17620039
176300                                  MR-VEND-STYL-NAME-L (PV-SUB)    17630039
176400                 MOVE DP015-RED       TO                          17640039
176500                                  MR-VEND-STYL-NAME-C (PV-SUB)    17650039
176600                 MOVE DP015-UNDERLINE TO                          17660039
176700                                  MR-VEND-STYL-NAME-H (PV-SUB)    17670039
176800                 MOVE PC-TSYMSG-00005                             17680039
176900                                     TO DP020-MSG-NUMBER          17690039
177000             END-IF                                               17700039
177100         END-IF                                                   17710039
177200     END-IF.                                                      17720039
177300                                                                  17730039
177400 3400-CHECK-RANGE-SEQUENCE.                                       17740039
177500                                                                  17750039
177600     IF ASC-START-OF-SELECTED-RANGE > ZERO AND                    17760039
177700        ASC-END-OF-SELECTED-RANGE   > ZERO AND                    17770039
177800        ASC-START-OF-SELECTED-RANGE > ASC-END-OF-SELECTED-RANGE   17780039
177900         MOVE PC-TSYMSG-00052    TO DP020-MSG-NUMBER              17790039
178000         SET PS-ERROR                                             17800039
178100             DP020-MSG-FATAL     TO TRUE                          17810039
178200                                                                  17820039
178300         PERFORM 3410-POSITION-AT-ERROR                           17830039
178400     END-IF.                                                      17840039
178500                                                                  17850039
178600 3410-POSITION-AT-ERROR.                                          17860039
178700                                                                  17870039
178800     SET DP030-SET-CURSOR-APPL-1 TO TRUE.                         17880039
178900     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE -               17890039
179000                                                  PV-TOP-ITEM + 1.17900039
179100     IF PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                       17910039
179200         CONTINUE                                                 17920039
179300     ELSE                                                         17930039
179400         MOVE -1                 TO MR-VEND-STYL-NAME-L (PV-SUB)  17940039
179500         MOVE DP015-RED          TO MR-VEND-STYL-NAME-C (PV-SUB)  17950039
179600         MOVE DP015-REVERSE      TO MR-VEND-STYL-NAME-H (PV-SUB)  17960039
179700     END-IF.                                                      17970039
179800                                                                  17980039
179900     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE - PV-TOP-ITEM + 1.17990039
180000     IF PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                       18000039
180100         CONTINUE                                                 18010039
180200     ELSE                                                         18020039
180300         MOVE -1                 TO MR-VEND-STYL-NAME-L (PV-SUB)  18030039
180400         MOVE DP015-RED          TO MR-VEND-STYL-NAME-C (PV-SUB)  18040039
180500         MOVE DP015-REVERSE      TO MR-VEND-STYL-NAME-H (PV-SUB)  18050039
180600     END-IF.                                                      18060039
180700                                                                  18070039
180800 3500-MARK-RANGE-AS-SELECTED.                                     18080039
180900                                                                  18090039
181000     MOVE +1                     TO ASC-BLK-SUB.                  18100039
181100                                                                  18110039
181200     PERFORM 3510-MARK-SELECTED-INDS                              18120039
181300             VARYING ASC-ITEM-SUB  FROM 1 BY 1                    18130039
181400             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           18140039
181500                                                                  18150039
181600     ADD +1                      TO ASC-BLK-SUB.                  18160039
181700                                                                  18170039
181800     PERFORM 3510-MARK-SELECTED-INDS                              18180039
181900             VARYING ASC-ITEM-SUB  FROM 1 BY 1                    18190039
182000             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           18200039
182100                                                                  18210039
182200     MOVE ASC-LIST-ITEM-NUMBER (1 1)                              18220039
182300                                 TO PV-LIST-ITEM-NUMBER.          18230039
182400     COMPUTE PV-FIRST-BLOCK-IN-ARRAY = 1 +                        18240039
182500                 ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).18250039
182600     MOVE ASC-START-OF-SELECTED-RANGE                             18260039
182700                                 TO PV-START-OF-SELECTED-RANGE.   18270039
182800     COMPUTE PV-FIRST-BLOCK-IN-RANGE = 1 +                        18280039
182900             ((PV-START-OF-SELECTED-RANGE - 1) /                  18290039
183000                                              PC-ITEMS-PER-PANEL).18300039
183100     MOVE ASC-END-OF-SELECTED-RANGE                               18310039
183200                                 TO PV-END-OF-SELECTED-RANGE.     18320039
183300     COMPUTE PV-LAST-BLOCK-IN-RANGE = 1 +                         18330039
183400             ((PV-END-OF-SELECTED-RANGE - 1) /                    18340039
183500                                              PC-ITEMS-PER-PANEL).18350039
183600     COMPUTE PV-NEXT-BLOCK-IN-ARRAY = PV-FIRST-BLOCK-IN-ARRAY + 1.18360039
183700                                                                  18370039
183800     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    18380039
183900        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        18390039
184000         MOVE +1                 TO ASC-BLK-SUB                   18400039
184100                                                                  18410039
184200         PERFORM 5100-WRITE-TEMP-STORAGE                          18420039
184300                                                                  18430039
184400         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         18440039
184500                                       PV-FIRST-BLOCK-IN-ARRAY - 118450039
184600                                                                  18460039
184700         PERFORM                                                  18470039
184800           UNTIL PV-FIRST-BLOCK-IN-RANGE > PV-PREV-BLOCK-IN-ARRAY 18480039
184900                 MOVE PV-FIRST-BLOCK-IN-RANGE TO PV-BLOCK-NUMBER  18490039
185000                                                                  18500039
185100                 PERFORM 4410-READ-TEMP-STORAGE                   18510039
185200                                                                  18520039
185300                 PERFORM 3510-MARK-SELECTED-INDS                  18530039
185400                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        18540039
185500                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL18550039
185600                                                                  18560039
185700                 PERFORM 5100-WRITE-TEMP-STORAGE                  18570039
185800                                                                  18580039
185900                 ADD +1          TO PV-FIRST-BLOCK-IN-RANGE       18590039
186000         END-PERFORM                                              18600039
186100                                                                  18610039
186200         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         18620039
186300                  PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY18630039
186400         PERFORM                                                  18640039
186500           UNTIL PV-NEXT-BLOCK-IN-ARRAY > PV-LAST-BLOCK-IN-RANGE  18650039
186600                 MOVE PV-NEXT-BLOCK-IN-ARRAY                      18660039
186700                                 TO PV-BLOCK-NUMBER               18670039
186800                                                                  18680039
186900                 PERFORM 4410-READ-TEMP-STORAGE                   18690039
187000                                                                  18700039
187100                 PERFORM 3510-MARK-SELECTED-INDS                  18710039
187200                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        18720039
187300                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL18730039
187400                                                                  18740039
187500                 PERFORM 5100-WRITE-TEMP-STORAGE                  18750039
187600                                                                  18760039
187700                 ADD +1          TO PV-NEXT-BLOCK-IN-ARRAY        18770039
187800         END-PERFORM                                              18780039
187900                                                                  18790039
188000         MOVE PV-FIRST-BLOCK-IN-ARRAY                             18800039
188100                                 TO PV-BLOCK-NUMBER               18810039
188200                                                                  18820039
188300         PERFORM 4410-READ-TEMP-STORAGE                           18830039
188400                                                                  18840039
188500     END-IF.                                                      18850039
188600                                                                  18860039
188700     MOVE ZERO                   TO ASC-START-OF-SELECTED-RANGE   18870039
188800                                    ASC-END-OF-SELECTED-RANGE.    18880039
188900                                                                  18890039
189000 3510-MARK-SELECTED-INDS.                                         18900039
189100                                                                  18910039
189200     IF ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB) NOT <     18920039
189300                                       ASC-START-OF-SELECTED-RANGE18930039
189400        IF ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB) NOT >  18940039
189500                                         ASC-END-OF-SELECTED-RANGE18950039
189600           IF NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)           18960039
189700               SET ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)          18970039
189800                   ASC-BLOCK-MODIFIED (ASC-BLK-SUB)               18980039
189900                   ASC-TEMP-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)     18990039
190000                                 TO TRUE                          19000039
190100               ADD +1            TO ASC-NUMBER-OF-SELECTED-ITEMS  19010039
190200           END-IF                                                 19020039
190300        END-IF                                                    19030039
190400     END-IF.                                                      19040039
190500                                                                  19050039
190600                                                                  19060039
190700 3600-SEARCH-LIST-QUEUE.                                          19070039
190800                                                                  19080039
190900     MOVE +1                     TO ASC-BLK-SUB.                  19090039
191000                                                                  19100039
191100     PERFORM 5100-WRITE-TEMP-STORAGE.                             19110039
191200                                                                  19120039
191300     ADD +1                      TO ASC-BLK-SUB.                  19130039
191400                                                                  19140039
191500     PERFORM 5100-WRITE-TEMP-STORAGE.                             19150039
191600                                                                  19160039
191700     MOVE ZERO TO ASC-NUMBER-OF-ITEMS-READ.                       19170039
191800                                                                  19180039
191900     PERFORM 3700-COMPARE-LIST-QUEUE                              19190039
192000         VARYING PV-ITEM  FROM 1 BY 1                             19200039
192100         UNTIL   PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN              19210039
192200         OR      PS-FOUND-UNUSED-BLOCK.                           19220039
192300                                                                  19230039
192400                                                                  19240039
192500                                                                  19250039
192600 3700-COMPARE-LIST-QUEUE.                                         19260039
192700                                                                  19270039
192800     PERFORM 6112-READ-LIST-QUEUE.                                19280039
192900                                                                  19290039
193000     IF PV-CICS-RESP = DFHRESP (NORMAL)                           19300039
193100         IF LQW-BLOCK-NOT-USED                                    19310039
193200             SET PS-FOUND-UNUSED-BLOCK TO TRUE                    19320039
193300         ELSE                                                     19330039
193400             PERFORM                                              19340039
193500             VARYING LQW-IDX  FROM 1 BY 1                         19350039
193600             UNTIL   LQW-IDX > PC-ITEMS-PER-PANEL OR              19360039
193700                     LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO        19370039
193800                                                                  19380039
193900                 IF LQW-VEND-STYL-NAME (LQW-IDX)                  19390039
194000                                  NOT = SPACES                    19400039
194100                     ADD +1 TO ASC-NUMBER-OF-ITEMS-READ           19410039
194200                     PERFORM 3800-CHECK-FOR-DUP-STYLES            19420039
194300                         VARYING PV-SUB FROM 1 BY 1               19430039
194400                         UNTIL PV-SUB > PC-ITEMS-PER-PANEL        19440039
194500                 END-IF                                           19450039
194600             END-PERFORM                                          19460039
194700         END-IF                                                   19470039
194800     END-IF.                                                      19480039
194900                                                                  19490039
195000 3800-CHECK-FOR-DUP-STYLES.                                       19500039
195100                                                                  19510039
195200     IF ASC-STYLE-MODIFIED (PV-SAVE-BLOCK-SUB PV-SUB)             19520039
195300         SET ASC-STYLE-NOT-MODIFIED (PV-SAVE-BLOCK-SUB PV-SUB)    19530039
195400                              TO TRUE                             19540039
195500     END-IF.                                                      19550039
195600                                                                  19560039
195700     IF (ASC-VEND-STYL-NAME (PV-SAVE-BLOCK-SUB PV-SUB)            19570039
195800                       NOT = SPACES) AND                          19580039
195900        (ASC-PURITM-KEY (PV-SAVE-BLOCK-SUB PV-SUB)                19590039
196000                       NOT = ZERO) AND                            19600039
196100        (ASC-PURITM-KEY (PV-SAVE-BLOCK-SUB PV-SUB) =              19610039
196200         LQW-PURITM-KEY (LQW-IDX)) AND                            19620039
196300         (PV-ITEM NOT = PV-SAVE-ITEM-SUB OR                       19630039
196400         LQW-IDX NOT = PV-SUB)                                    19640039
196500         SET PS-ERROR                                             19650039
196600             DP020-MSG-FATAL                                      19660039
196700             DP030-SET-CURSOR-APPL-1                              19670039
196800                           TO TRUE                                19680039
196900         MOVE PC-DUPLICATE-MSG TO                                 19690039
197000                          MR-DESC    (PV-SUB)                     19700039
197100         MOVE -1              TO                                  19710039
197200                          MR-VEND-STYL-NAME-L (PV-SUB)            19720039
197300         MOVE DP015-RED       TO                                  19730039
197400                          MR-VEND-STYL-NAME-C (PV-SUB)            19740039
197500         MOVE DP015-UNDERLINE TO                                  19750039
197600                          MR-VEND-STYL-NAME-H (PV-SUB)            19760039
197700         MOVE PC-TSYMSG-00906                                     19770039
197800                             TO DP020-MSG-NUMBER                  19780039
197900     END-IF.                                                      19790039
198000                                                                  19800039
198100                                                                  19810039
198200                                                                  19820039
198300 4000-BUILD-INITIAL-PANEL.                                        19830039
198400                                                                  19840039
198500     INITIALIZE ASC-BLOCK-ENTRIES (1)                             19850039
198600                ASC-BLOCK-ENTRIES (2).                            19860039
198700                                                                  19870039
198800     MOVE +1                     TO ASC-BLK-SUB.                  19880039
198900     SET ASC-MORE-PO-ITEMS       TO TRUE.                         19890039
199000                                                                  19900039
199100     MOVE ZERO                   TO ASC-ITEM-SUB                  19910039
199200                                    ASC-NUMBER-OF-ITEMS-READ      19920039
199300                                    ASC-NUMBER-OF-SELECTED-ITEMS  19930039
199400                                    ASC-HIGHEST-BLOCK-WRITTEN     19940039
199500                                    ASC-START-OF-SELECTED-RANGE   19950039
199600                                    ASC-END-OF-SELECTED-RANGE     19960039
199700                                    ASC-ITEM-AT-TOP-OF-PANEL.     19970039
199800     MOVE SPACES                 TO ASC-KEY-SEARCH-STYLE.         19980039
199900                                                                  19990039
200000                                                                  20000039
200100     PERFORM 4010-FORMAT-KEYS.                                    20010039
200200                                                                  20020039
200300     MOVE +0                  TO ASC-ITEM-SUB.                    20030039
200400     PERFORM 4030-SET-LIST-ITEM-NUMBER                            20040039
200500                 UNTIL PV-ITEM-SUB = PC-ITEMS-IN-ARRAY            20050039
200600     PERFORM 4060-CHECK-PO-STATUS.                                20060039
200700                                                                  20070039
200800     IF PS-NO-ERROR                                               20080039
200900         PERFORM 4020-GET-VENDOR-NAME                             20090039
201000         MOVE +1                 TO PV-TOP-ITEM                   20100039
201100                                                                  20110039
201200         MOVE -1                 TO MR-VEND-STYL-NAME-L (PV-SUB)  20120039
201300         SET DP030-SET-CURSOR-APPL-1                              20130039
201400                                 TO TRUE                          20140039
201500                                                                  20150039
201600         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     20160039
201700     END-IF.                                                      20170039
201800                                                                  20180039
201900 4010-FORMAT-KEYS.                                                20190039
202000                                                                  20200039
202100     MOVE ASC-KEY-PO-NBR-N       TO DK-PO-NBR.                    20210039
202200                                                                  20220039
202300 4020-GET-VENDOR-NAME.                                            20230039
202400                                                                  20240039
202500     PERFORM WITH TEST AFTER                                      20250039
202600         VARYING PV-RETRY-COUNTER  FROM 1 BY 1                    20260039
202700         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR             20270039
202800                 SQLCODE = ZERO OR                                20280039
202900                 SQLCODE = +100                                   20290039
203000                                                                  20300039
203100         EXEC SQL                                                 20310039
203200              SELECT B.ENT_NAME_DESC                              20320039
203300                INTO :ENTNME-ENT-NAME-DESC                        20330039
203400                FROM TPURCHS A,                                   20340039
203500                     TENTNME B                                    20350039
203600               WHERE A.VER_STATUS_CDE = :PC-ACTIVE                20360039
203700                 AND A.PO_NBR         = :DK-PO-NBR                20370039
203800                 AND A.ENT_ID         = B.ENT_ID                  20380039
203900                 AND B.TYPE_CDE       = :PC-01                    20390039
204000         END-EXEC                                                 20400039
204100                                                                  20410039
204200         EVALUATE TRUE                                            20420039
204300             WHEN SQLCODE = ZERO                                  20430039
204400             WHEN SQLCODE = +100                                  20440039
204500             WHEN SQLCODE = -904                                  20450039
204600             WHEN SQLCODE = -913                                  20460039
204700                  CONTINUE                                        20470039
204800                                                                  20480039
204900             WHEN SQLWARN0 NOT = SPACES                           20490039
205000             WHEN SQLCODE  NOT = ZERO                             20500039
205100                  MOVE '4020-GET-VENDOR-NAME'                     20510039
205200                                 TO DP013-PARAGRAPH               20520039
205300                  MOVE 'UNSUCCESSFUL SELECT OF VENDOR NAME'       20530039
205400                                 TO DP013-MESSAGE-TEXT (1)        20540039
205500                  MOVE SQLCA     TO DP013-SQLCA                   20550039
205600                  MOVE 'TENTNME' TO DP013-DB2-TABLE-NAME (1)      20560039
205700                  SET DP013-DB2-ABEND                             20570039
205800                      DP013-XCTL-DISPLAY-RESTART                  20580039
205900                                 TO TRUE                          20590039
206000                                                                  20600039
206100                  PERFORM DP013-0000-PROCESS-ABEND                20610039
206200         END-EVALUATE                                             20620039
206300     END-PERFORM.                                                 20630039
206400                                                                  20640039
206500     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         20650039
206600         MOVE '4020-GET-VENDOR-NAME'                              20660039
206700                                 TO DP013-PARAGRAPH               20670039
206800         MOVE 'MAX RETRIES EXCEEDED ON SELECT VENDOR NAME'        20680039
206900                                 TO DP013-MESSAGE-TEXT (1)        20690039
207000         MOVE SQLCA              TO DP013-SQLCA                   20700039
207100         MOVE 'TENTNME '         TO DP013-DB2-TABLE-NAME (1)      20710039
207200         SET DP013-XCTL-DISPLAY-RESTART                           20720039
207300             DP013-DB2-ABEND     TO TRUE                          20730039
207400                                                                  20740039
207500         PERFORM DP013-0000-PROCESS-ABEND                         20750039
207600     END-IF.                                                      20760039
207700                                                                  20770039
207800     IF SQLCODE = ZERO                                            20780039
207900         MOVE ENTNME-ENT-NAME-DESC                                20790039
208000                                 TO ASC-KEY-VENDOR-NAME           20800039
208100     ELSE                                                         20810039
208200         IF SQLCODE = +100                                        20820039
208300             MOVE 'VENDOR NOT FOUND'                              20830039
208400                                 TO ASC-KEY-VENDOR-NAME           20840039
208500         END-IF                                                   20850039
208600     END-IF.                                                      20860039
208700                                                                  20870039
208800 4030-SET-LIST-ITEM-NUMBER.                                       20880039
208900     IF ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                         20890039
209000         ADD +1          TO ASC-ITEM-SUB                          20900039
209100     ELSE                                                         20910039
209200         ADD +1          TO ASC-BLK-SUB                           20920039
209300         MOVE +1         TO ASC-ITEM-SUB                          20930039
209400                                                                  20940039
209500         IF ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY                  20950039
209600             MOVE +1     TO ASC-BLK-SUB                           20960039
209700             SET ASC-BLOCK-MODIFIED (1)                           20970039
209800                         TO TRUE                                  20980039
209900                                                                  20990039
210000             PERFORM 5100-WRITE-TEMP-STORAGE                      21000039
210100                                                                  21010039
210200             MOVE ASC-BLOCK-ENTRIES                               21020039
210300                                  (PC-MAX-BLOCKS-IN-ARRAY)        21030039
210400                         TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB)        21040039
210500             ADD +1      TO ASC-BLK-SUB                           21050039
210600             INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)           21060039
210700             SET ASC-BLOCK-NOT-MODIFIED (ASC-BLK-SUB)             21070039
210800                         TO TRUE                                  21080039
210900         END-IF                                                   21090039
211000     END-IF.                                                      21100039
211100     ADD +1                   TO PV-ITEM-SUB.                     21110039
211200     MOVE PV-ITEM-SUB         TO ASC-LIST-ITEM-NUMBER             21120039
211300                               (ASC-BLK-SUB ASC-ITEM-SUB).        21130039
211400*    COMPUTE ASC-LIST-ITEM-NUMBER                                 21140039
211500*                       ( ASC-BLK-SUB + 1  ASC-ITEM-SUB) =        21150039
211600*                             ASC-ITEM-SUB + 12.                  21160039
211700                                                                  21170039
211800 4060-CHECK-PO-STATUS.                                            21180039
211900                                                                  21190039
212000     PERFORM WITH TEST AFTER                                      21200039
212100         VARYING PV-RETRY-COUNTER  FROM 1 BY 1                    21210039
212200         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR             21220039
212300                 SQLCODE = ZERO OR                                21230039
212400                 SQLCODE = +100                                   21240039
212500                                                                  21250039
212600         EXEC SQL                                                 21260039
212700              SELECT STATUS_CDE                                   21270039
212800                INTO :PV-STATUS-CDE                               21280039
212900                FROM TPURCHS                                      21290039
213000               WHERE VER_STATUS_CDE = :PC-ACTIVE                  21300039
213100                 AND PO_NBR         = :DK-PO-NBR                  21310039
213200         END-EXEC                                                 21320039
213300                                                                  21330039
213400         EVALUATE TRUE                                            21340039
213500             WHEN SQLCODE = ZERO                                  21350039
213600             WHEN SQLCODE = +100                                  21360039
213700             WHEN SQLCODE = -904                                  21370039
213800             WHEN SQLCODE = -913                                  21380039
213900                  CONTINUE                                        21390039
214000                                                                  21400039
214100             WHEN SQLWARN0 NOT = SPACES                           21410039
214200             WHEN SQLCODE  NOT = ZERO                             21420039
214300                  MOVE '4060-CHECK-PO-STATUS'                     21430039
214400                                 TO DP013-PARAGRAPH               21440039
214500                  MOVE 'UNSUCCESSFUL SELECT OF PO STATUS'         21450039
214600                                 TO DP013-MESSAGE-TEXT (1)        21460039
214700                  MOVE SQLCA     TO DP013-SQLCA                   21470039
214800                  MOVE 'TPURCHS' TO DP013-DB2-TABLE-NAME (1)      21480039
214900                  SET DP013-DB2-ABEND                             21490039
215000                      DP013-XCTL-DISPLAY-RESTART                  21500039
215100                                 TO TRUE                          21510039
215200                                                                  21520039
215300                  PERFORM DP013-0000-PROCESS-ABEND                21530039
215400         END-EVALUATE                                             21540039
215500     END-PERFORM.                                                 21550039
215600                                                                  21560039
215700     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         21570039
215800         MOVE '4060-CHECK-PO-STATUS'                              21580039
215900                                 TO DP013-PARAGRAPH               21590039
216000         MOVE 'MAX RETRIES EXCEEDED ON SELECT PO STATUS'          21600039
216100                                 TO DP013-MESSAGE-TEXT (1)        21610039
216200         MOVE SQLCA              TO DP013-SQLCA                   21620039
216300         MOVE 'TPURCHS '         TO DP013-DB2-TABLE-NAME (1)      21630039
216400         SET DP013-XCTL-DISPLAY-RESTART                           21640039
216500             DP013-DB2-ABEND     TO TRUE                          21650039
216600                                                                  21660039
216700         PERFORM DP013-0000-PROCESS-ABEND                         21670039
216800     END-IF.                                                      21680039
216900                                                                  21690039
217000     IF SQLCODE = ZERO                                            21700039
217100         IF PV-VALID-STATUS-CDE                                   21710039
217200             CONTINUE                                             21720039
217300         ELSE                                                     21730039
217400             SET DP020-NEXT-ACT-APPL-ERROR                        21740039
217500                 PS-ERROR                                         21750039
217600                 DP020-MSG-FATAL TO TRUE                          21760039
217700             MOVE PC-TSYMSG-00168                                 21770039
217800                                 TO DP020-MSG-NUMBER              21780039
217900         END-IF                                                   21790039
218000     ELSE                                                         21800039
218100         IF SQLCODE = +100                                        21810039
218200             SET DP020-NEXT-ACT-APPL-ERROR                        21820039
218300                 PS-ERROR                                         21830039
218400                 DP020-MSG-FATAL TO TRUE                          21840039
218500             MOVE PC-TSYMSG-00726                                 21850039
218600                                 TO DP020-MSG-NUMBER              21860039
218700         END-IF                                                   21870039
218800     END-IF.                                                      21880039
218900                                                                  21890039
219000******************************************************************21900039
219100*  COMPUTES THE OPEN TO RECEIVE AMOUNT FOR THE GIVEN STORE.       21910039
219200******************************************************************21920039
219300                                                                  21930039
219400 4200-CALC-OPEN-TO-REC.                                           21940039
219500                                                                  21950039
219600     PERFORM 4210-CHECK-FOR-ALLOC-PLAN.                           21960039
219700                                                                  21970039
219800     IF PS-PLAN-FOUND                                             21980039
219900         PERFORM 4220-SUM-MERCH-DISTRO                            21990039
220000         PERFORM 4225-SUM-STR-MERCH-DISTRO                        22000039
220100         IF ALLPLN-CURR-SPLIT-QTY = PV-SUM-DISTRO-QTY             22010039
220200             PERFORM 4230-SUM-RECEIVED-UNITS                      22020039
220300             PERFORM 4240-SUM-INPROCESS-UNITS                     22030039
220400             COMPUTE PV-OPEN-TO-REC = PV-SUM-STR-DISTRO-QTY -     22040039
220500                 (PV-SUM-VERIFIED-QTY + PV-SUM-EXPTED-QTY)        22050039
220600         ELSE                                                     22060039
220700             MOVE PV-SUM-STR-DISTRO-QTY                           22070039
220800                                 TO PV-OPEN-TO-REC                22080039
220900         END-IF                                                   22090039
221000     ELSE                                                         22100039
221100         MOVE ZERO               TO PV-OPEN-TO-REC                22110039
221200     END-IF.                                                      22120039
221300                                                                  22130039
221400/                                                                 22140039
221500*----------------------------------------------------------------*22150039
221600*    CHECK IF A PLAN EXISTS FOR THIS PO                          *22160039
221700*----------------------------------------------------------------*22170039
221800                                                                  22180039
221900 4210-CHECK-FOR-ALLOC-PLAN.                                       22190039
222000                                                                  22200039
222100     PERFORM                                                      22210039
222200         WITH TEST AFTER                                          22220039
222300         VARYING PV-RETRY-COUNTER                                 22230039
222400         FROM 1 BY 1                                              22240039
222500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               22250039
222600             OR (SQLCODE = +0)                                    22260039
222700             OR (SQLCODE = +100))                                 22270039
222800                                                                  22280039
222900         EXEC SQL                                                 22290039
223000              SELECT PLAN_NBR,                                    22300039
223100                     CURR_SPLIT_QTY                               22310039
223200                INTO :ALLPLN-PLAN-NBR,                            22320039
223300                     :ALLPLN-CURR-SPLIT-QTY                       22330039
223400                FROM TALLPLN                                      22340039
223500               WHERE PO_NBR       = :DK-PO-NBR                    22350039
223600                 AND PO_LNE_NBR   = :PURITM-APP-PO-LNE-NBR        22360039
223700                 AND DEST_NBR     = :ASC-KEY-OPER-UNT-ID          22370039
223800                 AND STATUS_CDE   = :PC-AC                        22380039
223900         END-EXEC                                                 22390039
224000                                                                  22400039
224100         EVALUATE TRUE                                            22410039
224200             WHEN SQLCODE = +0                                    22420039
224300                  SET PS-PLAN-FOUND                               22430039
224400                                   TO TRUE                        22440039
224500             WHEN SQLCODE = +100                                  22450039
224600                  SET PS-PLAN-NOT-FOUND                           22460039
224700                                   TO TRUE                        22470039
224800             WHEN SQLCODE = -904                                  22480039
224900             WHEN SQLCODE = -913                                  22490039
225000                  CONTINUE                                        22500039
225100                                                                  22510039
225200             WHEN SQLWARN0 NOT = SPACES                           22520039
225300             WHEN SQLCODE < +0                                    22530039
225400             WHEN SQLCODE > +0                                    22540039
225500                  MOVE '4210-CHECK-FOR-ALLOC-PLAN'                22550039
225600                                   TO DP013-PARAGRAPH             22560039
225700                  MOVE 'UNSUCCESSFUL SELECT OF TALLPLN'           22570039
225800                                   TO DP013-MESSAGE-TEXT (1)      22580039
225900                  MOVE SQLCA       TO DP013-SQLCA                 22590039
226000                  MOVE 'TALLPLN '  TO DP013-DB2-TABLE-NAME (1)    22600039
226100                  SET DP013-DB2-ABEND                             22610039
226200                      DP013-XCTL-DISPLAY-RESTART                  22620039
226300                                   TO TRUE                        22630039
226400                  PERFORM DP013-0000-PROCESS-ABEND                22640039
226500         END-EVALUATE                                             22650039
226600     END-PERFORM.                                                 22660039
226700                                                                  22670039
226800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        22680039
226900         MOVE '4210-CHECK-FOR-ALLOC-PLAN'                         22690039
227000                                   TO DP013-PARAGRAPH             22700039
227100         MOVE 'MAX RETRIES EXCEEDED FOR SELECT OF TALLPLN'        22710039
227200                                   TO DP013-MESSAGE-TEXT (1)      22720039
227300         MOVE SQLCA                TO DP013-SQLCA                 22730039
227400         MOVE 'TALLPLN '           TO DP013-DB2-TABLE-NAME (1)    22740039
227500         SET DP013-XCTL-DISPLAY-RESTART                           22750039
227600             DP013-DB2-ABEND       TO TRUE                        22760039
227700         PERFORM DP013-0000-PROCESS-ABEND                         22770039
227800     END-IF.                                                      22780039
227900                                                                  22790039
228000/                                                                 22800039
228100*----------------------------------------------------------------*22810039
228200*    SUM ALL STORE DISTRIBUTION QUANTITIES                       *22820039
228300*----------------------------------------------------------------*22830039
228400                                                                  22840039
228500 4220-SUM-MERCH-DISTRO.                                           22850039
228600                                                                  22860039
228700     MOVE ZERO                     TO PV-SUM-DISTRO-QTY.          22870039
228800                                                                  22880039
228900     PERFORM                                                      22890039
229000         WITH TEST AFTER                                          22900039
229100         VARYING PV-RETRY-COUNTER                                 22910039
229200         FROM 1 BY 1                                              22920039
229300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               22930039
229400             OR (SQLCODE = +0)                                    22940039
229500             OR (SQLCODE = +100))                                 22950039
229600                                                                  22960039
229700         EXEC SQL                                                 22970039
229800             SELECT  SUM(STR_DISTRO_QTY)                          22980039
229900               INTO  :PV-SUM-DISTRO-QTY :PV-DISTRO-IND            22990039
230000               FROM  TMESTDS                                      23000039
230100              WHERE  PO_NBR      = :DK-PO-NBR                     23010039
230200                AND  PO_LNE_NBR  = :PURITM-APP-PO-LNE-NBR         23020039
230300                AND  PLAN_NBR    = :ALLPLN-PLAN-NBR               23030039
230400         END-EXEC                                                 23040039
230500                                                                  23050039
230600         EVALUATE TRUE                                            23060039
230700                                                                  23070039
230800             WHEN SQLCODE = +0                                    23080039
230900             WHEN SQLCODE = +100                                  23090039
231000             WHEN SQLCODE = -904                                  23100039
231100             WHEN SQLCODE = -913                                  23110039
231200                  CONTINUE                                        23120039
231300                                                                  23130039
231400             WHEN SQLWARN0 NOT = SPACES                           23140039
231500             WHEN SQLCODE < +0                                    23150039
231600             WHEN SQLCODE > +0                                    23160039
231700                  MOVE '4220-SUM-MERCH-DISTRO'                    23170039
231800                                   TO DP013-PARAGRAPH             23180039
231900                  MOVE 'UNSUCCESSFUL SUM OF TMESTDS'              23190039
232000                                   TO DP013-MESSAGE-TEXT (1)      23200039
232100                  MOVE SQLCA       TO DP013-SQLCA                 23210039
232200                  MOVE 'TMESTDS '  TO DP013-DB2-TABLE-NAME (1)    23220039
232300                  SET DP013-DB2-ABEND                             23230039
232400                      DP013-XCTL-DISPLAY-RESTART                  23240039
232500                                   TO TRUE                        23250039
232600                  PERFORM DP013-0000-PROCESS-ABEND                23260039
232700         END-EVALUATE                                             23270039
232800     END-PERFORM.                                                 23280039
232900                                                                  23290039
233000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        23300039
233100         MOVE '4220-SUM-MERCH-DISTRO'                             23310039
233200                                   TO DP013-PARAGRAPH             23320039
233300         MOVE 'MAX RETRIES EXCEEDED FOR SELECT OF TMESTDS'        23330039
233400                                   TO DP013-MESSAGE-TEXT (1)      23340039
233500         MOVE SQLCA                TO DP013-SQLCA                 23350039
233600         MOVE 'TMESTDS '           TO DP013-DB2-TABLE-NAME (1)    23360039
233700         SET DP013-XCTL-DISPLAY-RESTART                           23370039
233800             DP013-DB2-ABEND       TO TRUE                        23380039
233900         PERFORM DP013-0000-PROCESS-ABEND                         23390039
234000     END-IF.                                                      23400039
234100                                                                  23410039
234200/                                                                 23420039
234300*----------------------------------------------------------------*23430039
234400*    SUM SPECIFIC STORE DISTRIBUTION QUANTITIES                  *23440039
234500*----------------------------------------------------------------*23450039
234600                                                                  23460039
234700 4225-SUM-STR-MERCH-DISTRO.                                       23470039
234800                                                                  23480039
234900     MOVE ZERO                     TO PV-SUM-STR-DISTRO-QTY.      23490039
235000                                                                  23500039
235100     PERFORM                                                      23510039
235200         WITH TEST AFTER                                          23520039
235300         VARYING PV-RETRY-COUNTER                                 23530039
235400         FROM 1 BY 1                                              23540039
235500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               23550039
235600             OR (SQLCODE = +0)                                    23560039
235700             OR (SQLCODE = +100))                                 23570039
235800                                                                  23580039
235900         EXEC SQL                                                 23590039
236000             SELECT  SUM(STR_DISTRO_QTY)                          23600039
236100               INTO  :PV-SUM-STR-DISTRO-QTY :PV-DISTRO-IND        23610039
236200               FROM  TMESTDS                                      23620039
236300              WHERE  PO_NBR        = :DK-PO-NBR                   23630039
236400                AND  PO_LNE_NBR    = :PURITM-APP-PO-LNE-NBR       23640039
236500                AND  PLAN_NBR      = :ALLPLN-PLAN-NBR             23650039
236600                AND  STR_NBR BETWEEN :DK-STR-NBR-B                23660039
236700                                 AND :DK-STR-NBR-E                23670039
236800         END-EXEC                                                 23680039
236900                                                                  23690039
237000         EVALUATE TRUE                                            23700039
237100                                                                  23710039
237200             WHEN SQLCODE = +0                                    23720039
237300             WHEN SQLCODE = +100                                  23730039
237400             WHEN SQLCODE = -904                                  23740039
237500             WHEN SQLCODE = -913                                  23750039
237600                  CONTINUE                                        23760039
237700                                                                  23770039
237800             WHEN SQLWARN0 NOT = SPACES                           23780039
237900             WHEN SQLCODE < +0                                    23790039
238000             WHEN SQLCODE > +0                                    23800039
238100                  MOVE '4225-SUM-STR-MERCH-DISTRO'                23810039
238200                                   TO DP013-PARAGRAPH             23820039
238300                  MOVE 'UNSUCCESSFUL SUM OF TMESTDS'              23830039
238400                                   TO DP013-MESSAGE-TEXT (1)      23840039
238500                  MOVE SQLCA       TO DP013-SQLCA                 23850039
238600                  MOVE 'TMESTDS '  TO DP013-DB2-TABLE-NAME (1)    23860039
238700                  SET DP013-DB2-ABEND                             23870039
238800                      DP013-XCTL-DISPLAY-RESTART                  23880039
238900                                   TO TRUE                        23890039
239000                  PERFORM DP013-0000-PROCESS-ABEND                23900039
239100         END-EVALUATE                                             23910039
239200     END-PERFORM.                                                 23920039
239300                                                                  23930039
239400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        23940039
239500         MOVE '4225-SUM-STR-MERCH-DISTRO'                         23950039
239600                                   TO DP013-PARAGRAPH             23960039
239700         MOVE 'MAX RETRIES EXCEEDED FOR SELECT OF TMESTDS'        23970039
239800                                   TO DP013-MESSAGE-TEXT (1)      23980039
239900         MOVE SQLCA                TO DP013-SQLCA                 23990039
240000         MOVE 'TMESTDS '           TO DP013-DB2-TABLE-NAME (1)    24000039
240100         SET DP013-XCTL-DISPLAY-RESTART                           24010039
240200             DP013-DB2-ABEND       TO TRUE                        24020039
240300         PERFORM DP013-0000-PROCESS-ABEND                         24030039
240400     END-IF.                                                      24040039
240500                                                                  24050039
240600/                                                                 24060039
240700*----------------------------------------------------------------*24070039
240800*    SUM ALL RECEIVED UNITS FOR THIS PO, LINE, STORE             *24080039
240900*----------------------------------------------------------------*24090039
241000                                                                  24100039
241100 4230-SUM-RECEIVED-UNITS.                                         24110039
241200                                                                  24120039
241300     MOVE ZERO                     TO PV-SUM-VERIFIED-QTY.        24130039
241400                                                                  24140039
241500     PERFORM                                                      24150039
241600         WITH TEST AFTER                                          24160039
241700         VARYING PV-RETRY-COUNTER                                 24170039
241800         FROM 1 BY 1                                              24180039
241900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               24190039
242000             OR (SQLCODE = +0)                                    24200039
242100             OR (SQLCODE = +100))                                 24210039
242200                                                                  24220039
242300         EXEC SQL                                                 24230039
242400             SELECT  SUM(AP_VERIFY_ITM_QTY)                       24240039
242500               INTO  :PV-SUM-VERIFIED-QTY :PV-VERIFIED-IND        24250039
242600               FROM  TRECDIS A,                                   24260039
242700                     TRECEIV B                                    24270039
242800              WHERE   A.ORD_NBR        = :DK-PO-NBR               24280039
242900                AND   A.ORD_NBR        = B.ORD_NBR                24290039
243000                AND   A.ORD_LNE_NBR    = :PURITM-APP-PO-LNE-NBR   24300039
243100                AND   A.REC_SEQ_NBR    = :ASC-KEY-REC-SEQ-NBR     24310039
243200                AND   A.REC_SEQ_NBR    = B.REC_SEQ_NBR            24320039
243300                AND   A.OPER_UNT_ID    = :ASC-KEY-OPER-UNT-ID     24330039
243400                AND   A.FCLTY_ID       = :ASC-KEY-FCLTY-ID        24340039
243600                AND   B.VER_STATUS_CDE = :PC-ACTIVE               24360039
243700                AND   A.STR_NBR  BETWEEN :DK-STR-NBR-B            24370039
243800                                     AND :DK-STR-NBR-E            24380039
243900                AND   B.STATUS_CDE     = :PC-VE                   24390039
244000         END-EXEC                                                 24400039
244100                                                                  24410039
244200         EVALUATE TRUE                                            24420039
244300             WHEN SQLCODE = +0                                    24430039
244400             WHEN SQLCODE = +100                                  24440039
244500             WHEN SQLCODE = -904                                  24450039
244600             WHEN SQLCODE = -913                                  24460039
244700                  CONTINUE                                        24470039
244800                                                                  24480039
244900             WHEN SQLWARN0 NOT = SPACES                           24490039
245000             WHEN SQLCODE < +0                                    24500039
245100             WHEN SQLCODE > +0                                    24510039
245200                  MOVE '4230-SUM-RECEIVED-UNITS'                  24520039
245300                                   TO DP013-PARAGRAPH             24530039
245400                  MOVE 'UNSUCCESSFUL SUM OF TRECDIS'              24540039
245500                                   TO DP013-MESSAGE-TEXT (1)      24550039
245600                  MOVE SQLCA       TO DP013-SQLCA                 24560039
245700                  MOVE 'TRECDIS '  TO DP013-DB2-TABLE-NAME (1)    24570039
245800                  SET DP013-DB2-ABEND                             24580039
245900                      DP013-XCTL-DISPLAY-RESTART                  24590039
246000                                   TO TRUE                        24600039
246100                  PERFORM DP013-0000-PROCESS-ABEND                24610039
246200         END-EVALUATE                                             24620039
246300     END-PERFORM.                                                 24630039
246400                                                                  24640039
246500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        24650039
246600         MOVE '4230-SUM-RECEIVED-UNITS'                           24660039
246700                                   TO DP013-PARAGRAPH             24670039
246800         MOVE 'MAX RETRIES EXCEEDED FOR SELECT OF TRECDIS'        24680039
246900                                   TO DP013-MESSAGE-TEXT (1)      24690039
247000         MOVE SQLCA                TO DP013-SQLCA                 24700039
247100         MOVE 'TRECDIS '           TO DP013-DB2-TABLE-NAME (1)    24710039
247200         SET DP013-XCTL-DISPLAY-RESTART                           24720039
247300             DP013-DB2-ABEND       TO TRUE                        24730039
247400         PERFORM DP013-0000-PROCESS-ABEND                         24740039
247500     END-IF.                                                      24750039
247600                                                                  24760039
247700/                                                                 24770039
247800*----------------------------------------------------------------*24780039
247900*    SUM ALL INPROCESS UNITS FOR THIS PO, LINE, STORE            *24790039
248000*----------------------------------------------------------------*24800039
248100                                                                  24810039
248200 4240-SUM-INPROCESS-UNITS.                                        24820039
248300                                                                  24830039
248400     MOVE ZERO                     TO PV-SUM-EXPTED-QTY.          24840039
248500                                                                  24850039
248600     PERFORM                                                      24860039
248700         WITH TEST AFTER                                          24870039
248800         VARYING PV-RETRY-COUNTER                                 24880039
248900         FROM 1 BY 1                                              24890039
249000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               24900039
249100             OR (SQLCODE = +0)                                    24910039
249200             OR (SQLCODE = +100))                                 24920039
249300                                                                  24930039
249400         EXEC SQL                                                 24940039
249500             SELECT  SUM(A.EXPTED_ITM_QTY)                        24950039
249600               INTO  :PV-SUM-EXPTED-QTY :PV-EXPTED-IND            24960039
249700               FROM  TRECDIS A,                                   24970039
249800                     TRECEIV B                                    24980039
249900              WHERE   A.ORD_NBR        = :DK-PO-NBR               24990039
250000                AND   A.ORD_NBR        = B.ORD_NBR                25000039
250100                AND   A.ORD_LNE_NBR    = :PURITM-APP-PO-LNE-NBR   25010039
250200                AND   A.REC_SEQ_NBR    < :ASC-KEY-REC-SEQ-NBR     25020039
250300                AND   A.REC_SEQ_NBR    = B.REC_SEQ_NBR            25030039
250400                AND   A.OPER_UNT_ID    = :ASC-KEY-OPER-UNT-ID     25040039
250500                AND   A.FCLTY_ID       = :ASC-KEY-FCLTY-ID        25050039
250700                AND   B.VER_STATUS_CDE = :PC-ACTIVE               25070039
250800                AND   A.STR_NBR  BETWEEN :DK-STR-NBR-B            25080039
250900                                     AND :DK-STR-NBR-E            25090039
251000                AND   B.STATUS_CDE    IN (:PC-IP, :PC-CM)         25100039
251100         END-EXEC                                                 25110039
251200                                                                  25120039
251300         EVALUATE TRUE                                            25130039
251400             WHEN SQLCODE = +0                                    25140039
251500             WHEN SQLCODE = +100                                  25150039
251600             WHEN SQLCODE = -904                                  25160039
251700             WHEN SQLCODE = -913                                  25170039
251800                  CONTINUE                                        25180039
251900                                                                  25190039
252000             WHEN SQLWARN0 NOT = SPACES                           25200039
252100             WHEN SQLCODE < +0                                    25210039
252200             WHEN SQLCODE > +0                                    25220039
252300                  MOVE '4240-SUM-INPROCESS-UNITS'                 25230039
252400                                   TO DP013-PARAGRAPH             25240039
252500                  MOVE 'UNSUCCESSFUL SUM OF TRECDIS'              25250039
252600                                   TO DP013-MESSAGE-TEXT (1)      25260039
252700                  MOVE SQLCA       TO DP013-SQLCA                 25270039
252800                  MOVE 'TRECDIS '  TO DP013-DB2-TABLE-NAME (1)    25280039
252900                  SET DP013-DB2-ABEND                             25290039
253000                      DP013-XCTL-DISPLAY-RESTART                  25300039
253100                                   TO TRUE                        25310039
253200                  PERFORM DP013-0000-PROCESS-ABEND                25320039
253300         END-EVALUATE                                             25330039
253400     END-PERFORM.                                                 25340039
253500                                                                  25350039
253600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        25360039
253700         MOVE '4240-SUM-INPROCESS-UNITS'                          25370039
253800                                   TO DP013-PARAGRAPH             25380039
253900         MOVE 'MAX RETRIES EXCEEDED FOR SELECT OF TRECDIS'        25390039
254000                                   TO DP013-MESSAGE-TEXT (1)      25400039
254100         MOVE SQLCA                TO DP013-SQLCA                 25410039
254200         MOVE 'TRECDIS '           TO DP013-DB2-TABLE-NAME (1)    25420039
254300         SET DP013-XCTL-DISPLAY-RESTART                           25430039
254400             DP013-DB2-ABEND       TO TRUE                        25440039
254500         PERFORM DP013-0000-PROCESS-ABEND                         25450039
254600     END-IF.                                                      25460039
254700                                                                  25470039
254800 4400-MOVE-COMMAREA-TO-SCREEN.                                    25480039
254900                                                                  25490039
255000     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1)) AND         25500039
255100           (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1))) OR         25510039
255200           (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))            25520039
255300             MOVE +1             TO ASC-BLK-SUB                   25530039
255400                                                                  25540039
255500             PERFORM 5100-WRITE-TEMP-STORAGE                      25550039
255600                                                                  25560039
255700             ADD +1              TO ASC-BLK-SUB                   25570039
255800                                                                  25580039
255900             PERFORM 5100-WRITE-TEMP-STORAGE                      25590039
256000                                                                  25600039
256100             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             25610039
256200                 GIVING PV-BLOCK-NUMBER                           25620039
256300                 REMAINDER PV-REMAINDER                           25630039
256400             IF PV-REMAINDER > ZERO                               25640039
256500                 ADD +1          TO PV-BLOCK-NUMBER               25650039
256600             END-IF                                               25660039
256700             MOVE +1             TO ASC-BLK-SUB                   25670039
256800                                                                  25680039
256900             PERFORM 4410-READ-TEMP-STORAGE                       25690039
257000                                                                  25700039
257100**  NO TEMP STORAGE AREA EXISTS SO THIS WILL INITIALIZE IT        25710039
257200**  WITH VALID LIST NUMBERS                                       25720039
257300             IF DP020-FK-NEXT-PAGE (DP020-SRC-AID) AND            25730039
257400                PV-CICS-RESP = DFHRESP (ITEMERR)                  25740039
257500                 COMPUTE PV-ITEM-SUB = PV-TOP-ITEM - 1            25750039
257600                 COMPUTE PV-MAX-LIST-ITEM-NBR = PV-ITEM-SUB +     25760039
257700                     PC-ITEMS-IN-ARRAY - 1                        25770039
257800                 MOVE +0                  TO ASC-ITEM-SUB         25780039
257900                 INITIALIZE ASC-BLOCK-ENTRIES (1)                 25790039
258000                            ASC-BLOCK-ENTRIES (2)                 25800039
258100                 PERFORM 4030-SET-LIST-ITEM-NUMBER                25810039
258200                     UNTIL PV-ITEM-SUB > PV-MAX-LIST-ITEM-NBR     25820039
258300             ELSE                                                 25830039
258400                                                                  25840039
258500                 ADD +1              TO ASC-BLK-SUB               25850039
258600                                        PV-BLOCK-NUMBER           25860039
258700                                                                  25870039
258800                 PERFORM 4410-READ-TEMP-STORAGE                   25880039
258900             END-IF                                               25890039
259000                                                                  25900039
259100     END-IF.                                                      25910039
259200                                                                  25920039
259300     MOVE +1                     TO ASC-BLK-SUB.                  25930039
259400     COMPUTE ASC-ITEM-SUB =                                       25940039
259500         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              25950039
259600                       + PC-ITEMS-PER-PANEL).                     25960039
259700                                                                  25970039
259800     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         25980039
259900         ADD +1                  TO ASC-BLK-SUB                   25990039
260000         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            26000039
260100     END-IF.                                                      26010039
260200                                                                  26020039
260300     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           26030039
260400         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                26040039
260500                                                                  26050039
260600     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        26060039
260700                                                                  26070039
260800     PERFORM 4420-FORMAT-LIST-LINES                               26080039
260900         VARYING PV-SUB  FROM PC-ITEMS-PER-PANEL BY -1            26090039
261000         UNTIL   PV-SUB < +1.                                     26100039
261100                                                                  26110039
261200     COMPUTE ASC-ITEMS-DISPLAYED =                                26120039
261300                   ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).26130039
261400     MOVE PV-TOP-ITEM            TO ASC-ITEM-AT-TOP-OF-PANEL      26140039
261500                                    ASTRTITO.                     26150039
261600     MOVE ASC-ITEM-AT-BOT-OF-PANEL                                26160039
261700                                 TO AENDITO.                      26170039
261800     MOVE ASC-NUMBER-OF-ITEMS-READ                                26180039
261900                                 TO ATOTITO.                      26190039
262000     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            26200039
262100                                 TO ASELITO.                      26210039
262200                                                                  26220039
262300     MOVE ASC-KEY-OPER-UNT-ID    TO AOPERO.                       26230039
262400     MOVE ASC-KEY-FCLTY-ID       TO AFCLTYO.                      26240039
262500     MOVE ASC-KEY-VENDOR-NAME    TO AVENDO.                       26250039
262600     MOVE ASC-KEY-PO-NBR-N       TO PV-PO-NBR.                    26260039
262700     MOVE ASC-KEY-REC-SEQ-NBR    TO PV-REC-SEQ-NBR.               26270039
262800     MOVE PV-PO-REC-SEQ-NBR      TO ARCVRO.                       26280039
262900     MOVE ASC-KEY-STR-NBR        TO ASTRO.                        26290039
263000                                                                  26300039
263100     IF DP020-MSG-NUMBER-X = SPACE                                26310039
263200        IF ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ    26320039
263300            MOVE PC-TSYMSG-00279 TO DP020-MSG-NUMBER              26330039
263400            SET DP020-MSG-INFORMATIONAL                           26340039
263500                                 TO TRUE                          26350039
263600        END-IF                                                    26360039
263700     END-IF.                                                      26370039
263800                                                                  26380039
263900 4410-READ-TEMP-STORAGE.                                          26390039
264000                                                                  26400039
264100     EXEC CICS READQ TS                                           26410039
264200               QUEUE (ASC-LIST-QUEUE-NAME)                        26420039
264300               INTO  (ASC-BLOCK-ENTRIES (ASC-BLK-SUB))            26430039
264400               ITEM  (PV-BLOCK-NUMBER)                            26440039
264500               RESP  (PV-CICS-RESP)                               26450039
264600     END-EXEC.                                                    26460039
264700                                                                  26470039
264800     IF ((PV-CICS-RESP = DFHRESP (NORMAL)) OR                     26480039
264900         (PV-CICS-RESP = DFHRESP (ITEMERR)))                      26490039
265000         CONTINUE                                                 26500039
265100     ELSE                                                         26510039
265200         SET DP013-CICS-ABEND                                     26520039
265300             DP013-NO-ROLLBACK   TO TRUE                          26530039
265400         MOVE '4410-READ-TEMP-STORAGE'                            26540039
265500                                 TO DP013-PARAGRAPH               26550039
265600         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE READ'   26560039
265700                                 TO DP013-MESSAGE-TEXT (1)        26570039
265800                                                                  26580039
265900         PERFORM DP013-0000-PROCESS-ABEND                         26590039
266000     END-IF.                                                      26600039
266100                                                                  26610039
266200     SET ASC-BLOCK-NOT-MODIFIED (ASC-BLK-SUB)                     26620039
266300                                 TO TRUE.                         26630039
266400                                                                  26640039
266500     IF PV-CICS-RESP = DFHRESP (ITEMERR)                          26650039
266600         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               26660039
266700     END-IF.                                                      26670039
266800                                                                  26680039
266900 4420-FORMAT-LIST-LINES.                                          26690039
267000                                                                  26700039
267100     IF ASC-VEND-STYL-NAME (ASC-BLK-SUB ASC-ITEM-SUB) =           26710039
267200                                    SPACES                        26720039
267300*    IF ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ       26730039
267400*        SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                26740039
267500**       MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA       (PV-SUB)     26750039
267600**                                  MR-VEND-STYL-NAME-A(PV-SUB)   26760039
267700**                                  MR-UNIT-QTY-A    (PV-SUB)     26770039
267800         MOVE ASC-UNIT-QTY-N   (ASC-BLK-SUB ASC-ITEM-SUB)         26780039
267900                                 TO MR-UNIT-QTY-EDITED (PV-SUB)   26790039
268000         MOVE SPACE              TO MR-SELECTI       (PV-SUB)     26800039
268100                                    MR-ACT           (PV-SUB)     26810039
268200                                    MR-VEND-STYL-NAME(PV-SUB)     26820039
268300                                    MR-PO-LINE-NBR   (PV-SUB)     26830039
268400                                    MR-UNT-COST-AMT  (PV-SUB)     26840039
268500                                    MR-DESC          (PV-SUB)     26850039
268600         IF PV-SUB = 1                                            26860039
268700             SET DP030-SET-CURSOR-APPL-1                          26870039
268800                                 TO TRUE                          26880039
268900             MOVE -1             TO MR-VEND-STYL-NAME-L (PV-SUB)  26890039
269000         END-IF                                                   26900039
269100     ELSE                                                         26910039
269200         IF ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) >     26920039
269300                                                             SPACE26930039
269400             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 26940039
269500                                 TO MR-SELECTI (PV-SUB)           26950039
269600         ELSE                                                     26960039
269700             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      26970039
269800                                 TO MR-SELECTI (PV-SUB)           26980039
269900         END-IF                                                   26990039
270000                                                                  27000039
270100         IF DP030-SET-CURSOR-TRAILER                              27010039
270200            IF ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) >  27020039
270300                                                             SPACE27030039
270400               OR PV-SUB = 1                                      27040039
270500                SET DP030-SET-CURSOR-APPL-1                       27050039
270600                                 TO TRUE                          27060039
270700                MOVE -1          TO MR-VEND-STYL-NAME-L (PV-SUB)  27070039
270800            END-IF                                                27080039
270900         END-IF                                                   27090039
271000                                                                  27100039
271100         IF PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL            27110039
271200             MOVE ASC-VEND-STYL-NAME (ASC-BLK-SUB ASC-ITEM-SUB)   27120039
271300                                 TO MR-VEND-STYL-NAME             27130039
271400                                                       (PV-SUB)   27140039
271500             MOVE ASC-UNIT-QTY-N     (ASC-BLK-SUB ASC-ITEM-SUB)   27150039
271600                                 TO MR-UNIT-QTY-EDITED (PV-SUB)   27160039
271700             MOVE ASC-PO-LINE-NBR    (ASC-BLK-SUB ASC-ITEM-SUB)   27170039
271800                                 TO MR-PO-LINE-NBR     (PV-SUB)   27180039
271900             MOVE ASC-UNT-COST-AMT-N (ASC-BLK-SUB ASC-ITEM-SUB)   27190039
272000                                 TO MR-UNT-COST-AMT-EDITED        27200039
272100                                                       (PV-SUB)   27210039
272200             MOVE ASC-DESC           (ASC-BLK-SUB ASC-ITEM-SUB)   27220039
272300                                 TO MR-DESC            (PV-SUB)   27230039
272400         END-IF.                                                  27240039
272500*    END-IF.                                                      27250039
272600                                                                  27260039
272700     SUBTRACT +1 FROM ASC-ITEM-SUB.                               27270039
272800                                                                  27280039
272900     IF ASC-ITEM-SUB < +1                                         27290039
273000         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  27300039
273100         MOVE +1                 TO ASC-BLK-SUB.                  27310039
273200                                                                  27320039
273300 4430-CHECK-FOR-BEGIN-AND-END.                                    27330039
273400                                                                  27340039
273500     IF ASC-START-OF-SELECTED-RANGE > ZERO                        27350039
273600        IF ASC-END-OF-SELECTED-RANGE = ZERO                       27360039
273700            MOVE PC-TSYMSG-00051 TO DP020-MSG-NUMBER              27370039
273800            SET DP020-MSG-WARNING                                 27380039
273900                                 TO TRUE                          27390039
274000                                                                  27400039
274100            PERFORM 4431-POSITION-AT-WARNING                      27410039
274200                                                                  27420039
274300         END-IF                                                   27430039
274400     ELSE                                                         27440039
274500         IF ASC-END-OF-SELECTED-RANGE > ZERO                      27450039
274600             MOVE PC-TSYMSG-00053                                 27460039
274700                                 TO DP020-MSG-NUMBER              27470039
274800             SET DP020-MSG-WARNING                                27480039
274900                                 TO TRUE                          27490039
275000                                                                  27500039
275100             PERFORM 4431-POSITION-AT-WARNING                     27510039
275200                                                                  27520039
275300         END-IF                                                   27530039
275400     END-IF.                                                      27540039
275500                                                                  27550039
275600 4431-POSITION-AT-WARNING.                                        27560039
275700                                                                  27570039
275800     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE -               27580039
275900                                                  PV-TOP-ITEM + 1.27590039
276000     IF PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                       27600039
276100         CONTINUE                                                 27610039
276200     ELSE                                                         27620039
276300         SET DP030-SET-CURSOR-APPL-1                              27630039
276400                                 TO TRUE                          27640039
276500         MOVE -1                 TO MR-VEND-STYL-NAME-L (PV-SUB)  27650039
276600         MOVE DP015-YELLOW       TO MR-VEND-STYL-NAME-C (PV-SUB)  27660039
276700         MOVE DP015-REVERSE      TO MR-VEND-STYL-NAME-H (PV-SUB)  27670039
276800     END-IF.                                                      27680039
276900                                                                  27690039
277000     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE - PV-TOP-ITEM + 1.27700039
277100                                                                  27710039
277200     IF PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                       27720039
277300         CONTINUE                                                 27730039
277400     ELSE                                                         27740039
277500         SET DP030-SET-CURSOR-APPL-1                              27750039
277600                                 TO TRUE                          27760039
277700         MOVE -1                 TO MR-VEND-STYL-NAME-L (PV-SUB)  27770039
277800         MOVE DP015-YELLOW       TO MR-VEND-STYL-NAME-C (PV-SUB)  27780039
277900         MOVE DP015-REVERSE      TO MR-VEND-STYL-NAME-H (PV-SUB)  27790039
278000     END-IF.                                                      27800039
278100                                                                  27810039
278200 5000-PREPARE-SEL-QUEUE.                                          27820039
278300                                                                  27830039
278400     MOVE +1                     TO ASC-BLK-SUB.                  27840039
278500                                                                  27850039
278600     PERFORM 5100-WRITE-TEMP-STORAGE.                             27860039
278700                                                                  27870039
278800     ADD +1                      TO ASC-BLK-SUB.                  27880039
278900                                                                  27890039
279000     PERFORM 5100-WRITE-TEMP-STORAGE.                             27900039
279100                                                                  27910039
279200     MOVE ASC-SEL-QUEUE-NAME     TO RC015-SEL-QUEUE-NAME.         27920039
279300                                                                  27930039
279400     PERFORM 6010-DELETE-SEL-QUEUE.                               27940039
279500                                                                  27950039
279600     SET ASC-UPDATE-TSQ          TO TRUE.                         27960039
279700     SET RC013-IDX               TO 1.                            27970039
279800     MOVE ZERO                   TO RC015-NUMBER-OF-TS-ITEMS.     27980039
279900     INITIALIZE RC013-SELECTED-ITEM-ARRAY.                        27990039
280000                                                                  28000039
280100     IF DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)                    28010039
280200         MOVE ASC-KEY-PO-NBR-N   TO DK-PO-NBR                     28020039
280300         MOVE ASC-KEY-PO-NBR-N   TO PKITEM-PO-NBR                 28030039
280400         MOVE ASC-KEY-SEQ-NBR    TO PKITEM-SEQ-NBR                28040039
280500         PERFORM 5300-SEARCH-FOR-SELECTION                        28050039
280600             VARYING PV-ITEM  FROM 1 BY 1                         28060039
280700             UNTIL   PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN          28070039
280800             IF PS-ERROR                                          28080039
280900                 MOVE PC-TSYMSG-00117                             28090039
281000                                 TO DP020-MSG-NUMBER              28100039
281100             ELSE                                                 28110039
281200                 MOVE PC-TSYMSG-00034                             28120039
281300                                 TO DP020-MSG-NUMBER              28130039
281400             END-IF                                               28140039
281500     ELSE                                                         28150039
281600         PERFORM 5200-FILL-SEL-QUEUE-RECORD                       28160039
281700             VARYING PV-ITEM  FROM 1 BY 1                         28170039
281800             UNTIL   PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN          28180039
281900     END-IF.                                                      28190039
282000                                                                  28200039
282100     IF RC013-IDX > 1                                             28210039
282200         PERFORM 5205-WRITE-SEL-QUEUE                             28220039
282300         ADD +1                  TO RC015-NUMBER-OF-TS-ITEMS      28230039
282400     END-IF.                                                      28240039
282500                                                                  28250039
282600 5100-WRITE-TEMP-STORAGE.                                         28260039
282700                                                                  28270039
282800     MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)                    28280039
282900                                 TO PV-LIST-ITEM-NUMBER.          28290039
283000     COMPUTE PV-BLOCK-NUMBER = 1 +                                28300039
283100                 ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).28310039
283200                                                                  28320039
283300     IF PV-BLOCK-NUMBER NOT > ASC-HIGHEST-BLOCK-WRITTEN           28330039
283400        IF ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                       28340039
283500                                                                  28350039
283600            PERFORM 5105-REWRITE-ASC-LISTQ                        28360039
283700                                                                  28370039
283800        END-IF                                                    28380039
283900     ELSE                                                         28390039
284000         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       28400039
284100                                     ASC-HIGHEST-BLOCK-WRITTEN + 128410039
284200         PERFORM 5110-WRITE-ASC-LISTQ                             28420039
284300                                                                  28430039
284400         ADD +1                  TO ASC-HIGHEST-BLOCK-WRITTEN     28440039
284500     END-IF.                                                      28450039
284600                                                                  28460039
284700     SET ASC-BLOCK-NOT-MODIFIED (ASC-BLK-SUB)                     28470039
284800                                 TO TRUE.                         28480039
284900                                                                  28490039
285000 5105-REWRITE-ASC-LISTQ.                                          28500039
285100                                                                  28510039
285200     EXEC CICS WRITEQ TS                                          28520039
285300               QUEUE   (ASC-LIST-QUEUE-NAME)                      28530039
285400               FROM    (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))           28540039
285500               ITEM    (PV-BLOCK-NUMBER)                          28550039
285600               REWRITE                                            28560039
285700               RESP    (PV-CICS-RESP)                             28570039
285800     END-EXEC.                                                    28580039
285900                                                                  28590039
286000     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       28600039
286100         SET DP013-CICS-ABEND                                     28610039
286200             DP013-NO-ROLLBACK   TO TRUE                          28620039
286300         MOVE '5105-REWRITE-ASC-LISTQ'                            28630039
286400                                 TO DP013-PARAGRAPH               28640039
286500         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE REWRITE'28650039
286600                                 TO DP013-MESSAGE-TEXT (1)        28660039
286700         PERFORM DP013-0000-PROCESS-ABEND                         28670039
286800     END-IF.                                                      28680039
286900                                                                  28690039
287000 5110-WRITE-ASC-LISTQ.                                            28700039
287100                                                                  28710039
287200     EXEC CICS WRITEQ TS                                          28720039
287300               QUEUE (ASC-LIST-QUEUE-NAME)                        28730039
287400               FROM  (ASC-BLOCK-ENTRIES (ASC-BLK-SUB))            28740039
287500               ITEM  (PV-BLOCK-NUMBER)                            28750039
287600               RESP  (PV-CICS-RESP)                               28760039
287700     END-EXEC.                                                    28770039
287800                                                                  28780039
287900     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      28790039
288000         SET DP013-CICS-ABEND                                     28800039
288100             DP013-NO-ROLLBACK   TO TRUE                          28810039
288200         MOVE '5110-WRITE-ASC-LISTQ'                              28820039
288300                                 TO DP013-PARAGRAPH               28830039
288400         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE WRITE'  28840039
288500                                 TO DP013-MESSAGE-TEXT (1)        28850039
288600         PERFORM DP013-0000-PROCESS-ABEND                         28860039
288700     END-IF.                                                      28870039
288800                                                                  28880039
288900 5200-FILL-SEL-QUEUE-RECORD.                                      28890039
289000                                                                  28900039
289100     PERFORM 6112-READ-LIST-QUEUE.                                28910039
289200                                                                  28920039
289300     IF PV-CICS-RESP = DFHRESP (NORMAL)                           28930039
289400         PERFORM                                                  28940039
289500         VARYING LQW-IDX  FROM 1 BY 1                             28950039
289600         UNTIL   LQW-IDX > PC-ITEMS-PER-PANEL OR                  28960039
289700                 LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO            28970039
289800                                                                  28980039
289900             IF LQW-SELECT (LQW-IDX)                              28990039
290000                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              29000039
290100                                 TO RC013-ITEM         (RC013-IDX)29010039
290200                 MOVE LQW-PO-LINE-NBR     (LQW-IDX)               29020039
290300                                 TO RC013-PKSL-LNE-NBR-N          29030039
290400                                                       (RC013-IDX)29040039
290500                 MOVE SPACE      TO RC013-ACTION-SW    (RC013-IDX)29050039
290600                 SET RC013-IDX UP BY 1                            29060039
290700                 IF RC013-IDX > RC013-MAX-ITEMS                   29070039
290800                                                                  29080039
290900                     PERFORM 5205-WRITE-SEL-QUEUE                 29090039
291000                                                                  29100039
291100                     ADD +1      TO RC015-NUMBER-OF-TS-ITEMS      29110039
291200                     INITIALIZE RC013-SELECTED-ITEM-ARRAY         29120039
291300                     SET RC013-IDX                                29130039
291400                                 TO 1                             29140039
291500                 END-IF                                           29150039
291600             END-IF                                               29160039
291700         END-PERFORM                                              29170039
291800     END-IF.                                                      29180039
291900                                                                  29190039
292000 5205-WRITE-SEL-QUEUE.                                            29200039
292100                                                                  29210039
292200     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            29220039
292300                                 TO RC013-SELECTED-ITEMS.         29230039
292400                                                                  29240039
292500     EXEC CICS WRITEQ TS                                          29250039
292600               QUEUE (ASC-SEL-QUEUE-NAME)                         29260039
292700               FROM  (RC013-DC-SELECT-RECORD)                     29270039
292800               ITEM  (PV-SEL-QUEUE-ITEM)                          29280039
292900               RESP  (PV-CICS-RESP)                               29290039
293000     END-EXEC.                                                    29300039
293100                                                                  29310039
293200     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       29320039
293300         SET DP013-CICS-ABEND                                     29330039
293400             DP013-NO-ROLLBACK   TO TRUE                          29340039
293500         MOVE '5205-WRITE-SEL-QUEUE'                              29350039
293600                                 TO DP013-PARAGRAPH               29360039
293700         MOVE 'UNSUCCESSFUL SEL ITEMS TEMP STORAGE QUEUE WRITE'   29370039
293800                                 TO DP013-MESSAGE-TEXT (1)        29380039
293900         PERFORM DP013-0000-PROCESS-ABEND                         29390039
294000     END-IF.                                                      29400039
294100                                                                  29410039
294200 5300-SEARCH-FOR-SELECTION.                                       29420039
294300                                                                  29430039
294400     PERFORM 6112-READ-LIST-QUEUE.                                29440039
294500                                                                  29450039
294600     IF PV-CICS-RESP = DFHRESP (NORMAL)                           29460039
294700         PERFORM                                                  29470039
294800         VARYING LQW-IDX  FROM 1 BY 1                             29480039
294900         UNTIL   LQW-IDX > PC-ITEMS-PER-PANEL OR                  29490039
295000                 LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO            29500039
295100                                                                  29510039
295200             IF LQW-SELECT (LQW-IDX)                              29520039
295300                 IF LQW-UNIT-QTY (LQW-IDX) > ZERO                 29530039
295400                     PERFORM 5500-INSERT-TPKITEM                  29540039
295500                     ADD +1      TO RC015-NUMBER-OF-TS-ITEMS      29550039
295600                 END-IF                                           29560039
295700             END-IF                                               29570039
295800         END-PERFORM                                              29580039
295900     END-IF.                                                      29590039
296000                                                                  29600039
296100/                                                                 29610039
296200*----------------------------------------------------------------*29620039
296300*    CHECK IF THE PO LINE NUMBER ALREADY EXISTS ON THE PACK SLIP *29630039
296400*----------------------------------------------------------------*29640039
296500                                                                  29650039
296600 5400-SELECT-TPKITEM.                                             29660039
296700     MOVE ASC-KEY-PO-NBR-N       TO DK-PO-NBR.                    29670039
296800     MOVE ASC-KEY-SEQ-NBR        TO PKITEM-SEQ-NBR.               29680039
296900                                                                  29690039
297000     MOVE PURITM-APP-PO-LNE-NBR  TO PKITEM-PKSL-LNE-NBR.          29700039
297100                                                                  29710039
297200     PERFORM                                                      29720039
297300         WITH TEST AFTER                                          29730039
297400         VARYING PV-RETRY-COUNTER                                 29740039
297500         FROM 1 BY 1                                              29750039
297600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               29760039
297700             OR (SQLCODE = +0)                                    29770039
297800             OR (SQLCODE = +100))                                 29780039
297900                                                                  29790039
298000         EXEC SQL                                                 29800039
298100              SELECT PO_NBR                                       29810039
298200                INTO :PKITEM-PO-NBR                               29820039
298300                FROM TPKITEM                                      29830039
298400               WHERE PO_NBR       = :DK-PO-NBR                    29840039
298500                 AND SEQ_NBR      = :PKITEM-SEQ-NBR               29850039
298600                 AND PKSL_LNE_NBR = :PKITEM-PKSL-LNE-NBR          29860039
298700                 AND VER_STAT_CDE = :PC-ACTIVE                    29870039
298800         END-EXEC                                                 29880039
298900                                                                  29890039
299000         EVALUATE TRUE                                            29900039
299100             WHEN SQLCODE = +0                                    29910039
299200                  SET PS-PKITEM-FOUND                             29920039
299300                                   TO TRUE                        29930039
299400             WHEN SQLCODE = +100                                  29940039
299500                  SET PS-PKITEM-NOT-FOUND                         29950039
299600                                   TO TRUE                        29960039
299700             WHEN SQLCODE = -904                                  29970039
299800             WHEN SQLCODE = -913                                  29980039
299900                  CONTINUE                                        29990039
300000                                                                  30000039
300100             WHEN SQLWARN0 NOT = SPACES                           30010039
300200             WHEN SQLCODE < +0                                    30020039
300300             WHEN SQLCODE > +0                                    30030039
300400                  MOVE '5400-SELECT-TPKITEM'                      30040039
300500                                   TO DP013-PARAGRAPH             30050039
300600                  MOVE 'UNSUCCESSFUL SELECT OF TPKITEM'           30060039
300700                                   TO DP013-MESSAGE-TEXT (1)      30070039
300800                  MOVE SQLCA       TO DP013-SQLCA                 30080039
300900                  MOVE 'TPKITEM '  TO DP013-DB2-TABLE-NAME (1)    30090039
301000                  SET DP013-DB2-ABEND                             30100039
301100                      DP013-XCTL-DISPLAY-RESTART                  30110039
301200                                   TO TRUE                        30120039
301300                  PERFORM DP013-0000-PROCESS-ABEND                30130039
301400         END-EVALUATE                                             30140039
301500     END-PERFORM.                                                 30150039
301600                                                                  30160039
301700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        30170039
301800         MOVE '5400-SELECT-TPKITEM'                               30180039
301900                                   TO DP013-PARAGRAPH             30190039
302000         MOVE 'MAX RETRIES EXCEEDED FOR SELECT OF TPKITEM'        30200039
302100                                   TO DP013-MESSAGE-TEXT (1)      30210039
302200         MOVE SQLCA                TO DP013-SQLCA                 30220039
302300         MOVE 'TPKITEM '           TO DP013-DB2-TABLE-NAME (1)    30230039
302400         SET DP013-XCTL-DISPLAY-RESTART                           30240039
302500             DP013-DB2-ABEND       TO TRUE                        30250039
302600         PERFORM DP013-0000-PROCESS-ABEND                         30260039
302700     END-IF.                                                      30270039
302800                                                                  30280039
302900/                                                                 30290039
303000*----------------------------------------------------------------*30300039
303100*    INSERT A PACK SLIP ITEM ROW                                 *30310039
303200*----------------------------------------------------------------*30320039
303300                                                                  30330039
303400 5500-INSERT-TPKITEM.                                             30340039
303500                                                                  30350039
303600     MOVE LQW-UNIT-QTY (LQW-IDX) TO PKITEM-PKSL-ITM-QTY.          30360039
303700                                                                  30370039
303800     MOVE LQW-PO-LINE-NBR  (LQW-IDX)                              30380039
303900                                 TO PKITEM-PKSL-LNE-NBR.          30390039
304000     MOVE LQW-PURITM-VER-NBR(LQW-IDX)                             30400039
304100                                 TO PKITEM-PURITM-VER-NBR.        30410039
304200                                                                  30420039
304300*TCR  AUTOVE                                                      30430041
304400     SET PS-ORIG-ASN-PKSLIP-NO   TO TRUE.                         30440041
304500     PERFORM 5525-CHECK-ASN.                                      30450041
304600     MOVE 0 TO PV-ORIG-PKSL-ITM-QTY.                              30460041
304700     IF PS-ORIG-ASN-PKSLIP-YES                                    30470041
304800        MOVE PKITEM-PKSL-ITM-QTY TO PV-ORIG-PKSL-ITM-QTY          30480041
304900     END-IF.                                                      30490041
305000*TCR  AUTOVE                                                      30500041
305100                                                                  30510041
305200     PERFORM                                                      30520039
305300         WITH TEST AFTER                                          30530039
305400         VARYING PV-RETRY-COUNTER                                 30540039
305500         FROM 1 BY 1                                              30550039
305600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               30560039
305700             OR (SQLCODE = +0))                                   30570039
305800                                                                  30580039
305900         EXEC SQL                                                 30590039
306000              INSERT INTO TPKITEM                                 30600039
306100                     (PO_NBR,                                     30610039
306200                      SEQ_NBR,                                    30620039
306300                      PKSL_LNE_NBR,                               30630039
306400                      CRE_TMST,                                   30640039
306500                      VER_STAT_CDE,                               30650039
306600                      PKSL_ITM_QTY,                               30660039
306700                      CRE_UID,                                    30670039
306800                      PURITM_VER_NBR,                             30680041
306900                      ORIG_PKSL_ITM_QTY)                          30690041
307000              VALUES (:PKITEM-PO-NBR,                             30700039
307100                      :PKITEM-SEQ-NBR,                            30710039
307200                      :PKITEM-PKSL-LNE-NBR,                       30720039
307300                       CURRENT TIMESTAMP,                         30730039
307400                      :PC-ACTIVE,                                 30740039
307500                      :PKITEM-PKSL-ITM-QTY,                       30750039
307600                      :DP020-USERID,                              30760039
307700                      :PKITEM-PURITM-VER-NBR,                     30770041
307800                      :PV-ORIG-PKSL-ITM-QTY)                      30780041
307900         END-EXEC                                                 30790039
308000                                                                  30800039
308100         EVALUATE TRUE                                            30810039
308200             WHEN SQLCODE = +0                                    30820039
308300             WHEN SQLCODE = -904                                  30830039
308400             WHEN SQLCODE = -913                                  30840039
308500                  CONTINUE                                        30850039
308600                                                                  30860039
308700             WHEN SQLWARN0 NOT = SPACES                           30870039
308800             WHEN SQLCODE < +0                                    30880039
308900             WHEN SQLCODE > +0                                    30890039
309000                  MOVE '5500-INSERT-TPKITEM'                      30900039
309100                                   TO DP013-PARAGRAPH             30910039
309200                  MOVE 'UNSUCCESSFUL INSERT FOR TPKITEM'          30920039
309300                                   TO DP013-MESSAGE-TEXT (1)      30930039
309400                  MOVE SQLCA       TO DP013-SQLCA                 30940039
309500                  MOVE 'TPKITEM '  TO DP013-DB2-TABLE-NAME (1)    30950039
309600                  SET DP013-DB2-ABEND                             30960039
309700                      DP013-XCTL-DISPLAY-RESTART                  30970039
309800                                   TO TRUE                        30980039
309900                  PERFORM DP013-0000-PROCESS-ABEND                30990039
310000         END-EVALUATE                                             31000039
310100     END-PERFORM.                                                 31010039
310200                                                                  31020039
310300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        31030039
310400         MOVE '5500-INSERT-TPKITEM'                               31040039
310500                                   TO DP013-PARAGRAPH             31050039
310600         MOVE 'MAX RETRIES EXCEEDED FOR INSERT ON TPKITEM'        31060039
310700                                   TO DP013-MESSAGE-TEXT (1)      31070039
310800         MOVE SQLCA                TO DP013-SQLCA                 31080039
310900         MOVE 'TPKITEM '           TO DP013-DB2-TABLE-NAME (1)    31090039
311000         SET DP013-XCTL-DISPLAY-RESTART                           31100039
311100             DP013-DB2-ABEND       TO TRUE                        31110039
311200         PERFORM DP013-0000-PROCESS-ABEND                         31120039
311300     END-IF.                                                      31130039
311400                                                                  31140039
311500******************************************************************31150041
311600**  CHECK TO SEE IF ASN IS ORIGINAL (CRE_UID = RCKUP006)        **31160041
311700******************************************************************31170041
311800 5525-CHECK-ASN.                                                  31180041
311900                                                                  31190041
312000         EXEC SQL                                                 31200041
312100           SELECT COUNT(CRE_UID)                                  31210042
312200           INTO  :PV-COUNTER:PV-NULL-IND                          31220042
312300           FROM   TPKSLIP                                         31230041
312400           WHERE  PO_NBR       = :DK-PO-NBR                       31240041
312500             AND  SEQ_NBR      = :ASC-KEY-SEQ-NBR                 31250041
312600             AND  CRE_UID      = 'RCKUP006'                       31260042
312700         END-EXEC.                                                31270041
312800                                                                  31280041
312900         EVALUATE TRUE                                            31290041
313000             WHEN SQLCODE = ZERO                                  31300041
313100                  IF PV-COUNTER > 0                               31310042
313200                     SET PS-ORIG-ASN-PKSLIP-YES  TO TRUE          31320041
313300                  END-IF                                          31330041
313400             WHEN SQLCODE = +100                                  31340041
313500                  CONTINUE                                        31350041
313600             WHEN SQLCODE = -904                                  31360041
313700             WHEN SQLCODE = -911                                  31370041
313800             WHEN SQLCODE = -913                                  31380041
313900                  CONTINUE                                        31390041
314000                                                                  31400041
314100             WHEN SQLWARN0 NOT = SPACES                           31410041
314200             WHEN SQLCODE  NOT = ZERO                             31420041
314300                  MOVE '5525-CHECK-ASN'                           31430041
314400                                   TO DP013-PARAGRAPH             31440041
314500                  MOVE 'UNSUCCESSFUL SELECT FOR TPKSLIP'          31450041
314600                                   TO DP013-MESSAGE-TEXT (1)      31460041
314700                  MOVE SQLCA       TO DP013-SQLCA                 31470041
314800                  MOVE 'TPKSLIP '  TO DP013-DB2-TABLE-NAME (1)    31480041
314900                  SET DP013-DB2-ABEND                             31490041
315000                      DP013-XCTL-DISPLAY-RESTART                  31500041
315100                                   TO TRUE                        31510041
315200                  PERFORM DP013-0000-PROCESS-ABEND                31520041
315300         END-EVALUATE.                                            31530041
315400                                                                  31540041
315500 6000-REFRESH-PANEL-FROM-TEMP.                                    31550039
315600                                                                  31560039
315700     IF ASC-UPDATE-TSQ                                            31570039
315800         SET ASC-NO-TSQ-UPDATE   TO TRUE                          31580039
315900         MOVE ZERO               TO PV-SAVE-ITEM                  31590039
316000                                    PV-SEL-QUEUE-ITEM             31600039
316100         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        31610039
316200                                 TO PV-HOLD-SELECTED-ITEMS        31620039
316300         PERFORM 6100-UPDATE-TSQ                                  31630039
316400           UNTIL PV-ITEMS-PROCESSED > ASC-NUMBER-OF-SELECTED-ITEMS31640039
316500                                                                  31650039
316600         PERFORM 6010-DELETE-SEL-QUEUE                            31660039
316700                                                                  31670039
316800         INITIALIZE ASC-BLOCK-ENTRIES (1)                         31680039
316900                    ASC-BLOCK-ENTRIES (2)                         31690039
317000                                                                  31700039
317100         DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL                 31710039
317200                GIVING    PV-BLOCK-NUMBER                         31720039
317300                REMAINDER PV-REMAINDER                            31730039
317400                                                                  31740039
317500         IF PV-REMAINDER > ZERO                                   31750039
317600             ADD +1              TO PV-BLOCK-NUMBER               31760039
317700         END-IF                                                   31770039
317800                                                                  31780039
317900         MOVE +1                 TO ASC-BLK-SUB                   31790039
318000                                                                  31800039
318100         PERFORM 4410-READ-TEMP-STORAGE                           31810039
318200                                                                  31820039
318300         ADD +1                  TO ASC-BLK-SUB                   31830039
318400                            PV-BLOCK-NUMBER                       31840039
318500         PERFORM 4410-READ-TEMP-STORAGE                           31850039
318600                                                                  31860039
318700     END-IF.                                                      31870039
318800                                                                  31880039
318900 6010-DELETE-SEL-QUEUE.                                           31890039
319000                                                                  31900039
319100     EXEC CICS DELETEQ TS                                         31910039
319200               QUEUE (ASC-SEL-QUEUE-NAME)                         31920039
319300               RESP  (PV-CICS-RESP)                               31930039
319400     END-EXEC.                                                    31940039
319500                                                                  31950039
319600     IF ((PV-CICS-RESP = DFHRESP (NORMAL)) OR                     31960039
319700         (PV-CICS-RESP = DFHRESP (QIDERR)))                       31970039
319800         CONTINUE                                                 31980039
319900     ELSE                                                         31990039
320000         SET DP013-CICS-ABEND                                     32000039
320100             DP013-NO-ROLLBACK   TO TRUE                          32010039
320200         MOVE '6010-DELETE-SEL-QUEUE'                             32020039
320300                                 TO DP013-PARAGRAPH               32030039
320400         MOVE 'UNSUCCESSFUL SEL ITEMS TEMP STORAGE QUEUE DELETE'  32040039
320500                                 TO DP013-MESSAGE-TEXT (1)        32050039
320600         PERFORM DP013-0000-PROCESS-ABEND                         32060039
320700     END-IF.                                                      32070039
320800                                                                  32080039
320900 6100-UPDATE-TSQ.                                                 32090039
321000                                                                  32100039
321100     ADD 1                       TO PV-SEL-QUEUE-ITEM.            32110039
321200                                                                  32120039
321300     PERFORM 6105-READ-SEL-QUEUE.                                 32130039
321400                                                                  32140039
321500     PERFORM                                                      32150039
321600     VARYING RC013-IDX  FROM 1 BY 1                               32160039
321700     UNTIL   PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS OR       32170039
321800             RC013-IDX > RC013-MAX-ITEMS                          32180039
321900                                                                  32190039
322000         IF RC013-ACTION-SW (RC013-IDX) > SPACE                   32200039
322100            PERFORM 6110-PROCESS-ITEMS                            32210039
322200         END-IF                                                   32220039
322300                                                                  32230039
322400         ADD +1                  TO PV-ITEMS-PROCESSED            32240039
322500     END-PERFORM.                                                 32250039
322600                                                                  32260039
322700     PERFORM 6111-WRITE-LIST-QUEUE.                               32270039
322800                                                                  32280039
322900                                                                  32290039
323000 6105-READ-SEL-QUEUE.                                             32300039
323100                                                                  32310039
323200     EXEC CICS READQ TS                                           32320039
323300               QUEUE (ASC-SEL-QUEUE-NAME)                         32330039
323400               INTO  (RC013-DC-SELECT-RECORD)                     32340039
323500               ITEM  (PV-SEL-QUEUE-ITEM)                          32350039
323600               RESP  (PV-CICS-RESP)                               32360039
323700     END-EXEC.                                                    32370039
323800                                                                  32380039
323900     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       32390039
324000         SET DP013-CICS-ABEND                                     32400039
324100             DP013-NO-ROLLBACK   TO TRUE                          32410039
324200         MOVE '6105-READ-SEL-QUEUE'                               32420039
324300                                 TO DP013-PARAGRAPH               32430039
324400         MOVE 'UNSUCCESSFUL SEL ITEMS TEMP STORAGE QUEUE READ'    32440039
324500                                 TO DP013-MESSAGE-TEXT (1)        32450039
324600         PERFORM DP013-0000-PROCESS-ABEND                         32460039
324700     END-IF.                                                      32470039
324800                                                                  32480039
324900 6110-PROCESS-ITEMS.                                              32490039
325000                                                                  32500039
325100     COMPUTE PV-ITEM = 1 + ((RC013-ITEM (RC013-IDX) - 1)          32510039
325200                                            / PC-ITEMS-PER-PANEL).32520039
325300                                                                  32530039
325400     IF PV-ITEM NOT = PV-SAVE-ITEM                                32540039
325500        IF PV-SAVE-ITEM NOT = ZERO                                32550039
325600                                                                  32560039
325700            PERFORM 6111-WRITE-LIST-QUEUE                         32570039
325800                                                                  32580039
325900        END-IF                                                    32590039
326000        MOVE PV-ITEM             TO PV-SAVE-ITEM                  32600039
326100                                                                  32610039
326200        PERFORM 6112-READ-LIST-QUEUE                              32620039
326300                                                                  32630039
326400     END-IF.                                                      32640039
326500                                                                  32650039
326600     COMPUTE PV-SUB = (RC013-ITEM (RC013-IDX) -                   32660039
326700                                    LQW-LIST-ITEM-NUMBER (1)) + 1.32670039
326800     SET LQW-DESELECT (PV-SUB)   TO TRUE                          32680039
326900     MOVE LQW-SELECTED-SW (PV-SUB)                                32690039
327000                                 TO LQW-TEMP-SELECTED-SW (PV-SUB).32700039
327100                                                                  32710039
327200     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                32720039
327300                                                                  32730039
327400 6111-WRITE-LIST-QUEUE.                                           32740039
327500                                                                  32750039
327600     EXEC CICS WRITEQ TS                                          32760039
327700               QUEUE (ASC-LIST-QUEUE-NAME)                        32770039
327800               FROM  (LQW-LIST-QUEUE-WORK-AREA)                   32780039
327900               ITEM  (PV-SAVE-ITEM)                               32790039
328000               REWRITE                                            32800039
328100               RESP  (PV-CICS-RESP)                               32810039
328200     END-EXEC.                                                    32820039
328300                                                                  32830039
328400     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       32840039
328500         SET DP013-CICS-ABEND                                     32850039
328600             DP013-NO-ROLLBACK   TO TRUE                          32860039
328700         MOVE '6111-WRITE-LIST-QUEUE'                             32870039
328800                                 TO DP013-PARAGRAPH               32880039
328900         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE REWRITE'32890039
329000                                 TO DP013-MESSAGE-TEXT(1)         32900039
329100         PERFORM DP013-0000-PROCESS-ABEND                         32910039
329200     END-IF.                                                      32920039
329300                                                                  32930039
329400 6112-READ-LIST-QUEUE.                                            32940039
329500                                                                  32950039
329600     EXEC CICS READQ TS                                           32960039
329700               QUEUE (ASC-LIST-QUEUE-NAME)                        32970039
329800               INTO  (LQW-LIST-QUEUE-WORK-AREA)                   32980039
329900               ITEM  (PV-ITEM)                                    32990039
330000               RESP  (PV-CICS-RESP)                               33000039
330100     END-EXEC.                                                    33010039
330200                                                                  33020039
330300     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       33030039
330400         SET DP013-CICS-ABEND                                     33040039
330500             DP013-NO-ROLLBACK   TO TRUE                          33050039
330600         MOVE '6112-READ-LIST-QUEUE'                              33060039
330700                                 TO DP013-PARAGRAPH               33070039
330800         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE READ'   33080039
330900                                 TO DP013-MESSAGE-TEXT(1)         33090039
331000         PERFORM DP013-0000-PROCESS-ABEND                         33100039
331100     END-IF.                                                      33110039
331200                                                                  33120039
331300******************************************************************33130039
331400*    ABEND PROCESSING                                             33140039
331500******************************************************************33150039
331600     COPY DPPD013.                                                33160039
