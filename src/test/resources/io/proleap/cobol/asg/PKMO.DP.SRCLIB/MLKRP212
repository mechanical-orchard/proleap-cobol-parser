       IDENTIFICATION DIVISION.                                         00010000
                                                                        00020000
       PROGRAM-ID.    MLKRP212.                                         00030000
       AUTHOR.        BARBARA HULL.                                     00040000
       INSTALLATION.  KOHLS DEPARTMENT STORES.                          00050000
       DATE-WRITTEN.  09/14/98.                                         00060000
       DATE-COMPILED.                                                   00070000
                                                                        00080000
      ******************************************************************00090000
      * NEW MLKRP212 - SUB-CLASS LEVEL MERCHANDISE LEDGER REPORT        00100000
      *                                                                 00110000
      * THIS PROGRAM READS AN EXTRACT FROM THE SUB-CLASS LEVEL MTD      00120000
      * MERCHANDISE LEDGER TABLE AND PRODUCES THE SUB-CLASS LEVEL MTD   00130000
      * MERCHANDISE LEDGER REPORT.                                      00140000
      *                                                                 00150000
      * TOTALS ARE REPORTED FOR THE FOLLOWING LEVELS:                   00160000
      *       SUB-CLASS                                                 00170000
      *       MAJOR CLASS                                               00180000
      *       DEPARTMENT                                                00190000
      *       BUYER                                                     00200000
      *       MANAGER  (DMM)                                            00210000
      *       DIVISION (GMM)                                            00220000
      *       COMPANY                                                   00230000
      *                                                                 00240000
      * AN ADJUSTMENT LINE IS ALSO PRINTED TO SHOW THE INVENTORY        00250000
      * ADJUSTMENT TO BOOK INVENTORY AFTER A PHYSICAL INVENTORY.        00260000
      *                                                                 00270000
      * THIS PROGRAM WAS CREATED FROM MLKRP200 (DEPT-LEVEL DB2 REPORT)  00280000
      * AND THE ORIGINAL MODEL REPORT PGM MLKRP015, WHICH PRODUCED THE  00290000
      * DEPARTMENT-LEVEL MERCHANDISE LEDGER REPORT FROM AN EXTRACT      00300000
      * FROM THE MERCHANDISE LEDGER IMS DATABASES.                      00310000
      ******************************************************************00320000
WR5701*   DATE : 12/28/98       CHANGE ID : WR5701     WHO :TKMA372     00330000
WR5701*   REASON FOR CHANGE : 'PURCHASES' COLUMN OBSOLETED.             00340000
WR5701*    REPLACED WITH 'RECEIPTS' AND 'PURCHASE ADJ' COST & RETAIL.   00350000
WR5701*    'B.I.' LINE ONLY DISPLAYED FOR INITIAL MONTH AS PREV END-INV.00360000
WR5701******************************************************************00370000
      *    12/28/99                       WR#5701           JIM SHIFF   00380000
      *    REMOVE REFERENCE TO LASER PRINTING FUNCTION                  00390000
      *                                                                 00400000
W26603******************************************************************00410000
W26603* CHG ID   DATE        DESCRIPTION                               *00420000
W26603* ------   ----------  ----------------------------------------- *00430000
W26603* W26603   03-24-2004  STORE EXPANSION.  EXPANDED LRECL OF       *00440000
W26603*                      OUT02.                                    *00450000
W26603*                      EXPANDED WORKING STORAGE VARIABLES.       *00460000
W26603*                      ADDED 'WITH UR' TO DB2 SELECTS.           *00470000
W26603*                      - RONNA MCDONALD                          *00480000
C14666* CRQ000000014666   07-10-2012     RAVIKUMAR GUNTHA              *00481002
C14666*                      CHANGES MADE TO SHOW SHORTAGE SHRINK      *00482000
C14666*                      PERCENTAGE WITH 2 POSITIONS TO THE RIGHT  *00483000
C14666*                      OF THE DECIMAL POINT AND TO SHIFT         *00484000
C14666*                      EVERYTHING IN THE REPORT AFTER 'SHK%' BY 1*00485000
C14666*                      POSITION.                                 *00486000
222725* CHG0222725        04-29-2019                                   *00487010
222725*                      CHANGES MADE TO PICK ONLY THE BUYER       *00488010
222725*                      CREATED  UNDER 'DPT' IN TMDSEAR TABLE     *00489010
      ******************************************************************00490000
                                                                        00500000
       ENVIRONMENT DIVISION.                                            00510000
                                                                        00520000
                                                                        00530000
       CONFIGURATION SECTION.                                           00540000
                                                                        00550000
       SOURCE-COMPUTER.        IBM-3090.                                00560000
       OBJECT-COMPUTER.        IBM-3090.                                00570000
                                                                        00580000
                                                                        00590000
       INPUT-OUTPUT SECTION.                                            00600000
                                                                        00610000
       FILE-CONTROL.                                                    00620000
                                                                        00630000
           SELECT LEDGER-EXTRACT-FILE                                   00640000
               ASSIGN TO INP01.                                         00650000
                                                                        00660000
           SELECT LEDGER-EXTRACT-DATE-FILE                              00670000
               ASSIGN TO INP02.                                         00680000
                                                                        00690000
           SELECT LEDGER-REPORT-FILE                                    00700000
               ASSIGN RPT01.                                            00710000
                                                                        00720000
                                                                        00730000
                                                                        00740000
       DATA DIVISION.                                                   00750000
                                                                        00760000
                                                                        00770000
       FILE SECTION.                                                    00780000
                                                                        00790000
       FD  LEDGER-EXTRACT-FILE                                          00800000
           RECORDING MODE IS F                                          00810000
           LABEL RECORDS ARE STANDARD                                   00820000
           BLOCK CONTAINS 0 RECORDS.                                    00830000
                                                                        00840000
W26603 01  LEDGER-EXTRACT-RECORD            PIC  X(1288).               00850000
                                                                        00860000
       FD  LEDGER-EXTRACT-DATE-FILE                                     00870000
           RECORDING MODE IS F                                          00880000
           LABEL RECORDS ARE STANDARD                                   00890000
           BLOCK CONTAINS 0 RECORDS.                                    00900000
                                                                        00910000
       01  LEDGER-EXTRACT-DATE-RECORD       PIC X(80).                  00920000
                                                                        00930000
       FD  LEDGER-REPORT-FILE                                           00940000
           RECORDING MODE IS F                                          00950000
           LABEL RECORDS ARE STANDARD                                   00960000
           BLOCK CONTAINS 0 RECORDS.                                    00970000
                                                                        00980000
       01  LEDGER-REPORT-RECORD             PIC  X(175).                00990000
                                                                        01000000
                                                                        01010000
       WORKING-STORAGE SECTION.                                         01020000
                                                                        01030000
      ***************************************************************** 01040000
      * RECORD LAYOUT FOR LEDGER EXTRACT FILE                           01050000
      ***************************************************************** 01060000
                                                                        01070000
           COPY MLRD102.                                                01080000
                                                                        01090000
      *************************************************************     01100000
      * RECORD LAYOUT FOR LEDGER EXTRACT DATE RECORD                    01110000
      *************************************************************     01120000
                                                                        01130000
           COPY MLRD114.                                                01140000
                                                                        01150000
      ***************************************************************** 01160000
      *    WORKING STORAGE AREA FOR ROUTINE TO FORMAT NAME              01170000
      ***************************************************************** 01180000
                                                                        01190000
           COPY DPWS024.                                                01200000
                                                                        01210000
      ******************************************************************01220000
      *  VARIABLES REQUIRED FOR THE FORMAT SQLCA ROUTINE DPPD004        01230000
      ******************************************************************01240000
                                                                        01250000
           COPY DPWS004.                                                01260000
                                                                        01270000
       01  PC-PROGRAM-CONSTANTS.                                        01280000
           05  PC-COMPANY-TOTALS            PIC  X(22)    VALUE         01290000
                                            '*** COMPANY TOTALS ***'.   01300000
           05  PC-DIVISION-TOTALS           PIC  X(23)    VALUE         01310000
                                            '*** DIVISION TOTALS ***'.  01320000
           05  PC-MANAGER-TOTALS            PIC  X(22)    VALUE         01330000
                                            '*** MANAGER TOTALS ***'.   01340000
           05  PC-BUYER-TOTALS              PIC  X(20)    VALUE         01350000
                                            '*** BUYER TOTALS ***'.     01360000
           05  PC-DEPT-TOTALS               PIC  X(19)    VALUE         01370000
                                            '*** DEPT TOTALS ***'.      01380000
           05  PC-MAJ-CLASS-TOTALS          PIC  X(26)    VALUE         01390000
                                          '*** MAJOR CLASS TOTALS ***'. 01400000
           05  PC-SUB-CLASS-TOTALS          PIC  X(24)    VALUE         01410000
                                            '*** SUB-CLASS TOTALS ***'. 01420000
                                                                        01430000
           05  PC-SUB-CLASS-LVL             PIC S9(04)    COMP SYNC     01440000
                                                          VALUE +1.     01450000
           05  PC-MAJ-CLASS-LVL             PIC S9(04)    COMP SYNC     01460000
                                                          VALUE +2.     01470000
           05  PC-DEPT-LVL                  PIC S9(04)    COMP SYNC     01480000
                                                          VALUE +3.     01490000
           05  PC-BYR-LVL                   PIC S9(04)    COMP SYNC     01500000
                                                          VALUE +4.     01510000
           05  PC-DMA-LVL                   PIC S9(04)    COMP SYNC     01520000
                                                          VALUE +5.     01530000
           05  PC-GMA-LVL                   PIC S9(04)    COMP SYNC     01540000
                                                          VALUE +6.     01550000
           05  PC-OPERCO-LVL                PIC S9(04)    COMP SYNC     01560000
                                                          VALUE +7.     01570000
                                                                        01580000
           05  PC-MDSELV-GMA                PIC  X(03)    VALUE 'GMA'.  01590000
           05  PC-MDSELV-DMA                PIC  X(03)    VALUE 'DMA'.  01600000
           05  PC-MDSELV-DPT                PIC  X(03)    VALUE 'DPT'.  01610000
           05  PC-MDSELV-MCL                PIC  X(03)    VALUE 'MCL'.  01620000
           05  PC-MDSELV-SCL                PIC  X(03)    VALUE 'SCL'.  01630000
                                                                        01640000
           05  PC-RSPLVL-CDE-GMM            PIC  X(03)    VALUE 'GMM'.  01650000
           05  PC-RSPLVL-CDE-DMM            PIC  X(03)    VALUE 'DMM'.  01660000
           05  PC-RSPLVL-CDE-BYR            PIC  X(03)    VALUE 'BYR'.  01670000
                                                                        01680000
           05  PC-THOUSAND                  PIC S9(04)V99  COMP-3       01690000
                                                           VALUE +1000. 01700000
           05  PC-DEPT-NBR-000              PIC  X(03)     VALUE '000'. 01710000
           05  PC-OPERCO-NBR                PIC  X(02)     VALUE '03'.  01720000
           05  PC-APLSYS-CDE                PIC  X(02)     VALUE 'ML'.  01730000
           05  PC-MAX-RETRIES               PIC S9(4)      COMP SYNC    01740000
                                                           VALUE +2.    01750000
           05  PC-2-SPACES-LIT              PIC  X(02)     VALUE '  '.  01760000
           05  PC-PAREN-SPACE-LIT           PIC  X(02)     VALUE ') '.  01770000
                                                                        01780000
       01  PS-PROGRAM-SWITCHES.                                         01790000
           05  PS-END-OF-FSCL-MN-NM-CSR-SW  PIC X      VALUE 'N'.       01800000
               88 PS-END-OF-FSCL-MN-NM-CSR             VALUE 'Y'.       01810000
           05  PS-END-OF-LEDGER-EXTRACT-SW  PIC X      VALUE 'N'.       01820000
               88 PS-END-OF-LEDGER-EXTRACT             VALUE 'Y'.       01830000
           05  PS-END-OF-LEDGER-DATE-FILE-SW PIC X     VALUE 'N'.       01840000
               88 PS-END-OF-LEDGER-DATE-FILE           VALUE 'Y'.       01850000
                                                                        01860000
                                                                        01870000
           05  PS-BREAK-LEVEL-SW            PIC X      VALUE SPACE.     01880000
               88  PS-BREAK-LEVEL-SW-INIT              VALUE ' '.       01890000
               88  PS-BREAK-IS-OPERCO                  VALUE 'C'.       01900000
               88  PS-BREAK-IS-GMA                     VALUE 'G'.       01910000
               88  PS-BREAK-IS-DMA                     VALUE 'V'.       01920000
               88  PS-BREAK-IS-BYR                     VALUE 'B'.       01930000
               88  PS-BREAK-IS-DEPT                    VALUE 'D'.       01940000
               88  PS-BREAK-IS-MAJ-CLASS               VALUE 'M'.       01950000
               88  PS-BREAK-IS-SUB-CLASS               VALUE 'S'.       01960000
                                                                        01970000
       01  PV-PROGRAM-VARIABLES.                                        01980000
           05  PV-AMT-RNDED                 PIC S9(11)V9   COMP-3       01990000
                                                           VALUE ZERO.  02000000
C14666     05  PV-SHNK-PCT                  PIC S9(03)V99  COMP-3       02010000
C14666                                                     VALUE ZERO.  02020000
           05  PV-PCT                       PIC S9(04)V9   COMP-3       02021000
                                                           VALUE ZERO.  02022000
W26603     05  PV-BEG-INV-COST-AMT          PIC S9(13)V99  COMP-3       02030000
                                                           VALUE ZERO.  02040000
W26603     05  PV-BEG-INV-RTL-AMT           PIC S9(13)V99  COMP-3       02050000
                                                           VALUE ZERO.  02060000
           05  PV-SUB-CLASS-PER-PAGE        PIC S9(3)      COMP-3       02070000
                                                           VALUE ZERO.  02080000
           05  PV-DEPT-NBR                  PIC  X(03)     VALUE SPACE. 02090000
           05  PV-SUB-CLASS-NBR             PIC  X(03)     VALUE SPACE. 02100000
           05  PV-3-BYTE-SUB-CLASS-NBR.                                 02110000
               10  PV-1ST-BYTE-SUB-CLASS-NBR                            02120000
                                            PIC  X(01).                 02130000
               10  PV-2-BYTE-SUB-CLASS-NBR  PIC  X(02).                 02140000
           05  PV-MAJ-CLASS-NBR             PIC  X(02)     VALUE SPACE. 02150000
           05  PV-GMA-NBR                   PIC  X(02)     VALUE SPACE. 02160000
           05  PV-DMA-NBR                   PIC  X(02)     VALUE SPACE. 02170000
           05  PV-BYR-NBR                   PIC  X(03)     VALUE SPACE. 02180000
           05  PV-MDSELV-CDE                PIC  X(03)     VALUE SPACE. 02190000
           05  PV-NAME-WITH-PARENS.                                     02200000
               10  PV-NAME-PAREN-1          PIC  X(02)     VALUE ' ('.  02210000
               10  PV-ENTIRE-NAME           PIC  X(20).                 02220000
               10  PV-NAME-PAREN-2          PIC  X(02)     VALUE SPACE. 02230000
           05  PV-DESC                      PIC  X(25)     VALUE SPACE. 02240000
           05  PV-NAME                      PIC  X(24)     VALUE SPACE. 02250000
           05  PV-PAGE-CNT                  PIC S9(05)     COMP-3       02260000
                                                           VALUE ZERO.  02270000
           05  PV-PARAGRAPH-NAME            PIC  X(30)     VALUE SPACE. 02280000
           05  PV-DB2-OPER-ATTEMPTED        PIC  X(30)     VALUE SPACE. 02290000
           05  PV-ABEND-CODE                PIC S9(04)     COMP         02300000
                                                           VALUE ZERO.  02310000
                                                                        02320000
       01  SS-SUBSCRIPTS.                                               02330000
           05  SS-OPEN-MN                   PIC S9(04)     COMP SYNC    02340000
                                                           VALUE ZERO.  02350000
           05  SS-CURR-MN                   PIC S9(04)     COMP SYNC    02360000
                                                           VALUE ZERO.  02370000
           05  SS-SEASON                    PIC S9(04)     COMP SYNC    02380000
                                                           VALUE ZERO.  02390000
           05  SS-PREV-LVL                  PIC S9(04)     COMP SYNC    02400000
                                                           VALUE ZERO.  02410000
           05  SS-CURR-LVL                  PIC S9(04)     COMP SYNC    02420000
                                                           VALUE ZERO.  02430000
           05  SS-NEXT-LVL                  PIC S9(04)     COMP SYNC    02440000
                                                           VALUE ZERO.  02450000
                                                                        02460000
                                                                        02470000
       01  AT-ACCUMULATION-TABLE.                                       02480000
           05  AT-BUSINESS-LEVEL-TOTALS     OCCURS  7.                  02490000
W26603         10  AT-BEG-INV-COST-AMT      PIC S9(13)V99  COMP-3.      02500000
W26603         10  AT-BEG-INV-RTL-AMT       PIC S9(13)V99               02510000
                                                           COMP-3.      02520000
               10  AT-MONTH-TOTALS          OCCURS 12.                  02530000
W26603             15  AT-PRCH-NET-COST-AMT PIC S9(13)V99  COMP-3.      02540000
W26603             15  AT-PRCH-RTL-AMT      PIC S9(13)V99  COMP-3.      02550000
W26603             15  AT-RCPT-NET-COST-AMT PIC S9(13)V99  COMP-3.      02560000
W26603             15  AT-RCPT-RTL-AMT      PIC S9(13)V99  COMP-3.      02570000
W26603             15  AT-PADJ-NET-COST-AMT PIC S9(13)V99  COMP-3.      02580000
W26603             15  AT-PADJ-RTL-AMT      PIC S9(13)V99  COMP-3.      02590000
W26603             15  AT-SLS-RTL-AMT       PIC S9(13)V99  COMP-3.      02600000
W26603             15  AT-SHNK-RTL-AMT      PIC S9(13)V99  COMP-3.      02610000
W26603             15  AT-INV-ADJ-RTL-AMT   PIC S9(13)V99  COMP-3.      02620000
W26603             15  AT-MKDN-RTL-AMT      PIC S9(13)V99  COMP-3.      02630000
W26603             15  AT-END-INV-COST-AMT  PIC S9(13)V99  COMP-3.      02640000
W26603             15  AT-END-INV-RTL-AMT   PIC S9(13)V99  COMP-3.      02650000
W26603             15  AT-SLS-COST-AMT      PIC S9(13)V99  COMP-3.      02660000
W26603             15  AT-GRO-MRGN-AMT      PIC S9(13)V99  COMP-3.      02670000
                                                                        02680000
               10  AT-SEASON-TOTALS         OCCURS  2.                  02690000
                   15  AT-SEAS-PRCH-NET-COST-AMT                        02700000
W26603                                      PIC S9(13)V99  COMP-3.      02710000
W26603             15  AT-SEAS-PRCH-RTL-AMT PIC S9(13)V99  COMP-3.      02720000
WR5701             15  AT-SEAS-RCPT-NET-COST-AMT                        02730000
W26603                                      PIC S9(13)V99  COMP-3.      02740000
W26603             15  AT-SEAS-RCPT-RTL-AMT PIC S9(13)V99  COMP-3.      02750000
WR5701             15  AT-SEAS-PADJ-NET-COST-AMT                        02760000
W26603                                      PIC S9(13)V99  COMP-3.      02770000
W26603             15  AT-SEAS-PADJ-RTL-AMT PIC S9(13)V99  COMP-3.      02780000
W26603             15  AT-SEAS-SLS-RTL-AMT  PIC S9(14)V99  COMP-3.      02790000
W26603             15  AT-SEAS-SHNK-RTL-AMT PIC S9(12)V99  COMP-3.      02800000
W26603             15  AT-SEAS-MKDN-RTL-AMT PIC S9(13)V99  COMP-3.      02810000
W26603             15  AT-SEAS-SLS-COST-AMT PIC S9(13)V99  COMP-3.      02820000
W26603             15  AT-SEAS-GRO-MRGN-AMT PIC S9(13)V99  COMP-3.      02830000
                                                                        02840000
       01  YTD-YEAR-TO-DATE-TOTALS.                                     02850000
W26603     05  YTD-SLS-RTL-AMT              PIC S9(13)V99  COMP-3       02860000
                                                           VALUE ZERO.  02870000
W26603     05  YTD-SHNK-RTL-AMT             PIC S9(13)V99  COMP-3       02880000
                                                           VALUE ZERO.  02890000
W26603     05  YTD-MKDN-RTL-AMT             PIC S9(13)V99  COMP-3       02900000
                                                           VALUE ZERO.  02910000
W26603     05  YTD-SLS-COST-AMT             PIC S9(13)V99  COMP-3       02920000
                                                           VALUE ZERO.  02930000
W26603     05  YTD-GRO-MRGN-AMT             PIC S9(13)V99  COMP-3       02940000
                                                           VALUE ZERO.  02950000
W26603     05  YTD-PRCH-NET-COST-AMT        PIC S9(13)V99  COMP-3       02960000
                                                           VALUE ZERO.  02970000
W26603     05  YTD-PRCH-RTL-AMT             PIC S9(13)V99  COMP-3       02980000
                                                           VALUE ZERO.  02990000
W26603     05  YTD-RCPT-NET-COST-AMT        PIC S9(13)V99  COMP-3       03000000
WR5701                                                     VALUE ZERO.  03010000
W26603     05  YTD-RCPT-RTL-AMT             PIC S9(13)V99  COMP-3       03020000
WR5701                                                     VALUE ZERO.  03030000
W26603     05  YTD-PADJ-NET-COST-AMT        PIC S9(13)V99  COMP-3       03040000
WR5701                                                     VALUE ZERO.  03050000
W26603     05  YTD-PADJ-RTL-AMT             PIC S9(13)V99  COMP-3       03060000
WR5701                                                     VALUE ZERO.  03070000
                                                                        03080000
       01  MT-MONTH-NAME-TABLE.                                         03090000
           05  MT-FSCL-MN-NM-ENTRY          OCCURS 12.                  03100000
               10  MT-FSCL-MN-NM.                                       03110000
                   15  MT-FSCL-MN-NM-ABBREV PIC  X(03)     VALUE SPACE. 03120000
                   15  FILLER               PIC  X(06)     VALUE SPACE. 03130000
                                                                        03140000
       01  HN-HOLD-NUMBERS.                                             03150000
           05  HN-GMA-NBR                   PIC  X(02)     VALUE ZERO.  03160000
           05  HN-DMA-NBR                   PIC  X(02)     VALUE ZERO.  03170000
           05  HN-BYR-NBR                   PIC  X(03)     VALUE ZERO.  03180000
           05  HN-DEPT-NBR                  PIC  X(03)     VALUE ZERO.  03190000
           05  HN-MAJ-CLASS-NBR             PIC  X(02)     VALUE ZERO.  03200000
           05  HN-SUB-CLASS-NBR             PIC  X(02)     VALUE ZERO.  03210000
                                                                        03220000
      *01  LC-LASER-CONTROL-SWITCHES.                                   03230000
      *    05  LC-LASER-CONTROL-FF.                                     03240000
      *        10  FILLER                   PIC S9(04)     COMP         03250000
      *                                                    VALUE -1.    03260000
      *    05  LC-LASER-CONTROL-FD.                                     03270000
      *        10  FILLER                   PIC S9(04)     COMP         03280000
      *                                                    VALUE -513.  03290000
      *        10  FILLER                   PIC  X(79)     VALUE SPACE. 03300000
      *    05  LC-LASER-BREAK-SW            PIC  X         VALUE 'N'.   03310000
      *        88  LC-LASER-BREAK                          VALUE 'Y'.   03320000
                                                                        03330000
       01  TD-TODAYS-DATE.                                              03340000
           05  TD-YEAR                      PIC  9(02)     VALUE ZERO.  03350000
           05  TD-MONTH                     PIC  9(02)     VALUE ZERO.  03360000
           05  TD-DAY                       PIC  9(02)     VALUE ZERO.  03370000
                                                                        03380000
       01  TT-TODAYS-TIME.                                              03390000
           05  TT-HOUR                      PIC  9(02)     VALUE ZERO.  03400000
           05  TT-MINUTE                    PIC  9(02)     VALUE ZERO.  03410000
           05  FILLER                       PIC  9(04)     VALUE ZERO.  03420000
                                                                        03430000
WR5701 01  DP175O-STANDRD-HEADER-175-COLS.                              03440000
00002      05  DP175O-LASER-NEW-PAGE-INDICATR    PIC X(02) VALUE SPACE. 03450000
00003      05  DP175O-RUN-DATE.                                         03460000
00004          10  DP175O-RUN-MONTH              PIC 9(02) VALUE ZERO.  03470000
00005          10  FILLER                        PIC X(01) VALUE '/'.   03480000
00006          10  DP175O-RUN-DAY                PIC 9(02) VALUE ZERO.  03490000
00007          10  FILLER                        PIC X(01) VALUE '/'.   03500000
00008          10  DP175O-RUN-YEAR               PIC 9(02) VALUE ZERO.  03510000
00009      05  FILLER                            PIC X(02) VALUE SPACE. 03520000
00010      05  DP175O-RUN-TIME.                                         03530000
00011          10  DP175O-RUN-HOUR               PIC 9(02) VALUE ZERO.  03540000
00012          10  FILLER                        PIC X(01) VALUE ':'.   03550000
00013          10  DP175O-RUN-MINUTE             PIC 9(02) VALUE ZERO.  03560000
00014      05  FILLER                            PIC X(47) VALUE SPACE. 03570000
00015      05  FILLER                            PIC X(45)              03580000
00016          VALUE 'K O H L S   D E P A R T M E N T   S T O R E S'.   03590000
00017      05  FILLER                            PIC X(42) VALUE SPACE. 03600000
00018      05  DP175O-PROGRAM-NAME               PIC X(08) VALUE SPACE. 03610000
00019      05  FILLER                            PIC X(01) VALUE '-'.   03620000
00020      05  DP175O-REPORT-NUMBER              PIC 9(01) VALUE ZERO.  03630000
00021      05  FILLER                            PIC X(02) VALUE SPACE. 03640000
00022      05  FILLER                            PIC X(05) VALUE 'PAGE'.03650000
00023      05  DP175O-PAGE-NUMBER                PIC ZZZZ9 VALUE ZERO.  03660000
00024                                                                   03670000
       01  PH2-PAGE-HEADING-2.                                          03680000
WR5701     05  FILLER                       PIC X(62) VALUE SPACE.      03690000
           05  FILLER                       PIC X(08) VALUE             03700000
                                                         'MONTHLY '.    03710000
           05  FILLER                       PIC X(12) VALUE             03720000
                                                         'MERCHANDISE '.03730000
           05  FILLER                       PIC X(07) VALUE             03740000
                                                         'LEDGER '.     03750000
           05  FILLER                       PIC X(11) VALUE             03760000
                                                         'FOR FISCAL '. 03770000
           05  PH2-FSCL-MN-NM               PIC X(09) VALUE SPACE.      03780000
           05  FILLER                       PIC X(01) VALUE SPACE.      03790000
           05  PH2-FSCL-YR-NBR              PIC X(04) VALUE SPACE.      03800000
WR5701     05  FILLER                       PIC X(61) VALUE SPACE.      03810000
                                                                        03820000
       01  PH3-PAGE-HEADING-3.                                          03830000
           05  FILLER                       PIC X(73) VALUE SPACES.     03840000
           05  FILLER                       PIC X(11)                   03850000
                                              VALUE '(SUB-CLASS '.      03860000
           05  FILLER                       PIC X(06) VALUE 'LEVEL '.   03870000
           05  FILLER                       PIC X(09) VALUE 'TOTALS - '.03880000
           05  FILLER                       PIC X(04) VALUE '$000'.     03890000
           05  FILLER                       PIC X(01) VALUE QUOTE.      03900000
           05  FILLER                       PIC X(02) VALUE 'S)'.       03910000
           05  FILLER                       PIC X(73) VALUE SPACE.      03920000
                                                                        03930000
       01  CH-COMPANY-HEADING.                                          03940000
           05  FILLER                       PIC X(24) VALUE             03950000
                                    ' KOHLS DEPARTMENT STORES'.         03960000
           05  FILLER                       PIC X(151) VALUE SPACES.    03970000
                                                                        03980000
       01  GH-GMA-HEADING.                                              03990000
           05  FILLER                       PIC X(06) VALUE '  GMM:'.   04000000
           05  FILLER                       PIC X(02) VALUE SPACE.      04010000
           05  GH-GMA-NBR                   PIC X(02) VALUE SPACE.      04020000
           05  FILLER                       PIC X(01) VALUE '-'.        04030000
           05  GH-GMA-DESC-GMM-NAME         PIC X(50) VALUE SPACE.      04040000
           05  FILLER                       PIC X(114) VALUE SPACE.     04050000
                                                                        04060000
       01  DH-DMA-HEADING.                                              04070000
           05  FILLER                       PIC X(06) VALUE '  DMM:'.   04080000
           05  FILLER                       PIC X(02) VALUE SPACE.      04090000
           05  DH-DMA-NBR                   PIC X(02) VALUE SPACE.      04100000
           05  FILLER                       PIC X(01) VALUE '-'.        04110000
           05  DH-DMA-DESC-DMM-NAME         PIC X(50) VALUE SPACE.      04120000
           05  FILLER                       PIC X(114) VALUE SPACE.     04130000
                                                                        04140000
       01  BH-BUYER-HEADING.                                            04150000
           05  FILLER                       PIC X(06) VALUE 'BUYER:'.   04160000
WR5701     05  FILLER                       PIC X(01) VALUE SPACE.      04170000
WR5701     05  BH-BYR-NBR                   PIC X(03) VALUE SPACE.      04180000
           05  FILLER                       PIC X(01) VALUE '-'.        04190000
           05  BH-BYR-NAME                  PIC X(31) VALUE SPACE.      04200000
           05  FILLER                       PIC X(133) VALUE SPACE.     04210000
                                                                        04220000
       01  DH-DEPT-HEADING.                                             04230000
           05  FILLER                       PIC X(06) VALUE ' DEPT:'.   04240000
           05  FILLER                       PIC X(01) VALUE SPACE.      04250000
           05  DH-DEPT-NBR                  PIC 9(03) VALUE ZERO.       04260000
           05  FILLER                       PIC X(01) VALUE '-'.        04270000
           05  DH-DEPT-NAME                 PIC X(20) VALUE SPACE.      04280000
           05  FILLER                       PIC X(144) VALUE SPACE.     04290000
                                                                        04300000
       01  DH-MAJ-CLASS-HEADING.                                        04310000
           05  FILLER                       PIC X(06) VALUE 'CLASS:'.   04320000
           05  FILLER                       PIC X(01) VALUE SPACE.      04330000
           05  DH-MAJ-CLASS-NBR             PIC 9(03) VALUE ZERO.       04340000
           05  FILLER                       PIC X(01) VALUE '-'.        04350000
           05  DH-MAJ-CLASS-NAME            PIC X(20) VALUE SPACE.      04360000
           05  FILLER                       PIC X(144) VALUE SPACE.     04370000
                                                                        04380000
       01  DH-SUB-CLASS-HEADING.                                        04390000
           05  FILLER                       PIC X(10)                   04400000
                                              VALUE 'SUB-CLASS:'.       04410000
           05  FILLER                       PIC X(01) VALUE SPACE.      04420000
           05  DH-SUB-CLASS-NBR             PIC 9(03) VALUE ZERO.       04430000
           05  FILLER                       PIC X(01) VALUE '-'.        04440000
           05  DH-SUB-CLASS-NAME            PIC X(20) VALUE SPACE.      04450000
           05  FILLER                       PIC X(140) VALUE SPACE.     04460000
                                                                        04470000
       01  DH1-DETAIL-HEADING-1.                                        04480000
WR5701     05  FILLER                       PIC X(04) VALUE SPACE.      04490000
WR5701     05  FILLER                       PIC X(09) VALUE             04500000
WR5701                                                     '<------- '. 04510000
WR5701     05  FILLER                       PIC X(09) VALUE             04520000
WR5701                                                    'RECEIPTS '.  04530000
WR5701     05  FILLER                       PIC X(08) VALUE             04540000
WR5701                                                     '------> '.  04550000
WR5701     05  FILLER                       PIC X(07) VALUE             04560000
WR5701                                                     '<----- '.   04570000
WR5701     05  FILLER                       PIC X(09) VALUE             04580000
WR5701                                                    'PURCHASE '.  04590000
WR5701     05  FILLER                       PIC X(04) VALUE             04600000
WR5701                                                    'ADJ '.       04610000
WR5701     05  FILLER                       PIC X(07) VALUE             04620000
WR5701                                                     '-----> '.   04630000
WR5701     05  FILLER                       PIC X(06) VALUE SPACES.     04640000
           05  FILLER                       PIC X(15) VALUE             04650000
                                                      '<--------------'.04660000
           05  FILLER                       PIC X(19) VALUE             04670000
                                                  ' RETAIL REDUCTIONS '.04680000
C14666     05  FILLER                       PIC X(16) VALUE             04690000
C14666                                               '--------------->'.04700000
           05  FILLER                       PIC X(01) VALUE SPACE.      04710000
           05  FILLER                       PIC X(03) VALUE '<--'.      04720000
           05  FILLER                       PIC X(18) VALUE             04730000
                                                   ' ENDING INVENTORY '.04740000
           05  FILLER                       PIC X(04) VALUE '--->'.     04750000
           05  FILLER                       PIC X(03) VALUE SPACE.      04760000
           05  FILLER                       PIC X(07) VALUE 'COST OF'.  04770000
           05  FILLER                       PIC X(08) VALUE SPACE.      04780000
                                                                        04790000
       01  DH2-DETAIL-HEADING-2.                                        04800000
WR5701     05  FILLER                       PIC X(04) VALUE 'MNTH'.     04810000
WR5701     05  FILLER                       PIC X(04) VALUE SPACE.      04820000
WR5701     05  FILLER                       PIC X(04) VALUE 'COST'.     04830000
WR5701     05  FILLER                       PIC X(07) VALUE SPACE.      04840000
WR5701     05  FILLER                       PIC X(06) VALUE 'RETAIL'.   04850000
WR5701     05  FILLER                       PIC X(09) VALUE SPACE.      04860000
WR5701     05  FILLER                       PIC X(04) VALUE 'COST'.     04870000
WR5701     05  FILLER                       PIC X(08) VALUE SPACE.      04880000
WR5701     05  FILLER                       PIC X(06) VALUE 'RETAIL'.   04890000
WR5701     05  FILLER                       PIC X(04) VALUE SPACE.      04900000
WR5701     05  FILLER                       PIC X(05) VALUE 'MKON%'.    04910000
WR5701     05  FILLER                       PIC X(06) VALUE SPACE.      04920000
           05  FILLER                       PIC X(05) VALUE 'SALES'.    04930000
           05  FILLER                       PIC X(05) VALUE SPACE.      04940000
           05  FILLER                       PIC X(09) VALUE 'SHRINKAGE'.04950000
           05  FILLER                       PIC X(02) VALUE SPACE.      04960000
C14666     05  FILLER                       PIC X(05) VALUE 'SHK% '.    04970000
           05  FILLER                       PIC X(03) VALUE SPACE.      04980000
           05  FILLER                       PIC X(09) VALUE 'MARKDOWNS'.04990000
           05  FILLER                       PIC X(03) VALUE SPACE.      05000000
           05  FILLER                       PIC X(05) VALUE 'MKDN%'.    05010000
           05  FILLER                       PIC X(05) VALUE SPACE.      05020000
           05  FILLER                       PIC X(04) VALUE 'COST'.     05030000
           05  FILLER                       PIC X(08) VALUE SPACE.      05040000
           05  FILLER                       PIC X(06) VALUE 'RETAIL'.   05050000
           05  FILLER                       PIC X(07) VALUE SPACE.      05060000
           05  FILLER                       PIC X(05) VALUE 'SALES'.    05070000
           05  FILLER                       PIC X(08) VALUE SPACE.      05080000
           05  FILLER                       PIC X(07) VALUE 'GM DLRS'.  05090000
           05  FILLER                       PIC X(05) VALUE SPACE.      05100000
           05  FILLER                       PIC X(03) VALUE 'GM%'.      05110000
           05  FILLER                       PIC X(01) VALUE SPACE.      05120000
                                                                        05130000
       01  DL-DETAIL-LINE.                                              05140000
           05  DL-MONTH-ABBREV              PIC X(03) VALUE SPACES.     05150000
           05  FILLER                       PIC X(01) VALUE SPACES.     05160000
WR5701     05  DL-RECEIPTS-COST             PIC ZZ,ZZZ,ZZZ.Z-           05170000
WR5701                                                VALUE ZEROES.     05180000
WR5701     05  DL-RECEIPTS-RETAIL           PIC ZZ,ZZZ,ZZZ.Z-           05190000
WR5701                                                VALUE ZEROES.     05200000
WR5701     05  DL-PURCHASE-ADJ-COST         PIC ZZ,ZZZ,ZZZ.Z-           05210000
WR5701                                                VALUE ZEROES.     05220000
WR5701     05  DL-PURCHASE-ADJ-RETAIL       PIC ZZ,ZZZ,ZZZ.Z-           05230000
WR5701                                                VALUE ZEROES.     05240000
           05  DL-MKON-PCT                  PIC ZZ9.9-                  05250000
                                                      VALUE ZEROES.     05260000
           05  DL-SALES                     PIC ZZ,ZZZ,ZZZ.Z-           05270000
                                                      VALUE ZEROES.     05280000
           05  DL-SHRINKAGE                 PIC Z,ZZZ,ZZZ.Z-            05290000
                                                      VALUE ZEROES.     05300000
C14666     05  DL-SHNK-PCT                  PIC ZZ9.99-                 05310000
                                                      VALUE ZEROES.     05320000
           05  DL-MARKDOWNS                 PIC ZZ,ZZZ,ZZZ.Z-           05330000
                                                      VALUE ZEROES.     05340000
           05  DL-MKDN-PCT                  PIC ZZ9.9-                  05350000
                                                      VALUE ZEROES.     05360000
           05  DL-END-INV-COST              PIC ZZ,ZZZ,ZZZ.Z-           05370000
                                                      VALUE ZEROES.     05380000
           05  DL-END-INV-RETAIL            PIC ZZ,ZZZ,ZZZ.Z-           05390000
                                                      VALUE ZEROES.     05400000
           05  DL-COST-OF-SALES             PIC ZZ,ZZZ,ZZZ.Z-           05410000
                                                      VALUE ZEROES.     05420000
           05  DL-GM-DLRS                   PIC ZZ,ZZZ,ZZZ.Z-           05430000
                                                      VALUE ZEROES.     05440000
           05  FILLER                       PIC X(01) VALUE SPACES.     05450000
           05  DL-GM-PCT                    PIC ZZ9.9-                  05460000
                                                      VALUE ZEROES.     05470000
                                                                        05480000
       01  UL-UNDER-LINE.                                               05490000
           05  FILLER                       PIC X(05) VALUE SPACES.     05500000
           05  FILLER                       PIC X(12) VALUE             05510000
           '------------'.                                              05520000
           05  FILLER                       PIC X(01) VALUE SPACES.     05530000
           05  FILLER                       PIC X(12) VALUE             05540000
           '------------'.                                              05550000
           05  FILLER                       PIC X(01) VALUE SPACES.     05560000
           05  FILLER                       PIC X(12) VALUE             05570000
           '------------'.                                              05580000
           05  FILLER                       PIC X(01) VALUE SPACES.     05590000
           05  FILLER                       PIC X(12) VALUE             05600000
           '------------'.                                              05610000
           05  FILLER                       PIC X(01) VALUE SPACES.     05620000
           05  FILLER                       PIC X(05) VALUE             05630000
           '-----'.                                                     05640000
           05  FILLER                       PIC X(01) VALUE SPACES.     05650000
           05  FILLER                       PIC X(12) VALUE             05660000
           '------------'.                                              05670000
           05  FILLER                       PIC X(01) VALUE SPACES.     05680000
           05  FILLER                       PIC X(11) VALUE             05690000
           '-----------'.                                               05700000
           05  FILLER                       PIC X(01) VALUE SPACES.     05710000
C14666     05  FILLER                       PIC X(06) VALUE             05720000
C14666     '------'.                                                    05730000
           05  FILLER                       PIC X(01) VALUE SPACES.     05740000
           05  FILLER                       PIC X(12) VALUE             05750000
           '------------'.                                              05760000
           05  FILLER                       PIC X(01) VALUE SPACES.     05770000
           05  FILLER                       PIC X(05) VALUE             05780000
           '-----'.                                                     05790000
           05  FILLER                       PIC X(01) VALUE SPACES.     05800000
           05  FILLER                       PIC X(12) VALUE             05810000
           '------------'.                                              05820000
           05  FILLER                       PIC X(01) VALUE SPACES.     05830000
           05  FILLER                       PIC X(12) VALUE             05840000
           '------------'.                                              05850000
           05  FILLER                       PIC X(01) VALUE SPACES.     05860000
           05  FILLER                       PIC X(12) VALUE             05870000
           '------------'.                                              05880000
           05  FILLER                       PIC X(01) VALUE SPACES.     05890000
           05  FILLER                       PIC X(12) VALUE             05900000
           '------------'.                                              05910000
           05  FILLER                       PIC X(02) VALUE SPACES.     05920000
           05  FILLER                       PIC X(05) VALUE             05930000
           '-----'.                                                     05940000
                                                                        05950000
                                                                        05960000
      ****************************************************************  05970000
      * DATE ATTRIBUTE TABLE                                            05980000
      ****************************************************************  05990000
                                                                        06000000
           EXEC SQL                                                     06010000
               INCLUDE TDTATTR                                          06020000
           END-EXEC.                                                    06030000
                                                                        06040000
      ******************************************************************06050000
      *  MERCHANDISE AREA TABLE (TMDSEAR)                               06060000
      ******************************************************************06070000
                                                                        06080000
           EXEC SQL                                                     06090000
               INCLUDE TMDSEAR                                          06100000
           END-EXEC.                                                    06110000
                                                                        06120000
      ******************************************************************06130000
      *  APPLICATION AVAILABILITY TABLE (TAPLAVL)                       06140000
      ******************************************************************06150000
                                                                        06160000
           EXEC SQL                                                     06170000
               INCLUDE TAPLAVL                                          06180000
           END-EXEC.                                                    06190000
                                                                        06200000
      ******************************************************************06210000
      *  RESPONSIBILITY AREA TABLE (TRSPBAR)                           *06220000
      ******************************************************************06230000
                                                                        06240000
           EXEC SQL                                                     06250000
               INCLUDE TRSPBAR                                          06260000
           END-EXEC.                                                    06270000
                                                                        06280000
                                                                        06290000
      ******************************************************************06300000
      *    DB2 COMMUNICATION AREA                                       06310000
      ******************************************************************06320000
                                                                        06330000
           EXEC SQL                                                     06340000
               INCLUDE SQLCA                                            06350000
           END-EXEC.                                                    06360000
                                                                        06370000
      ****************************************************************  06380000
      *  DATE TABLE CURSOR                                              06390000
      ****************************************************************  06400000
                                                                        06410000
           EXEC SQL                                                     06420000
               DECLARE FSCL-MN-NM-CSR CURSOR FOR                        06430000
                   SELECT DISTINCT                                      06440000
                        FSCL_MN_NBR                                     06450000
                       ,FSCL_MN_NM                                      06460000
                   FROM                                                 06470000
                        TDTATTR                                         06480000
                   WHERE KY_DTE BETWEEN :DTATTR-FSCL-YR-BEG-DTE         06490000
                                    AND :ML114-EXTRACT-DTE              06500000
W26603             WITH UR                                              06510000
           END-EXEC.                                                    06520000
                                                                        06530000
                                                                        06540000
                                                                        06550000
       LINKAGE SECTION.                                                 06560000
                                                                        06570000
                                                                        06580000
                                                                        06590000
       PROCEDURE DIVISION.                                              06600000
                                                                        06610000
                                                                        06620000
       1000-MAIN-MODULE.                                                06630000
                                                                        06640000
           OPEN INPUT  LEDGER-EXTRACT-FILE                              06650000
                       LEDGER-EXTRACT-DATE-FILE                         06660000
                OUTPUT LEDGER-REPORT-FILE.                              06670000
                                                                        06680000
           PERFORM 1150-INIT.                                           06690000
                                                                        06700000
           PERFORM 7000-READ-LEDGER-EXTRACT.                            06710000
                                                                        06720000
           PERFORM 2000-PROCESS-EXTRACT                                 06730000
               UNTIL PS-END-OF-LEDGER-EXTRACT.                          06740000
                                                                        06750000
           SET PS-BREAK-IS-OPERCO TO TRUE.                              06760000
      *    MOVE 'Y' TO LC-LASER-BREAK-SW.                               06770000
                                                                        06780000
           PERFORM 3000-PROCESS-BREAKS.                                 06790000
                                                                        06800000
           CLOSE LEDGER-EXTRACT-FILE                                    06810000
                 LEDGER-EXTRACT-DATE-FILE                               06820000
                 LEDGER-REPORT-FILE.                                    06830000
                                                                        06840000
           STOP RUN.                                                    06850000
                                                                        06860000
                                                                        06870000
       1150-INIT.                                                       06880000
                                                                        06890000
           PERFORM 7100-READ-LEDGER-EXTRACT-DATE.                       06900000
      *    GET THE OPEN FISCAL MONTH INFORMATION.                       06910000
      *                                                                 06920000
           IF PS-END-OF-LEDGER-DATE-FILE                                06930000
               DISPLAY '** ABEND **'                                    06940000
               DISPLAY '** PROGRAM MLKRP212 **'                         06950000
               DISPLAY '** PARAGRAPH 1150-INIT'                         06960000
               DISPLAY '** LEDGER EXTRACT DATE FILE IS EMPTY.'          06970000
               MOVE +4003 TO PV-ABEND-CODE                              06980000
               PERFORM 9999-ABEND                                       06990000
           END-IF.                                                      07000000
                                                                        07010000
           MOVE ML114-EXTRACT-MN-NBR       TO SS-OPEN-MN.               07020000
           MOVE ML114-EXTRACT-DTE          TO DTATTR-KY-DTE.            07030000
                                                                        07040000
           PERFORM 8000-GET-DATE-ATTRIBUTES.                            07050000
                                                                        07060000
           MOVE DTATTR-FSCL-YR-NBR         TO PH2-FSCL-YR-NBR.          07070000
           MOVE DTATTR-FSCL-MN-NM          TO PH2-FSCL-MN-NM.           07080000
                                                                        07090000
                                                                        07100000
      *    TABLE THE MONTH NAMES OF THE MONTHS IN THE OPEN FISCAL       07110000
      *    YEAR.                                                        07120000
                                                                        07130000
           PERFORM 8700-OPEN-FSCL-MN-NM-CSR.                            07140000
                                                                        07150000
           PERFORM 8800-FETCH-FSCL-MN-NM-CSR.                           07160000
                                                                        07170000
           PERFORM UNTIL PS-END-OF-FSCL-MN-NM-CSR                       07180000
               MOVE DTATTR-FSCL-MN-NBR TO SS-CURR-MN                    07190000
               MOVE DTATTR-FSCL-MN-NM  TO MT-FSCL-MN-NM (SS-CURR-MN)    07200000
               PERFORM 8800-FETCH-FSCL-MN-NM-CSR                        07210000
           END-PERFORM.                                                 07220000
                                                                        07230000
           PERFORM 8900-CLOSE-FSCL-MN-NM-CSR.                           07240000
                                                                        07250000
      *    BUILD STANDARD REPORT HEADING.                               07260000
                                                                        07270000
           ACCEPT TD-TODAYS-DATE FROM DATE.                             07280000
           MOVE TD-YEAR    TO DP175O-RUN-YEAR.                          07290000
           MOVE TD-MONTH   TO DP175O-RUN-MONTH.                         07300000
           MOVE TD-DAY     TO DP175O-RUN-DAY.                           07310000
                                                                        07320000
           ACCEPT TT-TODAYS-TIME FROM TIME.                             07330000
           MOVE TT-HOUR    TO DP175O-RUN-HOUR.                          07340000
           MOVE TT-MINUTE  TO DP175O-RUN-MINUTE.                        07350000
                                                                        07360000
           MOVE 'MLKRP212' TO DP175O-PROGRAM-NAME.                      07370000
           MOVE 1          TO DP175O-REPORT-NUMBER.                     07380000
                                                                        07390000
           INITIALIZE AT-BUSINESS-LEVEL-TOTALS (PC-OPERCO-LVL).         07400000
                                                                        07410000
           MOVE +20        TO DP024-FLNAME-LENGTH.                      07420000
                                                                        07430000
                                                                        07440000
       2000-PROCESS-EXTRACT.                                            07450000
                                                                        07460000
      ******************************************************************07470000
      *    PROCESS ALL GMAS IN THE COMPANY.  WHEN A NEW GMA IS          07480000
      *    ENCOUNTERED, PRINT THE INFO FOR THE PREVIOUS GMA.            07490000
      ******************************************************************07500000
                                                                        07510000
           MOVE ML102-GMA-NBR TO HN-GMA-NBR.                            07520000
           INITIALIZE AT-BUSINESS-LEVEL-TOTALS (PC-GMA-LVL).            07530000
                                                                        07540000
           PERFORM 2100-PROCESS-GMA                                     07550000
               UNTIL (ML102-GMA-NBR NOT = HN-GMA-NBR)                   07560000
                  OR (PS-END-OF-LEDGER-EXTRACT).                        07570000
                                                                        07580000
           SET PS-BREAK-IS-GMA TO TRUE.                                 07590000
                                                                        07600000
           PERFORM 3000-PROCESS-BREAKS.                                 07610000
      *    MOVE 'Y' TO LC-LASER-BREAK-SW.                               07620000
                                                                        07630000
                                                                        07640000
       2100-PROCESS-GMA.                                                07650000
                                                                        07660000
      ******************************************************************07670000
      *    PROCESS ALL DMAS WITHIN THIS GMA.  WHEN A NEW GMA OR DMA IS  07680000
      *    ENCOUNTERED, PRINT THE INFO FOR THE PREVIOUS DMA.            07690000
      ******************************************************************07700000
                                                                        07710000
           MOVE ML102-DMA-NBR   TO HN-DMA-NBR.                          07720000
           INITIALIZE AT-BUSINESS-LEVEL-TOTALS (PC-DMA-LVL).            07730000
                                                                        07740000
           PERFORM 2200-PROCESS-DMA                                     07750000
               UNTIL (ML102-GMA-NBR NOT = HN-GMA-NBR)                   07760000
                  OR (ML102-DMA-NBR NOT = HN-DMA-NBR)                   07770000
                  OR  PS-END-OF-LEDGER-EXTRACT.                         07780000
                                                                        07790000
           SET PS-BREAK-IS-DMA TO TRUE.                                 07800000
                                                                        07810000
           PERFORM 3000-PROCESS-BREAKS.                                 07820000
      *    MOVE 'Y' TO LC-LASER-BREAK-SW.                               07830000
                                                                        07840000
                                                                        07850000
       2200-PROCESS-DMA.                                                07860000
                                                                        07870000
      ******************************************************************07880000
      *    PROCESS ALL BYRS WITHIN THIS DMA.  WHEN A NEW GMA, DMA, OR   07890000
      *    BYR IS ENCOUNTERED, PRINT THE INFO FOR THE PREVIOUS BYR.     07900000
      ******************************************************************07910000
                                                                        07920000
           MOVE ML102-BYR-NBR TO HN-BYR-NBR.                            07930000
           INITIALIZE AT-BUSINESS-LEVEL-TOTALS (PC-BYR-LVL).            07940000
                                                                        07950000
           PERFORM 2300-PROCESS-BYR                                     07960000
               UNTIL (ML102-GMA-NBR NOT = HN-GMA-NBR)                   07970000
                  OR (ML102-DMA-NBR NOT = HN-DMA-NBR)                   07980000
                  OR (ML102-BYR-NBR NOT = HN-BYR-NBR)                   07990000
                  OR (PS-END-OF-LEDGER-EXTRACT).                        08000000
                                                                        08010000
           SET PS-BREAK-IS-BYR TO TRUE.                                 08020000
                                                                        08030000
           PERFORM 3000-PROCESS-BREAKS.                                 08040000
      *    MOVE 'Y' TO LC-LASER-BREAK-SW.                               08050000
                                                                        08060000
                                                                        08070000
       2300-PROCESS-BYR.                                                08080000
                                                                        08090000
      ******************************************************************08100000
      *    PROCESS ALL DEPTS WITHIN THIS BYR.  WHEN A NEW GMA, DMA,     08110000
      *    BYR, OR DEPT IS ENCOUNTERED, PRINT THE INFO FOR THE          08120000
      *    PREVIOUS DEPT.                                               08130000
      ******************************************************************08140000
                                                                        08150000
           MOVE ML102-DEPT-NBR TO HN-DEPT-NBR.                          08160000
           INITIALIZE AT-BUSINESS-LEVEL-TOTALS (PC-DEPT-LVL).           08170000
                                                                        08180000
           PERFORM 3100-FILL-HEADINGS.                                  08190000
                                                                        08200000
           PERFORM 2400-PROCESS-DEPT                                    08210000
               UNTIL (ML102-GMA-NBR  NOT = HN-GMA-NBR)                  08220000
                  OR (ML102-DMA-NBR  NOT = HN-DMA-NBR)                  08230000
                  OR (ML102-BYR-NBR  NOT = HN-BYR-NBR)                  08240000
                  OR (ML102-DEPT-NBR NOT = HN-DEPT-NBR)                 08250000
                  OR (PS-END-OF-LEDGER-EXTRACT).                        08260000
                                                                        08270000
           SET PS-BREAK-IS-DEPT TO TRUE.                                08280000
                                                                        08290000
           PERFORM 3000-PROCESS-BREAKS.                                 08300000
                                                                        08310000
                                                                        08320000
       2400-PROCESS-DEPT.                                               08330000
                                                                        08340000
      ******************************************************************08350000
      *    PROCESS ALL DEPTS WITHIN THIS BYR.  WHEN A NEW GMA, DMA,     08360000
      *    BYR, OR DEPT IS ENCOUNTERED, PRINT THE INFO FOR THE          08370000
      *    PREVIOUS MAJOR CLASS.                                        08380000
      ******************************************************************08390000
                                                                        08400000
           MOVE ML102-MAJ-CL-NBR TO HN-MAJ-CLASS-NBR.                   08410000
           INITIALIZE AT-BUSINESS-LEVEL-TOTALS (PC-MAJ-CLASS-LVL).      08420000
                                                                        08430000
           PERFORM 3100-FILL-HEADINGS.                                  08440000
                                                                        08450000
           PERFORM 2500-PROCESS-MAJ-CLASS                               08460000
               UNTIL (ML102-GMA-NBR    NOT = HN-GMA-NBR)                08470000
                  OR (ML102-DMA-NBR    NOT = HN-DMA-NBR)                08480000
                  OR (ML102-BYR-NBR    NOT = HN-BYR-NBR)                08490000
                  OR (ML102-DEPT-NBR   NOT = HN-DEPT-NBR)               08500000
                  OR (ML102-MAJ-CL-NBR NOT = HN-MAJ-CLASS-NBR)          08510000
                  OR (PS-END-OF-LEDGER-EXTRACT).                        08520000
                                                                        08530000
           SET PS-BREAK-IS-MAJ-CLASS TO TRUE.                           08540000
                                                                        08550000
           PERFORM 3000-PROCESS-BREAKS.                                 08560000
                                                                        08570000
                                                                        08580000
       2500-PROCESS-MAJ-CLASS.                                          08590000
                                                                        08600000
      ******************************************************************08610000
      *    PROCESS ALL MAJOR CLASS WITHIN THIS DEPT. WHEN A NEW GMA,    08620000
      *    DMA, BYR, DEPT OR MAJOR CLASS IS ENCOUNTERED, PRINT THE INFO 08630000
      *    FOR THE PREVIOUS SUB-CLASS.                                  08640000
      ******************************************************************08650000
                                                                        08660000
           MOVE ML102-SUB-CL-NBR TO HN-SUB-CLASS-NBR.                   08670000
           INITIALIZE AT-BUSINESS-LEVEL-TOTALS (PC-SUB-CLASS-LVL).      08680000
                                                                        08690000
           PERFORM 3100-FILL-HEADINGS.                                  08700000
                                                                        08710000
           PERFORM 2600-PROCESS-SUB-CLASS                               08720000
               UNTIL (ML102-GMA-NBR    NOT = HN-GMA-NBR)                08730000
                  OR (ML102-DMA-NBR    NOT = HN-DMA-NBR)                08740000
                  OR (ML102-BYR-NBR    NOT = HN-BYR-NBR)                08750000
                  OR (ML102-DEPT-NBR   NOT = HN-DEPT-NBR)               08760000
                  OR (ML102-MAJ-CL-NBR NOT = HN-MAJ-CLASS-NBR)          08770000
                  OR (ML102-SUB-CL-NBR NOT = HN-SUB-CLASS-NBR)          08780000
                  OR (PS-END-OF-LEDGER-EXTRACT).                        08790000
                                                                        08800000
           SET PS-BREAK-IS-SUB-CLASS TO TRUE.                           08810000
                                                                        08820000
           PERFORM 3000-PROCESS-BREAKS.                                 08830000
                                                                        08840000
                                                                        08850000
       2600-PROCESS-SUB-CLASS.                                          08860000
                                                                        08870000
      ******************************************************************08880000
      *    PROCESS THE MERCHANDISE LEDGER RECORD.  UPDATE THE           08890000
      *    APPROPRIATE BUCKETS USING THE SUB-CLASS INFORMATION.         08900000
      ******************************************************************08910000
                                                                        08920000
           MOVE ML102-BEG-INV-COST-AMT                                  08930000
                TO AT-BEG-INV-COST-AMT (PC-SUB-CLASS-LVL).              08940000
           MOVE ML102-BEG-INV-RTL-AMT                                   08950000
                TO AT-BEG-INV-RTL-AMT  (PC-SUB-CLASS-LVL).              08960000
                                                                        08970000
           PERFORM VARYING SS-CURR-MN FROM 1 BY 1                       08980000
             UNTIL SS-CURR-MN > SS-OPEN-MN                              08990000
                                                                        09000000
               COMPUTE AT-PRCH-NET-COST-AMT(PC-SUB-CLASS-LVL SS-CURR-MN)09010000
                     = ML102-RCPT-NET-COST-AMT (SS-CURR-MN)             09020000
                     + ML102-PADJ-NET-COST-AMT (SS-CURR-MN)             09030000
                                                                        09040000
               COMPUTE AT-PRCH-RTL-AMT     (PC-SUB-CLASS-LVL SS-CURR-MN)09050000
                     = ML102-RCPT-RTL-AMT      (SS-CURR-MN)             09060000
                     + ML102-PADJ-RTL-AMT      (SS-CURR-MN)             09070000
                     + ML102-MKUP-RTL-AMT      (SS-CURR-MN)             09080000
                     + ML102-XFER-IN-RTL-AMT   (SS-CURR-MN)             09090000
                     - ML102-XFER-OUT-RTL-AMT  (SS-CURR-MN)             09100000
WR5701                                                                  09110000
WR5701         MOVE ML102-RCPT-NET-COST-AMT    (SS-CURR-MN)             09120000
WR5701              TO AT-RCPT-NET-COST-AMT(PC-SUB-CLASS-LVL SS-CURR-MN)09130000
WR5701         MOVE ML102-RCPT-RTL-AMT         (SS-CURR-MN)             09140000
WR5701              TO AT-RCPT-RTL-AMT     (PC-SUB-CLASS-LVL SS-CURR-MN)09150000
WR5701         MOVE ML102-PADJ-NET-COST-AMT    (SS-CURR-MN)             09160000
WR5701              TO AT-PADJ-NET-COST-AMT(PC-SUB-CLASS-LVL SS-CURR-MN)09170000
WR5701         COMPUTE AT-PADJ-RTL-AMT     (PC-SUB-CLASS-LVL SS-CURR-MN)09180000
WR5701               = ML102-PADJ-RTL-AMT      (SS-CURR-MN)             09190000
WR5701               + ML102-MKUP-RTL-AMT      (SS-CURR-MN)             09200000
WR5701               + ML102-XFER-IN-RTL-AMT   (SS-CURR-MN)             09210000
WR5701               - ML102-XFER-OUT-RTL-AMT  (SS-CURR-MN)             09220000
WR5701                                                                  09230000
               MOVE ML102-SLS-RTL-AMT          (SS-CURR-MN)             09240000
                    TO AT-SLS-RTL-AMT      (PC-SUB-CLASS-LVL SS-CURR-MN)09250000
               MOVE ML102-SHNK-RTL-AMT         (SS-CURR-MN)             09260000
                    TO AT-SHNK-RTL-AMT     (PC-SUB-CLASS-LVL SS-CURR-MN)09270000
               MOVE ML102-INV-ADJ-RTL-AMT      (SS-CURR-MN)             09280000
                    TO AT-INV-ADJ-RTL-AMT  (PC-SUB-CLASS-LVL SS-CURR-MN)09290000
               MOVE ML102-MKDN-RTL-AMT         (SS-CURR-MN)             09300000
                    TO AT-MKDN-RTL-AMT     (PC-SUB-CLASS-LVL SS-CURR-MN)09310000
               MOVE ML102-END-INV-RTL-AMT      (SS-CURR-MN)             09320000
                    TO AT-END-INV-RTL-AMT  (PC-SUB-CLASS-LVL SS-CURR-MN)09330000
               MOVE ML102-END-INV-COST-AMT     (SS-CURR-MN)             09340000
                    TO AT-END-INV-COST-AMT (PC-SUB-CLASS-LVL SS-CURR-MN)09350000
               MOVE ML102-SLS-COST-AMT         (SS-CURR-MN)             09360000
                    TO AT-SLS-COST-AMT     (PC-SUB-CLASS-LVL SS-CURR-MN)09370000
               MOVE ML102-GRO-MRGN-AMT         (SS-CURR-MN)             09380000
                    TO AT-GRO-MRGN-AMT     (PC-SUB-CLASS-LVL SS-CURR-MN)09390000
           END-PERFORM.                                                 09400000
                                                                        09410000
SJ***** FOLLOWING DISPLAYS SHOW EACH DOLLARS/CENTS FOR EACH             09420000
SJ***** THESE WERE USED DURING TESTING TO BALANCE WITH IMS              09430000
SJ    *                                                                 09440000
      *    DISPLAY ' '.                                                 09450000
      *    DISPLAY 'TABLE MONTH DOLLAR AMOUNTS'.                        09460000
      *    DISPLAY 'BEG-INV-COST-AMT = '                                09470000
      *      AT-BEG-INV-COST-AMT (PC-SUB-CLASS-LVL).                    09480000
      *    DISPLAY 'BEG-INV-RTL-AMT = '                                 09490000
      *      AT-BEG-INV-RTL-AMT (PC-SUB-CLASS-LVL).                     09500000
      *    PERFORM VARYING SS-CURR-MN FROM 1 BY 1                       09510000
      *      UNTIL SS-CURR-MN > SS-OPEN-MN                              09520000
      *    DISPLAY ' '                                                  09530000
      *    DISPLAY 'MONTH = ' SS-CURR-MN                                09540000
      *    DISPLAY 'PRCH-NET-COST-AMT = '                               09550000
      *      AT-PRCH-NET-COST-AMT (PC-SUB-CLASS-LVL SS-CURR-MN)         09560000
      *    DISPLAY 'PRCH-RTL-AMT = '                                    09570000
      *      AT-PRCH-RTL-AMT (PC-SUB-CLASS-LVL SS-CURR-MN)              09580000
      *    DISPLAY 'SLS-RTL-AMT = '                                     09590000
      *      AT-SLS-RTL-AMT (PC-SUB-CLASS-LVL SS-CURR-MN)               09600000
      *    DISPLAY 'SHNK-RTL-AMT = '                                    09610000
      *      AT-SHNK-RTL-AMT (PC-SUB-CLASS-LVL SS-CURR-MN)              09620000
      *    DISPLAY 'INV-ADJ-RTL-AMT = '                                 09630000
      *      AT-INV-ADJ-RTL-AMT (PC-SUB-CLASS-LVL SS-CURR-MN)           09640000
      *    DISPLAY 'MKDN-RTL-AMT = '                                    09650000
      *      AT-MKDN-RTL-AMT (PC-SUB-CLASS-LVL SS-CURR-MN)              09660000
      *    DISPLAY 'END-INV-RTL-AMT = '                                 09670000
      *      AT-END-INV-RTL-AMT (PC-SUB-CLASS-LVL SS-CURR-MN)           09680000
      *    DISPLAY 'END-INV-COST-AMT = '                                09690000
      *      AT-END-INV-COST-AMT (PC-SUB-CLASS-LVL SS-CURR-MN)          09700000
      *    DISPLAY 'SLS-COST-AMT = '                                    09710000
      *      AT-SLS-COST-AMT (PC-SUB-CLASS-LVL SS-CURR-MN)              09720000
      *    DISPLAY 'GRO-MRGN-AMT = '                                    09730000
      *      AT-GRO-MRGN-AMT (PC-SUB-CLASS-LVL SS-CURR-MN)              09740000
      *    END-PERFORM.                                                 09750000
                                                                        09760000
           PERFORM 2650-ADD-TO-SCL-SEASON-TOTS.                         09770000
                                                                        09780000
           PERFORM 7000-READ-LEDGER-EXTRACT.                            09790000
                                                                        09800000
                                                                        09810000
       2650-ADD-TO-SCL-SEASON-TOTS.                                     09820000
                                                                        09830000
      ******************************************************************09840000
      * ADD THE SUB-CLASS DOLLARS TO THE SEASON TOTALS FOR THE SUB-CLASS09850000
      ******************************************************************09860000
                                                                        09870000
      *    ADD THE BEGINNING INVENTORY TO THE SEASON PURCHASE TOTAL     09880000
      *    FOR THE DEPARTMENT.                                          09890000
           MOVE 1 TO SS-SEASON.                                         09900000
           MOVE AT-BEG-INV-COST-AMT       (PC-SUB-CLASS-LVL)            09910000
             TO AT-SEAS-PRCH-NET-COST-AMT (PC-SUB-CLASS-LVL SS-SEASON). 09920000
           MOVE AT-BEG-INV-RTL-AMT        (PC-SUB-CLASS-LVL)            09930000
             TO AT-SEAS-PRCH-RTL-AMT      (PC-SUB-CLASS-LVL SS-SEASON). 09940000
                                                                        09950000
           MOVE 2 TO SS-SEASON.                                         09960000
           IF SS-OPEN-MN > 6                                            09970000
               MOVE AT-END-INV-COST-AMT     (PC-SUB-CLASS-LVL 6)        09980000
                TO AT-SEAS-PRCH-NET-COST-AMT(PC-SUB-CLASS-LVL SS-SEASON)09990000
               MOVE AT-END-INV-RTL-AMT      (PC-SUB-CLASS-LVL 6)        10000000
                TO AT-SEAS-PRCH-RTL-AMT     (PC-SUB-CLASS-LVL SS-SEASON)10010000
           END-IF.                                                      10020000
                                                                        10030000
      *    ADD THE MONTHLY DOLLARS TO THE SEASON TOTALS FOR THE         10040000
      *    DEPARTMENT. MONTHS 1-6 BELONG TO THE SPRING SEASON.          10050000
      *    MONTHS 7-12 BELONG TO THE FALL SEASON.                       10060000
                                                                        10070000
           PERFORM VARYING SS-CURR-MN FROM 1 BY 1                       10080000
             UNTIL (SS-CURR-MN > SS-OPEN-MN) OR (SS-CURR-MN > 12)       10090000
                                                                        10100000
               IF SS-CURR-MN < 7                                        10110000
                   MOVE 1 TO SS-SEASON                                  10120000
               ELSE                                                     10130000
                   MOVE 2 TO SS-SEASON                                  10140000
               END-IF                                                   10150000
                                                                        10160000
              ADD AT-PRCH-NET-COST-AMT  (PC-SUB-CLASS-LVL SS-CURR-MN) TO10170000
                  AT-SEAS-PRCH-NET-COST-AMT                             10180000
                                        (PC-SUB-CLASS-LVL SS-SEASON)    10190000
              ADD AT-PRCH-RTL-AMT       (PC-SUB-CLASS-LVL SS-CURR-MN) TO10200000
                  AT-SEAS-PRCH-RTL-AMT  (PC-SUB-CLASS-LVL SS-SEASON)    10210000
WR5701        ADD AT-RCPT-NET-COST-AMT  (PC-SUB-CLASS-LVL SS-CURR-MN) TO10220000
WR5701            AT-SEAS-RCPT-NET-COST-AMT                             10230000
                                        (PC-SUB-CLASS-LVL SS-SEASON)    10240000
WR5701        ADD AT-RCPT-RTL-AMT       (PC-SUB-CLASS-LVL SS-CURR-MN) TO10250000
WR5701            AT-SEAS-RCPT-RTL-AMT  (PC-SUB-CLASS-LVL SS-SEASON)    10260000
WR5701        ADD AT-PADJ-NET-COST-AMT  (PC-SUB-CLASS-LVL SS-CURR-MN) TO10270000
WR5701            AT-SEAS-PADJ-NET-COST-AMT                             10280000
                                        (PC-SUB-CLASS-LVL SS-SEASON)    10290000
WR5701        ADD AT-PADJ-RTL-AMT       (PC-SUB-CLASS-LVL SS-CURR-MN) TO10300000
WR5701            AT-SEAS-PADJ-RTL-AMT  (PC-SUB-CLASS-LVL SS-SEASON)    10310000
              ADD AT-SLS-RTL-AMT        (PC-SUB-CLASS-LVL SS-CURR-MN) TO10320000
                  AT-SEAS-SLS-RTL-AMT   (PC-SUB-CLASS-LVL SS-SEASON)    10330000
              ADD AT-SHNK-RTL-AMT       (PC-SUB-CLASS-LVL SS-CURR-MN) TO10340000
                  AT-SEAS-SHNK-RTL-AMT  (PC-SUB-CLASS-LVL SS-SEASON)    10350000
              ADD AT-INV-ADJ-RTL-AMT    (PC-SUB-CLASS-LVL SS-CURR-MN) TO10360000
                  AT-SEAS-SHNK-RTL-AMT  (PC-SUB-CLASS-LVL SS-SEASON)    10370000
              ADD AT-MKDN-RTL-AMT       (PC-SUB-CLASS-LVL SS-CURR-MN) TO10380000
                  AT-SEAS-MKDN-RTL-AMT  (PC-SUB-CLASS-LVL SS-SEASON)    10390000
              ADD AT-SLS-COST-AMT       (PC-SUB-CLASS-LVL SS-CURR-MN) TO10400000
                  AT-SEAS-SLS-COST-AMT  (PC-SUB-CLASS-LVL SS-SEASON)    10410000
              ADD AT-GRO-MRGN-AMT       (PC-SUB-CLASS-LVL SS-CURR-MN) TO10420000
                  AT-SEAS-GRO-MRGN-AMT  (PC-SUB-CLASS-LVL SS-SEASON)    10430000
           END-PERFORM.                                                 10440000
                                                                        10450000
SJ***** FOLLOWING DISPLAYS SHOW EACH DOLLARS/CENTS FOR EACH             10460000
SJ***** THESE WERE USED DURING TESTING TO BALANCE WITH IMS              10470000
SJ    *                                                                 10480000
      *    DISPLAY ' '.                                                 10490000
      *    DISPLAY 'TABLE SPRING SEASON DOLLAR AMOUNTS'.                10500000
      *    DISPLAY 'SEAS-PRCH-NET-COST-AMT = '                          10510000
      *      AT-SEAS-PRCH-NET-COST-AMT (PC-SUB-CLASS-LVL 1).            10520000
      *    DISPLAY 'SEAS-PRCH-RTL-AMT = '                               10530000
      *      AT-SEAS-PRCH-RTL-AMT (PC-SUB-CLASS-LVL 1).                 10540000
      *    DISPLAY 'SEAS-SLS-RTL-AMT = '                                10550000
      *      AT-SEAS-SLS-RTL-AMT (PC-SUB-CLASS-LVL 1).                  10560000
      *    DISPLAY 'SEAS-SHNK-RTL-AMT = '                               10570000
      *      AT-SEAS-SHNK-RTL-AMT (PC-SUB-CLASS-LVL 1).                 10580000
      *    DISPLAY 'SEAS-MKDN-RTL-AMT = '                               10590000
      *      AT-SEAS-MKDN-RTL-AMT (PC-SUB-CLASS-LVL 1).                 10600000
      *    DISPLAY 'SEAS-SLS-COST-AMT = '                               10610000
      *      AT-SEAS-SLS-COST-AMT (PC-SUB-CLASS-LVL 1).                 10620000
      *    DISPLAY 'SEAS-GRO-MRGN-AMT = '                               10630000
      *      AT-SEAS-GRO-MRGN-AMT (PC-SUB-CLASS-LVL 1).                 10640000
      *                                                                 10650000
      *    DISPLAY ' '.                                                 10660000
      *    DISPLAY 'TABLE FALL SEASON DOLLAR AMOUNTS'.                  10670000
      *    DISPLAY 'SEAS-PRCH-NET-COST-AMT = '                          10680000
      *      AT-SEAS-PRCH-NET-COST-AMT (PC-SUB-CLASS-LVL 2).            10690000
      *    DISPLAY 'SEAS-PRCH-RTL-AMT = '                               10700000
      *      AT-SEAS-PRCH-RTL-AMT (PC-SUB-CLASS-LVL 2).                 10710000
      *    DISPLAY 'SEAS-SLS-RTL-AMT = '                                10720000
      *      AT-SEAS-SLS-RTL-AMT (PC-SUB-CLASS-LVL 2).                  10730000
      *    DISPLAY 'SEAS-SHNK-RTL-AMT = '                               10740000
      *      AT-SEAS-SHNK-RTL-AMT (PC-SUB-CLASS-LVL 2).                 10750000
      *    DISPLAY 'SEAS-MKDN-RTL-AMT = '                               10760000
      *      AT-SEAS-MKDN-RTL-AMT (PC-SUB-CLASS-LVL 2).                 10770000
      *    DISPLAY 'SEAS-SLS-COST-AMT = '                               10780000
      *      AT-SEAS-SLS-COST-AMT (PC-SUB-CLASS-LVL 2).                 10790000
      *    DISPLAY 'SEAS-GRO-MRGN-AMT = '                               10800000
      *      AT-SEAS-GRO-MRGN-AMT (PC-SUB-CLASS-LVL 2).                 10810000
                                                                        10820000
       3000-PROCESS-BREAKS.                                             10830000
                                                                        10840000
      *    DETERMINE WHICH BUSINES LEVEL THE BREAK IS OCCURRING ON AND  10850000
      *    SET THE LEVEL SUBSCRIPT ACCORDINGLY.                         10860000
                                                                        10870000
           MOVE SS-CURR-LVL TO SS-PREV-LVL.                             10880000
           EVALUATE  TRUE                                               10890000
               WHEN PS-BREAK-IS-SUB-CLASS                               10900000
                   MOVE PC-SUB-CLASS-LVL TO SS-CURR-LVL                 10910000
               WHEN PS-BREAK-IS-MAJ-CLASS                               10920000
                   MOVE PC-MAJ-CLASS-LVL TO SS-CURR-LVL                 10930000
               WHEN PS-BREAK-IS-DEPT                                    10940000
                   MOVE PC-DEPT-LVL   TO SS-CURR-LVL                    10950000
               WHEN PS-BREAK-IS-BYR                                     10960000
                   MOVE PC-BYR-LVL    TO SS-CURR-LVL                    10970000
               WHEN PS-BREAK-IS-DMA                                     10980000
                   MOVE PC-DMA-LVL    TO SS-CURR-LVL                    10990000
               WHEN PS-BREAK-IS-GMA                                     11000000
                   MOVE PC-GMA-LVL    TO SS-CURR-LVL                    11010000
               WHEN PS-BREAK-IS-OPERCO                                  11020000
                   MOVE PC-OPERCO-LVL TO SS-CURR-LVL                    11030000
           END-EVALUATE.                                                11040000
                                                                        11050000
      *    PRINT THE HEADINGS                                           11060000
                                                                        11070000
           IF SS-CURR-LVL = PC-SUB-CLASS-LVL                            11080000
               IF (SS-PREV-LVL = PC-SUB-CLASS-LVL)                      11090000
                 AND (PV-SUB-CLASS-PER-PAGE = 1)                        11100000
                   WRITE LEDGER-REPORT-RECORD FROM DH-SUB-CLASS-HEADING 11110000
                       AFTER ADVANCING 2 LINE                           11120000
                   MOVE 0 TO PV-SUB-CLASS-PER-PAGE                      11130000
               ELSE                                                     11140000
                   PERFORM 7200-PRINT-PAGE-HEADINGS                     11150000
                   MOVE 1 TO PV-SUB-CLASS-PER-PAGE                      11160000
               END-IF                                                   11170000
           ELSE                                                         11180000
               PERFORM 7200-PRINT-PAGE-HEADINGS                         11190000
           END-IF.                                                      11200000
           PERFORM 7300-PRINT-TOTAL-HEADING.                            11210000
           PERFORM 7400-PRINT-DETAIL-HEADINGS.                          11220000
                                                                        11230000
      *    PRINT THE DETAIL                                             11240000
                                                                        11250000
           MOVE AT-BEG-INV-COST-AMT (SS-CURR-LVL)                       11260000
                                                 TO PV-BEG-INV-COST-AMT.11270000
           MOVE AT-BEG-INV-RTL-AMT  (SS-CURR-LVL)                       11280000
                                                 TO PV-BEG-INV-RTL-AMT. 11290000
           PERFORM 3600-PROCESS-BEGIN-INV-LINE.                         11300000
                                                                        11310000
           PERFORM 3300-PROCESS-MONTH-DET-LINES                         11320000
               VARYING SS-CURR-MN FROM 1 BY 1                           11330000
               UNTIL   SS-CURR-MN > SS-OPEN-MN.                         11340000
                                                                        11350000
      *    PRINT THE YEAR-TO-DATE TOTALS                                11360000
                                                                        11370000
           IF SS-OPEN-MN > 6                                            11380000
               PERFORM 3400-PROCESS-YTD-TOTAL-LINE                      11390000
           END-IF.                                                      11400000
                                                                        11410000
           IF PS-BREAK-IS-OPERCO                                        11420000
               NEXT SENTENCE                                            11430000
           ELSE                                                         11440000
               PERFORM 3200-ADD-TO-NEXT-HIGHER-LEVEL                    11450000
           END-IF.                                                      11460000
                                                                        11470000
           SET PS-BREAK-LEVEL-SW-INIT TO TRUE.                          11480000
                                                                        11490000
                                                                        11500000
       3100-FILL-HEADINGS.                                              11510000
                                                                        11520000
      ******************************************************************11530000
      *    FILL IN THE SUB HEADING INFORMATION.                         11540000
      ******************************************************************11550000
                                                                        11560000
           IF NOT PS-END-OF-LEDGER-EXTRACT                              11570000
      *        GET GMM NAME                                             11580000
               MOVE ML102-GMA-NBR           TO PV-GMA-NBR               11590000
               PERFORM 8100-GET-GMM-NAME                                11600000
               MOVE RSPBAR-WORKER-FIR-NAME  TO DP024-FNAME              11610000
               MOVE RSPBAR-WORKER-LAST-NAME TO DP024-LNAME              11620000
               PERFORM DP024-0000-FORMAT-NAME                           11630000
                                                                        11640000
      *        PUT PARENTHESES AROUND GMM NAME                          11650000
               MOVE SPACES                  TO PV-ENTIRE-NAME           11660000
                                               PV-NAME-PAREN-2          11670000
                                               PV-NAME                  11680000
               MOVE DP024-FLNAME            TO PV-ENTIRE-NAME           11690000
               INSPECT PV-NAME-WITH-PARENS REPLACING                    11700000
                   FIRST PC-2-SPACES-LIT                                11710000
                      BY PC-PAREN-SPACE-LIT                             11720000
               MOVE PV-NAME-WITH-PARENS     TO PV-NAME                  11730000
                                                                        11740000
      *        GET GMA DESCRIPTION                                      11750000
               MOVE '??'                    TO PV-DMA-NBR               11760000
                                               PV-BYR-NBR               11770000
               MOVE PC-DEPT-NBR-000         TO PV-DEPT-NBR              11780000
               MOVE PC-MDSELV-GMA           TO PV-MDSELV-CDE            11790000
               PERFORM 8400-GET-DEPT-LEVEL-DESC                         11800000
                                                                        11810000
      *        BUILD GMA HEADING LINE                                   11820000
               MOVE ML102-GMA-NBR           TO GH-GMA-NBR               11830000
               MOVE SPACES                  TO GH-GMA-DESC-GMM-NAME     11840000
               MOVE MDSEAR-DESC             TO PV-DESC                  11850000
               STRING PV-DESC  PV-NAME                                  11860000
                   DELIMITED BY PC-2-SPACES-LIT                         11870000
                                          INTO GH-GMA-DESC-GMM-NAME     11880000
                                                                        11890000
      *        GET DMM NAME                                             11900000
               MOVE ML102-DMA-NBR           TO PV-DMA-NBR               11910000
               PERFORM 8200-GET-DMM-NAME                                11920000
               MOVE RSPBAR-WORKER-FIR-NAME  TO DP024-FNAME              11930000
               MOVE RSPBAR-WORKER-LAST-NAME TO DP024-LNAME              11940000
               PERFORM DP024-0000-FORMAT-NAME                           11950000
                                                                        11960000
      *        PUT PARENTHESES AROUND DMM NAME                          11970000
               MOVE SPACES                  TO PV-ENTIRE-NAME           11980000
                                               PV-NAME-PAREN-2          11990000
                                               PV-NAME                  12000000
               MOVE DP024-FLNAME            TO PV-ENTIRE-NAME           12010000
               INSPECT PV-NAME-WITH-PARENS REPLACING                    12020000
                   FIRST PC-2-SPACES-LIT   BY                           12030000
                         PC-PAREN-SPACE-LIT                             12040000
               MOVE PV-NAME-WITH-PARENS     TO PV-NAME                  12050000
                                                                        12060000
      *        GET DMA DESCRIPTION                                      12070000
               MOVE '??'                    TO  PV-GMA-NBR              12080000
                                                PV-BYR-NBR              12090000
               MOVE PC-DEPT-NBR-000         TO  PV-DEPT-NBR             12100000
               MOVE PC-MDSELV-DMA           TO  PV-MDSELV-CDE           12110000
               PERFORM 8400-GET-DEPT-LEVEL-DESC                         12120000
                                                                        12130000
      *        BUILD DMA HEADING LINE                                   12140000
               MOVE ML102-DMA-NBR           TO DH-DMA-NBR               12150000
               MOVE SPACES                  TO DH-DMA-DESC-DMM-NAME     12160000
               MOVE MDSEAR-DESC             TO PV-DESC                  12170000
               STRING PV-DESC  PV-NAME                                  12180000
               DELIMITED BY PC-2-SPACES-LIT                             12190000
                                          INTO DH-DMA-DESC-DMM-NAME     12200000
                                                                        12210000
      *        GET BUYER NAME                                           12220000
               MOVE ML102-BYR-NBR           TO PV-BYR-NBR               12230000
               MOVE ML102-DEPT-NBR          TO PV-DEPT-NBR              12240000
               PERFORM 8300-GET-BYR-NAME                                12250000
               MOVE RSPBAR-WORKER-FIR-NAME  TO DP024-FNAME              12260000
               MOVE RSPBAR-WORKER-LAST-NAME TO DP024-LNAME              12270000
               PERFORM DP024-0000-FORMAT-NAME                           12280000
                                                                        12290000
      *        BUILD BUYER HEADING LINE                                 12300000
WR5701         MOVE ML102-BYR-NBR           TO BH-BYR-NBR               12310000
               MOVE DP024-FLNAME            TO BH-BYR-NAME              12320000
                                                                        12330000
      *        GET DEPT DESCRIPTION                                     12340000
               MOVE '??'                    TO PV-GMA-NBR               12350000
                                               PV-DMA-NBR               12360000
               MOVE ML102-DEPT-NBR          TO PV-DEPT-NBR              12370000
               MOVE PC-MDSELV-DPT           TO PV-MDSELV-CDE            12380000
               PERFORM 8400-GET-DEPT-LEVEL-DESC                         12390000
                                                                        12400000
      *        BUILD DEPT HEADING LINE                                  12410000
               MOVE ML102-DEPT-NBR          TO DH-DEPT-NBR              12420000
               MOVE MDSEAR-DESC             TO DH-DEPT-NAME             12430000
                                                                        12440000
      *        GET MAJOR CLASS DESCRIPTION                              12450000
               MOVE '??'                    TO PV-GMA-NBR               12460000
                                               PV-DMA-NBR               12470000
               MOVE ML102-DEPT-NBR          TO PV-DEPT-NBR              12480000
               MOVE ML102-MAJ-CL-NBR        TO PV-MAJ-CLASS-NBR         12490000
               MOVE PC-MDSELV-MCL           TO PV-MDSELV-CDE            12500000
               PERFORM 8500-GET-MAJ-CLASS-LEVEL-DESC                    12510000
                                                                        12520000
      *        BUILD MCL HEADING LINE                                   12530000
               MOVE ML102-MAJ-CL-NBR        TO DH-MAJ-CLASS-NBR         12540000
               MOVE MDSEAR-DESC             TO DH-MAJ-CLASS-NAME        12550000
                                                                        12560000
      *        GET SUB-CLASS DESCRIPTION                                12570000
               MOVE '??'                    TO PV-GMA-NBR               12580000
                                               PV-DMA-NBR               12590000
               MOVE ML102-DEPT-NBR          TO PV-DEPT-NBR              12600000
               MOVE ML102-MAJ-CL-NBR        TO PV-MAJ-CLASS-NBR         12610000
               MOVE ML102-SUB-CL-NBR        TO PV-2-BYTE-SUB-CLASS-NBR  12620000
               MOVE 0                       TO PV-1ST-BYTE-SUB-CLASS-NBR12630000
               MOVE PV-3-BYTE-SUB-CLASS-NBR TO PV-SUB-CLASS-NBR         12640000
               MOVE PC-MDSELV-SCL           TO PV-MDSELV-CDE            12650000
               PERFORM 8600-GET-SUB-CLASS-LEVEL-DESC                    12660000
                                                                        12670000
      *        BUILD SCL HEADING LINE                                   12680000
               MOVE ML102-SUB-CL-NBR        TO DH-SUB-CLASS-NBR         12690000
               MOVE MDSEAR-DESC             TO DH-SUB-CLASS-NAME        12700000
           END-IF.                                                      12710000
                                                                        12720000
                                                                        12730000
       3200-ADD-TO-NEXT-HIGHER-LEVEL.                                   12740000
                                                                        12750000
      ******************************************************************12760000
      * ADD THE BEGINNING INVENTORY, MONTHLY, AND SEASON TOTALS         12770000
      * FOR THE CURRENT LEVEL TO THE NEXT HIGHER LEVEL.                 12780000
      ******************************************************************12790000
                                                                        12800000
           ADD 1 SS-CURR-LVL GIVING SS-NEXT-LVL.                        12810000
                                                                        12820000
           ADD AT-BEG-INV-COST-AMT (SS-CURR-LVL) TO                     12830000
               AT-BEG-INV-COST-AMT (SS-NEXT-LVL).                       12840000
           ADD AT-BEG-INV-RTL-AMT  (SS-CURR-LVL) TO                     12850000
               AT-BEG-INV-RTL-AMT  (SS-NEXT-LVL).                       12860000
                                                                        12870000
           PERFORM VARYING SS-CURR-MN FROM 1 BY 1                       12880000
             UNTIL SS-CURR-MN > SS-OPEN-MN                              12890000
               ADD AT-PRCH-NET-COST-AMT (SS-CURR-LVL SS-CURR-MN) TO     12900000
                   AT-PRCH-NET-COST-AMT (SS-NEXT-LVL SS-CURR-MN)        12910000
               ADD AT-PRCH-RTL-AMT      (SS-CURR-LVL SS-CURR-MN) TO     12920000
                   AT-PRCH-RTL-AMT      (SS-NEXT-LVL SS-CURR-MN)        12930000
WR5701         ADD AT-RCPT-NET-COST-AMT (SS-CURR-LVL SS-CURR-MN) TO     12940000
WR5701             AT-RCPT-NET-COST-AMT (SS-NEXT-LVL SS-CURR-MN)        12950000
WR5701         ADD AT-RCPT-RTL-AMT      (SS-CURR-LVL SS-CURR-MN) TO     12960000
WR5701             AT-RCPT-RTL-AMT      (SS-NEXT-LVL SS-CURR-MN)        12970000
WR5701         ADD AT-PADJ-NET-COST-AMT (SS-CURR-LVL SS-CURR-MN) TO     12980000
WR5701             AT-PADJ-NET-COST-AMT (SS-NEXT-LVL SS-CURR-MN)        12990000
WR5701         ADD AT-PADJ-RTL-AMT      (SS-CURR-LVL SS-CURR-MN) TO     13000000
WR5701             AT-PADJ-RTL-AMT      (SS-NEXT-LVL SS-CURR-MN)        13010000
               ADD AT-SLS-RTL-AMT       (SS-CURR-LVL SS-CURR-MN) TO     13020000
                   AT-SLS-RTL-AMT       (SS-NEXT-LVL SS-CURR-MN)        13030000
               ADD AT-SHNK-RTL-AMT      (SS-CURR-LVL SS-CURR-MN) TO     13040000
                   AT-SHNK-RTL-AMT      (SS-NEXT-LVL SS-CURR-MN)        13050000
               ADD AT-INV-ADJ-RTL-AMT   (SS-CURR-LVL SS-CURR-MN) TO     13060000
                   AT-INV-ADJ-RTL-AMT   (SS-NEXT-LVL SS-CURR-MN)        13070000
               ADD AT-MKDN-RTL-AMT      (SS-CURR-LVL SS-CURR-MN) TO     13080000
                   AT-MKDN-RTL-AMT      (SS-NEXT-LVL SS-CURR-MN)        13090000
               ADD AT-END-INV-COST-AMT  (SS-CURR-LVL SS-CURR-MN) TO     13100000
                   AT-END-INV-COST-AMT  (SS-NEXT-LVL SS-CURR-MN)        13110000
               ADD AT-END-INV-RTL-AMT   (SS-CURR-LVL SS-CURR-MN) TO     13120000
                   AT-END-INV-RTL-AMT   (SS-NEXT-LVL SS-CURR-MN)        13130000
               ADD AT-SLS-COST-AMT      (SS-CURR-LVL SS-CURR-MN) TO     13140000
                   AT-SLS-COST-AMT      (SS-NEXT-LVL SS-CURR-MN)        13150000
               ADD AT-GRO-MRGN-AMT      (SS-CURR-LVL SS-CURR-MN) TO     13160000
                   AT-GRO-MRGN-AMT      (SS-NEXT-LVL SS-CURR-MN)        13170000
           END-PERFORM.                                                 13180000
                                                                        13190000
           PERFORM VARYING SS-SEASON FROM 1 BY 1                        13200000
             UNTIL SS-SEASON > 2                                        13210000
               ADD AT-SEAS-PRCH-NET-COST-AMT (SS-CURR-LVL SS-SEASON) TO 13220000
                   AT-SEAS-PRCH-NET-COST-AMT (SS-NEXT-LVL SS-SEASON)    13230000
               ADD AT-SEAS-PRCH-RTL-AMT      (SS-CURR-LVL SS-SEASON) TO 13240000
                   AT-SEAS-PRCH-RTL-AMT      (SS-NEXT-LVL SS-SEASON)    13250000
WR5701         ADD AT-SEAS-RCPT-NET-COST-AMT (SS-CURR-LVL SS-SEASON) TO 13260000
WR5701             AT-SEAS-RCPT-NET-COST-AMT (SS-NEXT-LVL SS-SEASON)    13270000
WR5701         ADD AT-SEAS-RCPT-RTL-AMT      (SS-CURR-LVL SS-SEASON) TO 13280000
WR5701             AT-SEAS-RCPT-RTL-AMT      (SS-NEXT-LVL SS-SEASON)    13290000
WR5701         ADD AT-SEAS-PADJ-NET-COST-AMT (SS-CURR-LVL SS-SEASON) TO 13300000
WR5701             AT-SEAS-PADJ-NET-COST-AMT (SS-NEXT-LVL SS-SEASON)    13310000
WR5701         ADD AT-SEAS-PADJ-RTL-AMT      (SS-CURR-LVL SS-SEASON) TO 13320000
WR5701             AT-SEAS-PADJ-RTL-AMT      (SS-NEXT-LVL SS-SEASON)    13330000
               ADD AT-SEAS-SLS-RTL-AMT       (SS-CURR-LVL SS-SEASON) TO 13340000
                   AT-SEAS-SLS-RTL-AMT       (SS-NEXT-LVL SS-SEASON)    13350000
               ADD AT-SEAS-SHNK-RTL-AMT      (SS-CURR-LVL SS-SEASON) TO 13360000
                   AT-SEAS-SHNK-RTL-AMT      (SS-NEXT-LVL SS-SEASON)    13370000
               ADD AT-SEAS-MKDN-RTL-AMT      (SS-CURR-LVL SS-SEASON) TO 13380000
                   AT-SEAS-MKDN-RTL-AMT      (SS-NEXT-LVL SS-SEASON)    13390000
               ADD AT-SEAS-SLS-COST-AMT      (SS-CURR-LVL SS-SEASON) TO 13400000
                   AT-SEAS-SLS-COST-AMT      (SS-NEXT-LVL SS-SEASON)    13410000
               ADD AT-SEAS-GRO-MRGN-AMT      (SS-CURR-LVL SS-SEASON) TO 13420000
                   AT-SEAS-GRO-MRGN-AMT      (SS-NEXT-LVL SS-SEASON)    13430000
           END-PERFORM.                                                 13440000
                                                                        13450000
                                                                        13460000
       3300-PROCESS-MONTH-DET-LINES.                                    13470000
                                                                        13480000
      ******************************************************************13490000
      * BUILD THE DETAIL LINE FOR THE CURRENT MONTH.                    13500000
      ******************************************************************13510000
                                                                        13520000
           MOVE MT-FSCL-MN-NM-ABBREV (SS-CURR-MN) TO DL-MONTH-ABBREV.   13530000
                                                                        13540000
WR5701     COMPUTE PV-AMT-RNDED ROUNDED                                 13550000
WR5701           = AT-RCPT-NET-COST-AMT (SS-CURR-LVL SS-CURR-MN)        13560000
WR5701           / PC-THOUSAND.                                         13570000
WR5701     MOVE PV-AMT-RNDED     TO DL-RECEIPTS-COST.                   13580000
WR5701                                                                  13590000
WR5701     COMPUTE PV-AMT-RNDED ROUNDED                                 13600000
WR5701           = AT-RCPT-RTL-AMT (SS-CURR-LVL SS-CURR-MN)             13610000
WR5701           / PC-THOUSAND.                                         13620000
WR5701     MOVE PV-AMT-RNDED     TO DL-RECEIPTS-RETAIL.                 13630000
WR5701                                                                  13640000
WR5701     COMPUTE PV-AMT-RNDED ROUNDED                                 13650000
WR5701           = AT-PADJ-NET-COST-AMT (SS-CURR-LVL SS-CURR-MN)        13660000
WR5701           / PC-THOUSAND.                                         13670000
WR5701     MOVE PV-AMT-RNDED     TO DL-PURCHASE-ADJ-COST.               13680000
WR5701                                                                  13690000
WR5701     COMPUTE PV-AMT-RNDED ROUNDED                                 13700000
WR5701           = AT-PADJ-RTL-AMT (SS-CURR-LVL SS-CURR-MN)             13710000
WR5701           / PC-THOUSAND.                                         13720000
WR5701     MOVE PV-AMT-RNDED     TO DL-PURCHASE-ADJ-RETAIL.             13730000
                                                                        13740000
           IF AT-PRCH-RTL-AMT (SS-CURR-LVL SS-CURR-MN) NOT = ZERO       13750000
               COMPUTE PV-PCT ROUNDED                                   13760000
                     = ((AT-PRCH-RTL-AMT    (SS-CURR-LVL SS-CURR-MN)    13770000
                     - AT-PRCH-NET-COST-AMT (SS-CURR-LVL SS-CURR-MN))   13780000
                     * 100)                                             13790000
                     / AT-PRCH-RTL-AMT      (SS-CURR-LVL SS-CURR-MN)    13800000
               MOVE PV-PCT       TO DL-MKON-PCT                         13810000
           ELSE                                                         13820000
               MOVE ZERO         TO DL-MKON-PCT                         13830000
           END-IF.                                                      13840000
                                                                        13850000
           COMPUTE PV-AMT-RNDED ROUNDED                                 13860000
                 = AT-SLS-RTL-AMT (SS-CURR-LVL SS-CURR-MN)              13870000
                 / PC-THOUSAND.                                         13880000
           MOVE PV-AMT-RNDED     TO DL-SALES.                           13890000
                                                                        13900000
           COMPUTE PV-AMT-RNDED ROUNDED                                 13910000
                 = AT-SHNK-RTL-AMT (SS-CURR-LVL SS-CURR-MN)             13920000
                 / PC-THOUSAND.                                         13930000
           MOVE PV-AMT-RNDED     TO DL-SHRINKAGE.                       13940000
                                                                        13950000
           COMPUTE PV-AMT-RNDED ROUNDED                                 13960000
                 = AT-MKDN-RTL-AMT (SS-CURR-LVL SS-CURR-MN)             13970000
                 / PC-THOUSAND.                                         13980000
           MOVE PV-AMT-RNDED     TO DL-MARKDOWNS.                       13990000
                                                                        14000000
           COMPUTE PV-AMT-RNDED ROUNDED                                 14010000
                 = AT-END-INV-COST-AMT (SS-CURR-LVL SS-CURR-MN)         14020000
                 / PC-THOUSAND.                                         14030000
           MOVE PV-AMT-RNDED     TO DL-END-INV-COST.                    14040000
                                                                        14050000
           COMPUTE PV-AMT-RNDED ROUNDED                                 14060000
                 = AT-END-INV-RTL-AMT (SS-CURR-LVL SS-CURR-MN)          14070000
                 / PC-THOUSAND.                                         14080000
           MOVE PV-AMT-RNDED     TO DL-END-INV-RETAIL.                  14090000
                                                                        14100000
           COMPUTE PV-AMT-RNDED ROUNDED                                 14110000
                 = AT-SLS-COST-AMT (SS-CURR-LVL SS-CURR-MN)             14120000
                 / PC-THOUSAND.                                         14130000
           MOVE PV-AMT-RNDED     TO DL-COST-OF-SALES.                   14140000
                                                                        14150000
           COMPUTE PV-AMT-RNDED ROUNDED                                 14160000
                 = AT-GRO-MRGN-AMT (SS-CURR-LVL SS-CURR-MN)             14170000
                 / PC-THOUSAND.                                         14180000
           MOVE PV-AMT-RNDED     TO DL-GM-DLRS.                         14190000
                                                                        14200000
           IF AT-SLS-RTL-AMT (SS-CURR-LVL SS-CURR-MN) NOT = ZERO        14210000
C14666         COMPUTE PV-SHNK-PCT ROUNDED                              14220000
                     = (AT-SHNK-RTL-AMT (SS-CURR-LVL SS-CURR-MN) * 100) 14230000
                     / AT-SLS-RTL-AMT   (SS-CURR-LVL SS-CURR-MN)        14240000
C14666         MOVE PV-SHNK-PCT  TO DL-SHNK-PCT                         14250000
                                                                        14260000
               COMPUTE PV-PCT ROUNDED                                   14270000
                     = (AT-MKDN-RTL-AMT (SS-CURR-LVL SS-CURR-MN) * 100) 14280000
                     / AT-SLS-RTL-AMT   (SS-CURR-LVL SS-CURR-MN)        14290000
               MOVE PV-PCT       TO DL-MKDN-PCT                         14300000
                                                                        14310000
               COMPUTE PV-PCT ROUNDED                                   14320000
                     = (AT-GRO-MRGN-AMT (SS-CURR-LVL SS-CURR-MN) * 100) 14330000
                     / AT-SLS-RTL-AMT   (SS-CURR-LVL SS-CURR-MN)        14340000
               MOVE PV-PCT       TO DL-GM-PCT                           14350000
           ELSE                                                         14360000
               MOVE ZEROES       TO DL-SHNK-PCT                         14370000
                                    DL-MKDN-PCT                         14380000
                                    DL-GM-PCT                           14390000
           END-IF.                                                      14400000
                                                                        14410000
           PERFORM 7500-PRINT-DETAIL-LINE.                              14420000
                                                                        14430000
           IF AT-INV-ADJ-RTL-AMT (SS-CURR-LVL SS-CURR-MN) NOT = ZERO    14440000
               MOVE SPACES TO DL-DETAIL-LINE                            14450000
               MOVE 'ADJ.' TO DL-MONTH-ABBREV                           14460000
               COMPUTE PV-AMT-RNDED ROUNDED                             14470000
                     = AT-INV-ADJ-RTL-AMT (SS-CURR-LVL SS-CURR-MN)      14480000
                     / PC-THOUSAND                                      14490000
               MOVE PV-AMT-RNDED TO DL-SHRINKAGE                        14500000
                                                                        14510000
               PERFORM 7500-PRINT-DETAIL-LINE                           14520000
                                                                        14530000
               MOVE SPACES TO DL-MONTH-ABBREV                           14540000
           END-IF.                                                      14550000
                                                                        14560000
           IF (SS-CURR-MN = SS-OPEN-MN) OR                              14570000
              (SS-CURR-MN = 6)                                          14580000
               PERFORM 3500-PROCESS-SEASON-TOTALS                       14590000
           END-IF.                                                      14600000
                                                                        14610000
           IF (SS-CURR-MN NOT = SS-OPEN-MN) AND                         14620000
              (SS-CURR-MN     = 6)                                      14630000
               MOVE AT-END-INV-COST-AMT (SS-CURR-LVL SS-CURR-MN)        14640000
                    TO PV-BEG-INV-COST-AMT                              14650000
               MOVE AT-END-INV-RTL-AMT (SS-CURR-LVL SS-CURR-MN)         14660000
                    TO PV-BEG-INV-RTL-AMT                               14670000
               PERFORM 3600-PROCESS-BEGIN-INV-LINE                      14680000
           END-IF.                                                      14690000
                                                                        14700000
                                                                        14710000
       3400-PROCESS-YTD-TOTAL-LINE.                                     14720000
                                                                        14730000
      ******************************************************************14740000
      *    SET THE DETAIL LINE FOR THE YEAR TO DATE INFORMATION.        14750000
      ******************************************************************14760000
                                                                        14770000
           INITIALIZE     DL-DETAIL-LINE                                14780000
           MOVE 'YTD'  TO DL-MONTH-ABBREV.                              14790000
                                                                        14800000
           COMPUTE YTD-PRCH-NET-COST-AMT                                14810000
                 = AT-SEAS-PRCH-NET-COST-AMT (SS-CURR-LVL 1)            14820000
                 + AT-SEAS-PRCH-NET-COST-AMT (SS-CURR-LVL 2)            14830000
                 - AT-END-INV-COST-AMT       (SS-CURR-LVL 6).           14840000
                                                                        14850000
           COMPUTE YTD-PRCH-RTL-AMT                                     14860000
                 = AT-SEAS-PRCH-RTL-AMT(SS-CURR-LVL 1)                  14870000
                 + AT-SEAS-PRCH-RTL-AMT(SS-CURR-LVL 2)                  14880000
                 - AT-END-INV-RTL-AMT(SS-CURR-LVL 6).                   14890000
                                                                        14900000
WR5701     COMPUTE YTD-RCPT-NET-COST-AMT                                14910000
WR5701           = AT-SEAS-RCPT-NET-COST-AMT (SS-CURR-LVL 1)            14920000
WR5701           + AT-SEAS-RCPT-NET-COST-AMT (SS-CURR-LVL 2).           14930000
WR5701                                                                  14940000
WR5701     COMPUTE YTD-RCPT-RTL-AMT                                     14950000
WR5701           = AT-SEAS-RCPT-RTL-AMT(SS-CURR-LVL 1)                  14960000
WR5701           + AT-SEAS-RCPT-RTL-AMT(SS-CURR-LVL 2).                 14970000
WR5701                                                                  14980000
WR5701     COMPUTE PV-AMT-RNDED ROUNDED                                 14990000
WR5701           = YTD-RCPT-NET-COST-AMT / PC-THOUSAND.                 15000000
WR5701     MOVE PV-AMT-RNDED TO DL-RECEIPTS-COST.                       15010000
WR5701                                                                  15020000
WR5701     COMPUTE PV-AMT-RNDED ROUNDED                                 15030000
WR5701           = YTD-RCPT-RTL-AMT / PC-THOUSAND.                      15040000
WR5701     MOVE PV-AMT-RNDED TO DL-RECEIPTS-RETAIL.                     15050000
WR5701                                                                  15060000
WR5701     COMPUTE YTD-PADJ-NET-COST-AMT                                15070000
WR5701           = AT-SEAS-PADJ-NET-COST-AMT (SS-CURR-LVL 1)            15080000
WR5701           + AT-SEAS-PADJ-NET-COST-AMT (SS-CURR-LVL 2).           15090000
WR5701                                                                  15100000
WR5701     COMPUTE YTD-PADJ-RTL-AMT                                     15110000
WR5701           = AT-SEAS-PADJ-RTL-AMT(SS-CURR-LVL 1)                  15120000
WR5701           + AT-SEAS-PADJ-RTL-AMT(SS-CURR-LVL 2).                 15130000
WR5701                                                                  15140000
WR5701     COMPUTE PV-AMT-RNDED ROUNDED                                 15150000
WR5701           = YTD-PADJ-NET-COST-AMT / PC-THOUSAND.                 15160000
WR5701     MOVE PV-AMT-RNDED TO DL-PURCHASE-ADJ-COST.                   15170000
WR5701                                                                  15180000
WR5701     COMPUTE PV-AMT-RNDED ROUNDED                                 15190000
WR5701           = YTD-PADJ-RTL-AMT / PC-THOUSAND.                      15200000
WR5701     MOVE PV-AMT-RNDED TO DL-PURCHASE-ADJ-RETAIL.                 15210000
WR5701                                                                  15220000
WR5701     IF YTD-PRCH-RTL-AMT  NOT = ZERO                              15230000
WR5701         COMPUTE PV-PCT ROUNDED =                                 15240000
WR5701           (((  YTD-PRCH-RTL-AMT                                  15250000
WR5701             -  YTD-PRCH-NET-COST-AMT ) * 100 )                   15260000
WR5701             /  YTD-PRCH-RTL-AMT )                                15270000
WR5701         MOVE PV-PCT   TO DL-MKON-PCT                             15280000
WR5701     ELSE                                                         15290000
WR5701         MOVE ZERO     TO DL-MKON-PCT                             15300000
WR5701     END-IF.                                                      15310000
                                                                        15320000
           COMPUTE YTD-SLS-RTL-AMT                                      15330000
                 = AT-SEAS-SLS-RTL-AMT (SS-CURR-LVL 1)                  15340000
                 + AT-SEAS-SLS-RTL-AMT (SS-CURR-LVL 2).                 15350000
                                                                        15360000
           COMPUTE YTD-SHNK-RTL-AMT                                     15370000
                 = AT-SEAS-SHNK-RTL-AMT (SS-CURR-LVL 1)                 15380000
                 + AT-SEAS-SHNK-RTL-AMT (SS-CURR-LVL 2).                15390000
                                                                        15400000
           COMPUTE YTD-MKDN-RTL-AMT                                     15410000
                 = AT-SEAS-MKDN-RTL-AMT (SS-CURR-LVL 1)                 15420000
                 + AT-SEAS-MKDN-RTL-AMT (SS-CURR-LVL 2).                15430000
                                                                        15440000
           COMPUTE YTD-SLS-COST-AMT                                     15450000
                 = AT-SEAS-SLS-COST-AMT (SS-CURR-LVL 1)                 15460000
                 + AT-SEAS-SLS-COST-AMT (SS-CURR-LVL 2).                15470000
                                                                        15480000
           COMPUTE YTD-GRO-MRGN-AMT                                     15490000
                 = AT-SEAS-GRO-MRGN-AMT (SS-CURR-LVL 1)                 15500000
                 + AT-SEAS-GRO-MRGN-AMT (SS-CURR-LVL 2).                15510000
                                                                        15520000
           COMPUTE PV-AMT-RNDED ROUNDED                                 15530000
                 = YTD-SLS-RTL-AMT / PC-THOUSAND.                       15540000
           MOVE PV-AMT-RNDED TO DL-SALES.                               15550000
                                                                        15560000
           COMPUTE PV-AMT-RNDED ROUNDED                                 15570000
                 = YTD-SHNK-RTL-AMT / PC-THOUSAND.                      15580000
           MOVE PV-AMT-RNDED TO DL-SHRINKAGE.                           15590000
                                                                        15600000
           COMPUTE PV-AMT-RNDED ROUNDED                                 15610000
                 = YTD-MKDN-RTL-AMT / PC-THOUSAND.                      15620000
           MOVE PV-AMT-RNDED TO DL-MARKDOWNS.                           15630000
                                                                        15640000
           COMPUTE PV-AMT-RNDED ROUNDED                                 15650000
                 = YTD-SLS-COST-AMT / PC-THOUSAND.                      15660000
           MOVE PV-AMT-RNDED TO DL-COST-OF-SALES.                       15670000
                                                                        15680000
           COMPUTE PV-AMT-RNDED ROUNDED                                 15690000
                 = YTD-GRO-MRGN-AMT / PC-THOUSAND.                      15700000
           MOVE PV-AMT-RNDED TO DL-GM-DLRS.                             15710000
                                                                        15720000
           IF YTD-SLS-RTL-AMT NOT = ZERO                                15730000
C14666         COMPUTE PV-SHNK-PCT ROUNDED                              15740000
                     = (YTD-SHNK-RTL-AMT * 100) / YTD-SLS-RTL-AMT       15750000
C14666         MOVE PV-SHNK-PCT TO DL-SHNK-PCT                          15760000
                                                                        15770000
               COMPUTE PV-PCT ROUNDED                                   15780000
                     = (YTD-MKDN-RTL-AMT * 100) / YTD-SLS-RTL-AMT       15790000
               MOVE PV-PCT   TO DL-MKDN-PCT                             15800000
                                                                        15810000
               COMPUTE PV-PCT ROUNDED                                   15820000
                     = (YTD-GRO-MRGN-AMT * 100) / YTD-SLS-RTL-AMT       15830000
               MOVE PV-PCT   TO DL-GM-PCT                               15840000
           ELSE                                                         15850000
               MOVE ZEROES   TO DL-SHNK-PCT                             15860000
                                DL-MKDN-PCT                             15870000
                                DL-GM-PCT                               15880000
           END-IF.                                                      15890000
                                                                        15900000
           PERFORM 7600-PRINT-TOTAL-LINE.                               15910000
                                                                        15920000
                                                                        15930000
       3500-PROCESS-SEASON-TOTALS.                                      15940000
                                                                        15950000
      ******************************************************************15960000
      * SET UP THE DETAIL LINE FOR THE END OF SEASON INFO.              15970000
      ******************************************************************15980000
                                                                        15990000
           INITIALIZE DL-DETAIL-LINE.                                   16000000
                                                                        16010000
           IF SS-CURR-MN < 7                                            16020000
               MOVE 1        TO SS-SEASON                               16030000
               MOVE 'SPR'    TO DL-MONTH-ABBREV                         16040000
           ELSE                                                         16050000
               MOVE 2        TO SS-SEASON                               16060000
               MOVE 'FAL'    TO DL-MONTH-ABBREV                         16070000
           END-IF.                                                      16080000
                                                                        16090000
           COMPUTE PV-AMT-RNDED ROUNDED                                 16100000
WR5701           = AT-SEAS-RCPT-NET-COST-AMT (SS-CURR-LVL SS-SEASON)    16110000
                 / PC-THOUSAND.                                         16120000
WR5701     MOVE PV-AMT-RNDED TO DL-RECEIPTS-COST.                       16130000
                                                                        16140000
           COMPUTE PV-AMT-RNDED ROUNDED                                 16150000
WR5701           = AT-SEAS-RCPT-RTL-AMT (SS-CURR-LVL SS-SEASON)         16160000
                 / PC-THOUSAND.                                         16170000
WR5701     MOVE PV-AMT-RNDED TO DL-RECEIPTS-RETAIL.                     16180000
                                                                        16190000
           COMPUTE PV-AMT-RNDED ROUNDED                                 16200000
WR5701           = AT-SEAS-PADJ-NET-COST-AMT (SS-CURR-LVL SS-SEASON)    16210000
                 / PC-THOUSAND.                                         16220000
WR5701     MOVE PV-AMT-RNDED TO DL-PURCHASE-ADJ-COST.                   16230000
                                                                        16240000
           COMPUTE PV-AMT-RNDED ROUNDED                                 16250000
WR5701           = AT-SEAS-PADJ-RTL-AMT (SS-CURR-LVL SS-SEASON)         16260000
                 / PC-THOUSAND.                                         16270000
WR5701     MOVE PV-AMT-RNDED TO DL-PURCHASE-ADJ-RETAIL.                 16280000
                                                                        16290000
WR5701     IF AT-SEAS-RCPT-RTL-AMT (SS-CURR-LVL SS-SEASON) NOT = ZERO   16300000
WR5701         COMPUTE AT-SEAS-PRCH-RTL-AMT (SS-CURR-LVL SS-SEASON)     16310000
WR5701             =  (AT-SEAS-RCPT-RTL-AMT (SS-CURR-LVL SS-SEASON)     16320000
WR5701               + AT-SEAS-PADJ-RTL-AMT (SS-CURR-LVL SS-SEASON)     16330000
WR5701               + PV-BEG-INV-RTL-AMT  )                            16340000
WR5701         COMPUTE AT-SEAS-PRCH-NET-COST-AMT (SS-CURR-LVL SS-SEASON)16350000
WR5701             =  (AT-SEAS-RCPT-NET-COST-AMT (SS-CURR-LVL SS-SEASON)16360000
WR5701               + AT-SEAS-PADJ-NET-COST-AMT (SS-CURR-LVL SS-SEASON)16370000
WR5701               + PV-BEG-INV-COST-AMT  )                           16380000
WR5701         IF AT-SEAS-PRCH-RTL-AMT (SS-CURR-LVL SS-SEASON) NOT = 0  16390000
WR5701             COMPUTE PV-PCT ROUNDED =                             16400000
WR5701                 (((AT-SEAS-PRCH-RTL-AMT (SS-CURR-LVL SS-SEASON)  16410000
WR5701                  - AT-SEAS-PRCH-NET-COST-AMT                     16420000
WR5701                                         (SS-CURR-LVL SS-SEASON)) 16430000
WR5701                  * 100)                                          16440000
WR5701                 /  AT-SEAS-PRCH-RTL-AMT (SS-CURR-LVL SS-SEASON)) 16450000
WR5701             MOVE PV-PCT   TO DL-MKON-PCT                         16460000
WR5701         ELSE                                                     16470000
WR5701             MOVE ZERO     TO DL-MKON-PCT                         16480000
WR5701     ELSE                                                         16490000
WR5701         MOVE ZERO     TO DL-MKON-PCT                             16500000
WR5701     END-IF.                                                      16510000
      *    IF AT-SEAS-PRCH-RTL-AMT (SS-CURR-LVL SS-SEASON) NOT = ZERO   16520000
      *        COMPUTE PV-PCT ROUNDED                                   16530000
      *              = ((AT-SEAS-PRCH-RTL-AMT   (SS-CURR-LVL SS-SEASON) 16540000
      *              - AT-SEAS-PRCH-NET-COST-AMT                        16550000
      *                                         (SS-CURR-LVL SS-SEASON))16560000
      *              * 100)                                             16570000
      *              / AT-SEAS-PRCH-RTL-AMT     (SS-CURR-LVL SS-SEASON) 16580000
      *        MOVE PV-PCT   TO DL-MKON-PCT                             16590000
      *    ELSE                                                         16600000
      *        MOVE ZERO     TO DL-MKON-PCT                             16610000
      *    END-IF.                                                      16620000
                                                                        16630000
           COMPUTE PV-AMT-RNDED ROUNDED                                 16640000
                 = AT-SEAS-SLS-RTL-AMT (SS-CURR-LVL SS-SEASON)          16650000
                 / PC-THOUSAND.                                         16660000
           MOVE PV-AMT-RNDED TO DL-SALES.                               16670000
                                                                        16680000
           COMPUTE PV-AMT-RNDED ROUNDED                                 16690000
                 = AT-SEAS-SHNK-RTL-AMT (SS-CURR-LVL SS-SEASON)         16700000
                 / PC-THOUSAND.                                         16710000
           MOVE PV-AMT-RNDED TO DL-SHRINKAGE.                           16720000
                                                                        16730000
           COMPUTE PV-AMT-RNDED ROUNDED                                 16740000
                 = AT-SEAS-MKDN-RTL-AMT (SS-CURR-LVL SS-SEASON)         16750000
                 / PC-THOUSAND.                                         16760000
           MOVE PV-AMT-RNDED TO DL-MARKDOWNS.                           16770000
                                                                        16780000
           COMPUTE PV-AMT-RNDED ROUNDED                                 16790000
                 = AT-SEAS-SLS-COST-AMT (SS-CURR-LVL SS-SEASON)         16800000
                 / PC-THOUSAND.                                         16810000
           MOVE PV-AMT-RNDED TO DL-COST-OF-SALES.                       16820000
                                                                        16830000
           COMPUTE PV-AMT-RNDED ROUNDED                                 16840000
                 = AT-SEAS-GRO-MRGN-AMT (SS-CURR-LVL SS-SEASON)         16850000
                 / PC-THOUSAND.                                         16860000
           MOVE PV-AMT-RNDED TO DL-GM-DLRS.                             16870000
                                                                        16880000
           IF AT-SEAS-SLS-RTL-AMT (SS-CURR-LVL SS-SEASON) NOT = ZERO    16890000
C14666         COMPUTE PV-SHNK-PCT ROUNDED                              16900000
                     = (AT-SEAS-SHNK-RTL-AMT (SS-CURR-LVL SS-SEASON)    16910000
                     * 100)                                             16920000
                     / AT-SEAS-SLS-RTL-AMT   (SS-CURR-LVL SS-SEASON)    16930000
C14666         MOVE PV-SHNK-PCT TO DL-SHNK-PCT                          16940000
                                                                        16950000
               COMPUTE PV-PCT ROUNDED                                   16960000
                     = (AT-SEAS-MKDN-RTL-AMT (SS-CURR-LVL SS-SEASON)    16970000
                     * 100)                                             16980000
                     / AT-SEAS-SLS-RTL-AMT   (SS-CURR-LVL SS-SEASON)    16990000
               MOVE PV-PCT   TO DL-MKDN-PCT                             17000000
                                                                        17010000
               COMPUTE PV-PCT ROUNDED                                   17020000
                     = (AT-SEAS-GRO-MRGN-AMT (SS-CURR-LVL SS-SEASON)    17030000
                     * 100)                                             17040000
                     / AT-SEAS-SLS-RTL-AMT   (SS-CURR-LVL SS-SEASON)    17050000
               MOVE PV-PCT   TO DL-GM-PCT                               17060000
                                                                        17070000
           ELSE                                                         17080000
               MOVE ZEROES   TO DL-SHNK-PCT                             17090000
                                DL-MKDN-PCT                             17100000
                                DL-GM-PCT                               17110000
           END-IF.                                                      17120000
                                                                        17130000
           PERFORM 7600-PRINT-TOTAL-LINE.                               17140000
           PERFORM 7700-PRINT-BLANK-LINE.                               17150000
                                                                        17160000
                                                                        17170000
       3600-PROCESS-BEGIN-INV-LINE.                                     17180000
                                                                        17190000
      ******************************************************************17200000
      * BUILD THE DETAIL LINE FOR THE BEGINNING INVENTORY INFO.         17210000
      ******************************************************************17220000
                                                                        17230000
           MOVE SPACES       TO DL-DETAIL-LINE.                         17240000
           MOVE 'B.I'        TO DL-MONTH-ABBREV.                        17250000
                                                                        17260000
           COMPUTE PV-AMT-RNDED ROUNDED                                 17270000
                 = PV-BEG-INV-COST-AMT / PC-THOUSAND.                   17280000
WR5701     MOVE PV-AMT-RNDED TO DL-END-INV-COST.                        17290000
                                                                        17300000
           COMPUTE PV-AMT-RNDED ROUNDED                                 17310000
                 = PV-BEG-INV-RTL-AMT / PC-THOUSAND.                    17320000
WR5701     MOVE PV-AMT-RNDED TO DL-END-INV-RETAIL.                      17330000
                                                                        17340000
WR5701**   IF SS-CURR-MN NOT = 6                                        17350000
WR5701**       PERFORM 7500-PRINT-DETAIL-LINE                           17360000
WR5701**   END-IF.                                                      17370000
                                                                        17380000
           IF PV-BEG-INV-RTL-AMT NOT = ZERO                             17390000
               COMPUTE PV-PCT ROUNDED                                   17400000
                   = ((PV-BEG-INV-RTL-AMT - PV-BEG-INV-COST-AMT) * 100) 17410000
                   /   PV-BEG-INV-RTL-AMT                               17420000
               MOVE PV-PCT   TO DL-MKON-PCT                             17430000
           ELSE                                                         17440000
               MOVE ZERO     TO DL-MKON-PCT                             17450000
           END-IF.                                                      17460000
                                                                        17470000
******     PERFORM 7500-PRINT-DETAIL-LINE.                              17480000
                                                                        17490000
                                                                        17500000
       7000-READ-LEDGER-EXTRACT.                                        17510000
                                                                        17520000
           READ LEDGER-EXTRACT-FILE INTO ML102-LEDGER-EXTRACT-REC       17530000
               AT END SET PS-END-OF-LEDGER-EXTRACT TO TRUE.             17540000
                                                                        17550000
       7100-READ-LEDGER-EXTRACT-DATE.                                   17560000
                                                                        17570000
           READ LEDGER-EXTRACT-DATE-FILE                                17580000
               INTO ML114-LEDGER-EXTRACT-DATE-REC                       17590000
               AT END SET PS-END-OF-LEDGER-DATE-FILE TO TRUE.           17600000
                                                                        17610000
                                                                        17620000
       7200-PRINT-PAGE-HEADINGS.                                        17630000
                                                                        17640000
      ******************************************************************17650000
      * PRINT THE PAGE HEADINGS.                                        17660000
      * PRINT THE SUB HEADINGS BASED ON THE VALUE OF THE SUBSCRIPT.     17670000
      ******************************************************************17680000
                                                                        17690000
      *    IF LC-LASER-BREAK                                            17700000
      *        MOVE LC-LASER-CONTROL-FF TO                              17710000
      *            DP175O-LASER-NEW-PAGE-INDICATR                       17720000
      *        WRITE LEDGER-REPORT-RECORD FROM                          17730000
      *            LC-LASER-CONTROL-FD                                  17740000
      *                AFTER ADVANCING PAGE                             17750000
      *    ELSE                                                         17760000
      *        MOVE SPACES TO DP175O-LASER-NEW-PAGE-INDICATR  .         17770000
      *    END-IF.                                                      17780000
      *    MOVE 'N' TO LC-LASER-BREAK-SW.                               17790000
                                                                        17800000
           ADD  1           TO PV-PAGE-CNT.                             17810000
           MOVE PV-PAGE-CNT TO DP175O-PAGE-NUMBER.                      17820000
                                                                        17830000
           WRITE LEDGER-REPORT-RECORD                                   17840000
               FROM DP175O-STANDRD-HEADER-175-COLS                      17850000
               AFTER ADVANCING PAGE.                                    17860000
                                                                        17870000
           WRITE LEDGER-REPORT-RECORD                                   17880000
               FROM PH2-PAGE-HEADING-2                                  17890000
               AFTER ADVANCING 1 LINE.                                  17900000
                                                                        17910000
           WRITE LEDGER-REPORT-RECORD                                   17920000
               FROM PH3-PAGE-HEADING-3                                  17930000
               AFTER ADVANCING 1 LINE.                                  17940000
                                                                        17950000
           IF SS-CURR-LVL = PC-OPERCO-LVL                               17960000
               WRITE LEDGER-REPORT-RECORD  FROM CH-COMPANY-HEADING      17970000
                   AFTER ADVANCING 1 LINE                               17980000
           END-IF.                                                      17990000
                                                                        18000000
           IF SS-CURR-LVL < PC-OPERCO-LVL                               18010000
               WRITE LEDGER-REPORT-RECORD  FROM GH-GMA-HEADING          18020000
                   AFTER ADVANCING 1 LINE                               18030000
           END-IF.                                                      18040000
                                                                        18050000
           IF SS-CURR-LVL < PC-GMA-LVL                                  18060000
               WRITE LEDGER-REPORT-RECORD  FROM DH-DMA-HEADING          18070000
                   AFTER ADVANCING 1 LINE                               18080000
           END-IF.                                                      18090000
                                                                        18100000
           IF SS-CURR-LVL < PC-DMA-LVL                                  18110000
               WRITE LEDGER-REPORT-RECORD  FROM BH-BUYER-HEADING        18120000
                   AFTER ADVANCING 1 LINE                               18130000
           END-IF.                                                      18140000
                                                                        18150000
           IF SS-CURR-LVL < PC-BYR-LVL                                  18160000
               WRITE LEDGER-REPORT-RECORD  FROM DH-DEPT-HEADING         18170000
                   AFTER ADVANCING 1 LINE                               18180000
           END-IF.                                                      18190000
                                                                        18200000
           IF SS-CURR-LVL < PC-DEPT-LVL                                 18210000
               WRITE LEDGER-REPORT-RECORD  FROM DH-MAJ-CLASS-HEADING    18220000
                   AFTER ADVANCING 1 LINE                               18230000
           END-IF.                                                      18240000
                                                                        18250000
           IF SS-CURR-LVL < PC-MAJ-CLASS-LVL                            18260000
               WRITE LEDGER-REPORT-RECORD  FROM DH-SUB-CLASS-HEADING    18270000
                   AFTER ADVANCING 1 LINE                               18280000
           END-IF.                                                      18290000
                                                                        18300000
                                                                        18310000
       7300-PRINT-TOTAL-HEADING.                                        18320000
                                                                        18330000
           EVALUATE TRUE                                                18340000
               WHEN PS-BREAK-IS-OPERCO                                  18350000
                   WRITE LEDGER-REPORT-RECORD FROM PC-COMPANY-TOTALS    18360000
                   AFTER ADVANCING 1 LINE                               18370000
               WHEN PS-BREAK-IS-GMA                                     18380000
                   WRITE LEDGER-REPORT-RECORD FROM PC-DIVISION-TOTALS   18390000
               WHEN PS-BREAK-IS-DMA                                     18400000
                   WRITE LEDGER-REPORT-RECORD FROM PC-MANAGER-TOTALS    18410000
               WHEN PS-BREAK-IS-BYR                                     18420000
                   WRITE LEDGER-REPORT-RECORD FROM PC-BUYER-TOTALS      18430000
                   AFTER ADVANCING 1 LINE                               18440000
               WHEN PS-BREAK-IS-DEPT                                    18450000
                   WRITE LEDGER-REPORT-RECORD FROM PC-DEPT-TOTALS       18460000
                   AFTER ADVANCING 1 LINE                               18470000
               WHEN PS-BREAK-IS-MAJ-CLASS                               18480000
                   WRITE LEDGER-REPORT-RECORD FROM PC-MAJ-CLASS-TOTALS  18490000
                   AFTER ADVANCING 1 LINE                               18500000
      *        WHEN PS-BREAK-IS-SUB-CLASS                               18510000
      *            WRITE LEDGER-REPORT-RECORD FROM PC-SUB-CLASS-TOTALS  18520000
      *            AFTER ADVANCING 1 LINE                               18530000
           END-EVALUATE.                                                18540000
                                                                        18550000
                                                                        18560000
       7400-PRINT-DETAIL-HEADINGS.                                      18570000
                                                                        18580000
           WRITE LEDGER-REPORT-RECORD                                   18590000
               FROM DH1-DETAIL-HEADING-1                                18600000
               AFTER ADVANCING 1 LINES.                                 18610000
                                                                        18620000
           WRITE LEDGER-REPORT-RECORD                                   18630000
               FROM DH2-DETAIL-HEADING-2                                18640000
               AFTER ADVANCING 1 LINE.                                  18650000
                                                                        18660000
                                                                        18670000
       7500-PRINT-DETAIL-LINE.                                          18680000
                                                                        18690000
           WRITE LEDGER-REPORT-RECORD                                   18700000
               FROM DL-DETAIL-LINE                                      18710000
               AFTER ADVANCING 1 LINE.                                  18720000
                                                                        18730000
                                                                        18740000
       7600-PRINT-TOTAL-LINE.                                           18750000
                                                                        18760000
           WRITE LEDGER-REPORT-RECORD                                   18770000
               FROM UL-UNDER-LINE                                       18780000
               AFTER ADVANCING 1 LINE.                                  18790000
                                                                        18800000
           WRITE LEDGER-REPORT-RECORD                                   18810000
               FROM DL-DETAIL-LINE                                      18820000
               AFTER ADVANCING 1 LINE.                                  18830000
                                                                        18840000
                                                                        18850000
       7700-PRINT-BLANK-LINE.                                           18860000
                                                                        18870000
           INITIALIZE LEDGER-REPORT-RECORD.                             18880000
           WRITE LEDGER-REPORT-RECORD                                   18890000
              AFTER ADVANCING 1 LINE.                                   18900000
                                                                        18910000
                                                                        18920000
       8000-GET-DATE-ATTRIBUTES.                                        18930000
                                                                        18940000
           EXEC SQL                                                     18950000
                SELECT                                                  18960000
                    FSCL_YR_NBR                                         18970000
                   ,FSCL_MN_NM                                          18980000
                   ,FSCL_YR_BEG_DTE                                     18990000
                INTO                                                    19000000
                    :DTATTR-FSCL-YR-NBR                                 19010000
                   ,:DTATTR-FSCL-MN-NM                                  19020000
                   ,:DTATTR-FSCL-YR-BEG-DTE                             19030000
                FROM                                                    19040000
                    TDTATTR                                             19050000
                WHERE                                                   19060000
                    KY_DTE = :DTATTR-KY-DTE                             19070000
W26603             WITH UR                                              19080000
           END-EXEC                                                     19090000
                                                                        19100000
           EVALUATE TRUE                                                19110000
               WHEN SQLCODE        = +000                               19120000
                   CONTINUE                                             19130000
               WHEN OTHER                                               19140000
                   DISPLAY 'DTATTR-KY-DTE: ' DTATTR-KY-DTE              19150000
                   MOVE    '8000-GET-DATE-ATTRIBUTES'                   19160000
                                            TO PV-PARAGRAPH-NAME        19170000
                   MOVE    'SELECT ROW FROM TDTATTR'                    19180000
                                            TO PV-DB2-OPER-ATTEMPTED    19190000
                   PERFORM 9999-SQL-ABEND                               19200000
           END-EVALUATE.                                                19210000
                                                                        19220000
                                                                        19230000
                                                                        19240000
       8100-GET-GMM-NAME.                                               19250000
      *                                                                 19260000
           EXEC SQL                                                     19270000
                SELECT      B.WORKER_LAST_NAME                          19280000
                     ,      B.WORKER_FIR_NAME                           19290000
                  INTO     :RSPBAR-WORKER-LAST-NAME                     19300000
                     ,     :RSPBAR-WORKER-FIR-NAME                      19310000
                  FROM      TMDSEAR A                                   19320000
                     ,      TRSPBAR B                                   19330000
                     ,      TAPLAVL C                                   19340000
                 WHERE     (A.GMA_NBR     = :PV-GMA-NBR)                19350000
                   AND     (B.RSPLVL_CDE  = :PC-RSPLVL-CDE-GMM)         19360000
                   AND     (A.OPERCO_NBR  = :PC-OPERCO-NBR)             19370000
                   AND     (C.APLSYS_CDE  = :PC-APLSYS-CDE)             19380000
                   AND     (A.MDSEAR_DKEY =  B.MDSEAR_DKEY)             19390000
                   AND     (A.MDSEAR_DKEY =  C.MDSEAR_DKEY)             19400000
                   AND     (:ML114-EXTRACT-DTE                          19410000
                            BETWEEN B.WORKER_STRT_DTE                   19420000
                            AND     B.WORKER_END_DTE )                  19430000
                   AND     (:ML114-EXTRACT-DTE                          19440000
                            BETWEEN C.MDSEAR_STRT_DTE                   19450000
                            AND     C.MDSEAR_END_DTE )                  19460000
W26603             WITH UR                                              19470000
           END-EXEC                                                     19480000
                                                                        19490000
           EVALUATE TRUE                                                19500000
               WHEN SQLCODE        = +000                               19510000
                   CONTINUE                                             19520000
               WHEN SQLCODE        = +100                               19530000
                   DISPLAY 'GMA NUMBER ' PV-GMA-NBR ' NOT FOUND.'       19540000
                   MOVE 'OPEN' TO  RSPBAR-WORKER-FIR-NAME               19550000
                   MOVE SPACE  TO  RSPBAR-WORKER-LAST-NAME              19560000
               WHEN OTHER                                               19570000
                   MOVE '8100-GET-GMM-NAME' TO PV-PARAGRAPH-NAME        19580000
                   MOVE 'SELECT ROW FROM TRSPBAR  '                     19590000
                                            TO PV-DB2-OPER-ATTEMPTED    19600000
                   PERFORM 9999-SQL-ABEND                               19610000
           END-EVALUATE.                                                19620000
                                                                        19630000
                                                                        19640000
       8200-GET-DMM-NAME.                                               19650000
                                                                        19660000
           EXEC SQL                                                     19670000
                SELECT      B.WORKER_LAST_NAME                          19680000
                     ,      B.WORKER_FIR_NAME                           19690000
                  INTO     :RSPBAR-WORKER-LAST-NAME                     19700000
                     ,     :RSPBAR-WORKER-FIR-NAME                      19710000
                  FROM      TMDSEAR A                                   19720000
                     ,      TRSPBAR B                                   19730000
                     ,      TAPLAVL C                                   19740000
                 WHERE     (A.DMA_NBR     = :PV-DMA-NBR)                19750000
                   AND     (B.RSPLVL_CDE  = :PC-RSPLVL-CDE-DMM)         19760000
                   AND     (A.OPERCO_NBR  = :PC-OPERCO-NBR)             19770000
                   AND     (C.APLSYS_CDE  = :PC-APLSYS-CDE)             19780000
                   AND     (A.MDSEAR_DKEY =  B.MDSEAR_DKEY)             19790000
                   AND     (A.MDSEAR_DKEY =  C.MDSEAR_DKEY)             19800000
                   AND     (:ML114-EXTRACT-DTE                          19810000
                            BETWEEN B.WORKER_STRT_DTE                   19820000
                            AND     B.WORKER_END_DTE )                  19830000
                   AND     (:ML114-EXTRACT-DTE                          19840000
                            BETWEEN C.MDSEAR_STRT_DTE                   19850000
                            AND     C.MDSEAR_END_DTE )                  19860000
W26603             WITH UR                                              19870000
           END-EXEC                                                     19880000
                                                                        19890000
           EVALUATE TRUE                                                19900000
               WHEN SQLCODE        = +000                               19910000
                   CONTINUE                                             19920000
               WHEN SQLCODE        = +100                               19930000
                   DISPLAY 'DMA NUMBER ' PV-DMA-NBR ' NOT FOUND.'       19940000
                   MOVE 'OPEN' TO  RSPBAR-WORKER-FIR-NAME               19950000
                   MOVE SPACE  TO  RSPBAR-WORKER-LAST-NAME              19960000
               WHEN OTHER                                               19970000
                   MOVE '8200-GET-DMM-NAME' TO PV-PARAGRAPH-NAME        19980000
                   MOVE 'SELECT ROW FROM TRSPBAR  '                     19990000
                                            TO PV-DB2-OPER-ATTEMPTED    20000000
                   PERFORM 9999-SQL-ABEND                               20010000
           END-EVALUATE.                                                20020000
                                                                        20030000
                                                                        20040000
       8300-GET-BYR-NAME.                                               20050000
                                                                        20060000
           EXEC SQL                                                     20070000
                SELECT      DISTINCT                                    20080000
                            A.BYR_NBR                                   20090000
                     ,      B.WORKER_LAST_NAME                          20100000
                     ,      B.WORKER_FIR_NAME                           20110000
                  INTO     :MDSEAR-BYR-NBR                              20120000
                     ,     :RSPBAR-WORKER-LAST-NAME                     20130000
                     ,     :RSPBAR-WORKER-FIR-NAME                      20140000
                  FROM      TMDSEAR A                                   20150000
                     ,      TRSPBAR B                                   20160000
                     ,      TAPLAVL C                                   20170000
                 WHERE     (A.BYR_NBR     = :PV-BYR-NBR)                20180000
                   AND     (A.DEPT_NBR    = :PV-DEPT-NBR)               20190000
                   AND     (B.RSPLVL_CDE  = :PC-RSPLVL-CDE-BYR)         20200000
222725             AND      A.MDSELV_CDE = 'DPT'                        20201010
                   AND     (A.OPERCO_NBR  = :PC-OPERCO-NBR)             20210000
                   AND     (C.APLSYS_CDE  = :PC-APLSYS-CDE)             20220000
                   AND     (A.MDSEAR_DKEY =  B.MDSEAR_DKEY)             20230000
                   AND     (A.MDSEAR_DKEY =  C.MDSEAR_DKEY)             20240000
                   AND     (:ML114-EXTRACT-DTE                          20250000
                            BETWEEN B.WORKER_STRT_DTE                   20260000
                            AND     B.WORKER_END_DTE )                  20270000
                   AND     (:ML114-EXTRACT-DTE                          20280000
                            BETWEEN C.MDSEAR_STRT_DTE                   20290000
                            AND     C.MDSEAR_END_DTE )                  20300000
C26603             WITH UR                                              20310000
           END-EXEC                                                     20320000
                                                                        20330000
           EVALUATE TRUE                                                20340000
               WHEN SQLCODE        = +000                               20350000
                   CONTINUE                                             20360000
               WHEN SQLCODE        = +100                               20370000
                   DISPLAY 'BYR NUMBER ' PV-BYR-NBR ' NOT FOUND.'       20380000
                   MOVE 'OPEN' TO  RSPBAR-WORKER-FIR-NAME               20390000
                   MOVE SPACE  TO  RSPBAR-WORKER-LAST-NAME              20400000
               WHEN OTHER                                               20410000
                   MOVE '8300-GET-BYR-NAME' TO PV-PARAGRAPH-NAME        20420000
                   MOVE 'SELECT ROW FROM TRSPBAR  '                     20430000
                                            TO PV-DB2-OPER-ATTEMPTED    20440000
                   PERFORM 9999-SQL-ABEND                               20450000
           END-EVALUATE.                                                20460000
                                                                        20470000
                                                                        20480000
       8400-GET-DEPT-LEVEL-DESC.                                        20490000
                                                                        20500000
               EXEC SQL                                                 20510000
                   SELECT     A.MDSEAR_DESC                             20520000
                     INTO    :MDSEAR-DESC                               20530000
                     FROM     TMDSEAR A                                 20540000
                        ,     TAPLAVL B                                 20550000
                    WHERE    (A.GMA_NBR     = :PV-GMA-NBR               20560000
                       OR     A.DMA_NBR     = :PV-DMA-NBR               20570000
                       OR     A.BYR_NBR     = :PV-BYR-NBR)              20580000
                      AND    (A.DEPT_NBR    = :PV-DEPT-NBR)             20590000
                      AND    (A.MDSELV_CDE  = :PV-MDSELV-CDE)           20600000
                      AND    (A.OPERCO_NBR  = :PC-OPERCO-NBR)           20610000
                      AND    (B.APLSYS_CDE  = :PC-APLSYS-CDE)           20620000
                      AND    (A.MDSEAR_DKEY =  B.MDSEAR_DKEY)           20630000
                      AND    (:ML114-EXTRACT-DTE                        20640000
                              BETWEEN B.MDSEAR_STRT_DTE  AND            20650000
                                      B.MDSEAR_END_DTE)                 20660000
                      AND    (:ML114-EXTRACT-DTE                        20670000
                               BETWEEN A.STRT_DTE  AND                  20680000
                                       A.END_DTE)                       20690000
C26603             WITH UR                                              20700000
               END-EXEC                                                 20710000
                                                                        20720000
           EVALUATE TRUE                                                20730000
               WHEN SQLCODE        = +000                               20740000
                   CONTINUE                                             20750000
               WHEN SQLCODE        = +100                               20760000
                   DISPLAY 'DEPT NUMBER ' PV-DEPT-NBR ' NOT FOUND.'     20770000
                   MOVE 'NOT FOUND' TO MDSEAR-DESC                      20780000
               WHEN OTHER                                               20790000
                   MOVE '8400-GET-DEPT-LEVEL-DESC'                      20800000
                                            TO PV-PARAGRAPH-NAME        20810000
                   MOVE 'SELECT DEPARTMENT ROW ON TMDSEAR'              20820000
                                            TO PV-DB2-OPER-ATTEMPTED    20830000
                   PERFORM 9999-SQL-ABEND                               20840000
           END-EVALUATE.                                                20850000
                                                                        20860000
                                                                        20870000
       8500-GET-MAJ-CLASS-LEVEL-DESC.                                   20880000
                                                                        20890000
               EXEC SQL                                                 20900000
                   SELECT     A.MDSEAR_DESC                             20910000
                     INTO    :MDSEAR-DESC                               20920000
                     FROM     TMDSEAR A                                 20930000
                        ,     TAPLAVL B                                 20940000
                    WHERE    (A.GMA_NBR     = :PV-GMA-NBR               20950000
                       OR     A.DMA_NBR     = :PV-DMA-NBR               20960000
                       OR     A.BYR_NBR     = :PV-BYR-NBR)              20970000
                      AND    (A.DEPT_NBR    = :PV-DEPT-NBR)             20980000
                      AND    (A.MAJ_CL_NBR  = :PV-MAJ-CLASS-NBR)        20990000
                      AND    (A.MDSELV_CDE  = :PV-MDSELV-CDE)           21000000
                      AND    (A.OPERCO_NBR  = :PC-OPERCO-NBR)           21010000
                      AND    (B.APLSYS_CDE  = :PC-APLSYS-CDE)           21020000
                      AND    (A.MDSEAR_DKEY =  B.MDSEAR_DKEY)           21030000
                      AND    (:ML114-EXTRACT-DTE BETWEEN                21040000
                              B.MDSEAR_STRT_DTE  AND                    21050000
                              B.MDSEAR_END_DTE)                         21060000
                      AND    (:ML114-EXTRACT-DTE BETWEEN                21070000
                              A.STRT_DTE          AND                   21080000
                              A.END_DTE )                               21090000
C26603             WITH UR                                              21100000
               END-EXEC                                                 21110000
                                                                        21120000
           EVALUATE TRUE                                                21130000
               WHEN SQLCODE        = +000                               21140000
                   CONTINUE                                             21150000
               WHEN SQLCODE        = +100                               21160000
                   DISPLAY 'MAJOR CLASS NUMBER ' PV-MAJ-CLASS-NBR       21170000
                     ' NOT FOUND.'                                      21180000
                   MOVE 'NOT FOUND' TO MDSEAR-DESC                      21190000
               WHEN OTHER                                               21200000
                   MOVE '8500-GET-MAJ-CLASS-LEVEL-DESC'                 21210000
                                            TO PV-PARAGRAPH-NAME        21220000
                   MOVE 'SELECT MAJOR CLASS ROW ON TMDSEAR'             21230000
                                            TO PV-DB2-OPER-ATTEMPTED    21240000
                   PERFORM 9999-SQL-ABEND                               21250000
           END-EVALUATE.                                                21260000
                                                                        21270000
       8600-GET-SUB-CLASS-LEVEL-DESC.                                   21280000
                                                                        21290000
               EXEC SQL                                                 21300000
                   SELECT     A.MDSEAR_DESC                             21310000
                     INTO    :MDSEAR-DESC                               21320000
                     FROM     TMDSEAR A                                 21330000
                        ,     TAPLAVL B                                 21340000
                    WHERE    (A.GMA_NBR     = :PV-GMA-NBR               21350000
                       OR     A.DMA_NBR     = :PV-DMA-NBR               21360000
                       OR     A.BYR_NBR     = :PV-BYR-NBR)              21370000
                      AND    (A.DEPT_NBR    = :PV-DEPT-NBR)             21380000
                      AND    (A.MAJ_CL_NBR  = :PV-MAJ-CLASS-NBR)        21390000
                      AND    (A.SUB_CL_NBR  = :PV-SUB-CLASS-NBR)        21400000
                      AND    (A.MDSELV_CDE  = :PV-MDSELV-CDE)           21410000
                      AND    (A.OPERCO_NBR  = :PC-OPERCO-NBR)           21420000
                      AND    (B.APLSYS_CDE  = :PC-APLSYS-CDE)           21430000
                      AND    (A.MDSEAR_DKEY =  B.MDSEAR_DKEY)           21440000
                      AND    (:ML114-EXTRACT-DTE BETWEEN                21450000
                              B.MDSEAR_STRT_DTE  AND                    21460000
                              B.MDSEAR_END_DTE)                         21470000
                      AND    (:ML114-EXTRACT-DTE BETWEEN                21480000
                              A.STRT_DTE          AND                   21490000
                              A.END_DTE )                               21500000
C26603             WITH UR                                              21510000
               END-EXEC                                                 21520000
                                                                        21530000
           EVALUATE TRUE                                                21540000
               WHEN SQLCODE        = +000                               21550000
                   CONTINUE                                             21560000
               WHEN SQLCODE        = +100                               21570000
                   DISPLAY 'SUB-CLASS NUMBER ' PV-SUB-CLASS-NBR         21580000
                     ' NOT FOUND.'                                      21590000
                   MOVE 'NOT FOUND' TO MDSEAR-DESC                      21600000
               WHEN OTHER                                               21610000
                   MOVE '8600-GET-SUB-CLASS-LEVEL-DESC'                 21620000
                                            TO PV-PARAGRAPH-NAME        21630000
                   MOVE 'SELECT SUB-CLASS ROW ON TMDSEAR'               21640000
                                            TO PV-DB2-OPER-ATTEMPTED    21650000
                   PERFORM 9999-SQL-ABEND                               21660000
           END-EVALUATE.                                                21670000
                                                                        21680000
       8700-OPEN-FSCL-MN-NM-CSR.                                        21690000
                                                                        21700000
           EXEC SQL                                                     21710000
                OPEN FSCL-MN-NM-CSR                                     21720000
           END-EXEC                                                     21730000
                                                                        21740000
           EVALUATE TRUE                                                21750000
               WHEN SQLCODE = ZERO                                      21760000
                   CONTINUE                                             21770000
               WHEN OTHER                                               21780000
                   MOVE '8700-OPEN-FSCL-MN-NM-CSR'                      21790000
                                            TO PV-PARAGRAPH-NAME        21800000
                   MOVE 'OPEN FSCL-MN-NM-CSR'                           21810000
                                            TO PV-DB2-OPER-ATTEMPTED    21820000
                   PERFORM 9999-SQL-ABEND                               21830000
           END-EVALUATE.                                                21840000
                                                                        21850000
                                                                        21860000
       8800-FETCH-FSCL-MN-NM-CSR.                                       21870000
                                                                        21880000
           EXEC SQL                                                     21890000
               FETCH                                                    21900000
                   FSCL-MN-NM-CSR                                       21910000
               INTO                                                     21920000
                   :DTATTR-FSCL-MN-NBR                                  21930000
                  ,:DTATTR-FSCL-MN-NM                                   21940000
           END-EXEC.                                                    21950000
                                                                        21960000
           EVALUATE TRUE                                                21970000
               WHEN SQLCODE = ZERO                                      21980000
                   CONTINUE                                             21990000
               WHEN SQLCODE = +100                                      22000000
                   SET PS-END-OF-FSCL-MN-NM-CSR TO TRUE                 22010000
               WHEN OTHER                                               22020000
                   MOVE '8800-FETCH-FSCL-MN-NM-CSR'                     22030000
                                                TO PV-PARAGRAPH-NAME    22040000
                   MOVE 'FETCH FSCL-MN-NM-CSR' TO  PV-DB2-OPER-ATTEMPTED22050000
                   PERFORM 9999-SQL-ABEND                               22060000
           END-EVALUATE.                                                22070000
                                                                        22080000
                                                                        22090000
       8900-CLOSE-FSCL-MN-NM-CSR.                                       22100000
                                                                        22110000
           EXEC SQL                                                     22120000
               CLOSE FSCL-MN-NM-CSR                                     22130000
           END-EXEC.                                                    22140000
                                                                        22150000
           EVALUATE TRUE                                                22160000
               WHEN SQLCODE = ZERO                                      22170000
                   CONTINUE                                             22180000
               WHEN OTHER                                               22190000
                   MOVE '8900-CLOSE-FSCL-MN-NM-CSR'                     22200000
                                                TO PV-PARAGRAPH-NAME    22210000
                   MOVE 'CLOSE FSCL-MN-NM-CSR' TO  PV-DB2-OPER-ATTEMPTED22220000
                   PERFORM 9999-SQL-ABEND                               22230000
           END-EVALUATE.                                                22240000
                                                                        22250000
                                                                        22260000
      * DPPD024 COMBINES SEPARATE FIRST AND LAST NAME FIELDS INTO ONE  *22270000
      * FIRST/LAST NAME FIELD.                                         *22280000
                                                                        22290000
           COPY DPPD024.                                                22300000
                                                                        22310000
       9999-SQL-ABEND.                                                  22320000
                                                                        22330000
           MOVE +4013 TO PV-ABEND-CODE.                                 22340000
           DISPLAY '** ABEND **         ** = SQLERROR'.                 22350000
           DISPLAY '** PROGRAM          ** = MLKRP212'.                 22360000
           DISPLAY '** PARAGRAPH        ** = ' PV-PARAGRAPH-NAME.       22370000
           DISPLAY '** OPERATION        ** = ' PV-DB2-OPER-ATTEMPTED.   22380000
                                                                        22390000
      *    THE FOLLOWING COPYBOOK UTILIZES THE DB2 ABEND MODULE         22400000
      *    DSNTIAR TO CONVERT SQLCA INTO UNDERSTANDABLE VERBAGE.        22410000
           COPY DPPD004.                                                22420000
                                                                        22430000
           CALL 'ILBOABN0' USING PV-ABEND-CODE.                         22440000
                                                                        22450000
       9999-ABEND.                                                      22460000
                                                                        22470000
           CALL 'ILBOABN0'  USING PV-ABEND-CODE.                        22480000
