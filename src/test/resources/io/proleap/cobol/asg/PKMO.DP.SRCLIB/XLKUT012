000100*****************************************************************         
000200 IDENTIFICATION DIVISION.                                                 
000300*****************************************************************         
000400 PROGRAM-ID.    XLKUT012.                                                 
000500 AUTHOR.        STEPHANIE HERON.                                          
000600 INSTALLATION.  KOHLS.                                                    
000700 DATE-WRITTEN   SEPTEMBER 2002.                                           
000800 DATE-COMPILED.                                                           
000900*****************************************************************         
001000*  THIS PROGRAM WILL REFORMAT THE LOGISTICS SKU DOMAIN TABLE    *         
001100*  DATA INTO LOGISTICS DOMAIN SKU LAYOUT (XLRD008)              *         
001400*****************************************************************         
      *****************************************************************         
      * CHANGE DESCRIPTION                                                      
      *****************************************************************         
      * DATE  05/21/2010                                                        
      *  CHANGE MADE: CHANGED TO INCLUDE THE NEW WAREHOUSE INDICATOR            
      *  FIELD IN THE REFORMATTING.                                             
      *  MADE BY: TOYAM SAIKH     TKID:TKMAX89                                  
      *  CHANGES ARE TAGGED AS TS 05/21/2010                                    
      *****************************************************************         
001500 ENVIRONMENT DIVISION.                                                    
001600 INPUT-OUTPUT SECTION.                                                    
001700                                                                          
001800 FILE-CONTROL.                                                            
001900                                                                          
002000     SELECT LOGUNLD-SKU-FILE                                              
002010         ASSIGN TO INP01.                                                 
002100                                                                          
002110     SELECT LOGISTIC-SKU-FILE                                             
002120         ASSIGN TO OUT01.                                                 
002130                                                                          
002200*****************************************************************         
002300 DATA DIVISION.                                                           
002400*****************************************************************         
002500 FILE SECTION.                                                            
002600                                                                          
002700 FD  LOGUNLD-SKU-FILE                                                     
002800     RECORDING MODE IS F                                                  
002810     BLOCK CONTAINS 0 RECORDS                                             
002900     LABEL RECORDS ARE STANDARD.                                          
003000                                                                          
      *TS 05/21/2010 BEG                                                        
      *01  LOGUNLD-SKU-RECORD           PIC X(104).                             
       01  LOGUNLD-SKU-RECORD           PIC X(105).                             
      *TS 05/21/2010 END                                                        
003700                                                                          
003710 FD  LOGISTIC-SKU-FILE                                                    
003720     RECORDING MODE IS F                                                  
003730     BLOCK CONTAINS 0 RECORDS                                             
003740     LABEL RECORDS ARE STANDARD.                                          
003750                                                                          
003760 01  LOGISTIC-SKU-RECORD          PIC X(150).                             
003770                                                                          
003800                                                                          
003900*****************************************************************         
004000 WORKING-STORAGE SECTION.                                                 
004100                                                                          
004200 01  PS-PROGRAM-SWITCHES.                                                 
004300     05  PS-EOF-INPUT-SW              PIC X(01)  VALUE 'N'.               
004400         88  PS-EOF-INPUT-YES                    VALUE 'Y'.               
004500         88  PS-EOF-INPUT-NO                     VALUE 'N'.               
004600                                                                          
004700 01  PC-PROGRAM-CONSTANTS.                                                
004800     05  PC-PROGRAM-NAME              PIC  X(08) VALUE 'XLKUT012'.        
005000                                                                          
005100 01  PV-PROGRAM-VARIABLES.                                                
005900     05  PV-RECORDS-READ              PIC  9(09) VALUE  0.                
006000     05  PV-RECORDS-WRITTEN           PIC  9(09) VALUE  0.                
006700     05  PV-SQLCODE                   PIC  S9(9) VALUE +0.                
006800     05  PV-DISP-SQLCODE              PIC ZZZZZZ9-.                       
006900                                                                          
007000                                                                          
007100 01  PV-ABEND-FIELDS.                                                     
007200     05  PV-ABEND-CODE                PIC  S9(4) VALUE +0                 
007300                                                 COMP SYNC.               
007400     05  PV-ABEND-PROGRAM             PIC  X(08) VALUE 'XLKUT012'.        
007500     05  PV-ABEND-PARAGRAPH           PIC  X(50) VALUE SPACES.            
007600     05  PV-ABEND-OPERATION           PIC  X(50) VALUE SPACES.            
007700     05  PV-ABEND-TABLE               PIC  X(12) VALUE SPACES.            
007900     05  PV-DB2-OPERATION-MESSAGE-1   PIC  X(79) VALUE SPACES.            
008000     05  PV-DB2-OPERATION-MESSAGE-2   PIC  X(79) VALUE SPACES.            
008100     05  PV-DB2-OPERATION-MESSAGE-3   PIC  X(79) VALUE SPACES.            
008200                                                                          
       01  PV-INPUT-RECORD.                                                     
           05 PV-INTR-UPC-ID                PIC  S9(9) COMP.                    
           05 PV-STYL-ID                    PIC  S9(8)V COMP-3.                 
           05 PV-ITM-NBR                    PIC  S9(15)V COMP-3.                
           05 PV-SKU-NBR                    PIC  S9(8)V COMP-3.                 
           05 PV-SKU-STAT-CDE               PIC   X(2).                         
           05 PV-SKU-STAT-DESC              PIC   X(10).                        
           05 PV-INNR-PK-QTY                PIC  S9(4) COMP.                    
           05 PV-OUTR-PK-QTY                PIC  S9(4) COMP.                    
           05 PV-SKU-DESC                   PIC   X(30).                        
           05 PV-KOHLS-SIZE-CDE             PIC  S9(9) COMP.                    
           05 PV-SIZE-DESC                  PIC   X(10).                        
           05 PV-NRF-CLOR-CDE               PIC   X(3).                         
           05 PV-SHRT-CLOR-DESC             PIC   X(4).                         
           05 PV-CSTM-CLOR-DESC             PIC   X(10).                        
           05 PV-REGN-PRIC-IND              PIC   X(1).                         
           05 PV-KY-ITM-IND                 PIC   X(1).                         
           05 PV-GP-CDE                     PIC   X(3).                         
      *TS 05/21/2010 BEG                                                        
           05 PV-WHSE-RPLNT-IND             PIC   X(1).                         
      *TS 05/21/2010 END                                                        
008300                                                                          
008900***********************************************************               
009000*  COPYBOOK USED FOR THE LOGISTIC SKU OUTPUT FILE         *               
009100***********************************************************               
       01  PC-LOGISTIC-SKU-OUTPUT.                                              
009200     COPY XLRD008.                                                        
009300                                                                          
010800*****************************************************************         
010900 PROCEDURE DIVISION.                                                      
011000*****************************************************************         
011100     DISPLAY '**** BEGINNING XLKUT012 ****'.                              
011200     DISPLAY ' '.                                                         
011300                                                                          
011400     OPEN INPUT  LOGUNLD-SKU-FILE                                         
011410          OUTPUT LOGISTIC-SKU-FILE.                                       
011500                                                                          
011600     PERFORM 1000-READ-INPUT-FILE.                                        
011700                                                                          
012100     PERFORM 2000-PROCESS-INPUT-FILE                                      
012200       UNTIL PS-EOF-INPUT-YES.                                            
012300                                                                          
012310     CLOSE LOGUNLD-SKU-FILE                                               
012320           LOGISTIC-SKU-FILE.                                             
012500                                                                          
012600     DISPLAY '  INPUT DOMAIN SKU REC = ' PV-RECORDS-READ.                 
012700     DISPLAY ' OUTPUT DOMAIN SKU REC = ' PV-RECORDS-WRITTEN.              
012800     DISPLAY ' '.                                                         
012900     DISPLAY '****  END OF  XLKUT012  ****'.                              
013000                                                                          
013100     GOBACK.                                                              
013200                                                                          
013300                                                                          
013400*****************************************************************         
013500*  READ A VSM SKU RECORD                                                  
013600*****************************************************************         
013700 1000-READ-INPUT-FILE.                                                    
013800                                                                          
013900     MOVE '1000-READ-INPUT-FILE    ' TO PV-ABEND-PARAGRAPH.               
014000                                                                          
014010     INITIALIZE PV-INPUT-RECORD.                                          
014020                                                                          
014100     READ LOGUNLD-SKU-FILE                                                
014200          INTO PV-INPUT-RECORD                                            
014300            AT END                                                        
014400               SET PS-EOF-INPUT-YES TO TRUE                               
014900     END-READ.                                                            
015000                                                                          
015010     IF PS-EOF-INPUT-YES                                                  
015020        CONTINUE                                                          
015030     ELSE                                                                 
015040        ADD +1 TO PV-RECORDS-READ                                         
015050     END-IF.                                                              
015100                                                                          
015200*****************************************************************         
015300*  REFORMAT THE VSM SKU EXTRACT FILE                            *         
015400*****************************************************************         
015500 2000-PROCESS-INPUT-FILE.                                                 
015600                                                                          
015700     MOVE '2000-PROCESS-INPUT-FILE ' TO PV-ABEND-PARAGRAPH.               
015800                                                                          
015900     MOVE PV-INTR-UPC-ID             TO XL008-INTR-UPC-ID.                
015900     MOVE PV-STYL-ID                 TO XL008-STYL-ID.                    
015900     MOVE PV-ITM-NBR                 TO XL008-ITM-NBR.                    
015900     MOVE PV-SKU-NBR                 TO XL008-SKU-NBR.                    
015900     MOVE PV-SKU-STAT-CDE            TO XL008-SKU-STAT-CDE.               
015900     MOVE PV-SKU-STAT-DESC           TO XL008-SKU-STAT-DESC.              
015900     MOVE PV-INNR-PK-QTY             TO XL008-INNR-PK-QTY.                
015900     MOVE PV-OUTR-PK-QTY             TO XL008-OUTR-PK-QTY.                
015900     MOVE PV-SKU-DESC                TO XL008-SKU-DESC.                   
015900     MOVE PV-KOHLS-SIZE-CDE          TO XL008-KOHLS-SIZE-CDE.             
015900     MOVE PV-SIZE-DESC               TO XL008-SIZE-DESC.                  
015900     MOVE PV-NRF-CLOR-CDE            TO XL008-NRF-CLOR-CDE.               
015900     MOVE PV-SHRT-CLOR-DESC          TO XL008-SHRT-CLOR-DESC.             
015900     MOVE PV-CSTM-CLOR-DESC          TO XL008-CSTM-CLOR-DESC.             
015900     MOVE PV-REGN-PRIC-IND           TO XL008-REGN-PRIC-IND.              
015900     MOVE PV-KY-ITM-IND              TO XL008-KY-ITM-IND.                 
015900     MOVE PV-GP-CDE                  TO XL008-GP-CDE.                     
      *TS 05/21/2010 BEG                                                        
           MOVE PV-WHSE-RPLNT-IND          TO XL008-WHSE-RPLNT-IND.             
      *TS 05/21/2010 END                                                        
016370                                                                          
016400     PERFORM 2100-WRITE-OUTPUT.                                           
017700                                                                          
017800     PERFORM 1000-READ-INPUT-FILE.                                        
018500                                                                          
018600                                                                          
021600*****************************************************************         
021700*  WRITE A RECORDS TO THE LOGISTICS SKU OUTPUT FILE             *         
021800*****************************************************************         
021900 2100-WRITE-OUTPUT.                                                       
022000                                                                          
022001     MOVE 'B'    TO XL008-FILE-INDICATOR.                                 
022010     WRITE LOGISTIC-SKU-RECORD FROM                                       
022020         XL008-SKU-RECORD                                                 
022030     END-WRITE.                                                           
024400     ADD +1                 TO PV-RECORDS-WRITTEN.                        
027200                                                                          
