000100*-----------------------*                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*-----------------------*                                         00030000
000400 PROGRAM-ID.    PCKCS710.                                         00040000
000500 AUTHOR.        GERMAN BANDA.                                     00050000
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060000
000700 DATE-WRITTEN.  MARCH 2001.                                       00070000
000800 DATE-COMPILED.                                                   00080000
000900                                                                  00090000
001000*---------------------------------------------------------------* 00100000
001100*    E710 - PBS SMOOTHING STORE LIST.                           * 00110000
001200*                                                               * 00120000
001300*    THIS PROGRAM GENERATES A STORE LIST FOR THE                * 00130000
001400*    PACK-BY STORE SMOOTHING APPLICATION. THIS APPLICATION WILL * 00140000
001500*    BUILD CARTON MANIFESTS FOR PBS ORDERS                      * 00150000
001600*    CHANGE BY CHERI PARMLEY       PR#5148B                     * 00160001
001610*    CHANGE TO GET RFID TO PRINT ON LABELS FOR NON AUTO         * 00161012
001620*    CONVEYOR DC'S.                                             * 00162001
001640*                                                               * 00164001
001700*---------------------------------------------------------------* 00170000
001710*  CHANGED 10/16/2014    BY COGNIZANT       WR: CHG0094517        00171003
001720*                                                                 00172003
001730* EXTENDED PO# FROM 7 TO 8 DIGITS WHERE NEEDED.                   00173003
001740*-----------------------------------------------------------------00174003
001741*  CHANGED 05/29/2019    BY JIM ARENDT      WR: CHG0224787        00174111
001742*                                                                 00174211
001743*  FOR THE DELOITTE REFACTOR PROJECT, RESTAGE BECAUSE OF          00174311
001744*  SUWS095 COPYBOOK CHANGE.                                       00174411
001746*-----------------------------------------------------------------00174611
001747* DATE  11/04/2021                                                00174714
001748*            - CHANGE CALL OF 'DPKUT100' TO                     * 00174814
001749*              CALL DP010I-NUMERIC-EDIT-ROUTINE                 * 00174914
001750*              MAKING THE CALL DYNAMIC VS STATIC                * 00175014
001760*     MADE BY: GERMAN BANDA            WR/IR #: CHG0264232        00176015
001770*-----------------------------------------------------------------00177014
1122RM* DATE  11/07/2022                                              * 00178016
1122RM*            - ADD COPYBOOK DPWS930                             * 00179016
1122RM*              CHANGE CALL TO DPWS030 FROM STATIC TO            * 00179116
1122RM*              DYNAMIC.                                         * 00179216
1122RM*     MADE BY: BOB MCASEY              WR/IR #: CHG0277910      * 00179316
1122RM*-----------------------------------------------------------------00179416
001800 ENVIRONMENT DIVISION.                                            00180000
001900 DATA DIVISION.                                                   00190000
002000                                                                  00200000
002100 WORKING-STORAGE SECTION.                                         00210000
002200                                                                  00220000
002300 01  DK-DB2-KEYS.                                                 00230000
002400     05  DK-LINE-NBR                    PIC S9(09)  VALUE ZERO    00240000
002500                                                    COMP.         00250000
002600     05  DK-OPER-UNT-ID                 PIC S9(04)  VALUE ZERO    00260000
002700                                                    COMP.         00270000
002800     05  DK-LABOR-OPER                  PIC S9(04)  VALUE ZERO    00280000
002900                                                    COMP.         00290000
003000     05  DK-PREPK-ID                    PIC S9(04)  VALUE ZERO    00300000
003100                                                    COMP.         00310000
003200     05  DK-FCLTY-ID                    PIC S9(04)  VALUE ZERO    00320000
003300                                                    COMP.         00330000
003400     05  DK-OPER-UNT-ID-2               PIC S9(04)  VALUE ZERO    00340000
003500                                                    COMP.         00350000
003600     05  DK-ACTV-IND-CSR                PIC  X(01)  VALUE SPACE.  00360000
003700     05  DK-ACTV-IND                    PIC  X(01)  VALUE SPACE.  00370000
003800     05  DK-ACTV-IND-SMTH               PIC  X(01)  VALUE SPACE.  00380000
003900     05  DK-ACTV-IND-OTBND              PIC  X(01)  VALUE SPACE.  00390000
004000     05  DK-VEHICLE-NBR                 PIC  X(10)  VALUE SPACE.  00400000
004100     05  DK-SHIPT-ID                    PIC S9(09)  VALUE +0      00410000
004200                                                    COMP.         00420000
004300     05  DK-STATUS-CDE                  PIC  X(02)  VALUE SPACES. 00430000
004400     05  DK-STATUS-DTE                  PIC  X(10)  VALUE SPACES. 00440000
004500     05  DK-STATUS-TME                  PIC  X(08)  VALUE SPACES. 00450000
004600     05  DK-PO-NBR                      PIC S9(09)  COMP.         00460000
004700     05  DK-REC-SEQ-NBR                 PIC S9(09)  COMP.         00470000
004800     05  DK-RECEIVER                    PIC S9(04)  COMP.         00480000
004900     05  DK-STR-NBR                     PIC S9(4)   COMP.         00490000
005000     05  DK-STORE                       PIC S9(04)  VALUE ZERO    00500000
005100                                                    COMP.         00510000
005200     05  DK-RANDOM-NBR                  PIC S9(09)  COMP.         00520000
005300                                                                  00530000
005400                                                                  00540000
005500 01  PC-PROGRAM-CONSTANTS.                                        00550000
005600     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE 'PCK710  '.  00560000
005700     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE 'PCKM710 '.  00570000
005800     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE 'PCKCS710'.  00580000
006000     05  PC-AUTOVE-MODULE          PIC  X(08)  VALUE  'RCKUT127'. 00600000
006100     05  PC-AUTOVE-MODULE-LENGTH   PIC S9(04)  VALUE  +400        00610000
006200                                                    COMP SYNC.    00620000
006300     05  PC-FEM-MODULE             PIC  X(08)  VALUE  'RCKUT126'. 00630000
006400     05  PC-FEM-MODULE-LENGTH      PIC S9(04)  VALUE  +400        00640000
006500                                                    COMP SYNC.    00650000
006600     05  PC-TROUBLE-WTR            PIC  X(08) VALUE 'TMKCS521'.   00660000
006700     05  PC-TROUBLE-LENGTH         PIC S9(04) COMP VALUE +600.    00670000
006800     05  PC-FA-AUTOVE-TRBLE-381    PIC S9(04) COMP VALUE 381.     00680000
006900     05  PC-DEFAULT-DATE           PIC  X(26)  VALUE              00690000
007000                                     '9999-01-01-01.01.01.000000'.00700000
007100     05  PC-CALENDAR-ROUTINE       PIC  X(08)  VALUE  'DPKUT500'. 00710000
007200     05  PC-PRINT-PROGRAM          PIC  X(08)  VALUE  'PCKCS728'. 00720000
007300     05  PC-PRTR-VALIDATION-PGM    PIC  X(08)  VALUE  'DPKCS060'. 00730000
007400     05  PC-REPORT-PGM-1           PIC  X(08)  VALUE  'PCKCS126'. 00740000
007500     05  PC-RANDOM-PGM             PIC  X(08)  VALUE  'DPKUT902'. 00750000
007600     05  PC-LOCATION-MODULE        PIC  X(08)  VALUE  'XLKUT071'. 00760000
007700     05  PC-LIST-QUEUE-SEQ              PIC  9(01)  VALUE 1.      00770000
007800     05  PC-SEL-QUEUE-SEQ               PIC  9(01)  VALUE 2.      00780000
007900     05  PC-CRIT-SPEC-FORMAT            PIC  X(01)  VALUE '1'.    00790000
008000     05  PC-LIST-FORMAT                 PIC  X(01)  VALUE '2'.    00800000
008100     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +11     00810000
008200                                                    COMP SYNC.    00820000
008300     05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      00830000
008400                                                    COMP SYNC.    00840000
008500     05  PC-MAX-ITEMS                   PIC S9(09)  VALUE         00850000
008600                                                    +1000000      00860000
008700                                                    COMP-3.       00870000
008800     05  PC-MSG-NUMBER-LENGTH           PIC S9(04)  VALUE +5      00880000
008900                                                    COMP SYNC.    00890000
009000     05  PC-MAX-RETRIES                 PIC S9(03)  VALUE 3       00900000
009100                                                    COMP-3.       00910000
009200     05  PC-I                           PIC  X(01)  VALUE  'I'.   00920000
009300     05  PC-A                           PIC  X(01)  VALUE  'A'.   00930000
009400     05  PC-Z                           PIC  X(01)  VALUE  'Z'.   00940000
009500     05  PC-U                           PIC  X(01)  VALUE  'U'.   00950000
009600     05  PC-01                          PIC  X(02)  VALUE  '01'.  00960000
009700     05  PC-MGMX                        PIC  X(04)  VALUE 'MGMX'. 00970000
009800*                                                                 00980000
009900     05  PC-INQ                    PIC  X(03)  VALUE 'INQ'.       00990000
010000     05  PC-UPD                    PIC  X(03)  VALUE 'UPD'.       01000000
010100     05  PC-DEL                    PIC  X(03)  VALUE 'DEL'.       01010000
010200     05  PC-ERR                    PIC  X(03)  VALUE 'ERR'.       01020000
010300     05  PC-UNKNWN-VND-NME         PIC  X(20)  VALUE              01030000
010400                               'UNKNOWN VENDOR NAME '.            01040000
010500     05  PC-UCC128-EXISTS          PIC  X(25)  VALUE              01050000
010600                               'UCC-128 DATA EXISTS      '.       01060000
010700*LMM ADD                                                          01070000
010800*MESSAGE DEFINITIONS                                              01080000
010900*----------------------------------------------------------------*01090000
011000*  SYSTEM MESSAGES                                               *01100000
011100*----------------------------------------------------------------*01110000
011200*   00005 - INVALID VALUE                                        *01120000
011300*   00008 - MUST BE NUMERIC                                      *01130000
011400*   00045 - INVALID FUNCTION KEY                                 *01140000
011500*   00050 - NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED  *01150000
011600*   00051 - NO END OF RANGE HAS BEEN SPECIFIED                   *01160000
011700*   00052 - END OF RANGE PRECEDES START OF RANGE                 *01170000
011800*   00053 - NO START OF RANGE HAS BEEN SPECIFIED                 *01180000
011900*   00054 - ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED   *01190000
012000*   00055 - ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED     *01200000
012100*   00057 - A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION       *01210000
012200*   00069 - TOP OF LIST                                          *01220000
012300*   00070 - BOTTOM OF LIST                                       *01230000
012400*   00101 - VALUE MUST BE > ZERO AND  < 1,000,000                *01240000
012500*   00279 - MORE ITEMS TO DISPLAY                                *01250000
012600*   00551 - WAIT 15 SECONDS;RETRY FUNCTION AGAIN; IF UNSUCCESSFUL*01260000
012700*   00746 - INVALID PRINTER DESTINATION                          *01270000
012800*   00954 - PO/RECEIVER SEQUENCE NOT FOUND                       *01280000
012900*   00984 - DATABASE IS BUSY, TRY AGAIN IN A FEW MINUTES         *01290000
013000*   02234 - PRINT REQUEST HAS BEEN COMPLETED FOR SELECTED LINE(S)*01300000
013100*   02238 - PRINT PROBLEM, TRY AGAIN - LINES UP TO THIS POINT HAV*01310000
013200*   02479 - RECEIVER SEQUENCE NUMBER MUST BE GREATER THAN ZERO   *01320000
013300*   02678 - ACTIVE SMOOTHING EXISTS FOR STORE - UNABLE TO RE-ACTI*01330000
013400*   02679 - UNABLE TO RE-ACTIVATE, NO INACTIVE SMOOTHING EXISTS F*01340000
013500*   02680 - NUMBER OF CRTNS MUST EQUAL NBR OF CRTNS FROM ORIGINAL*01350000
013600*   02681 - RE-ACTIVATION SUCCESSFUL                             *01360000
013700*   02683 - VEND UCC128 DATA EXISTS - F2 TO CONFIRM SMOOTHING    *01370000
013800*   02684 - SMOOTHING HAS NOT OCCURRED, UNABLE TO PERFORM FUNCTIO*01380000
013900*   02688 - UNABLE TO PERFORM FUNCTION, CARTON INACTIVE          *01390000
014000*   02691 - ONE OR MORE STORE(S) SELECTED HAS NOT BEEN SMOOTHED  *01400000
014100*   02692 - INVALID STATUS FOR FUNCTION REQUESTED                *01410000
014200*   02693 - COMMUNICATION ERROR WHEN CREATING LABELS - CONTACT SU*01420000
014300*   02694 - DATABASE ERROR WHEN CREATING LABELS - CONTACT SUPERVI*01430000
014400*   02720 - YOU DO NOT HAVE AUTHORITY TO INACTIVATE SMOOTHING    *01440000
014500*   02721 - INACTIVATE PENDING - PRESS PF2 TO CONFIRM            *01450000
014600*   03161 - DO NOT HAVE THE AUTHORITY TO PERFORM SMOOTHING       *01460000
014700*   03362 = UNABLE TO SMOOTH AP TYPE RECEIVERS                    01470000
014800*   03399 - CAN'T SMOOTH UNTIL REC ATTACHED TO TRAILER - CONTACT *01480000
014900*   03401 - CAN'T SMOOTH UNTIL TRAILER HAS BEEN ARRIVED           01490000
015000*   03413 - UNABLE TO SMOOTH MORE THAN 1 CARTON DURING INVENTORY *01500000
015010*   03625 - already smoothed - use f15 for additional cartons    *01501000
015020                                                                  01502000
015030     05  PC-TSYMSG-NUMBERS.                                       01503000
015040         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  01504000
015050         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  01505000
015060         10  PC-TSYMSG-00045            PIC  9(05)  VALUE 00045.  01506000
015070         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  01507000
015080         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  01508000
015090         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  01509000
015100         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  01510000
015200         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  01520000
015300         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  01530000
015400         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  01540000
015500         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  01550000
015600         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  01560000
015700         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  01570000
015800         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  01580000
015900         10  PC-TSYMSG-00551            PIC  9(05)  VALUE 00551.  01590000
016000         10  PC-TSYMSG-00746            PIC  9(05)  VALUE 00746.  01600000
016100         10  PC-TSYMSG-00954            PIC  9(05)  VALUE 00954.  01610000
016200         10  PC-TSYMSG-00984            PIC  9(05)  VALUE 00984.  01620000
016300         10  PC-TSYMSG-01756            PIC  9(05)  VALUE 01756.  01630000
016400         10  PC-TSYMSG-02234            PIC  9(05)  VALUE 02234.  01640000
016500         10  PC-TSYMSG-02238            PIC  9(05)  VALUE 02238.  01650000
016600         10  PC-TSYMSG-02479            PIC  9(05)  VALUE 02479.  01660000
016700         10  PC-TSYMSG-02678            PIC  9(05)  VALUE 02678.  01670000
016800         10  PC-TSYMSG-02679            PIC  9(05)  VALUE 02679.  01680000
016900         10  PC-TSYMSG-02680            PIC  9(05)  VALUE 02680.  01690000
017000         10  PC-TSYMSG-02681            PIC  9(05)  VALUE 02681.  01700000
017100         10  PC-TSYMSG-02683            PIC  9(05)  VALUE 02683.  01710000
017200         10  PC-TSYMSG-02684            PIC  9(05)  VALUE 02684.  01720000
017300         10  PC-TSYMSG-02688            PIC  9(05)  VALUE 02688.  01730000
017400         10  PC-TSYMSG-02691            PIC  9(05)  VALUE 02691.  01740000
017500         10  PC-TSYMSG-02692            PIC  9(05)  VALUE 02692.  01750000
017600         10  PC-TSYMSG-02693            PIC  9(05)  VALUE 02693.  01760000
017700         10  PC-TSYMSG-02694            PIC  9(05)  VALUE 02694.  01770000
017800         10  PC-TSYMSG-02720            PIC  9(05)  VALUE 02720.  01780000
017900         10  PC-TSYMSG-02721            PIC  9(05)  VALUE 02721.  01790000
018000         10  PC-TSYMSG-02749            PIC  9(05)  VALUE 02749.  01800000
018100         10  PC-TSYMSG-02763            PIC  9(05)  VALUE 02763.  01810000
018200         10  PC-TSYMSG-02764            PIC  9(05)  VALUE 02764.  01820000
018300         10  PC-TSYMSG-02765            PIC  9(05)  VALUE 02765.  01830000
018400         10  PC-TSYMSG-02780            PIC  9(05)  VALUE 02780.  01840000
018500         10  PC-TSYMSG-03138            PIC  9(05)  VALUE 03138.  01850000
018600         10  PC-TSYMSG-03161            PIC  9(05)  VALUE 03161.  01860000
018700         10  PC-TSYMSG-03163            PIC  9(05)  VALUE 03163.  01870000
018800         10  PC-TSYMSG-03297            PIC  9(05)  VALUE 03297.  01880000
018900         10  PC-TSYMSG-03362            PIC  9(05)  VALUE 03362.  01890000
019000         10  PC-TSYMSG-03391            PIC  9(05)  VALUE 03391.  01900000
019100         10  PC-TSYMSG-03399            PIC  9(05)  VALUE 03399.  01910000
019200         10  PC-TSYMSG-03401            PIC  9(05)  VALUE 03401.  01920000
019300         10  PC-TSYMSG-03413            PIC  9(05)  VALUE 03413.  01930000
019400         10  PC-TSYMSG-03625            PIC  9(05)  VALUE 03625.  01940000
019500*                                                                 01950000
019600 01  PS-PROGRAM-SWITCHES.                                         01960000
019700     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    01970000
019800         88  PS-NO-ERROR                            VALUE 'Y'.    01980000
019900         88  PS-ERROR                               VALUE 'N'.    01990000
020000     05  PS-SOFT-ABORT-ERROR-SW         PIC  X(01)  VALUE  'N'.   02000000
020100         88  PS-SOFT-ABORT-ERROR                    VALUE  'Y'.   02010000
020200         88  PS-NO-SOFT-ABORT-ERROR                 VALUE  'N'.   02020000
020300     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    02030000
020400         88  PS-COMMAREA-VALID                      VALUE 'Y'.    02040000
020500         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    02050000
020600     05  PS-RECEIVER-EXISTS-SW          PIC  X(01)  VALUE 'Y'.    02060000
020700         88  PS-RECEIVER-EXISTS                     VALUE 'Y'.    02070000
020800         88  PS-RECEIVER-DOESNT-EXIST               VALUE 'N'.    02080000
020900     05  PS-END-OF-RECITM-CSR-SW  PIC  X(01)  VALUE 'N'.          02090000
021000         88  PS-END-OF-RECITM-CSR             VALUE 'Y'.          02100000
021100         88  PS-NOT-END-OF-RECITM-CSR         VALUE 'N'.          02110000
021200     05  PS-END-OF-CTN-CSR-SW     PIC  X(01)  VALUE 'N'.          02120000
021300         88  PS-END-OF-CTN-CSR-YES            VALUE 'Y'.          02130000
021400         88  PS-END-OF-CTN-CSR-NO             VALUE 'N'.          02140000
021500     05  PS-LIST-END-SW           PIC  X(01)  VALUE 'N'.          02150000
021600         88  PS-LIST-END                      VALUE 'Y'.          02160000
021700         88  PS-NO-LIST-END                   VALUE 'N'.          02170000
021800     05  PS-BLOCK-ERROR-SW        PIC  X(01)  VALUE 'Y'.          02180000
021900         88  PS-NO-BLOCK-ERROR                VALUE 'Y'.          02190000
022000         88  PS-BLOCK-ERROR                   VALUE 'N'.          02200000
022100     05  PS-VERIFIED-RECEIVER-SW  PIC  X(01)  VALUE 'N'.          02210000
022200         88  PS-VERIFIED-RECEIVER             VALUE 'Y'.          02220000
022300         88  PS-NO-VERIFIED-RECEIVER          VALUE 'N'.          02230000
022400     05  PS-VERIFIED-LINE-FND-SW  PIC  X(01)  VALUE 'N'.          02240000
022500         88  PS-VERIFIED-LINE-FND             VALUE 'Y'.          02250000
022600         88  PS-NO-VERIFIED-LINE-FND          VALUE 'N'.          02260000
022700     05  PS-PHYSICAL-INV-SW       PIC  X(01)  VALUE 'N'.          02270000
022800         88  PS-PHYSICAL-INV                  VALUE 'Y'.          02280000
022900         88  PS-NOT-PHYSICAL-INV              VALUE 'N'.          02290000
023000     05  PS-SMOOTHING-EXISTS-SW   PIC  X(01)  VALUE 'N'.          02300000
023100         88  PS-SMOOTHING-ACTV                VALUE 'Y'.          02310000
023200         88  PS-SMOOTHING-INACTV              VALUE 'N'.          02320000
023300         88  PS-INACTV-SMTH-NOT-FND           VALUE 'I'.          02330000
023400     05  PS-UCC128-DATA-FOUND-SW  PIC  X(01)  VALUE 'N'.          02340000
023500         88  PS-UCC128-ROW-FND                VALUE 'Y'.          02350000
023600         88  PS-NO-UCC128-ROW-FND             VALUE 'N'.          02360000
023700     05  PS-UCC128-DATA-SW        pic  x(01)  value 'N'.          02370000
023800         88  PS-UCC128-DATA-NO                value 'N'.          02380000
023900         88  PS-UCC128-DATA-YES               value 'Y'.          02390000
024000     05  PS-CARTONS-CHKD-IN-SW    pic  x(01)  value 'N'.          02400000
024100         88  PS-CARTONS-CHKD-IN-NO            value 'N'.          02410000
024200         88  PS-CARTONS-CHKD-IN-YES           value 'Y'.          02420000
024300     05  PS-VND-BRCDE-SCND-SW     PIC  X(01)  VALUE 'N'.          02430000
024310         88  PS-VND-BRCDE-SCND                VALUE 'Y'.          02431000
024320         88  PS-VND-BRCDE-SCND-NO             VALUE 'N'.          02432000
024330     05  PS-PRINTER-ERROR-SW            PIC  X(01)  VALUE  'N'.   02433000
024340         88  PS-PRINTER-ERROR                       VALUE  'Y'.   02434000
024350     05  PS-INVLD-CRTN-COUNT-SW         PIC  X(01)  VALUE  'N'.   02435000
024360         88  PS-INVLD-CRTN-COUNT                    VALUE  'Y'.   02436000
024370     05  PS-INVALID-UNIT-COUNT-SW       PIC  X(01)  VALUE  'N'.   02437000
024380         88  PS-INVALID-UNIT-COUNT                  VALUE  'Y'.   02438000
024390*                                                                 02439000
024400     05  PS-EOF-UPDATE-CARTN-CSR-SW     PIC  X(01)  VALUE  'N'.   02440000
024500         88  PS-EOF-UPDATE-CARTN-CSR                VALUE  'Y'.   02450000
024600         88  PS-NOT-EOF-UPDATE-CARTN-CSR            VALUE  'N'.   02460000
024700*                                                                 02470000
024800     05  PS-EOF-UPD-CRTN-CSR-128-SW     PIC  X(01)  VALUE  'N'.   02480000
024900         88  PS-EOF-UPD-CRTN-CSR-128                VALUE  'Y'.   02490000
025000         88  PS-NOT-EOF-UPD-CRTN-CSR-128            VALUE  'N'.   02500000
025100     05  PS-EOF-SMTH-DTE-TME-CSR-SW     PIC  X(01)  VALUE  'N'.   02510000
025200         88  PS-EOF-SMTH-DTE-TME-CSR                VALUE  'Y'.   02520000
025300         88  PS-NOT-EOF-SMTH-DTE-TME-CSR            VALUE  'N'.   02530000
025400     05  PS-TRANS-ID-DUP-SW             PIC X(01)   VALUE 'Y'.    02540000
025500         88  PS-TRANS-ID-NOT-DUP                    VALUE 'N'.    02550000
025600         88  PS-TRANS-ID-DUP                        VALUE 'Y'.    02560000
025700     05  PS-VALID-TRANS-ID-SW           PIC X(01)   VALUE 'Y'.    02570000
025800         88  PS-VALID-TRANS-ID                      VALUE 'Y'.    02580000
025900         88  PS-INVALID-TRANS-ID                    VALUE 'N'.    02590000
026000     05  PS-VALID-REPRINT-STATUS-SW     PIC X(01)   VALUE 'Y'.    02600000
026100         88  PS-VALID-REPRINT-STATUS                VALUE 'Y'.    02610000
026200         88  PS-INVALID-REPRINT-STATUS              VALUE 'N'.    02620000
026300     05  PS-ECOMM-LOCATION-SW           PIC X(01)   VALUE 'N'.    02630000
026400         88  PS-ECOMM-LOCATION-YES                  VALUE 'Y'.    02640000
026500         88  PS-ECOMM-LOCATION-NO                   VALUE 'N'.    02650000
026600     05  PS-CS-LOCATION-SW              PIC X(01)   VALUE 'N'.    02660000
026700         88  PS-CS-LOCATION-YES                     VALUE 'Y'.    02670000
026800         88  PS-CS-LOCATION-NO                      VALUE 'N'.    02680000
026900*LMM                                                              02690000
027000     05  PS-INACTIVE-SW                 PIC X(01)   VALUE 'N'.    02700000
027100         88  PS-INACTV-ALLOWED                      VALUE 'Y'.    02710000
027200         88  PS-INACTV-NOT-ALLOWED                  VALUE 'N'.    02720000
027300*DMB                                                              02730000
027400     05  PS-AUTO-VE-SW                  PIC X(01)   VALUE ' '.    02740000
027500         88  PS-AUTO-VE-YES                         VALUE 'Y'.    02750000
027600         88  PS-AUTO-VE-NO                          VALUE 'N'.    02760000
027700     05  PS-FEM-SW                      PIC X(01)   VALUE ' '.    02770000
027800         88  PS-FEM-YES                             VALUE 'Y'.    02780000
027900         88  PS-FEM-NO                              VALUE 'N'.    02790000
028000* TCR - 1/29/04 - LABOR - BEGIN                                   02800000
028100     05  PS-LABOR-NEXT-SEQ-SW         PIC  X(01)  VALUE  'N'.     02810000
028200         88  PS-LABOR-NEXT-SEQ-YES                VALUE  'Y'.     02820000
028300         88  PS-LABOR-NEXT-SEQ-NO                 VALUE  'N'.     02830000
028400     05  PS-LABOR-LOGGING-LEVEL-SW    PIC  X(01)  VALUE  ' '.     02840000
028500         88  PS-LABOR-LOG-HEADER                  VALUE  'H'.     02850000
028600         88  PS-LABOR-LOG-PHY-LBL                 VALUE  'P'.     02860000
028700     05  PS-LABOR-HAVE-DUMMY-TK-SW    PIC  X(01)  VALUE  'N'.     02870000
028800         88  PS-LABOR-HAVE-DUMMY-TK-YES           VALUE  'Y'.     02880000
028900         88  PS-LABOR-HAVE-DUMMY-TK-NO            VALUE  'N'.     02890000
029000     05  PS-LABOR-USE-DUMMY-ASGMT-SW  PIC  X(01)  VALUE  'N'.     02900000
029100         88  PS-LABOR-USE-DUMMY-ASGMT-YES         VALUE  'Y'.     02910000
029200         88  PS-LABOR-USE-DUMMY-ASGMT-NO          VALUE  'N'.     02920000
029300     05  PS-LABOR-PHY-LBL-SML-SW      pic  X(01)  VALUE  'N'.     02930000
029400         88  PS-LABOR-PHY-LBL-SML-YES             VALUE  'Y'.     02940000
029500         88  PS-LABOR-PHY-LBL-SML-NO              VALUE  'N'.     02950000
029600     05  PS-LABOR-PHY-LBL-P2L-SW      pic  X(01)  VALUE  'N'.     02960000
029700         88  PS-LABOR-PHY-LBL-P2L-YES             VALUE  'Y'.     02970000
029800         88  PS-LABOR-PHY-LBL-P2L-NO              VALUE  'N'.     02980000
029900* TCR - 1/29/04 - LABOR - END                                     02990000
030000* BBR WR41309 - RFID PROCESSING                                   03000000
030100     05  PS-AUTOCY-DIRECTIVE-MODE     PIC  X(03).                 03010000
030200         88  PS-NO-DIRECTIVES                     VALUE  'NNE'.   03020000
030300         88  PS-ISSUED-FOR-EXCEPTIONS             VALUE  'EXC'.   03030000
030400         88  PS-ISSUED-FOR-ALL                    VALUE  'ALL'.   03040000
030500* BBR WR41309 - END                                               03050000
030600*                                                                 03060000
030700 01  DN-DB2-NULL-INDICATORS.                                      03070000
030800     05  DN-INV-DTE                 PIC S9(04) COMP VALUE ZEROES. 03080000
030900     05  DN-CRE-DTE                 PIC S9(04) COMP VALUE ZEROES. 03090000
031000     05  DN-CRE-TM                  PIC S9(04) COMP VALUE ZEROES. 03100000
031100     05  DN-NULL-IND                PIC S9(04) COMP VALUE ZEROES. 03110000
031200*                                                                 03120000
031300 01  PV-PROGRAM-VARIABLES.                                        03130000
031400     05  PV-CICS-RESPONSE                PIC S9(09)  VALUE ZEROS  03140000
031500                                                     COMP SYNC.   03150000
031600     05  PV-PREV-STATUS                  PIC  X(01).              03160000
031700     05  PV-LAST-STAT-CHG-TMST           PIC  X(26).              03170000
031800     05  PV-SEL-TERM-ID                  PIC  X(04).              03180000
031900     05  PV-SEL-TASK-NUMBER              PIC  9(05).              03190000
032000     05  PV-SEL-SEQ                      PIC  9(01).              03200000
032100     05  PV-CICS-MSG-AREA                PIC  X(80)  VALUE SPACE. 03210000
032200     05  PV-CICS-MSG-AREA2               PIC  X(100) VALUE SPACE. 03220000
032300     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     03230000
032400                                                     COMP SYNC.   03240000
032500     05  PV-SUB                         PIC S9(04)  VALUE +0      03250000
032600                                                    COMP SYNC.    03260000
032700     05  PV-DB2-CURRENT-DATE            PIC X(10).                03270000
032800     05  PV-PLND-INV-DTE-FUNC-QTY       PIC X(10).                03280000
032900     05  PV-DB2-CURRENT-TIMESTAMP       PIC X(26).                03290000
033000     05  PV-CURRENT-DATE                PIC X(10).                03300000
033100     05  PV-CURRENT-TIME                PIC  9(06).               03310000
033200     05  PV-DC-SRVCNG-STR               PIC  9(03).               03320000
033300     05  PV-DISPLAY-OPER                PIC  9(04) VALUE ZEROES.  03330000
033400     05  PV-DISPLAY-RCVR-SEQ-NBR        PIC  9(03) VALUE ZEROES.  03340000
033500     05  PV-DISPLAY-LABOR-ASGMTS        PIC  9(04) VALUE ZEROES.  03350000
033600     05  PV-DISPLAY-SMTHG-PRC-ID        PIC  9(09) VALUE ZEROES.  03360000
033700     05  PV-DISPLAY-SQLCODE             PIC -9(03).               03370000
033800     05  PV-DSPLY-PO             PIC  9(09)   VALUE ZEROES.       03380000
033900     05  PV-DSPLY-RCVR           PIC  9(04)   VALUE ZEROES.       03390000
034000     05  PV-DSPLY-LNE            PIC  9(04)   VALUE ZEROES.       03400000
034100     05  PV-DISPLAY-STORE        PIC  9(04)   VALUE ZEROES.       03410000
034200     05  PV-STR-COUNT                   PIC S9(04)  VALUE +0      03420000
034300                                                    COMP-3.       03430000
034400     05  PV-MAX-CTN                     PIC S9(13)  VALUE +0      03440000
034500                                                    COMP-3.       03450000
034600     05  PV-MAX-CTN-TOT                 PIC S9(13)  VALUE +0      03460000
034700                                                    COMP-3.       03470000
034800     05  PV-SUM-UNT                     PIC S9(13)  VALUE +0      03480000
034900                                                    COMP-3.       03490000
035000     05  PV-SUM-UNT-TOT                 PIC S9(13)  VALUE +0      03500000
035100                                                    COMP-3.       03510000
035200     05  PV-SHIPMENT-COUNT              PIC S9(09)  VALUE +0      03520000
035300                                                    COMP-3.       03530000
035400     05  PV-DB2-COUNT-CRTN              PIC S9(09)  VALUE +0      03540000
035500                                                    COMP-3.       03550000
035600     05  PV-CARTON-SKU-COUNT            PIC S9(09)  VALUE +0      03560000
035700                                                    COMP-3.       03570000
035800     05  PV-NUMBER-OF-UPDATES           PIC S9(04)  VALUE +0      03580000
035900                                                    COMP-3.       03590000
036000     05  PV-NUMBER-STORES-PROCESSED     PIC S9(04)  VALUE +0      03600000
036100                                                    COMP-3.       03610000
036200     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      03620000
036300                                                    COMP SYNC.    03630000
036400     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      03640000
036500                                                    COMP-3.       03650000
036600     05  PV-COUNT                       PIC S9(09)  VALUE +0      03660000
036700                                                    COMP-3.       03670000
036800     05  PV-TOT-CART-COUNT              PIC S9(09)  VALUE +0      03680000
036900                                                    COMP-3.       03690000
037000     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      03700000
037100                                                    COMP-3.       03710000
037200     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      03720000
037300                                                    COMP-3.       03730000
037400     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      03740000
037500                                                    COMP-3.       03750000
037600     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      03760000
037700                                                    COMP SYNC.    03770000
037800     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      03780000
037900                                                    COMP SYNC.    03790000
038000     05  PV-ITEM                        PIC S9(04)  VALUE +0      03800000
038100                                                    COMP SYNC.    03810000
038200     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      03820000
038300                                                    COMP SYNC.    03830000
038400     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      03840000
038500                                                    COMP SYNC.    03850000
038600     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      03860000
038700                                                    COMP SYNC.    03870000
038800     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      03880000
038900                                                    COMP SYNC.    03890000
039000     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      03900000
039100                                                    COMP SYNC.    03910000
039200     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      03920000
039300                                                    COMP SYNC.    03930000
039400     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      03940000
039500                                                    COMP SYNC.    03950000
039600     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      03960000
039700                                                    COMP SYNC.    03970000
039800     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      03980000
039900                                                    COMP SYNC.    03990000
040000     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      04000000
040100                                                    COMP SYNC.    04010000
040200     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      04020000
040300                                                    COMP SYNC.    04030000
040400     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      04040000
040500                                                    COMP SYNC.    04050000
040600     05  PV-PO-RCVR-UNT-CNTR            PIC S9(05)  VALUE +0      04060000
040700                                                    COMP.         04070000
040800     05  PV-SHIPMENT-CSR-IND            PIC  X(01)  VALUE SPACES. 04080000
040900     05  PV-VEND-SHIP-DTE               PIC  X(10)  VALUE SPACES. 04090000
041000     05  PV-TOTAL-LBS-COUNT             PIC S9(04)  VALUE +0      04100000
041100                                                    COMP SYNC.    04110000
041200     05  PV-DB2-COUNT                   PIC S9(04)  VALUE +0      04120000
041300                                                    COMP SYNC.    04130000
041400     05  PV-DB2-COUNT-ACTV              PIC S9(04)  VALUE +0      04140000
041500                                                    COMP SYNC.    04150000
041600     05  PV-DB2-COUNT-INACTV            PIC S9(04)  VALUE +0      04160000
041700                                                    COMP SYNC.    04170000
041800     05  PV-DB2-COUNT-MANIFEST          PIC S9(04)  VALUE +0      04180000
041900                                                    COMP SYNC.    04190000
042000     05  PV-SHPD-QTY-PREVIOUS           PIC S9(04)  VALUE +0      04200000
042100                                                    COMP SYNC.    04210000
042200     05  PV-SOFT-ABORT-MSG.                                       04220000
042300         10  FILLER            PIC X(12) VALUE ' PCKCS710 - '.    04230000
042400         10  FILLER            PIC X(09) VALUE 'SQLCODE: '.       04240000
042500         10  PV-SOFT-SQLCODE   PIC ZZ9-.                          04250000
042600         10  FILLER            PIC X(07) VALUE ' PARA: '.         04260000
042700         10  PV-SOFT-PARAGRAPH PIC X(30).                         04270000
042800         10  PV-SOFT-MSG       PIC X(18).                         04280000
042900                                                                  04290000
043000     05  PV-PACK-TYPE                    PIC X(06) VALUE SPACES.  04300000
043100                                                                  04310000
043200     05  PV-SHP-PRTR-CLUSTER-NBR         PIC S9(04)  VALUE ZERO.  04320000
043300     05  PV-SHP-PRTR-ID-ADDR             PIC  X(15)  VALUE SPACES.04330000
043400     05  PV-SHP-PRTR-OS-RLSE-CDE         PIC  X(15)  VALUE SPACES.04340000
043500     05  PV-SHP-DATA-XFER-MODE-ID        PIC  X(02)  VALUE SPACES.04350000
043600     05  PV-SHP-XMIT-INTFC-CDE           PIC  X(01)  VALUE SPACE. 04360000
043700     05  PV-SHP-PRTR-TYP-CDE             PIC  X(08)  VALUE SPACE. 04370000
043800                                                                  04380000
043900     05  PV-STR-NBR                     PIC  9(04).               04390000
044000     05  PV-PO-NBR-N                    PIC  9(09).               04400000
044100     05  PV-PO-NBR-X REDEFINES PV-PO-NBR-N.                       04410000
044200         10 FILLER                      PIC  X(01).               04420004
044300         10 PV-PO-NBR                   PIC  X(08).               04430004
044400     05  PV-RECEIVER-N                  PIC  9(09).               04440000
044500     05  PV-RECEIVER-X REDEFINES PV-RECEIVER-N.                   04450000
044600         10 FILLER                      PIC  X(06).               04460000
044700         10 PV-RECEIVER                 PIC  X(03).               04470000
044800                                                                  04480000
044900     05  PV-ACTL-CTOFF-YYYYMMDD       PIC  X(08).                 04490000
045000     05  PV-RECEIPT-DTE-YYYYMMDD                                  04500000
045100                                      PIC  X(08).                 04510000
045200     05  PV-CURRENT-DTE-YYYYMMDD      PIC  X(08).                 04520000
045300                                                                  04530000
045400     05  PV-PLND-INV-DTE.                                         04540000
045500         15  PV-PLND-INV-DTE-YYYY     PIC  X(04)  VALUE SPACE.    04550000
045600         15  FILLER                   PIC  X(06)  VALUE SPACE.    04560000
045700                                                                  04570000
045800     05  PV-WORK-TMST.                                            04580000
045900         10  PV-WORK-TMST-1.                                      04590000
046000             15  PV-WK-CCYY           PIC  X(04)  VALUE SPACE.    04600000
046100             15  FILLER               PIC  X(01)  VALUE SPACE.    04610000
046200             15  PV-WK-MO             PIC  X(02)  VALUE SPACE.    04620000
046300             15  FILLER               PIC  X(01)  VALUE SPACE.    04630000
046400             15  PV-WK-DA             PIC  X(02)  VALUE SPACE.    04640000
046500         10  PV-WORK-TMST-2.                                      04650000
046600             15  FILLER               PIC  X(01)  VALUE SPACE.    04660000
046700             15  PV-WK-HH             PIC  X(02)  VALUE SPACE.    04670000
046800             15  FILLER               PIC  X(01)  VALUE SPACE.    04680000
046900             15  PV-WK-MM             PIC  X(02)  VALUE SPACE.    04690000
047000             15  FILLER               PIC  X(01)  VALUE SPACE.    04700000
047100             15  PV-WK-SS             PIC  X(02)  VALUE SPACE.    04710000
047200             15  FILLER               PIC  X(01)  VALUE SPACE.    04720000
047300             15  FILLER               PIC  X(06)  VALUE ZERO.     04730000
047400                                                                  04740000
047500     05  PV-VER-NBR                     PIC S9(09)  VALUE +0      04750000
047600                                                    COMP SYNC.    04760000
047700     05  PV-UNION-TYPE                  PIC  X(01).               04770000
047800*                                                                 04780000
047900     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      04790000
048000                                                    COMP-3.       04800000
048100     05  PV-ORIGINAL-BLOCK              PIC S9(04)  VALUE +0      04810000
048200                                                    COMP SYNC.    04820000
048300     05  PV-ITEMS-HOLD                  PIC S9(03)  COMP-3.       04830000
048400     05  PV-ITEMS-DIFF                  PIC S9(03)  COMP-3.       04840000
048500     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      04850000
048600                                                    COMP-3.       04860000
048700     05  PV-RANDOM-NUMBER                PIC  9(09)  VALUE ZEROES.04870000
048800     05  PV-RANDOM-NUMBER-R REDEFINES  PV-RANDOM-NUMBER.          04880000
048900         10  PV-RANDOM-1-8               PIC  9(08).              04890000
049000         10  FILLER                      PIC  9(01).              04900000
049100     05  PV-RANDOM-NBR-R                 PIC  9(08)  VALUE ZEROES.04910000
049200     05  PV-LPMS-TRANS-ID                PIC  9(08)  VALUE ZEROES.04920000
049300**                                                                04930000
049400     05  PV-DISPLAY-PO-NBR               PIC  9(08)  VALUE ZEROES.04940000
049500     05  PV-DISPLAY-RCVR                 PIC  9(04)  VALUE ZEROES.04950000
049600     05  PV-DISPLAY-CRTN-ID              PIC  9(18)  VALUE ZEROES.04960000
049700     05  PV-DB2-COUNT-PBS-ERRORS         PIC S9(09)  VALUE +0     04970000
049800                                                    COMP-3.       04980000
049900     05  PV-NULL-IND-1                   PIC S9(04)  VALUE +0     04990000
050000                                                     COMP.        05000000
050100                                                                  05010000
050200* TCR - 1/30/04 - LABOR - BEGIN                                   05020000
050300     05  PV-LABOR-ASGMT-STRT-DTE        PIC  X(10).               05030000
050400     05  PV-LABOR-ASGMT-NBR-TXT         PIC  X(10).               05040000
050500     05  PV-LABOR-ASGMT-NBR-SEQ-NBR     PIC S9(09) COMP.          05050000
050600     05  PV-LABOR-SEQ-START-NBR         PIC S9(09) COMP.          05060000
050700     05  PV-LABOR-DUMMY-TK              PIC  X(08).               05070000
050800     05  PV-LABOR-USER-ID               PIC  X(08).               05080000
050900     05  PV-LABOR-CURRENT-DATE          PIC  X(10).               05090000
051000     05  PV-LABOR-CURRENT-TIME          PIC  X(08).               05100000
051100     05  PV-LABOR-P2L-UNITS             PIC S9(09)  COMP.         05110000
051200     05  PV-LABOR-FCSE-UNITS            PIC S9(09)  COMP.         05120000
051300     05  PV-LABOR-INPK-UNITS            PIC S9(09)  COMP.         05130000
051400     05  PV-LABOR-SML-UNITS             PIC S9(09)  COMP.         05140000
051500* TCR - 1/30/04 - LABOR - END                                     05150000
051600                                                                  05160000
051700* dmh - 9/12/08 - begin                                           05170000
051710     05  PV-SMOOTH-CRTN-CNT             PIC S9(09)  VALUE +0      05171000
051720                                                    COMP-3.       05172000
051730* dmh - 9/12/08 - end                                             05173000
051740                                                                  05174000
051750******************************************************************05175000
051760**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **05176000
051770**  THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           **05177000
051780**  APPLICATION-SPECIFIC COMMAREA.                              **05178000
051790******************************************************************05179000
051800 01  LQW-LIST-QUEUE-WORK-AREA.                                    05180000
051900     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  05190000
052000     05  LQW-ITEM-ENTRIES               OCCURS 11 TIMES           05200000
052100                                        INDEXED BY LQW-IDX.       05210000
052200         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       05220000
052300*                                                                 05230000
052400         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               05240000
052500         10  LQW-SELECTED-SW            PIC  X(01).               05250000
052600             88  LQW-SELECT                         VALUE 'S'.    05260000
052700             88  LQW-DESELECT                       VALUE ' '.    05270000
052800             88  LQW-PRT                            VALUE 'P'.    05280000
052900         10  LQW-ACTION                 PIC  X(03).               05290000
053000         10  LQW-NBR-CARTONS            PIC  9(05).               05300000
053100         10  LQW-NBR-UNITS              PIC  9(05).               05310000
053200         10  LQW-STR-NUMBER             PIC  X(04).               05320000
053300         10  LQW-STR-NAME               PIC  X(24).               05330000
053400         10  LQW-STATUS                 PIC  X(20).               05340000
053500         10  LQW-PROTECT-SW             PIC  X(01).               05350000
053600             88  LQW-PROTECTED                     VALUE 'Y'.     05360000
053700             88  LQW-NOT-PROTECTED                 VALUE 'N'.     05370000
053800         10  LQW-INVLD-FOR-PROCESS      PIC  X(01).               05380000
053900             88  LQW-INVALID                       VALUE 'I'.     05390000
054000             88  LQW-NOT-INVALID                   VALUE 'N'.     05400000
054100             88  LQW-INVALID-STAT                  VALUE 'S'.     05410000
054200         10  LQW-UCC128-DATA-EXISTS-SW  PIC X(1).                 05420000
054300             88  LQW-UCC128-DATA-YES               VALUE 'Y'.     05430000
054400             88  LQW-UCC128-DATA-NO                VALUE 'N'.     05440000
054500         10  LQW-VERIFIED-LINE-SW       PIC X(1).                 05450000
054600             88  LQW-VERIFIED-LINE-YES             VALUE 'Y'.     05460000
054700             88  LQW-VERIFIED-LINE-NO              VALUE 'N'.     05470000
054800         10  LQW-PHYSICAL-INV-SW        PIC X(1).                 05480000
054900             88  LQW-PHYSICAL-INV-YES              VALUE 'Y'.     05490000
055000             88  LQW-PHYSICAL-INV-NO               VALUE 'N'.     05500000
055100         10  LQW-VND-BRCDE-SCND-SW      PIC X(1).                 05510000
055200             88  LQW-VND-BRCDE-SCND                VALUE 'Y'.     05520000
055300             88  LQW-VND-BRCDE-SCND-NO             VALUE 'N'.     05530000
055400         10  LQW-MISDIRECT-STORE-SW     PIC X(1).                 05540000
055500             88  LQW-MISDIRECT-STORE               VALUE 'Y'.     05550000
055600             88  LQW-MISDIRECT-STR-NO              VALUE 'N'.     05560000
055700         10  LQW-PBS-ERROR-SW           PIC X(1).                 05570000
055800             88  LQW-PBS-ERROR                     VALUE 'Y'.     05580000
055900             88  LQW-PBS-ERROR-NO                  VALUE 'N'.     05590000
056000         10  LQW-UNKN-ITEM-NBR-SW       PIC X(1).                 05600000
056100             88  LQW-UNKN-ITEM-NBR                 VALUE 'Y'.     05610000
056200         10  LQW-PHY-INV-STORE-SW       PIC X(1).                 05620000
056300             88  LQW-PHY-INV-STORE                 VALUE 'Y'.     05630000
056400             88  LQW-NOT-PHY-INV-STORE             VALUE 'N'.     05640000
056500                                                                  05650000
056600*---------------------------------------------------------------* 05660000
056700*  RECORD LAYOUT FOR THE MESSAGE SELECTION TEMP STORAGE QUEUE.  * 05670000
056800*---------------------------------------------------------------* 05680000
056900     COPY PCWS203.                                                05690000
057000     COPY PCWS206.                                                05700000
057100                                                                  05710000
057200*---------------------------------------------------------------* 05720000
057300*  RECORD LAYOUT FOR SELECTION TEMP STORAGE QUEUE.  *             05730000
057400*---------------------------------------------------------------* 05740000
057500     COPY RCWS013.                                                05750000
057600                                                                  05760000
057700*---------------------------------------------------------------* 05770000
057800*  RECORD LAYOUT FOR THE TROUBLE CREATION ROUTINE                 05780000
057900*---------------------------------------------------------------* 05790000
058000     COPY TMWS500.                                                05800000
058100*                                                                 05810000
058700*----------------------------------------------------------------*05870000
058800*  WORK AREA PASSED IN CALL TO DPKUT500                          *05880000
058900*----------------------------------------------------------------*05890000
059000     COPY DPWS500.                                                05900000
059100                                                                  05910000
059200*----------------------------------------------------------------*05920000
059300*    CURRENT DATE COPYBOOK.                                       05930000
059400*----------------------------------------------------------------*05940000
059500     COPY DPWS017.                                                05950000
059600                                                                  05960000
059700*----------------------------------------------------------------*05970000
059800*  SENDING/RECEIVING AREA FOR THE                                 05980000
059900*  PRINTER VALIDATION ROUTING (DPKCS060)                          05990000
060000*----------------------------------------------------------------*06000000
060100     COPY DPWS072.                                                06010000
060200                                                                  06020000
060300***************************************************************** 06030000
060400*   RCWS039 - IS THE LAYOUT THAT IS USED TO PASS INFO TO THE    * 06040000
060500*             FKEY ELIGIBILITY MODULE (RCKUT126).               * 06050000
060600***************************************************************** 06060000
060700     COPY RCWS039.                                                06070000
060800                                                                  06080000
060900***************************************************************** 06090000
061000*   RCWS040 - IS THE LAYOUT THAT IS USED TO PASS INFO TO THE    * 06100000
061100*             AUTOVERIFY (AUTOVE) ELIGIBILITY MODULE (RCKUT127).* 06110000
061200***************************************************************** 06120000
061300     COPY RCWS040.                                                06130000
061400                                                                  06140000
061500***************************************************************** 06150000
061600*   XLWS071 - IS THE LAYOUT THAT IS USED TO PASS INFO TO THE    * 06160000
061700*             LOCATION MODULE (XLKUT071)                        * 06170000
061800***************************************************************** 06180000
061900     COPY XLWS071.                                                06190000
062000                                                                  06200000
062100*---------------------------------------------------------------* 06210000
062200*  Commarea used by program DLKUP001 to get the next sequence   * 06220000
062300*  number for the purpose of numbering detail business events.  * 06230000
062400*  DC Labor - WR-24630 - 1/30/04 TCR                            * 06240000
062500*---------------------------------------------------------------* 06250000
062600     COPY DLWS001.                                                06260000
062700                                                                  06270000
062800*---------------------------------------------------------------* 06280000
062900*  Commarea used by program DLKUT001 to determine if an         * 06290000
063000*  Associate is already associated to an open assignment.       * 06300000
063100*  DC Labor - WR-24630 - 1/30/04 TCR                            * 06310000
063200*---------------------------------------------------------------* 06320000
063300     COPY DLWS003.                                                06330000
063400                                                                  06340000
063500*---------------------------------------------------------------* 06350000
063600*  Commarea used by program DLKUP003 to insert new assignments  * 06360000
063700*  into the DL assignment database.                             * 06370000
063800*  DC Labor - WR-24630 - 1/30/04 TCR                            * 06380000
063900*---------------------------------------------------------------* 06390000
064000     COPY DLWS007.                                                06400000
064100                                                                  06410000
064200*---------------------------------------------------------------* 06420000
064300*  Copybook used to consistently format the assignment fields   * 06430000
064400*  within the DL programs.                                      * 06440000
064500*  DC Labor - WR-24630 - 1/30/04 TCR                            * 06450000
064600*---------------------------------------------------------------* 06460000
064700     COPY DLWS011.                                                06470000
064800                                                                  06480000
064900*---------------------------------------------------------------* 06490000
065000*  Commarea used by program XLKUP033 to write data to the EAI   * 06500000
065100*  export tables within the logistics domain.                   * 06510000
065200*  DC Labor - WR-24630 - 1/30/04 TCR                            * 06520000
065300*---------------------------------------------------------------* 06530000
065400     COPY XLWS072.                                                06540000
065500                                                                  06550000
065600*---------------------------------------------------------------* 06560000
065700*  Copybook used by program XLKUP033 to define the data         * 06570000
065800*  elements in the DLT_TXT and xxT_BUS_EVNT_DTL tables          * 06580000
065900*  (the EAI export tables within the logistics domain)          * 06590000
066000*  DC Labor - WR-24630 - 1/23/04 DMH                            * 06600000
066100*---------------------------------------------------------------* 06610000
066200     COPY PCWS242.                                                06620000
066300                                                                  06630000
066400                                                                  06640000
066500******************************************************************06650000
066600*    COMMAREA COPYBOOK FOR PO-RCVR TRKNG MODULE                   06660000
066700******************************************************************06670000
066800     COPY RCWS071.                                                06680000
066900                                                                  06690000
067000* BBR WR41309 - RFID PROCESSING                                   06700000
067100******************************************************************06710000
067200*    COMMAREA COPYBOOK FOR RFID CARTON DIRECTIVES MODULE          06720000
067300******************************************************************06730000
067400     COPY SUWS095.                                                06740000
067401******************************************************************06740100
067402*    COMMAREA COPYBOOK FOR DELETE DIRECTIVES MODULE               06740200
067403******************************************************************06740300
067404     COPY SUWS090.                                                06740400
067405* BBR WR41309 - END                                               06740500
067406*---------------------------------------------------------------* 06740600
067407*    MAP LAYOUT                                                 * 06740700
067408*---------------------------------------------------------------* 06740800
067409     COPY PCKM710.                                                06740900
067410*                                                                 06741000
067420 01  MR-OCCURS-LAYOUT                   REDEFINES  PCK710O.       06742000
067430     05  FILLER                         PIC X(184).               06743007
067440     05  MR-SCROLL-AREA                 OCCURS 11 TIMES.          06744000
067450         10  MR-SELECTL                 PIC S9(04) COMP.          06745000
067460         10  MR-SELECTA                 PIC  X(01).               06746000
067470         10  MR-SELECTC                 PIC  X(01).               06747000
067480         10  MR-SELECTH                 PIC  X(01).               06748000
067490         10  MR-SELECTI                 PIC  X(01).               06749000
067500                                                                  06750000
067600         10  MR-ACTIONL                 PIC S9(04) COMP.          06760000
067700         10  MR-ACTIONA                 PIC  X(01).               06770000
067800         10  MR-ACTIONC                 PIC  X(01).               06780000
067900         10  MR-ACTIONH                 PIC  X(01).               06790000
068000         10  MR-ACTION                  PIC  X(03).               06800000
068100                                                                  06810000
068200         10  MR-NBR-CARTONSL               PIC S9(04) COMP.       06820000
068300         10  MR-NBR-CARTONSA               PIC  X(01).            06830000
068400         10  MR-NBR-CARTONSC               PIC  X(01).            06840000
068500         10  MR-NBR-CARTONSH               PIC  X(01).            06850000
068600         10  MR-NBR-CARTONS-X.                                    06860000
068700             15 MR-NBR-CARTONS             PIC  ZZZZ9.            06870000
068800                                                                  06880000
068900         10  MR-NBR-UNITSL                 PIC S9(04) COMP.       06890000
069000         10  MR-NBR-UNITSA                 PIC  X(01).            06900000
069100         10  MR-NBR-UNITSC                 PIC  X(01).            06910000
069200         10  MR-NBR-UNITSH                 PIC  X(01).            06920000
069300         10  MR-NBR-UNITS-X.                                      06930000
069400             15 MR-NBR-UNITS               PIC  ZZZZ9.            06940000
069500                                                                  06950000
069600         10  MR-STR-NUMBERL                PIC S9(04) COMP.       06960000
069700         10  MR-STR-NUMBERA                PIC  X(01).            06970000
069800         10  MR-STR-NUMBERC                PIC  X(01).            06980000
069900         10  MR-STR-NUMBERH                PIC  X(01).            06990000
070000         10  MR-STR-NUMBER-X.                                     07000000
070100             15 MR-STR-NUMBER              PIC  Z999.             07010000
070200                                                                  07020000
070300         10  MR-STR-NAMEL               PIC S9(04) COMP.          07030000
070400         10  MR-STR-NAMEA               PIC  X(01).               07040000
070500         10  MR-STR-NAMEC               PIC  X(01).               07050000
070600         10  MR-STR-NAMEH               PIC  X(01).               07060000
070700         10  MR-STR-NAME                PIC  X(24).               07070000
070800                                                                  07080000
070900                                                                  07090000
071000         10  MR-STATUSL                 PIC S9(04) COMP.          07100000
071100         10  MR-STATUSA                 PIC  X(01).               07110000
071200         10  MR-STATUSC                 PIC  X(01).               07120000
071300         10  MR-STATUSH                 PIC  X(01).               07130000
071400         10  MR-STATUS                  PIC  X(20).               07140000
071500     05  FILLER                         PIC  X(91).               07150000
071600                                                                  07160000
071700                                                                  07170000
071800*----------------------------------------------------------------*07180000
071900*  RANDOM NUMBER AREA                                             07190000
072000*----------------------------------------------------------------*07200000
072100     COPY DPWS902.                                                07210000
072200                                                                  07220000
072300*----------------------------------------------------------------*07230000
072400**  SECURITY SUBROUTINE PARAMETERS                                07240000
072500*----------------------------------------------------------------*07250000
072600     COPY DPWS008.                                                07260000
072700*---------------------------------------------------------------* 07270000
072800*    ATTRIBUTE SETTINGS COPYBOOK.                               * 07280000
072900*---------------------------------------------------------------* 07290000
073000                                                                  07300000
073100     COPY DPWS015.                                                07310000
073200                                                                  07320000
073300*---------------------------------------------------------------* 07330000
073400*    FUNCTION KEYS COPYBOOK.                                    * 07340000
073500*---------------------------------------------------------------* 07350000
073600                                                                  07360000
073700     COPY DPWS016.                                                07370000
073800                                                                  07380000
073900*---------------------------------------------------------------* 07390000
074000*    NUMERIC EDIT LAYOUT.                                       * 07400000
074100*---------------------------------------------------------------* 07410000
074200                                                                  07420000
074300     COPY DPWS010I.                                               07430000
074400                                                                  07440000
074500*---------------------------------------------------------------* 07450000
074600*    PARAMETERS FOR CALLING CICS ARCHITECTURE API (DPKCS030).   * 07460000
074700*---------------------------------------------------------------* 07470000
074800     COPY DPWS030.                                                07480000
1122rm     COPY DPWS930.                                                07481016
                                                                        07490016
075000*---------------------------------------------------------------* 07500000
075100*    STANDARD COMMAREA.                                         * 07510000
075200*---------------------------------------------------------------* 07520000
075300                                                                  07530000
075400     COPY DPWS020.                                                07540000
075500     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                07550000
075600                                                                  07560000
075700*---------------------------------------------------------------* 07570000
075800* INTER-APPLICATION COMMAREA.                                   * 07580000
075900*   PCWS201 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 07590000
076000*             SPEC SCREEN.                                      * 07600000
076100*   PCWS202 - IS THE INPUT  LAYOUT THAT WILL BE PASSED FROM     * 07610000
076200*             THE PBS-SMOOTHING STORE LIST.                     * 07620000
076300*---------------------------------------------------------------* 07630000
076400                                                                  07640000
076500         10  INTER-APPL-COMM-AREA       PIC X(200).               07650000
076600     COPY PCWS201.                                                07660000
076700     COPY PCWS202.                                                07670000
076800     COPY PCWS204.                                                07680000
076900     COPY RCWS015.                                                07690000
077000     COPY RCWS012.                                                07700000
077100*---------------------------------------------------------------* 07710000
077200*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 07720000
077300*---------------------------------------------------------------* 07730000
077400         10  ASC-SPECIFIC-COMMAREA.                               07740000
077500             15  ASC-PO-RECEIVER.                                 07750000
077600                 20 ASC-PO-NBR          PIC  X(08).               07760004
077700                 20 FILLER              PIC  X(01).               07770005
077800                 20 ASC-RECEIVER        PIC  X(03).               07780000
077900             15  ASC-LIST-KEYS.                                   07790000
078000                 20  ASC-OPER-UNT-ID                 PIC S9(04)   07800000
078100                                                           COMP.  07810000
078200                 20  ASC-KEY-OPER-UNT-ID             PIC S9(04)   07820000
078300                                                           COMP.  07830000
078400                 20  ASC-CURR-OPER-UNT-ID            PIC S9(04)   07840000
078500                                                           COMP.  07850000
078600                 20  ASC-FCLTY-ID                    PIC S9(04)   07860000
078700                                                           COMP.  07870000
078800                 20  ASC-KEY-FCLTY-ID                PIC S9(04)   07880000
078900                                                           COMP.  07890000
079000                 20  ASC-REC-SEQ-NBR                 PIC S9(09)   07900000
079100                                                           COMP.  07910000
079200                 20  ASC-SML-PRINTER                 PIC  X(08).  07920000
079300                 20  ASC-VENDOR-NAME                 PIC  X(23).  07930000
079400                 20  ASC-DEPT                        PIC  S9(04)  07940000
079500                                                           COMP.  07950000
079600                 20  ASC-TOTAL-CART                  PIC S9(09)   07960000
079700                                                           COMP.  07970000
079800                 20  ASC-TOTAL-UNITS                 PIC S9(09)   07980000
079900                                                           COMP.  07990000
080000                 20  ASC-UCC128-EXISTS               PIC  X(25).  08000000
080100                 20  ASC-UCC128-EXISTS-IND           PIC  X(01).  08010000
080200             15  ASC-BLK-SUB                         PIC S9(04)   08020000
080300                                                          COMP    08030000
080400                                                          SYNC.   08040000
080500             15  ASC-ITEM-SUB                        PIC S9(04)   08050000
080600                                                          COMP    08060000
080700                                                          SYNC.   08070000
080800             15  ASC-NUMBER-OF-ITEMS-READ            PIC S9(09)   08080000
080900                                                          COMP-3. 08090000
081000             15  ASC-NUMBER-OF-SELECTED-ITEMS        PIC S9(09)   08100000
081100                                                          COMP-3. 08110000
081200             15  ASC-ITEMS-DISPLAYED                 PIC S9(03)   08120000
081300                                                          COMP-3. 08130000
081400             15  ASC-ITEM-AT-TOP-OF-PANEL            PIC S9(09)   08140000
081500                                                          COMP-3. 08150000
081600             15  ASC-ITEM-AT-BOT-OF-PANEL            PIC S9(09)   08160000
081700                                                          COMP-3. 08170000
081800             15  ASC-HIGHEST-BLOCK-WRITTEN           PIC S9(04)   08180000
081900                                                          COMP    08190000
082000                                                          SYNC.   08200000
082100             15  ASC-START-OF-SELECTED-RANGE         PIC S9(09)   08210000
082200                                                          COMP-3. 08220000
082300             15  ASC-END-OF-SELECTED-RANGE           PIC S9(09)   08230000
082400                                                          COMP-3. 08240000
082500             15  ASC-PKGNG-CD                 PIC X(01).          08250000
082600                 88  ASC-PRE-PACK-ORDER           VALUE 'I', 'M'. 08260000
082700                 88  ASC-INNER-PREPK              VALUE 'I'.      08270000
082800                 88  ASC-MULTI-SKU-PREPK          VALUE 'M'.      08280000
082900                 88  ASC-SINGLE-SKU-PREPK         VALUE 'S'.      08290000
083000                 88  ASC-CASEPACK                 VALUE 'C'.      08300000
083100                 88  ASC-BULK-PACK                VALUE 'B'.      08310000
083200             15  ASC-DFLT-STR-ZN-ID                  PIC  X(05).  08320000
083300             15  ASC-ITEMS-LEFT-INDICATOR            PIC  X(01).  08330000
083400                 88  ASC-ITEMS-LEFT-ON-DB            VALUE 'Y'.   08340000
083500                 88  ASC-NO-ITEMS-LEFT-ON-DB         VALUE 'N'.   08350000
083600             15  ASC-TEMP-QUEUE-UPDATE-SW            PIC  X(01).  08360000
083700                 88  ASC-UPDATE-TSQ                  VALUE 'Y'.   08370000
083800                 88  ASC-NO-TSQ-UPDATE               VALUE ' '.   08380000
083900             15  ASC-LIST-QUEUE-NAME.                             08390000
084000                 20  ASC-LIST-TERM-ID                PIC  X(04).  08400000
084100                 20  ASC-LIST-TASK-NUMBER            PIC S9(05)   08410000
084200                                                          COMP-3. 08420000
084300                 20  ASC-LIST-SEQ                    PIC  9(01).  08430000
084400             15  ASC-SEL-QUEUE-NAME.                              08440000
084500                 20  ASC-SEL-TERM-ID          PIC  X(04).         08450000
084600                 20  ASC-SEL-TASK-NUMBER      PIC S9(05) COMP-3.  08460000
084700                 20  ASC-SEL-SEQ              PIC  9(01).         08470000
084800             15  ASC-SEL-QUEUE-NAME-IN.                           08480000
084900                 20  ASC-SEL-TERM-ID-IN       PIC  X(04).         08490000
085000                 20  ASC-SEL-TASK-NUMBER-IN   PIC S9(05) COMP-3.  08500000
085100                 20  ASC-SEL-SEQ-IN           PIC  9(01).         08510000
085200                                                                  08520000
085300             15  ASC-START-ITEM-REQUEST.                          08530000
085400                 20  ASC-START-ITEM-REQUEST-N        PIC  9(05).  08540000
085500*                                                                 08550000
085600             15  ASC-SEL-SUB                  PIC S9(4) COMP.     08560000
085700             15  ASC-SEL-ITEM                 PIC S9(4) COMP.     08570000
085800             15  ASC-USE-SELECTION-QUEUE-IND  PIC  X(1).          08580000
085900                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 08590000
086000             15  ASC-NUMBER-OF-TS-ITEMS       PIC S9(09) COMP-3.  08600000
086100                                                                  08610000
086200                                                                  08620000
086300             15  ASC-FUNC04-RETURN-FLAG       PIC  X(1).          08630000
086400                 88  ASC-FUNC04-RETURN-NO   VALUE 'N'.            08640000
086500                 88  ASC-FUNC04-RETURN-YES  VALUE 'Y'.            08650000
086600                                                                  08660000
086700             15  ASC-FUNC05-RETURN-FLAG       PIC  X(1).          08670000
086800                 88  ASC-FUNC05-RETURN-NO   VALUE 'N'.            08680000
086900                 88  ASC-FUNC05-RETURN-YES  VALUE 'Y'.            08690000
087000                                                                  08700000
087100             15  ASC-FUNC06-RETURN-FLAG       PIC  X(1).          08710000
087200                 88  ASC-FUNC06-RETURN-NO   VALUE 'N'.            08720000
087300                 88  ASC-FUNC06-RETURN-YES  VALUE 'Y'.            08730000
087400                                                                  08740000
087500             15  ASC-FUNC08-RETURN-FLAG       PIC  X(1).          08750000
087600                 88  ASC-FUNC08-RETURN-NO   VALUE 'N'.            08760000
087700                 88  ASC-FUNC08-RETURN-YES  VALUE 'Y'.            08770000
087800                                                                  08780000
087900             15  ASC-CONFIRM-TYPE-IND         PIC  X(01).         08790000
088000                 88  ASC-CONFIRM-UCC128          VALUE 'U'.       08800000
088100                 88  ASC-NO-CONFIRM-UCC128       VALUE 'N'.       08810000
088200*LMM                                                              08820000
088300             15  ASC-CONFIRM-INACTV-SW        PIC  X(01).         08830000
088400                 88  ASC-CONFIRM-INACTV          VALUE 'I'.       08840000
088500                 88  ASC-NO-CONFIRM-INACTV       VALUE 'N'.       08850000
088600             15  ASC-VEND-BRCDE-CONFIRM-SW    PIC X(1).           08860000
088700                 88  ASC-VND-BRCD-CNFRM          VALUE 'Y'.       08870000
088800                 88  ASC-VND-BRCD-CNFRM-NO       VALUE 'N'.       08880000
088900             15  ASC-RCVR-TRBLE-EXISTS-SW     PIC X(1).           08890000
089000                 88  ASC-RCVR-TRBLE-EXISTS-YES   VALUE 'Y'.       08900000
089100                 88  ASC-RCVR-TRBLE-EXISTS-NO    VALUE 'N'.       08910000
089200             15  ASC-TROUBLE-CREATE-SW         PIC X(1).          08920000
089300                 88  ASC-TROUBLE-CREATE-YES       VALUE 'Y'.      08930000
089400                 88  ASC-TROUBLE-CREATE-NO        VALUE 'N'.      08940000
089500* TCR - 1/29/04 - LABOR - BEGIN                                   08950000
089600             15  ASC-DC-INTERFC-LABOR-SW      PIC  X(01).         08960000
089700                 88  ASC-DC-INTERFC-LABOR-YES      VALUE  'Y'.    08970000
089800                 88  ASC-DC-INTERFC-LABOR-NO       VALUE  'N'.    08980000
089900             15  ASC-ASSOC-LABOR-ASGMT-SW     PIC  X(01).         08990000
090000                 88  ASC-ASSOC-LABOR-ASGMT-YES     VALUE  'Y'.    09000000
090100                 88  ASC-ASSOC-LABOR-ASGMT-NO      VALUE  'N'.    09010000
090200* TCR - 1/29/04 - LABOR - END                                     09020000
090300* DMH - 9/24/08 - BEGIN                                           09030000
090400             15  ASC-PREVIOUS-SMOOTH-SW       PIC  X(01).         09040000
090500                 88  ASC-PREVIOUS-SMOOTH-YES       VALUE  'Y'.    09050000
090600                 88  ASC-PREVIOUS-SMOOTH-NO        VALUE  'N'.    09060000
090700* DMH - 9/24/08 - END                                             09070000
090800* BBR - 9/04/12 - BEGIN                                           09080000
090900             15  ASC-AUTOCY-MODE              PIC X(03).          09090000
091000                 88  ASC-NO-DIRECTIVES            VALUE 'NNE'.    09100000
091100                 88  ASC-ISSUED-FOR-EXCP          VALUE 'EXC'.    09110000
091200                 88  ASC-ISSUED-FOR-ALL           VALUE 'ALL'.    09120000
091300* BBR - 9/04/12 - END                                             09130000
091400                                                                  09140000
091500             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                09150000
091600                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  09160000
091700                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   09170000
091800                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   09180000
091900                                                                  09190000
092000                 20  ASC-ITEM-ARRAY.                              09200000
092100                     25  ASC-ITEM-ENTRIES OCCURS 11 TIMES.        09210000
092200                         30  ASC-LIST-ITEM-NUMBER                 09220000
092300                                                     PIC S9(09)   09230000
092400                                                     COMP-3.      09240000
092500                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  09250000
092600                             88  ASC-VALID-SELECT    VALUE ' '    09260000
092700                                                           'S'    09270000
092800                                                           'B'    09280000
092900                                                           'E'.   09290000
093000                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   09300000
093100                             88  ASC-TEMP-SELECT     VALUE 'S'.   09310000
093200                             88  ASC-TEMP-BEGIN      VALUE 'B'.   09320000
093300                             88  ASC-TEMP-END        VALUE 'E'.   09330000
093400                         30  ASC-SELECTED-SW         PIC  X(01).  09340000
093500                             88  ASC-NO-SELECT       VALUE ' '.   09350000
093600                             88  ASC-SELECT          VALUE 'S'.   09360000
093700                             88  ASC-BEGIN           VALUE 'B'.   09370000
093800                             88  ASC-END             VALUE 'E'.   09380000
093900                         30  ASC-ACTION             PIC  X(03).   09390000
094000                         30  ASC-NBR-CARTONS        PIC  9(05).   09400000
094100                         30  ASC-NBR-UNITS          PIC  9(05).   09410000
094200                         30  ASC-STR-NUMBER         PIC  X(04).   09420000
094300                         30  ASC-STR-NAME           PIC  X(24).   09430000
094400                         30  ASC-STATUS             PIC  X(20).   09440000
094500*                        30  ASC-PROTECT-FLD        PIC  X(01).   09450000
094600                         30  ASC-PROTECT-SW         PIC  X(01).   09460000
094700                             88  ASC-PROTECTED       VALUE 'Y'.   09470000
094800                             88  ASC-NOT-PROTECTED   VALUE 'N'.   09480000
094900                         30  ASC-INVLD-FOR-PROCESS  PIC  X(01).   09490000
095000                             88  ASC-INVALID         VALUE 'I'.   09500000
095100                             88  ASC-NOT-INVALID     VALUE 'N'.   09510000
095200                             88  ASC-INVALID-STAT    VALUE 'S'.   09520000
095300                         30  ASC-UCC128-DATA-EXISTS-SW  PIC X(1). 09530000
095400                             88  ASC-UCC128-DATA-YES   VALUE 'Y'. 09540000
095500                             88  ASC-UCC128-DATA-NO    VALUE 'N'. 09550000
095600                         30  ASC-VERIFIED-LINES-SW      PIC X(1). 09560000
095700                             88  ASC-VERIFIED-LINE-YES VALUE 'Y'. 09570000
095800                             88  ASC-VERIFIED-LINE-NO  VALUE 'N'. 09580000
095900                         30  ASC-PHYSICAL-INV-SW        PIC X(1). 09590000
096000                             88  ASC-PHYSICAL-INV-YES  VALUE 'Y'. 09600000
096100                             88  ASC-PHYSICAL-INV-NO   VALUE 'N'. 09610000
096200                         30  ASC-VEND-BRCDE-SCND-SW     PIC X(1). 09620000
096300                             88  ASC-VND-BRCDE-SCND   VALUE 'Y'.  09630000
096400                             88  ASC-VND-BRCDE-SCND-NO VALUE 'N'. 09640000
096500                         30  ASC-MISDIRECT-STORE-SW    PIC X(1).  09650000
096600                             88  ASC-MISDIRECT-STORE   VALUE 'Y'. 09660000
096700                             88  ASC-MISDIRECT-STR-NO  VALUE 'N'. 09670000
096800                         30  ASC-PBS-ERROR-SW          PIC X(1).  09680000
096900                             88  ASC-PBS-ERROR         VALUE 'Y'. 09690000
097000                             88  ASC-PBS-ERROR-NO      VALUE 'N'. 09700000
097100                         30  ASC-UNKN-ITEM-NBR-SW      PIC X(1).  09710000
097200                             88  ASC-UNKN-ITEM-NBR    VALUE 'Y'.  09720000
097300                         30  ASC-PHY-INV-STORE-SW      PIC X(1).  09730000
097400                             88  ASC-PHY-INV-STORE     VALUE 'Y'. 09740000
097500                             88  ASC-NOT-PHY-INV-STORE VALUE 'N'. 09750000
097600                                                                  09760000
097700*---------------------------------------------------------------* 09770000
097800*    ABEND PROCESSING COPYBOOK.                                 * 09780000
097900*---------------------------------------------------------------* 09790000
098000     COPY DPWS013.                                                09800000
098100                                                                  09810000
098200*----------------------------------------------------------------*09820000
098300*    DB2 DCLGEN FOR THE PURCHASE ORDER  TABLE                     09830000
098400*----------------------------------------------------------------*09840000
098500     EXEC SQL                                                     09850000
098600          INCLUDE TPURCHS                                         09860000
098700     END-EXEC.                                                    09870000
098800                                                                  09880000
098900*----------------------------------------------------------------*09890000
099000*    DB2 DCLGEN FOR THE SHIPPED PO TABLE                          09900000
099100*----------------------------------------------------------------*09910000
099200     EXEC SQL                                                     09920000
099300          INCLUDE TSHPTPO                                         09930000
099400     END-EXEC.                                                    09940000
099500                                                                  09950000
099600*----------------------------------------------------------------*09960000
099700*    DB2 DCLGEN FOR THE SHIPMENT TABLE                            09970000
099800*----------------------------------------------------------------*09980000
099900     EXEC SQL                                                     09990000
100000          INCLUDE TSHIPMT                                         10000000
100100     END-EXEC.                                                    10010000
100200                                                                  10020000
100300*----------------------------------------------------------------*10030000
100400*    DB2 DCLGEN FOR THE TRIP TABLE                                10040000
100500*----------------------------------------------------------------*10050000
100600     EXEC SQL                                                     10060000
100700          INCLUDE TVHTRIP                                         10070000
100800     END-EXEC.                                                    10080000
100900                                                                  10090000
101000*----------------------------------------------------------------*10100000
101100*    DB2 DCLGEN FOR THE INBOUND TRIP DOOR TABLE                   10110000
101200*----------------------------------------------------------------*10120000
101300     EXEC SQL                                                     10130000
101400          INCLUDE SUT00040                                        10140000
101500     END-EXEC.                                                    10150000
101600                                                                  10160000
101700*----------------------------------------------------------------*10170000
101800*    SQL AND COBOL DECLARATIONS FOR THE PC-PACK-TO-LIGHT MODULE   10180000
101900*----------------------------------------------------------------*10190000
102000     EXEC SQL                                                     10200000
102100          INCLUDE TP2LMOD                                         10210000
102200     END-EXEC.                                                    10220000
102300                                                                  10230000
102400*---------------------------------------------------------------* 10240000
102500*    DC-DISTRIBUTION TRANSACTION DETAIL                         * 10250000
102600*---------------------------------------------------------------* 10260000
102700     EXEC SQL                                                     10270000
102800          INCLUDE TDISTDT                                         10280000
102900     END-EXEC.                                                    10290000
103000                                                                  10300000
103100*----------------------------------------------------------------*10310000
103200*    DB2 DCLGEN FOR THE EXTERNAL ENTITY NAME TABLE                10320000
103300*----------------------------------------------------------------*10330000
103400     EXEC SQL                                                     10340000
103500          INCLUDE TENTNME                                         10350000
103600     END-EXEC.                                                    10360000
103700                                                                  10370000
103800*---------------------------------------------------------------* 10380000
103900*    DB2 AREA FOR RECEIVER TABLE                                * 10390000
104000*---------------------------------------------------------------* 10400000
104100     EXEC SQL                                                     10410000
104200          INCLUDE TRECEIV                                         10420000
104300     END-EXEC.                                                    10430000
104400*---------------------------------------------------------------* 10440000
104500*    DB2 AREA FOR TRIP STATUS TABLE                             * 10450000
104600*---------------------------------------------------------------* 10460000
104700     EXEC SQL                                                     10470000
104800          INCLUDE TTRIPST                                         10480000
104900     END-EXEC.                                                    10490000
105000*---------------------------------------------------------------* 10500000
105100*    DB2 AREA                                                     10510000
105200*---------------------------------------------------------------* 10520000
105300     EXEC SQL                                                     10530000
105400          INCLUDE TINPKSU                                         10540000
105500     END-EXEC.                                                    10550000
105600*---------------------------------------------------------------* 10560000
105700*    DB2 AREA FOR THE PACKSLIP TABLE                            * 10570000
105800*---------------------------------------------------------------* 10580000
105900     EXEC SQL                                                     10590000
106000          INCLUDE TPKSLIP                                         10600000
106100     END-EXEC.                                                    10610000
106200*---------------------------------------------------------------* 10620000
106300*    DB2 AREA                                                     10630000
106400*---------------------------------------------------------------* 10640000
106500     EXEC SQL                                                     10650000
106600          INCLUDE TRECITM                                         10660000
106700     END-EXEC.                                                    10670000
106800*---------------------------------------------------------------* 10680000
106900*    DB2 AREA                                                     10690000
107000*---------------------------------------------------------------* 10700000
107100     EXEC SQL                                                     10710000
107200          INCLUDE TRECDIS                                         10720000
107300     END-EXEC.                                                    10730000
107400*---------------------------------------------------------------* 10740000
107500*    DB2 AREA                                                     10750000
107600*---------------------------------------------------------------* 10760000
107700     EXEC SQL                                                     10770000
107800          INCLUDE XLT00025                                        10780000
107900     END-EXEC.                                                    10790000
108000*---------------------------------------------------------------* 10800000
108100*    DB2 AREA FOR COMMUNICATIONS                                * 10810000
108200*---------------------------------------------------------------* 10820000
108300     EXEC SQL                                                     10830000
108400          INCLUDE TSHUUPC                                         10840000
108500     END-EXEC.                                                    10850000
108600*---------------------------------------------------------------* 10860000
108700* DB2 AREA FOR SHIPPING UNIT TABLE                                10870000
108800*---------------------------------------------------------------* 10880000
108900     EXEC SQL                                                     10890000
109000          INCLUDE TSHPUNT                                         10900000
109100     END-EXEC.                                                    10910000
109200*---------------------------------------------------------------* 10920000
109300*    DB2 AREA FOR SHIPPING UNIT PROCESS CNTL TABLE              * 10930000
109400*---------------------------------------------------------------* 10940000
109500     EXEC SQL                                                     10950000
109600          INCLUDE SUT00003                                        10960000
109700     END-EXEC.                                                    10970000
109800*---------------------------------------------------------------* 10980000
109900*    DB2 AREA FOR OUTBOUND SHIPPING UPC TABLE                   * 10990000
110000*---------------------------------------------------------------* 11000000
110100     EXEC SQL                                                     11010000
110200          INCLUDE SUT00028                                        11020000
110300     END-EXEC.                                                    11030000
110400*---------------------------------------------------------------* 11040000
110500* DB2 AREA FOR THE OUBOUND SHIPPPING UNIT TABLE                   11050000
110600*---------------------------------------------------------------* 11060000
110700     EXEC SQL                                                     11070000
110800          INCLUDE SUT00024                                        11080000
110900     END-EXEC.                                                    11090000
111000*---------------------------------------------------------------* 11100000
111100* DB2 AREA FOR HISTORY TABLE                                      11110000
111200*---------------------------------------------------------------* 11120000
111300     EXEC SQL                                                     11130000
111400          INCLUDE TLBTKHS                                         11140000
111500     END-EXEC.                                                    11150000
111600*---------------------------------------------------------------* 11160000
111700* DB2 AREA FOR HISTORY TABLE                                      11170000
111800*---------------------------------------------------------------* 11180000
111900     EXEC SQL                                                     11190000
112000          INCLUDE TKRPRPM                                         11200000
112100     END-EXEC.                                                    11210000
112200*---------------------------------------------------------------* 11220000
112300* DB2 AREA                                                        11230000
112400*---------------------------------------------------------------* 11240000
112500     EXEC SQL                                                     11250000
112600          INCLUDE TSHUNLO                                         11260000
112700     END-EXEC.                                                    11270000
112800*---------------------------------------------------------------* 11280000
112900*    DB2 AREA FOR THE SHIPPING UNIT CROSS REFERENCE TABLE       * 11290000
113000*---------------------------------------------------------------* 11300000
113100     EXEC SQL                                                     11310000
113200          INCLUDE TSULBXF                                         11320000
113300     END-EXEC.                                                    11330000
113400                                                                  11340000
113500*---------------------------------------------------------------* 11350000
113600*    DB2 AREA FOR COMMUNICATIONS                                * 11360000
113700*---------------------------------------------------------------* 11370000
113800     EXEC SQL                                                     11380000
113900          INCLUDE SQLCA                                           11390000
114000     END-EXEC.                                                    11400000
114100                                                                  11410000
114200******************************************************************11420000
114300*  CURSOR TO BUILD THE SMOOTHING STORE LIST                     **11430000
114400******************************************************************11440000
114500                                                                  11450000
114600                                                                  11460000
114700     EXEC SQL                                                     11470000
114800          DECLARE STORE-LIST-CSR CURSOR FOR                       11480000
114900          SELECT STR_DEST_NBR                                     11490000
115000                , EXPTED_PKG_QTY                                  11500000
115100                , PKSL_STAT_CDE                                   11510000
115200          FROM  TPKSLIP                                           11520000
115300          WHERE PO_NBR          = :DK-PO-NBR                      11530000
115400            AND REC_SEQ_NBR     = :DK-RECEIVER                    11540000
115500            AND VER_STAT_CDE    = 'A'                             11550000
115600            AND STR_DEST_NBR    >   0                             11560000
115700          ORDER BY STR_DEST_NBR                                   11570000
115800     END-EXEC.                                                    11580000
115900                                                                  11590000
116000                                                                  11600000
116100     EXEC SQL                                                     11610000
116200          DECLARE TOTAL_UNTS_CSR CURSOR FOR                       11620000
116300          SELECT   DISTINCT(A.STATUS_CDE)                         11630000
116400                 , SUM(B.VERIFY_ITM_QTY)                          11640000
116500                 , SUM(B.AP_VERIFY_ITM_QTY)                       11650000
116600           FROM    TRECITM A                                      11660000
116700                 , TRECDIS B                                      11670000
116800           WHERE     A.ORD_NBR        = :DK-PO-NBR                11680000
116900              AND    A.REC_SEQ_NBR    = :DK-REC-SEQ-NBR           11690000
117000              AND    B.STR_NBR        = :DK-STR-NBR               11700000
117100              AND    A.ORD_NBR        =  B.ORD_NBR                11710000
117200              AND    A.ORD_LNE_NBR    =  B.ORD_LNE_NBR            11720000
117300              AND    A.REC_SEQ_NBR    =  B.REC_SEQ_NBR            11730000
117400              AND    A.VER_STATUS_CDE = 'A'                       11740000
117500           GROUP BY A.STATUS_CDE                                  11750000
117600     END-EXEC.                                                    11760000
117700*---------------------------------------------------------------* 11770000
117800* CARTON CURSOR FOR SELECTING FROM OTBND UPC AND UPDATING         11780000
117900* OUTBOUND CARTON TABLE                                           11790000
118000*---------------------------------------------------------------* 11800000
118100     EXEC SQL                                                     11810000
118200          DECLARE UPD_CRTN_CSR_SMTH CURSOR FOR                    11820000
118300              SELECT DISTINCT                                     11830000
118400                     B.SHIPT_UNT_ID                               11840000
118500              FROM  SUT_OTBND_UPC A,                              11850000
118600                    SUT_OTBND_CART B                              11860000
118700              WHERE A.TRN_NBR           =  :DK-PO-NBR             11870000
118800               AND   A.RCVR_SEQ_NBR     =  :DK-REC-SEQ-NBR        11880000
118900               AND   A.SHIPT_UNT_ID     =   B.SHIPT_UNT_ID        11890000
119000               AND   B.DEST_LOC_NBR     =  :DK-STR-NBR            11900000
119100               AND   B.ACTV_IND         =  :DK-ACTV-IND-CSR       11910000
119200               AND   B.CRE_DTE          =  :SUT00024-CRE-DTE      11920000
119300               AND   B.CRE_TM           =  :SUT00024-CRE-TM       11930000
119400     END-EXEC.                                                    11940000
119500                                                                  11950000
119600                                                                  11960000
119700*---------------------------------------------------------------* 11970000
119800* CARTON CURSOR FOR UPDATING CARTONS WITH UCC128 DATA           * 11980000
119900*---------------------------------------------------------------* 11990000
120000     EXEC SQL                                                     12000000
120100          DECLARE UPD_CRTN_CSR_U128 CURSOR FOR                    12010000
120200             SELECT C.SHIPT_UNT_ID                                12020000
120300             FROM  TPKSLIP A,                                     12030000
120400                   TINPKSU B,                                     12040000
120500                   TSHPUNT C                                      12050000
120600             WHERE A.PO_NBR           = :DK-PO-NBR                12060000
120700               AND A.REC_SEQ_NBR      = :DK-RECEIVER              12070000
120800               AND A.VER_STAT_CDE     = 'A'                       12080000
120900               AND A.PO_NBR           =  B.PO_NBR                 12090000
121000               AND A.SEQ_NBR          =  B.SEQ_NBR                12100000
121100               AND B.SHIPT_UNT_ID     =  C.SHIPT_UNT_ID           12110000
121200               AND C.DEST_OPER_UNT_ID = :DK-STR-NBR               12120000
121300               AND C.ACTV_IND         = :DK-ACTV-IND-CSR          12130000
121400     END-EXEC.                                                    12140000
121500                                                                  12150000
121600                                                                  12160000
121700*---------------------------------------------------------------* 12170000
121800* CURSOR FOR SELECTING MAX DATE AND MAX TIME FROM                 12180000
121900* OUTBOUND SHIPT UNT TABLE (SUT_OTBND_CART)                       12190000
122000*---------------------------------------------------------------* 12200000
122100     EXEC SQL                                                     12210000
122200          DECLARE SMTHG_DTE_TME_CSR CURSOR FOR                    12220000
122300          SELECT  CRE_DTE                                         12230000
122400                 ,MAX(CRE_TM)                                     12240000
122500            FROM  SUT_OTBND_UPC A                                 12250000
122600               ,  SUT_OTBND_CART B                                12260000
122700            WHERE A.TRN_NBR          = :DK-PO-NBR                 12270000
122800             AND  A.RCVR_SEQ_NBR     = :DK-RECEIVER               12280000
122900             AND  A.SHIPT_UNT_ID     =  B.SHIPT_UNT_ID            12290000
123000             AND  B.DEST_LOC_NBR     = :DK-STR-NBR                12300000
123100             AND  B.CART_SRC_CDE     =  'SMO'                     12310000
123200             AND  B.ACTV_IND         = :DK-ACTV-IND-SMTH          12320000
123300             AND  B.CRE_DTE          =                            12330000
123400                  (SELECT MAX(B.CRE_DTE)                          12340000
123500                     FROM SUT_OTBND_UPC A                         12350000
123600                         ,SUT_OTBND_CART B                        12360000
123700                    WHERE A.TRN_NBR          = :DK-PO-NBR         12370000
123800                      AND  A.RCVR_SEQ_NBR     = :DK-RECEIVER      12380000
123900                      AND  A.SHIPT_UNT_ID     =  B.SHIPT_UNT_ID   12390000
124000                      AND  B.DEST_LOC_NBR     = :DK-STR-NBR       12400000
124100                      AND  B.CART_SRC_CDE     =  'SMO'            12410000
124200                      AND  B.ACTV_IND         = :DK-ACTV-IND-SMTH)12420000
124300             GROUP BY  CRE_DTE,  CRE_TM                           12430000
124400             ORDER BY  CRE_DTE,  CRE_TM DESC                      12440000
124500     END-EXEC.                                                    12450000
124600                                                                  12460000
124700                                                                  12470000
124800*---------------------------------------------------------------* 12480000
124900* CURSOR FOR DETERMINING NBR OF STORES, MAX CARTONS & MAX UNITS   12490000
125000*---------------------------------------------------------------* 12500000
125100     EXEC SQL                                                     12510000
125200          DECLARE CTN_UNT_CSR CURSOR FOR                          12520000
125300          SELECT STR_NBR                                          12530000
125400                ,MAX(CART_NBR)                                    12540000
125500                ,SUM(UNT_QTY)                                     12550000
125600          FROM   SUT_SMOOTHING_PRC                                12560000
125700          WHERE  SMTHG_PRC_ID = :PC204-SMTHG-PRC-ID               12570000
125800          GROUP BY STR_NBR                                        12580000
125900     END-EXEC.                                                    12590000
126000                                                                  12600000
126100*---------------------------------------------------------------* 12610000
126200                                                                  12620000
126300                                                                  12630000
126400 LINKAGE SECTION.                                                 12640000
126500                                                                  12650000
126600 01  DFHCOMMAREA.                                                 12660000
126700     05  FILLER                         OCCURS  1 TO 4072 TIMES   12670000
126800                                        DEPENDING ON EIBCALEN.    12680000
126900         10  FILLER                     PIC X.                    12690000
127000                                                                  12700000
127100 PROCEDURE DIVISION.                                              12710000
127200******************************************************************12720000
127300**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **12730000
127400**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **12740000
127500**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **12750000
127600******************************************************************12760000
127700 0000-MAIN-MODULE.                                                12770000
127800     INITIALIZE DP030-CICS-API-FIELDS.                            12780000
127900     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       12790000
128000     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          12800000
128100     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         12810000
128200     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       12820000
128300     MOVE LENGTH OF PCK710I        TO DP030-MAP-LENGTH (1).       12830000
128400     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     12840000
128500     PERFORM 0001-CALL-CICS-ARCH-API.                             12850000
128600                                                                  12860000
128700     PERFORM 1000-CONTROL-PROCESSING                              12870000
128800                                                                  12880000
128900     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     12890000
129000     PERFORM 0001-CALL-CICS-ARCH-API.                             12900000
129100                                                                  12910000
129200******************************************************************12920000
129300**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **12930000
129400**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **12940000
129500******************************************************************12950000
129600 0001-CALL-CICS-ARCH-API.                                         12960000
1122rm*    CALL 'DPKCS030' USING DFHEIBLK                               12970016
1122RM     CALL DP930-CICS-ARCH-API                                     12971016
1122RM                     USING DFHEIBLK                               12972016
129800                           DFHCOMMAREA                            12980000
129900                           DP030-CICS-API-FIELDS                  12990000
130000                           DP020-STANDARD-COMMAREA                13000000
130100                           PCK710I.                               13010000
130200                                                                  13020000
130300     IF  DP030-RC-CALL-SUCCESSFUL                                 13030000
130400         CONTINUE                                                 13040000
130500     ELSE                                                         13050000
130600         SET DP013-NO-ROLLBACK                                    13060000
130700             DP013-XCTL-DISPLAY-RESTART                           13070000
130800             DP013-CICS-ABEND      TO TRUE                        13080000
130900         MOVE '0001-CALL-CICS-ARCH-API'                           13090000
131000                                   TO DP013-PARAGRAPH             13100000
1122rm*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX13110017
1122rm*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      13120016
1122rm         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O13121017
1122RM-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      13122016
131300         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      13130000
131400         PERFORM DP013-0000-PROCESS-ABEND                         13140000
131500     END-IF.                                                      13150000
131600*----------------------------------------------------------------*13160000
131700* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *13170000
131800* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *13180000
131900*                                                                *13190000
132000* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *13200000
132100*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *13210000
132200*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *13220000
132300*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *13230000
132400*----------------------------------------------------------------*13240000
132500                                                                  13250000
132600 1000-CONTROL-PROCESSING.                                         13260000
132700                                                                  13270000
132800     EVALUATE TRUE                                                13280000
132900         WHEN DP020-NEXT-ACT-INITIAL                              13290000
133000             INITIALIZE ASC-SPECIFIC-COMMAREA                     13300000
133100             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            13310000
133200                                      ASC-SEL-TERM-ID             13320000
133300             MOVE DP020-SRC-TASK-NUMBER                           13330000
133400                                   TO ASC-LIST-TASK-NUMBER        13340000
133500                                      ASC-SEL-TASK-NUMBER         13350000
133600             MOVE PC-LIST-QUEUE-SEQ                               13360000
133700                                   TO ASC-LIST-SEQ                13370000
133800             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                 13380000
133900             PERFORM 1100-PROCESS-INTER-APPL-COMM                 13390000
134000***-----$TEMPLATE NOTE$-------------------------------------------13400000
134100*** IF THE DATA EXPECTED IS NOT RECEIVED FROM CALLING APPLICATION,13410000
134200*** SETUP APPROPRIATE MESSAGE AND SEVERITY AND SET APPL-ERROR TO  13420000
134300*** TRUE, THIS WILL RETURN TO CALLING APPLICATION WHEN API CALLED.13430000
134400***---------------------------------------------------------------13440000
134500             PERFORM 4000-BUILD-INITIAL-PANEL                     13450000
134600                                                                  13460000
134700         WHEN DP020-NEXT-ACT-READ-MAP                             13470000
134800             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        13480000
134900                                   TO PV-TOP-ITEM                 13490000
135000             PERFORM 2000-PROCESS-PANEL                           13500000
135100                                                                  13510000
135200         WHEN DP020-NEXT-ACT-RETURN                               13520000
135300             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        13530000
135400                                   TO PV-TOP-ITEM                 13540000
135500             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    13550000
135600             PERFORM 6000-REFRESH-PANEL-FROM-TEMP                 13560000
135700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 13570000
135800                                                                  13580000
135900         WHEN OTHER                                               13590000
136000             SET DP013-LOGIC-ABEND TO TRUE                        13600000
136100             SET DP013-NO-ROLLBACK TO TRUE                        13610000
136200             MOVE '1000-CONTROL-PROCESSING'                       13620000
136300                                   TO DP013-PARAGRAPH             13630000
136400             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    13640000
136500                                   TO DP013-MESSAGE-TEXT(1)       13650000
136600             PERFORM DP013-0000-PROCESS-ABEND                     13660000
136700     END-EVALUATE.                                                13670000
136800                                                                  13680000
136900*----------------------------------------------------------------*13690000
137000* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *13700000
137100* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *13710000
137200*----------------------------------------------------------------*13720000
137300                                                                  13730000
137400 1100-PROCESS-INTER-APPL-COMM.                                    13740000
137500                                                                  13750000
137600     SET PS-COMMAREA-VALID          TO TRUE.                      13760000
137700     MOVE SPACE                     TO ASC-START-ITEM-REQUEST.    13770000
137800     IF  DP020-INT-APPL-FORMAT-IND = PC-CRIT-SPEC-FORMAT          13780000
137900                                                                  13790000
138000         MOVE PC201-OPER-UNT-ID     TO ASC-OPER-UNT-ID            13800000
138100         MOVE PC201-FCLTY-ID        TO ASC-FCLTY-ID               13810000
138200         MOVE PC201-SML-PRTR-ID     TO ASC-SML-PRINTER            13820000
138300         MOVE PC201-PO-NBR          TO PV-PO-NBR-N                13830000
138400                                       DK-PO-NBR                  13840000
138500         MOVE PV-PO-NBR             TO ASC-PO-NBR                 13850000
138600         MOVE PC201-REC-SEQ-NBR     TO PV-RECEIVER-N              13860000
138700                                       DK-REC-SEQ-NBR             13870000
138800                                       DK-RECEIVER                13880000
138900                                       ASC-REC-SEQ-NBR            13890000
139000         MOVE PV-RECEIVER           TO ASC-RECEIVER               13900000
139100         PERFORM 4150-GET-DEPT-VENDOR                             13910000
139200         IF PC201-UCC128-DATA-IND  = 'Y'                          13920000
139300            MOVE PC-UCC128-EXISTS   TO ASC-UCC128-EXISTS          13930000
139400            MOVE  'Y'               TO ASC-UCC128-EXISTS-IND      13940000
139500         END-IF                                                   13950000
139600         IF PC201-RECEIVER-TROUBLE-YES                            13960000
139700            SET ASC-RCVR-TRBLE-EXISTS-YES TO TRUE                 13970000
139800         ELSE                                                     13980000
139900            SET ASC-RCVR-TRBLE-EXISTS-NO TO TRUE                  13990000
140000         END-IF                                                   14000000
140100     END-IF.                                                      14010000
140200                                                                  14020000
140300******************************************************************14030000
140400 1120-PREPARE-LIST-ENTRY.                                         14040000
140500                                                                  14050000
140600     MOVE PC203-MAX-ITEMS          TO ASC-SEL-SUB.                14060000
140700     MOVE ZERO                     TO ASC-SEL-ITEM.               14070000
140800     PERFORM 1130-GET-NEXT-RECORD.                                14080000
140900                                                                  14090000
141000******************************************************************14100000
141100*    GET THE NEXT RECORD IF A LIST OF RECORDS ARE BEING PROCESSED*14110000
141200******************************************************************14120000
141300 1130-GET-NEXT-RECORD.                                            14130000
141400                                                                  14140000
141500     ADD +1                       TO ASC-SEL-SUB.                 14150000
141600                                                                  14160000
141700     IF  ASC-SEL-SUB > PC203-MAX-ITEMS                            14170000
141800         ADD +1                   TO ASC-SEL-ITEM                 14180000
141900         MOVE +1                  TO ASC-SEL-SUB                  14190000
142000     END-IF.                                                      14200000
142100                                                                  14210000
142200     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                14220000
142300         PERFORM 9100-READ-SEL-QUEUE                              14230000
142400         IF  PC203-ITEM (ASC-SEL-SUB) > ZERO                      14240000
142500                                                                  14250000
142600             SET PC203-INQ (ASC-SEL-SUB)                          14260000
142700                                  TO TRUE                         14270000
142800             PERFORM 9200-REWRITE-SEL-QUEUE                       14280000
142900         ELSE                                                     14290000
143000             SUBTRACT +1 FROM ASC-SEL-SUB                         14300000
143100             MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER             14310000
143200             SET DP020-MSG-INFORMATIONAL                          14320000
143300                 PS-LIST-END             TO TRUE                  14330000
143400         END-IF                                                   14340000
143500     ELSE                                                         14350000
143600         SUBTRACT +1 FROM ASC-SEL-ITEM                            14360000
143700         MOVE PC203-MAX-ITEMS     TO ASC-SEL-SUB                  14370000
143800         MOVE PC-TSYMSG-00070     TO DP020-MSG-NUMBER             14380000
143900             SET DP020-MSG-INFORMATIONAL                          14390000
144000                 PS-LIST-END             TO TRUE                  14400000
144100     END-IF.                                                      14410000
144200                                                                  14420000
144300******************************************************************14430000
144400*    GET THE PREVIOUS RECORD IF A LIST OF RECORDS ARE BEING      *14440000
144500*    PROCESSED.                                                  *14450000
144600******************************************************************14460000
144700 1140-GET-PREV-RECORD.                                            14470000
144800                                                                  14480000
144900     SUBTRACT +1 FROM ASC-SEL-SUB.                                14490000
145000                                                                  14500000
145100     IF  ASC-SEL-SUB < +1                                         14510000
145200         SUBTRACT +1 FROM ASC-SEL-ITEM                            14520000
145300         MOVE PC203-MAX-ITEMS     TO ASC-SEL-SUB                  14530000
145400     END-IF.                                                      14540000
145500                                                                  14550000
145600     IF  ASC-SEL-ITEM > ZERO                                      14560000
145700         PERFORM 9100-READ-SEL-QUEUE                              14570000
145800         SET PC203-INQ (ASC-SEL-SUB)                              14580000
145900                                  TO TRUE                         14590000
146000         PERFORM 9200-REWRITE-SEL-QUEUE                           14600000
146100     ELSE                                                         14610000
146200         MOVE +1                  TO ASC-SEL-ITEM                 14620000
146300                                     ASC-SEL-SUB                  14630000
146400         MOVE PC-TSYMSG-00069     TO DP020-MSG-NUMBER             14640000
146500             SET DP020-MSG-INFORMATIONAL                          14650000
146600                 PS-LIST-END             TO TRUE                  14660000
146700     END-IF.                                                      14670000
146800                                                                  14680000
146900*----------------------------------------------------------------*14690000
147000* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *14700000
147100* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *14710000
147200* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *14720000
147300* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *14730000
147400* FUNCTION KEYS CAN GET THIS FAR.                                *14740000
147500*----------------------------------------------------------------*14750000
147600 2000-PROCESS-PANEL.                                              14760000
147700     EVALUATE TRUE                                                14770000
147800         WHEN DP020-SRC-AID = DP016-CLEAR                         14780000
147900             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    14790000
148000             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   14800000
148100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 14810000
148200                                                                  14820000
148300         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    14830000
148400             MOVE ASC-OPER-UNT-ID   TO DK-OPER-UNT-ID             14840000
148500             MOVE ASC-FCLTY-ID      TO DK-FCLTY-ID                14850000
148600             SET ASC-NO-CONFIRM-UCC128  TO TRUE                   14860000
148700             PERFORM 2050-DELETE-LIST-QUEUE                       14870000
148800             PERFORM 4000-BUILD-INITIAL-PANEL                     14880000
148900                                                                  14890000
149000         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    14900000
149100             PERFORM 2140-DESELECT-ALL-ITEMS                      14910000
149200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 14920000
149300                                                                  14930000
149400         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  14940000
149500             PERFORM 2150-SELECT-ALL-ITEMS                        14950000
149600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 14960000
149700                                                                  14970000
149800         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             14980000
149900           IF  ASC-USE-SELECTION-QUEUE                            14990000
150000               PERFORM 1130-GET-NEXT-RECORD                       15000000
150100               IF PS-LIST-END                                     15010000
150200                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN           15020000
150300                   SET PS-NO-LIST-END TO TRUE                     15030000
150400               ELSE                                               15040000
150500                   PERFORM 2050-DELETE-LIST-QUEUE                 15050000
150600                   PERFORM 3200-RESET-ATTRIBUTES                  15060000
150700                   PERFORM 4000-BUILD-INITIAL-PANEL               15070000
150800               END-IF                                             15080000
150900            ELSE                                                  15090000
151000               PERFORM 4400-MOVE-COMMAREA-TO-SCREEN               15100000
151100*              --- BOTTOM OF LIST ---                             15110000
151200               MOVE PC-TSYMSG-00070                               15120000
151300                                 TO DP020-MSG-NUMBER              15130000
151400               SET DP020-MSG-INFORMATIONAL                        15140000
151500                                 TO TRUE                          15150000
151600           END-IF                                                 15160000
151700                                                                  15170000
151800         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             15180000
151900           IF  ASC-USE-SELECTION-QUEUE                            15190000
152000               PERFORM 1140-GET-PREV-RECORD                       15200000
152100               IF PS-LIST-END                                     15210000
152200                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN           15220000
152300                   SET PS-NO-LIST-END                             15230000
152400                                 TO TRUE                          15240000
152500               ELSE                                               15250000
152600                   PERFORM 2050-DELETE-LIST-QUEUE                 15260000
152700                   PERFORM 3200-RESET-ATTRIBUTES                  15270000
152800                   PERFORM 4000-BUILD-INITIAL-PANEL               15280000
152900               END-IF                                             15290000
153000           ELSE                                                   15300000
153100               PERFORM 4400-MOVE-COMMAREA-TO-SCREEN               15310000
153200               MOVE PC-TSYMSG-00069                               15320000
153300                                 TO DP020-MSG-NUMBER              15330000
153400               SET DP020-MSG-INFORMATIONAL                        15340000
153500                                 TO TRUE                          15350000
153600           END-IF                                                 15360000
153700                                                                  15370000
153800         WHEN OTHER                                               15380000
153900             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 15390000
154000             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   15400000
154100                                                                  15410000
154200             IF  PS-NO-ERROR                                      15420000
154300                 SET DP030-CONTINUE-GO                            15430000
154400                                 TO TRUE                          15440000
154500                 PERFORM 2100-CHECK-FUNCTION-KEY                  15450000
154600             ELSE                                                 15460000
154700*** dmh 9/23/08 - begin                                           15470000
154701             IF  PS-ERROR  AND                                    15470100
154702                 ASC-PREVIOUS-SMOOTH-YES                          15470200
154703                 PERFORM 2050-DELETE-LIST-QUEUE                   15470300
154704                 PERFORM 3200-RESET-ATTRIBUTES                    15470400
154705                 PERFORM 4000-BUILD-INITIAL-PANEL                 15470500
154706                                                                  15470600
154707                 MOVE PC-TSYMSG-03625   TO DP020-MSG-NUMBER       15470700
154708                 SET DP020-MSG-FATAL    TO TRUE                   15470800
154709                 SET DP030-SET-CURSOR-APPL-1                      15470900
154710                                      TO TRUE                     15471000
154720                 SET ASC-PREVIOUS-SMOOTH-NO  TO  TRUE             15472000
154730*** dmh 9/23/08 - end                                             15473000
154740             ELSE                                                 15474000
154750                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             15475000
154760                 SET DP030-OVERRIDE-GO                            15476000
154770                                 TO TRUE                          15477000
154780             END-IF                                               15478000
154790             END-IF                                               15479000
154800     END-EVALUATE.                                                15480000
154900                                                                  15490000
155000*----------------------------------------------------------------*15500000
155100*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *15510000
155200*----------------------------------------------------------------*15520000
155300 2050-DELETE-LIST-QUEUE.                                          15530000
155400                                                                  15540000
155500     EXEC CICS                                                    15550000
155600         DELETEQ TS                                               15560000
155700             QUEUE (ASC-LIST-QUEUE-NAME)                          15570000
155800             RESP  (PV-CICS-RESP)                                 15580000
155900     END-EXEC.                                                    15590000
156000                                                                  15600000
156100     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       15610000
156200        (PV-CICS-RESP = DFHRESP(QIDERR))                          15620000
156300         CONTINUE                                                 15630000
156400     ELSE                                                         15640000
156500         SET DP013-CICS-ABEND      TO TRUE                        15650000
156600         SET DP013-NO-ROLLBACK     TO TRUE                        15660000
156700                                                                  15670000
156800         MOVE '2050-DELETE-LIST-QUEUE'                            15680000
156900                                   TO DP013-PARAGRAPH             15690000
157000         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    15700000
157100                                   TO DP013-MESSAGE-TEXT (1)      15710000
157200         PERFORM DP013-0000-PROCESS-ABEND                         15720000
157300     END-IF.                                                      15730000
157400                                                                  15740000
157500     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  15750000
157600                                                                  15760000
157700*----------------------------------------------------------------*15770000
157800* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*15780000
157900* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *15790000
158000* CICS ARCHITECTURE API.                                         *15800000
158100*----------------------------------------------------------------*15810000
158200***********************************                               15820000
158300* F13 - CTNRCLST    (LOCAL-FUNC-01)                               15830000
158400***********************************                               15840000
158500                                                                  15850000
158600 2100-CHECK-FUNCTION-KEY.                                         15860000
158700     SET PC202-UPDATE-TSQ TO TRUE.                                15870000
158800     EVALUATE TRUE                                                15880000
158900***RE-ACTIVATE ON LIST*** (LOCAL UPDATE)                          15890000
159000         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              15900000
159100             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              15910000
159200***check receiver type - cannot smooth if ap type                 15920000
159300                 PERFORM 4260-GET-RECEIVER-TYPE                   15930000
159400                 IF  RECEIV-REC-TYP-CDE = 'AP'                    15940000
159500                     SET PS-ERROR                                 15950000
159600                         DP020-MSG-FATAL  TO TRUE                 15960000
159700                     MOVE PC-TSYMSG-03362 TO DP020-MSG-NUMBER     15970000
159800                     SET DP030-SET-CURSOR-APPL-1 TO TRUE          15980000
159900                 END-IF                                           15990000
160000                                                                  16000000
160100                 IF PS-NO-ERROR                                   16010000
160200                    PERFORM 4600-PROCESS-PRINT-FUNCTION           16020000
160300                       VARYING PV-ITEM  FROM 1 BY 1               16030000
160400                       UNTIL PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN  16040000
160500                       OR PS-ERROR                                16050000
160600                    IF PS-ERROR                                   16060000
160700                       EVALUATE TRUE                              16070000
160800                          WHEN PS-SMOOTHING-ACTV                  16080000
160900                             MOVE PC-TSYMSG-02678                 16090000
161000                                            TO DP020-MSG-NUMBER   16100000
161100                          WHEN PS-INACTV-SMTH-NOT-FND             16110000
161200                             MOVE PC-TSYMSG-02679                 16120000
161300                                            TO DP020-MSG-NUMBER   16130000
161400                          WHEN PS-INVLD-CRTN-COUNT                16140000
161500                             MOVE PV-DB2-COUNT-INACTV             16150000
161600                                            TO DP020-MSG-TEXT     16160000
161700                             MOVE PC-TSYMSG-02680                 16170000
161800                                            TO DP020-MSG-NUMBER   16180000
161900                          WHEN PS-INVALID-UNIT-COUNT              16190000
162000                             MOVE PC-TSYMSG-02764                 16200000
162100                                            TO DP020-MSG-NUMBER   16210000
162200                        END-EVALUATE                              16220000
162300                        PERFORM 4400-MOVE-COMMAREA-TO-SCREEN      16230000
162400                        SET DP030-OVERRIDE-GO                     16240000
162500                                          TO TRUE                 16250000
162600                        SET DP020-MSG-WARNING                     16260000
162700                                          TO TRUE                 16270000
162800                    ELSE                                          16280000
162900                        MOVE PC-TSYMSG-02681                      16290000
163000                                            TO DP020-MSG-NUMBER   16300000
163100                        SET DP030-OVERRIDE-GO                     16310000
163200                                          TO TRUE                 16320000
163300                        SET DP020-MSG-WARNING                     16330000
163400                                          TO TRUE                 16340000
163500                        PERFORM 4400-MOVE-COMMAREA-TO-SCREEN      16350000
163600                    END-IF                                        16360000
163700                 END-IF                                           16370000
163800             ELSE                                                 16380000
163900                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             16390000
164000                 SET DP030-OVERRIDE-GO                            16400000
164100                                   TO TRUE                        16410000
164200                 MOVE PC-TSYMSG-00057                             16420000
164300                                   TO DP020-MSG-NUMBER            16430000
164400                 SET DP020-MSG-WARNING                            16440000
164500                                   TO TRUE                        16450000
164600             END-IF                                               16460000
164700                                                                  16470000
164800****F15 ADDLCTN**(PCKCS711)                                       16480000
164900         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              16490000
165000             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              16500000
165100                 INITIALIZE PC202-INTER-APPL-COMMAREA             16510000
165200                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                16520000
165300                                TO PC202-NUMBER-OF-SELECTED-ITEMS 16530000
165400                 MOVE ASC-OPER-UNT-ID                             16540000
165500                                TO PC202-OPER-UNT-ID              16550000
165600                 MOVE ASC-FCLTY-ID                                16560000
165700                                TO PC202-FCLTY-ID                 16570000
165800                 MOVE ASC-PO-NBR                                  16580000
165900                                TO PC202-PO-NBR                   16590000
166000                                   DK-PO-NBR                      16600000
166100                 MOVE ASC-REC-SEQ-NBR                             16610000
166200                                TO PC202-REC-SEQ-NBR              16620000
166300                                   DK-RECEIVER                    16630000
166400                 MOVE ASC-SML-PRINTER                             16640000
166500                                TO PC202-SML-PRINTER              16650000
166600                 MOVE PV-SHP-PRTR-ID-ADDR                         16660000
166700                                TO PC202-SHP-PRTR-IP-ADDR         16670000
166800                                                                  16680000
166900                 PERFORM 5000-PREPARE-SEL-QUEUE                   16690000
167000                 IF PS-SMOOTHING-INACTV                           16700000
167100                     SET DP030-OVERRIDE-GO                        16710000
167200                                       TO TRUE                    16720000
167300                     MOVE PC-TSYMSG-02684                         16730000
167400                                       TO DP020-MSG-NUMBER        16740000
167500                     SET DP020-MSG-WARNING                        16750000
167600                                       TO TRUE                    16760000
167700                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         16770000
167800                 END-IF                                           16780000
167900             ELSE                                                 16790000
168000                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             16800000
168100                 SET DP030-OVERRIDE-GO                            16810000
168200                                   TO TRUE                        16820000
168300                 MOVE PC-TSYMSG-00057                             16830000
168400                                   TO DP020-MSG-NUMBER            16840000
168500                 SET DP020-MSG-WARNING                            16850000
168600                                   TO TRUE                        16860000
168700             END-IF                                               16870000
168800                                                                  16880000
168900****F16 *INACTIVATE SMOOTHED CARTONS                              16890000
169000         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              16900000
169100             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              16910000
169200                 PERFORM 4600-PROCESS-PRINT-FUNCTION              16920000
169300                     VARYING PV-ITEM  FROM 1 BY 1                 16930000
169400                     UNTIL PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN    16940000
169500                 IF PS-INACTV-SMTH-NOT-FND                        16950000
169600                    PERFORM 4400-MOVE-COMMAREA-TO-SCREEN          16960000
169700                    SET DP030-OVERRIDE-GO                         16970000
169800                                      TO TRUE                     16980000
169900                    MOVE PC-TSYMSG-02684                          16990000
170000                                      TO DP020-MSG-NUMBER         17000000
170100                    SET DP020-MSG-WARNING                         17010000
170200                                      TO TRUE                     17020000
170300                 END-IF                                           17030000
170400             ELSE                                                 17040000
170500                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             17050000
170600                 SET ASC-NO-TSQ-UPDATE TO TRUE                    17060000
170700                 SET DP030-OVERRIDE-GO                            17070000
170800                                   TO TRUE                        17080000
170900                 MOVE PC-TSYMSG-00057                             17090000
171000                                   TO DP020-MSG-NUMBER            17100000
171100                 SET DP020-MSG-WARNING                            17110000
171200                                   TO TRUE                        17120000
171300             END-IF                                               17130000
171400                                                                  17140000
171500****F17 *CARTON LIST                                              17150000
171600         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              17160000
171700             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              17170000
171800                 INITIALIZE PC202-INTER-APPL-COMMAREA             17180000
171900                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                17190000
172000                                TO PC202-NUMBER-OF-SELECTED-ITEMS 17200000
172100                                                                  17210000
172200                 MOVE ASC-OPER-UNT-ID                             17220000
172300                                 TO  PC202-OPER-UNT-ID            17230000
172400                 MOVE ASC-FCLTY-ID                                17240000
172500                                 TO  PC202-FCLTY-ID               17250000
172600                 MOVE ASC-PO-NBR                                  17260000
172700                                 TO  PC202-PO-NBR                 17270000
172800                 MOVE ASC-REC-SEQ-NBR                             17280000
172900                                 TO PC202-REC-SEQ-NBR             17290000
173000                 MOVE ASC-SML-PRINTER                             17300000
173100                                TO PC202-SML-PRINTER              17310000
173200                 PERFORM 5000-PREPARE-SEL-QUEUE                   17320000
173300                 SET ASC-FUNC04-RETURN-YES TO TRUE                17330000
173400             ELSE                                                 17340000
173500                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             17350000
173600                 SET DP030-OVERRIDE-GO                            17360000
173700                                   TO TRUE                        17370000
173800                 MOVE PC-TSYMSG-00057                             17380000
173900                                   TO DP020-MSG-NUMBER            17390000
174000                 SET DP020-MSG-WARNING                            17400000
174100                                   TO TRUE                        17410000
174200             END-IF                                               17420000
174300                                                                  17430000
174400****F18 - TROUBLE LIST                                            17440000
174500         WHEN DP020-FK-LOCAL-FUNC-09 (DP020-SRC-AID)              17450000
174600             INITIALIZE RC012-INTER-APPL-COMMAREA                 17460000
174700             MOVE ASC-OPER-UNT-ID TO RC012-OPER-UNT-ID            17470000
174800             MOVE ASC-FCLTY-ID    TO RC012-FCLTY-ID               17480000
174900             MOVE ASC-PO-NBR      TO RC012-PO-NBR                 17490000
175000             MOVE ASC-REC-SEQ-NBR TO RC012-REC-SEQ-NBR            17500000
175100                                                                  17510000
175200****F20 **PSLHDINQ     ** (RC2PKSL)                               17520000
175300         WHEN DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)              17530000
175400             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              17540000
175500                 INITIALIZE RC015-INTER-APPL-COMMAREA             17550000
175600                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                17560000
175700                                TO RC015-NUMBER-OF-SELECTED-ITEMS 17570000
175800                 MOVE ASC-OPER-UNT-ID                             17580000
175900                                TO RC015-OPER-UNT-ID              17590000
176000                                   DK-OPER-UNT-ID                 17600000
176100                 MOVE ASC-FCLTY-ID                                17610000
176200                                TO RC015-FCLTY-ID                 17620000
176300                                   DK-FCLTY-ID                    17630000
176400                 MOVE ASC-PO-NBR                                  17640000
176500                                TO RC015-PO-NBR                   17650000
176600                                   DK-PO-NBR                      17660000
176700                                                                  17670000
176800                 PERFORM 5000-PREPARE-SEL-QUEUE                   17680000
176900                 SET ASC-FUNC05-RETURN-YES TO TRUE                17690000
177000                 IF PS-RECEIVER-DOESNT-EXIST                      17700000
177100                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         17710000
177200                     SET DP030-OVERRIDE-GO                        17720000
177300                                       TO TRUE                    17730000
177400                     MOVE PC-TSYMSG-02479                         17740000
177500                                       TO DP020-MSG-NUMBER        17750000
177600                     SET DP020-MSG-WARNING                        17760000
177700                                       TO TRUE                    17770000
177800                 END-IF                                           17780000
177900             ELSE                                                 17790000
178000                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             17800000
178100                 SET DP030-OVERRIDE-GO                            17810000
178200                                   TO TRUE                        17820000
178300                 MOVE PC-TSYMSG-00057                             17830000
178400                                   TO DP020-MSG-NUMBER            17840000
178500                 SET DP020-MSG-WARNING                            17850000
178600                                   TO TRUE                        17860000
178700             END-IF                                               17870000
178800                                                                  17880000
178900****F22 **PSLNSUM ** (RCKCS215)                                   17890000
179000         WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)              17900000
179100             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              17910000
179200                 INITIALIZE RC015-INTER-APPL-COMMAREA             17920000
179300                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                17930000
179400                                TO RC015-NUMBER-OF-SELECTED-ITEMS 17940000
179500                 MOVE ASC-OPER-UNT-ID                             17950000
179600                                TO RC015-OPER-UNT-ID              17960000
179700                 MOVE ASC-FCLTY-ID                                17970000
179800                                TO RC015-FCLTY-ID                 17980000
179900                 MOVE ASC-PO-NBR                                  17990000
180000                                TO RC015-PO-NBR                   18000000
180100                                   DK-PO-NBR                      18010000
180200                 PERFORM 5000-PREPARE-SEL-QUEUE                   18020000
180300                 SET ASC-FUNC06-RETURN-YES TO TRUE                18030000
180400                 IF PS-RECEIVER-DOESNT-EXIST                      18040000
180500                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         18050000
180600                     SET DP030-OVERRIDE-GO                        18060000
180700                                       TO TRUE                    18070000
180800                     MOVE PC-TSYMSG-02479                         18080000
180900                                       TO DP020-MSG-NUMBER        18090000
181000                     SET DP020-MSG-WARNING                        18100000
181100                                       TO TRUE                    18110000
181200                 END-IF                                           18120000
181300             ELSE                                                 18130000
181400                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             18140000
181500                 SET DP030-OVERRIDE-GO                            18150000
181600                                   TO TRUE                        18160000
181700                 MOVE PC-TSYMSG-00057                             18170000
181800                                   TO DP020-MSG-NUMBER            18180000
181900                 SET DP020-MSG-WARNING                            18190000
182000                                   TO TRUE                        18200000
182100             END-IF                                               18210000
182200                                                                  18220000
182300****F23 **SMOOTH AND PRINT (PCKCS728)                             18230000
182400         WHEN DP020-FK-LOCAL-FUNC-07 (DP020-SRC-AID)              18240000
182500             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              18250000
182600                 MOVE ZEROES TO PV-NUMBER-STORES-PROCESSED        18260000
182700                 IF PS-NO-ERROR                                   18270000
182800                     PERFORM 7000-CREATE-RANDOM-NBR               18280000
182900*                    PERFORM 8400-CHECK-AUTOVE                    18290000
183000                     IF PS-NO-ERROR                               18300000
183100                         PERFORM 4600-PROCESS-PRINT-FUNCTION      18310000
183200                           VARYING PV-ITEM  FROM 1 BY 1           18320000
183300                         UNTIL PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN18330000
183400                           OR PS-ERROR                            18340000
183500                           IF PV-NUMBER-STORES-PROCESSED > 0      18350000
183600                              AND PS-NO-ERROR                     18360000
183700                                PERFORM 4650-ISSUE-PRINT-REQ      18370000
183800                                IF PS-AUTO-VE-YES                 18380000
183900                                   IF ASC-TROUBLE-CREATE-YES      18390000
184000                                      PERFORM 8650-CREATE-TROUBLE 18400000
184100                                   END-IF                         18410000
184200                                END-IF                            18420000
184300                           END-IF                                 18430000
184400*                        IF PS-NO-ERROR                           18440000
184500*                            MOVE PC-TSYMSG-02683                 18450000
184600*                                              TO DP020-MSG-NUMBER18460000
184700*                            SET DP020-MSG-INFORMATIONAL  TO  TRUE18470000
184800*                            SET ASC-CONFIRM-UCC128 TO TRUE       18480000
184900*                        END-IF                                   18490000
185000                         SET DP020-MSG-INFORMATIONAL  TO  TRUE    18500000
185100                         MOVE PC-TSYMSG-02234 TO DP020-MSG-NUMBER 18510000
185200                         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN     18520000
185300                     END-IF                                       18530000
185400                 END-IF                                           18540000
185500             ELSE                                                 18550000
185600                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             18560000
185700                 SET DP030-OVERRIDE-GO TO TRUE                    18570000
185800                 MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER        18580000
185900                 SET DP020-MSG-WARNING TO TRUE                    18590000
186000             END-IF                                               18600000
186100***                                                               18610000
186200***F24  REPRINT LABELS FOR STORE                                  18620000
186300                                                                  18630000
186400         WHEN DP020-FK-LOCAL-FUNC-08 (DP020-SRC-AID)              18640000
186500             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              18650000
186600                 INITIALIZE PC204-INTER-APPL-COMMAREA             18660000
186700                 MOVE ASC-SML-PRINTER                             18670000
186800                                TO PC204-SML-PRINTER              18680000
186900                 MOVE PV-SHP-PRTR-ID-ADDR                         18690000
187000                                TO PC204-SHP-PRTR-IP-ADDR         18700000
187100                 PERFORM 7000-CREATE-RANDOM-NBR                   18710000
187200                 MOVE  ASC-NUMBER-OF-SELECTED-ITEMS               18720000
187300                                TO  PC204-TOT-STORES-REQ          18730000
187400                 PERFORM 5000-PREPARE-SEL-QUEUE                   18740000
187500                 IF  PS-INVALID-REPRINT-STATUS                    18750000
187600                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         18760000
187700                     SET DP030-OVERRIDE-GO                        18770000
187800                                       TO TRUE                    18780000
187900                     MOVE PC-TSYMSG-02691                         18790000
188000                                       TO DP020-MSG-NUMBER        18800000
188100                     SET DP020-MSG-WARNING                        18810000
188200                                       TO TRUE                    18820000
188300                 ELSE                                             18830000
188400                     SET ASC-FUNC08-RETURN-YES TO TRUE            18840000
188500                     MOVE PV-TOTAL-LBS-COUNT                      18850000
188600                                   TO PC204-TOT-LABELS-CNT        18860000
188700                     PERFORM 4650-ISSUE-PRINT-REQ                 18870000
188800                     PERFORM 6000-REFRESH-PANEL-FROM-TEMP         18880000
188900                     IF PS-NO-ERROR                               18890000
189000                        SET DP020-MSG-INFORMATIONAL  TO  TRUE     18900000
189100                        MOVE PC-TSYMSG-02234  TO DP020-MSG-NUMBER 18910000
189200                     END-IF                                       18920000
189300                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         18930000
189400                 END-IF                                           18940000
189500             ELSE                                                 18950000
189600                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             18960000
189700                 SET DP030-OVERRIDE-GO                            18970000
189800                                   TO TRUE                        18980000
189900                 MOVE PC-TSYMSG-00057                             18990000
190000                                   TO DP020-MSG-NUMBER            19000000
190100                 SET DP020-MSG-WARNING                            19010000
190200                                   TO TRUE                        19020000
190300             END-IF                                               19030000
190400*                                                                 19040000
190500                                                                  19050000
190600*F2=CONFIRM                                                       19060000
190700         WHEN DP020-FK-CONFIRM (DP020-SRC-AID)                    19070000
190800***check receiver type - cannot smooth if ap type                 19080000
190900           PERFORM 4260-GET-RECEIVER-TYPE                         19090000
191000           IF  RECEIV-REC-TYP-CDE = 'AP'                          19100000
191100               SET PS-ERROR                                       19110000
191200                   DP020-MSG-FATAL  TO TRUE                       19120000
191300               MOVE PC-TSYMSG-03362 TO DP020-MSG-NUMBER           19130000
191400               SET DP030-SET-CURSOR-APPL-1 TO TRUE                19140000
191500           END-IF                                                 19150000
191600                                                                  19160000
191700           EVALUATE TRUE                                          19170000
191800              WHEN ASC-CONFIRM-UCC128                             19180000
191900                   PERFORM 7000-CREATE-RANDOM-NBR                 19190000
192000**slh                                                             19200000
192100                   MOVE ASC-PO-NBR TO DK-PO-NBR                   19210000
192200                   MOVE ASC-REC-SEQ-NBR                           19220000
192300                                TO DK-REC-SEQ-NBR                 19230000
192400                   PERFORM 8400-CHECK-AUTOVE                      19240000
192500                   IF PS-NO-ERROR                                 19250000
192600**slh                                                             19260000
192700                      PERFORM 4600-PROCESS-PRINT-FUNCTION         19270000
192800                        VARYING PV-ITEM  FROM 1 BY 1              19280000
192900                        UNTIL PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN 19290000
193000                        OR PS-ERROR                               19300000
193100                   END-IF                                         19310000
193200                   IF PS-NO-ERROR                                 19320000
193300**slh                                                             19330000
193400                        IF PV-NUMBER-STORES-PROCESSED > 0         19340000
193500**slh                                                             19350000
193600                        PERFORM 4650-ISSUE-PRINT-REQ              19360000
193700**slh                                                             19370000
193800                        IF PS-AUTO-VE-YES                         19380000
193900                           IF ASC-TROUBLE-CREATE-YES              19390000
194000                              PERFORM 8650-CREATE-TROUBLE         19400000
194100                           END-IF                                 19410000
194200                        END-IF                                    19420000
194300                        END-IF                                    19430000
194400**slh                                                             19440000
194500                        SET DP020-MSG-INFORMATIONAL  TO  TRUE     19450000
194600                        MOVE PC-TSYMSG-02234  TO DP020-MSG-NUMBER 19460000
194700                   END-IF                                         19470000
194800                   SET ASC-NO-CONFIRM-UCC128  TO TRUE             19480000
194900                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN           19490000
195000              WHEN ASC-CONFIRM-INACTV                             19500000
195100                   PERFORM 4600-PROCESS-PRINT-FUNCTION            19510000
195200                       VARYING PV-ITEM  FROM 1 BY 1               19520000
195300                       UNTIL PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN  19530000
195400                   IF PS-INACTV-SMTH-NOT-FND                      19540000
195500                      PERFORM 4400-MOVE-COMMAREA-TO-SCREEN        19550000
195600                      SET DP030-OVERRIDE-GO                       19560000
195700                                        TO TRUE                   19570000
195800                      MOVE PC-TSYMSG-02684                        19580000
195900                                        TO DP020-MSG-NUMBER       19590000
196000                      SET DP020-MSG-WARNING                       19600000
196100                                        TO TRUE                   19610000
196200                   END-IF                                         19620000
196300                   SET ASC-NO-CONFIRM-INACTV TO TRUE              19630000
196400                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN           19640000
196500             WHEN OTHER                                           19650000
196600                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             19660000
196700                 SET ASC-NO-CONFIRM-UCC128  TO TRUE               19670000
196800*LMM                                                              19680000
196900                 SET ASC-NO-CONFIRM-INACTV  TO TRUE               19690000
197000                 SET DP030-OVERRIDE-GO                            19700000
197100                                   TO TRUE                        19710000
197200                 MOVE PC-TSYMSG-00045                             19720000
197300                                   TO DP020-MSG-NUMBER            19730000
197400                 SET DP020-MSG-WARNING                            19740000
197500                                   TO TRUE                        19750000
197600           END-EVALUATE                                           19760000
197700                                                                  19770000
197800*                                                                 19780000
197900* F6 - FIRST PAGE                                                 19790000
198000*                                                                 19800000
198100         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  19810000
198200             MOVE +1               TO PV-TOP-ITEM                 19820000
198300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 19830000
198400*                                                                 19840000
198500* F7 - PREVIOUS PAGE                                              19850000
198600*                                                                 19860000
198700         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   19870000
198800             PERFORM 2110-BROWSE-BACKWARD                         19880000
198900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 19890000
199000*                                                                 19900000
199100* F8 - NEXT PAGE                                                  19910000
199200*                                                                 19920000
199300         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   19930000
199400             PERFORM 2120-BROWSE-FORWARD                          19940000
199500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 19950000
199600*                                                                 19960000
199700* ENTER KEY                                                       19970000
199800*                                                                 19980000
199900         WHEN DP020-SRC-AID = DP016-ENTER                         19990000
200000             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   20000000
200100             IF  PS-ERROR                                         20010000
200200                 CONTINUE                                         20020000
200300             ELSE                                                 20030000
200400*                PERFORM 3200-RESET-ATTRIBUTES                    20040000
200500                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             20050000
200600             END-IF                                               20060000
200700                                                                  20070000
200800         WHEN OTHER                                               20080000
200900             SET DP013-NO-ROLLBACK                                20090000
201000                 DP013-XCTL-DISPLAY-RESTART                       20100000
201100                 DP013-CICS-ABEND  TO TRUE                        20110000
201200             MOVE '2100-CHECK-FUNCTION-KEY'                       20120000
201300                                   TO DP013-PARAGRAPH             20130000
201400             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      20140000
201500                                   TO DP013-MESSAGE-TEXT (1)      20150000
201600             PERFORM DP013-0000-PROCESS-ABEND                     20160000
201700     END-EVALUATE.                                                20170000
201800*                                                                 20180000
201900*LMM                                                              20190000
202000*----------------------------------------------------------------*20200000
202100* CHECK TO SEE IF USER HAS RACF AUTHORIZATION FOR INACTIVATE     *20210000
202200* SMOOTHING FUNCTION (F16=IN-ACTVE).                             *20220000
202300*----------------------------------------------------------------*20230000
202400 2105-RACF-ACCESS.                                                20240000
202500                                                                  20250000
202600      SET DP008-RSRC-TYPE-FUNC           TO TRUE                  20260000
202700      SET DP008-ACCESS-TYPE-USE          TO TRUE                  20270000
202800                                                                  20280000
202900      EXEC CICS                                                   20290000
203000         LINK PROGRAM (DP008-SECURITY-SUBROUTINE)                 20300000
203100              COMMAREA (DP008-SECURITY-COMMAREA)                  20310000
203200              LENGTH (DP008-SECURITY-COMMAREA-LENGTH)             20320000
203300      END-EXEC                                                    20330000
203400                                                                  20340000
203500      IF DP008-CALL-SUCCESSFUL                                    20350000
203600         IF DP008-ACCESS-ALLOWED                                  20360000
203700             SET PS-INACTV-ALLOWED TO TRUE                        20370000
203800         ELSE                                                     20380000
203900             SET PS-INACTV-NOT-ALLOWED TO TRUE                    20390000
204000         END-IF                                                   20400000
204100     ELSE                                                         20410000
204200         MOVE '2105-RACF-ACCESS'                                  20420000
204300                               TO DP013-PARAGRAPH                 20430000
204400          MOVE 'UNABLE TO ACCESS CICS'                            20440000
204500                               TO DP013-MESSAGE-TEXT (1)          20450000
204600          MOVE SQLCA                 TO DP013-SQLCA               20460000
204700          SET DP013-DB2-ABEND                                     20470000
204800              DP013-XCTL-DISPLAY-RESTART                          20480000
204900                               TO TRUE                            20490000
205000          PERFORM DP013-0000-PROCESS-ABEND                        20500000
205100      END-IF.                                                     20510000
205200                                                                  20520000
205300                                                                  20530000
205400*----------------------------------------------------------------*20540000
205500*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *20550000
205600*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *20560000
205700*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *20570000
205800*    MESSAGE.                                                    *20580000
205900*----------------------------------------------------------------*20590000
206000                                                                  20600000
206100 2110-BROWSE-BACKWARD.                                            20610000
206200     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    20620000
206300         GIVING PV-TOP-ITEM.                                      20630000
206400                                                                  20640000
206500     IF  ((PV-TOP-ITEM < +1)                                      20650000
206600       OR (PV-TOP-ITEM = +1))                                     20660000
206700         MOVE +1                   TO PV-TOP-ITEM                 20670000
206800*        -- TOP OF LIST --                                        20680000
206900         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            20690000
207000         SET DP020-MSG-INFORMATIONAL TO TRUE                      20700000
207100     END-IF.                                                      20710000
207200                                                                  20720000
207300*----------------------------------------------------------------*20730000
207400*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *20740000
207500*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *20750000
207600*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *20760000
207700*----------------------------------------------------------------*20770000
207800                                                                  20780000
207900 2120-BROWSE-FORWARD.                                             20790000
208000                                                                  20800000
208100     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              20810000
208200         GIVING PV-TOP-ITEM.                                      20820000
208300     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   20830000
208400         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            20840000
208500                                   TO PV-TOP-ITEM                 20850000
208600*        -- BOTTOM OF LIST --                                     20860000
208700         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            20870000
208800         SET DP020-MSG-INFORMATIONAL                              20880000
208900                                   TO TRUE                        20890000
209000     ELSE                                                         20900000
209100         COMPUTE PV-BOTTOM-ITEM =                                 20910000
209200             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 20920000
209300         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            20930000
209400*            -- BOTTOM OF LIST --                                 20940000
209500             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            20950000
209600             SET DP020-MSG-INFORMATIONAL                          20960000
209700                                   TO TRUE                        20970000
209800         END-IF                                                   20980000
209900     END-IF.                                                      20990000
210000                                                                  21000000
210100*----------------------------------------------------------------*21010000
210200*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *21020000
210300*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *21030000
210400*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *21040000
210500*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *21050000
210600*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *21060000
210700*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *21070000
210800*----------------------------------------------------------------*21080000
210900                                                                  21090000
211000 2130-CHECK-FOR-JUMP-BROWSE.                                      21100000
211100     SET PS-NO-ERROR               TO TRUE.                       21110000
211200     IF (ASC-START-ITEM-REQUEST = SPACE)                          21120000
211300         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            21130000
211400                                   TO PV-TOP-ITEM                 21140000
211500     ELSE                                                         21150000
211600         MOVE ASC-START-ITEM-REQUEST                              21160000
211700                                   TO DP010I-UNEDITED-FIELD       21170000
211800         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       21180000
211900         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     21190000
212000         SET DP010I-NEGATIVE-NOT-ALLOWED                          21200000
212100                                   TO TRUE                        21210000
212210         CALL DP010I-NUMERIC-EDIT-ROUTINE                         21221013
212220                         USING DP010I-NUMERIC-EDIT-AREA           21222013
212300                                                                  21230000
212400         IF  NOT DP010I-ERROR-DETECTED                            21240000
212500             MOVE DP010I-NUMERIC-FIELD                            21250000
212600                                   TO  ASC-START-ITEM-REQUEST-N   21260000
212700             IF  ASC-START-ITEM-REQUEST-N > ZERO                  21270000
212800                 IF  ASC-START-ITEM-REQUEST-N >                   21280000
212900                                          ASC-NUMBER-OF-ITEMS-READ21290000
213000                     MOVE SPACE TO ASC-START-ITEM-REQUEST         21300000
213100                     COMPUTE PV-TOP-ITEM =                        21310000
213200                             ASC-NUMBER-OF-ITEMS-READ             21320000
213300                             - PC-ITEMS-PER-PANEL + 1             21330000
213400                     IF  PV-TOP-ITEM < +1                         21340000
213500                         MOVE +1   TO PV-TOP-ITEM                 21350000
213600                         MOVE PC-TSYMSG-00070                     21360000
213700                                   TO DP020-MSG-NUMBER            21370000
213800                         SET DP020-MSG-INFORMATIONAL              21380000
213900                                   TO TRUE                        21390000
214000                     END-IF                                       21400000
214100                 ELSE                                             21410000
214200                     MOVE ASC-START-ITEM-REQUEST-N                21420000
214300                                   TO PV-TOP-ITEM                 21430000
214400                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      21440000
214500                     COMPUTE PV-BOTTOM-ITEM =                     21450000
214600                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     21460000
214700                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ21470000
214800*                        -- BOTTOM OF LIST --                     21480000
214900                         MOVE PC-TSYMSG-00070                     21490000
215000                                   TO DP020-MSG-NUMBER            21500000
215100                         SET DP020-MSG-INFORMATIONAL              21510000
215200                                   TO TRUE                        21520000
215300                     END-IF                                       21530000
215400                 END-IF                                           21540000
215500             ELSE                                                 21550000
215600*                --- VALUE OUT OF RANGE ----                      21560000
215700                 MOVE PC-TSYMSG-00101                             21570000
215800                                   TO DP020-MSG-NUMBER            21580000
215900                 MOVE -1           TO ASTRTITL                    21590000
216000                 SET DP030-SET-CURSOR-APPL-1                      21600000
216100                                   TO TRUE                        21610000
216200                 MOVE DP015-REVERSE                               21620000
216300                                   TO ASTRTITH                    21630000
216400                 MOVE DP015-RED    TO ASTRTITC                    21640000
216500                 MOVE DP015-UNP-NUM-BRT-MDT                       21650000
216600                                   TO ASTRTITA                    21660000
216700                 SET DP020-MSG-FATAL                              21670000
216800                                   TO TRUE                        21680000
216900                 SET PS-ERROR      TO TRUE                        21690000
217000             END-IF                                               21700000
217100                                                                  21710000
217200         ELSE                                                     21720000
217300             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            21730000
217400             MOVE -1               TO ASTRTITL                    21740000
217500             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  21750000
217600             MOVE DP015-REVERSE    TO ASTRTITH                    21760000
217700             MOVE DP015-RED        TO ASTRTITC                    21770000
217800             MOVE DP015-UNP-NUM-BRT-MDT                           21780000
217900                                   TO ASTRTITA                    21790000
218000             SET DP020-MSG-FATAL   TO TRUE                        21800000
218100             SET PS-ERROR          TO TRUE                        21810000
218200         END-IF                                                   21820000
218300     END-IF.                                                      21830000
218400                                                                  21840000
218500*----------------------------------------------------------------*21850000
218600*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *21860000
218700*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *21870000
218800*----------------------------------------------------------------*21880000
218900 2140-DESELECT-ALL-ITEMS.                                         21890000
219000     MOVE +1                       TO ASC-BLK-SUB.                21900000
219100                                                                  21910000
219200     PERFORM 2141-CLEAR-SELECTED-INDS                             21920000
219300         VARYING ASC-ITEM-SUB                                     21930000
219400         FROM 1 BY 1                                              21940000
219500         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 21950000
219600                                                                  21960000
219700     ADD +1                        TO ASC-BLK-SUB.                21970000
219800                                                                  21980000
219900     PERFORM 2141-CLEAR-SELECTED-INDS                             21990000
220000         VARYING ASC-ITEM-SUB                                     22000000
220100         FROM 1 BY 1                                              22010000
220200         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 22020000
220300                                                                  22030000
220400     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               22040000
220500                                   TO PV-LIST-ITEM-NUMBER.        22050000
220600                                                                  22060000
220700     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            22070000
220800         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    22080000
220900                                                                  22090000
221000     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     22100000
221100        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      22110000
221200         MOVE +1                   TO ASC-BLK-SUB                 22120000
221300                                                                  22130000
221400         PERFORM 5100-WRITE-TEMP-STORAGE                          22140000
221500                                                                  22150000
221600         MOVE +1                   TO PV-BLOCK-NUMBER             22160000
221700                                                                  22170000
221800         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         22180000
221900             PV-FIRST-BLOCK-IN-ARRAY - 1                          22190000
222000                                                                  22200000
222100         PERFORM                                                  22210000
222200             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       22220000
222300                                                                  22230000
222400             PERFORM 4410-READ-TEMP-STORAGE                       22240000
222500                                                                  22250000
222600             PERFORM 2141-CLEAR-SELECTED-INDS                     22260000
222700                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 22270000
222800                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          22280000
222900                                                                  22290000
223000             PERFORM 5100-WRITE-TEMP-STORAGE                      22300000
223100                                                                  22310000
223200             ADD +1                TO PV-BLOCK-NUMBER             22320000
223300                                                                  22330000
223400         END-PERFORM                                              22340000
223500                                                                  22350000
223600         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         22360000
223700             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     22370000
223800                                                                  22380000
223900         PERFORM                                                  22390000
224000             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       22400000
224100                   ASC-HIGHEST-BLOCK-WRITTEN                      22410000
224200                                                                  22420000
224300             MOVE PV-NEXT-BLOCK-IN-ARRAY                          22430000
224400                                   TO PV-BLOCK-NUMBER             22440000
224500                                                                  22450000
224600             PERFORM 4410-READ-TEMP-STORAGE                       22460000
224700                                                                  22470000
224800             PERFORM 2141-CLEAR-SELECTED-INDS                     22480000
224900                 VARYING ASC-ITEM-SUB                             22490000
225000                 FROM 1 BY 1                                      22500000
225100                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          22510000
225200                                                                  22520000
225300             PERFORM 5100-WRITE-TEMP-STORAGE                      22530000
225400                                                                  22540000
225500             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      22550000
225600                                                                  22560000
225700         END-PERFORM                                              22570000
225800                                                                  22580000
225900         MOVE PV-FIRST-BLOCK-IN-ARRAY                             22590000
226000                                   TO PV-BLOCK-NUMBER             22600000
226100                                                                  22610000
226200         PERFORM 4410-READ-TEMP-STORAGE                           22620000
226300     END-IF.                                                      22630000
226400                                                                  22640000
226500                                                                  22650000
226600     MOVE +0                     TO ASC-NUMBER-OF-SELECTED-ITEMS. 22660000
226700     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE.22670000
226800     MOVE +0                       TO ASC-END-OF-SELECTED-RANGE.  22680000
226900                                                                  22690000
227000*GB  PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        22700000
227100*3/23                                                             22710000
227200                                                                  22720000
227300*----------------------------------------------------------------*22730000
227400*    MARK EACH ITEM AS BEING NOT SELECTED.                       *22740000
227500*----------------------------------------------------------------*22750000
227600                                                                  22760000
227700 2141-CLEAR-SELECTED-INDS.                                        22770000
227800                                                                  22780000
227900     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           22790000
228000             NOT EQUAL ZERO                                       22800000
228100         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          22810000
228200             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          22820000
228300                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    22830000
228400                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  22840000
228500                                   TO TRUE                        22850000
228600         END-IF                                                   22860000
228700     END-IF.                                                      22870000
228800                                                                  22880000
228900                                                                  22890000
229000*----------------------------------------------------------------*22900000
229100*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *22910000
229200*  FOR ALL ITEMS.                                                *22920000
229300*----------------------------------------------------------------*22930000
229400                                                                  22940000
229500 2150-SELECT-ALL-ITEMS.                                           22950000
229600                                                                  22960000
229700     MOVE +1                       TO ASC-BLK-SUB.                22970000
229800                                                                  22980000
229900     PERFORM 2151-SET-SELECTED-INDS                               22990000
230000         VARYING ASC-ITEM-SUB                                     23000000
230100         FROM 1 BY 1                                              23010000
230200         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 23020000
230300                                                                  23030000
230400     ADD +1                        TO ASC-BLK-SUB.                23040000
230500                                                                  23050000
230600     PERFORM 2151-SET-SELECTED-INDS                               23060000
230700         VARYING ASC-ITEM-SUB                                     23070000
230800         FROM 1 BY 1                                              23080000
230900         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 23090000
231000                                                                  23100000
231100     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               23110000
231200                                   TO PV-LIST-ITEM-NUMBER.        23120000
231300                                                                  23130000
231400     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            23140000
231500         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    23150000
231600                                                                  23160000
231700*10/13/00- BEGIN                                                  23170000
231800     IF  PV-FIRST-BLOCK-IN-ARRAY  = +1                            23180000
231900         MOVE +1                   TO ASC-BLK-SUB                 23190000
232000                                                                  23200000
232100         PERFORM 5100-WRITE-TEMP-STORAGE                          23210000
232200         MOVE +2                   TO ASC-BLK-SUB                 23220000
232300         PERFORM 5100-WRITE-TEMP-STORAGE                          23230000
232400         MOVE +1                   TO ASC-BLK-SUB                 23240000
232500         MOVE +1                   TO PV-BLOCK-NUMBER             23250000
232600     END-IF.                                                      23260000
232700* 10/13/00 END                                                    23270000
232800     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     23280000
232900        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    23290000
233000         MOVE +1                   TO ASC-BLK-SUB                 23300000
233100                                                                  23310000
233200         PERFORM 5100-WRITE-TEMP-STORAGE                          23320000
233300                                                                  23330000
233400         MOVE +1                   TO PV-BLOCK-NUMBER             23340000
233500                                                                  23350000
233600         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         23360000
233700             PV-FIRST-BLOCK-IN-ARRAY - 1                          23370000
233800                                                                  23380000
233900         PERFORM                                                  23390000
234000             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       23400000
234100                                                                  23410000
234200             PERFORM 4410-READ-TEMP-STORAGE                       23420000
234300                                                                  23430000
234400             PERFORM 2151-SET-SELECTED-INDS                       23440000
234500                 VARYING ASC-ITEM-SUB                             23450000
234600                 FROM 1 BY 1                                      23460000
234700                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          23470000
234800                                                                  23480000
234900             PERFORM 5100-WRITE-TEMP-STORAGE                      23490000
235000                                                                  23500000
235100             ADD +1                TO PV-BLOCK-NUMBER             23510000
235200                                                                  23520000
235300         END-PERFORM                                              23530000
235400                                                                  23540000
235500         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         23550000
235600             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     23560000
235700                                                                  23570000
235800         PERFORM                                                  23580000
235900             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       23590000
236000                   ASC-HIGHEST-BLOCK-WRITTEN                      23600000
236100                                                                  23610000
236200             MOVE PV-NEXT-BLOCK-IN-ARRAY                          23620000
236300                                   TO PV-BLOCK-NUMBER             23630000
236400                                                                  23640000
236500             PERFORM 4410-READ-TEMP-STORAGE                       23650000
236600                                                                  23660000
236700             PERFORM 2151-SET-SELECTED-INDS                       23670000
236800                 VARYING ASC-ITEM-SUB                             23680000
236900                 FROM 1 BY 1                                      23690000
237000                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          23700000
237100                                                                  23710000
237200             PERFORM 5100-WRITE-TEMP-STORAGE                      23720000
237300                                                                  23730000
237400             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      23740000
237500                                                                  23750000
237600         END-PERFORM                                              23760000
237700                                                                  23770000
237800         MOVE PV-FIRST-BLOCK-IN-ARRAY                             23780000
237900                                   TO PV-BLOCK-NUMBER             23790000
238000                                                                  23800000
238100         PERFORM 4410-READ-TEMP-STORAGE                           23810000
238200     END-IF.                                                      23820000
238300                                                                  23830000
238400                                                                  23840000
238500     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             23850000
238600                       ASC-NUMBER-OF-SELECTED-ITEMS.              23860000
238700                                                                  23870000
238800     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        23880000
238900                                                                  23890000
239000*----------------------------------------------------------------*23900000
239100*    MARK EACH ITEM AS BEING SELECTED.                           *23910000
239200*----------------------------------------------------------------*23920000
239300 2151-SET-SELECTED-INDS.                                          23930000
239400                                                                  23940000
239500     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           23950000
239600             NOT EQUAL ZERO                                       23960000
239700         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             23970000
239800             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             23980000
239900                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        23990000
240000                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  24000000
240100                               TO  TRUE                           24010000
240200         END-IF                                                   24020000
240300     END-IF.                                                      24030000
240400                                                                  24040000
240500******************************************************************24050000
240600** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **24060000
240700** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **24070000
240800******************************************************************24080000
240900 2200-MOVE-SCREEN-TO-COMMAREA.                                    24090000
241000                                                                  24100000
241100     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             24110000
241200     MOVE +1                       TO PV-SUB.                     24120000
241300                                                                  24130000
241400     PERFORM 3100-SET-SUBSCRIPTS.                                 24140000
241500     IF  ASTRTITL > ZERO                                          24150000
241600         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          24160000
241700     ELSE                                                         24170000
241800         IF  ASTRTITF = DP015-ERASE-EOF                           24180000
241900             INITIALIZE ASC-START-ITEM-REQUEST                    24190000
242000         END-IF                                                   24200000
242100     END-IF.                                                      24210000
242200     IF  APRTRL > ZERO                                            24220000
242300         MOVE APRTRI           TO ASC-SML-PRINTER                 24230000
242400     ELSE                                                         24240000
242500         IF  APRTRF   = DP015-ERASE-EOF                           24250000
242600             MOVE ZERO         TO ASC-SML-PRINTER                 24260000
242700         END-IF                                                   24270000
242800     END-IF.                                                      24280000
242900     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          24290000
243000         VARYING PV-SUB                                           24300000
243100         FROM 1 BY 1                                              24310000
243200         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      24320000
243300******************************************************************24330000
243400** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**24340000
243500******************************************************************24350000
243600 2210-MOVE-LINES-TO-COMMAREA.                                     24360000
243700     IF  MR-SELECTL (PV-SUB) > ZERO                               24370000
243800         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             24380000
243900         MOVE MR-SELECTI (PV-SUB)                                 24390000
244000                                   TO ASC-TEMP-SELECTED-SW        24400000
244100                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      24410000
244200     ELSE                                                         24420000
244300         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                24430000
244400                 SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     24440000
244500                 MOVE SPACE        TO ASC-TEMP-SELECTED-SW        24450000
244600                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      24460000
244700         END-IF                                                   24470000
244800     END-IF.                                                      24480000
244900                                                                  24490000
245000     PERFORM 2215-MOVE-FIELDS-TO-COMMAREA.                        24500000
245100                                                                  24510000
245200     ADD +1                        TO ASC-ITEM-SUB.               24520000
245300     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        24530000
245400         IF  ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                     24540000
245500             COMPUTE PV-BLOCK-NUMBER  =                           24550000
245600                1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /         24560000
245700                    PC-ITEMS-PER-PANEL                            24570000
245800             PERFORM 5105-REWRITE-ASC-LISTQ                       24580000
245900         END-IF                                                   24590000
246000         ADD +1                    TO ASC-BLK-SUB                 24600000
246100         MOVE +1                   TO ASC-ITEM-SUB                24610000
246200     ELSE                                                         24620000
246300     IF  PV-SUB = ASC-ITEMS-DISPLAYED                             24630000
246400         IF  ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                     24640000
246500             COMPUTE PV-BLOCK-NUMBER  =                           24650000
246600                1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /         24660000
246700                    PC-ITEMS-PER-PANEL                            24670000
246800             PERFORM 5105-REWRITE-ASC-LISTQ                       24680000
246900         END-IF                                                   24690000
247000     END-IF.                                                      24700000
247100*----------------------------------------------------------------*24710000
247200*                                                                 24720000
247300*----------------------------------------------------------------*24730000
247400 2215-MOVE-FIELDS-TO-COMMAREA.                                    24740000
247500*                                                                 24750000
247600*                                                                 24760000
247700*** CARTON COUNT                                                  24770000
247800*                                                                 24780000
247900     IF  MR-NBR-CARTONSL (PV-SUB) > ZERO                          24790000
248000         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             24800000
248100         MOVE MR-NBR-CARTONS (PV-SUB) TO                          24810000
248200                                    DP010I-UNEDITED-FIELD         24820000
248300         MOVE LENGTH OF MR-NBR-CARTONS                            24830000
248400                                 TO DP010I-MAXIMUM-DIGITS         24840000
248500         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       24850000
248600         SET DP010I-NEGATIVE-NOT-ALLOWED                          24860000
248700                                 TO TRUE                          24870000
248810             CALL DP010I-NUMERIC-EDIT-ROUTINE                     24881013
248820                         USING DP010I-NUMERIC-EDIT-AREA           24882013
248900             IF  DP010I-ERROR-DETECTED                            24890000
249000                 CONTINUE                                         24900000
249100             ELSE                                                 24910000
249200                 SUBTRACT ASC-NBR-CARTONS                         24920000
249300                                    (ASC-BLK-SUB ASC-ITEM-SUB)    24930000
249400                              FROM ASC-TOTAL-CART                 24940000
249500                 MOVE DP010I-NUMERIC-FIELD                        24950000
249600                                     TO ASC-NBR-CARTONS           24960000
249700                                       (ASC-BLK-SUB ASC-ITEM-SUB) 24970000
249800                                        MR-NBR-CARTONS (PV-SUB)   24980000
249900                                        PV-TOT-CART-COUNT         24990000
250000                 ADD  PV-TOT-CART-COUNT                           25000000
250100                                   TO  ASC-TOTAL-CART             25010000
250200                                                                  25020000
250300             END-IF                                               25030000
250400     ELSE                                                         25040000
250500         IF  MR-NBR-CARTONSA (PV-SUB) = DP015-ERASE-EOF           25050000
250600             SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE         25060000
250700             MOVE ZEROES       TO ASC-NBR-CARTONS                 25070000
250800                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      25080000
250900         END-IF                                                   25090000
251000     END-IF.                                                      25100000
251100                                                                  25110000
251200                                                                  25120000
251300     IF  PS-NO-ERROR                                              25130000
251400         IF  ASC-SML-PRINTER > SPACES                             25140000
251500                 INITIALIZE  PV-SHP-PRTR-CLUSTER-NBR              25150000
251600                             PV-SHP-PRTR-ID-ADDR                  25160000
251700                             PV-SHP-PRTR-OS-RLSE-CDE              25170000
251800                             PV-SHP-DATA-XFER-MODE-ID             25180000
251900                 MOVE ASC-SML-PRINTER   TO                        25190000
252000                                          APRTRO                  25200000
252100                                          DP072-PRINTER-ID        25210000
252200                 MOVE PC-REPORT-PGM-1     TO DP072-RPT-PGM-NME    25220000
252300                 PERFORM 3010-VALIDATE-PRINTER                    25230000
252400                 IF  PS-NO-ERROR                                  25240000
252500                   PERFORM 3020-VALIDATE-PRINTER-ID-SML           25250000
252600                   MOVE  DP072-PRTR-CLUSTER-NBR                   25260000
252700                                    TO PV-SHP-PRTR-CLUSTER-NBR    25270000
252800                   MOVE  DP072-PRTR-IP-ADDRESS                    25280000
252900                                    TO PV-SHP-PRTR-ID-ADDR        25290000
253000                   MOVE  DP072-PRTR-CLUSTER-OS-RLSE-CDE           25300000
253100                                    TO PV-SHP-PRTR-OS-RLSE-CDE    25310000
253200                   MOVE  DP072-PRTR-DATA-XFER-MODE-ID             25320000
253300                                    TO PV-SHP-DATA-XFER-MODE-ID   25330000
253400                   MOVE  DP072-XMIT-INTFC-CDE                     25340000
253500                                    TO PV-SHP-XMIT-INTFC-CDE      25350000
253600                   MOVE  DP072-PRTR-TYP-CDE                       25360000
253700                                    TO PV-SHP-PRTR-TYP-CDE        25370000
253800                 END-IF                                           25380000
253900         END-IF                                                   25390000
254000     END-IF.                                                      25400000
254100******************************************************************25410000
254200** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **25420000
254300** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **25430000
254400******************************************************************25440000
254500 3000-EDIT-DATA-IN-COMMAREA.                                      25450000
254600     SET PS-NO-ERROR               TO TRUE.                       25460000
254700     PERFORM 3200-RESET-ATTRIBUTES.                               25470000
254800     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     25480000
254900**                                                                25490000
255000* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              25500000
255100* EDITTING IS DONE FROM THE BOTTOM UP.                            25510000
255200**                                                                25520000
255300     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       25530000
255400         ASC-ITEMS-DISPLAYED - 1.                                 25540000
255500     PERFORM 3100-SET-SUBSCRIPTS.                                 25550000
255600                                                                  25560000
255700******************************************************************25570000
255800***CHECK TO SEE IF THERE IS A DUMMY TRIP                          25580000
255900******************************************************************25590000
256000     IF PS-NO-ERROR                                               25600000
256100         PERFORM 8475-CHECK-FOR-DUMMY-TRIP                        25610000
256200         IF PS-ERROR                                              25620000
256300              SET  DP020-MSG-FATAL TO TRUE                        25630000
256400              MOVE PC-TSYMSG-03399 TO DP020-MSG-NUMBER            25640000
256500              MOVE -1              TO MR-SELECTL (PV-SUB)         25650000
256600              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 25660000
256700         ELSE                                                     25670000
256800             PERFORM 8480-CHECK-FOR-TRIP-STATUS                   25680000
256900             IF PS-ERROR                                          25690000
257000                  SET  DP020-MSG-FATAL TO TRUE                    25700000
257100                  MOVE PC-TSYMSG-03401 TO DP020-MSG-NUMBER        25710000
257200                  MOVE -1              TO MR-SELECTL (PV-SUB)     25720000
257300                  SET DP030-SET-CURSOR-APPL-1 TO TRUE             25730000
257400             END-IF                                               25740000
257500         END-IF                                                   25750000
257600     END-IF.                                                      25760000
257700                                                                  25770000
257800     IF  PS-NO-ERROR                                              25780000
257900         PERFORM 3005-EDIT-COMMAREA-BLOCKS                        25790000
258000     END-IF.                                                      25800000
258100                                                                  25810000
258200     IF  PS-NO-ERROR                                              25820000
258300         PERFORM 3400-CHECK-RANGE-SEQUENCE                        25830000
258400     END-IF.                                                      25840000
258500                                                                  25850000
258600     IF  ((PS-NO-ERROR)                                           25860000
258700       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   25870000
258800       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    25880000
258900             PERFORM 3500-MARK-RANGE-AS-SELECTED                  25890000
259000     END-IF.                                                      25900000
259100                                                                  25910000
259200*----------------------------------------------------------------*25920000
259300*   3005-EDIT-COMMAREA-BLOCKS                                    *25930000
259400*----------------------------------------------------------------*25940000
259500 3005-EDIT-COMMAREA-BLOCKS.                                       25950000
259600     MOVE +1                       TO PV-BLOCK-NUMBER.            25960000
259700     MOVE +1                       TO ASC-BLK-SUB.                25970000
259800     MOVE PC-ITEMS-PER-PANEL       TO ASC-ITEM-SUB.               25980000
259900                                                                  25990000
260000     COMPUTE PV-BLOCK-NUMBER  =                                   26000000
260100        1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /                 26010000
260200            PC-ITEMS-PER-PANEL.                                   26020000
260300                                                                  26030000
260400     MOVE  PV-BLOCK-NUMBER         TO PV-ORIGINAL-BLOCK.          26040000
260500                                                                  26050000
260600     PERFORM                                                      26060000
260700       UNTIL PV-BLOCK-NUMBER > ASC-HIGHEST-BLOCK-WRITTEN          26070000
260800          OR PS-ERROR                                             26080000
260900          OR PS-BLOCK-ERROR                                       26090000
261000                                                                  26100000
261100             COMPUTE PV-ITEMS-HOLD  =                             26110000
261200                     ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +        26120000
261300                     PC-ITEMS-PER-PANEL - 1                       26130000
261400                                                                  26140000
261500             IF  PV-ITEMS-HOLD  >  ASC-NUMBER-OF-ITEMS-READ       26150000
261600                 SUBTRACT  ASC-NUMBER-OF-ITEMS-READ               26160000
261700                     FROM  PV-ITEMS-HOLD                          26170000
261800                   GIVING  PV-ITEMS-DIFF                          26180000
261900                 SUBTRACT  PV-ITEMS-DIFF                          26190000
262000                     FROM  PC-ITEMS-PER-PANEL                     26200000
262100                   GIVING  PV-ITEMS-HOLD                          26210000
262200                     MOVE  PV-ITEMS-HOLD  TO  PV-SUB              26220000
262300                                              ASC-ITEM-SUB        26230000
262400                                              ASC-ITEMS-DISPLAYED 26240000
262500             ELSE                                                 26250000
262600                 MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB              26260000
262700                 MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB        26270000
262800             END-IF                                               26280000
262900                                                                  26290000
263000             SET PS-UCC128-DATA-NO    TO TRUE                     26300000
263100             PERFORM 3300-EDIT-SELECTIONS                         26310000
263200                     VARYING PV-SUB                               26320000
263300                        FROM PV-SUB BY -1                         26330000
263400                       UNTIL PV-SUB < +1                          26340000
263500             IF PS-NO-ERROR AND                                   26350000
263600               PS-UCC128-DATA-YES                                 26360000
263700                 SET  PS-ERROR                                    26370000
263800                      DP020-MSG-FATAL TO TRUE                     26380000
263900                 MOVE PC-TSYMSG-02683 TO DP020-MSG-NUMBER         26390000
264000                 SET  DP030-SET-CURSOR-APPL-1 TO TRUE             26400000
264010                 SET PS-BLOCK-ERROR   TO TRUE                     26401000
264020                 SET ASC-CONFIRM-UCC128 TO TRUE                   26402000
264030             END-IF                                               26403000
264040                                                                  26404000
264050             MOVE +1               TO ASC-BLK-SUB                 26405000
264060                                                                  26406000
264070             PERFORM 5105-REWRITE-ASC-LISTQ                       26407000
264080                                                                  26408000
264090             MOVE +1                TO ASC-BLK-SUB                26409000
264100                                                                  26410000
264200             IF  PS-BLOCK-ERROR                                   26420000
264300                 SET  PS-ERROR     TO TRUE                        26430000
264400                 MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)        26440000
264500                                   TO PV-TOP-ITEM                 26450000
264600             ELSE                                                 26460000
264700                 ADD  +1           TO PV-BLOCK-NUMBER             26470000
264800                 IF  PV-BLOCK-NUMBER >                            26480000
264900                     ASC-HIGHEST-BLOCK-WRITTEN                    26490000
265000                     MOVE +2       TO ASC-BLK-SUB                 26500000
265100                     PERFORM 4410-READ-TEMP-STORAGE               26510000
265200                     MOVE +1       TO ASC-BLK-SUB                 26520000
265300                 ELSE                                             26530000
265400                     PERFORM 4410-READ-TEMP-STORAGE               26540000
265500                     ADD  +1        TO PV-BLOCK-NUMBER            26550000
265600                     MOVE +2        TO ASC-BLK-SUB                26560000
265700                     PERFORM 4410-READ-TEMP-STORAGE               26570000
265800                     SUBTRACT +1  FROM PV-BLOCK-NUMBER            26580000
265900                     MOVE +1        TO ASC-BLK-SUB                26590000
266000                 END-IF                                           26600000
266100             END-IF                                               26610000
266200     END-PERFORM.                                                 26620000
266300                                                                  26630000
266400     IF  PV-ORIGINAL-BLOCK  = +1    OR                            26640000
266500         PS-ERROR                   OR                            26650000
266600         PS-BLOCK-ERROR                                           26660000
266700         CONTINUE                                                 26670000
266800     ELSE                                                         26680000
266900         MOVE +1                 TO PV-BLOCK-NUMBER               26690000
267000         MOVE +1                 TO ASC-BLK-SUB                   26700000
267100         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  26710000
267200         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEMS-DISPLAYED           26720000
267300         PERFORM 4410-READ-TEMP-STORAGE                           26730000
267400                                                                  26740000
267500         PERFORM                                                  26750000
267600           UNTIL PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK              26760000
267700              OR PS-ERROR                                         26770000
267800              OR PS-BLOCK-ERROR                                   26780000
267900                                                                  26790000
268000                 COMPUTE PV-ITEMS-HOLD  =                         26800000
268100                         ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +    26810000
268200                         PC-ITEMS-PER-PANEL - 1                   26820000
268300                                                                  26830000
268400                 IF  PV-ITEMS-HOLD > ASC-NUMBER-OF-ITEMS-READ     26840000
268500                     SUBTRACT  ASC-NUMBER-OF-ITEMS-READ           26850000
268600                         FROM  PV-ITEMS-HOLD                      26860000
268700                       GIVING  PV-ITEMS-DIFF                      26870000
268800                     SUBTRACT  PV-ITEMS-DIFF                      26880000
268900                         FROM  PC-ITEMS-PER-PANEL                 26890000
269000                       GIVING  PV-ITEMS-HOLD                      26900000
269100                         MOVE  PV-ITEMS-HOLD TO PV-SUB            26910000
269200                                                ASC-ITEM-SUB      26920000
269300                                               ASC-ITEMS-DISPLAYED26930000
269400                 ELSE                                             26940000
269500                     MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB          26950000
269600                     MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB    26960000
269700                 END-IF                                           26970000
269800                                                                  26980000
269900                 SET PS-UCC128-DATA-NO    TO TRUE                 26990000
270000                 PERFORM 3300-EDIT-SELECTIONS                     27000000
270100                         VARYING PV-SUB                           27010000
270200                            FROM PV-SUB BY -1                     27020000
270300                           UNTIL PV-SUB < +1                      27030000
270400                 IF PS-NO-ERROR AND                               27040000
270500                   PS-UCC128-DATA-YES                             27050000
270600                     SET  PS-ERROR                                27060000
270700                          DP020-MSG-FATAL TO TRUE                 27070000
270800                     MOVE PC-TSYMSG-02683 TO DP020-MSG-NUMBER     27080000
270810                     SET  DP030-SET-CURSOR-APPL-1 TO TRUE         27081000
270820                     SET PS-BLOCK-ERROR   TO TRUE                 27082000
270830                     SET ASC-CONFIRM-UCC128 TO TRUE               27083000
270840                 END-IF                                           27084000
270850                                                                  27085000
270860                 MOVE +1               TO ASC-BLK-SUB             27086000
270870                                                                  27087000
270880                 PERFORM 5105-REWRITE-ASC-LISTQ                   27088000
270890                                                                  27089000
270900                 MOVE +1                TO ASC-BLK-SUB            27090000
271000                                                                  27100000
271100                 IF  PS-BLOCK-ERROR                               27110000
271200                     SET  PS-ERROR     TO TRUE                    27120000
271300                     MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)    27130000
271400                                       TO PV-TOP-ITEM             27140000
271500                 ELSE                                             27150000
271600                     ADD  +1            TO PV-BLOCK-NUMBER        27160000
271700                     IF  PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK      27170000
271800                         MOVE +2        TO ASC-BLK-SUB            27180000
271900                         PERFORM 4410-READ-TEMP-STORAGE           27190000
272000                         MOVE +1        TO ASC-BLK-SUB            27200000
272100                     ELSE                                         27210000
272200                         PERFORM 4410-READ-TEMP-STORAGE           27220000
272300                         ADD  +1        TO PV-BLOCK-NUMBER        27230000
272400                         MOVE +2        TO ASC-BLK-SUB            27240000
272500                         PERFORM 4410-READ-TEMP-STORAGE           27250000
272600                         SUBTRACT +1  FROM PV-BLOCK-NUMBER        27260000
272700                         MOVE +1        TO ASC-BLK-SUB            27270000
272800                     END-IF                                       27280000
272900                 END-IF                                           27290000
273000     END-PERFORM.                                                 27300000
273100*----------------------------------------------------------------*27310000
273200*   3010-VALIDATE-PRINTER                                         27320000
273300* CALLS DPKCS060 TO VALIDATE THE PRINTER ID                       27330000
273400*----------------------------------------------------------------*27340000
273500 3010-VALIDATE-PRINTER.                                           27350000
273600                                                                  27360000
273700     MOVE PC-01                      TO DP072-RPT-PGM-TYP-ID.     27370000
273800     MOVE DP020-LOCATION-NBR         TO DP072-ORIGIN-OPER-UNT-ID. 27380000
273900     MOVE DP020-LOCATION-NBR         TO DP072-OPER-UNT-ID.        27390000
274000     MOVE 1                          TO DP072-ORIGIN-FCLTY-ID     27400000
274100                                        DP072-FCLTY-ID.           27410000
274200     SET DP072-VALIDATE              TO TRUE.                     27420000
274300                                                                  27430000
274400     EXEC CICS                                                    27440000
274500          LINK PROGRAM  (PC-PRTR-VALIDATION-PGM)                  27450000
274600               COMMAREA (DP072-COMM-AREA)                         27460000
274700               RESP     (PV-CICS-RESP)                            27470000
274800     END-EXEC                                                     27480000
274900                                                                  27490000
275000     EVALUATE TRUE                                                27500000
275100         WHEN PV-CICS-RESP = DFHRESP (NORMAL)                     27510000
275200              CONTINUE                                            27520000
275300         WHEN OTHER                                               27530000
275400             SET PS-ERROR                                         27540000
275500                 DP020-MSG-FATAL       TO TRUE                    27550000
275600             MOVE PC-TSYMSG-00746      TO DP020-MSG-NUMBER        27560000
275700             IF  DP072-RPT-PGM-NME = PC-REPORT-PGM-1              27570000
275800                 MOVE DP015-UNP-ALP-BRT-OFF                       27580000
275900                                       TO APRTRA                  27590000
276000                 MOVE DP015-RED        TO APRTRC                  27600000
276100                 MOVE DP015-REVERSE    TO APRTRH                  27610000
276200                 MOVE -1               TO APRTRL                  27620000
276300             ELSE                                                 27630000
276400                 MOVE DP015-UNP-ALP-BRT-OFF                       27640000
276500                                       TO APRTRA                  27650000
276600                 MOVE DP015-RED        TO APRTRC                  27660000
276700                 MOVE DP015-REVERSE    TO APRTRH                  27670000
276800                 MOVE -1               TO APRTRL                  27680000
276900             END-IF                                               27690000
277000             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  27700000
277100     END-EVALUATE.                                                27710000
277200                                                                  27720000
277300                                                                  27730000
277400*----------------------------------------------------------------*27740000
277500*  VALIDATE THE PRINTER NUMBER ENTERED ON THE SCREEN TO ENSURE   *27750000
277600*  THIS IS A VALID PRINTER AND THAT SHIPPING MANIFEST LABELS     *27760000
277700*  CAN BE PRINTED ON THIS PRINTER.                                27770000
277800*----------------------------------------------------------------*27780000
277900 3020-VALIDATE-PRINTER-ID-SML.                                    27790000
278000                                                                  27800000
278100     IF  DP072-PRTR-CLUSTER-OS-RLSE-CDE  = PC-MGMX                27810000
278200         SET  PS-PRINTER-ERROR                                    27820000
278300              PS-ERROR                                            27830000
278400              DP020-MSG-FATAL         TO TRUE                     27840000
278500         MOVE PC-TSYMSG-00746         TO DP020-MSG-NUMBER         27850000
278600         MOVE DP015-UNP-ALP-BRT-MDT   TO APRTRA                   27860000
278700         MOVE DP015-RED               TO APRTRC                   27870000
278800         MOVE DP015-REVERSE           TO APRTRH                   27880000
278900         MOVE -1                      TO APRTRL                   27890000
279000         SET DP030-SET-CURSOR-APPL-1  TO TRUE                     27900000
279100     ELSE                                                         27910000
279200         MOVE DP015-UNP-ALP-NOR-OFF    TO APRTRA                  27920000
279300         MOVE DP015-GREEN              TO APRTRC                  27930000
279400         MOVE DP015-UNDERLINE          TO APRTRH                  27940000
279500     END-IF.                                                      27950000
279600                                                                  27960000
279700     IF  DP072-PRTR-PRTR-TRK-STAT-CDE    = PC-A                   27970000
279800         MOVE DP015-UNP-ALP-NOR-OFF    TO APRTRA                  27980000
279900         MOVE DP015-GREEN              TO APRTRC                  27990000
280000         MOVE DP015-UNDERLINE          TO APRTRH                  28000000
280100     ELSE                                                         28010000
280200         SET  PS-PRINTER-ERROR                                    28020000
280300              PS-ERROR                                            28030000
280400              DP020-MSG-FATAL         TO TRUE                     28040000
280500         MOVE PC-TSYMSG-00746         TO DP020-MSG-NUMBER         28050000
280600         MOVE DP015-UNP-ALP-BRT-MDT   TO APRTRA                   28060000
280700         MOVE DP015-RED               TO APRTRC                   28070000
280800         MOVE DP015-REVERSE           TO APRTRH                   28080000
280900         MOVE -1                      TO APRTRL                   28090000
281000         SET DP030-SET-CURSOR-APPL-1  TO TRUE                     28100000
281100     END-IF.                                                      28110000
281200                                                                  28120000
281300                                                                  28130000
281400*                                                                 28140000
281500*                                                                 28150000
281600*----------------------------------------------------------------*28160000
281700*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *28170000
281800*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*28180000
281900*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *28190000
282000*                                                                *28200000
282100*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *28210000
282200*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *28220000
282300*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *28230000
282400*    US IN THE 2ND BLOCK OF THE ARRAY.                           *28240000
282500*----------------------------------------------------------------*28250000
282600                                                                  28260000
282700 3100-SET-SUBSCRIPTS.                                             28270000
282800                                                                  28280000
282900     COMPUTE ASC-ITEM-SUB =                                       28290000
283000         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        28300000
283100                                                                  28310000
283200     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         28320000
283300         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            28330000
283400                                                                  28340000
283500         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               28350000
283600     ELSE                                                         28360000
283700         MOVE +1                     TO ASC-BLK-SUB               28370000
283800     END-IF.                                                      28380000
283900******************************************************************28390000
284000** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **28400000
284100******************************************************************28410000
284200                                                                  28420000
284300 3200-RESET-ATTRIBUTES.                                           28430000
284400     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   28440000
284500     MOVE DP015-GREEN              TO ASTRTITC.                   28450000
284600     MOVE DP015-UNDERLINE          TO ASTRTITH.                   28460000
284700                                                                  28470000
284800     PERFORM                                                      28480000
284900         VARYING PV-SUB                                           28490000
285000         FROM 1 BY 1                                              28500000
285100         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        28510000
285200           IF ASC-PROTECTED (ASC-BLK-SUB ASC-ITEM-SUB)            28520000
285300              CONTINUE                                            28530000
285400           ELSE                                                   28540000
285500             MOVE DP015-UNP-ALP-NOR-OFF                           28550000
285600                                       TO MR-SELECTA (PV-SUB)     28560000
285700                                          MR-NBR-CARTONSA (PV-SUB)28570000
285800             MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)     28580000
285900                                          MR-NBR-CARTONSC (PV-SUB)28590000
286000             MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)     28600000
286100                                          MR-NBR-CARTONSH (PV-SUB)28610000
286200           END-IF                                                 28620000
286300     END-PERFORM.                                                 28630000
286400******************************************************************28640000
286500** EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS    **28650000
286600** WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'   **28660000
286700** IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR    **28670000
286800** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **28680000
286900******************************************************************28690000
287000 3300-EDIT-SELECTIONS.                                            28700000
287100     EVALUATE TRUE                                                28710000
287200         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     28720000
287300             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         28730000
287400                 CONTINUE                                         28740000
287500         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         28750000
287600             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        28760000
287700                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   28770000
287800                 MOVE ASC-TEMP-SELECTED-SW                        28780000
287900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  28790000
288000                                TO ASC-SELECTED-SW                28800000
288100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  28810000
288200             END-IF                                               28820000
288300         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     28830000
288400                 = SPACE                                          28840000
288500             EVALUATE TRUE                                        28850000
288600                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       28860000
288700                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS28870000
288800                     MOVE SPACE TO ASC-SELECTED-SW                28880000
288900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  28890000
289000                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        28900000
289100                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    28910000
289200                     MOVE SPACE TO ASC-SELECTED-SW                28920000
289300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  28930000
289400                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          28940000
289500                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      28950000
289600                     MOVE SPACE TO ASC-SELECTED-SW                28960000
289700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  28970000
289800             END-EVALUATE                                         28980000
289900         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           28990000
290000             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            29000000
290100                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    29010000
290200             END-IF                                               29020000
290300             PERFORM 3310-EDIT-RANGE                              29030000
290400         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             29040000
290500             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            29050000
290600                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    29060000
290700             END-IF                                               29070000
290800             PERFORM 3310-EDIT-RANGE                              29080000
290900         WHEN OTHER                                               29090000
291000             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           29100000
291100             SET DP020-MSG-FATAL    TO TRUE                       29110000
291200             MOVE -1                TO MR-SELECTL (PV-SUB)        29120000
291300             SET DP030-SET-CURSOR-APPL-1                          29130000
291400                                    TO TRUE                       29140000
291500             MOVE DP015-RED         TO MR-SELECTC (PV-SUB)        29150000
291600             MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)        29160000
291700             SET PS-ERROR TO TRUE                                 29170000
291800             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            29180000
291900                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     29190000
292000                 MOVE SPACE         TO ASC-SELECTED-SW            29200000
292100                                        (ASC-BLK-SUB ASC-ITEM-SUB)29210000
292200             END-IF                                               29220000
292300     END-EVALUATE.                                                29230000
292400                                                                  29240000
292500     PERFORM 3305-EDIT-LINES                                      29250000
292600******************************************************************29260000
292700***CHECK TO SEE IF UNIT QTY GREATER THAN ZERO                     29270000
292800******************************************************************29280000
292900     IF ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)                     29290000
293000       EVALUATE TRUE                                              29300000
293100          WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)             29310000
293200          WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)             29320000
293300          WHEN DP020-FK-LOCAL-FUNC-07 (DP020-SRC-AID)             29330000
293400            IF ASC-NBR-UNITS (ASC-BLK-SUB ASC-ITEM-SUB) > 0       29340000
293500                  CONTINUE                                        29350000
293600            ELSE                                                  29360000
293700               SET  PS-ERROR                                      29370000
293800                    DP020-MSG-FATAL TO TRUE                       29380000
293900               MOVE PC-TSYMSG-03297 TO DP020-MSG-NUMBER           29390000
294000               MOVE -1              TO MR-SELECTL (PV-SUB)        29400000
294100               SET DP030-SET-CURSOR-APPL-1 TO TRUE                29410000
294200               SET PS-BLOCK-ERROR   TO TRUE                       29420000
294300            END-IF                                                29430000
294400       END-EVALUATE                                               29440000
294500     END-IF                                                       29450000
294600                                                                  29460000
294700******************************************************************29470000
294800***CHECK RECEIVER TYPE                                            29480000
294900******************************************************************29490000
295000     IF ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)                     29500000
295100       EVALUATE TRUE                                              29510000
295200          WHEN DP020-FK-LOCAL-FUNC-07 (DP020-SRC-AID)             29520000
295300***check receiver type - cannot smooth if ap type                 29530000
295400             PERFORM 4260-GET-RECEIVER-TYPE                       29540000
295500             IF  RECEIV-REC-TYP-CDE = 'AP'                        29550000
295600                 SET PS-ERROR                                     29560000
295700                     DP020-MSG-FATAL  TO TRUE                     29570000
295800                 MOVE PC-TSYMSG-03362 TO DP020-MSG-NUMBER         29580000
295900                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              29590000
296000             END-IF                                               29600000
296100       END-EVALUATE                                               29610000
296200                                                                  29620000
296300******************************************************************29630000
296400***CHECK TO SEE OF UNITS OR STATUS HAS CHANGED                    29640000
296500******************************************************************29650000
296600     IF ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)                     29660000
296700       EVALUATE TRUE                                              29670000
296800          WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)             29680000
296900          WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)             29690000
297000          WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)             29700000
297100          WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)             29710000
297200          WHEN DP020-FK-LOCAL-FUNC-07 (DP020-SRC-AID)             29720000
297300               MOVE ASC-PO-NBR             TO DK-PO-NBR           29730000
297400               MOVE ASC-REC-SEQ-NBR        TO DK-REC-SEQ-NBR      29740000
297500               MOVE ASC-STR-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)     29750000
297600                                           TO DK-STR-NBR          29760000
297700               INITIALIZE RECDIS-VERIFY-ITM-QTY                   29770000
297800               PERFORM 5010-OPEN-TOTAL-UNTS-CSR                   29780000
297900               SET PS-NOT-END-OF-RECITM-CSR TO TRUE               29790000
298000               PERFORM 5310-FETCH-TOTAL-UNITS                     29800000
298100                          UNTIL PS-END-OF-RECITM-CSR              29810000
298200               PERFORM 5020-CLOSE-TOTAL-UNTS-CSR                  29820000
298300**                                                                29830000
298400**IF NO CHANGE IN UNITS OR NO CHANGE IN VERIFIED STATUS -CONTINUE 29840000
298500**                                                                29850000
298600               IF  RECDIS-VERIFY-ITM-QTY  =                       29860000
298700                   ASC-NBR-UNITS (ASC-BLK-SUB ASC-ITEM-SUB)       29870000
298800                   IF ASC-VERIFIED-LINES-SW                       29880000
298900                           (ASC-BLK-SUB ASC-ITEM-SUB) =           29890000
299000                           PS-VERIFIED-LINE-FND-SW                29900000
299100                      CONTINUE                                    29910000
299200                   ELSE                                           29920000
299300                      SET  PS-ERROR                               29930000
299400                           DP020-MSG-FATAL TO TRUE                29940000
299500                      MOVE PC-TSYMSG-02780 TO DP020-MSG-NUMBER    29950000
299600                      MOVE -1              TO MR-SELECTL (PV-SUB) 29960000
299700                      SET DP030-SET-CURSOR-APPL-1 TO TRUE         29970000
299800                      SET PS-BLOCK-ERROR   TO TRUE                29980000
299900                   END-IF                                         29990000
300000               ELSE                                               30000000
300100                    SET  PS-ERROR                                 30010000
300200                         DP020-MSG-FATAL TO TRUE                  30020000
300300                    MOVE PC-TSYMSG-02780 TO DP020-MSG-NUMBER      30030000
300400                    MOVE -1              TO MR-SELECTL (PV-SUB)   30040000
300500                    SET DP030-SET-CURSOR-APPL-1 TO TRUE           30050000
300600                    SET PS-BLOCK-ERROR   TO TRUE                  30060000
300700               END-IF                                             30070000
300800       END-EVALUATE                                               30080000
300900     END-IF.                                                      30090000
301000                                                                  30100000
301100     IF PS-NO-ERROR                                               30110000
301200     EVALUATE TRUE                                                30120000
301300        WHEN DP020-FK-LOCAL-FUNC-08 (DP020-SRC-AID)               30130000
301400            IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)             30140000
301500                MOVE ASC-PO-NBR             TO DK-PO-NBR          30150000
301600                MOVE ASC-REC-SEQ-NBR        TO DK-RECEIVER        30160000
301700                MOVE ASC-STR-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)    30170000
301800                                               TO DK-STR-NBR      30180000
301900                PERFORM 5500-CHECK-SMOOTHING-ACTV                 30190000
302000                IF PS-SMOOTHING-ACTV                              30200000
302100                   CONTINUE                                       30210000
302200                ELSE                                              30220000
302300                   SET  PS-ERROR                                  30230000
302400                        DP020-MSG-FATAL TO TRUE                   30240000
302500                   MOVE PC-TSYMSG-02692 TO DP020-MSG-NUMBER       30250000
302600                   MOVE -1              TO MR-SELECTL (PV-SUB)    30260000
302700                   SET DP030-SET-CURSOR-APPL-1 TO TRUE            30270000
302800                   SET PS-BLOCK-ERROR   TO TRUE                   30280000
302900                END-IF                                            30290000
303000            END-IF                                                30300000
303100                                                                  30310000
303200        WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)               30320000
303300             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            30330000
303400                 MOVE 'PCP2LDEL' TO DP008-FUNCTION-NAME           30340000
303500                 PERFORM 2105-RACF-ACCESS                         30350000
303600                 IF PS-INACTV-NOT-ALLOWED                         30360000
303700                    SET  PS-ERROR                                 30370000
303800                         DP020-MSG-FATAL TO TRUE                  30380000
303900                    MOVE PC-TSYMSG-02720 TO DP020-MSG-NUMBER      30390000
304000                    MOVE -1              TO MR-SELECTL (PV-SUB)   30400000
304100                    SET  DP030-SET-CURSOR-APPL-1 TO TRUE          30410000
304200                    SET PS-BLOCK-ERROR   TO TRUE                  30420000
304300                 ELSE                                             30430000
304400                    SET ASC-CONFIRM-INACTV TO TRUE                30440000
304500                    SET  PS-ERROR                                 30450000
304600                         DP020-MSG-FATAL TO TRUE                  30460000
304700                    MOVE PC-TSYMSG-02721 TO DP020-MSG-NUMBER      30470000
304800                    MOVE -1              TO MR-SELECTL (PV-SUB)   30480000
304900                    SET  DP030-SET-CURSOR-APPL-1 TO TRUE          30490000
305000                    SET PS-BLOCK-ERROR   TO TRUE                  30500000
305100                END-IF                                            30510000
305200             END-IF                                               30520000
305300     END-EVALUATE                                                 30530000
305400     END-IF.                                                      30540000
305500                                                                  30550000
305600     IF PS-NO-ERROR                                               30560000
305700        IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)                 30570000
305800           IF  DP020-FK-CONFIRM (DP020-SRC-AID) AND               30580000
305900                ASC-VND-BRCDE-SCND (ASC-BLK-SUB ASC-ITEM-SUB) AND 30590000
306000                ASC-VND-BRCD-CNFRM                                30600000
306100                  SET  PS-ERROR                                   30610000
306200                       DP020-MSG-FATAL TO TRUE                    30620000
306300                  MOVE PC-TSYMSG-02749 TO DP020-MSG-NUMBER        30630000
306400                  MOVE -1              TO MR-SELECTL (PV-SUB)     30640000
306500                  SET DP030-SET-CURSOR-APPL-1 TO TRUE             30650000
306600                  SET PS-BLOCK-ERROR   TO TRUE                    30660000
306700                  SET ASC-VND-BRCD-CNFRM-NO TO TRUE               30670000
306800           END-IF                                                 30680000
306900        END-IF                                                    30690000
307000*    END-IF                                                       30700000
307100                                                                  30710000
307200*    IF PS-NO-ERROR                                               30720000
307300        IF ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB) AND              30730000
307400               ASC-VERIFIED-LINE-YES (ASC-BLK-SUB ASC-ITEM-SUB)   30740000
307500           EVALUATE TRUE                                          30750000
307600              WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)         30760000
307700              WHEN DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)         30770000
307800              WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)         30780000
307900              WHEN DP020-FK-LOCAL-FUNC-08 (DP020-SRC-AID)         30790000
308000                    CONTINUE                                      30800000
308100              WHEN OTHER                                          30810000
308200                    SET  PS-ERROR                                 30820000
308300                         DP020-MSG-FATAL TO TRUE                  30830000
308400                    MOVE PC-TSYMSG-02692 TO DP020-MSG-NUMBER      30840000
308500                    MOVE -1              TO MR-SELECTL (PV-SUB)   30850000
308600                    SET  DP030-SET-CURSOR-APPL-1 TO TRUE          30860000
308700                    SET PS-BLOCK-ERROR   TO TRUE                  30870000
308800           END-EVALUATE                                           30880000
308900        END-IF.                                                   30890000
309000*    END-IF.                                                      30900000
309100                                                                  30910000
309200     IF PS-NO-ERROR                                               30920000
309300        IF ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB) AND              30930000
309400               ASC-RCVR-TRBLE-EXISTS-YES                          30940000
309500           EVALUATE TRUE                                          30950000
309600              WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)         30960000
309700              WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)         30970000
309800              WHEN DP020-FK-LOCAL-FUNC-07 (DP020-SRC-AID)         30980000
309900                    SET  PS-ERROR                                 30990000
310000                         DP020-MSG-FATAL TO TRUE                  31000000
310100                    MOVE PC-TSYMSG-01756 TO DP020-MSG-NUMBER      31010000
310200                    MOVE -1              TO MR-SELECTL (PV-SUB)   31020000
310300                    SET  DP030-SET-CURSOR-APPL-1 TO TRUE          31030000
310400                    SET PS-BLOCK-ERROR   TO TRUE                  31040000
310500              WHEN OTHER                                          31050000
310600                    CONTINUE                                      31060000
310700           END-EVALUATE                                           31070000
310800        END-IF                                                    31080000
310900     END-IF.                                                      31090000
311000*lmm beg                                                          31100000
311100* IF CARTON CNT CHANGED ON SCREEN RECHECK IF SMOOTHING ALLOWED    31110000
311200* IF STORE IS IN PHY INV CYCLE                                    31120000
311300     IF PS-NO-ERROR                                               31130000
311400       IF DP020-FK-LOCAL-FUNC-07 (DP020-SRC-AID) AND              31140000
311500          ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)                   31150000
311600          IF ASC-PHY-INV-STORE (ASC-BLK-SUB ASC-ITEM-SUB)         31160000
311700             IF ASC-NBR-CARTONS (ASC-BLK-SUB ASC-ITEM-SUB) > 1    31170000
311800               SET  PS-ERROR                                      31180000
311900                    DP020-MSG-FATAL TO TRUE                       31190000
312000               MOVE PC-TSYMSG-03413 TO DP020-MSG-NUMBER           31200000
312100               MOVE -1              TO MR-SELECTL (PV-SUB)        31210000
312200               SET  DP030-SET-CURSOR-APPL-1 TO TRUE               31220000
312300               SET PS-BLOCK-ERROR   TO TRUE                       31230000
312400             END-IF                                               31240000
312500          END-IF                                                  31250000
312600       END-IF                                                     31260000
312700     END-IF.                                                      31270000
312800*lmm end                                                          31280000
312900                                                                  31290000
313000**PERFORM EDIT CHECKS FOR AUTOVE DC                               31300000
313100     IF PS-NO-ERROR                                               31310000
313200        IF ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB) AND              31320000
313300               DP020-FK-LOCAL-FUNC-07 (DP020-SRC-AID)             31330000
313400           PERFORM 8400-CHECK-AUTOVE                              31340000
313500           IF ASC-UCC128-DATA-YES (ASC-BLK-SUB ASC-ITEM-SUB)      31350000
313600               MOVE ASC-PO-NBR             TO DK-PO-NBR           31360000
313700               MOVE ASC-REC-SEQ-NBR        TO DK-REC-SEQ-NBR      31370000
313800                                              DK-RECEIVER         31380000
313900               MOVE ASC-STR-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)     31390000
314000                                              TO DK-STR-NBR       31400000
314100               PERFORM 8450-CHECKED-IN-CRTN                       31410000
314200           END-IF                                                 31420000
314300           IF PS-NO-ERROR AND                                     31430000
314400              ASC-UCC128-DATA-YES (ASC-BLK-SUB ASC-ITEM-SUB)      31440000
314500               SET PS-UCC128-DATA-YES TO TRUE                     31450000
314600*              SET  PS-ERROR                                      31460000
314700*                   DP020-MSG-FATAL TO TRUE                       31470000
314800*              MOVE PC-TSYMSG-02683 TO DP020-MSG-NUMBER           31480000
314900               MOVE -1              TO MR-SELECTL (PV-SUB)        31490000
315000*              SET  DP030-SET-CURSOR-APPL-1 TO TRUE               31500000
315100*              SET PS-BLOCK-ERROR   TO TRUE                       31510000
315200*              SET ASC-CONFIRM-UCC128 TO TRUE                     31520000
315300           END-IF                                                 31530000
315400        END-IF                                                    31540000
315500     END-IF.                                                      31550000
315600                                                                  31560000
315700                                                                  31570000
315800     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 31580000
315900     SUBTRACT +1 FROM ASC-ITEM-SUB.                               31590000
316000     IF  ASC-ITEM-SUB < 1                                         31600000
316100         SUBTRACT +1 FROM ASC-BLK-SUB                             31610000
316200         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                31620000
316300     END-IF.                                                      31630000
316400******************************************************************31640000
316500 3305-EDIT-LINES.                                                 31650000
316600******************************************************************31660000
316700       IF DP020-FK-LOCAL-FUNC-07 (DP020-SRC-AID) AND              31670000
316800          ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)                   31680000
316900          IF  ASC-NBR-CARTONS (ASC-BLK-SUB ASC-ITEM-SUB)          31690000
317000                                        =  SPACE      OR          31700000
317010             ASC-NBR-CARTONS (ASC-BLK-SUB ASC-ITEM-SUB)           31701000
317020                                        =  ZEROES     OR          31702000
317030             ASC-NBR-CARTONS (ASC-BLK-SUB ASC-ITEM-SUB)           31703000
317040                                        =  LOW-VALUES             31704000
317050                 MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER       31705000
317060                 SET DP020-MSG-FATAL    TO TRUE                   31706000
317070                 SET DP030-SET-CURSOR-APPL-1                      31707000
317080                                      TO TRUE                     31708000
317090                 MOVE -1       TO MR-NBR-CARTONSL (PV-SUB)        31709000
317091                 MOVE DP015-RED  TO MR-NBR-CARTONSC (PV-SUB)      31709100
317092                 MOVE DP015-REVERSE TO MR-NBR-CARTONSH (PV-SUB)   31709200
317093                   SET PS-ERROR                                   31709300
317094                       PS-BLOCK-ERROR  TO  TRUE                   31709400
317095          END-IF                                                  31709500
317096       END-IF.                                                    31709600
317097                                                                  31709700
317098*** added - dmh - 9/12/08 - begin                                 31709800
317099       IF DP020-FK-LOCAL-FUNC-07 (DP020-SRC-AID) AND              31709900
317100          ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)                   31710000
317200             MOVE  ASC-PO-NBR       TO  DK-PO-NBR                 31720000
317300             MOVE  ASC-REC-SEQ-NBR  TO  DK-RECEIVER               31730000
317400             MOVE  ASC-STR-NUMBER  (ASC-BLK-SUB ASC-ITEM-SUB)     31740000
317500                                    to  DK-STR-NBR                31750000
317600                                                                  31760000
317700            PERFORM 8660-CHECK-IF-ALREADY-SMOOTHED                31770000
317800                                                                  31780000
317900            IF  PV-SMOOTH-CRTN-CNT  > 0                           31790000
318000                 MOVE ASC-OPER-UNT-ID   TO DK-OPER-UNT-ID         31800000
318100                 MOVE ASC-FCLTY-ID      TO DK-FCLTY-ID            31810000
318200                 SET ASC-NO-CONFIRM-UCC128    TO TRUE             31820000
318300                 SET ASC-PREVIOUS-SMOOTH-YES  TO TRUE             31830000
318400                 SET PS-ERROR                                     31840000
318500                     PS-BLOCK-ERROR           TO TRUE             31850000
318600           END-IF                                                 31860000
318700       END-IF.                                                    31870000
318800*** added - dmh - 9/12/08 - end                                   31880000
318900                                                                  31890000
319000******************************************************************31900000
319100** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **31910000
319200** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **31920000
319300** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**31930000
319400** THE ENDING.                                                  **31940000
319500******************************************************************31950000
319600 3310-EDIT-RANGE.                                                 31960000
319700     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                31970000
319800         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   31980000
319900             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)31990000
320000                                   TO ASC-SELECTED-SW             32000000
320100                                        (ASC-BLK-SUB ASC-ITEM-SUB)32010000
320200             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 32020000
320300         ELSE                                                     32030000
320400             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     32040000
320500                 CONTINUE                                         32050000
320600             ELSE                                                 32060000
320700*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        32070000
320800                 MOVE PC-TSYMSG-00054                             32080000
320900                                   TO DP020-MSG-NUMBER            32090000
321000                 SET DP020-MSG-FATAL                              32100000
321100                                   TO TRUE                        32110000
321200                 MOVE -1           TO MR-SELECTL (PV-SUB)         32120000
321300                 SET DP030-SET-CURSOR-APPL-1                      32130000
321400                                   TO TRUE                        32140000
321500                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         32150000
321600                 MOVE DP015-UNDERLINE                             32160000
321700                                   TO MR-SELECTH (PV-SUB)         32170000
321800                 SET PS-ERROR      TO TRUE                        32180000
321900             END-IF                                               32190000
322000         END-IF                                                   32200000
322100     ELSE                                                         32210000
322200         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     32220000
322300             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 32230000
322400                                   TO ASC-SELECTED-SW             32240000
322500                                     (ASC-BLK-SUB ASC-ITEM-SUB)   32250000
322600             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   32260000
322700         ELSE                                                     32270000
322800             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       32280000
322900                 CONTINUE                                         32290000
323000             ELSE                                                 32300000
323100*                -- ONLY ONE END-OF-RANGE ALLOWED --              32310000
323200                 MOVE PC-TSYMSG-00055                             32320000
323300                                   TO DP020-MSG-NUMBER            32330000
323400                 SET DP020-MSG-FATAL                              32340000
323500                                   TO TRUE                        32350000
323600                 MOVE -1           TO MR-SELECTL (PV-SUB)         32360000
323700                 SET DP030-SET-CURSOR-APPL-1                      32370000
323800                                   TO TRUE                        32380000
323900                 SET PS-ERROR      TO TRUE                        32390000
324000             END-IF                                               32400000
324100         END-IF                                                   32410000
324200     END-IF.                                                      32420000
324300                                                                  32430000
324400******************************************************************32440000
324500** IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,    **32450000
324600** MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.  **32460000
324700******************************************************************32470000
324800 3400-CHECK-RANGE-SEQUENCE.                                       32480000
324900     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       32490000
325000       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      32500000
325100       AND  ASC-START-OF-SELECTED-RANGE >                         32510000
325200                                         ASC-END-OF-SELECTED-RANGE32520000
325300*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                32530000
325400         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 32540000
325500         SET DP020-MSG-FATAL TO TRUE                              32550000
325600         SET PS-ERROR TO TRUE                                     32560000
325700         PERFORM 3410-POSITION-AT-ERROR                           32570000
325800     END-IF.                                                      32580000
325900******************************************************************32590000
326000** BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE    **32600000
326100** PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR **32610000
326200** SHOULD BE POSITIONED ON A RANGE ERROR.                       **32620000
326300******************************************************************32630000
326400 3410-POSITION-AT-ERROR.                                          32640000
326500     SET DP030-SET-CURSOR-APPL-1                                  32650000
326600                                   TO TRUE.                       32660000
326700     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 32670000
326800                    - PV-TOP-ITEM + 1.                            32680000
326900     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      32690000
327000         CONTINUE                                                 32700000
327100     ELSE                                                         32710000
327200         MOVE -1                   TO MR-SELECTL (PV-SUB)         32720000
327300         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         32730000
327400         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         32740000
327500     END-IF.                                                      32750000
327600                                                                  32760000
327700     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   32770000
327800                    - PV-TOP-ITEM + 1.                            32780000
327900     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      32790000
328000         CONTINUE                                                 32800000
328100     ELSE                                                         32810000
328200         MOVE -1                   TO MR-SELECTL (PV-SUB)         32820000
328300         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         32830000
328400         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         32840000
328500     END-IF.                                                      32850000
328600                                                                  32860000
328700*----------------------------------------------------------------*32870000
328800*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *32880000
328900*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *32890000
329000*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *32900000
329100*----------------------------------------------------------------*32910000
329200                                                                  32920000
329300 3500-MARK-RANGE-AS-SELECTED.                                     32930000
329400     MOVE +1                       TO  ASC-BLK-SUB.               32940000
329500     PERFORM 3510-MARK-SELECTED-INDS                              32950000
329600         VARYING ASC-ITEM-SUB                                     32960000
329700         FROM 1 BY 1                                              32970000
329800         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 32980000
329900                                                                  32990000
330000     ADD +1                        TO ASC-BLK-SUB.                33000000
330100     PERFORM 3510-MARK-SELECTED-INDS                              33010000
330200         VARYING ASC-ITEM-SUB                                     33020000
330300         FROM 1 BY 1                                              33030000
330400         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 33040000
330500                                                                  33050000
330600     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               33060000
330700                                   TO  PV-LIST-ITEM-NUMBER.       33070000
330800     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            33080000
330900         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         33090000
331000               PC-ITEMS-PER-PANEL).                               33100000
331100                                                                  33110000
331200     MOVE ASC-START-OF-SELECTED-RANGE                             33120000
331300                                   TO PV-START-OF-SELECTED-RANGE. 33130000
331400     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            33140000
331500         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  33150000
331600               PC-ITEMS-PER-PANEL).                               33160000
331700                                                                  33170000
331800     MOVE ASC-END-OF-SELECTED-RANGE                               33180000
331900                                   TO  PV-END-OF-SELECTED-RANGE.  33190000
332000     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             33200000
332100         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    33210000
332200               PC-ITEMS-PER-PANEL).                               33220000
332300     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             33230000
332400         PV-FIRST-BLOCK-IN-ARRAY + 1.                             33240000
332500                                                                  33250000
332600     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    33260000
332700        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        33270000
332800         MOVE +1                   TO ASC-BLK-SUB                 33280000
332900         PERFORM 5100-WRITE-TEMP-STORAGE                          33290000
333000         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         33300000
333100             PV-FIRST-BLOCK-IN-ARRAY - 1                          33310000
333200                                                                  33320000
333300         PERFORM                                                  33330000
333400             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      33340000
333500                   PV-PREV-BLOCK-IN-ARRAY                         33350000
333600             MOVE PV-FIRST-BLOCK-IN-RANGE                         33360000
333700                                   TO PV-BLOCK-NUMBER             33370000
333800             PERFORM 4410-READ-TEMP-STORAGE                       33380000
333900             PERFORM 3510-MARK-SELECTED-INDS                      33390000
334000                 VARYING ASC-ITEM-SUB                             33400000
334100                 FROM 1 BY 1                                      33410000
334200                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          33420000
334300             PERFORM 5100-WRITE-TEMP-STORAGE                      33430000
334400             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     33440000
334500         END-PERFORM                                              33450000
334600                                                                  33460000
334700         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         33470000
334800             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     33480000
334900         PERFORM                                                  33490000
335000             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       33500000
335100                   PV-LAST-BLOCK-IN-RANGE                         33510000
335200             MOVE PV-NEXT-BLOCK-IN-ARRAY                          33520000
335300                                   TO PV-BLOCK-NUMBER             33530000
335400             PERFORM 4410-READ-TEMP-STORAGE                       33540000
335500             PERFORM 3510-MARK-SELECTED-INDS                      33550000
335600                 VARYING ASC-ITEM-SUB                             33560000
335700                 FROM 1 BY 1                                      33570000
335800                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          33580000
335900             PERFORM 5100-WRITE-TEMP-STORAGE                      33590000
336000             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      33600000
336100         END-PERFORM                                              33610000
336200                                                                  33620000
336300         MOVE PV-FIRST-BLOCK-IN-ARRAY                             33630000
336400                                   TO PV-BLOCK-NUMBER             33640000
336500         PERFORM 4410-READ-TEMP-STORAGE                           33650000
336600     END-IF.                                                      33660000
336700                                                                  33670000
336800     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 33680000
336900                                      ASC-END-OF-SELECTED-RANGE.  33690000
337000                                                                  33700000
337100*----------------------------------------------------------------*33710000
337200* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *33720000
337300*----------------------------------------------------------------*33730000
337400                                                                  33740000
337500 3510-MARK-SELECTED-INDS.                                         33750000
337600                                                                  33760000
337700     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         33770000
337800                                ASC-ITEM-SUB) >                   33780000
337900         ASC-START-OF-SELECTED-RANGE)                             33790000
338000     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         33800000
338100                                ASC-ITEM-SUB) =                   33810000
338200         ASC-START-OF-SELECTED-RANGE)                             33820000
338300                                                                  33830000
338400         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     33840000
338500                                    ASC-ITEM-SUB) <               33850000
338600             ASC-END-OF-SELECTED-RANGE)                           33860000
338700         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     33870000
338800                                    ASC-ITEM-SUB) =               33880000
338900             ASC-END-OF-SELECTED-RANGE)                           33890000
339000                                                                  33900000
339100             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          33910000
339200                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   33920000
339300                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   33930000
339400                               TO TRUE                            33940000
339500                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              33950000
339600                               TO TRUE                            33960000
339700                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    33970000
339800             END-IF                                               33980000
339900         END-IF                                                   33990000
340000     END-IF.                                                      34000000
340100                                                                  34010000
340200*----------------------------------------------------------------*34020000
340300* DMH - 1/23/04 - LABOR - BEGIN                                  *34030000
340400* DETERMINE DC IS INTERFACING WITH THE DC LABOR SYSTEM           *34040000
340500*----------------------------------------------------------------*34050000
340600 3600-CHECK-DC-LABOR.                                             34060000
340700                                                                  34070000
340800     MOVE DP020-LOCATION-NBR TO  DK-LABOR-OPER.                   34080000
340900                                                                  34090000
341000     EXEC SQL                                                     34100000
341100          SELECT  FUNC_TXT                                        34110000
341200            INTO :KRPRPM-FUNC-TXT                                 34120000
341300            FROM  TKRPRPM                                         34130000
341400           WHERE  LOC_ID            = :DK-LABOR-OPER              34140000
341500             AND  INTFC_SYS_CDE     = 'DLX'                       34150000
341600             AND  SYS_PRC_FUNC_CDE  = 'DLLBIN'                    34160000
341700     END-EXEC.                                                    34170000
341800                                                                  34180000
341900     EVALUATE TRUE                                                34190000
342000                                                                  34200000
342100         WHEN SQLCODE = +0                                        34210000
342200              IF  KRPRPM-FUNC-TXT  = 'Y'                          34220000
342300                  SET  ASC-DC-INTERFC-LABOR-YES TO  TRUE          34230000
342400              ELSE                                                34240000
342500                  SET  ASC-DC-INTERFC-LABOR-NO  TO  TRUE          34250000
342600              END-IF                                              34260000
342700                                                                  34270000
342800         WHEN SQLCODE = +100                                      34280000
342900              SET  ASC-DC-INTERFC-LABOR-NO  TO  TRUE              34290000
343000                                                                  34300000
343100         WHEN SQLCODE = -904                                      34310000
343200         WHEN SQLCODE = -911                                      34320000
343300         WHEN SQLCODE = -913                                      34330000
343400              MOVE SQLCODE                   TO PV-SOFT-SQLCODE   34340000
343500              MOVE '3600-CHECK-DC-LABOR'     TO PV-SOFT-PARAGRAPH 34350000
343600              MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2 34360000
343700              MOVE LENGTH OF PV-CICS-MSG-AREA2                    34370000
343800                TO PV-COMMAREA-LENGTH                             34380000
343900              EXEC CICS                                           34390000
344000                   WRITEQ TD                                      34400000
344100                    QUEUE  ('CSSL')                               34410000
344200                     FROM  (PV-CICS-MSG-AREA2)                    34420000
344300                   LENGTH  (PV-COMMAREA-LENGTH)                   34430000
344400                     RESP  (PV-CICS-RESP)                         34440000
344500              END-EXEC                                            34450000
344600             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          34460000
344700             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              34470000
344800             PERFORM 9900-SOFT-ABORT                              34480000
344900                                                                  34490000
345000         WHEN SQLWARN0 NOT = SPACES                               34500000
345100         WHEN SQLCODE < +0                                        34510000
345200         WHEN SQLCODE > +0                                        34520000
345300              MOVE '3600-CHECK-DC-LABOR'                          34530000
345400                                 TO DP013-PARAGRAPH               34540000
345500              MOVE 'CHECK IF INTERFACE WITH DC LABOR SYSTEM'      34550000
345600                                 TO DP013-MESSAGE-TEXT (1)        34560000
345700              MOVE SQLCA         TO DP013-SQLCA                   34570000
345800              MOVE 'TKRPRPM'     TO DP013-DB2-TABLE-NAME (1)      34580000
345900              SET DP013-DB2-ABEND                                 34590000
346000                  DP013-XCTL-DISPLAY-RESTART                      34600000
346100                                 TO TRUE                          34610000
346200              PERFORM DP013-0000-PROCESS-ABEND                    34620000
346300     END-EVALUATE.                                                34630000
346400                                                                  34640000
346500                                                                  34650000
346600*----------------------------------------------------------------*34660000
346700* IF DC IS INTERFACING WITH THE DC LABOR SYSTEM, CHECK TO SEE    *34670000
346800* IF THE ASSOCIATE IS CURRENTLY ACTIVE ON A LABOR ASSIGNMENT.    *34680000
346900*----------------------------------------------------------------*34690000
347000 3610-CHECK-LABOR-ASGMT.                                          34700000
347100                                                                  34710000
347200     INITIALIZE  DL003-ASGMT-COMMAREA.                            34720000
347300     SET   DL003-BY-USER-KEY  TO  TRUE.                           34730000
347400     MOVE PV-LABOR-USER-ID    TO DL003-KEY-USER-ID.               34740000
347500     MOVE PC-CURRENT-PROGRAM-NAME                                 34750000
347600                              TO  DL003-ORIG-CALLING-PGM-NM.      34760000
347700                                                                  34770000
347800     CALL DL003-USER-PGM USING DFHEIBLK                           34780000
347900                               DL003-COMMAREA                     34790000
348000                               DL003-ASGMT-COMMAREA               34800000
348100                                                                  34810000
348200     EVALUATE TRUE                                                34820000
348300         WHEN DL003-SUCCESSFUL                                    34830000
348400             EVALUATE TRUE                                        34840000
348500                 WHEN DL003-ASGMT-FOUND                           34850000
348600                      SET ASC-ASSOC-LABOR-ASGMT-YES  TO TRUE      34860000
348700                                                                  34870000
348800                      MOVE DL003-ASGMT-START-DTE                  34880000
348900                                 TO  PV-LABOR-ASGMT-STRT-DTE      34890000
349000                      MOVE DL003-ASGMT-NBR-TXT                    34900000
349100                                 TO  PV-LABOR-ASGMT-NBR-TXT       34910000
349200                      MOVE DL003-ASGMT-NBR-SEQ-NBR                34920000
349300                                 TO  PV-LABOR-ASGMT-NBR-SEQ-NBR   34930000
349400                                                                  34940000
349500                 WHEN DL003-ASGMT-NOT-FOUND                       34950000
349600                      IF  PS-LABOR-LOG-PHY-LBL                    34960000
349700                          PERFORM 3670-CREATE-DL-DUMMY-ASGMT      34970000
349800                      ELSE                                        34980000
349900                          SET ASC-ASSOC-LABOR-ASGMT-NO            34990000
350000                                     TO TRUE                      35000000
350100                          MOVE ASC-OPER-UNT-ID                    35010000
350200                                     TO PV-DISPLAY-OPER           35020000
350300                          MOVE ASC-PO-NBR                         35030000
350400                                     TO  PV-DISPLAY-PO-NBR        35040000
350500                          MOVE ASC-REC-SEQ-NBR                    35050000
350600                                     TO  PV-DISPLAY-RCVR-SEQ-NBR  35060000
350700                          STRING ' PCKCS710-3610- '               35070000
350800                                 PV-DISPLAY-OPER   '-'            35080000
350900                                 PV-DISPLAY-PO-NBR '-'            35090000
351000                                 PV-DISPLAY-RCVR-SEQ-NBR ' - '    35100000
351100                                 DL003-KEY-USER-ID ' - '          35110000
351200                                 'NO ACTIVE ASSIGNMENT'           35120000
351300                                                DELIMITED BY SIZE 35130000
351400                                           INTO PV-CICS-MSG-AREA2 35140000
351500                          MOVE LENGTH OF PV-CICS-MSG-AREA2        35150000
351600                                             TO PV-COMMAREA-LENGTH35160000
351700                          EXEC CICS                               35170000
351800                               WRITEQ TD                          35180000
351900                                QUEUE  ('CSSL')                   35190000
352000                                 FROM  (PV-CICS-MSG-AREA2)        35200000
352100                               LENGTH  (PV-COMMAREA-LENGTH)       35210000
352200                                 RESP  (PV-CICS-RESP)             35220000
352300                          END-EXEC                                35230000
352400                      END-IF                                      35240000
352500                                                                  35250000
352600                                                                  35260000
352700                 WHEN DL003-ASGMT-MULT-FOUND                      35270000
352800                      SET ASC-ASSOC-LABOR-ASGMT-YES TO TRUE       35280000
352900                      MOVE DL003-ASGMT-START-DTE                  35290000
353000                                 TO  PV-LABOR-ASGMT-STRT-DTE      35300000
353100                      MOVE DL003-ASGMT-NBR-TXT                    35310000
353200                                 TO  PV-LABOR-ASGMT-NBR-TXT       35320000
353300                      MOVE DL003-ASGMT-NBR-SEQ-NBR                35330000
353400                                 TO  PV-LABOR-ASGMT-NBR-SEQ-NBR   35340000
353500                                                                  35350000
353600                      MOVE ASC-OPER-UNT-ID                        35360000
353700                                     TO PV-DISPLAY-OPER           35370000
353800                      MOVE ASC-PO-NBR                             35380000
353900                                     TO  PV-DISPLAY-PO-NBR        35390000
354000                      MOVE ASC-REC-SEQ-NBR                        35400000
354100                                     TO  PV-DISPLAY-RCVR-SEQ-NBR  35410000
354200                      MOVE DL003-ASGMT-FOUND-QTY                  35420000
354300                                     TO  PV-DISPLAY-LABOR-ASGMTS  35430000
354400                      INITIALIZE PV-CICS-MSG-AREA                 35440000
354500                      STRING ' PCKCS710-3610- '                   35450000
354600                              PV-DISPLAY-OPER   '-'               35460000
354700                              PV-DISPLAY-PO-NBR '-'               35470000
354800                              PV-DISPLAY-RCVR-SEQ-NBR ' - '       35480000
354900                              DL003-KEY-USER-ID ' - '             35490000
355000                              'ASGMTS='                           35500000
355100                              PV-DISPLAY-LABOR-ASGMTS             35510000
355200                                                DELIMITED BY SIZE 35520000
355300                                           INTO PV-CICS-MSG-AREA2 35530000
355400                      MOVE LENGTH OF PV-CICS-MSG-AREA2            35540000
355500                                             TO PV-COMMAREA-LENGTH35550000
355600                      EXEC CICS                                   35560000
355700                           WRITEQ TD                              35570000
355800                            QUEUE  ('CSSL')                       35580000
355900                             FROM  (PV-CICS-MSG-AREA2)            35590000
356000                           LENGTH  (PV-COMMAREA-LENGTH)           35600000
356100                             RESP  (PV-CICS-RESP)                 35610000
356200                      END-EXEC                                    35620000
356300                                                                  35630000
356400                      INITIALIZE PV-CICS-MSG-AREA2                35640000
356500                      STRING ' PCKCS710-' DL003-USER-PGM          35650000
356600                             ' -- ' DL003-SQL-ERROR-PARA          35660000
356700                             ' -- ' DL003-CALL-MOD-FAIL-NM        35670000
356800                             ' -- ' DL003-CALL-MOD-FAIL-ERR-CDE   35680000
356900                                                DELIMITED BY SIZE 35690000
357000                                           INTO PV-CICS-MSG-AREA2 35700000
357100                      MOVE LENGTH OF PV-CICS-MSG-AREA2            35710000
357200                                             TO PV-COMMAREA-LENGTH35720000
357300                      EXEC CICS                                   35730000
357400                           WRITEQ TD                              35740000
357500                            QUEUE  ('CSSL')                       35750000
357600                             FROM  (PV-CICS-MSG-AREA2)            35760000
357700                           LENGTH  (PV-COMMAREA-LENGTH)           35770000
357800                             RESP  (PV-CICS-RESP)                 35780000
357900                     END-EXEC                                     35790000
358000                                                                  35800000
358100                                                                  35810000
358200             END-EVALUATE                                         35820000
358300                                                                  35830000
358400         WHEN DL003-SQL-CONTENTION                                35840000
358500              SET ASC-ASSOC-LABOR-ASGMT-NO  TO TRUE               35850000
358600              MOVE ASC-OPER-UNT-ID   TO PV-DISPLAY-OPER           35860000
358700              MOVE ASC-PO-NBR        TO PV-DISPLAY-PO-NBR         35870000
358800              MOVE ASC-REC-SEQ-NBR   TO PV-DISPLAY-RCVR-SEQ-NBR   35880000
358900              MOVE DL003-ASGMT-SQLCODE                            35890000
359000                                     TO PV-DISPLAY-SQLCODE        35900000
359100              INITIALIZE PV-CICS-MSG-AREA                         35910000
359200              STRING ' PCKCS710-3610- '                           35920000
359300                      PV-DISPLAY-OPER   '-'                       35930000
359400                      PV-DISPLAY-PO-NBR '-'                       35940000
359500                      PV-DISPLAY-RCVR-SEQ-NBR ' - '               35950000
359600                      DL003-KEY-USER-ID ' - '                     35960000
359700                     'SQLCODE=' PV-DISPLAY-SQLCODE                35970000
359800                     ' - CONTENTION'            DELIMITED BY SIZE 35980000
359900                                           INTO PV-CICS-MSG-AREA2 35990000
360000               MOVE LENGTH OF PV-CICS-MSG-AREA2                   36000000
360100                                             TO PV-COMMAREA-LENGTH36010000
360200               EXEC CICS                                          36020000
360300                    WRITEQ TD                                     36030000
360400                     QUEUE  ('CSSL')                              36040000
360500                      FROM  (PV-CICS-MSG-AREA2)                   36050000
360600                    LENGTH  (PV-COMMAREA-LENGTH)                  36060000
360700                      RESP  (PV-CICS-RESP)                        36070000
360800               END-EXEC                                           36080000
360900                                                                  36090000
361000               INITIALIZE PV-CICS-MSG-AREA2                       36100000
361100               STRING ' PCKCS710-' DL003-USER-PGM                 36110000
361200                      ' -- ' DL003-SQL-ERROR-PARA                 36120000
361300                      ' -- ' DL003-CALL-MOD-FAIL-NM               36130000
361400                      ' -- ' DL003-CALL-MOD-FAIL-ERR-CDE          36140000
361500                                                DELIMITED BY SIZE 36150000
361600                                           INTO PV-CICS-MSG-AREA2 36160000
361700               MOVE LENGTH OF PV-CICS-MSG-AREA2                   36170000
361800                                             TO PV-COMMAREA-LENGTH36180000
361900               EXEC CICS                                          36190000
362000                    WRITEQ TD                                     36200000
362100                     QUEUE  ('CSSL')                              36210000
362200                      FROM  (PV-CICS-MSG-AREA2)                   36220000
362300                    LENGTH  (PV-COMMAREA-LENGTH)                  36230000
362400                      RESP  (PV-CICS-RESP)                        36240000
362500              END-EXEC                                            36250000
362600                                                                  36260000
362700               MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER        36270000
362800               SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE            36280000
362900               PERFORM 9900-SOFT-ABORT                            36290000
363000                                                                  36300000
363100         WHEN DL003-SQL-ERROR                                     36310000
363200              SET ASC-ASSOC-LABOR-ASGMT-NO  TO TRUE               36320000
363300              MOVE ASC-OPER-UNT-ID   TO PV-DISPLAY-OPER           36330000
363400              MOVE ASC-PO-NBR        TO  PV-DISPLAY-PO-NBR        36340000
363500              MOVE ASC-REC-SEQ-NBR   TO  PV-DISPLAY-RCVR-SEQ-NBR  36350000
363600              MOVE DL003-ASGMT-SQLCODE                            36360000
363700                                     TO  PV-DISPLAY-SQLCODE       36370000
363800              INITIALIZE PV-CICS-MSG-AREA                         36380000
363900              STRING ' PCKCS710-3610- '                           36390000
364000                      PV-DISPLAY-OPER   '-'                       36400000
364100                      PV-DISPLAY-PO-NBR '-'                       36410000
364200                      PV-DISPLAY-RCVR-SEQ-NBR ' - '               36420000
364300                      DL003-KEY-USER-ID ' - '                     36430000
364400                     'SQLCODE=' PV-DISPLAY-SQLCODE                36440000
364500                     ' - SQL ERROR'             DELIMITED BY SIZE 36450000
364600                                           INTO PV-CICS-MSG-AREA2 36460000
364700               MOVE LENGTH OF PV-CICS-MSG-AREA2                   36470000
364800                                             TO PV-COMMAREA-LENGTH36480000
364900               EXEC CICS                                          36490000
365000                    WRITEQ TD                                     36500000
365100                     QUEUE  ('CSSL')                              36510000
365200                      FROM  (PV-CICS-MSG-AREA2)                   36520000
365300                    LENGTH  (PV-COMMAREA-LENGTH)                  36530000
365400                      RESP  (PV-CICS-RESP)                        36540000
365500               END-EXEC                                           36550000
365600                                                                  36560000
365700               INITIALIZE PV-CICS-MSG-AREA2                       36570000
365800               STRING ' PCKCS710-' DL003-USER-PGM                 36580000
365900                      ' -- ' DL003-SQL-ERROR-PARA                 36590000
366000                      ' -- ' DL003-CALL-MOD-FAIL-NM               36600000
366100                      ' -- ' DL003-CALL-MOD-FAIL-ERR-CDE          36610000
366200                                                DELIMITED BY SIZE 36620000
366300                                           INTO PV-CICS-MSG-AREA2 36630000
366400               MOVE LENGTH OF PV-CICS-MSG-AREA2                   36640000
366500                                             TO PV-COMMAREA-LENGTH36650000
366600               EXEC CICS                                          36660000
366700                    WRITEQ TD                                     36670000
366800                     QUEUE  ('CSSL')                              36680000
366900                      FROM  (PV-CICS-MSG-AREA2)                   36690000
367000                    LENGTH  (PV-COMMAREA-LENGTH)                  36700000
367100                      RESP  (PV-CICS-RESP)                        36710000
367200              END-EXEC                                            36720000
367300                                                                  36730000
367400               MOVE  PC-TSYMSG-00551  TO  DP020-MSG-NUMBER        36740000
367500               SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE            36750000
367600               PERFORM 9900-SOFT-ABORT                            36760000
367700                                                                  36770000
367800         WHEN DL003-CALLED-MODULE-FAILURE                         36780000
367900              SET ASC-ASSOC-LABOR-ASGMT-NO  TO TRUE               36790000
368000              MOVE ASC-OPER-UNT-ID   TO PV-DISPLAY-OPER           36800000
368100              MOVE ASC-PO-NBR        TO  PV-DISPLAY-PO-NBR        36810000
368200              MOVE ASC-REC-SEQ-NBR   TO  PV-DISPLAY-RCVR-SEQ-NBR  36820000
368300              MOVE DL003-ASGMT-SQLCODE                            36830000
368400                                     TO  PV-DISPLAY-SQLCODE       36840000
368500              INITIALIZE PV-CICS-MSG-AREA                         36850000
368600              STRING ' PCKCS710-3610- '                           36860000
368700                      PV-DISPLAY-OPER   '-'                       36870000
368800                      PV-DISPLAY-PO-NBR '-'                       36880000
368900                      PV-DISPLAY-RCVR-SEQ-NBR ' - '               36890000
369000                      DL003-KEY-USER-ID ' - '                     36900000
369100                     'SQLCODE=' PV-DISPLAY-SQLCODE                36910000
369200                     ' - CALL FAILED'           DELIMITED BY SIZE 36920000
369300                                           INTO PV-CICS-MSG-AREA2 36930000
369400               MOVE LENGTH OF PV-CICS-MSG-AREA2                   36940000
369500                                             TO PV-COMMAREA-LENGTH36950000
369600               EXEC CICS                                          36960000
369700                    WRITEQ TD                                     36970000
369800                     QUEUE  ('CSSL')                              36980000
369900                      FROM  (PV-CICS-MSG-AREA2)                   36990000
370000                    LENGTH  (PV-COMMAREA-LENGTH)                  37000000
370100                      RESP  (PV-CICS-RESP)                        37010000
370200               END-EXEC                                           37020000
370300                                                                  37030000
370400               INITIALIZE PV-CICS-MSG-AREA2                       37040000
370500               STRING ' PCKCS710-' DL003-USER-PGM                 37050000
370600                      ' -- ' DL003-SQL-ERROR-PARA                 37060000
370700                      ' -- ' DL003-CALL-MOD-FAIL-NM               37070000
370800                      ' -- ' DL003-CALL-MOD-FAIL-ERR-CDE          37080000
370900                                                DELIMITED BY SIZE 37090000
371000                                           INTO PV-CICS-MSG-AREA2 37100000
371100               MOVE LENGTH OF PV-CICS-MSG-AREA2                   37110000
371200                                             TO PV-COMMAREA-LENGTH37120000
371300               EXEC CICS                                          37130000
371400                    WRITEQ TD                                     37140000
371500                     QUEUE  ('CSSL')                              37150000
371600                      FROM  (PV-CICS-MSG-AREA2)                   37160000
371700                    LENGTH  (PV-COMMAREA-LENGTH)                  37170000
371800                      RESP  (PV-CICS-RESP)                        37180000
371900              END-EXEC                                            37190000
372000                                                                  37200000
372100               MOVE  PC-TSYMSG-00551  TO  DP020-MSG-NUMBER        37210000
372200               SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE            37220000
372300               PERFORM 9900-SOFT-ABORT                            37230000
372400                                                                  37240000
372500         WHEN DL003-INVALID-ACCESS                                37250000
372600              SET ASC-ASSOC-LABOR-ASGMT-NO  TO TRUE               37260000
372700              MOVE ASC-OPER-UNT-ID   TO PV-DISPLAY-OPER           37270000
372800              MOVE ASC-PO-NBR        TO  PV-DISPLAY-PO-NBR        37280000
372900              MOVE ASC-REC-SEQ-NBR   TO  PV-DISPLAY-RCVR-SEQ-NBR  37290000
373000              MOVE DL003-ASGMT-SQLCODE                            37300000
373100                                     TO  PV-DISPLAY-SQLCODE       37310000
373200              INITIALIZE PV-CICS-MSG-AREA                         37320000
373300              STRING ' PCKCS710-3610- '                           37330000
373400                      PV-DISPLAY-OPER   '-'                       37340000
373500                      PV-DISPLAY-PO-NBR '-'                       37350000
373600                      PV-DISPLAY-RCVR-SEQ-NBR ' - '               37360000
373700                      DL003-KEY-USER-ID ' - '                     37370000
373800                     'SQLCODE=' PV-DISPLAY-SQLCODE                37380000
373900                     ' - INVALID ACCESS'        DELIMITED BY SIZE 37390000
374000                                           INTO PV-CICS-MSG-AREA2 37400000
374100               MOVE LENGTH OF PV-CICS-MSG-AREA2                   37410000
374200                                             TO PV-COMMAREA-LENGTH37420000
374300               EXEC CICS                                          37430000
374400                    WRITEQ TD                                     37440000
374500                     QUEUE  ('CSSL')                              37450000
374600                      FROM  (PV-CICS-MSG-AREA2)                   37460000
374700                    LENGTH  (PV-COMMAREA-LENGTH)                  37470000
374800                      RESP  (PV-CICS-RESP)                        37480000
374900               END-EXEC                                           37490000
375000                                                                  37500000
375100               INITIALIZE PV-CICS-MSG-AREA2                       37510000
375200               STRING ' PCKCS710-' DL003-USER-PGM                 37520000
375300                      ' -- ' DL003-SQL-ERROR-PARA                 37530000
375400                      ' -- ' DL003-CALL-MOD-FAIL-NM               37540000
375500                      ' -- ' DL003-CALL-MOD-FAIL-ERR-CDE          37550000
375600                                                DELIMITED BY SIZE 37560000
375700                                           INTO PV-CICS-MSG-AREA2 37570000
375800               MOVE LENGTH OF PV-CICS-MSG-AREA2                   37580000
375900                                             TO PV-COMMAREA-LENGTH37590000
376000               EXEC CICS                                          37600000
376100                    WRITEQ TD                                     37610000
376200                     QUEUE  ('CSSL')                              37620000
376300                      FROM  (PV-CICS-MSG-AREA2)                   37630000
376400                    LENGTH  (PV-COMMAREA-LENGTH)                  37640000
376500                      RESP  (PV-CICS-RESP)                        37650000
376600              END-EXEC                                            37660000
376700                                                                  37670000
376800               MOVE  PC-TSYMSG-00551  TO  DP020-MSG-NUMBER        37680000
376900               SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE            37690000
377000               PERFORM 9900-SOFT-ABORT                            37700000
377100                                                                  37710000
377200         WHEN OTHER                                               37720000
377300              SET ASC-ASSOC-LABOR-ASGMT-NO  TO TRUE               37730000
377400              MOVE ASC-OPER-UNT-ID   TO  PV-DISPLAY-OPER          37740000
377500              MOVE ASC-PO-NBR        TO  PV-DISPLAY-PO-NBR        37750000
377600              MOVE ASC-REC-SEQ-NBR   TO  PV-DISPLAY-RCVR-SEQ-NBR  37760000
377700              MOVE DL003-ASGMT-SQLCODE                            37770000
377800                                     TO  PV-DISPLAY-SQLCODE       37780000
377900              INITIALIZE PV-CICS-MSG-AREA                         37790000
378000              STRING ' PCKCS710-3610- '                           37800000
378100                      PV-DISPLAY-OPER   '-'                       37810000
378200                      PV-DISPLAY-PO-NBR '-'                       37820000
378300                      PV-DISPLAY-RCVR-SEQ-NBR ' - '               37830000
378400                      DL003-KEY-USER-ID ' - '                     37840000
378500                     'SQLCODE=' PV-DISPLAY-SQLCODE                37850000
378600                     ' - OTHER - '                                37860000
378700                      DL003-RETURN-CODE         DELIMITED BY SIZE 37870000
378800                                           INTO PV-CICS-MSG-AREA2 37880000
378900               MOVE LENGTH OF PV-CICS-MSG-AREA2                   37890000
379000                                             TO PV-COMMAREA-LENGTH37900000
379100               EXEC CICS                                          37910000
379200                    WRITEQ TD                                     37920000
379300                     QUEUE  ('CSSL')                              37930000
379400                      FROM  (PV-CICS-MSG-AREA2)                   37940000
379500                    LENGTH  (PV-COMMAREA-LENGTH)                  37950000
379600                      RESP  (PV-CICS-RESP)                        37960000
379700               END-EXEC                                           37970000
379800                                                                  37980000
379900               MOVE  PC-TSYMSG-00551  TO  DP020-MSG-NUMBER        37990000
380000               SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE            38000000
380100               PERFORM 9900-SOFT-ABORT                            38010000
380200                                                                  38020000
380300     END-EVALUATE.                                                38030000
380400                                                                  38040000
380500                                                                  38050000
380600*----------------------------------------------------------------*38060000
380700* IF DC IS INTERFACING WITH THE DC LABOR SYSTEM, AND ASSOCIATE   *38070000
380800* IS CURRENTLY ACTIVE ON A LABOR ASSIGNMENT, GET THE NEXT NEXT   *38080000
380900* SEQUENCE NUMBER FOR THE LABOR SYSTEM.                          *38090000
381000*----------------------------------------------------------------*38100000
381100 3620-GET-LABOR-SEQ-NBR.                                          38110000
381200                                                                  38120000
381300     INITIALIZE DL001-ASGMT-COMMAREA.                             38130000
381400     SET DL001-BY-ASGMT-KEY                                       38140000
381500         DL001-COMMIT-UPDATE                                      38150000
381600         DL001-FIND-NEXT-ASGMT    TO TRUE.                        38160000
381700                                                                  38170000
381800     IF  PS-LABOR-USE-DUMMY-ASGMT-YES                             38180000
381900         MOVE DL007-NEW-START-DTE     TO DL001-KEY-START-DTE      38190000
382000         MOVE DL007-NEW-NBR-TXT       TO DL001-KEY-NBR-TXT        38200000
382100         MOVE DL007-NEW-ASGMT-NBR-SEQ-NBR                         38210000
382200                                      TO DL001-KEY-NBR-SEQ-NBR    38220000
382300     ELSE                                                         38230000
382400         MOVE DL003-ASGMT-START-DTE   TO DL001-KEY-START-DTE      38240000
382500         MOVE DL003-ASGMT-NBR-TXT     TO DL001-KEY-NBR-TXT        38250000
382600         MOVE DL003-ASGMT-NBR-SEQ-NBR TO DL001-KEY-NBR-SEQ-NBR    38260000
382700     END-IF.                                                      38270000
382800                                                                  38280000
382900     MOVE +1                      TO DL001-NBR-OF-NBRS-NEED-QTY.  38290000
383000                                                                  38300000
383100     SET DL001-FIND-NEXT-ASGMT    TO TRUE.                        38310000
383200                                                                  38320000
383300     MOVE PC-CURRENT-PROGRAM-NAME TO DL001-ORIG-CALLING-PGM-NM.   38330000
383400                                                                  38340000
383500     CALL DL001-USER-PGM USING DFHEIBLK                           38350000
383600                              DL001-COMMAREA                      38360000
383700                              DL001-ASGMT-COMMAREA.               38370000
383800                                                                  38380000
383900     EVALUATE TRUE                                                38390000
384000         WHEN DL001-SUCCESSFUL                                    38400000
384100              IF DL001-ASGMT-NEXT-USED                            38410000
384200                 SET  PS-LABOR-NEXT-SEQ-YES  TO  TRUE             38420000
384300                 MOVE DL001-NXT-START-DTE                         38430000
384400                                   TO PV-LABOR-ASGMT-STRT-DTE     38440000
384500                 MOVE DL001-NXT-NBR-TXT                           38450000
384600                                   TO PV-LABOR-ASGMT-NBR-TXT      38460000
384700                 MOVE DL001-NXT-NBR-SEQ-NBR                       38470000
384800                                   TO PV-LABOR-ASGMT-NBR-SEQ-NBR  38480000
384900                 MOVE DL001-SEQ-START-NBR                         38490000
385000                                   TO PV-LABOR-SEQ-START-NBR      38500000
385100              ELSE                                                38510000
385200                 SET  PS-LABOR-NEXT-SEQ-NO   TO  TRUE             38520000
385300                 MOVE DL001-SEQ-START-NBR                         38530000
385400                                   TO PV-LABOR-SEQ-START-NBR      38540000
385500              END-IF                                              38550000
385600                                                                  38560000
385700         WHEN OTHER                                               38570000
385800              SET  PS-LABOR-NEXT-SEQ-NO   TO  TRUE                38580000
385900              MOVE ASC-OPER-UNT-ID   TO  PV-DISPLAY-OPER          38590000
386000              MOVE ASC-PO-NBR        TO  PV-DISPLAY-PO-NBR        38600000
386100              MOVE ASC-REC-SEQ-NBR   TO  PV-DISPLAY-RCVR-SEQ-NBR  38610000
386200              MOVE DL001-ASGMT-SQLCODE                            38620000
386300                                     TO  PV-DISPLAY-SQLCODE       38630000
386400              INITIALIZE PV-CICS-MSG-AREA2                        38640000
386500              STRING ' PCKCS710-3620- '                           38650000
386600                      PV-DISPLAY-OPER   '-'                       38660000
386700                      PV-DISPLAY-PO-NBR '-'                       38670000
386800                      PV-DISPLAY-RCVR-SEQ-NBR ' - '               38680000
386900                      DP020-USERID ' - '                          38690000
387000                     'SQLCODE=' PV-DISPLAY-SQLCODE                38700000
387100                     ' - RETURN CODE=' DL001-RETURN-CODE          38710000
387200                                                DELIMITED BY SIZE 38720000
387300                                           INTO PV-CICS-MSG-AREA2 38730000
387400               MOVE LENGTH OF PV-CICS-MSG-AREA2                   38740000
387500                                             TO PV-COMMAREA-LENGTH38750000
387600               EXEC CICS                                          38760000
387700                    WRITEQ TD                                     38770000
387800                     QUEUE  ('CSSL')                              38780000
387900                      FROM  (PV-CICS-MSG-AREA2)                   38790000
388000                    LENGTH  (PV-COMMAREA-LENGTH)                  38800000
388100                      RESP  (PV-CICS-RESP)                        38810000
388200               END-EXEC                                           38820000
388300                                                                  38830000
388400              INITIALIZE PV-CICS-MSG-AREA2                        38840000
388500              STRING ' PCKCS710-' DL001-USER-PGM                  38850000
388600                      ' -- ' DL001-SQL-ERROR-PARA                 38860000
388700                      ' -- ' DL001-CALL-MOD-FAIL-NM               38870000
388800                      ' -- ' DL001-CALL-MOD-FAIL-ERR-CDE          38880000
388900                                                DELIMITED BY SIZE 38890000
389000                                           INTO PV-CICS-MSG-AREA2 38900000
389100               MOVE LENGTH OF PV-CICS-MSG-AREA2                   38910000
389200                                             TO PV-COMMAREA-LENGTH38920000
389300               EXEC CICS                                          38930000
389400                    WRITEQ TD                                     38940000
389500                     QUEUE  ('CSSL')                              38950000
389600                      FROM  (PV-CICS-MSG-AREA2)                   38960000
389700                    LENGTH  (PV-COMMAREA-LENGTH)                  38970000
389800                      RESP  (PV-CICS-RESP)                        38980000
389900               END-EXEC                                           38990000
390000                                                                  39000000
390100               MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER        39010000
390200               SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE            39020000
390300               PERFORM 9900-SOFT-ABORT                            39030000
390400                                                                  39040000
390500     END-EVALUATE.                                                39050000
390600                                                                  39060000
390700                                                                  39070000
390800*----------------------------------------------------------------*39080000
390900* SEND DATA TO EAI EXPORT DATABASE FOR LABOR SYSTEM              *39090000
391000*----------------------------------------------------------------*39100000
391100 3630-SEND-LABOR-TO-EAI.                                          39110000
391200                                                                  39120000
391300     PERFORM 3640-GET-TRIP-ID.                                    39130000
391400     PERFORM 3650-GET-DOOR-ID.                                    39140000
391500                                                                  39150000
391600     INITIALIZE XL072-EAI-EXPORT-COMMAREA.                        39160000
391700     SET XL072-PC-APP-ID                                          39170000
391800         XL072-DO-NOT-COMMIT-UPDATE TO TRUE.                      39180000
391900                                                                  39190000
392000     MOVE PC-CURRENT-PROGRAM-NAME TO XL072-CRE-PGM-NM.            39200000
392100                                                                  39210000
392200     MOVE ZEROES                  TO XL072-EVNT-KY-1-NBR          39220000
392300                                     XL072-EVNT-KY-2-NBR          39230000
392400                                     XL072-EVNT-KY-3-NBR          39240000
392500                                     XL072-EVNT-KY-4-NBR          39250000
392600                                     XL072-EVNT-KY-5-NBR.         39260000
392700     MOVE SPACES                  TO XL072-EVNT-KY-1-TXT          39270000
392800                                     XL072-EVNT-KY-2-TXT          39280000
392900                                     XL072-EVNT-KY-3-TXT          39290000
393000                                     XL072-EVNT-KY-4-TXT          39300000
393100                                     XL072-EVNT-KY-5-TXT          39310000
393200                                     XL072-EVNT-KY-1-TMST         39320000
393300                                     XL072-EVNT-KY-2-TMST         39330000
393400                                     XL072-EVNT-KY-3-TMST         39340000
393500                                     XL072-EVNT-KY-4-TMST         39350000
393600                                     XL072-EVNT-KY-5-TMST.        39360000
393700                                                                  39370000
393800     IF  PS-LABOR-LOG-PHY-LBL                                     39380000
393900         MOVE 'CARTON'            TO XL072-EVNT-OBJ-TXT           39390000
394000         MOVE 'NON UCC PRINT'     TO XL072-EVNT-OBJ-ACTN-TXT      39400000
394100         MOVE DP020-USERID        TO XL072-CRE-BY-USR-ID          39410000
394200         MOVE ASC-PO-NBR          TO XL072-EVNT-KY-1-NBR          39420000
394300         MOVE ASC-REC-SEQ-NBR     TO XL072-EVNT-KY-2-NBR          39430000
394400         MOVE SHIPMT-TRIP-ID      TO XL072-EVNT-KY-4-NBR          39440000
394500     ELSE                                                         39450000
394600         MOVE 'PO DOWNLOAD'       TO XL072-EVNT-OBJ-TXT           39460000
394700         MOVE 'DOWNLOAD PROCESS'  TO XL072-EVNT-OBJ-ACTN-TXT      39470000
394800         MOVE DP020-USERID        TO XL072-CRE-BY-USR-ID          39480000
394900         MOVE ASC-PO-NBR          TO XL072-EVNT-KY-1-NBR          39490000
395000         MOVE ASC-REC-SEQ-NBR     TO XL072-EVNT-KY-2-NBR          39500000
395100         MOVE SHIPMT-TRIP-ID      TO XL072-EVNT-KY-3-NBR          39510000
395200     END-IF.                                                      39520000
395300                                                                  39530000
395400     INITIALIZE PC242-DTL-TXT-AREA.                               39540000
395500                                                                  39550000
395600     IF  PS-LABOR-LOG-PHY-LBL                                     39560000
395700         SET PC242-NON-UCC-LBL-PRT      TO TRUE                   39570000
395800         MOVE PV-LABOR-ASGMT-STRT-DTE                             39580000
395900                                   TO PC242-AD-ASGMT-STRT-DTE     39590000
396000         MOVE PV-LABOR-ASGMT-NBR-TXT                              39600000
396100                                   TO PC242-AD-ASGMT-NBR-TXT      39610000
396200         MOVE PV-LABOR-ASGMT-NBR-SEQ-NBR                          39620000
396300                                   TO PC242-AD-ASGMT-NBR-SEQ-NBR  39630000
396400         MOVE PV-LABOR-SEQ-START-NBR                              39640000
396500                                   TO PC242-AD-ASGMT-SEQ-DTL-NBR  39650000
396600         MOVE SUT00040-DOOR-ID     TO PC242-AD-DOOR-NBR           39660000
396700         MOVE PC-Z                 TO PC242-AD-PACK-TYPE-CDE      39670000
396800         MOVE PV-LABOR-DUMMY-TK    TO PC242-AD-DUMMY-USER-ID      39680000
396900                                                                  39690000
397000         IF PV-STR-COUNT = 1                                      39700000
397100           MOVE SUT00003-STR-NBR TO PC242-AD-CRTN-DEST-LOC-NBR    39710000
397200           SET PC242-AD-CRTN-TO-LOC TO TRUE                       39720000
397300         END-IF                                                   39730000
397400         IF PV-STR-COUNT > 1                                      39740000
397500            MOVE +0    TO PC242-AD-CRTN-DEST-LOC-NBR              39750000
397600                          PV-MAX-CTN                              39760000
397700                          PV-SUM-UNT                              39770000
397800            SET PC242-AD-CRTN-TO-MULT-LOC TO TRUE                 39780000
397900         END-IF                                                   39790000
398000         MOVE SPACE                TO PC242-AD-P2L-MODU-DESC      39800000
398100         MOVE SPACE                TO PC242-AD-STR-ZN-ID          39810000
398200         MOVE PV-MAX-CTN-TOT       TO PC242-AD-CRSDCK-LABEL-QTY   39820000
398300         MOVE PV-SUM-UNT-TOT       TO PC242-AD-CRSDCK-UNIT-QTY    39830000
398400         MOVE +0                   TO PC242-AD-P2L-LABEL-QTY      39840000
398500         MOVE +0                   TO PC242-AD-P2L-UNIT-QTY       39850000
398600     ELSE                                                         39860000
398700         SET  PC242-DOWNLOAD-PO-PROCESS  TO TRUE                  39870000
398800         MOVE PV-LABOR-ASGMT-STRT-DTE                             39880000
398900                                   TO PC242-AA-ASGMT-STRT-DTE     39890000
399000         MOVE PV-LABOR-ASGMT-NBR-TXT                              39900000
399100                                   TO PC242-AA-ASGMT-NBR-TXT      39910000
399200         MOVE PV-LABOR-ASGMT-NBR-SEQ-NBR                          39920000
399300                                   TO PC242-AA-ASGMT-NBR-SEQ-NBR  39930000
399400         MOVE PV-LABOR-SEQ-START-NBR                              39940000
399500                                   TO PC242-AA-ASGMT-SEQ-DTL-NBR  39950000
399600         MOVE SUT00040-DOOR-ID     TO PC242-AA-DOOR-NBR           39960000
399700         MOVE PC-Z                 TO PC242-AA-PACK-TYPE-CDE      39970000
399800     END-IF.                                                      39980000
399900                                                                  39990000
400000                                                                  40000000
400100     SET  XL072-PCWS242-COPYBOOK   TO TRUE.                       40010000
400200     MOVE PC242-DTL-TXT-AREA       TO XL072-DTL-TXT.              40020000
400300                                                                  40030000
400400     CALL XL072-USER-PGM USING DFHEIBLK                           40040000
400500                              XL072-COMMAREA                      40050000
400600                              XL072-EAI-EXPORT-COMMAREA.          40060000
400700                                                                  40070000
400800     EVALUATE TRUE                                                40080000
400900         WHEN XL072-SUCCESSFUL                                    40090000
401000              CONTINUE                                            40100000
401100         WHEN OTHER                                               40110000
401200              MOVE ASC-OPER-UNT-ID   TO  PV-DISPLAY-OPER          40120000
401300              MOVE ASC-PO-NBR        TO  PV-DISPLAY-PO-NBR        40130000
401400              MOVE ASC-REC-SEQ-NBR   TO  PV-DISPLAY-RCVR-SEQ-NBR  40140000
401500              MOVE XL072-EAI-DB-SQLCODE                           40150000
401600                                     TO  PV-DISPLAY-SQLCODE       40160000
401700              INITIALIZE PV-CICS-MSG-AREA2                        40170000
401800              STRING ' PCKCS710-3630- '                           40180000
401900                      PV-DISPLAY-OPER   '-'                       40190000
402000                      PV-DISPLAY-PO-NBR '-'                       40200000
402100                      PV-DISPLAY-RCVR-SEQ-NBR ' - '               40210000
402200                      DP020-USERID ' - '                          40220000
402300                     'SQLCODE=' PV-DISPLAY-SQLCODE                40230000
402400                     ' - RETURN CODE=' XL072-RETURN-CODE          40240000
402500                     ' - ' PS-LABOR-LOGGING-LEVEL-SW              40250000
402600                     ' - ' PS-LABOR-PHY-LBL-P2L-SW                40260000
402700                     ' - ' PS-LABOR-PHY-LBL-SML-SW                40270000
402800                                                DELIMITED BY SIZE 40280000
402900                                           INTO PV-CICS-MSG-AREA2 40290000
403000               MOVE LENGTH OF PV-CICS-MSG-AREA2                   40300000
403100                                             TO PV-COMMAREA-LENGTH40310000
403200               EXEC CICS                                          40320000
403300                    WRITEQ TD                                     40330000
403400                     QUEUE  ('CSSL')                              40340000
403500                      FROM  (PV-CICS-MSG-AREA2)                   40350000
403600                    LENGTH  (PV-COMMAREA-LENGTH)                  40360000
403700                      RESP  (PV-CICS-RESP)                        40370000
403800               END-EXEC                                           40380000
403900                                                                  40390000
404000              INITIALIZE PV-CICS-MSG-AREA2                        40400000
404100              STRING ' PCKCS710-' XL072-USER-PGM                  40410000
404200                      ' -- ' XL072-SQL-ERROR-PARA                 40420000
404300                      ' -- ' XL072-CALL-MOD-FAIL-NM               40430000
404400                      ' -- ' XL072-CALL-MOD-FAIL-ERR-CDE          40440000
404500                                                DELIMITED BY SIZE 40450000
404600                                           INTO PV-CICS-MSG-AREA2 40460000
404700               MOVE LENGTH OF PV-CICS-MSG-AREA2                   40470000
404800                                             TO PV-COMMAREA-LENGTH40480000
404900               EXEC CICS                                          40490000
405000                    WRITEQ TD                                     40500000
405100                     QUEUE  ('CSSL')                              40510000
405200                      FROM  (PV-CICS-MSG-AREA2)                   40520000
405300                    LENGTH  (PV-COMMAREA-LENGTH)                  40530000
405400                      RESP  (PV-CICS-RESP)                        40540000
405500               END-EXEC                                           40550000
405600                                                                  40560000
405700              INITIALIZE PV-CICS-MSG-AREA2                        40570000
405800              STRING ' PCKCS710-' XL072-USER-PGM                  40580000
405900                      ' -- ' XL072-SQLCA                          40590000
406000                                                DELIMITED BY SIZE 40600000
406100                                           INTO PV-CICS-MSG-AREA2 40610000
406200               MOVE LENGTH OF PV-CICS-MSG-AREA2                   40620000
406300                                             TO PV-COMMAREA-LENGTH40630000
406400               EXEC CICS                                          40640000
406500                    WRITEQ TD                                     40650000
406600                     QUEUE  ('CSSL')                              40660000
406700                      FROM  (PV-CICS-MSG-AREA2)                   40670000
406800                    LENGTH  (PV-COMMAREA-LENGTH)                  40680000
406900                      RESP  (PV-CICS-RESP)                        40690000
407000               END-EXEC                                           40700000
407100                                                                  40710000
407200               MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER        40720000
407300               SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE            40730000
407400               PERFORM 9900-SOFT-ABORT                            40740000
407500                                                                  40750000
407600     END-EVALUATE.                                                40760000
407700                                                                  40770000
407800                                                                  40780000
407900 3640-GET-TRIP-ID.                                                40790000
408000     MOVE  ASC-PO-NBR        TO  DK-PO-NBR.                       40800000
408100     MOVE  ASC-REC-SEQ-NBR   TO  DK-REC-SEQ-NBR.                  40810000
408200                                                                  40820000
408300     EXEC SQL                                                     40830000
408400          SELECT  DISTINCT                                        40840000
408500                  B.TRIP_ID                                       40850000
408600            INTO :SHIPMT-TRIP-ID                                  40860000
408700            FROM  TSHPTPO A                                       40870000
408800                 ,TSHIPMT B                                       40880000
408900           WHERE  A.PO_NBR      = :DK-PO-NBR                      40890000
409000             AND  A.REC_SEQ_NBR = :DK-REC-SEQ-NBR                 40900000
409100             AND  A.SHIPT_ID    =  B.SHIPT_ID                     40910000
409200     END-EXEC                                                     40920000
409300                                                                  40930000
409400     EVALUATE TRUE                                                40940000
409500         WHEN SQLCODE = +0                                        40950000
409600         WHEN SQLCODE = -811                                      40960000
409700              CONTINUE                                            40970000
409800                                                                  40980000
409900         WHEN SQLWARN0 NOT = SPACE                                40990000
410000         WHEN SQLCODE < +0                                        41000000
410100         WHEN SQLCODE > +0                                        41010000
410200              MOVE ASC-OPER-UNT-ID   TO  PV-DISPLAY-OPER          41020000
410300              MOVE ASC-PO-NBR        TO  PV-DISPLAY-PO-NBR        41030000
410400              MOVE ASC-REC-SEQ-NBR   TO  PV-DISPLAY-RCVR-SEQ-NBR  41040000
410500              MOVE SQLCODE           TO  PV-DISPLAY-SQLCODE       41050000
410600              INITIALIZE PV-CICS-MSG-AREA2                        41060000
410700              STRING ' PCKCS710-3640- '                           41070000
410800                      PV-DISPLAY-OPER   '-'                       41080000
410900                      PV-DISPLAY-PO-NBR '-'                       41090000
411000                      PV-DISPLAY-RCVR-SEQ-NBR ' - '               41100000
411100                      DP020-USERID ' - '                          41110000
411200                     'SQLCODE=' PV-DISPLAY-SQLCODE                41120000
411300                                                DELIMITED BY SIZE 41130000
411400                                           INTO PV-CICS-MSG-AREA2 41140000
411500               MOVE LENGTH OF PV-CICS-MSG-AREA2                   41150000
411600                                             TO PV-COMMAREA-LENGTH41160000
411700               EXEC CICS                                          41170000
411800                    WRITEQ TD                                     41180000
411900                     QUEUE  ('CSSL')                              41190000
412000                      FROM  (PV-CICS-MSG-AREA2)                   41200000
412100                    LENGTH  (PV-COMMAREA-LENGTH)                  41210000
412200                      RESP  (PV-CICS-RESP)                        41220000
412300               END-EXEC                                           41230000
412400                                                                  41240000
412500               MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER        41250000
412600               SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE            41260000
412700               PERFORM 9900-SOFT-ABORT                            41270000
412800                                                                  41280000
412900     END-EVALUATE.                                                41290000
413000                                                                  41300000
413100                                                                  41310000
413200 3650-GET-DOOR-ID.                                                41320000
413300                                                                  41330000
413400     EXEC SQL                                                     41340000
413500          SELECT  A.DOOR_ID                                       41350000
413600            INTO :SUT00040-DOOR-ID                                41360000
413700            FROM  SUT_INBD_TRIP_DOOR A                            41370000
413800           WHERE  A.TRIP_ID  =  :SHIPMT-TRIP-ID                   41380000
413900             AND  A.CRE_TMST  IN                                  41390000
414000                  (SELECT  MAX(B.CRE_TMST)                        41400000
414100                     FROM  SUT_INBD_TRIP_DOOR B                   41410000
414200                    WHERE  A.TRIP_ID  =  B.TRIP_ID)               41420000
414300     END-EXEC                                                     41430000
414400                                                                  41440000
414500     EVALUATE TRUE                                                41450000
414600         WHEN SQLCODE = +0                                        41460000
414700         WHEN SQLCODE = -811                                      41470000
414800              CONTINUE                                            41480000
414900                                                                  41490000
415000         WHEN SQLCODE = +100                                      41500000
415100              MOVE SPACES  TO  SUT00040-DOOR-ID                   41510000
415200                                                                  41520000
415300         WHEN SQLWARN0 NOT = SPACE                                41530000
415400         WHEN SQLCODE < +0                                        41540000
415500         WHEN SQLCODE > +0                                        41550000
415600              MOVE ASC-OPER-UNT-ID   TO  PV-DISPLAY-OPER          41560000
415700              MOVE ASC-PO-NBR        TO  PV-DISPLAY-PO-NBR        41570000
415800              MOVE ASC-REC-SEQ-NBR   TO  PV-DISPLAY-RCVR-SEQ-NBR  41580000
415900              MOVE SQLCODE           TO  PV-DISPLAY-SQLCODE       41590000
416000              INITIALIZE PV-CICS-MSG-AREA2                        41600000
416100              STRING ' PCKCS710-3650- '                           41610000
416200                      PV-DISPLAY-OPER   '-'                       41620000
416300                      PV-DISPLAY-PO-NBR '-'                       41630000
416400                      PV-DISPLAY-RCVR-SEQ-NBR ' - '               41640000
416500                      DP020-USERID ' - '                          41650000
416600                     'SQLCODE=' PV-DISPLAY-SQLCODE                41660000
416700                                                DELIMITED BY SIZE 41670000
416800                                           INTO PV-CICS-MSG-AREA2 41680000
416900               MOVE LENGTH OF PV-CICS-MSG-AREA2                   41690000
417000                                             TO PV-COMMAREA-LENGTH41700000
417100               EXEC CICS                                          41710000
417200                    WRITEQ TD                                     41720000
417300                     QUEUE  ('CSSL')                              41730000
417400                      FROM  (PV-CICS-MSG-AREA2)                   41740000
417500                    LENGTH  (PV-COMMAREA-LENGTH)                  41750000
417600                      RESP  (PV-CICS-RESP)                        41760000
417700               END-EXEC                                           41770000
417800                                                                  41780000
417900               MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER        41790000
418000               SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE            41800000
418100               PERFORM 9900-SOFT-ABORT                            41810000
418200                                                                  41820000
418300     END-EVALUATE.                                                41830000
418400                                                                  41840000
418500                                                                  41850000
418600*----------------------------------------------------------------*41860000
418700* GET DUMMY LABOR TK - USED FOR PHYSICAL LABELS                  *41870000
418800*----------------------------------------------------------------*41880000
418900 3660-GET-DUMMY-LABOR-TK.                                         41890000
419000                                                                  41900000
419100     MOVE DP020-LOCATION-NBR TO  DK-LABOR-OPER.                   41910000
419200                                                                  41920000
419300     EXEC SQL                                                     41930000
419400          SELECT  FUNC_TXT                                        41940000
419500            INTO :KRPRPM-FUNC-TXT                                 41950000
419600            FROM  TKRPRPM                                         41960000
419700           WHERE  LOC_ID            = :DK-LABOR-OPER              41970000
419800             AND  INTFC_SYS_CDE     = 'DLX'                       41980000
419900             AND  SYS_PRC_FUNC_CDE  = 'DLPLDU'                    41990000
420000     END-EXEC.                                                    42000000
420100                                                                  42010000
420200     EVALUATE TRUE                                                42020000
420300                                                                  42030000
420400         WHEN SQLCODE = +0                                        42040000
420500              MOVE  KRPRPM-FUNC-TXT  TO  PV-LABOR-DUMMY-TK        42050000
420600              SET  PS-LABOR-HAVE-DUMMY-TK-YES  TO  TRUE           42060000
420700                                                                  42070000
420800         WHEN SQLCODE = -904                                      42080000
420900         WHEN SQLCODE = -911                                      42090000
421000         WHEN SQLCODE = -913                                      42100000
421100              MOVE SQLCODE                   TO PV-SOFT-SQLCODE   42110000
421200              MOVE '3660-GET-DUMMY-LABOR-TK' TO PV-SOFT-PARAGRAPH 42120000
421300              MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2 42130000
421400              MOVE LENGTH OF PV-CICS-MSG-AREA2                    42140000
421500                TO PV-COMMAREA-LENGTH                             42150000
421600              EXEC CICS                                           42160000
421700                   WRITEQ TD                                      42170000
421800                    QUEUE  ('CSSL')                               42180000
421900                     FROM  (PV-CICS-MSG-AREA2)                    42190000
422000                   LENGTH  (PV-COMMAREA-LENGTH)                   42200000
422100                     RESP  (PV-CICS-RESP)                         42210000
422200              END-EXEC                                            42220000
422300             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          42230000
422400             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              42240000
422500             PERFORM 9900-SOFT-ABORT                              42250000
422600                                                                  42260000
422700         WHEN SQLWARN0 NOT = SPACES                               42270000
422800         WHEN SQLCODE < +0                                        42280000
422900         WHEN SQLCODE > +0                                        42290000
423000              MOVE '3660-GET-DUMMY-LABOR-TK'                      42300000
423100                                 TO DP013-PARAGRAPH               42310000
423200              MOVE 'GET DUMMY LABOR TK FOR PHYSICAL LABELS '      42320000
423300                                 TO DP013-MESSAGE-TEXT (1)        42330000
423400              MOVE SQLCA         TO DP013-SQLCA                   42340000
423500              MOVE 'TKRPRPM'     TO DP013-DB2-TABLE-NAME (1)      42350000
423600              SET DP013-DB2-ABEND                                 42360000
423700                  DP013-XCTL-DISPLAY-RESTART                      42370000
423800                                 TO TRUE                          42380000
423900              PERFORM DP013-0000-PROCESS-ABEND                    42390000
424000     END-EVALUATE.                                                42400000
424100                                                                  42410000
424200                                                                  42420000
424300*----------------------------------------------------------------*42430000
424400* IF PHYSICAL LABELS AND DUMMY USER IS NOT PART OF ACTIVE        *42440000
424500* DL LABOR ASSIGNMENT - CALL MODULE TO CREATE NEW ASSIGMENT      *42450000
424600*----------------------------------------------------------------*42460000
424700 3670-CREATE-DL-DUMMY-ASGMT.                                      42470000
424800                                                                  42480000
424900     SET  DL007-CREATE-NEW-ASGMT-WTEAM                            42490000
425000          DL007-COMMIT-UPDATE                                     42500000
425100          DL007-NO-LOG-TO-EAI-EXPORT                              42510000
425200          DL007-USR-IS-TMP              TO  TRUE.                 42520000
425300                                                                  42530000
425400     PERFORM 3680-GET-LABOR-DATE-TIME.                            42540000
425500     MOVE PV-LABOR-CURRENT-DATE   TO  DL007-NA-FLD-START-DTE.     42550000
425600     MOVE PV-LABOR-CURRENT-TIME   TO  DL007-NA-FLD-START-TM.      42560000
425700                                                                  42570000
425800     MOVE ASC-OPER-UNT-ID         TO  DL011-KEY-ASGMT-NBR-DC.     42580000
425900     SET  DL011-AN-RLABL-WRK-TYP  TO  TRUE.                       42590000
426000     MOVE DL011-KEY-ASGMT-NBR-TXT TO  DL007-NA-FLD-NBR-TXT.       42600000
426100                                                                  42610000
426200     MOVE PV-LABOR-DUMMY-TK       TO  DL007-NA-FLD-CRE-BY-USR-ID. 42620000
426300                                                                  42630000
426400     MOVE PC-CURRENT-PROGRAM-NAME TO  DL007-NA-FLD-CRE-PGM-NM     42640000
426500                                      DL007-ORIG-CALLING-PGM-NM.  42650000
426600                                                                  42660000
426700     SET  DL011-RLABL-WRK-TYP     TO  TRUE.                       42670000
426800     MOVE DL011-KEY-WK-TYP        TO  DL007-NA-FLD-WK-TYP-DESC.   42680000
426900                                                                  42690000
427000     MOVE PV-LABOR-DUMMY-TK       TO  DL011-RL-WRK-AREA-USER-ID.  42700000
427100     MOVE DL011-RLABL-WRK-AREA    TO  DL007-NA-FLD-WK-AREA-DESC.  42710000
427200                                                                  42720000
427300     MOVE ASC-OPER-UNT-ID         TO  DL007-NA-FLD-DC-NBR.        42730000
427400                                                                  42740000
427500     CALL DL007-USER-PGM USING DFHEIBLK                           42750000
427600                               DL007-COMMAREA                     42760000
427700                               DL007-ASGMT-COMMAREA.              42770000
427800                                                                  42780000
427900     EVALUATE TRUE                                                42790000
428000         WHEN DL007-SUCCESSFUL                                    42800000
428100              SET  ASC-ASSOC-LABOR-ASGMT-YES                      42810000
428200                   PS-LABOR-USE-DUMMY-ASGMT-YES TO TRUE           42820000
428300                                                                  42830000
428400              MOVE DL007-NEW-START-DTE                            42840000
428500                         TO  PV-LABOR-ASGMT-STRT-DTE              42850000
428600              MOVE DL007-NEW-NBR-TXT                              42860000
428700                         TO  PV-LABOR-ASGMT-NBR-TXT               42870000
428800              MOVE DL007-NEW-ASGMT-NBR-SEQ-NBR                    42880000
428900                         TO  PV-LABOR-ASGMT-NBR-SEQ-NBR           42890000
429000                                                                  42900000
429100         WHEN OTHER                                               42910000
429200              MOVE ASC-OPER-UNT-ID   TO  PV-DISPLAY-OPER          42920000
429300              MOVE ASC-PO-NBR        TO  PV-DISPLAY-PO-NBR        42930000
429400              MOVE ASC-REC-SEQ-NBR   TO  PV-DISPLAY-RCVR-SEQ-NBR  42940000
429500              MOVE DL007-ASGMT-SQLCODE                            42950000
429600                                     TO  PV-DISPLAY-SQLCODE       42960000
429700              INITIALIZE PV-CICS-MSG-AREA2                        42970000
429800              STRING ' PCKCS710-3670- '                           42980000
429900                      PV-DISPLAY-OPER   '-'                       42990000
430000                      PV-DISPLAY-PO-NBR '-'                       43000000
430100                      PV-DISPLAY-RCVR-SEQ-NBR ' - '               43010000
430200                      DP020-USERID ' - '                          43020000
430300                      PV-LABOR-DUMMY-TK ' - '                     43030000
430400                     'SQLCODE=' PV-DISPLAY-SQLCODE                43040000
430500                     ' - RETURN CODE=' DL007-RETURN-CODE          43050000
430600                                                DELIMITED BY SIZE 43060000
430700                                           INTO PV-CICS-MSG-AREA2 43070000
430800               MOVE LENGTH OF PV-CICS-MSG-AREA2                   43080000
430900                                             TO PV-COMMAREA-LENGTH43090000
431000               EXEC CICS                                          43100000
431100                    WRITEQ TD                                     43110000
431200                     QUEUE  ('CSSL')                              43120000
431300                      FROM  (PV-CICS-MSG-AREA2)                   43130000
431400                    LENGTH  (PV-COMMAREA-LENGTH)                  43140000
431500                      RESP  (PV-CICS-RESP)                        43150000
431600               END-EXEC                                           43160000
431700                                                                  43170000
431800              INITIALIZE PV-CICS-MSG-AREA2                        43180000
431900              STRING ' PCKCS710-' DL007-USER-PGM                  43190000
432000                      ' -- ' DL007-SQL-ERROR-PARA                 43200000
432100                      ' -- ' DL007-CALL-MOD-FAIL-NM               43210000
432200                      ' -- ' DL007-CALL-MOD-FAIL-ERR-CDE          43220000
432300                                                DELIMITED BY SIZE 43230000
432400                                           INTO PV-CICS-MSG-AREA2 43240000
432500               MOVE LENGTH OF PV-CICS-MSG-AREA2                   43250000
432600                                             TO PV-COMMAREA-LENGTH43260000
432700               EXEC CICS                                          43270000
432800                    WRITEQ TD                                     43280000
432900                     QUEUE  ('CSSL')                              43290000
433000                      FROM  (PV-CICS-MSG-AREA2)                   43300000
433100                    LENGTH  (PV-COMMAREA-LENGTH)                  43310000
433200                      RESP  (PV-CICS-RESP)                        43320000
433300               END-EXEC                                           43330000
433400                                                                  43340000
433500              INITIALIZE PV-CICS-MSG-AREA2                        43350000
433600              STRING ' PCKCS710-' DL007-USER-PGM                  43360000
433700                      ' DL007-NA-FLD-WK-TYP-DESC='                43370000
433800                      DL007-NA-FLD-WK-TYP-DESC                    43380000
433900                                                DELIMITED BY SIZE 43390000
434000                                           INTO PV-CICS-MSG-AREA2 43400000
434100               MOVE LENGTH OF PV-CICS-MSG-AREA2                   43410000
434200                                             TO PV-COMMAREA-LENGTH43420000
434300               EXEC CICS                                          43430000
434400                    WRITEQ TD                                     43440000
434500                     QUEUE  ('CSSL')                              43450000
434600                      FROM  (PV-CICS-MSG-AREA2)                   43460000
434700                    LENGTH  (PV-COMMAREA-LENGTH)                  43470000
434800                      RESP  (PV-CICS-RESP)                        43480000
434900               END-EXEC                                           43490000
435000                                                                  43500000
435100                                                                  43510000
435200              INITIALIZE PV-CICS-MSG-AREA2                        43520000
435300              STRING ' PCKCS710-' DL007-USER-PGM                  43530000
435400                      ' DL007-NA-FLD-WK-AREA-DESC='               43540000
435500                      DL007-NA-FLD-WK-AREA-DESC                   43550000
435600                                                DELIMITED BY SIZE 43560000
435700                                           INTO PV-CICS-MSG-AREA2 43570000
435800               MOVE LENGTH OF PV-CICS-MSG-AREA2                   43580000
435900                                             TO PV-COMMAREA-LENGTH43590000
436000               EXEC CICS                                          43600000
436100                    WRITEQ TD                                     43610000
436200                     QUEUE  ('CSSL')                              43620000
436300                      FROM  (PV-CICS-MSG-AREA2)                   43630000
436400                    LENGTH  (PV-COMMAREA-LENGTH)                  43640000
436500                      RESP  (PV-CICS-RESP)                        43650000
436600               END-EXEC                                           43660000
436700                                                                  43670000
436800               MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER        43680000
436900               SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE            43690000
437000               PERFORM 9900-SOFT-ABORT                            43700000
437100                                                                  43710000
437200     END-EVALUATE.                                                43720000
437300                                                                  43730000
437400                                                                  43740000
437500                                                                  43750000
437600 3680-GET-LABOR-DATE-TIME.                                        43760000
437700                                                                  43770000
437800     EXEC SQL                                                     43780000
437900          SET  :PV-LABOR-CURRENT-DATE  =  CURRENT_DATE            43790000
438000              ,:PV-LABOR-CURRENT-TIME  =  CURRENT_TIME            43800000
438100     END-EXEC.                                                    43810000
438200                                                                  43820000
438300* DMH - 1/23/04 - LABOR - END                                    *43830000
438400                                                                  43840000
438500*----------------------------------------------------------------*43850000
438600*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *43860000
438700*    INITIALIZE ALL COUNTERS AND FLAGS.                          *43870000
438800*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *43880000
438900*    DISPLAY THE PANEL TO USER.                                  *43890000
439000*----------------------------------------------------------------*43900000
439100                                                                  43910000
439200 4000-BUILD-INITIAL-PANEL.                                        43920000
439300                                                                  43930000
439400     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            43940000
439500                                 ASC-BLOCK-ENTRIES (2).           43950000
439600     MOVE +1                 TO ASC-BLK-SUB.                      43960000
439700     SET ASC-ITEMS-LEFT-ON-DB                                     43970000
439800                             TO TRUE.                             43980000
439900                                                                  43990000
440000     MOVE +0                 TO ASC-ITEM-SUB                      44000000
440100                                ASC-NUMBER-OF-ITEMS-READ          44010000
440200                                ASC-NUMBER-OF-SELECTED-ITEMS      44020000
440300                                ASC-HIGHEST-BLOCK-WRITTEN         44030000
440400                                ASC-START-OF-SELECTED-RANGE       44040000
440500                                ASC-END-OF-SELECTED-RANGE         44050000
440600                                ASC-ITEM-AT-TOP-OF-PANEL          44060000
440700                                ASC-TOTAL-UNITS                   44070000
440800                                ASC-TOTAL-CART.                   44080000
440900     PERFORM 4100-PREPARE-CURSOR.                                 44090000
441000                                                                  44100000
441100     PERFORM 4010-OPEN-STORE-LIST-CSR.                            44110000
441200                                                                  44120000
441300     PERFORM 4300-READ-ITEMS-FROM-DB.                             44130000
441400                                                                  44140000
441500     PERFORM 4020-CLOSE-STORE-LIST-CSR.                           44150000
441600                                                                  44160000
441700     MOVE +1                   TO  PV-TOP-ITEM.                   44170000
441800     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          44180000
441900         SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    44190000
442000         SET DP020-MSG-FATAL   TO  TRUE                           44200000
442100         MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               44210000
442200     ELSE                                                         44220000
442300         MOVE -1               TO MR-SELECTL (1)                  44230000
442400         SET DP030-SET-CURSOR-APPL-1                              44240000
442500                               TO TRUE                            44250000
442600         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     44260000
442700     END-IF.                                                      44270000
442800                                                                  44280000
442810* BBR WR41309 - RFID PROCESSING                                   44281000
442820     PERFORM 4635-DETERMINE-AUTO-CVY-MODE.                        44282000
442830* BBR WR41309 - END                                               44283000
442840                                                                  44284000
442850*----------------------------------------------------------------*44285000
442860* OPEN THE STORE LIST CURSOR                                     *44286000
442870*----------------------------------------------------------------*44287000
442880 4010-OPEN-STORE-LIST-CSR.                                        44288000
442890                                                                  44289000
442900     PERFORM                                                      44290000
443000         WITH TEST AFTER                                          44300000
443100         VARYING PV-RETRY-COUNTER                                 44310000
443200         FROM 1 BY 1                                              44320000
443300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               44330000
443400                   OR (SQLCODE = ZERO))                           44340000
443500                 EXEC SQL                                         44350000
443600                      OPEN STORE-LIST-CSR                         44360000
443700                 END-EXEC                                         44370000
443800                                                                  44380000
443900                                                                  44390000
444000         EVALUATE TRUE                                            44400000
444100             WHEN SQLCODE = ZERO                                  44410000
444200             WHEN SQLCODE = -904                                  44420000
444300             WHEN SQLCODE = -913                                  44430000
444400                 CONTINUE                                         44440000
444500             WHEN SQLWARN0 NOT = SPACES                           44450000
444600             WHEN SQLCODE < ZERO                                  44460000
444700             WHEN SQLCODE > ZERO                                  44470000
444800                 MOVE '4010-OPEN-STORE-LIST-CSR'                  44480000
444900                                   TO DP013-PARAGRAPH             44490000
445000                 MOVE 'OPEN STORE LIST CURSOR-'                   44500000
445100                                   TO DP013-MESSAGE-TEXT (1)      44510000
445200                 MOVE SQLCA        TO DP013-SQLCA                 44520000
445300                 MOVE 'TPKSLIP '   TO DP013-DB2-TABLE-NAME (1)    44530000
445400                 SET DP013-DB2-ABEND                              44540000
445500                     DP013-XCTL-DISPLAY-RESTART TO TRUE           44550000
445600                 PERFORM DP013-0000-PROCESS-ABEND                 44560000
445700         END-EVALUATE                                             44570000
445800     END-PERFORM.                                                 44580000
445900                                                                  44590000
446000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    44600000
446100         SQLCODE NOT = ZERO                                       44610000
446200         MOVE '4010-OPEN-STORE-LIST-CSR'   TO DP013-PARAGRAPH     44620000
446300         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   44630000
446400                                   TO DP013-MESSAGE-TEXT (1)      44640000
446500         MOVE SQLCA                TO DP013-SQLCA                 44650000
446600         MOVE 'TPKSLIP '           TO DP013-DB2-TABLE-NAME (1)    44660000
446700         SET DP013-DB2-ABEND                                      44670000
446800             DP013-XCTL-DISPLAY-RESTART                           44680000
446900                                   TO TRUE                        44690000
447000         PERFORM DP013-0000-PROCESS-ABEND                         44700000
447100     END-IF.                                                      44710000
447200                                                                  44720000
447300******************************************************************44730000
447400*  CLOSE EXPECTED CURSOR                                       * *44740000
447500******************************************************************44750000
447600 4020-CLOSE-STORE-LIST-CSR.                                       44760000
447700         EXEC SQL                                                 44770000
447800             CLOSE STORE-LIST-CSR                                 44780000
447900         END-EXEC                                                 44790000
448000                                                                  44800000
448100     EVALUATE TRUE                                                44810000
448200         WHEN SQLCODE = ZERO                                      44820000
448300             CONTINUE                                             44830000
448400         WHEN SQLWARN0 NOT = SPACES                               44840000
448500         WHEN SQLCODE < ZERO                                      44850000
448600         WHEN SQLCODE > ZERO                                      44860000
448700             MOVE '4020-CLOSE-STORE-LIST-CSR'                     44870000
448800                               TO DP013-PARAGRAPH                 44880000
448900             MOVE 'CLOSE STORE CURSOR '                           44890000
449000                               TO DP013-MESSAGE-TEXT (1)          44900000
449100             MOVE SQLCA        TO DP013-SQLCA                     44910000
449200             MOVE 'TPKSLIP '   TO DP013-DB2-TABLE-NAME (1)        44920000
449300             SET DP013-DB2-ABEND                                  44930000
449400                 DP013-XCTL-DISPLAY-RESTART TO TRUE               44940000
449500             PERFORM DP013-0000-PROCESS-ABEND                     44950000
449600     END-EVALUATE.                                                44960000
449700                                                                  44970000
449800*----------------------------------------------------------------*44980000
449900*    SET UP THE HOST VARIABLES.                                  *44990000
450000*----------------------------------------------------------------*45000000
450100 4100-PREPARE-CURSOR.                                             45010000
450200                                                                  45020000
450300     MOVE ASC-OPER-UNT-ID       TO DK-OPER-UNT-ID.                45030000
450400     MOVE ASC-FCLTY-ID          TO DK-FCLTY-ID.                   45040000
450500     MOVE ASC-PO-NBR            TO DK-PO-NBR.                     45050000
450600     MOVE ASC-REC-SEQ-NBR       TO PV-RECEIVER-N                  45060000
450700                                   DK-REC-SEQ-NBR                 45070000
450800                                   DK-RECEIVER.                   45080000
450900                                                                  45090000
451000******************************************************************45100000
451100 4150-GET-DEPT-VENDOR.                                            45110000
451200                                                                  45120000
451300     EXEC SQL                                                     45130000
451400          SELECT DEPT_NBR                                         45140000
451500                ,ENT_NAME_DESC                                    45150000
451600          INTO  :PURCHS-DEPT-NBR                                  45160000
451700               ,:ENTNME-ENT-NAME-DESC                             45170000
451800           FROM TPURCHS A                                         45180000
451900               ,TENTNME B                                         45190000
452000          WHERE A.PO_NBR           = :DK-PO-NBR                   45200000
452100            AND A.VER_STATUS_CDE   = 'A'                          45210000
452200            AND A.ENT_ID           =  B.ENT_ID                    45220000
452300            AND B.TYPE_CDE         = :PC-01                       45230000
452400     END-EXEC                                                     45240000
452500                                                                  45250000
452600                                                                  45260000
452700     EVALUATE TRUE                                                45270000
452800         WHEN SQLCODE = ZERO                                      45280000
452900              MOVE ENTNME-ENT-NAME-DESC TO   ASC-VENDOR-NAME      45290000
453000              MOVE PURCHS-DEPT-NBR      TO   ASC-DEPT             45300000
453100         WHEN SQLCODE = +100                                      45310000
453200              MOVE PC-TSYMSG-00954       TO DP020-MSG-NUMBER      45320000
453300              SET  PS-COMMAREA-NOT-VALID TO TRUE                  45330000
453400         WHEN SQLCODE = -811                                      45340000
453500         WHEN SQLWARN0 NOT = SPACE                                45350000
453600         WHEN SQLCODE NOT = ZERO                                  45360000
453700              MOVE  DK-PO-NBR  TO PV-DISPLAY-PO-NBR               45370000
453800              MOVE  ASC-REC-SEQ-NBR TO PV-DISPLAY-RCVR            45380000
453900              MOVE '4150-GET-DEPT-VENDOR'                         45390000
454000                               TO DP013-PARAGRAPH                 45400000
454100              MOVE 'SELECT DEPT NUMBER '                          45410000
454200                               TO DP013-MESSAGE-TEXT (1)          45420000
454300              STRING 'PO/RCVR '           DELIMITED BY SIZE       45430000
454400                     PV-DISPLAY-PO-NBR    DELIMITED BY SIZE       45440000
454500                     '-'                  DELIMITED BY SIZE       45450000
454600                     PV-DISPLAY-RCVR      DELIMITED BY '  '       45460000
454700                                     INTO DP013-MESSAGE-TEXT (2)  45470000
454800              MOVE 'TPKSLIP '  TO DP013-DB2-TABLE-NAME (1)        45480000
454900              MOVE SQLCA       TO DP013-SQLCA                     45490000
455000              SET DP013-DB2-ABEND                                 45500000
455100                               TO TRUE                            45510000
455200              PERFORM DP013-0000-PROCESS-ABEND                    45520000
455300     END-EVALUATE.                                                45530000
455400                                                                  45540000
455500 4200-PHY-INV-PROCESS-CHECK.                                      45550000
455600      SET PS-NOT-PHYSICAL-INV TO TRUE.                            45560000
455700      MOVE XL071-ASGMT-DC-NBR  TO PV-DC-SRVCNG-STR.               45570000
455800      MOVE PV-DC-SRVCNG-STR TO DK-OPER-UNT-ID-2.                  45580000
455900                                                                  45590000
456000      PERFORM 4270-SEL-KRPRPM-FUNC-QTY.                           45600000
456100      PERFORM 4280-READ-INV-PARM.                                 45610000
456200                                                                  45620000
456300*PHYSICAL INVENTORY CYCLE SMOOTHING CHANGE MADE HERE              45630000
456400      IF (PV-CURRENT-DATE >= PV-PLND-INV-DTE-FUNC-QTY             45640000
456500          AND PV-CURRENT-DATE <= XLT00025-PLND-INV-DTE)           45650000
456600         IF  ASC-NBR-CARTONS (ASC-BLK-SUB ASC-ITEM-SUB) = 1       45660000
456700             SET ASC-PHY-INV-STORE (ASC-BLK-SUB ASC-ITEM-SUB)     45670000
456800                                             TO TRUE              45680000
456900         ELSE                                                     45690000
457000            IF  ASC-NBR-CARTONS (ASC-BLK-SUB ASC-ITEM-SUB) > 1    45700000
457100                PERFORM 4205-GET-CARTON-SKU-COUNT                 45710000
457200                IF PV-CARTON-SKU-COUNT = 1                        45720000
457300                  SET ASC-PHY-INV-STORE (ASC-BLK-SUB ASC-ITEM-SUB)45730000
457400                                             TO TRUE              45740000
457500                   CONTINUE                                       45750000
457600                ELSE                                              45760000
457700                   SET PS-PHYSICAL-INV TO TRUE                    45770000
457800                END-IF                                            45780000
457900            END-IF                                                45790000
458000         END-IF                                                   45800000
458100      END-IF.                                                     45810000
458200                                                                  45820000
458300 4205-GET-CARTON-SKU-COUNT.                                       45830000
458400                                                                  45840000
458500     EXEC SQL                                                     45850000
458600         SELECT COUNT (DISTINCT A.ITM_NBR)                        45860000
458700           INTO  :PV-CARTON-SKU-COUNT                             45870000
458800           FROM TRECITM A                                         45880000
458900              , TRECDIS B                                         45890000
459000          WHERE A.ORD_NBR     = B.ORD_NBR                         45900000
459100            AND A.REC_SEQ_NBR = B.REC_SEQ_NBR                     45910000
459200            AND A.ORD_NBR     = :DK-PO-NBR                        45920000
459300            AND A.REC_SEQ_NBR = :DK-REC-SEQ-NBR                   45930000
459400     END-EXEC                                                     45940000
459500                                                                  45950000
459600     EVALUATE TRUE                                                45960000
459700         WHEN SQLCODE = ZERO                                      45970000
459800         WHEN SQLCODE = +100                                      45980000
459900              CONTINUE                                            45990000
460000         WHEN SQLWARN0 NOT = SPACE                                46000000
460100         WHEN SQLCODE NOT = ZERO                                  46010000
460200              MOVE '4205-GET-CARTON-SKU-COUNT'                    46020000
460300                               TO DP013-PARAGRAPH                 46030000
460400              MOVE 'COUNT CARTON SKUS'                            46040000
460500                               TO DP013-MESSAGE-TEXT (1)          46050000
460600              MOVE SQLCA       TO DP013-SQLCA                     46060000
460700              SET DP013-DB2-ABEND                                 46070000
460800                               TO TRUE                            46080000
460900              PERFORM DP013-0000-PROCESS-ABEND                    46090000
461000      END-EVALUATE.                                               46100000
461100                                                                  46110000
461200******************************************************************46120000
461300*    THIS PARAGRAPH RETRIEVES A VALID DC NUMBER.                  46130000
461400*    THE DC THAT SERVICES A SELECTED STORE                        46140000
461500******************************************************************46150000
461600 4250-GET-DC-INFO.                                                46160000
461700                                                                  46170000
461800     INITIALIZE XL071-COMMAREA-REC.                               46180000
461900     MOVE DK-STR-NBR  TO  XL071-LOCATION-NUMBER.                  46190000
462000                                                                  46200000
462100     CALL PC-LOCATION-MODULE  USING                               46210000
462200                                    DFHEIBLK                      46220000
462300                                    XL071-COMMAREA                46230000
462400                                    XL071-COMMAREA-REC.           46240000
462500                                                                  46250000
462600     EVALUATE TRUE                                                46260000
462700         WHEN XL071-NO-ERRORS                                     46270000
462800         WHEN XL071-DC-ASGMT-NOT-FND                              46280000
462900              CONTINUE                                            46290000
463000         when XL071-LOC-NOT-FOUND                                 46300000
463100*             MOVE PC-TSYMSG-03391       TO DP020-MSG-NUMBER      46310000
463200*             MOVE DK-STR-NBR  TO  PV-STR-NBR                     46320000
463300*             MOVE PV-STR-NBR  TO  DP020-MSG-TEXT                 46330000
463400*             SET  PS-COMMAREA-NOT-VALID TO TRUE                  46340000
463500*             SET DP020-MSG-FATAL   TO  TRUE                      46350000
463600              MOVE ASC-OPER-UNT-ID TO XL071-ASGMT-DC-NBR          46360000
463700              MOVE '*** INVALID STORE ***' TO XL071-LOC-NM        46370000
463800         WHEN OTHER                                               46380000
463900              MOVE  DK-PO-NBR  TO PV-DISPLAY-PO-NBR               46390000
464000              MOVE  ASC-REC-SEQ-NBR TO PV-DISPLAY-RCVR            46400000
464100              MOVE  DK-STR-NBR        TO PV-DISPLAY-STORE         46410000
464200              MOVE 'UNSUCCESSFUL CALL TO LOCATION MOD'            46420000
464300                                         TO DP013-MESSAGE-TEXT (1)46430000
464400              STRING 'PO/RCVR '                                   46440000
464500                     PV-DISPLAY-PO-NBR                            46450000
464600                     '-'                                          46460000
464700                     PV-DISPLAY-RCVR                              46470000
464800                     ' STORE =  '                                 46480000
464900                     PV-DISPLAY-STORE                             46490000
465000                     'XL071-RETURN-CODE '                         46500000
465100                     XL071-RETURN-CODE DELIMITED BY SIZE          46510000
465200                                     INTO DP013-MESSAGE-TEXT (3)  46520000
465300              MOVE SQLCA       TO DP013-SQLCA                     46530000
465400              SET DP013-DB2-ABEND                                 46540000
465500                               TO TRUE                            46550000
465600              PERFORM DP013-0000-PROCESS-ABEND                    46560000
465700     END-EVALUATE.                                                46570000
465800                                                                  46580000
465900                                                                  46590000
466000 4260-GET-RECEIVER-TYPE.                                          46600000
466100         EXEC SQL                                                 46610000
466200             SELECT REC_TYP_CDE                                   46620000
466300               INTO :RECEIV-REC-TYP-CDE                           46630000
466400               FROM TRECEIV                                       46640000
466500              WHERE ORD_NBR       =  :DK-PO-NBR                   46650000
466600                AND REC_SEQ_NBR   =  :DK-REC-SEQ-NBR              46660000
466700         END-EXEC                                                 46670000
466800                                                                  46680000
466900         EVALUATE TRUE                                            46690000
467000             WHEN SQLCODE = ZERO                                  46700000
467100             WHEN SQLCODE = +100                                  46710000
467200                  CONTINUE                                        46720000
467300             WHEN SQLWARN0 NOT = SPACE                            46730000
467400             WHEN SQLCODE NOT = ZERO                              46740000
467500                MOVE  DK-PO-NBR  TO PV-DISPLAY-PO-NBR             46750000
467600                MOVE  ASC-REC-SEQ-NBR TO PV-DISPLAY-RCVR          46760000
467700                MOVE '4260-GET-RECEIVER-TYPE '                    46770000
467800                                   TO DP013-PARAGRAPH             46780000
467900                MOVE 'GET RECEIVER TYPE '                         46790000
468000                                   TO DP013-MESSAGE-TEXT (1)      46800000
468100                STRING 'PO/RCVR '           DELIMITED BY SIZE     46810000
468200                       PV-DISPLAY-PO-NBR    DELIMITED BY SIZE     46820000
468300                       '-'                  DELIMITED BY SIZE     46830000
468400                       PV-DISPLAY-RCVR      DELIMITED BY '  '     46840000
468500                                       INTO DP013-MESSAGE-TEXT (2)46850000
468600                MOVE 'TRECEIV '  TO DP013-DB2-TABLE-NAME (1)      46860000
468700                MOVE SQLCA       TO DP013-SQLCA                   46870000
468800                SET DP013-DB2-ABEND                               46880000
468900                                   TO TRUE                        46890000
469000                PERFORM DP013-0000-PROCESS-ABEND                  46900000
469100         END-EVALUATE.                                            46910000
469200                                                                  46920000
469300******************************************************************46930000
469400 4270-SEL-KRPRPM-FUNC-QTY.                                        46940000
469500******************************************************************46950000
469600                                                                  46960000
469700                                                                  46970000
469800     EXEC SQL                                                     46980000
469900          SELECT FUNC_QTY                                         46990000
470000                ,CURRENT DATE                                     47000000
470100          INTO  :KRPRPM-FUNC-QTY                                  47010000
470200              , :PV-CURRENT-DATE                                  47020000
470300           FROM TKRPRPM                                           47030000
470400          WHERE LOC_ID             = :DK-OPER-UNT-ID-2            47040000
470500            AND SYS_PRC_FUNC_CDE   = 'SMOINV'                     47050000
470600     END-EXEC                                                     47060000
470700                                                                  47070000
470800                                                                  47080000
470900     EVALUATE TRUE                                                47090000
471000         WHEN SQLCODE = ZERO                                      47100000
471100              CONTINUE                                            47110000
471200         WHEN SQLCODE = +100                                      47120000
471300         WHEN SQLWARN0 NOT = SPACE                                47130000
471400         WHEN SQLCODE NOT = ZERO                                  47140000
471500              MOVE '4270-SEL-KRPRPM-FUNC-QTY'                     47150000
471600                               TO DP013-PARAGRAPH                 47160000
471700              MOVE 'SELECT TKRPRPM    '                           47170000
471800                               TO DP013-MESSAGE-TEXT (1)          47180000
471900              MOVE PV-DC-SRVCNG-STR                               47190000
472000                               TO DP013-MESSAGE-TEXT (2)          47200000
472100              MOVE SQLCA       TO DP013-SQLCA                     47210000
472200              SET DP013-DB2-ABEND                                 47220000
472300                               TO TRUE                            47230000
472400              PERFORM DP013-0000-PROCESS-ABEND                    47240000
472500     END-EVALUATE.                                                47250000
472600                                                                  47260000
472700*-----------------------------------------------------------------47270000
472800 4280-READ-INV-PARM.                                              47280000
472900                                                                  47290000
473000         EXEC SQL                                                 47300000
473100             SELECT                                               47310000
473200                    MAX (PLND_INV_DTE)                            47320000
473300             INTO                                                 47330000
473400                    :XLT00025-PLND-INV-DTE :DN-INV-DTE            47340000
473500             FROM                                                 47350000
473600                    XLT_MDSE_INV_PARM                             47360000
473700             WHERE                                                47370000
473800                    LOC_NBR           =  :DK-STORE                47380000
473900               AND  ACTV_IND          =  'Y'                      47390000
474000               AND  LOC_INV_STAT_CDE  = 'IN'                      47400000
474100         END-EXEC.                                                47410000
474200                                                                  47420000
474300         EVALUATE TRUE                                            47430000
474400             WHEN SQLCODE = ZERO                                  47440000
474500                IF DN-INV-DTE = 0                                 47450000
474600                   PERFORM 4281-READ-INV-PARM-2                   47460000
474700                ELSE                                              47470000
474800                   MOVE '9999-09-09' TO PV-PLND-INV-DTE-FUNC-QTY  47480000
474900                END-IF                                            47490000
475000             WHEN SQLCODE = +100                                  47500000
475100                  SET PS-ERROR    TO  TRUE                        47510000
475200             WHEN SQLWARN0 NOT = SPACES                           47520000
475300             WHEN SQLCODE NOT EQUAL ZERO                          47530000
475400              MOVE DK-STORE  TO  PV-DISPLAY-STORE                 47540000
475500              MOVE '4280-READ-INV-PARM'                           47550000
475600                               TO DP013-PARAGRAPH                 47560000
475700              MOVE 'SELECT XLT_MDSE_INV_PARM'                     47570000
475800                               TO DP013-MESSAGE-TEXT (1)          47580000
475900              MOVE PV-DISPLAY-STORE                               47590000
476000                               TO DP013-MESSAGE-TEXT (2)          47600000
476100              MOVE SQLCA       TO DP013-SQLCA                     47610000
476200              SET DP013-DB2-ABEND                                 47620000
476300                               TO TRUE                            47630000
476400              PERFORM DP013-0000-PROCESS-ABEND                    47640000
476500         END-EVALUATE.                                            47650000
476600*----------------------------------------------------------------*47660000
476700*     GET THE ACTUAL DATE .                                       47670000
476800*----------------------------------------------------------------*47680000
476900                                                                  47690000
477000 4281-READ-INV-PARM-2.                                            47700000
477100                                                                  47710000
477200         EXEC SQL                                                 47720000
477300             SELECT                                               47730000
477400                    MAX (PLND_INV_DTE) - :KRPRPM-FUNC-QTY DAYS    47740000
477500             INTO                                                 47750000
477600                    :PV-PLND-INV-DTE-FUNC-QTY                     47760000
477700             FROM                                                 47770000
477800                    XLT_MDSE_INV_PARM                             47780000
477900             WHERE                                                47790000
478000                    LOC_NBR           =  :DK-STORE                47800000
478100               AND  ACTV_IND          =  'Y'                      47810000
478200               AND  LOC_INV_STAT_CDE  =  'IN'                     47820000
478300         END-EXEC.                                                47830000
478400                                                                  47840000
478500         EVALUATE TRUE                                            47850000
478600             WHEN SQLCODE = ZERO                                  47860000
478700                  CONTINUE                                        47870000
478800             WHEN SQLCODE = +100                                  47880000
478900                  SET PS-ERROR    TO  TRUE                        47890000
479000             WHEN SQLWARN0 NOT = SPACES                           47900000
479100             WHEN SQLCODE NOT EQUAL ZERO                          47910000
479200              MOVE DK-STORE  TO  PV-DISPLAY-STORE                 47920000
479300              MOVE '4281-READ-INV-PARM-2'                         47930000
479400                               TO DP013-PARAGRAPH                 47940000
479500              MOVE 'SELECT XLT_MDSE_INV_PARM'                     47950000
479600                               TO DP013-MESSAGE-TEXT (1)          47960000
479700              MOVE PV-DISPLAY-STORE                               47970000
479800                               TO DP013-MESSAGE-TEXT (2)          47980000
479900              MOVE SQLCA       TO DP013-SQLCA                     47990000
480000              SET DP013-DB2-ABEND                                 48000000
480100                               TO TRUE                            48010000
480200              PERFORM DP013-0000-PROCESS-ABEND                    48020000
480300         END-EVALUATE.                                            48030000
480400*----------------------------------------------------------------*48040000
480500*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *48050000
480600*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *48060000
480700*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *48070000
480800*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *48080000
480900*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *48090000
481000*                                                                *48100000
481100*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *48110000
481200*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *48120000
481300*    UPON INITIALIZATION.                                        *48130000
481400*----------------------------------------------------------------*48140000
481500                                                                  48150000
481600 4300-READ-ITEMS-FROM-DB.                                         48160000
481700                                                                  48170000
481800     PERFORM 4370-CHECK-OPER-AND-FACILTY                          48180000
481900                                                                  48190000
481910     PERFORM                                                      48191000
481920         VARYING PV-READ-COUNT                                    48192000
481930         FROM 1 BY 1                                              48193000
481940         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    48194000
481950            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         48195000
481960                                                                  48196000
481970         PERFORM 4310-FETCH-STORE-LIST-CSR                        48197000
481980                                                                  48198000
481990         IF  ASC-ITEMS-LEFT-ON-DB                                 48199000
482000             PERFORM 4250-GET-DC-INFO                             48200000
482100*CHECK FOR CENTRAL STOCK OR ECOMMERCE LOCATIONS                   48210000
482200           IF XL071-LOC-TYP-CDE = 'DS' AND                        48220000
482300              XL071-E-BUS-IND   = 'Y'                             48230000
482400                SET PS-ECOMM-LOCATION-YES TO TRUE                 48240000
482500           ELSE                                                   48250000
482600              IF XL071-LOC-TYP-CDE = 'CS'                         48260000
482700                SET PS-CS-LOCATION-YES TO TRUE                    48270000
482800              END-IF                                              48280000
482900           END-IF                                                 48290000
483000                                                                  48300000
483100*CHECK FOR ACTIVE CARTONS ON TSHPUNT                              48310000
483200             MOVE   'A'  TO   DK-ACTV-IND                         48320000
483300             PERFORM 5400-CHECK-FOR-UCC128-DATA                   48330000
483400                                                                  48340000
483500             PERFORM 5500-CHECK-SMOOTHING-ACTV                    48350000
483600             IF PV-DB2-COUNT-ACTV = 0                             48360000
483700                PERFORM 5505-CHECK-SMOOTHING-INACTV               48370000
483800             END-IF                                               48380000
483900                                                                  48390000
484000**CHECK SERVICING DC AND PARM TABLE AND PHYSICAL INVENTORY        48400000
484100**           PERFORM 4200-PHY-INV-PROCESS-CHECK                   48410000
484200****                                                              48420000
484300                                                                  48430000
484400             PERFORM 5010-OPEN-TOTAL-UNTS-CSR                     48440000
484500             SET PS-NOT-END-OF-RECITM-CSR TO TRUE                 48450000
484600                                                                  48460000
484700             PERFORM 5310-FETCH-TOTAL-UNITS                       48470000
484800                        UNTIL PS-END-OF-RECITM-CSR                48480000
484900             PERFORM 5020-CLOSE-TOTAL-UNTS-CSR                    48490000
485000                                                                  48500000
485100                                                                  48510000
485200             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                48520000
485300                 ADD +1            TO ASC-ITEM-SUB                48530000
485400             ELSE                                                 48540000
485500                 ADD +1            TO ASC-BLK-SUB                 48550000
485600                 MOVE +1           TO ASC-ITEM-SUB                48560000
485700                                                                  48570000
485800                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         48580000
485900                     MOVE +1       TO ASC-BLK-SUB                 48590000
486000                     SET ASC-BLOCK-MODIFIED (1)                   48600000
486100                                   TO TRUE                        48610000
486200                     PERFORM 5100-WRITE-TEMP-STORAGE              48620000
486300                     MOVE ASC-BLOCK-ENTRIES                       48630000
486400                               (PC-MAX-BLOCKS-IN-ARRAY)           48640000
486500                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 48650000
486600                     ADD +1        TO ASC-BLK-SUB                 48660000
486700                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   48670000
486800                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      48680000
486900                                   TO TRUE                        48690000
487000                 END-IF                                           48700000
487100             END-IF                                               48710000
487200                                                                  48720000
487300             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    48730000
487400             MOVE ASC-NUMBER-OF-ITEMS-READ                        48740000
487500                                   TO ASC-LIST-ITEM-NUMBER        48750000
487600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  48760000
487700             MOVE SPACES                 TO  ASC-ACTION           48770000
487800                                       (ASC-BLK-SUB ASC-ITEM-SUB) 48780000
487900*** CHECK FOR MISDIRECT STORE                                     48790000
488000*            PERFORM 4370-CHECK-OPER-AND-FACILTY                  48800000
488100*            IF PV-DC-SRVCNG-STR = RECEIV-CURR-OPER-UNT-ID        48810000
488200*              SET ASC-MISDIRECT-STR-NO (ASC-BLK-SUB ASC-ITEM-SUB)48820000
488300*                                  TO TRUE                        48830000
488400*            ELSE                                                 48840000
488500*               SET ASC-MISDIRECT-STORE (ASC-BLK-SUB ASC-ITEM-SUB)48850000
488600*                                  TO TRUE                        48860000
488700*            END-IF                                               48870000
488800                                                                  48880000
488900*** CHECK FOR ITEM NUMBER = 0 (LINE NUMBER ADDED AT DC)           48890000
489000             PERFORM 5620-CHECK-FOR-ZERO-ITM-NBR                  48900000
489100                                                                  48910000
489200                                                                  48920000
489300*** CHECK FOR PBS ERROR                                           48930000
489400             PERFORM 4360-CHECK-PBS-ERROR                         48940000
489500             IF PV-DB2-COUNT-PBS-ERRORS    > ZERO                 48950000
489600                SET ASC-PBS-ERROR (ASC-BLK-SUB ASC-ITEM-SUB)      48960000
489700                                       TO TRUE                    48970000
489800             END-IF                                               48980000
489900                                                                  48990000
490000*** MOVE FOR TOTAL CARTON COUNT                                   49000000
490100             MOVE PKSLIP-EXPTED-PKG-QTY                           49010000
490200                                       TO ASC-NBR-CARTONS         49020000
490300                                       (ASC-BLK-SUB ASC-ITEM-SUB) 49030000
490400                                                                  49040000
490500**CHECK SERVICING DC AND PARM TABLE AND PHYSICAL INVENTORY        49050000
490600             PERFORM 4200-PHY-INV-PROCESS-CHECK                   49060000
490700                                                                  49070000
490800             ADD PKSLIP-EXPTED-PKG-QTY                            49080000
490900                                   TO ASC-TOTAL-CART              49090000
491000             INITIALIZE PKSLIP-EXPTED-PKG-QTY                     49100000
491100*********                                                         49110000
491200*** CHECK FOR MISDIRECT STORE                                     49120000
491300             IF PV-DC-SRVCNG-STR = RECEIV-CURR-OPER-UNT-ID        49130000
491400               SET ASC-MISDIRECT-STR-NO (ASC-BLK-SUB ASC-ITEM-SUB)49140000
491500                                   TO TRUE                        49150000
491600             ELSE                                                 49160000
491700                SET ASC-MISDIRECT-STORE (ASC-BLK-SUB ASC-ITEM-SUB)49170000
491800                                   TO TRUE                        49180000
491900             END-IF                                               49190000
492000*********                                                         49200000
492100*** MOVE FOR TOTAL UNITS                                          49210000
492110             MOVE PV-PO-RCVR-UNT-CNTR TO ASC-NBR-UNITS            49211000
492120                                       (ASC-BLK-SUB ASC-ITEM-SUB) 49212000
492130             ADD PV-PO-RCVR-UNT-CNTR                              49213000
492140                                   TO ASC-TOTAL-UNITS             49214000
492150             INITIALIZE PV-PO-RCVR-UNT-CNTR                       49215000
492160****                                                              49216000
492170                                                                  49217000
492180             MOVE PKSLIP-STR-DEST-NBR TO ASC-STR-NUMBER           49218000
492190                                       (ASC-BLK-SUB ASC-ITEM-SUB) 49219000
492200             MOVE XL071-LOC-NM    TO ASC-STR-NAME                 49220000
492300                                       (ASC-BLK-SUB ASC-ITEM-SUB) 49230000
492400             IF PS-UCC128-ROW-FND                                 49240000
492500                SET ASC-UCC128-DATA-YES (ASC-BLK-SUB ASC-ITEM-SUB)49250000
492600                                        TO TRUE                   49260000
492700                PERFORM 5405-UCC128-CRTN-SHUNLO                   49270000
492800             END-IF                                               49280000
492900                                                                  49290000
493000             IF PS-VERIFIED-LINE-FND                              49300000
493100                SET ASC-VERIFIED-LINE-YES                         49310000
493200                                     (ASC-BLK-SUB ASC-ITEM-SUB)   49320000
493300                                        TO TRUE                   49330000
493400             ELSE                                                 49340000
493500                SET ASC-VERIFIED-LINE-NO                          49350000
493600                                     (ASC-BLK-SUB ASC-ITEM-SUB)   49360000
493700                                        TO TRUE                   49370000
493800             END-IF                                               49380000
493900             IF PS-PHYSICAL-INV                                   49390000
494000                SET ASC-PHYSICAL-INV-YES                          49400000
494100                                     (ASC-BLK-SUB ASC-ITEM-SUB)   49410000
494200                                        TO TRUE                   49420000
494300             END-IF                                               49430000
494400                                                                  49440000
494500             PERFORM 4350-CHECKED-IN-CRTN                         49450000
494600*                                                                 49460000
494700             EVALUATE TRUE                                        49470000
494800               WHEN PS-CARTONS-CHKD-IN-YES                        49480000
494900                  MOVE 'CARTONS CHECKED IN'                       49490000
495000                                       TO ASC-STATUS              49500000
495100                                       (ASC-BLK-SUB ASC-ITEM-SUB) 49510000
495200                  SET ASC-NOT-PROTECTED (ASC-BLK-SUB ASC-ITEM-SUB)49520000
495300                                       TO TRUE                    49530000
495400                  SET ASC-NOT-INVALID   (ASC-BLK-SUB ASC-ITEM-SUB)49540000
495500                                       TO TRUE                    49550000
495510               WHEN  PKSLIP-PKSL-STAT-CDE  = 'IN'                 49551000
495520                  MOVE 'INACTIVE PKSLIP' TO ASC-STATUS            49552000
495530                                       (ASC-BLK-SUB ASC-ITEM-SUB) 49553000
495540                  SET ASC-PROTECTED (ASC-BLK-SUB ASC-ITEM-SUB)    49554000
495550                                       TO TRUE                    49555000
495560                  SET ASC-INVALID (ASC-BLK-SUB ASC-ITEM-SUB)      49556000
495570                                       TO TRUE                    49557000
495580               WHEN PS-VERIFIED-LINE-FND                          49558000
495590                  MOVE 'LINE(S) VERIFIED' TO ASC-STATUS           49559000
495600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 49560000
495700                  SET ASC-PROTECTED (ASC-BLK-SUB ASC-ITEM-SUB)    49570000
495800                                       TO TRUE                    49580000
495900                  SET ASC-INVALID (ASC-BLK-SUB ASC-ITEM-SUB)      49590000
496000                                       TO TRUE                    49600000
496100               WHEN  PS-PHYSICAL-INV                              49610000
496200                  MOVE 'PHY INVENTORY' TO ASC-STATUS              49620000
496300                                       (ASC-BLK-SUB ASC-ITEM-SUB) 49630000
496400                  SET ASC-PROTECTED (ASC-BLK-SUB ASC-ITEM-SUB)    49640000
496500                                       TO TRUE                    49650000
496600                  SET ASC-INVALID (ASC-BLK-SUB ASC-ITEM-SUB)      49660000
496700                                       TO TRUE                    49670000
496800               WHEN  PS-SMOOTHING-ACTV                            49680000
496900                  MOVE 'SMOOTHED '  TO ASC-STATUS                 49690000
497000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 49700000
497100                  SET ASC-PROTECTED (ASC-BLK-SUB ASC-ITEM-SUB)    49710000
497200                                       TO TRUE                    49720000
497300                  SET ASC-NOT-INVALID (ASC-BLK-SUB ASC-ITEM-SUB)  49730000
497400                                       TO TRUE                    49740000
497500               WHEN  PS-SMOOTHING-INACTV                          49750000
497600                  MOVE 'SMTHING INACTVTD'  TO ASC-STATUS          49760000
497700                                       (ASC-BLK-SUB ASC-ITEM-SUB) 49770000
497800                  SET ASC-NOT-PROTECTED (ASC-BLK-SUB ASC-ITEM-SUB)49780000
497900                                       TO TRUE                    49790000
498000                  SET ASC-NOT-INVALID   (ASC-BLK-SUB ASC-ITEM-SUB)49800000
498100                                       TO TRUE                    49810000
498200               WHEN  PS-CS-LOCATION-YES                           49820000
498300                  MOVE 'CENTRAL STOCK '  TO ASC-STATUS            49830000
498400                                       (ASC-BLK-SUB ASC-ITEM-SUB) 49840000
498500                  SET ASC-PROTECTED (ASC-BLK-SUB ASC-ITEM-SUB)    49850000
498600                                       TO TRUE                    49860000
498700                  SET ASC-INVALID-STAT (ASC-BLK-SUB ASC-ITEM-SUB) 49870000
498800                                       TO TRUE                    49880000
498900               WHEN  PS-ECOMM-LOCATION-YES                        49890000
499000                  MOVE 'E-COMMERCE LOCATION '  TO ASC-STATUS      49900000
499100                                       (ASC-BLK-SUB ASC-ITEM-SUB) 49910000
499200                  SET ASC-PROTECTED (ASC-BLK-SUB ASC-ITEM-SUB)    49920000
499300                                       TO TRUE                    49930000
499400                  SET ASC-INVALID-STAT (ASC-BLK-SUB ASC-ITEM-SUB) 49940000
499500                                       TO TRUE                    49950000
499600               WHEN  PS-UCC128-ROW-FND                            49960000
499700                  MOVE 'UCC128 DATA EXISTS'  TO ASC-STATUS        49970000
499800                                       (ASC-BLK-SUB ASC-ITEM-SUB) 49980000
499900                  SET ASC-NOT-PROTECTED (ASC-BLK-SUB ASC-ITEM-SUB)49990000
500000                                       TO TRUE                    50000000
500100                  SET ASC-NOT-INVALID   (ASC-BLK-SUB ASC-ITEM-SUB)50010000
500200                                       TO TRUE                    50020000
500300               WHEN  OTHER                                        50030000
500400                  MOVE SPACES        TO ASC-STATUS                50040000
500500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 50050000
500600                  SET ASC-NOT-PROTECTED (ASC-BLK-SUB ASC-ITEM-SUB)50060000
500700                                       TO TRUE                    50070000
500800                  SET ASC-NOT-INVALID   (ASC-BLK-SUB ASC-ITEM-SUB)50080000
500900                                       TO TRUE                    50090000
501000             END-EVALUATE                                         50100000
501100             SET PS-NO-VERIFIED-LINE-FND   TO TRUE                50110000
501200         END-IF                                                   50120000
501300     END-PERFORM.                                                 50130000
501400                                                                  50140000
501500     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          50150000
501600         MOVE +1               TO ASC-BLK-SUB                     50160000
501700         PERFORM 5100-WRITE-TEMP-STORAGE                          50170000
501800         ADD +1                TO ASC-BLK-SUB                     50180000
501900         PERFORM 5100-WRITE-TEMP-STORAGE                          50190000
502000                                                                  50200000
502100         MOVE 1                TO ASC-BLK-SUB                     50210000
502200                                  PV-BLOCK-NUMBER                 50220000
502300         PERFORM 4410-READ-TEMP-STORAGE                           50230000
502400         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             50240000
502500             MOVE 2            TO ASC-BLK-SUB                     50250000
502600                                  PV-BLOCK-NUMBER                 50260000
502700             PERFORM 4410-READ-TEMP-STORAGE                       50270000
502800         END-IF                                                   50280000
502900     END-IF.                                                      50290000
503000                                                                  50300000
503100*----------------------------------------------------------------*50310000
503200*    FETCH THE MESSAGE CURSOR.                                   *50320000
503300*----------------------------------------------------------------*50330000
503400 4310-FETCH-STORE-LIST-CSR.                                       50340000
503500                                                                  50350000
503600         EXEC SQL                                                 50360000
503700             FETCH STORE-LIST-CSR                                 50370000
503800             INTO   :PKSLIP-STR-DEST-NBR                          50380000
503900                  , :PKSLIP-EXPTED-PKG-QTY                        50390000
504000                  , :PKSLIP-PKSL-STAT-CDE                         50400000
504100         END-EXEC                                                 50410000
504200                                                                  50420000
504300     EVALUATE TRUE                                                50430000
504400         WHEN SQLCODE = ZERO                                      50440000
504500              MOVE PKSLIP-STR-DEST-NBR TO DK-STR-NBR              50450000
504600                                          DK-STORE                50460000
504700         WHEN SQLCODE = +100                                      50470000
504800              SET ASC-NO-ITEMS-LEFT-ON-DB                         50480000
504900                                        TO TRUE                   50490000
505000         WHEN SQLWARN0 NOT = SPACE                                50500000
505100         WHEN SQLCODE NOT = ZERO                                  50510000
505200              MOVE  DK-PO-NBR  TO PV-DISPLAY-PO-NBR               50520000
505300              MOVE  ASC-REC-SEQ-NBR TO PV-DISPLAY-RCVR            50530000
505400              MOVE '4310-FETCH-STORE-LIST'                        50540000
505500                               TO DP013-PARAGRAPH                 50550000
505600              MOVE 'FETCH STORE CURSOR'                           50560000
505700                               TO DP013-MESSAGE-TEXT (1)          50570000
505800              MOVE SQLCA       TO DP013-SQLCA                     50580000
505900              STRING 'PO/RCVR '           DELIMITED BY SIZE       50590000
506000                     PV-DISPLAY-PO-NBR    DELIMITED BY SIZE       50600000
506100                     '-'                  DELIMITED BY SIZE       50610000
506200                     PV-DISPLAY-RCVR      DELIMITED BY '  '       50620000
506300                                     INTO DP013-MESSAGE-TEXT (2)  50630000
506400              MOVE 'TPKSLIP '  TO DP013-DB2-TABLE-NAME (1)        50640000
506500              SET DP013-DB2-ABEND                                 50650000
506600                               TO TRUE                            50660000
506700              PERFORM DP013-0000-PROCESS-ABEND                    50670000
506800     END-EVALUATE.                                                50680000
506900                                                                  50690000
507000*----------------------------------------------------------------*50700000
507100* ARE THERE ANY ACTIVE CHECKED IN CARTONS                         50710000
507200*----------------------------------------------------------------*50720000
507300 4350-CHECKED-IN-CRTN.                                            50730000
507400     INITIALIZE PS-CARTONS-CHKD-IN-SW                             50740000
507500                                                                  50750000
507600     EXEC SQL                                                     50760000
507700          SELECT   COUNT (DISTINCT C.SHIPT_UNT_ID)                50770000
507800            INTO :PV-DB2-COUNT-CRTN  :DN-NULL-IND                 50780000
507810            FROM  TPKSLIP A                                       50781000
507820                , TINPKSU B                                       50782000
507830                , TSHUNLO C                                       50783000
507840           WHERE                                                  50784000
507850                  A.PO_NBR        = :DK-PO-NBR                    50785000
507860             AND  A.REC_SEQ_NBR   = :DK-RECEIVER                  50786000
507870             AND  A.STR_DEST_NBR  = :DK-STR-NBR                   50787000
507880             AND  A.PO_NBR        = B.PO_NBR                      50788000
507890             AND  A.SEQ_NBR       = B.SEQ_NBR                     50789000
507891             AND  C.SHIPT_UNT_ID  = B.SHIPT_UNT_ID                50789100
507892             AND  A.VER_STAT_CDE  = 'A'                           50789200
507893             AND  C.ACTV_CDE      = 'A'                           50789300
507894             AND  C.SCN_LOC_ID    = 'RECV'                        50789400
507895             AND EXISTS                                           50789500
507896             (SELECT *                                            50789600
507897               FROM TSULBXF D                                     50789700
507898               WHERE  C.SHIPT_UNT_ID  = D.SHIPT_UNT_ID)           50789800
507899     END-EXEC.                                                    50789900
507900                                                                  50790000
507901     EVALUATE TRUE                                                50790100
507902         WHEN SQLCODE = ZERO                                      50790200
507903             IF PV-DB2-COUNT-CRTN  > 0                            50790300
507904                 SET PS-CARTONS-CHKD-IN-YES TO TRUE               50790400
507905             END-IF                                               50790500
507906         WHEN SQLCODE = +100                                      50790600
507907         WHEN SQLCODE = -305                                      50790700
507908             CONTINUE                                             50790800
507909         WHEN SQLCODE = -904                                      50790900
507910         WHEN SQLCODE = -911                                      50791000
507920         WHEN SQLCODE = -913                                      50792000
507930             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   50793000
507931             MOVE '4350-CHECKED-IN-CRTN'     TO PV-SOFT-PARAGRAPH 50793100
507932             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 50793200
507933             MOVE LENGTH OF PV-CICS-MSG-AREA2                     50793300
507934               TO PV-COMMAREA-LENGTH                              50793400
507935             EXEC CICS                                            50793500
507936                  WRITEQ TD                                       50793600
507937                   QUEUE  ('CSSL')                                50793700
507938                    FROM  (PV-CICS-MSG-AREA2)                     50793800
507939                  LENGTH  (PV-COMMAREA-LENGTH)                    50793900
507940                    RESP  (PV-CICS-RESP)                          50794000
507941             END-EXEC                                             50794100
507942                                                                  50794200
507943         WHEN SQLWARN0 NOT = SPACES                               50794300
507944         WHEN SQLCODE NOT EQUAL ZERO                              50794400
507945              MOVE '4350-CHECKED-IN-CRTN' TO DP013-PARAGRAPH      50794500
507946              MOVE 'SELECT COUNT'  TO DP013-MESSAGE-TEXT (1)      50794600
507947              MOVE SQLCA           TO DP013-SQLCA                 50794700
507948              MOVE 'TPKSLIP'       TO DP013-DB2-TABLE-NAME (1)    50794800
507949              MOVE 'TINPKSU'       TO DP013-DB2-TABLE-NAME (2)    50794900
507950              MOVE 'TSHUNLO'       TO DP013-DB2-TABLE-NAME (3)    50795000
507951              MOVE 'TSULBXF'       TO DP013-DB2-TABLE-NAME (4)    50795100
507952              SET DP013-DB2-ABEND  TO TRUE                        50795200
507953              PERFORM DP013-0000-PROCESS-ABEND                    50795300
507954     END-EVALUATE.                                                50795400
507955                                                                  50795500
507956                                                                  50795600
507957*----------------------------------------------------------------*50795700
507958*    CHECK FOR PBS ERRORS                                        *50795800
507959*----------------------------------------------------------------*50795900
507960 4360-CHECK-PBS-ERROR.                                            50796000
507970                                                                  50797000
507980     PERFORM                                                      50798000
507990         WITH TEST AFTER                                          50799000
508000         VARYING PV-RETRY-COUNTER                                 50800000
508100         FROM 1 BY 1                                              50810000
508200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               50820000
508300            OR (SQLCODE = +0)                                     50830000
508400            OR (SQLCODE = +100))                                  50840000
508500                                                                  50850000
508600     EXEC SQL                                                     50860000
508700         SELECT  COUNT(*)                                         50870000
508800         INTO  :PV-DB2-COUNT-PBS-ERRORS                           50880000
508900         FROM   TPKSLIP A                                         50890000
509000               ,TINPKSU B                                         50900000
509100               ,TSHPUNT C                                         50910000
509200               ,TSHUNLO D                                         50920000
509300         WHERE A.PO_NBR       = :DK-PO-NBR                        50930000
509400           AND A.REC_SEQ_NBR  = :DK-REC-SEQ-NBR                   50940000
509500           AND A.VER_STAT_CDE = 'A'                               50950000
509600           AND A.PO_NBR       = B.PO_NBR                          50960000
509700           AND A.SEQ_NBR      = B.SEQ_NBR                         50970000
509800           AND B.SHIPT_UNT_ID = C.SHIPT_UNT_ID                    50980000
509900           AND C.SHIPT_UNT_ID = D.SHIPT_UNT_ID                    50990000
510000           AND C.DEST_OPER_UNT_ID = :DK-STR-NBR                   51000000
510100           AND C.ACTV_IND     = 'A'                               51010000
510200           AND D.SCN_LOC_ID IN                                    51020000
510300                 ('PBSA', 'PBSB', 'PBSC','PBSD','PBSE')           51030000
510400     END-EXEC                                                     51040000
510500                                                                  51050000
510600                                                                  51060000
510700     EVALUATE TRUE                                                51070000
510800         WHEN SQLCODE = ZERO                                      51080000
510900         WHEN SQLCODE = +100                                      51090000
511000              CONTINUE                                            51100000
511100         WHEN SQLWARN0 NOT = SPACE                                51110000
511200         WHEN SQLCODE NOT = ZERO                                  51120000
511300              MOVE '4360-CHECK-PBS-ERROR'                         51130000
511400                               TO DP013-PARAGRAPH                 51140000
511500              MOVE 'CHECK FOR PBS ERRORS'                         51150000
511600                               TO DP013-MESSAGE-TEXT (1)          51160000
511700              MOVE SQLCA       TO DP013-SQLCA                     51170000
511800              SET DP013-DB2-ABEND                                 51180000
511900                               TO TRUE                            51190000
512000              PERFORM DP013-0000-PROCESS-ABEND                    51200000
512100      END-EVALUATE                                                51210000
512200     END-PERFORM.                                                 51220000
512300                                                                  51230000
512400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    51240000
512500         SQLCODE NOT = +0                                         51250000
512600         MOVE '4360-CHECK-PBS-ERROR'                              51260000
512700                                 TO DP013-PARAGRAPH               51270000
512800         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     51280000
512900                                 TO DP013-MESSAGE-TEXT (1)        51290000
513000         MOVE 'ON TPKSLIP'       TO DP013-MESSAGE-TEXT (2)        51300000
513100         MOVE SQLCA              TO DP013-SQLCA                   51310000
513200         MOVE 'TPKSLIP'          TO DP013-DB2-TABLE-NAME (1)      51320000
513300         MOVE 'TINPKSU'          TO DP013-DB2-TABLE-NAME (2)      51330000
513400         MOVE 'TSHUNLO'          TO DP013-DB2-TABLE-NAME (3)      51340000
513500         SET DP013-DB2-ABEND     TO TRUE                          51350000
513600         SET DP013-XCTL-DISPLAY-RESTART                           51360000
513700                                 TO TRUE                          51370000
513800         PERFORM DP013-0000-PROCESS-ABEND                         51380000
513900     END-IF.                                                      51390000
514000/                                                                 51400000
514100****************************************************************  51410000
514200*GET CORRECT OPER AND FACILITY WHEN GOING TO                 ***  51420000
514300*RCVRINQ OR RCVRMNT SCREENS                                  ***  51430000
514400****************************************************************  51440000
514500 4370-CHECK-OPER-AND-FACILTY.                                     51450000
514600                                                                  51460000
514700         EXEC SQL                                                 51470000
514800                SELECT OPER_UNT_ID                                51480000
514900                     , FCLTY_ID                                   51490000
515000                     , STATUS_CDE                                 51500000
515100                     , CURR_OPER_UNT_ID                           51510000
515200                INTO  :RECEIV-OPER-UNT-ID                         51520000
515300                     ,:RECEIV-FCLTY-ID                            51530000
515400                     ,:RECEIV-STATUS-CDE                          51540000
515500                     ,:RECEIV-CURR-OPER-UNT-ID                    51550000
515600                FROM    TRECEIV                                   51560000
515700                WHERE   ORD_NBR     = :DK-PO-NBR                  51570000
515800                  AND   REC_SEQ_NBR = :DK-REC-SEQ-NBR             51580000
515900         END-EXEC                                                 51590000
516000                                                                  51600000
516100         EVALUATE TRUE                                            51610000
516200             WHEN SQLCODE = ZERO                                  51620000
516300             WHEN SQLCODE = +100                                  51630000
516400                  MOVE RECEIV-OPER-UNT-ID TO ASC-KEY-OPER-UNT-ID  51640000
516500                                             DK-OPER-UNT-ID       51650000
516600                  MOVE RECEIV-CURR-OPER-UNT-ID TO                 51660000
516700                                             ASC-CURR-OPER-UNT-ID 51670000
516800                  MOVE RECEIV-FCLTY-ID    TO ASC-KEY-FCLTY-ID     51680000
516900                                             DK-FCLTY-ID          51690000
517000             WHEN SQLWARN0 NOT = SPACE                            51700000
517100             WHEN SQLCODE NOT = ZERO                              51710000
517200                MOVE  DK-PO-NBR  TO PV-DISPLAY-PO-NBR             51720000
517300                MOVE  ASC-REC-SEQ-NBR TO PV-DISPLAY-RCVR          51730000
517400                MOVE '4370-CHECK-OPER-AND-FACILTY '               51740000
517500                                   TO DP013-PARAGRAPH             51750000
517600                MOVE 'FETCH MESSAGE CURSOR'                       51760000
517700                                   TO DP013-MESSAGE-TEXT (1)      51770000
517800                STRING 'PO/RCVR '           DELIMITED BY SIZE     51780000
517900                       PV-DISPLAY-PO-NBR    DELIMITED BY SIZE     51790000
518000                       '-'                  DELIMITED BY SIZE     51800000
518100                       PV-DISPLAY-RCVR      DELIMITED BY '  '     51810000
518200                                       INTO DP013-MESSAGE-TEXT (2)51820000
518300                MOVE 'TRECEIV '  TO DP013-DB2-TABLE-NAME (1)      51830000
518400                MOVE SQLCA       TO DP013-SQLCA                   51840000
518500                SET DP013-DB2-ABEND                               51850000
518600                                   TO TRUE                        51860000
518700                PERFORM DP013-0000-PROCESS-ABEND                  51870000
518800         END-EVALUATE.                                            51880000
518900****************************************************************  51890000
519000*GET CORRECT OPER AND FACILITY WHEN GOING TO                 ***  51900000
519100*RCVRINQ OR RCVRMNT SCREENS                                  ***  51910000
519200****************************************************************  51920000
519300 4380-SELECT-PKSLIP.                                              51930000
519400         EXEC SQL                                                 51940000
519500            SELECT  SEQ_NBR,                                      51950000
519600                    PKSL_NBR,                                     51960000
519700                    BOL_NBR,                                      51970000
519800                    PRO_NBR,                                      51980000
519900                    PKSL_STAT_CDE                                 51990000
520000              INTO :PKSLIP-SEQ-NBR,                               52000000
520100                   :PKSLIP-PKSL-NBR,                              52010000
520200                   :PKSLIP-BOL-NBR,                               52020000
520300                   :PKSLIP-PRO-NBR,                               52030000
520400                   :PKSLIP-PKSL-STAT-CDE                          52040000
520500              FROM  TPKSLIP                                       52050000
520600             WHERE PO_NBR              = :DK-PO-NBR               52060000
520700               AND REC_SEQ_NBR         = :DK-RECEIVER             52070000
520800               AND VER_STAT_CDE        = 'A'                      52080000
520900               AND OPER_UNT_ID         = :DK-OPER-UNT-ID          52090000
521000               AND FCLTY_ID            = :DK-FCLTY-ID             52100000
521100               AND STR_DEST_NBR        = :DK-STR-NBR              52110000
521200         END-EXEC                                                 52120000
521300                                                                  52130000
521400                                                                  52140000
521500         EVALUATE TRUE                                            52150000
521600             WHEN SQLCODE = ZERO                                  52160000
521700                MOVE PKSLIP-SEQ-NBR TO RC013-SEQ-NBR (RC013-IDX)  52170000
521800                MOVE PKSLIP-PKSL-NBR TO RC013-PKSL-NBR (RC013-IDX)52180000
521900                MOVE PKSLIP-BOL-NBR  TO RC013-BOL-NBR (RC013-IDX) 52190000
522000                MOVE PKSLIP-PRO-NBR  TO RC013-PRO-NBR (RC013-IDX) 52200000
522100                MOVE PKSLIP-PKSL-STAT-CDE                         52210000
522200                                TO RC013-PKSL-STAT-CDE (RC013-IDX)52220000
522300             WHEN SQLCODE = +100                                  52230000
522400                  CONTINUE                                        52240000
522500             WHEN SQLWARN0 NOT = SPACE                            52250000
522600             WHEN SQLCODE NOT = ZERO                              52260000
522700                  MOVE '4380-SELECT-PKSLIP '                      52270000
522800                                   TO DP013-PARAGRAPH             52280000
522900                  MOVE 'SELECT PACKSLIP '                         52290000
523000                                   TO DP013-MESSAGE-TEXT (1)      52300000
523100                  MOVE SQLCA       TO DP013-SQLCA                 52310000
523200                  SET DP013-DB2-ABEND                             52320000
523300                                   TO TRUE                        52330000
523400                  PERFORM DP013-0000-PROCESS-ABEND                52340000
523500         END-EVALUATE.                                            52350000
523600*----------------------------------------------------------------*52360000
523700* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *52370000
523800*----------------------------------------------------------------*52380000
523900                                                                  52390000
524000 4400-MOVE-COMMAREA-TO-SCREEN.                                    52400000
524100     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             52410000
524200         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          52420000
524300         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          52430000
524400             MOVE +1    TO ASC-BLK-SUB                            52440000
524500             PERFORM 5100-WRITE-TEMP-STORAGE                      52450000
524600             ADD +1     TO ASC-BLK-SUB                            52460000
524700             PERFORM 5100-WRITE-TEMP-STORAGE                      52470000
524800             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             52480000
524900                 GIVING PV-BLOCK-NUMBER                           52490000
525000                 REMAINDER PV-REMAINDER                           52500000
525100             IF  PV-REMAINDER > ZERO                              52510000
525200                 ADD +1 TO PV-BLOCK-NUMBER                        52520000
525300             END-IF                                               52530000
525400             MOVE +1    TO ASC-BLK-SUB                            52540000
525500             PERFORM 4410-READ-TEMP-STORAGE                       52550000
525600             ADD +1     TO ASC-BLK-SUB                            52560000
525700                           PV-BLOCK-NUMBER                        52570000
525800             PERFORM 4410-READ-TEMP-STORAGE                       52580000
525900     END-IF.                                                      52590000
526000     MOVE +1            TO ASC-BLK-SUB.                           52600000
526100     COMPUTE ASC-ITEM-SUB =                                       52610000
526200         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              52620000
526300         + PC-ITEMS-PER-PANEL).                                   52630000
526400                                                                  52640000
526500     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        52650000
526600         ADD +1         TO ASC-BLK-SUB                            52660000
526700         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            52670000
526800     END-IF.                                                      52680000
526900                                                                  52690000
527000     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           52700000
527100         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                52710000
527200     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        52720000
527300     PERFORM 4420-FORMAT-LIST-LINES                               52730000
527400         VARYING PV-SUB                                           52740000
527500         FROM PC-ITEMS-PER-PANEL BY -1                            52750000
527600         UNTIL PV-SUB < +1.                                       52760000
527700                                                                  52770000
527800     COMPUTE ASC-ITEMS-DISPLAYED =                                52780000
527900         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          52790000
528000     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    52800000
528100                                      ASTRTITO.                   52810000
528200     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    52820000
528300     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    52830000
528400     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            52840000
528500                                   TO ASELITO.                    52850000
528600     MOVE ASC-PO-NBR               TO APONBRO.                    52860000
528700     MOVE ASC-RECEIVER             TO ARECVRO.                    52870000
528800     MOVE ASC-OPER-UNT-ID          TO AOPERO.                     52880000
528900     MOVE ASC-FCLTY-ID             TO AFCLTYO.                    52890000
529000     MOVE ASC-SML-PRINTER          TO APRTRO.                     52900000
529100     MOVE ASC-VENDOR-NAME          TO AVNDNMEO.                   52910000
529200     MOVE ASC-DEPT                 TO ADEPTO.                     52920000
529300     MOVE ASC-TOTAL-CART           TO ATOTCRTO.                   52930000
529400     MOVE ASC-TOTAL-UNITS          TO ATOTUNTO.                   52940000
529500     MOVE ASC-UCC128-EXISTS        TO AUCC128O.                   52950000
529600                                                                  52960000
529700     IF  DP020-MSG-NUMBER-X = SPACE                               52970000
529800         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  52980000
529900*            --- MORE ITEMS TO DISPLAY ----                       52990000
530000             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            53000000
530100             SET DP020-MSG-INFORMATIONAL TO TRUE                  53010000
530200         END-IF                                                   53020000
530300     END-IF.                                                      53030000
530400*----------------------------------------------------------------*53040000
530500*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *53050000
530600*----------------------------------------------------------------*53060000
530700                                                                  53070000
530800 4410-READ-TEMP-STORAGE.                                          53080000
530900                                                                  53090000
531000     EXEC CICS                                                    53100000
531100         READQ TS                                                 53110000
531200             QUEUE (ASC-LIST-QUEUE-NAME)                          53120000
531300             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               53130000
531400             ITEM  (PV-BLOCK-NUMBER)                              53140000
531500             RESP  (PV-CICS-RESP)                                 53150000
531600     END-EXEC.                                                    53160000
531700     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       53170000
531800       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     53180000
531900         CONTINUE                                                 53190000
532000     ELSE                                                         53200000
532100         SET DP013-CICS-ABEND     TO TRUE                         53210000
532200         SET DP013-NO-ROLLBACK    TO TRUE                         53220000
532300         MOVE '4410-READ-TEMP-STORAGE'                            53230000
532400                                  TO DP013-PARAGRAPH              53240000
532500         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      53250000
532600                                  TO DP013-MESSAGE-TEXT(1)        53260000
532700         PERFORM DP013-0000-PROCESS-ABEND                         53270000
532800     END-IF.                                                      53280000
532900                                                                  53290000
533000     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             53300000
533100                                                                  53310000
533200     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         53320000
533300         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               53330000
533400     END-IF.                                                      53340000
533500                                                                  53350000
533600*----------------------------------------------------------------*53360000
533700*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *53370000
533800*----------------------------------------------------------------*53380000
533900 4420-FORMAT-LIST-LINES.                                          53390000
534000     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      53400000
534100         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                53410000
534200         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           53420000
534300                                    MR-NBR-CARTONSA (PV-SUB)      53430000
534400         MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)           53440000
534500                                    MR-NBR-CARTONSH (PV-SUB)      53450000
534600         MOVE SPACE              TO MR-ACTION  (PV-SUB)           53460000
534700                                    MR-SELECTI (PV-SUB)           53470000
534800                                    MR-NBR-CARTONS-X (PV-SUB)     53480000
534900                                    MR-NBR-UNITS-X (PV-SUB)       53490000
535000                                    MR-STR-NUMBER-X (PV-SUB)      53500000
535100                                    MR-STR-NAME (PV-SUB)          53510000
535200                                    MR-STATUS (PV-SUB)            53520000
535300     ELSE                                                         53530000
535400         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      53540000
535500                                                   > SPACE        53550000
535600             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 53560000
535700                                 TO MR-SELECTI (PV-SUB)           53570000
535800         ELSE                                                     53580000
535900             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      53590000
536000                                 TO MR-SELECTI (PV-SUB)           53600000
536100         END-IF                                                   53610000
536200                                                                  53620000
536300         IF  DP030-SET-CURSOR-TRAILER                             53630000
536400             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)53640000
536500                 > SPACE)                                         53650000
536600               OR (PV-SUB = 1))                                   53660000
536700                SET DP030-SET-CURSOR-APPL-1 TO TRUE               53670000
536800                MOVE -1          TO MR-SELECTL (PV-SUB)           53680000
536900             END-IF                                               53690000
537000         END-IF                                                   53700000
537100                                                                  53710000
537200         IF ASC-PROTECTED (ASC-BLK-SUB ASC-ITEM-SUB)              53720000
537300           MOVE DP015-ASK-NOR-OFF TO                              53730000
537400                                  MR-NBR-CARTONSA (PV-SUB)        53740000
537500           MOVE DP015-HL-OFF      TO                              53750000
537600                                  MR-NBR-CARTONSH (PV-SUB)        53760000
537700           MOVE DP015-BLUE   TO   MR-NBR-CARTONSC (PV-SUB)        53770000
537800         ELSE                                                     53780000
537900           MOVE DP015-GREEN  TO   MR-NBR-CARTONSC (PV-SUB)        53790000
538000           MOVE DP015-UNP-NUM-BRT-MDT TO                          53800000
538100                                  MR-NBR-CARTONSA (PV-SUB)        53810000
538200           MOVE DP015-UNDERLINE   TO                              53820000
538300                                  MR-NBR-CARTONSH (PV-SUB)        53830000
538400         END-IF                                                   53840000
538500                                                                  53850000
538600                                                                  53860000
538700         IF  PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL           53870000
538800             MOVE DP015-BLUE   TO MR-ACTIONC (PV-SUB)             53880000
538900                                  MR-NBR-UNITSC (PV-SUB)          53890000
539000                                  MR-STATUSC (PV-SUB)             53900000
539100             IF ASC-PBS-ERROR       (ASC-BLK-SUB ASC-ITEM-SUB)    53910000
539200                 MOVE DP015-RED    TO MR-STR-NUMBERC (PV-SUB)     53920000
539300                                      MR-STR-NAMEC (PV-SUB)       53930000
539400             ELSE                                                 53940000
539500                IF ASC-MISDIRECT-STORE (ASC-BLK-SUB ASC-ITEM-SUB) 53950000
539600                   MOVE DP015-YELLOW TO MR-STR-NUMBERC (PV-SUB)   53960000
539700                                        MR-STR-NAMEC (PV-SUB)     53970000
539800                ELSE                                              53980000
539900                    MOVE DP015-BLUE TO MR-STR-NUMBERC (PV-SUB)    53990000
540000                                       MR-STR-NAMEC (PV-SUB)      54000000
540100                END-IF                                            54010000
540200             END-IF                                               54020000
540300             MOVE ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB)           54030000
540400                                 TO MR-ACTION (PV-SUB)            54040000
540500             MOVE ASC-NBR-CARTONS  (ASC-BLK-SUB ASC-ITEM-SUB)     54050000
540600                                 TO MR-NBR-CARTONS (PV-SUB)       54060000
540700             MOVE ASC-NBR-UNITS (ASC-BLK-SUB ASC-ITEM-SUB)        54070000
540800                                 TO MR-NBR-UNITS (PV-SUB)         54080000
540900             MOVE ASC-STR-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)       54090000
541000                                 TO MR-STR-NUMBER (PV-SUB)        54100000
541100             MOVE ASC-STR-NAME  (ASC-BLK-SUB ASC-ITEM-SUB)        54110000
541200                                 TO MR-STR-NAME (PV-SUB)          54120000
541300             MOVE ASC-STATUS    (ASC-BLK-SUB ASC-ITEM-SUB)        54130000
541400                                 TO MR-STATUS (PV-SUB)            54140000
541500         ELSE                                                     54150000
541600             IF ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES    54160000
541700                 MOVE ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB)       54170000
541800                                     TO MR-ACTION (PV-SUB)        54180000
541900                                                                  54190000
542000                 MOVE ASC-STATUS    (ASC-BLK-SUB ASC-ITEM-SUB)    54200000
542100                                    TO MR-STATUS (PV-SUB)         54210000
542200                                                                  54220000
542300             END-IF                                               54230000
542400         END-IF                                                   54240000
542500     END-IF.                                                      54250000
542600     SUBTRACT +1 FROM ASC-ITEM-SUB                                54260000
542700     IF  ASC-ITEM-SUB < + 1                                       54270000
542800         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  54280000
542900         MOVE +1                 TO ASC-BLK-SUB                   54290000
543000     END-IF.                                                      54300000
543100******************************************************************54310000
543200** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **54320000
543300** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **54330000
543400** ISSUE A WARNING.                                             **54340000
543500******************************************************************54350000
543600 4430-CHECK-FOR-BEGIN-AND-END.                                    54360000
543700     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       54370000
543800         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     54380000
543900*            -- NO END-OF-RANGE SPECFIED ---                      54390000
544000             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            54400000
544100             SET DP020-MSG-WARNING TO TRUE                        54410000
544200             PERFORM 4431-POSITION-AT-WARNING                     54420000
544300         END-IF                                                   54430000
544400     ELSE                                                         54440000
544500         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     54450000
544600*            -- NO BEGINNING-OF-RANGE SPECFIED ---                54460000
544700             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            54470000
544800             SET DP020-MSG-WARNING TO TRUE                        54480000
544900             PERFORM 4431-POSITION-AT-WARNING                     54490000
545000         END-IF                                                   54500000
545100     END-IF.                                                      54510000
545200******************************************************************54520000
545300** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **54530000
545400** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **54540000
545500** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **54550000
545600** POSITION THE CURSOR THERE.                                   **54560000
545700******************************************************************54570000
545800 4431-POSITION-AT-WARNING.                                        54580000
545900     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 54590000
546000                    - PV-TOP-ITEM + 1.                            54600000
546100     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      54610000
546200         CONTINUE                                                 54620000
546300     ELSE                                                         54630000
546400         SET DP030-SET-CURSOR-APPL-1                              54640000
546500                                   TO TRUE                        54650000
546600         MOVE -1                   TO MR-SELECTL (PV-SUB)         54660000
546700         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         54670000
546800         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         54680000
546900     END-IF.                                                      54690000
547000                                                                  54700000
547100     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   54710000
547200                    - PV-TOP-ITEM + 1.                            54720000
547300     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      54730000
547400         CONTINUE                                                 54740000
547500     ELSE                                                         54750000
547600         SET DP030-SET-CURSOR-APPL-1                              54760000
547700                                   TO TRUE                        54770000
547800         MOVE -1                   TO MR-SELECTL (PV-SUB)         54780000
547900         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         54790000
548000         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         54800000
548100     END-IF.                                                      54810000
548200                                                                  54820000
548300*----------------------------------------------------------------*54830000
548400*  PRINT AND UPDATE FUNCTION                                      54840000
548500*----------------------------------------------------------------*54850000
548600 4600-PROCESS-PRINT-FUNCTION.                                     54860000
548700                                                                  54870000
548800                                                                  54880000
548900     MOVE +1                       TO ASC-BLK-SUB.                54890000
549000     PERFORM 5100-WRITE-TEMP-STORAGE.                             54900000
549100     ADD +1                        TO ASC-BLK-SUB.                54910000
549200     PERFORM 5100-WRITE-TEMP-STORAGE.                             54920000
549300                                                                  54930000
549400     PERFORM 6112-READ-LIST-QUEUE.                                54940000
549500                                                                  54950000
549600     SET  LQW-IDX  TO   1.                                        54960000
549700                                                                  54970000
549800       IF PV-CICS-RESP = DFHRESP (NORMAL)                         54980000
549900         PERFORM                                                  54990000
550000         VARYING LQW-IDX  FROM 1 BY 1                             55000000
550100         UNTIL   LQW-IDX > PC-ITEMS-PER-PANEL                     55010000
550200            OR   LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO            55020000
550300            OR   PS-ERROR                                         55030000
550400             IF  LQW-SELECT (LQW-IDX)                             55040000
550500                 PERFORM 4605-PROCESS-SELECTED-LINES              55050000
550600             END-IF                                               55060000
550700         END-PERFORM                                              55070000
550800       END-IF.                                                    55080000
550900                                                                  55090000
551000     MOVE PV-ITEM      TO PV-SAVE-ITEM.                           55100000
551100     PERFORM 6111-WRITE-LIST-QUEUE.                               55110000
551200                                                                  55120000
551300     MOVE +1                     TO  ASC-BLK-SUB.                 55130000
551400     PERFORM 4410-READ-TEMP-STORAGE.                              55140000
551500                                                                  55150000
551600     ADD +1                      TO  ASC-BLK-SUB                  55160000
551700                                     PV-BLOCK-NUMBER.             55170000
551800                                                                  55180000
551900     PERFORM 4410-READ-TEMP-STORAGE.                              55190000
552000                                                                  55200000
552100*----------------------------------------------------------------*55210000
552200*                                                                 55220000
552300*----------------------------------------------------------------*55230000
552400 4605-PROCESS-SELECTED-LINES.                                     55240000
552500                                                                  55250000
552600     PERFORM 4620-PROCESS-LINES.                                  55260000
552700                                                                  55270000
552800     IF  PS-NO-ERROR                                              55280000
552900*        SET  LQW-DESELECT (LQW-IDX) TO TRUE                      55290000
553000         EVALUATE TRUE                                            55300000
553100             WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)          55310000
553200                  MOVE PC-UPD      TO LQW-ACTION (LQW-IDX)        55320000
553300                  MOVE 'SMOOTHED ' TO LQW-STATUS (LQW-IDX)        55330000
553400                  SET LQW-PROTECTED (LQW-IDX) TO TRUE             55340000
553500                  SET  LQW-DESELECT (LQW-IDX) TO TRUE             55350000
553600                                                                  55360000
553700             WHEN DP020-FK-CONFIRM (DP020-SRC-AID)                55370000
553800             WHEN DP020-FK-LOCAL-FUNC-07 (DP020-SRC-AID)          55380000
553900                EVALUATE TRUE                                     55390000
554000                   WHEN ASC-CONFIRM-INACTV                        55400000
554100                      MOVE PC-UPD                                 55410000
554200                                  TO LQW-ACTION (LQW-IDX)         55420000
554300                      MOVE 'SMTHING INACTVTD'                     55430000
554400                                  TO LQW-STATUS (LQW-IDX)         55440000
554500                      SET LQW-NOT-PROTECTED (LQW-IDX) TO TRUE     55450000
554600                      SET  LQW-DESELECT (LQW-IDX) TO TRUE         55460000
554700                      COMPUTE ASC-TOTAL-CART =                    55470000
554800                                (ASC-TOTAL-CART -                 55480000
554900                                     LQW-NBR-CARTONS (LQW-IDX))   55490000
555000                   WHEN ASC-CONFIRM-UCC128                        55500000
555100                   WHEN DP020-FK-LOCAL-FUNC-07 (DP020-SRC-AID)    55510000
555200                      MOVE PC-UPD                                 55520000
555300                                  TO LQW-ACTION (LQW-IDX)         55530000
555400                      MOVE 'SMOOTHED '                            55540000
555500                                  TO  LQW-STATUS (LQW-IDX)        55550000
555600                      SET  LQW-PROTECTED (LQW-IDX) TO TRUE        55560000
555700                      SET  LQW-DESELECT (LQW-IDX) TO TRUE         55570000
555800                END-EVALUATE                                      55580000
555900         END-EVALUATE                                             55590000
556000         SUBTRACT  1                                              55600000
556100             FROM  ASC-NUMBER-OF-SELECTED-ITEMS                   55610000
556200         MOVE LQW-SELECTED-SW (LQW-IDX)                           55620000
556300                              TO LQW-TEMP-SELECTED-SW (LQW-IDX)   55630000
556400     END-IF.                                                      55640000
556500                                                                  55650000
556600                                                                  55660000
556700*----------------------------------------------------------------*55670000
556800*                                                                 55680000
556900*                                                                 55690000
557000*----------------------------------------------------------------*55700000
557100 4620-PROCESS-LINES.                                              55710000
557200                                                                  55720000
557300*    IF PS-AUTO-VE-YES                                            55730000
557400*        MOVE ASC-PO-NBR             TO DK-PO-NBR                 55740000
557500*        MOVE ASC-REC-SEQ-NBR        TO DK-REC-SEQ-NBR            55750000
557600*                                       DK-RECEIVER               55760000
557700*        MOVE LQW-STR-NUMBER (LQW-IDX)  TO DK-STR-NBR             55770000
557800*        PERFORM 8450-CHECKED-IN-CRTN                             55780000
557900*    ELSE                                                         55790000
558000*        SET PS-NO-ERROR  TO TRUE                                 55800000
558100*    END-IF.                                                      55810000
558200                                                                  55820000
558300     IF  PS-NO-ERROR                                              55830000
558400         MOVE ASC-PO-NBR             TO DK-PO-NBR                 55840000
558500         MOVE ASC-REC-SEQ-NBR        TO DK-REC-SEQ-NBR            55850000
558600                                        DK-RECEIVER               55860000
558700         MOVE LQW-STR-NUMBER (LQW-IDX)  TO DK-STR-NBR             55870000
558800                                                                  55880000
558900******************************************************************55890000
559000* PROCESS SELECTED LINES BASED ON FUNCTION SELECTED               55900000
559100* FUNC-01 (RE-ACTV)                                               55910000
559200*       --ACTV CARTONS CANNOT BE REACTIVATED                      55920000
559300*       --PROCESS WILL ACTIVATE CARTONS THAT HAVE MAX TIMESTAMP   55930000
559400*       --CARTON NBR ENTERED TO REACTIVATE MUST EQUAL PREVIOUS    55940000
559500*         SMOOTHED CARTON COUNT                                   55950000
559600*       --PASS CONTROL TO PCKCS711 TO ADD CARTONS                 55960000
559700* FUNC-03 (INACTV)                                                55970000
559800*       --INACTV SMOOTHED CARTONS ON OTBND AND REACTV CRTNS       55980000
559900*         IF THEY HAD UCC128 DATA                                 55990000
560000* FUNC-07 (SMTH/PRINT)                                            56000000
560100*       --PASS DATA TO PCKCS728 FOR SMOOTHING AND PRINT PROCESS   56010000
560200*       --INACTV UCC128 DATA IF EXISTS FOR STORE                  56020000
560300*       --LQW-PROTECTED INDICATES A STATUS WHERE CARTONS CANNOT   56030000
560400*         BE SMOOTHED                                             56040000
560500***7500- ROUTINE WILL PROCESS OUTBOUND CARTONS THAT NEED TO  *****56050000
560600***      ACTIVATED OR INACTIVATED                             ****56060000
560700***7600- ROUTINE WILL PROCESS VENDOR CARTONS THAT NEED TO     **  56070000
560800***      ACTIVATED OR INACTIVATED                             ****56080000
560900******************************************************************56090000
561000                                                                  56100000
561100                                                                  56110000
561200         IF  LQW-SELECT (LQW-IDX)                                 56120000
561300             EVALUATE TRUE                                        56130000
561400                 WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)      56140000
561500                    PERFORM 5500-CHECK-SMOOTHING-ACTV             56150000
561600                    IF PS-SMOOTHING-ACTV                          56160000
561700                          SET PS-ERROR TO TRUE                    56170000
561800                    ELSE                                          56180000
561900                       MOVE 'N' TO  DK-ACTV-IND-SMTH              56190000
562000                       PERFORM 5530-PRC-SMTHG-DTE-TME-CSR         56200000
562100*                                                                 56210000
562200                       IF PS-SMOOTHING-INACTV                     56220000
562300*CHECK FOR CHANGE IN UNITS                                        56230000
562400                        PERFORM 5600-SUM-INACTV-UNITS             56240000
562500                        IF LQW-NBR-UNITS (LQW-IDX) =              56250000
562600                                PV-SHPD-QTY-PREVIOUS              56260000
562700                          IF LQW-NBR-CARTONS (LQW-IDX) =          56270000
562800                             PV-DB2-COUNT-INACTV                  56280000
562900                              MOVE 'N' TO DK-ACTV-IND-CSR         56290000
563000                              MOVE 'Y' TO DK-ACTV-IND-OTBND       56300000
563100                              MOVE 'A' TO DK-ACTV-IND             56310000
563200                              MOVE 'I' TO PV-PREV-STATUS          56320000
563300                              PERFORM 7500-SEL-ACTV-SHPUNT        56330000
563400*INACTIVATE UCC128 CARTONS ON TSHPUNT                             56340000
563500*SET DK-ACTV-IND-CSR = 'A' TO SELECT CARTONS                      56350000
563600*SET DK-ACTV-IND     = 'I' TO UPDATE TABLE                        56360000
563700                             MOVE 'A'  TO DK-ACTV-IND-CSR         56370000
563800                             MOVE 'I'  TO DK-ACTV-IND             56380000
563900                             MOVE 'N'  TO DK-ACTV-IND-OTBND       56390000
564000                             MOVE 'A'  TO PV-PREV-STATUS          56400000
564100                             PERFORM 7600-SEL-ACTV-SHPUNT-128     56410000
564200                             PERFORM 6500-CALL-PO-RCVR-TRKING-MOD 56420000
564300                          ELSE                                    56430000
564400                             SET PS-INVLD-CRTN-COUNT              56440000
564500                                 PS-ERROR     TO TRUE             56450000
564600                          END-IF                                  56460000
564700                        ELSE                                      56470000
564800                           SET PS-INVALID-UNIT-COUNT              56480000
564900                                 PS-ERROR     TO TRUE             56490000
565000                        END-IF                                    56500000
565100                       ELSE                                       56510000
565200                           SET  PS-ERROR     TO TRUE              56520000
565300                       END-IF                                     56530000
565400                    END-IF                                        56540000
565500                                                                  56550000
565600                                                                  56560000
565700                 WHEN DP020-FK-CONFIRM (DP020-SRC-AID)            56570000
565800                 WHEN DP020-FK-LOCAL-FUNC-07 (DP020-SRC-AID)      56580000
565900                    EVALUATE TRUE                                 56590000
566000                       WHEN ASC-CONFIRM-INACTV                    56600000
566100*CURSOR TO INACTIVATE SMOOTHED CARTONS ON OTBND                   56610000
566200                          MOVE 'Y' TO  DK-ACTV-IND-SMTH           56620000
566300                          PERFORM 5530-PRC-SMTHG-DTE-TME-CSR      56630000
566400** IF PS-INACTV-SMTH-NOT-FND USER TRYING TO INACTV A STORE THAT   56640000
566500** HAS NOT BEEN SMOOTHED                                          56650000
566600                          IF PS-INACTV-SMTH-NOT-FND               56660000
566700                             SET PS-ERROR TO TRUE                 56670000
566800                          ELSE                                    56680000
566900                             MOVE 'Y'  TO DK-ACTV-IND-CSR         56690000
567000                             MOVE 'N'  TO DK-ACTV-IND-OTBND       56700000
567100                             MOVE 'I'  TO DK-ACTV-IND             56710000
567200                             MOVE 'A'  TO PV-PREV-STATUS          56720000
567300                             PERFORM 7500-SEL-ACTV-SHPUNT         56730000
567400                             SET LQW-NOT-PROTECTED (LQW-IDX)      56740000
567500                                  TO TRUE                         56750000
567600                             MOVE 'SMTHING INACTVTD' TO           56760000
567700                                  LQW-STATUS (LQW-IDX)            56770000
567800*REACTIVATE UCC128 CARTONS ON TSHPUNT                             56780000
567900                             MOVE 'I'  TO DK-ACTV-IND-CSR         56790000
568000                             MOVE 'A'  TO DK-ACTV-IND             56800000
568100                             MOVE 'Y'  TO DK-ACTV-IND-OTBND       56810000
568200                             MOVE 'I'  TO PV-PREV-STATUS          56820000
568300                             PERFORM 7600-SEL-ACTV-SHPUNT-128     56830000
568400                             PERFORM 6500-CALL-PO-RCVR-TRKING-MOD 56840000
568500                          END-IF                                  56850000
568600                       WHEN ASC-CONFIRM-UCC128                    56860000
568700                       WHEN DP020-FK-LOCAL-FUNC-07                56870000
568800                                          (DP020-SRC-AID)         56880000
568900                          IF LQW-PROTECTED (LQW-IDX)              56890000
569000                             SET PS-ERROR TO TRUE                 56900000
569100                             SET DP030-OVERRIDE-GO                56910000
569200                                              TO TRUE             56920000
569300                             SET DP020-MSG-WARNING                56930000
569400                                              TO TRUE             56940000
569500                             IF LQW-INVALID-STAT (LQW-IDX)        56950000
569600                                MOVE PC-TSYMSG-02765              56960000
569700                                              TO DP020-MSG-NUMBER 56970000
569800                             ELSE                                 56980000
569900                                MOVE PC-TSYMSG-02692              56990000
570000                                              TO DP020-MSG-NUMBER 57000000
570100                             END-IF                               57010000
570200                          ELSE                                    57020000
570300                            IF LQW-UNKN-ITEM-NBR (LQW-IDX)        57030000
570400                               SET PS-ERROR TO TRUE               57040000
570500                               IF PV-NUMBER-STORES-PROCESSED > 0  57050000
570600                                  PERFORM 4650-ISSUE-PRINT-REQ    57060000
570700                               END-IF                             57070000
570800                               IF PC204-SUCCESSFUL-REQ OR         57080000
570900                                 (PV-NUMBER-STORES-PROCESSED = 0) 57090000
571000                                  SET DP020-MSG-INFORMATIONAL     57100000
571100                                                TO  TRUE          57110000
571200                                  MOVE PC-TSYMSG-02763  TO        57120000
571300                                                 DP020-MSG-NUMBER 57130000
571400                               END-IF                             57140000
571500                            ELSE                                  57150000
571600                               MOVE 'A'  TO DK-ACTV-IND-CSR       57160000
571700                               MOVE 'I'  TO DK-ACTV-IND           57170000
571800                               MOVE 'N'  TO DK-ACTV-IND-OTBND     57180000
571900                               MOVE 'A'  TO PV-PREV-STATUS        57190000
572000                               PERFORM 7600-SEL-ACTV-SHPUNT-128   57200000
572100                               PERFORM 4630-LINK-TO-LOAD-TABLE    57210000
572200                              PERFORM 6500-CALL-PO-RCVR-TRKING-MOD57220000
572300                              ADD +1 TO                           57230000
572400                                      PV-NUMBER-STORES-PROCESSED  57240000
572500                            END-IF                                57250000
572600                          END-IF                                  57260000
572700                    END-EVALUATE                                  57270000
572800             END-EVALUATE                                         57280000
572900         END-IF                                                   57290000
573000     END-IF.                                                      57300000
573100                                                                  57310000
573200                                                                  57320000
573300*----------------------------------------------------------------*57330000
573400*----------------------------------------------------------------*57340000
573500 4630-LINK-TO-LOAD-TABLE.                                         57350000
573600                                                                  57360000
573700     INITIALIZE PC204-INTER-APPL-COMMAREA.                        57370000
573800                                                                  57380000
573900     SET PC204-INITIAL-SMOOTH     TO TRUE.                        57390000
574000                                                                  57400000
574100     MOVE PV-RANDOM-NBR-R         TO PC204-SMTHG-PRC-ID           57410000
574200     MOVE ASC-OPER-UNT-ID         TO PC204-OPER-UNT-ID.           57420000
574300     MOVE ASC-FCLTY-ID            TO PC204-FCLTY-ID.              57430000
574400     MOVE ASC-PO-NBR              TO PC204-PO-NBR.                57440000
574500     MOVE ASC-REC-SEQ-NBR         TO PC204-REC-SEQ-NBR.           57450000
574600                                                                  57460000
574700*    MOVE DK-OPER-UNT-ID          TO PC204-OPER-UNT-ID.           57470000
574800     MOVE LQW-STR-NUMBER (LQW-IDX) TO                             57480000
574900                                   PC204-STR-NBR                  57490000
575000     MOVE LQW-NBR-CARTONS (LQW-IDX) TO                            57500000
575100                                   PC204-LABELS-NEEDED            57510000
575200     ADD  LQW-NBR-CARTONS (LQW-IDX) TO                            57520000
575300                                   PV-TOTAL-LBS-COUNT.            57530000
575400     MOVE LENGTH OF PC204-INTER-APPL-COMMAREA TO                  57540000
575500                                    PV-COMMAREA-LENGTH.           57550000
575600     EXEC CICS                                                    57560000
575700         LINK                                                     57570000
575800             PROGRAM   (PC-PRINT-PROGRAM)                         57580000
575900             COMMAREA  (PC204-INTER-APPL-COMMAREA)                57590000
576000             LENGTH    (PV-COMMAREA-LENGTH)                       57600000
576100             RESP      (PV-CICS-RESP)                             57610000
576200     END-EXEC.                                                    57620000
576300                                                                  57630000
576400                                                                  57640000
576500     EVALUATE TRUE                                                57650000
576600         WHEN PV-CICS-RESP = DFHRESP (NORMAL)                     57660000
576700              IF PC204-SQL-ERROR                                  57670000
576800                  MOVE PC-TSYMSG-02694  TO DP020-MSG-NUMBER       57680000
576900                  PERFORM DP013-0000-PROCESS-ABEND                57690000
577000                  SET PS-ERROR TO TRUE                            57700000
577100              END-IF                                              57710000
577200         WHEN OTHER                                               57720000
577300              MOVE PC-TSYMSG-02694  TO DP020-MSG-NUMBER           57730000
577400              PERFORM DP013-0000-PROCESS-ABEND                    57740000
577500     END-EVALUATE.                                                57750000
577600*----------------------------------------------------------------*57760000
577700* BBR WR41309 - RFID PROCESSING                                   57770000
577800*----------------------------------------------------------------*57780000
577900 4635-DETERMINE-AUTO-CVY-MODE.                                    57790000
577910                                                                  57791000
577920     MOVE ASC-OPER-UNT-ID   TO DK-OPER-UNT-ID.                    57792000
577921     EXEC SQL                                                     57792100
577922         SELECT FUNC_TXT                                          57792200
577923           INTO :PS-AUTOCY-DIRECTIVE-MODE                         57792300
577924           FROM TKRPRPM                                           57792400
577925          WHERE INTFC_SYS_CDE     = 'KHL'                         57792500
577926            AND SYS_PRC_FUNC_CDE  = 'AUTOCY'                      57792600
577927            AND FUNC_PRC_STAT_CDE = 'AC'                          57792700
577928            AND FUNC_BEG_TMST    <= CURRENT TIMESTAMP             57792800
577929            AND FUNC_END_TMST    >= CURRENT TIMESTAMP             57792900
577930            AND LOC_ID            = :DK-OPER-UNT-ID               57793000
577931     END-EXEC                                                     57793100
577932                                                                  57793200
577933     EVALUATE TRUE                                                57793300
577934         WHEN SQLCODE = ZERO                                      57793400
577935            MOVE PS-AUTOCY-DIRECTIVE-MODE  TO ASC-AUTOCY-MODE     57793500
577936**Danh      SET ASC-ISSUED-FOR-ALL         TO TRUE                57793609
577937         WHEN SQLCODE = +100                                      57793700
577938              SET ASC-NO-DIRECTIVES           TO TRUE             57793800
577939         WHEN SQLWARN0 NOT = SPACE                                57793900
577940         WHEN SQLCODE NOT = ZERO                                  57794000
577941              MOVE  DK-PO-NBR  TO PV-DISPLAY-PO-NBR               57794100
577950              MOVE  ASC-REC-SEQ-NBR TO PV-DISPLAY-RCVR            57795000
577951              MOVE '4635-DETERMINE-AUTO-CVY-MODE'                 57795100
577952                               TO DP013-PARAGRAPH                 57795200
577953              MOVE 'SELECT AUTO CONVEYOR MODE'                    57795300
577954                               TO DP013-MESSAGE-TEXT (1)          57795400
577955              MOVE PC204-SMTHG-PRC-ID TO PV-DISPLAY-SMTHG-PRC-ID  57795500
577956              STRING 'SMTHG-PRC-ID:'      DELIMITED BY SIZE       57795600
577957                      PV-DISPLAY-SMTHG-PRC-ID DELIMITED BY SIZE   57795700
577958                                     INTO DP013-MESSAGE-TEXT (2)  57795800
577959              MOVE 'TKRPRPM'    TO DP013-DB2-TABLE-NAME (1)       57795900
577960              MOVE SQLCA        TO DP013-SQLCA                    57796000
577961              SET DP013-DB2-ABEND                                 57796100
577962                                TO TRUE                           57796200
577963              PERFORM DP013-0000-PROCESS-ABEND                    57796300
577964     END-EVALUATE.                                                57796400
577965                                                                  57796500
577966* BBR WR41309 - RFID PROCESSING                                   57796600
577967 4639-CHCK-RFID-DIRECTVS.                                         57796700
577968                                                                  57796800
577969     IF (ASC-ISSUED-FOR-EXCP OR ASC-ISSUED-FOR-ALL) AND           57796908
577970         PC204-RFID-STORE-YES                                     57797008
577980         PERFORM 4640-CALL-DIRECTIVES-MOD                         57798000
577981     END-IF.                                                      57798100
577982                                                                  57798200
577983 4640-CALL-DIRECTIVES-MOD.                                        57798300
577984                                                                  57798400
577985     INITIALIZE SU095-DIRECTIVE-COMMAREA.                         57798500
577986     SET  SU095-SMOOTHING           TO TRUE.                      57798600
577987                                                                  57798700
577988     MOVE ASC-PO-NBR                TO SU095-KEY-PO.              57798800
577989     MOVE ASC-REC-SEQ-NBR           TO SU095-KEY-REC-SEQ-NBR.     57798900
577990     MOVE ASC-OPER-UNT-ID           TO SU095-KEY-OPER-UNT-ID.     57799000
577991     MOVE PC204-STR-NBR             TO SU095-STORE.               57799100
577992     MOVE PC204-SMTHG-PRC-ID        TO SU095-SMTHG-PRC-ID         57799200
577993     MOVE DP020-USERID              TO SU095-ASSOC-ID.            57799300
577994                                                                  57799400
577995     MOVE LENGTH OF SU095-DIRECTIVE-COMMAREA                      57799500
577996                                    TO PV-COMMAREA-LENGTH.        57799600
577997                                                                  57799700
577998     CALL SU095-CRTN-DIR-PGM USING  DFHEIBLK                      57799800
577999                                    SU095-COMMAREA                57799900
578000                                    SU095-DIRECTIVE-COMMAREA.     57800000
578001     EVALUATE TRUE                                                57800100
578002        WHEN SU095-SUCCESS                                        57800200
578003            CONTINUE                                              57800300
578004        WHEN OTHER                                                57800400
578005          MOVE ASC-OPER-UNT-ID   TO  PV-DISPLAY-OPER              57800500
578006          MOVE ASC-PO-NBR        TO  PV-DISPLAY-PO-NBR            57800600
578007          MOVE ASC-REC-SEQ-NBR   TO  PV-DISPLAY-RCVR-SEQ-NBR      57800700
578008          INITIALIZE PV-CICS-MSG-AREA                             57800800
578009          STRING ' PCKCS710-4640- '                               57800900
578010                  PV-DISPLAY-OPER   '-'                           57801000
578020                  PV-DISPLAY-PO-NBR '-'                           57802000
578030                  PV-DISPLAY-RCVR-SEQ-NBR ' - '                   57803000
578031                 ' - SUCCESS IND - '                              57803100
578032                  SU095-RET-CODE        DELIMITED BY SIZE         57803200
578033                                       INTO PV-CICS-MSG-AREA2     57803300
578034           MOVE LENGTH OF PV-CICS-MSG-AREA2                       57803400
578035                                         TO PV-COMMAREA-LENGTH    57803500
578036           EXEC CICS                                              57803600
578037                WRITEQ TD                                         57803700
578038                 QUEUE  ('CSSL')                                  57803800
578039                  FROM  (PV-CICS-MSG-AREA2)                       57803900
578040                LENGTH  (PV-COMMAREA-LENGTH)                      57804000
578041                  RESP  (PV-CICS-RESP)                            57804100
578042           END-EXEC.                                              57804200
578043                                                                  57804300
578044*----------------------------------------------------------------*57804400
578045* BBR WR41309 - END                                               57804500
578046*----------------------------------------------------------------*57804600
578047 4650-ISSUE-PRINT-REQ.                                            57804700
578048                                                                  57804800
578049     IF DP020-FK-LOCAL-FUNC-08 (DP020-SRC-AID)                    57804900
578050        SET PC204-REPRINT-STORE-LIST TO TRUE                      57805000
578060     ELSE                                                         57806000
578070        SET PC204-UNLOAD-AND-PRINT   TO TRUE                      57807000
578071* BBR WR41309 - RFID PROCESSING                                   57807100
578072        IF ASC-ISSUED-FOR-EXCP                                    57807200
578073            SET PC204-AUTO-CONVEY-EXCPT-CRTNS   TO TRUE           57807300
578074        ELSE                                                      57807400
578075            IF ASC-ISSUED-FOR-ALL                                 57807500
578076                SET PC204-AUTO-CONVEY-ALL-CRTNS TO TRUE           57807600
578077            ELSE                                                  57807700
578078                SET PC204-AUTO-CONVEY-NO-CRTNS  TO TRUE           57807800
578079            END-IF                                                57807900
578080        END-IF                                                    57808000
578081* BBR WR41309 - END                                               57808100
578082     END-IF.                                                      57808200
578083                                                                  57808300
578084     MOVE PV-RANDOM-NBR-R         TO PC204-SMTHG-PRC-ID           57808400
578085     MOVE ASC-OPER-UNT-ID         TO PC204-OPER-UNT-ID.           57808500
578086     MOVE ASC-FCLTY-ID            TO PC204-FCLTY-ID.              57808600
578087     MOVE ASC-PO-NBR              TO PC204-PO-NBR.                57808700
578088     MOVE ASC-REC-SEQ-NBR         TO PC204-REC-SEQ-NBR.           57808800
578089     MOVE PV-SHP-PRTR-ID-ADDR     TO PC204-SHP-PRTR-IP-ADDR.      57808900
578090     MOVE ASC-SML-PRINTER         TO PC204-SML-PRINTER.           57809000
578100     MOVE PV-TOTAL-LBS-COUNT      TO PC204-TOT-LABELS-CNT.        57810000
578200                                                                  57820000
578300     MOVE LENGTH OF PC204-INTER-APPL-COMMAREA                     57830000
578400                                        TO PV-COMMAREA-LENGTH.    57840000
578500                                                                  57850000
578600     EXEC CICS                                                    57860000
578700         LINK                                                     57870000
578800             PROGRAM   (PC-PRINT-PROGRAM)                         57880000
578900             COMMAREA  (PC204-INTER-APPL-COMMAREA)                57890000
579000             LENGTH    (PV-COMMAREA-LENGTH)                       57900000
579100             RESP      (PV-CICS-RESP)                             57910000
579200     END-EXEC.                                                    57920000
579300                                                                  57930000
579400     EVALUATE TRUE                                                57940000
579500         WHEN PV-CICS-RESP = DFHRESP (NORMAL)                     57950000
579600              IF PC204-SUCCESSFUL-REQ                             57960000
579700                 IF PC204-UNLOAD-AND-PRINT                        57970000
579800                    PERFORM 4639-CHCK-RFID-DIRECTVS               57980000
579900                 END-IF                                           57990000
580000              ELSE                                                58000000
580100                  IF PC204-SQL-ERROR                              58010000
580200                     SET DP020-MSG-INFORMATIONAL  TO  TRUE        58020000
580300                     MOVE PC-TSYMSG-02694  TO DP020-MSG-NUMBER    58030000
580400                     SET PS-ERROR TO TRUE                         58040000
580500                  ELSE                                            58050000
580600                     SET DP020-MSG-INFORMATIONAL  TO  TRUE        58060000
580700                     MOVE PC-TSYMSG-02693  TO DP020-MSG-NUMBER    58070000
580800                     SET PS-ERROR TO TRUE                         58080000
580900                  END-IF                                          58090000
581000              END-IF                                              58100000
581100*-2693 COMMUNICATION-ERROR--*                                     58110000
581200*-2694  DATABASE ERROR------*                                     58120000
581300         WHEN OTHER                                               58130000
581400            IF PC204-SQL-ERROR                                    58140000
581500               SET DP020-MSG-INFORMATIONAL  TO  TRUE              58150000
581600               MOVE PC-TSYMSG-02694  TO DP020-MSG-NUMBER          58160000
581700               SET PS-ERROR TO TRUE                               58170000
581800            ELSE                                                  58180000
581900               SET DP020-MSG-INFORMATIONAL  TO  TRUE              58190000
582000               MOVE PC-TSYMSG-02693  TO DP020-MSG-NUMBER          58200000
582100               SET PS-ERROR TO TRUE                               58210000
582200            END-IF                                                58220000
582300     END-EVALUATE.                                                58230000
582400                                                                  58240000
582500     IF  DP020-FK-LOCAL-FUNC-08 (DP020-SRC-AID)                   58250000
582600     OR  PS-ERROR                                                 58260000
582700         CONTINUE                                                 58270000
582800     ELSE                                                         58280000
582900         PERFORM 4700-INTERFACE-LABOR                             58290000
583000     END-IF.                                                      58300000
583100                                                                  58310000
583200 4700-INTERFACE-LABOR.                                            58320000
583300                                                                  58330000
583400* TCR - 1/29/04 - LABOR - BEGIN                                   58340000
583500     PERFORM 3600-CHECK-DC-LABOR.                                 58350000
583600                                                                  58360000
583700     IF  ASC-DC-INTERFC-LABOR-YES                                 58370000
583800         MOVE DP020-USERID TO PV-LABOR-USER-ID                    58380000
583900         SET PS-LABOR-LOG-HEADER TO TRUE                          58390000
584000         PERFORM 3610-CHECK-LABOR-ASGMT                           58400000
584100         IF  ASC-ASSOC-LABOR-ASGMT-YES                            58410000
584200             PERFORM 3620-GET-LABOR-SEQ-NBR                       58420000
584300             PERFORM 3630-SEND-LABOR-TO-EAI                       58430000
584400         END-IF                                                   58440000
584500         PERFORM 3660-GET-DUMMY-LABOR-TK                          58450000
584600         MOVE PV-LABOR-DUMMY-TK TO PV-LABOR-USER-ID               58460000
584700         SET PS-LABOR-LOG-PHY-LBL TO TRUE                         58470000
584800         PERFORM 3610-CHECK-LABOR-ASGMT                           58480000
584900         IF  ASC-ASSOC-LABOR-ASGMT-YES                            58490000
585000             PERFORM 3620-GET-LABOR-SEQ-NBR                       58500000
585100*              GET CARTONS AND UNITS                              58510000
585200             PERFORM 4710-OPEN-CTN-UNT-CSR                        58520000
585300             SET PS-END-OF-CTN-CSR-NO TO TRUE                     58530000
585400             PERFORM 4720-FETCH-CTN-UNT-CSR                       58540000
585500               UNTIL PS-END-OF-CTN-CSR-YES                        58550000
585600             PERFORM 4730-CLOSE-CTN-UNT-CSR                       58560000
585700             PERFORM 3630-SEND-LABOR-TO-EAI                       58570000
585800         END-IF                                                   58580000
585900     END-IF.                                                      58590000
586000                                                                  58600000
586100* TCR - 1/29/04 - LABOR - END                                     58610000
586200                                                                  58620000
586300 4710-OPEN-CTN-UNT-CSR.                                           58630000
586400                                                                  58640000
586500     PERFORM                                                      58650000
586600         WITH TEST AFTER                                          58660000
586700         VARYING PV-RETRY-COUNTER                                 58670000
586800         FROM 1 BY 1                                              58680000
586900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               58690000
587000                   OR (SQLCODE = ZERO))                           58700000
587100                                                                  58710000
587200                 EXEC SQL                                         58720000
587300                      OPEN CTN_UNT_CSR                            58730000
587400                 END-EXEC                                         58740000
587500                                                                  58750000
587600                                                                  58760000
587700         EVALUATE TRUE                                            58770000
587800             WHEN SQLCODE = ZERO                                  58780000
587900             WHEN SQLCODE = -904                                  58790000
588000             WHEN SQLCODE = -913                                  58800000
588100                 CONTINUE                                         58810000
588200             WHEN SQLWARN0 NOT = SPACES                           58820000
588300             WHEN SQLCODE < ZERO                                  58830000
588400             WHEN SQLCODE > ZERO                                  58840000
588500                 MOVE '4710-OPEN-CTN-UNT-CSR'                     58850000
588600                                   TO DP013-PARAGRAPH             58860000
588700                 MOVE 'OPEN CTN/UNT CURSOR - '                    58870000
588800                                   TO DP013-MESSAGE-TEXT (1)      58880000
588900                 MOVE SQLCA        TO DP013-SQLCA                 58890000
589000                 MOVE 'SUT00003'   TO DP013-DB2-TABLE-NAME (1)    58900000
589100                 SET DP013-DB2-ABEND                              58910000
589200                     DP013-XCTL-DISPLAY-RESTART TO TRUE           58920000
589300                 PERFORM DP013-0000-PROCESS-ABEND                 58930000
589400         END-EVALUATE                                             58940000
589500     END-PERFORM.                                                 58950000
589600                                                                  58960000
589700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    58970000
589800         SQLCODE NOT = ZERO                                       58980000
589900         MOVE '4710-OPEN-CTN-UNT-CSR   ' TO DP013-PARAGRAPH       58990000
590000         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   59000000
590100                                   TO DP013-MESSAGE-TEXT (1)      59010000
590200         MOVE SQLCA                TO DP013-SQLCA                 59020000
590300         MOVE 'SUT00003'           TO DP013-DB2-TABLE-NAME (1)    59030000
590400         SET DP013-DB2-ABEND                                      59040000
590500             DP013-XCTL-DISPLAY-RESTART                           59050000
590600                                   TO TRUE                        59060000
590700         PERFORM DP013-0000-PROCESS-ABEND                         59070000
590800     END-IF.                                                      59080000
590900                                                                  59090000
591000                                                                  59100000
591100 4720-FETCH-CTN-UNT-CSR.                                          59110000
591200                                                                  59120000
591300     EXEC SQL                                                     59130000
591400            FETCH   CTN_UNT_CSR                                   59140000
591500            INTO   :SUT00003-STR-NBR                              59150000
591600                 , :PV-MAX-CTN                                    59160000
591700                 , :PV-SUM-UNT                                    59170000
591800     END-EXEC                                                     59180000
591900                                                                  59190000
592000                                                                  59200000
592100     EVALUATE TRUE                                                59210000
592200         WHEN SQLCODE = ZERO                                      59220000
592300            ADD +1 TO PV-STR-COUNT                                59230000
592400            ADD PV-MAX-CTN TO PV-MAX-CTN-TOT                      59240000
592500            ADD PV-SUM-UNT TO PV-SUM-UNT-TOT                      59250000
592600         WHEN SQLCODE = +100                                      59260000
592700              SET PS-END-OF-CTN-CSR-YES TO TRUE                   59270000
592800         WHEN SQLWARN0 NOT = SPACE                                59280000
592900         WHEN SQLCODE NOT = ZERO                                  59290000
593000              MOVE  DK-PO-NBR  TO PV-DISPLAY-PO-NBR               59300000
593100              MOVE  ASC-REC-SEQ-NBR TO PV-DISPLAY-RCVR            59310000
593200              MOVE '4720-FETCH-CTN-UNT-CSR'                       59320000
593300                               TO DP013-PARAGRAPH                 59330000
593400              MOVE 'FETCH CTN/UNT CURSOR'                         59340000
593500                               TO DP013-MESSAGE-TEXT (1)          59350000
593600              MOVE PC204-SMTHG-PRC-ID TO PV-DISPLAY-SMTHG-PRC-ID  59360000
593700              STRING 'SMTHG-PRC-ID:'      DELIMITED BY SIZE       59370000
593800                      PV-DISPLAY-SMTHG-PRC-ID DELIMITED BY SIZE   59380000
593900                                     INTO DP013-MESSAGE-TEXT (2)  59390000
594000              MOVE 'SUT00003'   TO DP013-DB2-TABLE-NAME (1)       59400000
594100              MOVE SQLCA        TO DP013-SQLCA                    59410000
594200              SET DP013-DB2-ABEND                                 59420000
594300                                TO TRUE                           59430000
594400              PERFORM DP013-0000-PROCESS-ABEND                    59440000
594500     END-EVALUATE.                                                59450000
594600                                                                  59460000
594700                                                                  59470000
594800 4730-CLOSE-CTN-UNT-CSR.                                          59480000
594900                                                                  59490000
595000         EXEC SQL                                                 59500000
595100             CLOSE CTN_UNT_CSR                                    59510000
595200         END-EXEC                                                 59520000
595300                                                                  59530000
595400     EVALUATE TRUE                                                59540000
595500         WHEN SQLCODE = ZERO                                      59550000
595600             CONTINUE                                             59560000
595700         WHEN SQLWARN0 NOT = SPACES                               59570000
595800         WHEN SQLCODE < ZERO                                      59580000
595900         WHEN SQLCODE > ZERO                                      59590000
596000             MOVE '4730-CLOSE-CTN-UNT-CSR   '                     59600000
596100                               TO DP013-PARAGRAPH                 59610000
596200             MOVE 'CLOSE CTN/UNT CURSOR'                          59620000
596300                               TO DP013-MESSAGE-TEXT (1)          59630000
596400             MOVE SQLCA        TO DP013-SQLCA                     59640000
596500             MOVE 'SUT00003'   TO DP013-DB2-TABLE-NAME (1)        59650000
596600             SET DP013-DB2-ABEND                                  59660000
596700                 DP013-XCTL-DISPLAY-RESTART TO TRUE               59670000
596800             PERFORM DP013-0000-PROCESS-ABEND                     59680000
596900     END-EVALUATE.                                                59690000
597000                                                                  59700000
597100*----------------------------------------------------------------*59710000
597200*----------------------------------------------------------------*59720000
597300* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *59730000
597400* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *59740000
597500* FOR THE SELECTED ITEMS QUEUE.                                  *59750000
597600*                                                                *59760000
597700* DETERMINE WHICH COPYBOOK WILL BE USED TO PREPARE THE SELECTION *59770000
597800* QUEUE BASED ON THE FUNCTION SELECTED (FUNC02 AND FUNC03 GO TO  *59780000
597900* RC LISTS WHICH USE A DIFFERENT COPYBOOK                        *59790000
598000*                                                                *59800000
598100* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *59810000
598200* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *59820000
598300* THE ARRAY IS FULL.                                             *59830000
598400*----------------------------------------------------------------*59840000
598500                                                                  59850000
598600 5000-PREPARE-SEL-QUEUE.                                          59860000
598700                                                                  59870000
598800     MOVE +1                   TO  ASC-BLK-SUB.                   59880000
598900     PERFORM 5100-WRITE-TEMP-STORAGE.                             59890000
599000     ADD +1                    TO  ASC-BLK-SUB.                   59900000
599100     PERFORM 5100-WRITE-TEMP-STORAGE.                             59910000
599200     EVALUATE TRUE                                                59920000
599300       WHEN DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)                59930000
599400       WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)                59940000
599500         MOVE ASC-SEL-QUEUE-NAME TO RC015-SEL-QUEUE-NAME          59950000
599600       WHEN DP020-FK-LOCAL-FUNC-08 (DP020-SRC-AID)                59960000
599700         MOVE ASC-SEL-QUEUE-NAME     TO  PC204-SEL-QUEUE-NAME     59970000
599800       WHEN OTHER                                                 59980000
599900         MOVE ASC-SEL-QUEUE-NAME     TO  PC202-SEL-QUEUE-NAME     59990000
600000     END-EVALUATE                                                 60000000
600100                                                                  60010000
600200     PERFORM 6010-DELETE-SEL-QUEUE.                               60020000
600300                                                                  60030000
600400     SET ASC-UPDATE-TSQ        TO  TRUE.                          60040000
600500     EVALUATE TRUE                                                60050000
600600       WHEN DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)                60060000
600700       WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)                60070000
600800         SET RC013-IDX         TO  1                              60080000
600900         MOVE ZERO             TO RC015-NUMBER-OF-TS-ITEMS        60090000
601000         INITIALIZE RC013-SELECTED-ITEM-ARRAY                     60100000
601100       WHEN DP020-FK-LOCAL-FUNC-08 (DP020-SRC-AID)                60110000
601200         SET PC206-IDX         TO  1                              60120000
601300         MOVE ZERO             TO PC204-NUMBER-OF-TS-ITEMS        60130000
601400         INITIALIZE PC206-SELECTED-ITEM-ARRAY                     60140000
601500       WHEN OTHER                                                 60150000
601600         SET PC203-IDX         TO  1                              60160000
601700         MOVE ZERO             TO PC202-NUMBER-OF-TS-ITEMS        60170000
601800         INITIALIZE PC203-SELECTED-ITEM-ARRAY                     60180000
601900       END-EVALUATE.                                              60190000
602000                                                                  60200000
602100     EVALUATE TRUE                                                60210000
602200       WHEN DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)                60220000
602300       WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)                60230000
602400         SET PS-NO-VERIFIED-RECEIVER TO TRUE                      60240000
602500         PERFORM 5300-FILL-SEL-QUEUE-RECORD                       60250000
602600           VARYING PV-ITEM FROM 1 BY 1                            60260000
602700             UNTIL PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN            60270000
602800       WHEN DP020-FK-LOCAL-FUNC-08 (DP020-SRC-AID)                60280000
602900         PERFORM 5250-FILL-SEL-QUEUE-RECORD                       60290000
603000                 VARYING PV-ITEM                                  60300000
603100                 FROM 1 BY 1                                      60310000
603200                 UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN  60320000
603300       WHEN OTHER                                                 60330000
603400         PERFORM 5200-FILL-SEL-QUEUE-RECORD                       60340000
603500           VARYING PV-ITEM FROM 1 BY 1                            60350000
603600             UNTIL PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN            60360000
603700     END-EVALUATE                                                 60370000
603800                                                                  60380000
603900                                                                  60390000
604000     EVALUATE TRUE                                                60400000
604100       WHEN DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)                60410000
604200       WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)                60420000
604300         IF RC013-IDX > 1                                         60430000
604400             PERFORM 5305-WRITE-SEL-QUEUE                         60440000
604500             ADD +1 TO RC015-NUMBER-OF-TS-ITEMS                   60450000
604600         END-IF                                                   60460000
604700       WHEN DP020-FK-LOCAL-FUNC-08 (DP020-SRC-AID)                60470000
604800         IF PC206-IDX > 1                                         60480000
604900             PERFORM 5255-WRITE-SEL-QUEUE                         60490000
605000             ADD +1 TO PC204-NUMBER-OF-TS-ITEMS                   60500000
605100         END-IF                                                   60510000
605200       WHEN OTHER                                                 60520000
605300         IF PC203-IDX > 1                                         60530000
605400             PERFORM 5205-WRITE-SEL-QUEUE                         60540000
605500             ADD +1 TO PC202-NUMBER-OF-TS-ITEMS                   60550000
605600         END-IF                                                   60560000
605700     END-EVALUATE.                                                60570000
605800                                                                  60580000
605900**********************************************************        60590000
606000 5010-OPEN-TOTAL-UNTS-CSR.                                        60600000
606100                                                                  60610000
606200     PERFORM                                                      60620000
606300         WITH TEST AFTER                                          60630000
606400         VARYING PV-RETRY-COUNTER                                 60640000
606500         FROM 1 BY 1                                              60650000
606600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               60660000
606700                   OR (SQLCODE = ZERO))                           60670000
606800                                                                  60680000
606900                 EXEC SQL                                         60690000
607000                      OPEN TOTAL_UNTS_CSR                         60700000
607100                 END-EXEC                                         60710000
607200                                                                  60720000
607300                                                                  60730000
607400         EVALUATE TRUE                                            60740000
607500             WHEN SQLCODE = ZERO                                  60750000
607600             WHEN SQLCODE = -904                                  60760000
607700             WHEN SQLCODE = -913                                  60770000
607800                 CONTINUE                                         60780000
607900             WHEN SQLWARN0 NOT = SPACES                           60790000
608000             WHEN SQLCODE < ZERO                                  60800000
608100             WHEN SQLCODE > ZERO                                  60810000
608200                 MOVE '5010-OPEN-TOTAL-UNTS-CSR'                  60820000
608300                                   TO DP013-PARAGRAPH             60830000
608400                 MOVE 'OPEN SHIPMT CURSOR - '                     60840000
608500                                   TO DP013-MESSAGE-TEXT (1)      60850000
608600                 MOVE SQLCA        TO DP013-SQLCA                 60860000
608700                 MOVE 'TSHIPMT '   TO DP013-DB2-TABLE-NAME (1)    60870000
608800                 SET DP013-DB2-ABEND                              60880000
608900                     DP013-XCTL-DISPLAY-RESTART TO TRUE           60890000
609000                 PERFORM DP013-0000-PROCESS-ABEND                 60900000
609100         END-EVALUATE                                             60910000
609200     END-PERFORM.                                                 60920000
609300                                                                  60930000
609400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    60940000
609500         SQLCODE NOT = ZERO                                       60950000
609600         MOVE '5010-OPEN-TOTAL-UNTS-CSR' TO DP013-PARAGRAPH       60960000
609700         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   60970000
609800                                   TO DP013-MESSAGE-TEXT (1)      60980000
609900         MOVE SQLCA                TO DP013-SQLCA                 60990000
610000         MOVE 'TSHIPMT '           TO DP013-DB2-TABLE-NAME (1)    61000000
610100         SET DP013-DB2-ABEND                                      61010000
610200             DP013-XCTL-DISPLAY-RESTART                           61020000
610300                                   TO TRUE                        61030000
610400         PERFORM DP013-0000-PROCESS-ABEND                         61040000
610500     END-IF.                                                      61050000
610600                                                                  61060000
610700******************************************************************61070000
610800* CLOSE TOTAL UNITS CURSOR                                        61080000
610900******************************************************************61090000
611000 5020-CLOSE-TOTAL-UNTS-CSR.                                       61100000
611100                                                                  61110000
611200         EXEC SQL                                                 61120000
611300             CLOSE TOTAL_UNTS_CSR                                 61130000
611400         END-EXEC                                                 61140000
611500                                                                  61150000
611600     EVALUATE TRUE                                                61160000
611700         WHEN SQLCODE = ZERO                                      61170000
611800             CONTINUE                                             61180000
611900         WHEN SQLWARN0 NOT = SPACES                               61190000
612000         WHEN SQLCODE < ZERO                                      61200000
612100         WHEN SQLCODE > ZERO                                      61210000
612200             MOVE '5020-CLOSE-TOTAL-UNTS-CSR'                     61220000
612300                               TO DP013-PARAGRAPH                 61230000
612400             MOVE 'CLOSE SHIPMT CURSOR '                          61240000
612500                               TO DP013-MESSAGE-TEXT (1)          61250000
612600             MOVE SQLCA        TO DP013-SQLCA                     61260000
612700             MOVE 'TSYMSG  '   TO DP013-DB2-TABLE-NAME (1)        61270000
612800             SET DP013-DB2-ABEND                                  61280000
612900                 DP013-XCTL-DISPLAY-RESTART TO TRUE               61290000
613000             PERFORM DP013-0000-PROCESS-ABEND                     61300000
613100     END-EVALUATE.                                                61310000
613200                                                                  61320000
613300*----------------------------------------------------------------*61330000
613400*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *61340000
613500*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *61350000
613600*----------------------------------------------------------------*61360000
613700 5100-WRITE-TEMP-STORAGE.                                         61370000
613800     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     61380000
613900                                   TO PV-LIST-ITEM-NUMBER.        61390000
614000     COMPUTE PV-BLOCK-NUMBER =                                    61400000
614100         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    61410000
614200                                                                  61420000
614300     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             61430000
614400     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             61440000
614500         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      61450000
614600             PERFORM 5105-REWRITE-ASC-LISTQ                       61460000
614700         END-IF                                                   61470000
614800     ELSE                                                         61480000
614900         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       61490000
615000         ASC-HIGHEST-BLOCK-WRITTEN + 1                            61500000
615100         PERFORM 5110-WRITE-ASC-LISTQ                             61510000
615200         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   61520000
615300     END-IF.                                                      61530000
615400                                                                  61540000
615500     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             61550000
615600******************************************************************61560000
615700** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **61570000
615800** SPECIFIC COMMAREA.                                           **61580000
615900******************************************************************61590000
616000 5105-REWRITE-ASC-LISTQ.                                          61600000
616100     EXEC CICS                                                    61610000
616200         WRITEQ TS                                                61620000
616300             QUEUE (ASC-LIST-QUEUE-NAME)                          61630000
616400             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               61640000
616500             ITEM  (PV-BLOCK-NUMBER)                              61650000
616600             REWRITE                                              61660000
616700             RESP  (PV-CICS-RESP)                                 61670000
616800     END-EXEC.                                                    61680000
616900                                                                  61690000
617000     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           61700000
617100         CONTINUE                                                 61710000
617200     ELSE                                                         61720000
617300         SET DP013-CICS-ABEND            TO TRUE                  61730000
617400         SET DP013-NO-ROLLBACK           TO TRUE                  61740000
617500         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       61750000
617600         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     61760000
617700                                         TO DP013-MESSAGE-TEXT(1) 61770000
617800         PERFORM DP013-0000-PROCESS-ABEND                         61780000
617900     END-IF.                                                      61790000
618000                                                                  61800000
618100******************************************************************61810000
618200** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **61820000
618300** SPECIFIC COMMAREA.                                           **61830000
618400******************************************************************61840000
618500 5110-WRITE-ASC-LISTQ.                                            61850000
618600     EXEC CICS                                                    61860000
618700         WRITEQ TS                                                61870000
618800             QUEUE (ASC-LIST-QUEUE-NAME)                          61880000
618900             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               61890000
619000             ITEM  (PV-BLOCK-NUMBER)                              61900000
619100             RESP  (PV-CICS-RESP)                                 61910000
619200     END-EXEC.                                                    61920000
619300     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      61930000
619400         SET DP013-CICS-ABEND      TO TRUE                        61940000
619500         SET DP013-NO-ROLLBACK     TO TRUE                        61950000
619600         MOVE '5110-WRITE-ASC-LISTQ'                              61960000
619700                                   TO DP013-PARAGRAPH             61970000
619800         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           61980000
619900                                   TO DP013-MESSAGE-TEXT(1)       61990000
620000         PERFORM DP013-0000-PROCESS-ABEND                         62000000
620100     END-IF.                                                      62010000
620200                                                                  62020000
620300*----------------------------------------------------------------*62030000
620400* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *62040000
620500* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *62050000
620600*----------------------------------------------------------------*62060000
620700 5200-FILL-SEL-QUEUE-RECORD.                                      62070000
620800                                                                  62080000
620900     PERFORM 6112-READ-LIST-QUEUE.                                62090000
621000     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       62100000
621100         PERFORM                                                  62110000
621200         VARYING LQW-IDX                                          62120000
621300         FROM 1 BY 1                                              62130000
621400         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            62140000
621500           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          62150000
621600                                                                  62160000
621700             IF  LQW-SELECT (LQW-IDX)                             62170000
621800               MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)                62180000
621900                                 TO PC203-ITEM (PC203-IDX)        62190000
622000               MOVE SPACE        TO PC203-ACTION-SW (PC203-IDX)   62200000
622100               MOVE LQW-NBR-CARTONS (LQW-IDX)                     62210000
622200                         TO PC203-PREV-CTN-COUNT (PC203-IDX)      62220000
622300               MOVE LQW-STR-NUMBER  (LQW-IDX)                     62230000
622400                         TO PC203-DEST-OPER-UNT-ID (PC203-IDX)    62240000
622500                            DK-STR-NBR                            62250000
622600               MOVE LQW-NBR-UNITS (LQW-IDX)                       62260000
622700                         TO PC203-DEST-STORE-UNITS (PC203-IDX)    62270000
622800               MOVE ASC-TOTAL-CART                                62280000
622900                         TO PC203-TOT-CRTNS-PO(PC203-IDX)         62290000
623000               PERFORM 5500-CHECK-SMOOTHING-ACTV                  62300000
623100               IF PV-DB2-COUNT-ACTV = 0                           62310000
623200                   SET PS-SMOOTHING-INACTV TO TRUE                62320000
623300               END-IF                                             62330000
623400                 SET PC203-IDX UP BY 1                            62340000
623500                 IF  PC203-IDX > PC203-MAX-ITEMS                  62350000
623600                     PERFORM 5205-WRITE-SEL-QUEUE                 62360000
623700                     ADD +1        TO PC202-NUMBER-OF-TS-ITEMS    62370000
623800                     INITIALIZE PC203-SELECTED-ITEM-ARRAY         62380000
623900                     SET PC203-IDX TO  1                          62390000
624000                 END-IF                                           62400000
624100             END-IF                                               62410000
624200         END-PERFORM                                              62420000
624300     END-IF.                                                      62430000
624400                                                                  62440000
624500*----------------------------------------------------------------*62450000
624600*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *62460000
624700*----------------------------------------------------------------*62470000
624800                                                                  62480000
624900 5205-WRITE-SEL-QUEUE.                                            62490000
625000                                                                  62500000
625100     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            62510000
625200                                   TO PC203-SELECTED-ITEMS.       62520000
625300                                                                  62530000
625400     EXEC CICS                                                    62540000
625500          WRITEQ TS                                               62550000
625600              QUEUE (ASC-SEL-QUEUE-NAME)                          62560000
625700              FROM  (PC203-DC-SELECT-RECORD)                      62570000
625800              ITEM  (PV-SEL-QUEUE-ITEM)                           62580000
625900              RESP  (PV-CICS-RESP)                                62590000
626000     END-EXEC.                                                    62600000
626100                                                                  62610000
626200     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          62620000
626300         CONTINUE                                                 62630000
626400     ELSE                                                         62640000
626500         SET DP013-CICS-ABEND      TO TRUE                        62650000
626600         SET DP013-NO-ROLLBACK     TO TRUE                        62660000
626700         MOVE '5205-WRITE-SEL-QUEUE'                              62670000
626800                                   TO DP013-PARAGRAPH             62680000
626900         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          62690000
627000                                   TO DP013-MESSAGE-TEXT(1)       62700000
627100         PERFORM DP013-0000-PROCESS-ABEND                         62710000
627200     END-IF.                                                      62720000
627300*----------------------------------------------------------------*62730000
627400* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *62740000
627500* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.                62750000
627600* MOVE THE KEY OF THE SELECTED LIST ITEM THAT WILL BE PASSED     *62760000
627700* TO THE DESTINATION APPLICATION.                                 62770000
627800*----------------------------------------------------------------*62780000
627900 5250-FILL-SEL-QUEUE-RECORD.                                      62790000
628000                                                                  62800000
628100     PERFORM 6112-READ-LIST-QUEUE.                                62810000
628200                                                                  62820000
628300     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       62830000
628400         PERFORM                                                  62840000
628500         VARYING LQW-IDX                                          62850000
628600         FROM 1 BY 1                                              62860000
628700         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            62870000
628800           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          62880000
628900                                                                  62890000
629000             IF  LQW-SELECT (LQW-IDX)                             62900000
629100                 IF (LQW-PHYSICAL-INV-YES (LQW-IDX) OR            62910000
629200                    LQW-VERIFIED-LINE-YES (LQW-IDX)) AND          62920000
629300                    PS-SMOOTHING-ACTV                             62930000
629400                       CONTINUE                                   62940000
629500                 ELSE                                             62950000
629600                    IF LQW-INVALID (LQW-IDX)                      62960000
629700                        SET PS-INVALID-REPRINT-STATUS TO TRUE     62970000
629800                    END-IF                                        62980000
629900                 END-IF                                           62990000
630000                 ADD  LQW-NBR-CARTONS (LQW-IDX) TO                63000000
630100                                               PV-TOTAL-LBS-COUNT 63010000
630200                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              63020000
630300                                   TO PC206-ITEM (PC206-IDX)      63030000
630400                 MOVE SPACES       TO PC206-ACTION-SW (PC206-IDX) 63040000
630500                                                                  63050000
630600                 MOVE LQW-STR-NUMBER (LQW-IDX)                    63060000
630700                                   TO PC206-STR-NUMBER            63070000
630800                                      (PC206-IDX)                 63080000
630900                                                                  63090000
631000                 SET PC206-IDX UP BY 1                            63100000
631100                 IF  PC206-IDX > PC206-MAX-ITEMS                  63110000
631200                     PERFORM 5255-WRITE-SEL-QUEUE                 63120000
631300                     ADD +1        TO PC204-NUMBER-OF-TS-ITEMS    63130000
631400                     INITIALIZE PC206-SELECTED-ITEM-ARRAY         63140000
631500                     SET PC206-IDX TO  1                          63150000
631600                 END-IF                                           63160000
631700             END-IF                                               63170000
631800         END-PERFORM                                              63180000
631900     END-IF.                                                      63190000
632000*                                                                 63200000
632100*----------------------------------------------------------------*63210000
632200*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                 63220000
632300*----------------------------------------------------------------*63230000
632400 5255-WRITE-SEL-QUEUE.                                            63240000
632500     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            63250000
632600                                   TO PC206-SELECTED-ITEMS.       63260000
632700                                                                  63270000
632800     EXEC CICS                                                    63280000
632900          WRITEQ TS                                               63290000
633000              QUEUE (ASC-SEL-QUEUE-NAME)                          63300000
633100              FROM  (PC206-DC-SELECT-RECORD)                      63310000
633200              ITEM  (PV-SEL-QUEUE-ITEM)                           63320000
633300              RESP  (PV-CICS-RESP)                                63330000
633400     END-EXEC.                                                    63340000
633500                                                                  63350000
633600     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          63360000
633700         CONTINUE                                                 63370000
633800     ELSE                                                         63380000
633900         SET DP013-CICS-ABEND      TO TRUE                        63390000
634000         SET DP013-NO-ROLLBACK     TO TRUE                        63400000
634100         MOVE '5255-WRITE-SEL-QUEUE'                              63410000
634200                                   TO DP013-PARAGRAPH             63420000
634300         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          63430000
634400                                   TO DP013-MESSAGE-TEXT(1)       63440000
634500         PERFORM DP013-0000-PROCESS-ABEND                         63450000
634600     END-IF.                                                      63460000
634700*                                                                 63470000
634800*----------------------------------------------------------------*63480000
634900 5300-FILL-SEL-QUEUE-RECORD.                                      63490000
635000                                                                  63500000
635100     PERFORM 6112-READ-LIST-QUEUE.                                63510000
635200                                                                  63520000
635300     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        63530000
635400         PERFORM                                                  63540000
635500           VARYING LQW-IDX FROM 1 BY 1                            63550000
635600             UNTIL LQW-IDX > PC-ITEMS-PER-PANEL                   63560000
635700                OR LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO          63570000
635800                                                                  63580000
635900             IF LQW-SELECT (LQW-IDX)                              63590000
636000                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              63600000
636100                            TO RC013-ITEM (RC013-IDX)             63610000
636200                 MOVE SPACE TO RC013-ACTION-SW (RC013-IDX)        63620000
636300                 MOVE LQW-STR-NUMBER (LQW-IDX)                    63630000
636400                            TO RC013-STR-NBR (RC013-IDX)          63640000
636500                               DK-STR-NBR                         63650000
636600                 MOVE ASC-REC-SEQ-NBR                             63660000
636700                            TO RC013-REC-SEQ-NBR (RC013-IDX)      63670000
636800                               DK-RECEIVER                        63680000
636900                               DK-REC-SEQ-NBR                     63690000
637000                 PERFORM 4370-CHECK-OPER-AND-FACILTY              63700000
637100                 PERFORM 4380-SELECT-PKSLIP                       63710000
637200                                                                  63720000
637300                 IF RECEIV-STATUS-CDE = 'VE'                      63730000
637400                     SET PS-VERIFIED-RECEIVER TO TRUE             63740000
637500                     MOVE PC-ERR TO LQW-ACTION (LQW-IDX)          63750000
637600                 END-IF                                           63760000
637700                 MOVE ASC-KEY-OPER-UNT-ID                         63770000
637800                            TO RC013-OPER-UNT-ID (RC013-IDX)      63780000
637900                 MOVE ASC-KEY-FCLTY-ID                            63790000
638000                            TO RC013-FCLTY-ID (RC013-IDX)         63800000
638100                                                                  63810000
638200                 SET RC013-IDX UP BY 1                            63820000
638300                 IF RC013-IDX > RC013-MAX-ITEMS                   63830000
638400                     PERFORM 5305-WRITE-SEL-QUEUE                 63840000
638500                     ADD +1  TO RC015-NUMBER-OF-TS-ITEMS          63850000
638600                     INITIALIZE RC013-SELECTED-ITEM-ARRAY         63860000
638700                     SET RC013-IDX TO 1                           63870000
638800                 END-IF                                           63880000
638900             END-IF                                               63890000
639000         END-PERFORM                                              63900000
639100     END-IF.                                                      63910000
639200     IF PS-VERIFIED-RECEIVER                                      63920000
639300         PERFORM 6113-WRITE-LIST-QUEUE                            63930000
639400     END-IF.                                                      63940000
639500                                                                  63950000
639600                                                                  63960000
639700*----------------------------------------------------------------*63970000
639800*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *63980000
639900*----------------------------------------------------------------*63990000
640000 5305-WRITE-SEL-QUEUE.                                            64000000
640100                                                                  64010000
640200     MOVE ASC-NUMBER-OF-SELECTED-ITEMS TO RC013-SELECTED-ITEMS.   64020000
640300                                                                  64030000
640400     EXEC CICS                                                    64040000
640500          WRITEQ TS                                               64050000
640600              QUEUE (ASC-SEL-QUEUE-NAME)                          64060000
640700              FROM  (RC013-DC-SELECT-RECORD)                      64070000
640800              ITEM  (PV-SEL-QUEUE-ITEM)                           64080000
640900              RESP  (PV-CICS-RESP)                                64090000
641000     END-EXEC.                                                    64100000
641100     IF PV-CICS-RESP = DFHRESP (NORMAL)                           64110000
641200         CONTINUE                                                 64120000
641300     ELSE                                                         64130000
641400         SET DP013-CICS-ABEND        TO TRUE                      64140000
641500         SET DP013-NO-ROLLBACK       TO TRUE                      64150000
641600         MOVE '5305-WRITE-SEL-QUEUE' TO DP013-PARAGRAPH           64160000
641700         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          64170000
641800                                     TO DP013-MESSAGE-TEXT(1)     64180000
641900         PERFORM DP013-0000-PROCESS-ABEND                         64190000
642000     END-IF.                                                      64200000
642100                                                                  64210000
642200*-----------------------------------------------------------------64220000
642300* FETCH FOR TOTAL UNITS                                           64230000
642400*                                                                 64240000
642500*-----------------------------------------------------------------64250000
642600 5310-FETCH-TOTAL-UNITS.                                          64260000
642700                                                                  64270000
642800                                                                  64280000
642900     EXEC SQL                                                     64290000
643000            FETCH   TOTAL_UNTS_CSR                                64300000
643100            INTO   :RECITM-STATUS-CDE                             64310000
643200                 , :RECDIS-VERIFY-ITM-QTY                         64320000
643300                 , :RECDIS-AP-VERIFY-ITM-QTY                      64330000
643400     END-EXEC                                                     64340000
643500                                                                  64350000
643600                                                                  64360000
643700     EVALUATE TRUE                                                64370000
643800         WHEN SQLCODE = ZERO                                      64380000
643900            IF RECITM-STATUS-CDE = 'VE'                           64390000
644000              ADD RECDIS-AP-VERIFY-ITM-QTY TO PV-PO-RCVR-UNT-CNTR 64400000
644100               SET PS-VERIFIED-LINE-FND TO TRUE                   64410000
644200            ELSE                                                  64420000
644300              ADD RECDIS-VERIFY-ITM-QTY TO PV-PO-RCVR-UNT-CNTR    64430000
644400            END-IF                                                64440000
644500         WHEN SQLCODE = +100                                      64450000
644600              SET PS-END-OF-RECITM-CSR TO TRUE                    64460000
644700         WHEN SQLWARN0 NOT = SPACE                                64470000
644800         WHEN SQLCODE NOT = ZERO                                  64480000
644900              MOVE  DK-PO-NBR  TO PV-DISPLAY-PO-NBR               64490000
645000              MOVE  ASC-REC-SEQ-NBR TO PV-DISPLAY-RCVR            64500000
645100              MOVE '5310-FETCH-TOTAL-UNITS'                       64510000
645200                               TO DP013-PARAGRAPH                 64520000
645300              MOVE 'FETCH MESSAGE CURSOR'                         64530000
645400                               TO DP013-MESSAGE-TEXT (1)          64540000
645500              STRING 'PO/RCVR '           DELIMITED BY SIZE       64550000
645600                     PV-DISPLAY-PO-NBR    DELIMITED BY SIZE       64560000
645700                     '-'                  DELIMITED BY SIZE       64570000
645800                     PV-DISPLAY-RCVR      DELIMITED BY '  '       64580000
645900                                     INTO DP013-MESSAGE-TEXT (2)  64590000
646000              MOVE 'TRECITM '   TO DP013-DB2-TABLE-NAME (1)       64600000
646100              MOVE SQLCA       TO DP013-SQLCA                     64610000
646200              SET DP013-DB2-ABEND                                 64620000
646300                               TO TRUE                            64630000
646400              PERFORM DP013-0000-PROCESS-ABEND                    64640000
646500     END-EVALUATE.                                                64650000
646600                                                                  64660000
646700                                                                  64670000
646800*-----------------------------------------------------------------64680000
646900* CHECK FOR UCC128 DATA                                          *64690000
647000*-----------------------------------------------------------------64700000
647100 5400-CHECK-FOR-UCC128-DATA.                                      64710000
647200                                                                  64720000
647300     PERFORM                                                      64730000
647400         WITH TEST AFTER                                          64740000
647500         VARYING PV-RETRY-COUNTER                                 64750000
647600         FROM 1 BY 1                                              64760000
647700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               64770000
647800             OR (SQLCODE = +0)                                    64780000
647900             OR (SQLCODE = -811)                                  64790000
648000             OR (SQLCODE = +100))                                 64800000
648100                                                                  64810000
648200     EXEC SQL                                                     64820000
648300             SELECT C.SHIPT_UNT_ID                                64830000
648400             INTO  :SHPUNT-SHIPT-UNT-ID                           64840000
648500             FROM  TPKSLIP A,                                     64850000
648600                   TINPKSU B,                                     64860000
648700                   TSHPUNT C                                      64870000
648800             WHERE A.PO_NBR           = :DK-PO-NBR                64880000
648900               AND A.REC_SEQ_NBR      = :DK-RECEIVER              64890000
649000               AND A.VER_STAT_CDE     = 'A'                       64900000
649100               AND A.PO_NBR           =  B.PO_NBR                 64910000
649200               AND A.SEQ_NBR          =  B.SEQ_NBR                64920000
649300               AND B.SHIPT_UNT_ID     =  C.SHIPT_UNT_ID           64930000
649400               AND C.DEST_OPER_UNT_ID = :DK-STR-NBR               64940000
649500               AND C.ACTV_IND         = :DK-ACTV-IND              64950000
649600     END-EXEC                                                     64960000
649700                                                                  64970000
649800         EVALUATE TRUE                                            64980000
649900             WHEN SQLCODE = +0                                    64990000
650000             WHEN SQLCODE = -811                                  65000000
650100                 SET PS-UCC128-ROW-FND TO TRUE                    65010000
650200             WHEN SQLCODE = +100                                  65020000
650300                 SET PS-NO-UCC128-ROW-FND TO TRUE                 65030000
650400             WHEN SQLCODE = -904                                  65040000
650500             WHEN SQLCODE = -913                                  65050000
650600                  CONTINUE                                        65060000
650700             WHEN SQLWARN0 NOT = +0                               65070000
650800             WHEN SQLCODE < +0                                    65080000
650900             WHEN SQLCODE > +0                                    65090000
651000                  MOVE  DK-PO-NBR  TO PV-DISPLAY-PO-NBR           65100000
651100                  MOVE  ASC-REC-SEQ-NBR TO PV-DISPLAY-RCVR        65110000
651200                  MOVE '5400-CHECK-FOR-UCC128'                    65120000
651300                                  TO DP013-PARAGRAPH              65130000
651400                  MOVE 'UNSUCCESSFUL SELECT ON TSHUUPC TABLE'     65140000
651500                                  TO DP013-MESSAGE-TEXT (1)       65150000
651600                  STRING 'PO/RCVR '           DELIMITED BY SIZE   65160000
651700                         PV-DISPLAY-PO-NBR    DELIMITED BY SIZE   65170000
651800                         '-'                  DELIMITED BY SIZE   65180000
651900                         PV-DISPLAY-RCVR      DELIMITED BY '  '   65190000
652000                                       INTO DP013-MESSAGE-TEXT (2)65200000
652100                  MOVE SQLCA      TO DP013-SQLCA                  65210000
652200                  MOVE 'TSHUUPC ' TO DP013-DB2-TABLE-NAME (1)     65220000
652300                  SET DP013-DB2-ABEND                             65230000
652400                      DP013-XCTL-DISPLAY-RESTART                  65240000
652500                                  TO TRUE                         65250000
652600              PERFORM DP013-0000-PROCESS-ABEND                    65260000
652700         END-EVALUATE                                             65270000
652800     END-PERFORM.                                                 65280000
652900                                                                  65290000
653000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        65300000
653100         MOVE '5400-CHECK-FOR-UCC128'                             65310000
653200                                  TO DP013-PARAGRAPH              65320000
653300         MOVE 'MAX RETRIES EXCEEDED ON SELECT TSHPUNT TABLE'      65330000
653400                                  TO DP013-MESSAGE-TEXT (1)       65340000
653500         MOVE SQLCA               TO DP013-SQLCA                  65350000
653600         MOVE 'TSHPUNT'           TO DP013-DB2-TABLE-NAME (1)     65360000
653700         SET DP013-DB2-ABEND                                      65370000
653800             DP013-XCTL-DISPLAY-RESTART                           65380000
653900                                  TO TRUE                         65390000
654000         PERFORM DP013-0000-PROCESS-ABEND                         65400000
654100     END-IF.                                                      65410000
654200                                                                  65420000
654300                                                                  65430000
654400*-----------------------------------------------------------------65440000
654500*                                                                *65450000
654600*-----------------------------------------------------------------65460000
654700 5405-UCC128-CRTN-SHUNLO.                                         65470000
654800                                                                  65480000
654900     PERFORM                                                      65490000
655000         WITH TEST AFTER                                          65500000
655100         VARYING PV-RETRY-COUNTER                                 65510000
655200         FROM 1 BY 1                                              65520000
655300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               65530000
655400             OR (SQLCODE = +0)                                    65540000
655500             OR (SQLCODE = -811)                                  65550000
655600             OR (SQLCODE = +100))                                 65560000
655700                                                                  65570000
655800     EXEC SQL                                                     65580000
655900         SELECT C.SHIPT_UNT_ID                                    65590000
656000         INTO  :SHPUNT-SHIPT-UNT-ID                               65600000
656100         FROM  TPKSLIP A,                                         65610000
656200               TINPKSU B,                                         65620000
656300               TSHPUNT C,                                         65630000
656400               TSHUNLO D                                          65640000
656500         WHERE A.PO_NBR           = :DK-PO-NBR                    65650000
656600           AND A.REC_SEQ_NBR      = :DK-RECEIVER                  65660000
656700           AND A.VER_STAT_CDE     = 'A'                           65670000
656800           AND A.PO_NBR           =  B.PO_NBR                     65680000
656900           AND A.SEQ_NBR          =  B.SEQ_NBR                    65690000
657000           AND B.SHIPT_UNT_ID     =  C.SHIPT_UNT_ID               65700000
657100           AND B.SHIPT_UNT_ID     =  D.SHIPT_UNT_ID               65710000
657200           AND C.DEST_OPER_UNT_ID = :DK-STR-NBR                   65720000
657300           AND C.ACTV_IND         = :DK-ACTV-IND                  65730000
657400     END-EXEC                                                     65740000
657500                                                                  65750000
657600         EVALUATE TRUE                                            65760000
657700             WHEN SQLCODE = +0                                    65770000
657800             WHEN SQLCODE = -811                                  65780000
657900                 SET ASC-VND-BRCDE-SCND (ASC-BLK-SUB ASC-ITEM-SUB)65790000
658000                                     TO TRUE                      65800000
658100             WHEN SQLCODE = +100                                  65810000
658200                SET ASC-VND-BRCDE-SCND-NO                         65820000
658300                            (ASC-BLK-SUB ASC-ITEM-SUB) TO TRUE    65830000
658400             WHEN SQLCODE = -904                                  65840000
658500             WHEN SQLCODE = -913                                  65850000
658600                  CONTINUE                                        65860000
658700             WHEN SQLWARN0 NOT = +0                               65870000
658800             WHEN SQLCODE < +0                                    65880000
658900             WHEN SQLCODE > +0                                    65890000
659000                  MOVE SHPUNT-SHIPT-UNT-ID TO PV-DISPLAY-CRTN-ID  65900000
659100                  MOVE '5405-UCC128-CRTN-SHUNLO'                  65910000
659200                                  TO DP013-PARAGRAPH              65920000
659300                  MOVE 'UNSUCCESSFUL SELECT ON TSHUNLO TABLE'     65930000
659400                                  TO DP013-MESSAGE-TEXT (1)       65940000
659500                  MOVE PV-DISPLAY-CRTN-ID                         65950000
659600                                  TO DP013-MESSAGE-TEXT (2)       65960000
659700                  MOVE SQLCA      TO DP013-SQLCA                  65970000
659800                  MOVE 'TSHUNLO ' TO DP013-DB2-TABLE-NAME (1)     65980000
659900                  SET DP013-DB2-ABEND                             65990000
660000                      DP013-XCTL-DISPLAY-RESTART                  66000000
660100                                  TO TRUE                         66010000
660200              PERFORM DP013-0000-PROCESS-ABEND                    66020000
660300         END-EVALUATE                                             66030000
660400     END-PERFORM.                                                 66040000
660500                                                                  66050000
660600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        66060000
660700         MOVE '5400-CHECK-FOR-UCC128'                             66070000
660800                                  TO DP013-PARAGRAPH              66080000
660900         MOVE 'MAX RETRIES EXCEEDED ON SELECT TSHPUNT TABLE'      66090000
661000                                  TO DP013-MESSAGE-TEXT (1)       66100000
661100         MOVE SQLCA               TO DP013-SQLCA                  66110000
661200         MOVE 'TSHPUNT'           TO DP013-DB2-TABLE-NAME (1)     66120000
661300         SET DP013-DB2-ABEND                                      66130000
661400             DP013-XCTL-DISPLAY-RESTART                           66140000
661500                                  TO TRUE                         66150000
661600         PERFORM DP013-0000-PROCESS-ABEND                         66160000
661700     END-IF.                                                      66170000
661800                                                                  66180000
661900                                                                  66190000
662000*-----------------------------------------------------------------66200000
662100*                                                                *66210000
662200*-----------------------------------------------------------------66220000
662300*5405-UCC128-CRTN-SHUNLO.                                         66230000
662400*                                                                 66240000
662500*    EXEC SQL                                                     66250000
662600*            SELECT TRIP_ID                                       66260000
662700*            INTO  :SHUNLO-TRIP-ID                                66270000
662800*            FROM  TSHUNLO                                        66280000
662900*            WHERE SHIPT_UNT_ID     = :SHPUNT-SHIPT-UNT-ID        66290000
663000*              AND ACTV_CDE         = 'A'                         66300000
663100*    END-EXEC                                                     66310000
663200*                                                                 66320000
663300*        EVALUATE TRUE                                            66330000
663400*            WHEN SQLCODE = +0                                    66340000
663500*            WHEN SQLCODE = -811                                  66350000
663600*                SET ASC-VND-BRCDE-SCND (ASC-BLK-SUB ASC-ITEM-SUB)66360000
663700*                                    TO TRUE                      66370000
663800*            WHEN SQLCODE = +100                                  66380000
663900*               SET ASC-VND-BRCDE-SCND-NO                         66390000
664000*                           (ASC-BLK-SUB ASC-ITEM-SUB) TO TRUE    66400000
664100*            WHEN SQLCODE = -904                                  66410000
664200*            WHEN SQLCODE = -913                                  66420000
664300*                 CONTINUE                                        66430000
664400*            WHEN SQLWARN0 NOT = +0                               66440000
664500*            WHEN SQLCODE < +0                                    66450000
664600*            WHEN SQLCODE > +0                                    66460000
664700*                 MOVE SHPUNT-SHIPT-UNT-ID TO PV-DISPLAY-CRTN-ID  66470000
664800*                 MOVE '5405-UCC128-CRTN-SHUNLO'                  66480000
664900*                                 TO DP013-PARAGRAPH              66490000
665000*                 MOVE 'UNSUCCESSFUL SELECT ON TSHUNLO TABLE'     66500000
665100*                                 TO DP013-MESSAGE-TEXT (1)       66510000
665200*                 MOVE PV-DISPLAY-CRTN-ID                         66520000
665300*                                 TO DP013-MESSAGE-TEXT (2)       66530000
665400*                 MOVE SQLCA      TO DP013-SQLCA                  66540000
665500*                 MOVE 'TSHUNLO ' TO DP013-DB2-TABLE-NAME (1)     66550000
665600*                 SET DP013-DB2-ABEND                             66560000
665700*                     DP013-XCTL-DISPLAY-RESTART                  66570000
665800*                                 TO TRUE                         66580000
665900*             PERFORM DP013-0000-PROCESS-ABEND                    66590000
666000*        END-EVALUATE.                                            66600000
666100*                                                                 66610000
666200                                                                  66620000
666300                                                                  66630000
666400*-----------------------------------------------------------------66640000
666500*                                                                *66650000
666600*-----------------------------------------------------------------66660000
666700 5500-CHECK-SMOOTHING-ACTV.                                       66670000
666800     INITIALIZE PV-DB2-COUNT-ACTV.                                66680000
666900                                                                  66690000
667000     PERFORM                                                      66700000
667100         WITH TEST AFTER                                          66710000
667200         VARYING PV-RETRY-COUNTER                                 66720000
667300         FROM 1 BY 1                                              66730000
667400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               66740000
667500             OR (SQLCODE = +0)                                    66750000
667600             OR (SQLCODE = +100))                                 66760000
667700                                                                  66770000
667800     EXEC SQL                                                     66780000
667900         SELECT COUNT(DISTINCT(A.SHIPT_UNT_ID))                   66790000
668000           INTO :PV-DB2-COUNT-ACTV                                66800000
668100           FROM SUT_OTBND_UPC A                                   66810000
668200              , SUT_OTBND_CART B                                  66820000
668300           WHERE A.TRN_NBR          = :DK-PO-NBR                  66830000
668400            AND  A.RCVR_SEQ_NBR     = :DK-RECEIVER                66840000
668500            AND  A.SHIPT_UNT_ID     =  B.SHIPT_UNT_ID             66850000
668600            AND  B.DEST_LOC_NBR     =  :DK-STR-NBR                66860000
668700            AND  B.CART_SRC_CDE     =  'SMO'                      66870000
668800            AND  B.ACTV_IND         =  'Y'                        66880000
668900            AND  B.CRE_PGM_NM       = 'PCKCS728'                  66890000
669000     END-EXEC                                                     66900000
669100                                                                  66910000
669200         EVALUATE TRUE                                            66920000
669300             WHEN SQLCODE = +0                                    66930000
669400                  IF PV-DB2-COUNT-ACTV > 0                        66940000
669500                     SET PS-SMOOTHING-ACTV TO TRUE                66950000
669600                     MOVE PV-DB2-COUNT-ACTV TO                    66960000
669700                                            PKSLIP-EXPTED-PKG-QTY 66970000
669800                  END-IF                                          66980000
669900             WHEN SQLCODE = -904                                  66990000
670000             WHEN SQLCODE = -913                                  67000000
670100                  CONTINUE                                        67010000
670200             WHEN SQLWARN0 NOT = +0                               67020000
670300             WHEN SQLCODE < +0                                    67030000
670400             WHEN SQLCODE > +0                                    67040000
670500                  MOVE  DK-PO-NBR  TO PV-DISPLAY-PO-NBR           67050000
670600                  MOVE  ASC-REC-SEQ-NBR TO PV-DISPLAY-RCVR        67060000
670700                  MOVE  DK-STR-NBR      TO PV-DISPLAY-STORE       67070000
670800                  MOVE '5500-CHECK-SMOOTHING-ACTV'                67080000
670900                                  TO DP013-PARAGRAPH              67090000
671000                  MOVE 'UNSUCCESSFUL SELECT ON TSHUUPC TABLE'     67100000
671100                                  TO DP013-MESSAGE-TEXT (1)       67110000
671200                  STRING 'PO/RCVR/STORE'      DELIMITED BY SIZE   67120000
671300                         PV-DISPLAY-PO-NBR    DELIMITED BY SIZE   67130000
671400                         '-'                  DELIMITED BY SIZE   67140000
671500                         PV-DISPLAY-RCVR      DELIMITED BY SIZE   67150000
671600                         PV-DISPLAY-STORE     DELIMITED BY '  '   67160000
671700                                       INTO DP013-MESSAGE-TEXT (2)67170000
671800                  MOVE SQLCA      TO DP013-SQLCA                  67180000
671900                  MOVE 'TSHUUPC ' TO DP013-DB2-TABLE-NAME (1)     67190000
672000                  SET DP013-DB2-ABEND                             67200000
672100                      DP013-XCTL-DISPLAY-RESTART                  67210000
672200                                  TO TRUE                         67220000
672300              PERFORM DP013-0000-PROCESS-ABEND                    67230000
672400         END-EVALUATE                                             67240000
672500     END-PERFORM.                                                 67250000
672600                                                                  67260000
672700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        67270000
672800         MOVE '5500-CHECK-SMOOTHING-ACTV'                         67280000
672900                                  TO DP013-PARAGRAPH              67290000
673000         MOVE 'MAX RETRIES EXCEEDED ON SELECT TSHUUPC TABLE'      67300000
673100                                  TO DP013-MESSAGE-TEXT (1)       67310000
673200         MOVE SQLCA               TO DP013-SQLCA                  67320000
673300         MOVE 'TSHUUPC'           TO DP013-DB2-TABLE-NAME (1)     67330000
673400         SET DP013-DB2-ABEND                                      67340000
673500             DP013-XCTL-DISPLAY-RESTART                           67350000
673600                                  TO TRUE                         67360000
673700         PERFORM DP013-0000-PROCESS-ABEND                         67370000
673800     END-IF.                                                      67380000
673900                                                                  67390000
674000                                                                  67400000
674100*-----------------------------------------------------------------67410000
674200*                                                                *67420000
674300*-----------------------------------------------------------------67430000
674400 5505-CHECK-SMOOTHING-INACTV.                                     67440000
674500                                                                  67450000
674600     INITIALIZE PV-DB2-COUNT-INACTV.                              67460000
674700                                                                  67470000
674800     EXEC SQL                                                     67480000
674900         SELECT COUNT(DISTINCT(A.SHIPT_UNT_ID))                   67490000
675000           INTO :PV-DB2-COUNT-INACTV                              67500000
675100           FROM SUT_OTBND_UPC A                                   67510000
675200              , SUT_OTBND_CART B                                  67520000
675300           WHERE A.TRN_NBR          = :DK-PO-NBR                  67530000
675400            AND  A.RCVR_SEQ_NBR     = :DK-RECEIVER                67540000
675500            AND  A.SHIPT_UNT_ID     =  B.SHIPT_UNT_ID             67550000
675600            AND  B.DEST_LOC_NBR     =  :DK-STR-NBR                67560000
675700            AND  B.CART_SRC_CDE     =  'SMO'                      67570000
675800            AND  B.ACTV_IND         =  'N'                        67580000
675900            AND  B.CRE_PGM_NM       = 'PCKCS728'                  67590000
676000     END-EXEC                                                     67600000
676100         EVALUATE TRUE                                            67610000
676200             WHEN SQLCODE = +0                                    67620000
676300                IF PV-DB2-COUNT-INACTV > 0                        67630000
676400                    SET PS-SMOOTHING-INACTV TO TRUE               67640000
676500                ELSE                                              67650000
676600                    MOVE SPACES TO PS-SMOOTHING-EXISTS-SW         67660000
676700                END-IF                                            67670000
676800             WHEN SQLWARN0 NOT = +0                               67680000
676900             WHEN SQLCODE < +0                                    67690000
677000             WHEN SQLCODE > +0                                    67700000
677100                  MOVE  DK-PO-NBR  TO PV-DISPLAY-PO-NBR           67710000
677200                  MOVE  ASC-REC-SEQ-NBR TO PV-DISPLAY-RCVR        67720000
677300                  MOVE  DK-STR-NBR      TO PV-DISPLAY-STORE       67730000
677400                  MOVE '5505-CHECK-SMOOTHING-INACTV'              67740000
677500                                  TO DP013-PARAGRAPH              67750000
677600                  MOVE 'UNSUCCESSFUL SELECT ON OTBNDUPC TABLE'    67760000
677700                                  TO DP013-MESSAGE-TEXT (1)       67770000
677800                  STRING 'PO/RCVR/STORE'      DELIMITED BY SIZE   67780000
677900                         PV-DISPLAY-PO-NBR    DELIMITED BY SIZE   67790000
678000                         '-'                  DELIMITED BY SIZE   67800000
678100                         PV-DISPLAY-RCVR      DELIMITED BY SIZE   67810000
678200                         PV-DISPLAY-STORE     DELIMITED BY '  '   67820000
678300                                       INTO DP013-MESSAGE-TEXT (2)67830000
678400                  MOVE SQLCA      TO DP013-SQLCA                  67840000
678500                  MOVE 'OTBNDUPC' TO DP013-DB2-TABLE-NAME (1)     67850000
678600                  SET DP013-DB2-ABEND                             67860000
678700                      DP013-XCTL-DISPLAY-RESTART                  67870000
678800                                  TO TRUE                         67880000
678900              PERFORM DP013-0000-PROCESS-ABEND                    67890000
679000         END-EVALUATE.                                            67900000
679100                                                                  67910000
679200                                                                  67920000
679300*----------------------------------------------------------------*67930000
679400* SELECT MAX CRE DATE AND TIME FROM TSHPUNT                       67940000
679500* TO DETERMINE PROPER CURRENT ROWS TO UPDATE                      67950000
679600*----------------------------------------------------------------*67960000
679700 5530-PRC-SMTHG-DTE-TME-CSR.                                      67970000
679800                                                                  67980000
679900     SET  PS-NOT-EOF-SMTH-DTE-TME-CSR TO TRUE.                    67990000
680000     PERFORM 5540-OPEN-SMTHG-DTE-TME-CSR.                         68000000
680100     PERFORM 5545-FETCH-SMTHG-DTE-TME-CSR                         68010000
680200             UNTIL PS-EOF-SMTH-DTE-TME-CSR.                       68020000
680300     PERFORM 5550-CLOSE-SMTHG-DTE-TME-CSR.                        68030000
680400                                                                  68040000
680500                                                                  68050000
680600                                                                  68060000
680700**********************************************************        68070000
680800 5540-OPEN-SMTHG-DTE-TME-CSR.                                     68080000
680900**********************************************************        68090000
681000                                                                  68100000
681100     PERFORM                                                      68110000
681200         WITH TEST AFTER                                          68120000
681300         VARYING PV-RETRY-COUNTER                                 68130000
681400         FROM 1 BY 1                                              68140000
681500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               68150000
681600                   OR (SQLCODE = ZERO))                           68160000
681700                                                                  68170000
681800                 EXEC SQL                                         68180000
681900                      OPEN SMTHG_DTE_TME_CSR                      68190000
682000                 END-EXEC                                         68200000
682100                                                                  68210000
682200                                                                  68220000
682300         EVALUATE TRUE                                            68230000
682400             WHEN SQLCODE = ZERO                                  68240000
682500             WHEN SQLCODE = -904                                  68250000
682600             WHEN SQLCODE = -913                                  68260000
682700                 CONTINUE                                         68270000
682800             WHEN SQLWARN0 NOT = SPACES                           68280000
682900             WHEN SQLCODE < ZERO                                  68290000
683000             WHEN SQLCODE > ZERO                                  68300000
683100                 MOVE '5540-OPEN-SMTHG-DTE'                       68310000
683200                                   TO DP013-PARAGRAPH             68320000
683300                 MOVE 'OPEN SMTHG DATE TIME CSR'                  68330000
683400                                   TO DP013-MESSAGE-TEXT (1)      68340000
683500                 MOVE SQLCA        TO DP013-SQLCA                 68350000
683600                 MOVE 'TSHPUNT '   TO DP013-DB2-TABLE-NAME (1)    68360000
683700                 SET DP013-DB2-ABEND                              68370000
683800                     DP013-XCTL-DISPLAY-RESTART TO TRUE           68380000
683900                 PERFORM DP013-0000-PROCESS-ABEND                 68390000
684000         END-EVALUATE                                             68400000
684100     END-PERFORM.                                                 68410000
684200                                                                  68420000
684300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    68430000
684400         SQLCODE NOT = ZERO                                       68440000
684500         MOVE '5540-OPEN-SMTHG-DTE-TME-' TO DP013-PARAGRAPH       68450000
684600         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   68460000
684700                                   TO DP013-MESSAGE-TEXT (1)      68470000
684800         MOVE SQLCA                TO DP013-SQLCA                 68480000
684900         MOVE 'TSHPUNT '           TO DP013-DB2-TABLE-NAME (1)    68490000
685000         SET DP013-DB2-ABEND                                      68500000
685100             DP013-XCTL-DISPLAY-RESTART                           68510000
685200                                   TO TRUE                        68520000
685300         PERFORM DP013-0000-PROCESS-ABEND                         68530000
685400     END-IF.                                                      68540000
685500                                                                  68550000
685600*----------------------------------------------------------------*68560000
685700* FETCH UPDATE CARTON CSR - INACTIVATE ROWS                       68570000
685800*----------------------------------------------------------------*68580000
685900 5545-FETCH-SMTHG-DTE-TME-CSR.                                    68590000
686000                                                                  68600000
686100     MOVE 'CURSOR: SMTHG_DTE_TME_CSR'                             68610000
686200                       TO DP013-MESSAGE-TEXT (2).                 68620000
686300                                                                  68630000
686400     EXEC SQL                                                     68640000
686500          FETCH SMTHG_DTE_TME_CSR                                 68650000
686600           INTO :SUT00024-CRE-DTE                                 68660000
686700             ,  :SUT00024-CRE-TM                                  68670000
686800     END-EXEC.                                                    68680000
686900                                                                  68690000
687000     EVALUATE TRUE                                                68700000
687100         WHEN SQLCODE = ZERO                                      68710000
687200              IF DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID) OR        68720000
687300                    ASC-CONFIRM-INACTV                            68730000
687400                 SET PS-EOF-SMTH-DTE-TME-CSR  TO TRUE             68740000
687500              ELSE                                                68750000
687600                 PERFORM 5555-SELECT-INACTV-FRM-CSR               68760000
687700              END-IF                                              68770000
687800         WHEN SQLCODE = +100                                      68780000
687900              SET PS-EOF-SMTH-DTE-TME-CSR                         68790000
688000                  PS-INACTV-SMTH-NOT-FND     TO TRUE              68800000
688100         WHEN SQLCODE = -904                                      68810000
688200         WHEN SQLCODE = -911                                      68820000
688300         WHEN SQLCODE = -913                                      68830000
688400             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   68840000
688500             MOVE '5545-FETCH-SMTHG-DTE-TME' TO PV-SOFT-PARAGRAPH 68850000
688600             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 68860000
688700             MOVE LENGTH OF PV-CICS-MSG-AREA2                     68870000
688800               TO PV-COMMAREA-LENGTH                              68880000
688900             EXEC CICS                                            68890000
689000                  WRITEQ TD                                       68900000
689100                   QUEUE  ('CSSL')                                68910000
689200                    FROM  (PV-CICS-MSG-AREA2)                     68920000
689300                  LENGTH  (PV-COMMAREA-LENGTH)                    68930000
689400                    RESP  (PV-CICS-RESP)                          68940000
689500             END-EXEC                                             68950000
689600             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          68960000
689700             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              68970000
689800         WHEN SQLWARN0 NOT = SPACE                                68980000
689900         WHEN SQLCODE NOT = ZERO                                  68990000
690000              MOVE  DK-PO-NBR  TO PV-DISPLAY-PO-NBR               69000000
690100              MOVE  ASC-REC-SEQ-NBR TO PV-DISPLAY-RCVR            69010000
690200              MOVE  DK-STR-NBR      TO PV-DISPLAY-STORE           69020000
690300              MOVE 'FETCH SMTHG_DTE_TME_CSR   '                   69030000
690400                               TO DP013-MESSAGE-TEXT (1)          69040000
690500              STRING 'PO/RCVR/STORE'      DELIMITED BY SIZE       69050000
690600                     PV-DISPLAY-PO-NBR    DELIMITED BY SIZE       69060000
690700                     '-'                  DELIMITED BY SIZE       69070000
690800                     PV-DISPLAY-RCVR      DELIMITED BY SIZE       69080000
690900                     PV-DISPLAY-STORE     DELIMITED BY '  '       69090000
691000                                   INTO DP013-MESSAGE-TEXT (2)    69100000
691100              MOVE '5545-FETCH-SMTHG-DTE-TME'                     69110000
691200                               TO DP013-PARAGRAPH                 69120000
691300              MOVE SQLCA       TO DP013-SQLCA                     69130000
691400              SET DP013-DB2-ABEND                                 69140000
691500                               TO TRUE                            69150000
691600              PERFORM DP013-0000-PROCESS-ABEND                    69160000
691700     END-EVALUATE.                                                69170000
691800                                                                  69180000
691900******************************************************************69190000
692000* CLOSE TOTAL UNITS CURSOR                                        69200000
692100******************************************************************69210000
692200 5550-CLOSE-SMTHG-DTE-TME-CSR.                                    69220000
692300                                                                  69230000
692400         EXEC SQL                                                 69240000
692500             CLOSE SMTHG_DTE_TME_CSR                              69250000
692600         END-EXEC                                                 69260000
692700                                                                  69270000
692800     EVALUATE TRUE                                                69280000
692900         WHEN SQLCODE = ZERO                                      69290000
693000             CONTINUE                                             69300000
693100         WHEN SQLWARN0 NOT = SPACES                               69310000
693200         WHEN SQLCODE < ZERO                                      69320000
693300         WHEN SQLCODE > ZERO                                      69330000
693400             MOVE '5550-CLOSE-SMTHG-DTE-TME'                      69340000
693500                               TO DP013-PARAGRAPH                 69350000
693600             MOVE 'CLOSE DTE TIME CURSOR'                         69360000
693700                               TO DP013-MESSAGE-TEXT (1)          69370000
693800             MOVE SQLCA        TO DP013-SQLCA                     69380000
693900             MOVE 'TSYMSG  '   TO DP013-DB2-TABLE-NAME (1)        69390000
694000             SET DP013-DB2-ABEND                                  69400000
694100                 DP013-XCTL-DISPLAY-RESTART TO TRUE               69410000
694200             PERFORM DP013-0000-PROCESS-ABEND                     69420000
694300     END-EVALUATE.                                                69430000
694400                                                                  69440000
694500*----------------------------------------------------------------*69450000
694600*  SELECT NUMBER OF INACTV CARTONS FOR PO/RCVR/STR                69460000
694700*----------------------------------------------------------------*69470000
694800 5555-SELECT-INACTV-FRM-CSR.                                      69480000
694900                                                                  69490000
695000     PERFORM                                                      69500000
695100         WITH TEST AFTER                                          69510000
695200         VARYING PV-RETRY-COUNTER                                 69520000
695300         FROM 1 BY 1                                              69530000
695400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               69540000
695500             OR (SQLCODE = +0)                                    69550000
695600             OR (SQLCODE = +100))                                 69560000
695700     EXEC SQL                                                     69570000
695800         SELECT COUNT(DISTINCT(A.SHIPT_UNT_ID))                   69580000
695900           INTO :PV-DB2-COUNT-INACTV                              69590000
696000           FROM SUT_OTBND_UPC A                                   69600000
696100              , SUT_OTBND_CART B                                  69610000
696200           WHERE A.TRN_NBR          = :DK-PO-NBR                  69620000
696300            AND  A.RCVR_SEQ_NBR     = :DK-RECEIVER                69630000
696400            AND  A.SHIPT_UNT_ID     =  B.SHIPT_UNT_ID             69640000
696500            AND  B.DEST_LOC_NBR     =  :DK-STR-NBR                69650000
696600            AND  B.CART_SRC_CDE     =  'SMO'                      69660000
696700            AND  B.ACTV_IND         =  'N'                        69670000
696800            AND  B.CRE_PGM_NM       = 'PCKCS728'                  69680000
696900            AND  B.CRE_DTE          = :SUT00024-CRE-DTE           69690000
697000            AND  B.CRE_TM           = :SUT00024-CRE-TM            69700000
697100     END-EXEC                                                     69710000
697200                                                                  69720000
697300                                                                  69730000
697400         EVALUATE TRUE                                            69740000
697500             WHEN SQLCODE = +0                                    69750000
697600               SET PS-EOF-SMTH-DTE-TME-CSR  TO TRUE               69760000
697700             WHEN SQLWARN0 NOT = SPACES                           69770000
697800             WHEN SQLCODE < +0                                    69780000
697900             WHEN SQLCODE > +0                                    69790000
698000                  MOVE  DK-PO-NBR  TO PV-DISPLAY-PO-NBR           69800000
698100                  MOVE  ASC-REC-SEQ-NBR TO PV-DISPLAY-RCVR        69810000
698200                  MOVE  DK-STR-NBR      TO PV-DISPLAY-STORE       69820000
698300                  MOVE 'UNSUCCESSFUL SELECT INACTV COUNT'         69830000
698400                                  TO DP013-MESSAGE-TEXT (1)       69840000
698500                  STRING 'PO/RCVR/STORE'      DELIMITED BY SIZE   69850000
698600                         PV-DISPLAY-PO-NBR    DELIMITED BY SIZE   69860000
698700                         '-'                  DELIMITED BY SIZE   69870000
698800                         PV-DISPLAY-RCVR      DELIMITED BY SIZE   69880000
698900                         PV-DISPLAY-STORE     DELIMITED BY '  '   69890000
699000                                       INTO DP013-MESSAGE-TEXT (2)69900000
699100                  MOVE '5555-SELECT-INACTV-'                      69910000
699200                                  TO DP013-PARAGRAPH              69920000
699300                  MOVE SQLCA      TO DP013-SQLCA                  69930000
699400                  MOVE 'TSHPUNT ' TO DP013-DB2-TABLE-NAME (1)     69940000
699500                  SET DP013-DB2-ABEND                             69950000
699600                      DP013-XCTL-DISPLAY-RESTART                  69960000
699700                                  TO TRUE                         69970000
699800                  PERFORM DP013-0000-PROCESS-ABEND                69980000
699900         END-EVALUATE                                             69990000
700000     END-PERFORM.                                                 70000000
700100                                                                  70010000
700200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    70020000
700300         SQLCODE NOT = ZERO                                       70030000
700400         MOVE '5555-SELECT-INACTV'                                70040000
700500                                  TO DP013-PARAGRAPH              70050000
700600         MOVE 'MAX RETRIES EXCEEDED ON SELECT INACTV COUNT'       70060000
700700                                  TO DP013-MESSAGE-TEXT (1)       70070000
700800         MOVE SQLCA               TO DP013-SQLCA                  70080000
700900         MOVE 'TSHPUNT '          TO DP013-DB2-TABLE-NAME (1)     70090000
701000         SET DP013-DB2-ABEND                                      70100000
701100             DP013-XCTL-DISPLAY-RESTART                           70110000
701200                                  TO TRUE                         70120000
701300         PERFORM DP013-0000-PROCESS-ABEND                         70130000
701400     END-IF.                                                      70140000
701500                                                                  70150000
701600/                                                                 70160000
701700*----------------------------------------------------------------*70170000
701800*  SUM TOTAL UNITS FOR INACTIVE CARTONS                           70180000
701900*----------------------------------------------------------------*70190000
702000                                                                  70200000
702100 5600-SUM-INACTV-UNITS.                                           70210000
702200                                                                  70220000
702300     INITIALIZE PV-SHPD-QTY-PREVIOUS.                             70230000
702400                                                                  70240000
702500     EXEC SQL                                                     70250000
702600         SELECT SUM(SHPD_UNT_QTY)                                 70260000
702700           INTO :PV-SHPD-QTY-PREVIOUS                             70270000
702800           FROM SUT_OTBND_UPC A                                   70280000
702900              , SUT_OTBND_CART B                                  70290000
703000           WHERE A.TRN_NBR          = :DK-PO-NBR                  70300000
703100            AND  A.RCVR_SEQ_NBR     = :DK-RECEIVER                70310000
703200            AND  A.SHIPT_UNT_ID     =  B.SHIPT_UNT_ID             70320000
703300            AND  B.DEST_LOC_NBR     =  :DK-STR-NBR                70330000
703400            AND  B.CART_SRC_CDE     =  'SMO'                      70340000
703500            AND  B.ACTV_IND         =  'N'                        70350000
703600            AND  B.CRE_PGM_NM       = 'PCKCS728'                  70360000
703700            AND  B.CRE_DTE          = :SUT00024-CRE-DTE           70370000
703800            AND  B.CRE_TM           = :SUT00024-CRE-TM            70380000
703900     END-EXEC                                                     70390000
704000                                                                  70400000
704100                                                                  70410000
704200         EVALUATE TRUE                                            70420000
704300             WHEN SQLCODE = +0                                    70430000
704400               CONTINUE                                           70440000
704500             WHEN SQLWARN0 NOT = SPACES                           70450000
704600             WHEN SQLCODE < +0                                    70460000
704700             WHEN SQLCODE > +0                                    70470000
704800                  MOVE  DK-PO-NBR  TO PV-DISPLAY-PO-NBR           70480000
704900                  MOVE  ASC-REC-SEQ-NBR TO PV-DISPLAY-RCVR        70490000
705000                  MOVE  DK-STR-NBR      TO PV-DISPLAY-STORE       70500000
705100                  MOVE 'UNSUCCESSFUL SUM OF INACTV COUNT'         70510000
705200                                  TO DP013-MESSAGE-TEXT (1)       70520000
705300                  STRING 'PO/RCVR/STORE'      DELIMITED BY SIZE   70530000
705400                         PV-DISPLAY-PO-NBR    DELIMITED BY SIZE   70540000
705500                         '-'                  DELIMITED BY SIZE   70550000
705600                         PV-DISPLAY-RCVR      DELIMITED BY SIZE   70560000
705700                         PV-DISPLAY-STORE     DELIMITED BY '  '   70570000
705800                                       INTO DP013-MESSAGE-TEXT (2)70580000
705900                  MOVE '5600-SUM-INACTV-UNTIS'                    70590000
706000                                  TO DP013-PARAGRAPH              70600000
706100                  MOVE SQLCA      TO DP013-SQLCA                  70610000
706200                  MOVE 'TSHPUNT ' TO DP013-DB2-TABLE-NAME (1)     70620000
706300                  SET DP013-DB2-ABEND                             70630000
706400                      DP013-XCTL-DISPLAY-RESTART                  70640000
706500                                  TO TRUE                         70650000
706600                  PERFORM DP013-0000-PROCESS-ABEND                70660000
706700         END-EVALUATE.                                            70670000
706800                                                                  70680000
706900/                                                                 70690000
707000*----------------------------------------------------------------*70700000
707100*  CHECK FOR ITEM NUMBER OF ZERO                                  70710000
707200*----------------------------------------------------------------*70720000
707300                                                                  70730000
707400 5620-CHECK-FOR-ZERO-ITM-NBR.                                     70740000
707500                                                                  70750000
707600                                                                  70760000
707700     EXEC SQL                                                     70770000
707800          SELECT A.ORD_LNE_NBR                                    70780000
707900           INTO :RECITM-ORD-LNE-NBR                               70790000
708000           FROM    TRECITM A                                      70800000
708100                 , TRECDIS B                                      70810000
708200           WHERE     A.ORD_NBR        = :DK-PO-NBR                70820000
708300              AND    A.REC_SEQ_NBR    = :DK-RECEIVER              70830000
708400              AND    B.STR_NBR        = :DK-STR-NBR               70840000
708500              AND    A.ORD_NBR        =  B.ORD_NBR                70850000
708600              AND    A.ORD_LNE_NBR    =  B.ORD_LNE_NBR            70860000
708700              AND    A.REC_SEQ_NBR    =  B.REC_SEQ_NBR            70870000
708800              AND    A.ITM_NBR        =  0                        70880000
708900              AND    A.VER_STATUS_CDE = 'A'                       70890000
709000     END-EXEC                                                     70900000
709100                                                                  70910000
709200                                                                  70920000
709300         EVALUATE TRUE                                            70930000
709400             WHEN SQLCODE = +0                                    70940000
709500             WHEN SQLCODE = -811                                  70950000
709600                SET ASC-UNKN-ITEM-NBR (ASC-BLK-SUB ASC-ITEM-SUB)  70960000
709700                                      TO TRUE                     70970000
709800             WHEN SQLCODE = +100                                  70980000
709900                    CONTINUE                                      70990000
710000             WHEN SQLWARN0 NOT = SPACES                           71000000
710100             WHEN SQLCODE < +0                                    71010000
710200             WHEN SQLCODE > +0                                    71020000
710300                  MOVE  DK-PO-NBR  TO PV-DISPLAY-PO-NBR           71030000
710400                  MOVE  ASC-REC-SEQ-NBR TO PV-DISPLAY-RCVR        71040000
710500                  MOVE  DK-STR-NBR      TO PV-DISPLAY-STORE       71050000
710600                  STRING 'PO/RCVR/STORE'      DELIMITED BY SIZE   71060000
710700                         PV-DISPLAY-PO-NBR    DELIMITED BY SIZE   71070000
710800                         '-'                  DELIMITED BY SIZE   71080000
710900                         PV-DISPLAY-RCVR      DELIMITED BY SIZE   71090000
711000                         PV-DISPLAY-STORE     DELIMITED BY '  '   71100000
711100                                       INTO DP013-MESSAGE-TEXT (1)71110000
711200                  MOVE '5600-CHECK-FOR-ZERO-ITM-NBR'              71120000
711300                                  TO DP013-PARAGRAPH              71130000
711400                  MOVE SQLCA      TO DP013-SQLCA                  71140000
711500                  MOVE 'TRECITM ' TO DP013-DB2-TABLE-NAME (1)     71150000
711600                  SET DP013-DB2-ABEND                             71160000
711700                      DP013-XCTL-DISPLAY-RESTART                  71170000
711800                                  TO TRUE                         71180000
711900                  PERFORM DP013-0000-PROCESS-ABEND                71190000
712000         END-EVALUATE.                                            71200000
712100                                                                  71210000
712200/                                                                 71220000
712300******************************************************************71230000
712400 6000-REFRESH-PANEL-FROM-TEMP.                                    71240000
712500     IF  ASC-UPDATE-TSQ                                           71250000
712600*        ((ASC-FUNC04-RETURN-YES  OR                              71260000
712700*          ASC-FUNC05-RETURN-YES  OR                              71270000
712800*          ASC-FUNC06-RETURN-YES  OR                              71280000
712900*          ASC-FUNC08-RETURN-YES) OR                              71290000
713000*         PC202-UPDATE-TSQ)                                       71300000
713100         SET ASC-NO-TSQ-UPDATE TO TRUE                            71310000
713200         MOVE ZERO                 TO PV-SAVE-ITEM                71320000
713300                                      PV-SEL-QUEUE-ITEM           71330000
713400         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        71340000
713500                                   TO PV-HOLD-SELECTED-ITEMS      71350000
713600         MOVE +1                   TO PV-ITEMS-PROCESSED          71360000
713700         EVALUATE TRUE                                            71370000
713800           WHEN ASC-FUNC05-RETURN-YES                             71380000
713900           WHEN ASC-FUNC06-RETURN-YES                             71390000
714000              PERFORM 6200-UPDATE-TSQ                             71400000
714100                UNTIL PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS 71410000
714200           WHEN ASC-FUNC08-RETURN-YES                             71420000
714300              PERFORM 6300-UPDATE-TSQ                             71430000
714400                UNTIL PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS 71440000
714500           WHEN OTHER                                             71450000
714600              PERFORM 6100-UPDATE-TSQ                             71460000
714700                UNTIL PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS 71470000
714800         END-EVALUATE                                             71480000
714900                                                                  71490000
715000         SET ASC-FUNC04-RETURN-NO TO TRUE                         71500000
715100         SET ASC-FUNC05-RETURN-NO TO TRUE                         71510000
715200         SET ASC-FUNC06-RETURN-NO TO TRUE                         71520000
715300         SET ASC-FUNC08-RETURN-NO TO TRUE                         71530000
715400                                                                  71540000
715500                                                                  71550000
715600         INITIALIZE ASC-BLOCK-ENTRIES (1)                         71560000
715700                    ASC-BLOCK-ENTRIES (2)                         71570000
715800     END-IF.                                                      71580000
715900                                                                  71590000
716000*----------------------------------------------------------------*71600000
716100*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *71610000
716200*----------------------------------------------------------------*71620000
716300 6010-DELETE-SEL-QUEUE.                                           71630000
716400                                                                  71640000
716500     EXEC CICS                                                    71650000
716600         DELETEQ TS                                               71660000
716700             QUEUE (ASC-SEL-QUEUE-NAME)                           71670000
716800             RESP  (PV-CICS-RESP)                                 71680000
716900     END-EXEC.                                                    71690000
717000     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      71700000
717100        (PV-CICS-RESP = DFHRESP(QIDERR)))                         71710000
717200         CONTINUE                                                 71720000
717300     ELSE                                                         71730000
717400         SET DP013-CICS-ABEND TO TRUE                             71740000
717500         SET DP013-NO-ROLLBACK TO TRUE                            71750000
717600         MOVE '6010-DELETE-SEL-QUEUE'                             71760000
717700                        TO DP013-PARAGRAPH                        71770000
717800         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         71780000
717900                        TO DP013-MESSAGE-TEXT (1)                 71790000
718000         PERFORM DP013-0000-PROCESS-ABEND                         71800000
718100     END-IF.                                                      71810000
718200                                                                  71820000
718300*----------------------------------------------------------------*71830000
718400*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *71840000
718500*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *71850000
718600*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *71860000
718700*    THE TEMP QUEUE.                                             *71870000
718800*----------------------------------------------------------------*71880000
718900 6100-UPDATE-TSQ.                                                 71890000
719000                                                                  71900000
719100     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             71910000
719200     PERFORM 6105-READ-SEL-QUEUE.                                 71920000
719300     PERFORM                                                      71930000
719400         VARYING PC203-IDX                                        71940000
719500         FROM 1 BY 1                                              71950000
719600         UNTIL ((PV-ITEMS-PROCESSED >                             71960000
719700                              PV-HOLD-SELECTED-ITEMS)             71970000
719800         OR (PC203-IDX GREATER THAN PC203-MAX-ITEMS))             71980000
719900         IF  PC203-ACTION-SW (PC203-IDX) > SPACE                  71990000
720000             PERFORM 6110-PROCESS-ITEMS                           72000000
720100         END-IF                                                   72010000
720200         ADD +1                TO PV-ITEMS-PROCESSED              72020000
720300     END-PERFORM.                                                 72030000
720400     PERFORM 6111-WRITE-LIST-QUEUE.                               72040000
720500*----------------------------------------------------------------*72050000
720600*    READ THE LIST QUEUE RECORD.                                 *72060000
720700*----------------------------------------------------------------*72070000
720800                                                                  72080000
720900 6105-READ-SEL-QUEUE.                                             72090000
721000                                                                  72100000
721100     EXEC CICS                                                    72110000
721200          READQ TS                                                72120000
721300              QUEUE (ASC-SEL-QUEUE-NAME)                          72130000
721400              INTO  (PC203-DC-SELECT-RECORD)                      72140000
721500              ITEM  (PV-SEL-QUEUE-ITEM)                           72150000
721600              RESP  (PV-CICS-RESP)                                72160000
721700     END-EXEC.                                                    72170000
721800*                                                                 72180000
721900     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          72190000
722000         CONTINUE                                                 72200000
722100     ELSE                                                         72210000
722200         SET DP013-CICS-ABEND      TO  TRUE                       72220000
722300         SET DP013-NO-ROLLBACK     TO  TRUE                       72230000
722400         MOVE '6105-READ-SEL-QUEUE'                               72240000
722500                                   TO  DP013-PARAGRAPH            72250000
722600         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           72260000
722700                                   TO  DP013-MESSAGE-TEXT(1)      72270000
722800         PERFORM DP013-0000-PROCESS-ABEND                         72280000
722900     END-IF.                                                      72290000
723000                                                                  72300000
723100*----------------------------------------------------------------*72310000
723200*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*72320000
723300*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*72330000
723400*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *72340000
723500*----------------------------------------------------------------*72350000
723600                                                                  72360000
723700 6110-PROCESS-ITEMS.                                              72370000
723800                                                                  72380000
723900     COMPUTE PV-ITEM = 1 + ((PC203-ITEM (PC203-IDX) - 1)          72390000
724000                     / PC-ITEMS-PER-PANEL).                       72400000
724100                                                                  72410000
724200     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           72420000
724300         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          72430000
724400             PERFORM 6111-WRITE-LIST-QUEUE                        72440000
724500         END-IF                                                   72450000
724600         MOVE PV-ITEM          TO PV-SAVE-ITEM                    72460000
724700                                                                  72470000
724800         PERFORM 6112-READ-LIST-QUEUE                             72480000
724900         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               72490000
725000             CONTINUE                                             72500000
725100         END-IF                                                   72510000
725200     END-IF.                                                      72520000
725300                                                                  72530000
725400     COMPUTE PV-SUB = (PC203-ITEM (PC203-IDX)                     72540000
725500                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              72550000
725600     SET LQW-DESELECT (PV-SUB) TO    TRUE                         72560000
725700     MOVE LQW-SELECTED-SW (PV-SUB)                                72570000
725800                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  72580000
725900     EVALUATE TRUE                                                72590000
726000         WHEN PC203-INQ (PC203-IDX)                               72600000
726100              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             72610000
726200                                                                  72620000
726300         WHEN PC203-UPD (PC203-IDX)                               72630000
726400              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             72640000
726500                                                                  72650000
726600         WHEN PC203-DEL (PC203-IDX)                               72660000
726700              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             72670000
726800                                                                  72680000
726900         WHEN PC203-ERR (PC203-IDX)                               72690000
727000              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             72700000
727100     END-EVALUATE.                                                72710000
727200     MOVE     PC203-PREV-CTN-COUNT (PC203-IDX)                    72720000
727300                               TO LQW-NBR-CARTONS (PV-SUB).       72730000
727400*    IF (PC203-PREV-CTN-COUNT (PC203-IDX) = 0) AND                72740000
727500*        ASC-FUNC04-RETURN-YES                                    72750000
727600*           MOVE 'SMTHING INACTVTD'  TO LQW-STATUS (PV-SUB)       72760000
727700*           SET  LQW-NOT-PROTECTED (PV-SUB) TO TRUE               72770000
727800*    END-IF.                                                      72780000
727900     MOVE     PC203-TOT-CRTNS-PO (PC203-IDX)                      72790000
728000                               TO ASC-TOTAL-CART.                 72800000
728100     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                72810000
728200                                                                  72820000
728300*----------------------------------------------------------------*72830000
728400*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *72840000
728500*----------------------------------------------------------------*72850000
728600                                                                  72860000
728700 6111-WRITE-LIST-QUEUE.                                           72870000
728800                                                                  72880000
728900     EXEC CICS                                                    72890000
729000         WRITEQ TS                                                72900000
729100             QUEUE (ASC-LIST-QUEUE-NAME)                          72910000
729200             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     72920000
729300             ITEM  (PV-SAVE-ITEM)                                 72930000
729400             REWRITE                                              72940000
729500             RESP  (PV-CICS-RESP)                                 72950000
729600     END-EXEC.                                                    72960000
729700*                                                                 72970000
729800     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          72980000
729900         CONTINUE                                                 72990000
730000     ELSE                                                         73000000
730100         SET DP013-CICS-ABEND  TO  TRUE                           73010000
730200         SET DP013-NO-ROLLBACK TO  TRUE                           73020000
730300         MOVE '6111-WRITE-LIST-QUEUE'                             73030000
730400                               TO  DP013-PARAGRAPH                73040000
730500         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  73050000
730600                               TO  DP013-MESSAGE-TEXT(1)          73060000
730700         PERFORM DP013-0000-PROCESS-ABEND                         73070000
730800     END-IF.                                                      73080000
730900                                                                  73090000
731000*----------------------------------------------------------------*73100000
731100*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*73110000
731200*----------------------------------------------------------------*73120000
731300 6112-READ-LIST-QUEUE.                                            73130000
731400                                                                  73140000
731500     EXEC CICS                                                    73150000
731600         READQ TS                                                 73160000
731700             QUEUE (ASC-LIST-QUEUE-NAME)                          73170000
731800             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     73180000
731900             ITEM  (PV-ITEM)                                      73190000
732000             RESP  (PV-CICS-RESP)                                 73200000
732100     END-EXEC.                                                    73210000
732200     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          73220000
732300         CONTINUE                                                 73230000
732400     ELSE                                                         73240000
732500         SET DP013-CICS-ABEND        TO TRUE                      73250000
732600         SET DP013-NO-ROLLBACK       TO TRUE                      73260000
732700         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           73270000
732800         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    73280000
732900                                     TO DP013-MESSAGE-TEXT(1)     73290000
733000         PERFORM DP013-0000-PROCESS-ABEND                         73300000
733100     END-IF.                                                      73310000
733200                                                                  73320000
733300*----------------------------------------------------------------*73330000
733400*    WRITE THE TS QUEUE RECORD                                   *73340000
733500*----------------------------------------------------------------*73350000
733600                                                                  73360000
733700 6113-WRITE-LIST-QUEUE.                                           73370000
733800                                                                  73380000
733900     EXEC CICS                                                    73390000
734000         WRITEQ TS                                                73400000
734100             QUEUE (ASC-LIST-QUEUE-NAME)                          73410000
734200             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     73420000
734300             ITEM  (PV-ITEM)                                      73430000
734400             REWRITE                                              73440000
734500             RESP  (PV-CICS-RESP)                                 73450000
734600     END-EXEC.                                                    73460000
734700*                                                                 73470000
734800     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          73480000
734900         CONTINUE                                                 73490000
735000     ELSE                                                         73500000
735100         SET DP013-CICS-ABEND  TO  TRUE                           73510000
735200         SET DP013-NO-ROLLBACK TO  TRUE                           73520000
735300         MOVE '6113-WRITE-LIST-QUEUE'                             73530000
735400                               TO  DP013-PARAGRAPH                73540000
735500         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  73550000
735600                               TO  DP013-MESSAGE-TEXT(1)          73560000
735700         PERFORM DP013-0000-PROCESS-ABEND                         73570000
735800     END-IF.                                                      73580000
735900                                                                  73590000
736000*----------------------------------------------------------------*73600000
736100 6200-UPDATE-TSQ.                                                 73610000
736200                                                                  73620000
736300     ADD 1 TO PV-SEL-QUEUE-ITEM.                                  73630000
736400     PERFORM 6205-READ-SEL-QUEUE.                                 73640000
736500                                                                  73650000
736600     PERFORM                                                      73660000
736700       VARYING RC013-IDX FROM 1 BY 1                              73670000
736800         UNTIL ((PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS)     73680000
736900            OR (RC013-IDX > RC013-MAX-ITEMS))                     73690000
737000                                                                  73700000
737100         IF RC013-ACTION-SW (RC013-IDX) > SPACE                   73710000
737200             PERFORM 6210-PROCESS-ITEMS                           73720000
737300         END-IF                                                   73730000
737400                                                                  73740000
737500         ADD +1 TO PV-ITEMS-PROCESSED                             73750000
737600     END-PERFORM.                                                 73760000
737700                                                                  73770000
737800     PERFORM 6111-WRITE-LIST-QUEUE.                               73780000
737900                                                                  73790000
738000*----------------------------------------------------------------*73800000
738100*    READ THE LIST QUEUE RECORD.                                 *73810000
738200*----------------------------------------------------------------*73820000
738300 6205-READ-SEL-QUEUE.                                             73830000
738400                                                                  73840000
738500     EXEC CICS                                                    73850000
738600          READQ TS                                                73860000
738700              QUEUE (ASC-SEL-QUEUE-NAME)                          73870000
738800              INTO  (RC013-DC-SELECT-RECORD)                      73880000
738900              ITEM  (PV-SEL-QUEUE-ITEM)                           73890000
739000              RESP  (PV-CICS-RESP)                                73900000
739100     END-EXEC.                                                    73910000
739200                                                                  73920000
739300     IF PV-CICS-RESP = DFHRESP (NORMAL)                           73930000
739400         CONTINUE                                                 73940000
739500     ELSE                                                         73950000
739600         SET DP013-CICS-ABEND       TO  TRUE                      73960000
739700         SET DP013-NO-ROLLBACK      TO  TRUE                      73970000
739800         MOVE '6205-READ-SEL-QUEUE' TO  DP013-PARAGRAPH           73980000
739900         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           73990000
740000                                    TO  DP013-MESSAGE-TEXT(1)     74000000
740100                                                                  74010000
740200         PERFORM DP013-0000-PROCESS-ABEND                         74020000
740300     END-IF.                                                      74030000
740400                                                                  74040000
740500*----------------------------------------------------------------*74050000
740600*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*74060000
740700*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*74070000
740800*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *74080000
740900*----------------------------------------------------------------*74090000
741000 6210-PROCESS-ITEMS.                                              74100000
741100                                                                  74110000
741200     COMPUTE PV-ITEM = 1 + ((RC013-ITEM (RC013-IDX) - 1)          74120000
741300                     / PC-ITEMS-PER-PANEL).                       74130000
741400                                                                  74140000
741500     IF PV-ITEM NOT EQUAL PV-SAVE-ITEM                            74150000
741600         IF PV-SAVE-ITEM NOT EQUAL ZERO                           74160000
741700             PERFORM 6111-WRITE-LIST-QUEUE                        74170000
741800         END-IF                                                   74180000
741900                                                                  74190000
742000         MOVE PV-ITEM TO PV-SAVE-ITEM                             74200000
742100                                                                  74210000
742200         PERFORM 6112-READ-LIST-QUEUE                             74220000
742300                                                                  74230000
742400         IF PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                74240000
742500             CONTINUE                                             74250000
742600         END-IF                                                   74260000
742700     END-IF.                                                      74270000
742800                                                                  74280000
742900     COMPUTE PV-SUB = (RC013-ITEM (RC013-IDX)                     74290000
743000                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              74300000
743100                                                                  74310000
743200     SET LQW-DESELECT (PV-SUB) TO TRUE                            74320000
743300     MOVE LQW-SELECTED-SW (PV-SUB)                                74330000
743400                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  74340000
743500                                                                  74350000
743600     EVALUATE TRUE                                                74360000
743700         WHEN RC013-INQ (RC013-IDX)                               74370000
743800              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             74380000
743900                                                                  74390000
744000         WHEN RC013-UPD (RC013-IDX)                               74400000
744100              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             74410000
744200                                                                  74420000
744300         WHEN RC013-DEL (RC013-IDX)                               74430000
744400              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             74440000
744500                                                                  74450000
744600         WHEN RC013-ERR (RC013-IDX)                               74460000
744700              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             74470000
744800     END-EVALUATE.                                                74480000
744900                                                                  74490000
745000     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                74500000
745100                                                                  74510000
745200*----------------------------------------------------------------*74520000
745300*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *74530000
745400*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *74540000
745500*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *74550000
745600*    THE TEMP QUEUE.                                             *74560000
745700*----------------------------------------------------------------*74570000
745800 6300-UPDATE-TSQ.                                                 74580000
745900     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             74590000
746000     PERFORM 6305-READ-SEL-QUEUE.                                 74600000
746100     PERFORM                                                      74610000
746200         VARYING PC206-IDX                                        74620000
746300         FROM 1 BY 1                                              74630000
746400         UNTIL ((PV-ITEMS-PROCESSED >                             74640000
746500                              PV-HOLD-SELECTED-ITEMS)             74650000
746600         OR (PC206-IDX GREATER THAN PC206-MAX-ITEMS))             74660000
746700         IF  PC206-ACTION-SW (PC206-IDX) > SPACES                 74670000
746800             PERFORM 6310-PROCESS-ITEMS                           74680000
746900         END-IF                                                   74690000
747000         ADD +1                TO PV-ITEMS-PROCESSED              74700000
747100     END-PERFORM.                                                 74710000
747200     PERFORM 6111-WRITE-LIST-QUEUE.                               74720000
747300*                                                                 74730000
747400*                                                                 74740000
747500*----------------------------------------------------------------*74750000
747600*    READ THE LIST QUEUE RECORD.                                 *74760000
747700*----------------------------------------------------------------*74770000
747800 6305-READ-SEL-QUEUE.                                             74780000
747900     EXEC CICS                                                    74790000
748000          READQ TS                                                74800000
748100              QUEUE (ASC-SEL-QUEUE-NAME)                          74810000
748200              INTO  (PC206-DC-SELECT-RECORD)                      74820000
748300              ITEM  (PV-SEL-QUEUE-ITEM)                           74830000
748400              RESP  (PV-CICS-RESP)                                74840000
748500     END-EXEC.                                                    74850000
748600                                                                  74860000
748700     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          74870000
748800         CONTINUE                                                 74880000
748900     ELSE                                                         74890000
749000         SET DP013-CICS-ABEND      TO  TRUE                       74900000
749100         SET DP013-NO-ROLLBACK     TO  TRUE                       74910000
749200         MOVE '6305-READ-SEL-QUEUE'                               74920000
749300                                   TO  DP013-PARAGRAPH            74930000
749400         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           74940000
749500                                   TO  DP013-MESSAGE-TEXT(1)      74950000
749600                                                                  74960000
749700         MOVE ASC-SEL-TERM-ID      TO PV-SEL-TERM-ID              74970000
749800         MOVE ASC-SEL-TASK-NUMBER  TO PV-SEL-TASK-NUMBER          74980000
749900         MOVE ASC-SEL-SEQ          TO PV-SEL-SEQ                  74990000
750000         STRING ' QUEUE 1 TERM ID-'     DELIMITED BY SIZE         75000000
750100                 PV-SEL-TERM-ID       DELIMITED BY SIZE           75010000
750200                ' QUEUE TASK-'        DELIMITED BY SIZE           75020000
750300                 PV-SEL-TASK-NUMBER   DELIMITED BY SIZE           75030000
750400                ' QUEUE SEQ-'         DELIMITED BY SIZE           75040000
750500                 PV-SEL-SEQ           DELIMITED BY SIZE           75050000
750600                                 INTO  DP013-MESSAGE-TEXT(2)      75060000
750700         MOVE ASC-SEL-TERM-ID           TO PV-SEL-TERM-ID         75070000
750800         MOVE ASC-SEL-TASK-NUMBER       TO PV-SEL-TASK-NUMBER     75080000
750900         MOVE ASC-SEL-SEQ               TO PV-SEL-SEQ             75090000
751000         STRING ' QUEUE 2 TERM ID-'     DELIMITED BY SIZE         75100000
751100                 PV-SEL-TERM-ID       DELIMITED BY SIZE           75110000
751200                ' QUEUE TASK-'        DELIMITED BY SIZE           75120000
751300                 PV-SEL-TASK-NUMBER   DELIMITED BY SIZE           75130000
751400                ' QUEUE SEQ-'         DELIMITED BY SIZE           75140000
751500                 PV-SEL-SEQ           DELIMITED BY SIZE           75150000
751600                                 INTO  DP013-MESSAGE-TEXT(3)      75160000
751700         PERFORM DP013-0000-PROCESS-ABEND                         75170000
751800     END-IF.                                                      75180000
751900                                                                  75190000
752000*----------------------------------------------------------------*75200000
752100*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*75210000
752200*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*75220000
752300*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *75230000
752400*----------------------------------------------------------------*75240000
752500 6310-PROCESS-ITEMS.                                              75250000
752600                                                                  75260000
752700     COMPUTE PV-ITEM = 1 + ((PC206-ITEM (PC206-IDX) - 1)          75270000
752800                     / PC-ITEMS-PER-PANEL).                       75280000
752900                                                                  75290000
753000     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           75300000
753100         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          75310000
753200             PERFORM 6111-WRITE-LIST-QUEUE                        75320000
753300         END-IF                                                   75330000
753400         MOVE PV-ITEM          TO PV-SAVE-ITEM                    75340000
753500                                                                  75350000
753600         PERFORM 6112-READ-LIST-QUEUE                             75360000
753700         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               75370000
753800             CONTINUE                                             75380000
753900         END-IF                                                   75390000
754000     END-IF.                                                      75400000
754100                                                                  75410000
754200     COMPUTE PV-SUB = (PC206-ITEM (PC206-IDX)                     75420000
754300                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              75430000
754400     SET LQW-DESELECT (PV-SUB) TO    TRUE                         75440000
754500     MOVE LQW-SELECTED-SW (PV-SUB)                                75450000
754600                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  75460000
754700     EVALUATE TRUE                                                75470000
754800         WHEN PC206-INQ (PC206-IDX)                               75480000
754900              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             75490000
755000                                                                  75500000
755100         WHEN PC206-UPD (PC206-IDX)                               75510000
755200              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             75520000
755300                                                                  75530000
755400         WHEN PC206-DEL (PC206-IDX)                               75540000
755500              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             75550000
755600                                                                  75560000
755700         WHEN PC206-ERR (PC206-IDX)                               75570000
755800              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             75580000
755900     END-EVALUATE.                                                75590000
756000                                                                  75600000
756100     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                75610000
756200*                                                                 75620000
756300*                                                                 75630000
756400                                                                  75640000
756500 6500-CALL-PO-RCVR-TRKING-MOD.                                    75650000
756600                                                                  75660000
756700     INITIALIZE RC071-FIELDS.                                     75670000
756800     MOVE ASC-PO-NBR                TO RC071-PO-NBR               75680000
756900     MOVE ASC-REC-SEQ-NBR           TO RC071-PO-RCVR              75690000
757000                                                                  75700000
757100     MOVE ZERO                      TO RC071-PREPK-ID             75710000
757200                                       RC071-PO-LINE              75720000
757300                                                                  75730000
757400     MOVE ASC-OPER-UNT-ID           TO RC071-SIGNON-LOCATION      75740000
757500     MOVE DP020-USERID              TO RC071-USER-ID              75750000
757600     MOVE PC-CURRENT-PROGRAM-NAME   TO RC071-CALLING-PROGRAM      75760000
757700                                                                  75770000
757800     EVALUATE TRUE                                                75780000
757900         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              75790000
758000            MOVE 86                 TO RC071-DC-FUNCTION-CODE     75800000
758100         WHEN ASC-CONFIRM-INACTV                                  75810000
758200            MOVE 85                 TO RC071-DC-FUNCTION-CODE     75820000
758300            WHEN ASC-CONFIRM-UCC128                               75830000
758400         WHEN ASC-CONFIRM-UCC128                                  75840000
758500         WHEN DP020-FK-LOCAL-FUNC-07 (DP020-SRC-AID)              75850000
758600            MOVE 84                 TO RC071-DC-FUNCTION-CODE     75860000
758700     END-EVALUATE                                                 75870000
758800                                                                  75880000
758900     MOVE LQW-STR-NUMBER (LQW-IDX)  TO RC071-DEST-OPER-UNT-ID     75890000
759000                                                                  75900000
759100     MOVE LENGTH OF RC071-FIELDS    TO PV-COMMAREA-LENGTH.        75910000
759200                                                                  75920000
759300     CALL RC071-PO-RCVR-TRACKING USING  DFHEIBLK                  75930000
759400                                        RC071-COMMAREA            75940000
759500                                        RC071-FIELDS.             75950000
759600     EVALUATE TRUE                                                75960000
759700        WHEN RC071-SUCCESSFUL                                     75970000
759800            CONTINUE                                              75980000
759900        WHEN RC071-DATABASE-BUSY                                  75990000
760000          MOVE ASC-OPER-UNT-ID   TO  PV-DISPLAY-OPER              76000000
760100          MOVE ASC-PO-NBR        TO  PV-DISPLAY-PO-NBR            76010000
760200          MOVE ASC-REC-SEQ-NBR   TO  PV-DISPLAY-RCVR-SEQ-NBR      76020000
760300          INITIALIZE PV-CICS-MSG-AREA                             76030000
760400          STRING ' PCKCS710-6500- '                               76040000
760500                  PV-DISPLAY-OPER   '-'                           76050000
760600                  PV-DISPLAY-PO-NBR '-'                           76060000
760700                  PV-DISPLAY-RCVR-SEQ-NBR ' - '                   76070000
760800                 ' - CONTENTION'            DELIMITED BY SIZE     76080000
760900                                       INTO PV-CICS-MSG-AREA2     76090000
761000           MOVE LENGTH OF PV-CICS-MSG-AREA2                       76100000
761100                                         TO PV-COMMAREA-LENGTH    76110000
761200           EXEC CICS                                              76120000
761300                WRITEQ TD                                         76130000
761400                 QUEUE  ('CSSL')                                  76140000
761500                  FROM  (PV-CICS-MSG-AREA2)                       76150000
761600                LENGTH  (PV-COMMAREA-LENGTH)                      76160000
761700                  RESP  (PV-CICS-RESP)                            76170000
761800           END-EXEC                                               76180000
761900                                                                  76190000
762000        WHEN OTHER                                                76200000
762100          MOVE ASC-OPER-UNT-ID   TO  PV-DISPLAY-OPER              76210000
762200          MOVE ASC-PO-NBR        TO  PV-DISPLAY-PO-NBR            76220000
762300          MOVE ASC-REC-SEQ-NBR   TO  PV-DISPLAY-RCVR-SEQ-NBR      76230000
762400          INITIALIZE PV-CICS-MSG-AREA                             76240000
762500          STRING ' PCKCS711-6500- '                               76250000
762600                  PV-DISPLAY-OPER   '-'                           76260000
762700                  PV-DISPLAY-PO-NBR '-'                           76270000
762800                  PV-DISPLAY-RCVR-SEQ-NBR ' - '                   76280000
762900                 ' - SUCCESS IND - '                              76290000
763000                  RC071-SUCCESS-IND     DELIMITED BY SIZE         76300000
763100                                       INTO PV-CICS-MSG-AREA2     76310000
763200           MOVE LENGTH OF PV-CICS-MSG-AREA2                       76320000
763300                                         TO PV-COMMAREA-LENGTH    76330000
763400           EXEC CICS                                              76340000
763500                WRITEQ TD                                         76350000
763600                 QUEUE  ('CSSL')                                  76360000
763700                  FROM  (PV-CICS-MSG-AREA2)                       76370000
763800                LENGTH  (PV-COMMAREA-LENGTH)                      76380000
763900                  RESP  (PV-CICS-RESP)                            76390000
764000           END-EXEC.                                              76400000
764100                                                                  76410000
764200                                                                  76420000
764300*----------------------------------------------------------------*76430000
764400*  CREATE A RANDOM NBR FOR SMOOTH REQUEST TABLE                   76440000
764500*----------------------------------------------------------------*76450000
764600 7000-CREATE-RANDOM-NBR.                                          76460000
764700     INITIALIZE PV-RANDOM-NBR-R.                                  76470000
764800     CALL PC-RANDOM-PGM USING DFHEIBLK                            76480000
764900                              DFHCOMMAREA                         76490000
765000                              DP902-RANDNBR-ROUTINE-FIELDS.       76500000
765100                                                                  76510000
765200     IF DP902-SUCCESSFUL                                          76520000
765300         MOVE DP902-RANDOM-NUMBER    TO PV-RANDOM-NUMBER          76530000
765400         MOVE PV-RANDOM-1-8          TO PV-RANDOM-NBR-R           76540000
765500         SET  PS-TRANS-ID-DUP        TO TRUE                      76550000
765600         MOVE PV-RANDOM-NBR-R        TO  DK-RANDOM-NBR            76560000
765700         PERFORM 7250-NOT-DUP-RNDM                                76570000
765800                 UNTIL PS-TRANS-ID-NOT-DUP                        76580000
765900                                                                  76590000
766000     ELSE                                                         76600000
766100         SET DP013-CICS-ABEND  TO  TRUE                           76610000
766200         SET DP013-NO-ROLLBACK TO  TRUE                           76620000
766300         MOVE '7000-CREATE-RANDOM-NBR'                            76630000
766400                               TO  DP013-PARAGRAPH                76640000
766500         MOVE 'ATTEMPTING TO CREATE RANDM NUMBR'                  76650000
766600                               TO  DP013-MESSAGE-TEXT(1)          76660000
766700         PERFORM DP013-0000-PROCESS-ABEND                         76670000
766800     END-IF.                                                      76680000
766900*----------------------------------------------------------------*76690000
767000*  CHECK TO SEE IF RANDOM NUMBER ALREADY EXISTS                   76700000
767100*----------------------------------------------------------------*76710000
767200 7250-NOT-DUP-RNDM.                                               76720000
767300                                                                  76730000
767400                                                                  76740000
767500     EXEC SQL                                                     76750000
767600          SELECT LBL_REQ_TRN_ID                                   76760000
767700          INTO  :LBTKHS-LBL-REQ-TRN-ID                            76770000
767800          FROM   TLBTKHS                                          76780000
767900          WHERE  LBL_REQ_TRN_ID  = :DK-RANDOM-NBR                 76790000
768000     END-EXEC.                                                    76800000
768100                                                                  76810000
768200     EVALUATE TRUE                                                76820000
768300         WHEN SQLCODE = ZERO                                      76830000
768400              ADD  1  TO  DK-RANDOM-NBR                           76840000
768500              SET  PS-TRANS-ID-DUP    TO  TRUE                    76850000
768600                                                                  76860000
768700         WHEN SQLCODE = +100                                      76870000
768800             SET PS-TRANS-ID-NOT-DUP  TO  TRUE                    76880000
768900             SET PS-VALID-TRANS-ID    TO  TRUE                    76890000
769000             MOVE DK-RANDOM-NBR       TO  PV-RANDOM-NBR-R         76900000
769100         WHEN OTHER                                               76910000
769200              MOVE '7250-NOT-DUP-RNDM   '                         76920000
769300                               TO DP013-PARAGRAPH                 76930000
769400              MOVE 'CHECK FOR DUPLICATE '                         76940000
769500                               TO DP013-MESSAGE-TEXT (1)          76950000
769600              MOVE SQLCA       TO DP013-SQLCA                     76960000
769700              SET DP013-DB2-ABEND                                 76970000
769800                               TO TRUE                            76980000
769900              PERFORM DP013-0000-PROCESS-ABEND                    76990000
770000                                                                  77000000
770100     END-EVALUATE.                                                77010000
770200                                                                  77020000
770300*----------------------------------------------------------------*77030000
770400* SELECT SHIPT-UNT-ID FROM TSHUUPC AND UPDATE TSHPUNT             77040000
770500*----------------------------------------------------------------*77050000
770600 7500-SEL-ACTV-SHPUNT.                                            77060000
770700                                                                  77070000
770800     SET  PS-NOT-EOF-UPDATE-CARTN-CSR TO TRUE.                    77080000
770900     PERFORM 7515-OPEN-UPD-CARTON-CSR                             77090000
771000     PERFORM 7530-FETCH-UPD-CARTON-CSR                            77100000
771100             UNTIL PS-EOF-UPDATE-CARTN-CSR.                       77110000
771200     PERFORM 7550-CLOSE-UPD-CARTON-CSR.                           77120000
771300                                                                  77130000
771400                                                                  77140000
771500*----------------------------------------------------------------*77150000
771600* OPEN UPD CARTON CSR                                             77160000
771700*----------------------------------------------------------------*77170000
771800 7515-OPEN-UPD-CARTON-CSR.                                        77180000
771900                                                                  77190000
772000     MOVE 'CURSOR: UPD_CRTN_CSR_SMTH'                             77200000
772100                       TO DP013-MESSAGE-TEXT (2).                 77210000
772200     EXEC SQL                                                     77220000
772300          OPEN UPD_CRTN_CSR_SMTH                                  77230000
772400     END-EXEC.                                                    77240000
772500                                                                  77250000
772600     EVALUATE TRUE                                                77260000
772700         WHEN SQLCODE = ZERO                                      77270000
772800             CONTINUE                                             77280000
772900         WHEN SQLCODE = -904                                      77290000
773000         WHEN SQLCODE = -911                                      77300000
773100         WHEN SQLCODE = -913                                      77310000
773200             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    77320000
773300             MOVE '7515-OPEN-UPD-CARTON-'   TO PV-SOFT-PARAGRAPH  77330000
773400             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  77340000
773500             MOVE LENGTH OF PV-CICS-MSG-AREA2                     77350000
773600               TO PV-COMMAREA-LENGTH                              77360000
773700             EXEC CICS                                            77370000
773800                  WRITEQ TD                                       77380000
773900                   QUEUE  ('CSSL')                                77390000
774000                    FROM  (PV-CICS-MSG-AREA2)                     77400000
774100                  LENGTH  (PV-COMMAREA-LENGTH)                    77410000
774200                    RESP  (PV-CICS-RESP)                          77420000
774300             END-EXEC                                             77430000
774400             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          77440000
774500             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              77450000
774600         WHEN SQLWARN0 NOT = SPACES                               77460000
774700         WHEN SQLCODE < ZERO                                      77470000
774800         WHEN SQLCODE > ZERO                                      77480000
774900             MOVE '7515-OPEN-UPD-CARTON-'                         77490000
775000                               TO DP013-PARAGRAPH                 77500000
775100             MOVE 'OPEN UPD_CRTN_CSR_SMTH - '                     77510000
775200                               TO DP013-MESSAGE-TEXT (1)          77520000
775300             MOVE SQLCA        TO DP013-SQLCA                     77530000
775400             MOVE 'TSHUUPC '   TO DP013-DB2-TABLE-NAME (1)        77540000
775500             SET DP013-DB2-ABEND                                  77550000
775600                 DP013-XCTL-DISPLAY-RESTART TO TRUE               77560000
775700             PERFORM DP013-0000-PROCESS-ABEND                     77570000
775800     END-EVALUATE.                                                77580000
775900                                                                  77590000
776000                                                                  77600000
776100*----------------------------------------------------------------*77610000
776200* FETCH UPDATE CARTON CSR - INACTIVATE ROWS                       77620000
776300*----------------------------------------------------------------*77630000
776400 7530-FETCH-UPD-CARTON-CSR.                                       77640000
776500                                                                  77650000
776600     MOVE 'CURSOR: UPD_CRTN_CSR_SMTH'                             77660000
776700                       TO DP013-MESSAGE-TEXT (2).                 77670000
776800                                                                  77680000
776900     EXEC SQL                                                     77690000
777000          FETCH UPD_CRTN_CSR_SMTH                                 77700000
777100           INTO :SUT00024-SHIPT-UNT-ID                            77710000
777200     END-EXEC.                                                    77720000
777300                                                                  77730000
777400     EVALUATE TRUE                                                77740000
777500         WHEN SQLCODE = ZERO                                      77750000
777600              MOVE SUT00024-SHIPT-UNT-ID TO SHPUNT-SHIPT-UNT-ID   77760000
777700              PERFORM 8000A-UPD-ACTV-IND-OTBND                    77770000
777800              PERFORM 8100-SELECT-SULBXF                          77780000
777900              IF SQLCODE = ZERO                                   77790000
778000                  PERFORM 8200-UPD-STAT-CDE-SULBXF                77800000
778100              END-IF                                              77810000
778200* BBR WR41309 - RFID PROCESSING                                   77820000
778300              IF ASC-CONFIRM-INACTV  AND                          77830009
778400                (ASC-ISSUED-FOR-EXCP OR ASC-ISSUED-FOR-ALL)       77840009
778500                  PERFORM 7535-SEND-DELETE-DIRECTIVE              77850000
778600              END-IF                                              77860000
778700* BBR WR41309 - END                                               77870000
778800         WHEN SQLCODE = +100                                      77880000
778900         SET PS-EOF-UPDATE-CARTN-CSR                              77890000
779000                                   TO TRUE                        77900000
779100         WHEN SQLCODE = -904                                      77910000
779200         WHEN SQLCODE = -911                                      77920000
779300         WHEN SQLCODE = -913                                      77930000
779400             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   77940000
779500             MOVE '7530-FETCH-UPD-CARTON-'   TO PV-SOFT-PARAGRAPH 77950000
779600             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 77960000
779700             MOVE LENGTH OF PV-CICS-MSG-AREA2                     77970000
779800               TO PV-COMMAREA-LENGTH                              77980000
779900             EXEC CICS                                            77990000
780000                  WRITEQ TD                                       78000000
780100                   QUEUE  ('CSSL')                                78010000
780200                    FROM  (PV-CICS-MSG-AREA2)                     78020000
780300                  LENGTH  (PV-COMMAREA-LENGTH)                    78030000
780400                    RESP  (PV-CICS-RESP)                          78040000
780500             END-EXEC                                             78050000
780600             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          78060000
780700             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              78070000
780800         WHEN SQLWARN0 NOT = SPACE                                78080000
780900         WHEN SQLCODE NOT = ZERO                                  78090000
781000              MOVE  DK-PO-NBR  TO PV-DISPLAY-PO-NBR               78100000
781100              MOVE  ASC-REC-SEQ-NBR TO PV-DISPLAY-RCVR            78110000
781200              MOVE  DK-STR-NBR      TO PV-DISPLAY-STORE           78120000
781300              STRING 'PO/RCVR/STORE'      DELIMITED BY SIZE       78130000
781400                     PV-DISPLAY-PO-NBR    DELIMITED BY SIZE       78140000
781500                     '-'                  DELIMITED BY SIZE       78150000
781600                     PV-DISPLAY-RCVR      DELIMITED BY SIZE       78160000
781700                     PV-DISPLAY-STORE     DELIMITED BY '  '       78170000
781800                                   INTO DP013-MESSAGE-TEXT (1)    78180000
781900              MOVE '7530-FETCH-UPD-CARTON-CS'                     78190000
782000                               TO DP013-PARAGRAPH                 78200000
782100              MOVE 'FETCH UPD_CRTN_CSR_SMTH   '                   78210000
782200                               TO DP013-MESSAGE-TEXT (2)          78220000
782300              MOVE SQLCA       TO DP013-SQLCA                     78230000
782400              SET DP013-DB2-ABEND                                 78240000
782500                               TO TRUE                            78250000
782600              PERFORM DP013-0000-PROCESS-ABEND                    78260000
782700     END-EVALUATE.                                                78270000
782800                                                                  78280000
782900                                                                  78290000
783000* BBR WR41309 - RFID PROCESSING                                   78300000
783100*----------------------------------------------------------------*78310000
783200 7535-SEND-DELETE-DIRECTIVE.                                      78320000
783300                                                                  78330000
783400     INITIALIZE SU090-DG-REQUEST-COMMAREA.                        78340000
783500                                                                  78350000
783600     MOVE '00'                    TO SU090-RET-CODE.              78360000
783700     MOVE PC-CURRENT-PROGRAM-NAME TO SU090-CALLING-PGM.           78370000
783710     MOVE ASC-OPER-UNT-ID         TO SU090-OPER-UNT-ID.           78371000
783720     SET SU090-DELETE-ACTION      TO TRUE.                        78372000
783730     SET SU090-CARTON-DIRECTIVE   TO TRUE.                        78373000
783740     SET SU090-ONLINE             TO TRUE.                        78374000
783750     SET SU090-QMNGR-CONNECTED-NO TO TRUE.                        78375000
783760     SET SU090-SML-BARCODE        TO TRUE.                        78376000
783770     MOVE 'RFD'                   TO SU090-DIRV-RSN-CDE.          78377000
783780     MOVE ' '                     TO SU090-CASI-CDE.              78378000
783790     MOVE DP020-USERID            TO SU090-ASSOC-ID.              78379000
783791                                                                  78379100
783792     MOVE DK-STR-NBR              TO SU090-STR-NBR                78379200
783793     MOVE DK-PO-NBR               TO SU090-PO-NBR                 78379300
783794     MOVE DK-REC-SEQ-NBR          TO SU090-RCVR-SEQ-NBR           78379400
783795     MOVE SUT00024-SHIPT-UNT-ID   TO SU090-SML-BRCDE-NBR,         78379500
783796                                                                  78379600
783797     INSPECT SU090-DG-REQUEST-COMMAREA                            78379700
783798         REPLACING ALL LOW-VALUES BY '?'.                         78379800
783799                                                                  78379900
783800     CALL SU090-DIRV-GEN-PGM USING DFHEIBLK                       78380000
783810                                 SU090-COMMAREA                   78381000
783820                                 SU090-DG-REQUEST-COMMAREA.       78382000
783830                                                                  78383000
783840     EVALUATE TRUE                                                78384000
783841        WHEN SU090-SUCCESS                                        78384100
783842            CONTINUE                                              78384200
783843        WHEN OTHER                                                78384300
783844          MOVE ASC-OPER-UNT-ID   TO  PV-DISPLAY-OPER              78384400
783845          MOVE ASC-PO-NBR        TO  PV-DISPLAY-PO-NBR            78384500
783846          MOVE ASC-REC-SEQ-NBR   TO  PV-DISPLAY-RCVR-SEQ-NBR      78384600
783847          INITIALIZE PV-CICS-MSG-AREA                             78384700
783848          STRING ' PCKCS710-7535- '                               78384800
783849                  PV-DISPLAY-OPER   '-'                           78384900
783850                  PV-DISPLAY-PO-NBR '-'                           78385000
783851                  PV-DISPLAY-RCVR-SEQ-NBR ' - '                   78385100
783852                 ' - SUCCESS IND - '                              78385200
783853                  SU090-RET-CODE        DELIMITED BY SIZE         78385300
783854                                       INTO PV-CICS-MSG-AREA2     78385400
783855           MOVE LENGTH OF PV-CICS-MSG-AREA2                       78385500
783856                                         TO PV-COMMAREA-LENGTH    78385600
783857           EXEC CICS                                              78385700
783858                WRITEQ TD                                         78385800
783859                 QUEUE  ('CSSL')                                  78385900
783860                  FROM  (PV-CICS-MSG-AREA2)                       78386000
783861                LENGTH  (PV-COMMAREA-LENGTH)                      78386100
783862                  RESP  (PV-CICS-RESP)                            78386200
783863           END-EXEC.                                              78386300
783864                                                                  78386400
783865*----------------------------------------------------------------*78386500
783866* BBR WR41309 - END                                               78386600
783867*----------------------------------------------------------------*78386700
783868* CLOSE LABEL CROSS REFERENCE CURSOR                              78386800
783869*----------------------------------------------------------------*78386900
783870 7550-CLOSE-UPD-CARTON-CSR.                                       78387000
783871                                                                  78387100
783872     MOVE 'CURSOR: UPD_CRTN_CSR_SMTH'                             78387200
783873                       TO DP013-MESSAGE-TEXT (2).                 78387300
783874     EXEC SQL                                                     78387400
783875          CLOSE UPD_CRTN_CSR_SMTH                                 78387500
783876     END-EXEC.                                                    78387600
783877                                                                  78387700
783878     EVALUATE TRUE                                                78387800
783879         WHEN SQLCODE = ZERO                                      78387900
783880             CONTINUE                                             78388000
783890         WHEN SQLCODE = -904                                      78389000
783900         WHEN SQLCODE = -911                                      78390000
784000         WHEN SQLCODE = -913                                      78400000
784100             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   78410000
784200             MOVE '7550-CLOSE-UPD-CARTON-'   TO PV-SOFT-PARAGRAPH 78420000
784300             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 78430000
784400             MOVE LENGTH OF PV-CICS-MSG-AREA2                     78440000
784500               TO PV-COMMAREA-LENGTH                              78450000
784600             EXEC CICS                                            78460000
784700                  WRITEQ TD                                       78470000
784800                   QUEUE  ('CSSL')                                78480000
784900                    FROM  (PV-CICS-MSG-AREA2)                     78490000
785000                  LENGTH  (PV-COMMAREA-LENGTH)                    78500000
785100                    RESP  (PV-CICS-RESP)                          78510000
785200             END-EXEC                                             78520000
785300             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          78530000
785400             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              78540000
785500         WHEN SQLWARN0 NOT = SPACES                               78550000
785600         WHEN SQLCODE < ZERO                                      78560000
785700         WHEN SQLCODE > ZERO                                      78570000
785800             MOVE '7550-CLOSE-UPD-CARTON   '                      78580000
785900                               TO DP013-PARAGRAPH                 78590000
786000             MOVE 'CLOSE UPD_CRTN_CSR_SMTH     '                  78600000
786100                               TO DP013-MESSAGE-TEXT (1)          78610000
786200             MOVE SQLCA        TO DP013-SQLCA                     78620000
786300             MOVE 'TSHUUPC '   TO DP013-DB2-TABLE-NAME (1)        78630000
786400             SET DP013-DB2-ABEND                                  78640000
786500                 DP013-XCTL-DISPLAY-RESTART TO TRUE               78650000
786600             PERFORM DP013-0000-PROCESS-ABEND                     78660000
786700     END-EVALUATE.                                                78670000
786800                                                                  78680000
786900                                                                  78690000
787000*----------------------------------------------------------------*78700000
787100* SELECT SHIPT-UNT-ID FROM TSHUUPC AND UPDATE TSHPUNT             78710000
787200* WHEN UCC128 DATA EXISTS                                         78720000
787300*----------------------------------------------------------------*78730000
787400 7600-SEL-ACTV-SHPUNT-128.                                        78740000
787500                                                                  78750000
787600     SET  PS-NOT-EOF-UPD-CRTN-CSR-128 TO TRUE.                    78760000
787700     PERFORM 7615-OPEN-UPD-CRTN-CSR-128                           78770000
787800     PERFORM 7630-FETCH-UPD-CRTN-CSR-128                          78780000
787900             UNTIL PS-EOF-UPD-CRTN-CSR-128.                       78790000
788000     PERFORM 7650-CLOSE-UPD-CRTN-CSR-128.                         78800000
788100                                                                  78810000
788200                                                                  78820000
788300*----------------------------------------------------------------*78830000
788400* OPEN UPD CARTON CSR                                             78840000
788500*----------------------------------------------------------------*78850000
788600 7615-OPEN-UPD-CRTN-CSR-128.                                      78860000
788700                                                                  78870000
788800     MOVE 'CURSOR: UPD_CRTN_CSR_U128'                             78880000
788900                       TO DP013-MESSAGE-TEXT (2).                 78890000
789000     EXEC SQL                                                     78900000
789100          OPEN UPD_CRTN_CSR_U128                                  78910000
789200     END-EXEC.                                                    78920000
789300                                                                  78930000
789400     EVALUATE TRUE                                                78940000
789500         WHEN SQLCODE = ZERO                                      78950000
789600             CONTINUE                                             78960000
789700         WHEN SQLCODE = -904                                      78970000
789800         WHEN SQLCODE = -911                                      78980000
789900         WHEN SQLCODE = -913                                      78990000
790000             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    79000000
790100             MOVE '7615-OPEN-UPD-CRTN-CSR'  TO PV-SOFT-PARAGRAPH  79010000
790200             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  79020000
790300             MOVE LENGTH OF PV-CICS-MSG-AREA2                     79030000
790400               TO PV-COMMAREA-LENGTH                              79040000
790500             EXEC CICS                                            79050000
790600                  WRITEQ TD                                       79060000
790700                   QUEUE  ('CSSL')                                79070000
790800                    FROM  (PV-CICS-MSG-AREA2)                     79080000
790900                  LENGTH  (PV-COMMAREA-LENGTH)                    79090000
791000                    RESP  (PV-CICS-RESP)                          79100000
791100             END-EXEC                                             79110000
791200             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          79120000
791300             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              79130000
791400         WHEN SQLWARN0 NOT = SPACES                               79140000
791500         WHEN SQLCODE < ZERO                                      79150000
791600         WHEN SQLCODE > ZERO                                      79160000
791700             MOVE '7615-OPEN-UPD-CRTN-'                           79170000
791800                               TO DP013-PARAGRAPH                 79180000
791900             MOVE 'OPEN UPD_CRTN_CSR_SMTH - '                     79190000
792000                               TO DP013-MESSAGE-TEXT (1)          79200000
792100             MOVE SQLCA        TO DP013-SQLCA                     79210000
792200             MOVE 'TSHUUPC '   TO DP013-DB2-TABLE-NAME (1)        79220000
792300             SET DP013-DB2-ABEND                                  79230000
792400                 DP013-XCTL-DISPLAY-RESTART TO TRUE               79240000
792500             PERFORM DP013-0000-PROCESS-ABEND                     79250000
792600     END-EVALUATE.                                                79260000
792700                                                                  79270000
792800                                                                  79280000
792900*----------------------------------------------------------------*79290000
793000* FETCH UPDATE CARTON CSR - INACTIVATE ROWS                       79300000
793100*----------------------------------------------------------------*79310000
793200 7630-FETCH-UPD-CRTN-CSR-128.                                     79320000
793300                                                                  79330000
793400     MOVE 'CURSOR: UPD_CRTN_CSR_U128'                             79340000
793500                       TO DP013-MESSAGE-TEXT (2).                 79350000
793600                                                                  79360000
793700     EXEC SQL                                                     79370000
793800          FETCH UPD_CRTN_CSR_U128                                 79380000
793900           INTO :SHPUNT-SHIPT-UNT-ID                              79390000
794000     END-EXEC.                                                    79400000
794100                                                                  79410000
794200     EVALUATE TRUE                                                79420000
794300         WHEN SQLCODE = ZERO                                      79430000
794400              PERFORM 8000-UPD-ACTV-IND-SHPUNT                    79440000
794500              PERFORM 8100-SELECT-SULBXF                          79450000
794600              IF SQLCODE = ZERO                                   79460000
794700                  PERFORM 8200-UPD-STAT-CDE-SULBXF                79470000
794800                  PERFORM 8300-UPD-STAT-CDE-OTBND                 79480000
794900              END-IF                                              79490000
795000         WHEN SQLCODE = +100                                      79500000
795100              SET PS-EOF-UPD-CRTN-CSR-128                         79510000
795200                                   TO TRUE                        79520000
795300         WHEN SQLCODE = -904                                      79530000
795400         WHEN SQLCODE = -911                                      79540000
795500         WHEN SQLCODE = -913                                      79550000
795600             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   79560000
795700             MOVE '7630-FETCH-UPD-CRTN-'     TO PV-SOFT-PARAGRAPH 79570000
795800             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 79580000
795900             MOVE LENGTH OF PV-CICS-MSG-AREA2                     79590000
796000               TO PV-COMMAREA-LENGTH                              79600000
796100             EXEC CICS                                            79610000
796200                  WRITEQ TD                                       79620000
796300                   QUEUE  ('CSSL')                                79630000
796400                    FROM  (PV-CICS-MSG-AREA2)                     79640000
796500                  LENGTH  (PV-COMMAREA-LENGTH)                    79650000
796600                    RESP  (PV-CICS-RESP)                          79660000
796700             END-EXEC                                             79670000
796800             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          79680000
796900             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              79690000
797000         WHEN SQLWARN0 NOT = SPACE                                79700000
797100         WHEN SQLCODE NOT = ZERO                                  79710000
797200              MOVE  DK-PO-NBR  TO PV-DISPLAY-PO-NBR               79720000
797300              MOVE  ASC-REC-SEQ-NBR TO PV-DISPLAY-RCVR            79730000
797400              MOVE  DK-STR-NBR      TO PV-DISPLAY-STORE           79740000
797500              STRING 'PO/RCVR/STORE'      DELIMITED BY SIZE       79750000
797600                     PV-DISPLAY-PO-NBR    DELIMITED BY SIZE       79760000
797700                     '-'                  DELIMITED BY SIZE       79770000
797800                     PV-DISPLAY-RCVR      DELIMITED BY SIZE       79780000
797900                     PV-DISPLAY-STORE     DELIMITED BY '  '       79790000
798000                                   INTO DP013-MESSAGE-TEXT (1)    79800000
798100              MOVE '7630-FETCH-UPD-CRTN-128 '                     79810000
798200                               TO DP013-PARAGRAPH                 79820000
798300              MOVE 'FETCH UPD_CRTN_CSR_SMTH   '                   79830000
798400                               TO DP013-MESSAGE-TEXT (2)          79840000
798500              MOVE SQLCA       TO DP013-SQLCA                     79850000
798600              SET DP013-DB2-ABEND                                 79860000
798700                               TO TRUE                            79870000
798800              PERFORM DP013-0000-PROCESS-ABEND                    79880000
798900     END-EVALUATE.                                                79890000
799000                                                                  79900000
799100                                                                  79910000
799200*----------------------------------------------------------------*79920000
799300* CLOSE LABEL CROSS REFERENCE CURSOR                              79930000
799400*----------------------------------------------------------------*79940000
799500 7650-CLOSE-UPD-CRTN-CSR-128.                                     79950000
799600                                                                  79960000
799700     MOVE 'CURSOR: UPD_CRTN_CSR_U128'                             79970000
799800                       TO DP013-MESSAGE-TEXT (2).                 79980000
799900     EXEC SQL                                                     79990000
800000          CLOSE UPD_CRTN_CSR_U128                                 80000000
800100     END-EXEC.                                                    80010000
800200                                                                  80020000
800300     EVALUATE TRUE                                                80030000
800400         WHEN SQLCODE = ZERO                                      80040000
800500             CONTINUE                                             80050000
800600         WHEN SQLCODE = -904                                      80060000
800700         WHEN SQLCODE = -911                                      80070000
800800         WHEN SQLCODE = -913                                      80080000
800900             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   80090000
801000             MOVE '7650-CLOSE-UPD-CRTN-128'  TO PV-SOFT-PARAGRAPH 80100000
801100             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 80110000
801200             MOVE LENGTH OF PV-CICS-MSG-AREA2                     80120000
801300               TO PV-COMMAREA-LENGTH                              80130000
801400             EXEC CICS                                            80140000
801500                  WRITEQ TD                                       80150000
801600                   QUEUE  ('CSSL')                                80160000
801700                    FROM  (PV-CICS-MSG-AREA2)                     80170000
801800                  LENGTH  (PV-COMMAREA-LENGTH)                    80180000
801900                    RESP  (PV-CICS-RESP)                          80190000
802000             END-EXEC                                             80200000
802100             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          80210000
802200             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              80220000
802300         WHEN SQLWARN0 NOT = SPACES                               80230000
802400         WHEN SQLCODE < ZERO                                      80240000
802500         WHEN SQLCODE > ZERO                                      80250000
802600             MOVE '7650-CLOSE-UPD-CRTN-128 '                      80260000
802700                               TO DP013-PARAGRAPH                 80270000
802800             MOVE 'CLOSE UPD_CRTN_CSR_SMTH     '                  80280000
802900                               TO DP013-MESSAGE-TEXT (1)          80290000
803000             MOVE SQLCA        TO DP013-SQLCA                     80300000
803100             MOVE 'TSHUUPC '   TO DP013-DB2-TABLE-NAME (1)        80310000
803200             SET DP013-DB2-ABEND                                  80320000
803300                 DP013-XCTL-DISPLAY-RESTART TO TRUE               80330000
803400             PERFORM DP013-0000-PROCESS-ABEND                     80340000
803500     END-EVALUATE.                                                80350000
803600                                                                  80360000
803700                                                                  80370000
803800*----------------------------------------------------------------*80380000
803900*  INACTIVATE TSHPUNT ROWS                                        80390000
804000*----------------------------------------------------------------*80400000
804100 8000-UPD-ACTV-IND-SHPUNT.                                        80410000
804200                                                                  80420000
804300                                                                  80430000
804400     EXEC SQL                                                     80440000
804500          UPDATE TSHPUNT                                          80450000
804600             SET                                                  80460000
804700                  ACTV_IND           = :DK-ACTV-IND               80470000
804800           WHERE  SHIPT_UNT_ID       = :SHPUNT-SHIPT-UNT-ID       80480000
804900     END-EXEC.                                                    80490000
805000                                                                  80500000
805100     EVALUATE TRUE                                                80510000
805200         WHEN SQLCODE = ZERO                                      80520000
805300         WHEN SQLCODE = +100                                      80530000
805400                  CONTINUE                                        80540000
805500                                                                  80550000
805600         WHEN SQLCODE = -904                                      80560000
805700         WHEN SQLCODE = -911                                      80570000
805800         WHEN SQLCODE = -913                                      80580000
805900             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   80590000
806000             MOVE '8000-UPD-ACTV-IND-SHPUNT' TO PV-SOFT-PARAGRAPH 80600000
806100             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 80610000
806200             MOVE LENGTH OF PV-CICS-MSG-AREA2                     80620000
806300               TO PV-COMMAREA-LENGTH                              80630000
806400             EXEC CICS                                            80640000
806500                  WRITEQ TD                                       80650000
806600                   QUEUE  ('CSSL')                                80660000
806700                    FROM  (PV-CICS-MSG-AREA2)                     80670000
806800                  LENGTH  (PV-COMMAREA-LENGTH)                    80680000
806900                    RESP  (PV-CICS-RESP)                          80690000
807000             END-EXEC                                             80700000
807100                                                                  80710000
807200         WHEN SQLWARN0 NOT = SPACES                               80720000
807300         WHEN SQLCODE NOT EQUAL ZERO                              80730000
807400              MOVE SHPUNT-SHIPT-UNT-ID TO PV-DISPLAY-CRTN-ID      80740000
807500              MOVE '8000-UPD-ACTV-IND-SHPUNT'                     80750000
807600                                   TO DP013-PARAGRAPH             80760000
807700              MOVE 'UPDATE ACTIVE IND TSHPUNT '                   80770000
807800                                   TO DP013-MESSAGE-TEXT (1)      80780000
807900              MOVE PV-DISPLAY-CRTN-ID                             80790000
808000                                   TO DP013-MESSAGE-TEXT (2)      80800000
808100              MOVE SQLCA           TO DP013-SQLCA                 80810000
808200              MOVE 'TSHPUNT'       TO DP013-DB2-TABLE-NAME (1)    80820000
808300              SET DP013-DB2-ABEND  TO TRUE                        80830000
808400              PERFORM DP013-0000-PROCESS-ABEND                    80840000
808500     END-EVALUATE.                                                80850000
808600                                                                  80860000
808700*----------------------------------------------------------------*80870000
808800*  INACTIVATE OTUBOUND SHIPPING UNIT TABLE SUT_OTBND_CART         80880000
808900*----------------------------------------------------------------*80890000
809000 8000A-UPD-ACTV-IND-OTBND.                                        80900000
809100                                                                  80910000
809200                                                                  80920000
809300     EXEC SQL                                                     80930000
809400          UPDATE SUT_OTBND_CART                                   80940000
809500             SET                                                  80950000
809600                  ACTV_IND           = :DK-ACTV-IND-OTBND         80960000
809700           WHERE  SHIPT_UNT_ID       = :SUT00024-SHIPT-UNT-ID     80970000
809800     END-EXEC.                                                    80980000
809900                                                                  80990000
810000     EVALUATE TRUE                                                81000000
810100         WHEN SQLCODE = ZERO                                      81010000
810200         WHEN SQLCODE = +100                                      81020000
810300                  CONTINUE                                        81030000
810400                                                                  81040000
810500         WHEN SQLCODE = -904                                      81050000
810600         WHEN SQLCODE = -911                                      81060000
810700         WHEN SQLCODE = -913                                      81070000
810800             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   81080000
810900             MOVE '8000A-UPD-ACTV-IND-OTBND' TO PV-SOFT-PARAGRAPH 81090000
811000             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 81100000
811100             MOVE LENGTH OF PV-CICS-MSG-AREA2                     81110000
811200               TO PV-COMMAREA-LENGTH                              81120000
811300             EXEC CICS                                            81130000
811400                  WRITEQ TD                                       81140000
811500                   QUEUE  ('CSSL')                                81150000
811600                    FROM  (PV-CICS-MSG-AREA2)                     81160000
811700                  LENGTH  (PV-COMMAREA-LENGTH)                    81170000
811800                    RESP  (PV-CICS-RESP)                          81180000
811900             END-EXEC                                             81190000
812000                                                                  81200000
812100         WHEN SQLWARN0 NOT = SPACES                               81210000
812200         WHEN SQLCODE NOT EQUAL ZERO                              81220000
812300              MOVE SUT00024-SHIPT-UNT-ID                          81230000
812400                                       TO PV-DISPLAY-CRTN-ID      81240000
812500              MOVE '8000A-UPD-ACTV-IND-OTBND'                     81250000
812600                                   TO DP013-PARAGRAPH             81260000
812700              MOVE 'UPDATE ACTIVE IND SUT_OTBND_CART '            81270000
812800                                   TO DP013-MESSAGE-TEXT (1)      81280000
812900              MOVE PV-DISPLAY-CRTN-ID                             81290000
813000                                   TO DP013-MESSAGE-TEXT (2)      81300000
813100              MOVE SQLCA           TO DP013-SQLCA                 81310000
813200              MOVE 'SUT_OTBND_CART' TO DP013-DB2-TABLE-NAME (1)   81320000
813300              SET DP013-DB2-ABEND  TO TRUE                        81330000
813400              PERFORM DP013-0000-PROCESS-ABEND                    81340000
813500     END-EVALUATE.                                                81350000
813600                                                                  81360000
813700*----------------------------------------------------------------*81370000
813800*  INACTIVATE LABEL CROSS REFERENCE ROW                           81380000
813900*----------------------------------------------------------------*81390000
814000 8100-SELECT-SULBXF.                                              81400000
814100                                                                  81410000
814200                                                                  81420000
814300     EXEC SQL                                                     81430000
814400          SELECT MAX(LAST_STAT_CHG_TMST)                          81440000
814500            INTO :PV-LAST-STAT-CHG-TMST                           81450000
814600            FROM TSULBXF                                          81460000
814700           WHERE  SHIPT_UNT_ID       = :SHPUNT-SHIPT-UNT-ID       81470000
814800             AND  STAT_CDE           = :PV-PREV-STATUS            81480000
814900     END-EXEC.                                                    81490000
815000                                                                  81500000
815100     EVALUATE TRUE                                                81510000
815200         WHEN SQLCODE = ZERO                                      81520000
815300         WHEN SQLCODE = +100                                      81530000
815400         WHEN SQLCODE = -305                                      81540000
815500                  CONTINUE                                        81550000
815600                                                                  81560000
815700         WHEN SQLCODE = -904                                      81570000
815800         WHEN SQLCODE = -911                                      81580000
815900         WHEN SQLCODE = -913                                      81590000
816000             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   81600000
816100             MOVE '8100-SELECT-SULBXF'       TO PV-SOFT-PARAGRAPH 81610000
816200             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 81620000
816300             MOVE LENGTH OF PV-CICS-MSG-AREA2                     81630000
816400               TO PV-COMMAREA-LENGTH                              81640000
816500             EXEC CICS                                            81650000
816600                  WRITEQ TD                                       81660000
816700                   QUEUE  ('CSSL')                                81670000
816800                    FROM  (PV-CICS-MSG-AREA2)                     81680000
816900                  LENGTH  (PV-COMMAREA-LENGTH)                    81690000
817000                    RESP  (PV-CICS-RESP)                          81700000
817100             END-EXEC                                             81710000
817200                                                                  81720000
817300         WHEN SQLWARN0 NOT = SPACES                               81730000
817400         WHEN SQLCODE NOT EQUAL ZERO                              81740000
817500              MOVE SHPUNT-SHIPT-UNT-ID TO PV-DISPLAY-CRTN-ID      81750000
817600              MOVE '8100-SELECT-SULBXF'                           81760000
817700                                   TO DP013-PARAGRAPH             81770000
817800              MOVE 'SELECT TSULBXF '                              81780000
817900                                   TO DP013-MESSAGE-TEXT (1)      81790000
818000              MOVE PV-DISPLAY-CRTN-ID                             81800000
818100                                   TO DP013-MESSAGE-TEXT (2)      81810000
818200              MOVE SQLCA           TO DP013-SQLCA                 81820000
818300              MOVE 'TSULBXF'       TO DP013-DB2-TABLE-NAME (1)    81830000
818400              SET DP013-DB2-ABEND  TO TRUE                        81840000
818500              PERFORM DP013-0000-PROCESS-ABEND                    81850000
818600     END-EVALUATE.                                                81860000
818700                                                                  81870000
818800*----------------------------------------------------------------*81880000
818900*  INACTIVATE LABEL CROSS REFERENCE ROW                           81890000
819000*----------------------------------------------------------------*81900000
819100 8200-UPD-STAT-CDE-SULBXF.                                        81910000
819200                                                                  81920000
819300                                                                  81930000
819400     EXEC SQL                                                     81940000
819500          UPDATE TSULBXF                                          81950000
819600             SET                                                  81960000
819700                  STAT_CDE           = :DK-ACTV-IND               81970000
819800               ,  LAST_STAT_CHG_TMST = CURRENT TIMESTAMP          81980000
819900           WHERE  SHIPT_UNT_ID       = :SHPUNT-SHIPT-UNT-ID       81990000
820000             AND  STAT_CDE           = :PV-PREV-STATUS            82000000
820100             AND  LAST_STAT_CHG_TMST = :PV-LAST-STAT-CHG-TMST     82010000
820200     END-EXEC.                                                    82020000
820300                                                                  82030000
820400     EVALUATE TRUE                                                82040000
820500         WHEN SQLCODE = ZERO                                      82050000
820600         WHEN SQLCODE = +100                                      82060000
820700                  CONTINUE                                        82070000
820800                                                                  82080000
820900         WHEN SQLCODE = -904                                      82090000
821000         WHEN SQLCODE = -911                                      82100000
821100         WHEN SQLCODE = -913                                      82110000
821200             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   82120000
821300             MOVE '8200-UPD-STAT-CDE-SULBXF' TO PV-SOFT-PARAGRAPH 82130000
821400             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 82140000
821500             MOVE LENGTH OF PV-CICS-MSG-AREA2                     82150000
821600               TO PV-COMMAREA-LENGTH                              82160000
821700             EXEC CICS                                            82170000
821800                  WRITEQ TD                                       82180000
821900                   QUEUE  ('CSSL')                                82190000
822000                    FROM  (PV-CICS-MSG-AREA2)                     82200000
822100                  LENGTH  (PV-COMMAREA-LENGTH)                    82210000
822200                    RESP  (PV-CICS-RESP)                          82220000
822300             END-EXEC                                             82230000
822400                                                                  82240000
822500         WHEN SQLWARN0 NOT = SPACES                               82250000
822600         WHEN SQLCODE NOT EQUAL ZERO                              82260000
822700              MOVE SHPUNT-SHIPT-UNT-ID TO PV-DISPLAY-CRTN-ID      82270000
822800              MOVE '8200-UPD-STAT-CDE-SULBXF'                     82280000
822900                                   TO DP013-PARAGRAPH             82290000
823000              MOVE 'UPDATE STATUS CDE TSULBXF '                   82300000
823100                                   TO DP013-MESSAGE-TEXT (1)      82310000
823200              MOVE PV-DISPLAY-CRTN-ID                             82320000
823300                                   TO DP013-MESSAGE-TEXT (2)      82330000
823400              MOVE SQLCA           TO DP013-SQLCA                 82340000
823500              MOVE 'TSULBXF'       TO DP013-DB2-TABLE-NAME (1)    82350000
823600              SET DP013-DB2-ABEND  TO TRUE                        82360000
823700              PERFORM DP013-0000-PROCESS-ABEND                    82370000
823800     END-EVALUATE.                                                82380000
823900                                                                  82390000
824000*----------------------------------------------------------------*82400000
824100*  INACTIVATE CARTONS ON THE OTBND CART TABLE THAT WERE           82410000
824200*  CREATED BY CHECK-IN                                            82420000
824300*----------------------------------------------------------------*82430000
824400 8300-UPD-STAT-CDE-OTBND.                                         82440000
824500                                                                  82450000
824600     EXEC SQL                                                     82460000
824700          UPDATE SUT_OTBND_CART                                   82470000
824800             SET                                                  82480000
824900                  ACTV_IND           = :DK-ACTV-IND-OTBND         82490000
825000           WHERE  ORIG_CART_ID       = :SHPUNT-SHIPT-UNT-ID       82500000
825100     END-EXEC.                                                    82510000
825200                                                                  82520000
825300     EVALUATE TRUE                                                82530000
825400         WHEN SQLCODE = ZERO                                      82540000
825500         WHEN SQLCODE = +100                                      82550000
825600                  CONTINUE                                        82560000
825700                                                                  82570000
825800         WHEN SQLCODE = -904                                      82580000
825900         WHEN SQLCODE = -911                                      82590000
826000         WHEN SQLCODE = -913                                      82600000
826100             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   82610000
826200             MOVE '8300-UPD-STAT-CDE-OTBND ' TO PV-SOFT-PARAGRAPH 82620000
826300             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 82630000
826400             MOVE LENGTH OF PV-CICS-MSG-AREA2                     82640000
826500               TO PV-COMMAREA-LENGTH                              82650000
826600             EXEC CICS                                            82660000
826700                  WRITEQ TD                                       82670000
826800                   QUEUE  ('CSSL')                                82680000
826900                    FROM  (PV-CICS-MSG-AREA2)                     82690000
827000                  LENGTH  (PV-COMMAREA-LENGTH)                    82700000
827100                    RESP  (PV-CICS-RESP)                          82710000
827200             END-EXEC                                             82720000
827300                                                                  82730000
827400         WHEN SQLWARN0 NOT = SPACES                               82740000
827500         WHEN SQLCODE NOT EQUAL ZERO                              82750000
827600              MOVE SHPUNT-SHIPT-UNT-ID TO PV-DISPLAY-CRTN-ID      82760000
827700              MOVE '8300-UPD-STAT-CDE-OTBND '                     82770000
827800                                   TO DP013-PARAGRAPH             82780000
827900              MOVE 'UPDATE STATUS CDE OTBND CRT'                  82790000
828000                                   TO DP013-MESSAGE-TEXT (1)      82800000
828100              MOVE PV-DISPLAY-CRTN-ID                             82810000
828200                                   TO DP013-MESSAGE-TEXT (2)      82820000
828300              MOVE SQLCA           TO DP013-SQLCA                 82830000
828400              MOVE 'SUT_OTBND_CART' TO DP013-DB2-TABLE-NAME (1)   82840000
828500              SET DP013-DB2-ABEND  TO TRUE                        82850000
828600              PERFORM DP013-0000-PROCESS-ABEND                    82860000
828700     END-EVALUATE.                                                82870000
828800                                                                  82880000
828900*----------------------------------------------------------------*82890000
829000*    CALL (AUTOVE) AUTOVERIFICATION MODULE (RCKUT127)             82900000
829100*----------------------------------------------------------------*82910000
829200 8400-CHECK-AUTOVE.                                               82920000
829300                                                                  82930000
829400     INITIALIZE RC040-FIELDS.                                     82940000
829500     MOVE ASC-CURR-OPER-UNT-ID TO RC040-SIGNON-LOCATION.          82950000
829600     MOVE DK-PO-NBR            TO RC040-PO-NBR.                   82960000
829700     MOVE DK-REC-SEQ-NBR       TO RC040-PO-RCVR.                  82970000
829800     MOVE ASC-DEPT             TO RC040-DEPT.                     82980000
829900     MOVE DP020-USERID         TO RC040-USER-ID.                  82990000
830000     MOVE 'PCKCS710'           TO RC040-CALLING-PROGRAM.          83000000
830100                                                                  83010000
830200     CALL RC040-AUTOVE-CHECK-PGM USING  DFHEIBLK                  83020000
830300                                        RC040-COMMAREA            83030000
830400                                        RC040-FIELDS.             83040000
830500                                                                  83050000
830600     EVALUATE TRUE                                                83060000
830700         WHEN RC040-SUCCESSFUL                                    83070000
830800              MOVE RC040-AUTO-VE-SW     TO PS-AUTO-VE-SW          83080000
830900         WHEN RC040-DATABASE-BUSY OR                              83090000
831000              RC040-INVALID-SQL                                   83100000
831100                  MOVE PC-TSYMSG-00984  TO DP020-MSG-NUMBER       83110000
831200                  SET DP020-MSG-WARNING TO TRUE                   83120000
831300                  SET DP030-OVERRIDE-GO TO TRUE                   83130000
831400                  SET PS-ERROR          TO TRUE                   83140000
831500         WHEN RC040-NOT-SUCCESSFUL                                83150000
831600                  MOVE PC-TSYMSG-03138  TO DP020-MSG-NUMBER       83160000
831700                  SET DP020-MSG-WARNING TO TRUE                   83170000
831800                  SET DP030-OVERRIDE-GO TO TRUE                   83180000
831900                  SET PS-ERROR          TO TRUE                   83190000
832000         WHEN OTHER                                               83200000
832100             MOVE '8400-CHECK-AUTOVE ' TO DP013-PARAGRAPH         83210000
832200             MOVE 'UNSUCCESSFUL CALL TO AUTO VE MOD'              83220000
832300                                         TO DP013-MESSAGE-TEXT (1)83230000
832400             MOVE RC040-SUCCESS-IND      TO DP013-MESSAGE-TEXT (2)83240000
832500             MOVE RC040-SQLCA            TO DP013-SQLCA           83250000
832600             SET DP013-DB2-ABEND                                  83260000
832700                 DP013-XCTL-DISPLAY-RESTART  TO TRUE              83270000
832800             SET PS-ERROR                    TO TRUE              83280000
832900             PERFORM DP013-0000-PROCESS-ABEND                     83290000
833000     END-EVALUATE.                                                83300000
833100                                                                  83310000
833200*----------------------------------------------------------------*83320000
833300* SEE IF THERE ARE ACTIVE CHECKED-IN CRTNS                        83330000
833400*----------------------------------------------------------------*83340000
833500 8450-CHECKED-IN-CRTN.                                            83350000
833600     INITIALIZE PV-DB2-COUNT-CRTN.                                83360000
833700                                                                  83370000
833800     EXEC SQL                                                     83380000
833900          SELECT   COUNT (DISTINCT C.SHIPT_UNT_ID)                83390000
834000            INTO :PV-DB2-COUNT-CRTN  :DN-NULL-IND                 83400000
834100            FROM  TPKSLIP A                                       83410000
834200                , TINPKSU B                                       83420000
834300                , TSHUNLO C                                       83430000
834400           WHERE                                                  83440000
834500                  A.PO_NBR        = :DK-PO-NBR                    83450000
834600             AND  A.REC_SEQ_NBR   = :DK-RECEIVER                  83460000
834700             AND  A.STR_DEST_NBR  = :DK-STR-NBR                   83470000
834800             AND  A.PO_NBR        = B.PO_NBR                      83480000
834900             AND  A.SEQ_NBR       = B.SEQ_NBR                     83490000
835000             AND  C.SHIPT_UNT_ID  = B.SHIPT_UNT_ID                83500000
835100             AND  A.VER_STAT_CDE  = 'A'                           83510000
835200             AND  C.ACTV_CDE      = 'A'                           83520000
835300             AND  C.SCN_LOC_ID    = 'RECV'                        83530000
835400             AND EXISTS                                           83540000
835500             (SELECT *                                            83550000
835600               FROM TSULBXF D                                     83560000
835700               WHERE  C.SHIPT_UNT_ID  = D.SHIPT_UNT_ID)           83570000
835800     END-EXEC.                                                    83580000
835900*                                                                 83590000
836000*    EXEC SQL                                                     83600000
836100*         SELECT COUNT(DISTINCT(A.SHIPT_UNT_ID))                  83610000
836200*           INTO :PV-DB2-COUNT-CRTN  :DN-NULL-IND                 83620000
836300*           FROM SUT_OTBND_UPC  A                                 83630000
836400*              , SUT_OTBND_CART B                                 83640000
836500*          WHERE  A.TRN_NBR        = :DK-PO-NBR                   83650000
836600*            AND  A.RCVR_SEQ_NBR   = :DK-RECEIVER                 83660000
836700*            AND  A.SHIPT_UNT_ID   = B.SHIPT_UNT_ID               83670000
836800*            AND  B.DEST_LOC_NBR   = :DK-STR-NBR                  83680000
836900*            AND  B.CART_SRC_CDE   = 'ASN'                        83690000
837000*            AND  B.ACTV_IND       = 'Y'                          83700000
837100*            AND  B.CRE_PGM_NM     = 'SUKRF502'                   83710000
837200*    END-EXEC.                                                    83720000
837300                                                                  83730000
837400     EVALUATE TRUE                                                83740000
837500         WHEN SQLCODE = ZERO                                      83750000
837600             IF PV-DB2-COUNT-CRTN  > 0                            83760000
837700                 MOVE PC-TSYMSG-03163  TO DP020-MSG-NUMBER        83770000
837800                 SET DP020-MSG-FATAL   TO TRUE                    83780000
837900                 SET DP030-OVERRIDE-GO TO TRUE                    83790000
838000                 SET PS-ERROR          TO TRUE                    83800000
838100             ELSE                                                 83810000
838200                 PERFORM 8500-CHECK-TSHPUNT                       83820000
838300             END-IF                                               83830000
838400         WHEN SQLCODE = +100                                      83840000
838500         WHEN SQLCODE = -305                                      83850000
838600             PERFORM 8500-CHECK-TSHPUNT                           83860000
838700         WHEN SQLCODE = -904                                      83870000
838800         WHEN SQLCODE = -911                                      83880000
838900         WHEN SQLCODE = -913                                      83890000
839000             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   83900000
839100             MOVE '8450-CHECKED-IN-CRN'      TO PV-SOFT-PARAGRAPH 83910000
839200             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 83920000
839300             MOVE LENGTH OF PV-CICS-MSG-AREA2                     83930000
839400               TO PV-COMMAREA-LENGTH                              83940000
839500             EXEC CICS                                            83950000
839600                  WRITEQ TD                                       83960000
839700                   QUEUE  ('CSSL')                                83970000
839800                    FROM  (PV-CICS-MSG-AREA2)                     83980000
839900                  LENGTH  (PV-COMMAREA-LENGTH)                    83990000
840000                    RESP  (PV-CICS-RESP)                          84000000
840100             END-EXEC                                             84010000
840200                                                                  84020000
840300         WHEN SQLWARN0 NOT = SPACES                               84030000
840400         WHEN SQLCODE NOT EQUAL ZERO                              84040000
840500              MOVE '8450-CHECKED-IN-CRTN' TO DP013-PARAGRAPH      84050000
840600              MOVE 'SELECT count'  TO DP013-MESSAGE-TEXT (1)      84060000
840700              MOVE SQLCA           TO DP013-SQLCA                 84070000
840800*             MOVE 'OTND_UPC'      TO DP013-DB2-TABLE-NAME (1)    84080000
840900              MOVE 'TPKSLIP'       TO DP013-DB2-TABLE-NAME (1)    84090000
841000              MOVE 'TINPKSU'       TO DP013-DB2-TABLE-NAME (2)    84100000
841100              MOVE 'TSHUNLO'       TO DP013-DB2-TABLE-NAME (3)    84110000
841200              MOVE 'TSULBXF'       TO DP013-DB2-TABLE-NAME (4)    84120000
841300              SET DP013-DB2-ABEND  TO TRUE                        84130000
841400              PERFORM DP013-0000-PROCESS-ABEND                    84140000
841500     END-EVALUATE.                                                84150000
841600                                                                  84160000
841700***************************************************************   84170000
841800* IF THE RECEIVER IS ATTACHED TO A DUMMY TRIP - DO NOT ALLOW      84180000
841900* SMOOTHING.   D.BRANTNER 4/2005                                  84190000
842000***************************************************************   84200000
842100 8475-CHECK-FOR-DUMMY-TRIP.                                       84210000
842200     MOVE  ASC-PO-NBR        TO  DK-PO-NBR.                       84220000
842300     MOVE  ASC-REC-SEQ-NBR   TO  DK-REC-SEQ-NBR.                  84230000
842400     MOVE  ZEROES            TO  PV-NULL-IND-1.                   84240000
842500                                                                  84250000
842600     EXEC SQL                                                     84260000
842700          SELECT                                                  84270000
842800                  C.VEH_NBR                                       84280000
842900                , C.TRIP_ID                                       84290000
843000            INTO :VHTRIP-VEH-NBR :PV-NULL-IND-1                   84300000
843100                ,:VHTRIP-TRIP-ID                                  84310000
843200            FROM  TSHPTPO A                                       84320000
843300                 ,TSHIPMT B                                       84330000
843400                 ,TVHTRIP C                                       84340000
843500           WHERE  A.PO_NBR      = :DK-PO-NBR                      84350000
843600             AND  A.REC_SEQ_NBR = :DK-REC-SEQ-NBR                 84360000
843700             AND  A.SHIPT_ID    =  B.SHIPT_ID                     84370000
843800             AND  B.TRIP_ID     =  C.TRIP_ID                      84380000
843900             AND  A.PRIM_SHIPT_IND = 'Y'                          84390000
844000     END-EXEC                                                     84400000
844100                                                                  84410000
844200     EVALUATE TRUE                                                84420000
844300         WHEN SQLCODE = +0                                        84430000
844400             IF PV-NULL-IND-1  < 0                                84440000
844500                 SET PS-ERROR          TO TRUE                    84450000
844600             END-IF                                               84460000
844700                                                                  84470000
844800         WHEN SQLWARN0 NOT = SPACE                                84480000
844900         WHEN SQLCODE < +0                                        84490000
845000         WHEN SQLCODE > +0                                        84500000
845100              MOVE ASC-OPER-UNT-ID   TO  PV-DISPLAY-OPER          84510000
845200              MOVE ASC-PO-NBR        TO  PV-DISPLAY-PO-NBR        84520000
845300              MOVE ASC-REC-SEQ-NBR   TO  PV-DISPLAY-RCVR-SEQ-NBR  84530000
845400              MOVE SQLCODE           TO  PV-DISPLAY-SQLCODE       84540000
845500              INITIALIZE PV-CICS-MSG-AREA2                        84550000
845600              STRING ' PCKCS710-8475- '                           84560000
845700                      PV-DISPLAY-OPER   '-'                       84570000
845800                      PV-DISPLAY-PO-NBR '-'                       84580000
845900                      PV-DISPLAY-RCVR-SEQ-NBR ' - '               84590000
846000                      DP020-USERID ' - '                          84600000
846100                     'SQLCODE=' PV-DISPLAY-SQLCODE                84610000
846200                                                DELIMITED BY SIZE 84620000
846300                                           INTO PV-CICS-MSG-AREA2 84630000
846400               MOVE LENGTH OF PV-CICS-MSG-AREA2                   84640000
846500                                             TO PV-COMMAREA-LENGTH84650000
846600               EXEC CICS                                          84660000
846700                    WRITEQ TD                                     84670000
846800                     QUEUE  ('CSSL')                              84680000
846900                      FROM  (PV-CICS-MSG-AREA2)                   84690000
847000                    LENGTH  (PV-COMMAREA-LENGTH)                  84700000
847100                      RESP  (PV-CICS-RESP)                        84710000
847200               END-EXEC                                           84720000
847300                                                                  84730000
847400               MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER        84740000
847500               SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE            84750000
847600               PERFORM 9900-SOFT-ABORT                            84760000
847700                                                                  84770000
847800     END-EVALUATE.                                                84780000
847900                                                                  84790000
848000***************************************************************   84800000
848100* IF THE RECEIVER IS ATTACHED TO A TRIP - CHECK FOR AR STATUS.    84810000
848200* IF STATUS IS SOMETHING ELSE SET PS-ERROR TO TRUE. DMB 4/2005.   84820000
848300***************************************************************   84830000
848400 8480-CHECK-FOR-TRIP-STATUS.                                      84840000
848500                                                                  84850000
848600     EXEC SQL                                                     84860000
848700          SELECT                                                  84870000
848800                  TRIP_STATUS_CDE                                 84880000
848900            INTO :TRIPST-TRIP-STATUS-CDE                          84890000
849000            FROM  TTRIPST                                         84900000
849100           WHERE  TRIP_ID            = :VHTRIP-TRIP-ID            84910000
849200             AND  TRIP_STATUS_CDE    = 'AR'                       84920000
849300     END-EXEC.                                                    84930000
849400                                                                  84940000
849500     EVALUATE TRUE                                                84950000
849600         WHEN SQLCODE = +0                                        84960000
849700             CONTINUE                                             84970000
849800         WHEN SQLCODE = +100                                      84980000
849900             SET PS-ERROR          TO TRUE                        84990000
850000         WHEN SQLWARN0 NOT = SPACE                                85000000
850100         WHEN SQLCODE < +0                                        85010000
850200         WHEN SQLCODE > +0                                        85020000
850300              MOVE ASC-OPER-UNT-ID   TO  PV-DISPLAY-OPER          85030000
850400              MOVE ASC-PO-NBR        TO  PV-DISPLAY-PO-NBR        85040000
850500              MOVE ASC-REC-SEQ-NBR   TO  PV-DISPLAY-RCVR-SEQ-NBR  85050000
850600              MOVE SQLCODE           TO  PV-DISPLAY-SQLCODE       85060000
850700              INITIALIZE PV-CICS-MSG-AREA2                        85070000
850800              STRING ' PCKCS710-8480- '                           85080000
850900                      PV-DISPLAY-OPER   '-'                       85090000
851000                      PV-DISPLAY-PO-NBR '-'                       85100000
851100                      PV-DISPLAY-RCVR-SEQ-NBR ' - '               85110000
851200                      DP020-USERID ' - '                          85120000
851300                     'SQLCODE=' PV-DISPLAY-SQLCODE                85130000
851400                                                DELIMITED BY SIZE 85140000
851500                                           INTO PV-CICS-MSG-AREA2 85150000
851600               MOVE LENGTH OF PV-CICS-MSG-AREA2                   85160000
851700                                             TO PV-COMMAREA-LENGTH85170000
851800               EXEC CICS                                          85180000
851900                    WRITEQ TD                                     85190000
852000                     QUEUE  ('CSSL')                              85200000
852100                      FROM  (PV-CICS-MSG-AREA2)                   85210000
852200                    LENGTH  (PV-COMMAREA-LENGTH)                  85220000
852300                      RESP  (PV-CICS-RESP)                        85230000
852400               END-EXEC                                           85240000
852500                                                                  85250000
852600               MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER        85260000
852700               SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE            85270000
852800               PERFORM 9900-SOFT-ABORT                            85280000
852900     END-EVALUATE.                                                85290000
853000                                                                  85300000
853100*----------------------------------------------------------------*85310000
853200* CHECK TSHPUNT FOR ACTIVE CARTONS                                85320000
853300*----------------------------------------------------------------*85330000
853400 8500-CHECK-TSHPUNT.                                              85340000
853500                                                                  85350000
853600     EXEC SQL                                                     85360000
853700             SELECT C.SHIPT_UNT_ID                                85370000
853800             INTO :SHPUNT-SHIPT-UNT-ID                            85380000
853900             FROM  TPKSLIP A,                                     85390000
854000                   TINPKSU B,                                     85400000
854100                   TSHPUNT C                                      85410000
854200             WHERE A.PO_NBR           = :DK-PO-NBR                85420000
854300               AND A.REC_SEQ_NBR      = :DK-RECEIVER              85430000
854400               AND A.VER_STAT_CDE     = 'A'                       85440000
854500               AND A.PO_NBR           =  B.PO_NBR                 85450000
854600               AND A.SEQ_NBR          =  B.SEQ_NBR                85460000
854700               AND B.SHIPT_UNT_ID     =  C.SHIPT_UNT_ID           85470000
854800               AND C.DEST_OPER_UNT_ID = :DK-STR-NBR               85480000
854900     END-EXEC.                                                    85490000
855000     EVALUATE TRUE                                                85500000
855100         WHEN SQLCODE = ZERO                                      85510000
855200         WHEN SQLCODE = -811                                      85520000
855300             PERFORM 8550-CHECK-TSHUNLO                           85530000
855400         WHEN SQLCODE = +100                                      85540000
855500             SET PS-NO-ERROR       TO TRUE                        85550000
855600         WHEN SQLCODE = -904                                      85560000
855700         WHEN SQLCODE = -911                                      85570000
855800         WHEN SQLCODE = -913                                      85580000
855900             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   85590000
856000             MOVE '8500-CHECK-TSHPUNT     ' TO PV-SOFT-PARAGRAPH  85600000
856100             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 85610000
856200             MOVE LENGTH OF PV-CICS-MSG-AREA2                     85620000
856300               TO PV-COMMAREA-LENGTH                              85630000
856400             EXEC CICS                                            85640000
856500                  WRITEQ TD                                       85650000
856600                   QUEUE  ('CSSL')                                85660000
856700                    FROM  (PV-CICS-MSG-AREA2)                     85670000
856800                  LENGTH  (PV-COMMAREA-LENGTH)                    85680000
856900                    RESP  (PV-CICS-RESP)                          85690000
857000             END-EXEC                                             85700000
857100                                                                  85710000
857200         WHEN SQLWARN0 NOT = SPACES                               85720000
857300         WHEN SQLCODE NOT EQUAL ZERO                              85730000
857400              MOVE '8500-CHECK-TSHPUNT '  TO DP013-PARAGRAPH      85740000
857500              MOVE 'SELECT TSHPUNT '     TO DP013-MESSAGE-TEXT (1)85750000
857600              MOVE SQLCA           TO DP013-SQLCA                 85760000
857700              MOVE 'TSHPUNT '      TO DP013-DB2-TABLE-NAME (1)    85770000
857800              SET DP013-DB2-ABEND  TO TRUE                        85780000
857900              PERFORM DP013-0000-PROCESS-ABEND                    85790000
858000     END-EVALUATE.                                                85800000
858100                                                                  85810000
858200*----------------------------------------------------------------*85820000
858300* CHECK TSHUNLO FOR PBS ERRORS                                    85830000
858400*----------------------------------------------------------------*85840000
858500 8550-CHECK-TSHUNLO.                                              85850000
858600                                                                  85860000
858700     EXEC SQL                                                     85870000
858800          SELECT D.SCN_LOC_ID                                     85880000
858900            INTO :SHUNLO-SCN-LOC-ID                               85890000
859000            FROM  TPKSLIP A,                                      85900000
859100                  TINPKSU B,                                      85910000
859200                  TSHPUNT C,                                      85920000
859300                  TSHUNLO D                                       85930000
859400             WHERE A.PO_NBR           = :DK-PO-NBR                85940000
859500               AND A.REC_SEQ_NBR      = :DK-RECEIVER              85950000
859600               AND A.VER_STAT_CDE     = 'A'                       85960000
859700               AND A.PO_NBR           =  B.PO_NBR                 85970000
859800               AND A.SEQ_NBR          =  B.SEQ_NBR                85980000
859900               AND B.SHIPT_UNT_ID     =  C.SHIPT_UNT_ID           85990000
860000               AND C.SHIPT_UNT_ID     =  D.SHIPT_UNT_ID           86000000
860100               AND C.DEST_OPER_UNT_ID = :DK-STR-NBR               86010000
860200               AND C.ACTV_IND         = 'A'                       86020000
860300               AND D.SCN_LOC_ID    IN ('PBSA', 'PBSB', 'PBSC',    86030000
860400                                      'PBSD', 'PBSE')             86040000
860500     END-EXEC.                                                    86050000
860600                                                                  86060000
860700     EVALUATE TRUE                                                86070000
860800         WHEN SQLCODE = ZERO                                      86080000
860900         WHEN SQLCODE = -811                                      86090000
861000             SET PS-NO-ERROR       TO TRUE                        86100000
861100         WHEN SQLCODE = +100                                      86110000
861200             PERFORM 8600-CHECK-RACF                              86120000
861300         WHEN SQLCODE = -904                                      86130000
861400         WHEN SQLCODE = -911                                      86140000
861500         WHEN SQLCODE = -913                                      86150000
861600             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   86160000
861700             MOVE '8550-CHECK-TSHUNLO     ' TO PV-SOFT-PARAGRAPH  86170000
861800             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 86180000
861900             MOVE LENGTH OF PV-CICS-MSG-AREA2                     86190000
862000               TO PV-COMMAREA-LENGTH                              86200000
862100             EXEC CICS                                            86210000
862200                  WRITEQ TD                                       86220000
862300                   QUEUE  ('CSSL')                                86230000
862400                    FROM  (PV-CICS-MSG-AREA2)                     86240000
862500                  LENGTH  (PV-COMMAREA-LENGTH)                    86250000
862600                    RESP  (PV-CICS-RESP)                          86260000
862700             END-EXEC                                             86270000
862800                                                                  86280000
862900         WHEN SQLWARN0 NOT = SPACES                               86290000
863000         WHEN SQLCODE NOT EQUAL ZERO                              86300000
863100              MOVE '8550-CHECK-TSHUNLO '  TO DP013-PARAGRAPH      86310000
863200              MOVE 'SELECT TSHUNLO '     TO DP013-MESSAGE-TEXT (1)86320000
863300              MOVE SQLCA           TO DP013-SQLCA                 86330000
863400              MOVE 'TSHUNLO '      TO DP013-DB2-TABLE-NAME (1)    86340000
863500              SET DP013-DB2-ABEND  TO TRUE                        86350000
863600              PERFORM DP013-0000-PROCESS-ABEND                    86360000
863700     END-EVALUATE.                                                86370000
863800                                                                  86380000
863900*----------------------------------------------------------------*86390000
864000*    LINK TO (FEM) FKEY ELIGIBILITY MODULE  (RCKUT126)            86400000
864100*----------------------------------------------------------------*86410000
864200 8600-CHECK-RACF.                                                 86420000
864300                                                                  86430000
864400     MOVE DP020-LOCATION-NBR  TO RC039-SIGNON-LOCATION.           86440000
864500     MOVE DK-PO-NBR           TO RC039-PO-NBR.                    86450000
864600     MOVE DK-RECEIVER         TO RC039-REC-SEQ-NBR.               86460000
864700     MOVE 'E'                 TO RC039-FUNCTION-REQ.              86470000
864800     MOVE 'PCKCS710'          TO RC039-PROGRAM-NAME.              86480000
864900                                                                  86490000
865000     EXEC CICS                                                    86500000
865100          LINK PROGRAM (PC-FEM-MODULE)                            86510000
865200          COMMAREA (RC039-FIELDS)                                 86520000
865300          LENGTH (PC-FEM-MODULE-LENGTH)                           86530000
865400          RESP (PV-CICS-RESP)                                     86540000
865500     END-EXEC.                                                    86550000
865600                                                                  86560000
865700     EVALUATE TRUE                                                86570000
865800         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 86580000
865900             IF  RC039-DATABASE-BUSY OR                           86590000
866000                 RC039-INVALID-SQL                                86600000
866100                   MOVE PC-TSYMSG-00984  TO DP020-MSG-NUMBER      86610000
866200                   SET DP020-MSG-WARNING TO TRUE                  86620000
866300                   SET DP030-OVERRIDE-GO TO TRUE                  86630000
866400                   SET PS-ERROR          TO TRUE                  86640000
866500             ELSE                                                 86650000
866600                 IF RC039-NOT-SUCCESSFUL                          86660000
866700                     MOVE PC-TSYMSG-03138  TO DP020-MSG-NUMBER    86670000
866800                     SET DP020-MSG-WARNING TO TRUE                86680000
866900                     SET DP030-OVERRIDE-GO TO TRUE                86690000
867000                     SET PS-ERROR          TO TRUE                86700000
867100                 ELSE                                             86710000
867200                     MOVE RC039-FUNCTION-SW    TO PS-FEM-SW       86720000
867300                     IF PS-FEM-NO                                 86730000
867400                         MOVE PC-TSYMSG-03161  TO DP020-MSG-NUMBER86740000
867500                         SET DP020-MSG-FATAL       TO TRUE        86750000
867600                         SET DP030-OVERRIDE-GO     TO TRUE        86760000
867700                         SET PS-ERROR              TO TRUE        86770000
867800                         SET ASC-TROUBLE-CREATE-NO TO TRUE        86780000
867900                     ELSE                                         86790000
868000                         SET PS-NO-ERROR           TO TRUE        86800000
868100                         SET ASC-TROUBLE-CREATE-YES TO TRUE       86810000
868200                     END-IF                                       86820000
868300                 END-IF                                           86830000
868400             END-IF                                               86840000
868500         WHEN OTHER                                               86850000
868600             MOVE '8600-CHECK-RACF   ' TO DP013-PARAGRAPH         86860000
868700             MOVE 'UNSUCCESSFUL CALL TO FEM MODULE '              86870000
868800                                         TO DP013-MESSAGE-TEXT (1)86880000
868900             MOVE RC039-SUCCESS-IND      TO DP013-MESSAGE-TEXT (2)86890000
869000             MOVE RC039-SQLCA            TO DP013-SQLCA           86900000
869100             SET DP013-DB2-ABEND                                  86910000
869200                 DP013-XCTL-DISPLAY-RESTART  TO TRUE              86920000
869300             SET PS-ERROR                    TO TRUE              86930000
869400             PERFORM DP013-0000-PROCESS-ABEND                     86940000
869500     END-EVALUATE.                                                86950000
869600                                                                  86960000
869700*----------------------------------------------------------------*86970000
869800*    LINK TO TROUBLE MODULE                                       86980000
869900*----------------------------------------------------------------*86990000
870000 8650-CREATE-TROUBLE.                                             87000000
870100                                                                  87010000
870200     SET  TM500-ADD-DETAILS                                       87020000
870300          TM500-CREATE-AUTO        TO TRUE.                       87030000
870400                                                                  87040000
870500     MOVE PC-FA-AUTOVE-TRBLE-381   TO TM500-TRBL-RSN-CDE          87050000
870600                                                                  87060000
870700                                                                  87070000
870800     MOVE ASC-PO-NBR               TO TM500-PO-NBR.               87080000
870900     MOVE ASC-REC-SEQ-NBR          TO TM500-REC-SEQ-NBR.          87090000
871000     MOVE ASC-OPER-UNT-ID          TO TM500-OPER-UNT-ID.          87100000
871100     MOVE ASC-FCLTY-ID             TO TM500-FCLTY-ID.             87110000
871200     MOVE DP020-USERID             TO TM500-NOTIF-UID.            87120000
871300                                                                  87130000
871400     EXEC CICS                                                    87140000
871500         LINK PROGRAM  (PC-TROUBLE-WTR)                           87150000
871600              COMMAREA (TM500-FIELDS)                             87160000
871700              LENGTH   (PC-TROUBLE-LENGTH)                        87170000
871800     END-EXEC.                                                    87180000
871900                                                                  87190000
872000     EVALUATE TRUE                                                87200000
872100         WHEN TM500-CALL-SUCCESSFUL                               87210000
872200         WHEN TM500-DUPLICATE-TROUBLE                             87220000
872300              CONTINUE                                            87230000
872400         WHEN OTHER                                               87240000
872500              MOVE  DK-PO-NBR       TO PV-DISPLAY-PO-NBR          87250000
872600              MOVE  ASC-REC-SEQ-NBR TO PV-DISPLAY-RCVR            87260000
872700              MOVE  DK-STR-NBR      TO PV-DISPLAY-STORE           87270000
872800              MOVE 'CREATING TROUBLE '                            87280000
872900                               TO DP013-MESSAGE-TEXT (1)          87290000
873000              STRING 'PO/RCVR/STORE'      DELIMITED BY SIZE       87300000
873100                     PV-DISPLAY-PO-NBR    DELIMITED BY SIZE       87310000
873200                     '-'                  DELIMITED BY SIZE       87320000
873300                     PV-DISPLAY-RCVR      DELIMITED BY SIZE       87330000
873400                     PV-DISPLAY-STORE     DELIMITED BY '  '       87340000
873500                                   INTO DP013-MESSAGE-TEXT (2)    87350000
873600              MOVE '8650-CREATE-TROUBLE '  TO DP013-PARAGRAPH     87360000
873700              MOVE SQLCA           TO DP013-SQLCA                 87370000
873800              SET DP013-DB2-ABEND  TO TRUE                        87380000
873900              PERFORM DP013-0000-PROCESS-ABEND                    87390000
874000              SET PS-ERROR         TO TRUE                        87400000
874100         END-EVALUATE.                                            87410000
874200                                                                  87420000
874300*** added - dmh - 9/12/08 - begin                                 87430000
874400*----------------------------------------------------------------*87440000
874500* CHECK TO SEE IF STORE HAS ALREADY BEEN SMOOTHED                 87450000
874600*----------------------------------------------------------------*87460000
874700 8660-CHECK-IF-ALREADY-SMOOTHED.                                  87470000
874800                                                                  87480000
874900     MOVE ZEROES  TO  PV-SMOOTH-CRTN-CNT.                         87490000
875000                                                                  87500000
875100     EXEC SQL                                                     87510000
875200          SELECT COUNT(DISTINCT(B.SHIPT_UNT_ID))                  87520000
875300          INTO  :PV-SMOOTH-CRTN-CNT                               87530000
875400            FROM SUT_OTBND_UPC A                                  87540000
875500               , SUT_OTBND_CART B                                 87550000
875600           WHERE A.TRN_NBR       =  :DK-PO-NBR                    87560000
875610             AND A.RCVR_SEQ_NBR  =  :DK-RECEIVER                  87561000
875620             AND A.SHIPT_UNT_ID  =  B.SHIPT_UNT_ID                87562000
875630             AND B.DEST_LOC_NBR  =  :DK-STR-NBR                   87563000
875640             AND B.ACTV_IND      =  'Y'                           87564000
875650             AND B.CART_SRC_CDE  =  'SMO'                         87565000
875660                                                                  87566000
875661     END-EXEC.                                                    87566100
875662                                                                  87566200
875663     EVALUATE TRUE                                                87566300
875664         WHEN SQLCODE = ZERO                                      87566400
875665         WHEN SQLCODE = +100                                      87566500
875666             CONTINUE                                             87566600
875667                                                                  87566700
875668         WHEN SQLCODE = -904                                      87566800
875669         WHEN SQLCODE = -911                                      87566900
875670         WHEN SQLCODE = -913                                      87567000
875680             MOVE SQLCODE                    TO PV-SOFT-SQLCODE   87568000
875690             MOVE '8660-CHECK-SMO-CARTONS ' TO PV-SOFT-PARAGRAPH  87569000
875700             MOVE PV-SOFT-ABORT-MSG          TO PV-CICS-MSG-AREA2 87570000
875710             MOVE LENGTH OF PV-CICS-MSG-AREA2                     87571000
875711               TO PV-COMMAREA-LENGTH                              87571100
875712             EXEC CICS                                            87571200
875713                  WRITEQ TD                                       87571300
875714                   QUEUE  ('CSSL')                                87571400
875715                    FROM  (PV-CICS-MSG-AREA2)                     87571500
875716                  LENGTH  (PV-COMMAREA-LENGTH)                    87571600
875717                    RESP  (PV-CICS-RESP)                          87571700
875718             END-EXEC                                             87571800
875719                                                                  87571900
875720         WHEN SQLWARN0 NOT = SPACES                               87572000
875721         WHEN SQLCODE NOT EQUAL ZERO                              87572100
875722              MOVE '8660-CHECK-TSHUNLO '  TO DP013-PARAGRAPH      87572200
875723              MOVE 'SELECT SMO CART'     TO DP013-MESSAGE-TEXT (1)87572300
875724              MOVE SQLCA           TO DP013-SQLCA                 87572400
875725              MOVE 'OTBND UPC'     TO DP013-DB2-TABLE-NAME (1)    87572500
875726              MOVE 'OTBND CART'    TO DP013-DB2-TABLE-NAME (2)    87572600
875727              SET DP013-DB2-ABEND  TO TRUE                        87572700
875728              PERFORM DP013-0000-PROCESS-ABEND                    87572800
875729     END-EVALUATE.                                                87572900
875730*** added - dmh - 9/12/08 - end                                   87573000
875731                                                                  87573100
875732***************************************************************** 87573200
875733 9100-READ-SEL-QUEUE.                                             87573300
875734     EXEC CICS                                                    87573400
875735         READQ TS                                                 87573500
875736             QUEUE (ASC-SEL-QUEUE-NAME-IN)                        87573600
875737             INTO  (PC203-DC-SELECT-RECORD)                       87573700
875738             ITEM  (ASC-SEL-ITEM)                                 87573800
875739             RESP  (PV-CICS-RESP)                                 87573900
875740     END-EXEC.                                                    87574000
875750     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        87575000
875760         CONTINUE                                                 87576000
875770     ELSE                                                         87577000
875780         SET DP013-LOGIC-ABEND                                    87578000
875790             DP013-NO-ROLLBACK   TO   TRUE                        87579000
875800         MOVE '9100-READ-SEL-QUEUE'                               87580000
875900                                 TO   DP013-PARAGRAPH             87590000
876000         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   87600000
876100                                 TO   DP013-MESSAGE-TEXT (1)      87610000
876200         PERFORM DP013-0000-PROCESS-ABEND                         87620000
876300     END-IF.                                                      87630000
876400                                                                  87640000
876500******************************************************************87650000
876600* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *87660000
876700***************************************************************** 87670000
876800 9200-REWRITE-SEL-QUEUE.                                          87680000
876900                                                                  87690000
877000     EXEC CICS                                                    87700000
877100          WRITEQ TS                                               87710000
877200              QUEUE  (ASC-SEL-QUEUE-NAME-IN)                      87720000
877300              FROM   (PC203-DC-SELECT-RECORD)                     87730000
877400              ITEM   (ASC-SEL-ITEM)                               87740000
877500              RESP   (PV-CICS-RESP)                               87750000
877600              REWRITE                                             87760000
877700     END-EXEC.                                                    87770000
877800                                                                  87780000
877900     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   87790000
878000         SET DP013-CICS-ABEND                                     87800000
878100             DP013-NO-ROLLBACK     TO TRUE                        87810000
878200         MOVE '9200-REWRITE-SEL-QUEUE'                            87820000
878300                                   TO DP013-PARAGRAPH             87830000
878400         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   87840000
878500                                   TO DP013-MESSAGE-TEXT (1)      87850000
878600         PERFORM DP013-0000-PROCESS-ABEND                         87860000
878700     END-IF.                                                      87870000
878800                                                                  87880000
878900*----------------------------------------------------------------*87890000
879000*    CURRENT SYSTEM DATE/TIME MODULE                              87900000
879100*----------------------------------------------------------------*87910000
879200     COPY DPPD017.                                                87920000
879300                                                                  87930000
879400*----------------------------------------------------------------*87940000
879500*    ABEND PROCESSOR MODULE                                      *87950000
879600*----------------------------------------------------------------*87960000
879700     COPY DPPD013.                                                87970000
879800                                                                  87980000
879900*----------------------------------------------------------------*87990000
880000*    THE DB2 RESOURCE IS NOT AVAILABLE, DISPLAY A MESSAGE ON     *88000000
880100*    THE TERMINAL INDICATING THAT THE RESOURCE IS UNAVAILABLE.   *88010000
880200*----------------------------------------------------------------*88020000
880300 9900-SOFT-ABORT.                                                 88030000
880400                                                                  88040000
880500     EXEC CICS SYNCPOINT                                          88050000
880600          ROLLBACK                                                88060000
880700     END-EXEC.                                                    88070000
880800                                                                  88080000
880900     SET  PS-ERROR                                                88090000
881000          PS-SOFT-ABORT-ERROR                                     88100000
881100          DP020-MSG-FATAL       TO  TRUE.                         88110000
881200                                                                  88120000
881300                                                                  88130000
