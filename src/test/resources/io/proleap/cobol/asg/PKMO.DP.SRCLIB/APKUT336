000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.     APKUT336.                                        00020021
000300 AUTHOR.         GREG WISISALOWSKI.                               00030000
000400 DATE-WRITTEN.   MAY 2008.                                        00040000
000500 DATE-COMPILED.                                                   00050000
000600*************************************************************     00060000
000700*    COBOL 2                                                *     00070000
000800*     REFORMATS APRD075 TO TEXT FORMAT.                     *     00080000
000900*                                                           *     00090000
001000* INPUT:                                                    *     00100000
001100*  1. PRIVATE LABEL UNJOURNALIZED EXTRACT   APRD075         *     00110000
001200*                                                           *     00120000
001300* OUTPUT:                                                   *     00130000
001400*  1. UNJOURNALIZED EXTRACT TEXT FILE       APRD076         *     00140000
001500*                                                           *     00150000
001600*************************************************************     00160000
001601* CHANGE LOG:                                               *     00160119
001602*                                                           *     00160220
001603*  DATE  05/28/2008                                         *     00160320
001604*      CHANGE MADE: INITIAL VERSION                         *     00160420
001605*      MADE BY: GREG WISIALOWSKI        WR/IR #: WR34309    *     00160520
001606*                                                           *     00160620
001607*  DATE  10/29/2021                                         *     00160723
001608*      CHANGE MADE: ADDED LOGIC TO HANDLE THE NEW FIELD     *     00160823
001609*      ADDED TO THE APRD075 AND APRD076 COPYBOOKS:          *     00160923
001610*      DERVD-LBL-TYPE-CDE.                                  *     00161023
001611*      MADE BY: NANCY EILBES            WR/IR #: CHG0263376 *     00161123
001612*                                                           *     00161223
001620*************************************************************     00162023
001700   EJECT                                                          00170000
001800 ENVIRONMENT DIVISION.                                            00180000
001900 CONFIGURATION SECTION.                                           00190000
002000 SOURCE-COMPUTER.    IBM-3090.                                    00200000
002100 OBJECT-COMPUTER.    IBM-3090.                                    00210000
002200                                                                  00220000
002300 INPUT-OUTPUT SECTION.                                            00230000
002400 FILE-CONTROL.                                                    00240000
002500     SELECT IN-FILE       ASSIGN TO UT-S-INP01.                   00250000
002600     SELECT OUT-FILE      ASSIGN TO UT-S-OUT01.                   00260000
002700                                                                  00270000
002800 DATA DIVISION.                                                   00280000
002900 FILE SECTION.                                                    00290000
003000                                                                  00300000
003100 FD  IN-FILE                                                      00310000
003200     RECORDING MODE IS F                                          00320000
003300     LABEL RECORDS ARE STANDARD                                   00330000
003400     BLOCK CONTAINS 0 RECORDS                                     00340000
003500     DATA RECORD IS PRIVLAB-IN-REC.                               00350001
003600 01  PRIVLAB-IN-REC                   PIC  X(160).                00360006
003800                                                                  00380000
003900 FD  OUT-FILE                                                     00390000
004000     RECORDING MODE IS F                                          00400000
004100     LABEL RECORDS ARE STANDARD                                   00410000
004200     BLOCK CONTAINS 0 RECORDS                                     00420000
004300     DATA RECORD IS PRIVLAB-OUT-REC.                              00430001
004400 01  PRIVLAB-OUT-REC                  PIC X(100).                 00440006
004500                                                                  00450005
004600                                                                  00460000
004700 EJECT                                                            00470000
004800 WORKING-STORAGE SECTION.                                         00480000
004900                                                                  00490000
005000 01  EOF-SW                           PIC X     VALUE 'N'.        00500000
005100     88  IN-EOF                                 VALUE 'Y'.        00510000
005200                                                                  00520016
005300*----------------------------------------------------------------*00530017
005310*    PRIVATE LABEL UNJOURNALIZED EXTRACT COPYBOOK                *00531017
005320*----------------------------------------------------------------*00532017
005330     COPY APRD075.                                                00533017
005340                                                                  00534017
005350*----------------------------------------------------------------*00535017
005360*    PRIVATE LABEL UNJOURNALIZED EXTRACT TEXT COPYBOOK           *00536017
005370*----------------------------------------------------------------*00537017
005380     COPY APRD076.                                                00538017
005390                                                                  00539017
005400 EJECT                                                            00540017
005500 PROCEDURE DIVISION.                                              00550017
005600 A100-MAIN.                                                       00560017
005700                                                                  00570017
005800     PERFORM B100-INITIALIZE.                                     00580017
005900                                                                  00590017
006000     PERFORM B200-PROCESS                                         00600017
006100         UNTIL IN-EOF.                                            00610017
006200                                                                  00620017
006300     CLOSE  IN-FILE                                               00630017
006400     CLOSE OUT-FILE.                                              00640017
006410                                                                  00641017
006420     GOBACK.                                                      00642017
006430 EJECT                                                            00643017
006440*----------------------------------------------------------------*00644017
006450*    INITIALIZATION PROCESSING                                   *00645017
006460*    CALLED FROM A100-MAIN                                       *00646017
006470*----------------------------------------------------------------*00647017
006480 B100-INITIALIZE.                                                 00648017
006490                                                                  00649017
006500     OPEN INPUT  IN-FILE                                          00650017
006600     OPEN OUTPUT OUT-FILE.                                        00660017
006700                                                                  00670017
006800     PERFORM R100-READ-INPUT.                                     00680017
006900                                                                  00690017
007000 B200-PROCESS.                                                    00700017
007100                                                                  00710017
007200     MOVE AP075-DMM-NBR         TO  AP076-DMM-NBR.                00720017
007300     MOVE AP075-DEPT-NBR        TO  AP076-DEPT-NBR.               00730017
007400     MOVE AP075-AP-VERIFY-ITM-QTY                                 00740017
007500                                TO  AP076-AP-VERIFY-ITM-QTY.      00750017
007600     MOVE AP075-EXTD-1ST-COST-AMT                                 00760017
007700                                TO  AP076-EXTD-1ST-COST-AMT.      00770017
007800     MOVE AP075-EXTD-UNIT-COST-AMT                                00780017
007900                                TO  AP076-EXTD-UNIT-COST-AMT.     00790017
007910     MOVE AP075-DERVD-LBL-TYP-CDE                                 00791022
007920                                TO  AP076-DERVD-LBL-TYP-CDE.      00792022
008000                                                                  00800017
008100     PERFORM W100-WRITE-OUTPUT.                                   00810017
008200                                                                  00820017
008210     PERFORM R100-READ-INPUT.                                     00821017
008220                                                                  00822017
008230                                                                  00823017
008240 R100-READ-INPUT.                                                 00824017
008250                                                                  00825017
008260                                                                  00826017
008270     READ IN-FILE INTO AP075-EXTRACT-FILE                         00827017
008280         AT END SET IN-EOF TO TRUE.                               00828017
008290                                                                  00829017
008300                                                                  00830017
008400 W100-WRITE-OUTPUT.                                               00840017
008500                                                                  00850017
008600     WRITE PRIVLAB-OUT-REC FROM AP076-EXTRACT-RECORD.             00860017
008700                                                                  00870017
