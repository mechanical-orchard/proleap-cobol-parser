000100 IDENTIFICATION DIVISION.                                         00010070
000200 PROGRAM-ID.     APKRP054.                                        00020070
000300 AUTHOR.         KEVIN CATLIN (COPY OF APKRP267 WITH CHANGES)     00030070
000400 DATE-WRITTEN.   DECEMBER, 2001.                                  00040070
000500 DATE-COMPILED.                                                   00050070
000600****************************************************************  00060070
000700*    COBOL 2                                                   *  00070070
000800*                                                              *  00080070
000900*   REPORT OF INVOICE CHARGES $500 AND ABOVE                   *  00090070
001000*                                                              *  00100070
001100*   PROGRAM OVERVIEW:                                          *  00110070
001200*                                                              *  00120070
001300*     THIS PROGRAM CREATES THE CHARGES ON INVOICE REPORT FROM  *  00130070
001400*   THE CHARGE EXTRACT CREATED IN APKUT048.  THIS EXTRACT      *  00140070
001500*   CONTAINS RECORDS FOR INVOICES WITH CHARGE AMOUNTS GREATER  *  00150070
001600*   THAN OR EQUAL TO $500.                                     *  00160070
001700*                                                              *  00170070
001800*   INPUT:                                                     *  00180070
001900*                                                              *  00190070
002000*     1. CHARGE-EXT-FILE                    (APRD267)          *  00200070
002100*                                                              *  00210070
002200*   OUTPUT:                                                    *  00220070
002300*                                                              *  00230070
002400*     1. PRINT-FILE                         (DPWS150O)         *  00240070
002500*     2. ERROR-FILE                         (DPWS150O)         *  00250070
002600*                                                              *  00260070
002700****************************************************************  00270070
002800*   CHANGES:                                                   *  00280070
002900*                                                              *  00290070
003000* 01/08/2002                                                   *  00300070
003100*       INITIAL VERSION.                                       *  00310070
003200*   MADE BY: KEVIN CATLIN                   WR #: 21574        *  00320070
003300*                                                              *  00330070
003400* 01/02/2003                                                   *  00340070
003500*     CHANGED REPORT TO REFLECT ALL CHARGES $500 OR OVER ON AN *  00350070
003600*     INVOICE, INSTEAD OF ONLY FREIGHT.  CORRECTED LRECL OF    *  00360070
003700*     EXTRACT FILE TO 218 TO MATCH APRD267I COPYBOOK.  CHANGED *  00370070
003800*     PRINT FILE AND REPORT FROM 132 TO 150.  CHANGED COPYBOOK *  00380070
003900*     FIELD AP267-FREIGHT-AMT TO AP267-CHARGE-AMT AND INVTBL      00390070
004000*     FIELD FROM INVTBL-FREIGHT-AMT TO INVTBL-CHARGE-AMT.      *  00400070
004100* MADE BY: KEVIN CATLIN                   WR #: 23646          *  00410070
004200*                                                              *  00420070
004300* 02/04/2003                                                   *  00430070
004400*     ARKPO PHASE3 PROJECT. INCREASED THE LENGTH OF PO NBR AND *  00440070
004500*     ALL OF ITS ASSOCIATED FIELDS FROM 7 TO 9. APRD267 COPY-  *  00450070
004600*     BOOK REPLACES THE OLD NAME OF APRD267I.  INCREASED THE   *  00460070
004700*     LRECL LENGTH FOR THE INP01 FILE TO 255.                  *  00470070
004800* MADE BY: MIKE BESKE                     WR #: 23500          *  00480070
004810*                                                              *  00481070
004820* 03/11/2007                                                   *  00482071
004830*     MATCH BY DC PROJECT.                                     *  00483070
004840*     ADDED DC TO THE DETAIL HEADER AND THE DETAIL LINE. ADDED *  00484070
004850*     DC-NBR AND MTCH-LVL-CDE TO INVTBL AND PRINT AREA IN      *  00485070
004860*     WORKING STORAGE.  MODIFIED 2000- AND 3100- TO MOVE       *  00486070
004861*     DC-NBR AND MTCH-LVL-CDE.                                 *  00486170
004862* MADE BY: MICHELE RINDFLEISCH            WR #: 21578          *  00486270
004863*                                                              *  00486370
004864****************************************************************  00486470
004865     EJECT                                                        00486570
004866 ENVIRONMENT DIVISION.                                            00486670
004867 CONFIGURATION SECTION.                                           00486770
004868 INPUT-OUTPUT SECTION.                                            00486870
004869 FILE-CONTROL.                                                    00486970
004870     SELECT CHARGE-EXT-FILE   ASSIGN TO INP01.                    00487070
004880     SELECT PRINT-FILE        ASSIGN TO RPT01.                    00488070
004890     SELECT ERROR-FILE        ASSIGN TO RPT02.                    00489070
004900     EJECT                                                        00490070
005000 DATA DIVISION.                                                   00500070
005100 FILE SECTION.                                                    00510070
005200 FD  CHARGE-EXT-FILE                                              00520070
005300     RECORDING MODE IS F                                          00530070
005400     LABEL RECORDS ARE STANDARD                                   00540070
005500     BLOCK CONTAINS 0 RECORDS                                     00550070
005600     DATA RECORD IS CHARGE-EXT-RECORD.                            00560070
005700 01  CHARGE-EXT-RECORD                PIC  X(255).                00570070
005800                                                                  00580070
005900 FD  PRINT-FILE                                                   00590070
006000     RECORDING MODE IS F                                          00600070
006100     LABEL RECORDS ARE STANDARD                                   00610070
006200     BLOCK CONTAINS 0 RECORDS                                     00620070
006300     RECORD CONTAINS 150 CHARACTERS                               00630070
006400     DATA RECORD IS PRINT-RECORD.                                 00640070
006500 01  PRINT-RECORD                     PIC  X(150).                00650070
006600                                                                  00660070
006700 FD  ERROR-FILE                                                   00670070
006800     RECORDING MODE IS F                                          00680070
006900     LABEL RECORDS ARE STANDARD                                   00690070
007000     BLOCK CONTAINS 0 RECORDS                                     00700070
007100     RECORD CONTAINS 150 CHARACTERS                               00710070
007200     DATA RECORD IS ERROR-REC.                                    00720070
007300 01  ERROR-REC                        PIC  X(150).                00730070
007400     EJECT                                                        00740070
007500 WORKING-STORAGE SECTION.                                         00750070
007600 01  PROGRAM-WORKAREA.                                            00760070
007700     05  FILLER                      PIC  X(31) VALUE             00770070
007800                             '** BEGINNING OF APKRP054 W/S **'.   00780070
007900     05  PW-CURRENT-PARAGRAPH         PIC  X(30).                 00790070
008000     05  PW-REPORT-NAME               PIC  X(08)    VALUE         00800070
008100                                      'APKRP054'.                 00810070
008200     05  PW-REPORT-NBR                PIC  9(01)    VALUE 1.      00820070
008300     05  PW-LINE-COUNT                PIC  9(03)    VALUE 99      00830070
008400                                                    COMP-3.       00840070
008500     05  PW-PAGE-COUNT                PIC  9(05)    VALUE ZERO    00850070
008600                                                    COMP-3.       00860070
008700     05  PW-ERROR-COUNT               PIC  9(05)    VALUE ZERO    00870070
008800                                                    COMP-3.       00880070
008900     05  PW-INPUT-COUNT               PIC  9(05)    VALUE ZERO    00890070
009000                                                    COMP-3.       00900070
009100     05  PW-MAX-LINES                 PIC  9(03)    VALUE 60      00910070
009200                                                    COMP-3.       00920070
009300     05  PW-ADVANCE-COUNT             PIC S9(03)    VALUE ZERO    00930070
009400                                                    COMP-3.       00940070
009500     05  PW-ERROR-PERCENT             PIC  9V99     VALUE 0.05    00950070
009600                                                    COMP-3.       00960070
009700     05  PW-ERROR-LINE-COUNT          PIC  9(03)    VALUE  99     00970070
009800                                                    COMP-3.       00980070
009900     05  PW-ERROR-PAGE-COUNT          PIC  9(05)    VALUE ZERO    00990070
010000                                                    COMP-3.       01000070
010100     05  PW-ERROR-THRESH              PIC  9(05)    VALUE 0       01010070
010200                                                    COMP-3.       01020070
010300     05  PW-DISPLAY-COUNT             PIC  9(05)    VALUE 0.      01030070
010400                                                                  01040070
010500     05  PW-SAVE-ENTRY-METHOD         PIC  X(01)    VALUE SPACE.  01050070
010600     05  PW-SAVE-REPORT-NUMBER        PIC  9(01)    VALUE ZERO.   01060070
010700     05  PW-PREV-PO-NBR               PIC  9(9)     VALUE ZERO.   01070070
010800     05  PW-PREV-RECORD-TYPE          PIC  X(01)    VALUE SPACE.  01080070
010900         88  PW-PREV-VENDOR                         VALUE 'A'.    01090070
011000         88  PW-PREV-INVOICE                        VALUE 'B'.    01100070
011100         88  PW-PREV-RECEIVER                       VALUE 'C'.    01110070
011200     05  PW-PREV-VENDOR-NAME          PIC  X(15)    VALUE SPACES. 01120070
011300     05  PW-PREV-VENDOR-NUMBER        PIC  9(09)    VALUE ZERO.   01130070
011400     05  PW-PREV-INVOICE-NUMBER       PIC  X(22)    VALUE SPACES. 01140070
011500     05  PW-SAVE-INVOICE-NUMBER       PIC  X(22)    VALUE SPACES. 01150070
011600                                                                  01160070
011700     05  PW-SAVE-PO-NBR               PIC  9(9)     VALUE ZERO.   01170070
011800     05  PW-SAVE-VENDOR-NAME          PIC  X(15)    VALUE SPACES. 01180070
011900     05  PW-SAVE-VENDOR-NUMBER        PIC  9(09)    VALUE ZERO.   01190070
012000     05  PW-SAVE-DEPARTMENT-NUMBER    PIC  9(03)    VALUE ZERO.   01200070
012100     05  PW-SAVE-CARTON-COUNT         PIC  9(05)    VALUE ZERO.   01210070
012200     05  PW-NINREC-CARTONS            PIC  9(05)    VALUE ZERO.   01220070
012300                                                                  01230070
012400 01  WS-ABEND-FIELDS.                                             01240070
012500     05  WS-ABEND-PROGRAM             PIC X(8)  VALUE 'APKRP054'. 01250070
012600     05  WS-ABEND-PARAGRAPH           PIC X(50) VALUE SPACES.     01260070
012700     05  WS-ABEND-OPERATION           PIC X(50) VALUE SPACES.     01270070
012800     05  WS-ABEND-STATUS              PIC XX    VALUE SPACES.     01280070
012900     05  WS-ABEND-CODE                PIC S9(04)    VALUE ZERO    01290070
013000                                                    COMP SYNC.    01300070
013100         88 WRITE-ERROR                             VALUE +4001.  01310070
013200         88 READ-ERROR                              VALUE +4002.  01320070
013300         88 CC-ERRROR                               VALUE +4003.  01330070
013400         88 TABLE-ERROR                             VALUE +4004.  01340070
013500         88 OPEN-ERROR                              VALUE +4005.  01350070
013600         88 CLOSE-ERROR                             VALUE +4006.  01360070
013700         88 SEQ-ERROR                               VALUE +4007.  01370070
013800         88 DATA-ERROR                              VALUE +4008.  01380070
013900         88 KEYPUNCH-ERROR                          VALUE +4009.  01390070
014000         88 SORT-ERROR                              VALUE +4012.  01400070
014100         88 DB2-ERROR                               VALUE +4013.  01410070
014200         88 DATE-ERROR                              VALUE +4019.  01420070
014300                                                                  01430070
014400                                                                  01440070
014500 01  PROGRAM-SWITCHES.                                            01450070
014600     05  PW-END-PROCESSING-SW         PIC  X(01)    VALUE 'N'.    01460070
014700         88  END-OF-PROCESSING                      VALUE 'Y'.    01470070
014800     05  PW-NEW-VENDOR-RPT-SW         PIC  X(01)    VALUE 'N'.    01480070
014900         88  NEW-VENDOR                             VALUE 'Y'.    01490070
015000         88  NOT-NEW-VENDOR                         VALUE 'N'.    01500070
015100     05  PW-RECVR-PROC-RPT-SW         PIC  X(01)    VALUE 'N'.    01510070
015200         88  RECEIVER-DATA                          VALUE 'Y'.    01520070
015300         88  NO-RECEIVER-DATA                       VALUE 'N'.    01530070
015400     05  PW-NINREC-SW                 PIC  X(01)    VALUE 'N'.    01540070
015500         88  NINREC-DATA                            VALUE 'Y'.    01550070
015600         88  NO-NINREC-DATA                         VALUE 'N'.    01560070
015700     05  PW-CLASS-TBL-PROC-SW         PIC  X(01)    VALUE 'N'.    01570070
015800         88  ALL-CLASS-TBL-PROC                     VALUE 'Y'.    01580070
015900         88  CLASS-TBL-NOT-PROC                     VALUE 'N'.    01590070
016000     05  PW-RECVR-TBL-PROC-SW         PIC  X(01)    VALUE 'N'.    01600070
016100         88  ALL-RECVR-TBL-PROC                     VALUE 'Y'.    01610070
016200         88  RECVR-TBL-NOT-PROC                     VALUE 'N'.    01620070
016300     05  PW-INVC-TBL-PROC-SW          PIC  X(01)    VALUE 'N'.    01630070
016400         88  ALL-INVC-TBL-PROC                      VALUE 'Y'.    01640070
016500         88  INVC-TBL-NOT-PROC                      VALUE 'N'.    01650070
016600     05  PW-DUP-CLASS-PROC-SW         PIC  X(01)    VALUE 'N'.    01660070
016700         88  DUPLICATE-CLASS                        VALUE 'Y'.    01670070
016800         88  NOT-DUPLICATE-CLASS                    VALUE 'N'.    01680070
016900     05  PW-DUP-RECV-PROC-SW          PIC  X(01)    VALUE 'N'.    01690070
017000         88  DUPLICATE-RECV                         VALUE 'Y'.    01700070
017100         88  NOT-DUPLICATE-RECV                     VALUE 'N'.    01710070
017200     05  PW-SEARCH-PROC-SW            PIC  X(01)    VALUE 'N'.    01720070
017300         88  END-OF-SEARCH                          VALUE 'Y'.    01730070
017400         88  NOT-END-OF-SEARCH                      VALUE 'N'.    01740070
017500     05  PW-FIRST-PROC-SW             PIC  X(01)    VALUE 'Y'.    01750070
017600         88  FIRST-PASS                             VALUE 'Y'.    01760070
017700         88  NOT-FIRST-PASS                         VALUE 'N'.    01770070
017800                                                                  01780070
017900 01  INVOICE-TABLE.                                               01790070
018000     05  INVOICE-TBL-DATA         OCCURS 2000 TIMES.              01800070
018100         10  INVTBL-INVOICE-NUMBER           PIC X(22).           01810070
018200         10  INVTBL-INVOICE-DATE.                                 01820070
018300             15  INVTBL-INVC-MONTH           PIC 9(02).           01830070
018400             15  INVTBL-INVC-DAY             PIC 9(02).           01840070
018500             15  INVTBL-INVC-YEAR            PIC 9(02).           01850070
018600         10  INVTBL-STORE-NUMBER             PIC 9(04).           01860070
018700         10  INVTBL-CHARGE-CODE              PIC X(03).           01870070
018800         10  INVTBL-CHARGE-AMT               PIC 9(09)V99  COMP-3.01880070
018900         10  INVTBL-DC-NBR                   PIC 9(05).           01890070
019000         10  INVTBL-MTCH-LVL-CDE             PIC X(01).           01900070
019100 01  INV-TBL-SUB            PIC 9(4) VALUE ZERO.                  01910070
019200                                                                  01920070
019300 01  CLASS-TABLE.                                                 01930070
019400     05  CLASS-DATA         OCCURS 99 TIMES.                      01940070
019500         10  CLASS-TABLE-ENTRY  PIC 9(3).                         01950070
019600 01  CLASS-NBR              PIC 9(2) VALUE ZERO.                  01960070
019700 01  CLASS-NBR-PROC         PIC 9(2) VALUE ZERO.                  01970070
019800 01  SEARCH-CLASS           PIC X(3).                             01980070
019900 01  SEARCH-SUB             PIC 9(4) VALUE ZERO.                  01990070
020000 01  NBR-ENTRY-MOVES        PIC 9(2) VALUE ZERO.                  02000070
020100                                                                  02010070
020200 01  RECV-SEQ-TABLE.                                              02020070
020300     05  RECV-SEQ-DATA         OCCURS 2000 TIMES.                 02030070
020400         10  RECV-SEQ-TBL-ENTRY  PIC 9(4).                        02040070
020500         10  RECV-SEQ-TBL-ENTRY-R   REDEFINES RECV-SEQ-TBL-ENTRY  02050070
020600                                 PIC X(4).                        02060070
020700                                                                  02070070
020800 01  RECV-SEQ-SUB              PIC 9(4) VALUE ZERO.               02080070
020900 01  RECV-SEQ-NBR-PROC         PIC 9(4) VALUE ZERO.               02090070
021000                                                                  02100070
021100 01  PW-CURRENT-DATE.                                             02110070
021200     05  PW-CURRENT-YEAR              PIC  9(02)    VALUE ZEROES. 02120070
021300     05  PW-CURRENT-MONTH             PIC  9(02)    VALUE ZEROES. 02130070
021400     05  PW-CURRENT-DAY               PIC  9(02)    VALUE ZEROES. 02140070
021500                                                                  02150070
021600 01  PW-CURRENT-TIME.                                             02160070
021700     05  PW-CURRENT-HOUR              PIC  9(02)    VALUE ZEROES. 02170070
021800     05  PW-CURRENT-MINUTE            PIC  9(02)    VALUE ZEROES. 02180070
021900     05  FILLER                       PIC  9(02)    VALUE ZEROES. 02190070
022000                                                                  02200070
022100 01  RECV-SEQ-NBR-TRUNC.                                          02210070
022200     05  FILLER                       PIC X(5).                   02220070
022300     05  RECV-SEQ-NBR-1-4             PIC X(4).                   02230070
022400                                                                  02240070
022500 01  PW-CONSTANTS.                                                02250070
022600     05  PW-NO-INVOICE                PIC  X(34)    VALUE         02260070
022700         'MISSING INVOICE RECORD            '.                    02270070
022800     05  PW-NO-INVC-OR-RECEIVERS      PIC  X(34)    VALUE         02280070
022900         'MISSING INVOICE/RECEIVING RECORDS '.                    02290070
023000     05  PW-NO-RECEIVERS              PIC  X(34)    VALUE         02300070
023100         'MISSING RECEIVING RECORD          '.                    02310070
023200     05  PW-MULTIPLE-VENDORS          PIC  X(34)    VALUE         02320070
023300         'MULTIPLE VENDOR RECORDS           '.                    02330070
023400     05  PW-NO-VENDOR                 PIC  X(34)    VALUE         02340070
023500         'MISSING  VENDOR RECORD            '.                    02350070
023600     05  PW-NO-VEND-RECV              PIC  X(34)    VALUE         02360070
023700         'MISSING VENDOR/RECEIVER RECORDS   '.                    02370070
023800     EJECT                                                        02380070
023900     COPY DPWS150O.                                               02390070
024000                                                                  02400070
024100 01  HDR-LINE-2.                                                  02410070
024200     05  FILLER                       PIC  X(59)   VALUE SPACES.  02420070
024300     05  FILLER                       PIC  X(31)  VALUE           02430070
024400         'CHARGES $500 OR OVER ON INVOICE'.                       02440070
024500     05  FILLER                       PIC  X(60)   VALUE SPACES.  02450070
024600                                                                  02460070
024700 01  RPT-LINE-1.                                                  02470070
024800     05  FILLER                       PIC  X(04)    VALUE         02480070
024900                                      'P/O '.                     02490070
025000     05  FILLER                       PIC  X(07)    VALUE SPACES. 02500070
025100     05  FILLER                       PIC  X(07)    VALUE         02510070
025200                                      'VENDOR '.                  02520070
025300     05  FILLER                       PIC  X(04)    VALUE SPACES. 02530070
025400     05  FILLER                       PIC  X(11)    VALUE         02540070
025500                                      'VENDOR NAME'.              02550070
025600     05  FILLER                       PIC  X(05)    VALUE SPACES. 02560070
025700     05  FILLER                       PIC  X(08)    VALUE         02570070
025800                                      'INVOICE '.                 02580070
025900     05  FILLER                       PIC  X(15)    VALUE SPACES. 02590070
026000     05  FILLER                       PIC  X(08)    VALUE         02600070
026100                                      'INVOICE '.                 02610070
026200     05  FILLER                       PIC  X(01)    VALUE SPACES. 02620070
026300     05  FILLER                       PIC  X(06)    VALUE         02630070
026400                                      'STORE '.                   02640070
026500     05  FILLER                       PIC  X(02)    VALUE SPACES. 02650070
026600     05  FILLER                       PIC  X(04)    VALUE         02660070
026700                                      'CART'.                     02670070
026800     05  FILLER                       PIC  X(01)    VALUE SPACES. 02680070
026900     05  FILLER                       PIC  X(06)    VALUE         02690070
027000                                      'CHARGE'.                   02700070
027100     05  FILLER                       PIC  X(08)    VALUE SPACES. 02710070
027200     05  FILLER                       PIC  X(07)    VALUE         02720070
027300                                      'KOHLS  '.                  02730070
027400     05  FILLER                       PIC  X(04)    VALUE         02740070
027500                                      'DEPT'.                     02750070
027600     05  FILLER                       PIC  X(02)    VALUE SPACES. 02760070
027700     05  FILLER                       PIC  X(05)    VALUE         02770070
027800                                      'CLASS'.                    02780070
027900     05  FILLER                       PIC  X(08)    VALUE SPACES. 02790070
028000     05  FILLER                       PIC  X(09)    VALUE         02800070
028100                                      'RCVR SEQ#'.                02810070
028200     05  FILLER                       PIC  X(06)    VALUE SPACES. 02820070
028300     05  FILLER                       PIC  X(02)    VALUE         02830070
028400                                      'DC'.                       02840070
028500     05  FILLER                       PIC  X(03)    VALUE SPACES. 02850070
028600     05  FILLER                       PIC  X(05)    VALUE         02860070
028700                                      'MATCH'.                    02870070
028800     05  FILLER                       PIC  X(02)    VALUE SPACES. 02880070
028900                                                                  02890070
029000 01  RPT-LINE-2.                                                  02900070
029100     05  FILLER                       PIC  X(06)    VALUE         02910070
029200                                      'NUMBER'.                   02920070
029300     05  FILLER                       PIC  X(05)    VALUE SPACES. 02930070
029400     05  FILLER                       PIC  X(07)    VALUE         02940070
029500                                      'NUMBER '.                  02950070
029600     05  FILLER                       PIC  X(20)    VALUE SPACES. 02960070
029700     05  FILLER                       PIC  X(08)    VALUE         02970070
029800                                      'NUMBER  '.                 02980070
029900     05  FILLER                       PIC  X(15)    VALUE SPACES. 02990070
030000     05  FILLER                       PIC  X(08)    VALUE         03000070
030100                                      'DATE    '.                 03010070
030200     05  FILLER                       PIC  X(01)    VALUE SPACES. 03020070
030300     05  FILLER                       PIC  X(06)    VALUE         03030070
030400                                      'NUMBER'.                   03040070
030500     05  FILLER                       PIC  X(07)    VALUE SPACES. 03050070
030600     05  FILLER                       PIC  X(04)    VALUE         03060070
030700                                      'CODE'.                     03070070
030800     05  FILLER                       PIC  X(09)    VALUE SPACES. 03080070
030900     05  FILLER                       PIC  X(06)    VALUE         03090070
031000                                      'CHARGE'.                   03100070
031100     05  FILLER                       PIC  X(36)    VALUE SPACES. 03110070
031200     05  FILLER                       PIC  X(03)    VALUE         03120070
031300                                      'NBR'.                      03130070
031400     05  FILLER                       PIC  X(02)    VALUE SPACES. 03140070
031500     05  FILLER                       PIC  X(07)    VALUE         03150070
031600                                      'LVL CDE'.                  03160070
031610     05  FILLER                       PIC  X(01)    VALUE SPACES. 03161070
031620     EJECT                                                        03162070
031630 01  PRINT-LINE.                                                  03163070
031640     05  PRINT-PO-NBR                 PIC  Z(09).                 03164070
031650     05  PRINT-PO-NBR-ALPHA REDEFINES PRINT-PO-NBR                03165070
031660                                      PIC  X(09).                 03166070
031670     05  FILLER                       PIC  X(02)    VALUE SPACES. 03167070
031680     05  PRINT-VENDOR-NUMBER          PIC  X(09).                 03168070
031690     05  FILLER                       PIC  X(02)    VALUE SPACES. 03169070
031700     05  PRINT-VENDOR-NAME            PIC  X(15).                 03170070
031800     05  FILLER                       PIC  X(01)    VALUE SPACE.  03180070
031900     05  PRINT-INVOICE-NUMBER         PIC  X(22).                 03190070
032000     05  FILLER                       PIC  X(01)    VALUE SPACES. 03200070
032100     05  PRINT-INVOICE-DATE.                                      03210070
032200         10  PRINT-INVC-DTE-MM        PIC  X(02).                 03220070
032300         10  PRINT-DASH1              PIC  X(01)    VALUE SPACES. 03230070
032400         10  PRINT-INVC-DTE-DD        PIC  X(02).                 03240070
032500         10  PRINT-DASH2              PIC  X(01)    VALUE SPACES. 03250070
032600         10  PRINT-INVC-DTE-YY        PIC  X(02).                 03260070
032700     05  FILLER                       PIC  X(02)    VALUE SPACES. 03270070
032800     05  PRINT-STORE-NUMBER           PIC  X(04).                 03280070
032900     05  FILLER                       PIC  X(02)    VALUE SPACES. 03290070
033000     05  PRINT-CARTON-COUNT           PIC  ZZZZZ.                 03300070
033100     05  PRINT-CART-CNT-ALPHA REDEFINES                           03310070
033200                              PRINT-CARTON-COUNT PIC X(5).        03320070
033300     05  FILLER                       PIC  X(01)    VALUE SPACES. 03330070
033400     05  PRINT-CHARGE-CODE            PIC  X(03).                 03340070
033500     05  FILLER                       PIC  X(02)    VALUE SPACES. 03350070
033600     05  PRINT-CHARGE-AMT             PIC  ZZZ,ZZZ,ZZZ.ZZ.        03360070
033700     05  FILLER                       PIC  X(02)    VALUE SPACES. 03370070
033800     05  PRINT-DEPARTMENT-NUMBER      PIC  X(03).                 03380070
033900     05  FILLER                       PIC  X(02)    VALUE SPACES. 03390070
034000     05  PRINT-CLASSES.                                           03400070
034100         10  PRINT-CLASS-DATA         OCCURS 3 TIMES.             03410070
034200             15 FILLER                PIC X VALUE SPACE.          03420070
034300             15  PRINT-CLASS-ENTRY    PIC X(3).                   03430070
034400     05  FILLER                       PIC  X(01)    VALUE SPACE.  03440070
034500     05  PRINT-RCVR-SEQ.                                          03450070
034600         10  PRINT-RECV-SEQ-DATA         OCCURS 3 TIMES.          03460070
034700             15 FILLER                PIC X VALUE SPACE.          03470070
034800             15  PRINT-RECV-SEQ-ENTRY PIC X(4).                   03480070
034900     05  FILLER                       PIC X(01)    VALUE SPACES.  03490070
035000     05  PRINT-DC-NBR                 PIC X(05)    VALUE SPACES.  03500070
035100     05  FILLER                       PIC X(01)    VALUE SPACES.  03510070
035200     05  PRINT-MTCH-LVL-CDE           PIC X(01)    VALUE SPACES.  03520070
035300                                                                  03530070
035400 01  MANUAL-NOTE.                                                 03540070
035500     05  FILLER                       PIC  X(14)    VALUE         03550070
035600         '  NOTE:       '.                                        03560070
035700     05  FILLER                       PIC  X(54)    VALUE         03570070
035800         'WHEN "INVOICED BY STORE", RECEIVER CARTON COUNT TOTALS'.03580070
035900     05  FILLER                       PIC  X(29)    VALUE         03590070
036000         ' REFLECT THE ENTIRE RECEIVER.'.                         03600070
036100     05  FILLER                       PIC  X(53)    VALUE SPACES. 03610070
036200                                                                  03620070
036300 01  EOR-END-OF-REPORT.                                           03630070
036400     05  FILLER                  PIC  X(61)  VALUE SPACES.        03640070
036500     05  FILLER                  PIC  X(89)  VALUE                03650070
036600         '*****  END OF REPORT *****'.                            03660070
036700                                                                  03670070
036800 01  EH-ERROR-HEADER.                                             03680070
036900     05  FILLER                  PIC  X(01)  VALUE SPACE.         03690070
037000     05  FILLER                  PIC  X(11)  VALUE 'P/O#'.        03700070
037100     05  FILLER                  PIC  X(11)  VALUE 'VENDOR#'.     03710070
037200     05  FILLER                  PIC  X(19)  VALUE 'VENDOR NAME'. 03720070
037300     05  FILLER                  PIC  X(24)  VALUE 'INVOICE#'.    03730070
037400     05  FILLER                  PIC  X(40)  VALUE                03740070
037500         'ERROR MESSAGE'.                                         03750070
037600     05  FILLER                  PIC  X(29)  VALUE SPACES.        03760070
037700                                                                  03770070
037800 01  H3-HEADER3.                                                  03780070
037900     05  FILLER                  PIC  X(69) VALUE SPACES.         03790070
038000     05  FILLER                  PIC  X(12)  VALUE                03800070
038100         'ERROR REPORT'.                                          03810070
038200     05  FILLER                  PIC  X(69) VALUE SPACES.         03820070
038300                                                                  03830070
038400 01  ED-ERROR-DETAIL.                                             03840070
038500     05  ED-PO-NBR               PIC  Z(09)  VALUE ZEROS.         03850070
038600     05  FILLER                  PIC  X(01)  VALUE SPACES.        03860070
038700     05  ED-VENDOR-NUMBER        PIC  9(09)  VALUE ZEROS.         03870070
038800     05  FILLER                  PIC  X(02)  VALUE SPACES.        03880070
038900     05  ED-VENDOR-NAME          PIC  X(15)  VALUE SPACES.        03890070
039000     05  FILLER                  PIC  X(04)  VALUE SPACES.        03900070
039100     05  ED-INVOICE-NUMBER       PIC  X(22)  VALUE ZEROS.         03910070
039200     05  FILLER                  PIC  X(02)  VALUE SPACES.        03920070
039300     05  ED-ERROR-MESSAGE        PIC  X(40)  VALUE SPACES.        03930070
039400     05  FILLER                  PIC  X(30)  VALUE SPACES.        03940070
039500                                                                  03950070
039600 01  ET-ERROR-TOTALS.                                             03960070
039700     05  FILLER                  PIC  X(01)  VALUE SPACE.         03970070
039800     05  FILLER                  PIC  X(24)  VALUE                03980070
039900         'TOTAL NUMBER OF ERRORS: '.                              03990070
040000     05  ET-ERROR-COUNT          PIC  ZZZZ9  VALUE ZEROS.         04000070
040100     05  FILLER                  PIC  X(121) VALUE SPACES.        04010070
040200     EJECT                                                        04020070
040300     COPY APRD267.                                                04030070
040400     EJECT                                                        04040070
040500 PROCEDURE DIVISION.                                              04050070
040600*                                                                 04060070
040700 0000-MAINLINE.                                                   04070070
040800                                                                  04080070
040900     MOVE '0000-MAINLINE                ' TO PW-CURRENT-PARAGRAPH.04090070
041000     PERFORM 1000-INITIALIZATION THRU 1000-EXIT.                  04100070
041100     PERFORM 2000-DETAIL-PROCESSING THRU 2000-EXIT                04110070
041200         UNTIL END-OF-PROCESSING.                                 04120070
041300     PERFORM 9900-END-OF-INPUT   THRU 9900-EXIT.                  04130070
041400                                                                  04140070
041500     GOBACK.                                                      04150070
041600     EJECT                                                        04160070
041700 1000-INITIALIZATION.                                             04170070
041800     MOVE '1000-INITIALIZATION          ' TO PW-CURRENT-PARAGRAPH.04180070
041900*                                                                 04190070
042000     MOVE ZERO TO PW-PAGE-COUNT                                   04200070
042100                  PW-ERROR-PAGE-COUNT.                            04210070
042200     OPEN INPUT  CHARGE-EXT-FILE                                  04220070
042300          OUTPUT PRINT-FILE                                       04230070
042400                 ERROR-FILE.                                      04240070
042500     ACCEPT PW-CURRENT-DATE FROM DATE.                            04250070
042600     MOVE PW-CURRENT-MONTH            TO DP150O-RUN-MONTH.        04260070
042700     MOVE PW-CURRENT-DAY              TO DP150O-RUN-DAY.          04270070
042800     MOVE PW-CURRENT-YEAR             TO DP150O-RUN-YEAR.         04280070
042900     ACCEPT PW-CURRENT-TIME FROM TIME.                            04290070
043000     MOVE PW-CURRENT-HOUR             TO DP150O-RUN-HOUR.         04300070
043100     MOVE PW-CURRENT-MINUTE           TO DP150O-RUN-MINUTE.       04310070
043200     MOVE PW-REPORT-NAME              TO DP150O-PROGRAM-NAME.     04320070
043300     MOVE PW-REPORT-NBR               TO DP150O-REPORT-NUMBER.    04330070
043400     PERFORM 8000-READ-CHARGE-EXT-FILE THRU 8000-EXIT.            04340070
043500     IF NOT END-OF-PROCESSING                                     04350070
043600         PERFORM 7000-NEW-PAGE-PROCESSING THRU 7000-EXIT          04360070
043700         PERFORM 7820-PRINT-ERROR-HEADERS THRU 7820-EXIT          04370070
043800     ELSE                                                         04380070
043900*----EMPTY FILE NO DATA TO REPORT                                 04390070
044000         PERFORM 7000-NEW-PAGE-PROCESSING THRU 7000-EXIT          04400070
044100         PERFORM 7820-PRINT-ERROR-HEADERS THRU 7820-EXIT          04410070
044200         PERFORM 7810-PRINT-END-ERROR THRU 7810-EXIT              04420070
044300     END-IF.                                                      04430070
044400     SET FIRST-PASS                                               04440070
044500         NO-RECEIVER-DATA                                         04450070
044600         NO-NINREC-DATA   TO TRUE.                                04460070
044700                                                                  04470070
044800     INITIALIZE INVOICE-TABLE                                     04480070
044900                CLASS-TABLE                                       04490070
045000                RECV-SEQ-TABLE.                                   04500070
045100     MOVE ZERO TO NBR-ENTRY-MOVES                                 04510070
045200                  CLASS-NBR-PROC                                  04520070
045300                  RECV-SEQ-NBR-PROC.                              04530070
045400                                                                  04540070
045500 1000-EXIT.                                                       04550070
045600     EXIT.                                                        04560070
045700     EJECT                                                        04570070
045800 2000-DETAIL-PROCESSING.                                          04580070
045900     MOVE '2000-DETAIL-PROCESSING       ' TO PW-CURRENT-PARAGRAPH.04590070
046000*                                                                 04600070
046100     IF VENDOR-RECORD                                             04610070
046200         IF AP267-PO-NBR = PW-PREV-PO-NBR                         04620070
046300             MOVE PW-MULTIPLE-VENDORS TO ED-ERROR-MESSAGE         04630070
046400             PERFORM 7800-PRINT-ERRORS THRU 7800-EXIT             04640070
046500         ELSE                                                     04650070
046600             IF PW-PREV-VENDOR                                    04660070
046700                 MOVE PW-NO-INVC-OR-RECEIVERS TO ED-ERROR-MESSAGE 04670070
046800                 PERFORM 7800-PRINT-ERRORS THRU 7800-EXIT         04680070
046900                 MOVE '*****' TO PRINT-CART-CNT-ALPHA             04690070
047000             END-IF                                               04700070
047100         END-IF                                                   04710070
047200     END-IF.                                                      04720070
047300                                                                  04730070
047400     IF INVOICE-RECORD                                            04740070
047500         IF AP267-PO-NBR NOT EQUAL          PW-PREV-PO-NBR        04750070
047600             MOVE PW-NO-VENDOR TO ED-ERROR-MESSAGE                04760070
047700             PERFORM 7800-PRINT-ERRORS THRU 7800-EXIT             04770070
047800         END-IF                                                   04780070
047900     END-IF.                                                      04790070
048000                                                                  04800070
048100     IF RECEIVER-RECORD                                           04810070
048200         IF AP267-PO-NBR NOT EQUAL          PW-PREV-PO-NBR        04820070
048300             MOVE PW-NO-VEND-RECV TO ED-ERROR-MESSAGE             04830070
048400             PERFORM 7800-PRINT-ERRORS THRU 7800-EXIT             04840070
048500             MOVE '*****' TO PRINT-CART-CNT-ALPHA                 04850070
048600         ELSE                                                     04860070
048700             IF PW-PREV-VENDOR                                    04870070
048800                 MOVE PW-NO-INVOICE TO ED-ERROR-MESSAGE           04880070
048900                 PERFORM 7800-PRINT-ERRORS THRU 7800-EXIT         04890070
049000                 MOVE '*****' TO PRINT-CART-CNT-ALPHA             04900070
049100             END-IF                                               04910070
049200         END-IF                                                   04920070
049300     END-IF.                                                      04930070
049400                                                                  04940070
049500     IF VENDOR-RECORD                                             04950070
049600         IF NOT-FIRST-PASS                                        04960070
049700             MOVE ZERO TO CLASS-NBR-PROC                          04970070
049800                          RECV-SEQ-NBR-PROC                       04980070
049900                          INV-TBL-SUB                             04990070
050000             PERFORM 3000-CREATE-DETAIL-RPT THRU 3000-EXIT        05000070
050100         END-IF                                                   05010070
050200         SET NOT-FIRST-PASS TO TRUE                               05020070
050300         MOVE AP267-PO-NBR          TO PW-SAVE-PO-NBR             05030070
050400                                       PW-PREV-PO-NBR             05040070
050500                                       PRINT-PO-NBR               05050070
050600         MOVE AP267-RECORD-TYPE     TO PW-PREV-RECORD-TYPE        05060070
050700         MOVE AP267-VENDOR-NAME TO PW-SAVE-VENDOR-NAME            05070070
050800                                    PRINT-VENDOR-NAME             05080070
050900         MOVE AP267-VENDOR-NUMBER TO PW-SAVE-VENDOR-NUMBER        05090070
051000                                      PRINT-VENDOR-NUMBER         05100070
051100         MOVE AP267-DEPT-NUMBER TO PW-SAVE-DEPARTMENT-NUMBER      05110070
051200                                    PRINT-DEPARTMENT-NUMBER       05120070
051300         SET NEW-VENDOR TO TRUE                                   05130070
051400         MOVE ZERO TO INV-TBL-SUB                                 05140070
051500                      PW-SAVE-CARTON-COUNT                        05150070
051600     ELSE                                                         05160070
051700         IF INVOICE-RECORD                                        05170070
051800             ADD 1 TO INV-TBL-SUB                                 05180070
051900             IF INV-TBL-SUB IS GREATER THAN 2000                  05190070
052000                 MOVE PW-CURRENT-PARAGRAPH  TO                    05200070
052100                      WS-ABEND-PARAGRAPH                          05210070
052200                 MOVE 'EXCEEDED INVOICE TBL LIMIT ' TO            05220070
052300                      WS-ABEND-OPERATION                          05230070
052400                 SET TABLE-ERROR TO TRUE                          05240070
052500                 PERFORM 9999-ABEND                               05250070
052600             END-IF                                               05260070
052700             MOVE AP267-RECORD-TYPE     TO PW-PREV-RECORD-TYPE    05270070
052800             MOVE AP267-INVOICE-NUMBER TO                         05280070
052900                  INVTBL-INVOICE-NUMBER (INV-TBL-SUB)             05290070
053000             MOVE AP267-INVC-MONTH TO                             05300070
053100                  INVTBL-INVC-MONTH (INV-TBL-SUB)                 05310070
053200             MOVE AP267-INVC-DAY    TO                            05320070
053300                  INVTBL-INVC-DAY (INV-TBL-SUB)                   05330070
053400             MOVE AP267-INVC-YEAR   TO                            05340070
053500                  INVTBL-INVC-YEAR (INV-TBL-SUB)                  05350070
053600             MOVE AP267-STORE-NUMBER TO                           05360070
053700                  INVTBL-STORE-NUMBER (INV-TBL-SUB)               05370070
053800             MOVE AP267-CHARGE-CODE   TO                          05380070
053900                  INVTBL-CHARGE-CODE  (INV-TBL-SUB)               05390070
054000             MOVE AP267-CHARGE-AMT    TO                          05400070
054100                  INVTBL-CHARGE-AMT (INV-TBL-SUB)                 05410070
054200             MOVE AP267-DC-NBR        TO                          05420070
054300                  INVTBL-DC-NBR (INV-TBL-SUB)                     05430070
054400             MOVE AP267-MTCH-LVL-CDE  TO                          05440070
054500                  INVTBL-MTCH-LVL-CDE (INV-TBL-SUB)               05450070
054600         ELSE                                                     05460070
054700*        RECEIVER RECORD                                          05470070
054800             MOVE AP267-RECORD-TYPE     TO PW-PREV-RECORD-TYPE    05480070
054900             PERFORM 2300-ADD-RECV-TO-TBL THRU 2300-EXIT          05490070
055000             PERFORM 2500-ADD-CLASS-TO-TBL THRU 2500-EXIT         05500070
055100                     VARYING CL-IDX FROM 1 BY 1                   05510070
055200                     UNTIL CL-IDX GREATER THAN 99 OR              05520070
055300                           AP267-RECVR-CLASS (CL-IDX) EQUAL ZERO  05530070
055400         END-IF                                                   05540070
055500     END-IF.                                                      05550070
055600                                                                  05560070
055700     PERFORM 8000-READ-CHARGE-EXT-FILE THRU 8000-EXIT.            05570070
055800                                                                  05580070
055900 2000-EXIT.                                                       05590070
056000     EXIT.                                                        05600070
056100     EJECT                                                        05610070
056200 2300-ADD-RECV-TO-TBL.                                            05620070
056300*----SEARCH TABLE TO VERIFY NOT DUPLICATE.                        05630070
056400     SET NOT-DUPLICATE-RECV                                       05640070
056500         NOT-END-OF-SEARCH  TO TRUE.                              05650070
056600     MOVE AP267-RECVR-SEQ-NO TO RECV-SEQ-NBR-TRUNC.               05660070
056700     PERFORM 2400-SEARCH-RECV-TBL THRU 2400-EXIT                  05670070
056800         VARYING SEARCH-SUB FROM 1 BY 1                           05680070
056900         UNTIL SEARCH-SUB GREATER THAN 1000 OR                    05690070
057000               END-OF-SEARCH.                                     05700070
057100                                                                  05710070
057200     IF DUPLICATE-RECV                                            05720070
057300         NEXT SENTENCE                                            05730070
057400     ELSE                                                         05740070
057500         ADD 1 TO RECV-SEQ-SUB                                    05750070
057600         IF RECV-SEQ-SUB IS GREATER THAN 2000                     05760070
057700             MOVE PW-CURRENT-PARAGRAPH  TO WS-ABEND-PARAGRAPH     05770070
057800             MOVE 'EXCEEDED RECV SEQ TBL LIMIT' TO                05780070
057900                      WS-ABEND-OPERATION                          05790070
058000             SET TABLE-ERROR TO TRUE                              05800070
058100             PERFORM 9999-ABEND                                   05810070
058200         ELSE                                                     05820070
058300           IF RECV-SEQ-NBR-1-4 = 9999                             05830070
058400               MOVE ' NR ' TO RECV-SEQ-TBL-ENTRY-R (RECV-SEQ-SUB) 05840070
058500               MOVE AP267-RECVR-CARTONS TO PW-NINREC-CARTONS      05850070
058600               SET NINREC-DATA TO TRUE                            05860070
058700           ELSE                                                   05870070
058800               MOVE RECV-SEQ-NBR-1-4 TO                           05880070
058900                            RECV-SEQ-TBL-ENTRY (RECV-SEQ-SUB)     05890070
059000               ADD AP267-RECVR-CARTONS TO PW-SAVE-CARTON-COUNT    05900070
059100               SET RECEIVER-DATA        TO TRUE.                  05910070
059200 2300-EXIT.                                                       05920070
059300     EXIT.                                                        05930070
059400     SKIP3                                                        05940070
059500 2400-SEARCH-RECV-TBL.                                            05950070
059600                                                                  05960070
059700     IF RECV-SEQ-TBL-ENTRY (SEARCH-SUB) EQUAL ZERO                05970070
059800         SET END-OF-SEARCH TO TRUE                                05980070
059900         GO TO 2400-EXIT.                                         05990070
060000                                                                  06000070
060100     IF RECV-SEQ-NBR-1-4 EQUAL RECV-SEQ-TBL-ENTRY (SEARCH-SUB)    06010070
060200         SET END-OF-SEARCH                                        06020070
060300             DUPLICATE-RECV TO TRUE.                              06030070
060400                                                                  06040070
060500 2400-EXIT.                                                       06050070
060600     EXIT.                                                        06060070
060700     EJECT                                                        06070070
060800 2500-ADD-CLASS-TO-TBL.                                           06080070
060900                                                                  06090070
061000*----SEARCH TABLE TO VERIFY NOT DUPLICATE.                        06100070
061100     SET NOT-DUPLICATE-CLASS                                      06110070
061200         NOT-END-OF-SEARCH  TO TRUE.                              06120070
061300     MOVE AP267-RECVR-CLASS (CL-IDX) TO SEARCH-CLASS.             06130070
061400     PERFORM 2600-SEARCH-CLASS-TBL THRU 2600-EXIT                 06140070
061500             VARYING SEARCH-SUB FROM 1 BY 1                       06150070
061600             UNTIL SEARCH-SUB GREATER THAN 99 OR                  06160070
061700                   END-OF-SEARCH.                                 06170070
061800                                                                  06180070
061900     IF DUPLICATE-CLASS                                           06190070
062000         NEXT SENTENCE                                            06200070
062100     ELSE                                                         06210070
062200         ADD 1 TO CLASS-NBR                                       06220070
062300         IF CLASS-NBR IS GREATER THAN 99                          06230070
062400             MOVE PW-CURRENT-PARAGRAPH  TO                        06240070
062500                  WS-ABEND-PARAGRAPH                              06250070
062600             MOVE 'EXCEEDED CLASS TBL LIMIT   ' TO                06260070
062700                  WS-ABEND-OPERATION                              06270070
062800             SET TABLE-ERROR TO TRUE                              06280070
062900             PERFORM 9999-ABEND                                   06290070
063000         END-IF                                                   06300070
063100         MOVE AP267-RECVR-CLASS (CL-IDX) TO                       06310070
063200              CLASS-TABLE-ENTRY (CLASS-NBR)                       06320070
063300     END-IF.                                                      06330070
063400                                                                  06340070
063500 2500-EXIT.                                                       06350070
063600     EXIT.                                                        06360070
063700     EJECT                                                        06370070
063800 2600-SEARCH-CLASS-TBL.                                           06380070
063900                                                                  06390070
064000     IF CLASS-TABLE-ENTRY (SEARCH-SUB) EQUAL ZERO                 06400070
064100         SET END-OF-SEARCH TO TRUE                                06410070
064200         GO TO 2600-EXIT.                                         06420070
064300                                                                  06430070
064400     IF SEARCH-CLASS EQUAL CLASS-TABLE-ENTRY (SEARCH-SUB)         06440070
064500         SET END-OF-SEARCH                                        06450070
064600             DUPLICATE-CLASS TO TRUE.                             06460070
064700                                                                  06470070
064800 2600-EXIT.                                                       06480070
064900     EXIT.                                                        06490070
065000     EJECT                                                        06500070
065100 3000-CREATE-DETAIL-RPT.                                          06510070
065200                                                                  06520070
065300*----CREATE FULL DETAIL LINE INCLUDE VENDOR DATA, PO, CART CNT ETC06530070
065400     IF PRINT-CART-CNT-ALPHA EQUAL '*****'                        06540070
065500         MOVE '***' TO PRINT-CLASS-ENTRY (1)                      06550070
065600         MOVE '****' TO PRINT-RECV-SEQ-ENTRY (1)                  06560070
065700     ELSE                                                         06570070
065800* NINREC CARTON COUNT COMES FROM THE TOTAL OF THE INVOICE CARTON  06580070
065900* COUNTS.  IF THERE ARE BOTH NINRECS AND RECEIVERS AND BOTH CARTON06590070
066000* COUNTS ARE ADDED IN, THE CARTON COUNT TOTAL COULD BE DOUBLED    06600070
066100* SINCE THE RECEIVER CARTON COUNTS COME DIRECTLY FROM THE RECEIVER06610070
066200* ONLY USE THE CARTON COUNT FOR NINREC IF THERE ARE NO OTHER      06620070
066300* RECEIVERS.                                                      06630070
066400         IF NINREC-DATA AND NO-RECEIVER-DATA                      06640070
066500             MOVE PW-NINREC-CARTONS    TO PRINT-CARTON-COUNT      06650070
066600         ELSE                                                     06660070
066700             MOVE PW-SAVE-CARTON-COUNT TO PRINT-CARTON-COUNT      06670070
066800         END-IF                                                   06680070
066900     END-IF.                                                      06690070
067000                                                                  06700070
067100     PERFORM 3100-RPT-REST-OF-RECV THRU 3100-EXIT                 06710070
067200             UNTIL ALL-CLASS-TBL-PROC                             06720070
067300               AND ALL-RECVR-TBL-PROC                             06730070
067400               AND ALL-INVC-TBL-PROC.                             06740070
067500                                                                  06750070
067600     INITIALIZE INVOICE-TABLE                                     06760070
067700                CLASS-TABLE                                       06770070
067800                RECV-SEQ-TABLE.                                   06780070
067900     MOVE ZERO TO NBR-ENTRY-MOVES                                 06790070
068000                  CLASS-NBR-PROC                                  06800070
068100                  RECV-SEQ-NBR-PROC                               06810070
068200                  CLASS-NBR                                       06820070
068300                  RECV-SEQ-SUB.                                   06830070
068400     SET NO-RECEIVER-DATA                                         06840070
068500         NO-NINREC-DATA                                           06850070
068600         CLASS-TBL-NOT-PROC                                       06860070
068700         RECVR-TBL-NOT-PROC                                       06870070
068800         INVC-TBL-NOT-PROC  TO TRUE.                              06880070
068900                                                                  06890070
069000 3000-EXIT.                                                       06900070
069100     EXIT.                                                        06910070
069200     EJECT                                                        06920070
069300 3100-RPT-REST-OF-RECV.                                           06930070
069400                                                                  06940070
069500     IF ALL-CLASS-TBL-PROC                                        06950070
069600        AND ALL-RECVR-TBL-PROC                                    06960070
069700        AND ALL-INVC-TBL-PROC                                     06970070
069800         GO TO 3100-EXIT.                                         06980070
069900                                                                  06990070
070000     IF ALL-INVC-TBL-PROC                                         07000070
070100         NEXT SENTENCE                                            07010070
070200     ELSE                                                         07020070
070300         ADD 1 TO INV-TBL-SUB.                                    07030070
070400     IF INVTBL-INVOICE-NUMBER (INV-TBL-SUB) EQUAL ZERO            07040070
070500        OR INVTBL-INVOICE-NUMBER (INV-TBL-SUB) EQUAL SPACES       07050070
070600         SET ALL-INVC-TBL-PROC TO TRUE                            07060070
070700     ELSE                                                         07070070
070800         MOVE INVTBL-INVOICE-NUMBER (INV-TBL-SUB) TO              07080070
070900              PRINT-INVOICE-NUMBER                                07090070
071000         MOVE INVTBL-INVC-MONTH (INV-TBL-SUB) TO                  07100070
071100              PRINT-INVC-DTE-MM                                   07110070
071200         MOVE INVTBL-INVC-DAY (INV-TBL-SUB) TO                    07120070
071300              PRINT-INVC-DTE-DD                                   07130070
071400         MOVE INVTBL-INVC-YEAR (INV-TBL-SUB) TO                   07140070
071500              PRINT-INVC-DTE-YY                                   07150070
071600         MOVE '-' TO PRINT-DASH1                                  07160070
071700         MOVE '-' TO PRINT-DASH2                                  07170070
071800         MOVE INVTBL-STORE-NUMBER (INV-TBL-SUB) TO                07180070
071900             PRINT-STORE-NUMBER                                   07190070
072000         MOVE INVTBL-CHARGE-CODE  (INV-TBL-SUB) TO                07200070
072100             PRINT-CHARGE-CODE                                    07210070
072200         MOVE INVTBL-CHARGE-AMT (INV-TBL-SUB) TO                  07220070
072300              PRINT-CHARGE-AMT                                    07230070
072400         MOVE INVTBL-DC-NBR (INV-TBL-SUB) TO                      07240070
072410              PRINT-DC-NBR                                        07241070
072420         MOVE INVTBL-MTCH-LVL-CDE (INV-TBL-SUB) TO                07242070
072430              PRINT-MTCH-LVL-CDE                                  07243070
072440     END-IF.                                                      07244070
072450                                                                  07245070
072460     IF ALL-CLASS-TBL-PROC                                        07246070
072470        AND ALL-RECVR-TBL-PROC                                    07247070
072480        AND ALL-INVC-TBL-PROC                                     07248070
072490         GO TO 3100-EXIT.                                         07249070
072500                                                                  07250070
072600     MOVE ZERO TO NBR-ENTRY-MOVES.                                07260070
072700     PERFORM 3200-MOVE-ANY-CLASS-RECV-DATA THRU 3200-EXIT         07270070
072800             UNTIL NBR-ENTRY-MOVES EQUAL 3.                       07280070
072900     PERFORM 7100-PRINT-DETAIL-LINE THRU 7100-EXIT.               07290070
073000                                                                  07300070
073100 3100-EXIT.                                                       07310070
073200     EXIT.                                                        07320070
073300     EJECT                                                        07330070
073400 3200-MOVE-ANY-CLASS-RECV-DATA.                                   07340070
073500                                                                  07350070
073600     ADD 1 TO NBR-ENTRY-MOVES.                                    07360070
073700     IF ALL-CLASS-TBL-PROC                                        07370070
073800         NEXT SENTENCE                                            07380070
073900     ELSE                                                         07390070
074000         ADD 1 TO CLASS-NBR-PROC.                                 07400070
074100     IF ALL-RECVR-TBL-PROC                                        07410070
074200         NEXT SENTENCE                                            07420070
074300     ELSE                                                         07430070
074400         ADD 1 TO RECV-SEQ-NBR-PROC.                              07440070
074500                                                                  07450070
074600     IF PRINT-CLASS-ENTRY (NBR-ENTRY-MOVES) EQUAL '***'           07460070
074700         NEXT SENTENCE                                            07470070
074800     ELSE                                                         07480070
074900     IF ALL-CLASS-TBL-PROC                                        07490070
075000         MOVE SPACES TO PRINT-CLASS-ENTRY (NBR-ENTRY-MOVES)       07500070
075100     ELSE                                                         07510070
075200         IF CLASS-TABLE-ENTRY (CLASS-NBR-PROC) EQUAL ZERO OR      07520070
075300            CLASS-TABLE-ENTRY (CLASS-NBR-PROC) NOT NUMERIC        07530070
075400             MOVE SPACES TO PRINT-CLASS-ENTRY (NBR-ENTRY-MOVES)   07540070
075500         ELSE                                                     07550070
075600             MOVE CLASS-TABLE-ENTRY (CLASS-NBR-PROC) TO           07560070
075700                  PRINT-CLASS-ENTRY (NBR-ENTRY-MOVES).            07570070
075800     IF CLASS-NBR-PROC >= CLASS-NBR                               07580070
075900         SET ALL-CLASS-TBL-PROC TO TRUE.                          07590070
076000                                                                  07600070
076100     IF PRINT-RECV-SEQ-ENTRY (NBR-ENTRY-MOVES) EQUAL '****'       07610070
076200         NEXT SENTENCE                                            07620070
076300     ELSE                                                         07630070
076400     IF ALL-RECVR-TBL-PROC                                        07640070
076500         MOVE SPACES TO PRINT-RECV-SEQ-ENTRY (NBR-ENTRY-MOVES)    07650070
076600     ELSE                                                         07660070
076700     IF RECV-SEQ-TBL-ENTRY-R (RECV-SEQ-NBR-PROC) EQUAL ' NR '     07670070
076800         MOVE RECV-SEQ-TBL-ENTRY-R (RECV-SEQ-NBR-PROC) TO         07680070
076900              PRINT-RECV-SEQ-ENTRY (NBR-ENTRY-MOVES)              07690070
077000     ELSE                                                         07700070
077100     IF RECV-SEQ-TBL-ENTRY (RECV-SEQ-NBR-PROC) EQUAL ZERO OR      07710070
077200        RECV-SEQ-TBL-ENTRY (RECV-SEQ-NBR-PROC) NOT NUMERIC        07720070
077300         MOVE SPACES TO PRINT-RECV-SEQ-ENTRY (NBR-ENTRY-MOVES)    07730070
077400     ELSE                                                         07740070
077500         MOVE RECV-SEQ-TBL-ENTRY (RECV-SEQ-NBR-PROC) TO           07750070
077600              PRINT-RECV-SEQ-ENTRY (NBR-ENTRY-MOVES).             07760070
077700     IF RECV-SEQ-NBR-PROC >= RECV-SEQ-SUB                         07770070
077800         SET ALL-RECVR-TBL-PROC TO TRUE.                          07780070
077900                                                                  07790070
078000 3200-EXIT.                                                       07800070
078100     EXIT.                                                        07810070
078200     EJECT                                                        07820070
078300 7000-NEW-PAGE-PROCESSING.                                        07830070
078400     MOVE '7000-NEW-PAGE-PROCESSING     ' TO PW-CURRENT-PARAGRAPH.07840070
078500*                                                                 07850070
078600     ADD 1                            TO PW-PAGE-COUNT.           07860070
078700     MOVE PW-PAGE-COUNT               TO DP150O-PAGE-NUMBER.      07870070
078800     MOVE 1 TO DP150O-REPORT-NUMBER                               07880070
078900     WRITE PRINT-RECORD                                           07890070
079000           FROM  DP150O-STANDRD-HEADER-150-COLS                   07900070
079100           AFTER ADVANCING PAGE.                                  07910070
079200     WRITE PRINT-RECORD                                           07920070
079300           FROM HDR-LINE-2                                        07930070
079400           AFTER ADVANCING 2 LINE.                                07940070
079500     WRITE PRINT-RECORD                                           07950070
079600           FROM RPT-LINE-1                                        07960070
079700           AFTER ADVANCING 2 LINES.                               07970070
079800     WRITE PRINT-RECORD                                           07980070
079900           FROM RPT-LINE-2                                        07990070
080000           AFTER ADVANCING 1 LINES.                               08000070
080100     INITIALIZE PRINT-RECORD.                                     08010070
080200     MOVE 7                           TO PW-LINE-COUNT.           08020070
080300*                                                                 08030070
080400 7000-EXIT.                                                       08040070
080500     EXIT.                                                        08050070
080600     EJECT                                                        08060070
080700 7100-PRINT-DETAIL-LINE.                                          08070070
080800     MOVE '7100-PRINT-DETAIL-LINE       ' TO PW-CURRENT-PARAGRAPH.08080070
080900*                                                                 08090070
081000     ADD 2                            TO PW-LINE-COUNT.           08100070
081100     IF PW-LINE-COUNT >= PW-MAX-LINES                             08110070
081200         PERFORM 7300-PRINT-MANUAL-NOTE THRU 7300-EXIT            08120070
081300         PERFORM 7000-NEW-PAGE-PROCESSING THRU 7000-EXIT          08130070
081400         ADD 2                        TO PW-LINE-COUNT            08140070
081500     END-IF.                                                      08150070
081600                                                                  08160070
081700     MOVE PRINT-LINE                  TO PRINT-RECORD.            08170070
081800     IF INV-TBL-SUB EQUAL 1                                       08180070
081900         WRITE PRINT-RECORD AFTER ADVANCING 2 LINE                08190070
082000     ELSE                                                         08200070
082100         WRITE PRINT-RECORD AFTER ADVANCING 1 LINE.               08210070
082200     INITIALIZE PRINT-LINE.                                       08220070
082300 7100-EXIT.                                                       08230070
082400     EXIT.                                                        08240070
082500     EJECT                                                        08250070
082600 7300-PRINT-MANUAL-NOTE.                                          08260070
082700     MOVE '7300-PRINT-MANUAL-NOTE       ' TO PW-CURRENT-PARAGRAPH.08270070
082800*                                                                 08280070
082900     MOVE MANUAL-NOTE                 TO PRINT-RECORD.            08290070
083000     COMPUTE PW-ADVANCE-COUNT = PW-MAX-LINES - PW-LINE-COUNT.     08300070
083100     WRITE PRINT-RECORD AFTER ADVANCING PW-ADVANCE-COUNT LINES.   08310070
083200 7300-EXIT.                                                       08320070
083300     EXIT.                                                        08330070
083400     EJECT                                                        08340070
083500 7800-PRINT-ERRORS.                                               08350070
083600                                                                  08360070
083700     MOVE '7800-PRINT-ERRORS' TO PW-CURRENT-PARAGRAPH.            08370070
083800                                                                  08380070
083900     ADD 1  TO PW-ERROR-LINE-COUNT.                               08390070
084000     IF PW-ERROR-LINE-COUNT >= PW-MAX-LINES                       08400070
084100         PERFORM 7820-PRINT-ERROR-HEADERS THRU 7820-EXIT          08410070
084200         ADD 1  TO PW-ERROR-LINE-COUNT                            08420070
084300     END-IF.                                                      08430070
084400                                                                  08440070
084500     MOVE PW-SAVE-PO-NBR TO ED-PO-NBR.                            08450070
084600     MOVE PW-SAVE-VENDOR-NAME    TO ED-VENDOR-NAME.               08460070
084700     MOVE PW-SAVE-VENDOR-NUMBER  TO ED-VENDOR-NUMBER.             08470070
084800     MOVE PW-SAVE-INVOICE-NUMBER TO ED-INVOICE-NUMBER.            08480070
084900     MOVE INVTBL-INVOICE-NUMBER (INV-TBL-SUB) TO                  08490070
085000          ED-INVOICE-NUMBER.                                      08500070
085100                                                                  08510070
085200     WRITE ERROR-REC FROM ED-ERROR-DETAIL AFTER 1.                08520070
085300                                                                  08530070
085400     INITIALIZE ERROR-REC.                                        08540070
085500     ADD 1  TO PW-ERROR-COUNT.                                    08550070
085600 7800-EXIT.                                                       08560070
085700     EXIT.                                                        08570070
085800     EJECT                                                        08580070
085900 7810-PRINT-END-ERROR.                                            08590070
086000                                                                  08600070
086100     MOVE '7810-PRINT-END-ERROR' TO PW-CURRENT-PARAGRAPH.         08610070
086200                                                                  08620070
086300     ADD 2  TO PW-ERROR-LINE-COUNT.                               08630070
086400     IF PW-ERROR-LINE-COUNT >= PW-MAX-LINES                       08640070
086500         PERFORM 7820-PRINT-ERROR-HEADERS THRU 7820-EXIT          08650070
086600     END-IF.                                                      08660070
086700                                                                  08670070
086800     WRITE ERROR-REC FROM EOR-END-OF-REPORT AFTER 2.              08680070
086900 7810-EXIT.                                                       08690070
087000     EXIT.                                                        08700070
087100     EJECT                                                        08710070
087200 7820-PRINT-ERROR-HEADERS.                                        08720070
087300                                                                  08730070
087400     MOVE '7820-PRINT-ERROR-HEADERS'  TO PW-CURRENT-PARAGRAPH.    08740070
087500                                                                  08750070
087600     ADD 1                            TO PW-ERROR-PAGE-COUNT.     08760070
087700     MOVE PW-ERROR-PAGE-COUNT         TO DP150O-PAGE-NUMBER.      08770070
087800     MOVE DP150O-REPORT-NUMBER        TO PW-SAVE-REPORT-NUMBER.   08780070
087900     MOVE 2                           TO DP150O-REPORT-NUMBER.    08790070
088000                                                                  08800070
088100     WRITE ERROR-REC                                              08810070
088200           FROM DP150O-STANDRD-HEADER-150-COLS AFTER PAGE.        08820070
088300     WRITE ERROR-REC FROM HDR-LINE-2 AFTER 1.                     08830070
088400     WRITE ERROR-REC FROM H3-HEADER3 AFTER 1.                     08840070
088500     WRITE ERROR-REC FROM EH-ERROR-HEADER AFTER 2.                08850070
088600                                                                  08860070
088700     MOVE PW-SAVE-REPORT-NUMBER TO DP150O-REPORT-NUMBER.          08870070
088800     INITIALIZE ERROR-REC.                                        08880070
088900     WRITE ERROR-REC AFTER 1.                                     08890070
089000                                                                  08900070
089100     MOVE 6                           TO PW-ERROR-LINE-COUNT.     08910070
089200 7820-EXIT.                                                       08920070
089300     EXIT.                                                        08930070
089400     EJECT                                                        08940070
089500 8000-READ-CHARGE-EXT-FILE.                                       08950070
089600     MOVE '8000-READ-CHARGE-EXT-FILE   ' TO PW-CURRENT-PARAGRAPH  08960070
089700*                                                                 08970070
089800     READ CHARGE-EXT-FILE                                         08980070
089900          INTO AP267-INPUT-RECORD                                 08990070
090000          AT END SET END-OF-PROCESSING TO TRUE.                   09000070
090100     IF NOT END-OF-PROCESSING                                     09010070
090200         ADD 1 TO PW-INPUT-COUNT.                                 09020070
090300*                                                                 09030070
090400 8000-EXIT.                                                       09040070
090500     EXIT.                                                        09050070
090600     EJECT                                                        09060070
090700 9900-END-OF-INPUT.                                               09070070
090800     MOVE '9900-END-OF-INPUT            ' TO PW-CURRENT-PARAGRAPH.09080070
090900                                                                  09090070
091000*----WRITE DETAIL RECORDS FOR LAST PURCHASE ORDER. INCLUDING ALL  09100070
091100*----VENDOR/INVOICE/RECEIVER DATA                                 09110070
091200     IF NO-RECEIVER-DATA                                          09120070
091300         MOVE '*****' TO PRINT-CART-CNT-ALPHA.                    09130070
091400                                                                  09140070
091500     MOVE ZERO TO CLASS-NBR-PROC                                  09150070
091600                  RECV-SEQ-NBR-PROC.                              09160070
091700         MOVE ZERO TO INV-TBL-SUB.                                09170070
091800     PERFORM 3000-CREATE-DETAIL-RPT THRU 3000-EXIT.               09180070
091900                                                                  09190070
092000     COMPUTE PW-ERROR-THRESH ROUNDED =                            09200070
092100         PW-INPUT-COUNT * PW-ERROR-PERCENT.                       09210070
092200******************************************************************09220070
092300     DISPLAY '** APKRP054 SUMMARY **'.                            09230070
092400     MOVE PW-INPUT-COUNT TO PW-DISPLAY-COUNT.                     09240070
092500     DISPLAY '** INPUT COUNT - ' PW-DISPLAY-COUNT.                09250070
092600     MOVE PW-ERROR-COUNT TO PW-DISPLAY-COUNT.                     09260070
092700     DISPLAY '** ERROR COUNT - ' PW-DISPLAY-COUNT.                09270070
092800     MOVE PW-ERROR-THRESH TO PW-DISPLAY-COUNT.                    09280070
092900     DISPLAY '** THRSH COUNT - ' PW-DISPLAY-COUNT.                09290070
093000                                                                  09300070
093100     PERFORM 7810-PRINT-END-ERROR THRU 7810-EXIT.                 09310070
093200     PERFORM 7300-PRINT-MANUAL-NOTE THRU 7300-EXIT.               09320070
093300                                                                  09330070
093400     CLOSE CHARGE-EXT-FILE                                        09340070
093500           PRINT-FILE                                             09350070
093600           ERROR-FILE.                                            09360070
093700 9900-EXIT.                                                       09370070
093800     EXIT.                                                        09380070
093900                                                                  09390070
094000***************************************************************** 09400070
094100*    ABEND ROUTINE                                               *09410070
094200***************************************************************** 09420070
094300 9999-ABEND.                                                      09430070
094400                                                                  09440070
094500     MOVE '9999-ABEND' TO PW-CURRENT-PARAGRAPH.                   09450070
094600                                                                  09460070
094700     DISPLAY '*** PROGRAM   = ' WS-ABEND-PROGRAM.                 09470070
094800     DISPLAY '*** PARAGRAPH = ' WS-ABEND-PARAGRAPH.               09480070
094900     DISPLAY '*** OPERATION = ' WS-ABEND-OPERATION.               09490070
095000     CALL 'ILBOABN0' USING WS-ABEND-CODE.                         09500070
095100                                                                  09510070
