000100***************************************************************** 00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300***************************************************************** 00030000
000400                                                                  00040000
000500 PROGRAM-ID.             RCKUP062.                                00050000
000600 AUTHOR.                 DENISE HAHN.                             00060000
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070000
000800 DATE-WRITTEN            03-07-16.                                00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100***************************************************************** 00110000
001200* ASN - CARRIER CARTON TRACKING                                 * 00120008
001300*                                                               * 00130000
001400*  THIS PROGRAM WILL READ AN EXTRACT FILE THAT CONTAINS THE     * 00140000
001500*  ASN CARTON NBR, CARRIER TRACKING NUMBER, PROCESS TIMESTAMP.  * 00150008
001501*  THE EXTRACT FILE IS CREATED BY SUKUP010 (SUK000 & SUK010).   * 00150100
001502*  FORMAT:  RCRD093                                             * 00150200
001510*  PROGRAM WILL CHECK IF THE ASN CARTON NUMBER HAS BEEN ENTERED * 00151000
001520*  INTO THE INBOUND CARTON DATABASE (TSHPUNT), IT IT HAS THE    * 00152000
001530*  CARRIER TRACKING NUMBER WILL BE INSERTED INTO THE DATABASE.  * 00153008
001540*  IF IT HAS NOT, THE THE RECORD WILL BE WRITTEN TO A WRAP FILE * 00154000
001600*  AND WILL BE PROCESSED THE NEXT TIME.                         * 00160000
001700***************************************************************** 00170000
001800*                                                               * 00180000
003330***************************************************************** 00333000
003340 ENVIRONMENT DIVISION.                                            00334000
003350***************************************************************** 00335000
003360                                                                  00336000
003370 CONFIGURATION SECTION.                                           00337000
003380                                                                  00338000
003390 SOURCE-COMPUTER.        IBM-3090.                                00339000
003400 OBJECT-COMPUTER.        IBM-3090.                                00340000
003500                                                                  00350000
003600 INPUT-OUTPUT SECTION.                                            00360000
003700                                                                  00370000
003800 FILE-CONTROL.                                                    00380000
003900                                                                  00390000
004000     SELECT ASN-CARR-TRACKING                                     00400008
004100         ASSIGN TO INP01                                          00410000
004200     FILE STATUS IS F-STAT.                                       00420000
004210                                                                  00421000
004900     SELECT ASN-CARR-TRACKING-BACKUP                              00490008
005000         ASSIGN TO OUT01.                                         00500000
006100                                                                  00610000
006110     SELECT ASN-CARR-TRACKING-WRAP                                00611009
006120         ASSIGN TO OUT02.                                         00612009
006130                                                                  00613009
006200******************************************************************00620000
006300 DATA DIVISION.                                                   00630000
006400******************************************************************00640000
006500                                                                  00650000
006600 FILE SECTION.                                                    00660000
006700                                                                  00670000
006710 FD  ASN-CARR-TRACKING                                            00671008
006720     RECORDING MODE F                                             00672000
006740     LABEL RECORDS ARE STANDARD                                   00674000
006750     BLOCK CONTAINS 0 RECORDS.                                    00675004
006770 01  ASN-CARR-TRACK-REC                   PIC X(150).             00677008
006771                                                                  00677100
006772 FD  ASN-CARR-TRACKING-BACKUP                                     00677208
006773     RECORDING MODE F                                             00677300
006774     LABEL RECORDS ARE STANDARD                                   00677400
006775     BLOCK CONTAINS 0 RECORDS.                                    00677504
006776 01  ASN-CARR-TRACK-BACKUP-REC            PIC X(150).             00677608
006780                                                                  00678000
006790 FD  ASN-CARR-TRACKING-WRAP                                       00679009
006800     RECORDING MODE F                                             00680009
006900     LABEL RECORDS ARE STANDARD                                   00690009
007000     BLOCK CONTAINS 0 RECORDS.                                    00700009
007100 01  ASN-CARR-TRACK-WRAP-REC              PIC X(150).             00710009
007200                                                                  00720009
011500                                                                  01150000
011600 WORKING-STORAGE SECTION.                                         01160000
011700                                                                  01170000
011800 01 F-STAT PIC 99.                                                01180000
012800                                                                  01280000
012900 01  PROGRAM-SWITCHES.                                            01290000
013000     05  PS-EOF-INPUT-SW             PIC  X(01) VALUE 'N'.        01300002
013100         88  PS-EOF-INPUT                       VALUE 'Y'.        01310002
013200         88  PS-EOF-INPUT-NO                    VALUE 'N'.        01320002
013300     05  PS-CARTON-ON-TSHPUNT-SW     PIC  X(01) VALUE 'N'.        01330002
013400         88  PS-CARTON-ON-TSHPUNT               VALUE 'Y'.        01340002
013500         88  PS-CARTON-ON-TSHPUNT-NO            VALUE 'N'.        01350002
013510     05  PS-ON-INBND-TRACK-SW        PIC  X(01) VALUE 'N'.        01351002
013520         88  PS-ON-INBND-TRACK-YES              VALUE 'Y'.        01352002
013530         88  PS-ON-INBND-TRACK-NO               VALUE 'N'.        01353002
013540     05  PS-VALID-CARTON-SW          PIC  X(01) VALUE 'N'.        01354004
013550         88  PS-VALID-CARTON-YES                VALUE 'Y'.        01355004
013560         88  PS-VALID-CARTON-NO                 VALUE 'N'.        01356004
013570     05  PS-ON-TRACK-STATUS-SW       PIC  X(01) VALUE 'N'.        01357004
013580         88  PS-ON-TRACK-STATUS-YES             VALUE 'Y'.        01358004
013590         88  PS-ON-TRACK-STATUS-NO              VALUE 'N'.        01359004
025000                                                                  02500002
025001                                                                  02500102
025010 01  PROGRAM-VARIABLES.                                           02501000
025024     05  PV-ASNCAR-NBR               PIC  X(45) VALUE SPACES.     02502402
025025     05  PV-ASNCAR-NBR-R REDEFINES PV-ASNCAR-NBR.                 02502504
025027         10  PV-ASNCAR-1-2           PIC  X(02).                  02502702
025028         10  PV-ASNCAR-3-20          PIC  X(18).                  02502802
025029         10  PV-ASNCAR-21-40         PIC  X(20).                  02502902
025030         10  FILLER                  PIC  X(05).                  02503002
025031     05  PV-ASNCAR-NBR-R2 REDEFINES PV-ASNCAR-NBR.                02503102
025032         10  FILLER                  PIC  X(02).                  02503202
025033         10  PV-ASNCAR-NUM           PIC  9(18).                  02503302
025034         10  FILLER                  PIC  X(20).                  02503402
025035         10  FILLER                  PIC  X(05).                  02503502
025036                                                                  02503602
025037     05  PV-INPUT-CNT                PIC  9(09) VALUE ZEROS.      02503704
025038     05  PV-OUTPUT-CNT               PIC  9(09) VALUE ZEROS.      02503804
025039     05  PV-FIRST-2-CNT              PIC  9(09) VALUE ZEROS.      02503904
025040     05  PV-NOT-NUMERIC-CNT          PIC  9(09) VALUE ZEROS.      02504004
025041     05  PV-NOT-BLANK-CNT            PIC  9(09) VALUE ZEROS.      02504104
025042     05  PV-VALID-CARTON-CNT         PIC  9(09) VALUE ZEROS.      02504204
025043     05  PV-NOT-ON-INBND-CNT         PIC  9(09) VALUE ZEROS.      02504304
025044     05  PV-ON-INBND-CNT             PIC  9(09) VALUE ZEROS.      02504404
025045*                                                                 02504504
025046     05  PV-INSERT-TRACK-CNT         PIC  9(09) VALUE ZEROS.      02504604
025047     05  PV-DUP-TRACK-CNT            PIC  9(09) VALUE ZEROS.      02504722
025048     05  PV-INSERT-STAT-CNT          PIC  9(09) VALUE ZEROS.      02504822
025049     05  PV-DUP-STAT-CNT             PIC  9(09) VALUE ZEROS.      02504922
025050     05  PV-INSERT-COMMIT-CNT        PIC  9(09) VALUE ZEROS.      02505022
025051     05  PV-COMMIT-QTY               PIC S9(09) VALUE +100.       02505122
025052     05  PV-COMMIT-CNT               PIC  9(09) VALUE ZEROS.      02505222
025053     05  PV-WRAP-PURGE-CNT           PIC  9(09) VALUE ZEROS.      02505322
025054     05  PV-WRAP-CNT                 PIC  9(09) VALUE ZEROS.      02505422
025055                                                                  02505522
025056     05  PV-DISP-INPUT               PIC  ZZZ,ZZZ,ZZ9.            02505622
025057     05  PV-DISP-OUTPUT              PIC  ZZZ,ZZZ,ZZ9.            02505722
025058     05  PV-DISP-FIRST-2             PIC  ZZZ,ZZZ,ZZ9.            02505822
025059     05  PV-DISP-NOT-NUMERIC         PIC  ZZZ,ZZZ,ZZ9.            02505922
025060     05  PV-DISP-NOT-BLANK           PIC  ZZZ,ZZZ,ZZ9.            02506022
025061     05  PV-DISP-VALID-CARTON        PIC  ZZZ,ZZZ,ZZ9.            02506122
025062     05  PV-DISP-NOT-ON-INBND        PIC  ZZZ,ZZZ,ZZ9.            02506222
025063     05  PV-DISP-ON-INBND            PIC  ZZZ,ZZZ,ZZ9.            02506322
025064     05  PV-DISP-INSERT-TRACK        PIC  ZZZ,ZZZ,ZZ9.            02506422
025065     05  PV-DISP-DUP-TRACK           PIC  ZZZ,ZZZ,ZZ9.            02506522
025066     05  PV-DISP-INSERT-STAT         PIC  ZZZ,ZZZ,ZZ9.            02506622
025067     05  PV-DISP-DUP-STAT            PIC  ZZZ,ZZZ,ZZ9.            02506722
025068     05  PV-DISP-INSERT-COMMIT       PIC  ZZZ,ZZZ,ZZ9.            02506822
025069     05  PV-DISP-COMMIT              PIC  ZZZ,ZZZ,ZZ9.            02506922
025070     05  PV-DISP-WRAP-PURGE          PIC  ZZZ,ZZZ,ZZ9.            02507022
025071     05  PV-DISP-WRAP                PIC  ZZZ,ZZZ,ZZ9.            02507122
025072                                                                  02507222
025073     05  PV-DISP-CARTON              PIC  9(18).                  02507322
025074     05  PV-DISP-SQLCODE             PIC -999.                    02507422
025075                                                                  02507522
025076     05  PV-ABEND-CODE               PIC S9(04) VALUE ZERO        02507622
025077                                                COMP SYNC.        02507722
025078     05  PV-ABEND-PARAGRAPH          PIC  X(35) VALUE SPACES.     02507822
025079     05  PV-DB2-OPERATION-ATTEMPTED  PIC  X(35) VALUE SPACES.     02507922
025080                                                                  02508022
025081     05  PV-TRACK-WRAP-PURGE-TMST    PIC  X(26) VALUE SPACES.     02508122
025082                                                                  02508222
025083 01  ABEND-CODE                       PIC S9(04)     VALUE +0     02508322
025084                                                     COMP SYNC.   02508422
025085     88  ABEND-4001-WRITE-ERROR                      VALUE +4001. 02508522
025086     88  ABEND-4002-READ-ERROR                       VALUE +4002. 02508622
025087     88  ABEND-4003-CTRL-CARD-ERROR                  VALUE +4003. 02508722
025088     88  ABEND-4004-TABLE-ERROR                      VALUE +4004. 02508822
025089     88  ABEND-4005-OPEN-ERROR                       VALUE +4005. 02508922
025090     88  ABEND-4006-CLOSE-ERROR                      VALUE +4006. 02509022
025091     88  ABEND-4007-SEQUENCE-ERROR                   VALUE +4007. 02509122
025092     88  ABEND-4008-DATS-ERROR                       VALUE +4008. 02509222
025093     88  ABEND-4009-KEY-DATS-ERROR                   VALUE +4009. 02509322
025094     88  ABEND-4013-DB2-ERROR                        VALUE +4013. 02509422
025095                                                                  02509522
025096                                                                  02509622
025097 01  PC-CONSTANTS.                                                02509722
025098     05  PC-00                       PIC  X(02) VALUE '00'.       02509822
025099     05  PC-Y                        PIC  X(01) VALUE 'Y'.        02509922
025100     05  PC-N                        PIC  X(01) VALUE 'N'.        02510022
025101     05  PC-PROGRAM-NAME             PIC  X(08) VALUE 'RCKUP062'. 02510122
025102     05  PC-NOTIFY                   PIC  X(03) VALUE 'NTF'.      02510222
025110                                                                  02511022
025200                                                                  02520022
134100******************************************************************13410000
134200*  INPUT FILE LAYOUT                                              13420002
134300******************************************************************13430000
134400     COPY RCRD093.                                                13440002
134500                                                                  13450002
134600******************************************************************13460004
134700* TRANSACTION PRESENTATION MODULE PARAMETERS                      13470004
134800******************************************************************13480004
134900     COPY DPLS001.                                                13490004
135000         05  WORK-STRG-AREA          PIC X(600).                  13500004
135100                                                                  13510004
139400****************************************************************  13940000
139500*  INBOUND CARTON DATABASE                                        13950000
139510****************************************************************  13951000
139600*                                                                 13960000
139700     EXEC SQL                                                     13970000
139800         INCLUDE TSHPUNT                                          13980000
139900     END-EXEC.                                                    13990000
140000                                                                  14000000
140100****************************************************************  14010002
140200*  INBOUND CARTON TRACKING TABLE - SUT_INBD_CART_TRKG             14020014
140300****************************************************************  14030002
140400                                                                  14040015
140500     EXEC SQL                                                     14050015
140600         INCLUDE SUT00116                                         14060015
140700     END-EXEC.                                                    14070015
140800                                                                  14080002
140900****************************************************************  14090002
141000*  CARTON TRACKING NUMBER STATUS TABLE - SUT_TRKG_NBR_HIST        14100014
141100****************************************************************  14110002
141200                                                                  14120015
141300     EXEC SQL                                                     14130015
141400         INCLUDE SUT00119                                         14140015
141500     END-EXEC.                                                    14150015
141600                                                                  14160002
141700****************************************************************  14170010
141800*  PARM TABLE                                                     14180010
141900****************************************************************  14190010
142000*                                                                 14200010
142100     EXEC SQL                                                     14210010
142200         INCLUDE TKRPRPM                                          14220010
142300     END-EXEC.                                                    14230010
142400                                                                  14240010
142500****************************************************************  14250010
161818*                                                                 16181800
161819****************************************************************  16181910
161820*  COMMUNICATIONS AREA FOR DB2                                    16182000
161821*                                                                 16182100
161830     EXEC SQL                                                     16183000
161840         INCLUDE SQLCA                                            16184000
161850     END-EXEC.                                                    16185000
161860                                                                  16186000
161870*                                                                 16187000
161880* DB2 COMMUNICATION AREA 2                                        16188000
161890*                                                                 16189000
161900     COPY SQLCA2.                                                 16190000
162000                                                                  16200000
168200                                                                  16820000
168300 EJECT                                                            16830000
168400***************************************************************** 16840000
168500* PROCEDURE DIVISION.                                           * 16850000
168600***************************************************************** 16860000
168700 PROCEDURE DIVISION.                                              16870000
168800                                                                  16880000
168900 0000-MAINLINE-PROCESSING.                                        16890000
169000                                                                  16900000
169100     PERFORM 1000-INITIALIZATION.                                 16910000
169200                                                                  16920000
169300     PERFORM 2000-PROCESS-EXTRACT-RECS                            16930000
169400       UNTIL PS-EOF-INPUT.                                        16940000
170200                                                                  17020000
170210     CLOSE  ASN-CARR-TRACKING                                     17021008
170220            ASN-CARR-TRACKING-BACKUP                              17022009
170230            ASN-CARR-TRACKING-WRAP.                               17023009
171900                                                                  17190000
172300     PERFORM 9900-GENERATE-STATISTICS.                            17230002
172400                                                                  17240002
172500     STOP RUN.                                                    17250000
172600                                                                  17260000
172700                                                                  17270000
172800******************************************************************17280000
172900** READ THE DB2 CONTROL TABLE AND READ THE FIRST ASN EXTRACT REC *17290000
173000******************************************************************17300000
173100 1000-INITIALIZATION.                                             17310000
173110                                                                  17311000
173210                                                                  17321000
173220     DISPLAY ' RCKUP062: CARRIER ASSIGNED PACKAGE ID TRACKING'    17322002
173310     DISPLAY ' '                                                  17331000
173320                                                                  17332000
173321     OPEN INPUT  ASN-CARR-TRACKING.                               17332108
173330     OPEN OUTPUT ASN-CARR-TRACKING-BACKUP                         17333009
173331                 ASN-CARR-TRACKING-WRAP.                          17333109
173340                                                                  17334000
173350     SET  PS-EOF-INPUT-NO                                         17335000
173380          PS-CARTON-ON-TSHPUNT-NO  TO TRUE                        17338000
173390                                                                  17339000
173400     PERFORM 1100-GET-WRAP-FILE-PURGE.                            17340010
173410                                                                  17341010
173500     PERFORM 7000-READ-INPUT.                                     17350000
181600                                                                  18160000
184600                                                                  18460000
184700***************************************************************** 18470010
184710* CHECK PARM TRKWRP FOR THE NUMBER OF DAYS TO LEAVE AN ENTRY ON * 18471010
184720* THE WRAP FILE                                                 * 18472010
184730***************************************************************** 18473010
184740 1100-GET-WRAP-FILE-PURGE.                                        18474010
184750                                                                  18475010
184760     MOVE '1100-GET-WRAP-FILE-PURGE' TO PV-ABEND-PARAGRAPH.       18476010
184770                                                                  18477010
184790                                                                  18479010
184791     EXEC SQL                                                     18479110
184792         SELECT  FUNC_QTY                                         18479212
184793              ,  CURRENT TIMESTAMP - FUNC_QTY DAYS                18479311
184794           INTO :KRPRPM-FUNC-QTY                                  18479411
184795              , :PV-TRACK-WRAP-PURGE-TMST                         18479511
184796          FROM  TKRPRPM                                           18479611
184797         WHERE  LOC_ID            =  90                           18479711
184798           AND  INTFC_SYS_CDE     = 'KHL'                         18479811
184799           AND  SYS_PRC_FUNC_CDE  = 'TRKWRP'                      18479911
184800           AND  FUNC_PRC_STAT_CDE = 'AC'                          18480011
184801           AND  FUNC_BEG_TMST    <=  CURRENT TIMESTAMP            18480111
184802           AND  FUNC_END_TMST    >=  CURRENT TIMESTAMP            18480211
184805          WITH UR                                                 18480511
184806     END-EXEC                                                     18480611
184807                                                                  18480711
184808     EVALUATE TRUE                                                18480811
184809         WHEN SQLCODE = +0                                        18480911
184810              DISPLAY 'WRAP PURGE TIMESTAMP:'                     18481011
184811                       PV-TRACK-WRAP-PURGE-TMST                   18481111
184813                                                                  18481311
184817         WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                  18481711
184819             MOVE SQLCODE                TO  PV-DISP-SQLCODE      18481911
184820             DISPLAY '**************************************'     18482011
184821             DISPLAY '*                                    *'     18482111
184822             DISPLAY PC-PROGRAM-NAME ' - '                        18482211
184823                     PV-ABEND-PARAGRAPH                           18482311
184826             DISPLAY 'SQLCODE:' PV-DISP-SQLCODE                   18482611
184827             DISPLAY '*                                    *'     18482711
184828             DISPLAY '**************************************'     18482811
184829             DISPLAY 'WARNING ISSUED ON SELECT OF TKRPRPM   '     18482911
184830             DISPLAY 'PARM:   TRKWRP  '                           18483011
184831             DISPLAY '**************************************'     18483111
184832             PERFORM 9800-SQL-ERROR                               18483211
184833                                                                  18483311
184834         WHEN SQLCODE < ZERO                                      18483411
184836             MOVE SQLCODE                TO  PV-DISP-SQLCODE      18483611
184837             DISPLAY '**************************************'     18483711
184838             DISPLAY '*                                    *'     18483811
184839             DISPLAY PC-PROGRAM-NAME ' - '                        18483911
184840                     PV-ABEND-PARAGRAPH                           18484011
184843             DISPLAY 'SQLCODE:' PV-DISP-SQLCODE                   18484311
184844             DISPLAY '*                                    *'     18484411
184845             DISPLAY '**************************************'     18484511
184846             DISPLAY 'ERROR ISSUED ON SELECT OF TKRPRPM     '     18484611
184847             DISPLAY 'PARM:   TRKWRP'                             18484711
184848             DISPLAY '**************************************'     18484811
184849             PERFORM 9800-SQL-ERROR                               18484911
184850                                                                  18485011
184851     END-EVALUATE.                                                18485111
184852                                                                  18485211
184853                                                                  18485311
184854******************************************************************18485411
184855*  PROCESS THE CARRIER TRACKING EXTRACT FILE                     *18485511
184856*                                                                *18485611
184857******************************************************************18485711
184858 2000-PROCESS-EXTRACT-RECS.                                       18485811
184859                                                                  18485911
184860     SET  PS-CARTON-ON-TSHPUNT-NO                                 18486011
184861          PS-VALID-CARTON-NO                                      18486111
184862          PS-ON-INBND-TRACK-NO                                    18486211
184870          PS-ON-TRACK-STATUS-NO    TO TRUE.                       18487011
184900                                                                  18490001
188400     PERFORM 3000-VALIDATE-CARTON-NBR.                            18840002
188410                                                                  18841001
188500     IF  PS-VALID-CARTON-YES                                      18850004
188600         PERFORM 3010-CHECK-TSHPUNT                               18860002
188700     END-IF.                                                      18870001
188800                                                                  18880000
189400     IF  PS-CARTON-ON-TSHPUNT  AND                                18940001
189410         PS-VALID-CARTON-YES                                      18941004
189500         PERFORM 3020-WRITE-TRACKING                              18950002
189600     ELSE                                                         18960011
189700         PERFORM 3050-WRAP-FILE                                   18970011
190200     END-IF.                                                      19020000
190300                                                                  19030000
190301     PERFORM 8000-WRITE-OUTPUT.                                   19030111
190302                                                                  19030202
190310     PERFORM 7000-READ-INPUT.                                     19031000
193100                                                                  19310000
193200                                                                  19320000
193300******************************************************************19330002
193310** CHECK TO MAKE SURE VALID CARTON NUMBER                        *19331002
193320******************************************************************19332002
193330 3000-VALIDATE-CARTON-NBR.                                        19333002
193340                                                                  19334002
193350     MOVE RC093-ASNCAR-NBR  TO PV-ASNCAR-NBR                      19335004
193370                                                                  19337002
193380     IF  PV-ASNCAR-1-2  NOT = PC-00                               19338002
193390         ADD  1  TO  PV-FIRST-2-CNT                               19339004
193391         SET PS-VALID-CARTON-NO                                   19339102
193392             RC093-CARTON-01-02-NOT-00    TO TRUE                 19339202
193394     ELSE                                                         19339402
193395         IF  PV-ASNCAR-3-20 IS NOT NUMERIC                        19339502
193396             ADD  1  TO  PV-NOT-NUMERIC-CNT                       19339602
193397             SET PS-VALID-CARTON-NO                               19339702
193398                 RC093-CARTON-NOT-NUMERIC TO TRUE                 19339802
193400         ELSE                                                     19340002
193401             IF PV-ASNCAR-21-40 > SPACES                          19340102
193402                 ADD  1  TO  PV-NOT-BLANK-CNT                     19340202
193403                 SET PS-VALID-CARTON-NO                           19340302
193404                     RC093-CARTON-21-40-NOT-BLANK TO TRUE         19340402
193406             ELSE                                                 19340602
193407                 IF  RC093-CARR-TRACKING-NBR  >  SPACES           19340708
193408                     SET PS-VALID-CARTON-YES TO TRUE              19340804
193409                     ADD  1  TO  PV-VALID-CARTON-CNT              19340902
193410                 ELSE                                             19341002
193411                     SET RC093-CARTON-TRACKING-BLANK TO TRUE      19341102
193412                 END-IF                                           19341202
193413             END-IF                                               19341302
193414         END-IF                                                   19341402
193415     END-IF.                                                      19341502
193416                                                                  19341602
193417                                                                  19341702
193420******************************************************************19342000
193500** CHECK IF THE ASN CARTON IS ON INBOUND CARTON DATABASE TSHPUNT *19350000
193600******************************************************************19360000
193610 3010-CHECK-TSHPUNT.                                              19361002
193620                                                                  19362002
193630     MOVE '3010-CHECK-TSHPUNT' TO PV-ABEND-PARAGRAPH.             19363002
193640                                                                  19364002
193650     MOVE PV-ASNCAR-NUM        TO SHPUNT-SHIPT-UNT-ID             19365002
193693                                                                  19369302
193694     EXEC SQL                                                     19369402
193695         SELECT  ACTV_IND                                         19369502
193696           INTO :SHPUNT-ACTV-IND                                  19369602
193697          FROM  TSHPUNT                                           19369702
193698         WHERE  SHIPT_UNT_ID = :SHPUNT-SHIPT-UNT-ID               19369802
193699          WITH UR                                                 19369902
193700     END-EXEC                                                     19370002
193701                                                                  19370102
193710     EVALUATE TRUE                                                19371002
193720         WHEN SQLCODE = +0                                        19372002
193721              ADD  1  TO  PV-ON-INBND-CNT                         19372102
193722              SET  PS-CARTON-ON-TSHPUNT   TO  TRUE                19372221
193725                                                                  19372502
193730         WHEN SQLCODE = +100                                      19373002
193731              ADD  1  TO  PV-NOT-ON-INBND-CNT                     19373102
193740              SET PS-VALID-CARTON-NO                              19374002
193741                  RC093-CARTON-NO-INBOUND      TO TRUE            19374102
193770                                                                  19377002
193780         WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                  19378002
193781             MOVE SHPUNT-SHIPT-UNT-ID  TO  PV-DISP-CARTON         19378105
193782             MOVE SQLCODE              TO  PV-DISP-SQLCODE        19378205
193783             DISPLAY '**************************************'     19378305
193784             DISPLAY '*                                    *'     19378405
193786             DISPLAY PC-PROGRAM-NAME ' - '                        19378606
193787                     PV-ABEND-PARAGRAPH                           19378705
193788             DISPLAY 'CARTON: ' PV-DISP-CARTON                    19378805
193789             DISPLAY 'SQLCODE:' PV-DISP-SQLCODE                   19378905
193790             DISPLAY '*                                    *'     19379005
193792             DISPLAY '**************************************'     19379205
193793             DISPLAY 'WARNING ISSUED ON SELECT OF TSHPUNT   '     19379305
193794             DISPLAY 'INPUT:' RC093-CARR-SSCC-TRACK-REC           19379407
193795             DISPLAY '**************************************'     19379505
193796             PERFORM 9800-SQL-ERROR                               19379605
193797                                                                  19379705
193798         WHEN SQLCODE < ZERO                                      19379805
193799             MOVE SHPUNT-SHIPT-UNT-ID  TO  PV-DISP-CARTON         19379905
193800             MOVE SQLCODE              TO  PV-DISP-SQLCODE        19380005
193801             DISPLAY '**************************************'     19380105
193802             DISPLAY '*                                    *'     19380205
193804             DISPLAY PC-PROGRAM-NAME ' - '                        19380406
193805                     PV-ABEND-PARAGRAPH                           19380505
193806             DISPLAY 'CARTON: ' PV-DISP-CARTON                    19380605
193807             DISPLAY 'SQLCODE:' PV-DISP-SQLCODE                   19380705
193808             DISPLAY '*                                    *'     19380805
193809             DISPLAY '**************************************'     19380905
193810             DISPLAY 'ERROR ISSUED ON SELECT OF TSHPUNT     '     19381005
193811             DISPLAY 'INPUT:' RC093-CARR-SSCC-TRACK-REC           19381107
193812             DISPLAY '**************************************'     19381202
193813             PERFORM 9800-SQL-ERROR                               19381302
193820                                                                  19382002
193830     END-EVALUATE.                                                19383002
193908                                                                  19390800
193909                                                                  19390900
193910******************************************************************19391002
193911** CREATE TRACKING ENTRIES IN DATABASE                           *19391102
193912******************************************************************19391202
193920 3020-WRITE-TRACKING.                                             19392002
193949                                                                  19394900
193950     SET  PS-ON-INBND-TRACK-NO                                    19395002
193951          PS-ON-TRACK-STATUS-NO  TO  TRUE.                        19395102
193952                                                                  19395202
193953     PERFORM 3030-CHECK-INBND-TRCK.                               19395302
193954     PERFORM 3040-CHECK-TRACK-STAT.                               19395402
193955                                                                  19395502
193956*                                                                 19395602
193957*  SUT00116 - INBOUND CARTON TRACKING TABLE - SUT_INBD_CART_TRKG  19395715
193958*  SUT00119 - TRACKING NUMBER HISTORY TABLE - SUT_TRKG_NBR_HIST   19395815
193959*                                                                 19395915
193960     MOVE PV-ASNCAR-NUM           TO SUT00116-SHIPT-UNT-ID.       19396015
193962     MOVE RC093-CARR-TRACKING-NBR TO SUT00116-TRKG-NBR            19396215
193963                                     SUT00119-TRKG-NBR.           19396315
193964     IF  PS-ON-INBND-TRACK-NO                                     19396415
193965         MOVE PC-Y                TO SUT00116-ACTV-IND            19396515
193966     ELSE                                                         19396615
193967         MOVE PC-N                TO SUT00116-ACTV-IND            19396715
193970     END-IF.                                                      19397015
193980                                                                  19398015
193982     MOVE PC-NOTIFY               TO SUT00119-TRKG-STAT-CDE.      19398215
193983                                                                  19398315
193990     IF  PS-ON-TRACK-STATUS-NO                                    19399015
193991         MOVE PC-Y                TO SUT00119-PRCD-IND            19399115
193992     ELSE                                                         19399215
193993         MOVE PC-N                TO SUT00119-PRCD-IND            19399315
193994     END-IF.                                                      19399415
193997                                                                  19399715
193998     MOVE PC-PROGRAM-NAME         TO SUT00119-CRE-PGM-NM.         19399815
193999                                                                  19399915
194000     MOVE RC093-PROCESS-TMST      TO SUT00119-TRK-TMST.           19400015
194001                                                                  19400102
194002     PERFORM 4000-INSERT-CART-TRACK.                              19400202
194003                                                                  19400302
194004     PERFORM 4010-INSERT-TRACK-STATUS.                            19400402
194005                                                                  19400502
194006     IF  PV-INSERT-COMMIT-CNT  >=  PV-COMMIT-QTY                  19400602
194007         EXEC SQL                                                 19400702
194008            COMMIT                                                19400802
194009         END-EXEC                                                 19400902
194010                                                                  19401002
194011         ADD  1  TO  PV-COMMIT-CNT                                19401102
194012         MOVE 0  TO  PV-INSERT-COMMIT-CNT                         19401202
194013                                                                  19401302
194014         MOVE  PV-COMMIT-CNT          TO  PV-DISP-COMMIT          19401404
194015         MOVE  PV-INPUT-CNT           TO  PV-DISP-INPUT           19401504
194016                                                                  19401602
194017         DISPLAY ' COMMIT CNT:' PV-DISP-COMMIT                    19401704
194018                 '  INPUT CNT:' PV-DISP-INPUT                     19401804
194020                 '  REC:'       RC093-CARR-SSCC-TRACK-REC         19402007
194030     END-IF.                                                      19403002
194040                                                                  19404002
194050                                                                  19405002
194051***************************************************************** 19405104
194052* CHECK IF NOTIFY CARTON IS ALREADY ON DATABASE                 * 19405204
194053*                                                               * 19405304
194054***************************************************************** 19405404
194060 3030-CHECK-INBND-TRCK.                                           19406004
194061                                                                  19406104
194062     MOVE '3030-CHECK-INBND-TRCK ' TO PV-ABEND-PARAGRAPH.         19406204
194063                                                                  19406305
194065     MOVE PV-ASNCAR-NUM        TO SUT00116-SHIPT-UNT-ID           19406515
194066                                                                  19406615
194067     EXEC SQL                                                     19406715
194068         SELECT  ACTV_IND                                         19406815
194069           INTO :SUT00116-ACTV-IND                                19406915
194070          FROM  SUT_INBD_CART_TRKG                                19407015
194071         WHERE  SHIPT_UNT_ID  = :SUT00116-SHIPT-UNT-ID            19407115
194072           AND  TRKG_NBR      = :RC093-CARR-TRACKING-NBR          19407215
194073           AND  ACTV_IND      = :PC-Y                             19407315
194074          WITH UR                                                 19407415
194075     END-EXEC                                                     19407515
194076                                                                  19407615
194077     EVALUATE TRUE                                                19407715
194078         WHEN SQLCODE = +0                                        19407815
194079              SET  PS-ON-INBND-TRACK-YES  TO  TRUE                19407915
194081                                                                  19408115
194082         WHEN SQLCODE = +100                                      19408215
194083              SET  PS-ON-INBND-TRACK-NO   TO  TRUE                19408315
194087                                                                  19408715
194088         WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                  19408815
194089             MOVE SUT00116-SHIPT-UNT-ID  TO  PV-DISP-CARTON       19408915
194090             MOVE SQLCODE                TO  PV-DISP-SQLCODE      19409015
194091             DISPLAY '**************************************'     19409115
194092             DISPLAY '*                                    *'     19409215
194093             DISPLAY PC-PROGRAM-NAME ' - '                        19409315
194094                     PV-ABEND-PARAGRAPH                           19409415
194095             DISPLAY 'CARTON: ' PV-DISP-CARTON                    19409515
194096             DISPLAY 'TRCKING:' RC093-CARR-TRACKING-NBR           19409615
194097             DISPLAY 'SQLCODE:' PV-DISP-SQLCODE                   19409715
194098             DISPLAY '*                                    *'     19409815
194099             DISPLAY '**************************************'     19409915
194100             DISPLAY 'WARNING ISSUED ON SELECT OF TSHPUNT   '     19410015
194101             DISPLAY 'INPUT:' RC093-CARR-SSCC-TRACK-REC           19410115
194102             DISPLAY '**************************************'     19410215
194103             PERFORM 9800-SQL-ERROR                               19410315
194104                                                                  19410415
194105         WHEN SQLCODE < ZERO                                      19410515
194106             MOVE SUT00116-SHIPT-UNT-ID  TO  PV-DISP-CARTON       19410615
194107             MOVE SQLCODE                TO  PV-DISP-SQLCODE      19410715
194108             DISPLAY '**************************************'     19410815
194109             DISPLAY '*                                    *'     19410915
194110             DISPLAY PC-PROGRAM-NAME ' - '                        19411015
194111                     PV-ABEND-PARAGRAPH                           19411115
194112             DISPLAY 'CARTON: ' PV-DISP-CARTON                    19411215
194113             DISPLAY 'TRCKING:' RC093-CARR-TRACKING-NBR           19411315
194114             DISPLAY 'SQLCODE:' PV-DISP-SQLCODE                   19411415
194115             DISPLAY '*                                    *'     19411515
194116             DISPLAY '**************************************'     19411615
194117             DISPLAY 'ERROR ISSUED ON SELECT OF TSHPUNT     '     19411715
194118             DISPLAY 'INPUT:' RC093-CARR-SSCC-TRACK-REC           19411815
194119             DISPLAY '**************************************'     19411915
194120             PERFORM 9800-SQL-ERROR                               19412015
194121                                                                  19412115
194122     END-EVALUATE.                                                19412215
194123                                                                  19412305
194124                                                                  19412405
194125***************************************************************** 19412505
194126* CHECK IF NOTIFY RECORD IS ALREADY IN TRACKING STATUS          * 19412605
194127*                                                               * 19412705
194128***************************************************************** 19412805
194129 3040-CHECK-TRACK-STAT.                                           19412905
194130                                                                  19413005
194131     MOVE '3040-CHECK-TRACK-STAT ' TO PV-ABEND-PARAGRAPH.         19413105
194132                                                                  19413205
194133     MOVE RC093-CARR-TRACKING-NBR  TO SUT00119-TRKG-NBR           19413315
194134                                                                  19413415
194135     EXEC SQL                                                     19413515
194136         SELECT  TRKG_STAT_CDE                                    19413615
194137           INTO :SUT00119-TRKG-STAT-CDE                           19413715
194138          FROM  SUT_TRKG_NBR_HIST                                 19413815
194139         WHERE  TRKG_NBR           = :SUT00119-TRKG-NBR           19413915
194140           AND  TRKG_STAT_CDE      = :PC-NOTIFY                   19414015
194141           AND  PRCD_IND           = :PC-Y                        19414115
194142          WITH UR                                                 19414215
194143     END-EXEC                                                     19414315
194144                                                                  19414415
194145     EVALUATE TRUE                                                19414515
194146         WHEN SQLCODE = +0                                        19414615
194147              SET  PS-ON-TRACK-STATUS-YES TO  TRUE                19414715
194148                                                                  19414815
194149         WHEN SQLCODE = +100                                      19414915
194150              SET  PS-ON-TRACK-STATUS-NO  TO  TRUE                19415015
194151                                                                  19415115
194152         WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                  19415215
194153             MOVE SUT00116-SHIPT-UNT-ID  TO  PV-DISP-CARTON       19415316
194154             MOVE SQLCODE                TO  PV-DISP-SQLCODE      19415415
194155             DISPLAY '**************************************'     19415515
194156             DISPLAY '*                                    *'     19415615
194157             DISPLAY PC-PROGRAM-NAME ' - '                        19415715
194158                     PV-ABEND-PARAGRAPH                           19415815
194159             DISPLAY 'CARTON:  ' PV-DISP-CARTON                   19415915
194160             DISPLAY 'TRKG NBR:' RC093-CARR-TRACKING-NBR          19416015
194161             DISPLAY 'SQLCODE: ' PV-DISP-SQLCODE                  19416115
194162             DISPLAY '*                                    *'     19416215
194163             DISPLAY '**************************************'     19416315
194164             DISPLAY 'WARNING ISSUED ON SELECT OF TSHPUNT   '     19416415
194165             DISPLAY 'INPUT:' RC093-CARR-SSCC-TRACK-REC           19416515
194166             DISPLAY '**************************************'     19416615
194167             PERFORM 9800-SQL-ERROR                               19416715
194168                                                                  19416815
194169         WHEN SQLCODE < ZERO                                      19416915
194170             MOVE SUT00116-SHIPT-UNT-ID  TO  PV-DISP-CARTON       19417016
194171             MOVE SQLCODE                TO  PV-DISP-SQLCODE      19417115
194172             DISPLAY '**************************************'     19417215
194173             DISPLAY '*                                    *'     19417315
194174             DISPLAY PC-PROGRAM-NAME ' - '                        19417415
194175                     PV-ABEND-PARAGRAPH                           19417515
194176             DISPLAY 'CARTON:  ' PV-DISP-CARTON                   19417615
194177             DISPLAY 'TRKG NBR:' RC093-CARR-TRACKING-NBR          19417715
194178             DISPLAY 'SQLCODE: ' PV-DISP-SQLCODE                  19417815
194179             DISPLAY '*                                    *'     19417915
194180             DISPLAY '**************************************'     19418015
194181             DISPLAY 'ERROR ISSUED ON SELECT OF TSHPUNT     '     19418115
194182             DISPLAY 'INPUT:' RC093-CARR-SSCC-TRACK-REC           19418215
194183             DISPLAY '**************************************'     19418315
194184             PERFORM 9800-SQL-ERROR                               19418415
194185                                                                  19418515
194186     END-EVALUATE.                                                19418615
194190                                                                  19419005
194200                                                                  19420004
194210***************************************************************** 19421011
194220* INSERT INTO INBOUND CARTON TRACKING TABLE                     * 19422011
194230*                                                               * 19423011
194240***************************************************************** 19424011
194300 3050-WRAP-FILE.                                                  19430011
194400                                                                  19440011
194410     IF  RC093-PROCESS-TMST < PV-TRACK-WRAP-PURGE-TMST            19441011
194420         ADD  1  TO  PV-WRAP-PURGE-CNT                            19442011
194430     ELSE                                                         19443011
194440         PERFORM 8010-WRITE-WRAP-FILE                             19444011
194450     END-IF.                                                      19445011
194460                                                                  19446011
194500                                                                  19450011
234000***************************************************************** 23400000
234100* INSERT INTO INBOUND CARTON TRACKING TABLE                     * 23410002
234200*                                                               * 23420000
234300***************************************************************** 23430000
234400                                                                  23440002
234500 4000-INSERT-CART-TRACK.                                          23450002
234600                                                                  23460002
234700     MOVE '4000-INSERT-CART-TRACK' TO PV-ABEND-PARAGRAPH.         23470002
234710                                                                  23471003
235600     EXEC SQL                                                     23560015
235700         INSERT                                                   23570015
235710           INTO SUT_INBD_CART_TRKG                                23571015
235800               (                                                  23580015
235810                 SHIPT_UNT_ID                                     23581015
235820               , CRE_TMST                                         23582015
235830               , TRKG_NBR                                         23583015
236000               , ACTV_IND                                         23600015
236200               )                                                  23620015
237200         VALUES                                                   23720015
237300               (                                                  23730015
237310                 :SUT00116-SHIPT-UNT-ID                           23731018
237320               ,  CURRENT TIMESTAMP                               23732020
237400               , :SUT00116-TRKG-NBR                               23740015
237500               , :SUT00116-ACTV-IND                               23750015
237700               )                                                  23770015
238700     END-EXEC.                                                    23870015
238800                                                                  23880015
238900     EVALUATE TRUE                                                23890015
239000         WHEN SQLCODE = ZERO                                      23900015
239010              IF  PS-ON-INBND-TRACK-YES                           23901022
239100                  SET  RC093-DUP-CART-TRKG  TO  TRUE              23910022
239101                  ADD  1  TO  PV-DUP-TRACK-CNT                    23910122
239102                              PV-INSERT-COMMIT-CNT                23910222
239103              ELSE                                                23910322
239104                  SET  RC093-SUCCESSFUL   TO  TRUE                23910422
239105                  ADD  1  TO  PV-INSERT-TRACK-CNT                 23910522
239106                              PV-INSERT-COMMIT-CNT                23910622
239107              END-IF                                              23910722
239200                                                                  23920015
239420         WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                  23942015
239421             MOVE SUT00116-SHIPT-UNT-ID  TO  PV-DISP-CARTON       23942115
239422             MOVE SQLCODE                TO  PV-DISP-SQLCODE      23942215
239423             DISPLAY '**************************************'     23942315
239424             DISPLAY '*                                    *'     23942415
239425             DISPLAY PC-PROGRAM-NAME ' - '                        23942515
239426                     PV-ABEND-PARAGRAPH                           23942615
239427             DISPLAY 'CARTON: ' PV-DISP-CARTON                    23942715
239428             DISPLAY 'TRCKING:' SUT00116-TRKG-NBR                 23942816
239429             DISPLAY 'SQLCODE:' PV-DISP-SQLCODE                   23942915
239430             DISPLAY '*                                    *'     23943015
239431             DISPLAY '**************************************'     23943115
239440             DISPLAY 'ERROR-INSERT INBOUND CARTON TRACKING  '     23944015
239450             DISPLAY 'INPUT:' RC093-CARR-SSCC-TRACK-REC           23945015
239460             DISPLAY '**************************************'     23946015
239470             PERFORM 9800-SQL-ERROR                               23947015
239480                                                                  23948015
239490         WHEN SQLCODE < ZERO                                      23949015
239491             MOVE SUT00116-SHIPT-UNT-ID  TO  PV-DISP-CARTON       23949115
239492             MOVE SQLCODE                TO  PV-DISP-SQLCODE      23949215
239493             DISPLAY '**************************************'     23949315
239494             DISPLAY '*                                    *'     23949415
239495             DISPLAY PC-PROGRAM-NAME ' - '                        23949515
239496                     PV-ABEND-PARAGRAPH                           23949615
239497             DISPLAY 'CARTON: ' PV-DISP-CARTON                    23949715
239498             DISPLAY 'TRCKING:' SUT00116-TRKG-NBR                 23949816
239499             DISPLAY 'SQLCODE:' PV-DISP-SQLCODE                   23949915
239500             DISPLAY '*                                    *'     23950015
239501             DISPLAY '**************************************'     23950115
239510             DISPLAY 'ERROR-INSERT INBOUND CARTON TRACKING  '     23951015
239520             DISPLAY 'INPUT:' RC093-CARR-SSCC-TRACK-REC           23952015
239530             DISPLAY '**************************************'     23953015
239540             PERFORM 9800-SQL-ERROR                               23954015
240600                                                                  24060015
240700     END-EVALUATE.                                                24070015
240800                                                                  24080002
240900                                                                  24090002
240910***************************************************************** 24091002
240920* INSERT INTO CARTON TRACKING STATUS TABLE                      * 24092002
240930*                                                               * 24093002
240940***************************************************************** 24094002
240950                                                                  24095002
240960 4010-INSERT-TRACK-STATUS.                                        24096002
241000                                                                  24100002
241100     MOVE '4010-INSERT-TRACK-STATUS' TO PV-ABEND-PARAGRAPH.       24110002
241200                                                                  24120002
241300     EXEC SQL                                                     24130015
241400         INSERT                                                   24140015
241500           INTO SUT_TRKG_NBR_HIST                                 24150015
241600               (                                                  24160015
241700                 TRKG_NBR                                         24170015
241701               , TRKG_STAT_CDE                                    24170115
241710               , CRE_TMST                                         24171015
241900               , PRCD_IND                                         24190015
241912               , CRE_PGM_NM                                       24191215
241913               , TRK_TMST                                         24191315
241920               )                                                  24192015
241930         VALUES                                                   24193015
241940               (                                                  24194015
241950                 :SUT00119-TRKG-NBR                               24195018
241951               , :SUT00119-TRKG-STAT-CDE                          24195115
241952               ,  CURRENT TIMESTAMP                               24195220
241970               , :SUT00119-PRCD-IND                               24197015
241971               , :SUT00119-CRE-PGM-NM                             24197119
241980               , :SUT00119-TRK-TMST                               24198015
241990               )                                                  24199015
241991     END-EXEC.                                                    24199115
242003                                                                  24200315
242004     EVALUATE TRUE                                                24200415
242005         WHEN SQLCODE = ZERO                                      24200515
242006              IF  PS-ON-TRACK-STATUS-YES                          24200622
242007                  ADD  1  TO  PV-DUP-STAT-CNT                     24200723
242009                  IF  PS-ON-INBND-TRACK-YES                       24200923
242010                      SET  RC093-DUP-BOTH       TO  TRUE          24201023
242011                  ELSE                                            24201123
242012                      SET  RC093-DUP-TRKG-HIST  TO  TRUE          24201223
242013                  END-IF                                          24201323
242014              ELSE                                                24201422
242015                  ADD  1  TO  PV-INSERT-STAT-CNT                  24201523
242017              END-IF                                              24201722
242018                                                                  24201822
242019         WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                  24201922
242020             MOVE SQLCODE                 TO PV-DISP-SQLCODE      24202015
242021             MOVE SUT00116-SHIPT-UNT-ID   TO PV-DISP-CARTON       24202115
242022             DISPLAY '**************************************'     24202215
242023             DISPLAY '*                                    *'     24202315
242024             DISPLAY PC-PROGRAM-NAME ' - '                        24202415
242025                     PV-ABEND-PARAGRAPH                           24202515
242026             DISPLAY 'CARTON:   ' PV-DISP-CARTON                  24202615
242027             DISPLAY 'TRCKING:  ' SUT00119-TRKG-NBR               24202715
242028             DISPLAY 'STATUS:   ' SUT00119-TRKG-STAT-CDE          24202816
242029             DISPLAY 'PROCESS:  ' SUT00119-PRCD-IND               24202917
242030             DISPLAY 'TRCK TMST:' SUT00119-TRK-TMST               24203015
242031             DISPLAY 'SQLCODE:  ' PV-DISP-SQLCODE                 24203115
242032             DISPLAY '*                                    *'     24203215
242033             DISPLAY '**************************************'     24203315
242034             DISPLAY 'ERROR-INSERT TRACKINT STATUS          '     24203415
242035             DISPLAY 'INPUT:' RC093-CARR-SSCC-TRACK-REC           24203515
242036             DISPLAY '**************************************'     24203615
242037             PERFORM 9800-SQL-ERROR                               24203715
242038                                                                  24203815
242039         WHEN SQLCODE < ZERO                                      24203915
242040             MOVE SQLCODE                 TO PV-DISP-SQLCODE      24204015
242041             MOVE SUT00116-SHIPT-UNT-ID   TO PV-DISP-CARTON       24204115
242042             DISPLAY '**************************************'     24204215
242043             DISPLAY '*                                    *'     24204315
242044             DISPLAY PC-PROGRAM-NAME ' - '                        24204415
242045                     PV-ABEND-PARAGRAPH                           24204515
242046             DISPLAY 'CARTON:   ' PV-DISP-CARTON                  24204615
242047             DISPLAY 'TRCKING:  ' SUT00119-TRKG-NBR               24204715
242048             DISPLAY 'STATUS:   ' SUT00119-TRKG-STAT-CDE          24204816
242049             DISPLAY 'PROCESS:  ' SUT00119-PRCD-IND               24204915
242050             DISPLAY 'TRK TMST: ' SUT00119-TRK-TMST               24205015
242051             DISPLAY 'SQLCODE:  ' PV-DISP-SQLCODE                 24205115
242052             DISPLAY '*                                    *'     24205215
242053             DISPLAY '**************************************'     24205315
242054             DISPLAY 'ERROR-INSERT TRACKING STATUS          '     24205415
242055             DISPLAY 'INPUT:' RC093-CARR-SSCC-TRACK-REC           24205515
242056             DISPLAY '**************************************'     24205615
242057             PERFORM 9800-SQL-ERROR                               24205715
242058                                                                  24205815
242059     END-EVALUATE.                                                24205915
242060                                                                  24206014
242061                                                                  24206114
242062******************************************************************24206214
242063* READ EXTRACT RECORD.                                            24206314
242064******************************************************************24206414
242065 7000-READ-INPUT.                                                 24206514
242066                                                                  24206614
242067     READ  ASN-CARR-TRACKING                                      24206714
242068      INTO RC093-CARR-SSCC-TRACK-REC                              24206814
242069           AT END                                                 24206914
242070              SET  PS-EOF-INPUT  TO  TRUE                         24207014
242071           NOT AT END                                             24207114
242072              ADD  1             TO  PV-INPUT-CNT.                24207214
242073                                                                  24207314
242074                                                                  24207414
242075******************************************************************24207514
242076* WRITE OUTPUT BACKUP RECORD.                                     24207614
242077******************************************************************24207704
242080 8000-WRITE-OUTPUT.                                               24208004
242090                                                                  24209004
242091     WRITE ASN-CARR-TRACK-BACKUP-REC                              24209108
242092      FROM RC093-CARR-SSCC-TRACK-REC.                             24209207
242093                                                                  24209304
242094     ADD  1  TO  PV-OUTPUT-CNT.                                   24209404
242095                                                                  24209504
242100                                                                  24210004
242200******************************************************************24220011
242300* WRITE OUTPUT WRAP FILE RECORD.                                  24230011
242400******************************************************************24240011
242500 8010-WRITE-WRAP-FILE.                                            24250011
242600                                                                  24260011
242700     WRITE ASN-CARR-TRACK-WRAP-REC                                24270011
242800      FROM RC093-CARR-SSCC-TRACK-REC.                             24280011
242900                                                                  24290011
243000     ADD  1  TO  PV-WRAP-CNT.                                     24300011
243100                                                                  24310011
243200                                                                  24320011
945500******************************************************************94550000
945600* THIS MODULE PERFORMS THE SQL ERROR.                            *94560000
945700******************************************************************94570000
945900 9800-SQL-ERROR.                                                  94590002
946000                                                                  94600002
946100      MOVE SQLCODE               TO SQLCODE2.                     94610002
946200      MOVE SQLERRD(3)            TO SQLERRD3.                     94620002
946300      DISPLAY '**                **'                              94630005
946310      DISPLAY '** ABEND **       ** = SQLERROR'.                  94631005
946400      DISPLAY '** PROGRAM        ** = RCKUP062'.                  94640002
946500      DISPLAY '** PARAGRAPH      ** = ' PV-ABEND-PARAGRAPH.       94650002
946600      DISPLAY '** OPERATION ATTEMPTED = '                         94660002
946700                                      PV-DB2-OPERATION-ATTEMPTED  94670002
946800      DISPLAY '** SQLCODE        ** = ' SQLCODE2.                 94680002
946900      DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                 94690002
947000      DISPLAY '** SQLERRM        ** = ' SQLERRM.                  94700002
947100      DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                 94710002
947200                                                                  94720002
947300      PERFORM 9900-GENERATE-STATISTICS.                           94730004
947500      SET ABEND-4013-DB2-ERROR   TO TRUE                          94750002
947600      CALL 'ILBOABN0' USING ABEND-CODE.                           94760002
947700                                                                  94770002
947710 9900-GENERATE-STATISTICS.                                        94771003
947711                                                                  94771103
947712     MOVE  PV-INPUT-CNT          TO  PV-DISP-INPUT                94771203
947713     MOVE  PV-FIRST-2-CNT        TO  PV-DISP-FIRST-2              94771303
947714     MOVE  PV-NOT-NUMERIC-CNT    TO  PV-DISP-NOT-NUMERIC          94771403
947715     MOVE  PV-NOT-BLANK-CNT      TO  PV-DISP-NOT-BLANK            94771503
947716     MOVE  PV-VALID-CARTON-CNT   TO  PV-DISP-VALID-CARTON         94771603
947717     MOVE  PV-NOT-ON-INBND-CNT   TO  PV-DISP-NOT-ON-INBND         94771703
947718     MOVE  PV-ON-INBND-CNT       TO  PV-DISP-ON-INBND             94771803
947719     MOVE  PV-INSERT-TRACK-CNT   TO  PV-DISP-INSERT-TRACK         94771903
947720     MOVE  PV-DUP-TRACK-CNT      TO  PV-DISP-DUP-TRACK            94772022
947721     MOVE  PV-INSERT-STAT-CNT    TO  PV-DISP-INSERT-STAT          94772122
947722     MOVE  PV-DUP-STAT-CNT       TO  PV-DISP-DUP-STAT             94772222
947723     MOVE  PV-INSERT-COMMIT-CNT  TO  PV-DISP-INSERT-COMMIT        94772322
947724     MOVE  PV-COMMIT-CNT         TO  PV-DISP-COMMIT               94772422
947725     MOVE  PV-OUTPUT-CNT         TO  PV-DISP-OUTPUT               94772522
947726     MOVE  PV-WRAP-PURGE-CNT     TO  PV-DISP-WRAP-PURGE           94772622
947727     MOVE  PV-WRAP-CNT           TO  PV-DISP-WRAP                 94772722
947728                                                                  94772822
947729     DISPLAY '*************************************'.             94772922
947730     DISPLAY '**      RCKUP062 STATISTICS COUNTS **'.             94773022
947731     DISPLAY '*************************************'.             94773122
947732     DISPLAY '*'.                                                 94773222
947733     DISPLAY '* READ COUNT:   '       PV-DISP-INPUT               94773303
947734     DISPLAY '*'.                                                 94773403
947735     DISPLAY '* CARTON NOT START 00:' PV-DISP-FIRST-2             94773503
947736     DISPLAY '* CARTON NOT NUMERIC: ' PV-DISP-NOT-NUMERIC         94773603
947737     DISPLAY '* CARTON 21-40 BLANK: ' PV-DISP-NOT-BLANK           94773703
947738     DISPLAY '*'.                                                 94773803
947739     DISPLAY '* VALID CARTONS:      ' PV-DISP-VALID-CARTON        94773903
947740     DISPLAY '* NOT ON INBOUND DB:  ' PV-DISP-NOT-ON-INBND        94774003
947741     DISPLAY '* ON INBOUND DB:      ' PV-DISP-ON-INBND            94774103
947742     DISPLAY '*'.                                                 94774203
947743     DISPLAY '* CARTON TRACK INSERT:' PV-DISP-INSERT-TRACK        94774303
947744     DISPLAY '* CARTON DUPLICATE:   ' PV-DISP-DUP-TRACK           94774422
947745     DISPLAY '* TRACK STATUS INSERT:' PV-DISP-INSERT-STAT         94774522
947746     DISPLAY '* TRACK STATUS DUP:   ' PV-DISP-DUP-STAT            94774622
947747     DISPLAY '*'.                                                 94774722
947748     DISPLAY '* INSERT TO COMMIT:   ' PV-DISP-INSERT-COMMIT       94774822
947749     DISPLAY '* NUMBER OF COMMITS:  ' PV-DISP-COMMIT              94774922
947750     DISPLAY '*'.                                                 94775022
947751     DISPLAY '* WRAP PURGE:         '  PV-DISP-WRAP-PURGE         94775122
947752     DISPLAY '* WRAP COUNT:         '  PV-DISP-WRAP               94775222
947753     DISPLAY '*'.                                                 94775322
947754     DISPLAY '* OUTPUT COUNT  '       PV-DISP-OUTPUT              94775422
947755     DISPLAY '*'.                                                 94775522
947756     DISPLAY '* LAST RECORD PROCESSED:'                           94775622
947757                                  RC093-CARR-SSCC-TRACK-REC.      94775722
947758     DISPLAY '*'.                                                 94775822
947759     DISPLAY '*************************************'.             94775922
947760                                                                  94776022
948140     COPY DPPD001.                                                94814003
