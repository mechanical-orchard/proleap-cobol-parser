000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.             SUKUT704.                                00050000
000600 AUTHOR.                 GERMAN BANDA.                            00060000
000700 INSTALLATION.           KOHLS.                                   00070000
000800 DATE-WRITTEN            OCTOBER, 2003.                           00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100******************************************************************00110000
001200* THIS PROGRAM WILL CREATE A NEW PACKSLIP AND DETACH THE CARTON   00120000
001300* FROM THE ORIGINAL PACKSLIP AND ATTACH IT TO A NEW PACKSLIP.     00130000
001400******************************************************************00140000
001500                                                                  00150000
001600******************************************************************00160000
001700 ENVIRONMENT DIVISION.                                            00170000
001800******************************************************************00180000
001900                                                                  00190000
002000******************************************************************00200000
002100 DATA DIVISION.                                                   00210000
002200******************************************************************00220000
002300                                                                  00230000
002400******************************************************************00240000
002500 WORKING-STORAGE SECTION.                                         00250000
002600******************************************************************00260000
002700                                                                  00270000
002800     COPY SUWS044.                                                00280000
002900                                                                  00290000
003000*----------------------------------------------------------------*00300000
003100*    CURRENT DATE COPYBOOK.                                      *00310000
003200*----------------------------------------------------------------*00320000
003300                                                                  00330000
003400     COPY DPWS017.                                                00340000
003500*----------------------------------------------------------------*00350000
003600*    COPY BOOK FOR CALENDAR SUBROUTINE (DPKUT500)                 00360000
003700*----------------------------------------------------------------*00370000
003800                                                                  00380000
003900     COPY DPWS500.                                                00390000
004000                                                                  00400000
004100*---------------------------------------------------------------* 00410000
004200*  RECORD LAYOUTS FOR THE TROUBLE CREATION ROUTINE                00420000
004300*---------------------------------------------------------------* 00430000
004400     COPY TMWS500.                                                00440000
004500*                                                                 00450000
004600*---------------------------------------------------------------* 00460000
004700*  RECORD LAYOUTS FOR RECEIVER AUDIT CREATE                       00470000
004800*---------------------------------------------------------------* 00480000
004900     COPY RCWS031.                                                00490000
005000*                                                                 00500000
005100 01  DK-DB2-KEYS.                                                 00510000
005200     05  DK-STR-DEST-NBR                 PIC S9(4) COMP VALUE +0. 00520000
005300     05  DK-AUDIT-CNTL-NBR               PIC S9(09) COMP.         00530000
005400     05  DK-EXPTED-ITM-UPD-QTY           PIC S9(09) COMP.         00540000
005500     05  DK-VERIFY-ITM-UPD-QTY           PIC S9(09) COMP.         00550000
005600     05  DK-AP-VERIFY-ITM-UPD-QTY        PIC S9(09) COMP.         00560000
005700     05  DK-SHPTPO-EXPTED-UPD-CNT        PIC S9(09) COMP.         00570000
005800     05  DK-SHIPMT-EXPTED-UPD-QTY        PIC S9(09) COMP.         00580000
005900     05  DK-PKITM-UPD-ITM-QTY            PIC S9(09) COMP.         00590000
006000     05  DK-EXPTED-CART-UPD-CNT          PIC S9(09) COMP.         00600000
006100     05  DK-PKSL-ITM-UPD-QTY             PIC S9(09) COMP.         00610000
006200     05  DK-DTL-CK-ITM-QTY               PIC S9(09) COMP.         00620000
006300     05  DK-PO-LNE-NBR                   PIC S9(9) COMP.          00630000
006400     05  DK-SHIPT-UNT-ID                 PIC S9(18) COMP-3.       00640000
006500     05  DK-OPER-UNT-ID                  PIC S9(04) COMP.         00650000
006600     05  DK-OUTER-QTY                    PIC S9(04) COMP.         00660000
006700     05  DK-FCLTY-ID                     PIC S9(04) COMP.         00670000
006800     05  DK-STR-NBR                      PIC S9(04) COMP SYNC.    00680000
006900     05  DK-REC-SEQ-NBR                  PIC S9(09) COMP SYNC.    00690000
007000     05  DK-PKSL-LNE-NBR                 PIC S9(09) COMP SYNC.    00700000
007100     05  DK-TRN-TYP-CDE                  PIC  X(02).              00710000
007200     05  DK-UPC-NBR                      PIC S9(15)V COMP-3.      00720000
007300     05  DK-SHIPT-ID                     PIC S9(09) COMP VALUE +0.00730000
007400     05  DK-STR-NBR-N                    PIC 9(4).                00740000
007500     05  DK-STR-NBR-X   REDEFINES     DK-STR-NBR-N.               00750000
007600         10  DK-STR-NBR-X1               PIC X(01).               00760000
007700         10  DK-STR-NBR-X2               PIC X(03).               00770000
007800     05  DK-STR-NBR-USE                  PIC X(03).               00780000
007900     05  DK-NULL                         PIC S9(04)  VALUE +0     00790000
008000                                              COMP SYNC.          00800000
008100                                                                  00810000
008200 01  DN-DB2-NULL-INDICATORS.                                      00820000
008300     05  DN-SEQ-NBR-IND             PIC S9(04) COMP VALUE ZEROES. 00830000
008400     05  DN-AUDIT-IND               PIC S9(04) COMP VALUE ZEROES. 00840000
008500     05  DN-SHIPT-IND               PIC S9(04) COMP VALUE ZEROES. 00850000
008600     05  DN-PROB-IND                PIC S9(04) COMP VALUE ZEROES. 00860000
008700     05  DN-ADJ-IND                 PIC S9(04) COMP VALUE ZEROES. 00870000
008800     05  DN-TRIP-ID                   PIC S9(04) COMP VALUE +0.   00880000
008900     05  DN-SHIP-EST-AR-TMST          PIC S9(04) COMP VALUE +0.   00890000
009000     05  DN-VEH-NBR                   PIC S9(04) COMP VALUE +0.   00900000
009100                                                                  00910000
009200 01  PC-PROGRAM-CONSTANTS.                                        00920000
009300     05  PC-DEFAULT-TMST           PIC X(26)  VALUE               00930000
009400                                  '9999-09-09-09.09.09.999999'.   00940000
009500     05  PC-CALENDAR-ROUTINE       PIC X(08)  VALUE 'RCKCS290'.   00950000
009600     05  PC-CURRENT-PROGRAM-NAME   PIC X(08)  VALUE 'SUKUT704'.   00960000
009700     05  PC-FA-AUTOVE-TRBLE-372    PIC S9(04) COMP VALUE 372.     00970000
009800     05  PC-AUDIT-RTN              PIC X(08)  VALUE 'RCKCS290'.   00980000
009900     05  PC-TROUBLE-WTR            PIC  X(08) VALUE 'TMKCS521'.   00990000
010000     05  PC-SHPUM-UPD-PGM          PIC  X(08) VALUE 'SUKUT708'.   01000000
010100     05  PC-TROUBLE-LENGTH         PIC S9(04) COMP VALUE +600.    01010000
010200     05  PC-AUDIT-RTN-LENGTH       PIC S9(4)  VALUE  +300         01020000
010300                                                COMP SYNC.        01030000
010400     05  PC-DEFAULT-DATE           PIC X(10)  VALUE '0001-01-01'. 01040000
010500     05  PC-IN                     PIC X(02)  VALUE 'IN'.         01050000
010600     05  PC-FA                     PIC X(02)  VALUE 'FA'.         01060000
010700     05  PC-A                      PIC X(01)  VALUE 'A'.          01070000
010800     05  PC-M                      PIC X(01)  VALUE 'M'.          01080000
010900     05  PC-I                      PIC X(01)  VALUE 'I'.          01090000
011000     05  PC-FRASTY-CRE-USER-ID     PIC X(08)  VALUE 'F/A SYTM'.   01100000
011100                                                                  01110000
011200                                                                  01120000
011300 01  PS-PROGRAM-SWITCHES.                                         01130000
011400     05  PS-MORE-SHUUPC-SW            PIC X(01)  VALUE 'N'.       01140000
011500         88  PS-MORE-SHUUPC-YES                  VALUE 'Y'.       01150000
011600         88  PS-MORE-SHUUPC-NO                   VALUE 'N'.       01160000
011700     05  PS-LOG-MESSAGE-SW              PIC  X       VALUE 'N'.   01170000
011800         88  PS-LOG-MESSAGE                          VALUE 'Y'.   01180000
011900         88  PS-NO-LOG-MESSAGE                       VALUE 'N'.   01190000
012000     05  PS-PROCESS-ODD-UNITS-SW        PIC  X       VALUE 'N'.   01200000
012100         88  PS-PROCESS-ODD-UNITS                    VALUE 'Y'.   01210000
012200         88  PS-NOT-PROCESS-ODD-UNITS                VALUE 'N'.   01220000
012300     05  PS-BEFORE-ONLY-LOGGING-SW      PIC  X       VALUE 'N'.   01230000
012400         88  PS-BEFORE-ONLY-LOGGING                  VALUE 'Y'.   01240000
012500         88  PS-NOT-BEFORE-ONLY-LOGGING              VALUE 'N'.   01250000
012600     05  PS-FIRST-PKSLIP-LINE-SW        PIC  X       VALUE 'N'.   01260000
012700         88  PS-FIRST-PKSLIP-LINE                    VALUE 'Y'.   01270000
012800         88  PS-NOT-FIRST-PKSLIP-LINE                VALUE 'N'.   01280000
012900     05  PS-TROUBLE-CREATE-SW           PIC  X       VALUE 'N'.   01290000
013000         88  PS-TROUBLE-CREATE-YES                   VALUE 'Y'.   01300000
013100         88  PS-TROUBLE-CREATE-NO                    VALUE 'N'.   01310000
013200     05  PS-FIRST-ODD-UNTS-FETCH-SW      PIC  X(01)  VALUE 'Y'.   01320000
013300         88  PS-FIRST-ODD-UNTS-FETCH                 VALUE 'Y'.   01330000
013400         88  PS-NOT-FIRST-ODD-UNTS-FETCH             VALUE 'N'.   01340000
013500     05  PS-FOUND-ON-ODD-UNTS-CSR-SW     PIC  X(01)  VALUE 'Y'.   01350000
013600         88  PS-FOUND-ON-ODD-UNTS-CSR                VALUE 'Y'.   01360000
013700         88  PS-EO-ODD-UNTS-CSR                      VALUE 'N'.   01370000
013800     05  PS-ODD-UNT-CRTN-FOUND-SW        PIC  X(01)  VALUE 'N'.   01380000
013900         88  PS-ODD-UNT-CRTN-FOUND                   VALUE 'Y'.   01390000
014000         88  PS-NOT-ODD-UNT-CRTN-FOUND               VALUE 'N'.   01400000
014100     05  PS-FIRST-PREPK-SW               PIC  X(01)  VALUE 'Y'.   01410000
014200         88  PS-FIRST-PREPK                          VALUE 'Y'.   01420000
014300         88  PS-NOT-FIRST-PREPK                      VALUE 'N'.   01430000
014400     05  PS-EO-UNITS-CSR-SW              PIC  X(01)  VALUE 'N'.   01440000
014500         88  PS-EO-UNITS-CSR                         VALUE 'Y'.   01450000
014600         88  PS-NOT-EO-UNITS-CSR                     VALUE 'N'.   01460000
014700     05  PS-EO-PREPK-CSR-SW              PIC  X(01)  VALUE 'N'.   01470000
014800         88  PS-EO-PREPK-CSR                         VALUE 'Y'.   01480000
014900         88  PS-NOT-EO-PREPK-CSR                     VALUE 'N'.   01490000
015000     05  PS-END-OF-VRTL-LBL-CSR-SW       PIC  X(01)  VALUE 'N'.   01500000
015100         88  PS-END-OF-VRTL-LBL-CSR                  VALUE 'Y'.   01510000
015200         88  PS-NOT-END-OF-VRTL-LBL-CSR              VALUE 'N'.   01520000
015300     05  PS-ERROR-SW                    PIC  X(01)   VALUE 'N'.   01530000
015400         88  PS-NO-ERROR                             VALUE 'N'.   01540000
015500         88  PS-ERROR                                VALUE 'Y'.   01550000
015600     05  PS-PKSLIP-INSERT-SW            PIC  X(01)   VALUE 'N'.   01560000
015700         88  PS-PKSLIP-INSERTED                      VALUE 'N'.   01570000
015800         88  PS-PKSLIP-NOT-INSERTED                  VALUE 'Y'.   01580000
015900     05  PS-SUCCESSFUL-UPDATE-SW         PIC  X(01)  VALUE 'N'.   01590000
016000         88  PS-SUCCESSFUL-UPDATE                    VALUE 'Y'.   01600000
016100         88  PS-NOT-SUCCESSFUL-UPDATE                VALUE 'N'.   01610000
016200     05  PS-FIRST-PO-LINE-SW             PIC  X(01)  VALUE 'Y'.   01620000
016300         88  PS-FIRST-PO-LINE-FOR-CTN                VALUE 'Y'.   01630000
016400         88  PS-NOT-FIRST-PO-LINE-FOR-CTN            VALUE 'N'.   01640000
016500     05  PS-FOUND-ON-CURSOR-SW           PIC  X(01)  VALUE 'Y'.   01650000
016600         88  PS-FOUND-ON-CURSOR                      VALUE 'Y'.   01660000
016700         88  PS-NOT-FOUND-ON-CURSOR                  VALUE 'N'.   01670000
016800     05  PS-LABEL-DATA-FOUND-SW          PIC  X(01)  VALUE 'N'.   01680000
016900         88  PS-LABEL-DATA-FOUND                     VALUE 'Y'.   01690000
017000         88  PS-LABEL-DATA-NOT-FOUND                 VALUE 'N'.   01700000
017100     05  PS-UPDATE-TPKITEM-SW            PIC  X(01)  VALUE 'N'.   01710000
017200         88  PS-UPDATE-TPKITEM-YES                   VALUE 'Y'.   01720000
017300         88  PS-UPDATE-TPKITEM-NO                    VALUE 'N'.   01730000
017400     05  PS-FIRST-PREPK-LINE-SW          PIC  X(01)  VALUE 'Y'.   01740000
017500         88  PS-FIRST-PREPK-LINE-YES                 VALUE 'Y'.   01750000
017600         88  PS-FIRST-PREPK-LINE-NO                  VALUE 'N'.   01760000
017700     05  PS-UPDATE-PKSLIP-ONLY-SW        PIC  X(01)  VALUE 'N'.   01770000
017800         88  PS-UPDATE-PKSLIP-ONLY-YES               VALUE 'Y'.   01780000
017900         88  PS-UPDATE-PKSLIP-ONLY-NO                VALUE 'N'.   01790000
018000     05  PS-FIRST-INPK-CNVY-SW           PIC  X(01)  VALUE 'Y'.   01800000
018100         88  PS-FIRST-INPK-CNVY-YES                  VALUE 'Y'.   01810000
018200         88  PS-FIRST-INPK-CNVY-NO                   VALUE 'N'.   01820000
018210     05  PS-BLD-INTERNAL-TABLE-SW     PIC  X(01) VALUE 'N'.       01821003
018220         88  PS-BLD-INTERNAL-TABLE-YES           VALUE 'Y'.       01822003
018230         88  PS-BLD-INTERNAL-TABLE-NO            VALUE 'N'.       01823003
018300                                                                  01830000
018400 01  PV-PROGRAM-VARIABLES.                                        01840000
018500     05  PV-NULL-IND                    PIC S9(04)  VALUE +0      01850000
018600                                                    COMP SYNC.    01860000
018700     05  PV-TRBL-RSN-CDE                 PIC S9(4) VALUE ZERO     01870000
018800                                                COMP SYNC.        01880000
018900     05  PV-CICS-MSG-AREA                PIC  X(100) VALUE SPACE. 01890000
019000     05  PV-NOTIF-NBR                    PIC S9(9) VALUE ZERO     01900000
019100                                                COMP SYNC.        01910000
019200     05  PV-CURRENT-TIMESTAMP            PIC X(26)   VALUE SPACES.01920000
019300     05  PV-PO-LNE-NBR                   PIC  S9(9) COMP.         01930000
019400     05  PV-MAX-SEQ-NBR                  PIC S9(04) VALUE +0      01940000
019500                                                 COMP.            01950000
019600     05  PV-NEXT-SEQ-NBR                 PIC S9(04) VALUE +0      01960000
019700                                                 COMP.            01970000
019800     05  PV-FROM-PARAGRAPH               PIC X(35) VALUE SPACES.  01980000
019900     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     01990000
020000                                                COMP SYNC.        02000000
020100     05  PV-CICS-RESPONSE                PIC S9(04)  VALUE +0     02010000
020200                                                COMP SYNC.        02020000
020210     05  PV-DISP-PO                      PIC 9(09).               02021009
020211     05  PV-DISP-LINE                    PIC 9(04).               02021109
020220     05  PV-DISP-RCVR                    PIC 9(04).               02022000
020230     05  PV-DISP-STR                     PIC 9(04).               02023000
020231     05  PV-DISP-DEST-STR                PIC 9(04).               02023109
020240     05  pv-disp-sqlcode                 PIC -9(03) VALUE ZEROES. 02024007
020250     05  PV-DISPLAY-UPC-NBR              PIC   9(15).             02025000
020260     05  PV-DISPLAY-INTR-UPC             PIC   9(9).              02026000
020270     05  PV-DISPLAY-PKSL-SEQ-NBR         PIC   9(04).             02027000
020271     05  PV-DISPLAY-LINE-NBR             PIC   9(04).             02027100
020280     05  PV-DISP-OPER-UNT-ID             PIC   9(04).             02028000
020290     05  PV-DISPLAY-ADJ-ERR-CDE          PIC   9(04).             02029000
020300     05  PV-DISP-PARAGRAPH-NAME          PIC X(30).               02030000
020500     05  PV-DISP-SHIPMT-ID               PIC 9(09).               02050000
020600     05  PV-DISP-RCVR-SEQ-NBR            PIC 9(04).               02060000
020700     05  PV-DISP-SEQ-NBR                 PIC 9(04).               02070000
020800     05  PV-DISP-SHIPT-UNT-ID            PIC 9(18).               02080000
020900     05  PV-DISP-PACK-ID                 PIC 9(04).               02090000
021000     05  PV-DISP-PO-LNE-NBR              PIC 9(04).               02100000
021100     05  PV-DISP-PROB-RSN-CDE            PIC 9(04).               02110000
021200     05  PV-DISP-TRN-TYP-CDE             PIC X(02).               02120000
021300     05  PV-DISP-UPC-NBR                 PIC 9(15).               02130000
021400     05  PV-DISP-STR-NBR                 PIC 9(04).               02140000
021500     05  PV-DISPLAY-CICS-RESP            PIC 999999999-           02150000
021600                                                 VALUE ZEROS.     02160000
021700     05  PV-DB2-TMST                      PIC X(26).              02170000
021800     05  FILLER  REDEFINES  PV-DB2-TMST.                          02180000
021900         10  PV-DB2-TMST-CCYY         PIC X(04).                  02190000
022000         10  FILLER                   PIC X(01).                  02200000
022100         10  PV-DB2-TMST-MO           PIC X(02).                  02210000
022200         10  FILLER                   PIC X(01).                  02220000
022300         10  PV-DB2-TMST-DA           PIC X(02).                  02230000
022400         10  FILLER                   PIC X(01).                  02240000
022500         10  PV-DB2-TMST-HH           PIC X(02).                  02250000
022600         10  FILLER                   PIC X(01).                  02260000
022700         10  PV-DB2-TMST-MM           PIC X(02).                  02270000
022800         10  FILLER                   PIC X(01).                  02280000
022900         10  PV-DB2-TMST-SS           PIC X(02).                  02290000
023000             88  PV-DB2-TMST-SS-01               VALUE '01'.      02300000
023100         10  FILLER                   PIC X(01).                  02310000
023200         10  PV-DB2-TMST-MS           PIC X(06).                  02320000
023300             88  PV-DB2-TMST-MS-ZERO             VALUE '000000'.  02330000
023400     05  PV-TRN-LNE-NBR                  PIC  S9(9) COMP.         02340000
023500     05  PV-HOLD-TRN-LNE-NBR            PIC  S9(9) COMP.          02350000
023600     05  PV-PREV-FETCH                   PIC  X(01).              02360000
023700     05  PV-PREV-LINE                    PIC  S9(9) COMP.         02370000
023800     05  PV-PREPK-UNT-QTY                PIC  S9(4) COMP.         02380000
023900     05  PV-INPK-UNT-QTY                 PIC  S9(4) COMP.         02390000
024000     05  PV-SHUUPC-SHPD-QTY              PIC  S9(9)V COMP-3.      02400000
024100     05  PV-SHUUPC-UNIT-QTY              PIC  S9(9)V COMP-3.      02410000
024200     05  PV-SHUUPC-QTY-DR-LNE            PIC  S9(9)V COMP-3.      02420000
024300     05  PV-UNION-TYPE                   PIC  X(01).              02430000
024400     05  PV-SHIPPED-QTY                  PIC  S9(9) VALUE ZEROES  02440000
024500                                                    COMP.         02450000
024600     05  PV-SHPD-QTY-TOTAL               PIC  S9(9) VALUE ZEROES  02460000
024700                                                    COMP.         02470000
024800*                                                                 02480000
024900     05  PV-MISDIRECT-OPER-ID            PIC  9(04) VALUE ZEROES. 02490000
025000     05  PV-MISDIRECT-FA-CREATE-SRCE.                             02500000
025100         10  PV-MIS-FA-CRE-OPER          PIC  X(04)  VALUE SPACE. 02510000
025200         10  PV-MIS-FA-CRE-SYST          PIC  X(04)  VALUE 'PBSM'.02520000
025300*                                                                 02530000
025400     05  PV-MULTIPLE                     PIC  9(04)  VALUE ZEROS. 02540000
025500     05  PV-HOLD-MULTIPLE                PIC  9(04)  VALUE ZEROS. 02550000
025600     05  PV-REMAINDER                    PIC  9(04)  VALUE ZEROS. 02560000
025700     05  PV-FCSE-CART-CNT                PIC  S9(4) COMP.         02570000
025800     05  PV-P2L-CART-CNT                 PIC  S9(4) COMP.         02580000
025900     05  PV-INPK-CART-CNT                PIC  S9(4) COMP.         02590000
026000*                                                                 02600000
026010                                                                  02601003
026020     05  PV-CSSL-PARA                    PIC  X(04) VALUE SPACES. 02602003
026030     05  PV-PARM-SECONDS                 PIC S9(09) COMP VALUE 0. 02603003
026040     05  PV-RECEIVE-RQST-TMST            PIC X(26).               02604003
026050     05  PV-RECEIVE-RQST-TMST-R REDEFINES PV-RECEIVE-RQST-TMST.   02605003
026060         10  FILLER                      PIC  X(11).              02606003
026070         10  PV-INIT-HH                  PIC  9(02).              02607003
026080         10  FILLER                      PIC  X(01).              02608003
026090         10  PV-INIT-MM                  PIC  9(02).              02609003
026091         10  FILLER                      PIC  X(01).              02609103
026092         10  PV-INIT-SS                  PIC  9(02).              02609203
026093         10  FILLER                      PIC  X(07).              02609303
026094     05  PV-INIT-TIME-KEY.                                        02609403
026095         10  PV-INIT-KEY-HH              PIC  9(02).              02609503
026096         10  PV-INIT-KEY-MM              PIC  9(02).              02609603
026097         10  PV-INIT-KEY-SS              PIC  9(02).              02609703
026098     05  PV-DURATION-SEC                 PIC S9(09) COMP VALUE 0. 02609803
026099     05  PV-DISP-DURATION                PIC  9(09)   VALUE ZEROS.02609903
026100     05  PV-DISP-PARM-SECONDS            PIC  9(09)   VALUE ZEROS.02610003
026101     05  PV-DURATION-NANO-SEC            PIC S9(10) COMP VALUE 0. 02610103
026102     05  PV-WORK-NANO-SEC                PIC  9(10) VALUE ZEROES. 02610203
026103     05  PV-WORK-NANO-SEC-REDEF REDEFINES PV-WORK-NANO-SEC.       02610303
026104         10  PV-WORK-NANO-MIN-1-2        PIC  9(02).              02610403
026105         10  PV-WORK-NANO-SEC-3-4        PIC  9(02).              02610503
026106         10  PV-WORK-NANO-MICRO-5-10     PIC  9(06).              02610603
026107     05  PV-DISP-NANO-SEC                PIC  X(12).              02610703
026108     05  PV-DISP-NANO-SEC-REDEF REDEFINES PV-DISP-NANO-SEC.       02610803
026109         10  PV-DISP-NANO-MIN-1-2        PIC  9(02).              02610903
026110         10  PV-DISP-NANO-DASH-1         PIC  X(01).              02611003
026111         10  PV-DISP-NANO-SEC-3-4        PIC  9(02).              02611103
026112         10  PV-DISP-NANO-DASH-2         PIC  X(01).              02611203
026113         10  PV-DISP-NANO-MICRO-5-10     PIC  9(06).              02611303
026114     05  PV-CURRENT-PARA-TMST            PIC  X(26).              02611403
026115     05  PV-CICS-MSG-AREA-3              PIC  X(125) VALUE SPACE. 02611503
026116     05  PV-DISP-OPER                    pIC  9(04)  VALUE zeros. 02611607
026117     05  PV-DISP-CRTN-OPER               pIC  9(04)  VALUE zeros. 02611707
026118     05  PV-DISP-sscc                    pIC  9(18)  VALUE zeros. 02611807
026120     05  PV-DISP-ORIG-RCVR               pIC  9(04)  VALUE zeros. 02612007
026121     05  PV-DISP-NEW-RCVR                pIC  9(04)  VALUE zeros. 02612107
026122     05  PV-DISP-FCLTY                   pIC  9(04)  VALUE zeros. 02612207
026123     05  PV-DISP-TRIP                    pIC  9(09)  VALUE zeros. 02612307
026125     05  PV-DISP-ORIG-SHIP               pIC  9(09)  VALUE zeros. 02612507
026126     05  PV-DISP-new-ship                pIC  9(09)  VALUE zeros. 02612607
026128     05  PV-DISP-ORIG-PKSL               pIC  9(04)  VALUE zeros. 02612807
026129     05  PV-DISP-new-pksl                pIC  9(04)  VALUE zeros. 02612907
026130                                                                  02613003
026131                                                                  02613104
026132*----------------------------------------------------------------*02613204
026133* PARAGRAPH TRACKING TABLE - USED FOR DEBUGGING                  *02613304
026134* WILL TRACK PARAGRAPHS IN THIS TABLE - IF WE SEE TRANSACTION    *02613404
026135* IF TAKING LONGER THEN X SECONDS TO RESPOND, WILL DUMP THE      *02613504
026136* TABLE TO CSSL                                                  *02613604
026137* PARM PATIM4                                                    *02613704
026138*----------------------------------------------------------------*02613804
026139 01  PT-PARA-TRACKING-TABLE.                                      02613904
026140     05  PT-ENTRIES               OCCURS 1500 TIMES               02614004
026141                                  INDEXED BY PT-TRACK-IDX.        02614104
026142         10 FILLER                PIC  X(01) VALUE SPACE.         02614204
026143         10 PT-PROGRAM            PIC  X(08) VALUE 'SUKUT704'.    02614320
026144         10 FILLER                PIC  X(01) VALUE SPACE.         02614404
026145         10 pt-dc                 PIC  9(04) VALUE zeroes.        02614504
026146         10 filler                PIC  X(01) VALUE '-'.           02614604
026147         10 PT-crtn-oper          PIC  9(04) VALUE zeroes.        02614704
026148         10 filler                PIC  X(01) VALUE '-'.           02614804
026149         10 pt-start-hhmmss       PIC  9(06) VALUE zeroes.        02614904
026150         10 FILLER                PIC  X(01) VALUE SPACE.         02615004
026151         10 PT-INDEX-NBR          PIC  9(05) VALUE ZEROES.        02615104
026152         10 FILLER                PIC  X(01) VALUE SPACE.         02615204
026153         10 PT-paragraph          PIC  X(04) VALUE SPACE.         02615304
026154         10 FILLER                PIC  X(01) VALUE SPACE.         02615404
026155         10 PT-TIMESTAMP          PIC  X(26) VALUE SPACE.         02615504
026156         10 FILLER                PIC  X(01) VALUE SPACE.         02615604
026157         10 PT-DURATION           PIC  9(09) VALUE ZEROES.        02615704
026158         10 FILLER                PIC  X(01) VALUE SPACE.         02615804
026159         10 PT-nano-sec           PIC  x(12) VALUE ZEROES.        02615904
026160     05  PT-MAX-PARA-ENTRIES      PIC  9(04) VALUE 1500.          02616004
026161     05  PT-CURR-ENTRIES          PIC  9(04) VALUE ZEROES.        02616104
026162     05  PT-CURR-PARA             PIC  X(04) VALUE SPACES.        02616204
026163                                                                  02616304
026164                                                                  02616404
026170                                                                  02617000
026200*----------------------------------------------------------------*02620000
026300*    DB2 SHIPPING UNIT TABLE                                      02630000
026400*----------------------------------------------------------------*02640000
026500     EXEC SQL                                                     02650000
026600          INCLUDE TSHUUPC                                         02660000
026700     END-EXEC.                                                    02670000
026800******************************************************************02680000
026900*  SQL AND COBOL DECLARATIONS FOR THE KOHLS/RETEK PARMS (TKRPRPM) 02690000
027000******************************************************************02700000
027100     EXEC SQL                                                     02710000
027200          INCLUDE TKRPRPM                                         02720000
027300     END-EXEC.                                                    02730000
027400                                                                  02740000
027500******************************************************************02750000
027600* DB2 AREA FOR THE RECEIVER ITEM TABLE                            02760000
027700******************************************************************02770000
027800     EXEC SQL                                                     02780000
027900          INCLUDE TRECITM                                         02790000
028000     END-EXEC.                                                    02800000
028100                                                                  02810000
028200******************************************************************02820000
028300* DB2 AREA FOR THE RECEIVER DISTRIBUTION TABLE                    02830000
028400******************************************************************02840000
028500     EXEC SQL                                                     02850000
028600          INCLUDE TRECDIS                                         02860000
028700     END-EXEC.                                                    02870000
028800                                                                  02880000
028900******************************************************************02890000
029000* DB2 AREA FOR THE RECEIVER TABLE                                 02900000
029100******************************************************************02910000
029200     EXEC SQL                                                     02920000
029300          INCLUDE TRECEIV                                         02930000
029400     END-EXEC.                                                    02940000
029500                                                                  02950000
029600******************************************************************02960000
029700* DB2 AREA FOR THE PACKSLIP TABLE                                 02970000
029800******************************************************************02980000
029900     EXEC SQL                                                     02990000
030000          INCLUDE TPKSLIP                                         03000000
030100     END-EXEC.                                                    03010000
030200                                                                  03020000
030300******************************************************************03030000
030400* DB2 AREA FOR THE PACKSLIP ITEM TABLE                            03040000
030500******************************************************************03050000
030600     EXEC SQL                                                     03060000
030700          INCLUDE TPKITEM                                         03070000
030800     END-EXEC.                                                    03080000
030900                                                                  03090000
031000******************************************************************03100000
031100* DB2 AREA FOR THE RECEIVER DIST HEADER TABLE                     03110000
031200******************************************************************03120000
031300     EXEC SQL                                                     03130000
031400          INCLUDE TDISTHD                                         03140000
031500     END-EXEC.                                                    03150000
031600                                                                  03160000
031700******************************************************************03170000
031800*    DB2 DCLGEN FOR DISTRIBUTION DETAIL TABLE                     03180000
031900******************************************************************03190000
032000     EXEC SQL                                                     03200000
032100          INCLUDE TDISTDT                                         03210000
032200     END-EXEC.                                                    03220000
032300                                                                  03230000
032400*---------------------------------------------------------------* 03240000
032500*    DB2 AREA FOR PURCHASE ORDER ITEM TABLE                     * 03250000
032600*---------------------------------------------------------------* 03260000
032700     EXEC SQL                                                     03270000
032800          INCLUDE TPURITM                                         03280000
032900     END-EXEC.                                                    03290000
033000*---------------------------------------------------------------* 03300000
033100*    DB2 AREA FOR VIRTUAL LABEL DATA TABLE                      * 03310000
033200*---------------------------------------------------------------* 03320000
033300     EXEC SQL                                                     03330000
033400          INCLUDE TLBVRDA                                         03340000
033500     END-EXEC.                                                    03350000
033600*---------------------------------------------------------------* 03360000
033700*    DB2 AREA FOR SHIPMENT TABLE                      *           03370000
033800*---------------------------------------------------------------* 03380000
033900     EXEC SQL                                                     03390000
034000          INCLUDE TSHIPMT                                         03400000
034100     END-EXEC.                                                    03410000
034200*---------------------------------------------------------------* 03420000
034300*    DB2 AREA                                                     03430000
034400*---------------------------------------------------------------* 03440000
034500     EXEC SQL                                                     03450000
034600          INCLUDE TINPKSU                                         03460000
034700     END-EXEC.                                                    03470000
034800*---------------------------------------------------------------* 03480000
034900*    DB2 AREA                                                     03490000
035000*---------------------------------------------------------------* 03500000
035100     EXEC SQL                                                     03510000
035200          INCLUDE TPURCHS                                         03520000
035300     END-EXEC.                                                    03530000
035400*---------------------------------------------------------------* 03540000
035500*    DB2 AREA                                                     03550000
035600*---------------------------------------------------------------* 03560000
035700     EXEC SQL                                                     03570000
035800          INCLUDE TSHPTPO                                         03580000
035900     END-EXEC.                                                    03590000
036000******************************************************************03600000
036100*---------------------------------------------------------------* 03610000
036200*    DB2 AREA FOR TRECDIS ORIGINAL DATA (RCT_RECDIS_ORIG)         03620000
036300*---------------------------------------------------------------* 03630000
036400     EXEC SQL                                                     03640000
036500          INCLUDE RCT00013                                        03650000
036600     END-EXEC.                                                    03660000
036700******************************************************************03670000
036800******************************************************************03680000
036900*  COMMUNICATIONS AREA FOR DB2                                    03690000
037000******************************************************************03700000
037100     EXEC SQL                                                     03710000
037200         INCLUDE SQLCA                                            03720000
037300     END-EXEC.                                                    03730000
037400                                                                  03740000
037500*----------------------------------------------------------------*03750000
037600*    DB2 CURSOR DEFINITION FOR RETRIEVAL OF RECITMS FOR A PACK-ID 03760000
037700*----------------------------------------------------------------*03770000
037800     EXEC SQL                                                     03780000
037900         DECLARE SHUUPC-CURSOR CURSOR FOR                         03790000
038000          SELECT TRN_LNE_NBR                                      03800000
038100               , SUM(SHPD_QTY)                                    03810000
038200            FROM TSHUUPC                                          03820000
038300           WHERE SHIPT_UNT_ID   = :DK-SHIPT-UNT-ID                03830000
038400           AND   SHPD_QTY       >  0                              03840000
038500        GROUP BY TRN_LNE_NBR                                      03850000
038510            with ur                                               03851016
038600     END-EXEC.                                                    03860000
038700                                                                  03870000
038800*----------------------------------------------------------------*03880000
038900*  CURSOR TO SELECT THE LINE(S), LINE NUMBER, PREPACK ID        * 03890000
039000*  AND SHIPPED QUANTITY                                         * 03900000
039100*---------------------------------------------------------------* 03910000
039200                                                                  03920000
039300                                                                  03930000
039400     EXEC SQL                                                     03940000
039500          DECLARE PREPK-CSR CURSOR FOR                            03950000
039600          SELECT D.PREPK_ID                                       03960000
039700                ,D.PREPK_RATO_QTY                                 03970000
039800                ,A.SHPD_QTY                                       03980000
039900                ,E.PREPK_LNE_PRC_CDE                              03990000
040000          FROM   TSHUUPC A                                        04000000
040100               , TINPKSU B                                        04010000
040200               , TPKSLIP C                                        04020000
040300               , TRECITM D                                        04030000
040400               , TDISTHD E                                        04040000
040500          WHERE A.SHIPT_UNT_ID = :DK-SHIPT-UNT-ID                 04050000
040600          AND  A.SHIPT_UNT_ID = B.SHIPT_UNT_ID                    04060000
040700          AND  B.PO_NBR       = C.PO_NBR                          04070000
040800          AND  B.SEQ_NBR      = C.SEQ_NBR                         04080000
040900          AND  C.VER_STAT_CDE = 'A'                               04090000
041000          AND  C.PO_NBR       = D.ORD_NBR                         04100000
041100          AND  C.REC_SEQ_NBR  = D.REC_SEQ_NBR                     04110000
041200          AND  C.REC_SEQ_NBR  = :SU044-ORIG-REC-SEQ-NBR           04120000
041300          AND  A.TRN_LNE_NBR  = D.ORD_LNE_NBR                     04130000
041400          AND  E.ORD_NBR      = C.PO_NBR                          04140000
041500          AND  E.RCVR_SEQ_NBR = C.REC_SEQ_NBR                     04150000
041600          AND  E.ORD_LNE_NBR  = D.ORD_LNE_NBR                     04160000
041700          AND  E.TOT_CART_CNT > 0                                 04170000
041710         with ur                                                  04171016
041800     END-EXEC                                                     04180000
041900                                                                  04190000
042000*---------------------------------------------------------------* 04200000
042100*  CURSOR TO DETERMINE ODD UNITS IN A PREPACK                   * 04210000
042200*  CARTON                                                       * 04220000
042300*---------------------------------------------------------------* 04230000
042400     EXEC SQL                                                     04240000
042500          DECLARE ODD-UNITS-CSR CURSOR FOR                        04250000
042600           SELECT 'A'                                             04260000
042700                , TRN_LNE_NBR                                     04270000
042800           FROM TSHUUPC                                           04280000
042900           WHERE SHIPT_UNT_ID = :DK-SHIPT-UNT-ID                  04290000
043000           UNION                                                  04300000
043100           SELECT 'B'                                             04310000
043200                 , B.ORD_LNE_NBR                                  04320000
043300           FROM  TRECITM A                                        04330000
043400               , TSHUUPC                                          04340000
043500               , TRECITM B                                        04350000
043600           WHERE A.ORD_NBR        = TRN_NBR                       04360000
043700               AND A.REC_SEQ_NBR  = :SU044-ORIG-REC-SEQ-NBR       04370000
043800               AND A.ORD_LNE_NBR  = TRN_LNE_NBR                   04380000
043900               AND SHIPT_UNT_ID   = :DK-SHIPT-UNT-ID              04390000
044000               AND B.ORD_NBR      = A.ORD_NBR                     04400000
044100               AND B.REC_SEQ_NBR  = A.REC_SEQ_NBR                 04410000
044200               AND B.PREPK_ID     = A.PREPK_ID                    04420000
044300           ORDER BY 2, 1                                          04430000
044310            with ur                                               04431016
044400     END-EXEC.                                                    04440000
044500                                                                  04450000
044600*---------------------------------------------------------------* 04460000
044700*  CURSOR TO SELECT THE LINE(S) AND NUMBER OF UNITS WITHIN A    * 04470000
044800*  CARTON                                                       * 04480000
044900*---------------------------------------------------------------* 04490000
045000     EXEC SQL                                                     04500000
045100          DECLARE UNITS-CSR CURSOR FOR                            04510000
045200          SELECT SHPD_QTY                                         04520000
045300                ,TRN_LNE_NBR                                      04530000
045400          FROM   TSHUUPC A                                        04540000
045500                ,TDISTHD B                                        04550000
045600          WHERE SHIPT_UNT_ID  = :DK-SHIPT-UNT-ID                  04560000
045700            AND A.TRN_NBR     =  B.ORD_NBR                        04570000
045800            AND A.TRN_LNE_NBR =  B.ORD_LNE_NBR                    04580000
045900            AND B.RCVR_SEQ_NBR = :SU044-ORIG-REC-SEQ-NBR          04590000
046000            AND B.TOT_CART_CNT > 0                                04600000
046100          ORDER BY 2                                              04610000
046110          with ur                                                 04611016
046200     END-EXEC                                                     04620000
046300                                                                  04630000
046400     EXEC SQL                                                     04640000
046500        DECLARE VRTL-LBL-INPK-CSR CURSOR FOR                      04650000
046600        SELECT   CART_LBL_TYP_CDE                                 04660000
046700                ,PREPK_PRCG_LNE_NBR                               04670000
046800                ,INPK_UNT_QTY                                     04680000
046900                ,PREPK_RATO_QTY                                   04690000
047000                ,DEST_OPER_UNT_ID                                 04700000
047100                ,CSE_PK_QTY                                       04710000
047200                ,ODD_CART_IND                                     04720000
047300                ,INPK_CNVYB_IND                                   04730000
047400                ,LBL_TYP_LBL_SEQ_ID                               04740000
047500                ,LBL_TYP_TOT_QTY                                  04750000
047600                ,BRCDE_NBR                                        04760000
047700                ,STR_ZN_ID                                        04770000
047800                ,MODU_DESC                                        04780000
047900                ,ITM_NBR                                          04790000
048000                ,DEPT_DESC                                        04800000
048100                ,MAJ_CL_DESC                                      04810000
048200                ,SEASET_NM                                        04820000
048300                ,FIXT_ID                                          04830000
048400                ,LBL_TYP_CDE                                      04840000
048500                ,PRNT_CART_SEQ_ID                                 04850000
048600                ,STRG_AREA_CDE                                    04860000
048700                ,INPK_UNT_QTY                                     04870000
048800        FROM TLBVRDA A                                            04880000
048900        WHERE  A.PO_NBR                =   :SU044-PO              04890000
049000          AND  A.RCVR_SEQ_NBR          =   :SU044-ORIG-REC-SEQ-NBR04900000
049100          AND  A.PO_LNE_NBR            =   :LBVRDA-PO-LNE-NBR     04910000
049200          AND  A.PREPK_ID              =   :RECITM-PREPK-ID       04920000
049300          AND  A.OTPK_UNT_QTY          =   :DK-OUTER-QTY          04930000
049400*         AND  A.LBL_ASG_IND           =   'N'                    04940000
049500          AND  A.PRNT_CART_SEQ_ID      =  :LBVRDA-PRNT-CART-SEQ-ID04950000
049600        ORDER BY LBL_TYP_LBL_SEQ_ID                               04960000
049700     END-EXEC                                                     04970000
049800******************************************************************04980000
049900 LINKAGE SECTION.                                                 04990000
050000 01  DFHCOMMAREA.                                                 05000000
050100     05  FILLER                         OCCURS  1 TO 4072 TIMES   05010000
050200                                      DEPENDING ON EIBCALEN.      05020000
050300         10  FILLER                   PIC X.                      05030000
050400******************************************************************05040000
050500                                                                  05050000
050600******************************************************************05060000
050700 PROCEDURE DIVISION.                                              05070000
050800******************************************************************05080000
050900 0000-PROGRAM-MAINLINE.                                           05090000
051000     INITIALIZE PV-PROGRAM-VARIABLES                              05100000
051100                PS-PROGRAM-SWITCHES                               05110000
051200                SU044-COMM-AREA.                                  05120000
051210                                                                  05121004
051220     SET PS-BLD-INTERNAL-TABLE-NO  TO  TRUE.                      05122004
051221     MOVE 999999999                TO  PV-PARM-SECONDS.           05122112
051222                                                                  05122212
051223     EXEC SQL                                                     05122312
051224          SET :PV-CURRENT-PARA-TMST = CURRENT TIMESTAMP           05122412
051225     END-EXEC.                                                    05122512
051226                                                                  05122612
051227     MOVE  PV-CURRENT-PARA-TMST  TO  PV-RECEIVE-RQST-TMST.        05122720
051228                                                                  05122812
051229     MOVE  PV-INIT-HH            TO  PV-INIT-KEY-HH.              05122920
051231     MOVE  PV-INIT-MM            TO  PV-INIT-KEY-MM.              05123120
051233     MOVE  PV-INIT-SS            TO  PV-INIT-KEY-SS.              05123320
051240                                                                  05124004
051300     MOVE  'N' TO  PS-MORE-SHUUPC-SW                              05130000
051400                   PS-LOG-MESSAGE-SW                              05140000
051500                   PS-PROCESS-ODD-UNITS-SW                        05150000
051600                   PS-BEFORE-ONLY-LOGGING-SW                      05160000
051700                   PS-TROUBLE-CREATE-SW                           05170000
051800                   PS-ODD-UNT-CRTN-FOUND-SW                       05180000
051900                   PS-EO-UNITS-CSR-SW                             05190000
052000                   PS-EO-PREPK-CSR-SW                             05200000
052100                   PS-END-OF-VRTL-LBL-CSR-SW                      05210000
052200                   PS-ERROR-SW                                    05220000
052300                   PS-PKSLIP-INSERT-SW                            05230000
052400                   PS-SUCCESSFUL-UPDATE-SW                        05240000
052500                   PS-LABEL-DATA-FOUND-SW                         05250000
052600                   PS-UPDATE-TPKITEM-SW                           05260000
052700                   PS-UPDATE-PKSLIP-ONLY-SW                       05270000
052800     MOVE  'Y' TO  PS-FIRST-ODD-UNTS-FETCH-SW                     05280000
052900                   PS-FIRST-PKSLIP-LINE-SW                        05290000
053000                   PS-FOUND-ON-ODD-UNTS-CSR-SW                    05300000
053100                   PS-FIRST-PO-LINE-SW                            05310000
053200                   PS-FOUND-ON-CURSOR-SW                          05320000
053300                   PS-FIRST-PREPK-SW                              05330000
053400                   PS-FIRST-PREPK-LINE-SW                         05340000
053500                   PS-FIRST-INPK-CNVY-SW.                         05350000
053600                                                                  05360000
053700     MOVE DFHCOMMAREA              TO  SU044-COMM-AREA.           05370000
053800     MOVE SU044-OPER-UNT-ID        TO DK-OPER-UNT-ID.             05380000
053900     SET PS-NO-ERROR TO TRUE.                                     05390000
054000     PERFORM 8000-CHECK-FOR-LOGGING.                              05400000
054100     IF PS-LOG-MESSAGE                                            05410000
054200         MOVE SU044-PO               TO PV-DISP-PO                05420000
054300         MOVE SU044-ORIG-REC-SEQ-NBR TO  PV-DISP-RCVR-SEQ-NBR     05430000
054400         MOVE SU044-SHIPT-UNT-ID     TO  PV-DISP-SHIPT-UNT-ID     05440000
054500         STRING   ' SUKUT704 PROGRAM STARTED -'                   05450000
054600                  ' CALLED BY-'                                   05460000
054700                  SU044-PROGRAM-NAME                              05470000
054800                  ' PO='                                          05480000
054900                  PV-DISP-PO                                      05490000
055000                  ' RCVR='                                        05500000
055100                  PV-DISP-RCVR-SEQ-NBR                            05510000
055200                  ' CARTON='                                      05520000
055300                  PV-DISP-SHIPT-UNT-ID                            05530000
055400                  DELIMITED BY SIZE                               05540000
055500                                  INTO PV-CICS-MSG-AREA           05550000
055600         MOVE PV-CICS-MSG-AREA      TO SU044-CRA-RET-MSG          05560000
055700         PERFORM 9999-WRITE-TO-CSSL                               05570000
055800         MOVE SU044-SUCCESS-IND TO PV-CICS-MSG-AREA               05580000
055900         PERFORM 9999-WRITE-TO-CSSL                               05590000
056000     END-IF.                                                      05600000
056100                                                                  05610000
056110     PERFORM 8100-CHECK-PARA-TRACK-SEC.                           05611012
056120                                                                  05612012
056200     PERFORM 1000-PROCESS-CARTON-PACKSLIP.                        05620000
056300                                                                  05630000
056400     MOVE SU044-COMM-AREA               TO DFHCOMMAREA.           05640000
056410                                                                  05641005
056420* 02/01/15 begin                                                  05642005
056430     IF  PS-BLD-INTERNAL-TABLE-YES  and                           05643005
056440         PV-DURATION-sec       >=  PV-PARM-SECONDS                05644023
056450                                                                  05645005
056460         move spaces to  pv-ciCS-MSG-AREA-3                       05646019
056470         PERFORM 9997-WRITE-TO-CSSL                               05647011
056480                                                                  05648005
056481         move '0000'  to  PV-CSSL-PARA                            05648120
056490         perform 8110-WRITE-suws044-TO-CSSL                       05649005
056491                                                                  05649105
056492         move spaces to  pv-ciCS-MSG-AREA-3                       05649219
056493         PERFORM 9997-WRITE-TO-CSSL                               05649305
056494                                                                  05649405
056495         STRING ' SUKUT704-DID NOT MEET SLA'                      05649505
056496                ' DC:'        PV-DISP-OPER                        05649605
056497                ' CRTN OPER:' PV-DISP-CRTN-OPER                   05649705
056498                ' SSCC:'      PV-DISP-SSCC                        05649805
056499                              DELIMITED BY SIZE                   05649905
056500                         INTO PV-CICS-MSG-AREA-3                  05650019
056501         PERFORM 9997-WRITE-TO-CSSL                               05650105
056502                                                                  05650221
056503         INITIALIZE PV-CICS-MSG-AREA-3                            05650321
056504         STRING ' SUKUT704 '                                      05650422
056505                ' START:'     PV-RECEIVE-RQST-TMST                05650521
056506                ' END:'       PV-CURRENT-PARA-TMST                05650621
056507                ' KEY:'       PV-INIT-TIME-KEY                    05650721
056508                ' DURATION:'  PV-DISP-NANO-SEC                    05650821
056509                              DELIMITED BY SIZE                   05650921
056510                         INTO PV-CICS-MSG-AREA-3                  05651024
056511         PERFORM 9997-WRITE-TO-CSSL                               05651121
056512                                                                  05651221
056513                                                                  05651321
056514         PERFORM 8140-DUMP-TABLE-TO-CSSL                          05651421
056515         VARYING PT-TRACK-IDX                                     05651521
056516            FROM 1 BY 1                                           05651621
056517           UNTIL PT-TRACK-IDX >  PT-CURR-ENTRIES                  05651721
056518              OR PT-TRACK-IDX >  PT-MAX-PARA-ENTRIES              05651821
056519                                                                  05651921
056520         PERFORM 8150-CLEAR-TABLE                                 05652021
056521         VARYING PT-TRACK-IDX                                     05652121
056522            FROM 1 BY 1                                           05652221
056523            UNTIL PT-TRACK-IDX >  PT-CURR-ENTRIES                 05652321
056524               OR PT-TRACK-IDX >  PT-MAX-PARA-ENTRIES             05652421
056525                                                                  05652521
056526         MOVE ZEROES TO PT-CURR-ENTRIES                           05652621
056527         SET  PT-TRACK-IDX  to  PT-CURR-ENTRIES                   05652721
056528                                                                  05652821
056529         INITIALIZE PV-CICS-MSG-AREA-3                            05652921
056530         MOVE PV-DURATION-SEC TO  PV-DISP-DURATION                05653021
056531         STRING ' SUKUT704-DID NOT MEET SLA'                      05653121
056532                ' DC:'        PV-DISP-OPER                        05653221
056533                ' CRTN OPER:' PV-DISP-CRTN-OPER                   05653321
056534                ' SSCC:'      PV-DISP-SSCC                        05653421
056535                ' DONE'                                           05653521
056536                              DELIMITED BY SIZE                   05653621
056537                         INTO PV-CICS-MSG-AREA-3                  05653721
056538         PERFORM 9997-WRITE-TO-CSSL                               05653821
056539                                                                  05653921
056542     end-if.                                                      05654221
056543                                                                  05654321
056544* 02/01/15 end                                                    05654421
056545                                                                  05654521
056550                                                                  05655000
056600     GOBACK.                                                      05660000
056700                                                                  05670000
056800 1000-PROCESS-CARTON-PACKSLIP.                                    05680000
056810                                                                  05681013
056820     IF  PS-BLD-INTERNAL-TABLE-YES                                05682013
056830         MOVE  '1000'  TO  PT-CURR-PARA                           05683013
056840         PERFORM 8120-INTERNAL-TABLE                              05684013
056850     END-IF.                                                      05685013
056900                                                                  05690000
057000     IF PS-LOG-MESSAGE                                            05700000
057100        MOVE ' SUKUT704-1000-PROCESS-CARTON-PACKSLIP'             05710002
057300                                    TO PV-CICS-MSG-AREA           05730002
057400        PERFORM 9999-WRITE-TO-CSSL                                05740000
057500         MOVE SU044-SUCCESS-IND TO PV-CICS-MSG-AREA               05750000
057600         PERFORM 9999-WRITE-TO-CSSL                               05760000
057700     END-IF                                                       05770000
057800                                                                  05780000
057900     INITIALIZE DCLTPKSLIP.                                       05790000
058000     MOVE SU044-SHIPT-UNT-ID TO DK-SHIPT-UNT-ID                   05800000
058100     IF SU044-CREATE-PKSLIP                                       05810000
058200         PERFORM 1200-PROCESS-CRE-AND-DETACH                      05820000
058300         PERFORM 4000-PROCESS-SHUUPC-CURSOR                       05830000
058400     ELSE                                                         05840000
058500         PERFORM 1500-PROCESS-DETACH-ONLY                         05850000
058600     END-IF.                                                      05860000
058700                                                                  05870000
058800     IF PS-TROUBLE-CREATE-YES AND SU044-SRC-CHECKIN               05880000
058900        PERFORM 7100-CREATE-TROUBLE                               05890000
059000     END-IF.                                                      05900000
059100                                                                  05910000
059200     IF SU044-RCVR-BULK OR SU044-RCVR-PREPK                       05920000
059300        PERFORM 7200-LINK-SUKUT708                                05930000
059400     END-IF.                                                      05940000
059500                                                                  05950000
059600                                                                  05960000
059700 1200-PROCESS-CRE-AND-DETACH.                                     05970000
059710                                                                  05971013
059720     IF  PS-BLD-INTERNAL-TABLE-YES                                05972013
059730         MOVE  '1200'  TO  PT-CURR-PARA                           05973013
059740         PERFORM 8120-INTERNAL-TABLE                              05974013
059750     END-IF.                                                      05975013
059760                                                                  05976013
059800     IF PS-LOG-MESSAGE                                            05980000
059900        MOVE ' SUKUT704-1200-PROCESS-CRE-AND-DETACH '             05990002
060100                                    TO PV-CICS-MSG-AREA           06010002
060200        PERFORM 9999-WRITE-TO-CSSL                                06020000
060300         MOVE SU044-SUCCESS-IND TO PV-CICS-MSG-AREA               06030000
060400         PERFORM 9999-WRITE-TO-CSSL                               06040000
060500     END-IF                                                       06050000
060600     PERFORM 3000-ADD-PACK-SLIP-HEADER.                           06060000
060700*                                                                 06070000
060800                                                                  06080000
060900 1500-PROCESS-DETACH-ONLY.                                        06090000
060910                                                                  06091013
060920     IF  PS-BLD-INTERNAL-TABLE-YES                                06092013
060930         MOVE  '1500'  TO  PT-CURR-PARA                           06093013
060940         PERFORM 8120-INTERNAL-TABLE                              06094013
060950     END-IF.                                                      06095013
060960                                                                  06096013
061000     IF PS-LOG-MESSAGE                                            06100000
061100        MOVE ' SUKUT704-1500-PROCESS-DETACH-ONLY '                06110002
061300                                    TO PV-CICS-MSG-AREA           06130002
061400        PERFORM 9999-WRITE-TO-CSSL                                06140000
061500     END-IF                                                       06150000
061600                                                                  06160000
061700     PERFORM 4100-PROCSS-SHUUPC-CSR-DETACH.                       06170000
061800                                                                  06180000
061900                                                                  06190000
062000 3000-ADD-PACK-SLIP-HEADER.                                       06200000
062010                                                                  06201013
062020     IF  PS-BLD-INTERNAL-TABLE-YES                                06202013
062030         MOVE  '3000'  TO  PT-CURR-PARA                           06203013
062040         PERFORM 8120-INTERNAL-TABLE                              06204013
062050     END-IF.                                                      06205013
062100                                                                  06210000
062200     IF PS-LOG-MESSAGE                                            06220000
062300        MOVE ' SUKUT704-3000-ADD-PACK-SLIP-HEADER '               06230002
062500                                    TO PV-CICS-MSG-AREA           06250002
062600        PERFORM 9999-WRITE-TO-CSSL                                06260000
062700         MOVE SU044-SUCCESS-IND TO PV-CICS-MSG-AREA               06270000
062800         PERFORM 9999-WRITE-TO-CSSL                               06280000
062900     END-IF                                                       06290000
063000     INITIALIZE DCLTPKSLIP.                                       06300000
063100                                                                  06310000
063200     MOVE SU044-OPER-UNT-ID        TO DK-OPER-UNT-ID.             06320000
063300     MOVE SU044-FCLTY-ID           TO DK-FCLTY-ID.                06330000
063400     MOVE SU044-DEST-STR-NBR       TO DK-STR-NBR.                 06340000
063500     MOVE ZEROES                   TO PKSLIP-PKSL-PG-CNT.         06350000
063600                                                                  06360000
063700     MOVE +0                       TO PKSLIP-EXPTED-PKG-QTY.      06370000
063800                                                                  06380000
063900     MOVE SU044-SCAC-ID            TO PKSLIP-OWNER-SCAC-ID.       06390000
064000                                                                  06400000
064100                                                                  06410000
064200     MOVE SU044-NEW-REC-SEQ-NBR    TO PKSLIP-REC-SEQ-NBR.         06420000
064300     MOVE SU044-NEW-SHIP           TO PKSLIP-SHIPT-ID.            06430000
064400     MOVE SU044-ORIG-BOL-NBR       TO PKSLIP-BOL-NBR.             06440000
064500     MOVE SU044-ORIG-PRO-NBR       TO PKSLIP-PRO-NBR.             06450000
064600     MOVE PC-FA                    TO PKSLIP-CRE-SRC-CDE.         06460000
064700     MOVE PC-IN                    TO PKSLIP-PKSL-STAT-CDE.       06470000
064800     MOVE PC-A                     TO PKSLIP-VER-STAT-CDE.        06480000
064900                                                                  06490000
065000     IF SU044-OPER-UNT-ID = SU044-CRTN-OPER-UNT-ID                06500000
065100        MOVE PC-FRASTY-CRE-USER-ID    TO PKSLIP-CRE-UID           06510000
065200                                         PKSLIP-PKSL-NBR          06520000
065300     ELSE                                                         06530000
065400       IF SU044-RCVR-PBS                                          06540000
065500          MOVE SU044-CRTN-OPER-UNT-ID   TO PV-MISDIRECT-OPER-ID   06550000
065600                                           DK-OPER-UNT-ID         06560000
065700          MOVE PV-MISDIRECT-OPER-ID     TO PV-MIS-FA-CRE-OPER     06570000
065800          MOVE 'PBSM'                   TO PV-MIS-FA-CRE-SYST     06580000
065900          MOVE PV-MISDIRECT-FA-CREATE-SRCE TO PKSLIP-CRE-UID      06590000
066000                                              PKSLIP-PKSL-NBR     06600000
066100       ELSE                                                       06610000
066200          MOVE SU044-CRTN-OPER-UNT-ID   TO PV-MISDIRECT-OPER-ID   06620000
066300          MOVE PV-MISDIRECT-OPER-ID     TO PV-MIS-FA-CRE-OPER     06630000
066400          MOVE 'FASY'                   TO PV-MIS-FA-CRE-SYST     06640000
066500          MOVE PV-MISDIRECT-FA-CREATE-SRCE TO PKSLIP-CRE-UID      06650000
066600                                              PKSLIP-PKSL-NBR     06660000
066700       END-IF                                                     06670000
066800     END-IF                                                       06680000
066900                                                                  06690000
067000                                                                  06700000
067100     MOVE SU044-ORIG-PKSL-SEQ-NBR                                 06710000
067200                         TO PKSLIP-ORIG-PKSL-SEQ-NBR.             06720000
067300     PERFORM 3100-GET-PO-VER-NBR.                                 06730000
067400     MOVE PURCHS-VER-NBR           TO PKSLIP-PO-VER-NBR.          06740000
067500                                                                  06750000
067600     PERFORM 3130-GET-NEXT-SEQ-NBR.                               06760000
067700     MOVE PV-NEXT-SEQ-NBR          TO PKSLIP-SEQ-NBR              06770000
067800                                      SU044-NEW-PKSL-SEQ-NBR.     06780000
067900     PERFORM 3160-GET-VEND-SHIP-DTE.                              06790000
068000                                                                  06800000
068100     PERFORM 3200-CONTINUE-INSERT.                                06810000
068200                                                                  06820000
068300 3100-GET-PO-VER-NBR.                                             06830000
068310                                                                  06831013
068320     IF  PS-BLD-INTERNAL-TABLE-YES                                06832013
068330         MOVE  '3100'  TO  PT-CURR-PARA                           06833013
068340         PERFORM 8120-INTERNAL-TABLE                              06834013
068350     END-IF.                                                      06835013
068400                                                                  06840000
068500     IF PS-LOG-MESSAGE                                            06850000
068600        MOVE ' SUKUT704-3100-GET-PO-VER-NBR '                     06860002
068800                                    TO PV-CICS-MSG-AREA           06880002
068900        PERFORM 9999-WRITE-TO-CSSL                                06890000
069000         MOVE SU044-SUCCESS-IND TO PV-CICS-MSG-AREA               06900000
069100         PERFORM 9999-WRITE-TO-CSSL                               06910000
069200     END-IF                                                       06920000
069300                                                                  06930000
069400     EXEC SQL                                                     06940000
069500          SELECT VER_NBR                                          06950000
069600            INTO :PURCHS-VER-NBR                                  06960000
069700            FROM TPURCHS                                          06970000
069800           WHERE PO_NBR         = :SU044-PO                       06980000
069900             AND VER_STATUS_CDE = :PC-A                           06990000
069910            with ur                                               06991016
070000     END-EXEC                                                     07000000
070100                                                                  07010000
070200     EVALUATE TRUE                                                07020000
070300         WHEN SQLCODE = ZERO                                      07030000
070400             CONTINUE                                             07040000
070500         WHEN SQLCODE = +100                                      07050000
070600         WHEN SQLWARN0 NOT = SPACES                               07060000
070700         WHEN SQLCODE  NOT = ZERO                                 07070000
070710                                                                  07071015
070720              MOVE '3100'  TO  PV-CSSL-PARA                       07072015
070730              perform 8110-WRITE-suws044-TO-CSSL                  07073015
070740                                                                  07074015
070800             SET SU044-INVALID-SQL                                07080000
070900                 PS-ERROR             TO TRUE                     07090017
071000             MOVE SU044-PO            TO  PV-DISP-PO              07100017
071100             MOVE SU044-NEW-REC-SEQ-NBR                           07110000
071200                                      TO PV-DISP-RCVR-SEQ-NBR     07120000
071300             MOVE SHUUPC-TRN-LNE-NBR  TO PV-DISP-PO-LNE-NBR       07130000
071400             MOVE DK-OPER-UNT-ID      TO PV-DISP-OPER-UNT-ID      07140000
071410             MOVE SQLCODE             TO PV-DISP-SQLCODE          07141017
071500             STRING   ' SUKUT704-3100-'                           07150000
071600                      ' CALLED BY:'      SU044-PROGRAM-NAME       07160017
071700                      ' SQL:'            PV-DISP-SQLCODE          07170017
071800                      ' PO:'             PV-DISP-OPER-UNT-ID      07180017
071900                      '-'                PV-DISP-PO               07190017
072100                      '-'                PV-DISP-RCVR-SEQ-NBR     07210017
072400                      DELIMITED BY SIZE                           07240000
072500                                      INTO PV-CICS-MSG-AREA       07250000
072600             PERFORM 9999-WRITE-TO-CSSL                           07260000
072700             MOVE PV-CICS-MSG-AREA      TO SU044-CRA-RET-MSG      07270000
072800     END-EVALUATE.                                                07280000
072900                                                                  07290000
073000 3130-GET-NEXT-SEQ-NBR.                                           07300000
073010                                                                  07301013
073020     IF  PS-BLD-INTERNAL-TABLE-YES                                07302013
073030         MOVE  '3130'  TO  PT-CURR-PARA                           07303013
073040         PERFORM 8120-INTERNAL-TABLE                              07304013
073050     END-IF.                                                      07305013
073100                                                                  07310000
073200     IF PS-LOG-MESSAGE                                            07320000
073300        MOVE ' SUKUT704-3130-GET-NEXT-SEQ-NBR'                    07330002
073500                                    TO PV-CICS-MSG-AREA           07350002
073600        PERFORM 9999-WRITE-TO-CSSL                                07360000
073700         MOVE SU044-SUCCESS-IND TO PV-CICS-MSG-AREA               07370000
073800         PERFORM 9999-WRITE-TO-CSSL                               07380000
073900     END-IF                                                       07390000
074000                                                                  07400000
074100     MOVE ZEROS                    TO PV-MAX-SEQ-NBR.             07410000
074200                                                                  07420000
074300     EXEC SQL                                                     07430000
074400          SELECT MAX(SEQ_NBR)                                     07440000
074500            INTO :PV-MAX-SEQ-NBR :DN-SEQ-NBR-IND                  07450000
074600            FROM TPKSLIP                                          07460000
074700           WHERE PO_NBR = :SU044-PO                               07470000
074800     END-EXEC                                                     07480000
074900                                                                  07490000
075000     EVALUATE TRUE                                                07500000
075100         WHEN SQLCODE = +0                                        07510000
075200            IF DN-SEQ-NBR-IND = -1                                07520000
075300               MOVE +1          TO PV-NEXT-SEQ-NBR                07530000
075400            ELSE                                                  07540000
075500               COMPUTE PV-NEXT-SEQ-NBR = PV-MAX-SEQ-NBR + 1       07550000
075600            END-IF                                                07560000
075700         WHEN SQLCODE = +100                                      07570000
075800            MOVE +1          TO PV-NEXT-SEQ-NBR                   07580000
075900         WHEN SQLWARN0 NOT = SPACES                               07590000
076000         WHEN SQLCODE  NOT = ZERO                                 07600000
076010                                                                  07601015
076020              MOVE '3130'  TO  PV-CSSL-PARA                       07602015
076030              perform 8110-WRITE-suws044-TO-CSSL                  07603015
076040                                                                  07604015
076100             SET SU044-INVALID-SQL     TO TRUE                    07610000
076200             MOVE SU044-PO             TO  PV-DISP-PO             07620017
076300             MOVE SU044-NEW-REC-SEQ-NBR                           07630000
076400                                       TO PV-DISP-RCVR-SEQ-NBR    07640017
076500             MOVE SHUUPC-TRN-LNE-NBR   TO PV-DISP-PO-LNE-NBR      07650017
076600             MOVE DK-OPER-UNT-ID       TO PV-DISP-OPER-UNT-ID     07660017
076610             MOVE SQLCODE              TO PV-DISP-SQLCODE         07661017
076700             STRING   ' SUKUT704-3130-'                           07670015
076800                      ' CALLED BY:'       SU044-PROGRAM-NAME      07680017
076810                      ' SQL:'             PV-DISP-SQLCODE         07681017
077000                      ' PO:'              PV-DISP-OPER-UNT-ID     07700017
077100                      '-'                 PV-DISP-PO              07710017
077300                      '-'                 PV-DISP-RCVR-SEQ-NBR    07730017
077600                                          DELIMITED BY SIZE       07760017
077700                                     INTO PV-CICS-MSG-AREA        07770017
077800             PERFORM 9999-WRITE-TO-CSSL                           07780000
077900             MOVE PV-CICS-MSG-AREA      TO SU044-CRA-RET-MSG      07790000
078000     END-EVALUATE.                                                07800000
078100                                                                  07810000
078200 3160-GET-VEND-SHIP-DTE.                                          07820000
078300                                                                  07830000
078320     IF  PS-BLD-INTERNAL-TABLE-YES                                07832013
078330         MOVE  '3160'  TO  PT-CURR-PARA                           07833013
078340         PERFORM 8120-INTERNAL-TABLE                              07834013
078350     END-IF.                                                      07835013
078360                                                                  07836013
078400     EXEC SQL                                                     07840000
078500         SELECT VEND_SHIP_DTE                                     07850000
078600             ,  ASN_NBR                                           07860000
078610             ,  OPER_UNT_ID                                       07861001
078700         INTO :PKSLIP-VEND-SHIP-DTE                               07870000
078800             ,:PKSLIP-ASN-NBR                                     07880000
078810             ,:PKSLIP-OPER-UNT-ID                                 07881001
078900           FROM TPKSLIP A                                         07890000
079000          WHERE A.PO_NBR         =  :SU044-PO                     07900000
079100            AND A.SEQ_NBR        =  :SU044-ORIG-PKSL-SEQ-NBR      07910000
079200            AND A.VER_STAT_CDE   =  'A'                           07920000
079210           with ur                                                07921016
079300     END-EXEC.                                                    07930000
079400                                                                  07940000
079500     EVALUATE TRUE                                                07950000
079600         WHEN SQLCODE = +0                                        07960000
079700            CONTINUE                                              07970000
079800         WHEN SQLCODE = +100                                      07980000
079900            MOVE PC-DEFAULT-DATE          TO PKSLIP-VEND-SHIP-DTE 07990000
080000         WHEN SQLWARN0 NOT = SPACES                               08000000
080100         WHEN SQLCODE  NOT = ZERO                                 08010000
080110                                                                  08011015
080120              MOVE '3160'  TO  PV-CSSL-PARA                       08012015
080130              perform 8110-WRITE-suws044-TO-CSSL                  08013015
080140                                                                  08014015
080200             SET SU044-INVALID-SQL         TO TRUE                08020017
080300             MOVE SU044-PO                 TO PV-DISP-PO          08030017
080400             MOVE SU044-ORIG-PKSL-SEQ-NBR  TO PV-DISP-SEQ-NBR     08040017
080410             MOVE SQLCODE                  TO PV-DISP-SQLCODE     08041017
080500                                                                  08050017
080600             STRING   ' SUKUT704-3160-'                           08060000
080700                      ' CALLED BY:'           SU044-PROGRAM-NAME  08070017
080800                      ' SQL:'                 PV-DISP-SQLCODE     08080017
080900                      ' PO:'                  PV-DISP-PO          08090017
081100                      ' SEQ:'                 PV-DISP-SEQ-NBR     08110017
081200                                              DELIMITED BY SIZE   08120017
081300                                         INTO PV-CICS-MSG-AREA    08130017
081500             PERFORM 9999-WRITE-TO-CSSL                           08150000
081600             MOVE PV-CICS-MSG-AREA      TO SU044-CRA-RET-MSG      08160000
081700     END-EVALUATE.                                                08170000
081800                                                                  08180000
081900 3200-CONTINUE-INSERT.                                            08190000
081910                                                                  08191013
081920     IF  PS-BLD-INTERNAL-TABLE-YES                                08192013
081930         MOVE  '3200'  TO  PT-CURR-PARA                           08193013
081940         PERFORM 8120-INTERNAL-TABLE                              08194013
081950     END-IF.                                                      08195013
082000                                                                  08200000
082100     SET PS-PKSLIP-NOT-INSERTED    TO TRUE.                       08210000
082200     PERFORM 3210-GET-CURRENT-TMST.                               08220000
082300     PERFORM 3220-INSERT-LOOP                                     08230000
082400             UNTIL PS-PKSLIP-INSERTED.                            08240000
082500                                                                  08250000
082600 3210-GET-CURRENT-TMST.                                           08260000
082610                                                                  08261013
082620     IF  PS-BLD-INTERNAL-TABLE-YES                                08262013
082630         MOVE  '3210'  TO  PT-CURR-PARA                           08263013
082640         PERFORM 8120-INTERNAL-TABLE                              08264013
082650     END-IF.                                                      08265013
082700                                                                  08270000
082800     IF PS-LOG-MESSAGE                                            08280000
082900        MOVE 'SUKUT704-3210-GET-CURRENT-TMST'                     08290002
083100                                    TO PV-CICS-MSG-AREA           08310002
083200        PERFORM 9999-WRITE-TO-CSSL                                08320000
083300         MOVE SU044-SUCCESS-IND TO PV-CICS-MSG-AREA               08330000
083400         PERFORM 9999-WRITE-TO-CSSL                               08340000
083500     END-IF                                                       08350000
083600                                                                  08360000
083700                                                                  08370000
083800     EXEC SQL                                                     08380000
083900          SET :PV-DB2-TMST         =  CURRENT TIMESTAMP           08390000
084000     END-EXEC.                                                    08400000
084100                                                                  08410000
084200     EVALUATE TRUE                                                08420000
084300         WHEN SQLCODE = ZERO                                      08430000
084400           SET PV-DB2-TMST-SS-01                                  08440000
084500               PV-DB2-TMST-MS-ZERO   TO  TRUE                     08450000
084600         WHEN SQLWARN0 NOT = SPACES                               08460000
084700         WHEN SQLCODE  NOT = ZERO                                 08470000
084710                                                                  08471015
084720              MOVE '3210'  TO  PV-CSSL-PARA                       08472015
084730              perform 8110-WRITE-suws044-TO-CSSL                  08473015
084740                                                                  08474015
084800             SET SU044-INVALID-SQL      TO TRUE                   08480017
084900             MOVE SU044-PO              TO  PV-DISP-PO            08490017
085000             MOVE SU044-NEW-REC-SEQ-NBR TO PV-DISP-RCVR-SEQ-NBR   08500017
085200             MOVE SHUUPC-TRN-LNE-NBR    TO PV-DISP-PO-LNE-NBR     08520017
085300             MOVE DK-OPER-UNT-ID        TO PV-DISP-OPER-UNT-ID    08530017
085400             STRING   ' SUKUT704-3210-'                           08540000
085500                      ' CALLED BY:'        SU044-PROGRAM-NAME     08550017
085600                      ' SQL:'              PV-DISP-SQLCODE        08560017
085700                      ' PO:'               PV-DISP-OPER-UNT-ID    08570017
085800                      '-'                  PV-DISP-PO             08580017
086000                      '-'                  PV-DISP-RCVR-SEQ-NBR   08600017
086100                      '-'                  PV-DISP-PO-LNE-NBR     08610017
086300                                           DELIMITED BY SIZE      08630017
086400                                      INTO PV-CICS-MSG-AREA       08640000
086500             PERFORM 9999-WRITE-TO-CSSL                           08650000
086600             MOVE PV-CICS-MSG-AREA      TO SU044-CRA-RET-MSG      08660000
086700     END-EVALUATE.                                                08670000
086800/                                                                 08680000
086900*----------------------------------------------------------------*08690000
087000*    THIS ROUTINE ADDED TO PRECLUDE LOGICAL DUPLICATES FROM      *08700000
087100*    BEING INSERTED.  WHEN 2 USERS ARE ADDING PACK SLIPS TO      *08710000
087200*    THE SAME PO, IT IS POSSIBLE TO OBTAIN THE SAME SEQUENCE     *08720000
087300*    NUMBER (LOGICAL DUPLICATE).  BECAUSE THE TIMSTAMP IS PART   *08730000
087400*    OF THE PHYSICAL KEY, NO -803 OCCURS.  IN 5001, WE FORCE     *08740000
087500*    A 01 IN THE SECONDS FIELD AND ALL ZEROES IN THE MICRO-      *08750000
087600*    SECONDS FIELD.  THIS WILL CAUSE A -803 WHICH IS HANDLED     *08760000
087700*    HERE BY ADDING 1 TO THE SEQUENCE NUMBER.                    *08770000
087800*----------------------------------------------------------------*08780000
087900                                                                  08790000
088000 3220-INSERT-LOOP.                                                08800000
088010                                                                  08801013
088020     IF  PS-BLD-INTERNAL-TABLE-YES                                08802013
088030         MOVE  '3220'  TO  PT-CURR-PARA                           08803013
088040         PERFORM 8120-INTERNAL-TABLE                              08804013
088050     END-IF.                                                      08805013
088100                                                                  08810000
088200     PERFORM 3240-INSERT-TPKSLIP.                                 08820000
088300                                                                  08830000
088400                                                                  08840000
088500 3240-INSERT-TPKSLIP.                                             08850000
088510                                                                  08851013
088520     IF  PS-BLD-INTERNAL-TABLE-YES                                08852013
088530         MOVE  '3240'  TO  PT-CURR-PARA                           08853013
088540         PERFORM 8120-INTERNAL-TABLE                              08854013
088550     END-IF.                                                      08855013
088600                                                                  08860000
088700     IF PS-LOG-MESSAGE                                            08870000
088800        MOVE 'SUKUT704-3240-INSERT-TPKSLIP '                      08880002
089000                                    TO PV-CICS-MSG-AREA           08900002
089100        PERFORM 9999-WRITE-TO-CSSL                                08910000
089200         MOVE SU044-SUCCESS-IND TO PV-CICS-MSG-AREA               08920000
089300         PERFORM 9999-WRITE-TO-CSSL                               08930000
089400     END-IF                                                       08940000
089500                                                                  08950000
089600                                                                  08960000
089700     EXEC SQL                                                     08970000
089800        INSERT INTO TPKSLIP                                       08980000
089900            (PO_NBR,                                              08990000
090000             SEQ_NBR,                                             09000000
090100             CRE_TMST,                                            09010000
090200             VER_STAT_CDE,                                        09020000
090300             OPER_UNT_ID,                                         09030000
090400             FCLTY_ID,                                            09040000
090500             PKSL_NBR,                                            09050000
090600             STR_DEST_NBR,                                        09060000
090700             REC_SEQ_NBR,                                         09070000
090800             SHIPT_ID,                                            09080000
090900             BOL_NBR,                                             09090000
091000             PRO_NBR,                                             09100000
091100             PKSL_STAT_CDE,                                       09110000
091200             CRE_UID,                                             09120000
091300             PO_VER_NBR,                                          09130000
091400             CRE_SRC_CDE,                                         09140000
091500             EXPTED_PKG_QTY,                                      09150000
091600             OWNER_SCAC_ID,                                       09160000
091700             ASN_NBR,                                             09170000
091800             VEND_SHIP_DTE,                                       09180000
091900             PKSL_PG_CNT,                                         09190000
092000             CONTNR_ID,                                           09200000
092100             ORIG_PKSL_SEQ_NBR)                                   09210000
092200     VALUES (:SU044-PO,                                           09220000
092300             :PKSLIP-SEQ-NBR,                                     09230000
092400             :PV-DB2-TMST,                                        09240000
092500             :PC-A,                                               09250000
092600             :PKSLIP-OPER-UNT-ID,                                 09260001
092610***          :DK-OPER-UNT-ID,                                     09261001
092700             :DK-FCLTY-ID,                                        09270000
092800             :PKSLIP-PKSL-NBR,                                    09280000
092900             :DK-STR-NBR,                                         09290000
093000             :PKSLIP-REC-SEQ-NBR,                                 09300000
093100             :PKSLIP-SHIPT-ID,                                    09310000
093200             :PKSLIP-BOL-NBR,                                     09320000
093300             :PKSLIP-PRO-NBR,                                     09330000
093400             :PKSLIP-PKSL-STAT-CDE,                               09340000
093500             :PKSLIP-CRE-UID,                                     09350000
093600             :PKSLIP-PO-VER-NBR,                                  09360000
093700             :PKSLIP-CRE-SRC-CDE,                                 09370000
093800             :PKSLIP-EXPTED-PKG-QTY,                              09380000
093900             :PKSLIP-OWNER-SCAC-ID,                               09390000
094000             :PKSLIP-ASN-NBR,                                     09400000
094100             :PKSLIP-VEND-SHIP-DTE,                               09410000
094200             :PKSLIP-PKSL-PG-CNT,                                 09420000
094300             :PKSLIP-CONTNR-ID,                                   09430000
094400             :PKSLIP-ORIG-PKSL-SEQ-NBR)                           09440000
094500        END-EXEC                                                  09450000
094600                                                                  09460000
094700        EVALUATE TRUE                                             09470000
094800           WHEN SQLCODE = +0                                      09480000
094900              SET PS-PKSLIP-INSERTED TO TRUE                      09490000
095000           WHEN SQLCODE = -803                                    09500000
095100              ADD 1                TO PKSLIP-SEQ-NBR              09510000
095200         WHEN SQLWARN0 NOT = SPACES                               09520000
095300         WHEN SQLCODE  NOT = ZERO                                 09530000
095310                                                                  09531015
095320              MOVE '3240'  TO  PV-CSSL-PARA                       09532015
095330              perform 8110-WRITE-suws044-TO-CSSL                  09533015
095340                                                                  09534015
095400             SET SU044-INVALID-SQL     TO TRUE                    09540000
095500             MOVE DK-SHIPT-UNT-ID     TO PV-DISP-SHIPT-UNT-ID     09550000
095600             STRING   ' SUKUT704-3240-'                           09560000
095700                      ' CALLED BY-'                               09570000
095800                      SU044-PROGRAM-NAME                          09580000
095900                      ' SHIPT UNIT = '                            09590000
096000                      PV-DISP-SHIPT-UNT-ID                        09600000
096100                      DELIMITED BY SIZE                           09610000
096200                                      INTO PV-CICS-MSG-AREA       09620000
096300             PERFORM 9999-WRITE-TO-CSSL                           09630000
096400             MOVE PV-CICS-MSG-AREA      TO SU044-CRA-RET-MSG      09640000
096500        END-EVALUATE.                                             09650000
096600                                                                  09660000
096700                                                                  09670000
096800 4000-PROCESS-SHUUPC-CURSOR.                                      09680000
096810                                                                  09681013
096820     IF  PS-BLD-INTERNAL-TABLE-YES                                09682013
096830         MOVE  '4000'  TO  PT-CURR-PARA                           09683013
096840         PERFORM 8120-INTERNAL-TABLE                              09684013
096850     END-IF.                                                      09685013
096900                                                                  09690000
097000     IF PS-LOG-MESSAGE                                            09700000
097100        MOVE ' SUKUT704-4000-PROCESS-SHUUPC-CURSOR'               09710002
097300                                    TO PV-CICS-MSG-AREA           09730002
097400        PERFORM 9999-WRITE-TO-CSSL                                09740000
097500         MOVE SU044-SUCCESS-IND TO PV-CICS-MSG-AREA               09750000
097600         PERFORM 9999-WRITE-TO-CSSL                               09760000
097700     END-IF                                                       09770000
097800                                                                  09780000
097900     SET PS-MORE-SHUUPC-YES TO TRUE.                              09790000
098000     PERFORM 4310-OPEN-SHUUPC-CURSOR.                             09800000
098100                                                                  09810000
098200     PERFORM 4320-FETCH-SHUUPC-CURSOR                             09820000
098300       UNTIL PS-MORE-SHUUPC-NO                                    09830000
098400     PERFORM 4350-CLOSE-SHUUPC-CURSOR.                            09840000
098500                                                                  09850000
098600     PERFORM 4410-UPDATE-TINPKSU.                                 09860000
098700                                                                  09870000
098800 4100-PROCSS-SHUUPC-CSR-DETACH.                                   09880000
098810                                                                  09881013
098820     IF  PS-BLD-INTERNAL-TABLE-YES                                09882013
098830         MOVE  '4100'  TO  PT-CURR-PARA                           09883013
098840         PERFORM 8120-INTERNAL-TABLE                              09884013
098850     END-IF.                                                      09885013
098860                                                                  09886013
098900     SET  PS-FIRST-PKSLIP-LINE                                    09890000
099000          PS-MORE-SHUUPC-YES TO TRUE.                             09900000
099100     PERFORM 4310-OPEN-SHUUPC-CURSOR.                             09910000
099200     PERFORM 4320-FETCH-SHUUPC-CURSOR                             09920000
099300       UNTIL PS-MORE-SHUUPC-NO                                    09930000
099400     PERFORM 4350-CLOSE-SHUUPC-CURSOR.                            09940000
099500                                                                  09950000
099600     PERFORM 4410-UPDATE-TINPKSU.                                 09960000
099700                                                                  09970000
099800 4310-OPEN-SHUUPC-CURSOR.                                         09980000
099810                                                                  09981013
099820     IF  PS-BLD-INTERNAL-TABLE-YES                                09982013
099830         MOVE  '4310'  TO  PT-CURR-PARA                           09983013
099840         PERFORM 8120-INTERNAL-TABLE                              09984013
099850     END-IF.                                                      09985013
099900                                                                  09990000
100000     EXEC SQL                                                     10000000
100100         OPEN SHUUPC-CURSOR                                       10010000
100200     END-EXEC.                                                    10020000
100300                                                                  10030000
100400     EVALUATE TRUE                                                10040000
100500       WHEN SQLCODE = ZERO                                        10050000
100600           SET PS-MORE-SHUUPC-YES TO TRUE                         10060000
100700                                                                  10070000
100800       WHEN SQLWARN0 NOT = SPACES                                 10080000
100900       WHEN SQLCODE  NOT = ZERO                                   10090000
100910                                                                  10091015
100920            MOVE '4310'  TO  PV-CSSL-PARA                         10092015
100930            perform 8110-WRITE-suws044-TO-CSSL                    10093015
100940                                                                  10094015
101000           MOVE SU044-PO       TO PV-DISP-PO                      10100000
101100           MOVE DK-REC-SEQ-NBR TO PV-DISP-RCVR-SEQ-NBR            10110000
101200           MOVE DK-OPER-UNT-ID TO PV-DISP-OPER-UNT-ID             10120000
101300           MOVE RECITM-PREPK-ID TO PV-DISP-PACK-ID                10130000
101400           MOVE SQLCODE        TO pv-disp-sqlcode                 10140007
101500           STRING   ' SUKUT704-4310-'                             10150000
101600                      ' CALLED BY-'                               10160000
101700                      SU044-PROGRAM-NAME                          10170000
101800                      '  SQLCODE='                                10180000
101900                      pv-disp-sqlcode                             10190007
102000                      ' PO= '                                     10200000
102100                      PV-DISP-PO                                  10210000
102200                      ' RCV= '                                    10220000
102300                      PV-DISP-RCVR-SEQ-NBR                        10230000
102400                      ' OPER= '                                   10240000
102500                      PV-DISP-OPER-UNT-ID                         10250000
102600                      ' PACK= '                                   10260000
102700                      PV-DISP-PACK-ID                             10270000
102800                      DELIMITED BY SIZE                           10280000
102900                                      INTO PV-CICS-MSG-AREA       10290000
103000           PERFORM 9999-WRITE-TO-CSSL                             10300000
103100           MOVE '4310-'                TO SU044-CRA-REQ-ID        10310000
103200           MOVE PV-CICS-MSG-AREA      TO SU044-CRA-RET-MSG        10320000
103300           PERFORM 9998-RETURN                                    10330000
103400     END-EVALUATE.                                                10340000
103500                                                                  10350000
103600 4320-FETCH-SHUUPC-CURSOR.                                        10360000
103610                                                                  10361013
103620     IF  PS-BLD-INTERNAL-TABLE-YES                                10362013
103630         MOVE  '4320'  TO  PT-CURR-PARA                           10363013
103640         PERFORM 8120-INTERNAL-TABLE                              10364013
103650     END-IF.                                                      10365013
103700                                                                  10370000
103800     IF PS-LOG-MESSAGE                                            10380000
103900        MOVE ' SUKUT704-4320-FETCH-SHUUPC-CURSOR'                 10390002
104100                                   TO  PV-CICS-MSG-AREA           10410002
104200        PERFORM 9999-WRITE-TO-CSSL                                10420000
104300         MOVE SU044-SUCCESS-IND TO PV-CICS-MSG-AREA               10430000
104400         PERFORM 9999-WRITE-TO-CSSL                               10440000
104500     END-IF                                                       10450000
104600                                                                  10460000
104700                                                                  10470000
104800     EXEC SQL                                                     10480000
104900         FETCH  SHUUPC-CURSOR                                     10490000
105000          INTO :SHUUPC-TRN-LNE-NBR                                10500000
105100             , :SHUUPC-SHPD-QTY                                   10510000
105200     END-EXEC.                                                    10520000
105300                                                                  10530000
105400     EVALUATE TRUE                                                10540000
105500       WHEN SQLCODE = ZERO                                        10550000
105600           MOVE SHUUPC-SHPD-QTY    TO PV-SHUUPC-SHPD-QTY          10560000
105700           IF SU044-CREATE-PKSLIP                                 10570000
105800              PERFORM 4345-PRCESS-PKSLIP-CRE-DETAIL               10580000
105900           ELSE                                                   10590000
106000              PERFORM 4500-PRCESS-PKSLIP-DETACH                   10600000
106100           END-IF                                                 10610000
106200       WHEN SQLCODE = +100                                        10620000
106300           SET PS-MORE-SHUUPC-NO TO TRUE                          10630000
106400                                                                  10640000
106500       WHEN SQLWARN0 NOT = SPACES                                 10650000
106600       WHEN SQLCODE  NOT = ZERO                                   10660000
106610                                                                  10661015
106620            MOVE '4320'  TO  PV-CSSL-PARA                         10662015
106630            perform 8110-WRITE-suws044-TO-CSSL                    10663015
106640                                                                  10664015
106700           MOVE SU044-PO       TO PV-DISP-PO                      10670000
106800           MOVE DK-REC-SEQ-NBR TO PV-DISP-RCVR-SEQ-NBR            10680000
106900           MOVE DK-OPER-UNT-ID TO PV-DISP-OPER-UNT-ID             10690000
107000           MOVE RECITM-PREPK-ID TO PV-DISP-PACK-ID                10700000
107100           MOVE SQLCODE        TO pv-disp-sqlcode                 10710007
107200           STRING   ' SUKUT704-4320-'                             10720000
107300                      ' CALLED BY-'                               10730000
107400                      SU044-PROGRAM-NAME                          10740000
107500                      '  SQLCODE='                                10750000
107600                      pv-disp-sqlcode                             10760007
107700                      ' PO= '                                     10770000
107800                      PV-DISP-PO                                  10780000
107900                      ' RCV= '                                    10790000
108000                      PV-DISP-RCVR-SEQ-NBR                        10800000
108100                      ' OPER= '                                   10810000
108200                      PV-DISP-OPER-UNT-ID                         10820000
108300                      ' PACK= '                                   10830000
108400                      PV-DISP-PACK-ID                             10840000
108500                      DELIMITED BY SIZE                           10850000
108600                                      INTO PV-CICS-MSG-AREA       10860000
108700           PERFORM 9999-WRITE-TO-CSSL                             10870000
108800           MOVE '4320-'                TO SU044-CRA-REQ-ID        10880000
108900           MOVE PV-CICS-MSG-AREA      TO SU044-CRA-RET-MSG        10890000
109000           PERFORM 9998-RETURN                                    10900000
109100     END-EVALUATE.                                                10910000
109200                                                                  10920000
109300 4330-SELECT-PURITM-VER-NBR.                                      10930000
109310                                                                  10931013
109320     IF  PS-BLD-INTERNAL-TABLE-YES                                10932013
109330         MOVE  '4330'  TO  PT-CURR-PARA                           10933013
109340         PERFORM 8120-INTERNAL-TABLE                              10934013
109350     END-IF.                                                      10935013
109400                                                                  10940000
109500     IF PS-LOG-MESSAGE                                            10950000
109600        MOVE ' SUKUT704-4330-SELECT-PURITM-VER-NBR'               10960002
109800                                    TO PV-CICS-MSG-AREA           10980002
109900        PERFORM 9999-WRITE-TO-CSSL                                10990000
110000         MOVE SU044-SUCCESS-IND TO PV-CICS-MSG-AREA               11000000
110100         PERFORM 9999-WRITE-TO-CSSL                               11010000
110200     END-IF                                                       11020000
110300                                                                  11030000
110400     EXEC SQL                                                     11040000
110500         SELECT  PURITM_VER_NBR                                   11050000
110600          INTO  :PURITM-VER-NBR                                   11060000
110700           FROM TPKITEM                                           11070000
110800          WHERE PO_NBR         = :SU044-PO                        11080000
110900            AND SEQ_NBR        = :SU044-ORIG-PKSL-SEQ-NBR         11090000
111000            AND PKSL_LNE_NBR   = :SHUUPC-TRN-LNE-NBR              11100000
111100            AND VER_STAT_CDE   = 'A'                              11110000
111110           with ur                                                11111016
111200     END-EXEC.                                                    11120000
111300                                                                  11130000
111400     EVALUATE TRUE                                                11140000
111500       WHEN SQLCODE = ZERO                                        11150000
111510       WHEN SQLCODE = -811                                        11151034
111600           CONTINUE                                               11160000
111700       WHEN SQLCODE = +100                                        11170000
111800           PERFORM 4340-SEL-PURITM-RECITM-VER                     11180000
111900       WHEN SQLWARN0 NOT = SPACES                                 11190000
112000       WHEN SQLCODE  NOT = ZERO                                   11200000
112010                                                                  11201015
112020            MOVE '4330'  TO  PV-CSSL-PARA                         11202015
112030            perform 8110-WRITE-suws044-TO-CSSL                    11203015
112040                                                                  11204015
112100           MOVE SU044-PO       TO PV-DISP-PO                      11210000
112200           MOVE DK-REC-SEQ-NBR TO PV-DISP-RCVR-SEQ-NBR            11220000
112300           MOVE DK-OPER-UNT-ID TO PV-DISP-OPER-UNT-ID             11230000
112400           MOVE DK-PKSL-LNE-NBR                                   11240000
112500                               TO PV-DISP-PO-LNE-NBR              11250000
112600           MOVE DK-STR-DEST-NBR                                   11260000
112700                               TO PV-DISP-STR-NBR                 11270000
112800           MOVE SQLCODE        TO pv-disp-sqlcode                 11280007
112900           STRING   ' SUKUT704-4330-'                             11290000
113000                      ' CALLED BY-'                               11300000
113100                      SU044-PROGRAM-NAME                          11310000
113200                      '  SQLCODE='                                11320000
113300                      pv-disp-sqlcode                             11330007
113400                      ' PO= '                                     11340000
113500                      PV-DISP-PO                                  11350000
113600                      ' RCV= '                                    11360000
113700                      PV-DISP-RCVR-SEQ-NBR                        11370000
113800                      ' OPER= '                                   11380000
113900                      PV-DISP-OPER-UNT-ID                         11390000
114000                      ' LINE= '                                   11400000
114100                      PV-DISP-PO-LNE-NBR                          11410000
114200                      ' STR= '                                    11420000
114300                      PV-DISP-STR-NBR                             11430000
114400                      DELIMITED BY SIZE                           11440000
114500                                      INTO PV-CICS-MSG-AREA       11450000
114600           PERFORM 9999-WRITE-TO-CSSL                             11460000
114700           MOVE '4350-'                TO SU044-CRA-REQ-ID        11470000
114800           MOVE PV-CICS-MSG-AREA      TO SU044-CRA-RET-MSG        11480000
114900           PERFORM 9998-RETURN                                    11490000
115000     END-EVALUATE.                                                11500000
115100                                                                  11510000
115256                                                                  11525633
115257 4340-SEL-PURITM-RECITM-VER.                                      11525700
115258                                                                  11525813
115259     IF  PS-BLD-INTERNAL-TABLE-YES                                11525913
115260         MOVE  '4340'  TO  PT-CURR-PARA                           11526013
115261         PERFORM 8120-INTERNAL-TABLE                              11526113
115270     END-IF.                                                      11527013
115300                                                                  11530000
115400     IF PS-LOG-MESSAGE                                            11540000
115500        MOVE ' SUKUT704-4340-SEL-PURITM-RECITM-VER'               11550002
115700                                    TO PV-CICS-MSG-AREA           11570002
115800        PERFORM 9999-WRITE-TO-CSSL                                11580000
115900         MOVE SU044-SUCCESS-IND TO PV-CICS-MSG-AREA               11590000
116000         PERFORM 9999-WRITE-TO-CSSL                               11600000
116100     END-IF                                                       11610000
116200                                                                  11620000
116300     EXEC SQL                                                     11630000
116400         SELECT VER_NBR                                           11640000
116500         INTO  :PURITM-VER-NBR                                    11650000
116600         FROM TPURITM A                                           11660000
116700             ,TRECITM B                                           11670000
116800         WHERE A.PO_NBR         = :SU044-PO                       11680000
116900           AND A.PO_NBR         = B.ORD_NBR                       11690000
117000           AND B.REC_SEQ_NBR    = :SU044-ORIG-REC-SEQ-NBR         11700000
117100           AND A.APP_PO_LNE_NBR = :SHUUPC-TRN-LNE-NBR             11710000
117200           AND A.APP_PO_LNE_NBR = B.ORD_LNE_NBR                   11720000
117300           AND A.VER_STATUS_CDE = 'A'                             11730000
117400           AND B.VER_STATUS_CDE = 'A'                             11740000
117500           AND A.VER_NBR        = B.PO_VER_NBR                    11750000
117510          with ur                                                 11751016
117600     END-EXEC.                                                    11760000
117700                                                                  11770000
117800     EVALUATE TRUE                                                11780000
117900       WHEN SQLCODE = ZERO                                        11790000
118000            CONTINUE                                              11800000
118100       WHEN SQLWARN0 NOT = SPACES                                 11810000
118200       WHEN SQLCODE  NOT = ZERO                                   11820000
118210                                                                  11821015
118220            MOVE '4340'  TO  PV-CSSL-PARA                         11822015
118230            perform 8110-WRITE-suws044-TO-CSSL                    11823015
118240                                                                  11824015
118300           MOVE SU044-PO       TO PV-DISP-PO                      11830000
118400           MOVE DK-REC-SEQ-NBR TO PV-DISP-RCVR-SEQ-NBR            11840000
118500           MOVE DK-OPER-UNT-ID TO PV-DISP-OPER-UNT-ID             11850000
118600           MOVE DK-PKSL-LNE-NBR                                   11860000
118700                               TO PV-DISP-PO-LNE-NBR              11870000
118800           MOVE DK-STR-DEST-NBR                                   11880000
118900                               TO PV-DISP-STR-NBR                 11890000
119000           MOVE SQLCODE        TO pv-disp-sqlcode                 11900007
119100           STRING   ' SUKUT704-4340-'                             11910000
119200                      ' CALLED BY-'                               11920000
119300                      SU044-PROGRAM-NAME                          11930000
119400                      '  SQLCODE='                                11940000
119500                      pv-disp-sqlcode                             11950007
119600                      ' PO= '                                     11960000
119700                      PV-DISP-PO                                  11970000
119800                      ' RCV= '                                    11980000
119900                      PV-DISP-RCVR-SEQ-NBR                        11990000
120000                      ' OPER= '                                   12000000
120100                      PV-DISP-OPER-UNT-ID                         12010000
120200                      ' LINE= '                                   12020000
120300                      PV-DISP-PO-LNE-NBR                          12030000
120400                      ' STR= '                                    12040000
120500                      PV-DISP-STR-NBR                             12050000
120600                      DELIMITED BY SIZE                           12060000
120700                                      INTO PV-CICS-MSG-AREA       12070000
120800           PERFORM 9999-WRITE-TO-CSSL                             12080000
120900           MOVE '4340-'                TO SU044-CRA-REQ-ID        12090000
121000           MOVE PV-CICS-MSG-AREA      TO SU044-CRA-RET-MSG        12100000
121100           PERFORM 9998-RETURN                                    12110000
121200     END-EVALUATE.                                                12120000
121300                                                                  12130000
121400                                                                  12140000
121500 4345-PRCESS-PKSLIP-CRE-DETAIL.                                   12150000
121510                                                                  12151013
121520     IF  PS-BLD-INTERNAL-TABLE-YES                                12152013
121530         MOVE  '4345'  TO  PT-CURR-PARA                           12153013
121540         PERFORM 8120-INTERNAL-TABLE                              12154013
121550     END-IF.                                                      12155013
121560                                                                  12156013
121600     IF PS-LOG-MESSAGE                                            12160000
121700        MOVE ' SUKUT704-4345-PRCESS-PKSLIP-CRE-DETAIL'            12170002
121900                                    TO PV-CICS-MSG-AREA           12190002
122000        PERFORM 9999-WRITE-TO-CSSL                                12200000
122100         MOVE SU044-SUCCESS-IND TO PV-CICS-MSG-AREA               12210000
122200         PERFORM 9999-WRITE-TO-CSSL                               12220000
122300     END-IF                                                       12230000
122400                                                                  12240000
122500      MOVE    SU044-NEW-PKSL-SEQ-NBR   TO PKITEM-SEQ-NBR          12250000
122600                                          INPKSU-SEQ-NBR          12260000
122700      MOVE    SHUUPC-TRN-LNE-NBR       TO PKITEM-PKSL-LNE-NBR     12270000
122800                                          DK-PO-LNE-NBR           12280000
122900      MOVE    SHUUPC-SHPD-QTY          TO PKITEM-PKSL-ITM-QTY     12290000
123000      MOVE    SU044-NEW-SHIP           TO SHIPMT-SHIPT-ID         12300000
123100      MOVE    SU044-NEW-REC-SEQ-NBR    TO RECEIV-REC-SEQ-NBR      12310000
123200                                          SHPTPO-REC-SEQ-NBR.     12320000
123300      MOVE    SU044-SHIPT-UNT-ID       TO INPKSU-SHIPT-UNT-ID.    12330000
123400                                                                  12340000
123500      PERFORM 4330-SELECT-PURITM-VER-NBR.                         12350000
123600      MOVE    PURITM-VER-NBR           TO PKITEM-PURITM-VER-NBR   12360000
123700      PERFORM 4370-INSERT-TPKITEM.                                12370000
123800                                                                  12380000
123900      PERFORM 5000-PROCSS-ORIGINAL-RCVR.                          12390000
124000                                                                  12400000
124100 4350-CLOSE-SHUUPC-CURSOR.                                        12410000
124110                                                                  12411013
124120     IF  PS-BLD-INTERNAL-TABLE-YES                                12412013
124130         MOVE  '4350'  TO  PT-CURR-PARA                           12413013
124140         PERFORM 8120-INTERNAL-TABLE                              12414013
124150     END-IF.                                                      12415013
124200                                                                  12420000
124300     EXEC SQL                                                     12430000
124400         CLOSE SHUUPC-CURSOR                                      12440000
124500     END-EXEC.                                                    12450000
124600                                                                  12460000
124700     EVALUATE TRUE                                                12470000
124800       WHEN SQLCODE = ZERO                                        12480000
124900           CONTINUE                                               12490000
125000                                                                  12500000
125100       WHEN SQLWARN0 NOT = SPACES                                 12510000
125200       WHEN SQLCODE  NOT = ZERO                                   12520000
125210                                                                  12521015
125220            MOVE '4350'  TO  PV-CSSL-PARA                         12522015
125230            perform 8110-WRITE-suws044-TO-CSSL                    12523015
125240                                                                  12524015
125300           MOVE SU044-PO       TO PV-DISP-PO                      12530000
125400           MOVE DK-REC-SEQ-NBR TO PV-DISP-RCVR-SEQ-NBR            12540000
125500           MOVE DK-OPER-UNT-ID TO PV-DISP-OPER-UNT-ID             12550000
125600           MOVE RECITM-PREPK-ID TO PV-DISP-PACK-ID                12560000
125700           MOVE SQLCODE        TO pv-disp-sqlcode                 12570007
125800           STRING   ' SUKUT704-4350-'                             12580015
125900                      ' CALLED BY-'                               12590000
126000                      SU044-PROGRAM-NAME                          12600000
126100                      '  SQLCODE='                                12610000
126200                      pv-disp-sqlcode                             12620007
126300                      ' PO= '                                     12630000
126400                      PV-DISP-PO                                  12640000
126500                      ' RCV= '                                    12650000
126600                      PV-DISP-RCVR-SEQ-NBR                        12660000
126700                      ' OPER= '                                   12670000
126800                      PV-DISP-OPER-UNT-ID                         12680000
126900                      ' PACK= '                                   12690000
127000                      PV-DISP-PACK-ID                             12700000
127100                      DELIMITED BY SIZE                           12710000
127200                                      INTO PV-CICS-MSG-AREA       12720000
127300           PERFORM 9999-WRITE-TO-CSSL                             12730000
127400           MOVE '4320-'                TO SU044-CRA-REQ-ID        12740000
127500           MOVE PV-CICS-MSG-AREA       TO SU044-CRA-RET-MSG       12750000
127600           PERFORM 9998-RETURN                                    12760000
127700     END-EVALUATE.                                                12770000
127800                                                                  12780000
127900                                                                  12790000
128000                                                                  12800000
128100 4370-INSERT-TPKITEM.                                             12810000
128110                                                                  12811013
128120     IF  PS-BLD-INTERNAL-TABLE-YES                                12812013
128130         MOVE  '4370'  TO  PT-CURR-PARA                           12813013
128140         PERFORM 8120-INTERNAL-TABLE                              12814013
128150     END-IF.                                                      12815013
128200                                                                  12820000
128300     IF PS-LOG-MESSAGE                                            12830000
128400        MOVE ' SUKUT704-4370-INSERT-TPKITEM '                     12840002
128600                                    TO PV-CICS-MSG-AREA           12860002
128700        PERFORM 9999-WRITE-TO-CSSL                                12870000
128800         MOVE SU044-SUCCESS-IND TO PV-CICS-MSG-AREA               12880000
128900         PERFORM 9999-WRITE-TO-CSSL                               12890000
129000     END-IF                                                       12900000
129100                                                                  12910000
129200     EXEC SQL                                                     12920000
129300         INSERT INTO TPKITEM                                      12930000
129400         (    PO_NBR                                              12940000
129500          ,   SEQ_NBR                                             12950000
129600          ,   PKSL_LNE_NBR                                        12960000
129700          ,   CRE_TMST                                            12970000
129800          ,   VER_STAT_CDE                                        12980000
129900          ,   PKSL_ITM_QTY                                        12990000
130000          ,   CRE_UID                                             13000000
130100          ,   PURITM_VER_NBR)                                     13010000
130200         VALUES                                                   13020000
130300         (   :SU044-PO                                            13030000
130400          ,  :PKITEM-SEQ-NBR                                      13040000
130500          ,  :SHUUPC-TRN-LNE-NBR                                  13050000
130600          ,   CURRENT TIMESTAMP                                   13060000
130700          ,  'A'                                                  13070000
130800          ,  :PKITEM-PKSL-ITM-QTY                                 13080000
130900          ,  :PC-CURRENT-PROGRAM-NAME                             13090000
131000          ,  :PKITEM-PURITM-VER-NBR )                             13100000
131100     END-EXEC.                                                    13110000
131200                                                                  13120000
131300     EVALUATE TRUE                                                13130000
131400         WHEN SQLCODE = +0                                        13140000
131500             CONTINUE                                             13150000
131600         WHEN SQLWARN0 NOT = SPACES                               13160000
131700         WHEN SQLCODE < +0                                        13170000
131800         WHEN SQLCODE > +0                                        13180000
131810                                                                  13181015
131820            MOVE '4370'  TO  PV-CSSL-PARA                         13182015
131830            perform 8110-WRITE-suws044-TO-CSSL                    13183015
131840                                                                  13184015
131900             SET PS-ERROR                                         13190000
132000                 SU044-INVALID-SQL    TO TRUE                     13200000
132100             MOVE SU044-PO            TO PV-DISP-PO               13210000
132200             MOVE SHUUPC-TRN-LNE-NBR  TO PV-DISP-PO-LNE-NBR       13220000
132300             MOVE DK-REC-SEQ-NBR      TO PV-DISP-RCVR-SEQ-NBR     13230000
132400             MOVE DK-OPER-UNT-ID      TO PV-DISP-OPER-UNT-ID      13240000
132500             MOVE DK-STR-DEST-NBR     TO PV-DISP-STR-NBR          13250000
132600             MOVE  SQLCODE            TO pv-disp-sqlcode          13260007
132700             STRING   ' SUKUT704-4370-'                           13270000
132800                      ' CALLED BY-'                               13280000
132900                      SU044-PROGRAM-NAME                          13290000
133000                      '  SQLCODE='                                13300000
133100                      pv-disp-sqlcode                             13310007
133200                      ' PO='                                      13320000
133300                      PV-DISP-PO                                  13330000
133400                      ' LNE='                                     13340000
133500                      PV-DISP-PO-LNE-NBR                          13350000
133600                      ' RCV='                                     13360000
133700                      PV-DISP-RCVR-SEQ-NBR                        13370000
133800                      ' STR='                                     13380000
133900                      PV-DISP-STR-NBR                             13390000
134000                      ' OP='                                      13400000
134100                      PV-DISP-OPER-UNT-ID                         13410000
134200                      DELIMITED BY SIZE                           13420000
134300                                      INTO PV-CICS-MSG-AREA       13430000
134400             PERFORM 9999-WRITE-TO-CSSL                           13440000
134500             MOVE '4370-'                TO SU044-CRA-REQ-ID      13450000
134600             MOVE PV-CICS-MSG-AREA      TO SU044-CRA-RET-MSG      13460000
134700             PERFORM 9998-RETURN                                  13470000
134800     END-EVALUATE.                                                13480000
134900                                                                  13490000
135000 4410-UPDATE-TINPKSU.                                             13500000
135010                                                                  13501013
135020     IF  PS-BLD-INTERNAL-TABLE-YES                                13502013
135030         MOVE  '4410'  TO  PT-CURR-PARA                           13503013
135040         PERFORM 8120-INTERNAL-TABLE                              13504013
135050     END-IF.                                                      13505013
135100                                                                  13510000
135200     IF PS-LOG-MESSAGE                                            13520000
135300        MOVE ' SUKUT704-4410-UPDATE-TINPKSU '                     13530002
135500                                    TO PV-CICS-MSG-AREA           13550002
135600        PERFORM 9999-WRITE-TO-CSSL                                13560000
135700         MOVE SU044-SUCCESS-IND TO PV-CICS-MSG-AREA               13570000
135800         PERFORM 9999-WRITE-TO-CSSL                               13580000
135900     END-IF                                                       13590000
136000     EXEC SQL                                                     13600000
136100       UPDATE TINPKSU                                             13610000
136200          SET SEQ_NBR           = :SU044-NEW-PKSL-SEQ-NBR         13620000
136300             ,ORIG_PKSL_SEQ_NBR = :SU044-ORIG-PKSL-SEQ-NBR        13630000
136400        WHERE SHIPT_UNT_ID      = :SU044-SHIPT-UNT-ID             13640000
136500          AND PO_NBR            = :SU044-PO                       13650000
136600     END-EXEC.                                                    13660000
136700                                                                  13670000
136800     EVALUATE TRUE                                                13680000
136900         WHEN SQLCODE = +0                                        13690000
137000             CONTINUE                                             13700000
137100         WHEN SQLWARN0 NOT = SPACES                               13710000
137200         WHEN SQLCODE < +0                                        13720000
137300         WHEN SQLCODE > +0                                        13730000
137310                                                                  13731015
137320              MOVE '4410'  TO  PV-CSSL-PARA                       13732015
137330              perform 8110-WRITE-suws044-TO-CSSL                  13733015
137340                                                                  13734015
137400             SET PS-ERROR                                         13740000
137500                 SU044-INVALID-SQL    TO TRUE                     13750000
137600             MOVE SU044-PO            TO PV-DISP-PO               13760000
137700             MOVE DK-REC-SEQ-NBR      TO PV-DISP-RCVR-SEQ-NBR     13770000
137800             MOVE SHUUPC-TRN-LNE-NBR  TO PV-DISP-PO-LNE-NBR       13780000
137900             MOVE DK-STR-DEST-NBR     TO PV-DISP-STR-NBR          13790000
138000             MOVE  SQLCODE            TO pv-disp-sqlcode          13800007
138100             STRING   ' SUKUT704-4410-'                           13810000
138200                      ' CALLED BY-'                               13820000
138300                      SU044-PROGRAM-NAME                          13830000
138400                      '  SQLCODE='                                13840000
138500                      pv-disp-sqlcode                             13850007
138600                      ' PO='                                      13860000
138700                      PV-DISP-PO                                  13870000
138800                      ' RCV='                                     13880000
138900                      PV-DISP-RCVR-SEQ-NBR                        13890000
139000                      ' LNE='                                     13900000
139100                      PV-DISP-PO-LNE-NBR                          13910000
139200                      ' STR='                                     13920000
139300                      PV-DISP-STR-NBR                             13930000
139400                      DELIMITED BY SIZE                           13940000
139500                                      INTO PV-CICS-MSG-AREA       13950000
139600             PERFORM 9999-WRITE-TO-CSSL                           13960000
139700             MOVE '4390-'                TO SU044-CRA-REQ-ID      13970000
139800             MOVE PV-CICS-MSG-AREA      TO SU044-CRA-RET-MSG      13980000
139900             PERFORM 9998-RETURN                                  13990000
140000     END-EVALUATE.                                                14000000
140100                                                                  14010000
140200                                                                  14020000
140300 4500-PRCESS-PKSLIP-DETACH.                                       14030000
140310                                                                  14031013
140320     IF  PS-BLD-INTERNAL-TABLE-YES                                14032013
140330         MOVE  '4500'  TO  PT-CURR-PARA                           14033013
140340         PERFORM 8120-INTERNAL-TABLE                              14034013
140350     END-IF.                                                      14035013
140360                                                                  14036013
140400     IF PS-LOG-MESSAGE                                            14040000
140500        MOVE ' SUKUT704-4500-PRCESS-PKSLIP-DETACH'                14050002
140700                                    TO PV-CICS-MSG-AREA           14070002
140800        PERFORM 9999-WRITE-TO-CSSL                                14080000
140900         MOVE SU044-SUCCESS-IND TO PV-CICS-MSG-AREA               14090000
141000         PERFORM 9999-WRITE-TO-CSSL                               14100000
141100     END-IF                                                       14110000
141200      MOVE SU044-NEW-PKSL-SEQ-NBR TO PKITEM-SEQ-NBR.              14120000
141300      MOVE SHUUPC-TRN-LNE-NBR     TO PKITEM-PKSL-LNE-NBR.         14130000
141400                                                                  14140000
141500      PERFORM 4510-UPDATE-TPKITEM.                                14150000
141600                                                                  14160000
141700      IF PS-UPDATE-TPKITEM-NO                                     14170000
141800         PERFORM 4345-PRCESS-PKSLIP-CRE-DETAIL                    14180000
141900      END-IF.                                                     14190000
142000                                                                  14200000
142100                                                                  14210000
142200      IF PS-UPDATE-TPKITEM-YES AND                                14220000
142300         (SU044-ORIG-REC-SEQ-NBR > 0)                             14230000
142400         SET PS-UPDATE-PKSLIP-ONLY-YES TO TRUE                    14240000
142500         PERFORM 5000-PROCSS-ORIGINAL-RCVR                        14250000
142600      END-IF.                                                     14260000
142700                                                                  14270000
142800 4510-UPDATE-TPKITEM.                                             14280000
142810                                                                  14281013
142820     IF  PS-BLD-INTERNAL-TABLE-YES                                14282013
142830         MOVE  '4510'  TO  PT-CURR-PARA                           14283013
142840         PERFORM 8120-INTERNAL-TABLE                              14284013
142850     END-IF.                                                      14285013
142860                                                                  14286013
142900     IF PS-LOG-MESSAGE                                            14290000
143000        MOVE ' SUKUT704-4510-UPDATE-TPKITEM '                     14300002
143200                                    TO PV-CICS-MSG-AREA           14320002
143300        PERFORM 9999-WRITE-TO-CSSL                                14330000
143400         MOVE SU044-SUCCESS-IND TO PV-CICS-MSG-AREA               14340000
143500         PERFORM 9999-WRITE-TO-CSSL                               14350000
143600     END-IF                                                       14360000
143700                                                                  14370000
143800     EXEC SQL                                                     14380000
143900       UPDATE TPKITEM                                             14390000
144000          SET PKSL_ITM_QTY     = (PKSL_ITM_QTY + :SHUUPC-SHPD-QTY)14400000
144100        WHERE PO_NBR           = :SU044-PO                        14410000
144200          AND SEQ_NBR          = :SU044-NEW-PKSL-SEQ-NBR          14420000
144300          AND PKSL_LNE_NBR     = :SHUUPC-TRN-LNE-NBR              14430000
144400     END-EXEC.                                                    14440000
144500                                                                  14450000
144600     EVALUATE TRUE                                                14460000
144700         WHEN SQLCODE = +0                                        14470000
144800              SET PS-UPDATE-TPKITEM-YES TO TRUE                   14480000
144900         WHEN SQLCODE = +100                                      14490000
145000              SET PS-UPDATE-TPKITEM-NO  TO TRUE                   14500000
145100         WHEN SQLWARN0 NOT = SPACES                               14510000
145200         WHEN SQLCODE < +0                                        14520000
145300         WHEN SQLCODE > +0                                        14530000
145310                                                                  14531015
145320              MOVE '4510'  TO  PV-CSSL-PARA                       14532015
145330              perform 8110-WRITE-suws044-TO-CSSL                  14533015
145340                                                                  14534015
145400             SET PS-ERROR                                         14540000
145500                 SU044-INVALID-SQL    TO TRUE                     14550000
145600             MOVE SU044-PO            TO PV-DISP-PO               14560000
145700             MOVE DK-REC-SEQ-NBR      TO PV-DISP-RCVR-SEQ-NBR     14570000
145800             MOVE SHUUPC-TRN-LNE-NBR  TO PV-DISP-PO-LNE-NBR       14580000
145900             MOVE DK-STR-DEST-NBR     TO PV-DISP-STR-NBR          14590000
146000             MOVE  SQLCODE            TO pv-disp-sqlcode          14600007
146100             STRING   ' SUKUT704-4510-'                           14610015
146200                      ' CALLED BY-'                               14620000
146300                      SU044-PROGRAM-NAME                          14630000
146400                      '  SQLCODE='                                14640000
146500                      pv-disp-sqlcode                             14650007
146600                      ' PO='                                      14660000
146700                      PV-DISP-PO                                  14670000
146800                      ' RCV='                                     14680000
146900                      PV-DISP-RCVR-SEQ-NBR                        14690000
147000                      ' LNE='                                     14700000
147100                      PV-DISP-PO-LNE-NBR                          14710000
147200                      ' STR='                                     14720000
147300                      PV-DISP-STR-NBR                             14730000
147400                      DELIMITED BY SIZE                           14740000
147500                                      INTO PV-CICS-MSG-AREA       14750000
147600             PERFORM 9999-WRITE-TO-CSSL                           14760000
147700             MOVE '4390-'                TO SU044-CRA-REQ-ID      14770000
147800             MOVE PV-CICS-MSG-AREA      TO SU044-CRA-RET-MSG      14780000
147900             PERFORM 9998-RETURN                                  14790000
148000     END-EVALUATE.                                                14800000
148100                                                                  14810000
148200 5000-PROCSS-ORIGINAL-RCVR.                                       14820000
148210                                                                  14821013
148220     IF  PS-BLD-INTERNAL-TABLE-YES                                14822013
148230         MOVE  '5000'  TO  PT-CURR-PARA                           14823013
148240         PERFORM 8120-INTERNAL-TABLE                              14824013
148250     END-IF.                                                      14825013
148260                                                                  14826013
148300     IF PS-LOG-MESSAGE                                            14830000
148400        MOVE ' SUKUT704-5000-PROCSS-ORIGINAL-RCVR'                14840002
148600                                    TO PV-CICS-MSG-AREA           14860002
148700        PERFORM 9999-WRITE-TO-CSSL                                14870000
148800         MOVE SU044-SUCCESS-IND TO PV-CICS-MSG-AREA               14880000
148900         PERFORM 9999-WRITE-TO-CSSL                               14890000
149000     END-IF                                                       14900000
149100** GB 8/22/05 ADDED CHECK FOR REC-SEQ > 0                         14910000
149200     IF SU044-ORIG-REC-SEQ-NBR > 0                                14920000
149300        PERFORM 5025-CHECK-TRECEIV                                14930000
149400     END-IF                                                       14940000
149500     IF SU044-UPDATE-PKSLIP-ONLY                                  14950000
149600        PERFORM 5150-UPDATE-TPKITEM-ONLY                          14960000
149700     ELSE                                                         14970000
149800        IF SU044-ORIG-REC-SEQ-NBR > 0                             14980000
149900          IF (RECEIV-STATUS-CDE = 'VE')  AND                      14990000
150000             (RECEIV-ML-POST-TMST <  PC-DEFAULT-TMST)             15000000
150100              CONTINUE                                            15010000
150200          ELSE                                                    15020000
150300             EVALUATE TRUE                                        15030000
150400               WHEN SU044-RCVR-PBS                                15040000
150500                    MOVE SU044-DEST-STR-NBR TO DK-STR-DEST-NBR    15050000
150600                    PERFORM 5050-PROCESS-ORIG-RCVR                15060000
150700               WHEN SU044-RCVR-BULK                               15070000
150800               WHEN SU044-RCVR-PREPK                              15080000
150900                    PERFORM 6000-PRCS-ORIG-RCVR-BLK               15090000
151000             END-EVALUATE                                         15100000
151100          END-IF                                                  15110000
151200        END-IF.                                                   15120000
151300                                                                  15130000
151400 5025-CHECK-TRECEIV.                                              15140000
151410                                                                  15141013
151420     IF  PS-BLD-INTERNAL-TABLE-YES                                15142013
151430         MOVE  '5025'  TO  PT-CURR-PARA                           15143013
151440         PERFORM 8120-INTERNAL-TABLE                              15144013
151450     END-IF.                                                      15145013
151500                                                                  15150000
151600     IF PS-LOG-MESSAGE                                            15160000
151700        MOVE ' SUKUT704-5025-CHECK-TRECEIV'                       15170002
151900                                    TO PV-CICS-MSG-AREA           15190002
152000        PERFORM 9999-WRITE-TO-CSSL                                15200000
152100         MOVE SU044-SUCCESS-IND TO PV-CICS-MSG-AREA               15210000
152200         PERFORM 9999-WRITE-TO-CSSL                               15220000
152300     END-IF                                                       15230000
152400     EXEC SQL                                                     15240000
152500        SELECT STATUS_CDE                                         15250000
152600             , PKGNG_CDE                                          15260000
152700             , ML_POST_TMST                                       15270000
152800        INTO   :RECEIV-STATUS-CDE                                 15280000
152900            ,  :RECEIV-PKGNG-CDE                                  15290000
153000            ,  :RECEIV-ML-POST-TMST                               15300000
153100          FROM TRECEIV A                                          15310000
153200         WHERE A.ORD_NBR         =  :SU044-PO                     15320000
153300           AND A.REC_SEQ_NBR     =  :SU044-ORIG-REC-SEQ-NBR       15330000
153310          with ur                                                 15331016
153400     END-EXEC.                                                    15340000
153500                                                                  15350000
153600     EVALUATE TRUE                                                15360000
153700         WHEN SQLCODE = ZERO                                      15370000
153800             CONTINUE                                             15380000
153900         WHEN SQLCODE = +100                                      15390000
154000         WHEN SQLWARN0 NOT = SPACES                               15400000
154100         WHEN SQLCODE NOT EQUAL ZERO                              15410000
154110                                                                  15411015
154120              MOVE '5025'  TO  PV-CSSL-PARA                       15412015
154130              perform 8110-WRITE-suws044-TO-CSSL                  15413015
154140                                                                  15414015
154200             SET PS-ERROR                                         15420000
154300                 SU044-INVALID-SQL    TO TRUE                     15430000
154400             MOVE  SQLCODE            TO pv-disp-sqlcode          15440007
154500             STRING   ' SUKUT704-5025-'                           15450000
154600                      ' CALLED BY-'                               15460000
154700                      SU044-PROGRAM-NAME                          15470000
154800                      '  SQLCODE='                                15480000
154900                      pv-disp-sqlcode                             15490007
155000                      ' '                                         15500000
155100                      DELIMITED BY SIZE                           15510000
155200                                      INTO PV-CICS-MSG-AREA       15520000
155300             PERFORM 9999-WRITE-TO-CSSL                           15530000
155400             MOVE '5025-'                TO SU044-CRA-REQ-ID      15540000
155500             MOVE PV-CICS-MSG-AREA      TO SU044-CRA-RET-MSG      15550000
155600             SET SU044-INVALID-SQL TO TRUE                        15560000
155700             PERFORM 9998-RETURN                                  15570000
155800     END-EVALUATE.                                                15580000
155900                                                                  15590000
156000 5050-PROCESS-ORIG-RCVR.                                          15600000
156010                                                                  15601013
156020     IF  PS-BLD-INTERNAL-TABLE-YES                                15602013
156030         MOVE  '5050'  TO  PT-CURR-PARA                           15603013
156040         PERFORM 8120-INTERNAL-TABLE                              15604013
156050     END-IF.                                                      15605013
156100                                                                  15610000
156200     IF PS-LOG-MESSAGE                                            15620000
156300        MOVE ' SUKUT704-5050-PROCESS-ORIG-RCVR'                   15630002
156500                                    TO PV-CICS-MSG-AREA           15650002
156600        PERFORM 9999-WRITE-TO-CSSL                                15660000
156700         MOVE SU044-SUCCESS-IND TO PV-CICS-MSG-AREA               15670000
156800         PERFORM 9999-WRITE-TO-CSSL                               15680000
156900     END-IF                                                       15690000
157000      PERFORM 5100-SELECT-RECITM-RECDIS                           15700000
157100                                                                  15710000
157200      IF RECDIS-EXPTED-ITM-QTY <  PV-SHUUPC-SHPD-QTY              15720000
157300         MOVE ZEROES                TO DK-EXPTED-ITM-UPD-QTY      15730000
157400      ELSE                                                        15740000
157500         COMPUTE DK-EXPTED-ITM-UPD-QTY =                          15750000
157600             (RECDIS-EXPTED-ITM-QTY - PV-SHUUPC-SHPD-QTY)         15760000
157700      END-IF                                                      15770000
157800                                                                  15780000
157900      IF SU044-SRC-VERIFICATION                                   15790000
158000         MOVE RECDIS-VERIFY-ITM-QTY TO DK-VERIFY-ITM-UPD-QTY      15800000
158100      ELSE                                                        15810000
158200        IF RECDIS-VERIFY-ITM-QTY <  PV-SHUUPC-SHPD-QTY            15820000
158300           MOVE ZEROES                TO DK-VERIFY-ITM-UPD-QTY    15830000
158400        ELSE                                                      15840000
158500           COMPUTE DK-VERIFY-ITM-UPD-QTY =                        15850000
158600               (RECDIS-VERIFY-ITM-QTY - PV-SHUUPC-SHPD-QTY)       15860000
158700        END-IF                                                    15870000
158800      END-IF                                                      15880000
158900                                                                  15890000
159000*     IF RECDIS-AP-VERIFY-ITM-QTY <  PV-SHUUPC-SHPD-QTY           15900000
159100*        MOVE ZEROES                TO DK-AP-VERIFY-ITM-UPD-QTY   15910000
159200*     ELSE                                                        15920000
159300*        COMPUTE DK-AP-VERIFY-ITM-UPD-QTY =                       15930000
159400*            (RECDIS-AP-VERIFY-ITM-QTY - PV-SHUUPC-SHPD-QTY)      15940000
159500*     END-IF                                                      15950000
159600                                                                  15960000
159700*                                                                 15970000
159800      MOVE SHUUPC-TRN-LNE-NBR TO DK-PO-LNE-NBR                    15980000
159900      SET RC031-AUDIT-TRECDIS TO TRUE                             15990000
160000      PERFORM 7000-UPD-TO-RECVR-AUDIT                             16000000
160100*                                                                 16010000
160200      PERFORM 5190-INSERT-RECDIS-ORIG                             16020000
160300                                                                  16030000
160400      PERFORM 5200-UPDATE-TRECDIS                                 16040000
160500*----------------------------------------------------------------*16050000
160600      IF RECITM-PKSL-ITM-QTY      <  PV-SHUUPC-SHPD-QTY           16060000
160700         MOVE ZEROES                TO DK-PKSL-ITM-UPD-QTY        16070000
160800      ELSE                                                        16080000
160900         COMPUTE DK-PKSL-ITM-UPD-QTY =                            16090000
161000             (RECITM-PKSL-ITM-QTY  - PV-SHUUPC-SHPD-QTY)          16100000
161100      END-IF                                                      16110000
161200                                                                  16120000
161300      IF RECITM-DTL-CK-ITM-QTY  > 0                               16130000
161400         IF RECITM-DTL-CK-ITM-QTY    <  PV-SHUUPC-SHPD-QTY        16140000
161500            MOVE ZEROES           TO   DK-DTL-CK-ITM-QTY          16150000
161600         ELSE                                                     16160000
161700            COMPUTE DK-DTL-CK-ITM-QTY   =                         16170000
161800                   (RECITM-DTL-CK-ITM-QTY  - PV-SHUUPC-SHPD-QTY)  16180000
161900         END-IF                                                   16190000
162000      ELSE                                                        16200000
162100         MOVE RECITM-DTL-CK-ITM-QTY   TO DK-DTL-CK-ITM-QTY        16210000
162200      END-IF                                                      16220000
162300*                                                                 16230000
162400      SET RC031-AUDIT-TRECITM TO TRUE                             16240000
162500      PERFORM 7000-UPD-TO-RECVR-AUDIT                             16250000
162600                                                                  16260000
162700      PERFORM 5300-UPDATE-TRECITM.                                16270000
162800*----------------------------------------------------------------*16280000
162900                                                                  16290000
163000      PERFORM 5350-SELECT-TPKITEM.                                16300000
163100                                                                  16310000
163200      IF PKITEM-PKSL-ITM-QTY      <  PV-SHUUPC-SHPD-QTY           16320000
163300         MOVE ZEROES                TO DK-PKITM-UPD-ITM-QTY       16330000
163400      ELSE                                                        16340000
163500         COMPUTE DK-PKITM-UPD-ITM-QTY      =                      16350000
163600             (PKITEM-PKSL-ITM-QTY  - PV-SHUUPC-SHPD-QTY)          16360000
163700      END-IF                                                      16370000
163800                                                                  16380000
163900      PERFORM 5360-UPDATE-TPKITEM.                                16390000
164000                                                                  16400000
164100*---------------------------------------------------------------* 16410000
164200*---------------------------------------------------------------* 16420000
164300 5055-PROCESS-ORIG-RCVR-INPK.                                     16430000
164310                                                                  16431013
164320     IF  PS-BLD-INTERNAL-TABLE-YES                                16432013
164330         MOVE  '5055'  TO  PT-CURR-PARA                           16433013
164340         PERFORM 8120-INTERNAL-TABLE                              16434013
164350     END-IF.                                                      16435013
164400                                                                  16440000
164500      IF PS-LOG-MESSAGE                                           16450000
164600        MOVE ' SUKUT704-5055-PROCESS-ORIG-RCVR-INPK'              16460002
164800                                     TO PV-CICS-MSG-AREA          16480002
164900         PERFORM 9999-WRITE-TO-CSSL                               16490000
165000         MOVE SU044-SUCCESS-IND TO PV-CICS-MSG-AREA               16500000
165100         PERFORM 9999-WRITE-TO-CSSL                               16510000
165200      END-IF                                                      16520000
165300      PERFORM 5100-SELECT-RECITM-RECDIS                           16530000
165400                                                                  16540000
165500      IF SU044-RCVR-PREPK                                         16550000
165600         MOVE RECITM-PREPK-RATO-QTY  TO  PV-INPK-UNT-QTY          16560000
165700         MOVE PV-INPK-UNT-QTY        TO  DISTHD-CAL-UNT-PRCD-QTY  16570000
165800      ELSE                                                        16580000
165900         MOVE LBVRDA-INPK-UNT-QTY    TO  PV-INPK-UNT-QTY          16590000
166000         MOVE DK-OUTER-QTY           TO  DISTHD-CAL-UNT-PRCD-QTY  16600000
166100      END-IF                                                      16610000
166200                                                                  16620000
166300      IF RECDIS-EXPTED-ITM-QTY <  PV-INPK-UNT-QTY                 16630000
166400         MOVE ZEROES                TO DK-EXPTED-ITM-UPD-QTY      16640000
166500      ELSE                                                        16650000
166600         COMPUTE DK-EXPTED-ITM-UPD-QTY =                          16660000
166700             (RECDIS-EXPTED-ITM-QTY - PV-INPK-UNT-QTY)            16670000
166800      END-IF                                                      16680000
166900                                                                  16690000
167000      IF SU044-SRC-VERIFICATION                                   16700000
167100         MOVE RECDIS-VERIFY-ITM-QTY TO DK-VERIFY-ITM-UPD-QTY      16710000
167200      ELSE                                                        16720000
167300         IF RECDIS-VERIFY-ITM-QTY <  PV-INPK-UNT-QTY              16730000
167400            MOVE ZEROES                TO DK-VERIFY-ITM-UPD-QTY   16740000
167500         ELSE                                                     16750000
167600            COMPUTE DK-VERIFY-ITM-UPD-QTY =                       16760000
167700                (RECDIS-VERIFY-ITM-QTY - PV-INPK-UNT-QTY)         16770000
167800         END-IF                                                   16780000
167900      END-IF                                                      16790000
168000                                                                  16800000
168100*     IF RECDIS-AP-VERIFY-ITM-QTY <  PV-INPK-UNT-QTY              16810000
168200*        MOVE ZEROES                TO DK-AP-VERIFY-ITM-UPD-QTY   16820000
168300*     ELSE                                                        16830000
168400*        COMPUTE DK-AP-VERIFY-ITM-UPD-QTY =                       16840000
168500*            (RECDIS-AP-VERIFY-ITM-QTY - PV-INPK-UNT-QTY)         16850000
168600*     END-IF                                                      16860000
168700                                                                  16870000
168800*                                                                 16880000
168900      MOVE SHUUPC-TRN-LNE-NBR TO DK-PO-LNE-NBR                    16890000
169000      SET RC031-AUDIT-TRECDIS TO TRUE                             16900000
169100      PERFORM 7000-UPD-TO-RECVR-AUDIT                             16910000
169200*                                                                 16920000
169300      PERFORM 5190-INSERT-RECDIS-ORIG                             16930000
169400                                                                  16940000
169500      PERFORM 5200-UPDATE-TRECDIS                                 16950000
169600*----------------------------------------------------------------*16960000
169700      IF RECITM-PKSL-ITM-QTY      <  PV-INPK-UNT-QTY              16970000
169800         MOVE ZEROES                TO DK-PKSL-ITM-UPD-QTY        16980000
169900      ELSE                                                        16990000
170000         COMPUTE DK-PKSL-ITM-UPD-QTY =                            17000000
170100             (RECITM-PKSL-ITM-QTY  - PV-INPK-UNT-QTY)             17010000
170200      END-IF                                                      17020000
170300                                                                  17030000
170400      IF RECITM-DTL-CK-ITM-QTY  > 0                               17040000
170500         IF RECITM-DTL-CK-ITM-QTY    <  PV-INPK-UNT-QTY           17050000
170600            MOVE ZEROES           TO   DK-DTL-CK-ITM-QTY          17060000
170700         ELSE                                                     17070000
170800            COMPUTE DK-DTL-CK-ITM-QTY   =                         17080000
170900                   (RECITM-DTL-CK-ITM-QTY -                       17090000
171000                                        PV-INPK-UNT-QTY)          17100000
171100         END-IF                                                   17110000
171200      ELSE                                                        17120000
171300         MOVE RECITM-DTL-CK-ITM-QTY   TO DK-DTL-CK-ITM-QTY        17130000
171400      END-IF                                                      17140000
171500*                                                                 17150000
171600      SET RC031-AUDIT-TRECITM TO TRUE                             17160000
171700      PERFORM 7000-UPD-TO-RECVR-AUDIT                             17170000
171800                                                                  17180000
171900      PERFORM 5300-UPDATE-TRECITM.                                17190000
172000*----------------------------------------------------------------*17200000
172100                                                                  17210000
172200      PERFORM 5350-SELECT-TPKITEM.                                17220000
172300                                                                  17230000
172400      IF PKITEM-PKSL-ITM-QTY      <  PV-INPK-UNT-QTY              17240000
172500         MOVE ZEROES                TO DK-PKITM-UPD-ITM-QTY       17250000
172600      ELSE                                                        17260000
172700         COMPUTE DK-PKITM-UPD-ITM-QTY      =                      17270000
172800             (PKITEM-PKSL-ITM-QTY  - PV-INPK-UNT-QTY)             17280000
172900      END-IF                                                      17290000
173000                                                                  17300000
173100      PERFORM 5360-UPDATE-TPKITEM.                                17310000
173200                                                                  17320000
173300      IF PS-FIRST-INPK-CNVY-YES                                   17330000
173400         COMPUTE PV-INPK-CART-CNT           =                     17340000
173500             (DK-OUTER-QTY / LBVRDA-INPK-UNT-QTY)                 17350000
173600         PERFORM 6750-UPDATE-TDISTHD                              17360000
173700         SET PS-FIRST-INPK-CNVY-NO TO TRUE                        17370000
173800      END-IF                                                      17380000
173900                                                                  17390000
174000      PERFORM 6770-UPDATE-TDISTDT-INPK.                           17400000
174100*----------------------------------------------------------------*17410000
174200                                                                  17420000
174300 5100-SELECT-RECITM-RECDIS.                                       17430000
174310                                                                  17431013
174320     IF  PS-BLD-INTERNAL-TABLE-YES                                17432013
174330         MOVE  '5100'  TO  PT-CURR-PARA                           17433013
174340         PERFORM 8120-INTERNAL-TABLE                              17434013
174350     END-IF.                                                      17435013
174400                                                                  17440000
174500     IF PS-LOG-MESSAGE                                            17450000
174600        MOVE ' SUKUT704-5100-SELECT-RECITM-RECDIS'                17460002
174800                                    TO PV-CICS-MSG-AREA           17480002
174900        PERFORM 9999-WRITE-TO-CSSL                                17490000
175000         MOVE SU044-SUCCESS-IND TO PV-CICS-MSG-AREA               17500000
175100         PERFORM 9999-WRITE-TO-CSSL                               17510000
175200     END-IF                                                       17520000
175300     EXEC SQL                                                     17530000
175400        SELECT B.STATUS_CDE                                       17540000
175500            ,  B.PKSL_ITM_QTY                                     17550000
175600            ,  B.EXPTED_CART_CNT                                  17560000
175700            ,  B.PREPK_ID                                         17570000
175800            ,  B.DTL_CK_ITM_QTY                                   17580000
175900            ,  A.EXPTED_ITM_QTY                                   17590000
176000            ,  A.VERIFY_ITM_QTY                                   17600000
176100*           ,  A.AP_VERIFY_ITM_QTY                                17610000
176200            ,  B.PREPK_RATO_QTY                                   17620000
176300            ,  A.OPER_UNT_ID                                      17630000
176400        INTO   :RECITM-STATUS-CDE                                 17640000
176500            ,  :RECITM-PKSL-ITM-QTY                               17650000
176600            ,  :RECITM-EXPTED-CART-CNT                            17660000
176700            ,  :RECITM-PREPK-ID                                   17670000
176800            ,  :RECITM-DTL-CK-ITM-QTY                             17680000
176900            ,  :RECDIS-EXPTED-ITM-QTY                             17690000
177000            ,  :RECDIS-VERIFY-ITM-QTY                             17700000
177100*           ,  :RECDIS-AP-VERIFY-ITM-QTY                          17710000
177200            ,  :RECITM-PREPK-RATO-QTY                             17720000
177300            ,  :RECDIS-OPER-UNT-ID                                17730000
177400          FROM TRECDIS A                                          17740000
177500            ,  TRECITM B                                          17750000
177600         WHERE A.ORD_NBR         =  :SU044-PO                     17760000
177700           AND A.ORD_LNE_NBR     =  :SHUUPC-TRN-LNE-NBR           17770000
177800           AND A.REC_SEQ_NBR     =  :SU044-ORIG-REC-SEQ-NBR       17780000
177900           AND A.STR_NBR         =  :DK-STR-DEST-NBR              17790000
178000           AND A.ORD_NBR         =  B.ORD_NBR                     17800000
178100           AND A.ORD_LNE_NBR     =  B.ORD_LNE_NBR                 17810000
178200           AND A.REC_SEQ_NBR     =  B.REC_SEQ_NBR                 17820000
178210          with ur                                                 17821016
178300     END-EXEC.                                                    17830000
178400                                                                  17840000
178500     EVALUATE TRUE                                                17850000
178600         WHEN SQLCODE = ZERO                                      17860000
178700             CONTINUE                                             17870000
178800         WHEN SQLWARN0 NOT = SPACES                               17880000
178900         WHEN SQLCODE NOT EQUAL ZERO                              17890000
178910                                                                  17891015
178920              MOVE '5100'  TO  PV-CSSL-PARA                       17892015
178930              perform 8110-WRITE-suws044-TO-CSSL                  17893015
178940                                                                  17894015
179000             SET PS-ERROR                                         17900000
179100                 SU044-INVALID-SQL    TO TRUE                     17910000
179200             MOVE  SQLCODE            TO pv-disp-sqlcode          17920007
179300             STRING   ' SUKUT704-5100-'                           17930000
179400                      ' CALLED BY-'                               17940000
179500                      SU044-PROGRAM-NAME                          17950000
179600                      '  SQLCODE='                                17960000
179700                      pv-disp-sqlcode                             17970007
179800                      ' PO NBR= '                                 17980000
179900                      ' '                                         17990000
180000                      DELIMITED BY SIZE                           18000000
180100                                      INTO PV-CICS-MSG-AREA       18010000
180200             PERFORM 9999-WRITE-TO-CSSL                           18020000
180300***                                                               18030000
180400             MOVE SU044-PO                TO PV-DISP-PO           18040000
180500             MOVE SHUUPC-TRN-LNE-NBR      TO PV-DISP-LINE         18050000
180600             MOVE SU044-ORIG-REC-SEQ-NBR  TO PV-DISP-RCVR         18060000
180700             MOVE DK-STR-DEST-NBR         TO PV-DISP-STR          18070000
180710             INITIALIZE  PV-CICS-MSG-AREA                         18071000
180720             STRING   ' SUKUT704-5100-'                           18072000
180730                      PV-DISP-PO '-'                              18073000
180740                      PV-DISP-RCVR '-'                            18074000
180741                      PV-DISP-LINE '-'                            18074100
180742                      PV-DISP-STR                                 18074200
180743                      DELIMITED BY SIZE                           18074300
180744                                      INTO PV-CICS-MSG-AREA       18074400
180745             PERFORM 9999-WRITE-TO-CSSL                           18074500
180746***                                                               18074600
180747             MOVE '5100-'                TO SU044-CRA-REQ-ID      18074700
180748             MOVE PV-CICS-MSG-AREA      TO SU044-CRA-RET-MSG      18074800
180749             SET SU044-INVALID-SQL TO TRUE                        18074900
180750             PERFORM 9998-RETURN                                  18075000
180760     END-EVALUATE.                                                18076000
180770                                                                  18077000
180780                                                                  18078000
180790*----------------------------------------------------------------*18079000
180800 5150-UPDATE-TPKITEM-ONLY.                                        18080000
180900*----------------------------------------------------------------*18090000
181000                                                                  18100000
181020     IF  PS-BLD-INTERNAL-TABLE-YES                                18102013
181030         MOVE  '5150'  TO  PT-CURR-PARA                           18103013
181040         PERFORM 8120-INTERNAL-TABLE                              18104013
181050     END-IF.                                                      18105013
181100                                                                  18110000
181200      PERFORM 5350-SELECT-TPKITEM.                                18120000
181300                                                                  18130000
181400      IF PKITEM-PKSL-ITM-QTY      <  PV-SHUUPC-SHPD-QTY           18140000
181500         MOVE ZEROES                TO DK-PKITM-UPD-ITM-QTY       18150000
181600      ELSE                                                        18160000
181700         COMPUTE DK-PKITM-UPD-ITM-QTY      =                      18170000
181800             (PKITEM-PKSL-ITM-QTY  - PV-SHUUPC-SHPD-QTY)          18180000
181900      END-IF                                                      18190000
182000                                                                  18200000
182100      PERFORM 5360-UPDATE-TPKITEM.                                18210000
182200                                                                  18220000
182300                                                                  18230000
182400 5190-INSERT-RECDIS-ORIG.                                         18240000
182410                                                                  18241013
182420     IF  PS-BLD-INTERNAL-TABLE-YES                                18242013
182430         MOVE  '5190'  TO  PT-CURR-PARA                           18243013
182440         PERFORM 8120-INTERNAL-TABLE                              18244013
182450     END-IF.                                                      18245013
182500                                                                  18250000
182600     EXEC SQL                                                     18260000
182700       INSERT INTO RCT_RECDIS_ORIG                                18270000
182800             (  ORD_NBR                                           18280000
182900               ,ORD_LNE_NBR                                       18290000
183000               ,REC_SEQ_NBR                                       18300000
183100               ,OPER_UNT_ID                                       18310000
183200               ,FCLTY_ID                                          18320000
183300               ,STR_NBR                                           18330000
183400               ,STR_FCLTY_ID                                      18340000
183500               ,ORIG_EXPTED_QTY                                   18350000
183600               ,CRE_TMST)                                         18360000
183700       VALUES (:SU044-PO                                          18370000
183800              ,:SHUUPC-TRN-LNE-NBR                                18380000
183900              ,:SU044-ORIG-REC-SEQ-NBR                            18390000
184000              ,:RECDIS-OPER-UNT-ID                                18400000
184100              , 1                                                 18410000
184200              ,:DK-STR-DEST-NBR                                   18420000
184300              , 1                                                 18430000
184400              ,:RECDIS-EXPTED-ITM-QTY                             18440000
184500              , CURRENT TIMESTAMP)                                18450000
184600     END-EXEC.                                                    18460000
184700                                                                  18470000
184800     EVALUATE TRUE                                                18480000
184900         WHEN SQLCODE = +0                                        18490000
185000         WHEN SQLCODE = -803                                      18500000
185100             CONTINUE                                             18510000
185200         WHEN SQLWARN0 NOT = SPACES                               18520000
185300         WHEN SQLCODE < +0                                        18530000
185400         WHEN SQLCODE > +0                                        18540000
185410                                                                  18541015
185420              MOVE '5190'  TO  PV-CSSL-PARA                       18542015
185430              perform 8110-WRITE-suws044-TO-CSSL                  18543015
185440                                                                  18544015
185500             SET PS-ERROR                                         18550000
185600                 SU044-INVALID-SQL    TO TRUE                     18560000
185700             MOVE SU044-PO            TO PV-DISP-PO               18570000
185800             MOVE DK-REC-SEQ-NBR      TO PV-DISP-RCVR-SEQ-NBR     18580000
185900             MOVE SHUUPC-TRN-LNE-NBR  TO PV-DISP-PO-LNE-NBR       18590000
186000             MOVE DK-STR-DEST-NBR     TO PV-DISP-STR-NBR          18600000
186100             MOVE  SQLCODE            TO pv-disp-sqlcode          18610007
186200             STRING   ' SUKUT704-5190-'                           18620000
186300                      ' CALLED BY-'                               18630000
186400                      SU044-PROGRAM-NAME                          18640000
186500                      '  SQLCODE='                                18650000
186600                      pv-disp-sqlcode                             18660007
186700                      ' PO='                                      18670000
186800                      PV-DISP-PO                                  18680000
186900                      ' RCV='                                     18690000
187000                      PV-DISP-RCVR-SEQ-NBR                        18700000
187100                      ' LNE='                                     18710000
187200                      PV-DISP-PO-LNE-NBR                          18720000
187300                      ' STR='                                     18730000
187400                      PV-DISP-STR-NBR                             18740000
187500                      DELIMITED BY SIZE                           18750000
187600                                      INTO PV-CICS-MSG-AREA       18760000
187700             PERFORM 9999-WRITE-TO-CSSL                           18770000
187800             MOVE '5190-'                TO SU044-CRA-REQ-ID      18780000
187900             MOVE PV-CICS-MSG-AREA      TO SU044-CRA-RET-MSG      18790000
188000             PERFORM 9998-RETURN                                  18800000
188100     END-EVALUATE.                                                18810000
188200                                                                  18820000
188300                                                                  18830000
188400 5200-UPDATE-TRECDIS.                                             18840000
188410                                                                  18841013
188420     IF  PS-BLD-INTERNAL-TABLE-YES                                18842013
188430         MOVE  '5200'  TO  PT-CURR-PARA                           18843013
188440         PERFORM 8120-INTERNAL-TABLE                              18844013
188450     END-IF.                                                      18845013
188500                                                                  18850000
188600     IF PS-LOG-MESSAGE                                            18860000
188700        MOVE ' SUKUT704-5200-UPDATE-TRECDIS '                     18870002
188900                                    TO PV-CICS-MSG-AREA           18890002
189000        PERFORM 9999-WRITE-TO-CSSL                                18900000
189100         MOVE SU044-SUCCESS-IND TO PV-CICS-MSG-AREA               18910000
189200         PERFORM 9999-WRITE-TO-CSSL                               18920000
189300     END-IF                                                       18930000
189400     EXEC SQL                                                     18940000
189500       UPDATE TRECDIS                                             18950000
189600          SET EXPTED_ITM_QTY   = :DK-EXPTED-ITM-UPD-QTY           18960000
189700             ,VERIFY_ITM_QTY   = :DK-VERIFY-ITM-UPD-QTY           18970000
189800*            ,AP_VERIFY_ITM_QTY= :DK-AP-VERIFY-ITM-UPD-QTY        18980000
189900        WHERE ORD_NBR          = :SU044-PO                        18990000
190000          AND ORD_LNE_NBR      = :SHUUPC-TRN-LNE-NBR              19000000
190100          AND REC_SEQ_NBR      = :SU044-ORIG-REC-SEQ-NBR          19010000
190200          AND STR_NBR          = :DK-STR-DEST-NBR                 19020000
190300     END-EXEC.                                                    19030000
190400                                                                  19040000
190500     EVALUATE TRUE                                                19050000
190600         WHEN SQLCODE = +0                                        19060000
190700             CONTINUE                                             19070000
190800         WHEN SQLWARN0 NOT = SPACES                               19080000
190900         WHEN SQLCODE < +0                                        19090000
191000         WHEN SQLCODE > +0                                        19100000
191010                                                                  19101015
191020              MOVE '5200'  TO  PV-CSSL-PARA                       19102015
191030              perform 8110-WRITE-suws044-TO-CSSL                  19103015
191040                                                                  19104015
191100             SET PS-ERROR                                         19110000
191200                 SU044-INVALID-SQL    TO TRUE                     19120000
191300             MOVE SU044-PO            TO PV-DISP-PO               19130000
191400             MOVE DK-REC-SEQ-NBR      TO PV-DISP-RCVR-SEQ-NBR     19140000
191500             MOVE SHUUPC-TRN-LNE-NBR  TO PV-DISP-PO-LNE-NBR       19150000
191600             MOVE DK-STR-DEST-NBR     TO PV-DISP-STR-NBR          19160000
191700             MOVE  SQLCODE            TO pv-disp-sqlcode          19170007
191800             STRING   ' SUKUT704-5200-'                           19180000
191900                      ' CALLED BY-'                               19190000
192000                      SU044-PROGRAM-NAME                          19200000
192100                      '  SQLCODE='                                19210000
192200                      pv-disp-sqlcode                             19220007
192300                      ' PO='                                      19230000
192400                      PV-DISP-PO                                  19240000
192500                      ' RCV='                                     19250000
192600                      PV-DISP-RCVR-SEQ-NBR                        19260000
192700                      ' LNE='                                     19270000
192800                      PV-DISP-PO-LNE-NBR                          19280000
192900                      ' STR='                                     19290000
193000                      PV-DISP-STR-NBR                             19300000
193100                      DELIMITED BY SIZE                           19310000
193200                                      INTO PV-CICS-MSG-AREA       19320000
193300             PERFORM 9999-WRITE-TO-CSSL                           19330000
193400             MOVE '5200-'                TO SU044-CRA-REQ-ID      19340000
193500             MOVE PV-CICS-MSG-AREA      TO SU044-CRA-RET-MSG      19350000
193600             PERFORM 9998-RETURN                                  19360000
193700     END-EVALUATE.                                                19370000
193800                                                                  19380000
193900                                                                  19390000
194000 5300-UPDATE-TRECITM.                                             19400000
194010                                                                  19401013
194020     IF  PS-BLD-INTERNAL-TABLE-YES                                19402013
194030         MOVE  '5300'  TO  PT-CURR-PARA                           19403013
194040         PERFORM 8120-INTERNAL-TABLE                              19404013
194050     END-IF.                                                      19405013
194100                                                                  19410000
194200     IF PS-LOG-MESSAGE                                            19420000
194300        MOVE ' SUKUT704-5300-UPDATE-TRECITM '                     19430002
194500                                    TO PV-CICS-MSG-AREA           19450002
194600        PERFORM 9999-WRITE-TO-CSSL                                19460000
194700         MOVE SU044-SUCCESS-IND TO PV-CICS-MSG-AREA               19470000
194800         PERFORM 9999-WRITE-TO-CSSL                               19480000
194900     END-IF                                                       19490000
195000     EXEC SQL                                                     19500000
195100       UPDATE TRECITM                                             19510000
195200          SET PKSL_ITM_QTY     = :DK-PKSL-ITM-UPD-QTY             19520000
195300            , DTL_CK_ITM_QTY   = :DK-DTL-CK-ITM-QTY               19530000
195400            , UPD_TMST         = CURRENT TIMESTAMP                19540000
195500            , UPD_PGM_ID       = :PC-CURRENT-PROGRAM-NAME         19550000
195600            , UPD_UID          = :SU044-SIGNON-USER-ID            19560000
195700        WHERE ORD_NBR          = :SU044-PO                        19570000
195800          AND ORD_LNE_NBR      = :SHUUPC-TRN-LNE-NBR              19580000
195900          AND REC_SEQ_NBR      = :SU044-ORIG-REC-SEQ-NBR          19590000
196000     END-EXEC.                                                    19600000
196100                                                                  19610000
196200     EVALUATE TRUE                                                19620000
196300         WHEN SQLCODE = +0                                        19630000
196400             CONTINUE                                             19640000
196500         WHEN SQLWARN0 NOT = SPACES                               19650000
196600         WHEN SQLCODE < +0                                        19660000
196700         WHEN SQLCODE > +0                                        19670000
196710                                                                  19671015
196720              MOVE '5300'  TO  PV-CSSL-PARA                       19672015
196730              perform 8110-WRITE-suws044-TO-CSSL                  19673015
196740                                                                  19674015
196800             SET PS-ERROR                                         19680000
196900                 SU044-INVALID-SQL    TO TRUE                     19690000
197000             MOVE SU044-PO            TO PV-DISP-PO               19700000
197100             MOVE DK-REC-SEQ-NBR      TO PV-DISP-RCVR-SEQ-NBR     19710000
197200             MOVE SHUUPC-TRN-LNE-NBR  TO PV-DISP-PO-LNE-NBR       19720000
197300             MOVE DK-STR-DEST-NBR     TO PV-DISP-STR-NBR          19730000
197400             MOVE  SQLCODE            TO pv-disp-sqlcode          19740007
197500             STRING   ' SUKUT704-5300-'                           19750000
197600                      ' CALLED BY-'                               19760000
197700                      SU044-PROGRAM-NAME                          19770000
197800                      '  SQLCODE='                                19780000
197900                      pv-disp-sqlcode                             19790007
198000                      ' PO='                                      19800000
198100                      PV-DISP-PO                                  19810000
198200                      ' RCV='                                     19820000
198300                      PV-DISP-RCVR-SEQ-NBR                        19830000
198400                      ' LNE='                                     19840000
198500                      PV-DISP-PO-LNE-NBR                          19850000
198600                      ' STR='                                     19860000
198700                      PV-DISP-STR-NBR                             19870000
198800                      DELIMITED BY SIZE                           19880000
198900                                      INTO PV-CICS-MSG-AREA       19890000
199000             PERFORM 9999-WRITE-TO-CSSL                           19900000
199100             MOVE '5300-'                TO SU044-CRA-REQ-ID      19910000
199200             MOVE PV-CICS-MSG-AREA      TO SU044-CRA-RET-MSG      19920000
199300             PERFORM 9998-RETURN                                  19930000
199400     END-EVALUATE.                                                19940000
199500                                                                  19950000
199600 5350-SELECT-TPKITEM.                                             19960000
199610                                                                  19961013
199620     IF  PS-BLD-INTERNAL-TABLE-YES                                19962013
199630         MOVE  '5350'  TO  PT-CURR-PARA                           19963013
199640         PERFORM 8120-INTERNAL-TABLE                              19964013
199650     END-IF.                                                      19965013
199700                                                                  19970000
199800     IF PS-LOG-MESSAGE                                            19980000
199900        MOVE ' SUKUT704-5350-SELECT-TPKITEM '                     19990002
200100                                    TO PV-CICS-MSG-AREA           20010002
200200        PERFORM 9999-WRITE-TO-CSSL                                20020000
200300         MOVE SU044-SUCCESS-IND TO PV-CICS-MSG-AREA               20030000
200400         PERFORM 9999-WRITE-TO-CSSL                               20040000
200500     END-IF                                                       20050000
200600                                                                  20060000
200700     EXEC SQL                                                     20070000
200800        SELECT PKSL_ITM_QTY                                       20080000
200900        INTO   :PKITEM-PKSL-ITM-QTY                               20090000
201000          FROM TPKITEM A                                          20100000
201100         WHERE A.PO_NBR          =  :SU044-PO                     20110000
201200           AND A.SEQ_NBR         =  :SU044-ORIG-PKSL-SEQ-NBR      20120000
201300           AND A.PKSL_LNE_NBR    =  :SHUUPC-TRN-LNE-NBR           20130000
201400           AND A.VER_STAT_CDE    = 'A'                            20140000
201410          with ur                                                 20141016
201500     END-EXEC.                                                    20150000
201600                                                                  20160000
201700     EVALUATE TRUE                                                20170000
201800         WHEN SQLCODE = ZERO                                      20180000
201900             CONTINUE                                             20190000
202000         WHEN SQLCODE = +100                                      20200000
202100             MOVE ZEROES TO PKITEM-PKSL-ITM-QTY                   20210000
202110         WHEN SQLCODE = -811                                      20211026
202120              perform 5353-SELECT-TPKITEM-W-TMST                  20212026
202130                                                                  20213026
202200         WHEN SQLWARN0 NOT = SPACES                               20220000
202300         WHEN SQLCODE NOT EQUAL ZERO                              20230000
202301                                                                  20230115
202302              MOVE '5350'  TO  PV-CSSL-PARA                       20230215
202303              perform 8110-WRITE-suws044-TO-CSSL                  20230315
202304                                                                  20230415
202310             INITIALIZE  PV-CICS-MSG-AREA                         20231000
202400             SET PS-ERROR                                         20240000
202500                 SU044-INVALID-SQL    TO TRUE                     20250000
202600             MOVE  SQLCODE            TO pv-disp-sqlcode          20260007
202700             MOVE SU044-PO TO PV-DISP-PO                          20270000
202800             MOVE SU044-ORIG-REC-SEQ-NBR                          20280000
202900                           TO PV-DISP-RCVR-SEQ-NBR                20290000
203000             MOVE SU044-ORIG-PKSL-SEQ-NBR                         20300000
203100                           TO PV-DISPLAY-PKSL-SEQ-NBR             20310000
203110             MOVE SHUUPC-TRN-LNE-NBR                              20311000
203120                           TO PV-DISPLAY-LINE-NBR                 20312000
203200             STRING   ' SUKUT704-5350-'                           20320000
203300                      ' CALLED BY-'                               20330000
203400                      SU044-PROGRAM-NAME                          20340000
203500                      '  SQLCODE='                                20350000
203600                      pv-disp-sqlcode                             20360007
203700                      ' '                                         20370000
203800                      'PO = '                                     20380000
203900                      PV-DISP-PO                                  20390000
204000                      'REC= '                                     20400000
204100                      PV-DISP-RCVR-SEQ-NBR                        20410000
204200                      'ORIG PKSL SEQ'                             20420000
204300                      PV-DISPLAY-PKSL-SEQ-NBR                     20430000
204400                      ' '                                         20440000
204500                      DELIMITED BY SIZE                           20450000
204600                                      INTO PV-CICS-MSG-AREA       20460000
204700             PERFORM 9999-WRITE-TO-CSSL                           20470000
204701                                                                  20470100
204710             INITIALIZE  PV-CICS-MSG-AREA                         20471000
204791             STRING   ' SUKUT704-5350-'                           20479100
204792                      ' CALLED BY-'                               20479200
204801                      'ORIG PKSL SEQ'                             20480100
204802                      PV-DISPLAY-PKSL-SEQ-NBR                     20480200
204803                      '   '                                       20480300
204804                      'LINE NBR'                                  20480400
204805                      PV-DISPLAY-LINE-NBR                         20480500
204806                      DELIMITED BY SIZE                           20480600
204807                                      INTO PV-CICS-MSG-AREA       20480700
204808             PERFORM 9999-WRITE-TO-CSSL                           20480800
204809                                                                  20480900
204810             MOVE '5350-'                TO SU044-CRA-REQ-ID      20481000
204900             MOVE PV-CICS-MSG-AREA      TO SU044-CRA-RET-MSG      20490000
205000             SET SU044-INVALID-SQL TO TRUE                        20500000
205100             PERFORM 9998-RETURN                                  20510000
205200     END-EVALUATE.                                                20520000
205300                                                                  20530000
205301                                                                  20530126
205302*----------------------------------------------------------------*20530226
205303* select tpkitem when there are 2 active rows                    *20530326
205304*----------------------------------------------------------------*20530426
205310 5353-SELECT-TPKITEM-W-TMST.                                      20531026
205320                                                                  20532026
205330     IF  PS-BLD-INTERNAL-TABLE-YES                                20533026
205340         MOVE  '5353'  TO  PT-CURR-PARA                           20534026
205350         PERFORM 8120-INTERNAL-TABLE                              20535026
205360     END-IF.                                                      20536026
205370                                                                  20537026
205380     IF PS-LOG-MESSAGE                                            20538026
205390        MOVE ' SUKUT704-5353-SELECT-TPKITEM-W-TMST '              20539026
205391                                    TO PV-CICS-MSG-AREA           20539126
205392        PERFORM 9999-WRITE-TO-CSSL                                20539226
205393         MOVE SU044-SUCCESS-IND TO PV-CICS-MSG-AREA               20539326
205394         PERFORM 9999-WRITE-TO-CSSL                               20539426
205395     END-IF                                                       20539526
205396                                                                  20539626
205397     EXEC SQL                                                     20539726
205398        SELECT PKSL_ITM_QTY                                       20539826
205399             , CRE_TMST                                           20539931
205400        INTO   :PKITEM-PKSL-ITM-QTY                               20540026
205401             , :PKITEM-CRE-TMST                                   20540131
205402          FROM TPKITEM A                                          20540231
205403         WHERE A.PO_NBR          =  :SU044-PO                     20540331
205404           AND A.SEQ_NBR         =  :SU044-ORIG-PKSL-SEQ-NBR      20540431
205405           AND A.PKSL_LNE_NBR    =  :SHUUPC-TRN-LNE-NBR           20540531
205406           AND A.VER_STAT_CDE    = 'A'                            20540631
205407           AND A.CRE_TMST  IN                                     20540731
205408               (SELECT MAX(B.CRE_TMST)                            20540831
205409                  FROM TPKITEM B                                  20540931
205410                 WHERE b.PO_NBR       =  :SU044-PO                20541035
205411                   AND b.SEQ_NBR      =  :SU044-ORIG-PKSL-SEQ-NBR 20541135
205412                   AND b.PKSL_LNE_NBR =  :SHUUPC-TRN-LNE-NBR      20541235
205413                   AND b.VER_STAT_CDE =  'A'                      20541335
205414               )                                                  20541431
205415          WITH UR                                                 20541531
205416     END-EXEC.                                                    20541631
205417                                                                  20541731
205418     EVALUATE TRUE                                                20541831
205419         WHEN SQLCODE = ZERO                                      20541931
205420              PERFORM 5355-INACTIVATE-TPKITEM-W-TMST              20542031
205421                                                                  20542131
205422         WHEN SQLCODE = +100                                      20542231
205423             continue                                             20542331
205424                                                                  20542431
205425         WHEN SQLWARN0 NOT = SPACES                               20542531
205426         WHEN SQLCODE NOT EQUAL ZERO                              20542631
205427                                                                  20542731
205428              MOVE '5353'  TO  PV-CSSL-PARA                       20542831
205429              perform 8110-WRITE-suws044-TO-CSSL                  20542931
205430                                                                  20543031
205431             INITIALIZE  PV-CICS-MSG-AREA                         20543131
205432             SET PS-ERROR                                         20543231
205433                 SU044-INVALID-SQL    TO TRUE                     20543331
205434             MOVE  SQLCODE            TO pv-disp-sqlcode          20543431
205435             MOVE SU044-PO TO PV-DISP-PO                          20543531
205436             MOVE SU044-ORIG-REC-SEQ-NBR                          20543631
205437                           TO PV-DISP-RCVR-SEQ-NBR                20543731
205438             MOVE SU044-ORIG-PKSL-SEQ-NBR                         20543831
205439                           TO PV-DISPLAY-PKSL-SEQ-NBR             20543931
205440             MOVE SHUUPC-TRN-LNE-NBR                              20544031
205441                           TO PV-DISPLAY-LINE-NBR                 20544131
205442             STRING   ' SUKUT704-5353-'                           20544231
205443                      ' CALLED BY-'                               20544331
205444                      SU044-PROGRAM-NAME                          20544431
205445                      '  SQLCODE='                                20544531
205446                      pv-disp-sqlcode                             20544631
205447                      ' '                                         20544731
205448                      'PO = '                                     20544831
205449                      PV-DISP-PO                                  20544931
205450                      'REC= '                                     20545031
205451                      PV-DISP-RCVR-SEQ-NBR                        20545131
205452                      'ORIG PKSL SEQ'                             20545231
205453                      PV-DISPLAY-PKSL-SEQ-NBR                     20545331
205454                      ' '                                         20545431
205455                      DELIMITED BY SIZE                           20545531
205456                                      INTO PV-CICS-MSG-AREA       20545631
205457             PERFORM 9999-WRITE-TO-CSSL                           20545731
205458                                                                  20545831
205459             INITIALIZE  PV-CICS-MSG-AREA                         20545931
205460             STRING   ' SUKUT704-5353-'                           20546031
205461                      ' CALLED BY-'                               20546131
205462                      'ORIG PKSL SEQ'                             20546231
205463                      PV-DISPLAY-PKSL-SEQ-NBR                     20546331
205464                      '   '                                       20546431
205465                      'LINE NBR'                                  20546531
205466                      PV-DISPLAY-LINE-NBR                         20546631
205467                      DELIMITED BY SIZE                           20546731
205468                                      INTO PV-CICS-MSG-AREA       20546831
205469             PERFORM 9999-WRITE-TO-CSSL                           20546931
205470                                                                  20547031
205471             MOVE '5353-'                TO SU044-CRA-REQ-ID      20547131
205472             MOVE PV-CICS-MSG-AREA      TO SU044-CRA-RET-MSG      20547231
205473             SET SU044-INVALID-SQL TO TRUE                        20547331
205474             PERFORM 9998-RETURN                                  20547431
205475     END-EVALUATE.                                                20547531
205476                                                                  20547631
205477                                                                  20547731
205478*----------------------------------------------------------------*20547831
205479* inactivate the older of the entries when there are multiple    *20547931
205480* duplicate active rows                                          *20548031
205481*----------------------------------------------------------------*20548131
205482 5355-INACTIVATE-TPKITEM-W-TMST.                                  20548231
205483                                                                  20548331
205484     IF  PS-BLD-INTERNAL-TABLE-YES                                20548431
205485         MOVE  '5355'  TO  PT-CURR-PARA                           20548531
205486         PERFORM 8120-INTERNAL-TABLE                              20548631
205487     END-IF.                                                      20548731
205488                                                                  20548831
205489     IF PS-LOG-MESSAGE                                            20548931
205490        MOVE ' SUKUT704-5355-INACTIVATE-TPKITEM-W-TMST '          20549031
205491                                    TO PV-CICS-MSG-AREA           20549131
205492        PERFORM 9999-WRITE-TO-CSSL                                20549231
205493         MOVE SU044-SUCCESS-IND TO PV-CICS-MSG-AREA               20549331
205494         PERFORM 9999-WRITE-TO-CSSL                               20549431
205495     END-IF                                                       20549531
205496                                                                  20549631
205497     EXEC SQL                                                     20549731
205498        UPDATE TPKITEM                                            20549831
205499           SET VER_STAT_CDE      =  'I'                           20549931
205500         WHERE PO_NBR          =  :SU044-PO                       20550028
205501           AND SEQ_NBR         =  :SU044-ORIG-PKSL-SEQ-NBR        20550128
205502           AND PKSL_LNE_NBR    =  :SHUUPC-TRN-LNE-NBR             20550228
205503           AND VER_STAT_CDE    = 'A'                              20550328
205504           AND CRE_TMST        <  :PKITEM-CRE-TMST                20550432
205513     END-EXEC.                                                    20551326
205514                                                                  20551426
205515     EVALUATE TRUE                                                20551526
205516         WHEN SQLCODE = ZERO                                      20551626
205517         WHEN SQLCODE = +100                                      20551726
205518             CONTINUE                                             20551826
205519         WHEN SQLWARN0 NOT = SPACES                               20551926
205520         WHEN SQLCODE NOT EQUAL ZERO                              20552026
205521                                                                  20552126
205522              MOVE '5355'  TO  PV-CSSL-PARA                       20552226
205523              perform 8110-WRITE-suws044-TO-CSSL                  20552326
205524                                                                  20552426
205525             INITIALIZE  PV-CICS-MSG-AREA                         20552526
205526             SET PS-ERROR                                         20552626
205527                 SU044-INVALID-SQL    TO TRUE                     20552726
205528             MOVE  SQLCODE            TO pv-disp-sqlcode          20552826
205529             MOVE SU044-PO TO PV-DISP-PO                          20552926
205530             MOVE SU044-ORIG-REC-SEQ-NBR                          20553026
205531                           TO PV-DISP-RCVR-SEQ-NBR                20553126
205532             MOVE SU044-ORIG-PKSL-SEQ-NBR                         20553226
205533                           TO PV-DISPLAY-PKSL-SEQ-NBR             20553326
205534             MOVE SHUUPC-TRN-LNE-NBR                              20553426
205535                           TO PV-DISPLAY-LINE-NBR                 20553526
205536             STRING   ' SUKUT704-5355-'                           20553626
205537                      ' CALLED BY-'                               20553726
205538                      SU044-PROGRAM-NAME                          20553826
205539                      '  SQLCODE='                                20553926
205540                      pv-disp-sqlcode                             20554026
205541                      ' '                                         20554126
205542                      'PO = '                                     20554226
205543                      PV-DISP-PO                                  20554326
205544                      'REC= '                                     20554426
205545                      PV-DISP-RCVR-SEQ-NBR                        20554526
205546                      'ORIG PKSL SEQ'                             20554626
205547                      PV-DISPLAY-PKSL-SEQ-NBR                     20554726
205548                      ' '                                         20554826
205549                      DELIMITED BY SIZE                           20554926
205550                                      INTO PV-CICS-MSG-AREA       20555026
205551             PERFORM 9999-WRITE-TO-CSSL                           20555126
205552                                                                  20555226
205553             INITIALIZE  PV-CICS-MSG-AREA                         20555326
205554             STRING   ' SUKUT704-5355-'                           20555426
205555                      ' CALLED BY-'                               20555526
205556                      'ORIG PKSL SEQ'                             20555626
205557                      PV-DISPLAY-PKSL-SEQ-NBR                     20555726
205558                      '   '                                       20555826
205559                      'LINE NBR'                                  20555926
205560                      PV-DISPLAY-LINE-NBR                         20556026
205561                      DELIMITED BY SIZE                           20556126
205562                                      INTO PV-CICS-MSG-AREA       20556226
205563             PERFORM 9999-WRITE-TO-CSSL                           20556326
205564                                                                  20556426
205565             MOVE '5355-'                TO SU044-CRA-REQ-ID      20556526
205566             MOVE PV-CICS-MSG-AREA      TO SU044-CRA-RET-MSG      20556626
205567             SET SU044-INVALID-SQL TO TRUE                        20556726
205568             PERFORM 9998-RETURN                                  20556826
205569     END-EVALUATE.                                                20556926
205570                                                                  20557026
205571                                                                  20557126
205572*----------------------------------------------------------------*20557226
205573*                                                                *20557326
205574*----------------------------------------------------------------*20557426
205575 5360-UPDATE-TPKITEM.                                             20557500
205576                                                                  20557613
205577     IF  PS-BLD-INTERNAL-TABLE-YES                                20557713
205578         MOVE  '5360'  TO  PT-CURR-PARA                           20557813
205579         PERFORM 8120-INTERNAL-TABLE                              20557913
205580     END-IF.                                                      20558013
205590                                                                  20559000
205600     IF PS-LOG-MESSAGE                                            20560000
205700        MOVE ' SUKUT704-5360-UPDATE-TPKITEM '                     20570002
205900                                    TO PV-CICS-MSG-AREA           20590002
206000        PERFORM 9999-WRITE-TO-CSSL                                20600000
206100         MOVE SU044-SUCCESS-IND TO PV-CICS-MSG-AREA               20610000
206200         PERFORM 9999-WRITE-TO-CSSL                               20620000
206300     END-IF                                                       20630000
206400                                                                  20640000
206500     EXEC SQL                                                     20650000
206600       UPDATE TPKITEM                                             20660000
206700          SET PKSL_ITM_QTY   =  :DK-PKITM-UPD-ITM-QTY             20670000
206800       WHERE PO_NBR          =  :SU044-PO                         20680000
206900         AND SEQ_NBR         =  :SU044-ORIG-PKSL-SEQ-NBR          20690000
207000         AND PKSL_LNE_NBR    =  :SHUUPC-TRN-LNE-NBR               20700000
207100         AND VER_STAT_CDE    =  'A'                               20710000
207200     END-EXEC.                                                    20720000
207300                                                                  20730000
207400     EVALUATE TRUE                                                20740000
207500         WHEN SQLCODE = +0                                        20750000
207600         WHEN SQLCODE = +100                                      20760000
207700             CONTINUE                                             20770000
207800         WHEN SQLWARN0 NOT = SPACES                               20780000
207900         WHEN SQLCODE < +0                                        20790000
208000         WHEN SQLCODE > +0                                        20800000
208010                                                                  20801015
208020              MOVE '5360'  TO  PV-CSSL-PARA                       20802015
208030              perform 8110-WRITE-suws044-TO-CSSL                  20803015
208040                                                                  20804015
208100             SET PS-ERROR                                         20810000
208200                 SU044-INVALID-SQL    TO TRUE                     20820000
208300             MOVE SU044-PO            TO PV-DISP-PO               20830000
208400             MOVE DK-REC-SEQ-NBR      TO PV-DISP-RCVR-SEQ-NBR     20840000
208500             MOVE SHUUPC-TRN-LNE-NBR  TO PV-DISP-PO-LNE-NBR       20850000
208600             MOVE DK-STR-DEST-NBR     TO PV-DISP-STR-NBR          20860000
208700             MOVE  SQLCODE            TO pv-disp-sqlcode          20870007
208800             STRING   ' SUKUT704-5360-'                           20880000
208900                      ' CALLED BY-'                               20890000
209000                      SU044-PROGRAM-NAME                          20900000
209100                      '  SQLCODE='                                20910000
209200                      pv-disp-sqlcode                             20920007
209300                      ' PO='                                      20930000
209400                      PV-DISP-PO                                  20940000
209500                      ' RCV='                                     20950000
209600                      PV-DISP-RCVR-SEQ-NBR                        20960000
209700                      ' LNE='                                     20970000
209800                      PV-DISP-PO-LNE-NBR                          20980000
209900                      ' STR='                                     20990000
210000                      PV-DISP-STR-NBR                             21000000
210100                      DELIMITED BY SIZE                           21010000
210200                                      INTO PV-CICS-MSG-AREA       21020000
210300             PERFORM 9999-WRITE-TO-CSSL                           21030000
210400             MOVE '5360-'                TO SU044-CRA-REQ-ID      21040000
210500             MOVE PV-CICS-MSG-AREA      TO SU044-CRA-RET-MSG      21050000
210600             PERFORM 9998-RETURN                                  21060000
210700     END-EVALUATE.                                                21070000
210800                                                                  21080000
210900                                                                  21090000
211000 6000-PRCS-ORIG-RCVR-BLK.                                         21100000
211010                                                                  21101013
211020     IF  PS-BLD-INTERNAL-TABLE-YES                                21102013
211030         MOVE  '6000'  TO  PT-CURR-PARA                           21103013
211040         PERFORM 8120-INTERNAL-TABLE                              21104013
211050     END-IF.                                                      21105013
211100                                                                  21110000
211200     IF PS-LOG-MESSAGE                                            21120000
211300        MOVE ' SUKUT704-6000-PRCS-ORIG-RCVR-BLK'                  21130002
211500                                    TO PV-CICS-MSG-AREA           21150002
211600        PERFORM 9999-WRITE-TO-CSSL                                21160000
211700         MOVE SU044-SUCCESS-IND TO PV-CICS-MSG-AREA               21170000
211800         PERFORM 9999-WRITE-TO-CSSL                               21180000
211900     END-IF                                                       21190000
212000                                                                  21200000
212100     PERFORM 6050-SELECT-TDISTHD.                                 21210000
212200     IF SU044-RCVR-BULK                                           21220000
212300        PERFORM 6100-BULK-LABEL-ROUTINE                           21230000
212400     ELSE                                                         21240000
212500        IF PS-FIRST-PREPK-LINE-YES                                21250000
212600           PERFORM 6100-BULK-LABEL-ROUTINE                        21260000
212700           SET PS-FIRST-PREPK-LINE-NO TO TRUE                     21270000
212800        ELSE                                                      21280000
212900           IF PS-LABEL-DATA-FOUND                                 21290000
213000              PERFORM 6700-PRINT-VIRTUAL-LABELS                   21300000
213100           END-IF                                                 21310000
213200        END-IF                                                    21320000
213300     END-IF.                                                      21330000
213400******************************************************************21340000
213500******************************************************************21350000
213600 6050-SELECT-TDISTHD.                                             21360000
213610                                                                  21361013
213620     IF  PS-BLD-INTERNAL-TABLE-YES                                21362013
213630         MOVE  '6050'  TO  PT-CURR-PARA                           21363013
213640         PERFORM 8120-INTERNAL-TABLE                              21364013
213650     END-IF.                                                      21365013
213700                                                                  21370000
213800     IF PS-LOG-MESSAGE                                            21380000
213900        MOVE ' SUKUT704-6050-SELECT-TDISTHD '                     21390002
214100                                    TO PV-CICS-MSG-AREA           21410002
214200        PERFORM 9999-WRITE-TO-CSSL                                21420000
214300         MOVE SU044-SUCCESS-IND TO PV-CICS-MSG-AREA               21430000
214400         PERFORM 9999-WRITE-TO-CSSL                               21440000
214500     END-IF                                                       21450000
214600                                                                  21460000
214700     EXEC SQL                                                     21470000
214800       SELECT  INPK_CNVYB_IND                                     21480000
214900            ,  TOT_CART_CNT                                       21490000
215000            ,  PREPK_LNE_PRC_CDE                                  21500000
215100       INTO   :DISTHD-INPK-CNVYB-IND                              21510000
215200            , :DISTHD-TOT-CART-CNT                                21520000
215300            , :DISTHD-PREPK-LNE-PRC-CDE                           21530000
215400       FROM TDISTHD A                                             21540000
215500        WHERE A.ORD_NBR           =  :SU044-PO                    21550000
215600         AND A.RCVR_SEQ_NBR       =  :SU044-ORIG-REC-SEQ-NBR      21560000
215700         AND A.ORD_LNE_NBR        =  :SHUUPC-TRN-LNE-NBR          21570000
215800         AND A.UCC128_DAT_USG_CDE =  'U'                          21580000
215900         AND A.TOT_CART_CNT       > 0                             21590000
215910        with ur                                                   21591016
216000     END-EXEC.                                                    21600000
216100                                                                  21610000
216200     EVALUATE TRUE                                                21620000
216300         WHEN SQLCODE = ZERO                                      21630000
216400             SET PS-TROUBLE-CREATE-NO TO TRUE                     21640000
216500         WHEN SQLCODE = +100                                      21650000
216600             SET PS-TROUBLE-CREATE-YES TO TRUE                    21660000
216700         WHEN SQLWARN0 NOT = SPACES                               21670000
216800         WHEN SQLCODE NOT EQUAL ZERO                              21680000
216810                                                                  21681015
216820              MOVE '6050'  TO  PV-CSSL-PARA                       21682015
216830              perform 8110-WRITE-suws044-TO-CSSL                  21683015
216840                                                                  21684015
216900             SET PS-ERROR                                         21690000
217000                 SU044-INVALID-SQL    TO TRUE                     21700000
217100             MOVE  SQLCODE            TO pv-disp-sqlcode          21710007
217200             STRING   ' SUKUT704-6050-'                           21720000
217300                      ' CALLED BY-'                               21730000
217400                      SU044-PROGRAM-NAME                          21740000
217500                      '  SQLCODE='                                21750000
217600                      pv-disp-sqlcode                             21760007
217700                      ' '                                         21770000
217800                      DELIMITED BY SIZE                           21780000
217900                                      INTO PV-CICS-MSG-AREA       21790000
218000             PERFORM 9999-WRITE-TO-CSSL                           21800000
218100             MOVE '6050-'                TO SU044-CRA-REQ-ID      21810000
218200             MOVE PV-CICS-MSG-AREA      TO SU044-CRA-RET-MSG      21820000
218300             SET SU044-INVALID-SQL TO TRUE                        21830000
218400             PERFORM 9998-RETURN                                  21840000
218500     END-EVALUATE.                                                21850000
218600                                                                  21860000
218700******************************************************************21870000
218800 6100-BULK-LABEL-ROUTINE.                                         21880000
218900******************************************************************21890000
218910                                                                  21891013
218920     IF  PS-BLD-INTERNAL-TABLE-YES                                21892013
218930         MOVE  '6100'  TO  PT-CURR-PARA                           21893013
218940         PERFORM 8120-INTERNAL-TABLE                              21894013
218950     END-IF.                                                      21895013
218960                                                                  21896013
219000     IF PS-LOG-MESSAGE                                            21900000
219100        MOVE ' SUKUT704-6100-BULK-LABEL-ROUTINE'                  21910002
219300                                    TO PV-CICS-MSG-AREA           21930002
219400        PERFORM 9999-WRITE-TO-CSSL                                21940000
219500         MOVE SU044-SUCCESS-IND TO PV-CICS-MSG-AREA               21950000
219600         PERFORM 9999-WRITE-TO-CSSL                               21960000
219700     END-IF                                                       21970000
219800                                                                  21980000
219900     INITIALIZE                                                   21990000
220000                DK-OUTER-QTY                                      22000000
220100                PV-TRN-LNE-NBR                                    22010000
220200                DK-PO-LNE-NBR                                     22020000
220300                PV-HOLD-TRN-LNE-NBR.                              22030000
220400     MOVE SHUUPC-TRN-LNE-NBR TO     DK-PO-LNE-NBR.                22040000
220500     SET PS-NOT-FOUND-ON-CURSOR                                   22050000
220600         PS-FIRST-PO-LINE-FOR-CTN TO TRUE.                        22060000
220700                                                                  22070000
220800     IF RECEIV-PKGNG-CDE = PC-M OR PC-I                           22080000
220900        MOVE ZEROES TO DK-PO-LNE-NBR                              22090000
221000        SET PS-NOT-ODD-UNT-CRTN-FOUND                             22100000
221100            PS-FOUND-ON-ODD-UNTS-CSR  TO TRUE                     22110000
221200        PERFORM 6335-OPEN-ODD-UNITS-CSR                           22120000
221300        PERFORM 6340-FETCH-ODD-UNITS-CSR                          22130000
221400          UNTIL PS-EO-ODD-UNTS-CSR OR PS-ODD-UNT-CRTN-FOUND       22140000
221500        PERFORM 6345-CLOSE-ODD-UNITS-CSR                          22150000
221600                                                                  22160000
221700        IF PS-ODD-UNT-CRTN-FOUND                                  22170000
221800           SET PS-TROUBLE-CREATE-YES TO TRUE                      22180000
221900        ELSE                                                      22190000
222000          SET PS-NOT-EO-PREPK-CSR                                 22200000
222100              PS-NOT-ODD-UNT-CRTN-FOUND  TO TRUE                  22210000
222200          PERFORM 6350-OPEN-PREPK-CSR                             22220000
222300          PERFORM 6360-FETCH-PREPK-CSR                            22230000
222400            UNTIL PS-EO-PREPK-CSR OR PS-ODD-UNT-CRTN-FOUND        22240000
222500          PERFORM 6370-CLOSE-PREPK-CSR                            22250000
222600        END-IF                                                    22260000
222700     ELSE                                                         22270000
222800         PERFORM 6450-OPEN-UNITS-CSR                              22280000
222900         PERFORM 6460-FETCH-LINE-AND-UNITS                        22290000
223000           UNTIL PS-EO-UNITS-CSR                                  22300000
223100         PERFORM 6470-CLOSE-UNITS-CSR                             22310000
223200     END-IF.                                                      22320000
223300                                                                  22330000
223400                                                                  22340000
223500     IF PS-ODD-UNT-CRTN-FOUND                                     22350000
223600        SET PS-TROUBLE-CREATE-YES TO TRUE                         22360000
223700     ELSE                                                         22370000
223800       IF PS-FOUND-ON-CURSOR                                      22380000
223900          PERFORM 6500-GET-VIRTUAL-LABEL-DATA                     22390000
224000          IF PS-LABEL-DATA-FOUND                                  22400000
224100             PERFORM 6700-PRINT-VIRTUAL-LABELS                    22410000
224200          ELSE                                                    22420000
224300             IF SU044-SRC-VERIFICATION                            22430000
224400                PERFORM 5150-UPDATE-TPKITEM-ONLY                  22440000
224500**CONSUME UNUSED P2L LABEL ??                                     22450000
224600             ELSE                                                 22460000
224700                SET PS-TROUBLE-CREATE-YES TO TRUE                 22470000
224800             END-IF                                               22480000
224900          END-IF                                                  22490000
225000       ELSE                                                       22500000
225100             SET PS-TROUBLE-CREATE-YES TO TRUE                    22510000
225200       END-IF                                                     22520000
225300     END-IF.                                                      22530000
225400                                                                  22540000
225500                                                                  22550000
225600******************************************************************22560000
225700 6335-OPEN-ODD-UNITS-CSR.                                         22570000
225710                                                                  22571013
225720     IF  PS-BLD-INTERNAL-TABLE-YES                                22572013
225730         MOVE  '6335'  TO  PT-CURR-PARA                           22573013
225740         PERFORM 8120-INTERNAL-TABLE                              22574013
225750     END-IF.                                                      22575013
225760                                                                  22576013
225800     SET PS-NOT-ODD-UNT-CRTN-FOUND TO TRUE.                       22580000
225900                                                                  22590000
226000      EXEC SQL                                                    22600000
226100           OPEN ODD-UNITS-CSR                                     22610000
226200      END-EXEC                                                    22620000
226300                                                                  22630000
226400                                                                  22640000
226500      EVALUATE TRUE                                               22650000
226600          WHEN SQLCODE = +0                                       22660000
226700              CONTINUE                                            22670000
226800          WHEN SQLWARN0 NOT = SPACES                              22680000
226900          WHEN SQLCODE < +0                                       22690000
227000          WHEN SQLCODE > +0                                       22700000
227010                                                                  22701015
227020              MOVE '6335'  TO  PV-CSSL-PARA                       22702015
227030              perform 8110-WRITE-suws044-TO-CSSL                  22703015
227040                                                                  22704015
227100              SET PS-ERROR                                        22710000
227200                  SU044-INVALID-SQL    TO TRUE                    22720000
227300              MOVE SU044-PO            TO PV-DISP-PO              22730000
227400              MOVE DK-REC-SEQ-NBR      TO PV-DISP-RCVR-SEQ-NBR    22740000
227500              MOVE SHUUPC-TRN-LNE-NBR  TO PV-DISP-PO-LNE-NBR      22750000
227600              MOVE DK-STR-DEST-NBR     TO PV-DISP-STR-NBR         22760000
227700              MOVE  SQLCODE            TO pv-disp-sqlcode         22770007
227800              STRING   ' SUKUT704-6335-'                          22780000
227900                       ' CALLED BY-'                              22790000
228000                       SU044-PROGRAM-NAME                         22800000
228100                       '  SQLCODE='                               22810000
228200                       pv-disp-sqlcode                            22820007
228300                       ' PO='                                     22830000
228400                       PV-DISP-PO                                 22840000
228500                       ' RCV='                                    22850000
228600                       PV-DISP-RCVR-SEQ-NBR                       22860000
228700                       ' LNE='                                    22870000
228800                       PV-DISP-PO-LNE-NBR                         22880000
228900                       ' STR='                                    22890000
229000                       PV-DISP-STR-NBR                            22900000
229100                       DELIMITED BY SIZE                          22910000
229200                                       INTO PV-CICS-MSG-AREA      22920000
229300              PERFORM 9999-WRITE-TO-CSSL                          22930000
229400              MOVE '6335-'                TO SU044-CRA-REQ-ID     22940000
229500              MOVE PV-CICS-MSG-AREA      TO SU044-CRA-RET-MSG     22950000
229600              PERFORM 9998-RETURN                                 22960000
229700      END-EVALUATE.                                               22970000
229800                                                                  22980000
229900 EJECT                                                            22990000
230000*----------------------------------------------------------------*23000000
230100*                                                                *23010000
230200*----------------------------------------------------------------*23020000
230300 6340-FETCH-ODD-UNITS-CSR.                                        23030000
230310                                                                  23031013
230320     IF  PS-BLD-INTERNAL-TABLE-YES                                23032013
230330         MOVE  '6340'  TO  PT-CURR-PARA                           23033013
230340         PERFORM 8120-INTERNAL-TABLE                              23034013
230350     END-IF.                                                      23035013
230400                                                                  23040000
230500     IF PS-LOG-MESSAGE                                            23050000
230600        MOVE ' SUKUT704-6340-FETCH-ODD-UNITS-CSR'                 23060002
230800                                    TO PV-CICS-MSG-AREA           23080002
230900        PERFORM 9999-WRITE-TO-CSSL                                23090000
231000         MOVE SU044-SUCCESS-IND TO PV-CICS-MSG-AREA               23100000
231100         PERFORM 9999-WRITE-TO-CSSL                               23110000
231200     END-IF                                                       23120000
231300                                                                  23130000
231400     EXEC SQL                                                     23140000
231500        FETCH   ODD-UNITS-CSR                                     23150000
231600        INTO   :PV-UNION-TYPE                                     23160000
231700            ,  :PV-TRN-LNE-NBR                                    23170000
231800     END-EXEC.                                                    23180000
231900* PREPACK SHOULD BE ON BOTH TSHUUPC('A' UNION) AND TRECITM('B')   23190000
232000* THE FETCH SHOULD ALWAYS RETURN AN ROW FROM 'A' FOLLOWED BY A    23200000
232100* ROW FROM 'B'                                                    23210000
232200                                                                  23220000
232300     EVALUATE TRUE                                                23230000
232400       WHEN SQLCODE = ZEROS                                       23240000
232500            SET PS-FOUND-ON-ODD-UNTS-CSR TO TRUE                  23250000
232600                                                                  23260000
232700            IF PS-FIRST-ODD-UNTS-FETCH                            23270000
232800* FIRST CARTON CANNOT BE A 'B'                                    23280000
232900               IF PV-UNION-TYPE = 'B'                             23290000
233000                  SET PS-ODD-UNT-CRTN-FOUND TO TRUE               23300000
233100               ELSE                                               23310000
233200                  MOVE PV-UNION-TYPE TO PV-PREV-FETCH             23320000
233300                  MOVE PV-TRN-LNE-NBR TO PV-PREV-LINE             23330000
233400                  SET PS-NOT-FIRST-ODD-UNTS-FETCH TO TRUE         23340000
233500               END-IF                                             23350000
233600            ELSE                                                  23360000
233700              IF PV-UNION-TYPE = PV-PREV-FETCH                    23370000
233800                 SET PS-ODD-UNT-CRTN-FOUND TO TRUE                23380000
233900              ELSE                                                23390000
234000                 IF PV-TRN-LNE-NBR = PV-PREV-LINE                 23400000
234100                     MOVE PV-UNION-TYPE  TO PV-PREV-FETCH         23410000
234200                     MOVE PV-TRN-LNE-NBR TO PV-PREV-LINE          23420000
234300                 ELSE                                             23430000
234400** CHECK CASE WHERE 'A' FOLLOWED BY 'B' ARE THE SAME LINE         23440000
234500** THE LINE NUMBER SHOULD ONLY CHANGE WHEN THE PREV-FETCH = 'B'   23450000
234600                     IF PV-PREV-FETCH = 'A'                       23460000
234700                        SET PS-ODD-UNT-CRTN-FOUND TO TRUE         23470000
234800                     ELSE                                         23480000
234900                        MOVE PV-UNION-TYPE  TO PV-PREV-FETCH      23490000
235000                        MOVE PV-TRN-LNE-NBR TO PV-PREV-LINE       23500000
235100                     END-IF                                       23510000
235200                 END-IF                                           23520000
235300              END-IF                                              23530000
235400            END-IF                                                23540000
235500                                                                  23550000
235600       WHEN SQLCODE = +100                                        23560000
235700                SET  PS-EO-ODD-UNTS-CSR  TO TRUE                  23570000
235800*CHECK TO SEE IF LAST PREPACK IS AN 'A' WITH NO 'B'               23580000
235900                IF PV-UNION-TYPE  = 'A'                           23590000
236000                   SET PS-ODD-UNT-CRTN-FOUND TO TRUE              23600000
236100                END-IF                                            23610000
236200       WHEN OTHER                                                 23620000
236210                                                                  23621018
236220              MOVE '6340'  TO  PV-CSSL-PARA                       23622018
236230              perform 8110-WRITE-suws044-TO-CSSL                  23623018
236240                                                                  23624018
236300              SET PS-ERROR                                        23630000
236400                  SU044-INVALID-SQL    TO TRUE                    23640000
236500              MOVE SU044-PO            TO PV-DISP-PO              23650000
236600              MOVE DK-REC-SEQ-NBR      TO PV-DISP-RCVR-SEQ-NBR    23660000
236700              MOVE SHUUPC-TRN-LNE-NBR  TO PV-DISP-PO-LNE-NBR      23670000
236800              MOVE DK-STR-DEST-NBR     TO PV-DISP-STR-NBR         23680000
236900              MOVE  SQLCODE            TO pv-disp-sqlcode         23690007
237000              STRING   ' SUKUT704-6340-'                          23700000
237100                       ' CALLED BY-'                              23710000
237200                       SU044-PROGRAM-NAME                         23720000
237300                       '  SQLCODE='                               23730000
237400                       pv-disp-sqlcode                            23740007
237500                       ' PO='                                     23750000
237600                       PV-DISP-PO                                 23760000
237700                       ' RCV='                                    23770000
237800                       PV-DISP-RCVR-SEQ-NBR                       23780000
237900                       ' LNE='                                    23790000
238000                       PV-DISP-PO-LNE-NBR                         23800000
238100                       ' STR='                                    23810000
238200                       PV-DISP-STR-NBR                            23820000
238300                       DELIMITED BY SIZE                          23830000
238400                                       INTO PV-CICS-MSG-AREA      23840000
238500              PERFORM 9999-WRITE-TO-CSSL                          23850000
238600              MOVE '6340-'                TO SU044-CRA-REQ-ID     23860000
238700              MOVE PV-CICS-MSG-AREA      TO SU044-CRA-RET-MSG     23870000
238800              PERFORM 9998-RETURN                                 23880000
238900     END-EVALUATE.                                                23890000
239000                                                                  23900000
239100                                                                  23910000
239200 6345-CLOSE-ODD-UNITS-CSR.                                        23920000
239210                                                                  23921013
239220     IF  PS-BLD-INTERNAL-TABLE-YES                                23922013
239230         MOVE  '6345'  TO  PT-CURR-PARA                           23923013
239240         PERFORM 8120-INTERNAL-TABLE                              23924013
239250     END-IF.                                                      23925013
239300                                                                  23930000
239400      EXEC SQL                                                    23940000
239500          CLOSE ODD-UNITS-CSR                                     23950000
239600      END-EXEC                                                    23960000
239700                                                                  23970000
239800      EVALUATE TRUE                                               23980000
239900          WHEN SQLCODE = +0                                       23990000
240000              CONTINUE                                            24000000
240100          WHEN SQLWARN0 NOT = SPACES                              24010000
240200          WHEN SQLCODE < +0                                       24020000
240300          WHEN SQLCODE > +0                                       24030000
240310                                                                  24031015
240320              MOVE '6345'  TO  PV-CSSL-PARA                       24032015
240330              perform 8110-WRITE-suws044-TO-CSSL                  24033015
240340                                                                  24034015
240400              SET PS-ERROR                                        24040000
240500                  SU044-INVALID-SQL    TO TRUE                    24050000
240600              MOVE SU044-PO            TO PV-DISP-PO              24060000
240700              MOVE DK-REC-SEQ-NBR      TO PV-DISP-RCVR-SEQ-NBR    24070000
240800              MOVE SHUUPC-TRN-LNE-NBR  TO PV-DISP-PO-LNE-NBR      24080000
240900              MOVE DK-STR-DEST-NBR     TO PV-DISP-STR-NBR         24090000
241000              MOVE  SQLCODE            TO pv-disp-sqlcode         24100007
241100              STRING   ' SUKUT704-6345-'                          24110000
241200                       ' CALLED BY-'                              24120000
241300                       SU044-PROGRAM-NAME                         24130000
241400                       '  SQLCODE='                               24140000
241500                       pv-disp-sqlcode                            24150007
241600                       ' PO='                                     24160000
241700                       PV-DISP-PO                                 24170000
241800                       ' RCV='                                    24180000
241900                       PV-DISP-RCVR-SEQ-NBR                       24190000
242000                       ' LNE='                                    24200000
242100                       PV-DISP-PO-LNE-NBR                         24210000
242200                       ' STR='                                    24220000
242300                       PV-DISP-STR-NBR                            24230000
242400                       DELIMITED BY SIZE                          24240000
242500                                       INTO PV-CICS-MSG-AREA      24250000
242600              PERFORM 9999-WRITE-TO-CSSL                          24260000
242700              MOVE '6335-'                TO SU044-CRA-REQ-ID     24270000
242800              MOVE PV-CICS-MSG-AREA      TO SU044-CRA-RET-MSG     24280000
242900              PERFORM 9998-RETURN                                 24290000
243000      END-EVALUATE.                                               24300000
243100                                                                  24310000
243200                                                                  24320000
243300******************************************************************24330000
243400 6350-OPEN-PREPK-CSR.                                             24340000
243410                                                                  24341013
243420     IF  PS-BLD-INTERNAL-TABLE-YES                                24342013
243430         MOVE  '6350-' TO  PT-CURR-PARA                           24343014
243440         PERFORM 8120-INTERNAL-TABLE                              24344013
243450     END-IF.                                                      24345013
243500                                                                  24350000
243600     EXEC SQL                                                     24360000
243700          OPEN PREPK-CSR                                          24370000
243800     END-EXEC                                                     24380000
243900                                                                  24390000
244000                                                                  24400000
244100     EVALUATE TRUE                                                24410000
244200         WHEN SQLCODE = ZERO                                      24420000
244300             CONTINUE                                             24430000
244400         WHEN SQLWARN0 NOT = SPACES                               24440000
244500         WHEN SQLCODE NOT EQUAL ZERO                              24450000
244510                                                                  24451015
244520              MOVE '6350'  TO  PV-CSSL-PARA                       24452015
244530              perform 8110-WRITE-suws044-TO-CSSL                  24453015
244540                                                                  24454015
244600             SET PS-ERROR                                         24460000
244700                 SU044-INVALID-SQL    TO TRUE                     24470000
244800             MOVE  SQLCODE            TO pv-disp-sqlcode          24480007
244900             STRING   ' SUKUT704-6350-'                           24490000
245000                      ' CALLED BY-'                               24500000
245100                      SU044-PROGRAM-NAME                          24510000
245200                      '  SQLCODE='                                24520000
245300                      pv-disp-sqlcode                             24530007
245400                      ' '                                         24540000
245500                      DELIMITED BY SIZE                           24550000
245600                                      INTO PV-CICS-MSG-AREA       24560000
245700             PERFORM 9999-WRITE-TO-CSSL                           24570000
245800             MOVE '6350-'                TO SU044-CRA-REQ-ID      24580000
245900             MOVE PV-CICS-MSG-AREA      TO SU044-CRA-RET-MSG      24590000
246000             SET SU044-INVALID-SQL TO TRUE                        24600000
246100             PERFORM 9998-RETURN                                  24610000
246200     END-EVALUATE.                                                24620000
246300                                                                  24630000
246400                                                                  24640000
246500 EJECT                                                            24650000
246600*----------------------------------------------------------------*24660000
246700*                                                                *24670000
246800*----------------------------------------------------------------*24680000
246900 6360-FETCH-PREPK-CSR.                                            24690000
246910                                                                  24691013
246920     IF  PS-BLD-INTERNAL-TABLE-YES                                24692013
246930         MOVE  '6360-' TO  PT-CURR-PARA                           24693014
246940         PERFORM 8120-INTERNAL-TABLE                              24694013
246950     END-IF.                                                      24695013
247000                                                                  24700000
247100     IF PS-LOG-MESSAGE                                            24710000
247200        MOVE ' SUKUT704-6360-FETCH-PREPK-CSR'                     24720002
247400                                    TO PV-CICS-MSG-AREA           24740002
247500        PERFORM 9999-WRITE-TO-CSSL                                24750000
247600         MOVE SU044-SUCCESS-IND TO PV-CICS-MSG-AREA               24760000
247700         PERFORM 9999-WRITE-TO-CSSL                               24770000
247800     END-IF                                                       24780000
247900                                                                  24790000
248000     EXEC SQL                                                     24800000
248100        FETCH   PREPK-CSR                                         24810000
248200        INTO   :RECITM-PREPK-ID                                   24820000
248300              ,:RECITM-PREPK-RATO-QTY                             24830000
248400              ,:PV-SHUUPC-QTY-DR-LNE                              24840000
248500              ,:DISTHD-PREPK-LNE-PRC-CDE                          24850000
248600     END-EXEC.                                                    24860000
248700                                                                  24870000
248800     EVALUATE TRUE                                                24880000
248900       WHEN SQLCODE = ZEROS                                       24890000
249000          SET PS-FOUND-ON-CURSOR TO TRUE                          24900000
249100          DIVIDE PV-SHUUPC-QTY-DR-LNE BY RECITM-PREPK-RATO-QTY    24910000
249200                 GIVING PV-MULTIPLE REMAINDER PV-REMAINDER        24920000
249300          IF PV-REMAINDER = 0                                     24930000
249400             IF PS-FIRST-PREPK                                    24940000
249500                MOVE PV-MULTIPLE TO PV-HOLD-MULTIPLE              24950000
249600                SET PS-NOT-FIRST-PREPK TO TRUE                    24960000
249700             END-IF                                               24970000
249800          ELSE                                                    24980000
249900             SET PS-ODD-UNT-CRTN-FOUND TO TRUE                    24990000
250000          END-IF                                                  25000000
250100          IF PV-MULTIPLE NOT EQUAL PV-HOLD-MULTIPLE               25010000
250200             SET PS-ODD-UNT-CRTN-FOUND TO TRUE                    25020000
250300          END-IF                                                  25030000
250400                                                                  25040000
250500          IF DISTHD-PREPK-LNE-PRC-CDE  = 'D'                      25050000
250600             PERFORM  6445-GET-OUTER-PACK                         25060000
250700             MOVE PV-SHIPPED-QTY         TO  PV-PREPK-UNT-QTY     25070000
250800             MOVE PV-SHUUPC-QTY-DR-LNE   TO  DK-OUTER-QTY         25080000
250900          END-IF                                                  25090000
251000                                                                  25100000
251100       WHEN SQLCODE = +100                                        25110000
251200          SET  PS-EO-PREPK-CSR TO TRUE                            25120000
251300       WHEN OTHER                                                 25130000
251310                                                                  25131018
251320              MOVE '6370'  TO  PV-CSSL-PARA                       25132018
251330              perform 8110-WRITE-suws044-TO-CSSL                  25133018
251340                                                                  25134018
251400          SET PS-ERROR                                            25140000
251500              SU044-INVALID-SQL    TO TRUE                        25150000
251600          MOVE  SQLCODE            TO pv-disp-sqlcode             25160007
251700          STRING   ' SUKUT704-6370-'                              25170000
251800                   ' CALLED BY-'                                  25180000
251900                   SU044-PROGRAM-NAME                             25190000
252000                   '  SQLCODE='                                   25200000
252100                   pv-disp-sqlcode                                25210007
252200                   ' '                                            25220000
252300                   DELIMITED BY SIZE                              25230000
252400                                   INTO PV-CICS-MSG-AREA          25240000
252500          PERFORM 9999-WRITE-TO-CSSL                              25250000
252600          MOVE '6370-'                TO SU044-CRA-REQ-ID         25260000
252700          MOVE PV-CICS-MSG-AREA      TO SU044-CRA-RET-MSG         25270000
252800          SET SU044-INVALID-SQL TO TRUE                           25280000
252900          PERFORM 9998-RETURN                                     25290000
253000     END-EVALUATE.                                                25300000
253100                                                                  25310000
253200                                                                  25320000
253300 6370-CLOSE-PREPK-CSR.                                            25330000
253310                                                                  25331013
253320     IF  PS-BLD-INTERNAL-TABLE-YES                                25332013
253330         MOVE  '6370-' TO  PT-CURR-PARA                           25333014
253340         PERFORM 8120-INTERNAL-TABLE                              25334013
253350     END-IF.                                                      25335013
253400                                                                  25340000
253500     EXEC SQL                                                     25350000
253600         CLOSE PREPK-CSR                                          25360000
253700     END-EXEC                                                     25370000
253800                                                                  25380000
253900     EVALUATE TRUE                                                25390000
254000         WHEN SQLCODE = ZERO                                      25400000
254100             CONTINUE                                             25410000
254200         WHEN SQLWARN0 NOT = SPACES                               25420000
254300         WHEN SQLCODE NOT EQUAL ZERO                              25430000
254310                                                                  25431015
254320              MOVE '6370'  TO  PV-CSSL-PARA                       25432015
254330              perform 8110-WRITE-suws044-TO-CSSL                  25433015
254340                                                                  25434015
254400             SET PS-ERROR                                         25440000
254500                 SU044-INVALID-SQL    TO TRUE                     25450000
254600             MOVE  SQLCODE            TO pv-disp-sqlcode          25460007
254700             STRING   ' SUKUT704-6370-'                           25470000
254800                      ' CALLED BY-'                               25480000
254900                      SU044-PROGRAM-NAME                          25490000
255000                      '  SQLCODE='                                25500000
255100                      pv-disp-sqlcode                             25510007
255200                      ' '                                         25520000
255300                      DELIMITED BY SIZE                           25530000
255400                                      INTO PV-CICS-MSG-AREA       25540000
255500             PERFORM 9999-WRITE-TO-CSSL                           25550000
255600             MOVE '6370-'                TO SU044-CRA-REQ-ID      25560000
255700             MOVE PV-CICS-MSG-AREA      TO SU044-CRA-RET-MSG      25570000
255800             SET SU044-INVALID-SQL TO TRUE                        25580000
255900             PERFORM 9998-RETURN                                  25590000
256000     END-EVALUATE.                                                25600000
256100                                                                  25610000
256200*----------------------------------------------------------------*25620000
256300*                                                                *25630000
256400*----------------------------------------------------------------*25640000
256500 6445-GET-OUTER-PACK.                                             25650000
256510                                                                  25651013
256520     IF  PS-BLD-INTERNAL-TABLE-YES                                25652013
256530         MOVE  '6445-' TO  PT-CURR-PARA                           25653014
256540         PERFORM 8120-INTERNAL-TABLE                              25654013
256550     END-IF.                                                      25655013
256600                                                                  25660000
256700     IF PS-LOG-MESSAGE                                            25670000
256800        MOVE ' SUKUT704-6445-GET-OUTER-PACK '                     25680002
257000                                    TO PV-CICS-MSG-AREA           25700002
257100        PERFORM 9999-WRITE-TO-CSSL                                25710000
257200         MOVE SU044-SUCCESS-IND TO PV-CICS-MSG-AREA               25720000
257300         PERFORM 9999-WRITE-TO-CSSL                               25730000
257400     END-IF                                                       25740000
257500                                                                  25750000
257600                                                                  25760000
257700     EXEC SQL                                                     25770000
257800          SELECT  SUM(SHPD_QTY)                                   25780000
257900            INTO :PV-SHIPPED-QTY                                  25790000
258000            FROM  TSHUUPC                                         25800000
258100           WHERE  SHIPT_UNT_ID  = :DK-SHIPT-UNT-ID                25810000
258110            with ur                                               25811016
258200     END-EXEC                                                     25820000
258300                                                                  25830000
258400     EVALUATE TRUE                                                25840000
258500       WHEN SQLCODE = ZERO                                        25850000
258600            CONTINUE                                              25860000
258700       WHEN SQLWARN0 NOT = SPACES                                 25870000
258800       WHEN SQLCODE NOT EQUAL ZERO                                25880000
258810                                                                  25881015
258820            MOVE '6445'  TO  PV-CSSL-PARA                         25882015
258830            perform 8110-WRITE-suws044-TO-CSSL                    25883015
258840                                                                  25884015
258900         SET PS-ERROR                                             25890000
259000             SU044-INVALID-SQL    TO TRUE                         25900000
259100         MOVE  SQLCODE            TO pv-disp-sqlcode              25910007
259200         STRING   ' SUKUT704-6445-'                               25920015
259300                  ' CALLED BY-'                                   25930000
259400                  SU044-PROGRAM-NAME                              25940000
259500                  '  SQLCODE='                                    25950000
259600                  pv-disp-sqlcode                                 25960007
259700                  ' '                                             25970000
259800                  DELIMITED BY SIZE                               25980000
259900                                  INTO PV-CICS-MSG-AREA           25990000
260000         PERFORM 9999-WRITE-TO-CSSL                               26000000
260100         MOVE '6370-'                TO SU044-CRA-REQ-ID          26010000
260200         MOVE PV-CICS-MSG-AREA      TO SU044-CRA-RET-MSG          26020000
260300         SET SU044-INVALID-SQL TO TRUE                            26030000
260400         PERFORM 9998-RETURN                                      26040000
260500     END-EVALUATE.                                                26050000
260600                                                                  26060000
260700 6450-OPEN-UNITS-CSR.                                             26070000
260710                                                                  26071013
260720     IF  PS-BLD-INTERNAL-TABLE-YES                                26072013
260730         MOVE  '6450-' TO  PT-CURR-PARA                           26073014
260740         PERFORM 8120-INTERNAL-TABLE                              26074013
260750     END-IF.                                                      26075013
260900                                                                  26090000
261000     EXEC SQL                                                     26100000
261100          OPEN UNITS-CSR                                          26110000
261200     END-EXEC                                                     26120000
261300                                                                  26130000
261400                                                                  26140000
261500     EVALUATE TRUE                                                26150000
261600         WHEN SQLCODE = ZERO                                      26160000
261700             CONTINUE                                             26170000
261800         WHEN SQLWARN0 NOT = SPACES                               26180000
261900         WHEN SQLCODE < ZERO                                      26190000
261910                                                                  26191015
261920              MOVE '6450'  TO  PV-CSSL-PARA                       26192015
261930              perform 8110-WRITE-suws044-TO-CSSL                  26193015
261940                                                                  26194015
262000           SET PS-ERROR                                           26200000
262100               SU044-INVALID-SQL    TO TRUE                       26210000
262200           MOVE  SQLCODE            TO pv-disp-sqlcode            26220007
262300           STRING   ' SUKUT704-6450-'                             26230000
262400                    ' CALLED BY-'                                 26240000
262500                    SU044-PROGRAM-NAME                            26250000
262600                    '  SQLCODE='                                  26260000
262700                    pv-disp-sqlcode                               26270007
262800                    ' '                                           26280000
262900                    DELIMITED BY SIZE                             26290000
263000                                    INTO PV-CICS-MSG-AREA         26300000
263100           PERFORM 9999-WRITE-TO-CSSL                             26310000
263200           MOVE '6450-'                TO SU044-CRA-REQ-ID        26320000
263300           MOVE PV-CICS-MSG-AREA      TO SU044-CRA-RET-MSG        26330000
263400           SET SU044-INVALID-SQL TO TRUE                          26340000
263500           PERFORM 9998-RETURN                                    26350000
263600     END-EVALUATE.                                                26360000
263700                                                                  26370000
263800 EJECT                                                            26380000
263900*----------------------------------------------------------------*26390000
264000*                                                                *26400000
264100*----------------------------------------------------------------*26410000
264200 6460-FETCH-LINE-AND-UNITS.                                       26420000
264210                                                                  26421013
264220     IF  PS-BLD-INTERNAL-TABLE-YES                                26422013
264230         MOVE  '6460-' TO  PT-CURR-PARA                           26423014
264240         PERFORM 8120-INTERNAL-TABLE                              26424013
264250     END-IF.                                                      26425013
264300                                                                  26430000
264400     IF PS-LOG-MESSAGE                                            26440000
264500        MOVE ' SUKUT704-6460-FETCH-LINE-AND-UNITS'                26450002
264700                                    TO PV-CICS-MSG-AREA           26470002
264800        PERFORM 9999-WRITE-TO-CSSL                                26480000
264900         MOVE SU044-SUCCESS-IND TO PV-CICS-MSG-AREA               26490000
265000         PERFORM 9999-WRITE-TO-CSSL                               26500000
265100     END-IF                                                       26510000
265200     EXEC SQL                                                     26520000
265300        FETCH   UNITS-CSR                                         26530000
265400        INTO   :PV-SHUUPC-UNIT-QTY                                26540000
265500             , :PV-TRN-LNE-NBR                                    26550000
265600                                                                  26560000
265700     END-EXEC.                                                    26570000
265800                                                                  26580000
265900     EVALUATE TRUE                                                26590000
266000       WHEN SQLCODE = ZEROS                                       26600000
266100            SET PS-FOUND-ON-CURSOR TO TRUE                        26610000
266200            ADD  PV-SHUUPC-UNIT-QTY  TO  PV-SHPD-QTY-TOTAL        26620000
266300            IF PS-FIRST-PO-LINE-FOR-CTN                           26630000
266400               MOVE PV-TRN-LNE-NBR TO PV-HOLD-TRN-LNE-NBR         26640000
266500               SET  PS-NOT-FIRST-PO-LINE-FOR-CTN TO TRUE          26650000
266600            END-IF                                                26660000
266700            IF PV-TRN-LNE-NBR = PV-HOLD-TRN-LNE-NBR               26670000
266800               CONTINUE                                           26680000
266900            ELSE                                                  26690000
267000               MOVE PV-TRN-LNE-NBR TO PV-HOLD-TRN-LNE-NBR         26700000
267100            END-IF                                                26710000
267200       WHEN SQLCODE = +100                                        26720000
267300            SET  PS-EO-UNITS-CSR   TO TRUE                        26730000
267400            MOVE PV-SHPD-QTY-TOTAL TO                             26740000
267500                                      DK-OUTER-QTY                26750000
267600            MOVE ZEROES            TO PV-SHPD-QTY-TOTAL           26760000
267700       WHEN OTHER                                                 26770000
267710                                                                  26771018
267720              MOVE '6460'  TO  PV-CSSL-PARA                       26772018
267730              perform 8110-WRITE-suws044-TO-CSSL                  26773018
267740                                                                  26774018
267800           SET PS-ERROR                                           26780000
267900               SU044-INVALID-SQL    TO TRUE                       26790000
268000           MOVE  SQLCODE            TO pv-disp-sqlcode            26800007
268100           STRING   ' SUKUT704-6460-'                             26810000
268200                    ' CALLED BY-'                                 26820000
268300                    SU044-PROGRAM-NAME                            26830000
268400                    '  SQLCODE='                                  26840000
268500                    pv-disp-sqlcode                               26850007
268600                    ' '                                           26860000
268700                    DELIMITED BY SIZE                             26870000
268800                                    INTO PV-CICS-MSG-AREA         26880000
268900           PERFORM 9999-WRITE-TO-CSSL                             26890000
269000           MOVE '6460-'                TO SU044-CRA-REQ-ID        26900000
269100           MOVE PV-CICS-MSG-AREA      TO SU044-CRA-RET-MSG        26910000
269200           SET SU044-INVALID-SQL TO TRUE                          26920000
269300           PERFORM 9998-RETURN                                    26930000
269400     END-EVALUATE.                                                26940000
269500                                                                  26950000
269600                                                                  26960000
269700 6470-CLOSE-UNITS-CSR.                                            26970000
269710                                                                  26971013
269720     IF  PS-BLD-INTERNAL-TABLE-YES                                26972013
269730         MOVE  '6470-' TO  PT-CURR-PARA                           26973014
269740         PERFORM 8120-INTERNAL-TABLE                              26974013
269750     END-IF.                                                      26975013
269800                                                                  26980000
269900     EXEC SQL                                                     26990000
270000         CLOSE UNITS-CSR                                          27000000
270100     END-EXEC                                                     27010000
270200                                                                  27020000
270300                                                                  27030000
270400     EVALUATE TRUE                                                27040000
270500         WHEN SQLCODE = ZERO                                      27050000
270600             CONTINUE                                             27060000
270700         WHEN SQLWARN0 NOT = SPACES                               27070000
270800         WHEN SQLCODE < ZERO                                      27080000
270900         WHEN SQLCODE > ZERO                                      27090000
270910                                                                  27091015
270920              MOVE '6470'  TO  PV-CSSL-PARA                       27092015
270930              perform 8110-WRITE-suws044-TO-CSSL                  27093015
270940                                                                  27094015
271000           SET PS-ERROR                                           27100000
271100               SU044-INVALID-SQL    TO TRUE                       27110000
271200           MOVE  SQLCODE            TO pv-disp-sqlcode            27120007
271300           STRING   ' SUKUT704-6470-'                             27130000
271400                    ' CALLED BY-'                                 27140000
271500                    SU044-PROGRAM-NAME                            27150000
271600                    '  SQLCODE='                                  27160000
271700                    pv-disp-sqlcode                               27170007
271800                    ' '                                           27180000
271900                    DELIMITED BY SIZE                             27190000
272000                                    INTO PV-CICS-MSG-AREA         27200000
272100           PERFORM 9999-WRITE-TO-CSSL                             27210000
272200           MOVE '6470-'                TO SU044-CRA-REQ-ID        27220000
272300           MOVE PV-CICS-MSG-AREA      TO SU044-CRA-RET-MSG        27230000
272400           SET SU044-INVALID-SQL TO TRUE                          27240000
272500           PERFORM 9998-RETURN                                    27250000
272600     END-EVALUATE.                                                27260000
272700                                                                  27270000
272800                                                                  27280000
272900 EJECT                                                            27290000
273000**********************************************************        27300000
273100 6500-GET-VIRTUAL-LABEL-DATA.                                     27310000
273200**********************************************************        27320000
273210                                                                  27321013
273220     IF  PS-BLD-INTERNAL-TABLE-YES                                27322013
273230         MOVE  '6500'  TO  PT-CURR-PARA                           27323013
273240         PERFORM 8120-INTERNAL-TABLE                              27324013
273250     END-IF.                                                      27325013
273260                                                                  27326013
273300     IF PS-LOG-MESSAGE                                            27330000
273400        MOVE ' SUKUT704-6500-GET-VIRTUAL-LABEL-DATA'              27340002
273600                                    TO PV-CICS-MSG-AREA           27360002
273700        PERFORM 9999-WRITE-TO-CSSL                                27370000
273800         MOVE SU044-SUCCESS-IND TO PV-CICS-MSG-AREA               27380000
273900         PERFORM 9999-WRITE-TO-CSSL                               27390000
274000     END-IF                                                       27400000
274100                                                                  27410000
274200                                                                  27420000
274300     EXEC SQL                                                     27430000
274400        SELECT   PREPK_ID                                         27440000
274500                ,LBL_ASG_SEQ_NBR                                  27450000
274600                ,CART_LBL_TYP_CDE                                 27460000
274700                ,PREPK_PRCG_LNE_NBR                               27470000
274800                ,INPK_UNT_QTY                                     27480000
274900                ,PREPK_RATO_QTY                                   27490000
275000                ,PREPK_UNT_QTY                                    27500000
275100                ,DEST_OPER_UNT_ID                                 27510000
275200                ,CSE_PK_QTY                                       27520000
275300                ,ODD_CART_IND                                     27530000
275400                ,INPK_CNVYB_IND                                   27540000
275500                ,LBL_TYP_LBL_SEQ_ID                               27550000
275600                ,LBL_TYP_TOT_QTY                                  27560000
275700                ,BRCDE_NBR                                        27570000
275800                ,STR_ZN_ID                                        27580000
275900                ,MODU_DESC                                        27590000
276000                ,ITM_NBR                                          27600000
276100                ,DEPT_DESC                                        27610000
276200                ,MAJ_CL_DESC                                      27620000
276300                ,SEASET_NM                                        27630000
276400                ,FIXT_ID                                          27640000
276500                ,LBL_TYP_CDE                                      27650000
276600                ,PRNT_CART_SEQ_ID                                 27660000
276700                ,STRG_AREA_CDE                                    27670000
276800        INTO     :LBVRDA-PREPK-ID                                 27680000
276900                ,:LBVRDA-LBL-ASG-SEQ-NBR                          27690000
277000                ,:LBVRDA-CART-LBL-TYP-CDE                         27700000
277100                ,:LBVRDA-PREPK-PRCG-LNE-NBR                       27710000
277200                ,:LBVRDA-INPK-UNT-QTY                             27720000
277300                ,:LBVRDA-PREPK-RATO-QTY                           27730000
277400                ,:LBVRDA-PREPK-UNT-QTY                            27740000
277500                ,:LBVRDA-DEST-OPER-UNT-ID                         27750000
277600                ,:LBVRDA-CSE-PK-QTY                               27760000
277700                ,:LBVRDA-ODD-CART-IND                             27770000
277800                ,:LBVRDA-INPK-CNVYB-IND                           27780000
277900                ,:LBVRDA-LBL-TYP-LBL-SEQ-ID                       27790000
278000                ,:LBVRDA-LBL-TYP-TOT-QTY                          27800000
278100                ,:LBVRDA-BRCDE-NBR                                27810000
278200                ,:LBVRDA-STR-ZN-ID                                27820000
278300                ,:LBVRDA-MODU-DESC                                27830000
278400                ,:LBVRDA-ITM-NBR                                  27840000
278500                ,:LBVRDA-DEPT-DESC                                27850000
278600                ,:LBVRDA-MAJ-CL-DESC                              27860000
278700                ,:LBVRDA-SEASET-NM                                27870000
278800                ,:LBVRDA-FIXT-ID                                  27880000
278900                ,:LBVRDA-LBL-TYP-CDE                              27890000
279000                ,:LBVRDA-PRNT-CART-SEQ-ID                         27900000
279100                ,:LBVRDA-STRG-AREA-CDE                            27910000
279200        FROM TLBVRDA A                                            27920000
279300        WHERE  A.PO_NBR                =  :SU044-PO               27930000
279400          AND  A.RCVR_SEQ_NBR          =  :SU044-ORIG-REC-SEQ-NBR 27940000
279500          AND  A.PO_LNE_NBR            =  :DK-PO-LNE-NBR          27950000
279600          AND  A.PREPK_ID              =  :RECITM-PREPK-ID        27960000
279700          AND  A.OTPK_UNT_QTY          =  :DK-OUTER-QTY           27970000
279800          AND  A.LBL_ASG_IND           =  'N'                     27980000
279900          AND  A.LBL_TYP_CDE           =  'M'                     27990000
280000          AND  A.LBL_ASG_SEQ_NBR =                                28000000
280100             (SELECT  MAX(LBL_ASG_SEQ_NBR)                        28010000
280200                 FROM   TLBVRDA B                                 28020000
280300              WHERE B.PO_NBR            = A.PO_NBR                28030000
280400                    AND  B.RCVR_SEQ_NBR = A.RCVR_SEQ_NBR          28040000
280500                    AND  B.PO_LNE_NBR   = A.PO_LNE_NBR            28050000
280600                    AND  B.PREPK_ID     = A.PREPK_ID              28060000
280700                    AND  B.OTPK_UNT_QTY = A.OTPK_UNT_QTY          28070000
280800                    AND  B.LBL_ASG_IND  = A.LBL_ASG_IND           28080000
280900                    AND  B.CART_LBL_TYP_CDE      =  'S'           28090000
281000                    AND  A.LBL_TYP_CDE  = B.LBL_TYP_CDE)          28100000
281100     END-EXEC                                                     28110000
281200                                                                  28120000
281300         EVALUATE TRUE                                            28130000
281400             WHEN SQLCODE = ZERO                                  28140000
281500                MOVE LBVRDA-DEST-OPER-UNT-ID TO DK-STR-DEST-NBR   28150000
281600                IF LBVRDA-INPK-CNVYB-IND = 'Y'                    28160000
281700                   CONTINUE                                       28170000
281800                ELSE                                              28180000
281900                   PERFORM 6550-CONSUME-TABLE-ROW                 28190000
282000                END-IF                                            28200000
282100                SET PS-LABEL-DATA-FOUND     TO TRUE               28210000
282200             WHEN SQLCODE = +100                                  28220000
282300                PERFORM 6505-GET-VRTL-LABEL-DATA-P2L              28230000
282400             WHEN OTHER                                           28240000
282410                                                                  28241018
282420              MOVE '6500'  TO  PV-CSSL-PARA                       28242018
282430              perform 8110-WRITE-suws044-TO-CSSL                  28243018
282440                                                                  28244018
282500                 SET PS-ERROR                                     28250000
282600                     SU044-INVALID-SQL    TO TRUE                 28260000
282700                 MOVE  SQLCODE            TO pv-disp-sqlcode      28270007
282800                 STRING   ' SUKUT704-6500-'                       28280000
282900                          ' CALLED BY-'                           28290000
283000                          SU044-PROGRAM-NAME                      28300000
283100                          '  SQLCODE='                            28310000
283200                          pv-disp-sqlcode                         28320007
283300                          ' '                                     28330000
283400                          DELIMITED BY SIZE                       28340000
283500                                          INTO PV-CICS-MSG-AREA   28350000
283600                 PERFORM 9999-WRITE-TO-CSSL                       28360000
283700                 MOVE '6500-'                TO SU044-CRA-REQ-ID  28370000
283800                 MOVE PV-CICS-MSG-AREA      TO SU044-CRA-RET-MSG  28380000
283900                 SET SU044-INVALID-SQL TO TRUE                    28390000
284000                 PERFORM 9998-RETURN                              28400000
284100         END-EVALUATE.                                            28410000
284200                                                                  28420000
284300**********************************************************        28430000
284400 6505-GET-VRTL-LABEL-DATA-P2L.                                    28440000
284500**********************************************************        28450000
284510                                                                  28451013
284520     IF  PS-BLD-INTERNAL-TABLE-YES                                28452013
284530         MOVE  '6505'  TO  PT-CURR-PARA                           28453013
284540         PERFORM 8120-INTERNAL-TABLE                              28454013
284550     END-IF.                                                      28455013
284560                                                                  28456013
284600     IF PS-LOG-MESSAGE                                            28460000
284700        MOVE ' SUKUT704-6505-GET-VRTL-LABEL-DATA-P2L'             28470002
284900                                    TO PV-CICS-MSG-AREA           28490002
285000        PERFORM 9999-WRITE-TO-CSSL                                28500000
285100         MOVE SU044-SUCCESS-IND TO PV-CICS-MSG-AREA               28510000
285200         PERFORM 9999-WRITE-TO-CSSL                               28520000
285300     END-IF                                                       28530000
285400                                                                  28540000
285500                                                                  28550000
285600     EXEC SQL                                                     28560000
285700        SELECT   PREPK_ID                                         28570000
285800                ,LBL_ASG_SEQ_NBR                                  28580000
285900                ,CART_LBL_TYP_CDE                                 28590000
286000                ,PREPK_PRCG_LNE_NBR                               28600000
286100                ,INPK_UNT_QTY                                     28610000
286200                ,PREPK_RATO_QTY                                   28620000
286300                ,PREPK_UNT_QTY                                    28630000
286400                ,DEST_OPER_UNT_ID                                 28640000
286500                ,CSE_PK_QTY                                       28650000
286600                ,ODD_CART_IND                                     28660000
286700                ,INPK_CNVYB_IND                                   28670000
286800                ,LBL_TYP_LBL_SEQ_ID                               28680000
286900                ,LBL_TYP_TOT_QTY                                  28690000
287000                ,BRCDE_NBR                                        28700000
287100                ,STR_ZN_ID                                        28710000
287200                ,MODU_DESC                                        28720000
287300                ,ITM_NBR                                          28730000
287400                ,DEPT_DESC                                        28740000
287500                ,MAJ_CL_DESC                                      28750000
287600                ,SEASET_NM                                        28760000
287700                ,FIXT_ID                                          28770000
287800                ,LBL_TYP_CDE                                      28780000
287900                ,PRNT_CART_SEQ_ID                                 28790000
288000                ,STRG_AREA_CDE                                    28800000
288100        INTO     :LBVRDA-PREPK-ID                                 28810000
288200                ,:LBVRDA-LBL-ASG-SEQ-NBR                          28820000
288300                ,:LBVRDA-CART-LBL-TYP-CDE                         28830000
288400                ,:LBVRDA-PREPK-PRCG-LNE-NBR                       28840000
288500                ,:LBVRDA-INPK-UNT-QTY                             28850000
288600                ,:LBVRDA-PREPK-RATO-QTY                           28860000
288700                ,:LBVRDA-PREPK-UNT-QTY                            28870000
288800                ,:LBVRDA-DEST-OPER-UNT-ID                         28880000
288900                ,:LBVRDA-CSE-PK-QTY                               28890000
289000                ,:LBVRDA-ODD-CART-IND                             28900000
289100                ,:LBVRDA-INPK-CNVYB-IND                           28910000
289200                ,:LBVRDA-LBL-TYP-LBL-SEQ-ID                       28920000
289300                ,:LBVRDA-LBL-TYP-TOT-QTY                          28930000
289400                ,:LBVRDA-BRCDE-NBR                                28940000
289500                ,:LBVRDA-STR-ZN-ID                                28950000
289600                ,:LBVRDA-MODU-DESC                                28960000
289700                ,:LBVRDA-ITM-NBR                                  28970000
289800                ,:LBVRDA-DEPT-DESC                                28980000
289900                ,:LBVRDA-MAJ-CL-DESC                              28990000
290000                ,:LBVRDA-SEASET-NM                                29000000
290100                ,:LBVRDA-FIXT-ID                                  29010000
290200                ,:LBVRDA-LBL-TYP-CDE                              29020000
290300                ,:LBVRDA-PRNT-CART-SEQ-ID                         29030000
290400                ,:LBVRDA-STRG-AREA-CDE                            29040000
290500        FROM TLBVRDA A                                            29050000
290600        WHERE  A.PO_NBR                =  :SU044-PO               29060000
290700          AND  A.RCVR_SEQ_NBR          =  :SU044-ORIG-REC-SEQ-NBR 29070000
290800          AND  A.PO_LNE_NBR            =  :DK-PO-LNE-NBR          29080000
290900          AND  A.PREPK_ID              =  :RECITM-PREPK-ID        29090000
291000          AND  A.OTPK_UNT_QTY          =  :DK-OUTER-QTY           29100000
291100          AND  A.LBL_ASG_IND           =  'N'                     29110000
291200          AND  A.LBL_TYP_CDE           =  'M'                     29120000
291300          AND  A.LBL_ASG_SEQ_NBR =                                29130000
291400             (SELECT  MAX(LBL_ASG_SEQ_NBR)                        29140000
291500                 FROM   TLBVRDA B                                 29150000
291600              WHERE B.PO_NBR            = A.PO_NBR                29160000
291700                    AND  B.RCVR_SEQ_NBR = A.RCVR_SEQ_NBR          29170000
291800                    AND  B.PO_LNE_NBR   = A.PO_LNE_NBR            29180000
291900                    AND  B.PREPK_ID     = A.PREPK_ID              29190000
292000                    AND  B.OTPK_UNT_QTY = A.OTPK_UNT_QTY          29200000
292100                    AND  B.LBL_ASG_IND  = A.LBL_ASG_IND           29210000
292200                    AND  A.LBL_TYP_CDE  = B.LBL_TYP_CDE)          29220000
292300     END-EXEC                                                     29230000
292400                                                                  29240000
292500         EVALUATE TRUE                                            29250000
292600             WHEN SQLCODE = ZERO                                  29260000
292700                MOVE LBVRDA-DEST-OPER-UNT-ID TO DK-STR-DEST-NBR   29270000
292800                PERFORM 6550-CONSUME-TABLE-ROW                    29280000
292900                SET PS-LABEL-DATA-FOUND     TO TRUE               29290000
293000             WHEN SQLCODE = +100                                  29300000
293100                 SET PS-LABEL-DATA-NOT-FOUND TO TRUE              29310000
293200             WHEN OTHER                                           29320000
293210                                                                  29321018
293220              MOVE '6505'  TO  PV-CSSL-PARA                       29322018
293230              perform 8110-WRITE-suws044-TO-CSSL                  29323018
293240                                                                  29324018
293300                 SET PS-ERROR                                     29330000
293400                     SU044-INVALID-SQL    TO TRUE                 29340000
293500                 MOVE  SQLCODE            TO pv-disp-sqlcode      29350007
293600                 STRING   ' SUKUT704-6505-'                       29360000
293700                          ' CALLED BY-'                           29370000
293800                          SU044-PROGRAM-NAME                      29380000
293900                          '  SQLCODE='                            29390000
294000                          pv-disp-sqlcode                         29400007
294100                          ' '                                     29410000
294200                          DELIMITED BY SIZE                       29420000
294300                                          INTO PV-CICS-MSG-AREA   29430000
294400                 PERFORM 9999-WRITE-TO-CSSL                       29440000
294500                 MOVE '6505-'                TO SU044-CRA-REQ-ID  29450000
294600                 MOVE PV-CICS-MSG-AREA      TO SU044-CRA-RET-MSG  29460000
294700                 SET SU044-INVALID-SQL TO TRUE                    29470000
294800                 PERFORM 9998-RETURN                              29480000
294900         END-EVALUATE.                                            29490000
295000                                                                  29500000
295100**********************************************************        29510000
295200 6550-CONSUME-TABLE-ROW.                                          29520000
295300**********************************************************        29530000
295310                                                                  29531013
295320     IF  PS-BLD-INTERNAL-TABLE-YES                                29532013
295330         MOVE  '6550'  TO  PT-CURR-PARA                           29533013
295340         PERFORM 8120-INTERNAL-TABLE                              29534013
295350     END-IF.                                                      29535013
295360                                                                  29536013
295400     IF PS-LOG-MESSAGE                                            29540000
295500        MOVE ' SUKUT704-6550-CONSUME-TABLE-ROW'                   29550002
295700                                    TO PV-CICS-MSG-AREA           29570002
295800        PERFORM 9999-WRITE-TO-CSSL                                29580000
295900         MOVE SU044-SUCCESS-IND TO PV-CICS-MSG-AREA               29590000
296000         PERFORM 9999-WRITE-TO-CSSL                               29600000
296100     END-IF                                                       29610000
296200                                                                  29620000
296300     EXEC SQL                                                     29630000
296400         UPDATE TLBVRDA                                           29640000
296500           SET LBL_ASG_IND     = 'Y'                              29650000
296600         WHERE PO_NBR          = :SU044-PO                        29660000
296700           AND RCVR_SEQ_NBR    = :SU044-ORIG-REC-SEQ-NBR          29670000
296800           AND PO_LNE_NBR      = :DK-PO-LNE-NBR                   29680000
296900           AND PREPK_ID        = :RECITM-PREPK-ID                 29690000
297000           AND LBL_ASG_SEQ_NBR = :LBVRDA-LBL-ASG-SEQ-NBR          29700000
297100           AND LBL_ASG_IND     = 'N'                              29710000
297200     END-EXEC.                                                    29720000
297300                                                                  29730000
297400                                                                  29740000
297500         EVALUATE TRUE                                            29750000
297600             WHEN SQLCODE = ZERO                                  29760000
297700                SET PS-SUCCESSFUL-UPDATE TO TRUE                  29770000
297800             WHEN SQLCODE = +100                                  29780000
297900                SET PS-NOT-SUCCESSFUL-UPDATE TO TRUE              29790000
298000             WHEN OTHER                                           29800000
298010                                                                  29801018
298020              MOVE '6550'  TO  PV-CSSL-PARA                       29802018
298030              perform 8110-WRITE-suws044-TO-CSSL                  29803018
298040                                                                  29804018
298100                 SET PS-ERROR                                     29810000
298200                     SU044-INVALID-SQL    TO TRUE                 29820000
298300                 MOVE  SQLCODE            TO pv-disp-sqlcode      29830007
298400                 STRING   ' SUKUT704-6550-'                       29840000
298500                          ' CALLED BY-'                           29850000
298600                          SU044-PROGRAM-NAME                      29860000
298700                          '  SQLCODE='                            29870000
298800                          pv-disp-sqlcode                         29880007
298900                          ' '                                     29890000
299000                          DELIMITED BY SIZE                       29900000
299100                                          INTO PV-CICS-MSG-AREA   29910000
299200                 PERFORM 9999-WRITE-TO-CSSL                       29920000
299300                 MOVE '6550-'                TO SU044-CRA-REQ-ID  29930000
299400                 MOVE PV-CICS-MSG-AREA      TO SU044-CRA-RET-MSG  29940000
299500                 SET SU044-INVALID-SQL TO TRUE                    29950000
299600                 PERFORM 9998-RETURN                              29960000
299700         END-EVALUATE.                                            29970000
299800                                                                  29980000
299900                                                                  29990000
300000                                                                  30000000
300100**********************************************************        30010000
300200 6700-PRINT-VIRTUAL-LABELS.                                       30020000
300300**********************************************************        30030000
300310                                                                  30031013
300320     IF  PS-BLD-INTERNAL-TABLE-YES                                30032013
300330         MOVE  '6700'  TO  PT-CURR-PARA                           30033013
300340         PERFORM 8120-INTERNAL-TABLE                              30034013
300350     END-IF.                                                      30035013
300400                                                                  30040000
300500     IF PS-LOG-MESSAGE                                            30050000
300600        MOVE ' SUKUT704-6700-PRINT-VIRTUAL-LABELS'                30060002
300800                                    TO PV-CICS-MSG-AREA           30080002
300900        PERFORM 9999-WRITE-TO-CSSL                                30090000
301000         MOVE SU044-SUCCESS-IND TO PV-CICS-MSG-AREA               30100000
301100         PERFORM 9999-WRITE-TO-CSSL                               30110000
301200     END-IF                                                       30120000
301300                                                                  30130000
301400                                                                  30140000
301500     MOVE  ZEROES            TO   PV-FCSE-CART-CNT                30150000
301600                                  PV-P2L-CART-CNT                 30160000
301700                                  PV-INPK-CART-CNT                30170000
301800     EVALUATE TRUE                                                30180000
301900         WHEN LBVRDA-CART-LBL-TYP-CDE =  'P'                      30190000
302000            MOVE +1   TO PV-P2L-CART-CNT                          30200000
302100            SET PS-TROUBLE-CREATE-YES TO TRUE                     30210000
302200            PERFORM 5150-UPDATE-TPKITEM-ONLY                      30220000
302300            MOVE SHUUPC-SHPD-QTY TO DISTHD-CAL-UNT-PRCD-QTY       30230000
302400            PERFORM 6750-UPDATE-TDISTHD                           30240000
302500         WHEN LBVRDA-INPK-CNVYB-IND = 'N'                         30250000
302600            MOVE +1    TO PV-FCSE-CART-CNT                        30260000
302700            PERFORM 5050-PROCESS-ORIG-RCVR                        30270000
302800            MOVE SHUUPC-SHPD-QTY TO DISTHD-CAL-UNT-PRCD-QTY       30280000
302900            PERFORM 6750-UPDATE-TDISTHD                           30290000
303000            PERFORM 6760-UPDATE-TDISTDT-FCSE                      30300000
303100                                                                  30310000
303200         WHEN LBVRDA-INPK-CNVYB-IND = 'Y'                         30320000
303300            IF SU044-RCVR-PREPK                                   30330000
303400               MOVE ZEROES TO LBVRDA-PO-LNE-NBR                   30340000
303500            ELSE                                                  30350000
303600               MOVE DK-PO-LNE-NBR TO LBVRDA-PO-LNE-NBR            30360000
303700            END-IF                                                30370000
303800                                                                  30380000
303900            SET PS-NOT-END-OF-VRTL-LBL-CSR                        30390000
304000                PS-FIRST-INPK-CNVY-YES     TO TRUE                30400000
304100                                                                  30410000
304200            PERFORM 6710-OPEN-INPK-CSR                            30420000
304300            PERFORM 6720-FETCH-INPK-CSR                           30430000
304400            PERFORM 5055-PROCESS-ORIG-RCVR-INPK                   30440000
304500                                                                  30450000
304600            PERFORM UNTIL PS-END-OF-VRTL-LBL-CSR                  30460000
304700                PERFORM 6720-FETCH-INPK-CSR                       30470000
304800                IF PS-NOT-END-OF-VRTL-LBL-CSR                     30480000
304900                   PERFORM 5055-PROCESS-ORIG-RCVR-INPK            30490000
305000                END-IF                                            30500000
305100            END-PERFORM                                           30510000
305200            PERFORM 6735-CONSUME-INPK-ROWS                        30520000
305300            PERFORM 6730-CLOSE-INPK-CSR                           30530000
305400     END-EVALUATE.                                                30540000
305500                                                                  30550000
305600*----------------------------------------------------------------*30560000
305700* OPEN THE VIRTUAL LABEL PRINT CURSOR                            *30570000
305800*----------------------------------------------------------------*30580000
305900                                                                  30590000
306000 6710-OPEN-INPK-CSR.                                              30600000
306010                                                                  30601013
306020     IF  PS-BLD-INTERNAL-TABLE-YES                                30602013
306030         MOVE  '6710'  TO  PT-CURR-PARA                           30603013
306040         PERFORM 8120-INTERNAL-TABLE                              30604013
306050     END-IF.                                                      30605013
306100                                                                  30610000
306200     EXEC SQL                                                     30620000
306300         OPEN VRTL-LBL-INPK-CSR                                   30630000
306400     END-EXEC.                                                    30640000
306500                                                                  30650000
306600         EVALUATE TRUE                                            30660000
306700             WHEN SQLCODE = ZERO                                  30670000
306800             WHEN SQLCODE = -904                                  30680000
306900             WHEN SQLCODE = -913                                  30690000
307000                 CONTINUE                                         30700000
307100             WHEN SQLWARN0 NOT = SPACES                           30710000
307200             WHEN SQLCODE < ZERO                                  30720000
307300             WHEN SQLCODE > ZERO                                  30730000
307310                                                                  30731015
307320                  MOVE '6710'  TO  PV-CSSL-PARA                   30732015
307330                  perform 8110-WRITE-suws044-TO-CSSL              30733015
307340                                                                  30734015
307400                 SET PS-ERROR                                     30740000
307500                     SU044-INVALID-SQL    TO TRUE                 30750000
307600                 MOVE  SQLCODE            TO pv-disp-sqlcode      30760007
307700                 STRING   ' SUKUT704-6710-'                       30770000
307800                          ' CALLED BY-'                           30780000
307900                          SU044-PROGRAM-NAME                      30790000
308000                          '  SQLCODE='                            30800000
308100                          pv-disp-sqlcode                         30810007
308200                          ' '                                     30820000
308300                          DELIMITED BY SIZE                       30830000
308400                                          INTO PV-CICS-MSG-AREA   30840000
308500                 PERFORM 9999-WRITE-TO-CSSL                       30850000
308600                 MOVE '6710-'                TO SU044-CRA-REQ-ID  30860000
308700                 MOVE PV-CICS-MSG-AREA      TO SU044-CRA-RET-MSG  30870000
308800                 SET SU044-INVALID-SQL TO TRUE                    30880000
308900                 PERFORM 9998-RETURN                              30890000
309000         END-EVALUATE.                                            30900000
309100                                                                  30910000
309200                                                                  30920000
309300 EJECT                                                            30930000
309400******************************************************************30940000
309500 6720-FETCH-INPK-CSR.                                             30950000
309510                                                                  30951013
309520     IF  PS-BLD-INTERNAL-TABLE-YES                                30952013
309530         MOVE  '6720'  TO  PT-CURR-PARA                           30953013
309540         PERFORM 8120-INTERNAL-TABLE                              30954013
309550     END-IF.                                                      30955013
309560                                                                  30956013
309600     IF PS-LOG-MESSAGE                                            30960000
309700        MOVE ' SUKUT704-6720-FETCH-INPK-CSR '                     30970002
309900                                    TO PV-CICS-MSG-AREA           30990002
310000        PERFORM 9999-WRITE-TO-CSSL                                31000000
310100         MOVE SU044-SUCCESS-IND TO PV-CICS-MSG-AREA               31010000
310200         PERFORM 9999-WRITE-TO-CSSL                               31020000
310300     END-IF                                                       31030000
310400                                                                  31040000
310500                                                                  31050000
310600      EXEC SQL                                                    31060000
310700        FETCH VRTL-LBL-INPK-CSR                                   31070000
310800        INTO     :LBVRDA-CART-LBL-TYP-CDE                         31080000
310900                ,:LBVRDA-PREPK-PRCG-LNE-NBR                       31090000
311000                ,:LBVRDA-INPK-UNT-QTY                             31100000
311100                ,:LBVRDA-PREPK-RATO-QTY                           31110000
311200                ,:LBVRDA-DEST-OPER-UNT-ID                         31120000
311300                ,:LBVRDA-CSE-PK-QTY                               31130000
311400                ,:LBVRDA-ODD-CART-IND                             31140000
311500                ,:LBVRDA-INPK-CNVYB-IND                           31150000
311600                ,:LBVRDA-LBL-TYP-LBL-SEQ-ID                       31160000
311700                ,:LBVRDA-LBL-TYP-TOT-QTY                          31170000
311800                ,:LBVRDA-BRCDE-NBR                                31180000
311900                ,:LBVRDA-STR-ZN-ID                                31190000
312000                ,:LBVRDA-MODU-DESC                                31200000
312100                ,:LBVRDA-ITM-NBR                                  31210000
312200                ,:LBVRDA-DEPT-DESC                                31220000
312300                ,:LBVRDA-MAJ-CL-DESC                              31230000
312400                ,:LBVRDA-SEASET-NM                                31240000
312500                ,:LBVRDA-FIXT-ID                                  31250000
312600                ,:LBVRDA-LBL-TYP-CDE                              31260000
312700                ,:LBVRDA-PRNT-CART-SEQ-ID                         31270000
312800                ,:LBVRDA-STRG-AREA-CDE                            31280000
312900                ,:LBVRDA-INPK-UNT-QTY                             31290000
313000         END-EXEC                                                 31300000
313100                                                                  31310000
313200     EVALUATE TRUE                                                31320000
313300         WHEN SQLCODE = ZERO                                      31330000
313400              MOVE LBVRDA-DEST-OPER-UNT-ID TO DK-STR-DEST-NBR     31340000
313500         WHEN SQLCODE = +100                                      31350000
313600              SET PS-END-OF-VRTL-LBL-CSR TO TRUE                  31360000
313700         WHEN SQLWARN0 NOT = SPACE                                31370000
313800         WHEN SQLCODE NOT = ZERO                                  31380000
313810                                                                  31381015
313820              MOVE '6720'  TO  PV-CSSL-PARA                       31382015
313830              perform 8110-WRITE-suws044-TO-CSSL                  31383015
313840                                                                  31384015
313900             SET PS-ERROR                                         31390000
314000                 SU044-INVALID-SQL    TO TRUE                     31400000
314100             MOVE  SQLCODE            TO pv-disp-sqlcode          31410007
314200             STRING   ' SUKUT704-6720-'                           31420000
314300                      ' CALLED BY-'                               31430000
314400                      SU044-PROGRAM-NAME                          31440000
314500                      '  SQLCODE='                                31450000
314600                      pv-disp-sqlcode                             31460007
314700                      ' '                                         31470000
314800                      DELIMITED BY SIZE                           31480000
314900                                      INTO PV-CICS-MSG-AREA       31490000
315000             PERFORM 9999-WRITE-TO-CSSL                           31500000
315100             MOVE '6720-'                TO SU044-CRA-REQ-ID      31510000
315200             MOVE PV-CICS-MSG-AREA      TO SU044-CRA-RET-MSG      31520000
315300             SET SU044-INVALID-SQL TO TRUE                        31530000
315400             PERFORM 9998-RETURN                                  31540000
315500     END-EVALUATE.                                                31550000
315600******************************************************************31560000
315700*  CLOSE VIRTUAL LABEL PRINT CURSOR                            * *31570000
315800******************************************************************31580000
315900 6730-CLOSE-INPK-CSR.                                             31590000
315910                                                                  31591013
315920     IF  PS-BLD-INTERNAL-TABLE-YES                                31592013
315930         MOVE  '6730'  TO  PT-CURR-PARA                           31593013
315940         PERFORM 8120-INTERNAL-TABLE                              31594013
315950     END-IF.                                                      31595013
315960                                                                  31596013
316000         EXEC SQL                                                 31600000
316100             CLOSE VRTL-LBL-INPK-CSR                              31610000
316200         END-EXEC                                                 31620000
316300                                                                  31630000
316400     EVALUATE TRUE                                                31640000
316500         WHEN SQLCODE = ZERO                                      31650000
316600             CONTINUE                                             31660000
316700         WHEN SQLWARN0 NOT = SPACES                               31670000
316800         WHEN SQLCODE < ZERO                                      31680000
316900         WHEN SQLCODE > ZERO                                      31690000
316910                                                                  31691015
316920              MOVE '6730'  TO  PV-CSSL-PARA                       31692015
316930              perform 8110-WRITE-suws044-TO-CSSL                  31693015
316940                                                                  31694015
317000             SET PS-ERROR                                         31700000
317100                 SU044-INVALID-SQL    TO TRUE                     31710000
317200             MOVE  SQLCODE            TO pv-disp-sqlcode          31720007
317300             STRING   ' SUKUT704-6730-'                           31730000
317400                      ' CALLED BY-'                               31740000
317500                      SU044-PROGRAM-NAME                          31750000
317600                      '  SQLCODE='                                31760000
317700                      pv-disp-sqlcode                             31770007
317800                      ' '                                         31780000
317900                      DELIMITED BY SIZE                           31790000
318000                                      INTO PV-CICS-MSG-AREA       31800000
318100             PERFORM 9999-WRITE-TO-CSSL                           31810000
318200             MOVE '6730-'                TO SU044-CRA-REQ-ID      31820000
318300             MOVE PV-CICS-MSG-AREA      TO SU044-CRA-RET-MSG      31830000
318400             SET SU044-INVALID-SQL TO TRUE                        31840000
318500             PERFORM 9998-RETURN                                  31850000
318600     END-EVALUATE.                                                31860000
318700                                                                  31870000
318800******************************************************************31880000
318900*  UPDATE ALL THE INNER PACK VIRTUAL ROWS TO CONSUMED          * *31890000
319000******************************************************************31900000
319100 6735-CONSUME-INPK-ROWS.                                          31910000
319110                                                                  31911013
319120     IF  PS-BLD-INTERNAL-TABLE-YES                                31912013
319130         MOVE  '6735'  TO  PT-CURR-PARA                           31913013
319140         PERFORM 8120-INTERNAL-TABLE                              31914013
319150     END-IF.                                                      31915013
319200                                                                  31920000
319300     IF PS-LOG-MESSAGE                                            31930000
319400        MOVE ' SUKUT704-6735-CONSUME-INPK-ROWS'                   31940002
319600                                    TO PV-CICS-MSG-AREA           31960002
319700        PERFORM 9999-WRITE-TO-CSSL                                31970000
319800         MOVE SU044-SUCCESS-IND TO PV-CICS-MSG-AREA               31980000
319900         PERFORM 9999-WRITE-TO-CSSL                               31990000
320000     END-IF                                                       32000000
320100                                                                  32010000
320200     IF RECITM-PREPK-ID > 0                                       32020000
320300        MOVE ZERO                TO  LBVRDA-PO-LNE-NBR            32030000
320400     ELSE                                                         32040000
320500        MOVE SHUUPC-TRN-LNE-NBR  TO LBVRDA-PO-LNE-NBR             32050000
320600     END-IF                                                       32060000
320700                                                                  32070000
320800     EXEC SQL                                                     32080000
320900        UPDATE TLBVRDA                                            32090000
321000          SET  LBL_ASG_IND           =   'Y'                      32100000
321100        WHERE  PO_NBR                =   :SU044-PO                32110000
321200          AND  RCVR_SEQ_NBR          =   :SU044-ORIG-REC-SEQ-NBR  32120000
321300          AND  PO_LNE_NBR            =   :LBVRDA-PO-LNE-NBR       32130000
321400          AND  PREPK_ID              =   :RECITM-PREPK-ID         32140000
321500          AND  OTPK_UNT_QTY          =   :DK-OUTER-QTY            32150000
321600          AND  LBL_ASG_IND           =   'N'                      32160000
321700          AND  PRNT_CART_SEQ_ID      =  :LBVRDA-PRNT-CART-SEQ-ID  32170000
321800     END-EXEC                                                     32180000
321900                                                                  32190000
322000     EVALUATE TRUE                                                32200000
322100         WHEN SQLCODE = ZERO                                      32210000
322200         WHEN SQLCODE = +100                                      32220000
322300             CONTINUE                                             32230000
322400         WHEN SQLWARN0 NOT = SPACES                               32240000
322500         WHEN SQLCODE < ZERO                                      32250000
322600         WHEN SQLCODE > ZERO                                      32260000
322610                                                                  32261015
322620              MOVE '6735'  TO  PV-CSSL-PARA                       32262015
322630              perform 8110-WRITE-suws044-TO-CSSL                  32263015
322640                                                                  32264015
322700             SET PS-ERROR                                         32270000
322800                 SU044-INVALID-SQL    TO TRUE                     32280000
322900             MOVE  SQLCODE            TO pv-disp-sqlcode          32290007
323000             STRING   ' SUKUT704-6735-'                           32300000
323100                      ' CALLED BY-'                               32310000
323200                      SU044-PROGRAM-NAME                          32320000
323300                      '  SQLCODE='                                32330000
323400                      pv-disp-sqlcode                             32340007
323500                      ' '                                         32350000
323600                      DELIMITED BY SIZE                           32360000
323700                                      INTO PV-CICS-MSG-AREA       32370000
323800             PERFORM 9999-WRITE-TO-CSSL                           32380000
323900             MOVE '6735-'                TO SU044-CRA-REQ-ID      32390000
324000             MOVE PV-CICS-MSG-AREA      TO SU044-CRA-RET-MSG      32400000
324100             SET SU044-INVALID-SQL TO TRUE                        32410000
324200             PERFORM 9998-RETURN                                  32420000
324300     END-EVALUATE.                                                32430000
324400                                                                  32440000
324500 EJECT                                                            32450000
324600                                                                  32460000
324700 6750-UPDATE-TDISTHD.                                             32470000
324710                                                                  32471013
324720     IF  PS-BLD-INTERNAL-TABLE-YES                                32472013
324730         MOVE  '6750'  TO  PT-CURR-PARA                           32473013
324740         PERFORM 8120-INTERNAL-TABLE                              32474013
324750     END-IF.                                                      32475013
324800                                                                  32480000
324900     IF PS-LOG-MESSAGE                                            32490000
325000        MOVE ' SUKUT704-6750-UPDATE-TDISTHD '                     32500002
325200                                    TO PV-CICS-MSG-AREA           32520002
325300        PERFORM 9999-WRITE-TO-CSSL                                32530000
325400         MOVE SU044-SUCCESS-IND TO PV-CICS-MSG-AREA               32540000
325500         PERFORM 9999-WRITE-TO-CSSL                               32550000
325600     END-IF                                                       32560000
325700                                                                  32570000
325800     EXEC SQL                                                     32580000
325900       UPDATE TDISTHD                                             32590000
326000         SET TOT_CART_CNT   = (TOT_CART_CNT  - 1)                 32600000
326100           , FCSE_CART_CNT  = (FCSE_CART_CNT - :PV-FCSE-CART-CNT) 32610000
326200           , P2L_CART_CNT   = (P2L_CART_CNT  - :PV-P2L-CART-CNT)  32620000
326300           , INPK_CART_CNT  = (INPK_CART_CNT - :PV-INPK-CART-CNT) 32630000
326400           , CAL_UNT_PRCD_QTY =                                   32640000
326500                          (CAL_UNT_PRCD_QTY -                     32650000
326600                                  :DISTHD-CAL-UNT-PRCD-QTY)       32660000
326700       WHERE ORD_NBR        = :SU044-PO                           32670000
326800         AND RCVR_SEQ_NBR   = :SU044-ORIG-REC-SEQ-NBR             32680000
326900         AND ORD_LNE_NBR    = :DK-PO-LNE-NBR                      32690000
327000         AND TOT_CART_CNT   > 0                                   32700000
327100     END-EXEC.                                                    32710000
327200                                                                  32720000
327300     EVALUATE TRUE                                                32730000
327400         WHEN SQLCODE = +0                                        32740000
327500         WHEN SQLCODE = +100                                      32750000
327600              CONTINUE                                            32760000
327700         WHEN SQLWARN0 NOT = SPACES                               32770000
327800         WHEN SQLCODE < +0                                        32780000
327900         WHEN SQLCODE > +0                                        32790000
327910                                                                  32791015
327920              MOVE '6750'  TO  PV-CSSL-PARA                       32792015
327930              perform 8110-WRITE-suws044-TO-CSSL                  32793015
327940                                                                  32794015
328000             SET PS-ERROR                                         32800000
328100                 SU044-INVALID-SQL    TO TRUE                     32810000
328200             MOVE SU044-PO            TO PV-DISP-PO               32820000
328300             MOVE DK-REC-SEQ-NBR      TO PV-DISP-RCVR-SEQ-NBR     32830000
328400             MOVE SHUUPC-TRN-LNE-NBR  TO PV-DISP-PO-LNE-NBR       32840000
328500             MOVE DK-STR-DEST-NBR     TO PV-DISP-STR-NBR          32850000
328600             MOVE  SQLCODE            TO pv-disp-sqlcode          32860007
328700             STRING   ' SUKUT704-6750-'                           32870000
328800                      ' CALLED BY-'                               32880000
328900                      SU044-PROGRAM-NAME                          32890000
329000                      '  SQLCODE='                                32900000
329100                      pv-disp-sqlcode                             32910007
329200                      ' PO='                                      32920000
329300                      PV-DISP-PO                                  32930000
329400                      ' RCV='                                     32940000
329500                      PV-DISP-RCVR-SEQ-NBR                        32950000
329600                      ' LNE='                                     32960000
329700                      PV-DISP-PO-LNE-NBR                          32970000
329800                      ' STR='                                     32980000
329900                      PV-DISP-STR-NBR                             32990000
330000                      DELIMITED BY SIZE                           33000000
330100                                      INTO PV-CICS-MSG-AREA       33010000
330200             PERFORM 9999-WRITE-TO-CSSL                           33020000
330300             MOVE '6750-'                TO SU044-CRA-REQ-ID      33030000
330400             MOVE PV-CICS-MSG-AREA      TO SU044-CRA-RET-MSG      33040000
330500             PERFORM 9998-RETURN                                  33050000
330600     END-EVALUATE.                                                33060000
330700                                                                  33070000
330800 6760-UPDATE-TDISTDT-FCSE.                                        33080000
330810                                                                  33081013
330820     IF  PS-BLD-INTERNAL-TABLE-YES                                33082013
330830         MOVE  '6760'  TO  PT-CURR-PARA                           33083013
330840         PERFORM 8120-INTERNAL-TABLE                              33084013
330850     END-IF.                                                      33085013
330900                                                                  33090000
331000     IF PS-LOG-MESSAGE                                            33100000
331100        MOVE ' SUKUT704-6760-UPDATE-TDISTDT-FCSE '                33110002
331300                                    TO PV-CICS-MSG-AREA           33130002
331400        PERFORM 9999-WRITE-TO-CSSL                                33140000
331500         MOVE SU044-SUCCESS-IND TO PV-CICS-MSG-AREA               33150000
331600         PERFORM 9999-WRITE-TO-CSSL                               33160000
331700     END-IF                                                       33170000
331800                                                                  33180000
331900     EXEC SQL                                                     33190000
332000       UPDATE TDISTDT                                             33200000
332100         SET FCSE_SPLT_UNT_QTY = (FCSE_SPLT_UNT_QTY -             33210000
332200                                               :SHUUPC-SHPD-QTY)  33220000
332300           , FCSE_ACTL_UNT_QTY = (FCSE_ACTL_UNT_QTY -             33230000
332400                                               :SHUUPC-SHPD-QTY)  33240000
332500           , EXPTED_ALLOC_QTY  = (EXPTED_ALLOC_QTY  -             33250000
332600                                               :SHUUPC-SHPD-QTY)  33260000
332700       WHERE ORD_NBR        = :SU044-PO                           33270000
332800         AND RCVR_SEQ_NBR   = :SU044-ORIG-REC-SEQ-NBR             33280000
332900         AND ORD_LNE_NBR    = :DK-PO-LNE-NBR                      33290000
333000         AND STR_NBR        = :DK-STR-DEST-NBR                    33300000
333100         AND FCSE_SPLT_UNT_QTY > 0                                33310000
333200     END-EXEC.                                                    33320000
333300                                                                  33330000
333400     EVALUATE TRUE                                                33340000
333500         WHEN SQLCODE = +0                                        33350000
333600         WHEN SQLCODE = +100                                      33360000
333700              CONTINUE                                            33370000
333800         WHEN SQLWARN0 NOT = SPACES                               33380000
333900         WHEN SQLCODE < +0                                        33390000
334000         WHEN SQLCODE > +0                                        33400000
334010                                                                  33401015
334020              MOVE '6760'  TO  PV-CSSL-PARA                       33402015
334030              perform 8110-WRITE-suws044-TO-CSSL                  33403015
334040                                                                  33404015
334100             SET PS-ERROR                                         33410000
334200                 SU044-INVALID-SQL    TO TRUE                     33420000
334300             MOVE SU044-PO            TO PV-DISP-PO               33430000
334400             MOVE DK-REC-SEQ-NBR      TO PV-DISP-RCVR-SEQ-NBR     33440000
334500             MOVE SHUUPC-TRN-LNE-NBR  TO PV-DISP-PO-LNE-NBR       33450000
334600             MOVE DK-STR-DEST-NBR     TO PV-DISP-STR-NBR          33460000
334700             MOVE  SQLCODE            TO pv-disp-sqlcode          33470007
334800             STRING   ' SUKUT704-6760-'                           33480000
334900                      ' CALLED BY-'                               33490000
335000                      SU044-PROGRAM-NAME                          33500000
335100                      '  SQLCODE='                                33510000
335200                      pv-disp-sqlcode                             33520007
335300                      ' PO='                                      33530000
335400                      PV-DISP-PO                                  33540000
335500                      ' RCV='                                     33550000
335600                      PV-DISP-RCVR-SEQ-NBR                        33560000
335700                      ' LNE='                                     33570000
335800                      PV-DISP-PO-LNE-NBR                          33580000
335900                      ' STR='                                     33590000
336000                      PV-DISP-STR-NBR                             33600000
336100                      DELIMITED BY SIZE                           33610000
336200                                      INTO PV-CICS-MSG-AREA       33620000
336300             PERFORM 9999-WRITE-TO-CSSL                           33630000
336400             MOVE '6760-'                TO SU044-CRA-REQ-ID      33640000
336500             MOVE PV-CICS-MSG-AREA      TO SU044-CRA-RET-MSG      33650000
336600             PERFORM 9998-RETURN                                  33660000
336700     END-EVALUATE.                                                33670000
336800                                                                  33680000
336900 6770-UPDATE-TDISTDT-INPK.                                        33690000
336910                                                                  33691013
336920     IF  PS-BLD-INTERNAL-TABLE-YES                                33692013
336930         MOVE  '6770'  TO  PT-CURR-PARA                           33693013
336940         PERFORM 8120-INTERNAL-TABLE                              33694013
336950     END-IF.                                                      33695013
337000                                                                  33700000
337100     IF PS-LOG-MESSAGE                                            33710000
337200        MOVE ' SUKUT704-6770-UPDATE-TDISTDT-INPK '                33720002
337400                                    TO PV-CICS-MSG-AREA           33740002
337500        PERFORM 9999-WRITE-TO-CSSL                                33750000
337600         MOVE SU044-SUCCESS-IND TO PV-CICS-MSG-AREA               33760000
337700         PERFORM 9999-WRITE-TO-CSSL                               33770000
337800     END-IF                                                       33780000
337900                                                                  33790000
338000     EXEC SQL                                                     33800000
338100       UPDATE TDISTDT                                             33810000
338200         SET INPK_SPLT_UNT_QTY = (INPK_SPLT_UNT_QTY -             33820000
338300                                        :PV-INPK-UNT-QTY)         33830000
338400           , FCSE_ACTL_UNT_QTY = (FCSE_ACTL_UNT_QTY -             33840000
338500                                        :PV-INPK-UNT-QTY)         33850000
338600           , EXPTED_ALLOC_QTY  = (EXPTED_ALLOC_QTY  -             33860000
338700                                               :PV-INPK-UNT-QTY)  33870000
338800       WHERE ORD_NBR        = :SU044-PO                           33880000
338900         AND RCVR_SEQ_NBR   = :SU044-ORIG-REC-SEQ-NBR             33890000
339000         AND ORD_LNE_NBR    = :DK-PO-LNE-NBR                      33900000
339100         AND STR_NBR        = :DK-STR-DEST-NBR                    33910000
339200         AND INPK_SPLT_UNT_QTY > 0                                33920000
339300     END-EXEC.                                                    33930000
339400                                                                  33940000
339500     EVALUATE TRUE                                                33950000
339600         WHEN SQLCODE = +0                                        33960000
339700         WHEN SQLCODE = +100                                      33970000
339800              CONTINUE                                            33980000
339900         WHEN SQLWARN0 NOT = SPACES                               33990000
340000         WHEN SQLCODE < +0                                        34000000
340100         WHEN SQLCODE > +0                                        34010000
340110                                                                  34011015
340120              MOVE '6770'  TO  PV-CSSL-PARA                       34012015
340130              perform 8110-WRITE-suws044-TO-CSSL                  34013015
340140                                                                  34014015
340200             SET PS-ERROR                                         34020000
340300                 SU044-INVALID-SQL    TO TRUE                     34030000
340400             MOVE SU044-PO            TO PV-DISP-PO               34040000
340500             MOVE DK-REC-SEQ-NBR      TO PV-DISP-RCVR-SEQ-NBR     34050000
340600             MOVE SHUUPC-TRN-LNE-NBR  TO PV-DISP-PO-LNE-NBR       34060000
340700             MOVE DK-STR-DEST-NBR     TO PV-DISP-STR-NBR          34070000
340800             MOVE  SQLCODE            TO pv-disp-sqlcode          34080007
340900             STRING   ' SUKUT704-6770-'                           34090000
341000                      ' CALLED BY-'                               34100000
341100                      SU044-PROGRAM-NAME                          34110000
341200                      '  SQLCODE='                                34120000
341300                      pv-disp-sqlcode                             34130007
341400                      ' PO='                                      34140000
341500                      PV-DISP-PO                                  34150000
341600                      ' RCV='                                     34160000
341700                      PV-DISP-RCVR-SEQ-NBR                        34170000
341800                      ' LNE='                                     34180000
341900                      PV-DISP-PO-LNE-NBR                          34190000
342000                      ' STR='                                     34200000
342100                      PV-DISP-STR-NBR                             34210000
342200                      DELIMITED BY SIZE                           34220000
342300                                      INTO PV-CICS-MSG-AREA       34230000
342400             PERFORM 9999-WRITE-TO-CSSL                           34240000
342500             MOVE '6770-'                TO SU044-CRA-REQ-ID      34250000
342600             MOVE PV-CICS-MSG-AREA      TO SU044-CRA-RET-MSG      34260000
342700             PERFORM 9998-RETURN                                  34270000
342800     END-EVALUATE.                                                34280000
342900                                                                  34290000
343000 7000-UPD-TO-RECVR-AUDIT.                                         34300000
343010                                                                  34301013
343020     IF  PS-BLD-INTERNAL-TABLE-YES                                34302013
343030         MOVE  '7000'  TO  PT-CURR-PARA                           34303013
343040         PERFORM 8120-INTERNAL-TABLE                              34304013
343050     END-IF.                                                      34305013
343100                                                                  34310000
343200     IF PS-LOG-MESSAGE                                            34320000
343300        MOVE ' SUKUT704-7000-UPD-TO-RECVR-AUDIT'                  34330002
343500                                    TO PV-CICS-MSG-AREA           34350002
343600        PERFORM 9999-WRITE-TO-CSSL                                34360000
343700         MOVE SU044-SUCCESS-IND TO PV-CICS-MSG-AREA               34370000
343800         PERFORM 9999-WRITE-TO-CSSL                               34380000
343900     END-IF                                                       34390000
344000                                                                  34400000
344100     EXEC SQL                                                     34410000
344200          SET :PV-CURRENT-TIMESTAMP = CURRENT TIMESTAMP           34420000
344300     END-EXEC.                                                    34430000
344400                                                                  34440000
344500*    RC031-AUDIT-TRECEIV         VALUE 'V'.                       34450000
344600*    RC031-AUDIT-TRECITM         VALUE 'I'.                       34460000
344700*    RC031-AUDIT-TRECDIS         VALUE 'D'.                       34470000
344800                                                                  34480000
344900     MOVE 'D'                     TO RC031-TABLE-TO-AUDIT.        34490000
345000                                                                  34500000
345100     MOVE 'B'                     TO RC031-AUD-TYP-CDE.           34510000
345200     MOVE 'U'                     TO RC031-AUD-FUNC-CDE.          34520000
345300     MOVE RECDIS-OPER-UNT-ID      TO RC031-OPER-UNT-ID.           34530000
345400     MOVE 1                       TO RC031-FCLTY-ID.              34540000
345500     MOVE SU044-PO                TO RC031-PO-NBR.                34550000
345600     MOVE SU044-ORIG-REC-SEQ-NBR  TO RC031-REC-SEQ-NBR.           34560000
345700     IF SU044-RCVR-PBS                                            34570000
345800       MOVE SU044-DEST-STR-NBR      TO RC031-STR-NBR              34580000
345900     ELSE                                                         34590000
346000       MOVE DK-STR-DEST-NBR         TO RC031-STR-NBR              34600000
346100     END-IF                                                       34610000
346200                                                                  34620000
346300     MOVE SHUUPC-TRN-LNE-NBR      TO RC031-PO-LNE-NBR.            34630000
346400     MOVE PC-CURRENT-PROGRAM-NAME TO RC031-UPD-PGM-ID             34640000
346500                                     RC031-UPD-UID.               34650000
346600     MOVE PV-CURRENT-TIMESTAMP    TO RC031-UPD-TMST.              34660000
346700                                                                  34670000
346800     EXEC CICS                                                    34680000
346900          LINK PROGRAM  (PC-AUDIT-RTN)                            34690000
347000          COMMAREA (RC031-FIELDS)                                 34700000
347100          LENGTH   (PC-AUDIT-RTN-LENGTH)                          34710000
347200     END-EXEC.                                                    34720000
347300                                                                  34730000
347400     EVALUATE TRUE                                                34740000
347500         WHEN RC031-CALL-SUCCESSFUL                               34750000
347600             CONTINUE                                             34760000
347700         WHEN OTHER                                               34770000
347800             STRING 'SUKUT704'      DELIMITED BY SIZE             34780000
347900                    '-7000-UPD-AUD-RCKCS290'                      34790000
348000                                        DELIMITED BY SIZE         34800000
348100                    'UNSUCCESSFUL CALL TO AUDIT RTN'              34810000
348200                                        DELIMITED BY SIZE         34820000
348300                    RC031-RETURN-CODE  DELIMITED BY SIZE          34830000
348400                    ' '                DELIMITED BY SIZE          34840000
348500                    RC031-RETURN-DESC  DELIMITED BY SIZE          34850000
348600                                  INTO PV-CICS-MSG-AREA           34860000
348700             PERFORM 9999-WRITE-TO-CSSL                           34870000
348800             SET SU044-INVALID-SQL     TO TRUE                    34880000
348900             MOVE PV-CICS-MSG-AREA      TO SU044-CRA-RET-MSG      34890000
349000     END-EVALUATE.                                                34900000
349100                                                                  34910000
349200 7100-CREATE-TROUBLE.                                             34920000
349210                                                                  34921013
349220     IF  PS-BLD-INTERNAL-TABLE-YES                                34922013
349230         MOVE  '7100'  TO  PT-CURR-PARA                           34923013
349240         PERFORM 8120-INTERNAL-TABLE                              34924013
349250     END-IF.                                                      34925013
349300                                                                  34930000
349400     IF PS-LOG-MESSAGE                                            34940000
349500        MOVE ' SUKUT704-7100-CREATE-TROUBLE '                     34950002
349700                                    TO PV-CICS-MSG-AREA           34970002
349800        PERFORM 9999-WRITE-TO-CSSL                                34980000
349900         MOVE SU044-SUCCESS-IND TO PV-CICS-MSG-AREA               34990000
350000         PERFORM 9999-WRITE-TO-CSSL                               35000000
350100     END-IF                                                       35010000
350200                                                                  35020000
350300     SET  TM500-ADD-DETAILS                                       35030000
350400          TM500-CREATE-AUTO        TO TRUE.                       35040000
350500                                                                  35050000
350600     MOVE PC-FA-AUTOVE-TRBLE-372   TO TM500-TRBL-RSN-CDE          35060000
350700                                                                  35070000
350800                                                                  35080000
350900     MOVE SU044-PO                 TO TM500-PO-NBR.               35090000
351000     MOVE SU044-OPER-UNT-ID        TO TM500-OPER-UNT-ID.          35100000
351100     MOVE SU044-FCLTY-ID           TO TM500-FCLTY-ID.             35110000
351200     MOVE SU044-NEW-REC-SEQ-NBR    TO TM500-REC-SEQ-NBR.          35120000
351300     MOVE SU044-SIGNON-USER-ID     TO TM500-NOTIF-UID.            35130000
351400                                                                  35140000
351500                                                                  35150000
351600     EXEC CICS                                                    35160000
351700         LINK PROGRAM  (PC-TROUBLE-WTR)                           35170000
351800              COMMAREA (TM500-FIELDS)                             35180000
351900              LENGTH   (PC-TROUBLE-LENGTH)                        35190000
352000     END-EXEC.                                                    35200000
352100                                                                  35210000
352200                                                                  35220000
352300     EVALUATE TRUE                                                35230000
352400         WHEN TM500-CALL-SUCCESSFUL                               35240000
352500         WHEN TM500-DUPLICATE-TROUBLE                             35250000
352600              CONTINUE                                            35260000
352700         WHEN OTHER                                               35270000
352800             SET PS-ERROR                                         35280000
352900                 SU044-INVALID-SQL    TO TRUE                     35290000
353000             MOVE  SQLCODE            TO pv-disp-sqlcode          35300007
353100             STRING   ' SUKUT704-7100-'                           35310000
353200                      ' CALLED BY-'                               35320000
353300                      SU044-PROGRAM-NAME                          35330000
353400                      '  SQLCODE='                                35340000
353500                      pv-disp-sqlcode                             35350007
353600                      ' '                                         35360000
353700                      DELIMITED BY SIZE                           35370000
353800                                      INTO PV-CICS-MSG-AREA       35380000
353900             PERFORM 9999-WRITE-TO-CSSL                           35390000
354000             MOVE '7100-'                TO SU044-CRA-REQ-ID      35400000
354100             MOVE PV-CICS-MSG-AREA      TO SU044-CRA-RET-MSG      35410000
354200             SET SU044-INVALID-SQL TO TRUE                        35420000
354300             PERFORM 9998-RETURN                                  35430000
354400         END-EVALUATE.                                            35440000
354500                                                                  35450000
354600*----------------------------------------------------------------*35460000
354700*  LINK TO SUKUT708 TO UPDATE TSHPSUM CARTON COMBINATIONS         35470000
354800*----------------------------------------------------------------*35480000
354900 7200-LINK-SUKUT708.                                              35490000
354910                                                                  35491013
354920     IF  PS-BLD-INTERNAL-TABLE-YES                                35492013
354930         MOVE  '7200'  TO  PT-CURR-PARA                           35493013
354940         PERFORM 8120-INTERNAL-TABLE                              35494013
354950     END-IF.                                                      35495013
355000                                                                  35500000
355100     MOVE LENGTH OF SU044-COMM-AREA                               35510000
355200                                         TO PV-COMMAREA-LENGTH.   35520000
355300                                                                  35530000
355400     EXEC CICS                                                    35540000
355500         LINK PROGRAM  (PC-SHPUM-UPD-PGM)                         35550000
355600              COMMAREA (SU044-COMM-AREA)                          35560000
355700              LENGTH   (PV-COMMAREA-LENGTH)                       35570000
355800              RESP     (PV-CICS-RESPONSE)                         35580000
355900     END-EXEC.                                                    35590000
356000                                                                  35600000
356100     EVALUATE TRUE                                                35610000
356200         WHEN SU044-SUCCESSFUL                                    35620000
356300             CONTINUE                                             35630000
356400         WHEN OTHER                                               35640000
356500             SET PS-ERROR                                         35650000
356600                 SU044-INVALID-SQL    TO TRUE                     35660000
356700             MOVE  SQLCODE            TO pv-disp-sqlcode          35670007
356800             STRING   ' SUKUT704-'                                35680000
356900                      SU044-CRA-RET-MSG  DELIMITED BY SIZE        35690000
357000                                    INTO PV-CICS-MSG-AREA         35700000
357100             PERFORM 9999-WRITE-TO-CSSL                           35710000
357200             INITIALIZE PV-CICS-MSG-AREA                          35720000
357300             STRING   ' SUKUT704-7200-'                           35730000
357400                      ' CALLED BY-'                               35740000
357500                      SU044-PROGRAM-NAME                          35750000
357600                      '  SQLCODE='                                35760000
357700                      pv-disp-sqlcode                             35770007
357800                      '  SUCCESS-IND='                            35780000
357900                      SU044-SUCCESS-IND                           35790000
358000                      DELIMITED BY SIZE                           35800000
358100                                      INTO PV-CICS-MSG-AREA       35810000
358200             PERFORM 9999-WRITE-TO-CSSL                           35820000
358300             MOVE '7200-'                TO SU044-CRA-REQ-ID      35830000
358400             INITIALIZE  SU044-CRA-RET-MSG                        35840000
358500             MOVE PV-CICS-MSG-AREA       TO SU044-CRA-RET-MSG     35850000
358600             SET SU044-INVALID-SQL TO TRUE                        35860000
358700             PERFORM 9998-RETURN                                  35870000
358800     END-EVALUATE.                                                35880000
358900                                                                  35890000
359000                                                                  35900000
359100 8000-CHECK-FOR-LOGGING.                                          35910000
359110                                                                  35911013
359120     IF  PS-BLD-INTERNAL-TABLE-YES                                35912013
359130         MOVE  '8000'  TO  PT-CURR-PARA                           35913013
359140         PERFORM 8120-INTERNAL-TABLE                              35914013
359150     END-IF.                                                      35915013
359200                                                                  35920000
359300     EXEC SQL                                                     35930000
359400          SELECT FUNC_TXT                                         35940000
359500            INTO :KRPRPM-FUNC-TXT                                 35950000
359600            FROM TKRPRPM                                          35960000
359700           WHERE LOC_ID            = :DK-OPER-UNT-ID              35970000
359800             AND INTFC_SYS_CDE    = 'KHL'                         35980000
359900             AND SYS_PRC_FUNC_CDE = 'SU704D'                      35990000
360000             AND FUNC_PRC_STAT_CDE = 'AC'                         36000000
360010            with ur                                               36001016
360100     END-EXEC.                                                    36010000
360200                                                                  36020000
360300     EVALUATE TRUE                                                36030000
360400         WHEN SQLCODE = ZERO                                      36040000
360500             IF KRPRPM-FUNC-TXT = 'Y'                             36050000
360600                 SET PS-LOG-MESSAGE  TO TRUE                      36060000
360700             ELSE                                                 36070000
360800                 SET PS-NO-LOG-MESSAGE  TO TRUE                   36080000
360900             END-IF                                               36090000
361000         WHEN SQLCODE = +100                                      36100000
361100             SET PS-NO-LOG-MESSAGE  TO TRUE                       36110000
361200         WHEN SQLWARN0 NOT = SPACES                               36120000
361300         WHEN SQLCODE NOT EQUAL ZERO                              36130000
361310                                                                  36131015
361320              MOVE '8000'  TO  PV-CSSL-PARA                       36132015
361330              perform 8110-WRITE-suws044-TO-CSSL                  36133015
361340                                                                  36134015
361400             SET PS-ERROR                                         36140000
361500                 SU044-INVALID-SQL    TO TRUE                     36150000
361600             MOVE  SQLCODE            TO pv-disp-sqlcode          36160007
361700             STRING   ' SUKUT704-8000-'                           36170000
361800                      ' CALLED BY-'                               36180000
361900                      SU044-PROGRAM-NAME                          36190000
362000                      '  SQLCODE='                                36200000
362100                      pv-disp-sqlcode                             36210007
362200                      ' '                                         36220000
362300                      DELIMITED BY SIZE                           36230000
362400                                      INTO PV-CICS-MSG-AREA       36240000
362500             PERFORM 9999-WRITE-TO-CSSL                           36250000
362600             MOVE '8000-'                TO SU044-CRA-REQ-ID      36260000
362700             MOVE PV-CICS-MSG-AREA      TO SU044-CRA-RET-MSG      36270000
362800             SET SU044-INVALID-SQL TO TRUE                        36280000
362900             PERFORM 9998-RETURN                                  36290000
363000     END-EVALUATE.                                                36300000
363100                                                                  36310000
363200                                                                  36320000
363210*---------------------------------------------------------------* 36321006
363220* check parm table (TKRPRPM) to check for logging to CSSL       * 36322006
363230* IF PROGRAM IS TAKING TOO LONG TO RESPOND.  THE VALUE WILL     * 36323006
363240* BE seconds AND WILL BE USED TO DETERMINE IF WE SHOULD WRITE   * 36324006
363250* pt-pARA-tRACKING TABLE TO CSSL                                * 36325006
363260* check parm table (TKRPRPM) to check if will be building the   * 36326006
363270* internal table during processing.  this will be used when     * 36327006
363280* dc's report long resonse times                                * 36328006
363290*  2015-01-29 - DMH                                             * 36329006
363291*---------------------------------------------------------------* 36329106
363292 8100-CHECK-PARA-TRACK-SEC.                                       36329206
363293                                                                  36329306
363294     IF  PS-BLD-INTERNAL-TABLE-YES                                36329406
363295         MOVE  '8100'  TO  PT-CURR-PARA                           36329506
363296         PERFORM 8120-INTERNAL-TABLE                              36329606
363297     END-IF.                                                      36329706
363298                                                                  36329806
363299     EXEC SQL                                                     36329906
363300          SELECT  FUNC_QTY                                        36330006
363301               ,  FUNC_txt                                        36330106
363302            INTO :PV-PARM-seconds                                 36330206
363303               , :PS-BLD-INTERNAL-TABLE-SW                        36330306
363304            FROM  TKRPRPM                                         36330406
363305           WHERE  LOC_ID            = :DK-OPER-UNT-ID             36330506
363306             AND  INTFC_SYS_CDE     = 'ACM'                       36330606
363307             AND  SYS_PRC_FUNC_CDE  = 'PATIM4'                    36330706
363308             AND  FUNC_PRC_STAT_CDE = 'AC'                        36330806
363309             AND  fUNC_BEG_TMST    <=  current timestamp          36330906
363310             AND  fUNC_END_TMST    >=  current timestamp          36331006
363311            WITH UR                                               36331106
363312     END-EXEC.                                                    36331206
363313                                                                  36331306
363314     EVALUATE TRUE                                                36331406
363315         WHEN SQLCODE = ZERO                                      36331506
363316              CONTINUE                                            36331606
363317                                                                  36331706
363318         WHEN SQLCODE = +100                                      36331806
363319              MOVE 999999999  TO  PV-PARM-SECONDS                 36331906
363320              SET  PS-BLD-INTERNAL-TABLE-NO   TO TRUE             36332006
363321                                                                  36332106
363322         WHEN SQLWARN0 NOT = SPACES                               36332206
363323         WHEN SQLCODE NOT EQUAL ZERO                              36332306
363324                                                                  36332415
363325              move '8100'  to  PV-CSSL-PARA                       36332506
363326              perform 8110-WRITE-suws044-TO-CSSL                  36332606
363327                                                                  36332706
363331              SET PS-BLD-INTERNAL-TABLE-NO   TO  TRUE             36333106
363332              MOVE  SQLCODE           TO pv-disp-sqlcode          36333207
363333              SET PS-ERROR                                        36333306
363334                  SU044-INVALID-SQL   TO TRUE                     36333406
363335              MOVE  SQLCODE           TO pv-disp-sqlcode          36333507
363336              STRING   ' SUKUT704-8100-'                          36333623
363337                       ' CALLED BY:'     SU044-PROGRAM-NAME       36333706
363338                       ' SQL:'           pv-disp-sqlcode          36333807
363339                       ' '                                        36333906
363340                       DELIMITED BY SIZE                          36334006
363341                                    INTO PV-CICS-MSG-AREA-3       36334106
363342             PERFORM 9997-WRITE-TO-CSSL                           36334206
363343             MOVE '8100-'             TO SU044-CRA-REQ-ID         36334306
363344             MOVE PV-CICS-MSG-AREA    TO SU044-CRA-RET-MSG        36334406
363345             SET SU044-INVALID-SQL    TO TRUE                     36334506
363346             PERFORM 9998-RETURN                                  36334606
363347                                                                  36334706
363348     END-EVALUATE.                                                36334806
363349                                                                  36334906
363350                                                                  36335006
363351*---------------------------------------------------------------* 36335106
363352* WRITE COMMAREA TO CSSL                                        * 36335206
363353* DMH - 01/29/15                                                * 36335306
363354*---------------------------------------------------------------* 36335406
363355 8110-WRITE-suws044-TO-CSSL.                                      36335506
363356                                                                  36335606
363357     IF  PS-BLD-INTERNAL-TABLE-YES                                36335706
363358         MOVE  '8110'  TO  PT-CURR-PARA                           36335806
363359         PERFORM 8120-INTERNAL-TABLE                              36335906
363360     END-IF.                                                      36336006
363361                                                                  36336106
363362     INITIALIZE PV-CICS-MSG-AREA-3                                36336206
363363     MOVE SU044-SHIPT-UNT-ID       TO PV-DISP-SSCC                36336306
363364     MOVE SU044-PO                 TO PV-DISP-PO                  36336406
363365     MOVE SU044-ORIG-REC-SEQ-NBR   TO PV-DISP-ORIG-RCVR           36336506
363366     MOVE SU044-NEW-REC-SEQ-NBR    TO PV-DISP-NEW-RCVR            36336606
363367     MOVE SU044-OPER-UNT-ID        TO PV-DISP-OPER                36336706
363368     MOVE SU044-CRTN-OPER-UNT-ID   TO PV-DISP-CRTN-OPER           36336806
363369     MOVE SU044-FCLTY-ID           TO PV-DISP-FCLTY               36336906
363370     MOVE SU044-TRIP-ID            TO PV-DISP-TRIP                36337006
363371     MOVE SU044-DEST-STR-NBR       TO PV-DISP-DEST-STR            36337106
363372     MOVE SU044-ORIG-SHIP          TO PV-DISP-ORIG-SHIP           36337206
363373     MOVE SU044-NEW-SHIP           TO PV-DISP-NEW-SHIP            36337306
363374     MOVE SU044-ORIG-PKSL-SEQ-NBR  TO PV-DISP-ORIG-PKSL           36337406
363375     MOVE SU044-NEW-PKSL-SEQ-NBR   TO PV-DISP-NEW-PKSL            36337506
363376     MOVE SQLCODE                  TO PV-DISP-SQLCODE             36337606
363377                                                                  36337706
363378     STRING  ' SUKUT704 '  PV-CSSL-PARA                           36337806
363379             ' SSCC:'      PV-DISP-SSCC                           36337906
363380             ' PO:'        PV-DISP-PO                             36338006
363381             ' ORIG RCVR:' PV-DISP-ORIG-RCVR                      36338106
363382             ' NEW RCVR:'  PV-DISP-NEW-RCVR                       36338206
363383             ' TYPE:'      SU044-RCVR-TYPE-CDE                    36338306
363384             ' OPER:'      PV-DISP-OPER                           36338406
363385             ' CRTN OPER:' PV-DISP-CRTN-OPER                      36338506
363386             ' FCLTY:'     PV-DISP-FCLTY                          36338606
363387                           DELIMITED BY SIZE                      36338706
363388                      INTO PV-CICS-MSG-AREA-3                     36338806
363389                                                                  36338906
363390     PERFORM 9997-WRITE-TO-CSSL                                   36339006
363391                                                                  36339106
363392     INITIALIZE PV-CICS-MSG-AREA-3                                36339206
363393     STRING  ' SUKUT704 '                                         36339306
363394             ' SCAC:'      SU044-SCAC-ID                          36339406
363395             ' TRLR:'      SU044-VEH-NBR                          36339506
363396             ' DEST:'      PV-DISP-DEST-STR                       36339606
363397             ' ORIG SHIP:' PV-DISP-ORIG-SHIP                      36339706
363398             ' NEW SHIP:'  PV-DISP-NEW-SHIP                       36339806
363399             ' ORIG BOL:'  SU044-ORIG-BOL-NBR                     36339906
363400                           DELIMITED BY SIZE                      36340006
363401                      INTO PV-CICS-MSG-AREA-3                     36340106
363402                                                                  36340206
363403     PERFORM 9997-WRITE-TO-CSSL                                   36340306
363404                                                                  36340406
363405     INITIALIZE PV-CICS-MSG-AREA-3                                36340506
363406     STRING  ' SUKUT704 '                                         36340606
363407             ' ORIG PKSL:' PV-DISP-ORIG-PKSL                      36340706
363408             ' NEW PKSL:'  PV-DISP-NEW-PKSL                       36340806
363409             ' FUNC:'      SU044-FUNCTION-SWITCH                  36340906
363410             ' SRC:'       SU044-CALL-SOURCE-SWITCH               36341006
363411             ' PKSL:'      SU044-UPDATE-PKSLIP-SW                 36341106
363412             ' PGRM:'      SU044-PROGRAM-NAME                     36341206
363413             ' SUCC:'      SU044-SUCCESS-IND                      36341306
363414             ' PKSL CRE:'  SU044-PKSLIP-CRE-SRCE                  36341406
363415             ' RCVR CRE:'  SU044-RECEIVER-CREATE-SRC              36341506
363416                           DELIMITED BY SIZE                      36341606
363417                      INTO PV-CICS-MSG-AREA-3                     36341706
363418                                                                  36341806
363419     PERFORM 9997-WRITE-TO-CSSL.                                  36341906
363420                                                                  36342006
363421     INITIALIZE PV-CICS-MSG-AREA-3                                36342106
363422     STRING  ' SUKUT704 '                                         36342206
363423             ' ORIG pro:'  SU044-ORIG-PRO-NBR                     36342306
363424             ' NEW pro:'   SU044-NEW-PRO-NBR                      36342406
363425             ' usrid:'     SU044-SIGNON-USER-ID                   36342506
363426             ' SQL:'       PV-DISP-SQLCODE                        36342606
363427                           DELIMITED BY SIZE                      36342706
363428                      INTO PV-CICS-MSG-AREA-3                     36342806
363429                                                                  36342906
363430     PERFORM 9997-WRITE-TO-CSSL.                                  36343006
363431                                                                  36343106
363432                                                                  36343206
363433*---------------------------------------------------------------* 36343306
363434* BUILD INTERNAL TABLE WITN PARAGRAPH TRACKING                  * 36343406
363435* DMH - 01/29/15                                                * 36343506
363436*---------------------------------------------------------------* 36343606
363437 8120-INTERNAL-TABLE.                                             36343706
363438                                                                  36343806
363439     PERFORM 8130-GET-CURRENT-TMST.                               36343906
363440     ADD  +1  TO  PT-CURR-ENTRIES.                                36344006
363441     SET  PT-TRACK-IDX to PT-CURR-ENTRIES                         36344106
363442                                                                  36344206
363443     MOVE 'SUKUT704'           TO PT-PROGRAM(PT-TRACK-IDX).       36344306
363444     MOVE PT-CURR-ENTRIES      TO PT-INDEX-NBR(PT-TRACK-IDX).     36344406
363445     MOVE PT-CURR-PARA         TO PT-PARAGRAPH(PT-TRACK-IDX).     36344506
363446     MOVE PV-CURRENT-PARA-TMST TO PT-TIMESTAMP(PT-TRACK-IDX).     36344606
363447     MOVE PV-DURATION-SEC      TO PT-DURATION(PT-TRACK-IDX).      36344706
363448                                                                  36344806
363449     MOVE PV-DURATION-NANO-SEC    TO PV-WORK-NANO-SEC.            36344906
363450     MOVE PV-WORK-NANO-MIN-1-2    TO PV-DISP-NANO-MIN-1-2.        36345006
363451     MOVE '-'                     TO PV-DISP-NANO-DASH-1.         36345106
363452     MOVE PV-WORK-NANO-SEC-3-4    TO PV-DISP-NANO-SEC-3-4.        36345206
363453     MOVE '-'                     TO PV-DISP-NANO-DASH-2.         36345306
363454     MOVE PV-WORK-NANO-MICRO-5-10 TO PV-DISP-NANO-MICRO-5-10.     36345406
363455     MOVE PV-DISP-NANO-SEC     TO PT-NANO-SEC(PT-TRACK-IDX).      36345506
363456                                                                  36345606
363457     MOVE SU044-OPER-UNT-ID      tO PT-DC(PT-TRACK-IDX).          36345706
363458     MOVE SU044-CRTN-OPER-UNT-ID tO PT-crtn-oper(PT-TRACK-IDX).   36345806
363459     MOVE PV-INIT-TIME-KEY      TO PT-START-HHMMSS(PT-TRACK-IDX). 36345906
363460                                                                  36346006
363461     IF  PT-TRACK-IDX >=  PT-MAX-PARA-ENTRIES                     36346106
363462         MOVE ZEROES TO PT-CURR-ENTRIES                           36346206
363463         SET  PT-TRACK-IDX  TO PT-CURR-ENTRIES                    36346306
363464     END-IF.                                                      36346406
363465                                                                  36346506
363466                                                                  36346606
363467*---------------------------------------------------------------* 36346706
363468*                                                               * 36346806
363469* DMH - 01/29/15                                                * 36346906
363470*---------------------------------------------------------------* 36347006
363471 8130-GET-CURRENT-TMST.                                           36347106
363472     EXEC SQL                                                     36347206
363473          SET :PV-CURRENT-PARA-TMST = CURRENT TIMESTAMP           36347306
363474     END-EXEC.                                                    36347406
363475                                                                  36347506
363476     EXEC SQL                                                     36347606
363477          SELECT                                                  36347706
363478                 TIMESTAMPDIFF( 2 ,CHAR(:PV-CURRENT-PARA-TMST     36347806
363479                   - TIMESTAMP(:PV-RECEIVE-RQST-TMST)))           36347906
363480               , TIMESTAMPDIFF( 1 ,CHAR(:PV-CURRENT-PARA-TMST     36348006
363481                   - TIMESTAMP(:PV-RECEIVE-RQST-TMST)))           36348106
363482            INTO :PV-DURATION-SEC                                 36348206
363483               , :PV-DURATION-nano-sec                            36348306
363484            FROM  SYSIBM.SYSDUMMY1                                36348406
363485     END-EXEC.                                                    36348506
363486                                                                  36348606
363487                                                                  36348706
363488*---------------------------------------------------------------* 36348806
363489*                                                               * 36348906
363490* DMH - 01/29/15                                                * 36349006
363491*---------------------------------------------------------------* 36349106
363492 8140-DUMP-TABLE-TO-CSSL.                                         36349206
363493                                                                  36349306
363494     INITIALIZE PV-CICS-MSG-AREA                                  36349406
363495                                                                  36349506
363496     MOVE PT-ENTRIES(PT-TRACK-IDX)  TO PV-CICS-MSG-AREA-3         36349606
363497                                                                  36349706
363498     PERFORM 9997-WRITE-TO-CSSL.                                  36349806
363499                                                                  36349906
363500                                                                  36350006
363501*---------------------------------------------------------------* 36350106
363502*                                                               * 36350206
363503* DMH - 01/29/15                                                * 36350306
363504*---------------------------------------------------------------* 36350406
363505 8150-CLEAR-TABLE.                                                36350506
363506                                                                  36350606
363507     MOVE  SPACES  TO  PT-PROGRAM(PT-TRACK-IDX).                  36350706
363508     MOVE  ZEROES  TO  PT-INDEX-NBR(PT-TRACK-IDX).                36350806
363509     MOVE  SPACES  TO  PT-PARAGRAPH(PT-TRACK-IDX).                36350906
363510     MOVE  SPACES  TO  PT-TIMESTAMP(PT-TRACK-IDX).                36351006
363511     MOVE  ZEROES  TO  PT-DURATION(PT-TRACK-IDX).                 36351106
363512                                                                  36351206
363513                                                                  36351306
363514                                                                  36351400
363515*----------------------------------------------------------------*36351500
363520*    CURRENT SYSTEM DATE/TIME MODULE                              36352000
363600*----------------------------------------------------------------*36360000
363700                                                                  36370000
363800     COPY DPPD017.                                                36380000
363900                                                                  36390000
363910*-----------------------------------------------------------------36391006
363911*                                                                -36391106
363912*-----------------------------------------------------------------36391206
363920 9997-WRITE-TO-CSSL.                                              36392006
363930*                                                                 36393006
363940     MOVE LENGTH OF PV-CICS-MSG-AREA-3  TO PV-COMMAREA-LENGTH.    36394006
363950                                                                  36395006
363960     EXEC CICS                                                    36396006
363970          WRITEQ TD                                               36397006
363980           QUEUE   ('CSSL')                                       36398006
363990            FROM   (PV-CICS-MSG-AREA-3)                           36399006
363991          LENGTH   (PV-COMMAREA-LENGTH)                           36399106
363992            RESP   (PV-CICS-RESPONSE)                             36399206
363993     END-EXEC.                                                    36399306
363994                                                                  36399406
363995                                                                  36399506
364000*-----------------------------------------------------------------36400000
364100*  RETURN TO CALLING PROGRAM                                      36410000
364200*-----------------------------------------------------------------36420000
364300 9998-RETURN.                                                     36430000
364400                                                                  36440000
364500     MOVE SQLCA                         TO SU044-SQLCA            36450000
364600                                           PV-CICS-MSG-AREA.      36460000
364700     PERFORM 9999-WRITE-TO-CSSL.                                  36470000
364800     MOVE SU044-COMM-AREA               TO DFHCOMMAREA.           36480000
364900                                                                  36490000
365000     EXEC CICS                                                    36500000
365100          RETURN                                                  36510000
365200     END-EXEC.                                                    36520000
365300                                                                  36530000
365400 9999-WRITE-TO-CSSL.                                              36540000
365500                                                                  36550000
365600     MOVE LENGTH OF PV-CICS-MSG-AREA  TO PV-COMMAREA-LENGTH.      36560000
365700                                                                  36570000
365800     EXEC CICS                                                    36580000
365900          WRITEQ TD                                               36590000
366000           QUEUE   ('CSSL')                                       36600000
366100            FROM   (PV-CICS-MSG-AREA)                             36610000
366200          LENGTH   (PV-COMMAREA-LENGTH)                           36620000
366300            RESP   (PV-CICS-RESPONSE)                             36630000
366400     END-EXEC.                                                    36640000
366500                                                                  36650000
