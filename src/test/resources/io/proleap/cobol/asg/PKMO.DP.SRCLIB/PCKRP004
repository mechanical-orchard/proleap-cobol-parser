000100***************************************************************** 00010008
000200 IDENTIFICATION DIVISION.                                         00020008
000300***************************************************************** 00030008
000400 PROGRAM-ID.             PCKRP004.                                00040008
000500 AUTHOR.                 LARRY SCHLEICHER - STRATAGEM.            00050008
000600 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00060008
000700 DATE-WRITTEN            OCTOBER, 1996                            00070008
000800 DATE-COMPILED.                                                   00080008
000900***************************************************************** 00090008
001000*  THIS PROGRAM WILL PRINT THE RECEIVERS COMPLETE - NOT VERIFIED* 00100008
001100*  REPORT.                                                      * 00110008
001200***************************************************************** 00120008
001300*  CHANGED 04/20/01 BY DEANNA BRANTNER                          * 00130008
001400*   WR# 9900 CHANGE SORTING BY ADDING PROCESS AREA TO HEADING.  * 00140008
001410*  CHANGED 09/26/14 BY DAVID WELLER                             * 00141022
001420*   CHG0098147 PO-NBR EXPANSION TO 8 DIGITS.                    * 00142022
001500*  CHANGED MM/DD/YY BY XXXXXXXXXXX                              * 00150008
001600*   WR# XXXX XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX * 00160008
001700*                                                               * 00170008
001800***************************************************************** 00180008
001900 ENVIRONMENT DIVISION.                                            00190008
002000***************************************************************** 00200008
002100 CONFIGURATION SECTION.                                           00210008
002200 SOURCE-COMPUTER.        IBM-3090.                                00220008
002300 OBJECT-COMPUTER.        IBM-3090.                                00230008
002400 INPUT-OUTPUT SECTION.                                            00240008
002500 FILE-CONTROL.                                                    00250008
002600*                                                                 00260008
002700     SELECT EXTRACT-FILE                                          00270008
002800         ASSIGN TO INP01.                                         00280008
002900                                                                  00290008
003000     SELECT PC-COMPLETE-NOT-VERIFIED-RPT                          00300008
003100         ASSIGN TO RPT01.                                         00310008
003200*                                                                 00320008
003300***************************************************************** 00330008
003400 DATA DIVISION.                                                   00340008
003500***************************************************************** 00350008
003600 FILE SECTION.                                                    00360008
003700*                                                                 00370008
003800 FD  EXTRACT-FILE                                                 00380008
003900     LABEL RECORDS ARE STANDARD                                   00390008
004000     RECORDING MODE IS F                                          00400008
004100     BLOCK CONTAINS 0 RECORDS                                     00410008
004110*** PRB0064829 START                                              00411023
004200*    RECORD CONTAINS 150 CHARACTERS.                              00420023
004300*01  EXTRACT-RECORD                  PIC X(150).                  00430023
004310     RECORD CONTAINS 200 CHARACTERS.                              00431023
004320 01  EXTRACT-RECORD                  PIC X(200).                  00432023
004330*** PRB0064829 END                                                00433023
004400                                                                  00440008
004500 FD  PC-COMPLETE-NOT-VERIFIED-RPT                                 00450008
004600     RECORDING MODE IS F                                          00460008
004700     BLOCK CONTAINS 0  RECORDS.                                   00470008
004800 01  PC-COMPLETE-NOT-VERIFIED-REC    PIC  X(132).                 00480008
004900                                                                  00490008
005000 WORKING-STORAGE SECTION.                                         00500008
005100*                                                                 00510008
005200 01  PROGRAM-SWITCHES.                                            00520008
005300     05  PS-END-OF-EXTRACT-SW        PIC  X(01)    VALUE 'N'.     00530008
005400         88  PS-END-OF-EXTRACT                     VALUE 'Y'.     00540008
005500         88  PS-PROCESS-EXTRACT                    VALUE 'N'.     00550008
005600     05  PS-VALID-DC-SW              PIC  X(01)    VALUE 'N'.     00560008
005700         88  PS-VALID-DC                           VALUE 'Y'.     00570008
005800         88  PS-INVALID-DC                         VALUE 'N'.     00580008
005900     05  PS-FIRST-PASS-SW            PIC  X(01)    VALUE 'Y'.     00590008
006000         88  PS-NOT-FIRST-PASS                     VALUE 'N'.     00600008
006100     05  PS-FIRST-DETAIL-REC-SW      PIC  X(01)    VALUE 'N'.     00610008
006200         88  PS-FIRST-DETAIL-REC                   VALUE 'Y'.     00620008
006300         88  PS-NOT-FIRST-DETAIL-REC               VALUE 'N'.     00630008
006400     05  PS-HEADER-ONLY-REC-SW       PIC  X(01)    VALUE 'N'.     00640008
006500         88  PS-HEADER-ONLY-REC                    VALUE 'Y'.     00650008
006600         88  PS-NOT-HEADER-ONLY-REC                VALUE 'N'.     00660008
006700*                                                                 00670008
006800 01  PC-CONSTANTS.                                                00680008
006900     05  PC-1                        PIC S9(03)    VALUE +1       00690008
007000                                                   COMP-3.        00700008
007100     05  PC-2                        PIC S9(03)    VALUE +2       00710008
007200                                                   COMP-3.        00720008
007300     05  PC-6                        PIC S9(03)    VALUE +6       00730008
007400                                                   COMP-3.        00740008
007500     05  PC-55                       PIC S9(03)    VALUE +55      00750008
007600                                                   COMP-3.        00760008
007700     05  PC-60                       PIC S9(03)    VALUE +60      00770008
007800                                                   COMP-3.        00780008
007900     05  PC-PCKRP004                 PIC  X(08)    VALUE          00790008
008000         'PCKRP004'.                                              00800008
008100     05  PC-REPORT-NBR               PIC  9(01)    VALUE 1.       00810008
008200     05  PC-ENROUTE                  PIC  X(10)   VALUE 'ENROUTE'.00820008
008300     05  PC-ENRT                     PIC  X(04)    VALUE 'ENRT'.  00830008
008400     05  PC-HERE                     PIC  X(04)    VALUE 'HERE'.  00840008
008500*                                                                 00850008
008600 01  PV-MISC-FIELDS.                                              00860008
008700     05  PV-LINE-SUB                 PIC S9(03)    VALUE ZERO     00870008
008800                                                   COMP-3.        00880008
008900     05  PV-LINE-CNT                 PIC S9(03)    VALUE ZERO     00890008
009000                                                   COMP-3.        00900008
009100     05  PV-PAGE-CNT                 PIC S9(04)    VALUE ZERO     00910008
009200                                                   COMP-3.        00920008
009300     05  PV-VENDOR-COUNT             PIC S9(04)    VALUE ZERO     00930008
009400                                                   COMP-3.        00940008
009500     05  PV-ABEND-CODE               PIC S9(04)    VALUE ZERO     00950008
009600                                                   COMP SYNC.     00960008
009700     05  PV-RECEIVER-STATUS          PIC  X(04)    VALUE SPACES.  00970008
009800     05  PV-CURRENT-OPER             PIC  9(04)    VALUE ZERO.    00980016
009900*        10  FILLER                  PIC  X(01)    VALUE SPACES.  00990016
010000*        10  PV-CURRENT-OPER-3       PIC  X(03)    VALUE SPACES.  01000016
010100*    05  PV-CURRENT-OPER-X-3         PIC  X(03)    VALUE SPACES.  01010016
010200     05  PV-SAVE-PRE-RECEIVED-IND    PIC  X(01)    VALUE SPACES.  01020008
010300     05  PV-SAVE-PROCESS             PIC  X(06)    VALUE SPACES.  01030008
010400     05  PV-SAVE-CURR-OPER           PIC  9(04)    VALUE ZERO.    01040008
010500     05  PV-SAVE-CURR-FCLTY          PIC  9(04)    VALUE ZERO.    01050008
010600     05  PV-PROCESS-CARTON-QTY       PIC  9(09)    VALUE ZERO.    01060008
010700     05  PV-PROCESS-ITEM-QTY         PIC  9(09)    VALUE ZERO.    01070008
010800     05  PV-GRAND-CARTON-QTY         PIC  9(09)    VALUE ZERO.    01080008
010900     05  PV-GRAND-ITEM-QTY           PIC  9(09)    VALUE ZERO.    01090008
011000     05  PV-ABEND-PARAGRAPH          PIC  X(30)    VALUE SPACES.  01100008
011100     05  PV-SAVE-PO                  PIC S9(09)    VALUE ZERO.    01110008
011200     05  PV-SAVE-RECEIVER            PIC  9(03)    VALUE ZERO.    01120008
011300     05  PV-DATE-DDMMYY.                                          01130008
011400         10  PV-DATE-DD              PIC  X(02).                  01140008
011500         10  PV-DATE-SLASH-1         PIC  X(01).                  01150008
011600         10  PV-DATE-MM              PIC  X(02).                  01160008
011700         10  PV-DATE-SLASH-2         PIC  X(01).                  01170008
011800         10  PV-DATE-YY              PIC  X(04).                  01180008
011900     05  PV-TODAYS-DATE.                                          01190008
012000         10  PV-TODAYS-DATE-YY       PIC  9(02)    VALUE ZERO.    01200008
012100         10  PV-TODAYS-DATE-MM       PIC  9(02)    VALUE ZERO.    01210008
012200         10  PV-TODAYS-DATE-DD       PIC  9(02)    VALUE ZERO.    01220008
012300     05  PV-TODAYS-TIME.                                          01230008
012400         10  PV-TODAYS-TIME-HH       PIC  9(02)    VALUE ZERO.    01240008
012500         10  PV-TODAYS-TIME-MM       PIC  9(02)    VALUE ZERO.    01250008
012600         10  PV-TODAYS-TIME-SS       PIC  9(02)    VALUE ZERO.    01260008
012700         10  FILLER                  PIC  9(02)    VALUE ZERO.    01270008
012800     05  PV-FORMAT-DATE.                                          01280008
012900         10  PV-FORMAT-DATE-MM       PIC  X(02)    VALUE SPACES.  01290008
013000         10  FILLER                  PIC  X(01)    VALUE '/'.     01300008
013100         10  PV-FORMAT-DATE-DD       PIC  X(02)    VALUE SPACES.  01310008
013200         10  FILLER                  PIC  X(01)    VALUE '/'.     01320008
013300         10  PV-FORMAT-DATE-YYYY     PIC  X(04)    VALUE SPACES.  01330008
013400     05  PV-SAVE-ASSIGN-TOT-QTY      PIC S9(07)    VALUE ZERO     01340008
013500                                                   COMP-3.        01350008
013600     COPY TMRD001.                                                01360008
013700                                                                  01370008
013800     COPY PCRD002.                                                01380008
013900                                                                  01390008
014000*-----------------------------------------------------------------01400009
014100* COMMAREA FOR XLKUT071 - LOCATION MODULE                         01410009
014200*-----------------------------------------------------------------01420009
014300     COPY XLWS071.                                                01430009
014400******************************************************************01440008
014500*  WORK FIELDS FOR PRINTING A 132 CHARACTER REPORT.               01450008
014600******************************************************************01460008
014700     COPY DPWS132O.                                               01470008
014800*                                                                 01480008
014900 01  HEADING-LINES.                                               01490008
015000     05  HEADING-LINE-1.                                          01500008
015100         10  FILLER                  PIC  X(09)    VALUE          01510008
015200             'LOCATION '.                                         01520008
015300         10  HL1-OPER-UNIT           PIC  X(05).                  01530008
015400         10  HL1-PROCESS             PIC  X(06).                  01540008
015500*DMB     10  HL1-FACILITY            PIC  X(04).                  01550008
015600         10  FILLER                  PIC  X(30)    VALUE SPACES.  01560008
015700*DMB     10  FILLER                  PIC  X(32)    VALUE SPACES.  01570008
015800         10  FILLER                  PIC  X(33)    VALUE          01580008
015900             'RECEIVERS COMPLETE - NOT VERIFIED'.                 01590008
016000         10  FILLER                  PIC  X(49)    VALUE SPACES.  01600008
016100*                                                                 01610008
016110*** PRB0064829 START                                              01611023
016200     05  HEADING-LINE-2.                                          01620008
016300         10  FILLER                  PIC  X(09)    VALUE          01630008
016400             'PROCESS  '.                                         01640008
016500         10  FILLER                  PIC  X(10)    VALUE          01650008
016600*            'RECEIVED  '.                                        01660023
016610             'RECEIVE   '.                                        01661025
016700         10  FILLER                  PIC  X(06)    VALUE          01670010
016800             'CREATE'.                                            01680010
016900         10  FILLER                  PIC  X(03)    VALUE SPACES.  01690025
017000         10  FILLER                  PIC  X(02)    VALUE          01700008
017100             'PO'.                                                01710008
017200         10  FILLER                  PIC  X(05)    VALUE SPACES.  01720025
017300         10  FILLER                  PIC  X(03)    VALUE          01730008
017400             'REC'.                                               01740008
017500         10  FILLER                  PIC  X(05)    VALUE          01750008
017600             ' LINE'.                                             01760008
017700         10  FILLER                  PIC  X(11)    VALUE SPACES.  01770023
017800         10  FILLER                  PIC  X(06)    VALUE          01780008
017900             'VENDOR'.                                            01790008
018000         10  FILLER                  PIC  X(11)    VALUE SPACES.  01800023
018100         10  FILLER                  PIC  X(04)    VALUE          01810023
018200             'DPT '.                                              01820023
018300         10  FILLER                  PIC  X(10)    VALUE          01830023
018301             '  OTB     '.                                        01830123
018310         10  FILLER                  PIC  X(06)    VALUE          01831023
018400             'SEASN '.                                            01840010
018500*        10  FILLER                  PIC  X(04)    VALUE          01850023
018600*            'NEW '.                                              01860023
018700*        10  FILLER                  PIC  X(04)    VALUE          01870023
018800*            'PIC '.                                              01880023
018900         10  FILLER                  PIC  X(08)    VALUE          01890008
019000             'TROUBLE '.                                          01900008
019100         10  FILLER                  PIC  X(04)    VALUE          01910008
019200             'CODE'.                                              01920008
019300         10  FILLER                  PIC  X(03)    VALUE SPACES.  01930008
019400         10  FILLER                  PIC  X(07)    VALUE          01940008
019500             'CARTONS'.                                           01950008
019600         10  FILLER                  PIC  X(02)    VALUE SPACES.  01960008
019700         10  FILLER                  PIC  X(05)    VALUE          01970008
019800             'PKSL '.                                             01980008
019900*        10  FILLER                  PIC  X(06)    VALUE          01990023
020000*            'ITEM P'.                                            02000023
020010         10  FILLER                  PIC  X(06)    VALUE          02001026
020020             'ITM  P'.                                            02002026
020100         10  FILLER                  PIC  X(06)    VALUE SPACES.  02010026
020200*                                                                 02020008
020300     05  HEADING-LINE-3.                                          02030008
020400         10  FILLER                  PIC  X(09)    VALUE          02040008
020500             ' AREA    '.                                         02050008
020600         10  FILLER                  PIC  X(10)    VALUE          02060008
020700             '  DATE    '.                                        02070008
020800         10  FILLER                  PIC  X(01)    VALUE SPACES.  02080012
020900         10  FILLER                  PIC  X(03)    VALUE          02090008
021000             'FOR'.                                               02100012
021100         10  FILLER                  PIC  X(16)    VALUE SPACES.  02110012
021200         10  FILLER                  PIC  X(03)    VALUE          02120012
021300             'LOC'.                                               02130012
021400         10  FILLER                  PIC  X(13)    VALUE SPACES.  02140008
021500         10  FILLER                  PIC  X(04)    VALUE          02150008
021600             'NAME'.                                              02160008
021700         10  FILLER                  PIC  X(17)    VALUE SPACES.  02170014
021800         10  FILLER                  PIC  X(09)    VALUE          02180023
021801             'PERIOD   '.                                         02180123
021810         10  FILLER                  PIC  X(05)    VALUE          02181023
021900             'SET  '.                                             02190010
022000*        10  FILLER                  PIC  X(04)    VALUE          02200023
022100*            'STR '.                                              02210023
022200*        10  FILLER                  PIC  X(02)    VALUE          02220023
022300*            'AD'.                                                02230023
022400*        10  FILLER                  PIC  X(29)    VALUE SPACES.  02240023
022410         10  FILLER                  PIC  X(27)    VALUE SPACES.  02241023
022500         10  FILLER                  PIC  X(04)    VALUE          02250024
022600             ' QTY'.                                              02260024
022700         10  FILLER                  PIC  X(04)    VALUE SPACES.  02270026
022800         10  FILLER                  PIC  X(01)    VALUE          02280008
022900             'S'.                                                 02290008
023000*        10  FILLER                  PIC  X(08)    VALUE SPACES.  02300023
023010         10  FILLER                  PIC  X(06)    VALUE SPACES.  02301026
023100*** PRB0064829 END                                                02310023
023110*                                                                 02311023
023200 01  MISCELLANEOUS-LINES.                                         02320008
023300     05  END-OF-REPORT-LINE.                                      02330008
023400         10  FILLER                  PIC  X(44)    VALUE SPACES.  02340008
023500         10  FILLER                  PIC  X(45)    VALUE          02350008
023600             '*******   E N D   O F   R E P O R T   *******'.     02360008
023700         10  FILLER                  PIC  X(43)    VALUE SPACES.  02370008
023800     05  NO-DATA-TO-REPORT-LINE.                                  02380008
023900         10  FILLER                  PIC  X(40)    VALUE SPACES.  02390008
024000         10  FILLER                  PIC  X(52)    VALUE          02400008
024100         '*******  N O   D A T A   T O   R E P O R T   *******'.  02410008
024200         10  FILLER                  PIC  X(40)    VALUE SPACES.  02420008
024300*                                                                 02430008
024310*** PRB0064829 START                                              02431023
024400 01  DETAIL-LINES.                                                02440008
024500     05  DETAIL-LINE1.                                            02450008
024600         10  DL1-PROCESS-AREA        PIC  X(06)    VALUE SPACES.  02460008
024700*        10  FILLER                  PIC  X(02)    VALUE SPACES.  02470023
024710         10  FILLER                  PIC  X(01)    VALUE SPACES.  02471023
024800         10  DL1-RECEIVED-DATE       PIC  X(10)    VALUE SPACES.  02480008
024900         10  FILLER                  PIC  X(02)    VALUE SPACES.  02490008
025000         10  DL1-OPER-UNIT           PIC  X(04)    VALUE SPACES.  02500008
025100         10  FILLER                  PIC  X(02)    VALUE SPACES.  02510010
025200         10  DL1-PO                  PIC  ZZZZZZZ9  VALUE ZERO.   02520019
025300         10  FILLER                  PIC  X(01)    VALUE SPACES.  02530008
025400*        10  DL1-REC-SEQ             PIC  9(03)    VALUE ZERO.    02540023
025410         10  DL1-REC-SEQ             PIC  9(04)    VALUE ZERO.    02541023
025500         10  FILLER                  PIC  X(01)    VALUE SPACES.  02550008
025600         10  DL1-LINE                PIC  X(05)    VALUE SPACES.  02560008
025700         10  FILLER                  PIC  X(01)    VALUE SPACES.  02570008
025800         10  DL1-VENDOR              PIC  X(25)    VALUE SPACES.  02580008
025900         10  FILLER                  PIC  X(01)    VALUE SPACES.  02590014
026000         10  DL1-DEPT                PIC  X(03)    VALUE SPACES.  02600008
026100*        10  FILLER                  PIC  X(02)    VALUE SPACES.  02610023
026110         10  FILLER                  PIC  X(01)    VALUE SPACES.  02611023
026120         10  DL1-OTB-MM-YY           PIC  X(05)    VALUE SPACES.  02612023
026130         10  FILLER                  PIC  X(01)    VALUE SPACES.  02613023
026140         10  FILLER                  PIC  X(02)    VALUE 'WK'.    02614023
026150         10  DL1-OTB-WK              PIC  9(01)    VALUE ZEROES.  02615023
026160         10  FILLER                  PIC  X(01)    VALUE SPACES.  02616023
026200         10  DL1-SEASN-SET           PIC  X(05)    VALUE SPACES.  02620010
026300*        10  FILLER                  PIC  X(02)    VALUE SPACES.  02630023
026310         10  FILLER                  PIC  X(01)    VALUE SPACES.  02631023
026400*        10  DL1-NEW-STR             PIC  X(01)    VALUE SPACES.  02640023
026500*        10  FILLER                  PIC  X(03)    VALUE SPACES.  02650023
026600*        10  DL1-PIC-AD              PIC  X(01)    VALUE SPACES.  02660023
026700*        10  FILLER                  PIC  X(02)    VALUE SPACES.  02670023
026800         10  DL1-TROUBLE             PIC  X(13)    VALUE SPACES.  02680008
026900         10  FILLER                  PIC  X(02)    VALUE SPACES.  02690008
027000         10  DL1-CARTON-CNT          PIC  ZZZZZZ9  VALUE ZERO.    02700008
027100*        10  FILLER                  PIC  X(04)    VALUE SPACES.  02710023
027110         10  FILLER                  PIC  X(03)    VALUE SPACES.  02711026
027200         10  DL1-PACKSLIP-QTY        PIC  ZZZZZZ9  VALUE ZERO.    02720008
027300         10  FILLER                  PIC  X(01)    VALUE SPACES.  02730008
027400         10  DL1-PACKSLIP-IND        PIC  X(01)    VALUE SPACES.  02740008
027500*        10  FILLER                  PIC  X(01)    VALUE SPACES.  02750023
027510         10  FILLER                  PIC  X(02)    VALUE SPACES.  02751023
027600         10  DL1-LIST-LITERAL        PIC  X(05)    VALUE SPACES.  02760008
027710*** PRB0064829 END                                                02771023
027800                                                                  02780008
027900 01  TOTAL-LINES.                                                 02790008
028000     05  TOTAL-LINE-1.                                            02800008
028010*** PRB0064829 START                                              02801026
028100*        10  FILLER                  PIC  X(87)    VALUE SPACES.  02810026
028110         10  FILLER                  PIC  X(88)    VALUE SPACES.  02811026
028200         10  TL1-PROCESS-TOTAL       PIC  X(16)    VALUE          02820008
028300              'PROCESS TOTAL:  '.                                 02830008
028400         10  TL1-PROCESS-CARTON-QTY  PIC  ZZZZZZZZ9.              02840008
028500*        10  FILLER                  PIC  X(02)    VALUE SPACES.  02850026
028510         10  FILLER                  PIC  X(01)    VALUE SPACES.  02851026
028520*** PRB0064829 END                                                02852026
028600         10  TL1-PROCESS-ITEM-QTY    PIC  ZZZZZZZZ9.              02860008
028700         10  FILLER                  PIC  X(09)    VALUE SPACES.  02870019
028800                                                                  02880008
028900     05  TOTAL-LINE-2.                                            02890008
028910*** PRB0064829 START                                              02891026
029000*        10  FILLER                  PIC  X(89)    VALUE SPACES.  02900026
029010         10  FILLER                  PIC  X(90)    VALUE SPACES.  02901026
029100         10  TL2-GRAND-TOTAL         PIC  X(14)    VALUE          02910008
029200              'GRAND TOTAL:  '.                                   02920008
029300         10  TL2-GRAND-CARTON-QTY    PIC  ZZZZZZZZ9.              02930008
029400*        10  FILLER                  PIC  X(02)    VALUE SPACES.  02940026
029410         10  FILLER                  PIC  X(01)    VALUE SPACES.  02941026
029420*** PRB0064829 END                                                02942026
029500         10  TL2-GRAND-ITEM-QTY      PIC  ZZZZZZZZ9.              02950008
029600         10  FILLER                  PIC  X(09)    VALUE SPACES.  02960019
029700                                                                  02970008
029800*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE LOGISTICS          02980009
029900*  LOCATION TABLE                                                 02990009
030000*  (XLT_LOC)                                                      03000009
030100*                                                                 03010009
030200     EXEC SQL                                                     03020009
030300          INCLUDE XLT00010                                        03030009
030400     END-EXEC.                                                    03040009
030500*                                                                 03050009
030600                                                                  03060009
030700*    DB2 AREA FOR COMMUNICATIONS                                  03070008
030800                                                                  03080008
030900     EXEC SQL                                                     03090008
031000          INCLUDE SQLCA                                           03100008
031100     END-EXEC.                                                    03110008
031200                                                                  03120008
031300*    DB2 AREA FOR COMMUNICATIONS AREA2                            03130008
031400                                                                  03140008
031500     COPY SQLCA2.                                                 03150008
031600                                                                  03160008
031700 PROCEDURE DIVISION.                                              03170008
031800*                                                                 03180008
031900 0000-MAINLINE-PROCESSING.                                        03190008
032000******************************************************************03200008
032100**  THIS IS THE MAIN DRIVER FOR THE PROGRAM.                      03210008
032200******************************************************************03220008
032300     OPEN INPUT  EXTRACT-FILE                                     03230008
032400          OUTPUT PC-COMPLETE-NOT-VERIFIED-RPT.                    03240008
032500*                                                                 03250008
032600     SET PS-FIRST-DETAIL-REC TO TRUE.                             03260008
032700     PERFORM 2200-READ-EXTRACT.                                   03270008
032800     IF PC002-HEADER-RECORD                                       03280008
032900         SET PS-HEADER-ONLY-REC TO TRUE                           03290008
033000     END-IF.                                                      03300008
033100     PERFORM 1000-INITIALIZATION.                                 03310008
033200*                                                                 03320008
033300     PERFORM 2000-PROCESS-EXTRACT                                 03330008
033400         UNTIL PS-END-OF-EXTRACT.                                 03340008
033500*                                                                 03350008
033600     IF PS-NOT-HEADER-ONLY-REC                                    03360008
033700         PERFORM 9000-PROCESS-TOTAL                               03370008
033800         PERFORM 9200-PROCESS-GRAND-TOTAL                         03380008
033900     ELSE                                                         03390008
034000         WRITE PC-COMPLETE-NOT-VERIFIED-REC                       03400008
034100           FROM NO-DATA-TO-REPORT-LINE                            03410008
034200             AFTER ADVANCING 2 LINES                              03420008
034300     END-IF.                                                      03430008
034400                                                                  03440008
034500     WRITE PC-COMPLETE-NOT-VERIFIED-REC                           03450008
034600       FROM END-OF-REPORT-LINE                                    03460008
034700         AFTER ADVANCING 2 LINES.                                 03470008
034800*                                                                 03480008
034900     CLOSE EXTRACT-FILE                                           03490008
035000           PC-COMPLETE-NOT-VERIFIED-RPT.                          03500008
035100*                                                                 03510008
035200     GOBACK.                                                      03520008
035300*                                                                 03530008
035400******************************************************************03540008
035500**  PERFORM THE INITIAL PROCESSING FOR THE PROGRAM.               03550008
035600******************************************************************03560008
035700 1000-INITIALIZATION.                                             03570008
035800     ACCEPT PV-TODAYS-DATE                                        03580008
035900       FROM DATE.                                                 03590008
036000*                                                                 03600008
036100     ACCEPT PV-TODAYS-TIME                                        03610008
036200       FROM TIME.                                                 03620008
036300*                                                                 03630008
036400     MOVE PC-REPORT-NBR          TO DP132O-REPORT-NUMBER.         03640008
036500     MOVE PV-TODAYS-DATE-MM      TO DP132O-RUN-MONTH.             03650008
036600     MOVE PV-TODAYS-DATE-DD      TO DP132O-RUN-DAY.               03660008
036700     MOVE PV-TODAYS-DATE-YY      TO DP132O-RUN-YEAR.              03670008
036800*                                                                 03680008
036900     MOVE PV-TODAYS-TIME-HH      TO DP132O-RUN-HOUR.              03690008
037000     MOVE PV-TODAYS-TIME-MM      TO DP132O-RUN-MINUTE.            03700008
037100     MOVE PC-PCKRP004            TO DP132O-PROGRAM-NAME.          03710008
037200*                                                                 03720008
037300     MOVE PC002-CURRENT-OPER   TO HL1-OPER-UNIT                   03730008
037400                                  PV-SAVE-CURR-OPER.              03740008
037500     MOVE PC002-PROCESS-AREA   TO HL1-PROCESS                     03750008
037600                                  PV-SAVE-PROCESS.                03760008
037700*DMB MOVE PC002-CURRENT-FCLTY  TO HL1-FACILITY                    03770008
037800*DMB  04/01                       PV-SAVE-CURR-FCLTY.             03780008
037900     MOVE PC002-CURRENT-OPER TO PV-CURRENT-OPER.                  03790008
038000*LMM MOVE PV-CURRENT-OPER-3  TO PV-CURRENT-OPER-X-3.              03800016
038100     PERFORM 2300-VALIDATE-OPER-UNIT.                             03810008
038200     IF PS-VALID-DC                                               03820008
038300         PERFORM 8000-WRITE-REPORT-HEADERS                        03830008
038400     END-IF.                                                      03840008
038500                                                                  03850008
038600******************************************************************03860008
038700*  THIS IS THE MAIN CONTROLLING PARAGRAPH FOR PROCESSING THE     *03870008
038800*  PROCESS AREA CURRENT ON HAND REPORT                           *03880008
038900******************************************************************03890008
039000 2000-PROCESS-EXTRACT.                                            03900008
039100     IF (PC002-CURRENT-OPER NOT = PV-SAVE-CURR-OPER)              03910008
039200*DMB IF (PC002-CURRENT-OPER NOT = PV-SAVE-CURR-OPER) OR           03920008
039300*DMB    (PC002-CURRENT-FCLTY NOT = PV-SAVE-CURR-FCLTY)            03930008
039400         MOVE PC002-CURRENT-OPER TO PV-CURRENT-OPER               03940008
039500*        MOVE PV-CURRENT-OPER-3  TO PV-CURRENT-OPER-X-3           03950016
039600         PERFORM 2300-VALIDATE-OPER-UNIT                          03960008
039700         IF PS-VALID-DC                                           03970008
039800             IF  PV-LINE-CNT > PC-55                              03980008
039900                 PERFORM 8000-WRITE-REPORT-HEADERS                03990008
040000             END-IF                                               04000008
040100             IF  PS-NOT-FIRST-DETAIL-REC                          04010008
040200                 IF PS-NOT-HEADER-ONLY-REC                        04020008
040300                     PERFORM 9000-PROCESS-TOTAL                   04030008
040400                     PERFORM 9200-PROCESS-GRAND-TOTAL             04040008
040500                     WRITE PC-COMPLETE-NOT-VERIFIED-REC           04050008
040600                       FROM END-OF-REPORT-LINE                    04060008
040700                         AFTER ADVANCING 2 LINES                  04070008
040800                 ELSE                                             04080008
040900                     WRITE PC-COMPLETE-NOT-VERIFIED-REC           04090008
041000                       FROM NO-DATA-TO-REPORT-LINE                04100008
041100                         AFTER ADVANCING 2 LINES                  04110008
041200                     WRITE PC-COMPLETE-NOT-VERIFIED-REC           04120008
041300                       FROM END-OF-REPORT-LINE                    04130008
041400                         AFTER ADVANCING 2 LINES                  04140008
041500                 END-IF                                           04150008
041600             ELSE                                                 04160008
041700                 IF PS-HEADER-ONLY-REC                            04170008
041800                     WRITE PC-COMPLETE-NOT-VERIFIED-REC           04180008
041900                       FROM NO-DATA-TO-REPORT-LINE                04190008
042000                         AFTER ADVANCING 2 LINES                  04200008
042100                     WRITE PC-COMPLETE-NOT-VERIFIED-REC           04210008
042200                       FROM END-OF-REPORT-LINE                    04220008
042300                         AFTER ADVANCING 2 LINES                  04230008
042400                 END-IF                                           04240008
042500             END-IF                                               04250008
042600             MOVE PC002-CURRENT-OPER   TO HL1-OPER-UNIT           04260008
042700                                          PV-SAVE-CURR-OPER       04270008
042800             MOVE PC002-PROCESS-AREA   TO HL1-PROCESS             04280008
042900                                          PV-SAVE-PROCESS         04290008
043000*DMB 04/01   MOVE PC002-CURRENT-FCLTY  TO HL1-FACILITY            04300008
043100*DMB 04/01                                PV-SAVE-CURR-FCLTY      04310008
043200             MOVE 0                    TO PV-PAGE-CNT             04320008
043300             PERFORM 8000-WRITE-REPORT-HEADERS                    04330008
043400             IF PC002-DETAIL-RECORD                               04340008
043500                 MOVE PC002-PROCESS-AREA TO PV-SAVE-PROCESS       04350008
043600                 PERFORM 2100-WRITE-REPORT                        04360008
043700             END-IF                                               04370008
043800         END-IF                                                   04380008
043900         IF PC002-HEADER-RECORD                                   04390008
044000             SET PS-HEADER-ONLY-REC TO TRUE                       04400008
044100         ELSE                                                     04410008
044200             SET PS-NOT-HEADER-ONLY-REC TO TRUE                   04420008
044300         END-IF                                                   04430008
044400     ELSE                                                         04440008
044500         IF PS-PROCESS-EXTRACT                                    04450008
044600             IF PS-VALID-DC AND                                   04460008
044700                PS-NOT-HEADER-ONLY-REC                            04470008
044800                 PERFORM 2100-WRITE-REPORT                        04480008
044900             ELSE                                                 04490008
045000                 IF PS-PROCESS-EXTRACT                            04500008
045100                     PERFORM 2200-READ-EXTRACT                    04510008
045200                 END-IF                                           04520008
045300             END-IF                                               04530008
045400         END-IF                                                   04540008
045500     END-IF.                                                      04550008
045600                                                                  04560008
045700 2100-WRITE-REPORT.                                               04570008
045800     IF PS-NOT-FIRST-PASS AND                                     04580008
045900        PS-NOT-FIRST-DETAIL-REC                                   04590008
046000         IF  PV-LINE-CNT > PC-55                                  04600008
046100             PERFORM 8000-WRITE-REPORT-HEADERS                    04610008
046200         END-IF                                                   04620008
046300         IF PC002-PROCESS-AREA NOT = PV-SAVE-PROCESS              04630008
046400             PERFORM 9000-PROCESS-TOTAL                           04640008
046500*DMB 04/01                                                        04650008
046600             MOVE PC002-PROCESS-AREA   TO HL1-PROCESS             04660008
046700                                          PV-SAVE-PROCESS         04670008
046800*DMB 04/01                                                        04680008
046900             PERFORM 8000-WRITE-REPORT-HEADERS                    04690008
047000         END-IF                                                   04700008
047100     ELSE                                                         04710008
047200         SET PS-NOT-FIRST-PASS                                    04720008
047300             PS-NOT-FIRST-DETAIL-REC TO TRUE                      04730008
047400     END-IF.                                                      04740008
047500     MOVE PC002-PROCESS-AREA   TO DL1-PROCESS-AREA                04750008
047600                                  PV-SAVE-PROCESS.                04760008
047700     MOVE PC002-PRE-RECEIVED-IND                                  04770008
047800                               TO PV-SAVE-PRE-RECEIVED-IND.       04780008
047900     MOVE PC002-REC-DATE       TO PV-DATE-DDMMYY.                 04790008
048000     MOVE '/'                  TO PV-DATE-SLASH-1.                04800008
048100     MOVE '/'                  TO PV-DATE-SLASH-2.                04810008
048200     MOVE PV-DATE-DDMMYY       TO DL1-RECEIVED-DATE.              04820008
048300     MOVE PC002-LOGICAL-OPER   TO DL1-OPER-UNIT.                  04830008
048400     MOVE PC002-PO-NBR         TO DL1-PO.                         04840008
048500     MOVE PC002-REC-SEQ-NBR    TO DL1-REC-SEQ.                    04850008
048600     MOVE PC002-LNE-LOC-CDE    TO DL1-LINE.                       04860008
048700     MOVE PC002-VNDR-NME       TO DL1-VENDOR.                     04870008
048800     MOVE PC002-DEPT-NBR       TO DL1-DEPT.                       04880008
048900     MOVE PC002-SEASET-NM      TO DL1-SEASN-SET.                  04890011
048910*** PRB0064829 START                                              04891023
049000*    MOVE PC002-NEW-STR-IND    TO DL1-NEW-STR.                    04900023
049100*    MOVE PC002-AD-PICTURE-IND TO DL1-PIC-AD.                     04910023
049110     MOVE PC002-OPEN-TO-BUY-PERIOD                                04911023
049111                               TO DL1-OTB-MM-YY.                  04911123
049120     MOVE PC002-OPEN-TO-BUY-WEEK-NBR                              04912023
049130                               TO DL1-OTB-WK.                     04913023
049140*** PRB0064829 END                                                04914023
049200     STRING PC002-UNRESOLVED-TROUBLE DELIMITED BY SIZE            04920008
049300            PC002-MULTI-TROUBLE DELIMITED BY SIZE                 04930008
049400            ' ' DELIMITED BY SIZE                                 04940008
049500            PC002-LATEST-TROUBLE DELIMITED BY SIZE                04950008
049600            INTO DL1-TROUBLE.                                     04960008
049700     MOVE PC002-CART-CNT       TO DL1-CARTON-CNT.                 04970008
049800     ADD PC002-CART-CNT        TO PV-PROCESS-CARTON-QTY           04980008
049900                                  PV-GRAND-CARTON-QTY.            04990008
050000     MOVE PC002-PKSL-ITM-QTY   TO DL1-PACKSLIP-QTY.               05000008
050100     ADD PC002-PKSL-ITM-QTY    TO PV-PROCESS-ITEM-QTY             05010008
050200                                  PV-GRAND-ITEM-QTY.              05020008
050300     MOVE PC002-PACKSLIP-IND   TO DL1-PACKSLIP-IND.               05030008
050400     IF  PV-LINE-CNT > PC-60                                      05040008
050500         PERFORM 8000-WRITE-REPORT-HEADERS                        05050008
050600     END-IF                                                       05060008
050700     PERFORM 8400-WRITE-DETAIL-LINES                              05070008
050800     PERFORM 2200-READ-EXTRACT.                                   05080008
050900                                                                  05090008
051000 2200-READ-EXTRACT.                                               05100008
051100     READ EXTRACT-FILE INTO PC002-RECEIVER-EXT-RECORD             05110008
051200        AT END                                                    05120008
051300           SET PS-END-OF-EXTRACT TO TRUE.                         05130008
051400                                                                  05140008
051500 2300-VALIDATE-OPER-UNIT.                                         05150008
051600******************************************************************05160009
051700* XLT_LOC (XLT00010)                                              05170017
051800* CALL LOCATION MODULE XLKUT071                                   05180009
051900******************************************************************05190009
052000                                                                  05200009
052100     INITIALIZE XL071-COMMAREA-REC.                               05210009
052200     MOVE PV-CURRENT-OPER            TO XL071-LOCATION-NUMBER.    05220016
052300                                                                  05230009
052400     CALL XL071-LOCATION-MODULE  USING XL071-COMMAREA-REC.        05240018
052500                                                                  05250009
052600        IF XL071-LOC-TYP-CDE = 'DC'                               05260009
052700           SET PS-VALID-DC             TO TRUE                    05270009
052800        ELSE                                                      05280009
052900           SET PS-INVALID-DC           TO TRUE                    05290009
053000        END-IF.                                                   05300013
053100                                                                  05310013
053200*                                                                 05320009
053300                                                                  05330008
053400******************************************************************05340008
053500*  PRINT THE HEADING FOR THE FIRST PAGE OF AN ASN.  SUBSEQUENT   *05350008
053600*  PAGES FOR THE SAME ASN DO NOT REPEAT ALL OF THE HEADING INFO. *05360008
053700******************************************************************05370008
053800 8000-WRITE-REPORT-HEADERS.                                       05380008
053900     PERFORM 8200-WRITE-TOP-LINE.                                 05390008
054000*                                                                 05400008
054100     WRITE PC-COMPLETE-NOT-VERIFIED-REC                           05410008
054200       FROM HEADING-LINE-1                                        05420008
054300         AFTER ADVANCING 2 LINE.                                  05430008
054400*                                                                 05440008
054500     WRITE PC-COMPLETE-NOT-VERIFIED-REC                           05450008
054600       FROM HEADING-LINE-2                                        05460008
054700         AFTER ADVANCING 2 LINES.                                 05470008
054800*                                                                 05480008
054900     WRITE PC-COMPLETE-NOT-VERIFIED-REC                           05490008
055000       FROM HEADING-LINE-3                                        05500008
055100         AFTER ADVANCING 1 LINES.                                 05510008
055200*                                                                 05520008
055300     MOVE PC-6            TO PV-LINE-CNT.                         05530008
055400     MOVE PC-2            TO PV-LINE-SUB.                         05540008
055500*                                                                 05550008
055600*                                                                 05560008
055700******************************************************************05570008
055800*     WRITES HEADER LINES 0 AND 1 WHEN MORE THAN ONE PAGE IS     *05580008
055900*     NEEDED FOR AN ASN NUMBER.                                  *05590008
056000******************************************************************05600008
056100 8200-WRITE-TOP-LINE.                                             05610008
056200     ADD 1                        TO PV-PAGE-CNT.                 05620008
056300*                                                                 05630008
056400     MOVE PV-PAGE-CNT             TO DP132O-PAGE-NUMBER.          05640008
056500*                                                                 05650008
056600     WRITE PC-COMPLETE-NOT-VERIFIED-REC                           05660008
056700       FROM DP132O-STANDRD-HEADER-132-COLS                        05670008
056800         AFTER ADVANCING PAGE.                                    05680008
056900*                                                                 05690008
057000******************************************************************05700008
057100*     WRITES THE DETAIL LINE INFORMATION.                        *05710008
057200******************************************************************05720008
057300 8400-WRITE-DETAIL-LINES.                                         05730008
057400     WRITE PC-COMPLETE-NOT-VERIFIED-REC                           05740008
057500       FROM DETAIL-LINE1                                          05750008
057600         AFTER ADVANCING PV-LINE-SUB LINES.                       05760008
057700*                                                                 05770008
057800     ADD PV-LINE-SUB                 TO PV-LINE-CNT.              05780008
057900     MOVE PC-1                       TO PV-LINE-SUB.              05790008
058000                                                                  05800008
058100******************************************************************05810008
058200*     WRITES THE PROCESS TOTAL LINE                              *05820008
058300******************************************************************05830008
058400 9000-PROCESS-TOTAL.                                              05840008
058500     MOVE PV-PROCESS-CARTON-QTY  TO TL1-PROCESS-CARTON-QTY.       05850008
058600     MOVE PV-PROCESS-ITEM-QTY    TO TL1-PROCESS-ITEM-QTY.         05860008
058700     WRITE PC-COMPLETE-NOT-VERIFIED-REC                           05870008
058800       FROM TOTAL-LINE-1                                          05880008
058900         AFTER ADVANCING 2 LINES.                                 05890008
059000                                                                  05900008
059100     ADD PC-2                        TO PV-LINE-CNT.              05910008
059200     MOVE PC-2                       TO PV-LINE-SUB.              05920008
059300     MOVE ZERO                       TO PV-PROCESS-CARTON-QTY     05930008
059400                                        PV-PROCESS-ITEM-QTY.      05940008
059500                                                                  05950008
059600******************************************************************05960008
059700*     WRITES THE GRAND TOTAL LINE                                *05970008
059800******************************************************************05980008
059900 9200-PROCESS-GRAND-TOTAL.                                        05990008
060000     MOVE PV-GRAND-CARTON-QTY    TO TL2-GRAND-CARTON-QTY.         06000008
060100     MOVE PV-GRAND-ITEM-QTY      TO TL2-GRAND-ITEM-QTY.           06010008
060200     WRITE PC-COMPLETE-NOT-VERIFIED-REC                           06020008
060300       FROM TOTAL-LINE-2                                          06030008
060400         AFTER ADVANCING 2 LINES.                                 06040008
060500                                                                  06050008
060600     ADD PC-2                        TO PV-LINE-CNT.              06060008
060700     MOVE PC-2                       TO PV-LINE-SUB.              06070008
060800     MOVE ZERO                       TO PV-GRAND-CARTON-QTY       06080008
060900                                        PV-GRAND-ITEM-QTY.        06090008
061000******************************************************************06100008
061100*     SQL WARNING OR ERROR PROCESSING                            *06110008
061200******************************************************************06120008
061300 Z999-SQL-ERROR.                                                  06130008
061400     MOVE SQLCODE    TO SQLCODE2.                                 06140008
061500     MOVE SQLERRD(3) TO SQLERRD3.                                 06150008
061600     DISPLAY '** ABEND **       ** = SQLERROR'.                   06160008
061700     DISPLAY '** PROGRAM        ** = PCKRP004'.                   06170008
061800     DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  06180008
061900     DISPLAY '** SQLERRM        ** = ' SQLERRM.                   06190008
062000     DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                  06200008
062100     MOVE +4013 TO PV-ABEND-CODE.                                 06210008
062200     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         06220008
