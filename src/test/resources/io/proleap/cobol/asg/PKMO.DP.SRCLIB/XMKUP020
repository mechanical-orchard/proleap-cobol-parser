      * ------------------------------------------------------------- * 00010000
       IDENTIFICATION DIVISION.                                         00020000
      * ------------------------------------------------------------- * 00030000
       PROGRAM-ID.      XMKUP020.                                       00040000
       AUTHOR.          BOB MCASEY.                                     00050000
       INSTALLATION.    KOHLS DEPARTMENT STORES.                        00060000
       DATE-WRITTEN.    DECEMBER 2002.                                  00070000
                                                                        00080000
      ***************************************************************** 00090000
      *  THIS PROGRAM "GETS" MESSAGES OFF THE MQ SERIES DATA QUEUE FOR* 00100000
      *  RMS ORG HIERARCHY AND UPDATES THE APPROPRIATE DB2 TABLES.    * 00110000
      *  FOR THE MERCHANDISING DOMAIN.                                * 00120000
      ***************************************************************** 00130000
      *---------------------------------------------------------------* 00140000
      *    WR/PITS#     DATE        DESCRIPTION                       * 00150000
      *    --------   ----------   ---------------------------------  * 00160000
      *    WR24442    12/16/2002   INITIAL CREATION.                  * 00170000
      *    WR24442    08/27/2003   CORRECT STORE ATTRIBUTE UPDATE SQL.* 00180073
      *    WR24285    09/19/2003   CORRECT MEDIAN AGE PROCESS         * 00190074
      *    WR25355    12/18/2003   DC TO DC RELATIONSHIP PROCESSING   * 00191082
      *    WR25355    01/21/2004   DC TO DC RELATIONSHIP CORRECTION   * 00192082
0404PK*    WR26600    04/29/2004   ADD 10 CHAR STORE NAME TO XMT_LOC  * 00193093
0519PK*    WR26600    05/19/2004   MAINTAIN 10 CHAR STORE NAME ON     * 00194099
0519PK*                            XMT_LOC FOR OUTLOC LOCATIONS.      * 00195099
0904RM*    WR27051    09/13/2004   COMMENT OUT POS-RGST-BNK-QTY LOGIC * 00196099
0405RM*    PIT752205  04/06/2005   CORRECT ISSUE OF UPDATING CURRENT  * 00197099
0405RM*                            XMT_STR_GP_MBSHP ROW.              * 00198099
0409RM*    WR29166    07/14/2005   ADD PLN_CTG_CDE PROCESSING.        * 00199099
0405RM*    PM00832785 12/19/2005   6830-DELETE-STR-GP-MBSHP ROUTINE   * 00199199
0405RM*                            CHANGE TO REMOVE XMT_STR_GP DELETE.* 00199299
0405RM*    PM00851175 02/16/2006   PAUL KEBER - ALL WAREHOUSE ATTRIBUTE 00199399
0405RM*                            TYPES SHOULD PROCESS DC LOCATION     00199499
0405RM*                            ASSIGNMENTS.                         00199599
0107PK*    PM00973922 01/23/2007   PAUL KEBER - CORRECT THE INSERT CALL 00199699
0107PK*                            FOR XMT_STR_GP_MBSHP.                00199799
0407PK*    PM01003252 04/04/2007   PAUL KEBER - CORRECT THE 6825- UPDATE00199899
0407PK*                            CALL TO INCLUDE EFF_END_DTE.         00199999
0423PK*    WR31384    04/23/2007   MAINTAIN OPEN STORE MONTH AND OPEN   00200099
0423PK*                            STORE YEAR ON XMT_LOC FOR STORES.    00200199
      *---------------------------------------------------------------* 00201000
       ENVIRONMENT DIVISION.                                            00210000
      * ------------------------------------------------------------- * 00220000
                                                                        00230000
       CONFIGURATION SECTION.                                           00240000
                                                                        00250000
       SOURCE-COMPUTER.       IBM-3090.                                 00260000
       OBJECT-COMPUTER.       IBM-3090.                                 00270000
                                                                        00280000
       INPUT-OUTPUT SECTION.                                            00290000
                                                                        00300000
       FILE-CONTROL.                                                    00310000
           SELECT CONTROL-CARD-1   ASSIGN TO INP01.                     00320000
           SELECT CONTROL-CARD-2   ASSIGN TO INP02.                     00330000
           SELECT CONTROL-CARD-3   ASSIGN TO INP03.                     00340000
           SELECT INPUT-FILE       ASSIGN TO INP04.                     00350000
           SELECT AUDIT-FILE       ASSIGN TO OUT01.                     00360000
           SELECT ERROR-FILE       ASSIGN TO OUT02.                     00370000
           SELECT BYPASS-FILE      ASSIGN TO OUT03.                     00380000
                                                                        00390000
      * ------------------------------------------------------------- * 00400000
       DATA DIVISION.                                                   00410000
      * ------------------------------------------------------------- * 00420000
       FILE SECTION.                                                    00430000
                                                                        00440000
       FD  CONTROL-CARD-1                                               00450000
           RECORDING MODE F                                             00460000
           BLOCK CONTAINS 0 RECORDS                                     00470000
           LABEL RECORDS ARE OMITTED.                                   00480000
       01  CONTROL-CARD-1-LINE              PIC  X(80).                 00490000
                                                                        00500000
       FD  CONTROL-CARD-2                                               00510000
           RECORDING MODE F                                             00520000
           BLOCK CONTAINS 0 RECORDS                                     00530000
           LABEL RECORDS ARE OMITTED.                                   00540000
       01  CONTROL-CARD-2-LINE              PIC  X(80).                 00550000
                                                                        00560000
       FD  CONTROL-CARD-3                                               00570000
           RECORDING MODE F                                             00580000
           BLOCK CONTAINS 0 RECORDS                                     00590000
           LABEL RECORDS ARE OMITTED.                                   00600000
       01  CONTROL-CARD-3-LINE              PIC  X(80).                 00610000
                                                                        00620000
       FD  INPUT-FILE                                                   00630000
           RECORDING MODE F                                             00640000
           LABEL RECORDS OMITTED                                        00650000
           BLOCK CONTAINS  0 RECORDS.                                   00660000
       01  INPUT-RECORD                     PIC X(500).                 00670000
                                                                        00680000
       FD  AUDIT-FILE                                                   00690000
           RECORDING MODE F                                             00700000
           LABEL RECORDS OMITTED                                        00710000
           BLOCK CONTAINS  0 RECORDS.                                   00720000
       01  AUDIT-RECORD                     PIC X(500).                 00730000
                                                                        00740000
       FD  ERROR-FILE                                                   00750000
           RECORDING MODE F                                             00760000
           LABEL RECORDS OMITTED                                        00770000
           BLOCK CONTAINS  0 RECORDS.                                   00780000
       01  ERROR-RECORD                     PIC X(500).                 00790000
                                                                        00800000
       FD  BYPASS-FILE                                                  00810000
           RECORDING MODE F                                             00820000
           LABEL RECORDS OMITTED                                        00830000
           BLOCK CONTAINS  0 RECORDS.                                   00840000
       01  BYPASS-RECORD                    PIC X(500).                 00850000
                                                                        00860000
      * ------------------------------------------------------------- * 00870000
       WORKING-STORAGE SECTION.                                         00880000
      * ------------------------------------------------------------- * 00890000
                                                                        00900000
       01  WS-MQCONN                 PIC X(8)  VALUE 'CSQBCONN'.        00910000
       01  WS-MQOPEN                 PIC X(8)  VALUE 'CSQBOPEN'.        00920000
       01  WS-MQINQ                  PIC X(8)  VALUE 'CSQBINQ'.         00930000
       01  WS-MQGET                  PIC X(8)  VALUE 'CSQBGET'.         00940000
       01  WS-MQPUT1                 PIC X(8)  VALUE 'CSQBPUT1'.        00950000
       01  WS-MQBACK                 PIC X(8)  VALUE 'CSQBBACK'.        00960000
       01  WS-MQCMIT                 PIC X(8)  VALUE 'CSQBCOMM'.        00970000
       01  WS-MQCLOSE                PIC X(8)  VALUE 'CSQBCLOS'.        00980000
       01  WS-MQDISC                 PIC X(8)  VALUE 'CSQBDISC'.        00990000
       01  WS-DEAD-LETTER-QUEUE-NAME PIC X(48).                         01000000
                                                                        01010000
      *    API CONTROL BLOCKS                                           01020000
                                                                        01030000
       01  MQM-OBJECT-DESCRIPTOR.                                       01040000
           COPY CMQODV.                                                 01050000
       01  MQM-MESSAGE-DESCRIPTOR.                                      01060000
           COPY CMQMDV.                                                 01070000
       01  MQM-GET-MESSAGE-OPTIONS.                                     01080000
           COPY CMQGMOV.                                                01090000
       01  MQM-PUT-MESSAGE-OPTIONS.                                     01100000
           COPY CMQPMOV.                                                01110000
                                                                        01120000
      *    MQV CONTAINS CONSTANTS (FOR FILLING IN THE CONTROL BLOCKS)   01130000
      *    AND RETURN CODES (FOR TESTING THE RESULT OF A CALL)          01140000
                                                                        01150000
       01  MQM-CONSTANTS.                                               01160000
           COPY CMQV.                                                   01170000
      *                                                                 01180000
      *----------------------------------------------------------------*01190000
      *    CONTROL CARD                                                 01200000
      *----------------------------------------------------------------*01210000
       01  CC-CONTROL-CARD-1.                                           01220000
           05  CC-QMGR-NAME              PIC X(48).                     01230000
           05  FILLER                    PIC X(32).                     01240000
                                                                        01250000
       01  CC-CONTROL-CARD-2.                                           01260000
           05  CC-ORG-HIERARCHY-QNAME    PIC X(48).                     01270000
           05  FILLER                    PIC X(32).                     01280000
                                                                        01290000
       01  CC-CONTROL-CARD-3.                                           01300000
           05  CC-INPUT-SOURCE           PIC X(01).                     01310000
               88  CC-IS-MQ              VALUE 'M'.                     01320000
               88  CC-IS-FILE            VALUE 'F'.                     01330000
           05  FILLER                    PIC X(79).                     01340000
                                                                        01350000
      *----------------------------------------------------------------*01360000
      *    PROGRAM ACCUMULATORS                                         01370000
      *----------------------------------------------------------------*01380000
       01  PA-PROGRAM-ACCUMULATORS.                                     01390000
           05  PA-NUMPUTS                PIC S9(07) BINARY VALUE 0.     01400000
           05  PA-MQGET                  PIC 9(07) VALUE 0.             01410000
           05  PA-READS                  PIC 9(07) VALUE 0.             01420000
           05  PA-AUDITS                 PIC 9(07) VALUE 0.             01430000
           05  PA-ERRORS                 PIC 9(07) VALUE 0.             01440000
           05  PA-BYPASS                 PIC 9(07) VALUE 0.             01450000
           05  PA-STORE-MSGS             PIC 9(07) VALUE 0.             01460000
           05  PA-STORE-INSERTS          PIC 9(07) VALUE 0.             01470000
           05  PA-STORE-UPDATES          PIC 9(07) VALUE 0.             01480000
           05  PA-STORE-DELETES          PIC 9(07) VALUE 0.             01490000
           05  PA-STORE-ERRORS           PIC 9(07) VALUE 0.             01500000
           05  PA-STORE-ATTRIB-MSGS      PIC 9(07) VALUE 0.             01510000
           05  PA-STORE-ATTRIB-INSERTS   PIC 9(07) VALUE 0.             01520000
           05  PA-STORE-ATTRIB-UPDATES   PIC 9(07) VALUE 0.             01530000
           05  PA-STORE-ATTRIB-DELETES   PIC 9(07) VALUE 0.             01540000
           05  PA-STORE-ATTRIB-ERRORS    PIC 9(07) VALUE 0.             01550000
           05  PA-WH-MESSAGES            PIC 9(07) VALUE 0.             01560000
           05  PA-WH-INSERTS             PIC 9(07) VALUE 0.             01570000
           05  PA-WH-UPDATES             PIC 9(07) VALUE 0.             01580000
           05  PA-WH-DELETES             PIC 9(07) VALUE 0.             01590000
           05  PA-WH-ERRORS              PIC 9(07) VALUE 0.             01600000
           05  PA-WH-ATTRIB-MSGS         PIC 9(07) VALUE 0.             01610000
           05  PA-WH-ATTRIB-INSERTS      PIC 9(07) VALUE 0.             01620000
           05  PA-WH-ATTRIB-UPDATES      PIC 9(07) VALUE 0.             01630000
           05  PA-WH-ATTRIB-ERRORS       PIC 9(07) VALUE 0.             01640000
           05  PA-WH-STR-ASSIGN-MSGS     PIC 9(07) VALUE 0.             01650000
           05  PA-WH-STR-ASSIGN-INSERTS  PIC 9(07) VALUE 0.             01660000
           05  PA-WH-STR-ASSIGN-UPDATES  PIC 9(07) VALUE 0.             01670000
           05  PA-WH-STR-ASSIGN-DELETES  PIC 9(07) VALUE 0.             01680000
           05  PA-WH-STR-ASSIGN-ERRORS   PIC 9(07) VALUE 0.             01690000
           05  PA-AREA-MESSAGES          PIC 9(07) VALUE 0.             01700000
           05  PA-AREA-INSERTS           PIC 9(07) VALUE 0.             01710000
           05  PA-AREA-UPDATES           PIC 9(07) VALUE 0.             01720000
           05  PA-AREA-DELETES           PIC 9(07) VALUE 0.             01730000
           05  PA-AREA-ERRORS            PIC 9(07) VALUE 0.             01740000
           05  PA-REGION-MESSAGES        PIC 9(07) VALUE 0.             01750000
           05  PA-REGION-INSERTS         PIC 9(07) VALUE 0.             01760000
           05  PA-REGION-UPDATES         PIC 9(07) VALUE 0.             01770000
           05  PA-REGION-DELETES         PIC 9(07) VALUE 0.             01780000
           05  PA-REGION-ERRORS          PIC 9(07) VALUE 0.             01790000
           05  PA-LOC-ATTR-INSERTS       PIC 9(07) VALUE 0.             01800000
           05  PA-LOC-ATTR-UPDATES       PIC 9(07) VALUE 0.             01810000
           05  PA-LOC-ATTR-DELETES       PIC 9(07) VALUE 0.             01820000
           05  PA-LOC-ATTR-ERRORS        PIC 9(07) VALUE 0.             01830000
           05  PA-DISTRICT-MESSAGES      PIC 9(07) VALUE 0.             01840000
           05  PA-DISTRICT-INSERTS       PIC 9(07) VALUE 0.             01850000
           05  PA-DISTRICT-UPDATES       PIC 9(07) VALUE 0.             01860000
           05  PA-DISTRICT-DELETES       PIC 9(07) VALUE 0.             01870000
           05  PA-DISTRICT-ERRORS        PIC 9(07) VALUE 0.             01880000
           05  PA-OUTLOC-MESSAGES        PIC 9(07) VALUE 0.             01890000
           05  PA-OUTLOC-INSERTS         PIC 9(07) VALUE 0.             01900000
           05  PA-OUTLOC-UPDATES         PIC 9(07) VALUE 0.             01910000
           05  PA-OUTLOC-DELETES         PIC 9(07) VALUE 0.             01920000
           05  PA-OUTLOC-ERRORS          PIC 9(07) VALUE 0.             01930000
           05  PA-STR-GP-MSGS            PIC 9(07) VALUE 0.             01940000
           05  PA-STR-GP-INSERTS         PIC 9(07) VALUE 0.             01950000
           05  PA-STR-GP-UPDATES         PIC 9(07) VALUE 0.             01960000
           05  PA-STR-GP-ERRORS          PIC 9(07) VALUE 0.             01970000
           05  PA-STR-GP-DELETES         PIC 9(07) VALUE 0.             01980000
           05  PA-STR-GP-TYP-MSGS        PIC 9(07) VALUE 0.             01990000
           05  PA-METRO-PRICE-ZONE-MSGS  PIC 9(07) VALUE 0.             02000000
           05  PA-PRICE-ZONE-MSGS        PIC 9(07) VALUE 0.             02010000
           05  PA-STR-GP-TYP-INSERTS     PIC 9(07) VALUE 0.             02020000
           05  PA-STR-GP-TYP-UPDATES     PIC 9(07) VALUE 0.             02030000
           05  PA-STR-GP-TYP-ERRORS      PIC 9(07) VALUE 0.             02040000
           05  PA-STR-GP-TYP-DELETES     PIC 9(07) VALUE 0.             02050000
           05  PA-STR-GP-MBSHP-MSGS      PIC 9(07) VALUE 0.             02060000
           05  PA-STR-GP-MBSHP-INSERTS   PIC 9(07) VALUE 0.             02070000
           05  PA-STR-GP-MBSHP-UPDATES   PIC 9(07) VALUE 0.             02080000
           05  PA-STR-GP-MBSHP-DELETES   PIC 9(07) VALUE 0.             02090000
           05  PA-STR-GP-MBSHP-ERRORS    PIC 9(07) VALUE 0.             02100000
      *----------------------------------------------------------------*02110000
      *    PROGRAM CONSTANTS                                            02120000
      *----------------------------------------------------------------*02130000
       01  PC-PROGRAM-CONSTANTS.                                        02140000
           05  PC-Y                      PIC X(01) VALUE 'Y'.           02150000
           05  PC-DEPT-STR               PIC X(02) VALUE 'DS'.          02160000
           05  PC-DIST-CTR               PIC X(02) VALUE 'DC'.          02170000
           05  PC-ASTERISKS              PIC X(03) VALUE '***'.         02180000
           05  PC-8888                   PIC 9(04)  VALUE 8888.         02190000
           05  PC-9999                   PIC 9(04)  VALUE 9999.         02200000
           05  PC-PGM-NAME               PIC X(09) VALUE 'XMKUP020 '.   02210000
           05  PC-STORE-TABLE            PIC X(30) VALUE                02220000
              'STORE                         '.                         02230000
           05  PC-STORE-ATTRIBUTES-TABLE PIC X(30) VALUE                02240000
              'STORE_ATTRIBUTES              '.                         02250000
           05  PC-AREA-TABLE             PIC X(30) VALUE                02260000
              'AREA                          '.                         02270000
           05  PC-REGION-TABLE           PIC X(30) VALUE                02280000
              'REGION                        '.                         02290000
           05  PC-DISTRICT-TABLE         PIC X(30) VALUE                02300000
              'DISTRICT                      '.                         02310000
           05  PC-OUTLOC-TABLE           PIC X(30) VALUE                02320000
              'OUTLOC                        '.                         02330000
           05  PC-WH-TABLE               PIC X(30) VALUE                02340000
              'WH                            '.                         02350000
           05  PC-WH-ATTRIBUTES-TABLE    PIC X(30) VALUE                02360000
              'WH_ATTRIBUTES                 '.                         02370000
           05  PC-WH-STORE-ASSIGN        PIC X(30) VALUE                02380000
              'WH_STORE_ASSIGN               '.                         02390000
           05  PC-PRICE-ZONE             PIC X(30) VALUE                02400000
              'PRICE_ZONE                    '.                         02410000
           05  PC-PRICE-ZONE-GROUP       PIC X(30) VALUE                02420000
              'PRICE_ZONE_GROUP              '.                         02430000
           05  PC-METRO-PRICE-ZONE-PROMO PIC X(30) VALUE                02440000
              'METRO_PRICE_ZONE_PROMO      '.                           02450000
           05  PC-K-EMT-ZONE-STORE-DATE  PIC X(30) VALUE                02460000
              'K_EMT_ZONE_STORE_DATE         '.                         02470000
           05  PC-K-EMT-METRO-PRICE-ZONE PIC X(30) VALUE                02480000
              'K_EMT_METRO_PRICE_ZONE        '.                         02490000
           05  PC-FIFTY-STARS            PIC X(50)  VALUE ALL '*'.      02500000
           05  PC-ONE                    PIC 9(01)  VALUE 1.            02510000
           05  PC-MAX-RETRIES            PIC 9(04)  VALUE 3 COMP.       02520000
           05  PC-ROW-NOT-FOUND          PIC S9(04) VALUE +100.         02531088
           05  PC-DEADLOCK               PIC S9(04) VALUE -913.         02540000
           05  PC-UNAVAILABLE-RESOURCES  PIC S9(04) VALUE -904.         02550000
           05  PC-DUP-ROW                PIC S9(04) VALUE -803.         02560000
           05  PC-DEFAULT-DATE           PIC X(10)  VALUE               02570000
               '9999-09-09'.                                            02580000
                                                                        02590000
      *----------------------------------------------------------------*02600000
      *    PROGRAM SWITCHES                                             02610000
      *----------------------------------------------------------------*02620000
       01  PS-PROGRAM-SWITCHES.                                         02630000
           05  PS-CONTROL-CARD-1-SW      PIC X(01) VALUE 'N'.           02640000
               88  PS-CONTROL-CARD-1-END           VALUE 'Y'.           02650000
               88  PS-CONTROL-CARD-1-START         VALUE 'N'.           02660000
           05  PS-CONTROL-CARD-2-SW      PIC X(01) VALUE 'N'.           02670000
               88  PS-CONTROL-CARD-2-END           VALUE 'Y'.           02680000
               88  PS-CONTROL-CARD-2-START         VALUE 'N'.           02690000
           05  PS-CONTROL-CARD-3-SW      PIC X(01) VALUE 'N'.           02700000
               88  PS-CONTROL-CARD-3-END           VALUE 'Y'.           02710000
               88  PS-CONTROL-CARD-3-START         VALUE 'N'.           02720000
           05  PS-INPUT-FILE-SW          PIC X(01) VALUE 'N'.           02730000
               88  PS-END-OF-INPUT-FILE            VALUE 'Y'.           02740000
               88  PS-NOT-END-OF-INPUT-FILE        VALUE 'N'.           02750000
           05  PS-MQGET-SUCCESSFUL-SW    PIC X(01) VALUE 'N'.           02760000
               88  PS-MQGET-SUCCESSFUL             VALUE 'Y'.           02770000
           05  PS-INPUT-REC-ERR-SW       PIC X(01) VALUE 'N'.           02780000
               88  PS-NO-INPUT-REC-ERROR           VALUE 'N'.           02790000
               88  PS-INPUT-REC-ERROR              VALUE 'Y'.           02800000
                                                                        02810000
      *----------------------------------------------------------------*02820000
      *    PROGRAM VARIABLES                                            02830000
      *----------------------------------------------------------------*02840000
       01  PV-PROGRAM-VARIABLES.                                        02850000
           05  PV-EFF-END-DTE-NULL-IND    PIC S9(04)  VALUE +0 COMP.    02851099
           05  PV-RETRY-COUNT             PIC S9(03)  VALUE +0 COMP.    02860099
           05  PV-SQL-SUB                 PIC 9(04)   VALUE 0.          02870000
           05  PV-MESSAGE                 PIC X(50).                    02880000
           05  PV-ERROR-MESSAGE           PIC X(48) VALUE SPACES.       02890000
           05  PV-4-COMP-3                PIC S9(04) COMP-3 VALUE 0.    02900000
           05  PV-CURRENT-DATE            PIC X(10) VALUE SPACES.       02910000
           05  PV-DISPLAY-LOC             PIC 9(04) VALUE ZERO.         02911099
                                                                        02920000
       01  PV-MQ-VARIABLES.                                             02930000
           05  PV-QM-NAME              PIC X(48).                       02940000
           05  PV-PARAGRAPH            PIC X(50).                       02950000
           05  PV-MSGBUFFER            PIC X(500) VALUE SPACES.         02960000
           05  PV-LOC-NBR              PIC 9(09)  VALUE 0.              02970000
           05  PV-REPLT-STR-NBR        PIC 9(04)  VALUE 0.              02980000
           05  PV-MSGLENGTH            PIC S9(9)  BINARY VALUE +500.    02990000
           05  PV-DATA-LENGTH          PIC S9(9)  BINARY.               03000000
           05  PV-SELECT-COUNT         PIC S9(9)  BINARY VALUE 1.       03010000
           05  PV-SELECTOR-TABLE.                                       03020000
               10  PV-SELECTOR         PIC S9(9)  BINARY OCCURS 1 TIMES.03030000
           05  PV-INT-ATTR-COUNT       PIC S9(9)  BINARY VALUE 0.       03040000
           05  PV-INT-ATTR-TABLE.                                       03050000
               10  PV-INT-ATTR         PIC S9(9)  BINARY OCCURS 1 TIMES.03060000
           05  PV-CHAR-ATTR-LENGTH     PIC S9(9)  BINARY VALUE 48.      03070000
           05  PV-CHAR-ATTRS           PIC X(48).                       03080000
           05  PV-HCONN                PIC S9(9)  BINARY VALUE 0.       03090000
           05  PV-GQ-HANDLE            PIC S9(9)  BINARY VALUE 0.       03100000
           05  PV-OPEN-OPTIONS         PIC S9(9)  BINARY.               03110000
           05  PV-COMPLETION-CODE      PIC S9(9)  BINARY.               03120000
           05  PV-REASON               PIC S9(9)  BINARY.               03130000
           05  PV-CON-REASON           PIC S9(9)  BINARY.               03140000
           05  PV-ISP-QMGR-NM          PIC X(08).                       03150000
0903RM     05  PV-LOC-MEDN-AGE.                                         03160074
0903RM         10  PV-LOC-MEDN-AGE-NBR-NUM    PIC 9(02).                03170074
0903RM         10  FILLER                     PIC X(01).                03180074
0903RM         10  PV-LOC-MEDN-AGE-NBR-DEC    PIC 9(02).                03190074
0903RM     05  PV-LOC-MEDN-AGE-WHOLE.                                   03200074
0903RM         10  PV-LOC-MEDN-AGE-NBR-1      PIC 9(02).                03210074
0903RM         10  PV-LOC-MEDN-AGE-NBR-2      PIC 9(02).                03220074
0903RM     05  PV-LOC-MEDN-AGE-NBR            PIC 9(02)V99.             03230074
1203RM     05  PV-WHATTR-WH                   PIC X(04).                03231081
1203RM     05  PV-WHATTR-WH-RDF REDEFINES PV-WHATTR-WH                  03232081
1203RM                                        PIC 9(04).                03233081
1203RM     05  PV-WHATTR-DC-NBR               PIC X(04).                03233181
1203RM     05  PV-WHATTR-DC-NBR-RDF REDEFINES PV-WHATTR-DC-NBR          03233281
1203RM                                        PIC 9(04).                03233381
                                                                        03234081
       01  PH-PROGRAM-HOLD-VARIABLES.                                   03272099
           05  PH-COMPLETION-CODE          PIC  S9(09) BINARY.          03273099
           05  PH-REASON                   PIC  S9(09) BINARY.          03274099
                                                                        03280000
      ***************************************************************** 03290000
      *  RMS TO DB2 MQ SERIES COPYBOOK                                  03300000
      ***************************************************************** 03310000
           COPY HORD100.                                                03320000
                                                                        03330000
      *----------------------------------------------------------------*03340000
      *    ABEND CODES                                                  03350000
      *----------------------------------------------------------------*03360000
       01  ABEND-CODE                  PIC S9(4)    VALUE ZEROS         03370000
                                                    COMP SYNC.          03380000
           88  AC-DB2-ERROR                         VALUE +4013.        03390000
           88  AC-MQ-ERROR                          VALUE +4020.        03400000
                                                                        03410000
      * ------------------------------------------------------------- * 03420000
      *  COMMUNICATION AREAS FOR DB2                                    03430000
      * ------------------------------------------------------------- * 03440000
           EXEC SQL                                                     03450000
               INCLUDE SQLCA                                            03460000
           END-EXEC.                                                    03470000
                                                                        03480000
      * ------------------------------------------------------------- * 03490000
      *  ERROR MESSAGE AREA FOR DB2                                   * 03500000
      * ------------------------------------------------------------- * 03510000
           COPY DPWS004.                                                03520000
                                                                        03530000
      * ------------------------------------------------------------- * 03540000
      *  SQL AND COBOL DECLARATIONS FOR THE LOCATION TABLE (XMT_LOC)    03550000
      * ------------------------------------------------------------- * 03560000
                                                                        03570000
           EXEC SQL                                                     03580000
               INCLUDE XMT00001                                         03590000
           END-EXEC.                                                    03600000
                                                                        03610000
      * ------------------------------------------------------------- * 03620000
      *  SQL AND COBOL DECLARATIONS FOR THE DC LOCATION ASSIGNMENT      03630000
      *  TABLE (XMT_DC_LOC_ASGMT)                                       03640000
      * ------------------------------------------------------------- * 03650000
                                                                        03660000
           EXEC SQL                                                     03670000
               INCLUDE XMT00002                                         03680000
           END-EXEC.                                                    03690000
                                                                        03700000
      * ------------------------------------------------------------- * 03710000
      *  SQL AND COBOL DECLARATIONS FOR THE STORE GROUP MEMBERSHIP      03720000
      *  TABLE (XMT_STR_GP_MBSHP)                                       03730000
      * ------------------------------------------------------------- * 03740000
                                                                        03750000
           EXEC SQL                                                     03760000
               INCLUDE XMT00003                                         03770000
           END-EXEC.                                                    03780000
                                                                        03790000
      * ------------------------------------------------------------- * 03800000
      *  SQL AND COBOL DECLARATIONS FOR THE STORE GROUP TABLE           03810000
      *  (XMT_STR_GP)                                                   03820000
      * ------------------------------------------------------------- * 03830000
                                                                        03840000
           EXEC SQL                                                     03850000
               INCLUDE XMT00004                                         03860000
           END-EXEC.                                                    03870000
                                                                        03880000
      * ------------------------------------------------------------- * 03890000
      *  SQL AND COBOL DECLARATIONS FOR THE STORE GROUP TYPE TABLE      03900000
      *  (XMT_STR_GP_TYP)                                               03910000
      * ------------------------------------------------------------- * 03920000
                                                                        03930000
           EXEC SQL                                                     03940000
               INCLUDE XMT00005                                         03950000
           END-EXEC.                                                    03960000
                                                                        03970000
      * ------------------------------------------------------------- * 03980000
      *  SQL AND COBOL DECLARATIONS FOR THE DISTRICT TABLE (XMT_DIST)   03990000
      * ------------------------------------------------------------- * 04000000
                                                                        04010000
           EXEC SQL                                                     04020000
               INCLUDE XMT00006                                         04030000
           END-EXEC.                                                    04040000
                                                                        04050000
      * ------------------------------------------------------------- * 04060000
      *  SQL AND COBOL DECLARATIONS FOR THE REGION TABLE (XMT_REGN)     04070000
      * ------------------------------------------------------------- * 04080000
                                                                        04090000
           EXEC SQL                                                     04100000
               INCLUDE XMT00007                                         04110000
           END-EXEC.                                                    04120000
                                                                        04130000
      * ------------------------------------------------------------- * 04140000
      *  SQL AND COBOL DECLARATIONS FOR TERRITORY TABLE (XMT_TERR)      04150000
      * ------------------------------------------------------------- * 04160000
                                                                        04170000
           EXEC SQL                                                     04180000
               INCLUDE XMT00008                                         04190000
           END-EXEC.                                                    04200000
                                                                        04210000
                                                                        04220000
      * ------------------------------------------------------------- * 04230000
       PROCEDURE DIVISION.                                              04240000
      * ------------------------------------------------------------- * 04250000
       0000-XMKUP020.                                                   04260000
                                                                        04270000
           PERFORM 1000-INITIALIZE.                                     04280000
                                                                        04290000
           IF PS-CONTROL-CARD-1-END                                     04300000
            OR PS-CONTROL-CARD-2-END                                    04310000
            OR PS-CONTROL-CARD-3-END                                    04320000
               CONTINUE                                                 04330000
           ELSE                                                         04340000
               IF CC-IS-MQ                                              04350000
                   PERFORM 2000-PROCESS-MESSAGES UNTIL                  04360000
                     NOT PS-MQGET-SUCCESSFUL                            04370000
               ELSE                                                     04380000
                   PERFORM 2000-PROCESS-MESSAGES UNTIL                  04390000
                     PS-END-OF-INPUT-FILE                               04400000
               END-IF                                                   04410000
           END-IF.                                                      04420000
                                                                        04430000
           PERFORM 2400-EOJ-PROCESSING.                                 04440000
           STOP RUN.                                                    04450000
                                                                        04460000
      *----------------------------------------------------------------*04470000
      *  INITIALIZATION ROUTINE.                                        04480000
      *----------------------------------------------------------------*04490000
       1000-INITIALIZE.                                                 04500000
                                                                        04510000
           SET PS-CONTROL-CARD-1-START TO TRUE.                         04520000
           OPEN INPUT CONTROL-CARD-1                                    04530000
                      CONTROL-CARD-2                                    04540000
                      CONTROL-CARD-3.                                   04550000
           OPEN OUTPUT AUDIT-FILE                                       04560000
                       ERROR-FILE                                       04570000
                       BYPASS-FILE.                                     04580000
                                                                        04590000
           PERFORM 8000-READ-CONTROL-CARD1.                             04600000
                                                                        04610000
           IF PS-CONTROL-CARD-1-END                                     04620000
               DISPLAY PC-PGM-NAME                                      04630000
                    'CONTROL CARD MISSING - FOR QMGR NAME'              04640000
            ELSE                                                        04650000
                DISPLAY PC-PGM-NAME                                     04660000
                        '- '                                            04670000
                        PC-FIFTY-STARS                                  04680000
                DISPLAY PC-PGM-NAME                                     04690000
                        '- CONTROL CARD: '                              04700000
                        CC-CONTROL-CARD-1                               04710000
            END-IF.                                                     04720000
                                                                        04730000
            CLOSE CONTROL-CARD-1.                                       04740000
                                                                        04750000
            PERFORM 8010-READ-CONTROL-CARD2.                            04760000
            IF PS-CONTROL-CARD-2-END                                    04770000
                DISPLAY PC-PGM-NAME                                     04780000
                   'CONTROL CARD MISSING - RMS TO DB2 QUEUE NAME'       04790000
            ELSE                                                        04800000
                DISPLAY PC-PGM-NAME                                     04810000
                        '- '                                            04820000
                        PC-FIFTY-STARS                                  04830000
                DISPLAY PC-PGM-NAME                                     04840000
                        '- CONTROL CARD: '                              04850000
                        CC-CONTROL-CARD-2                               04860000
           END-IF.                                                      04870000
                                                                        04880000
           CLOSE CONTROL-CARD-2.                                        04890000
                                                                        04900000
            PERFORM 8020-READ-CONTROL-CARD3.                            04910000
            IF PS-CONTROL-CARD-3-END                                    04920000
                DISPLAY PC-PGM-NAME                                     04930000
                   'CONTROL CARD MISSING - INPUT SOURCE         '       04940000
            ELSE                                                        04950000
                DISPLAY PC-PGM-NAME                                     04960000
                        '- '                                            04970000
                        PC-FIFTY-STARS                                  04980000
                DISPLAY PC-PGM-NAME                                     04990000
                        '- CONTROL CARD: '                              05000000
                        CC-CONTROL-CARD-3                               05010000
           END-IF.                                                      05020000
                                                                        05030000
           CLOSE CONTROL-CARD-3.                                        05040000
                                                                        05050000
           EXEC SQL                                                     05060000
               SELECT CURRENT DATE                                      05070000
                   INTO :PV-CURRENT-DATE                                05080000
                 FROM SYSIBM.SYSDUMMY1                                  05090000
           END-EXEC.                                                    05100000
                                                                        05110000
           IF PS-CONTROL-CARD-1-END                                     05120000
            OR PS-CONTROL-CARD-2-END                                    05130000
            OR PS-CONTROL-CARD-3-END                                    05140000
               CONTINUE                                                 05150000
           ELSE                                                         05160000
               IF CC-IS-MQ                                              05170000
                   DISPLAY ' SOURCE OF INPUT IS MQ SERIES QUEUE '       05180000
                   PERFORM 1500-MQ-SETUP                                05190000
                   PERFORM 8200-MQGET-MSG                               05200000
               ELSE                                                     05210000
                   IF CC-IS-FILE                                        05220000
                       DISPLAY ' SOURCE OF INPUT IS A FLAT FILE '       05230000
                       OPEN INPUT INPUT-FILE                            05240000
                       PERFORM 8700-READ-INPUT-FILE                     05250000
                   ELSE                                                 05260000
                       DISPLAY PC-PGM-NAME                              05270000
                           'CONTROL CARD 3 INVALID'                     05280000
                   END-IF                                               05290000
               END-IF                                                   05300000
           END-IF.                                                      05310000
                                                                        05320000
                                                                        05330000
                                                                        05340000
      * ------------------------------------------------------------- * 05350000
      *  SETUP MQ VALUES                                                05360000
      * ------------------------------------------------------------- * 05370000
                                                                        05380000
       1500-MQ-SETUP.                                                   05390000
      *    CONNECT TO THE QUEUE MANAGER                                 05400000
                                                                        05410000
           MOVE CC-QMGR-NAME TO PV-QM-NAME.                             05420000
           CALL WS-MQCONN USING PV-QM-NAME                              05430000
                               PV-HCONN                                 05440000
                               PV-COMPLETION-CODE                       05450000
                               PV-REASON.                               05460000
                                                                        05470000
      *    IF CONNECTION FAILED THEN DISPLAY ERROR MESSAGE              05480000
      *    AND EXIT                                                     05490000
                                                                        05500000
           MOVE PV-REASON TO PV-CON-REASON.                             05510000
           IF (PV-COMPLETION-CODE NOT = MQCC-OK) THEN                   05520000
              MOVE 'MQCONN ERROR'   TO PV-ERROR-MESSAGE                 05530000
              PERFORM 9000-DISPLAY-MQ-ERROR                             05540000
           END-IF.                                                      05550000
           DISPLAY 'MQCONN SUCCESSFUL TO ', PV-QM-NAME.                 05560000
                                                                        05570000
      *    OPEN QUEUE MANAGER FOR INQUIRY OF DEAD LETTER QUEUE NAME     05580000
                                                                        05590000
           COMPUTE PV-OPEN-OPTIONS = MQOO-INQUIRE +                     05600000
                                  MQOO-FAIL-IF-QUIESCING.               05610000
           MOVE MQOT-Q-MGR        TO MQOD-OBJECTTYPE.                   05620000
           MOVE PV-QM-NAME        TO MQOD-OBJECTQMGRNAME.               05630000
           MOVE SPACES            TO MQOD-OBJECTNAME.                   05640000
                                                                        05650000
           CALL WS-MQOPEN USING PV-HCONN                                05660000
                               MQM-OBJECT-DESCRIPTOR                    05670000
                               PV-OPEN-OPTIONS                          05680000
                               PV-GQ-HANDLE                             05690000
                               PV-COMPLETION-CODE                       05700000
                               PV-REASON.                               05710000
                                                                        05720000
      *    IF OPEN FAILED THEN DISPLAY ERROR MESSAGE                    05730000
      *    AND EXIT.                                                    05740000
                                                                        05750000
           IF (PV-COMPLETION-CODE NOT = MQCC-OK) THEN                   05760000
              MOVE 'MQOPEN ERROR'   TO PV-ERROR-MESSAGE                 05770000
              PERFORM 8220-DISCONNECT-QMGR                              05780000
              PERFORM 9000-DISPLAY-MQ-ERROR                             05790000
           END-IF.                                                      05800000
           DISPLAY 'MQOPEN SUCCESSFUL - INQUIRE OF QMGR'.               05810000
                                                                        05820000
      *    INQUIRE ON QUEUE MANAGER                                     05830000
                                                                        05840000
           MOVE MQCA-DEAD-LETTER-Q-NAME  TO  PV-SELECTOR(1).            05850000
           CALL WS-MQINQ USING  PV-HCONN,                               05860000
                                PV-GQ-HANDLE,                           05870000
                                PV-SELECT-COUNT,                        05880000
                                PV-SELECTOR-TABLE,                      05890000
                                PV-INT-ATTR-COUNT,                      05900000
                                PV-INT-ATTR-TABLE,                      05910000
                                PV-CHAR-ATTR-LENGTH,                    05920000
                                PV-CHAR-ATTRS,                          05930000
                                PV-COMPLETION-CODE,                     05940000
                                PV-REASON.                              05950000
                                                                        05960000
           IF (PV-COMPLETION-CODE NOT = MQCC-OK) THEN                   05970000
              MOVE 'MQINQ ERROR'   TO PV-ERROR-MESSAGE                  05980000
              PERFORM 9000-DISPLAY-MQ-ERROR                             05990000
           ELSE                                                         06000000
              DISPLAY 'MQINQ SUCCESSFUL, DEAD LETTER Q: ', PV-CHAR-ATTRS06010000
              MOVE PV-CHAR-ATTRS TO WS-DEAD-LETTER-QUEUE-NAME           06020000
           END-IF.                                                      06030000
                                                                        06040000
           CALL WS-MQCLOSE USING PV-HCONN                               06050000
                                PV-GQ-HANDLE                            06060000
                                MQCO-NONE                               06070000
                                PV-COMPLETION-CODE                      06080000
                                PV-REASON.                              06090000
           IF (PV-COMPLETION-CODE NOT = MQCC-OK) THEN                   06100000
              MOVE 'MQCLOSE ERROR'  TO PV-ERROR-MESSAGE                 06110000
              PERFORM 9000-DISPLAY-MQ-ERROR                             06120000
           ELSE                                                         06130000
              DISPLAY 'MQCLOSE SUCCESSFUL - INQUIRE OF QMGR'            06140000
           END-IF.                                                      06150000
                                                                        06160000
      *    OPEN THE RMS ORG HIERCHARCY QUEUE FOR INPUT                  06170000
                                                                        06180000
           COMPUTE PV-OPEN-OPTIONS = MQOO-INPUT-SHARED +                06190000
                                     MQOO-FAIL-IF-QUIESCING.            06200000
           MOVE MQOT-Q                   TO MQOD-OBJECTTYPE.            06210000
           MOVE CC-ORG-HIERARCHY-QNAME   TO MQOD-OBJECTNAME.            06220000
           MOVE PV-QM-NAME               TO MQOD-OBJECTQMGRNAME.        06230000
      *                                                                 06240000
           CALL WS-MQOPEN USING PV-HCONN                                06250000
                               MQM-OBJECT-DESCRIPTOR                    06260000
                               PV-OPEN-OPTIONS                          06270000
                               PV-GQ-HANDLE                             06280000
                               PV-COMPLETION-CODE                       06290000
                               PV-REASON.                               06300000
      *                                                                 06310000
      *    IF OPEN FAILED THEN DISPLAY ERROR MESSAGE                    06320000
      *    AND EXIT.                                                    06330000
      *                                                                 06340000
           IF (PV-COMPLETION-CODE NOT = MQCC-OK) THEN                   06350000
              MOVE 'MQOPEN ERROR'   TO PV-ERROR-MESSAGE                 06360000
              PERFORM 8220-DISCONNECT-QMGR                              06370000
              PERFORM 9000-DISPLAY-MQ-ERROR                             06380000
           END-IF.                                                      06390000
           DISPLAY 'MQOPEN SUCCESSFUL TO ' MQOD-OBJECTNAME.             06400000
                                                                        06410000
                                                                        06420000
      * ------------------------------------------------------------- * 06430000
      *  PROCESS MESSAGES                                               06440000
      * ------------------------------------------------------------- * 06450000
                                                                        06460000
       2000-PROCESS-MESSAGES.                                           06470000
                                                                        06480000
      * ------------------------------------------------------------- * 06490000
      * CHECK INPUT RECORD REPLACING THE '|' WITH ' '.                  06500000
      * CHECK INPUT RECORD REPLACING THE '_' WITH ' '.                  06510000
      * THE | AND _ ARE ILLEGAL IN THE DW SYSTEM.                       06520000
      * ------------------------------------------------------------- * 06530000
      *    DISPLAY 'TABLE NAME ' HO100-RMS-TBL-NAME.                    06540000
           INSPECT HO100-STORE-DATA REPLACING ALL '|' BY ' '.           06550000
           INSPECT HO100-STORE-DATA REPLACING ALL '_' BY ' '.           06560000
                                                                        06570000
           PERFORM 9910-WRITE-AUDIT-RECORD.                             06580000
                                                                        06590000
           SET PS-NO-INPUT-REC-ERROR TO TRUE.                           06600000
                                                                        06610000
           EVALUATE TRUE                                                06620000
              WHEN HO100-RMS-TBL-NAME = PC-AREA-TABLE                   06630000
                 PERFORM 3000-PROCESS-AREA-MESSAGES                     06640000
              WHEN HO100-RMS-TBL-NAME = PC-REGION-TABLE                 06650000
                 PERFORM 4000-PROCESS-REGION-MESSAGES                   06660000
              WHEN HO100-RMS-TBL-NAME = PC-DISTRICT-TABLE               06670000
                 PERFORM 5000-PROCESS-DISTRICT-MESSAGES                 06680000
              WHEN HO100-RMS-TBL-NAME = PC-STORE-TABLE                  06690000
                 PERFORM 6000-PROCESS-STORE                             06700000
              WHEN HO100-RMS-TBL-NAME = PC-STORE-ATTRIBUTES-TABLE       06710000
                 PERFORM 6100-PROCESS-STORE-ATTRIB                      06720000
              WHEN HO100-RMS-TBL-NAME = PC-WH-TABLE                     06730000
                 PERFORM 6200-PROCESS-WH                                06740000
              WHEN HO100-RMS-TBL-NAME = PC-WH-ATTRIBUTES-TABLE          06750000
                 PERFORM 6300-PROCESS-WH-ATTRIB                         06760000
              WHEN HO100-RMS-TBL-NAME = PC-WH-STORE-ASSIGN              06770000
                 PERFORM 6400-PROCESS-WH-STR-ASSIGN                     06780000
              WHEN HO100-RMS-TBL-NAME = PC-OUTLOC-TABLE                 06790000
                 PERFORM 6500-PROCESS-OUTLOC                            06800000
              WHEN HO100-RMS-TBL-NAME = PC-PRICE-ZONE-GROUP             06810000
                 PERFORM 6600-PROCESS-STR-GP-TYP                        06820000
              WHEN HO100-RMS-TBL-NAME = PC-PRICE-ZONE                   06830000
                 PERFORM 6700-PROCESS-STR-GP                            06840000
              WHEN HO100-RMS-TBL-NAME = PC-K-EMT-METRO-PRICE-ZONE       06850000
                 PERFORM 6700-PROCESS-STR-GP                            06860000
              WHEN HO100-RMS-TBL-NAME = PC-K-EMT-ZONE-STORE-DATE        06870000
                 PERFORM 6800-PROCESS-ZONE-STORE-DATE                   06880000
              WHEN OTHER                                                06890000
                   SET PS-INPUT-REC-ERROR TO TRUE                       06900000
                   DISPLAY '@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@'            06910000
                   DISPLAY ' MESSAGE NOT PROCESSED '                    06920000
                             HO100-RMS-TBL-NAME                         06930000
                   PERFORM 9930-WRITE-BYPASS-RECORD                     06940000
           END-EVALUATE.                                                06950000
                                                                        06960000
           IF PS-NO-INPUT-REC-ERROR                                     06970000
               PERFORM 8400-COMMIT-DB2                                  06980000
           ELSE                                                         06990000
               PERFORM 8410-ROLLBACK-DB2                                07000000
           END-IF.                                                      07010000
                                                                        07020000
           IF CC-IS-MQ                                                  07030000
               PERFORM 8450-COMMIT-MQ                                   07040000
               PERFORM 8200-MQGET-MSG                                   07050000
           ELSE                                                         07060000
               PERFORM 8700-READ-INPUT-FILE                             07070000
           END-IF.                                                      07080000
                                                                        07090000
       2400-EOJ-PROCESSING.                                             07100000
                                                                        07110000
           DISPLAY '*-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-*'    07120000
           DISPLAY 'END OF JOB RECORD COUNTERS'.                        07130000
           IF CC-IS-MQ                                                  07140000
               DISPLAY 'SUCCESSFUL MQGETS       ' PA-MQGET              07150000
           ELSE                                                         07160000
               DISPLAY 'SUCCESSFUL FILE READS   ' PA-READS              07170000
           END-IF.                                                      07180000
           DISPLAY 'AUDIT RECORDS WRITTEN   ' PA-AUDITS.                07190000
           DISPLAY 'RECORDS WITH ERRORS     ' PA-ERRORS.                07200000
           DISPLAY 'RECORDS BYPASSED        ' PA-BYPASS.                07210000
           DISPLAY '*-%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%-*'.             07220000
           DISPLAY 'STORE-MESSAGES          ' PA-STORE-MSGS.            07230000
           DISPLAY 'STORE-INSERTS           ' PA-STORE-INSERTS.         07240000
           DISPLAY 'STORE-UPDATES           ' PA-STORE-UPDATES.         07250000
           DISPLAY 'STORE-DELETES           ' PA-STORE-DELETES.         07260000
           DISPLAY 'STORE-ERRORS            ' PA-STORE-ERRORS.          07270000
           DISPLAY 'STORE-ATTRIB-MESGS      ' PA-STORE-ATTRIB-MSGS.     07280000
           DISPLAY 'STORE-ATTRIB-INSERTS    ' PA-STORE-ATTRIB-INSERTS.  07290000
           DISPLAY 'STORE-ATTRIB-UPDATES    ' PA-STORE-ATTRIB-UPDATES.  07300000
           DISPLAY 'STORE-ATTRIB-DELETES    ' PA-STORE-ATTRIB-DELETES.  07310000
           DISPLAY 'STORE-ATTRIB-ERRORS     ' PA-STORE-ATTRIB-ERRORS.   07320000
           DISPLAY 'WH-MESSAGES             ' PA-WH-MESSAGES.           07330000
           DISPLAY 'WH-INSERTS              ' PA-WH-INSERTS.            07340000
           DISPLAY 'WH-UPDATES              ' PA-WH-UPDATES.            07350000
           DISPLAY 'WH-DELETES              ' PA-WH-DELETES.            07360000
           DISPLAY 'WH-ERRORS               ' PA-WH-ERRORS.             07370000
           DISPLAY 'WH-ATTRIB-MESSAGES      ' PA-WH-ATTRIB-MSGS.        07380000
           DISPLAY 'WH-ATTRIB-INSERTS       ' PA-WH-ATTRIB-INSERTS.     07390000
           DISPLAY 'WH-ATTRIB-UPDATES       ' PA-WH-ATTRIB-UPDATES.     07400000
           DISPLAY 'WH-ATTRIB-ERRORS        ' PA-WH-ATTRIB-ERRORS.      07410000
           DISPLAY 'WH-STR-ASSIGN-MSGS      ' PA-WH-STR-ASSIGN-MSGS.    07420000
           DISPLAY 'WH-STR-ASSIGN-INSERTS   ' PA-WH-STR-ASSIGN-INSERTS. 07430000
           DISPLAY 'WH-STR-ASSIGN-UPDATES   ' PA-WH-STR-ASSIGN-UPDATES. 07440000
           DISPLAY 'WH-STR-ASSIGN-DELETES   ' PA-WH-STR-ASSIGN-DELETES. 07450000
           DISPLAY 'WH-STR-ASSIGN-ERRORS    ' PA-WH-STR-ASSIGN-ERRORS.  07460000
           DISPLAY 'AREA-MESSAGES           ' PA-AREA-MESSAGES.         07470000
           DISPLAY 'AREA-INSERTS            ' PA-AREA-INSERTS.          07480000
           DISPLAY 'AREA-UPDATES            ' PA-AREA-UPDATES.          07490000
           DISPLAY 'AREA-DELETES            ' PA-AREA-DELETES.          07500000
           DISPLAY 'AREA-ERRORS             ' PA-AREA-ERRORS.           07510000
           DISPLAY 'REGION-MESSAGES         ' PA-REGION-MESSAGES.       07520000
           DISPLAY 'REGION-INSERTS          ' PA-REGION-INSERTS.        07530000
           DISPLAY 'REGION-UPDATES          ' PA-REGION-UPDATES.        07540000
           DISPLAY 'REGION-DELETES          ' PA-REGION-DELETES.        07550000
           DISPLAY 'REGION-ERRORS           ' PA-REGION-ERRORS.         07560000
           DISPLAY 'DISTRICT-MESSAGES       ' PA-DISTRICT-MESSAGES.     07570000
           DISPLAY 'DISTRICT-INSERTS        ' PA-DISTRICT-INSERTS.      07580000
           DISPLAY 'DISTRICT-UPDATES        ' PA-DISTRICT-UPDATES.      07590000
           DISPLAY 'DISTRICT-DELETES        ' PA-DISTRICT-DELETES.      07600000
           DISPLAY 'DISTRICT-ERRORS         ' PA-DISTRICT-ERRORS.       07610000
           DISPLAY 'OUTLOC-MESSAGES         ' PA-OUTLOC-MESSAGES.       07620000
           DISPLAY 'OUTLOC-INSERTS          ' PA-OUTLOC-INSERTS.        07630000
           DISPLAY 'OUTLOC-UPDATES          ' PA-OUTLOC-UPDATES.        07640000
           DISPLAY 'OUTLOC-DELETES          ' PA-OUTLOC-DELETES.        07650000
           DISPLAY 'OUTLOC-ERRORS           ' PA-OUTLOC-ERRORS.         07660000
           DISPLAY 'STR-GROUP-MSGS          ' PA-STR-GP-MSGS.           07670000
           DISPLAY 'STR-GROUP-INSERTS       ' PA-STR-GP-INSERTS.        07680000
           DISPLAY 'STR-GROUP-UPDATES       ' PA-STR-GP-UPDATES.        07690000
           DISPLAY 'STR-GROUP-DELETES       ' PA-STR-GP-DELETES.        07700000
           DISPLAY 'STR-GROUP-ERRORS        ' PA-STR-GP-ERRORS.         07710000
           DISPLAY 'STR-GROUP-MBSHP MSGS    ' PA-STR-GP-MBSHP-MSGS.     07720000
           DISPLAY 'STR-GROUP-MBSHP INSERTS ' PA-STR-GP-MBSHP-INSERTS.  07730000
           DISPLAY 'STR-GROUP-MBSHP UPDATES ' PA-STR-GP-MBSHP-UPDATES.  07740000
           DISPLAY 'STR-GROUP-MBSHP DELETES ' PA-STR-GP-MBSHP-DELETES.  07750000
           DISPLAY 'STR-GROUP-MBSHP ERRORS  ' PA-STR-GP-MBSHP-ERRORS.   07760000
           DISPLAY 'STR-GROUP-TYP MSGS      ' PA-STR-GP-TYP-MSGS.       07770000
           DISPLAY 'STR-GROUP-TYP INSERTS   ' PA-STR-GP-TYP-INSERTS.    07780000
           DISPLAY 'STR-GROUP-TYP UPDTES    ' PA-STR-GP-TYP-UPDATES.    07790000
           DISPLAY 'STR-GROUP-TYP ERRORS    ' PA-STR-GP-TYP-ERRORS.     07800000
           DISPLAY 'STR-GROUP-TYP DELETES   ' PA-STR-GP-TYP-DELETES.    07810000
           DISPLAY '*-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-*'    07820000
           CLOSE AUDIT-FILE.                                            07830000
           CLOSE ERROR-FILE.                                            07840000
           CLOSE BYPASS-FILE.                                           07850000
           IF CC-IS-MQ                                                  07860000
               PERFORM 8210-CLOSE-QUEUE                                 07870000
               PERFORM 8220-DISCONNECT-QMGR                             07880000
           ELSE                                                         07890000
               CLOSE INPUT-FILE                                         07900000
           END-IF.                                                      07910000
                                                                        07920000
      *-- THIS RETURN CODE WILL GENERATE AN EMAIL IN A SUBSEQUENT       07930000
      *-- STEP IN THE JOB                                               07940000
           IF PA-ERRORS > 0                                             07950000
               MOVE 4095 TO RETURN-CODE                                 07960000
           END-IF.                                                      07970000
                                                                        07980000
      * ------------------------------------------------------------- * 07990000
      * PROCESS THE AREA (TERRITORY) MESSAGES                           08000000
      * ------------------------------------------------------------- * 08010000
       3000-PROCESS-AREA-MESSAGES.                                      08020000
                                                                        08030000
           ADD 1                      TO PA-AREA-MESSAGES.              08040000
           MOVE HO100-AREA-AREA       TO XMT00008-TERR-NBR.             08050000
           MOVE HO100-AREA-NAME       TO XMT00008-TERR-NM.              08060000
           MOVE HO100-AREA-MGR-NAME   TO XMT00008-TERR-MGR-NM.          08070000
                                                                        08080000
           IF HO100-ACTN-TYP-INSERT                                     08090000
               PERFORM 3100-INSERT-TERRITORY-ROW                        08100000
               IF PS-INPUT-REC-ERROR                                    08110000
                   ADD 1 TO PA-AREA-ERRORS                              08120000
               ELSE                                                     08130000
                   ADD 1 TO PA-AREA-INSERTS                             08140000
           ELSE                                                         08150000
               IF HO100-ACTN-TYP-UPDATE                                 08160000
                   PERFORM 3200-UPDATE-TERRITORY-ROW                    08170000
                   IF PS-INPUT-REC-ERROR                                08180000
                       ADD 1 TO PA-AREA-ERRORS                          08190000
                   ELSE                                                 08200000
                       ADD 1 TO PA-AREA-UPDATES                         08210000
               ELSE                                                     08220000
                   IF HO100-ACTN-TYP-DELETE                             08230000
                       PERFORM 3300-DELETE-TERRITORY-ROW                08240000
                       IF PS-INPUT-REC-ERROR                            08250000
                           ADD 1 TO PA-AREA-ERRORS                      08260000
                       ELSE                                             08270000
                           ADD 1 TO PA-AREA-DELETES                     08280000
                       END-IF                                           08290000
                   END-IF                                               08300000
               END-IF                                                   08310000
           END-IF.                                                      08320000
      * ------------------------------------------------------------- * 08330000
      * INSERT THE TERRITORY DATA                                       08340000
      * ------------------------------------------------------------- * 08350000
       3100-INSERT-TERRITORY-ROW.                                       08360000
                                                                        08370000
           MOVE '3100-INSERT-TERRITORY-ROW' TO PV-PARAGRAPH.            08380000
                                                                        08390000
           PERFORM                                                      08400000
               WITH TEST AFTER                                          08410000
               VARYING PV-SQL-SUB                                       08420000
               FROM 1 BY 1                                              08430000
               UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        08440000
                  OR SQLCODE = 0                                        08450000
                  OR PS-INPUT-REC-ERROR                                 08460000
                                                                        08470000
                 EXEC SQL                                               08480000
                     INSERT INTO XMT_TERR                               08490000
                         (TERR_NBR                                      08500000
                        , TERR_NM                                       08510000
                        , TERR_MGR_NM )                                 08520000
                     VALUES (: XMT00008-TERR-NBR                        08530000
                           , : XMT00008-TERR-NM                         08540000
                           , : XMT00008-TERR-MGR-NM )                   08550000
                 END-EXEC                                               08560000
                                                                        08570000
               EVALUATE TRUE                                            08580000
                   WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              08590000
                   WHEN SQLCODE = PC-DEADLOCK                           08600000
                   WHEN SQLCODE = ZERO                                  08610000
                        CONTINUE                                        08620000
                   WHEN SQLWARN0 NOT = SPACE                            08630000
                   WHEN SQLCODE NOT =  ZERO                             08640000
                       MOVE 'BAD SQLCODE FOR INSERT TERRITORY'          08650000
                                     TO  PV-MESSAGE                     08660000
                       PERFORM 9900-PROCESS-DB2-ERROR                   08670000
                       SET PS-INPUT-REC-ERROR TO TRUE                   08680000
               END-EVALUATE                                             08690000
           END-PERFORM.                                                 08700000
                                                                        08710000
           IF PV-SQL-SUB > PC-MAX-RETRIES                               08720000
               MOVE  'MAX RETRIES EXCEEDED FOR INSERT TERRITORY'        08730000
                      TO PV-MESSAGE                                     08740000
               PERFORM 9900-PROCESS-DB2-ERROR                           08750000
               SET PS-INPUT-REC-ERROR TO TRUE                           08760000
           END-IF.                                                      08770000
                                                                        08780000
                                                                        08790000
      * ------------------------------------------------------------- * 08800000
      * UPDATE THE TERRITORY DATA                                       08810000
      * ------------------------------------------------------------- * 08820000
       3200-UPDATE-TERRITORY-ROW.                                       08830000
                                                                        08840000
           MOVE '3200-UPDATE-TERRITORY-ROW' TO  PV-PARAGRAPH.           08850000
                                                                        08860000
           PERFORM                                                      08870000
               WITH TEST AFTER                                          08880000
               VARYING PV-SQL-SUB                                       08890000
               FROM 1 BY 1                                              08900000
               UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        08910000
                  OR SQLCODE = 0                                        08920000
                  OR SQLCODE = PC-ROW-NOT-FOUND                         08930000
                  OR PS-INPUT-REC-ERROR                                 08940000
                                                                        08950000
                 EXEC SQL                                               08960000
                     UPDATE XMT_TERR                                    08970000
                     SET TERR_NM     = : XMT00008-TERR-NM               08980000
                       , TERR_MGR_NM = : XMT00008-TERR-MGR-NM           08990000
                     WHERE TERR_NBR  = : XMT00008-TERR-NBR              09000000
                 END-EXEC                                               09010000
                                                                        09020000
               EVALUATE TRUE                                            09030000
                   WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              09040000
                   WHEN SQLCODE = PC-DEADLOCK                           09050000
                   WHEN SQLCODE = PC-ROW-NOT-FOUND                      09060000
                   WHEN SQLCODE = ZERO                                  09070000
                        CONTINUE                                        09080000
                   WHEN SQLWARN0 NOT = SPACE                            09090000
                   WHEN SQLCODE NOT = ZERO                              09100000
                       MOVE 'BAD SQLCODE FOR UPDATE TERRITORY'          09110000
                                     TO  PV-MESSAGE                     09120000
                       PERFORM 9900-PROCESS-DB2-ERROR                   09130000
                       SET PS-INPUT-REC-ERROR TO TRUE                   09140000
               END-EVALUATE                                             09150000
           END-PERFORM.                                                 09160000
                                                                        09170000
           IF  PV-SQL-SUB > PC-MAX-RETRIES                              09180000
               MOVE 'MAX RETRIES EXCEEDED FOR UPDATE TERRITORY'         09190000
                                     TO  PV-MESSAGE                     09200000
               PERFORM 9900-PROCESS-DB2-ERROR                           09210000
               SET PS-INPUT-REC-ERROR TO TRUE                           09220000
           END-IF.                                                      09230000
                                                                        09240000
           IF SQLCODE = PC-ROW-NOT-FOUND                                09250000
               MOVE 'TERRITORY ROW NOT FOUND FOR UPDATE'                09260000
                                     TO  PV-MESSAGE                     09270000
               PERFORM 9900-PROCESS-DB2-ERROR                           09280000
           END-IF.                                                      09290000
                                                                        09300000
      * ------------------------------------------------------------- * 09310000
      * DELETE THE TERRITORY DATA                                       09320000
      * ------------------------------------------------------------- * 09330000
       3300-DELETE-TERRITORY-ROW.                                       09340000
                                                                        09350000
           MOVE '3300-DELETE-TERRITORY-ROW' TO  PV-PARAGRAPH.           09360000
                                                                        09370000
           PERFORM                                                      09380000
               WITH TEST AFTER                                          09390000
               VARYING PV-SQL-SUB                                       09400000
               FROM 1 BY 1                                              09410000
               UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        09420000
                  OR SQLCODE = 0                                        09430000
                  OR SQLCODE = PC-ROW-NOT-FOUND                         09440000
                  OR PS-INPUT-REC-ERROR                                 09450000
                                                                        09460000
                 EXEC SQL                                               09470000
                     DELETE FROM XMT_TERR                               09480000
                     WHERE TERR_NBR   = : XMT00008-TERR-NBR             09490000
                 END-EXEC                                               09500000
                                                                        09510000
               EVALUATE TRUE                                            09520000
                   WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              09530000
                   WHEN SQLCODE = PC-DEADLOCK                           09540000
                   WHEN SQLCODE = PC-ROW-NOT-FOUND                      09550000
                   WHEN SQLCODE = ZERO                                  09560000
                        CONTINUE                                        09570000
                   WHEN SQLWARN0 NOT = SPACE                            09580000
                   WHEN SQLCODE NOT = ZERO                              09590000
                       MOVE 'BAD SQLCODE FOR DELETE TERRITORY'          09600000
                                     TO  PV-MESSAGE                     09610000
                       PERFORM 9900-PROCESS-DB2-ERROR                   09620000
                       SET PS-INPUT-REC-ERROR TO TRUE                   09630000
               END-EVALUATE                                             09640000
           END-PERFORM.                                                 09650000
                                                                        09660000
           IF  PV-SQL-SUB > PC-MAX-RETRIES                              09670000
               MOVE 'MAX RETRIES EXCEEDED FOR DELETE TERRITORY'         09680000
                                     TO  PV-MESSAGE                     09690000
               PERFORM 9900-PROCESS-DB2-ERROR                           09700000
               SET PS-INPUT-REC-ERROR TO TRUE                           09710000
           END-IF.                                                      09720000
                                                                        09730000
           IF SQLCODE = PC-ROW-NOT-FOUND                                09740000
               MOVE 'TERRITORY ROW NOT FOUND FOR DELETE'                09750000
                                     TO  PV-MESSAGE                     09760000
               PERFORM 9900-PROCESS-DB2-ERROR                           09770000
           END-IF.                                                      09780000
                                                                        09790000
      * ------------------------------------------------------------- * 09800000
      * PROCESS THE REGION MESSAGES                                     09810000
      * ------------------------------------------------------------- * 09820000
       4000-PROCESS-REGION-MESSAGES.                                    09830000
                                                                        09840000
           ADD 1                        TO  PA-REGION-MESSAGES.         09850000
           MOVE HO100-REGION            TO  XMT00007-REGN-NBR           09860000
           MOVE HO100-REGION-AREA       TO  XMT00007-TERR-NBR           09870000
           MOVE HO100-REGION-AREA-NAME  TO  XMT00007-REGN-NM.           09880000
           MOVE HO100-REGION-MGR-NAME   TO  XMT00007-REGN-MGR-NM.       09890000
                                                                        09900000
           IF HO100-ACTN-TYP-INSERT                                     09910000
               PERFORM 4100-INSERT-REGION-ROW                           09920000
               IF PS-INPUT-REC-ERROR                                    09930000
                   ADD 1 TO PA-REGION-ERRORS                            09940000
               ELSE                                                     09950000
                   ADD 1 TO PA-REGION-INSERTS                           09960000
               END-IF                                                   09970000
           ELSE                                                         09980000
               IF HO100-ACTN-TYP-UPDATE                                 09990000
                   PERFORM 4200-UPDATE-REGION-ROW                       10000000
                   IF PS-INPUT-REC-ERROR                                10010000
                       ADD 1 TO PA-REGION-ERRORS                        10020000
                   ELSE                                                 10030000
                       ADD 1 TO PA-REGION-UPDATES                       10040000
                   END-IF                                               10050000
               ELSE                                                     10060000
                   IF HO100-ACTN-TYP-DELETE                             10070000
                       PERFORM 4300-DELETE-REGION-ROW                   10080000
                       IF PS-INPUT-REC-ERROR                            10090000
                           ADD 1 TO PA-REGION-ERRORS                    10100000
                       ELSE                                             10110000
                           ADD 1 TO PA-REGION-DELETES                   10120000
                       END-IF                                           10130000
                   END-IF                                               10140000
               END-IF                                                   10150000
           END-IF.                                                      10160000
      * ------------------------------------------------------------- * 10170000
      * INSERT THE REGION DATA                                          10180000
      * ------------------------------------------------------------- * 10190000
       4100-INSERT-REGION-ROW.                                          10200000
                                                                        10210000
           MOVE '4100-INSERT-REGION-ROW' TO  PV-PARAGRAPH.              10220000
                                                                        10230000
           PERFORM                                                      10240000
               WITH TEST AFTER                                          10250000
               VARYING PV-SQL-SUB                                       10260000
               FROM 1 BY 1                                              10270000
               UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        10280000
                  OR SQLCODE = 0                                        10290000
                  OR PS-INPUT-REC-ERROR                                 10300000
                                                                        10310000
                 EXEC SQL                                               10320000
                     INSERT INTO XMT_REGN                               10330000
                              (REGN_NBR                                 10340000
                             , REGN_NM                                  10350000
                             , TERR_NBR                                 10360000
                             , REGN_MGR_NM)                             10370000
                     VALUES (:XMT00007-REGN-NBR                         10380000
                           , :XMT00007-REGN-NM                          10390000
                           , :XMT00007-TERR-NBR                         10400000
                           , :XMT00007-REGN-MGR-NM)                     10410000
                 END-EXEC                                               10420000
                                                                        10430000
               EVALUATE TRUE                                            10440000
                   WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              10450000
                   WHEN SQLCODE = PC-DEADLOCK                           10460000
                   WHEN SQLCODE = ZERO                                  10470000
                        CONTINUE                                        10480000
                   WHEN SQLWARN0 NOT = SPACE                            10490000
                   WHEN SQLCODE NOT = ZERO                              10500000
                       MOVE 'BAD SQLCODE FOR INSERT REGION'             10510000
                                     TO  PV-MESSAGE                     10520000
                       PERFORM 9900-PROCESS-DB2-ERROR                   10530000
                       SET PS-INPUT-REC-ERROR TO TRUE                   10540000
               END-EVALUATE                                             10550000
           END-PERFORM.                                                 10560000
                                                                        10570000
           IF  PV-SQL-SUB > PC-MAX-RETRIES                              10580000
               MOVE 'MAX RETRIES EXCEEDED FOR INSERT REGION'            10590000
                                     TO  PV-MESSAGE                     10600000
               PERFORM 9900-PROCESS-DB2-ERROR                           10610000
               SET PS-INPUT-REC-ERROR TO TRUE                           10620000
           END-IF.                                                      10630000
                                                                        10640000
      * ------------------------------------------------------------- * 10650000
      * UPDATE THE REGION DATA                                          10660000
      * ------------------------------------------------------------- * 10670000
       4200-UPDATE-REGION-ROW.                                          10680000
                                                                        10690000
           MOVE '4200-UPDATE-REGION-ROW' TO  PV-PARAGRAPH.              10700000
                                                                        10710000
           PERFORM                                                      10720000
               WITH TEST AFTER                                          10730000
               VARYING PV-SQL-SUB                                       10740000
               FROM 1 BY 1                                              10750000
               UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        10760000
                  OR SQLCODE = 0                                        10770000
                  OR SQLCODE = PC-ROW-NOT-FOUND                         10780000
                  OR PS-INPUT-REC-ERROR                                 10790000
                                                                        10800000
                 EXEC SQL                                               10810000
                     UPDATE XMT_REGN                                    10820000
                     SET REGN_NM       = :XMT00007-REGN-NM              10830000
                       , TERR_NBR      = :XMT00007-TERR-NBR             10840000
                       , REGN_MGR_NM   = :XMT00007-REGN-MGR-NM          10850000
                     WHERE (REGN_NBR   = :XMT00007-REGN-NBR)            10860000
                 END-EXEC                                               10870000
                                                                        10880000
               EVALUATE TRUE                                            10890000
                   WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              10900000
                   WHEN SQLCODE = PC-DEADLOCK                           10910000
                   WHEN SQLCODE = PC-ROW-NOT-FOUND                      10920000
                   WHEN SQLCODE = ZERO                                  10930000
                        CONTINUE                                        10940000
                   WHEN SQLWARN0 NOT = SPACE                            10950000
                   WHEN SQLCODE NOT = ZERO                              10960000
                       MOVE 'BAD SQLCODE FOR UPDATE REGION'             10970000
                                     TO  PV-MESSAGE                     10980000
                       PERFORM 9900-PROCESS-DB2-ERROR                   10990000
                       SET PS-INPUT-REC-ERROR TO TRUE                   11000000
               END-EVALUATE                                             11010000
           END-PERFORM.                                                 11020000
                                                                        11030000
           IF  PV-SQL-SUB > PC-MAX-RETRIES                              11040000
               MOVE 'MAX RETRIES EXCEEDED FOR UPDATE REGION'            11050000
                                     TO  PV-MESSAGE                     11060000
               PERFORM 9900-PROCESS-DB2-ERROR                           11070000
               SET PS-INPUT-REC-ERROR TO TRUE                           11080000
           END-IF.                                                      11090000
                                                                        11100000
           IF SQLCODE = PC-ROW-NOT-FOUND                                11110000
               MOVE 'REGION ROW NOT FOUND FOR UPDATE'                   11120000
                                     TO  PV-MESSAGE                     11130000
               PERFORM 9900-PROCESS-DB2-ERROR                           11140000
           END-IF.                                                      11150000
                                                                        11160000
      * ------------------------------------------------------------- * 11170000
      * DELETE THE REGION DATA                                          11180000
      * ------------------------------------------------------------- * 11190000
       4300-DELETE-REGION-ROW.                                          11200000
                                                                        11210000
           MOVE '4300-DELETE-REGION-ROW' TO  PV-PARAGRAPH.              11220000
                                                                        11230000
           PERFORM                                                      11240000
               WITH TEST AFTER                                          11250000
               VARYING PV-SQL-SUB                                       11260000
               FROM 1 BY 1                                              11270000
               UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        11280000
                  OR SQLCODE = 0                                        11290000
                  OR SQLCODE = PC-ROW-NOT-FOUND                         11300000
                  OR PS-INPUT-REC-ERROR                                 11310000
                                                                        11320000
                 EXEC SQL                                               11330000
                     DELETE FROM XMT_REGN                               11340000
                     WHERE REGN_NBR   = : XMT00007-REGN-NBR             11350000
                 END-EXEC                                               11360000
                                                                        11370000
               EVALUATE TRUE                                            11380000
                   WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              11390000
                   WHEN SQLCODE = PC-DEADLOCK                           11400000
                   WHEN SQLCODE = ZERO                                  11410000
                        CONTINUE                                        11420000
                   WHEN SQLWARN0 NOT = SPACE                            11430000
                   WHEN SQLCODE NOT = ZERO                              11440000
                       MOVE 'BAD SQLCODE FOR DELETE REGION'             11450000
                                     TO  PV-MESSAGE                     11460000
                       PERFORM 9900-PROCESS-DB2-ERROR                   11470000
                       SET PS-INPUT-REC-ERROR TO TRUE                   11480000
               END-EVALUATE                                             11490000
           END-PERFORM.                                                 11500000
                                                                        11510000
           IF  PV-SQL-SUB > PC-MAX-RETRIES                              11520000
               MOVE 'MAX RETRIES EXCEEDED FOR DELETE REGION'            11530000
                                     TO  PV-MESSAGE                     11540000
               PERFORM 9900-PROCESS-DB2-ERROR                           11550000
               SET PS-INPUT-REC-ERROR TO TRUE                           11560000
           END-IF.                                                      11570000
                                                                        11580000
           IF SQLCODE = PC-ROW-NOT-FOUND                                11590000
               MOVE 'REGION ROW NOT FOUND FOR DELETE'                   11600000
                                     TO  PV-MESSAGE                     11610000
               PERFORM 9900-PROCESS-DB2-ERROR                           11620000
           END-IF.                                                      11630000
                                                                        11640000
                                                                        11650000
      * ------------------------------------------------------------- * 11660000
      * PROCESS THE DISTRICT MESSAGES                                   11670000
      * ------------------------------------------------------------- * 11680000
       5000-PROCESS-DISTRICT-MESSAGES.                                  11690000
                                                                        11700000
           ADD 1 TO PA-DISTRICT-MESSAGES                                11710000
           MOVE HO100-DISTRICT           TO XMT00006-DIST-NBR           11720000
           MOVE HO100-DISTRICT-REGION    TO XMT00006-REGN-NBR.          11730000
           MOVE HO100-DISTRICT-AREA-NAME TO XMT00006-DIST-NM.           11740000
           MOVE HO100-DISTRICT-MGR-NAME  TO XMT00006-DIST-MGR-NM.       11750000
                                                                        11760000
           IF HO100-ACTN-TYP-INSERT                                     11770000
               PERFORM 5100-INSERT-DISTRICT-ROW                         11780000
               IF PS-INPUT-REC-ERROR                                    11790000
                   ADD 1 TO PA-DISTRICT-ERRORS                          11800000
               ELSE                                                     11810000
                   ADD 1 TO PA-DISTRICT-INSERTS                         11820000
               END-IF                                                   11830000
           ELSE                                                         11840000
               IF HO100-ACTN-TYP-UPDATE                                 11850000
                   PERFORM 5200-UPDATE-DISTRICT-ROW                     11860000
                   IF PS-INPUT-REC-ERROR                                11870000
                       ADD 1 TO PA-DISTRICT-ERRORS                      11880000
                   ELSE                                                 11890000
                       ADD 1 TO PA-DISTRICT-UPDATES                     11900000
                   END-IF                                               11910000
               ELSE                                                     11920000
                   IF HO100-ACTN-TYP-DELETE                             11930000
                       PERFORM 5300-DELETE-DISTRICT-ROW                 11940000
                       IF PS-INPUT-REC-ERROR                            11950000
                           ADD 1 TO PA-DISTRICT-ERRORS                  11960000
                       ELSE                                             11970000
                           ADD 1 TO PA-DISTRICT-DELETES                 11980000
                       END-IF                                           11990000
                   END-IF                                               12000000
               END-IF                                                   12010000
           END-IF.                                                      12020000
                                                                        12030000
      * ------------------------------------------------------------- * 12040000
      * INSERT THE DISTRICT ROW                                         12050000
      * ------------------------------------------------------------- * 12060000
       5100-INSERT-DISTRICT-ROW.                                        12070000
                                                                        12080000
           MOVE '5100-INSERT-DISTRICT-ROW' TO  PV-PARAGRAPH.            12090000
                                                                        12100000
           PERFORM                                                      12110000
               WITH TEST AFTER                                          12120000
               VARYING PV-SQL-SUB                                       12130000
               FROM 1 BY 1                                              12140000
               UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        12150000
                  OR SQLCODE = 0                                        12160000
                  OR PS-INPUT-REC-ERROR                                 12170000
                                                                        12180000
                 EXEC SQL                                               12190000
                     INSERT INTO XMT_DIST                               12200000
                             ( DIST_NBR                                 12210000
                             , DIST_NM                                  12220000
                             , REGN_NBR                                 12230000
                             , DIST_MGR_NM)                             12240000
                     VALUES                                             12250000
                           ( :XMT00006-DIST-NBR                         12260000
                           , :XMT00006-DIST-NM                          12270000
                           , :XMT00006-REGN-NBR                         12280000
                           , :XMT00006-DIST-MGR-NM)                     12290000
                 END-EXEC                                               12300000
                                                                        12310000
               EVALUATE TRUE                                            12320000
                   WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              12330000
                   WHEN SQLCODE = PC-DEADLOCK                           12340000
                   WHEN SQLCODE = ZERO                                  12350000
                        CONTINUE                                        12360000
                   WHEN SQLWARN0 NOT = SPACE                            12370000
                   WHEN SQLCODE NOT = ZERO                              12380000
                       MOVE 'BAD SQLCODE FOR INSERT DISTRICT'           12390000
                                     TO  PV-MESSAGE                     12400000
                       PERFORM 9900-PROCESS-DB2-ERROR                   12410000
                       SET PS-INPUT-REC-ERROR TO TRUE                   12420000
               END-EVALUATE                                             12430000
           END-PERFORM.                                                 12440000
                                                                        12450000
           IF  PV-SQL-SUB > PC-MAX-RETRIES                              12460000
               MOVE 'MAX RETRIES EXCEEDED FOR INSERT DISTRICT'          12470000
                                     TO  PV-MESSAGE                     12480000
               PERFORM 9900-PROCESS-DB2-ERROR                           12490000
               SET PS-INPUT-REC-ERROR TO TRUE                           12500000
           END-IF.                                                      12510000
                                                                        12520000
      * ------------------------------------------------------------- * 12530000
      * UPDATE THE DISTRICT DATA                                        12540000
      * ------------------------------------------------------------- * 12550000
       5200-UPDATE-DISTRICT-ROW.                                        12560000
                                                                        12570000
           MOVE '5200-UPDATE-DISTRICT-ROW' TO PV-PARAGRAPH.             12580000
                                                                        12590000
           PERFORM                                                      12600000
               WITH TEST AFTER                                          12610000
               VARYING PV-SQL-SUB                                       12620000
               FROM 1 BY 1                                              12630000
               UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        12640000
                  OR SQLCODE = 0                                        12650000
                  OR SQLCODE = PC-ROW-NOT-FOUND                         12660000
                  OR PS-INPUT-REC-ERROR                                 12670000
                                                                        12680000
                 EXEC SQL                                               12690000
                     UPDATE XMT_DIST                                    12700000
                     SET DIST_NM       = :XMT00006-DIST-NM              12710000
                       , REGN_NBR      = :XMT00006-REGN-NBR             12720000
                       , DIST_MGR_NM   = :XMT00006-DIST-MGR-NM          12730000
                     WHERE  DIST_NBR   = :XMT00006-DIST-NBR             12740000
                 END-EXEC                                               12750000
                                                                        12760000
               EVALUATE TRUE                                            12770000
                   WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              12780000
                   WHEN SQLCODE = PC-DEADLOCK                           12790000
                   WHEN SQLCODE = PC-ROW-NOT-FOUND                      12800000
                   WHEN SQLCODE = ZERO                                  12810000
                        CONTINUE                                        12820000
                   WHEN SQLWARN0 NOT = SPACE                            12830000
                   WHEN SQLCODE NOT = ZERO                              12840000
                       MOVE 'BAD SQLCODE FOR UPDATE DISTRICT'           12850000
                                     TO  PV-MESSAGE                     12860000
                       PERFORM 9900-PROCESS-DB2-ERROR                   12870000
                       SET PS-INPUT-REC-ERROR TO TRUE                   12880000
               END-EVALUATE                                             12890000
           END-PERFORM.                                                 12900000
                                                                        12910000
           IF  PV-SQL-SUB > PC-MAX-RETRIES                              12920000
               MOVE 'MAX RETRIES EXCEEDED FOR UPDATE DISTRICT'          12930000
                                     TO  PV-MESSAGE                     12940000
               PERFORM 9900-PROCESS-DB2-ERROR                           12950000
               SET PS-INPUT-REC-ERROR TO TRUE                           12960000
           END-IF.                                                      12970000
                                                                        12980000
           IF SQLCODE = PC-ROW-NOT-FOUND                                12990000
               MOVE 'DISTRICT ROW NOT FOUND FOR UPDATE'                 13000000
                                     TO  PV-MESSAGE                     13010000
               PERFORM 9900-PROCESS-DB2-ERROR                           13020000
           END-IF.                                                      13030000
                                                                        13040000
      * ------------------------------------------------------------- * 13050000
      * DELETE THE DISTRICT ROW                                         13060000
      * ------------------------------------------------------------- * 13070000
       5300-DELETE-DISTRICT-ROW.                                        13080000
                                                                        13090000
           MOVE '5300-DELETE-DISTRICT-ROW' TO  PV-PARAGRAPH.            13100000
                                                                        13110000
           PERFORM                                                      13120000
               WITH TEST AFTER                                          13130000
               VARYING PV-SQL-SUB                                       13140000
               FROM 1 BY 1                                              13150000
               UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        13160000
                  OR SQLCODE = 0                                        13170000
                  OR SQLCODE = PC-ROW-NOT-FOUND                         13180000
                  OR PS-INPUT-REC-ERROR                                 13190000
                                                                        13200000
                 EXEC SQL                                               13210000
                     DELETE FROM XMT_DIST                               13220000
                   WHERE  (DIST_NBR = :XMT00006-DIST-NBR)               13230000
                 END-EXEC                                               13240000
                                                                        13250000
               EVALUATE TRUE                                            13260000
                   WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              13270000
                   WHEN SQLCODE = PC-DEADLOCK                           13280000
                   WHEN SQLCODE = PC-ROW-NOT-FOUND                      13290000
                   WHEN SQLCODE = ZERO                                  13300000
                        CONTINUE                                        13310000
                   WHEN SQLWARN0 NOT = SPACE                            13320000
                   WHEN SQLCODE NOT = ZERO                              13330000
                       MOVE 'BAD SQLCODE FOR DELETE DISTRICT'           13340000
                                     TO  PV-MESSAGE                     13350000
                       PERFORM 9900-PROCESS-DB2-ERROR                   13360000
                       SET PS-INPUT-REC-ERROR TO TRUE                   13370000
               END-EVALUATE                                             13380000
           END-PERFORM.                                                 13390000
                                                                        13400000
           IF  PV-SQL-SUB > PC-MAX-RETRIES                              13410000
               MOVE 'MAX RETRIES EXCEEDED FOR DELETE DISTRICT'          13420000
                                     TO  PV-MESSAGE                     13430000
               PERFORM 9900-PROCESS-DB2-ERROR                           13440000
               SET PS-INPUT-REC-ERROR TO TRUE                           13450000
           END-IF.                                                      13460000
                                                                        13470000
           IF SQLCODE = PC-ROW-NOT-FOUND                                13480000
               MOVE 'DISTRICT ROW NOT FOUND FOR DELETE'                 13490000
                                     TO  PV-MESSAGE                     13500000
               PERFORM 9900-PROCESS-DB2-ERROR                           13510000
           END-IF.                                                      13520000
                                                                        13530000
      * ------------------------------------------------------------- * 13540000
      * PROCESS THE STORE TABLE MESSAGES                              * 13550000
      * - ONLY IF THE INPUT RECORD IS FROM THE RMS STORE TABLE WILL   * 13560000
      * - IT BE AN ACTUAL INSERT.  THE STORE ROW MUST BE ON RMS FIRST * 13570000
      * - BEFORE ANY OTHER STORE-TABLE RELATED ENTRIES CAN BE BUILT   * 13580000
      * ------------------------------------------------------------- * 13590000
       6000-PROCESS-STORE.                                              13600000
                                                                        13610000
           ADD 1                TO PA-STORE-MSGS.                       13620000
                                                                        13630000
           IF HO100-ACTN-TYP-INSERT                                     13640000
      *        INITIALIZE DCLXMT00001                                   13650000
               PERFORM 6010-FORMAT-BASE-LOC-ROW                         13660000
               PERFORM 6020-INSERT-LOC-ROW                              13670000
               IF PS-INPUT-REC-ERROR                                    13680000
                   ADD 1 TO PA-STORE-ERRORS                             13690000
               ELSE                                                     13700000
                   ADD 1 TO PA-STORE-INSERTS                            13710000
               END-IF                                                   13720000
           ELSE                                                         13730000
               IF HO100-ACTN-TYP-UPDATE                                 13740000
                   MOVE HO100-STR-NBR TO PV-LOC-NBR                     13750000
                   MOVE PV-LOC-NBR    TO XMT00001-LOC-NBR               13760000
                   PERFORM 6030-SELECT-LOC-ROW                          13770000
                   IF PS-NO-INPUT-REC-ERROR                             13780000
                       PERFORM 6010-FORMAT-BASE-LOC-ROW                 13790000
                       PERFORM 6040-UPDATE-LOC-ROW                      13800000
                   END-IF                                               13810000
                   IF PS-INPUT-REC-ERROR                                13820000
                       ADD 1 TO PA-STORE-ERRORS                         13830000
                   ELSE                                                 13840000
                       ADD 1 TO PA-STORE-UPDATES                        13850000
                   END-IF                                               13860000
               ELSE                                                     13870000
                   IF HO100-ACTN-TYP-DELETE                             13880000
                       MOVE HO100-STR-NBR TO PV-LOC-NBR                 13890000
                       MOVE PV-LOC-NBR    TO XMT00001-LOC-NBR           13900000
                       PERFORM 6050-DELETE-LOC-ROW                      13910000
                       IF PS-INPUT-REC-ERROR                            13920000
                           ADD 1 TO PA-STORE-ERRORS                     13930000
                       ELSE                                             13940000
                           ADD 1 TO PA-STORE-DELETES                    13950000
                       END-IF                                           13960000
                   END-IF                                               13970000
               END-IF                                                   13980000
           END-IF.                                                      13990000
                                                                        14000000
      * ------------------------------------------------------------- * 14010000
      * INSERT - UPDATE THE STORE BASE ROW DATA                       * 14020000
      * ------------------------------------------------------------- * 14030000
       6010-FORMAT-BASE-LOC-ROW.                                        14040000
                                                                        14050000
           MOVE HO100-STR-NBR             TO PV-LOC-NBR.                14060000
           MOVE PV-LOC-NBR                TO XMT00001-LOC-NBR.          14070000
           MOVE HO100-STR-DISTRICT        TO XMT00001-DIST-NBR.         14080000
           MOVE PC-DEPT-STR               TO XMT00001-LOC-TYP-CDE.      14090000
           MOVE HO100-STR-NAME            TO XMT00001-LOC-NM.           14100000
0404PK     MOVE HO100-STR-NAME10          TO XMT00001-LOC-10-ABBR-NM.   14101093
           MOVE HO100-STR-ADD1            TO XMT00001-LNE-1-ADDR.       14110000
           MOVE HO100-STR-ADD2            TO XMT00001-LNE-2-ADDR.       14120000
           MOVE HO100-STR-CITY            TO XMT00001-CTY-NM.           14130000
           MOVE HO100-STR-STATE-1-2       TO XMT00001-ST-CDE.           14140000
           MOVE HO100-STR-PCODE           TO XMT00001-ZIP-10-CDE.       14150000
           MOVE HO100-STR-PHONE-NUMBER    TO XMT00001-PHN-NBR.          14160000
           MOVE HO100-STR-MGR-NAME        TO XMT00001-MGR-NM.           14170000
           MOVE HO100-STR-OPEN-DATE       TO XMT00001-OPN-DTE.          14180000
           MOVE HO100-STR-CLOSE-DATE      TO XMT00001-CLO-DTE.          14190000
                                                                        14200000
           MOVE HO100-STR-ACQUIRD-DATE TO XMT00001-ACQR-DTE.            14210000
                                                                        14220000
           MOVE HO100-STR-REMODEL-DATE TO XMT00001-RMDL-DTE.            14230000
                                                                        14240000
           MOVE HO100-STR-FORMAT          TO XMT00001-FMT-CDE.          14250000
           MOVE HO100-STR-STOP-ORDER-DAYS TO                            14260000
                XMT00001-STP-ORD-DAYS-QTY.                              14270000
           MOVE HO100-STR-START-ORDER-DAYS TO                           14280000
                XMT00001-STRT-ORD-DAYS-QTY.                             14290000
           MOVE HO100-STR-TOTAL-SQUARE-FT TO                            14300000
                XMT00001-TOT-SQ-FTG-QTY.                                14310000
           MOVE HO100-STR-SELL-SQ-FT      TO                            14320000
                XMT00001-TOT-SLG-SQ-FTG-QTY.                            14330000
           IF HO100-ACTN-TYP-INSERT                                     14340000
               MOVE 0 TO   XMT00001-REPLT-STR-NBR                       14350000
           END-IF.                                                      14360000
                                                                        14370000
      * ------------------------------------------------------------- * 14380000
      * INSERT THE LOCATION ROW                                         14390000
      * ------------------------------------------------------------- * 14400000
       6020-INSERT-LOC-ROW.                                             14410000
                                                                        14420000
           MOVE '6020-INSERT-LOC-ROW' TO    PV-PARAGRAPH.               14430000
                                                                        14440000
           PERFORM                                                      14450000
            WITH TEST AFTER                                             14460000
            VARYING PV-SQL-SUB                                          14470000
            FROM 1 BY 1                                                 14480000
            UNTIL PV-SQL-SUB > PC-MAX-RETRIES                           14490000
               OR SQLCODE = 0                                           14500000
               OR PS-INPUT-REC-ERROR                                    14510000
                                                                        14520000
             EXEC SQL                                                   14530000
               INSERT INTO XMT_LOC                                      14540000
                   ( LOC_NBR                                            14550000
                   , REPLT_STR_NBR                                      14560000
                   , DIST_NBR                                           14570000
                   , LOC_TYP_CDE                                        14580000
                   , LOC_NM                                             14590000
                   , LOC_5_ABBR_NM                                      14600000
                   , LNE_1_ADDR                                         14610000
                   , LNE_2_ADDR                                         14620000
                   , CTY_NM                                             14630000
                   , ST_CDE                                             14640000
                   , ZIP_10_CDE                                         14650000
                   , PHN_NBR                                            14660000
                   , MGR_NM                                             14670000
                   , OPN_DTE                                            14680000
                   , ACQR_DTE                                           14690000
                   , RMDL_DTE                                           14700000
                   , CLO_DTE                                            14710000
                   , FMT_CDE                                            14720000
                   , STP_ORD_DAYS_QTY                                   14730000
                   , STRT_ORD_DAYS_QTY                                  14740000
                   , TOT_SQ_FTG_QTY                                     14750000
                   , TOT_SLG_SQ_FTG_QTY                                 14760000
                   , LAST_UPD_TMST                                      14770093
0404PK             , LOC_10_ABBR_NM)                                    14771093
          VALUES                                                        14780000
                 ( : XMT00001-LOC-NBR                                   14790000
                 , : XMT00001-REPLT-STR-NBR                             14800000
                 , : XMT00001-DIST-NBR                                  14810000
                 , : XMT00001-LOC-TYP-CDE                               14820000
                 , : XMT00001-LOC-NM                                    14830000
                 , : XMT00001-LOC-5-ABBR-NM                             14840000
                 , : XMT00001-LNE-1-ADDR                                14850000
                 , : XMT00001-LNE-2-ADDR                                14860000
                 , : XMT00001-CTY-NM                                    14870000
                 , : XMT00001-ST-CDE                                    14880000
                 , : XMT00001-ZIP-10-CDE                                14890000
                 , : XMT00001-PHN-NBR                                   14900000
                 , : XMT00001-MGR-NM                                    14910000
                 , : XMT00001-OPN-DTE                                   14920000
                 , : XMT00001-ACQR-DTE                                  14930000
                 , : XMT00001-RMDL-DTE                                  14940000
                 , : XMT00001-CLO-DTE                                   14950000
                 , : XMT00001-FMT-CDE                                   14960000
                 , : XMT00001-STP-ORD-DAYS-QTY                          14970000
                 , : XMT00001-STRT-ORD-DAYS-QTY                         14980000
                 , : XMT00001-TOT-SQ-FTG-QTY                            14990000
                 , : XMT00001-TOT-SLG-SQ-FTG-QTY                        15000000
                 , CURRENT TIMESTAMP                                    15010093
0404PK           , : XMT00001-LOC-10-ABBR-NM)                           15010193
             END-EXEC                                                   15020000
                                                                        15030000
               EVALUATE TRUE                                            15040000
                   WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              15050000
                   WHEN SQLCODE = PC-DEADLOCK                           15060000
                   WHEN SQLCODE = ZERO                                  15070000
                        CONTINUE                                        15080000
                   WHEN SQLWARN0 NOT = SPACE                            15090000
                   WHEN SQLCODE NOT = ZERO                              15100000
                       MOVE XMT00001-LOC-NBR TO PV-DISPLAY-LOC          15101099
                       STRING 'BAD SQLCODE FOR INSERT STORE: '          15102099
                             PV-DISPLAY-LOC                             15103099
                             DELIMITED BY SIZE                          15103199
                             INTO PV-MESSAGE                            15104099
                       PERFORM 9900-PROCESS-DB2-ERROR                   15130000
                       SET PS-INPUT-REC-ERROR TO TRUE                   15140000
               END-EVALUATE                                             15150000
           END-PERFORM.                                                 15160000
                                                                        15170000
           IF  PV-SQL-SUB > PC-MAX-RETRIES                              15180000
               MOVE 'MAX RETRIES EXCEEDED FOR INSERT STORE'             15190000
                                     TO  PV-MESSAGE                     15200000
               PERFORM 9900-PROCESS-DB2-ERROR                           15210000
               SET PS-INPUT-REC-ERROR TO TRUE                           15220000
           END-IF.                                                      15230000
                                                                        15240000
      * ------------------------------------------------------------- * 15250000
      * SELECT THE LOCATION ROW                                         15260000
      * ------------------------------------------------------------- * 15270000
       6030-SELECT-LOC-ROW.                                             15280000
                                                                        15290000
           MOVE '6030-SELECT-LOC-ROW' TO    PV-PARAGRAPH.               15300000
                                                                        15310000
           PERFORM                                                      15320000
               WITH TEST AFTER                                          15330000
               VARYING PV-SQL-SUB                                       15340000
               FROM 1 BY 1                                              15350000
               UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        15360000
                  OR SQLCODE = ZERO                                     15370000
                  OR SQLCODE = PC-ROW-NOT-FOUND                         15380000
                  OR PS-INPUT-REC-ERROR                                 15390000
                                                                        15400000
               EXEC SQL                                                 15410000
                 SELECT                                                 15420000
                     LOC_NBR                                            15430000
                   , DIST_NBR                                           15440000
                   , LOC_TYP_CDE                                        15450000
                   , LOC_NM                                             15460000
                   , LNE_1_ADDR                                         15470000
                   , LNE_2_ADDR                                         15480000
                   , CTY_NM                                             15490000
                   , ST_CDE                                             15500000
                   , ZIP_10_CDE                                         15510000
                   , OPN_DTE                                            15520000
                   , CLO_DTE                                            15530000
                   , PHN_NBR                                            15540000
                   , MGR_NM                                             15550000
                   , FMT_CDE                                            15560000
                   , TOT_SLG_SQ_FTG_QTY                                 15570000
                   , TOT_SQ_FTG_QTY                                     15580000
                   , STP_ORD_DAYS_QTY                                   15590000
                   , STRT_ORD_DAYS_QTY                                  15600000
                   , ACQR_DTE                                           15610000
                   , RMDL_DTE                                           15620000
                   , LAST_UPD_TMST                                      15630000
0404PK             , LOC_10_ABBR_NM                                     15631093
             INTO                                                       15640000
                    : XMT00001-LOC-NBR                                  15650000
                  , : XMT00001-DIST-NBR                                 15660000
                  , : XMT00001-LOC-TYP-CDE                              15670000
                  , : XMT00001-LOC-NM                                   15680000
                  , : XMT00001-LNE-1-ADDR                               15690000
                  , : XMT00001-LNE-2-ADDR                               15700000
                  , : XMT00001-CTY-NM                                   15710000
                  , : XMT00001-ST-CDE                                   15720000
                  , : XMT00001-ZIP-10-CDE                               15730000
                  , : XMT00001-OPN-DTE                                  15740000
                  , : XMT00001-CLO-DTE                                  15750000
                  , : XMT00001-PHN-NBR                                  15760000
                  , : XMT00001-MGR-NM                                   15770000
                  , : XMT00001-FMT-CDE                                  15780000
                  , : XMT00001-TOT-SLG-SQ-FTG-QTY                       15790000
                  , : XMT00001-TOT-SQ-FTG-QTY                           15800000
                  , : XMT00001-STP-ORD-DAYS-QTY                         15810000
                  , : XMT00001-STRT-ORD-DAYS-QTY                        15820000
                  , : XMT00001-ACQR-DTE                                 15830000
                  , : XMT00001-RMDL-DTE                                 15840000
                  , : XMT00001-LAST-UPD-TMST                            15850000
0404PK            , : XMT00001-LOC-10-ABBR-NM                           15851093
                         FROM XMT_LOC                                   15860000
                            WHERE  (LOC_NBR = : XMT00001-LOC-NBR)       15870000
               END-EXEC                                                 15880000
                                                                        15890000
               EVALUATE TRUE                                            15900000
                   WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              15910000
                   WHEN SQLCODE = PC-DEADLOCK                           15920000
                   WHEN SQLCODE = ZERO                                  15930000
                        CONTINUE                                        15940000
                   WHEN SQLWARN0 NOT = SPACE                            15950000
                   WHEN SQLCODE NOT = ZERO                              15960000
                       MOVE XMT00001-LOC-NBR TO PV-DISPLAY-LOC          15961099
                       STRING 'BAD SQLCODE FOR SELECT STORE: '          15962099
                             PV-DISPLAY-LOC                             15963099
                             DELIMITED BY SIZE                          15964099
                             INTO PV-MESSAGE                            15965099
                       PERFORM 9900-PROCESS-DB2-ERROR                   15990000
                       SET PS-INPUT-REC-ERROR TO TRUE                   16000000
               END-EVALUATE                                             16010000
           END-PERFORM.                                                 16020000
                                                                        16030000
           IF PV-SQL-SUB > PC-MAX-RETRIES                               16040000
               MOVE 'MAX RETRIES EXCEEDED FOR SELECT STORE'             16050000
                                     TO  PV-MESSAGE                     16060000
               PERFORM 9900-PROCESS-DB2-ERROR                           16070000
               SET PS-INPUT-REC-ERROR TO TRUE                           16080000
           END-IF.                                                      16090000
                                                                        16100000
      * ------------------------------------------------------------- * 16110000
      * UPDATE THE LOCATION DATA                                        16120000
      * ------------------------------------------------------------- * 16130000
       6040-UPDATE-LOC-ROW.                                             16140000
                                                                        16150000
           MOVE '6040-UPDATE-LOC-ROW' TO    PV-PARAGRAPH.               16160000
           PERFORM                                                      16170000
            WITH TEST AFTER                                             16180000
            VARYING PV-SQL-SUB                                          16190000
            FROM 1 BY 1                                                 16200000
            UNTIL PV-SQL-SUB > PC-MAX-RETRIES                           16210000
               OR SQLCODE = 0                                           16220000
               OR SQLCODE = PC-ROW-NOT-FOUND                            16230000
               OR PS-INPUT-REC-ERROR                                    16240000
                                                                        16250000
              EXEC SQL                                                  16260000
                UPDATE XMT_LOC                                          16270000
                SET LOC_NBR            = : XMT00001-LOC-NBR             16280000
                   ,DIST_NBR           = : XMT00001-DIST-NBR            16290000
                   ,LOC_TYP_CDE        = : XMT00001-LOC-TYP-CDE         16300000
                   ,LOC_NM             = : XMT00001-LOC-NM              16310000
                   ,LNE_1_ADDR         = : XMT00001-LNE-1-ADDR          16320000
                   ,LNE_2_ADDR         = : XMT00001-LNE-2-ADDR          16330000
                   ,CTY_NM             = : XMT00001-CTY-NM              16340000
                   ,ST_CDE             = : XMT00001-ST-CDE              16350000
                   ,ZIP_10_CDE         = : XMT00001-ZIP-10-CDE          16360000
                   ,OPN_DTE            = : XMT00001-OPN-DTE             16370000
                   ,CLO_DTE            = : XMT00001-CLO-DTE             16380000
                   ,PHN_NBR            = : XMT00001-PHN-NBR             16390000
                   ,MGR_NM             = : XMT00001-MGR-NM              16400000
                   ,FMT_CDE            = : XMT00001-FMT-CDE             16410000
                   ,TOT_SLG_SQ_FTG_QTY = : XMT00001-TOT-SLG-SQ-FTG-QTY  16420000
                   ,TOT_SQ_FTG_QTY     = : XMT00001-TOT-SQ-FTG-QTY      16430000
                   ,STP_ORD_DAYS_QTY   = : XMT00001-STP-ORD-DAYS-QTY    16440000
                   ,STRT_ORD_DAYS_QTY  = : XMT00001-STRT-ORD-DAYS-QTY   16450000
                   ,ACQR_DTE           = : XMT00001-ACQR-DTE            16460000
                   ,RMDL_DTE           = : XMT00001-RMDL-DTE            16470000
                   ,LAST_UPD_TMST      = CURRENT TIMESTAMP              16480000
0404PK             ,LOC_10_ABBR_NM     = : XMT00001-LOC-10-ABBR-NM      16481093
                    WHERE  (LOC_NBR = : XMT00001-LOC-NBR)               16490000
                 END-EXEC                                               16500000
                                                                        16510000
               EVALUATE TRUE                                            16520000
                   WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              16530000
                   WHEN SQLCODE = PC-DEADLOCK                           16540000
                   WHEN SQLCODE = ZERO                                  16550000
                        CONTINUE                                        16560000
                   WHEN SQLWARN0 NOT = SPACE                            16570000
                   WHEN SQLCODE NOT = ZERO                              16580000
                       MOVE XMT00001-LOC-NBR TO PV-DISPLAY-LOC          16581099
                       STRING 'BAD SQLCODE FOR UPDATE LOCATION: '       16582099
                             PV-DISPLAY-LOC                             16583099
                             DELIMITED BY SIZE                          16583199
                             INTO PV-MESSAGE                            16583299
                       PERFORM 9900-PROCESS-DB2-ERROR                   16610000
                       SET PS-INPUT-REC-ERROR TO TRUE                   16620000
               END-EVALUATE                                             16630000
           END-PERFORM.                                                 16640000
                                                                        16650000
           IF  PV-SQL-SUB > PC-MAX-RETRIES                              16660000
               MOVE 'MAX RETRIES EXCEEDED FOR UPDATE LOCATION'          16670000
                                     TO  PV-MESSAGE                     16680000
               PERFORM 9900-PROCESS-DB2-ERROR                           16690000
               SET PS-INPUT-REC-ERROR TO TRUE                           16700000
           END-IF.                                                      16710000
                                                                        16720000
      * ------------------------------------------------------------- * 16730000
      * DELETE THE LOCATION ROW                                         16740000
      * ------------------------------------------------------------- * 16750000
       6050-DELETE-LOC-ROW.                                             16760000
                                                                        16770000
           MOVE '6050-DELETE-LOC-ROW' TO    PV-PARAGRAPH.               16780000
                                                                        16790000
           PERFORM                                                      16800000
            WITH TEST AFTER                                             16810000
            VARYING PV-SQL-SUB                                          16820000
            FROM 1 BY 1                                                 16830000
            UNTIL PV-SQL-SUB > PC-MAX-RETRIES                           16840000
               OR SQLCODE = 0                                           16850000
               OR SQLCODE = PC-ROW-NOT-FOUND                            16860000
               OR PS-INPUT-REC-ERROR                                    16870000
                                                                        16880000
               EXEC SQL                                                 16890000
                   DELETE FROM XMT_LOC                                  16900000
                   WHERE LOC_NBR = :XMT00001-LOC-NBR                    16910000
               END-EXEC                                                 16920000
                                                                        16930000
               EVALUATE TRUE                                            16940000
                   WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              16950000
                   WHEN SQLCODE = PC-DEADLOCK                           16960000
                   WHEN SQLCODE = PC-ROW-NOT-FOUND                      16970000
                   WHEN SQLCODE = ZERO                                  16980000
                        CONTINUE                                        16990000
                   WHEN SQLWARN0 NOT = SPACE                            17000000
                   WHEN SQLCODE NOT = ZERO                              17010000
                       MOVE XMT00001-LOC-NBR TO PV-DISPLAY-LOC          17011099
                       STRING 'BAD SQLCODE FOR DELETE STORE: '          17012099
                             PV-DISPLAY-LOC                             17013099
                             DELIMITED BY SIZE                          17013199
                             INTO PV-MESSAGE                            17013299
                       PERFORM 9900-PROCESS-DB2-ERROR                   17040000
                       SET PS-INPUT-REC-ERROR TO TRUE                   17050000
               END-EVALUATE                                             17060000
           END-PERFORM.                                                 17070000
                                                                        17080000
           IF  PV-SQL-SUB > PC-MAX-RETRIES                              17090000
               MOVE 'MAX RETRIES EXCEEDED FOR DELETE STORE'             17100000
                                     TO  PV-MESSAGE                     17110000
               PERFORM 9900-PROCESS-DB2-ERROR                           17120000
               SET PS-INPUT-REC-ERROR TO TRUE                           17130000
           END-IF.                                                      17140000
                                                                        17150000
      * ------------------------------------------------------------- * 17160000
      * PROCESS THE STORE ATTRIBUTE TABLE MESSAGES                    * 17170000
      * NOTE THAT AN INSERT IS NOT ACTULLY PERFORMED BECAUSE THE      * 17180000
      * ROW SHOULD ALREADY BE PRESENT THRU THE STORE ADD!             * 17190000
      * ------------------------------------------------------------- * 17200000
       6100-PROCESS-STORE-ATTRIB.                                       17210000
                                                                        17220000
           ADD 1 TO PA-STORE-ATTRIB-MSGS.                               17230000
                                                                        17240000
           MOVE HO100-SATTR-STR-NBR TO PV-LOC-NBR.                      17250000
           MOVE PV-LOC-NBR          TO XMT00001-LOC-NBR.                17260000
      *    DISPLAY 'HO100-SATTR-STR-NBR  ' HO100-STR-NBR.               17270000
      *    DISPLAY 'PV-LOC-NBR           ' PV-LOC-NBR.                  17280000
      *    DISPLAY 'XMT00001-LOC-NBR     ' XMT00001-LOC-NBR.            17290000
                                                                        17300000
           IF HO100-ACTN-TYP-DELETE                                     17310000
               ADD 1 TO PA-STORE-ATTRIB-DELETES                         17320000
           ELSE                                                         17330000
                   PERFORM 6110-UPDATE-STORE-ATTR-DATA                  17340000
                   PERFORM 6120-UPDATE-LOC-ATTR-DATA                    17350000
                   IF PS-INPUT-REC-ERROR                                17360000
                       ADD 1 TO PA-STORE-ATTRIB-ERRORS                  17370000
                   ELSE                                                 17380000
                       IF HO100-ACTN-TYP-INSERT                         17390000
                           ADD 1 TO PA-STORE-ATTRIB-INSERTS             17400000
                       ELSE                                             17410000
                           ADD 1 TO PA-STORE-ATTRIB-UPDATES             17420000
                       END-IF                                           17430000
                   END-IF                                               17440000
           END-IF.                                                      17450000
                                                                        17460000
      * ------------------------------------------------------------- * 17470000
      * UPDATE THE STORE TABLE WITH THE STORE ATTRIBUTE DATA            17480000
      * ------------------------------------------------------------- * 17490000
       6110-UPDATE-STORE-ATTR-DATA.                                     17500000
                                                                        17510000
           MOVE HO100-SATTR-REPLT-STR-NBR    TO                         17520000
                PV-REPLT-STR-NBR.                                       17530000
           MOVE PV-REPLT-STR-NBR             TO                         17540000
                XMT00001-REPLT-STR-NBR.                                 17550000
           MOVE HO100-SATTR-STR-NM-5-ABBR    TO                         17560000
                XMT00001-LOC-5-ABBR-NM.                                 17570000
           MOVE HO100-SATTR-SLS-INCL-DTE-CDE TO                         17580000
                XMT00001-SLS-INCL-DTE-CDE.                              17590000
           MOVE HO100-SATTR-OCPNC-DTE        TO                         17600000
                XMT00001-OCPNC-DTE.                                     17610000
           MOVE HO100-SATTR-TM-ZN-CDE        TO                         17620000
                XMT00001-STD-TM-ZN-CDE.                                 17630000
           MOVE HO100-SATTR-DST-IND          TO                         17640000
                XMT00001-DST-IND.                                       17650000
           MOVE HO100-SATTR-E-BUS-LOC-IND    TO                         17660000
                XMT00001-E-BUS-IND.                                     17670000
                                                                        17680074
           MOVE HO100-SATTR-MEDN-AGE-NBR     TO                         17690074
0903RM          PV-LOC-MEDN-AGE.                                        17700074
0903RM     MOVE PV-LOC-MEDN-AGE-NBR-NUM      TO                         17710074
0903RM          PV-LOC-MEDN-AGE-NBR-1.                                  17720074
0903RM     MOVE PV-LOC-MEDN-AGE-NBR-DEC      TO                         17730074
0903RM          PV-LOC-MEDN-AGE-NBR-2.                                  17740074
0903RM     MOVE PV-LOC-MEDN-AGE-WHOLE        TO                         17750077
0903RM          PV-LOC-MEDN-AGE-NBR.                                    17760078
0903RM     MOVE PV-LOC-MEDN-AGE-NBR          TO                         17770078
                XMT00001-MEDN-AGE-NBR.                                  17780074
                                                                        17790074
           MOVE HO100-SATTR-EST-HH-INCM-AMT  TO                         17800000
                XMT00001-EST-HH-INCM-AMT.                               17810000
           MOVE HO100-SATTR-EXTD-MALL-NM     TO                         17820000
                XMT00001-EXTD-MALL-NM.                                  17830000
           MOVE HO100-SATTR-PRCHG-IND        TO                         17840000
                XMT00001-PRCHG-CRE-IND.                                 17850000
           MOVE HO100-SATTR-IN-STR-PRCHG-IND TO                         17860000
                XMT00001-IN-STR-PRCHG-IND.                              17870000
           MOVE HO100-SATTR-FINCL-CLO-DTE    TO                         17880000
                XMT00001-FINCL-CLO-DTE.                                 17890000
           MOVE HO100-SATTR-SEA-SLS-INCL-DTE TO                         17900000
                XMT00001-SEA-SLS-INCL-DTE.                              17910000
           MOVE HO100-SATTR-QTR-SLS-INCL-DTE TO                         17920000
                XMT00001-QTR-SLS-INCL-DTE.                              17930000
           MOVE HO100-SATTR-MN-SLS-INCL-DTE  TO                         17940000
                XMT00001-MN-SLS-INCL-DTE.                               17950000
           MOVE HO100-SATTR-YR-SLS-INCL-DTE  TO                         17960000
                XMT00001-YR-SLS-INCL-DTE.                               17970000
           MOVE HO100-SATTR-GRND-OPN-DTE     TO                         17980000
                XMT00001-GRND-OPN-DTE.                                  17990000
0904RM*-- WR27051                                                       17991099
0904RM*    MOVE HO100-SATTR-POS-RGST-BNK-QTY TO                         18000099
0904RM*         XMT00001-POS-RGST-BNK-QTY.                              18010099
0605RM     MOVE HO100-SATTR-PLN-CTG-CDE      TO                         18021099
0605RM          XMT00001-PLN-CTG-CDE.                                   18022099
0423PK     MOVE HO100-SATTR-OPN-STR-MN       TO                         18023099
0423PK          XMT00001-NW-STR-OPNG-GP-MN.                             18024099
0423PK     MOVE HO100-SATTR-OPN-STR-YR       TO                         18025099
0423PK          XMT00001-NW-STR-OPNG-GP-YR.                             18026099
                                                                        18030000
      * ------------------------------------------------------------- * 18040000
      * UPDATE THE LOCATION DATA                                        18050000
      * ------------------------------------------------------------- * 18060000
       6120-UPDATE-LOC-ATTR-DATA.                                       18070000
                                                                        18080000
           MOVE '6120-UPDATE-LOC-ATTR-DATA' TO    PV-PARAGRAPH.         18090000
           PERFORM                                                      18100000
            WITH TEST AFTER                                             18110000
            VARYING PV-SQL-SUB                                          18120000
            FROM 1 BY 1                                                 18130000
            UNTIL PV-SQL-SUB > PC-MAX-RETRIES                           18140000
               OR SQLCODE = 0                                           18150000
               OR SQLCODE = PC-ROW-NOT-FOUND                            18160000
               OR PS-INPUT-REC-ERROR                                    18170000
                                                                        18180000
              EXEC SQL                                                  18190000
                UPDATE XMT_LOC                                          18200000
                SET REPLT_STR_NBR      = : XMT00001-REPLT-STR-NBR       18210000
0803RM*            ,DIST_NBR           = : XMT00001-DIST-NBR            18220073
0803RM*            ,LOC_TYP_CDE        = : XMT00001-LOC-TYP-CDE         18230073
0803RM*            ,LOC_NM             = : XMT00001-LOC-NM              18240073
                   ,LOC_5_ABBR_NM      = : XMT00001-LOC-5-ABBR-NM       18250000
0904RM*-- WR27051                                                       18251099
0904RM*            ,POS_RGST_BNK_QTY   = : XMT00001-POS-RGST-BNK-QTY    18260099
                   ,DST_IND            = : XMT00001-DST-IND             18270000
                   ,E_BUS_IND          = : XMT00001-E-BUS-IND           18280000
                   ,STD_TM_ZN_CDE      = : XMT00001-STD-TM-ZN-CDE       18290000
                   ,SLS_INCL_DTE_CDE   = : XMT00001-SLS-INCL-DTE-CDE    18300000
                   ,MEDN_AGE_NBR       = : XMT00001-MEDN-AGE-NBR        18310000
                   ,EST_HH_INCM_AMT    = : XMT00001-EST-HH-INCM-AMT     18320000
                   ,QTR_SLS_INCL_DTE   = : XMT00001-QTR-SLS-INCL-DTE    18330000
                   ,SEA_SLS_INCL_DTE   = : XMT00001-SEA-SLS-INCL-DTE    18340000
                   ,YR_SLS_INCL_DTE    = : XMT00001-YR-SLS-INCL-DTE     18350073
                   ,MN_SLS_INCL_DTE    = : XMT00001-MN-SLS-INCL-DTE     18360073
                   ,OCPNC_DTE          = : XMT00001-OCPNC-DTE           18370073
                   ,FINCL_CLO_DTE      = : XMT00001-FINCL-CLO-DTE       18380073
                   ,EXTD_MALL_NM       = : XMT00001-EXTD-MALL-NM        18390073
                   ,GRND_OPN_DTE       = : XMT00001-GRND-OPN-DTE        18400073
                   ,PRCHG_CRE_IND      = : XMT00001-PRCHG-CRE-IND       18410073
                   ,IN_STR_PRCHG_IND   = : XMT00001-IN-STR-PRCHG-IND    18420073
                   ,LAST_UPD_TMST      = CURRENT TIMESTAMP              18430073
0605RM             ,PLN_CTG_CDE        = : XMT00001-PLN-CTG-CDE         18431099
0423PK             ,NW_STR_OPNG_GP_MN  = : XMT00001-NW-STR-OPNG-GP-MN   18431199
0423PK             ,NW_STR_OPNG_GP_YR  = : XMT00001-NW-STR-OPNG-GP-YR   18431299
                    WHERE  (LOC_NBR = : XMT00001-LOC-NBR)               18440073
                 END-EXEC                                               18450073
                                                                        18460073
               EVALUATE TRUE                                            18470073
                   WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              18480073
                   WHEN SQLCODE = PC-DEADLOCK                           18490073
                   WHEN SQLCODE = ZERO                                  18500073
                        CONTINUE                                        18510073
                   WHEN SQLWARN0 NOT = SPACE                            18520073
                   WHEN SQLCODE NOT = ZERO                              18530073
                       MOVE XMT00001-LOC-NBR TO PV-DISPLAY-LOC          18531099
                       STRING 'BAD SQLCODE FOR UPDATE LOCATION: '       18540099
                             PV-DISPLAY-LOC                             18550099
                             DELIMITED BY SIZE                          18550199
                             INTO PV-MESSAGE                            18550299
                       PERFORM 9900-PROCESS-DB2-ERROR                   18560073
                       SET PS-INPUT-REC-ERROR TO TRUE                   18570073
               END-EVALUATE                                             18580073
           END-PERFORM.                                                 18590073
                                                                        18600073
           IF  PV-SQL-SUB > PC-MAX-RETRIES                              18610073
               MOVE 'MAX RETRIES EXCEEDED FOR UPDATE LOCATION'          18620073
                                     TO  PV-MESSAGE                     18630073
               PERFORM 9900-PROCESS-DB2-ERROR                           18640073
               SET PS-INPUT-REC-ERROR TO TRUE                           18650073
           END-IF.                                                      18660073
      * ------------------------------------------------------------- * 18670073
      * PROCESS THE WH TABLE MESSAGES                                   18680073
      * ------------------------------------------------------------- * 18690073
       6200-PROCESS-WH.                                                 18700073
                                                                        18710073
           ADD 1 TO PA-WH-MESSAGES.                                     18720000
                                                                        18730000
           IF HO100-ACTN-TYP-INSERT                                     18740000
               INITIALIZE DCLXMT00001                                   18750000
               PERFORM 6210-LOAD-WH-DATA                                18760000
               PERFORM 6220-INSERT-WH-LOC-ROW                           18770000
               IF PS-INPUT-REC-ERROR                                    18780000
                   ADD 1 TO PA-WH-ERRORS                                18790000
               ELSE                                                     18800000
                   ADD 1 TO PA-WH-INSERTS                               18810000
               END-IF                                                   18820000
           ELSE                                                         18830000
               IF HO100-ACTN-TYP-UPDATE                                 18840000
                   PERFORM 6210-LOAD-WH-DATA                            18850000
                   PERFORM 6230-UPDATE-WH-LOC-ROW                       18860000
                   IF PS-INPUT-REC-ERROR                                18870000
                       ADD 1 TO PA-WH-ERRORS                            18880000
                   ELSE                                                 18890000
                       ADD 1 TO PA-WH-UPDATES                           18900000
                   END-IF                                               18910000
               ELSE                                                     18920000
                   IF HO100-ACTN-TYP-DELETE                             18930000
                       MOVE HO100-WH   TO PV-LOC-NBR                    18940000
                       MOVE PV-LOC-NBR TO XMT00001-LOC-NBR              18950000
                       PERFORM 6050-DELETE-LOC-ROW                      18960000
                       IF PS-INPUT-REC-ERROR                            18970000
                           ADD 1 TO PA-WH-ERRORS                        18980000
                       ELSE                                             18990000
                           ADD 1 TO PA-WH-DELETES                       19000000
                       END-IF                                           19010000
                   END-IF                                               19020000
               END-IF                                                   19030000
           END-IF.                                                      19040000
                                                                        19050000
      * ------------------------------------------------------------- * 19060000
      * LOAD THE DATA FOR THE WH ROW                                  * 19070000
      * ------------------------------------------------------------- * 19080000
       6210-LOAD-WH-DATA.                                               19090000
                                                                        19100000
           MOVE HO100-WH             TO PV-LOC-NBR.                     19110000
           MOVE PV-LOC-NBR           TO XMT00001-LOC-NBR.               19120000
                                                                        19130000
**TEMP*    DISPLAY 'HO100-WH         ' HO100-WH.                        19140000
**TEMP*    DISPLAY 'PV-LOC-NBR       ' PV-LOC-NBR.                      19150000
**TEMP*    DISPLAY 'XMT00001-LOC-NBR ' XMT00001-LOC-NBR.                19160000
                                                                        19170000
           MOVE HO100-WH-NAME        TO XMT00001-LOC-NM.                19180000
           MOVE HO100-WH-ADD1        TO XMT00001-LNE-1-ADDR.            19190000
           MOVE HO100-WH-ADD2        TO XMT00001-LNE-2-ADDR.            19200000
           MOVE HO100-WH-CITY        TO XMT00001-CTY-NM.                19210000
           MOVE HO100-WH-STATE-1-2   TO XMT00001-ST-CDE.                19220000
           MOVE HO100-WH-PCODE       TO XMT00001-ZIP-10-CDE.            19230000
                                                                        19240000
           IF HO100-ACTN-TYP-INSERT                                     19250000
               MOVE SPACES           TO XMT00001-LOC-5-ABBR-NM          19260000
               MOVE PC-DIST-CTR      TO XMT00001-LOC-TYP-CDE            19270000
               MOVE PC-DEFAULT-DATE  TO XMT00001-OPN-DTE                19280000
                                        XMT00001-CLO-DTE                19290000
           END-IF.                                                      19300000
                                                                        19310000
      * ------------------------------------------------------------- * 19320000
      * INSERT THE DATA FOR THE WH ROW                                * 19330000
      * ------------------------------------------------------------- * 19340000
       6220-INSERT-WH-LOC-ROW.                                          19350000
                                                                        19360000
           MOVE '6220-INSERT-WH-LOC-ROW ' TO PV-PARAGRAPH.              19370000
                                                                        19380000
           PERFORM                                                      19390000
               WITH TEST AFTER                                          19400000
               VARYING PV-SQL-SUB                                       19410000
               FROM 1 BY 1                                              19420000
               UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        19430000
                  OR SQLCODE = 0                                        19440000
                  OR PS-INPUT-REC-ERROR                                 19450000
      *                                                                 19460000
             EXEC SQL                                                   19470000
               INSERT INTO XMT_LOC                                      19480000
                   ( LOC_NBR                                            19490000
                   , LOC_TYP_CDE                                        19500000
                   , LOC_NM                                             19510000
                   , LOC_5_ABBR_NM                                      19520000
                   , LNE_1_ADDR                                         19530000
                   , LNE_2_ADDR                                         19540000
                   , CTY_NM                                             19550000
                   , ST_CDE                                             19560000
                   , ZIP_10_CDE                                         19570000
                   , OPN_DTE                                            19580000
                   , CLO_DTE                                            19590000
************       , OCPNC_DTE                                          19600000
                   , LAST_UPD_TMST)                                     19610000
          VALUES                                                        19620000
                 ( : XMT00001-LOC-NBR                                   19630000
                 , : XMT00001-LOC-TYP-CDE                               19640000
                 , : XMT00001-LOC-NM                                    19650000
                 , : XMT00001-LOC-5-ABBR-NM                             19660000
                 , : XMT00001-LNE-1-ADDR                                19670000
                 , : XMT00001-LNE-2-ADDR                                19680000
                 , : XMT00001-CTY-NM                                    19690000
                 , : XMT00001-ST-CDE                                    19700000
                 , : XMT00001-ZIP-10-CDE                                19710000
                 , : XMT00001-OPN-DTE                                   19720000
                 , : XMT00001-CLO-DTE                                   19730000
**********       , : XMT00001-OCPNC-DTE                                 19740000
                 , CURRENT TIMESTAMP)                                   19750000
             END-EXEC                                                   19760000
                                                                        19770000
               EVALUATE TRUE                                            19780000
                   WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              19790000
                   WHEN SQLCODE = PC-DEADLOCK                           19800000
                   WHEN SQLCODE = ZERO                                  19810000
                   WHEN SQLCODE = PC-ROW-NOT-FOUND                      19820000
                        CONTINUE                                        19830000
                   WHEN SQLWARN0 NOT = SPACE                            19840000
                   WHEN SQLCODE NOT = ZERO                              19850000
                       MOVE 'BAD SQLCODE ON INSERT TO XMT_LOC'          19860000
                                     TO  PV-MESSAGE                     19870000
                       PERFORM 9900-PROCESS-DB2-ERROR                   19880000
                       SET PS-INPUT-REC-ERROR TO TRUE                   19890000
               END-EVALUATE                                             19900000
           END-PERFORM.                                                 19910000
      *                                                                 19920000
           IF PV-SQL-SUB > PC-MAX-RETRIES                               19930000
               MOVE 'MAX RETRIES EXCEEDED ON INSERT TO XMT_LOC'         19940000
                                     TO  PV-MESSAGE                     19950000
               PERFORM 9900-PROCESS-DB2-ERROR                           19960000
               SET PS-INPUT-REC-ERROR TO TRUE                           19970000
           END-IF.                                                      19980000
                                                                        19990000
      * ------------------------------------------------------------- * 20000000
      * PERFORM THE UPDATE OF THE WAREHOUSE DATA TO THE XMT_LOC TABLE * 20010000
      * ------------------------------------------------------------- * 20020000
       6230-UPDATE-WH-LOC-ROW.                                          20030000
                                                                        20040000
           MOVE '6230-UPDATE-WH-LOC-ROW ' TO PV-PARAGRAPH.              20050000
                                                                        20060000
           PERFORM                                                      20070000
               WITH TEST AFTER                                          20080000
               VARYING PV-SQL-SUB                                       20090000
               FROM 1 BY 1                                              20100000
               UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        20110000
                  OR SQLCODE = 0                                        20120000
                  OR PS-INPUT-REC-ERROR                                 20130000
      *                                                                 20140000
             EXEC SQL                                                   20150000
               UPDATE XMT_LOC                                           20160000
                  SET LOC_NM           = :XMT00001-LOC-NM               20170000
                    , LNE_1_ADDR       = :XMT00001-LNE-1-ADDR           20180000
                    , LNE_2_ADDR       = :XMT00001-LNE-2-ADDR           20190000
                    , CTY_NM           = :XMT00001-CTY-NM               20200000
                    , ST_CDE           = :XMT00001-ST-CDE               20210000
                    , ZIP_10_CDE       = :XMT00001-ZIP-10-CDE           20220000
                    , LAST_UPD_TMST    = CURRENT TIMESTAMP              20230000
               WHERE LOC_NBR           = :XMT00001-LOC-NBR              20240000
             END-EXEC                                                   20250000
                                                                        20260000
               EVALUATE TRUE                                            20270000
                   WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              20280000
                   WHEN SQLCODE = PC-DEADLOCK                           20290000
                   WHEN SQLCODE = ZERO                                  20300000
                   WHEN SQLCODE = PC-ROW-NOT-FOUND                      20310000
                        CONTINUE                                        20320000
                   WHEN SQLWARN0 NOT = SPACE                            20330000
                   WHEN SQLCODE NOT = ZERO                              20340000
                       MOVE 'BAD SQLCODE FOR UPDATE XMT_LOC'            20350000
                                     TO  PV-MESSAGE                     20360000
                       PERFORM 9900-PROCESS-DB2-ERROR                   20370000
                       SET PS-INPUT-REC-ERROR TO TRUE                   20380000
               END-EVALUATE                                             20390000
           END-PERFORM.                                                 20400000
      *                                                                 20410000
           IF PV-SQL-SUB > PC-MAX-RETRIES                               20420000
               MOVE 'MAX RETRIES EXCEEDED FOR UPDATE XMT_LOC'           20430000
                                     TO  PV-MESSAGE                     20440000
               PERFORM 9900-PROCESS-DB2-ERROR                           20450000
               SET PS-INPUT-REC-ERROR TO TRUE                           20460000
           END-IF.                                                      20470000
      * ------------------------------------------------------------- * 20480000
      * PROCESS THE WH ATTRIB MESSAGES                                * 20490000
      * NOTE THAT AN INSERT IS NOT ACTUALLY PERFORMED BECAUSE THE     * 20500000
      * ROW SHOULD ALREADY BE PRESENT THRU THE WH ADD                 * 20510000
      * ------------------------------------------------------------- * 20520000
       6300-PROCESS-WH-ATTRIB.                                          20530000
                                                                        20540000
           ADD 1 TO PA-WH-ATTRIB-MSGS.                                  20550000
                                                                        20560000
           MOVE HO100-WHATTR-WH      TO PV-LOC-NBR.                     20571094
           MOVE PV-LOC-NBR           TO XMT00001-LOC-NBR.               20572094
      *    DISPLAY 'HO100-WHATTR-WH  ' HO100-WHATTR-WH.                 20600000
      *    DISPLAY 'PV-LOC-NBR       ' PV-LOC-NBR.                      20610000
      *    DISPLAY 'XMT00001-LOC-NBR ' XMT00001-LOC-NBR.                20620096
                                                                        20630000
           PERFORM 6310-UPDATE-WH-ATTR-DATA.                            20640000
0206PK**   WAREHOUSE DC ASSIGMENTS                                      20641099
0206PK     PERFORM 6315-PROCESS-DC-TO-DC.                               20642099
           PERFORM 6320-UPDATE-WH-LOC-ROW.                              20650000
                                                                        20651099
           IF PS-INPUT-REC-ERROR                                        20660000
               ADD 1 TO PA-WH-ATTRIB-ERRORS                             20670000
           ELSE                                                         20680000
               IF HO100-ACTN-TYP-INSERT                                 20690000
                   ADD 1 TO PA-WH-ATTRIB-INSERTS                        20700000
               ELSE                                                     20710000
                   ADD 1 TO PA-WH-ATTRIB-UPDATES                        20720000
               END-IF                                                   20730000
           END-IF.                                                      20740000
                                                                        20750000
      * ------------------------------------------------------------- * 20760000
      * LOAD THE WH-ATTRIBUTE DATA INTO THE STORE ROW                 * 20770000
      * ------------------------------------------------------------- * 20780000
       6310-UPDATE-WH-ATTR-DATA.                                        20790000
                                                                        20800000
           MOVE HO100-WHATTR-LOC-TYP-CDE   TO XMT00001-LOC-TYP-CDE.     20810000
           MOVE HO100-WHATTR-NM-5-ABBR     TO XMT00001-LOC-5-ABBR-NM.   20820000
0404PK     MOVE HO100-WHATTR-NM-10-ABBR    TO XMT00001-LOC-10-ABBR-NM.  20821093
           MOVE HO100-WHATTR-OPN-DTE       TO XMT00001-OPN-DTE.         20830000
           MOVE HO100-WHATTR-CLO-DTE       TO XMT00001-CLO-DTE.         20840000
           MOVE HO100-WHATTR-OCPNC-DTE     TO XMT00001-OCPNC-DTE.       20850000
           MOVE HO100-WHATTR-PRCHG-IND     TO XMT00001-PRCHG-CRE-IND.   20860000
           MOVE HO100-WHATTR-IN-STR-PRCHG-IND TO                        20870000
                XMT00001-IN-STR-PRCHG-IND.                              20880000
           MOVE HO100-WHATTR-E-BUS-LOC-IND TO XMT00001-E-BUS-IND.       20890000
           MOVE HO100-WHATTR-DST-IND       TO XMT00001-DST-IND.         20900000
                                                                        20900181
0104RM* ------------------------------------------------------------- * 20901689
0104RM* PROCESS DC TO DC RELATIONSHIPS - UPDATE OR INSERT             * 20901789
0104RM* ------------------------------------------------------------- * 20901889
0104RM 6315-PROCESS-DC-TO-DC.                                           20901989
0104RM     MOVE '6315-PROCESS-DC-TO-DC.  ' TO PV-PARAGRAPH.             20902089
                                                                        20902189
1203RM     MOVE HO100-WHATTR-WH            TO PV-WHATTR-WH.             20902290
1203RM     MOVE PV-WHATTR-WH-RDF           TO XMT00002-LOC-NBR.         20902381
1203RM     PERFORM 6460-SELECT-DC-LOC.                                  20903081
1203RM     MOVE HO100-WHATTR-DC-NBR        TO PV-WHATTR-DC-NBR.         20904081
0104RM     IF (SQLCODE = PC-ROW-NOT-FOUND)                              20904188
0104RM         MOVE PV-WHATTR-DC-NBR-RDF TO XMT00002-DC-NBR             20904288
0104RM         MOVE HO100-WHATTR-OPN-DTE TO XMT00002-EFF-BEG-DTE        20904388
0104RM         MOVE HO100-WHATTR-OPN-DTE TO XMT00002-PO-STRT-DTE        20904488
0104RM         PERFORM                                                  20904588
0104RM             WITH TEST AFTER                                      20904688
0104RM             VARYING PV-SQL-SUB                                   20904788
0104RM             FROM 1 BY 1                                          20904888
0104RM             UNTIL PV-SQL-SUB > PC-MAX-RETRIES                    20904988
0104RM                OR SQLCODE = 0                                    20905088
0104RM                OR PS-INPUT-REC-ERROR                             20905188
0104RM*                                                                 20905288
0104RM               EXEC SQL                                           20905388
0104RM                   INSERT INTO XMT_DC_LOC_ASGMT                   20905488
0104RM                            (LOC_NBR                              20905588
0104RM                           , EFF_BEG_DTE                          20905688
0104RM                           , DC_NBR                               20905788
0104RM                           , PO_STRT_DTE)                         20905888
0104RM                   VALUES (: XMT00002-LOC-NBR                     20905988
0104RM                         , : XMT00002-EFF-BEG-DTE                 20906088
0104RM                         , : XMT00002-DC-NBR                      20906188
0104RM                         , : XMT00002-PO-STRT-DTE)                20906288
0104RM               END-EXEC                                           20906388
0104RM*                                                                 20906488
0104RM             EVALUATE TRUE                                        20906588
0104RM                 WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES          20906688
0104RM                 WHEN SQLCODE = PC-DEADLOCK                       20906788
0104RM                 WHEN SQLCODE = ZERO                              20906888
0104RM                     ADD 1 TO PA-WH-STR-ASSIGN-INSERTS            20907189
0104RM                 WHEN SQLWARN0 NOT = SPACE                        20907388
0104RM                 WHEN SQLCODE NOT = ZERO                          20907488
0104RM                     ADD 1 TO PA-WH-STR-ASSIGN-ERRORS             20907589
0104RM                     MOVE 'BAD SQLCODE FOR INSERT DC_LOC_ASGMT'   20907688
0104RM                                   TO PV-MESSAGE                  20907788
0104RM                     PERFORM 9900-PROCESS-DB2-ERROR               20907888
0104RM                     SET PS-INPUT-REC-ERROR TO TRUE               20907988
0104RM             END-EVALUATE                                         20908088
0104RM         END-PERFORM                                              20908188
0104RM*                                                                 20908288
0104RM         IF PV-SQL-SUB > PC-MAX-RETRIES                           20908388
0104RM             MOVE 'MAX RETRIES EXCEEDED FOR INSERT DC_LOC_ASGMT'  20908488
0104RM                                   TO PV-MESSAGE                  20908588
0104RM             PERFORM 9900-PROCESS-DB2-ERROR                       20908688
0104RM             SET PS-INPUT-REC-ERROR TO TRUE                       20908788
0104RM         END-IF                                                   20908888
0104RM     ELSE                                                         20908988
1203RM     IF ((PV-WHATTR-DC-NBR-RDF = XMT00002-DC-NBR)     AND         20909087
1203RM        (HO100-WHATTR-OPN-DTE = XMT00002-EFF-BEG-DTE) AND         20910081
1203RM        (HO100-WHATTR-OPN-DTE = XMT00002-PO-STRT-DTE))            20910187
1203RM         CONTINUE                                                 20910381
1203RM     ELSE                                                         20910481
1203RM         MOVE PV-WHATTR-DC-NBR-RDF TO XMT00002-DC-NBR             20910581
1203RM         MOVE HO100-WHATTR-OPN-DTE TO XMT00002-EFF-BEG-DTE        20910681
1203RM         MOVE HO100-WHATTR-OPN-DTE TO XMT00002-PO-STRT-DTE        20910781
1203RM         PERFORM                                                  20910881
1203RM             WITH TEST AFTER                                      20910981
1203RM             VARYING PV-SQL-SUB                                   20911081
1203RM             FROM 1 BY 1                                          20911181
1203RM             UNTIL PV-SQL-SUB > PC-MAX-RETRIES                    20912081
1203RM                OR SQLCODE = ZERO                                 20913081
1203RM                OR SQLCODE = PC-ROW-NOT-FOUND                     20914081
1203RM                OR PS-INPUT-REC-ERROR                             20915081
1203RM                                                                  20916081
1203RM             EXEC SQL                                             20917081
1203RM               UPDATE XMT_DC_LOC_ASGMT                            20918081
1203RM                  SET DC_NBR      = :XMT00002-DC-NBR              20919081
1203RM                    , EFF_BEG_DTE = :XMT00002-EFF-BEG-DTE         20919181
1203RM                    , PO_STRT_DTE = :XMT00002-PO-STRT-DTE         20919281
1203RM                WHERE LOC_NBR     = :XMT00002-LOC-NBR             20919381
1203RM             END-EXEC                                             20919581
1203RM                                                                  20919681
1203RM             EVALUATE TRUE                                        20919781
1203RM                 WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES          20919881
1203RM                 WHEN SQLCODE = PC-DEADLOCK                       20919981
1203RM                 WHEN SQLCODE = ZERO                              20920081
1203RM                      CONTINUE                                    20920181
1203RM                 WHEN SQLWARN0 NOT = SPACE                        20920281
1203RM                 WHEN SQLCODE NOT = ZERO                          20920381
1203RM                     MOVE 'BAD SQLCODE FOR UPDATE DC_LOC_ASGMT'   20920481
1203RM                                   TO PV-MESSAGE                  20920581
1203RM                     PERFORM 9900-PROCESS-DB2-ERROR               20920681
1203RM                     SET PS-INPUT-REC-ERROR TO TRUE               20920781
1203RM             END-EVALUATE                                         20920881
1203RM         END-PERFORM                                              20920981
1203RM                                                                  20921081
1203RM         IF PV-SQL-SUB > PC-MAX-RETRIES                           20921181
1203RM             MOVE 'MAX RETRIES EXCEEDED FOR UPDATE DC_LOC_ASGMT'  20921281
1203RM                                   TO PV-MESSAGE                  20921381
1203RM             PERFORM 9900-PROCESS-DB2-ERROR                       20921481
1203RM             SET PS-INPUT-REC-ERROR TO TRUE                       20921581
1203RM         END-IF                                                   20921681
1203RM     END-IF.                                                      20921781
      * ------------------------------------------------------------- * 20923000
      * PERFORM THE UPDATE OF THE WAREHOUSE DATA TO THE XMT_LOC TABLE * 20930000
      * ------------------------------------------------------------- * 20940000
       6320-UPDATE-WH-LOC-ROW.                                          20950000
                                                                        20960000
           MOVE '6320-UPDATE-WH-LOC-ROW ' TO PV-PARAGRAPH.              20970000
                                                                        20980000
           PERFORM                                                      20990000
               WITH TEST AFTER                                          21000000
               VARYING PV-SQL-SUB                                       21010000
               FROM 1 BY 1                                              21020000
               UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        21030000
                  OR SQLCODE = 0                                        21040000
                  OR PS-INPUT-REC-ERROR                                 21050000
      *                                                                 21060000
             EXEC SQL                                                   21070000
               UPDATE XMT_LOC                                           21080000
                  SET LOC_TYP_CDE      = :XMT00001-LOC-TYP-CDE          21090000
                    , LOC_5_ABBR_NM    = :XMT00001-LOC-5-ABBR-NM        21100000
0404PK              , LOC_10_ABBR_NM   = :XMT00001-LOC-10-ABBR-NM       21101093
                    , OPN_DTE          = :XMT00001-OPN-DTE              21110000
                    , CLO_DTE          = :XMT00001-CLO-DTE              21120000
                    , OCPNC_DTE        = :XMT00001-OCPNC-DTE            21130000
                    , E_BUS_IND        = :XMT00001-E-BUS-IND            21140000
                    , DST_IND          = :XMT00001-DST-IND              21150000
                    , IN_STR_PRCHG_IND = :XMT00001-IN-STR-PRCHG-IND     21160000
                    , PRCHG_CRE_IND    = :XMT00001-PRCHG-CRE-IND        21170000
                    , LAST_UPD_TMST    = CURRENT TIMESTAMP              21180000
               WHERE LOC_NBR           = :XMT00001-LOC-NBR              21190000
             END-EXEC                                                   21200000
                                                                        21210000
               EVALUATE TRUE                                            21220000
                   WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              21230000
                   WHEN SQLCODE = PC-DEADLOCK                           21240000
                   WHEN SQLCODE = ZERO                                  21250000
                   WHEN SQLCODE = PC-ROW-NOT-FOUND                      21260000
                        CONTINUE                                        21270000
                   WHEN SQLWARN0 NOT = SPACE                            21280000
                   WHEN SQLCODE NOT = ZERO                              21290000
                       MOVE 'BAD SQLCODE FOR UPDATE XMT_LOC'            21300000
                                     TO  PV-MESSAGE                     21310000
                       PERFORM 9900-PROCESS-DB2-ERROR                   21320000
                       SET PS-INPUT-REC-ERROR TO TRUE                   21330000
               END-EVALUATE                                             21340000
           END-PERFORM.                                                 21350000
      *                                                                 21360000
           IF PV-SQL-SUB > PC-MAX-RETRIES                               21370000
               MOVE 'MAX RETRIES EXCEEDED FOR UPDATE XMT_LOC'           21380000
                                     TO  PV-MESSAGE                     21390000
               PERFORM 9900-PROCESS-DB2-ERROR                           21400000
               SET PS-INPUT-REC-ERROR TO TRUE                           21410000
           END-IF.                                                      21420000
      * ------------------------------------------------------------- * 21430000
      * PROCESS THE WH STORE ASSIGN MESSAGES                            21440000
      * ------------------------------------------------------------- * 21450000
       6400-PROCESS-WH-STR-ASSIGN.                                      21460000
                                                                        21470000
           ADD 1 TO PA-WH-STR-ASSIGN-MSGS.                              21480000
                                                                        21490000
           MOVE HO100-SA-STORE-NUMBER TO PV-LOC-NBR.                    21500000
           MOVE PV-LOC-NBR            TO XMT00002-LOC-NBR.              21510000
                                                                        21520000
           IF HO100-ACTN-TYP-UPDATE                                     21530000
               PERFORM 6410-UPDATE-DC                                   21540000
               IF PS-INPUT-REC-ERROR                                    21550000
                   ADD 1 TO PA-WH-STR-ASSIGN-ERRORS                     21560000
               ELSE                                                     21570000
                   ADD 1 TO PA-WH-STR-ASSIGN-UPDATES                    21580000
               END-IF                                                   21590000
           ELSE                                                         21600000
               IF HO100-ACTN-TYP-INSERT                                 21610000
                   PERFORM 6420-INSERT-DC-LOC                           21620000
                   IF PS-INPUT-REC-ERROR                                21630000
                       ADD 1 TO PA-WH-STR-ASSIGN-ERRORS                 21640000
                   ELSE                                                 21650000
                       ADD 1 TO PA-WH-STR-ASSIGN-INSERTS                21660000
                   END-IF                                               21670000
               ELSE                                                     21680000
                   IF HO100-ACTN-TYP-DELETE                             21690000
                       PERFORM 6440-DELETE-DC-LOC                       21700000
                       IF PS-INPUT-REC-ERROR                            21710000
                           ADD 1 TO PA-WH-STR-ASSIGN-ERRORS             21720000
                       ELSE                                             21730000
                           ADD 1 TO PA-WH-STR-ASSIGN-DELETES            21740000
                       END-IF                                           21750000
                   END-IF                                               21760000
               END-IF                                                   21770000
           END-IF.                                                      21780000
                                                                        21790000
      * ------------------------------------------------------------- * 21800000
      * UPDATE THE BEG DATE OR DC ON THE XMT_DC_LOC_ASGMT               21810000
      * ------------------------------------------------------------- * 21820000
       6410-UPDATE-DC.                                                  21830000
                                                                        21840000
           MOVE '6410-UPDATE-DC' TO       PV-PARAGRAPH.                 21850000
                                                                        21860000
      *-- IF OLD AND NEW WH MATCHES MOVE OLD TO DC NBR                  21870000
      *-- ELSE MOVE NEW TO DC NBR                                       21880000
           IF HO100-SA-OLD-WH-2-4 = HO100-SA-WH-2-4                     21890000
               MOVE HO100-SA-OLD-WH-2-4 TO XMT00002-DC-NBR              21900000
           ELSE                                                         21910000
               MOVE HO100-SA-WH-2-4     TO XMT00002-DC-NBR              21920000
           END-IF.                                                      21930000
                                                                        21940000
                                                                        21990075
           IF HO100-SA-OLD-ASSIGN-DATE = HO100-SA-ASSIGN-DATE           22000000
               MOVE HO100-SA-OLD-ASSIGN-DATE TO XMT00002-EFF-BEG-DTE    22010000
           ELSE                                                         22020000
               MOVE HO100-SA-ASSIGN-DATE     TO XMT00002-EFF-BEG-DTE    22030000
           END-IF.                                                      22040000
                                                                        22050000
           IF HO100-SA-OLD-PO-STRT-DATE = HO100-SA-PO-STRT-DTE          22100000
               MOVE HO100-SA-OLD-PO-STRT-DATE TO XMT00002-PO-STRT-DTE   22110000
           ELSE                                                         22120000
               MOVE HO100-SA-PO-STRT-DTE      TO XMT00002-PO-STRT-DTE   22130000
           END-IF.                                                      22140000
                                                                        22150000
           PERFORM                                                      22160000
               WITH TEST AFTER                                          22170000
               VARYING PV-SQL-SUB                                       22180000
               FROM 1 BY 1                                              22190000
               UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        22200000
                  OR SQLCODE = ZERO                                     22210000
                  OR SQLCODE = PC-ROW-NOT-FOUND                         22220000
                  OR PS-INPUT-REC-ERROR                                 22230000
                                                                        22240000
               EXEC SQL                                                 22250000
                 UPDATE XMT_DC_LOC_ASGMT                                22260000
                    SET DC_NBR      = :XMT00002-DC-NBR                  22270000
                      , EFF_BEG_DTE = :XMT00002-EFF-BEG-DTE             22280000
                      , PO_STRT_DTE = :XMT00002-PO-STRT-DTE             22290000
                  WHERE  LOC_NBR    = :XMT00002-LOC-NBR                 22300000
                    AND EFF_BEG_DTE = :HO100-SA-OLD-ASSIGN-DATE         22310000
               END-EXEC                                                 22320000
                                                                        22330000
               EVALUATE TRUE                                            22340000
                   WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              22350000
                   WHEN SQLCODE = PC-DEADLOCK                           22360000
                   WHEN SQLCODE = ZERO                                  22370000
                        CONTINUE                                        22380000
                   WHEN SQLWARN0 NOT = SPACE                            22390000
                   WHEN SQLCODE NOT = ZERO                              22400000
                       MOVE 'BAD SQLCODE FOR UPDATE DC_LOC_ASGMT'       22410000
                                     TO  PV-MESSAGE                     22420000
                       PERFORM 9900-PROCESS-DB2-ERROR                   22430000
                       SET PS-INPUT-REC-ERROR TO TRUE                   22440000
               END-EVALUATE                                             22450000
           END-PERFORM.                                                 22460000
      *                                                                 22470000
           IF PV-SQL-SUB > PC-MAX-RETRIES                               22480000
               MOVE 'MAX RETRIES EXCEEDED FOR UPDATE DC_LOC_ASGMT'      22490000
                                     TO  PV-MESSAGE                     22500000
               PERFORM 9900-PROCESS-DB2-ERROR                           22510000
               SET PS-INPUT-REC-ERROR TO TRUE                           22520000
           END-IF.                                                      22530000
      * ------------------------------------------------------------- * 22540000
      * INSERT THE DC_LOC_ASGMT ROW                                     22550000
      * ------------------------------------------------------------- * 22560000
       6420-INSERT-DC-LOC.                                              22570000
                                                                        22580000
           MOVE '6400-INSERT-WH-ASSIGN' TO  PV-PARAGRAPH.               22590000
                                                                        22600000
           MOVE HO100-SA-ASSIGN-DATE  TO XMT00002-EFF-BEG-DTE.          22610000
           MOVE HO100-SA-PO-STRT-DTE  TO XMT00002-PO-STRT-DTE.          22620000
           MOVE HO100-SA-WH-2-4       TO XMT00002-DC-NBR.               22630000
                                                                        22640000
           PERFORM                                                      22650000
               WITH TEST AFTER                                          22660000
               VARYING PV-SQL-SUB                                       22670000
               FROM 1 BY 1                                              22680000
               UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        22690000
                  OR SQLCODE = 0                                        22700000
                  OR PS-INPUT-REC-ERROR                                 22710000
      *                                                                 22720000
                 EXEC SQL                                               22730000
                     INSERT INTO XMT_DC_LOC_ASGMT                       22740000
                              (LOC_NBR                                  22750000
                             , EFF_BEG_DTE                              22760000
                             , DC_NBR                                   22770000
                             , PO_STRT_DTE)                             22780000
                     VALUES (: XMT00002-LOC-NBR                         22790000
                           , : XMT00002-EFF-BEG-DTE                     22800000
                           , : XMT00002-DC-NBR                          22810000
                           , : XMT00002-PO-STRT-DTE)                    22820000
                 END-EXEC                                               22830000
      *                                                                 22840000
               EVALUATE TRUE                                            22850000
                   WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              22860000
                   WHEN SQLCODE = PC-DEADLOCK                           22870000
                   WHEN SQLCODE = ZERO                                  22880000
                        CONTINUE                                        22890000
                   WHEN SQLWARN0 NOT = SPACE                            22900000
                   WHEN SQLCODE NOT = ZERO                              22910000
                       MOVE 'BAD SQLCODE FOR INSERT DC_LOC_ASGMT'       22920000
                                     TO  PV-MESSAGE                     22930000
                       PERFORM 9900-PROCESS-DB2-ERROR                   22940000
                       SET PS-INPUT-REC-ERROR TO TRUE                   22950000
               END-EVALUATE                                             22960000
           END-PERFORM.                                                 22970000
      *                                                                 22980000
           IF  PV-SQL-SUB > PC-MAX-RETRIES                              22990000
               MOVE 'MAX RETRIES EXCEEDED FOR INSERT DC_LOC_ASGMT'      23000000
                                     TO  PV-MESSAGE                     23010000
               PERFORM 9900-PROCESS-DB2-ERROR                           23020000
               SET PS-INPUT-REC-ERROR TO TRUE                           23030000
           END-IF.                                                      23040000
                                                                        23050000
       6440-DELETE-DC-LOC.                                              23060000
                                                                        23070000
           MOVE '6440-DELETE-DC-LOC.' TO PV-PARAGRAPH.                  23080000
                                                                        23090000
           MOVE HO100-SA-ASSIGN-DATE  TO XMT00002-EFF-BEG-DTE.          23100000
                                                                        23110000
           PERFORM                                                      23120000
            WITH TEST AFTER                                             23130000
            VARYING PV-SQL-SUB                                          23140000
            FROM 1 BY 1                                                 23150000
            UNTIL PV-SQL-SUB > PC-MAX-RETRIES                           23160000
               OR SQLCODE = 0                                           23170000
               OR SQLCODE = PC-ROW-NOT-FOUND                            23180000
               OR PS-INPUT-REC-ERROR                                    23190000
                                                                        23200000
               EXEC SQL                                                 23210000
                   DELETE FROM XMT_DC_LOC_ASGMT                         23220000
                  WHERE  LOC_NBR    = :XMT00002-LOC-NBR                 23230000
                    AND EFF_BEG_DTE = :XMT00002-EFF-BEG-DTE             23240000
               END-EXEC                                                 23250000
                                                                        23260000
               EVALUATE TRUE                                            23270000
                   WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              23280000
                   WHEN SQLCODE = PC-DEADLOCK                           23290000
                   WHEN SQLCODE = PC-ROW-NOT-FOUND                      23300000
                   WHEN SQLCODE = ZERO                                  23310000
                        CONTINUE                                        23320000
                   WHEN SQLWARN0 NOT = SPACE                            23330000
                   WHEN SQLCODE NOT = ZERO                              23340000
                       MOVE 'BAD SQLCODE FOR DELETE WH'                 23350000
                                     TO  PV-MESSAGE                     23360000
                       PERFORM 9900-PROCESS-DB2-ERROR                   23370000
                       SET PS-INPUT-REC-ERROR TO TRUE                   23380000
               END-EVALUATE                                             23390000
           END-PERFORM.                                                 23400000
                                                                        23410000
           IF  PV-SQL-SUB > PC-MAX-RETRIES                              23420000
               MOVE 'MAX RETRIES EXCEEDED FOR DELETE WH'                23430000
                                     TO  PV-MESSAGE                     23440000
               PERFORM 9900-PROCESS-DB2-ERROR                           23450000
               SET PS-INPUT-REC-ERROR TO TRUE                           23460000
           END-IF.                                                      23470000
                                                                        23480000
1203RM 6460-SELECT-DC-LOC.                                              23481081
1203RM                                                                  23482081
1203RM     MOVE '6460-SELECT-DC-LOC.' TO PV-PARAGRAPH.                  23483081
1203RM                                                                  23484081
1203RM     PERFORM                                                      23487081
1203RM      WITH TEST AFTER                                             23488081
1203RM      VARYING PV-SQL-SUB                                          23489081
1203RM      FROM 1 BY 1                                                 23489181
1203RM      UNTIL PV-SQL-SUB > PC-MAX-RETRIES                           23489281
1203RM         OR SQLCODE = 0                                           23489381
1203RM         OR SQLCODE = PC-ROW-NOT-FOUND                            23489481
1203RM         OR PS-INPUT-REC-ERROR                                    23489581
1203RM                                                                  23489681
1203RM         EXEC SQL                                                 23489781
1203RM             SELECT LOC_NBR                                       23489881
1203RM                   ,EFF_BEG_DTE                                   23489981
1203RM                   ,DC_NBR                                        23490081
1203RM                   ,PO_STRT_DTE                                   23490181
1203RM               INTO :XMT00002-LOC-NBR                             23490281
1203RM                  , :XMT00002-EFF-BEG-DTE                         23490381
1203RM                  , :XMT00002-DC-NBR                              23490481
1203RM                  , :XMT00002-PO-STRT-DTE                         23490581
1203RM               FROM XMT_DC_LOC_ASGMT                              23490681
1203RM              WHERE LOC_NBR    = :XMT00002-LOC-NBR                23490781
1203RM         END-EXEC                                                 23490981
1203RM                                                                  23491081
1203RM         EVALUATE TRUE                                            23491281
1203RM             WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              23491381
1203RM             WHEN SQLCODE = PC-DEADLOCK                           23491481
1203RM             WHEN SQLCODE = PC-ROW-NOT-FOUND                      23491587
1203RM             WHEN SQLCODE = ZERO                                  23491786
1203RM                  CONTINUE                                        23491886
1203RM             WHEN SQLWARN0 NOT = SPACE                            23491986
1203RM             WHEN SQLCODE NOT = ZERO                              23492086
1203RM                 MOVE 'BAD SQLCODE FOR SELECT DC_LOC_ASGMT'       23492186
1203RM                               TO  PV-MESSAGE                     23492286
1203RM                 PERFORM 9900-PROCESS-DB2-ERROR                   23492386
1203RM                 SET PS-INPUT-REC-ERROR TO TRUE                   23492486
1203RM         END-EVALUATE                                             23492586
1203RM     END-PERFORM.                                                 23492686
1203RM                                                                  23492786
1203RM     IF  PV-SQL-SUB > PC-MAX-RETRIES                              23492886
1203RM         MOVE 'MAX RETRIES EXCEEDED FOR SELECT DC_LOC_ASGMT'      23492986
1203RM                               TO  PV-MESSAGE                     23493086
1203RM         PERFORM 9900-PROCESS-DB2-ERROR                           23493186
1203RM         SET PS-INPUT-REC-ERROR TO TRUE                           23493286
1203RM     END-IF.                                                      23493386
                                                                        23493486
      * ------------------------------------------------------------- * 23494081
      * PROCESS THE OUTLOC MESSAGES                                     23500000
      * ------------------------------------------------------------- * 23510000
       6500-PROCESS-OUTLOC.                                             23520000
                                                                        23530000
           ADD 1 TO PA-OUTLOC-MESSAGES.                                 23540000
                                                                        23550000
           IF HO100-ACTN-TYP-INSERT                                     23560000
               INITIALIZE DCLXMT00001                                   23570000
               PERFORM 6510-INS-UPD-STORE-ROW                           23580000
               PERFORM 6520-INSERT-OUTLOC-LOC-ROW                       23590000
               IF PS-INPUT-REC-ERROR                                    23600000
                   ADD 1 TO PA-OUTLOC-ERRORS                            23610000
               ELSE                                                     23620000
                   ADD 1 TO PA-OUTLOC-INSERTS                           23630000
               END-IF                                                   23640000
           ELSE                                                         23650000
               IF HO100-ACTN-TYP-UPDATE                                 23660000
                   PERFORM 6510-INS-UPD-STORE-ROW                       23670000
                   PERFORM 6530-UPDATE-OUTLOC-LOC-ROW                   23680000
                   IF PS-INPUT-REC-ERROR                                23690000
                       ADD 1 TO PA-OUTLOC-ERRORS                        23700000
                   ELSE                                                 23710000
                       ADD 1 TO PA-OUTLOC-UPDATES                       23720000
                   END-IF                                               23730000
               ELSE                                                     23740000
                   IF HO100-ACTN-TYP-DELETE                             23750000
                       MOVE HO100-OTLC-ID      TO XMT00001-LOC-NBR      23770097
                       PERFORM 6050-DELETE-LOC-ROW                      23780000
                       IF PS-INPUT-REC-ERROR                            23790000
                           ADD 1 TO PA-OUTLOC-ERRORS                    23800000
                       ELSE                                             23810000
                           ADD 1 TO PA-OUTLOC-DELETES                   23820000
                       END-IF                                           23830000
                   END-IF                                               23840000
               END-IF                                                   23850000
           END-IF.                                                      23860000
                                                                        23870000
                                                                        23880000
      * ------------------------------------------------------------- * 23890000
      *   UPDATE/INSERT STORE LEVEL DATA WITH OUTLOC DATA               23900000
      * ------------------------------------------------------------- * 23910000
       6510-INS-UPD-STORE-ROW.                                          23920000
                                                                        23930000
           MOVE HO100-OTLC-ID            TO XMT00001-LOC-NBR.           23950097
      *    DISPLAY 'HO100-OTLC-ID    ' HO100-OTLC-ID.                   23960000
      *    DISPLAY 'XMT00001-LOC-NBR ' XMT00001-LOC-NBR.                23980000
                                                                        23990000
           MOVE HO100-OTLC-TYPE          TO XMT00001-LOC-TYP-CDE.       24000000
           MOVE HO100-OTLC-DESC          TO XMT00001-LOC-NM.            24010000
           MOVE HO100-OTLC-NM-5-ABBR     TO XMT00001-LOC-5-ABBR-NM.     24020000
0519PK     MOVE HO100-OUTLOC-DESC1-10    TO XMT00001-LOC-10-ABBR-NM.    24021098
           MOVE HO100-OTLC-ADD1          TO XMT00001-LNE-1-ADDR.        24030000
           MOVE HO100-OTLC-ADD2          TO XMT00001-LNE-2-ADDR.        24040000
           MOVE HO100-OTLC-CITY          TO XMT00001-CTY-NM.            24050000
           MOVE HO100-OTLC-STATE         TO XMT00001-ST-CDE.            24060000
           MOVE HO100-OTLC-POST          TO XMT00001-ZIP-10-CDE.        24070000
           MOVE HO100-OTLC-CONTACT-PHONE TO XMT00001-PHN-NBR.           24080000
           MOVE HO100-OTLC-OPN-DTE       TO XMT00001-OPN-DTE.           24090000
           MOVE HO100-OTLC-CLO-DTE       TO XMT00001-CLO-DTE.           24100000
                                                                        24110000
      * ------------------------------------------------------------- * 24120000
      * INSERT THE OUTLOC DATA ON THE XMT_LOC TABLE                   * 24130000
      * ------------------------------------------------------------- * 24140000
       6520-INSERT-OUTLOC-LOC-ROW.                                      24150000
                                                                        24160000
           MOVE '6520-INSERT-OUTLOC-LOC-ROW. ' TO PV-PARAGRAPH.         24170000
                                                                        24180000
           PERFORM                                                      24190000
               WITH TEST AFTER                                          24200000
               VARYING PV-SQL-SUB                                       24210000
               FROM 1 BY 1                                              24220000
               UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        24230000
                  OR SQLCODE = 0                                        24240000
                  OR PS-INPUT-REC-ERROR                                 24250000
      *                                                                 24260000
             EXEC SQL                                                   24270000
               INSERT INTO XMT_LOC                                      24280000
                   ( LOC_NBR                                            24290000
                   , LOC_TYP_CDE                                        24300000
                   , LOC_NM                                             24310000
                   , LOC_5_ABBR_NM                                      24320000
                   , LNE_1_ADDR                                         24330000
                   , LNE_2_ADDR                                         24340000
                   , CTY_NM                                             24350000
                   , ST_CDE                                             24360000
                   , ZIP_10_CDE                                         24370000
                   , PHN_NBR                                            24380000
                   , OPN_DTE                                            24390000
                   , CLO_DTE                                            24400000
                   , LAST_UPD_TMST                                      24411098
0404PK             , LOC_10_ABBR_NM)                                    24412098
          VALUES                                                        24420000
                 ( : XMT00001-LOC-NBR                                   24430000
                 , : XMT00001-LOC-TYP-CDE                               24440000
                 , : XMT00001-LOC-NM                                    24450000
                 , : XMT00001-LOC-5-ABBR-NM                             24460000
                 , : XMT00001-LNE-1-ADDR                                24470000
                 , : XMT00001-LNE-2-ADDR                                24480000
                 , : XMT00001-CTY-NM                                    24490000
                 , : XMT00001-ST-CDE                                    24500000
                 , : XMT00001-ZIP-10-CDE                                24510000
                 , : XMT00001-PHN-NBR                                   24520000
                 , : XMT00001-OPN-DTE                                   24530000
                 , : XMT00001-CLO-DTE                                   24540000
                 , CURRENT TIMESTAMP                                    24551098
0519PK           , : XMT00001-LOC-10-ABBR-NM)                           24552098
             END-EXEC                                                   24560000
                                                                        24570000
               EVALUATE TRUE                                            24580000
                   WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              24590000
                   WHEN SQLCODE = PC-DEADLOCK                           24600000
                   WHEN SQLCODE = ZERO                                  24610000
                   WHEN SQLCODE = PC-ROW-NOT-FOUND                      24620000
                        CONTINUE                                        24630000
                   WHEN SQLWARN0 NOT = SPACE                            24640000
                   WHEN SQLCODE NOT = ZERO                              24650000
                       MOVE 'BAD SQLCODE ON INSERT TO XMT_LOC'          24660000
                                     TO  PV-MESSAGE                     24670000
                       PERFORM 9900-PROCESS-DB2-ERROR                   24680000
                       SET PS-INPUT-REC-ERROR TO TRUE                   24690000
               END-EVALUATE                                             24700000
           END-PERFORM.                                                 24710000
      *                                                                 24720000
           IF PV-SQL-SUB > PC-MAX-RETRIES                               24730000
               MOVE 'MAX RETRIES EXCEEDED ON INSERT TO XMT_LOC'         24740000
                                     TO  PV-MESSAGE                     24750000
               PERFORM 9900-PROCESS-DB2-ERROR                           24760000
               SET PS-INPUT-REC-ERROR TO TRUE                           24770000
           END-IF.                                                      24780000
                                                                        24790000
      * ------------------------------------------------------------- * 24800000
      * PERFORM THE UPDATE OF THE OUTLOC DATA TO THE XMT_LOC TABLE    * 24810000
      * ------------------------------------------------------------- * 24820000
       6530-UPDATE-OUTLOC-LOC-ROW.                                      24830000
                                                                        24840000
           MOVE '6530-UPDATE-OUTLOC-LOC-ROW.' TO PV-PARAGRAPH.          24850000
                                                                        24860000
           PERFORM                                                      24870000
               WITH TEST AFTER                                          24880000
               VARYING PV-SQL-SUB                                       24890000
               FROM 1 BY 1                                              24900000
               UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        24910000
                  OR SQLCODE = 0                                        24920000
                  OR PS-INPUT-REC-ERROR                                 24930000
      *                                                                 24940000
             EXEC SQL                                                   24950000
               UPDATE XMT_LOC                                           24960000
                  SET LOC_NM           = :XMT00001-LOC-NM               24970000
                    , LOC_5_ABBR_NM    = :XMT00001-LOC-5-ABBR-NM        24980000
                    , LNE_1_ADDR       = :XMT00001-LNE-1-ADDR           24990000
                    , LNE_2_ADDR       = :XMT00001-LNE-2-ADDR           25000000
                    , CTY_NM           = :XMT00001-CTY-NM               25010000
                    , ST_CDE           = :XMT00001-ST-CDE               25020000
                    , ZIP_10_CDE       = :XMT00001-ZIP-10-CDE           25030000
                    , PHN_NBR          = :XMT00001-PHN-NBR              25040000
                    , OPN_DTE          = :XMT00001-OPN-DTE              25050000
                    , CLO_DTE          = :XMT00001-CLO-DTE              25060000
                    , LAST_UPD_TMST    = CURRENT TIMESTAMP              25070000
0519PK              , LOC_10_ABBR_NM   = :XMT00001-LOC-10-ABBR-NM       25071098
               WHERE LOC_NBR           = :XMT00001-LOC-NBR              25080000
             END-EXEC                                                   25090000
                                                                        25100000
               EVALUATE TRUE                                            25110000
                   WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              25120000
                   WHEN SQLCODE = PC-DEADLOCK                           25130000
                   WHEN SQLCODE = ZERO                                  25140000
                   WHEN SQLCODE = PC-ROW-NOT-FOUND                      25150000
                        CONTINUE                                        25160000
                   WHEN SQLWARN0 NOT = SPACE                            25170000
                   WHEN SQLCODE NOT = ZERO                              25180000
                       MOVE 'BAD SQLCODE FOR UPDATE XMT_LOC'            25190000
                                     TO  PV-MESSAGE                     25200000
                       PERFORM 9900-PROCESS-DB2-ERROR                   25210000
                       SET PS-INPUT-REC-ERROR TO TRUE                   25220000
               END-EVALUATE                                             25230000
           END-PERFORM.                                                 25240000
      *                                                                 25250000
           IF PV-SQL-SUB > PC-MAX-RETRIES                               25260000
               MOVE 'MAX RETRIES EXCEEDED FOR UPDATE XMT_LOC'           25270000
                                     TO  PV-MESSAGE                     25280000
               PERFORM 9900-PROCESS-DB2-ERROR                           25290000
               SET PS-INPUT-REC-ERROR TO TRUE                           25300000
           END-IF.                                                      25310000
                                                                        25320000
      * ------------------------------------------------------------- * 25330000
      *   PROCESS THE PRICE_ZONE_GROUP DATA                             25340000
      * ------------------------------------------------------------- * 25350000
       6600-PROCESS-STR-GP-TYP.                                         25360000
                                                                        25370000
           ADD 1 TO PA-STR-GP-TYP-MSGS.                                 25380000
                                                                        25390000
           MOVE HO100-PZG-STR-GP-TYP-CDE TO XMT00005-STR-GP-TYP-CDE.    25400000
           MOVE HO100-PZG-STR-GP-CTG-NM  TO XMT00005-STR-GP-TYP-NM.     25410000
                                                                        25420000
           IF HO100-ACTN-TYP-UPDATE                                     25430000
               PERFORM 6610-UPDATE-STR-GP-TYP-ROW                       25440000
               IF PS-INPUT-REC-ERROR                                    25450000
                   ADD 1 TO PA-STR-GP-TYP-ERRORS                        25460000
               ELSE                                                     25470000
                   ADD 1 TO PA-STR-GP-TYP-UPDATES                       25480000
               END-IF                                                   25490000
           ELSE                                                         25500000
               IF HO100-ACTN-TYP-INSERT                                 25510000
                   PERFORM 6620-INSERT-STR-GP-TYP-ROW                   25520000
                   IF PS-INPUT-REC-ERROR                                25530000
                       ADD 1 TO PA-STR-GP-TYP-ERRORS                    25540000
                   ELSE                                                 25550000
                       ADD 1 TO PA-STR-GP-TYP-INSERTS                   25560000
                   END-IF                                               25570000
               ELSE                                                     25580000
                   IF HO100-ACTN-TYP-DELETE                             25590000
                       PERFORM 6630-DELETE-STR-GP-TYP-ROW               25600000
                       IF PS-INPUT-REC-ERROR                            25610000
                           ADD 1 TO PA-STR-GP-TYP-ERRORS                25620000
                       ELSE                                             25630000
                           ADD 1 TO PA-STR-GP-TYP-DELETES               25640000
                       END-IF                                           25650000
                   END-IF                                               25660000
               END-IF                                                   25670000
           END-IF.                                                      25680000
                                                                        25690000
      * ------------------------------------------------------------- * 25700000
      * UPDATE THE XMT-STR-GP-TYP ROW                                   25710000
      * ------------------------------------------------------------- * 25720000
       6610-UPDATE-STR-GP-TYP-ROW.                                      25730000
                                                                        25740000
           MOVE '6610-UPDATE-STR-GP-TYP-ROW' TO  PV-PARAGRAPH.          25750000
                                                                        25760000
           PERFORM                                                      25770000
               WITH TEST AFTER                                          25780000
               VARYING PV-SQL-SUB                                       25790000
               FROM 1 BY 1                                              25800000
               UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        25810000
                  OR SQLCODE = 0                                        25820000
                  OR SQLCODE = PC-ROW-NOT-FOUND                         25830000
                  OR PS-INPUT-REC-ERROR                                 25840000
                                                                        25850000
                 EXEC SQL                                               25860000
                     UPDATE XMT_STR_GP_TYP                              25870000
                     SET STR_GP_TYP_NM =    :XMT00005-STR-GP-TYP-NM     25880000
                     WHERE STR_GP_TYP_CDE = :XMT00005-STR-GP-TYP-CDE    25890000
                 END-EXEC                                               25900000
                                                                        25910000
               EVALUATE TRUE                                            25920000
                   WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              25930000
                   WHEN SQLCODE = PC-DEADLOCK                           25940000
                   WHEN SQLCODE = PC-ROW-NOT-FOUND                      25950000
                   WHEN SQLCODE = ZERO                                  25960000
                        CONTINUE                                        25970000
                   WHEN SQLWARN0 NOT = SPACE                            25980000
                   WHEN SQLCODE NOT = ZERO                              25990000
                       MOVE 'BAD SQLCODE FOR UPDATE XMT_STR_GP_TYP'     26000000
                                     TO  PV-MESSAGE                     26010000
                       PERFORM 9900-PROCESS-DB2-ERROR                   26020000
                       SET PS-INPUT-REC-ERROR TO TRUE                   26030000
               END-EVALUATE                                             26040000
           END-PERFORM.                                                 26050000
                                                                        26060000
           IF  PV-SQL-SUB > PC-MAX-RETRIES                              26070000
               MOVE 'MAX RETRIES EXCEEDED FOR UPDATE XMT_STR_GP_TYP'    26080000
                                     TO  PV-MESSAGE                     26090000
               PERFORM 9900-PROCESS-DB2-ERROR                           26100000
               SET PS-INPUT-REC-ERROR TO TRUE                           26110000
           END-IF.                                                      26120000
                                                                        26130000
           IF SQLCODE = PC-ROW-NOT-FOUND                                26140000
               MOVE 'XMT_STR_GP_TYP ROW NOT FOUND FOR UPDATE'           26150000
                                     TO  PV-MESSAGE                     26160000
               PERFORM 9900-PROCESS-DB2-ERROR                           26170000
           END-IF.                                                      26180000
                                                                        26190000
      * ------------------------------------------------------------- * 26200000
      * INSERT THE XMT_STR_GP_TYP ROW                                   26210000
      * ------------------------------------------------------------- * 26220000
       6620-INSERT-STR-GP-TYP-ROW.                                      26230000
                                                                        26240000
           MOVE '6620-INSERT-STR-GP-TYP-ROW' TO PV-PARAGRAPH.           26250000
                                                                        26260000
           PERFORM                                                      26270000
               WITH TEST AFTER                                          26280000
               VARYING PV-SQL-SUB                                       26290000
               FROM 1 BY 1                                              26300000
               UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        26310000
                  OR SQLCODE = 0                                        26320000
                  OR PS-INPUT-REC-ERROR                                 26330000
                                                                        26340000
                 EXEC SQL                                               26350000
                     INSERT INTO XMT_STR_GP_TYP                         26360000
                            (STR_GP_TYP_CDE                             26370000
                           , STR_GP_TYP_NM)                             26380000
                     VALUES (:XMT00005-STR-GP-TYP-CDE                   26390000
                           , :XMT00005-STR-GP-TYP-NM)                   26400000
                 END-EXEC                                               26410000
                                                                        26420000
               EVALUATE TRUE                                            26430000
                   WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              26440000
                   WHEN SQLCODE = PC-DEADLOCK                           26450000
                   WHEN SQLCODE = ZERO                                  26460000
                        CONTINUE                                        26470000
                   WHEN SQLWARN0 NOT = SPACE                            26480000
                   WHEN SQLCODE NOT =  ZERO                             26490000
                       MOVE 'BAD SQLCODE FOR INSERT XMT_STR_GP_TYP'     26500000
                                     TO  PV-MESSAGE                     26510000
                       PERFORM 9900-PROCESS-DB2-ERROR                   26520000
                       SET PS-INPUT-REC-ERROR TO TRUE                   26530000
               END-EVALUATE                                             26540000
           END-PERFORM.                                                 26550000
                                                                        26560000
           IF PV-SQL-SUB > PC-MAX-RETRIES                               26570000
               MOVE  'MAX RETRIES EXCEEDED FOR INSERT XMT_STR_GP_TYP'   26580000
                      TO PV-MESSAGE                                     26590000
               PERFORM 9900-PROCESS-DB2-ERROR                           26600000
               SET PS-INPUT-REC-ERROR TO TRUE                           26610000
           END-IF.                                                      26620000
                                                                        26630000
      * ------------------------------------------------------------- * 26640000
      * DELETE THE XMT_STR_GP_TYP ROW                                   26650000
      * ------------------------------------------------------------- * 26660000
       6630-DELETE-STR-GP-TYP-ROW.                                      26670000
                                                                        26680000
           MOVE '6630-DELETE-STR-GP-TYP-ROW' TO  PV-PARAGRAPH.          26690000
                                                                        26700000
           PERFORM                                                      26710000
               WITH TEST AFTER                                          26720000
               VARYING PV-SQL-SUB                                       26730000
               FROM 1 BY 1                                              26740000
               UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        26750000
                  OR SQLCODE = 0                                        26760000
                  OR SQLCODE = PC-ROW-NOT-FOUND                         26770000
                  OR PS-INPUT-REC-ERROR                                 26780000
                                                                        26790000
                 EXEC SQL                                               26800000
                     DELETE FROM XMT_STR_GP_TYP                         26810000
                     WHERE STR_GP_TYP_CDE = : XMT00005-STR-GP-TYP-CDE   26820000
                 END-EXEC                                               26830000
                                                                        26840000
               EVALUATE TRUE                                            26850000
                   WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              26860000
                   WHEN SQLCODE = PC-DEADLOCK                           26870000
                   WHEN SQLCODE = PC-ROW-NOT-FOUND                      26880000
                   WHEN SQLCODE = ZERO                                  26890000
                        CONTINUE                                        26900000
                   WHEN SQLWARN0 NOT = SPACE                            26910000
                   WHEN SQLCODE NOT = ZERO                              26920000
                       MOVE 'BAD SQLCODE FOR DELETE XMT_STR_GP_TYP'     26930000
                                     TO  PV-MESSAGE                     26940000
                       PERFORM 9900-PROCESS-DB2-ERROR                   26950000
                       SET PS-INPUT-REC-ERROR TO TRUE                   26960000
               END-EVALUATE                                             26970000
           END-PERFORM.                                                 26980000
                                                                        26990000
           IF  PV-SQL-SUB > PC-MAX-RETRIES                              27000000
               MOVE 'MAX RETRIES EXCEEDED FOR DELETE XMT_STR_GP_TYP'    27010000
                                     TO  PV-MESSAGE                     27020000
               PERFORM 9900-PROCESS-DB2-ERROR                           27030000
               SET PS-INPUT-REC-ERROR TO TRUE                           27040000
           END-IF.                                                      27050000
                                                                        27060000
           IF SQLCODE = PC-ROW-NOT-FOUND                                27070000
               MOVE 'STR-GP-TYP-ROW NOT FOUND FOR XMT_STR_GP_TYP'       27080000
                                     TO  PV-MESSAGE                     27090000
               PERFORM 9900-PROCESS-DB2-ERROR                           27100000
           END-IF.                                                      27110000
                                                                        27120000
      *----------------------------------------------------------------*27130000
      *   PROCESS THE PRICE-ZONE & K-EMT-METRO-PRICE-ZONE MESSAGES TO   27140000
      *   INSERT, UPDATE OR DELETE ROWS ON THE XMT_STR_GP TABLE.        27150000
      *   PERFORM SEPARATE UPDATE MODULES DEPENDING ON THE SOURCE TABLE.27160000
      *----------------------------------------------------------------*27170000
       6700-PROCESS-STR-GP.                                             27180000
           MOVE '6700-PROCESS-STR-GP       ' TO PV-PARAGRAPH.           27190000
                                                                        27200000
           ADD 1 TO PA-STR-GP-MSGS.                                     27210000
                                                                        27220000
           IF HO100-ACTN-TYP-INSERT                                     27230000
               INITIALIZE DCLXMT00004                                   27240000
           END-IF.                                                      27250000
                                                                        27260000
           IF HO100-RMS-TBL-NAME = PC-PRICE-ZONE                        27270000
               MOVE HO100-PZ-GROUP-ID      TO XMT00004-STR-GP-TYP-CDE   27280000
               MOVE HO100-PZ-ZONE-ID       TO XMT00004-STR-GP-ID        27290000
               MOVE HO100-PZ-DESCRIPTION   TO XMT00004-STR-GP-NM        27300000
               ADD 1 TO PA-PRICE-ZONE-MSGS                              27310000
           ELSE                                                         27320000
              IF HO100-RMS-TBL-NAME = PC-K-EMT-METRO-PRICE-ZONE         27330000
                  MOVE HO100-METRO-GROUP-ID TO XMT00004-STR-GP-TYP-CDE  27500000
                  MOVE HO100-METRO-ZONE-ID  TO XMT00004-STR-GP-ID       27510000
                  MOVE HO100-METRO-ST-CDE   TO XMT00004-ST-CDE          27520000
                  MOVE HO100-METRO-RPT-FLSH-SLS-IND  TO                 27530000
                       XMT00004-RPT-FLSH-SLS-IND                        27540000
                  MOVE HO100-METRO-DESCRIPTION TO XMT00004-STR-GP-NM    27550000
                  ADD 1 TO PA-METRO-PRICE-ZONE-MSGS                     27560000
              END-IF                                                    27570000
           END-IF.                                                      27580000
                                                                        27590000
           IF HO100-ACTN-TYP-INSERT                                     27600000
               PERFORM 6710-INSERT-STR-GP-ROW                           27610000
               IF PS-INPUT-REC-ERROR                                    27620000
                   ADD 1 TO PA-STR-GP-ERRORS                            27630000
               ELSE                                                     27640000
                   ADD 1 TO PA-STR-GP-INSERTS                           27650000
               END-IF                                                   27660000
           ELSE                                                         27670000
               IF HO100-ACTN-TYP-UPDATE                                 27680000
                   IF HO100-RMS-TBL-NAME = PC-PRICE-ZONE                27690000
                       PERFORM 6720-UPDATE-STR-GP-ROW                   27700000
                   ELSE                                                 27710000
                       PERFORM 6725-UPDATE-STR-GP-MPZ-ROW               27720000
                   END-IF                                               27730000
                   IF PS-INPUT-REC-ERROR                                27740000
                       ADD 1 TO PA-STR-GP-ERRORS                        27750000
                   ELSE                                                 27760000
                       ADD 1 TO PA-STR-GP-UPDATES                       27770000
                   END-IF                                               27780000
               ELSE                                                     27790000
                   IF HO100-ACTN-TYP-DELETE                             27800000
                       PERFORM 6730-DELETE-STR-GP-ROW                   27810000
                       IF PS-INPUT-REC-ERROR                            27820000
                           ADD 1 TO PA-STR-GP-ERRORS                    27830000
                       ELSE                                             27840000
                           ADD 1 TO PA-STR-GP-DELETES                   27850000
                       END-IF                                           27860000
                   END-IF                                               27870000
               END-IF                                                   27880000
           END-IF.                                                      27890000
      *----------------------------------------------------------------*27900000
      *   INSERT A ROW TO THE XMT_STR_GP TABLE                          27910000
      *----------------------------------------------------------------*27920000
       6710-INSERT-STR-GP-ROW.                                          27930000
                                                                        27940000
           MOVE '6710-INSERT-STR-GP-ROW' TO PV-PARAGRAPH.               27950000
                                                                        27960000
           PERFORM                                                      27970000
               WITH TEST AFTER                                          27980000
               VARYING PV-SQL-SUB                                       27990000
               FROM 1 BY 1                                              28000000
               UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        28010000
                  OR SQLCODE = 0                                        28020000
                  OR PS-INPUT-REC-ERROR                                 28030000
                                                                        28040000
                 EXEC SQL                                               28050000
                     INSERT INTO XMT_STR_GP                             28060000
                            ( STR_GP_TYP_CDE                            28070000
                             ,STR_GP_ID                                 28080000
                             ,STR_GP_NM                                 28090000
                             ,ST_CDE                                    28100000
                             ,RPT_FLSH_SLS_IND)                         28110000
                     VALUES (:XMT00004-STR-GP-TYP-CDE                   28120000
                           , :XMT00004-STR-GP-ID                        28130000
                           , :XMT00004-STR-GP-NM                        28140000
                           , :XMT00004-ST-CDE                           28150000
                           , :XMT00004-RPT-FLSH-SLS-IND)                28160000
                 END-EXEC                                               28170000
                                                                        28180000
               EVALUATE TRUE                                            28190000
                   WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              28200000
                   WHEN SQLCODE = PC-DEADLOCK                           28210000
                   WHEN SQLCODE = PC-ROW-NOT-FOUND                      28220000
                   WHEN SQLCODE = ZERO                                  28230000
                        CONTINUE                                        28240000
                   WHEN SQLCODE = PC-DUP-ROW                            28250000
                        PERFORM 6715-CHECK-INPUT-SOURCE                 28260000
                   WHEN SQLWARN0 NOT = SPACE                            28270000
                   WHEN SQLCODE NOT = ZERO                              28280000
                       MOVE 'BAD SQLCODE FOR INSERT XMT_STR_GP'         28290000
                                     TO  PV-MESSAGE                     28300000
                       PERFORM 9900-PROCESS-DB2-ERROR                   28310000
                       SET PS-INPUT-REC-ERROR TO TRUE                   28320000
               END-EVALUATE                                             28330000
           END-PERFORM.                                                 28340000
                                                                        28350000
           IF  PV-SQL-SUB > PC-MAX-RETRIES                              28360000
               MOVE 'MAX RETRIES EXCEEDED FOR INSERT XMT_STR_GP'        28370000
                                     TO  PV-MESSAGE                     28380000
               PERFORM 9900-PROCESS-DB2-ERROR                           28390000
               SET PS-INPUT-REC-ERROR TO TRUE                           28400000
           END-IF.                                                      28410000
                                                                        28420000
      *----------------------------------------------------------------*28430000
      *   CHECK IF INPUT RECORD IS FROM K_EMT_METRO_PRICE_ZONE ON AN    28440000
      *   INSERT.  IF IT IS, PERFORM UPDATE MODULE.                     28450000
      *----------------------------------------------------------------*28460000
       6715-CHECK-INPUT-SOURCE.                                         28470000
                                                                        28480000
           IF HO100-RMS-TBL-NAME = PC-K-EMT-METRO-PRICE-ZONE            28490000
               PERFORM 6725-UPDATE-STR-GP-MPZ-ROW                       28500000
           ELSE                                                         28510000
               MOVE 'BAD SQLCODE FOR INSERT XMT_STR_GP'                 28520000
                             TO PV-MESSAGE                              28530000
               PERFORM 9900-PROCESS-DB2-ERROR                           28540000
               SET PS-INPUT-REC-ERROR TO TRUE                           28550000
           END-IF.                                                      28560000
                                                                        28570000
      *----------------------------------------------------------------*28580000
      *   UPDATE A ROW TO THE XMT_STR_GP TABLE                          28590000
      *----------------------------------------------------------------*28600000
       6720-UPDATE-STR-GP-ROW.                                          28610000
                                                                        28620000
           MOVE '6720-UPDATE-STR-GP-ROW' TO PV-PARAGRAPH.               28630000
                                                                        28640000
           PERFORM                                                      28650000
               WITH TEST AFTER                                          28660000
               VARYING PV-SQL-SUB                                       28670000
               FROM 1 BY 1                                              28680000
               UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        28690000
                  OR SQLCODE = 0                                        28700000
                  OR SQLCODE = PC-ROW-NOT-FOUND                         28710000
                  OR PS-INPUT-REC-ERROR                                 28720000
                                                                        28730000
                 EXEC SQL                                               28740000
                     UPDATE XMT_STR_GP                                  28750000
                     SET STR_GP_NM        = :XMT00004-STR-GP-NM         28760000
                     WHERE STR_GP_TYP_CDE = :XMT00004-STR-GP-TYP-CDE    28770000
                       AND STR_GP_ID      = :XMT00004-STR-GP-ID         28780000
                 END-EXEC                                               28790000
                                                                        28800000
               EVALUATE TRUE                                            28810000
                   WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              28820000
                   WHEN SQLCODE = PC-DEADLOCK                           28830000
                   WHEN SQLCODE = PC-ROW-NOT-FOUND                      28840000
                   WHEN SQLCODE = ZERO                                  28850000
                        CONTINUE                                        28860000
                   WHEN SQLWARN0 NOT = SPACE                            28870000
                   WHEN SQLCODE NOT = ZERO                              28880000
                       MOVE 'BAD SQLCODE FOR UPDATE XMT_STR_GP'         28890099
                                     TO  PV-MESSAGE                     28900000
                       PERFORM 9900-PROCESS-DB2-ERROR                   28910000
                       SET PS-INPUT-REC-ERROR TO TRUE                   28920000
               END-EVALUATE                                             28930000
           END-PERFORM.                                                 28940000
                                                                        28950000
           IF  PV-SQL-SUB > PC-MAX-RETRIES                              28960000
               MOVE 'MAX RETRIES EXCEEDED FOR UPDATE XMT_STR_GP'        28970099
                                     TO  PV-MESSAGE                     28980000
               PERFORM 9900-PROCESS-DB2-ERROR                           28990000
               SET PS-INPUT-REC-ERROR TO TRUE                           29000000
           END-IF.                                                      29010000
                                                                        29020000
           IF SQLCODE = PC-ROW-NOT-FOUND                                29030000
               MOVE 'XMT_STR_GP ROW NOT FOUND FOR UPDATE'               29040099
                                     TO  PV-MESSAGE                     29050000
               PERFORM 9900-PROCESS-DB2-ERROR                           29060000
           END-IF.                                                      29070000
                                                                        29080000
      *----------------------------------------------------------------*29090000
      *   UPDATE A ROW TO THE XMT_STR_GP TABLE WITH METRO PRICE ZONE    29100000
      *   DATA.                                                         29110000
      *----------------------------------------------------------------*29120000
       6725-UPDATE-STR-GP-MPZ-ROW.                                      29130000
                                                                        29140000
           MOVE '6720-UPDATE-STR-GP-MPZ-ROW' TO PV-PARAGRAPH.           29150000
                                                                        29160000
           PERFORM                                                      29170000
               WITH TEST AFTER                                          29180000
               VARYING PV-SQL-SUB                                       29190000
               FROM 1 BY 1                                              29200000
               UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        29210000
                  OR SQLCODE = 0                                        29220000
                  OR SQLCODE = PC-ROW-NOT-FOUND                         29230000
                  OR PS-INPUT-REC-ERROR                                 29240000
                                                                        29250000
                 EXEC SQL                                               29260000
                     UPDATE XMT_STR_GP                                  29270000
                     SET STR_GP_NM        = :XMT00004-STR-GP-NM         29280000
                       , ST_CDE           = :XMT00004-ST-CDE            29290000
                       , RPT_FLSH_SLS_IND = :XMT00004-RPT-FLSH-SLS-IND  29300000
                     WHERE STR_GP_TYP_CDE = :XMT00004-STR-GP-TYP-CDE    29310000
                       AND STR_GP_ID      = :XMT00004-STR-GP-ID         29320000
                 END-EXEC                                               29330000
                                                                        29340000
               EVALUATE TRUE                                            29350000
                   WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              29360000
                   WHEN SQLCODE = PC-DEADLOCK                           29370000
                   WHEN SQLCODE = PC-ROW-NOT-FOUND                      29380000
                   WHEN SQLCODE = ZERO                                  29390000
                        CONTINUE                                        29400000
                   WHEN SQLWARN0 NOT = SPACE                            29410000
                   WHEN SQLCODE NOT = ZERO                              29420000
                       MOVE 'BAD SQLCODE FOR UPDATE XMT_STR_GP'         29430099
                                     TO  PV-MESSAGE                     29440000
                       PERFORM 9900-PROCESS-DB2-ERROR                   29450000
                       SET PS-INPUT-REC-ERROR TO TRUE                   29460000
               END-EVALUATE                                             29470000
           END-PERFORM.                                                 29480000
                                                                        29490000
           IF  PV-SQL-SUB > PC-MAX-RETRIES                              29500000
               MOVE 'MAX RETRIES EXCEEDED FOR UPDATE XMT_STR_GP'        29510099
                                     TO  PV-MESSAGE                     29520000
               PERFORM 9900-PROCESS-DB2-ERROR                           29530000
               SET PS-INPUT-REC-ERROR TO TRUE                           29540000
           END-IF.                                                      29550000
                                                                        29560000
           IF SQLCODE = PC-ROW-NOT-FOUND                                29570000
               MOVE 'XMT_STR_GP ROW NOT FOUND FOR UPDATE'               29580099
                                     TO  PV-MESSAGE                     29590000
               PERFORM 9900-PROCESS-DB2-ERROR                           29600000
           END-IF.                                                      29610000
                                                                        29620000
      *----------------------------------------------------------------*29630000
      *   DELETE A ROW TO THE XMT_STR_GP TABLE                          29640000
      *----------------------------------------------------------------*29650000
       6730-DELETE-STR-GP-ROW.                                          29660000
                                                                        29670000
           MOVE '6730-DELETE-STR-GP-ROW' TO PV-PARAGRAPH.               29680000
                                                                        29690000
           PERFORM                                                      29700000
            WITH TEST AFTER                                             29710000
            VARYING PV-SQL-SUB                                          29720000
            FROM 1 BY 1                                                 29730000
            UNTIL PV-SQL-SUB > PC-MAX-RETRIES                           29740000
               OR SQLCODE = 0                                           29750000
               OR SQLCODE = PC-ROW-NOT-FOUND                            29760000
               OR PS-INPUT-REC-ERROR                                    29770000
                                                                        29780000
               EXEC SQL                                                 29790000
                   DELETE FROM XMT_STR_GP                               29800000
                   WHERE STR_GP_TYP_CDE = :XMT00004-STR-GP-TYP-CDE      29810000
                     AND STR_GP_ID      = :XMT00004-STR-GP-ID           29820000
               END-EXEC                                                 29830000
                                                                        29840000
               EVALUATE TRUE                                            29850000
                   WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              29860000
                   WHEN SQLCODE = PC-DEADLOCK                           29870000
                   WHEN SQLCODE = PC-ROW-NOT-FOUND                      29880000
                   WHEN SQLCODE = ZERO                                  29890000
                        CONTINUE                                        29900000
                   WHEN SQLWARN0 NOT = SPACE                            29910000
                   WHEN SQLCODE NOT = ZERO                              29920000
                       MOVE 'BAD SQLCODE FOR DELETE XMT_STR_GP'         29930000
                                     TO  PV-MESSAGE                     29940000
                       PERFORM 9900-PROCESS-DB2-ERROR                   29950000
                       SET PS-INPUT-REC-ERROR TO TRUE                   29960000
               END-EVALUATE                                             29970000
           END-PERFORM.                                                 29980000
                                                                        29990000
           IF  PV-SQL-SUB > PC-MAX-RETRIES                              30000000
               MOVE 'MAX RETRIES EXCEEDED FOR DELETE XMT_STR_GP'        30010000
                                     TO  PV-MESSAGE                     30020000
               PERFORM 9900-PROCESS-DB2-ERROR                           30030000
               SET PS-INPUT-REC-ERROR TO TRUE                           30040000
           END-IF.                                                      30050000
                                                                        30060000
                                                                        30070000
                                                                        30080000
      * ------------------------------------------------------------- * 30090000
      *   PROCESS THE K_EMT_ZONE_STORE_DATE DATA TO INSERT, UPDATE,     30100000
      *   OR DELETE FROM THE XMT_STR_GP_MBSHP TABLE                     30110000
      * ------------------------------------------------------------- * 30120000
       6800-PROCESS-ZONE-STORE-DATE.                                    30130000
                                                                        30140000
           MOVE '6800-PROCESS-ZONE-STORE-DATE' TO PV-PARAGRAPH.         30150000
                                                                        30160000
           ADD 1 TO PA-STR-GP-MBSHP-MSGS                                30170000
                                                                        30180000
           MOVE HO100-ZSD-STR-GP-TYP-CDE TO XMT00003-STR-GP-TYP-CDE.    30190000
           MOVE HO100-ZSD-GP-ID          TO XMT00003-STR-GP-ID.         30200000
           MOVE HO100-ZSD-STR-NBR        TO XMT00003-LOC-NBR.           30210000
           MOVE HO100-ZSD-EFF-BEG-DTE    TO XMT00003-EFF-BEG-DTE.       30220000
0107PK     IF HO100-ZSD-EFF-END-DTE = SPACES                            30220199
0107PK         MOVE -1 TO PV-EFF-END-DTE-NULL-IND                       30220299
0107PK     ELSE                                                         30220399
0107PK         MOVE HO100-ZSD-EFF-END-DTE TO XMT00003-EFF-END-DTE       30221099
0107PK         MOVE ZERO TO PV-EFF-END-DTE-NULL-IND                     30221199
0107PK     END-IF.                                                      30221299
                                                                        30230000
           IF HO100-ACTN-TYP-INSERT                                     30240000
               PERFORM 6810-INSERT-STR-GP-MBSHP-ROW                     30250000
               IF PS-INPUT-REC-ERROR                                    30260000
                   ADD 1 TO PA-STR-GP-MBSHP-ERRORS                      30270000
               ELSE                                                     30280000
                   ADD 1 TO PA-STR-GP-MBSHP-INSERTS                     30290000
               END-IF                                                   30300000
           ELSE                                                         30310000
               IF HO100-ACTN-TYP-UPDATE                                 30320000
0405RM** PIT752205                                                      30321099
0405RM             IF HO100-ZSD-EFF-END-DTE = SPACES                    30322099
0405RM                 PERFORM 6825-UPDATE-CURR-STR-GP-MBSHP            30323099
0405RM             ELSE                                                 30324099
                       PERFORM 6820-UPDATE-STR-GP-MBSHP-ROW             30340099
0405RM             END-IF                                               30341099
                   IF PS-INPUT-REC-ERROR                                30350000
                       ADD 1 TO PA-STR-GP-MBSHP-ERRORS                  30360000
                   ELSE                                                 30370000
                       ADD 1 TO PA-STR-GP-MBSHP-UPDATES                 30380000
                   END-IF                                               30390000
               ELSE                                                     30400000
                   IF HO100-ACTN-TYP-DELETE                             30410000
                       PERFORM 6830-DELETE-STR-GP-MBSHP-ROW             30420000
                       IF PS-INPUT-REC-ERROR                            30430000
                           ADD 1 TO PA-STR-GP-MBSHP-ERRORS              30440000
                       ELSE                                             30450000
                           ADD 1 TO PA-STR-GP-MBSHP-DELETES             30460000
                       END-IF                                           30470000
                   END-IF                                               30480000
               END-IF                                                   30490000
           END-IF.                                                      30500000
                                                                        30510000
      *----------------------------------------------------------------*30520000
      *   INSERT THE XMT_STR_GP_MBSHP ROW                               30530000
      *----------------------------------------------------------------*30540000
       6810-INSERT-STR-GP-MBSHP-ROW.                                    30550000
                                                                        30560000
           MOVE '6810-INSERT-STR-GP-MBSHP-ROW' TO PV-PARAGRAPH.         30570000
                                                                        30580000
           PERFORM                                                      30590000
               WITH TEST AFTER                                          30600000
               VARYING PV-SQL-SUB                                       30610000
               FROM 1 BY 1                                              30620000
               UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        30630000
                  OR SQLCODE = 0                                        30640000
                  OR PS-INPUT-REC-ERROR                                 30650000
                                                                        30660000
                 EXEC SQL                                               30670000
                     INSERT INTO XMT_STR_GP_MBSHP                       30680000
                            ( LOC_NBR                                   30690000
                             ,STR_GP_TYP_CDE                            30700000
                             ,STR_GP_ID                                 30710000
                             ,EFF_BEG_DTE                               30720099
PK0107                       ,EFF_END_DTE)                              30730099
                     VALUES (:XMT00003-LOC-NBR                          30740000
                           , :XMT00003-STR-GP-TYP-CDE                   30750000
                           , :XMT00003-STR-GP-ID                        30760000
                           , :XMT00003-EFF-BEG-DTE                      30770099
PK0107                     , :XMT00003-EFF-END-DTE                      30780099
PK0107                       :PV-EFF-END-DTE-NULL-IND)                  30781099
                 END-EXEC                                               30790000
                                                                        30800000
               EVALUATE TRUE                                            30810000
                   WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              30820000
                   WHEN SQLCODE = PC-DEADLOCK                           30830000
                   WHEN SQLCODE = PC-ROW-NOT-FOUND                      30840000
                   WHEN SQLCODE = ZERO                                  30850000
                        CONTINUE                                        30860000
                   WHEN SQLWARN0 NOT = SPACE                            30870000
                   WHEN SQLCODE NOT = ZERO                              30880000
                       MOVE 'BAD SQLCODE FOR INSERT XMT_STR_GP_MBSHP'   30890000
                                     TO  PV-MESSAGE                     30900000
                       PERFORM 9900-PROCESS-DB2-ERROR                   30910000
                       SET PS-INPUT-REC-ERROR TO TRUE                   30920000
               END-EVALUATE                                             30930000
           END-PERFORM.                                                 30940000
                                                                        30950000
           IF  PV-SQL-SUB > PC-MAX-RETRIES                              30960000
               MOVE 'MAX RETRIES EXCEEDED FOR INSERT XMT_STR_GP_MBSHP'  30970000
                                     TO  PV-MESSAGE                     30980000
               PERFORM 9900-PROCESS-DB2-ERROR                           30990000
               SET PS-INPUT-REC-ERROR TO TRUE                           31000000
           END-IF.                                                      31010000
                                                                        31020000
      *----------------------------------------------------------------*31030000
      *   UPDATE THE XMT_STR_GP_MBSHP ROW.                             *31040000
      *----------------------------------------------------------------*31050000
       6820-UPDATE-STR-GP-MBSHP-ROW.                                    31060000
                                                                        31070000
           MOVE '6820-UPDATE-STR-GP-MBSHP ROW' TO PV-PARAGRAPH.         31080000
                                                                        31090000
           PERFORM                                                      31100000
               WITH TEST AFTER                                          31110000
               VARYING PV-SQL-SUB                                       31120000
               FROM 1 BY 1                                              31130000
               UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        31140000
                  OR SQLCODE = 0                                        31150000
                  OR SQLCODE = PC-ROW-NOT-FOUND                         31160000
                  OR PS-INPUT-REC-ERROR                                 31170000
                                                                        31180000
                 EXEC SQL                                               31190000
                     UPDATE XMT_STR_GP_MBSHP                            31200000
                        SET EFF_END_DTE    = :XMT00003-EFF-END-DTE      31210000
                      WHERE LOC_NBR        = :XMT00003-LOC-NBR          31220000
                        AND STR_GP_TYP_CDE = :XMT00003-STR-GP-TYP-CDE   31230000
                        AND STR_GP_ID      = :XMT00003-STR-GP-ID        31240000
                        AND EFF_BEG_DTE    = :XMT00003-EFF-BEG-DTE      31250000
                 END-EXEC                                               31260000
                                                                        31270000
               EVALUATE TRUE                                            31280000
                   WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              31290000
                   WHEN SQLCODE = PC-DEADLOCK                           31300000
                   WHEN SQLCODE = ZERO                                  31310000
                        CONTINUE                                        31320000
                   WHEN SQLWARN0 NOT = SPACE                            31330000
                   WHEN SQLCODE NOT = ZERO                              31340000
                       MOVE 'BAD SQLCODE FOR UPDATE XMT_STR_GP_MBSHP'   31350000
                                     TO  PV-MESSAGE                     31360000
                       PERFORM 9900-PROCESS-DB2-ERROR                   31370000
                       SET PS-INPUT-REC-ERROR TO TRUE                   31380000
               END-EVALUATE                                             31390000
           END-PERFORM.                                                 31400000
                                                                        31410000
           IF  PV-SQL-SUB > PC-MAX-RETRIES                              31420000
               MOVE 'MAX RETRIES EXCEEDED FOR UPDATE XMT_STR_GP_MBSHP'  31430000
                                     TO  PV-MESSAGE                     31440000
               PERFORM 9900-PROCESS-DB2-ERROR                           31450000
               SET PS-INPUT-REC-ERROR TO TRUE                           31460000
           END-IF.                                                      31470000
0405RM**PIT752205                                                       31471099
      *----------------------------------------------------------------*31473099
      *   UPDATE THE XMT_STR_GP_MBSHP ROW.                             *31474099
      *----------------------------------------------------------------*31475099
0405RM 6825-UPDATE-CURR-STR-GP-MBSHP.                                   31476099
0405RM                                                                  31477099
0405RM     MOVE '6825-UPDATE-CURR-STR-GP-MBSHP' TO PV-PARAGRAPH.        31478099
0405RM                                                                  31479099
0405RM     PERFORM                                                      31479199
0405RM         WITH TEST AFTER                                          31479299
0405RM         VARYING PV-SQL-SUB                                       31479399
0405RM         FROM 1 BY 1                                              31479499
0405RM         UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        31479599
0405RM            OR SQLCODE = 0                                        31479699
0405RM            OR SQLCODE = PC-ROW-NOT-FOUND                         31479799
0405RM            OR PS-INPUT-REC-ERROR                                 31479899
0405RM                                                                  31479999
0405RM           EXEC SQL                                               31480099
0405RM               UPDATE XMT_STR_GP_MBSHP                            31480199
0405RM                  SET STR_GP_ID      = :XMT00003-STR-GP-ID        31480299
0407PK                     ,EFF_END_DTE    = :XMT00003-EFF-END-DTE      31480399
0407PK                                       :PV-EFF-END-DTE-NULL-IND   31480499
0405RM                WHERE LOC_NBR        = :XMT00003-LOC-NBR          31480599
0405RM                  AND STR_GP_TYP_CDE = :XMT00003-STR-GP-TYP-CDE   31480699
0405RM                  AND EFF_BEG_DTE    = :XMT00003-EFF-BEG-DTE      31480799
0405RM           END-EXEC                                               31480899
0405RM                                                                  31480999
0405RM         EVALUATE TRUE                                            31481099
0405RM             WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              31481199
0405RM             WHEN SQLCODE = PC-DEADLOCK                           31481299
0405RM             WHEN SQLCODE = ZERO                                  31481399
0405RM                  CONTINUE                                        31481499
0405RM             WHEN SQLWARN0 NOT = SPACE                            31481599
0405RM             WHEN SQLCODE NOT = ZERO                              31481699
0405RM                 MOVE 'BAD SQLCODE FOR UPDATE XMT_STR_GP_MBSHP'   31481799
0405RM                               TO  PV-MESSAGE                     31481899
0405RM                 PERFORM 9900-PROCESS-DB2-ERROR                   31481999
0405RM                 SET PS-INPUT-REC-ERROR TO TRUE                   31482099
0405RM         END-EVALUATE                                             31482199
0405RM     END-PERFORM.                                                 31482299
0405RM                                                                  31482399
0405RM     IF  PV-SQL-SUB > PC-MAX-RETRIES                              31482499
0405RM         MOVE 'MAX RETRIES EXCEEDED FOR UPDATE XMT_STR_GP_MBSHP'  31482599
0405RM                               TO  PV-MESSAGE                     31482699
0405RM         PERFORM 9900-PROCESS-DB2-ERROR                           31482799
0405RM         SET PS-INPUT-REC-ERROR TO TRUE                           31482899
0405RM     END-IF.                                                      31482999
0405RM                                                                  31483099
      *----------------------------------------------------------------*31484099
      *   DELETE THE XMT_STR_GP_MBSHP ROW.                              31490000
      *----------------------------------------------------------------*31500000
       6830-DELETE-STR-GP-MBSHP-ROW.                                    31510000
                                                                        31520000
           MOVE '6830-DELETE-STR-GP-MBSHP-ROW' TO PV-PARAGRAPH.         31530099
                                                                        31540000
           PERFORM                                                      31910000
            WITH TEST AFTER                                             31920000
            VARYING PV-SQL-SUB                                          31930000
            FROM 1 BY 1                                                 31940000
            UNTIL PV-SQL-SUB > PC-MAX-RETRIES                           31950000
               OR SQLCODE = 0                                           31960000
               OR SQLCODE = PC-ROW-NOT-FOUND                            31970000
               OR PS-INPUT-REC-ERROR                                    31980000
                                                                        31990000
               EXEC SQL                                                 32000000
                   DELETE FROM XMT_STR_GP_MBSHP                         32010000
                   WHERE STR_GP_TYP_CDE = :XMT00003-STR-GP-TYP-CDE      32030099
                     AND STR_GP_ID      = :XMT00003-STR-GP-ID           32040000
                     AND LOC_NBR        = :XMT00003-LOC-NBR             32041099
                     AND EFF_BEG_DTE    = :XMT00003-EFF-BEG-DTE         32050000
               END-EXEC                                                 32060000
                                                                        32070000
               EVALUATE TRUE                                            32080000
                   WHEN SQLCODE = PC-UNAVAILABLE-RESOURCES              32090000
                   WHEN SQLCODE = PC-DEADLOCK                           32100000
                   WHEN SQLCODE = PC-ROW-NOT-FOUND                      32110000
                   WHEN SQLCODE = ZERO                                  32120000
                        CONTINUE                                        32130000
                   WHEN SQLWARN0 NOT = SPACE                            32140000
                   WHEN SQLCODE NOT = ZERO                              32150000
                       MOVE 'BAD SQLCODE FOR DELETE XMT_STR_GP_MBSHP'   32160000
                                     TO  PV-MESSAGE                     32170000
                       PERFORM 9900-PROCESS-DB2-ERROR                   32180000
                       SET PS-INPUT-REC-ERROR TO TRUE                   32190000
               END-EVALUATE                                             32200000
           END-PERFORM.                                                 32210000
                                                                        32220000
           IF  PV-SQL-SUB > PC-MAX-RETRIES                              32230000
               MOVE 'MAX RETRIES EXCEEDED FOR DELETE XMT_STR_GP_MBSHP'  32240000
                                     TO  PV-MESSAGE                     32250000
               PERFORM 9900-PROCESS-DB2-ERROR                           32260000
               SET PS-INPUT-REC-ERROR TO TRUE                           32270000
           END-IF.                                                      32280000
                                                                        32290000
      * ------------------------------------------------------------- * 32300000
      * READ CONTROL CARD 1 TO OBTAIN THE INPUT QUEUE MGR NAME          32310000
      * ------------------------------------------------------------ *  32320000
       8000-READ-CONTROL-CARD1.                                         32330000
            READ CONTROL-CARD-1 INTO CC-CONTROL-CARD-1                  32340000
                AT END                                                  32350000
                    SET PS-CONTROL-CARD-1-END   TO TRUE.                32360000
                                                                        32370000
      * ------------------------------------------------------------- * 32380000
      * READ CONTROL CARD 2 TO OBTAIN THE INPUT QUEUE NAME              32390000
      * ------------------------------------------------------------- * 32400000
       8010-READ-CONTROL-CARD2.                                         32410000
            READ CONTROL-CARD-2 INTO CC-CONTROL-CARD-2                  32420000
                AT END                                                  32430000
                    SET PS-CONTROL-CARD-2-END TO TRUE.                  32440000
                                                                        32450000
      * ------------------------------------------------------------- * 32460000
      * READ CONTROL CARD 3 TO OBTAIN THE METHOD OF INPUT:              32470000
      * 'M' - MQSERIES QUEUE OR 'F' - FILE                              32480000
      * ------------------------------------------------------------- * 32490000
       8020-READ-CONTROL-CARD3.                                         32500000
            READ CONTROL-CARD-3 INTO CC-CONTROL-CARD-3                  32510000
                AT END                                                  32520000
                    SET PS-CONTROL-CARD-3-END TO TRUE.                  32530000
      * ------------------------------------------------------------- * 32540000
      * GET RMS ORG HIERARCHY MESSAGES FROM MQ SERIES                   32550000
      * ------------------------------------------------------------- * 32560000
       8200-MQGET-MSG.                                                  32570000
                                                                        32580000
           INITIALIZE PS-MQGET-SUCCESSFUL-SW.                           32590000
           INITIALIZE PV-MSGBUFFER.                                     32600000
           MOVE MQMI-NONE              TO MQMD-MSGID.                   32610000
           MOVE MQCI-NONE              TO MQMD-CORRELID.                32620000
           MOVE CC-ORG-HIERARCHY-QNAME TO MQOD-OBJECTNAME.              32630000
           COMPUTE MQGMO-OPTIONS  = MQGMO-SYNCPOINT +                   32640000
                                    MQGMO-CONVERT +                     32650000
                                    MQGMO-WAIT.                         32660000
                                                                        32670000
           CALL WS-MQGET USING PV-HCONN                                 32680000
                               PV-GQ-HANDLE                             32690000
                               MQM-MESSAGE-DESCRIPTOR                   32700000
                               MQM-GET-MESSAGE-OPTIONS                  32710000
                               PV-MSGLENGTH                             32720000
                               PV-MSGBUFFER                             32730000
                               PV-DATA-LENGTH                           32740000
                               PV-COMPLETION-CODE                       32750000
                               PV-REASON.                               32760000
                                                                        32770000
      *        IF GET FAILED THEN DISPLAY ERROR MESSAGE                 32780000
      *        AND BREAK OUT OF LOOP                                    32790000
                                                                        32800000
           IF (PV-COMPLETION-CODE NOT = MQCC-OK)                        32810000
              IF (PV-REASON NOT = MQRC-NO-MSG-AVAILABLE)                32820000
                  MOVE PV-COMPLETION-CODE TO PH-COMPLETION-CODE         32830000
                  MOVE PV-REASON          TO PH-REASON                  32840000
                  PERFORM 8500-BACK-OUT-MQ                              32850000
                  PERFORM 8210-CLOSE-QUEUE                              32860000
                  PERFORM 8220-DISCONNECT-QMGR                          32870000
                  MOVE 'MQGET ERROR'      TO PV-ERROR-MESSAGE           32880000
                  MOVE PH-COMPLETION-CODE TO PV-COMPLETION-CODE         32890000
                  MOVE PH-REASON          TO PV-REASON                  32900000
                  PERFORM 9000-DISPLAY-MQ-ERROR                         32910000
              ELSE                                                      32920000
                  DISPLAY 'NO MORE MESSAGES AVAILABLE'                  32930000
              END-IF                                                    32940000
           ELSE                                                         32950000
              MOVE MQMD-REPLYTOQMGR TO PV-ISP-QMGR-NM                   32960000
      *       DISPLAY "*** REPLY TO QUEUE MANAGER NAME OF MSG : ",      32970000
      *               MQMD-REPLYTOQMGR                                  32980000
              SET PS-MQGET-SUCCESSFUL TO TRUE                           32990000
              ADD 1 TO PA-MQGET                                         33000000
              MOVE PV-MSGBUFFER TO HORD100-RECORD                       33010000
           END-IF.                                                      33020000
                                                                        33030000
      * ------------------------------------------------------------- * 33040000
      *  CLOSE MQ QUEUE                                                 33050000
      * ------------------------------------------------------------- * 33060000
       8210-CLOSE-QUEUE.                                                33070000
                                                                        33080000
           CALL WS-MQCLOSE USING PV-HCONN                               33090000
                                 PV-GQ-HANDLE                           33100000
                                 MQCO-NONE                              33110000
                                 PV-COMPLETION-CODE                     33120000
                                 PV-REASON.                             33130000
           IF (PV-COMPLETION-CODE NOT = MQCC-OK) THEN                   33140000
              MOVE 'MQCLOSE ERROR' TO PV-ERROR-MESSAGE                  33150000
              PERFORM 9000-DISPLAY-MQ-ERROR                             33160000
           ELSE                                                         33170000
              DISPLAY 'MQCLOSE SUCCESSFUL'                              33180000
           END-IF.                                                      33190000
                                                                        33200000
      * ------------------------------------------------------------- * 33210000
      *  DISCONNECT QUEUE MANAGER                                       33220000
      *-------------------------------------------------------------- * 33230000
                                                                        33240000
       8220-DISCONNECT-QMGR.                                            33250000
                                                                        33260000
           IF PV-CON-REASON IS NOT EQUAL TO MQRC-ALREADY-CONNECTED      33270000
              CALL WS-MQDISC USING PV-HCONN                             33280000
                                  PV-COMPLETION-CODE                    33290000
                                  PV-REASON                             33300000
              IF (PV-COMPLETION-CODE NOT = MQCC-OK) THEN                33310000
                 MOVE 'MQDISC ERROR'   TO PV-ERROR-MESSAGE              33320000
                 PERFORM 9000-DISPLAY-MQ-ERROR                          33330000
              ELSE                                                      33340000
                 DISPLAY 'MQDISC SUCCESSFUL'                            33350000
              END-IF                                                    33360000
           END-IF.                                                      33370000
                                                                        33380000
      ******************************************************************33390000
      *  COMMIT DB2 PROCESSING SINCE THE POINT OF THE LAST COMMIT      *33400000
      ******************************************************************33410000
                                                                        33420000
       8400-COMMIT-DB2.                                                 33430000
                                                                        33440000
           EXEC SQL                                                     33450000
              COMMIT                                                    33460000
           END-EXEC.                                                    33470000
                                                                        33480000
           IF SQLCODE NOT = +0                                          33490000
              MOVE '8400-COMMIT-DB2'    TO PV-PARAGRAPH                 33500000
              MOVE 'ATTEMPT TO COMMIT UPDATES TO DB2 TABLES'            33510000
                                        TO PV-MESSAGE                   33520000
              PERFORM 8500-BACK-OUT-MQ                                  33530000
              PERFORM 9900-PROCESS-DB2-ERROR                            33540000
           END-IF.                                                      33550000
                                                                        33560000
      ******************************************************************33570000
      *  ROLLBACK DB2 PROCESSING SINCE THE POINT OF THE LAST COMMIT    *33580000
      ******************************************************************33590000
                                                                        33600000
       8410-ROLLBACK-DB2.                                               33610000
                                                                        33620000
           EXEC SQL                                                     33630000
              ROLLBACK                                                  33640000
           END-EXEC.                                                    33650000
                                                                        33660000
           IF SQLCODE NOT = +0                                          33670000
              MOVE '8410-ROLLBACK-DB2'  TO PV-PARAGRAPH                 33680000
              MOVE 'ATTEMPT TO ROLLBACK UPDATES TO DB2 TABLES'          33690000
                                        TO PV-MESSAGE                   33700000
              PERFORM 8500-BACK-OUT-MQ                                  33710000
              PERFORM 9900-PROCESS-DB2-ERROR                            33720000
           END-IF.                                                      33730000
                                                                        33740000
                                                                        33750000
      ******************************************************************33760000
      *  COMMIT MQ PROCESSING SINCE THE POINT OF THE LAST COMMIT       *33770000
      ******************************************************************33780000
                                                                        33790000
       8450-COMMIT-MQ.                                                  33800000
                                                                        33810000
           CALL WS-MQCMIT USING PV-HCONN                                33820000
                                PV-COMPLETION-CODE                      33830000
                                PV-REASON.                              33840000
                                                                        33850000
           IF (PV-COMPLETION-CODE NOT = MQCC-OK)                        33860000
              MOVE '8450-COMMIT-MQ'  TO PV-PARAGRAPH                    33870000
              MOVE 'MQCMIT ERROR'    TO PV-ERROR-MESSAGE                33880000
              PERFORM 8500-BACK-OUT-MQ                                  33890000
              PERFORM 9000-DISPLAY-MQ-ERROR                             33900000
           END-IF.                                                      33910000
                                                                        33920000
      ******************************************************************33930000
      * BACK OUT MQ PROCESSING SINCE THE POINT OF THE LAST COMMIT      *33940000
      ******************************************************************33950000
                                                                        33960000
       8500-BACK-OUT-MQ.                                                33970000
                                                                        33980000
           CALL WS-MQBACK USING PV-HCONN                                33990000
                                PV-COMPLETION-CODE                      34000000
                                PV-REASON.                              34010000
                                                                        34020000
           IF (PV-COMPLETION-CODE NOT = MQCC-OK) THEN                   34030000
              MOVE '8500-BACK-OUT-MQ'  TO PV-PARAGRAPH                  34040000
              MOVE 'MQBACK ERROR'    TO PV-ERROR-MESSAGE                34050000
              PERFORM 9000-DISPLAY-MQ-ERROR                             34060000
           END-IF.                                                      34070000
                                                                        34080000
      * ------------------------------------------------------------- * 34090000
      * READ INPUT FILE WHEN CONTROL CARD 3 IS 'F'                      34100000
      * ------------------------------------------------------------- * 34110000
       8700-READ-INPUT-FILE.                                            34120000
            READ INPUT-FILE INTO HORD100-RECORD                         34130000
                AT END                                                  34140000
                    SET PS-END-OF-INPUT-FILE TO TRUE.                   34150000
                                                                        34160000
            IF PS-END-OF-INPUT-FILE                                     34170000
                CONTINUE                                                34180000
            ELSE                                                        34190000
                ADD 1 TO PA-READS                                       34200000
            END-IF.                                                     34210000
                                                                        34220000
      * ------------------------------------------------------------- * 34230000
      * DISPLAY THE VALUES OF A FAILED MQ API COMMAND                   34240000
      * ------------------------------------------------------------- * 34250000
       9000-DISPLAY-MQ-ERROR.                                           34260000
                                                                        34270000
           DISPLAY '**** ABEND *************************************'.  34280000
           DISPLAY '** MQSERIES ERROR **'                               34290000
           DISPLAY '** PROGRAM:    ', PC-PGM-NAME                       34300000
           DISPLAY '** PARAGRAPH:  ', PV-PARAGRAPH                      34310000
           DISPLAY '** MESSAGE:    ', PV-ERROR-MESSAGE.                 34320000
           DISPLAY '** COMP CODE:  ', PV-COMPLETION-CODE.               34330000
           DISPLAY '** RSN CODE:   ', PV-REASON.                        34340000
           DISPLAY '************************************************'.  34350000
           SET AC-MQ-ERROR TO TRUE.                                     34360000
           CALL 'ILBOABN0' USING ABEND-CODE.                            34370000
                                                                        34380000
      *----------------------------------------------------------------*34390000
      *  FORMAT A DB2 ERROR MESSAGE                                    *34400000
      *----------------------------------------------------------------*34410000
                                                                        34420000
       9900-PROCESS-DB2-ERROR.                                          34430000
                                                                        34440000
           DISPLAY '***************************************************'34450000
           DISPLAY '**  PROGRAM   **  = ' PC-PGM-NAME.                  34460000
           DISPLAY '**  PARAGRAPH **  = ' PV-PARAGRAPH.                 34470000
           DISPLAY '**  MESSAGE   **  = ' PV-MESSAGE.                   34480000
      *                                                                 34490000
      *  ROUTINE TO CONVERT THE SQLCA INTO A READABLE FORMAT, USING     34500000
      *  THE CALLED MODULE DSNTIAR.                                     34510000
      *                                                                 34520000
           COPY DPPD004.                                                34530000
                                                                        34540000
           PERFORM 9920-WRITE-ERROR-RECORD.                             34550000
                                                                        34560000
      *----------------------------------------------------------------*34570000
      *  WRITE AN AUDIT RECORD - JUST A COPY OF THE INPUT RECORD       *34580000
      *----------------------------------------------------------------*34590000
                                                                        34600000
       9910-WRITE-AUDIT-RECORD.                                         34610000
           WRITE AUDIT-RECORD FROM HORD100-RECORD.                      34620000
           ADD 1 TO PA-AUDITS.                                          34630000
                                                                        34640000
      *----------------------------------------------------------------*34650000
      *  WRITE AN ERROR RECORD - JUST A COPY OF THE INPUT RECORD       *34660000
      *----------------------------------------------------------------*34670000
                                                                        34680000
       9920-WRITE-ERROR-RECORD.                                         34690000
           WRITE ERROR-RECORD FROM HORD100-RECORD.                      34700000
           ADD 1 TO PA-ERRORS.                                          34710000
                                                                        34720000
      *----------------------------------------------------------------*34730000
      *  WRITE A BYPASS RECORD - JUST A COPY OF THE INPUT RECORD       *34740000
      *----------------------------------------------------------------*34750000
                                                                        34760000
       9930-WRITE-BYPASS-RECORD.                                        34770000
           WRITE BYPASS-RECORD FROM HORD100-RECORD.                     34780000
           ADD 1 TO PA-BYPASS.                                          34790000
                                                                        34800000
