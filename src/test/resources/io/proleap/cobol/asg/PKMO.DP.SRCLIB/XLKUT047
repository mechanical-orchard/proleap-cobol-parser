000100***************************************************************** 00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300***************************************************************** 00030000
000400 PROGRAM-ID.    XLKUT047.                                         00040000
000500 AUTHOR.        PAUL OMAN.                                        00050000
000600 INSTALLATION.  KOHLS.                                            00060000
000700 DATE-WRITTEN   APRIL, 2003.                                      00070000
000800 DATE-COMPILED.                                                   00080000
000900****************************************************************  00090000
001000*    THIS PROGRAM WILL COMPARE RMS PO / LEGACY PO              *  00100000
001100* PO DOMAIN TEMPLATE.........:  XXT_PO_PK_SKU                  *  00110000
001200* PO DOMAIN TEMPLATE COPYBOOK:  XLRD021                        *  00120000
001300*                                                              *  00130000
001400*        INPUT COMES TO THIS PROGRAM FROM XLKUT039 AND MUST    *  00140000
001500*    BE SORTED BY THE COMPLETE RECORD. THAT WAY, IF YOU HAVE   *  00150000
001600*    DUPLICATE KEY FIELDS THAT YOU ARE MATCHING ON, BUT THE    *  00160000
001700*    DATA IS DIFFERENT, THEY WILL MATCH.  IF YOU DON'T SORT    *  00170000
001800*    BY THE COMPLETE RECORD, RECORDS WITH DUPLICATE KEY        *  00180000
001900*    FIELDS COULD POSSIBLY CREATE MISLEADING DATA MISMATCHING  *  00190000
002000*    RECORDS WHEN NONE REALLY EXIST.                           *  00200000
002100*                                                              *  00210000
002200*        THIS PROGRAM MATCHES THE LEGACY AND RMS FILES BY PO   *  00220000
002300*    NUMBER, PACK SKU NUMBER, AND SKU NUMBER. IT               *  00230000
002400*    WRITES ERROR RECORDS OUT FOR ANY UNMATCHED RECORDS. IT    *  00240000
002500*    ALSO CHECKS TO SEE IF THERE ARE ANY DATA DIFFERENCES FOR  *  00250000
002600*    THOSE RECORDS WHOSE PO NUMBERS MATCH. IF THERE ARE ANY,   *  00260000
002700*    AN ERROR RECORD IS WRITTEN INDICATING THE FIELDS THAT     *  00270000
002800*    ARE DIFFERENT.                                            *  00280000
002900*        THERE ARE SOME MOVES OF FIELDS COMMENTED OUT. THIS    *  00290000
003000*    HAS BEEN DONE BECAUSE SOME OF THESE FIELDS AREN'T AVAIL-  *  00300000
003100*    ABLE ON ONE OF THE SYSTEMS.  YOU MAY FIND THESE BY DOING  *  00310000
003200*    A F '**??'.                                               *  00320000
003300***************************************************************** 00330000
003400 ENVIRONMENT DIVISION.                                            00340000
003500 INPUT-OUTPUT SECTION.                                            00350000
003600                                                                  00360000
003700 FILE-CONTROL.                                                    00370000
003800                                                                  00380000
003900     SELECT RMS-PO-FILE                                           00390000
004000         ASSIGN TO INP01.                                         00400000
004100                                                                  00410000
004200     SELECT LEGACY-FILE                                           00420000
004300         ASSIGN TO INP02.                                         00430000
004400                                                                  00440000
004500     SELECT ERROR-FILE                                            00450000
004600         ASSIGN TO OUT01.                                         00460000
004700                                                                  00470000
004800***************************************************************** 00480000
004900 DATA DIVISION.                                                   00490000
005000***************************************************************** 00500000
005100 FILE SECTION.                                                    00510000
005200                                                                  00520000
005300 FD  RMS-PO-FILE                                                  00530000
005400     RECORDING MODE IS F                                          00540000
005500     BLOCK CONTAINS 0 RECORDS                                     00550000
005600     LABEL RECORDS ARE STANDARD.                                  00560000
005700                                                                  00570000
005800 01  RMS-PO-RECORD                PIC X(121).                     00580000
005900                                                                  00590000
006000 FD  LEGACY-FILE                                                  00600000
006100     RECORDING MODE IS F                                          00610000
006200     BLOCK CONTAINS 0 RECORDS                                     00620000
006300     LABEL RECORDS ARE STANDARD.                                  00630000
006400                                                                  00640000
006500 01  LEGACY-RECORD                PIC X(121).                     00650000
006600                                                                  00660000
006700                                                                  00670000
006800 FD  ERROR-FILE                                                   00680000
006900     RECORDING MODE IS F                                          00690000
007000     BLOCK CONTAINS 0 RECORDS                                     00700000
007100     LABEL RECORDS ARE STANDARD.                                  00710000
007200                                                                  00720000
007300 01  ERROR-RECORD                 PIC X(830).                     00730000
007400                                                                  00740000
007500                                                                  00750000
007600***************************************************************** 00760000
007700 WORKING-STORAGE SECTION.                                         00770000
007800                                                                  00780000
007900 01  PS-PROGRAM-SWITCHES.                                         00790000
008000     05  PS-EOF-INPUT1-SW             PIC X(01)  VALUE 'N'.       00800000
008100         88  PS-EOF-INPUT1-YES                   VALUE 'Y'.       00810000
008200         88  PS-EOF-INPUT1-NO                    VALUE 'N'.       00820000
008300     05  PS-EOF-INPUT2-SW             PIC X(01)  VALUE 'N'.       00830000
008400         88  PS-EOF-INPUT2-YES                   VALUE 'Y'.       00840000
008500         88  PS-EOF-INPUT2-NO                    VALUE 'N'.       00850000
008600     05  PS-EMAIL-SW                  PIC X(01)  VALUE 'N'.       00860000
008700         88  PS-EMAIL-YES                        VALUE 'Y'.       00870000
008800         88  PS-EMAIL-NO                         VALUE 'N'.       00880000
008900                                                                  00890000
009000 01  PC-PROGRAM-CONSTANTS.                                        00900000
009100     05  PC-PROGRAM-NAME              PIC  X(08) VALUE 'XLKUT047'.00910000
009200     05  PC-FIVE-BLANKS               PIC  X(05) VALUE SPACES.    00920000
009300                                                                  00930000
009400 01  PC-SORT-KEY.                                                 00940000
009500     05  PC-PK-SKU-NBR                PIC  9(08) VALUE ZEROES.    00950000
009600     05  PC-SKU-NBR                   PIC  9(08) VALUE ZEROES.    00960000
009700                                                                  00970000
009800 01  PV-PROGRAM-VARIABLES.                                        00980000
009900     05  PV-RECORDS-READ-1            PIC  9(09) VALUE  0.        00990000
010000     05  PV-RECORDS-READ-2            PIC  9(09) VALUE  0.        01000000
010100     05  PV-RECORDS-WRITTEN           PIC  9(09) VALUE  0.        01010000
010200     05  PV-RECORDS-ON-BOTH           PIC  9(09) VALUE  0.        01020000
010300     05  PV-RECORDS-ON-RMS-ONLY       PIC  9(09) VALUE  0.        01030000
010400     05  PV-RECORDS-ON-LEGACY-ONLY    PIC  9(09) VALUE  0.        01040000
010500     05  PV-RECORDS-DATA-MISMATCH     PIC  9(09) VALUE  0.        01050000
010600     05  PV-ALL-NINES                 PIC  9(09) VALUE 99999999.  01060000
010700                                                                  01070000
010800 01  PV-ABEND-FIELDS.                                             01080000
010900     05  PV-ABEND-CODE                PIC  S9(4) VALUE +0         01090000
011000                                                 COMP SYNC.       01100000
011100     05  PV-ABEND-PROGRAM             PIC  X(08) VALUE 'XLKUT047'.01110000
011200     05  PV-ABEND-PARAGRAPH           PIC  X(50) VALUE SPACES.    01120000
011300     05  PV-ABEND-OPERATION           PIC  X(50) VALUE SPACES.    01130000
011400     05  PV-ABEND-TABLE               PIC  X(12) VALUE SPACES.    01140000
011500                                                                  01150000
011600 01  PV-RMS-INPUT.                                                01160000
011700     COPY XLRD021.                                                01170000
011800                                                                  01180000
011900 01  PV-LEGACY-INPUT.                                             01190000
012000     COPY XLRD021.                                                01200000
012100                                                                  01210000
012200 01  PV-ERROR-OUTPUT.                                             01220000
012300     COPY XLRD023.                                                01230000
012400                                                                  01240000
012500***************************************************************** 01250000
012600 PROCEDURE DIVISION.                                              01260000
012700***************************************************************** 01270000
012800     DISPLAY ' '.                                                 01280000
012900     DISPLAY '**** BEGINNING XLKUT047 ****'.                      01290000
013000                                                                  01300000
013100     OPEN INPUT  RMS-PO-FILE                                      01310000
013200                 LEGACY-FILE                                      01320000
013300          OUTPUT ERROR-FILE.                                      01330000
013400     SET PS-EMAIL-NO       TO TRUE.                               01340000
013500                                                                  01350000
013600     PERFORM 1000-READ-RMS-INPUT.                                 01360000
013700     PERFORM 1100-READ-LEGACY-INPUT.                              01370000
013800                                                                  01380000
013900     PERFORM 2000-PROCESS-INPUT-FILE                              01390000
014000       UNTIL PS-EOF-INPUT1-YES AND                                01400000
014100             PS-EOF-INPUT2-YES.                                   01410000
014200                                                                  01420000
014300     CLOSE RMS-PO-FILE                                            01430000
014400           LEGACY-FILE                                            01440000
014500           ERROR-FILE.                                            01450000
014600                                                                  01460000
014700     DISPLAY ' '.                                                 01470000
014800     DISPLAY '  INPUT RMS PO REC = ' PV-RECORDS-READ-1.           01480000
014900     DISPLAY '  INPUT LEGACY REC = ' PV-RECORDS-READ-2.           01490000
015000     DISPLAY ' '.                                                 01500000
015100     DISPLAY '          XLRD021 - XXT-PO-PK-SKU'.                 01510000
015200     DISPLAY 'FILES ARE MATCHED BY PO NUMBER  - 8 POSITIONS'.     01520000
015300     DISPLAY '                     PK-SKU-NBR - 8 POSITIONS'.     01530000
015400     DISPLAY '                     SKU-NBR    - 8 POSITIONS'.     01540000
015500     DISPLAY ' '.                                                 01550000
015600     DISPLAY PC-FIVE-BLANKS                                       01560000
015700             'RECORDS ON BOTH FILES ---------> '                  01570000
015800              PV-RECORDS-ON-BOTH.                                 01580000
015900     DISPLAY ' '.                                                 01590000
016000     DISPLAY '  OUTPUT RECORDS WRITTEN ------> '                  01600000
016100              PV-RECORDS-WRITTEN.                                 01610000
016200     DISPLAY PC-FIVE-BLANKS                                       01620000
016300             'RECORDS ON RMS ONLY -----------> '                  01630000
016400              PV-RECORDS-ON-RMS-ONLY                              01640000
016500             ' - "A" RECORD CODE'.                                01650000
016600     DISPLAY PC-FIVE-BLANKS                                       01660000
016700             'RECORDS ON LEGACY ONLY --------> '                  01670000
016800              PV-RECORDS-ON-LEGACY-ONLY                           01680000
016900             ' - "B" RECORD CODE'.                                01690000
017000     DISPLAY PC-FIVE-BLANKS                                       01700000
017100             'RECORDS WITH DATA MISMATCH ----> '                  01710000
017200              PV-RECORDS-DATA-MISMATCH                            01720000
017300             ' - "C" RECORD CODE'.                                01730000
017400     DISPLAY ' '.                                                 01740000
017500     DISPLAY '****  END OF  XLKUT047  ****'.                      01750000
017600     DISPLAY ' '.                                                 01760000
017700                                                                  01770000
017800*    SET RETURN CODE IF E-MAIL SWITCH IS TRUE.                    01780000
017900     IF PS-EMAIL-YES                                              01790000
018000         MOVE 4095 TO RETURN-CODE                                 01800000
018100     END-IF.                                                      01810000
018200     GOBACK.                                                      01820000
018300                                                                  01830000
018400                                                                  01840000
018500***************************************************************** 01850000
018600*  READ A RMS PO RECORD                                           01860000
018700***************************************************************** 01870000
018800 1000-READ-RMS-INPUT.                                             01880000
018900                                                                  01890000
019000     MOVE '1000-READ-RMS-INPUT    ' TO PV-ABEND-PARAGRAPH.        01900000
019100                                                                  01910000
019200     INITIALIZE PV-RMS-INPUT.                                     01920000
019300                                                                  01930000
019400     READ RMS-PO-FILE                                             01940000
019500          INTO PV-RMS-INPUT                                       01950000
019600            AT END                                                01960000
019700               SET PS-EOF-INPUT1-YES TO TRUE                      01970000
019800     END-READ.                                                    01980000
019900                                                                  01990000
020000     IF PS-EOF-INPUT1-YES                                         02000000
020100        MOVE PV-ALL-NINES TO XL021-PO-NBR OF PV-RMS-INPUT         02010000
020200                             XL021-PK-SKU-NBR OF PV-RMS-INPUT     02020000
020300                             XL021-SKU-NBR OF PV-RMS-INPUT        02030000
020400     ELSE                                                         02040000
020500        ADD +1 TO PV-RECORDS-READ-1                               02050000
020600     END-IF.                                                      02060000
020700                                                                  02070000
020800***************************************************************** 02080000
020900*  READ A LEGACY RECORD                                           02090000
021000***************************************************************** 02100000
021100 1100-READ-LEGACY-INPUT.                                          02110000
021200                                                                  02120000
021300     MOVE '1100-READ-LEGACY-INPUT' TO PV-ABEND-PARAGRAPH.         02130000
021400                                                                  02140000
021500     INITIALIZE PV-LEGACY-INPUT.                                  02150000
021600                                                                  02160000
021700     READ LEGACY-FILE                                             02170000
021800          INTO PV-LEGACY-INPUT                                    02180000
021900            AT END                                                02190000
022000               SET PS-EOF-INPUT2-YES TO TRUE                      02200000
022100     END-READ.                                                    02210000
022200                                                                  02220000
022300     IF PS-EOF-INPUT2-YES                                         02230000
022400        MOVE PV-ALL-NINES TO XL021-PO-NBR OF PV-LEGACY-INPUT      02240000
022500                             XL021-PK-SKU-NBR OF PV-LEGACY-INPUT  02250000
022600                             XL021-SKU-NBR OF PV-LEGACY-INPUT     02260000
022700     ELSE                                                         02270000
022800        ADD +1 TO PV-RECORDS-READ-2                               02280000
022900     END-IF.                                                      02290000
023000                                                                  02300000
023100***************************************************************** 02310000
023200*  REFORMAT THE RMS PO EXTRACT FILE                               02320000
023300***************************************************************** 02330000
023400 2000-PROCESS-INPUT-FILE.                                         02340000
023500                                                                  02350000
023600     MOVE '2000-PROCESS-INPUT-FILE ' TO PV-ABEND-PARAGRAPH.       02360000
023700                                                                  02370000
023800     IF XL021-PO-NBR   OF PV-RMS-INPUT    <                       02380000
023900        XL021-PO-NBR   OF PV-LEGACY-INPUT                         02390000
024000*******************************                                   02400000
024100***  ON RMS NOT ON LEGACY                                         02410000
024200*******************************                                   02420000
024300        ADD 1 TO PV-RECORDS-ON-RMS-ONLY                           02430000
024400        SET XL023-ON-RMS-ONLY TO TRUE                             02440000
024500        PERFORM 3400-WRITE-RMS-ERROR                              02450000
024600        PERFORM 1000-READ-RMS-INPUT                               02460000
024700     ELSE                                                         02470000
024800        IF XL021-PO-NBR  OF PV-RMS-INPUT    >                     02480000
024900           XL021-PO-NBR  OF PV-LEGACY-INPUT                       02490000
025000*******************************                                   02500000
025100***   ON LEGACY NOT ON RMS                                        02510000
025200*******************************                                   02520000
025300           ADD 1 TO PV-RECORDS-ON-LEGACY-ONLY                     02530000
025400           SET XL023-ON-LEGACY-ONLY TO TRUE                       02540000
025500           PERFORM 4000-WRITE-LEGACY-ERROR                        02550000
025600           PERFORM 1100-READ-LEGACY-INPUT                         02560000
025700        ELSE                                                      02570000
025800*******************************                                   02580000
025900***  ON RMS AND ON LEGACY                                         02590000
026000*******************************                                   02600000
026100           PERFORM 2400-CHECK-KEY-VALUES                          02610000
026200        END-IF                                                    02620000
026300     END-IF.                                                      02630000
026400                                                                  02640000
026500****************************************************************  02650000
026600*    CHECK ALL THE KEY VALUES FOR MISMATCHES.                  *  02660000
026700*                                                              *  02670000
026800*                                                              *  02680000
026900****************************************************************  02690000
027000 2400-CHECK-KEY-VALUES.                                           02700000
027100                                                                  02710000
027200     MOVE '2400-CHECK-KEY-VALUES ' TO PV-ABEND-PARAGRAPH.         02720000
027300                                                                  02730000
027400     EVALUATE TRUE                                                02740000
027500         WHEN XL021-PK-SKU-NBR OF PV-RMS-INPUT <                  02750000
027600              XL021-PK-SKU-NBR OF PV-LEGACY-INPUT                 02760000
027700              ADD 1 TO PV-RECORDS-ON-RMS-ONLY                     02770000
027800              SET XL023-ON-RMS-ONLY TO TRUE                       02780000
027900              PERFORM 3400-WRITE-RMS-ERROR                        02790000
028000              PERFORM 1000-READ-RMS-INPUT                         02800000
028100                                                                  02810000
028200         WHEN XL021-PK-SKU-NBR OF PV-RMS-INPUT >                  02820000
028300              XL021-PK-SKU-NBR OF PV-LEGACY-INPUT                 02830000
028400              ADD 1 TO PV-RECORDS-ON-LEGACY-ONLY                  02840000
028500              SET XL023-ON-LEGACY-ONLY TO TRUE                    02850000
028600              PERFORM 4000-WRITE-LEGACY-ERROR                     02860000
028700              PERFORM 1100-READ-LEGACY-INPUT                      02870000
028800                                                                  02880000
028900         WHEN XL021-SKU-NBR OF PV-RMS-INPUT <                     02890000
029000              XL021-SKU-NBR OF PV-LEGACY-INPUT                    02900000
029100              ADD 1 TO PV-RECORDS-ON-RMS-ONLY                     02910000
029200              SET XL023-ON-RMS-ONLY TO TRUE                       02920000
029300              PERFORM 3400-WRITE-RMS-ERROR                        02930000
029400              PERFORM 1000-READ-RMS-INPUT                         02940000
029500                                                                  02950000
029600         WHEN XL021-SKU-NBR OF PV-RMS-INPUT >                     02960000
029700              XL021-SKU-NBR OF PV-LEGACY-INPUT                    02970000
029800              ADD 1 TO PV-RECORDS-ON-LEGACY-ONLY                  02980000
029900              SET XL023-ON-LEGACY-ONLY TO TRUE                    02990000
030000              PERFORM 4000-WRITE-LEGACY-ERROR                     03000000
030100              PERFORM 1100-READ-LEGACY-INPUT                      03010000
030200                                                                  03020000
030300         WHEN OTHER                                               03030000
030400              ADD 1 TO PV-RECORDS-ON-BOTH                         03040000
030500              IF XL021-DATA-AREA OF PV-RMS-INPUT    =             03050000
030600                 XL021-DATA-AREA OF PV-LEGACY-INPUT               03060000
030700                 PERFORM 1000-READ-RMS-INPUT                      03070000
030800                 PERFORM 1100-READ-LEGACY-INPUT                   03080000
030900              ELSE                                                03090000
031000                 SET XL023-ON-BOTH-RMS-LEGACY TO TRUE             03100000
031100                 PERFORM 3400-WRITE-RMS-ERROR                     03110000
031200                 PERFORM 4000-WRITE-LEGACY-ERROR                  03120000
031300                 PERFORM 1000-READ-RMS-INPUT                      03130000
031400                 PERFORM 1100-READ-LEGACY-INPUT                   03140000
031500              END-IF                                              03150000
031600                                                                  03160000
031700     END-EVALUATE.                                                03170000
031800                                                                  03180000
031900                                                                  03190000
032000***************************************************************** 03200000
032100*  WRITE A RMS RECORD TO THE ERROR FILE                           03210000
032200***************************************************************** 03220000
032300 3400-WRITE-RMS-ERROR.                                            03230000
032400                                                                  03240000
032500     SET XL023-XXT-PO-PK-SKU TO TRUE.                             03250000
032600     MOVE XL021-PO-NBR    OF PV-RMS-INPUT TO XL023-PO-SORT-KEY-PO.03260000
032700     MOVE XL021-PK-SKU-NBR OF PV-RMS-INPUT TO PC-PK-SKU-NBR.      03270000
032800     MOVE XL021-SKU-NBR OF PV-RMS-INPUT    TO PC-SKU-NBR.         03280000
032900     MOVE PC-SORT-KEY     TO XL023-PO-SORT-KEY-DATA.              03290000
033000     INITIALIZE XL023-PO-PK-SKU.                                  03300000
033100                                                                  03310000
033200     MOVE XL021-PO-NBR OF PV-RMS-INPUT    TO                      03320000
033300                             XL023-PB-PO-NBR-RMS.                 03330000
033400     MOVE XL021-PK-SKU-NBR OF PV-RMS-INPUT  TO                    03340000
033500                             XL023-PB-PK-SKU-NBR-RMS.             03350000
033600     MOVE XL021-SKU-NBR OF PV-RMS-INPUT   TO                      03360000
033700                             XL023-PB-SKU-NBR-RMS.                03370000
033800                                                                  03380000
033900     MOVE  XL021-UNT-COST-AMT  OF PV-RMS-INPUT   TO               03390000
034000                        XL023-PB-UNT-COST-AMT-RMS.                03400000
034100     MOVE  XL021-FRST-COST-AMT OF PV-RMS-INPUT   TO               03410000
034200                        XL023-PB-FRST-COST-AMT-RMS.               03420000
034300     IF XL021-UNT-RTL-AMT  OF PV-RMS-INPUT(1:7) NUMERIC AND       03430000
034400        XL021-UNT-RTL-AMT  OF PV-RMS-INPUT(9:2) NUMERIC           03440000
034500         MOVE XL021-UNT-RTL-AMT  OF PV-RMS-INPUT TO               03450000
034600                              XL023-PB-UNT-RTL-AMT-RMS            03460000
034700     ELSE                                                         03470000
034800         MOVE ZEROES TO       XL023-PB-UNT-RTL-AMT-RMS            03480000
034900     END-IF.                                                      03490000
035000     IF XL021-GP-RTL-AMT OF PV-RMS-INPUT(1:7) NUMERIC AND         03500000
035100        XL021-GP-RTL-AMT OF PV-RMS-INPUT(9:2) NUMERIC             03510000
035200         MOVE XL021-GP-RTL-AMT   OF PV-RMS-INPUT TO               03520000
035300                         XL023-PB-GP-RTL-AMT-RMS                  03530000
035400     ELSE                                                         03540000
035500         MOVE ZEROES TO  XL023-PB-GP-RTL-AMT-RMS                  03550000
035600     END-IF.                                                      03560000
035700     IF XL021-GP-RTL-QTY  OF PV-RMS-INPUT NUMERIC                 03570000
035800         MOVE XL021-GP-RTL-QTY   OF PV-RMS-INPUT TO               03580000
035900                         XL023-PB-GP-RTL-QTY-RMS                  03590000
036000     ELSE                                                         03600000
036100         MOVE ZEROES TO  XL023-PB-GP-RTL-QTY-RMS                  03610000
036200     END-IF.                                                      03620000
036300     MOVE  XL021-RATO-UNT-QTY  OF PV-RMS-INPUT   TO               03630000
036400                        XL023-PB-RATO-UNT-QTY-RMS.                03640000
036401**GB 7/31/12                                                      03640100
036402     MOVE  XL021-INPK-QTY      OF PV-RMS-INPUT   TO               03640200
036403                        XL023-PB-INPK-QTY-RMS.                    03640300
036404     MOVE  XL021-OTPK-QTY      OF PV-RMS-INPUT   TO               03640400
036405                        XL023-PB-OTPK-QTY-RMS.                    03640500
036406**GB 7/31/12                                                      03640600
036407                                                                  03640700
036408     IF XL023-ON-BOTH-RMS-LEGACY                                  03640800
036409         CONTINUE                                                 03640900
036410     ELSE                                                         03641000
036420        PERFORM P5000-WRITE-ERROR-RECORD                          03642000
036430     END-IF.                                                      03643000
036440                                                                  03644000
036450***************************************************************** 03645000
036460*  WRITE A LEGACY RECORD TO THE ERROR FILE                        03646000
036470***************************************************************** 03647000
036480 4000-WRITE-LEGACY-ERROR.                                         03648000
036490                                                                  03649000
036500     IF XL023-ON-BOTH-RMS-LEGACY                                  03650000
036600         CONTINUE                                                 03660000
036700     ELSE                                                         03670000
036800         SET XL023-XXT-PO-PK-SKU TO TRUE                          03680000
036900         MOVE XL021-PO-NBR OF PV-LEGACY-INPUT                     03690000
037000                                        TO XL023-PO-SORT-KEY-PO   03700000
037100         MOVE XL021-PK-SKU-NBR OF PV-LEGACY-INPUT TO PC-PK-SKU-NBR03710000
037200         MOVE XL021-SKU-NBR OF PV-LEGACY-INPUT TO PC-SKU-NBR      03720000
037300         MOVE PC-SORT-KEY     TO XL023-PO-SORT-KEY-DATA           03730000
037400         INITIALIZE XL023-PO-PK-SKU                               03740000
037500     END-IF.                                                      03750000
037600                                                                  03760000
037700     MOVE XL021-PO-NBR OF PV-LEGACY-INPUT TO                      03770000
037800                             XL023-PB-PO-NBR-LGCY.                03780000
037900     MOVE XL021-PK-SKU-NBR OF PV-LEGACY-INPUT TO                  03790000
038000                             XL023-PB-PK-SKU-NBR-LGCY.            03800000
038100     MOVE XL021-SKU-NBR OF PV-LEGACY-INPUT    TO                  03810000
038200                             XL023-PB-SKU-NBR-LGCY.               03820000
038300                                                                  03830000
038400     MOVE  XL021-UNT-COST-AMT  OF PV-LEGACY-INPUT    TO           03840000
038500                        XL023-PB-UNT-COST-AMT-LGCY.               03850000
038600     MOVE  XL021-FRST-COST-AMT OF PV-LEGACY-INPUT    TO           03860000
038700                        XL023-PB-FRST-COST-AMT-LGCY.              03870000
038800     IF XL021-UNT-RTL-AMT  OF PV-LEGACY-INPUT(1:7) NUMERIC AND    03880000
038900        XL021-UNT-RTL-AMT  OF PV-LEGACY-INPUT(9:2) NUMERIC        03890000
039000         MOVE XL021-UNT-RTL-AMT  OF PV-LEGACY-INPUT TO            03900000
039100                              XL023-PB-UNT-RTL-AMT-LGCY           03910000
039200     ELSE                                                         03920000
039300         MOVE ZEROES TO       XL023-PB-UNT-RTL-AMT-LGCY           03930000
039400     END-IF.                                                      03940000
039500     IF XL021-GP-RTL-AMT OF PV-LEGACY-INPUT(1:7) NUMERIC AND      03950000
039600        XL021-GP-RTL-AMT OF PV-LEGACY-INPUT(9:2) NUMERIC          03960000
039700         MOVE XL021-GP-RTL-AMT   OF PV-LEGACY-INPUT TO            03970000
039800                         XL023-PB-GP-RTL-AMT-LGCY                 03980000
039900     ELSE                                                         03990000
040000         MOVE ZEROES TO  XL023-PB-GP-RTL-AMT-LGCY                 04000000
040100     END-IF.                                                      04010000
040200     IF XL021-GP-RTL-QTY  OF PV-LEGACY-INPUT NUMERIC              04020000
040300         MOVE XL021-GP-RTL-QTY   OF PV-LEGACY-INPUT TO            04030000
040400                         XL023-PB-GP-RTL-QTY-LGCY                 04040000
040500     ELSE                                                         04050000
040600         MOVE ZEROES TO  XL023-PB-GP-RTL-QTY-LGCY                 04060000
040700     END-IF.                                                      04070000
040800     MOVE  XL021-RATO-UNT-QTY  OF PV-LEGACY-INPUT    TO           04080000
040900                        XL023-PB-RATO-UNT-QTY-LGCY.               04090000
041000*GB 7/31/12                                                       04100000
041100     MOVE  XL021-INPK-QTY      OF PV-LEGACY-INPUT    TO           04110000
041200                        XL023-PB-INPK-QTY-LGCY.                   04120000
041300     MOVE  XL021-OTPK-QTY      OF PV-LEGACY-INPUT    TO           04130000
041400                        XL023-PB-OTPK-QTY-LGCY.                   04140000
041500*GB 7/31/12                                                       04150000
041600     IF XL023-ON-BOTH-RMS-LEGACY                                  04160000
041700         PERFORM 4300-COMPARE                                     04170000
041800     ELSE                                                         04180000
041900        PERFORM P5000-WRITE-ERROR-RECORD                          04190000
042000     END-IF.                                                      04200000
042100                                                                  04210000
042200***************************************************************** 04220000
042300*  COMPARE FIELDS TO FIND DISCREPANCIES.                          04230000
042400***************************************************************** 04240000
042500 4300-COMPARE.                                                    04250000
042600                                                                  04260000
042700     IF XL023-PB-PO-NBR-RMS  NOT = XL023-PB-PO-NBR-LGCY           04270000
042800         MOVE '*'  TO  XL023-PB-PO-NBR-DIFF                       04280000
042900     END-IF.                                                      04290000
043000                                                                  04300000
043100     IF XL023-PB-PK-SKU-NBR-RMS  NOT =                            04310000
043200        XL023-PB-PK-SKU-NBR-LGCY                                  04320000
043300         MOVE '*'  TO   XL023-PB-PK-SKU-NBR-DIFF                  04330000
043400     END-IF.                                                      04340000
043500                                                                  04350000
043600     IF XL023-PB-SKU-NBR-RMS     NOT =                            04360000
043700        XL023-PB-SKU-NBR-LGCY                                     04370000
043800         MOVE '*'  TO   XL023-PB-SKU-NBR-DIFF                     04380000
043900     END-IF.                                                      04390000
044000                                                                  04400000
044100     IF XL023-PB-UNT-COST-AMT-RMS NOT =                           04410000
044200        XL023-PB-UNT-COST-AMT-LGCY                                04420000
044300         MOVE '*'  TO   XL023-PB-UNT-COST-AMT-DIFF                04430000
044400     END-IF.                                                      04440000
044500                                                                  04450000
044600* 8/22/03 DEANNA BRANTNTER                                        04460000
044700* SINCE FIRST COST ONLY APPLIES TO IMPORT PO'S, FIRST COST        04470000
044800* WILL NOT BE CHECKED FOR NON-IMPORT PO'S.  THE REFORMAT          04480000
044900* PROGRAM MOVED ZEROES INTO THE LGCY FIELD FOR NON-IMPORTS.       04490000
045000                                                                  04500000
045100     IF XL023-PB-FRST-COST-AMT-LGCY = '0000000000000000.0000'     04510000
045200         MOVE ' '  TO XL023-PB-FRST-COST-AMT-DIFF                 04520000
045300     ELSE                                                         04530000
045400         IF XL023-PB-FRST-COST-AMT-RMS  NOT =                     04540000
045500            XL023-PB-FRST-COST-AMT-LGCY                           04550000
045600             MOVE '*'  TO XL023-PB-FRST-COST-AMT-DIFF             04560000
045700         END-IF                                                   04570000
045800     END-IF.                                                      04580000
045900                                                                  04590000
046000     IF XL023-PB-UNT-RTL-AMT-RMS NOT =                            04600000
046100        XL023-PB-UNT-RTL-AMT-LGCY                                 04610000
046200         MOVE '*'  TO   XL023-PB-UNT-RTL-AMT-DIFF                 04620000
046300     END-IF.                                                      04630000
046400                                                                  04640000
046500     IF XL023-PB-GP-RTL-AMT-RMS NOT =                             04650000
046600        XL023-PB-GP-RTL-AMT-LGCY                                  04660000
046700         MOVE '*'  TO   XL023-PB-GP-RTL-AMT-DIFF                  04670000
046800     END-IF.                                                      04680000
046900                                                                  04690000
047000     IF XL023-PB-GP-RTL-QTY-RMS NOT =                             04700000
047100        XL023-PB-GP-RTL-QTY-LGCY                                  04710000
047200         MOVE '*'  TO   XL023-PB-GP-RTL-QTY-DIFF                  04720000
047300     END-IF.                                                      04730000
047400                                                                  04740000
047500     IF XL023-PB-RATO-UNT-QTY-RMS  NOT =                          04750000
047600        XL023-PB-RATO-UNT-QTY-LGCY                                04760000
047700         MOVE '*'  TO   XL023-PB-RATO-UNT-QTY-DIFF                04770000
047800     END-IF.                                                      04780000
047900                                                                  04790000
048000     IF XL023-PB-PO-NBR-DIFF        = '*' OR                      04800000
048100        XL023-PB-PK-SKU-NBR-DIFF    = '*' OR                      04810000
048200        XL023-PB-SKU-NBR-DIFF       = '*' OR                      04820000
048300        XL023-PB-UNT-COST-AMT-DIFF  = '*' OR                      04830000
048400        XL023-PB-FRST-COST-AMT-DIFF = '*' OR                      04840000
048500        XL023-PB-UNT-RTL-AMT-DIFF = '*' OR                        04850000
048600        XL023-PB-GP-RTL-AMT-DIFF = '*' OR                         04860000
048700        XL023-PB-GP-RTL-QTY-DIFF = '*' OR                         04870000
048800        XL023-PB-RATO-UNT-QTY-DIFF  = '*'                         04880000
048900                                                                  04890000
049000        ADD 1 TO PV-RECORDS-DATA-MISMATCH                         04900000
049100        PERFORM P5000-WRITE-ERROR-RECORD                          04910000
049200     END-IF.                                                      04920000
049300                                                                  04930000
049400 P5000-WRITE-ERROR-RECORD.                                        04940000
049500                                                                  04950000
049600     ADD +1  TO PV-RECORDS-WRITTEN.                               04960000
049700     WRITE ERROR-RECORD FROM                                      04970000
049800         PV-ERROR-OUTPUT                                          04980000
049900     END-WRITE.                                                   04990000
050000                                                                  05000000
050100*    SET SWITCH FOR E-MAIL NOTIFICATION OF ERROR.                 05010000
050200*    SET PS-EMAIL-YES       TO TRUE.                              05020000
050300                                                                  05030000
