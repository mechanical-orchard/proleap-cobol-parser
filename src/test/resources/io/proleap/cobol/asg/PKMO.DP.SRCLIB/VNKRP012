000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.     VNKRP012.                                        00020000
000300 AUTHOR.         CAROLYN GIFFORD.                                 00030000
000400 DATE-WRITTEN.   05/18/99.                                        00040000
000500 DATE-COMPILED.                                                   00050000
000600******************************************************************00060000
000700*** VENDOR DATABASE CHANGES REPORT                             ***00070000
000800***                                                            ***00080000
000900*** COBOL 2 WITH SQL                                           ***00090000
001000***                                                            ***00100000
001100*** PURPOSE IS TO CREATE A REPORT OF ANY VENDORS UPDATED       ***00110000
001200*** DURING THE PREVIOUS WEEKLY PERIOD.                         ***00120000
001300***                                                            ***00130000
001400*** INPUT:                                                     ***00140000
001500***                                                            ***00150000
001600***    DB2 TABLES - NEW VENDOR ADD/CHANGE TABLE                ***00160000
001700***                                                            ***00170000
001800*** OUTPUT:                                                    ***00180000
001900***                                                            ***00190000
002000***    VENDOR UPDATE REPORT                                    ***00200000
002100***                                                            ***00210000
002200******************************************************************00220000
002300***  CHANGE LOG:                                               ***00230000
002400***                                                            ***00240000
002500***  05/18/99   INITIAL VERSION                                ***00250000
002600***             BY: CAROLYN GIFFORD           WR#              ***00260000
002700***                                                            ***00270000
002800***  02/09/00                                                  ***00280000
002900***             USE PREVIOUS WEEK END DATE FROM TAPCNTL TO     ***00290000
003000***             CALCULATE BEGINNING & ENDING DATES FOR REPORT. ***00300000
003100***             ADDED BEGINNING & ENDING DATES TO CURSOR SO    ***00310000
003200***             ONLY ROWS WHERE AUD_TMST DATE IS BETWEEN THESE ***00320000
003300***             DATES WILL BE SELECTED.                        ***00330000
003400***             BY: CAROLYN GIFFORD           WR# 20685        ***00340000
003401***                                                            ***00340104
003410***  04/13/01                                                  ***00341004
003420***             CHANGED SQL AND REPORT TO USE NEW COLUMNS ON   ***00342004
003430***             TVNDTAU.                                       ***00343004
003470***             BY: NANCY EILBES              WR# 21278        ***00347004
003500******************************************************************00350000
003600   EJECT                                                          00360000
003700 ENVIRONMENT DIVISION.                                            00370000
003800 CONFIGURATION SECTION.                                           00380000
003900 SOURCE-COMPUTER.     IBM-3090.                                   00390000
004000 OBJECT-COMPUTER.     IBM-3090.                                   00400000
004100                                                                  00410000
004200 INPUT-OUTPUT SECTION.                                            00420000
004300 FILE-CONTROL.                                                    00430000
004400     SELECT VENDOR-REPORT-FILE           ASSIGN TO UT-S-RPT01.    00440000
004500                                                                  00450000
004600   EJECT                                                          00460000
004700 DATA DIVISION.                                                   00470000
004800 FILE SECTION.                                                    00480000
004900                                                                  00490000
005000 FD VENDOR-REPORT-FILE                                            00500000
005100     LABEL RECORDS ARE STANDARD                                   00510000
005200     RECORDING MODE IS F                                          00520000
005300     BLOCK CONTAINS 0 RECORDS                                     00530000
005400     RECORD CONTAINS 150 CHARACTERS                               00540000
005500     DATA RECORD IS VENDOR-REPORT-RECORD.                         00550000
005600                                                                  00560000
005700 01 VENDOR-REPORT-RECORD                  PIC X(150).             00570000
005800                                                                  00580000
005900   EJECT                                                          00590000
006000 WORKING-STORAGE SECTION.                                         00600000
006100                                                                  00610000
006200 01  PV-PROGRAM-VARIABLES.                                        00620000
006300     05  PV-PROGRAM-NAME           PIC  X(08)  VALUE 'VNKRP012'.  00630000
006400     05  PV-MAX-RETRIES            PIC S9(4)   COMP VALUE +3.     00640000
006500     05  PV-RETRY-COUNTER          PIC S9(04)  VALUE +0 COMP SYNC.00650000
006600     05  PV-UPDATE-COUNT           PIC  9(10)  VALUE ZEROES.      00660000
006700     05  PV-BTCH-TMST              PIC  X(26)  VALUE SPACES.      00670000
006800     05  PV-MIN-UPDATE-DATE        PIC  X(10)  VALUE SPACES.      00680000
006900     05  PV-MIN-UPDATE-CYMD REDEFINES PV-MIN-UPDATE-DATE.         00690000
007000         10 PV-MIN-UPD-CC          PIC  X(02).                    00700000
007100         10 PV-MIN-UPD-YY          PIC  X(02).                    00710000
007200         10 PV-MIN-UPD-DASH1       PIC  X(01).                    00720000
007300         10 PV-MIN-UPD-MM          PIC  X(02).                    00730000
007400         10 PV-MIN-UPD-DASH2       PIC  X(01).                    00740000
007500         10 PV-MIN-UPD-DD          PIC  X(02).                    00750000
007600     05  PV-MAX-UPDATE-DATE        PIC  X(10)  VALUE SPACES.      00760000
007700     05  PV-MAX-UPDATE-CYMD REDEFINES PV-MAX-UPDATE-DATE.         00770000
007800         10 PV-MAX-UPD-CC          PIC  X(02).                    00780000
007900         10 PV-MAX-UPD-YY          PIC  X(02).                    00790000
008000         10 PV-MAX-UPD-DASH1       PIC  X(01).                    00800000
008100         10 PV-MAX-UPD-MM          PIC  X(02).                    00810000
008200         10 PV-MAX-UPD-DASH2       PIC  X(01).                    00820000
008300         10 PV-MAX-UPD-DD          PIC  X(02).                    00830000
008400     05  PV-UPDATE-DATE            PIC  X(10) VALUE SPACES.       00840000
008500     05  PV-UPDATE-CYMD REDEFINES PV-UPDATE-DATE.                 00850000
008600         10 PV-UPDATE-CC           PIC  X(02).                    00860000
008700         10 PV-UPDATE-YY           PIC  X(02).                    00870000
008800         10 PV-UPDATE-DASH1        PIC  X(01).                    00880000
008900         10 PV-UPDATE-MM           PIC  X(02).                    00890000
009000         10 PV-UPDATE-DASH2        PIC  X(01).                    00900000
009100         10 PV-UPDATE-DD           PIC  X(02).                    00910000
009200     05  PV-CURRENT-DATE.                                         00920000
009300         10  PV-CURRENT-YEAR       PIC  9(02)  VALUE ZEROS.       00930000
009400         10  PV-CURRENT-MONTH      PIC  9(02)  VALUE ZEROS.       00940000
009500         10  PV-CURRENT-DAY        PIC  9(02)  VALUE ZEROS.       00950000
009600     05  PV-CURRENT-TIME.                                         00960000
009700         10  PV-CURRENT-HOUR       PIC  9(02)  VALUE ZEROS.       00970000
009800         10  PV-CURRENT-MINUTE     PIC  9(02)  VALUE ZEROS.       00980000
009900         10  FILLER                PIC  9(02)  VALUE ZEROS.       00990000
010000     05  PV-STRING-LINE.                                          01000000
010100         10  PV-HEADING-STRING     PIC X(50)  VALUE SPACES.       01010000
010200         10  PV-STRING             PIC X(100) VALUE SPACES.       01020000
010300     05  PV-STRING2.                                              01030000
010400         10 PV-STRING-POS12        PIC X(02)  VALUE SPACES.       01040000
010500         10 PV-STRING-REST         PIC X(98)  VALUE SPACES.       01050000
010600     05  PV-STRING-OVERFLOW        PIC X(100) VALUE SPACES.       01060000
010700     05  PV-STRING-RECEIVER        PIC X(55)  VALUE SPACES.       01070000
010800     05  PV-STRING-PREV            PIC X(100) VALUE SPACES.       01080000
010900     05  PV-USER-ID                PIC   X(08).                   01090000
011000     05  PV-UPD-DTE.                                              01100000
011100         10  PV-UPD-MM             PIC   X(02).                   01110000
011200         10  FILLER                PIC   X(01) VALUE '/'.         01120000
011300         10  PV-UPD-DD             PIC   X(02).                   01130000
011400         10  FILLER                PIC   X(01) VALUE '/'.         01140000
011500         10  PV-UPD-YY             PIC   X(02).                   01150000
011600     05  PV-PRIM-NAME              PIC   X(30).                   01160000
011700     05  PV-VN-NAME.                                              01170000
011800        10 FILLER                  PIC  X(14) VALUE               01180000
011900                                   'PRIMARY NAME: '.              01190000
012000        10 PV-VN-NAME-V            PIC  X(30).                    01200000
012100     05  PV-VNDR-STATUS.                                          01210000
012200        10 FILLER                  PIC  X(15) VALUE               01220000
012300                                   'VENDOR STATUS: '.             01230000
012400        10 PV-VNDR-STATUS-V        PIC  X(01).                    01240000
012500     05  PV-PRIM-TYP-CDE.                                         01250001
012600        10 FILLER                  PIC  X(16) VALUE               01260000
012700                                   'PRIMARY TYP CD: '.            01270001
012800        10 PV-PRIM-TYP-CDE-V       PIC  X(01).                    01280002
012900     05  PV-PRTNR-IND.                                            01290001
013000        10 FILLER                  PIC  X(13) VALUE               01300001
013100                                   'PARTNER IND: '.               01310001
013200        10 PV-PRTNR-IND-V          PIC  X(01).                    01320001
013300     05  PV-PRTNR-TYP-CDE.                                        01330001
013400        10 FILLER                  PIC  X(17) VALUE               01340001
013500                                   'PARTNER TYPE CD: '.           01350001
013600        10 PV-PRTNR-TYP-CDE-V      PIC  X(02).                    01360003
014100     05 PV-PRNT-CO.                                               01410000
014200        10 FILLER                  PIC  X(15) VALUE               01420000
014300                                   'PARENT CO IND: '.             01430000
014400        10 PV-PRNT-CO-V            PIC  X(01).                    01440000
014500     05 PV-PAY-FCTR.                                              01450000
014600        10 FILLER                  PIC  X(14) VALUE               01460000
014700                                   'USING FACTOR: '.              01470000
014800        10 PV-PAY-FCTR-V           PIC  X(01).                    01480000
014900     05 PV-HLD-PAYT.                                              01490000
015000        10 FILLER                  PIC  X(16) VALUE               01500000
015100                                   'VENDOR ON HOLD: '.            01510000
015200        10 PV-HLD-PAYT-V           PIC  X(01).                    01520000
015300     05 PV-SEP-INV-PAY.                                           01530000
015400        10 FILLER                  PIC  X(20) VALUE               01540000
015500                                   'SEPARATE PYMNT IND: '.        01550000
015600        10 PV-SEP-INV-PAY-V        PIC  X(01).                    01560000
015700     05 PV-PYMT-HNDL.                                             01570000
015800        10 FILLER                  PIC  X(20) VALUE               01580000
015900                                   'PYMNT HANDLING CDE: '.        01590000
016000        10 PV-PYMT-HNDL-V          PIC  X(02).                    01600000
016100     05 PV-1099-IND.                                              01610000
016200        10 FILLER                  PIC  X(17) VALUE               01620000
016300                                   '1099 VENDOR IND: '.           01630000
016400        10 PV-1099-IND-V           PIC  X(01).                    01640000
016500     05 PV-TAXID.                                                 01650000
016600        10 FILLER                  PIC  X(12) VALUE               01660000
016700                                   'TAX ID NBR: '.                01670000
016800        10 PV-TAXID-V              PIC  X(09).                    01680000
016900     05 PV-ST-PROV.                                               01690000
017000        10 FILLER                  PIC  X(15) VALUE               01700000
017100                                   'REMIT ST/PROV: '.             01710000
017200        10 PV-ST-PROV-V            PIC  X(06).                    01720000
017300     05 PV-ZIP-CODE.                                              01730000
017400        10 FILLER                  PIC  X(11) VALUE               01740000
017500                                   'REMIT ZIP: '.                 01750000
017600        10 PV-ZIP-CODE-V           PIC  X(12).                    01760000
017700     05 PV-CNTRY-CDE.                                             01770000
017800        10 FILLER                  PIC  X(18) VALUE               01780000
017900                                   'REMIT CNTRY CODE: '.          01790000
018000        10 PV-CNTRY-CDE-V          PIC  X(03).                    01800000
018100     05 PV-CONTACT-NAME.                                          01810000
018200        10 FILLER                  PIC  X(09) VALUE               01820000
018300                                   'CONTACT: '.                   01830000
018400        10 PV-CONTACT-NAME-V       PIC  X(31).                    01840000
018500     05 PV-EXTD-VND-NM.                                           01850000
018600        10 FILLER                  PIC  X(15)                     01860000
018700                                  VALUE 'EXTD VND NAME: '.        01870000
018800        10 PV-EXTD-VND-NM-V        PIC  X(40).                    01880000
018900     05 PV-1099-ALT-NM.                                           01890000
019000        10 FILLER                  PIC  X(15)                     01900000
019100                                  VALUE 'ALT 1099 NAME: '.        01910000
019200        10 PV-1099-ALT-NM-V        PIC  X(40).                    01920000
019300     05 PV-1099ADD1.                                              01930000
019400        10 FILLER                  PIC  X(14) VALUE               01940000
019500                                   '1099 ADDRESS: '.              01950000
019600        10 PV-1099ADD1-V           PIC  X(40).                    01960000
019700     05 PV-1099ADD2.                                              01970000
019800        10 PV-1099ADD2-V           PIC  X(40).                    01980000
019900     05 PV-1099ADD3.                                              01990000
020000        10 PV-1099ADD3-V           PIC  X(40).                    02000000
020100     05 PV-1099-CITY.                                             02010000
020200        10 FILLER                  PIC  X(11) VALUE               02020000
020300                                   '1099 CITY: '.                 02030000
020400        10 PV-1099-CITY-V          PIC  X(40).                    02040000
020500     05 PV-1099-STPR.                                             02050000
020600        10 FILLER                  PIC  X(14) VALUE               02060000
020700                                   '1099 ST/PROV: '.              02070000
020800        10 PV-1099-STPR-V          PIC  X(06).                    02080000
020900     05 PV-1099-ZIP.                                              02090000
021000        10 FILLER                  PIC  X(10) VALUE               02100000
021100                                   '1099 ZIP: '.                  02110000
021200        10 PV-1099-ZIP-V           PIC  X(12).                    02120000
021300     05 PV-1099-CNTRY.                                            02130000
021400        10 FILLER                  PIC  X(17) VALUE               02140000
021500                                   '1099 CNTRY CODE: '.           02150000
021600        10 PV-1099-CNTRY-V         PIC  X(03).                    02160000
021700     05 PV-1099-ATTN-TO.                                          02170000
021800        10 FILLER                  PIC  X(14) VALUE               02180000
021900                                   '1099 ATTN TO: '.              02190000
022000        10 PV-1099-ATTN-TO-V       PIC  X(40).                    02200000
022100     05 PV-ADDRESS1.                                              02210000
022200        10 FILLER                  PIC  X(15) VALUE               02220000
022300                                   'REMIT ADDRESS: '.             02230000
022400        10 PV-ADDRESS1-V           PIC  X(40).                    02240000
022500     05 PV-ADDRESS2.                                              02250000
022600        10 PV-ADDRESS2-V           PIC  X(40).                    02260000
022700     05 PV-ADDRESS3.                                              02270000
022800        10 PV-ADDRESS3-V           PIC  X(40).                    02280000
022900     05 PV-CITY-NAME.                                             02290000
023000        10 FILLER                  PIC  X(12) VALUE               02300000
023100                                   'REMIT CITY: '.                02310000
023200        10 PV-CITY-NAME-V          PIC  X(40).                    02320000
023300     05 PV-ATTN-TO.                                               02330000
023400        10 FILLER                  PIC  X(15) VALUE               02340000
023500                                   'REMIT ATTN TO: '.             02350000
023600        10 PV-ATTN-TO-V            PIC  X(40).                    02360000
023700     05 PV-ENT-ID                  PIC S9(09)  COMP.              02370000
023800     05 PV-PREV-ENT-ID             PIC S9(09)  COMP VALUE ZEROES. 02380000
023900     05 PV-PREV-USER-ID            PIC X(08)  VALUE SPACES.       02390000
024000     05 PV-PREV-UPDATE-DATE        PIC X(10)  VALUE SPACES.       02400000
024100                                                                  02410000
024200 01  WS-MISC-VARIABLES.                                           02420000
024300     05  WS-CRE-DATE.                                             02430000
024400         10 WS-CRE-CENT            PIC  X(02).                    02440000
024500         10 WS-CRE-YEAR            PIC  X(02).                    02450000
024600         10 WS-CRE-DASH1           PIC  X(01).                    02460000
024700         10 WS-CRE-MONTH           PIC  X(02).                    02470000
024800         10 WS-CRE-DASH2           PIC  X(01).                    02480000
024900         10 WS-CRE-DAY             PIC  X(02).                    02490000
025000     05  WS-LAST-UPD-DATE.                                        02500000
025100         10 WS-LUPD-CENT           PIC  X(02).                    02510000
025200         10 WS-LUPD-YEAR           PIC  X(02).                    02520000
025300         10 WS-LUPD-DASH1          PIC  X(01).                    02530000
025400         10 WS-LUPD-MONTH          PIC  X(02).                    02540000
025500         10 WS-LUPD-DASH2          PIC  X(01).                    02550000
025600         10 WS-LUPD-DAY            PIC  X(02).                    02560000
025700     05  WS-BLANK-LINE                  PIC X(151) VALUE SPACES.  02570000
025800     05  WS-ADDR-DELETED                PIC  X(40).               02580000
025900                                                                  02590000
026000 01  PC-PROGRAM-CONSTANTS.                                        02600000
026100     05  PC-PROGRAM-NAME           PIC  X(08)  VALUE 'VNKRP012'.  02610000
026200     05  PC-IN-PROCESS-CODE        PIC  X(01)  VALUE '9'.         02620000
026300     05  PC-RUN-COMPLETE-CODE      PIC  X(01)  VALUE '0'.         02630000
026400     05  PC-MAX-LINES              PIC S9(03)  VALUE +60          02640000
026500                                               COMP-3.            02650000
026600     05  PC-LINE-COUNT             PIC S9(03)  VALUE +99          02660000
026700                                               COMP-3.            02670000
026800     05  PC-PAGE-COUNT             PIC  9(05)  VALUE ZEROES.      02680000
026900                                                                  02690000
027000 01  PC-PROGRAM-COUNTERS.                                         02700000
027100     05  PC-VUPD-TVNADAU-CNT     PIC  9(10)  VALUE ZEROES.        02710000
027200                                                                  02720000
027300 01  PROGRAM-SWITCHES.                                            02730000
027400     05  PS-OUT-OF-VNDTAU-UPDS1-SW    PIC X(01) VALUE 'N'.        02740000
027500         88  NOT-OUT-OF-VNDTAU-UPDS1            VALUE 'N'.        02750000
027600         88  OUT-OF-VNDTAU-UPDS1                VALUE 'Y'.        02760000
027700     05  PS-OUT-OF-VNADAU-UPDS1-SW    PIC X(01) VALUE 'N'.        02770000
027800         88  NOT-OUT-OF-VNADAU-UPDS1            VALUE 'N'.        02780000
027900         88  OUT-OF-VNADAU-UPDS1                VALUE 'Y'.        02790000
028000     05  PS-OUT-OF-VNADAU-UPDS2-SW    PIC X(01) VALUE 'N'.        02800000
028100         88  NOT-OUT-OF-VNADAU-UPDS2            VALUE 'N'.        02810000
028200         88  OUT-OF-VNADAU-UPDS2                VALUE 'Y'.        02820000
028300     05  PS-ADDRESS-DETAIL-NOT-FND-SW PIC X(01) VALUE 'N'.        02830000
028400         88  NO-ADDRESS-DETAIL-FOUND            VALUE 'N'.        02840000
028500         88  ADDRESS-DETAIL-FOUND               VALUE 'Y'.        02850000
028600                                                                  02860000
028700 01  WS-SQLCODE                      PIC S9(9) COMP-4 VALUE ZERO. 02870000
028800 01  WS-SQLWARN0                     PIC X.                       02880000
028900 01  WS-RETRY-COUNTER                PIC S9(4) COMP VALUE ZERO.   02890000
029000 01  WS-DISPLAY-RETRY-COUNTER        PIC 9(9)  VALUE ZEROS.       02900000
029100                                                                  02910000
029200                                                                  02920000
029300 01  WS-TIMESTAMP            PIC X(26)     VALUE SPACES.          02930000
029400 01  FILLER REDEFINES WS-TIMESTAMP.                               02940000
029500     05  FILLER              PIC X(14).                           02950000
029600     05  WS-MINUTE           PIC X(02).                           02960000
029700     05  FILLER              PIC X(02).                           02970000
029800     05  WS-SECOND           PIC X(01).                           02980000
029900     05  FILLER              PIC X(01).                           02990000
030000     05  WS-NANOSEC-1-3      PIC X(03).                           03000000
030100     05  WS-NANOSEC-4-6      PIC X(03).                           03010000
030200                                                                  03020000
030300 01  WS-RANDOM-KEY           PIC 9(09)     VALUE 0.               03030000
030400 01  FILLER REDEFINES WS-RANDOM-KEY.                              03040000
030500     05  WS-RND-NANOSEC-4-6  PIC X(03).                           03050000
030600     05  WS-RND-NANOSEC-1-3  PIC X(03).                           03060000
030700     05  WS-RND-MINUTE       PIC X(02).                           03070000
030800     05  WS-RND-SECOND       PIC X(01).                           03080000
030900                                                                  03090000
031000 01  WS-RANDOM-KEY-COMP      PIC S9(09)    VALUE 0 COMP.          03100000
031100                                                                  03110000
031200******************************************************************03120000
031300***                STANDARD HEADER LAYOUT ***                     03130000
031400******************************************************************03140000
031500     COPY DPWS150O.                                               03150005
031600                                                                  03160000
031700 01  H2-HEADER2.                                                  03170000
031800     05  FILLER                  PIC  X(64) VALUE SPACES.         03180000
031900     05  FILLER                  PIC  X(21) VALUE                 03190000
032000         'VENDOR UPDATE REPORT '.                                 03200000
032100                                                                  03210000
032200 01  H2-HEADER3.                                                  03220000
032300     05  FILLER                  PIC  X(60) VALUE SPACES.         03230000
032400     05  FILLER                  PIC  X(06) VALUE                 03240000
032500         'AS OF '.                                                03250000
032600     05  H2-BEGIN-MM             PIC  X(02).                      03260000
032700     05  FILLER                  PIC  X(01) VALUE '/'.            03270000
032800     05  H2-BEGIN-DD             PIC  X(02).                      03280000
032900     05  FILLER                  PIC  X(01) VALUE '/'.            03290000
033000     05  H2-BEGIN-YY             PIC  X(02).                      03300000
033100     05  FILLER                  PIC  X(09) VALUE ' THROUGH '.    03310000
033200     05  H2-END-MM               PIC  X(02).                      03320000
033300     05  FILLER                  PIC  X(01) VALUE '/'.            03330000
033400     05  H2-END-DD               PIC  X(02).                      03340000
033500     05  FILLER                  PIC  X(01) VALUE '/'.            03350000
033600     05  H2-END-YY               PIC  X(02).                      03360000
033700                                                                  03370000
033800 01  DH-DETAIL-HEADER1.                                           03380000
033900     05  FILLER                  PIC   X(01) VALUE SPACES.        03390000
034000     05  FILLER                  PIC   X(07) VALUE 'USER ID'.     03400000
034100     05  FILLER                  PIC   X(04) VALUE SPACES.        03410000
034200     05  FILLER                  PIC   X(06) VALUE 'DATE  '.      03420000
034300     05  FILLER                  PIC   X(01) VALUE SPACES.        03430000
034400     05  FILLER                  PIC   X(13) VALUE                03440000
034500                                     'PRIMARY NAME '.             03450000
034600                                                                  03460000
034700******************************************************************03470000
034800*  COMMUNICATIONS AREA2 FOR DB2                                  *03480000
034900******************************************************************03490000
035000     COPY SQLCA2.                                                 03500005
035100                                                                  03510000
035200     EXEC SQL                                                     03520000
035300         INCLUDE SQLCA                                            03530000
035400     END-EXEC.                                                    03540000
035500                                                                  03550000
035600******************************************************************03560000
035700*           DCLGEN FOR VENDOR BUSINESS LOCATION TABLE            *03570000
035800******************************************************************03580000
035900     EXEC SQL                                                     03590000
036000         INCLUDE TBUSLOC                                          03600000
036100     END-EXEC.                                                    03610000
036200                                                                  03620000
036300******************************************************************03630000
036400*           DCLGEN FOR AP CONTROL TABLE                          *03640000
036500******************************************************************03650000
036600     EXEC SQL                                                     03660000
036700         INCLUDE TAPCNTL                                          03670000
036800     END-EXEC.                                                    03680000
036900                                                                  03690000
037000******************************************************************03700000
037100***     DB2 DCLGEN FOR VENDOR EXTERNAL ENTERPRISE NAME TABLE   ***03710000
037200******************************************************************03720000
037300     EXEC SQL                                                     03730000
037400          INCLUDE TENTNME                                         03740000
037500     END-EXEC.                                                    03750000
037600                                                                  03760000
037700******************************************************************03770000
037800*           DCLGEN FOR VENDOR ADDRESS ADD/UPDATE TABLE           *03780000
037900******************************************************************03790000
038000     EXEC SQL                                                     03800000
038100         INCLUDE TVNADAU                                          03810000
038200     END-EXEC.                                                    03820000
038300                                                                  03830000
038400******************************************************************03840000
038500*           DCLGEN FOR VENDOR DETAIL ADD/UPDATE TABLE            *03850000
038600******************************************************************03860000
038700     EXEC SQL                                                     03870000
038800         INCLUDE TVNDTAU                                          03880000
038900     END-EXEC.                                                    03890000
039000                                                                  03900000
039100******************************************************************03910000
039200*  VNDTAU UPDATE CURSOR #1                                       *03920000
039300*                                                                *03930000
039400*  THIS CURSOR IS USED TO CHECK THE VENDOR DETAIL HISTORY TABLE  *03940000
039500*  FOR ALL VENDORS UPDATED SINCE LAST RUN                        *03950000
039600*                                                                *03960000
039700******************************************************************03970000
039800     EXEC SQL                                                     03980000
039900        DECLARE VNDTAU_UPD_CSR1 CURSOR WITH HOLD FOR              03990000
040000           SELECT ENT_ID                                          04000000
040100                 ,DATE(AUD_TMST)                                  04010000
040200                 ,LAST_UPD_BY_USR_ID                              04020000
040300                 ,VND_NM                                          04030000
040400                 ,STAT_CDE                                        04040000
040900                 ,PRNT_CO_IND_CDE                                 04090000
041000                 ,PAY_FCTR_IND_CDE                                04100000
041100                 ,HLD_PAYT_IND_CDE                                04110000
041200                 ,SEPR_INVC_IND_CDE                               04120000
041300                 ,PAYT_HNDLG_CDE                                  04130000
041400                 ,NEED_1099_IND_CDE                               04140000
041500                 ,FED_TX_ID_NBR                                   04150000
041510                 ,PRIM_TYP_CDE                                    04151001
041520                 ,PRTNR_IND                                       04152001
041530                 ,PRTNR_TYP_CDE                                   04153001
041600           FROM   TVNDTAU                                         04160000
041700           WHERE AUD_FUNC_CDE = 'U'                               04170000
041800            AND  DATE(AUD_TMST) <= :PV-MAX-UPDATE-DATE            04180000
041900            AND  DATE(AUD_TMST) >= :PV-MIN-UPDATE-DATE            04190000
042000           ORDER BY 3                                             04200000
042100                   ,2                                             04210000
042200                   ,1                                             04220000
042300     END-EXEC.                                                    04230000
042400                                                                  04240000
042500******************************************************************04250000
042600*  VNADAU UPDATE CURSOR #1 -                                     *04260000
042700*                                                                *04270000
042800*  THIS CURSOR IS USED TO FETCH THE VENDOR ADDRESS HISTORY TABLE *04280000
042900*  ROW FOR UPDATE WHERE ENT_ID IS EQUAL TO THE VENDOR DETAIL     *04290000
043000*  HISTORY TABLE ENT_ID                                          *04300000
043100*                                                                *04310000
043200******************************************************************04320000
043300     EXEC SQL                                                     04330000
043400        DECLARE VNADAU_UPD_CSR1 CURSOR WITH HOLD FOR              04340000
043500           SELECT ENT_ID                                          04350000
043600                 ,SEQ_NBR                                         04360000
043700                 ,REP_1ST_NM                                      04370000
043800                 ,REP_LAST_NM                                     04380000
043900                 ,EXTD_VND_NM                                     04390000
044000                 ,VND_1ST_LNE_ADDR                                04400000
044100                 ,VND_2ND_LNE_ADDR                                04410000
044200                 ,VND_3RD_LNE_ADDR                                04420000
044300                 ,CTY_NM                                          04430000
044400                 ,ST_PROV_CDE                                     04440000
044500                 ,ZIP_CDE                                         04450000
044600                 ,CNTRY_CDE                                       04460000
044700                 ,ATTN_TO_TXT                                     04470000
044800           FROM   TVNADAU                                         04480000
044900           WHERE AUD_FUNC_CDE = 'U' AND                           04490000
045000                   ENT_ID = :VNDTAU-ENT-ID AND                    04500000
045100                   DATE(AUD_TMST) = :PV-UPDATE-DATE               04510000
045200           FOR UPDATE OF AUD_FUNC_CDE                             04520000
045300     END-EXEC.                                                    04530000
045400                                                                  04540000
045500******************************************************************04550000
045600*  VNADAU UPDATE CURSOR #2 -                                     *04560000
045700*                                                                *04570000
045800*  THIS CURSOR IS USED TO FETCH THE VENDOR ADDRESS HISTORY TABLE *04580000
045900*  ROWS THAT HAVE BEEN UPDATED SINCE LAST RUN                    *04590000
046000*                                                                *04600000
046100******************************************************************04610000
046200     EXEC SQL                                                     04620000
046300        DECLARE VNADAU_UPD_CSR2 CURSOR WITH HOLD FOR              04630000
046400           SELECT ENT_ID                                          04640000
046500                 ,SEQ_NBR                                         04650000
046600                 ,DATE(AUD_TMST)                                  04660000
046700                 ,LAST_UPD_BY_USR_ID                              04670000
046800                 ,REP_1ST_NM                                      04680000
046900                 ,REP_LAST_NM                                     04690000
047000                 ,EXTD_VND_NM                                     04700000
047100                 ,VND_1ST_LNE_ADDR                                04710000
047200                 ,VND_2ND_LNE_ADDR                                04720000
047300                 ,VND_3RD_LNE_ADDR                                04730000
047400                 ,CTY_NM                                          04740000
047500                 ,ST_PROV_CDE                                     04750000
047600                 ,ZIP_CDE                                         04760000
047700                 ,CNTRY_CDE                                       04770000
047800                 ,ATTN_TO_TXT                                     04780000
047900           FROM   TVNADAU                                         04790000
048000           WHERE AUD_FUNC_CDE = 'U'                               04800000
048100            AND  DATE(AUD_TMST) <= :PV-MAX-UPDATE-DATE            04810000
048200            AND  DATE(AUD_TMST) >= :PV-MIN-UPDATE-DATE            04820000
048300           ORDER BY 4                                             04830000
048400                   ,3                                             04840000
048500                   ,1                                             04850000
048600     END-EXEC.                                                    04860000
048700                                                                  04870000
048800******************************************************************04880000
048900*  ABEND DATA AREAS                                              *04890000
049000******************************************************************04900000
049100 01  ABEND-CODE                  PIC S9(04)  VALUE ZEROS          04910000
049200                                             COMP SYNC.           04920000
049300     88  AC-DB2-ERROR                        VALUE +4013.         04930000
049400     88  AC-DATE-ERROR                       VALUE +4019.         04940000
049500                                                                  04950000
049600 01  ABEND-AREAS.                                                 04960000
049700     05  AA-ABEND-LIT            PIC  X(40)  VALUE                04970000
049800          '*****       ABEND'.                                    04980000
049900     05  AA-PROGRAM-LIT          PIC  X(40)  VALUE                04990000
050000          '*****   PROGRAM: VNKRP012'.                            05000000
050100     05  AA-PARAGRAPH-LIT.                                        05010000
050200         10  FILLER              PIC  X(17)  VALUE                05020000
050300          '***** PARAGRAPH: '.                                    05030000
050400         10  AA-PARAGRAPH-NAME   PIC  X(35)  VALUE SPACES.        05040000
050500     05  AA-MESSAGE-LINE.                                         05050000
050600         10  FILLER              PIC  X(06)  VALUE '*****'.       05060000
050700         10  AA-MESSAGE          PIC  X(127) VALUE SPACES.        05070000
050800     05  AA-DB2-ERROR-LIT        PIC  X(40)  VALUE                05080000
050900           '*****    DB2 ERROR'.                                  05090000
051000     05  AA-DB2-OPERATION-LIT.                                    05100000
051100         10  FILLER              PIC  X(17)  VALUE                05110000
051200           '***** OPERATION: '.                                   05120000
051300         10  AA-DB2-OPERATION.                                    05130000
051400             15  AA-DB2-OP-1     PIC  X(25)  VALUE SPACES.        05140000
051500             15  AA-DB2-OP-2     PIC  X(25)  VALUE SPACES.        05150000
051600     05  AA-DB2-TABLE-1          PIC  X(08)  VALUE SPACES.        05160000
051700     05  AA-DB2-TABLE-2          PIC  X(08)  VALUE SPACES.        05170000
051800     05  AA-DB2-TABLE-3          PIC  X(08)  VALUE SPACES.        05180000
051900                                                                  05190000
052000     COPY DPWS004.                                                05200005
052100                                                                  05210000
052200 01  FILLER                      PIC  X(25)  VALUE                05220000
052300     '** END OF VNKRP012 W/S **'.                                 05230000
052400                                                                  05240000
052500 PROCEDURE DIVISION.                                              05250000
052600 0000-MAIN.                                                       05260000
052700     PERFORM 1000-INITIALIZE.                                     05270000
052800                                                                  05280000
052900     PERFORM 7100-OPEN-VNDTAU-UPD-CSR1.                           05290000
053000     PERFORM 2000-PROCESS-VNDTAU-UPDS                             05300000
053100         UNTIL OUT-OF-VNDTAU-UPDS1.                               05310000
053200     PERFORM 7200-CLOSE-VNDTAU-UPD-CSR1.                          05320000
053300                                                                  05330000
053400     PERFORM 7500-OPEN-VNADAU-UPD-CSR2.                           05340000
053500     PERFORM 2500-PROCESS-VNADAU-UPDS                             05350000
053600         UNTIL OUT-OF-VNADAU-UPDS2.                               05360000
053700     PERFORM 7600-CLOSE-VNADAU-UPD-CSR2.                          05370000
053800                                                                  05380000
053900     PERFORM 3000-END-PROGRAM.                                    05390000
054000                                                                  05400000
054100     GOBACK.                                                      05410000
054200                                                                  05420000
054300******************************************************************05430000
054400*    INITIALIZATION PROCESSING                                   *05440000
054500*    - GET CURRENT DATE & CALCULATE WEEK BEGIN DATE              *05450000
054600******************************************************************05460000
054700 1000-INITIALIZE.                                                 05470000
054800                                                                  05480000
054900     OPEN OUTPUT VENDOR-REPORT-FILE.                              05490000
055000                                                                  05500000
055100     INITIALIZE DCLTVNDTAU                                        05510000
055200                DCLTVNADAU                                        05520000
055300                PC-VUPD-TVNADAU-CNT                               05530000
055400                WS-BLANK-LINE                                     05540000
055500                VENDOR-REPORT-RECORD.                             05550000
055600                                                                  05560000
055700     SET NOT-OUT-OF-VNDTAU-UPDS1                                  05570000
055800         NOT-OUT-OF-VNADAU-UPDS1                                  05580000
055900         NOT-OUT-OF-VNADAU-UPDS2 TO TRUE.                         05590000
056000                                                                  05600000
056100     ACCEPT PV-CURRENT-DATE FROM DATE.                            05610000
056200     MOVE PV-CURRENT-MONTH            TO DP150O-RUN-MONTH.        05620000
056300     MOVE PV-CURRENT-DAY              TO DP150O-RUN-DAY.          05630000
056400     MOVE PV-CURRENT-YEAR             TO DP150O-RUN-YEAR.         05640000
056500                                                                  05650000
056600     ACCEPT PV-CURRENT-TIME FROM TIME.                            05660000
056700     MOVE PV-CURRENT-HOUR             TO DP150O-RUN-HOUR.         05670000
056800     MOVE PV-CURRENT-MINUTE           TO DP150O-RUN-MINUTE.       05680000
056900     MOVE PV-PROGRAM-NAME             TO DP150O-PROGRAM-NAME.     05690000
057000     MOVE 1                           TO DP150O-REPORT-NUMBER.    05700000
057100                                                                  05710000
057200     PERFORM 7030-GET-RPT-BEG-END-DATE.                           05720000
057300     MOVE PV-MAX-UPD-MM   TO   H2-END-MM.                         05730000
057400     MOVE PV-MAX-UPD-DD   TO   H2-END-DD.                         05740000
057500     MOVE PV-MAX-UPD-YY   TO   H2-END-YY.                         05750000
057600                                                                  05760000
057700     MOVE PV-MIN-UPD-MM   TO   H2-BEGIN-MM.                       05770000
057800     MOVE PV-MIN-UPD-DD   TO   H2-BEGIN-DD.                       05780000
057900     MOVE PV-MIN-UPD-YY   TO   H2-BEGIN-YY.                       05790000
058000                                                                  05800000
058100     PERFORM 6000-WRITE-REPORT-HEADERS.                           05810000
058200                                                                  05820000
058300******************************************************************05830000
058400*       FETCH VENDOR DETAIL HISTORY ROWS WHERE AUDIT CODE = 'U'  *05840000
058500******************************************************************05850000
058600 2000-PROCESS-VNDTAU-UPDS.                                        05860000
058700                                                                  05870000
058800** LOOP #1 GRAB VENDOR DETAIL HISTORY AND ANY RELATED ADDRESS     05880000
058900** ROWS FOR THIS ENT ID & DATE                                    05890000
059000     SET NOT-OUT-OF-VNADAU-UPDS1 TO TRUE.                         05900000
059100     PERFORM 7000-FETCH-VNDTAU-UPD-CSR1.                          05910000
059200     IF NOT-OUT-OF-VNDTAU-UPDS1                                   05920000
059300       IF (VNDTAU-ENT-ID NOT = PV-PREV-ENT-ID OR                  05930000
059400          VNDTAU-LAST-UPD-BY-USR-ID NOT = PV-PREV-USER-ID OR      05940000
059500          PV-UPDATE-DATE NOT = PV-PREV-UPDATE-DATE) OR            05950000
059600                (PV-PREV-ENT-ID = ZEROES AND                      05960000
059700                 PV-PREV-USER-ID = SPACES AND                     05970000
059800                 PV-PREV-UPDATE-DATE = ZEROES)                    05980000
059900         MOVE VNDTAU-LAST-UPD-BY-USR-ID         TO PV-USER-ID     05990000
060000         MOVE VNDTAU-ENT-ID    TO PV-ENT-ID                       06000000
060100         PERFORM 7020-SELECT-TENTNME-TYP01                        06010000
060200         MOVE ENTNME-ENT-NAME-DESC              TO PV-PRIM-NAME   06020000
060300         PERFORM 4000-STRING-PRIMARY-FLDS                         06030000
060400         MOVE VNDTAU-ENT-ID TO PV-PREV-ENT-ID                     06040000
060500         MOVE VNDTAU-LAST-UPD-BY-USR-ID TO PV-PREV-USER-ID        06050000
060600         MOVE PV-UPDATE-DATE            TO PV-PREV-UPDATE-DATE    06060000
060700       END-IF                                                     06070000
060800       PERFORM 4100-MOVES-DETAIL                                  06080000
060900       PERFORM 4200-POPULATE-DETAIL                               06090000
061000                                                                  06100000
061100       PERFORM 7300-OPEN-VNADAU-UPD-CSR1                          06110000
061200       PERFORM UNTIL OUT-OF-VNADAU-UPDS1                          06120000
061300                                                                  06130000
061400         PERFORM 7010-FETCH-VNADAU-UPD-CSR1                       06140000
061500                                                                  06150000
061600         IF ADDRESS-DETAIL-FOUND                                  06160000
061700           PERFORM 7070-SELECT-TBUSLOC-ROW                        06170000
061800           PERFORM 4300-MOVES-ADDRESS                             06180000
061900           PERFORM 4400-POPULATE-ADDRESS                          06190000
062000           PERFORM 7050-UPDATE-TVNADAU                            06200000
062100         END-IF                                                   06210000
062200                                                                  06220000
062300       END-PERFORM                                                06230000
062400                                                                  06240000
062500       PERFORM 7400-CLOSE-VNADAU-UPD-CSR1                         06250000
062600     ELSE                                                         06260000
062700       IF PV-STRING > SPACES                                      06270000
062800          PERFORM 5000-WRITE-STRING-LINE                          06280000
062900       END-IF                                                     06290000
063000     END-IF.                                                      06300000
063100                                                                  06310000
063200******************************************************************06320000
063300*    FETCH VENDOR ADDRESS ROWS WHERE AUDIT CODE = 'U'            *06330000
063400******************************************************************06340000
063500 2500-PROCESS-VNADAU-UPDS.                                        06350000
063600                                                                  06360000
063700** LOOP #2 GRAB VENDOR ADDRESS ROW WHERE NO CORRESPONDING DETAIL  06370000
063800** HISTORY ROW EXISTS                                             06380000
063900     PERFORM 7060-FETCH-VNADAU-UPD-CSR2.                          06390000
064000                                                                  06400000
064100     IF NOT-OUT-OF-VNADAU-UPDS2                                   06410000
064200       MOVE VNADAU-ENT-ID    TO PV-ENT-ID                         06420000
064300       PERFORM 7020-SELECT-TENTNME-TYP01                          06430000
064400       IF (VNADAU-ENT-ID NOT = PV-PREV-ENT-ID OR                  06440000
064500          VNADAU-LAST-UPD-BY-USR-ID NOT = PV-PREV-USER-ID OR      06450000
064600          PV-UPDATE-DATE NOT = PV-PREV-UPDATE-DATE) OR            06460000
064700                (PV-PREV-ENT-ID = ZEROES AND                      06470000
064800                 PV-PREV-USER-ID = SPACES AND                     06480000
064900                 PV-PREV-UPDATE-DATE = ZEROES)                    06490000
065000          MOVE VNADAU-LAST-UPD-BY-USR-ID TO PV-USER-ID            06500000
065100          MOVE ENTNME-ENT-NAME-DESC      TO PV-PRIM-NAME          06510000
065200          PERFORM 4000-STRING-PRIMARY-FLDS                        06520000
065300          MOVE VNADAU-ENT-ID             TO PV-PREV-ENT-ID        06530000
065400          MOVE VNADAU-LAST-UPD-BY-USR-ID TO PV-PREV-USER-ID       06540000
065500          MOVE PV-UPDATE-DATE            TO PV-PREV-UPDATE-DATE   06550000
065600       END-IF                                                     06560000
065700       PERFORM 7070-SELECT-TBUSLOC-ROW                            06570000
065800       PERFORM 4300-MOVES-ADDRESS                                 06580000
065900       PERFORM 4400-POPULATE-ADDRESS                              06590000
066000     ELSE                                                         06600000
066100       IF PV-STRING > SPACES                                      06610000
066200         PERFORM 5000-WRITE-STRING-LINE                           06620000
066300       END-IF                                                     06630000
066400     END-IF.                                                      06640000
066500                                                                  06650000
066600******************************************************************06660000
066700*    ENDING PROCESSING: DISPLAY BEGIN & END DATES CALCULATED &   *06670000
066800*    CLOSE FILES.                                                *06680000
066900******************************************************************06690000
067000 3000-END-PROGRAM.                                                06700000
067100                                                                  06710000
067200     CLOSE  VENDOR-REPORT-FILE.                                   06720000
067300                                                                  06730000
067400     DISPLAY '*****   RECORD COUNTS FROM VNKRP012    ******'.     06740000
067500     DISPLAY '*****   RECORD COUNTS FROM VNKRP012    ******'.     06750000
067600     DISPLAY '---------------------------------------------'.     06760000
067700     DISPLAY 'CALCULATED WEEK BEGIN DATE => ' PV-MIN-UPDATE-DATE. 06770000
067800     DISPLAY 'CALCULATED WEEK END DATE => ' PV-MAX-UPDATE-DATE.   06780000
067900     DISPLAY 'ADDRESS DETAIL ROWS UPDATED =>' PC-VUPD-TVNADAU-CNT.06790000
068000     DISPLAY '                                             '.     06800000
068100                                                                  06810000
068200 4000-STRING-PRIMARY-FLDS.                                        06820000
068300** WRITE OUT REST OF PREVIOUS RECORD                              06830000
068400     IF PV-STRING > SPACES                                        06840000
068500       PERFORM 5000-WRITE-STRING-LINE                             06850000
068600     END-IF.                                                      06860000
068700                                                                  06870000
068800     MOVE PV-UPDATE-MM                      TO PV-UPD-MM.         06880000
068900     MOVE PV-UPDATE-DD                      TO PV-UPD-DD.         06890000
069000     MOVE PV-UPDATE-YY                      TO PV-UPD-YY.         06900000
069100                                                                  06910000
069200     STRING ' '                  DELIMITED BY SIZE,               06920000
069300            PV-USER-ID           DELIMITED BY SIZE,               06930000
069400            ' '                  DELIMITED BY SIZE,               06940000
069500            PV-UPD-DTE           DELIMITED BY SIZE,               06950000
069600            ' '                  DELIMITED BY SIZE,               06960000
069700            PV-PRIM-NAME         DELIMITED BY SIZE                06970000
069800     INTO PV-HEADING-STRING.                                      06980000
069900                                                                  06990000
070000 4100-MOVES-DETAIL.                                               07000000
070100     MOVE VNDTAU-STAT-CDE          TO PV-VNDR-STATUS-V.           07010000
070200     MOVE VNDTAU-VND-NM            TO PV-VN-NAME-V.               07020000
070700     MOVE VNDTAU-PRNT-CO-IND-CDE   TO PV-PRNT-CO-V.               07070000
070800     MOVE VNDTAU-PAY-FCTR-IND-CDE  TO PV-PAY-FCTR-V.              07080000
070900     MOVE VNDTAU-HLD-PAYT-IND-CDE  TO PV-HLD-PAYT-V.              07090000
071000     MOVE VNDTAU-SEPR-INVC-IND-CDE TO PV-SEP-INV-PAY-V.           07100000
071100     MOVE VNDTAU-PAYT-HNDLG-CDE    TO PV-PYMT-HNDL-V.             07110000
071200     MOVE VNDTAU-NEED-1099-IND-CDE TO PV-1099-IND-V.              07120000
071300     MOVE VNDTAU-FED-TX-ID-NBR     TO PV-TAXID-V.                 07130000
071310     MOVE VNDTAU-PRIM-TYP-CDE      TO PV-PRIM-TYP-CDE-V.          07131001
071320     MOVE VNDTAU-PRTNR-IND         TO PV-PRTNR-IND-V.             07132001
071330     MOVE VNDTAU-PRTNR-TYP-CDE     TO PV-PRTNR-TYP-CDE-V.         07133001
071400                                                                  07140000
071500 4200-POPULATE-DETAIL.                                            07150000
071600** CHECK EACH FIELD IN FILE FOR SPACES & ONLY MOVE POPULATED      07160000
071700** FIELDS TO OUTPUT STRING                                        07170000
071800     IF PV-VN-NAME-V = SPACES                                     07180000
071900         CONTINUE                                                 07190000
072000     ELSE                                                         07200000
072100         MOVE PV-VN-NAME  TO PV-STRING-RECEIVER                   07210000
072200         PERFORM 4600-STRING-PARAGRAPH                            07220000
072300         MOVE SPACES TO PV-VN-NAME-V                              07230000
072400     END-IF.                                                      07240000
072500                                                                  07250000
072600     IF PV-VNDR-STATUS-V = SPACES                                 07260000
072700         CONTINUE                                                 07270000
072800     ELSE                                                         07280000
072900         MOVE PV-VNDR-STATUS  TO PV-STRING-RECEIVER               07290000
073000         PERFORM 4600-STRING-PARAGRAPH                            07300000
073100         MOVE SPACES TO PV-VNDR-STATUS-V                          07310000
073200     END-IF.                                                      07320000
073300                                                                  07330000
073400     IF PV-PRIM-TYP-CDE-V = SPACES                                07340001
073500         CONTINUE                                                 07350000
073600     ELSE                                                         07360000
073700         MOVE PV-PRIM-TYP-CDE         TO PV-STRING-RECEIVER       07370001
073800         PERFORM 4600-STRING-PARAGRAPH                            07380000
073900         MOVE SPACES TO PV-PRIM-TYP-CDE-V                         07390001
074000     END-IF.                                                      07400000
074100                                                                  07410000
074200     IF PV-PRTNR-IND-V = SPACES                                   07420001
074300         CONTINUE                                                 07430000
074400     ELSE                                                         07440000
074500         MOVE PV-PRTNR-IND           TO PV-STRING-RECEIVER        07450001
074600         PERFORM 4600-STRING-PARAGRAPH                            07460000
074700         MOVE SPACES TO PV-PRTNR-IND-V                            07470001
074800     END-IF.                                                      07480000
074900                                                                  07490000
075000     IF PV-PRTNR-TYP-CDE-V = SPACES                               07500001
075100         CONTINUE                                                 07510000
075200     ELSE                                                         07520000
075300         MOVE PV-PRTNR-TYP-CDE        TO PV-STRING-RECEIVER       07530001
075400         PERFORM 4600-STRING-PARAGRAPH                            07540000
075500         MOVE SPACES TO PV-PRTNR-TYP-CDE-V                        07550001
075600     END-IF.                                                      07560000
075700                                                                  07570000
076600     IF PV-PRNT-CO-V = SPACES                                     07660000
076700         CONTINUE                                                 07670000
076800     ELSE                                                         07680000
076900         MOVE PV-PRNT-CO              TO PV-STRING-RECEIVER       07690000
077000         PERFORM 4600-STRING-PARAGRAPH                            07700000
077100         MOVE SPACES TO PV-PRNT-CO-V                              07710000
077200     END-IF.                                                      07720000
077300                                                                  07730000
077400     IF PV-PAY-FCTR-V = SPACES                                    07740000
077500         CONTINUE                                                 07750000
077600     ELSE                                                         07760000
077700         MOVE PV-PAY-FCTR             TO PV-STRING-RECEIVER       07770000
077800         PERFORM 4600-STRING-PARAGRAPH                            07780000
077900         MOVE SPACES TO PV-PAY-FCTR-V                             07790000
078000     END-IF.                                                      07800000
078100                                                                  07810000
078200     IF PV-HLD-PAYT-V = SPACES                                    07820000
078300         CONTINUE                                                 07830000
078400     ELSE                                                         07840000
078500         MOVE PV-HLD-PAYT             TO PV-STRING-RECEIVER       07850000
078600         PERFORM 4600-STRING-PARAGRAPH                            07860000
078700         MOVE SPACES TO PV-HLD-PAYT-V                             07870000
078800     END-IF.                                                      07880000
078900                                                                  07890000
079000     IF PV-SEP-INV-PAY-V = SPACES                                 07900000
079100         CONTINUE                                                 07910000
079200     ELSE                                                         07920000
079300         MOVE PV-SEP-INV-PAY           TO PV-STRING-RECEIVER      07930000
079400         PERFORM 4600-STRING-PARAGRAPH                            07940000
079500         MOVE SPACES TO PV-SEP-INV-PAY-V                          07950000
079600     END-IF.                                                      07960000
079700                                                                  07970000
079800     IF PV-PYMT-HNDL-V = SPACES                                   07980000
079900         CONTINUE                                                 07990000
080000     ELSE                                                         08000000
080100         MOVE PV-PYMT-HNDL          TO PV-STRING-RECEIVER         08010000
080200         PERFORM 4600-STRING-PARAGRAPH                            08020000
080300         MOVE SPACES TO PV-PYMT-HNDL-V                            08030000
080400     END-IF.                                                      08040000
080500                                                                  08050000
080600     IF PV-1099-IND-V = SPACES                                    08060000
080700         CONTINUE                                                 08070000
080800     ELSE                                                         08080000
080900         MOVE PV-1099-IND              TO PV-STRING-RECEIVER      08090000
081000         PERFORM 4600-STRING-PARAGRAPH                            08100000
081100         MOVE SPACES TO PV-1099-IND-V                             08110000
081200     END-IF.                                                      08120000
081300                                                                  08130000
081400     IF PV-TAXID-V = SPACES                                       08140000
081500         CONTINUE                                                 08150000
081600     ELSE                                                         08160000
081700         MOVE PV-TAXID             TO PV-STRING-RECEIVER          08170000
081800         PERFORM 4600-STRING-PARAGRAPH                            08180000
081900         MOVE SPACES TO PV-TAXID-V                                08190000
082000     END-IF.                                                      08200000
082100                                                                  08210000
082200 4300-MOVES-ADDRESS.                                              08220000
082300     INITIALIZE PV-CONTACT-NAME-V                                 08230000
082400     STRING VNADAU-REP-1ST-NM DELIMITED BY ' '                    08240000
082500       ' ' DELIMITED BY SIZE                                      08250000
082600       VNADAU-REP-LAST-NM DELIMITED BY '  '                       08260000
082700     INTO PV-CONTACT-NAME-V.                                      08270000
082800                                                                  08280000
082900     IF WS-ADDR-DELETED > SPACES                                  08290000
083000       MOVE WS-ADDR-DELETED TO PV-ADDRESS1-V                      08300000
083100       MOVE SPACES TO WS-ADDR-DELETED                             08310000
083200     ELSE                                                         08320000
083300     IF BUSLOC-FUNCTION-ID = 9                                    08330000
083400       MOVE VNADAU-VND-1ST-LNE-ADDR TO PV-ADDRESS1-V              08340000
083500       MOVE VNADAU-VND-2ND-LNE-ADDR TO PV-ADDRESS2-V              08350000
083600       MOVE VNADAU-VND-3RD-LNE-ADDR TO PV-ADDRESS3-V              08360000
083700       MOVE VNADAU-CTY-NM           TO PV-CITY-NAME-V             08370000
083800       MOVE VNADAU-ST-PROV-CDE      TO PV-ST-PROV-V               08380000
083900       MOVE VNADAU-ZIP-CDE          TO PV-ZIP-CODE-V              08390000
084000       MOVE VNADAU-CNTRY-CDE        TO PV-CNTRY-CDE-V             08400000
084100       MOVE VNADAU-ATTN-TO-TXT      TO PV-ATTN-TO-V               08410000
084200       MOVE VNADAU-EXTD-VND-NM      TO PV-EXTD-VND-NM-V           08420000
084300       MOVE SPACES                  TO PV-1099ADD1-V              08430000
084400                                       PV-1099ADD2-V              08440000
084500                                       PV-1099ADD3-V              08450000
084600                                       PV-1099-CITY-V             08460000
084700                                       PV-1099-STPR-V             08470000
084800                                       PV-1099-ZIP-V              08480000
084900                                       PV-1099-CNTRY-V            08490000
085000                                       PV-1099-ATTN-TO-V          08500000
085100                                       PV-1099-ALT-NM-V           08510000
085200     ELSE                                                         08520000
085300       MOVE VNADAU-VND-1ST-LNE-ADDR TO PV-1099ADD1-V              08530000
085400       MOVE VNADAU-VND-2ND-LNE-ADDR TO PV-1099ADD2-V              08540000
085500       MOVE VNADAU-VND-3RD-LNE-ADDR TO PV-1099ADD3-V              08550000
085600       MOVE VNADAU-CTY-NM           TO PV-1099-CITY-V             08560000
085700       MOVE VNADAU-ST-PROV-CDE      TO PV-1099-STPR-V             08570000
085800       MOVE VNADAU-ZIP-CDE          TO PV-1099-ZIP-V              08580000
085900       MOVE VNADAU-CNTRY-CDE        TO PV-1099-CNTRY-V            08590000
086000       MOVE VNADAU-ATTN-TO-TXT      TO PV-1099-ATTN-TO-V          08600000
086100       MOVE VNADAU-EXTD-VND-NM      TO PV-1099-ALT-NM-V           08610000
086200       MOVE SPACES                  TO PV-ADDRESS1-V              08620000
086300                                       PV-ADDRESS2-V              08630000
086400                                       PV-ADDRESS3-V              08640000
086500                                       PV-CITY-NAME-V             08650000
086600                                       PV-ST-PROV-V               08660000
086700                                       PV-ZIP-CODE-V              08670000
086800                                       PV-CNTRY-CDE-V             08680000
086900                                       PV-ATTN-TO-V               08690000
087000                                       PV-EXTD-VND-NM-V.          08700000
087100                                                                  08710000
087200 4400-POPULATE-ADDRESS.                                           08720000
087300     IF PV-CONTACT-NAME-V = SPACES                                08730000
087400         CONTINUE                                                 08740000
087500     ELSE                                                         08750000
087600         MOVE PV-CONTACT-NAME       TO PV-STRING-RECEIVER         08760000
087700         PERFORM 4600-STRING-PARAGRAPH                            08770000
087800         MOVE SPACES TO PV-CONTACT-NAME-V                         08780000
087900     END-IF.                                                      08790000
088000                                                                  08800000
088100     IF PV-EXTD-VND-NM-V = SPACES                                 08810000
088200         CONTINUE                                                 08820000
088300     ELSE                                                         08830000
088400         MOVE PV-EXTD-VND-NM        TO PV-STRING-RECEIVER         08840000
088500         PERFORM 4600-STRING-PARAGRAPH                            08850000
088600         MOVE SPACES TO PV-EXTD-VND-NM-V                          08860000
088700     END-IF.                                                      08870000
088800                                                                  08880000
088900     IF PV-1099-ALT-NM-V = SPACES                                 08890000
089000         CONTINUE                                                 08900000
089100     ELSE                                                         08910000
089200         MOVE PV-1099-ALT-NM        TO PV-STRING-RECEIVER         08920000
089300         PERFORM 4600-STRING-PARAGRAPH                            08930000
089400         MOVE SPACES TO PV-1099-ALT-NM-V                          08940000
089500     END-IF.                                                      08950000
089600                                                                  08960000
089700     IF PV-ADDRESS1-V = SPACES                                    08970000
089800         CONTINUE                                                 08980000
089900     ELSE                                                         08990000
090000         MOVE PV-ADDRESS1             TO PV-STRING-RECEIVER       09000000
090100         PERFORM 4600-STRING-PARAGRAPH                            09010000
090200         MOVE SPACES TO PV-ADDRESS1-V                             09020000
090300     END-IF.                                                      09030000
090400                                                                  09040000
090500     IF PV-1099ADD1-V = SPACES                                    09050000
090600         CONTINUE                                                 09060000
090700     ELSE                                                         09070000
090800         MOVE PV-1099ADD1             TO PV-STRING-RECEIVER       09080000
090900         PERFORM 4600-STRING-PARAGRAPH                            09090000
091000         MOVE SPACES TO PV-1099ADD1-V                             09100000
091100     END-IF.                                                      09110000
091200                                                                  09120000
091300     IF PV-ADDRESS2-V = SPACES                                    09130000
091400         CONTINUE                                                 09140000
091500     ELSE                                                         09150000
091600         MOVE PV-ADDRESS2             TO PV-STRING-RECEIVER       09160000
091700         PERFORM 4600-STRING-PARAGRAPH                            09170000
091800         MOVE SPACES TO PV-ADDRESS2-V                             09180000
091900     END-IF.                                                      09190000
092000                                                                  09200000
092100     IF PV-1099ADD2-V = SPACES                                    09210000
092200         CONTINUE                                                 09220000
092300     ELSE                                                         09230000
092400         MOVE PV-1099ADD2             TO PV-STRING-RECEIVER       09240000
092500         PERFORM 4600-STRING-PARAGRAPH                            09250000
092600         MOVE SPACES TO PV-1099ADD2-V                             09260000
092700     END-IF.                                                      09270000
092800                                                                  09280000
092900     IF PV-ADDRESS3-V = SPACES                                    09290000
093000         CONTINUE                                                 09300000
093100     ELSE                                                         09310000
093200         MOVE PV-ADDRESS3-V           TO PV-STRING-RECEIVER       09320000
093300         PERFORM 4600-STRING-PARAGRAPH                            09330000
093400         MOVE SPACES TO PV-ADDRESS3-V                             09340000
093500     END-IF.                                                      09350000
093600                                                                  09360000
093700     IF PV-1099ADD3-V = SPACES                                    09370000
093800         CONTINUE                                                 09380000
093900     ELSE                                                         09390000
094000         MOVE PV-1099ADD3-V           TO PV-STRING-RECEIVER       09400000
094100         PERFORM 4600-STRING-PARAGRAPH                            09410000
094200         MOVE SPACES TO PV-1099ADD3-V                             09420000
094300     END-IF.                                                      09430000
094400                                                                  09440000
094500     IF PV-CITY-NAME-V = SPACES                                   09450000
094600         CONTINUE                                                 09460000
094700     ELSE                                                         09470000
094800         MOVE PV-CITY-NAME       TO PV-STRING-RECEIVER            09480000
094900         PERFORM 4600-STRING-PARAGRAPH                            09490000
095000         MOVE SPACES TO PV-CITY-NAME-V                            09500000
095100     END-IF.                                                      09510000
095200                                                                  09520000
095300     IF PV-1099-CITY-V = SPACES                                   09530000
095400         CONTINUE                                                 09540000
095500     ELSE                                                         09550000
095600         MOVE PV-1099-CITY       TO PV-STRING-RECEIVER            09560000
095700         PERFORM 4600-STRING-PARAGRAPH                            09570000
095800         MOVE SPACES TO PV-1099-CITY-V                            09580000
095900     END-IF.                                                      09590000
096000                                                                  09600000
096100     IF PV-ST-PROV-V = SPACES                                     09610000
096200         CONTINUE                                                 09620000
096300     ELSE                                                         09630000
096400         MOVE PV-ST-PROV              TO PV-STRING-RECEIVER       09640000
096500         PERFORM 4600-STRING-PARAGRAPH                            09650000
096600         MOVE SPACES TO PV-ST-PROV-V                              09660000
096700     END-IF.                                                      09670000
096800                                                                  09680000
096900     IF PV-ZIP-CODE-V = SPACES                                    09690000
097000         CONTINUE                                                 09700000
097100     ELSE                                                         09710000
097200         MOVE PV-ZIP-CODE        TO PV-STRING-RECEIVER            09720000
097300         PERFORM 4600-STRING-PARAGRAPH                            09730000
097400         MOVE SPACES TO PV-ZIP-CODE-V                             09740000
097500     END-IF.                                                      09750000
097600                                                                  09760000
097700     IF PV-1099-STPR-V = SPACES                                   09770000
097800         CONTINUE                                                 09780000
097900     ELSE                                                         09790000
098000         MOVE PV-1099-STPR            TO PV-STRING-RECEIVER       09800000
098100         PERFORM 4600-STRING-PARAGRAPH                            09810000
098200         MOVE SPACES TO PV-1099-STPR                              09820000
098300     END-IF.                                                      09830000
098400                                                                  09840000
098500     IF PV-1099-ZIP-V = SPACES                                    09850000
098600         CONTINUE                                                 09860000
098700     ELSE                                                         09870000
098800         MOVE PV-1099-ZIP        TO PV-STRING-RECEIVER            09880000
098900         PERFORM 4600-STRING-PARAGRAPH                            09890000
099000         MOVE SPACES TO PV-ZIP-CODE-V                             09900000
099100     END-IF.                                                      09910000
099200                                                                  09920000
099300     IF PV-1099-CNTRY-V = SPACES                                  09930000
099400         CONTINUE                                                 09940000
099500     ELSE                                                         09950000
099600         MOVE PV-1099-CNTRY           TO PV-STRING-RECEIVER       09960000
099700         PERFORM 4600-STRING-PARAGRAPH                            09970000
099800         MOVE SPACES TO PV-CNTRY-CDE-V                            09980000
099900     END-IF.                                                      09990000
100000                                                                  10000000
100100     IF PV-1099-ATTN-TO-V = SPACES                                10010000
100200         CONTINUE                                                 10020000
100300     ELSE                                                         10030000
100400         MOVE PV-1099-ATTN-TO         TO PV-STRING-RECEIVER       10040000
100500         PERFORM 4600-STRING-PARAGRAPH                            10050000
100600         MOVE SPACES TO PV-ATTN-TO-V                              10060000
100700     END-IF.                                                      10070000
100800                                                                  10080000
100900     IF PV-CNTRY-CDE-V = SPACES                                   10090000
101000         CONTINUE                                                 10100000
101100     ELSE                                                         10110000
101200         MOVE PV-CNTRY-CDE            TO PV-STRING-RECEIVER       10120000
101300         PERFORM 4600-STRING-PARAGRAPH                            10130000
101400         MOVE SPACES TO PV-CNTRY-CDE-V                            10140000
101500     END-IF.                                                      10150000
101600                                                                  10160000
101700     IF PV-ATTN-TO-V = SPACES                                     10170000
101800         CONTINUE                                                 10180000
101900     ELSE                                                         10190000
102000         MOVE PV-ATTN-TO              TO PV-STRING-RECEIVER       10200000
102100         PERFORM 4600-STRING-PARAGRAPH                            10210000
102200         MOVE SPACES TO PV-ATTN-TO-V                              10220000
102300     END-IF.                                                      10230000
102400                                                                  10240000
102500 4600-STRING-PARAGRAPH.                                           10250000
102600                                                                  10260000
102700     STRING PV-STRING            DELIMITED BY '   ',              10270000
102800            '  '                 DELIMITED BY SIZE,               10280000
102900            PV-STRING-RECEIVER   DELIMITED BY '  '                10290000
103000       INTO PV-STRING                                             10300000
103100      ON OVERFLOW                                                 10310000
103200            MOVE PV-STRING-PREV TO PV-STRING                      10320000
103300            MOVE PV-STRING-RECEIVER TO PV-STRING-OVERFLOW         10330000
103400     END-STRING.                                                  10340000
103500                                                                  10350000
103600     MOVE PV-STRING  TO PV-STRING-PREV.                           10360000
103700                                                                  10370000
103800     IF PV-STRING-OVERFLOW > SPACES                               10380000
103900         PERFORM 5000-WRITE-STRING-LINE                           10390000
104000     END-IF.                                                      10400000
104100                                                                  10410000
104200 5000-WRITE-STRING-LINE.                                          10420000
104300     IF PC-LINE-COUNT > PC-MAX-LINES                              10430000
104400         PERFORM 6000-WRITE-REPORT-HEADERS                        10440000
104500     END-IF.                                                      10450000
104600                                                                  10460000
104700     MOVE PV-STRING TO PV-STRING2.                                10470000
104800     IF PV-STRING-POS12 = SPACES                                  10480000
104900       MOVE SPACES         TO PV-STRING                           10490000
105000       MOVE PV-STRING-REST TO PV-STRING.                          10500000
105100                                                                  10510000
105200     MOVE PV-STRING-LINE TO  VENDOR-REPORT-RECORD.                10520000
105300     WRITE VENDOR-REPORT-RECORD AFTER 1.                          10530000
105400     ADD 1 TO PC-LINE-COUNT.                                      10540000
105500     INITIALIZE PV-STRING-LINE.                                   10550000
105600     MOVE PV-STRING-OVERFLOW TO PV-STRING.                        10560000
105700     MOVE SPACES TO PV-STRING-OVERFLOW.                           10570000
105800                                                                  10580000
105900******************************************************************10590000
106000**               WRITE REPORT HEADINGS                          **10600000
106100******************************************************************10610000
106200 6000-WRITE-REPORT-HEADERS.                                       10620000
106300     ADD 1                            TO PC-PAGE-COUNT.           10630000
106400     MOVE PC-PAGE-COUNT               TO DP150O-PAGE-NUMBER.      10640000
106500                                                                  10650000
106600     WRITE VENDOR-REPORT-RECORD                                   10660000
106700           FROM DP150O-STANDRD-HEADER-150-COLS AFTER PAGE.        10670000
106800                                                                  10680000
106900     WRITE VENDOR-REPORT-RECORD FROM H2-HEADER2 AFTER 1.          10690000
107000     WRITE VENDOR-REPORT-RECORD FROM H2-HEADER3 AFTER 1.          10700000
107100                                                                  10710000
107200     WRITE VENDOR-REPORT-RECORD FROM WS-BLANK-LINE AFTER 2.       10720000
107300                                                                  10730000
107400     WRITE VENDOR-REPORT-RECORD FROM DH-DETAIL-HEADER1 AFTER 1.   10740000
107500                                                                  10750000
107600     MOVE 5  TO PC-LINE-COUNT.                                    10760000
107700                                                                  10770000
107800 7000-FETCH-VNDTAU-UPD-CSR1.                                      10780000
107900                                                                  10790000
108000     EXEC SQL                                                     10800000
108100        FETCH VNDTAU_UPD_CSR1                                     10810000
108200         INTO :VNDTAU-ENT-ID                                      10820000
108300             ,:PV-UPDATE-DATE                                     10830000
108400             ,:VNDTAU-LAST-UPD-BY-USR-ID                          10840000
108500             ,:VNDTAU-VND-NM                                      10850000
108600             ,:VNDTAU-STAT-CDE                                    10860000
109100             ,:VNDTAU-PRNT-CO-IND-CDE                             10910000
109200             ,:VNDTAU-PAY-FCTR-IND-CDE                            10920000
109300             ,:VNDTAU-HLD-PAYT-IND-CDE                            10930000
109400             ,:VNDTAU-SEPR-INVC-IND-CDE                           10940000
109500             ,:VNDTAU-PAYT-HNDLG-CDE                              10950000
109600             ,:VNDTAU-NEED-1099-IND-CDE                           10960000
109700             ,:VNDTAU-FED-TX-ID-NBR                               10970000
109710             ,:VNDTAU-PRIM-TYP-CDE                                10971001
109720             ,:VNDTAU-PRTNR-IND                                   10972001
109730             ,:VNDTAU-PRTNR-TYP-CDE                               10973001
109800     END-EXEC.                                                    10980000
109900                                                                  10990000
110000     EVALUATE TRUE                                                11000000
110100      WHEN SQLCODE = ZERO                                         11010000
110200        CONTINUE                                                  11020000
110300      WHEN SQLCODE = +100                                         11030000
110400        SET OUT-OF-VNDTAU-UPDS1 TO TRUE                           11040000
110500      WHEN SQLWARN0 NOT = SPACES                                  11050000
110600      WHEN SQLCODE  NOT = ZERO                                    11060000
110700        MOVE '7000-FETCH-VNDTAU-UPD-CSR1'                         11070000
110800                           TO AA-PARAGRAPH-NAME                   11080000
110900        MOVE                                                      11090000
111000             'UNSUCCESSFUL FETCH WITH VNDTAU UPD CSR1'            11100000
111100                           TO AA-DB2-OPERATION                    11110000
111200        MOVE 'TVNDTAU'     TO AA-DB2-TABLE-1                      11120000
111300        MOVE SPACES        TO AA-DB2-TABLE-2                      11130000
111400                              AA-DB2-TABLE-3                      11140000
111500        PERFORM 9999-DB2-ABEND                                    11150000
111600     END-EVALUATE.                                                11160000
111700                                                                  11170000
111800 7010-FETCH-VNADAU-UPD-CSR1.                                      11180000
111900                                                                  11190000
112000     EXEC SQL                                                     11200000
112100        FETCH VNADAU_UPD_CSR1                                     11210000
112200         INTO :VNADAU-ENT-ID                                      11220000
112300             ,:VNADAU-SEQ-NBR                                     11230000
112400             ,:VNADAU-REP-1ST-NM                                  11240000
112500             ,:VNADAU-REP-LAST-NM                                 11250000
112600             ,:VNADAU-EXTD-VND-NM                                 11260000
112700             ,:VNADAU-VND-1ST-LNE-ADDR                            11270000
112800             ,:VNADAU-VND-2ND-LNE-ADDR                            11280000
112900             ,:VNADAU-VND-3RD-LNE-ADDR                            11290000
113000             ,:VNADAU-CTY-NM                                      11300000
113100             ,:VNADAU-ST-PROV-CDE                                 11310000
113200             ,:VNADAU-ZIP-CDE                                     11320000
113300             ,:VNADAU-CNTRY-CDE                                   11330000
113400             ,:VNADAU-ATTN-TO-TXT                                 11340000
113500     END-EXEC.                                                    11350000
113600                                                                  11360000
113700     EVALUATE TRUE                                                11370000
113800      WHEN SQLCODE = ZERO                                         11380000
113900        SET ADDRESS-DETAIL-FOUND TO TRUE                          11390000
114000      WHEN SQLCODE = +100                                         11400000
114100        SET NO-ADDRESS-DETAIL-FOUND TO TRUE                       11410000
114200        SET OUT-OF-VNADAU-UPDS1     TO TRUE                       11420000
114300      WHEN SQLWARN0 NOT = SPACES                                  11430000
114400      WHEN SQLCODE  NOT = ZERO                                    11440000
114500        MOVE '7010-FETCH-VNADAU-UPD-CSR1'                         11450000
114600                           TO AA-PARAGRAPH-NAME                   11460000
114700        MOVE                                                      11470000
114800             'UNSUCCESSFUL FETCH WITH VNADAU UPD CSR1'            11480000
114900                           TO AA-DB2-OPERATION                    11490000
115000        MOVE 'TVNADAU'     TO AA-DB2-TABLE-1                      11500000
115100        MOVE SPACES        TO AA-DB2-TABLE-2                      11510000
115200                              AA-DB2-TABLE-3                      11520000
115300        PERFORM 9999-DB2-ABEND                                    11530000
115400     END-EVALUATE.                                                11540000
115500                                                                  11550000
115600 7020-SELECT-TENTNME-TYP01.                                       11560000
115700     PERFORM                                                      11570000
115800         WITH TEST AFTER                                          11580000
115900         VARYING PV-RETRY-COUNTER                                 11590000
116000         FROM 1 BY 1                                              11600000
116100         UNTIL ((PV-RETRY-COUNTER > PV-MAX-RETRIES)               11610000
116200                   OR (SQLCODE = ZERO)                            11620000
116300                   OR (SQLCODE = +100))                           11630000
116400                                                                  11640000
116500         EXEC SQL                                                 11650000
116600             SELECT ENT_NAME_DESC                                 11660000
116700             INTO  :ENTNME-ENT-NAME-DESC                          11670000
116800             FROM TENTNME                                         11680000
116900             WHERE                                                11690000
117000                ENT_ID = :PV-ENT-ID AND TYPE_CDE = '01'           11700000
117100         END-EXEC                                                 11710000
117200                                                                  11720000
117300         EVALUATE TRUE                                            11730000
117400             WHEN SQLCODE = ZERO                                  11740000
117500             WHEN SQLCODE = -904                                  11750000
117600             WHEN SQLCODE = -913                                  11760000
117700                 CONTINUE                                         11770000
117800             WHEN SQLWARN0 NOT = SPACES                           11780000
117900             WHEN SQLCODE < ZERO                                  11790000
118000             WHEN SQLCODE > ZERO                                  11800000
118100                  MOVE '7020-SELECT-TENTNME-TYP01'                11810000
118200                                  TO AA-PARAGRAPH-NAME            11820000
118300                  MOVE 'UNSUCCESSFUL SELECT TENTNME TBL '         11830000
118400                                  TO AA-DB2-OPERATION             11840000
118500                  MOVE 'TENTNME ' TO AA-DB2-TABLE-1               11850000
118600                  MOVE SPACES     TO AA-DB2-TABLE-2               11860000
118700                  PERFORM 9999-DB2-ABEND                          11870000
118800         END-EVALUATE                                             11880000
118900     END-PERFORM.                                                 11890000
119000                                                                  11900000
119100     IF  PV-RETRY-COUNTER > PV-MAX-RETRIES                        11910000
119200         MOVE '7020-SELECT-TENTNME-TYP01' TO  AA-PARAGRAPH-NAME   11920000
119300         MOVE 'MAX RETRIES EXCEEDED ON SELECT TENTNME NAME    '   11930000
119400                                  TO AA-DB2-OPERATION             11940000
119500         MOVE 'TENTNME '          TO AA-DB2-TABLE-1               11950000
119600         MOVE SPACES              TO AA-DB2-TABLE-2               11960000
119700         PERFORM 9999-DB2-ABEND                                   11970000
119800     END-IF.                                                      11980000
119900                                                                  11990000
120000 7030-GET-RPT-BEG-END-DATE.                                       12000000
120100     PERFORM                                                      12010000
120200         WITH TEST AFTER                                          12020000
120300         VARYING PV-RETRY-COUNTER                                 12030000
120400         FROM 1 BY 1                                              12040000
120500         UNTIL ((PV-RETRY-COUNTER > PV-MAX-RETRIES)               12050000
120600             OR (SQLCODE = +0)                                    12060000
120700             OR (SQLCODE = -305))                                 12070000
120800                                                                  12080000
120900         EXEC SQL                                                 12090000
121000           SELECT PREV_WK_END_DTE                                 12100000
121100                 ,(PREV_WK_END_DTE - 7 DAYS)                      12110000
121200            INTO  :PV-MAX-UPDATE-DATE                             12120000
121300                 ,:PV-MIN-UPDATE-DATE                             12130000
121400            FROM TAPCNTL                                          12140000
121500         END-EXEC                                                 12150000
121600                                                                  12160000
121700         EVALUATE TRUE                                            12170000
121800             WHEN SQLCODE = +0                                    12180000
121900             WHEN SQLCODE = -904                                  12190000
122000             WHEN SQLCODE = -913                                  12200000
122100                  CONTINUE                                        12210000
122200             WHEN SQLWARN0 NOT = SPACES                           12220000
122300             WHEN SQLCODE < +0                                    12230000
122400             WHEN SQLCODE > +0                                    12240000
122500                  MOVE '7030-GET-RPT-BEG-END-DATE'                12250000
122600                                  TO AA-PARAGRAPH-NAME            12260000
122700                  MOVE 'UNSUCCESSFUL SELECT TAPCNTL TBL '         12270000
122800                                  TO AA-DB2-OPERATION             12280000
122900                  MOVE 'TAPCNTL'  TO AA-DB2-TABLE-1               12290000
123000                  MOVE SPACES     TO AA-DB2-TABLE-2               12300000
123100                  PERFORM 9999-DB2-ABEND                          12310000
123200         END-EVALUATE                                             12320000
123300     END-PERFORM.                                                 12330000
123400                                                                  12340000
123500     IF  PV-RETRY-COUNTER > PV-MAX-RETRIES                        12350000
123600         MOVE '7030-GET-RPT-BEG-END-DATE' TO  AA-PARAGRAPH-NAME   12360000
123700         MOVE 'MAX RETRIES EXCEEDED ON SELECT TAPCNTL TABLE   '   12370000
123800                                  TO AA-DB2-OPERATION             12380000
123900         MOVE 'TAPCNTL'           TO AA-DB2-TABLE-1               12390000
124000         MOVE SPACES              TO AA-DB2-TABLE-2               12400000
124100         PERFORM 9999-DB2-ABEND                                   12410000
124200     END-IF.                                                      12420000
124300                                                                  12430000
124400******************************************************************12440000
124500***         UPDATE THE ROW ON THE ADDRESS DETAIL TABLE         ***12450000
124600******************************************************************12460000
124700 7050-UPDATE-TVNADAU.                                             12470000
124800     PERFORM                                                      12480000
124900         WITH TEST AFTER                                          12490000
125000         VARYING PV-RETRY-COUNTER                                 12500000
125100         FROM 1 BY 1                                              12510000
125200         UNTIL ((PV-RETRY-COUNTER > PV-MAX-RETRIES)               12520000
125300                   OR (SQLCODE = ZERO))                           12530000
125400         EXEC SQL                                                 12540000
125500             UPDATE TVNADAU                                       12550000
125600               SET AUD_FUNC_CDE = 'P'                             12560000
125700             WHERE CURRENT OF VNADAU_UPD_CSR1                     12570000
125800         END-EXEC                                                 12580000
125900                                                                  12590000
126000         EVALUATE TRUE                                            12600000
126100             WHEN SQLCODE = ZERO                                  12610000
126200                ADD 1 TO PC-VUPD-TVNADAU-CNT                      12620000
126300                ADD 1 TO PV-UPDATE-COUNT                          12630000
126400                PERFORM 9000-COMMIT                               12640000
126500             WHEN SQLCODE = -904                                  12650000
126600             WHEN SQLCODE = -913                                  12660000
126700                 CONTINUE                                         12670000
126800             WHEN SQLWARN0 NOT = SPACES                           12680000
126900             WHEN SQLCODE < ZERO                                  12690000
127000             WHEN SQLCODE > ZERO                                  12700000
127100                 MOVE ' 7050-UPDATE-TVNADAU'                      12710000
127200                                   TO AA-PARAGRAPH-NAME           12720000
127300                 MOVE 'UPDATE A ROW ON THE ADDRESS HISTORY TBL'   12730000
127400                                   TO AA-DB2-OPERATION            12740000
127500                 MOVE 'TVNADAU'    TO AA-DB2-TABLE-1              12750000
127600                 MOVE SPACES       TO AA-DB2-TABLE-2              12760000
127700                 PERFORM 9999-DB2-ABEND                           12770000
127800         END-EVALUATE                                             12780000
127900     END-PERFORM.                                                 12790000
128000                                                                  12800000
128100     IF  PV-RETRY-COUNTER > PV-MAX-RETRIES                        12810000
128200         MOVE ' 7050-UPDATE-TVNADAU'                              12820000
128300                                   TO AA-PARAGRAPH-NAME           12830000
128400         MOVE 'MAX RETRIES EXCEEDED TRYING TO UPDATE TVNADAU '    12840000
128500                                   TO AA-DB2-OPERATION            12850000
128600         MOVE 'TVNADAU'            TO AA-DB2-TABLE-1              12860000
128700         MOVE SPACES               TO AA-DB2-TABLE-2              12870000
128800         PERFORM 9999-DB2-ABEND                                   12880000
128900     END-IF.                                                      12890000
129000                                                                  12900000
129100 7060-FETCH-VNADAU-UPD-CSR2.                                      12910000
129200                                                                  12920000
129300     EXEC SQL                                                     12930000
129400        FETCH VNADAU_UPD_CSR2                                     12940000
129500         INTO :VNADAU-ENT-ID                                      12950000
129600             ,:VNADAU-SEQ-NBR                                     12960000
129700             ,:PV-UPDATE-DATE                                     12970000
129800             ,:VNADAU-LAST-UPD-BY-USR-ID                          12980000
129900             ,:VNADAU-REP-1ST-NM                                  12990000
130000             ,:VNADAU-REP-LAST-NM                                 13000000
130100             ,:VNADAU-EXTD-VND-NM                                 13010000
130200             ,:VNADAU-VND-1ST-LNE-ADDR                            13020000
130300             ,:VNADAU-VND-2ND-LNE-ADDR                            13030000
130400             ,:VNADAU-VND-3RD-LNE-ADDR                            13040000
130500             ,:VNADAU-CTY-NM                                      13050000
130600             ,:VNADAU-ST-PROV-CDE                                 13060000
130700             ,:VNADAU-ZIP-CDE                                     13070000
130800             ,:VNADAU-CNTRY-CDE                                   13080000
130900             ,:VNADAU-ATTN-TO-TXT                                 13090000
131000     END-EXEC.                                                    13100000
131100                                                                  13110000
131200     EVALUATE TRUE                                                13120000
131300      WHEN SQLCODE = ZERO                                         13130000
131400        CONTINUE                                                  13140000
131500      WHEN SQLCODE = +100                                         13150000
131600        SET OUT-OF-VNADAU-UPDS2 TO TRUE                           13160000
131700      WHEN SQLWARN0 NOT = SPACES                                  13170000
131800      WHEN SQLCODE  NOT = ZERO                                    13180000
131900        MOVE '7060-FETCH-VNADAU-UPD-CSR2'                         13190000
132000                           TO AA-PARAGRAPH-NAME                   13200000
132100        MOVE                                                      13210000
132200             'UNSUCCESSFUL FETCH WITH VNADAU UPD CSR1'            13220000
132300                           TO AA-DB2-OPERATION                    13230000
132400        MOVE 'TVNADAU'     TO AA-DB2-TABLE-1                      13240000
132500        MOVE SPACES        TO AA-DB2-TABLE-2                      13250000
132600                              AA-DB2-TABLE-3                      13260000
132700        PERFORM 9999-DB2-ABEND                                    13270000
132800     END-EVALUATE.                                                13280000
132900                                                                  13290000
133000 7070-SELECT-TBUSLOC-ROW.                                         13300000
133100                                                                  13310000
133200     EXEC SQL                                                     13320000
133300           SELECT FUNCTION_ID                                     13330000
133400           INTO :BUSLOC-FUNCTION-ID                               13340000
133500           FROM TBUSLOC                                           13350000
133600           WHERE ENT_ID = :VNADAU-ENT-ID                          13360000
133700                AND SEQ_NBR = :VNADAU-SEQ-NBR                     13370000
133800     END-EXEC.                                                    13380000
133900                                                                  13390000
134000     EVALUATE TRUE                                                13400000
134100          WHEN SQLCODE = ZERO                                     13410000
134200            CONTINUE                                              13420000
134300          WHEN SQLCODE = +100                                     13430000
134400            MOVE 'ADDRESS ROW DELETED FOR VENDOR ' TO             13440000
134500                             WS-ADDR-DELETED                      13450000
134600          WHEN SQLWARN0 NOT = SPACES                              13460000
134700          WHEN SQLCODE  NOT = ZERO                                13470000
134800            MOVE '7070-SELECT-TBUSLOC-ROW'                        13480000
134900                                       TO AA-PARAGRAPH-NAME       13490000
135000            MOVE                                                  13500000
135100                'UNSUCCESSFUL SELECT ON TBUSLOC TABLE   '         13510000
135200                                    TO AA-DB2-OPERATION           13520000
135300            MOVE 'TBUSLOC'      TO AA-DB2-TABLE-1                 13530000
135400            MOVE SPACES         TO AA-DB2-TABLE-2                 13540000
135500            PERFORM 9999-DB2-ABEND                                13550000
135600     END-EVALUATE.                                                13560000
135700                                                                  13570000
135800******************************************************************13580000
135900*    OPENS THE VENDOR UPD CURSOR #1                              *13590000
136000******************************************************************13600000
136100 7100-OPEN-VNDTAU-UPD-CSR1.                                       13610000
136200                                                                  13620000
136300     EXEC SQL                                                     13630000
136400        OPEN VNDTAU_UPD_CSR1                                      13640000
136500     END-EXEC.                                                    13650000
136600                                                                  13660000
136700     EVALUATE TRUE                                                13670000
136800        WHEN SQLCODE = ZERO                                       13680000
136900            CONTINUE                                              13690000
137000        WHEN SQLWARN0 NOT = SPACES                                13700000
137100        WHEN SQLCODE  NOT = ZERO                                  13710000
137200          MOVE '7100-OPEN-VNDTAU-UPD-CSR1'                        13720000
137300                              TO AA-PARAGRAPH-NAME                13730000
137400          MOVE 'UNSUCCESSFUL OPEN ON VNDTAU UPD CSR1'             13740000
137500                              TO AA-DB2-OPERATION                 13750000
137600          MOVE 'TVNDTAU'      TO AA-DB2-TABLE-1                   13760000
137700          MOVE SPACES         TO AA-DB2-TABLE-2                   13770000
137800                                 AA-DB2-TABLE-3                   13780000
137900          PERFORM 9999-DB2-ABEND                                  13790000
138000     END-EVALUATE.                                                13800000
138100                                                                  13810000
138200******************************************************************13820000
138300*    CLOSES THE VENDOR ADD CURSOR.                               *13830000
138400******************************************************************13840000
138500 7200-CLOSE-VNDTAU-UPD-CSR1.                                      13850000
138600                                                                  13860000
138700     EXEC SQL                                                     13870000
138800        CLOSE VNDTAU_UPD_CSR1                                     13880000
138900     END-EXEC.                                                    13890000
139000                                                                  13900000
139100     EVALUATE TRUE                                                13910000
139200       WHEN SQLCODE = ZERO                                        13920000
139300           CONTINUE                                               13930000
139400       WHEN SQLWARN0 NOT = SPACES                                 13940000
139500       WHEN SQLCODE  NOT = ZERO                                   13950000
139600          MOVE '7200-CLOSE-VNDTAU-UPD-CSR1'                       13960000
139700                             TO AA-PARAGRAPH-NAME                 13970000
139800          MOVE 'UNSUCCESSFUL CLOSE ON VENDOR ADD CSR'             13980000
139900                             TO AA-DB2-OPERATION                  13990000
140000          MOVE 'TVNDTAU'     TO AA-DB2-TABLE-1                    14000000
140100          MOVE SPACES        TO AA-DB2-TABLE-2                    14010000
140200                                AA-DB2-TABLE-3                    14020000
140300          PERFORM 9999-DB2-ABEND                                  14030000
140400     END-EVALUATE.                                                14040000
140500                                                                  14050000
140600 7300-OPEN-VNADAU-UPD-CSR1.                                       14060000
140700                                                                  14070000
140800     EXEC SQL                                                     14080000
140900        OPEN VNADAU_UPD_CSR1                                      14090000
141000     END-EXEC.                                                    14100000
141100                                                                  14110000
141200     EVALUATE TRUE                                                14120000
141300        WHEN SQLCODE = ZERO                                       14130000
141400            CONTINUE                                              14140000
141500        WHEN SQLWARN0 NOT = SPACES                                14150000
141600        WHEN SQLCODE  NOT = ZERO                                  14160000
141700          MOVE '7300-OPEN-VNADAU-UPD-CSR1'                        14170000
141800                              TO AA-PARAGRAPH-NAME                14180000
141900          MOVE 'UNSUCCESSFUL OPEN ON VNADAU UPD CSR1'             14190000
142000                              TO AA-DB2-OPERATION                 14200000
142100          MOVE 'TVNADAU'      TO AA-DB2-TABLE-1                   14210000
142200          MOVE SPACES         TO AA-DB2-TABLE-2                   14220000
142300                                 AA-DB2-TABLE-3                   14230000
142400          PERFORM 9999-DB2-ABEND                                  14240000
142500     END-EVALUATE.                                                14250000
142600                                                                  14260000
142700   EJECT                                                          14270000
142800******************************************************************14280000
142900*    CLOSES THE VENDOR ADDRESS DETAIL UPDATE CURSOR #1           *14290000
143000******************************************************************14300000
143100 7400-CLOSE-VNADAU-UPD-CSR1.                                      14310000
143200                                                                  14320000
143300     EXEC SQL                                                     14330000
143400        CLOSE VNADAU_UPD_CSR1                                     14340000
143500     END-EXEC.                                                    14350000
143600                                                                  14360000
143700     EVALUATE TRUE                                                14370000
143800       WHEN SQLCODE = ZERO                                        14380000
143900           CONTINUE                                               14390000
144000       WHEN SQLWARN0 NOT = SPACES                                 14400000
144100       WHEN SQLCODE  NOT = ZERO                                   14410000
144200          MOVE '7400-CLOSE-VNADAU-UPD-CSR1'                       14420000
144300                             TO AA-PARAGRAPH-NAME                 14430000
144400          MOVE 'UNSUCCESSFUL CLOSE ON VNADAU UPD CSR1'            14440000
144500                             TO AA-DB2-OPERATION                  14450000
144600          MOVE 'TVNADAU'     TO AA-DB2-TABLE-1                    14460000
144700          MOVE SPACES        TO AA-DB2-TABLE-2                    14470000
144800                                AA-DB2-TABLE-3                    14480000
144900          PERFORM 9999-DB2-ABEND                                  14490000
145000     END-EVALUATE.                                                14500000
145100                                                                  14510000
145200 7500-OPEN-VNADAU-UPD-CSR2.                                       14520000
145300                                                                  14530000
145400     EXEC SQL                                                     14540000
145500        OPEN VNADAU_UPD_CSR2                                      14550000
145600     END-EXEC.                                                    14560000
145700                                                                  14570000
145800     EVALUATE TRUE                                                14580000
145900        WHEN SQLCODE = ZERO                                       14590000
146000            CONTINUE                                              14600000
146100        WHEN SQLWARN0 NOT = SPACES                                14610000
146200        WHEN SQLCODE  NOT = ZERO                                  14620000
146300          MOVE '7300-OPEN-VNADAU-UPD-CSR2'                        14630000
146400                              TO AA-PARAGRAPH-NAME                14640000
146500          MOVE 'UNSUCCESSFUL OPEN ON VNADAU UPD CSR2'             14650000
146600                              TO AA-DB2-OPERATION                 14660000
146700          MOVE 'TVNADAU'      TO AA-DB2-TABLE-1                   14670000
146800          MOVE SPACES         TO AA-DB2-TABLE-2                   14680000
146900                                 AA-DB2-TABLE-3                   14690000
147000          PERFORM 9999-DB2-ABEND                                  14700000
147100     END-EVALUATE.                                                14710000
147200                                                                  14720000
147300******************************************************************14730000
147400*    CLOSES THE VENDOR UPDATE CURSOR.                            *14740000
147500******************************************************************14750000
147600 7600-CLOSE-VNADAU-UPD-CSR2.                                      14760000
147700                                                                  14770000
147800     EXEC SQL                                                     14780000
147900        CLOSE VNADAU_UPD_CSR2                                     14790000
148000     END-EXEC.                                                    14800000
148100                                                                  14810000
148200     EVALUATE TRUE                                                14820000
148300       WHEN SQLCODE = ZERO                                        14830000
148400           CONTINUE                                               14840000
148500       WHEN SQLWARN0 NOT = SPACES                                 14850000
148600       WHEN SQLCODE  NOT = ZERO                                   14860000
148700          MOVE '7600-CLOSE-VNADAU-UPD-CSR2'                       14870000
148800                             TO AA-PARAGRAPH-NAME                 14880000
148900          MOVE 'UNSUCCESSFUL CLOSE ON VNADAU UPD CSR2'            14890000
149000                             TO AA-DB2-OPERATION                  14900000
149100          MOVE 'TVNADAU'     TO AA-DB2-TABLE-1                    14910000
149200          MOVE SPACES        TO AA-DB2-TABLE-2                    14920000
149300                                AA-DB2-TABLE-3                    14930000
149400          PERFORM 9999-DB2-ABEND                                  14940000
149500     END-EVALUATE.                                                14950000
149600                                                                  14960000
149700 9000-COMMIT.                                                     14970000
149800     IF PV-UPDATE-COUNT > 50                                      14980000
149900         EXEC SQL                                                 14990000
150000             COMMIT                                               15000000
150100         END-EXEC                                                 15010000
150200         DISPLAY '%%%%%%%%  COMMIT PERFORMED  %%%%%%%%%%'         15020000
150300         MOVE ZEROES TO PV-UPDATE-COUNT                           15030000
150400     END-IF.                                                      15040000
150500                                                                  15050000
150600 9999-DB2-ABEND.                                                  15060000
150700                                                                  15070000
150800     CLOSE  VENDOR-REPORT-FILE.                                   15080000
150900                                                                  15090000
151000     DISPLAY 'VENDOR ENT ID = ' VNADAU-ENT-ID.                    15100000
151100                                                                  15110000
151200     DISPLAY AA-ABEND-LIT.                                        15120000
151300     DISPLAY AA-DB2-ERROR-LIT.                                    15130000
151400     DISPLAY AA-PROGRAM-LIT.                                      15140000
151500     DISPLAY AA-PARAGRAPH-LIT.                                    15150000
151600     DISPLAY AA-DB2-OPERATION-LIT.                                15160000
151700     DISPLAY AA-DB2-TABLE-1.                                      15170000
151800     DISPLAY AA-DB2-TABLE-2.                                      15180000
151900     DISPLAY AA-DB2-TABLE-3.                                      15190000
152000     SET AC-DB2-ERROR TO TRUE.                                    15200000
152100                                                                  15210000
152200     COPY DPPD004.                                                15220000
152300     CALL 'ILBOABN0' USING ABEND-CODE.                            15230000
