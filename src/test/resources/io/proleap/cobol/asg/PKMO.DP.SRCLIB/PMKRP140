000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.             PMKRP140.                                00020000
000300 AUTHOR.                 AMANDA NEWHART.                          00030000
000400 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00040000
000500 DATE-WRITTEN.           SEPTEMBER 2003.                          00050000
000600 DATE-COMPILED.                                                   00060000
000700******************************************************************00070000
000800***** SPECIAL NOTE: CHANGE THE DATES IN THE PROCLIB CONTROL CARD *00080015
000800*****               IF NEEDED.                                   *00081015
000700******************************************************************00082015
000900*    PMKRP140 - LPS EXCEPTION REPORT - PRE                       *00090000
001000*      THIS PROGRAM PRINTS THE LPS EXCEPTION REPORT.  OPEN THE   *00100000
001100*      INPUT FILE AND THE REPORT.  FIND THE CURRENT DATE AND     *00110000
001200*      TIME BY ACCEPTING THE CPU DATE AND TIME.  READ THE FIRST  *00120000
001300*      LINE FROM THE INPUT FILE.  IF THERE IS NOTHING IN THE     *00130000
001400*      FILE THEN DISPLAY A MESSAGE.  OTHERWISE IF THERE IS DATA  *00140000
001500*      THEN CHECK TO SEE IF THE CURRENT DEPT-NBR IS EQUAL TO     *00150000
001600*      THE PREV DPT-NBR.  IF THIS IS NOT EQUAL THEN WRITE A NEW  *00160000
001700*      PAGE AND PROCESS THE HEADER.  NEXT WRITE OUT THE DETAIL   *00170000
001800*      LINE.  IF THE CURRENT DPT IS EQUAL TO THE PREV DPT-NBR    *00180000
001900*      THEN JUST WRITE OUT THE DETAIL LINE.  READ THE NEXT       *00190000
002000*      RECORD IN THE FILE AND CONTINUE THIS PROCESS TILL THE     *00200000
002100*      END OF THE FILE HAS BEEN REACHED.  PRINT OUT A END OF     *00210000
002200*      REPORT LINE AND CLOSE THE INPUT FILE AND REPORT.  THEN    *00220000
002300*      DISPLAY THE NUMBER OF RECORDS WRITTEN.                    *00230000
002400*                                                                *00240000
002500******************************************************************00250000
002600*    CHANGE LOG:                                                 *00260000
002700*    09/29/2003 - MARTIN BRADLEY - WR25600                       *00270000
002800*     - CHANGED THE LENGTH OF THE INPUT FILE.                    *00280000
002900*                                                                *00290000
003000*    09/30/2003 - AMADNA NEWHART - WR25600                       *00300000
003100*     - ADDED A BLANK PAGE IF THE BUYER ON THE BACK SIDE IS NOT  *00310000
003200*       EQUAL TO THE BUYER ON THE FRONT SIDE.                    *00320000
003300*                                                                *00330000
003400*    10/01/2003 - AMADNA NEWHART - WR25600                       *00340000
003500*     - NEED TO ADD THE DMM, GMM, BUYER AND DPT HEADER TO THE    *00350000
003600*       BLANK PAGE AS WELL.  NEEDED BECAUSE OF SORT IN RDS.      *00360000
003700*                                                                *00370000
003800*    11/01/2004 - COLLEEN CUMMINGS - WR25600                     *00380000
003900*     - CHANGED PC-ANAL-BEG-DTE = '11/01/2004'.                  *00390000
004000*     - CHANGED PC-ANAL-END-DTE = '12/11/2004'.                  *00400000
004100*     FOR NEXT RUN OF LPS SEASON.                                *00410000
004200*                                                                *00420000
004300*    01/20/2005 - COLLEEN CUMMINGS - WR28178                     *00430000
004400*     - CHANGED PC-ANAL-BEG-DTE = '01/30/2005'.                  *00440000
004500*     - CHANGED PC-ANAL-END-DTE = '05/07/2005'.                  *00450000
004600*     FOR NEXT RUN OF LPS SEASON.                                *00460000
004700*     ADDED FOOTER (COMMENT-LINE) ON BOTTOM OF REPORT.           *00470000
004800*     MOVED NON-LPS PRICE NEXT TO LPS PRICE.                     *00480000
004900*                                                                *00490000
005000*    01/20/2005 - COLLEEN CUMMINGS - WR28178                     *00500000
005100*     ADDITIONAL CHANGES TO END WITH THE LPS EVENT:              *00510000
005200*     - CHANGED PC-ANAL-END-DTE = '04/30/2005'.                  *00520000
005300*     ADDED VERBAGE TO PRICE COLUMNS TO DIFFERENTIATE BETWEEN    *00530000
005400*     "STD" (SEASON TO DATE) AND "LPS" PRICE.                    *00540000
005410*                                                                *00550000
005420*    05/04/2005 - TOM BOYD  P000760046                           *00560000
005430*     ADDITIONAL CHANGES TO END WITH THE LPS EVENT:              *00570000
005440*     - CHANGED PC-ANAL-BEG-DTE = '05/08/2005'.                  *00580000
005450*     - CHANGED PC-ANAL-END-DTE = '07/17/2005'.                  *00590000
005410*                                                                *00600000
005420*    07/26/2005 - TOM BOYD  P000784190                            00610000
005430*     ADDITIONAL CHANGES TO END WITH THE LPS EVENT:              *00620000
005440*     - CHANGED PC-ANAL-BEG-DTE = '07/31/2005'.                  *00630000
005450*     - CHANGED PC-ANAL-END-DTE = '10/31/2005'.                  *00640000
005410*                                                                *00650000
005420*    09/15/2005 - COLLEEN CUMMINGS WR29445                        00660000
005430*     CHANGE FOOTER TEXT PER KATHLYN BELANGER.                   *00670000
005410*                                                                *00680000
005420*    10/31/2005 - ERIC ZUNKE WR29647                              00690000
005430*     ADDITIONAL CHANGES TO END WITH THE LPS EVENT:              *00700000
005440*     - CHANGED PC-ANAL-BEG-DTE = '11/01/2005'.                  *00710000
005450*     - CHANGED PC-ANAL-END-DTE = '12/17/2005'.                  *00720000
005410*                                                                *00730000
      *    11/17/2005 - ERIC ZUNKE WR29647                             *00740000
      *     CHANGED TEXT ON THE REPORT BOTTOM TO CLEARLY               *00750000
      *     STATE ALL LPS NIGHT OWL PRICING MUST BE LOWER              *00760000
      *     THAN ALL PRICING DURING THE LPS SEASON                     *00770000
      *                                                                *00780000
      *    01/20/2006 - ERIC ZUNKE WR29979                             *00790000
      *     - CHANGED PC-ANAL-BEG-DTE = '01/29/2006'.                  *00800000
      *     - CHANGED PC-ANAL-END-DTE = '04/29/2006'.                  *00810000
      *     CHANGED TEXT ON THE REPORT BOTTOM ACCORDING TO             *00820000
      *     WORK REQUEST REQUIREMENT. (INCLUDING MAP ITEMS)            *00830000
      *                                                                *00840000
      *    02/21/2006 - ERIC ZUNKE WR29979                             *00850001
      *     CHANGED TEXT ON THE REPORT BOTTOM ACCORDING TO             *00860001
      *     KATHLYN'S REQUEST.                                         *00870001
      *                                                                *00880001
      *    05/08/2006 - ERIC ZUNKE WR30721                             *00890002
      *     - CHANGED PC-ANAL-BEG-DTE = '05/14/2006'.                  *00900002
      *     - CHANGED PC-ANAL-END-DTE = '07/16/2006'.                  *00910002
      *                                                                *00920002
      *    09/21/2006 - ERIC ZUNKE WR31071                             *00930005
      *     - CHANGED PC-ANAL-END-DTE = '10/30/2006'.                  *00940005
      *                                                                *00950005
      *    10/24/2006 - LIHUA LIANG WR31503                            *00960007
      *     - CHANGED PC-ANAL-BEG-DTE = '11/01/2006'.                  *00970007
      *     - CHANGED PC-ANAL-END-DTE = '12/17/2006'.                  *00980007
      *                                                                *00990007
      *    01/29/2007 - AMANDA JEFFORDA WR31947                        *00991008
      *     - CHANGED PC-ANAL-BEG-DTE = '02/04/2007'.                  *00992008
      *     - CHANGED PC-ANAL-END-DTE = '04/25/2007'.                  *00993008
      *                                                                *00994008
      *    05/22/2007 - DAVID FELLENZ  WR32904                         *00995010
      *     - CHANGED PC-ANAL-BEG-DTE = '05/14/2007'.                  *00996010
      *     - CHANGED PC-ANAL-END-DTE = '07/11/2007'.                  *00997010
      *                                                                *00998010
DF2507*    07/25/2007 - DAVID FELLENZ  WR33193                         *00999013
      *     - CHANGED PC-ANAL-BEG-DTE = '08/05/2007'.                  *00999111
      *     - CHANGED PC-ANAL-END-DTE = '10/16/2007'.                  *00999211
      *                                                                *00999311
W33193*    08/03/2007 - DAVID FELLENZ  WR33193                         *00999416
      *     CREATED A CONTROL CARD TO HANDLE THE DATE CHANGE SO        *00999516
      *      PROGRAM EDITING IS NO LONGER NEEDED.                      *00999616
      *                                                                *00999716
567913*    10/29/2008 - DARYL STEWART  INC000000567913                 *00999823
      *     - MODIFIED WORDING ON THE NOTE THAT APPEARS AT THE BOTTOM  *00999923
      *     - OF THE REPORT.                                           *01000023
      *                                                                *01000123
005500******************************************************************01001023
005600 ENVIRONMENT DIVISION.                                            01010000
005700 CONFIGURATION SECTION.                                           01020000
005800 SOURCE-COMPUTER. IBM-3090.                                       01030000
005900 OBJECT-COMPUTER. IBM-3090.                                       01040000
006000                                                                  01050000
006100 INPUT-OUTPUT SECTION.                                            01060000
006200 FILE-CONTROL.                                                    01070000
006300                                                                  01080000
006400     SELECT PRE-LPS-EXCP-FILE                                     01090000
006500         ASSIGN                       TO INP01.                   01100000
006600                                                                  01110000
W33193     SELECT CONTROL-CARD-FILE                                     01111016
W33193         ASSIGN                       TO INP02.                   01112017
006600                                                                  01113014
006700     SELECT PRE-LPS-EXCP-REPORT                                   01120000
006800         ASSIGN                       TO RPT01.                   01130000
006900                                                                  01140000
007000 DATA DIVISION.                                                   01150000
007100                                                                  01160000
007200 FILE SECTION.                                                    01170000
007300                                                                  01180000
007400 FD  PRE-LPS-EXCP-FILE                                            01190000
007500     RECORDING MODE F                                             01200000
007600     BLOCK CONTAINS 0 RECORDS                                     01210000
007700     LABEL RECORDS ARE OMITTED.                                   01220000
007800 01  PRE-LPS-EXCP-FILE-RECORD         PIC X(350).                 01230000
                                                                        01240014
W33193 FD  CONTROL-CARD-FILE                                            01241016
W33193     RECORDING MODE F                                             01242017
W33193     BLOCK CONTAINS 0 RECORDS                                     01243016
W33193     LABEL RECORDS ARE OMITTED                                    01244017
W33193     DATA RECORD IS CONTROL-CARD-RECORD.                          01245016
W33193 01  CONTROL-CARD-RECORD              PIC X(80).                  01246017
                                                                        01247014
008000 FD  PRE-LPS-EXCP-REPORT                                          01250000
008100     RECORDING MODE F                                             01260000
008200     BLOCK CONTAINS 0 RECORDS                                     01270000
008300     LABEL RECORDS ARE OMITTED.                                   01280000
008400 01  PRE-LPS-EXCP-LINE                PIC X(250).                 01290000
008500                                                                  01300000
008600 WORKING-STORAGE SECTION.                                         01310000
008700                                                                  01320000
008800 01  ABEND-CODE                       PIC S9(04)   COMP VALUE +0. 01330000
008900     88  ABEND-4001-WRITE-ERROR                    VALUE +4001.   01340000
009000     88  ABEND-4002-READ-ERROR                     VALUE +4002.   01350000
009100     88  ABEND-4003-CTRL-CARD-ERROR                VALUE +4003.   01360000
009200     88  ABEND-4004-TABLE-ERROR                    VALUE +4004.   01370000
009300     88  ABEND-4005-OPEN-ERROR                     VALUE +4005.   01380000
009400     88  ABEND-4006-CLOSE-ERROR                    VALUE +4006.   01390000
009500     88  ABEND-4007-SEQUENCE-ERROR                 VALUE +4007.   01400000
009600     88  ABEND-4008-DATA-ERROR                     VALUE +4008.   01410000
009700     88  ABEND-4009-KEY-DATA-ERROR                 VALUE +4009.   01420000
009800     88  ABEND-4013-DB2-ERROR                      VALUE +4013.   01430000
009900     88  ABEND-4019-DATE-ROUTINE-ERROR             VALUE +4019.   01440000
010000     88  ABEND-4444-FORCED-ABEND                   VALUE +4444.   01450000
010100                                                                  01460000
010200*01  COMMENT-LINE1.                                               01470000
010300*    05  FILLER                       PIC X(01)      VALUE SPACES.01480000
010400*    05  FILLER                       PIC X(44)      VALUE        01490000
010500*        '** ADVERTISED LPS PRICING MUST BE LOWER THAN'.          01500000
010600*    05  FILLER                       PIC X(40)      VALUE        01510000
010700*        ' ANY PREVIOUS MAIN OR NON-MAIN PROMOTION'.              01520000
010800*    05  FILLER                       PIC X(36)      VALUE        01530000
010900*        ' PRICING STARTING WITH THE BEGINNING'.                  01540000
011000*    05  FILLER                       PIC X(45)      VALUE        01550000
011100*        ' OF THE CURRENT LPS SEASON THROUGH THE END OF'.         01560000
011200*    05  FILLER                       PIC X(44)      VALUE        01570000
011300*        ' THE LPS EVENT. **                          '.          01580000
011600*    05  FILLER                       PIC X(31)      VALUE SPACES.01590000
011700                                                                  01600000
010200 01  COMMENT-LINE1.                                               01610000
010300     05  FILLER                       PIC X(01)      VALUE SPACES.01620000
010400     05  FILLER                       PIC X(48)      VALUE        01630000
010500         '** ADVERTISED LPS PRICING MUST BE LOWER THAN ANY'.      01640000
010600     05  FILLER                       PIC X(52)      VALUE        01650000
010700         ' PREVIOUS MAIN OR NON-MAIN PRICING STARTING WITH THE'.  01660000
010800     05  FILLER                       PIC X(39)      VALUE        01670000
010900         ' BEGINING OF THE LPS SEASON THROUGH THE'.               01680000
010800     05  FILLER                       PIC X(22)      VALUE        01690000
010900         ' END OF THE LPS EVENT.'.                                01700000
012000     05  FILLER                       PIC X(48)      VALUE        01710001
012100         ' PRICING IN PARTIAL DAY PROMOTIONS SUCH AS EARLY'.      01720001
012600     05  FILLER                       PIC X(31)      VALUE SPACES.01730001
012700                                                                  01740000
011800*01  COMMENT-LINE2.                                               01750000
011900*    05  FILLER                       PIC X(01)      VALUE SPACES.01760000
012000*    05  FILLER                       PIC X(44)      VALUE        01770000
012100*        '** PRICING IN PARTIAL DAY PROMOTIONS SUCH AS'.          01780000
012200*    05  FILLER                       PIC X(40)      VALUE        01790000
012300*        ' EARLY BIRDS/NIGHT OWLS ARE NOT INTERROG'.              01800000
012400*    05  FILLER                       PIC X(39)      VALUE        01810000
012500*        'ATED FOR COMPARISONS TO LPS PRICING. **'.               01820000
012600*    05  FILLER                       PIC X(117)     VALUE SPACES.01830000
012700                                                                  01840000
011800 01  COMMENT-LINE2.                                               01850000
011900     05  FILLER                       PIC X(01)      VALUE SPACES.01860000
012000     05  FILLER                       PIC X(42)      VALUE        01870000
012100         ' BIRDS/NIGHT OWLS ARE NOT INTERROGATED FOR'.            01880000
012000     05  FILLER                       PIC X(27)      VALUE        01890000
012100         ' COMPARISON TO LPS PRICING.'.                           01900000
012000     05  FILLER                       PIC X(48)      VALUE        01910000
012100         '** MAP ITEMS MUST FOLLOW THE ABOVE PRICING RULES'.      01920001
012200     05  FILLER                       PIC X(51)      VALUE        01930001
012300         ' OR OFFER A HIGER VALUE GWP THAN PREVIOUSLY OFFERED'.   01940001
012200     05  FILLER                       PIC X(51)      VALUE        01950001
012300         ' DURING CURRENT LPS SEASON TO MAINTAING MAP PRICING'.   01960001
012600     05  FILLER                       PIC X(21)      VALUE SPACES.01970001
012700                                                                  01980000
567913 01  COMMENT-LINE2B.                                              01981023
567913     05  FILLER                       PIC X(01)      VALUE SPACES.01982023
567913     05  FILLER                       PIC X(38)      VALUE        01983023
567913         ' BIRDS/NIGHT OWLS ARE INTERROGATED FOR'.                01984023
567913     05  FILLER                       PIC X(27)      VALUE        01985023
567913         ' COMPARISON TO LPS PRICING.'.                           01986023
567913     05  FILLER                       PIC X(48)      VALUE        01987023
567913         '** MAP ITEMS MUST FOLLOW THE ABOVE PRICING RULES'.      01988023
567913     05  FILLER                       PIC X(51)      VALUE        01989023
567913         ' OR OFFER A HIGER VALUE GWP THAN PREVIOUSLY OFFERED'.   01989123
567913     05  FILLER                       PIC X(51)      VALUE        01989223
567913         ' DURING CURRENT LPS SEASON TO MAINTAING MAP PRICING'.   01989323
567913     05  FILLER                       PIC X(25)      VALUE SPACES.01989423
567913                                                                  01989523
012800 01  END-OF-REPORT-LINE.                                          01990000
012900     05  FILLER                       PIC X(115)     VALUE SPACES.02000000
013000     05  FILLER                       PIC X(20)      VALUE        02010000
013100         ' ** END OF REPORT **'.                                  02020000
013200     05  FILLER                       PIC X(115)     VALUE SPACES.02030000
013300                                                                  02040000
013400 01  BLANK-PAGE-LINE.                                             02050000
013500     05  FILLER                       PIC X(55)      VALUE SPACES.02060000
013600     05  HDR-01-TITLE                 PIC X(39)      VALUE        02070000
013700         '*****PAGE INTENTIONALLY LEFT BLANK*****'.               02080000
013800     05  FILLER                       PIC X(56)      VALUE SPACES.02090000
013900                                                                  02100000
014000 01  HEADER-01.                                                   02110000
014100     05  FILLER                       PIC X(115)     VALUE SPACES.02120000
014200     05  HDR-01-TITLE                 PIC X(20)      VALUE        02130000
014300         'LPS EXCEPTION REPORT'.                                  02140000
014400     05  FILLER                       PIC X(115)     VALUE SPACES.02150000
014500                                                                  02160000
014600 01  HEADER-02.                                                   02170000
014700     05  FILLER                       PIC X(106)     VALUE SPACES.02180000
014800     05  HDR-02-TITLE                 PIC X(15)      VALUE        02190000
014900         'DATES ANALYZED:'.                                       02200000
015000     05  FILLER                       PIC X(01)      VALUE SPACES.02210000
015100     05  HDR-02-ANAL-BEG-DTE          PIC X(10)      VALUE SPACES.02220000
015200     05  FILLER                       PIC X(01)      VALUE SPACES.02230000
015300     05  FILLER                       PIC X(01)      VALUE '-'.   02240000
015400     05  FILLER                       PIC X(01)      VALUE SPACES.02250000
015500     05  HDR-02-ANAL-END-DTE          PIC X(10)      VALUE SPACES.02260000
015600     05  FILLER                       PIC X(105)     VALUE SPACES.02270000
015700                                                                  02280000
015800 01  HEADER-03.                                                   02290000
015900     05  FILLER                       PIC X(09)      VALUE        02300000
016000         ' GMM:    '.                                             02310000
016100     05  FILLER                       PIC X(01)      VALUE SPACES.02320000
016200     05  HDR-03-GMM-NBR               PIC X(02).                  02330000
016300     05  FILLER                       PIC X(01)      VALUE SPACES.02340000
016400     05  HDR-03-GMM-NAME              PIC X(36).                  02350000
016500     05  FILLER                       PIC X(201)     VALUE SPACES.02360000
016600                                                                  02370000
016700 01  HEADER-04.                                                   02380000
016800     05  FILLER                       PIC X(09)      VALUE        02390000
016900         ' DMM:    '.                                             02400000
017000     05  FILLER                       PIC X(01)      VALUE SPACES.02410000
017100     05  HDR-04-DMM-NBR               PIC X(02).                  02420000
017200     05  FILLER                       PIC X(01)      VALUE SPACES.02430000
017300     05  HDR-04-DMM-NAME              PIC X(36).                  02440000
017400     05  FILLER                       PIC X(201)     VALUE SPACES.02450000
017500                                                                  02460000
017600 01  HEADER-05.                                                   02470000
017700     05  FILLER                       PIC X(09)      VALUE        02480000
017800         ' BUYER:  '.                                             02490000
017900     05  HDR-05-BUYER-NBR             PIC X(03).                  02500000
018000     05  FILLER                       PIC X(01)      VALUE SPACES.02510000
018100     05  HDR-05-BUYER-NAME            PIC X(36).                  02520000
018200     05  FILLER                       PIC X(201)     VALUE SPACES.02530000
018300                                                                  02540000
018400 01  HEADER-06.                                                   02550000
018500     05  FILLER                       PIC X(09)      VALUE        02560000
018600         ' DEPT:   '.                                             02570000
018700     05  HDR-06-DEPT-NBR              PIC X(03).                  02580000
018800     05  FILLER                       PIC X(01)      VALUE SPACES.02590000
018900     05  HDR-06-DEPT-DESC             PIC X(36).                  02600000
019000     05  FILLER                       PIC X(201)     VALUE SPACES.02610000
019100                                                                  02620000
019200 01  HEADER-07.                                                   02630000
019300     05  HDR-07-DASHED-LINE-01        PIC X(55)     VALUE         02640000
019400        ' ------------------------------------------------------'.02650000
019500     05  HDR-07-LPS-EVENT-LINE        PIC X(54)      VALUE        02660000
019600         '----------------------LOWEST PRICE--------------------'.02670000
019700     05  HDR-07-DASHED-LINE-02        PIC X(54)     VALUE         02680000
019800         '------------------------------------------------------'.02690000
019900     05  HDR-07-DASHED-LINE-03        PIC X(11)     VALUE         02700000
020000         '-----------'.                                           02710000
020100     05  FILLER                       PIC X(03)     VALUE SPACES. 02720000
020200     05  HDR-07-LPS-PRICE-LINE        PIC X(55)     VALUE         02730000
020300        '---------------------------------LPS PRICE-------------'.02740000
020400     05  HDR-07-DASHED-LINE-04        PIC X(18)     VALUE         02750000
020500         '------------------'.                                    02760000
020600                                                                  02770000
020700 01  HEADER-07B.                                                  02780000
020800     05  FILLER                       PIC X(159)    VALUE SPACES. 02790000
020900     05  HDR-07B-STD-PRICE            PIC X(03)     VALUE 'STD'.  02800000
021000     05  FILLER                       PIC X(15)     VALUE SPACES. 02810000
021100     05  HDR-07B-LPS-PRICE            PIC X(03)     VALUE 'LPS'.  02820000
021200     05  FILLER                       PIC X(20)     VALUE SPACES. 02830000
021300                                                                  02840000
021400 01  HEADER-08.                                                   02850000
021500     05  FILLER                       PIC X(03)     VALUE SPACES. 02860000
021600     05  FILLER                       PIC X(04)     VALUE         02870000
021700         'SBCL'.                                                  02880000
021800     05  FILLER                       PIC X(01)     VALUE SPACES. 02890000
021900     05  FILLER                       PIC X(05)     VALUE         02900000
022000         'STYLE'.                                                 02910000
022100     05  FILLER                       PIC X(16)     VALUE SPACES. 02920000
022200     05  FILLER                       PIC X(11)     VALUE         02930000
022300         'DESCRIPTION'.                                           02940000
022400     05  FILLER                       PIC X(20)      VALUE SPACES.02950000
022500     05  FILLER                       PIC X(08)      VALUE        02960000
022600         'AD EVENT'.                                              02970000
022700     05  FILLER                       PIC X(33)      VALUE SPACES.02980000
022800     05  FILLER                       PIC X(09)      VALUE        02990000
022900         'PROMOTION'.                                             03000000
023000     05  FILLER                       PIC X(16)      VALUE SPACES.03010000
023100     05  FILLER                       PIC X(10)      VALUE        03020000
023200         'PROMO ITEM'.                                            03030000
023300     05  FILLER                       PIC X(23)      VALUE SPACES.03040000
023400     05  FILLER                       PIC X(05)      VALUE        03050000
023500         'PRICE'.                                                 03060000
023600     05  FILLER                       PIC X(13)      VALUE SPACES.03070000
023700     05  FILLER                       PIC X(05)      VALUE        03080000
023800         'PRICE'.                                                 03090000
023900     05  FILLER                       PIC X(13)      VALUE SPACES.03100000
024000     05  FILLER                       PIC X(09)      VALUE        03110000
024100         'PROMOTION'.                                             03120000
024200     05  FILLER                       PIC X(16)      VALUE SPACES.03130000
024300     05  FILLER                       PIC X(10)      VALUE        03140000
024400         'PROMO ITEM'.                                            03150000
024500     05  FILLER                       PIC X(20)      VALUE SPACES.03160000
024600                                                                  03170000
024700 01  HEADER-UNDERLINE1.                                           03180000
024800     05  FILLER                       PIC X(01)      VALUE SPACES.03190000
024900     05  FILLER                       PIC X(01)      VALUE        03200000
025000         '_'.                                                     03210000
025100     05  FILLER                       PIC X(01)      VALUE SPACES.03220000
025200     05  FILLER                       PIC X(04)      VALUE        03230000
025300         '____'.                                                  03240000
025400     05  FILLER                       PIC X(01)      VALUE SPACES.03250000
025500     05  FILLER                       PIC X(20)      VALUE        03260000
025600         '____________________'.                                  03270000
025700     05  FILLER                       PIC X(01)      VALUE SPACES.03280000
025800     05  FILLER                       PIC X(30)      VALUE        03290000
025900         '______________________________'.                        03300000
026000     05  FILLER                       PIC X(01)      VALUE SPACES.03310000
026100     05  FILLER                       PIC X(40)      VALUE        03320000
026200         '________________________________________'.              03330000
026300     05  FILLER                       PIC X(01)      VALUE SPACES.03340000
026400     05  FILLER                       PIC X(24)      VALUE        03350000
026500         '________________________'.                              03360000
026600     05  FILLER                       PIC X(01)      VALUE SPACES.03370000
026700     05  FILLER                       PIC X(30)      VALUE        03380000
026800         '______________________________'.                        03390000
026900     05  FILLER                       PIC X(03)      VALUE SPACES.03400000
027000     05  FILLER                       PIC X(16)      VALUE        03410000
027100         '________________'.                                      03420000
027200     05  FILLER                       PIC X(02)      VALUE SPACES.03430000
027300     05  FILLER                       PIC X(16)      VALUE        03440000
027400         '________________'.                                      03450000
027500     05  FILLER                       PIC X(02)      VALUE SPACES.03460000
027600     05  FILLER                       PIC X(24)      VALUE        03470000
027700         '________________________'.                              03480000
027800     05  FILLER                       PIC X(01)      VALUE SPACES.03490000
027900     05  FILLER                       PIC X(30)      VALUE        03500000
028000         '______________________________'.                        03510000
028100                                                                  03520000
028200 01  DETAIL-01.                                                   03530000
028300     05  FILLER                       PIC X(01)      VALUE SPACES.03540000
028400     05  DTL-01-RPT-IND               PIC X(01)      VALUE SPACES.03550000
028500     05  FILLER                       PIC X(01)      VALUE SPACES.03560000
028600     05  DTL-01-SCL-NBR               PIC X(04)      VALUE SPACES.03570000
028700     05  FILLER                       PIC X(01)      VALUE SPACES.03580000
028800     05  DTL-01-STYLE-NBR             PIC X(20)      VALUE SPACES.03590000
028900     05  FILLER                       PIC X(01)      VALUE SPACES.03600000
029000     05  DTL-01-STYL-DESC             PIC X(30)      VALUE SPACES.03610000
029100     05  FILLER                       PIC X(01)      VALUE SPACES.03620000
029200     05  DTL-01-AD-EVENT              PIC X(40)      VALUE SPACES.03630000
029300     05  FILLER                       PIC X(01)      VALUE SPACES.03640000
029400     05  DTL-01-PROMO                 PIC X(24)      VALUE SPACES.03650000
029500     05  FILLER                       PIC X(01)      VALUE SPACES.03660000
029600     05  DTL-01-LOWEST-AD-ITM         PIC X(30)      VALUE SPACES.03670000
029700     05  FILLER                       PIC X(03)      VALUE SPACES.03680000
029800     05  DTL-01-LOWEST-PRICE          PIC Z,ZZZ,ZZZ,ZZ9.99.       03690000
029900     05  FILLER                       PIC X(02)      VALUE SPACES.03700000
030000     05  DTL-01-LPS-PRICE             PIC Z,ZZZ,ZZZ,ZZ9.99.       03710000
030100     05  FILLER                       PIC X(02)      VALUE SPACES.03720000
030200     05  DTL-01-LPS-PROMO             PIC X(24)      VALUE SPACES.03730000
030300     05  FILLER                       PIC X(01)      VALUE SPACES.03740000
030400     05  DTL-01-LP-AD-ITM             PIC X(30)      VALUE SPACES.03750000
030500                                                                  03760000
030600 01  DETAIL-02.                                                   03770000
030700     05  FILLER                       PIC X(109)     VALUE SPACES.03780000
030800     05  FILLER                       PIC X(31)      VALUE        03790000
030900         '* * *  NO DATA TO REPORT  * * *'.                       03800000
031000     05  FILLER                       PIC X(110)     VALUE SPACES.03810000
031100                                                                  03820000
031200 01  PC-PROGRAM-CONSTANTS.                                        03830000
031300     05  PC-CURRENT-PROGRAM-NAME      PIC  X(08)     VALUE        03840000
031400                                                      'PMKRP140'. 03850000
031500     05  PC-SPACE                     PIC  X(01)     VALUE SPACES.03860000
031600     05  PC-MAX-LINE-CNT              PIC S9(04)     COMP         03870000
031700                                                      VALUE +75.  03880000
W33193*    05  PC-ANAL-BEG-DTE              PIC  X(10)     VALUE        03890016
W33193*                                                    '08/05/2007'.03900017
W33193*    05  PC-ANAL-END-DTE              PIC  X(10)     VALUE        03910016
W33193*                                                    '10/16/2007'.03920017
032200                                                                  03930000
032300 01  PS-PROGRAM-SWITCHES.                                         03940000
032400     05  PS-EOF-SLS-DMA-RSLTS-SW      PIC  X(01)     VALUE 'Y'.   03950000
032500         88  PS-EOF-LPS-EXCP-FILE                    VALUE 'N'.   03960000
032600         88  PS-NOT-EOF-LPS-EXCP-FILE                VALUE 'Y'.   03970000
032700                                                                  03980000
032800 01  PA-PROGRAM-ACCUMULATORS.                                     03990000
032900     05  PA-RECORDS-WRITTEN            PIC S9(11) COMP-3 VALUE 0. 04000000
033000                                                                  04010000
033100 01  PV-PROGRAM-VARIABLES.                                        04020000
033200     05  PV-ADVANCE-LINES             PIC S9(04)    COMP VALUE +1.04030000
033300     05  PV-RPT-LINE                  PIC X(250)     VALUE SPACES.04040000
033400     05  PV-HOLD-LINE                 PIC X(250)     VALUE SPACES.04050000
033500     05  PV-LINE-CNT                  PIC S9(04)    COMP VALUE +0.04060000
033600     05  PV-PAGE-CNT                  PIC  9(05)     VALUE ZERO.  04070000
033700     05  PV-PARAGRAPH-NAME            PIC  X(30)     VALUE SPACES.04080000
033800     05  PV-OPERATION-MSG-1           PIC  X(40)     VALUE SPACES.04090000
033900     05  PV-OPERATION-MSG-2           PIC  X(40)     VALUE SPACES.04100000
034000     05  PV-DPT-NBR                   PIC  X(03)     VALUE SPACES.04110000
034100     05  PV-PREV-DPT-NBR              PIC  X(03)     VALUE SPACES.04120000
034200     05  PV-BUYER-NBR                 PIC  X(03)     VALUE SPACES.04130000
034300     05  PV-PREV-BUYER-NBR            PIC  X(03)     VALUE SPACES.04140000
034400     05  PV-PAGE-REM                  PIC S9(03)     VALUE +0.    04150000
034500     05  PV-PAGE-DIV                  PIC S9(05)     VALUE +0.    04160000
034600                                                                  04170000
034700 01  CD-CONTROL-DATES.                                            04180000
034800     05  CD-CPU-DATE.                                             04190000
034900         10  CD-CPU-YR                PIC 9(02)  VALUE ZEROES.    04200000
035000         10  CD-CPU-MO                PIC 9(02)  VALUE ZEROES.    04210000
035100         10  CD-CPU-DY                PIC 9(02)  VALUE ZEROES.    04220000
035200                                                                  04230000
035300     05  CD-CPU-DATE-GREG.                                        04240000
035400         10  CD-CPU-MM                PIC 9(02)  VALUE ZEROES.    04250000
035500         10  CD-CPU-DD                PIC 9(02)  VALUE ZEROES.    04260000
035600         10  CD-CPU-YY                PIC 9(02)  VALUE ZEROES.    04270000
035700                                                                  04280000
035800     05  CD-CPU-DATE-ISO              PIC X(10)  VALUE SPACES.    04290000
035900                                                                  04300000
036000 01  CT-CONTROL-TIMES.                                            04310000
036100     05  CT-CPU-TIME.                                             04320000
036200         10  CT-CPU-HR                PIC 9(02)  VALUE ZEROES.    04330000
036300         10  CT-CPU-MIN               PIC 9(02)  VALUE ZEROES.    04340000
036400         10  CT-CPU-SEC               PIC 9(02)  VALUE ZEROES.    04350000
036500         10  CT-CPU-HSEC              PIC 9(02)  VALUE ZEROES.    04360000
036600                                                                  04370000
W33193*----------------------------------------------------------       04371016
W33193* CC- CONTROL CARD                                                04372017
W33193*----------------------------------------------------------       04373016
W33193 01  CC-CONTROL-CARD-REC.                                         04374017
W33193     05  CC-ANAL-BEG-DTE                PIC X(10) VALUE SPACES.   04374116
W33193     05  FILLER                         PIC X(01) VALUE SPACES.   04376016
W33193     05  CC-ANAL-END-DTE                PIC X(10) VALUE SPACES.   04377017
                                                                        04379214
036700******************************************************************04380000
036800*    LPS PRE EXCEPT OUTPUT RECORD                                 04390000
036900******************************************************************04400000
037000     COPY PMRD044.                                                04410000
037100                                                                  04420000
037200***************************************************************** 04430000
037300*  DATE VALIDATION CALLING PARAMETER LIST                         04440000
037400***************************************************************** 04450000
037500     COPY DPWS500.                                                04460000
037600                                                                  04470000
037700***************************************************************** 04480000
037800*  STANDARD HEADER LINE - KOHLS 250 COL                           04490000
037900***************************************************************** 04500000
038000     COPY DPWS250O.                                               04510000
038100                                                                  04520000
038200********************                                              04530000
038300 EJECT                                                            04540000
038400********************                                              04550000
038500 PROCEDURE DIVISION.                                              04560000
038600********************                                              04570000
038700***************************************************************** 04580000
038800*        MAINLINE ROUTINE                                       * 04590000
038900***************************************************************** 04600000
039000 A100-MAINLINE.                                                   04610000
039100                                                                  04620000
039200     PERFORM B100-OPEN-FILES.                                     04630000
039300     PERFORM B150-CURRENT-DATE.                                   04640000
039400                                                                  04650000
W33193     READ CONTROL-CARD-FILE INTO CC-CONTROL-CARD-REC.             04651016
039400                                                                  04652014
W33193*    MOVE PC-ANAL-BEG-DTE TO HDR-02-ANAL-BEG-DTE.                 04660016
W33193*    MOVE PC-ANAL-END-DTE TO HDR-02-ANAL-END-DTE.                 04670017
W33193     MOVE CC-ANAL-BEG-DTE TO HDR-02-ANAL-BEG-DTE.                 04671016
W33193     MOVE CC-ANAL-END-DTE TO HDR-02-ANAL-END-DTE.                 04672017
039700                                                                  04680000
039800     MOVE SPACES TO PV-DPT-NBR.                                   04690000
039900     MOVE SPACES TO PV-BUYER-NBR.                                 04700000
040000     PERFORM D100-READ-FILE.                                      04710000
040100                                                                  04720000
040200     IF PS-EOF-LPS-EXCP-FILE                                      04730000
040300         DISPLAY 'NO LPS PRE EXCEPTIONS TO REPORT.'               04740000
040400     ELSE                                                         04750000
040500         PERFORM D200-PROCESS-FILE                                04760000
040600             UNTIL PS-EOF-LPS-EXCP-FILE                           04770000
040700         PERFORM W500-WRITE-COMMENT-LINE                          04780000
040800         MOVE END-OF-REPORT-LINE    TO PV-RPT-LINE                04790000
040900         MOVE 2                     TO PV-ADVANCE-LINES           04800000
041000         ADD PV-ADVANCE-LINES       TO PV-LINE-CNT                04810000
041100         PERFORM W200-WRITE-RPT-LINE                              04820000
041200     END-IF.                                                      04830000
041300                                                                  04840000
041400     PERFORM B900-CLOSE-FILES.                                    04850000
041500                                                                  04860000
041600     DISPLAY 'RECORDS FROM FILE WRITTEN TO REPORT = '             04870000
041700                                            PA-RECORDS-WRITTEN.   04880000
041800                                                                  04890000
041900     STOP RUN.                                                    04900000
042000                                                                  04910000
042100***************************************************************** 04920000
042200* B100-OPEN-FILES.                                              * 04930000
042300* ==> PROCESSES:                                                * 04940000
042400*  - OPEN THE INPUT FILE AND REPORT                             * 04950000
042500* ==> PERFORMED FROM: A100-MAINLINE                             * 04960000
042600***************************************************************** 04970000
042700 B100-OPEN-FILES.                                                 04980000
042800                                                                  04990000
042900     OPEN INPUT  PRE-LPS-EXCP-FILE                                05000000
W33193                 CONTROL-CARD-FILE                                05001016
043000          OUTPUT PRE-LPS-EXCP-REPORT.                             05010000
043100                                                                  05020000
043200***************************************************************** 05030000
043300* B150-CURRENT-DATE.                                            * 05040000
043400* ==> PROCESSES:                                                * 05050000
043500*  - GET THE CPU DATE AND TIME                                  * 05060000
043600* ==> PERFORMED FROM: A100-MAINLINE                             * 05070000
043700***************************************************************** 05080000
043800 B150-CURRENT-DATE.                                               05090000
043900                                                                  05100000
044000     ACCEPT CD-CPU-DATE FROM DATE.                                05110000
044100     MOVE CD-CPU-YR                  TO CD-CPU-YY.                05120000
044200     MOVE CD-CPU-MO                  TO CD-CPU-MM.                05130000
044300     MOVE CD-CPU-DY                  TO CD-CPU-DD.                05140000
044400                                                                  05150000
044500     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              05160000
044600     SET DPG51-ACTUAL-CALENDAR-ONLY  TO TRUE.                     05170000
044700     SET DPG51-DO-NOT-INCR-DECR-DATE TO TRUE.                     05180000
044800     SET DPG52-LK-DTE-GREG           TO TRUE.                     05190000
044900     MOVE CD-CPU-DATE-GREG           TO DPG52-LK-DATE-INPUT.      05200000
045000     MOVE 'INVALID CONVERT OF CURRENT DATE FROM CPU'              05210000
045100                                     TO PV-OPERATION-MSG-1.       05220000
045200                                                                  05230000
045300     PERFORM Z800-CALENDAR-ROUTINE.                               05240000
045400                                                                  05250000
045500     MOVE DPG55-DB2-ISO-DATE-FMT     TO CD-CPU-DATE-ISO.          05260000
045600                                                                  05270000
045700     ACCEPT CT-CPU-TIME FROM TIME.                                05280000
045800     MOVE CT-CPU-HR                  TO DP250O-RUN-HOUR.          05290000
045900     MOVE CT-CPU-MIN                 TO DP250O-RUN-MINUTE.        05300000
046000     MOVE CD-CPU-MO                  TO DP250O-RUN-MONTH.         05310000
046100     MOVE CD-CPU-DY                  TO DP250O-RUN-DAY.           05320000
046200     MOVE CD-CPU-YR                  TO DP250O-RUN-YEAR.          05330000
046300     MOVE PC-CURRENT-PROGRAM-NAME    TO DP250O-PROGRAM-NAME.      05340000
046400                                                                  05350000
046500***************************************************************** 05360000
046600* B900-CLOSE-FILES                                              * 05370000
046700* ==> PROCESSES:                                                * 05380000
046800*  - CLOSE THE INPUT FILE AND REPORT                            * 05390000
046900* ==> PERFORMED FROM: A100-MAINLINE                             * 05400000
047000***************************************************************** 05410000
047100 B900-CLOSE-FILES.                                                05420000
047200                                                                  05430000
047300     CLOSE  PRE-LPS-EXCP-FILE                                     05440000
W33193            CONTROL-CARD-FILE                                     05441016
047400            PRE-LPS-EXCP-REPORT.                                  05450000
047500                                                                  05460000
047600***************************************************************** 05470000
047700* D100-READ-FILE.                                               * 05480000
047800* ==> PROCESSES:                                                * 05490000
047900*  - READ THE INPUT FILE AND SET THE DEPT VARIABLES.            * 05500000
048000* ==> PERFORMED FROM: A100-MAINLINE, D200-PROCESS-FILE          * 05510000
048100***************************************************************** 05520000
048200 D100-READ-FILE.                                                  05530000
048300                                                                  05540000
048400     READ PRE-LPS-EXCP-FILE INTO PM044-PM-LPS-PRE-EXCEP           05550000
048500          AT END                                                  05560000
048600             SET PS-EOF-LPS-EXCP-FILE TO TRUE                     05570000
048700     END-READ.                                                    05580000
048800                                                                  05590000
048900     MOVE PV-DPT-NBR       TO PV-PREV-DPT-NBR.                    05600000
049000     MOVE PM044-DEPT-NBR   TO PV-DPT-NBR.                         05610000
049100     MOVE PV-BUYER-NBR     TO PV-PREV-BUYER-NBR.                  05620000
049200     MOVE PM044-BUYER-NBR  TO PV-BUYER-NBR.                       05630000
049300                                                                  05640000
049400***************************************************************** 05650000
049500* D200-PROCESS-FILE                                             * 05660000
049600* ==> PROCESSES:                                                * 05670000
049700*  - IF IT IS A NEW DEPARTMENT THEN WRITE A NEW PAGE            * 05680000
049800*  - MOVE COPYBOOK VARIABLES TO THE HEADER AND DETAIL LINES.    * 05690000
049900*  - WRITE OUT THE DETAIL LINE                                  * 05700000
050000* ==> PERFORMED FROM: A100-MAINLINE                             * 05710000
050100***************************************************************** 05720000
050200 D200-PROCESS-FILE.                                               05730000
050300                                                                  05740000
050400     IF NOT(PV-BUYER-NBR = PV-PREV-BUYER-NBR)                     05750000
050500         PERFORM W400-PRINT-BLANK-PAGE                            05760000
050600     END-IF.                                                      05770000
050700                                                                  05780000
050800     IF NOT(PV-DPT-NBR = PV-PREV-DPT-NBR)                         05790000
050900         DISPLAY 'DONE PROCESSING DEPT ' PV-PREV-DPT-NBR          05800000
051000         DISPLAY 'PROCESS NEW DEPT ' PV-DPT-NBR                   05810000
051100         MOVE PM044-GMM-NBR      TO HDR-03-GMM-NBR                05820000
051200         MOVE PM044-GMM-NAME     TO HDR-03-GMM-NAME               05830000
051300         MOVE PM044-DMM-NBR      TO HDR-04-DMM-NBR                05840000
051400         MOVE PM044-DMM-NAME     TO HDR-04-DMM-NAME               05850000
051500         MOVE PM044-BUYER-NBR    TO HDR-05-BUYER-NBR              05860000
051600         MOVE PM044-BUYER-NAME   TO HDR-05-BUYER-NAME             05870000
051700         MOVE PM044-DEPT-NBR     TO HDR-06-DEPT-NBR               05880000
051800         MOVE PM044-DEPT-DESC    TO HDR-06-DEPT-DESC              05890000
051900         PERFORM W300-PROCESS-PAGE-HEADER                         05900000
052000     END-IF.                                                      05910000
052100                                                                  05920000
052200     MOVE SPACES                 TO DETAIL-01.                    05930000
052300                                                                  05940000
052400     IF PM044-SUB-CL-NBR = ZEROES AND PM044-STYL-ID               05950000
052500        = SPACES AND PM044-PRE-LO-AMT = ZEROES                    05960000
052600        AND PM044-PRE-AD-ITM = SPACES AND                         05970000
052700        PM044-LPS-PRICG-AMT = ZEROES AND                          05980000
052800        PM044-LPS-AD-ITM = SPACES                                 05990000
052900        MOVE DETAIL-02              TO PV-RPT-LINE                06000000
053000     ELSE                                                         06010000
053100        MOVE PM044-SUB-CL-NBR      TO DTL-01-SCL-NBR              06020000
053200        MOVE PM044-STYL-ID         TO DTL-01-STYLE-NBR            06030000
053300        MOVE PM044-VS-DESC         TO DTL-01-STYL-DESC            06040000
053400        MOVE PM044-PRE-LO-AMT      TO DTL-01-LOWEST-PRICE         06050000
053500        MOVE PM044-PRE-AD-EVNT     TO DTL-01-AD-EVENT             06060000
053600        MOVE PM044-PRE-PROMO-NM    TO DTL-01-PROMO                06070000
053700        MOVE PM044-PRE-AD-ITM      TO DTL-01-LOWEST-AD-ITM        06080000
053800        MOVE PM044-LPS-PRICG-AMT   TO DTL-01-LPS-PRICE            06090000
053900        MOVE PM044-LPS-PROMO-NM    TO DTL-01-LPS-PROMO            06100000
054000        MOVE PM044-LPS-AD-ITM      TO DTL-01-LP-AD-ITM            06110000
054100        IF PM044-LPS-PREV-RPTD-IND = 'Y'                          06120000
054200           MOVE 'R'                TO DTL-01-RPT-IND              06130000
054300        ELSE                                                      06140000
054400           MOVE SPACES             TO DTL-01-RPT-IND              06150000
054500        END-IF                                                    06160000
054600        MOVE DETAIL-01             TO PV-RPT-LINE                 06170000
054700     END-IF.                                                      06180000
054800                                                                  06190000
054900     ADD 1                       TO PA-RECORDS-WRITTEN.           06200000
055000                                                                  06210000
055100     MOVE 1                      TO PV-ADVANCE-LINES.             06220000
055200     ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  06230000
055300     PERFORM W200-WRITE-RPT-LINE.                                 06240000
055400                                                                  06250000
055500     PERFORM D100-READ-FILE.                                      06260000
055600                                                                  06270000
055700***************************************************************** 06280000
055800* W100-WRITE-NEW-PAGE.                                          * 06290000
055900* ==> PROCESSES:                                                * 06300000
056000*  - WRITE THE LINE TO A NEW PAGE                               * 06310000
056100* ==> PERFORMED FROM:W300-PROCESS-PAGE-HEADER                   * 06320000
056200***************************************************************** 06330000
056300 W100-WRITE-NEW-PAGE.                                             06340000
056400                                                                  06350000
056500     WRITE PRE-LPS-EXCP-LINE                                      06360000
056600           FROM PV-RPT-LINE                                       06370000
056700           AFTER ADVANCING PAGE.                                  06380000
056800                                                                  06390000
056900     ADD 2            TO PV-LINE-CNT.                             06400000
057000                                                                  06410000
057100***************************************************************** 06420000
057200* W200-WRITE-RPT-LINE.                                          * 06430000
057300* ==> PROCESSES:                                                * 06440000
057400*  - WRITE OUT A LINE ON THE REPORT                             * 06450000
057500* ==> PERFORMED FROM: A100-MAINLINE, D200-PROCESS-FILE          * 06460000
057600*      W300-PROCESS-PAGE-HEADER                                 * 06470000
057700***************************************************************** 06480000
057800 W200-WRITE-RPT-LINE.                                             06490000
057900                                                                  06500000
058000     IF PV-LINE-CNT > PC-MAX-LINE-CNT                             06510000
058100         MOVE PV-RPT-LINE TO PV-HOLD-LINE                         06520000
058200         PERFORM W300-PROCESS-PAGE-HEADER                         06530000
058300         MOVE 1                  TO PV-ADVANCE-LINES              06540000
058400         ADD PV-ADVANCE-LINES    TO PV-LINE-CNT                   06550000
058500         MOVE PV-HOLD-LINE TO PV-RPT-LINE                         06560000
058600     END-IF.                                                      06570000
058700                                                                  06580000
058800     WRITE PRE-LPS-EXCP-LINE                                      06590000
058900           FROM PV-RPT-LINE                                       06600000
059000           AFTER ADVANCING PV-ADVANCE-LINES.                      06610000
059100                                                                  06620000
059200***************************************************************** 06630000
059300* W300-PROCESS-PAGE-HEADER.                                     * 06640000
059400* ==> PROCESSES:                                                * 06650000
059500*  - WRITE OUT THE HEADER ON THE REPORT                         * 06660000
059600*  - THIS WILL APPEAR ON EVERY PAGE                             * 06670000
059700* ==> PERFORMED FROM: D200-PROCESS-FILE, W200-WRITE-RPT-LINE    * 06680000
059800***************************************************************** 06690000
059900 W300-PROCESS-PAGE-HEADER.                                        06700000
060000                                                                  06710000
060100     IF PV-PAGE-CNT > 0                                           06720000
060200         PERFORM W500-WRITE-COMMENT-LINE                          06730000
060300     END-IF.                                                      06740000
060400     MOVE 0                      TO PV-LINE-CNT.                  06750000
060500     ADD  1                      TO PV-PAGE-CNT.                  06760000
060600     MOVE PV-PAGE-CNT            TO DP250O-PAGE-NUMBER.           06770000
060700     MOVE 1                      TO DP250O-REPORT-NUMBER.         06780000
060800                                                                  06790000
060900     MOVE DP250O-STANDRD-HEADER-250-COLS                          06800000
061000                                 TO PV-RPT-LINE.                  06810000
061100     PERFORM W100-WRITE-NEW-PAGE.                                 06820000
061200                                                                  06830000
061300     MOVE HEADER-01              TO PV-RPT-LINE.                  06840000
061400     MOVE 2                      TO PV-ADVANCE-LINES.             06850000
061500     ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  06860000
061600     PERFORM W200-WRITE-RPT-LINE.                                 06870000
061700                                                                  06880000
061800     MOVE HEADER-02               TO PV-RPT-LINE.                 06890000
061900     MOVE 1                       TO PV-ADVANCE-LINES.            06900000
062000     ADD PV-ADVANCE-LINES         TO PV-LINE-CNT.                 06910000
062100     PERFORM W200-WRITE-RPT-LINE.                                 06920000
062200                                                                  06930000
062300     MOVE HEADER-03               TO PV-RPT-LINE.                 06940000
062400     MOVE 2                       TO PV-ADVANCE-LINES.            06950000
062500     ADD PV-ADVANCE-LINES         TO PV-LINE-CNT.                 06960000
062600     PERFORM W200-WRITE-RPT-LINE.                                 06970000
062700                                                                  06980000
062800     MOVE HEADER-04              TO PV-RPT-LINE.                  06990000
062900     MOVE 1                      TO PV-ADVANCE-LINES.             07000000
063000     ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  07010000
063100     PERFORM W200-WRITE-RPT-LINE.                                 07020000
063200                                                                  07030000
063300     MOVE HEADER-05              TO PV-RPT-LINE.                  07040000
063400     MOVE 1                      TO PV-ADVANCE-LINES.             07050000
063500     ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  07060000
063600     PERFORM W200-WRITE-RPT-LINE.                                 07070000
063700                                                                  07080000
063800     MOVE HEADER-06              TO PV-RPT-LINE.                  07090000
063900     MOVE 1                      TO PV-ADVANCE-LINES.             07100000
064000     ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  07110000
064100     PERFORM W200-WRITE-RPT-LINE.                                 07120000
064200                                                                  07130000
064300     MOVE HEADER-07              TO PV-RPT-LINE.                  07140000
064400     MOVE 3                      TO PV-ADVANCE-LINES.             07150000
064500     ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  07160000
064600     PERFORM W200-WRITE-RPT-LINE.                                 07170000
064700                                                                  07180000
064800     MOVE HEADER-07B             TO PV-RPT-LINE.                  07190000
064900     MOVE 1                      TO PV-ADVANCE-LINES.             07200000
065000     ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  07210000
065100     PERFORM W200-WRITE-RPT-LINE.                                 07220000
065200                                                                  07230000
065300     MOVE HEADER-08              TO PV-RPT-LINE.                  07240000
065400     MOVE 1                      TO PV-ADVANCE-LINES.             07250000
065500     ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  07260000
065600     PERFORM W200-WRITE-RPT-LINE.                                 07270000
065700                                                                  07280000
065800     MOVE HEADER-UNDERLINE1      TO PV-RPT-LINE.                  07290000
065900     MOVE 1                      TO PV-ADVANCE-LINES.             07300000
066000     ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  07310000
066100     PERFORM W200-WRITE-RPT-LINE.                                 07320000
066200                                                                  07330000
066300***************************************************************** 07340000
066400* W400-PRINT-BLANK-PAGE                                         * 07350000
066500* ==> PROCESSES:                                                * 07360000
066600*  - WRITE OUT THE HEADER ON THE REPORT                         * 07370000
066700*  - THIS WILL APPEAR ON EVERY PAGE                             * 07380000
066800* ==> PERFORMED FROM: D200-PROCESS-FILE, W200-WRITE-RPT-LINE    * 07390000
066900***************************************************************** 07400000
067000 W400-PRINT-BLANK-PAGE.                                           07410000
067100                                                                  07420000
067200     DIVIDE PV-PAGE-CNT BY 2                                      07430000
067300         GIVING PV-PAGE-DIV                                       07440000
067400         REMAINDER PV-PAGE-REM.                                   07450000
067500                                                                  07460000
067600     IF (PV-PAGE-REM > 0)                                         07470000
067700         PERFORM W500-WRITE-COMMENT-LINE                          07480000
067800         MOVE 0                  TO PV-LINE-CNT                   07490000
067900         ADD 1                   TO PV-PAGE-CNT                   07500000
068000         MOVE PV-PAGE-CNT        TO DP250O-PAGE-NUMBER            07510000
068100         MOVE 1                  TO DP250O-REPORT-NUMBER          07520000
068200         MOVE DP250O-STANDRD-HEADER-250-COLS                      07530000
068300                                 TO PV-RPT-LINE                   07540000
068400         PERFORM W100-WRITE-NEW-PAGE                              07550000
068500                                                                  07560000
068600         MOVE HEADER-01              TO PV-RPT-LINE               07570000
068700         MOVE 2                      TO PV-ADVANCE-LINES          07580000
068800         ADD PV-ADVANCE-LINES        TO PV-LINE-CNT               07590000
068900         PERFORM W200-WRITE-RPT-LINE                              07600000
069000                                                                  07610000
069100         MOVE HEADER-02               TO PV-RPT-LINE              07620000
069200         MOVE 1                       TO PV-ADVANCE-LINES         07630000
069300         ADD PV-ADVANCE-LINES         TO PV-LINE-CNT              07640000
069400         PERFORM W200-WRITE-RPT-LINE                              07650000
069500                                                                  07660000
069600         MOVE HEADER-03               TO PV-RPT-LINE              07670000
069700         MOVE 2                       TO PV-ADVANCE-LINES         07680000
069800         ADD PV-ADVANCE-LINES         TO PV-LINE-CNT              07690000
069900         PERFORM W200-WRITE-RPT-LINE                              07700000
070000                                                                  07710000
070100         MOVE HEADER-04               TO PV-RPT-LINE              07720000
070200         MOVE 1                       TO PV-ADVANCE-LINES         07730000
070300         ADD PV-ADVANCE-LINES         TO PV-LINE-CNT              07740000
070400         PERFORM W200-WRITE-RPT-LINE                              07750000
070500                                                                  07760000
070600         MOVE HEADER-05               TO PV-RPT-LINE              07770000
070700         MOVE 1                       TO PV-ADVANCE-LINES         07780000
070800         ADD PV-ADVANCE-LINES         TO PV-LINE-CNT              07790000
070900         PERFORM W200-WRITE-RPT-LINE                              07800000
071000                                                                  07810000
071100         MOVE HEADER-06               TO PV-RPT-LINE              07820000
071200         MOVE 1                       TO PV-ADVANCE-LINES         07830000
071300         ADD PV-ADVANCE-LINES         TO PV-LINE-CNT              07840000
071400         PERFORM W200-WRITE-RPT-LINE                              07850000
071500                                                                  07860000
071600         MOVE BLANK-PAGE-LINE         TO PV-RPT-LINE              07870000
071700         MOVE 15                      TO PV-ADVANCE-LINES         07880000
071800         ADD PV-ADVANCE-LINES         TO PV-LINE-CNT              07890000
071900         PERFORM W200-WRITE-RPT-LINE                              07900000
072000                                                                  07910000
072100     END-IF.                                                      07920000
072200                                                                  07930000
072300***************************************************************** 07940000
072400* W500-WRITE-COMMENT-LINE.                                      * 07950000
072500* ==> PROCESSES:                                                * 07960000
072600*  - WRITE THE LINE TO COMMENT LINES                            * 07970000
072700***************************************************************** 07980000
072800 W500-WRITE-COMMENT-LINE.                                         07990000
072900                                                                  08000000
073000     MOVE 2                 TO PV-ADVANCE-LINES.                  08010000
073100     ADD PV-ADVANCE-LINES   TO PV-LINE-CNT.                       08020000
073200     WRITE PRE-LPS-EXCP-LINE                                      08030000
073300           FROM COMMENT-LINE1                                     08040000
073400           AFTER ADVANCING PV-ADVANCE-LINES.                      08050000
073500                                                                  08060000
073600     MOVE 1                 TO PV-ADVANCE-LINES.                  08070000
073700     ADD PV-ADVANCE-LINES   TO PV-LINE-CNT.                       08080000
073800     WRITE PRE-LPS-EXCP-LINE                                      08090000
567913           FROM COMMENT-LINE2B                                    08100023
074000           AFTER ADVANCING PV-ADVANCE-LINES.                      08110000
074100                                                                  08120000
074200******************************************************************08130000
074300*Z800-CALENDAR-ROUTINE.                                          *08140000
074400*  ==> PROCESSES:                                                *08150000
074500*      - CALLS THE DATE ROUTINE WITH SPECIFIED PARAMETERS.       *08160000
074600******************************************************************08170000
074700 Z800-CALENDAR-ROUTINE.                                           08180000
074800                                                                  08190000
074900     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52          08200000
075000                                             DPG53 DPG54          08210000
075100                                             DPG55 DPG56.         08220000
075200                                                                  08230000
075300     EVALUATE TRUE                                                08240000
075400         WHEN DPG54-NO-ERROR                                      08250000
075500             CONTINUE                                             08260000
075600         WHEN DPG54-WARNING-ERROR                                 08270000
075700             DISPLAY '** WARNING - PROGRAM '                      08280000
075800                      PC-CURRENT-PROGRAM-NAME ' **'               08290000
075900             DISPLAY '** Z800-CALENDAR-ROUTINE'                   08300000
076000             DISPLAY '** CALL TO DPKUT500 RETURNED WARNING ERROR' 08310000
076100             DISPLAY '** DPG54-ERROR-MESSAGE: '                   08320000
076200             DISPLAY '** ' DPG54-ERROR-MESSAGE                    08330000
076300             DISPLAY '** DPG51: ' DPG51                           08340000
076400             DISPLAY '** DPG52: ' DPG52                           08350000
076500             DISPLAY '** PLEASE INVESTIGATE FURTHER **'           08360000
076600         WHEN DPG54-SEVERE-ERROR                                  08370000
076700             DISPLAY '** ABEND - PROGRAM '                        08380000
076800                      PC-CURRENT-PROGRAM-NAME ' **'               08390000
076900             DISPLAY '** Z800-CALENDAR-ROUTINE'                   08400000
077000             DISPLAY '** CALL TO DPKUT500 RETURNED SEVERE ERROR'  08410000
077100             IF DPG54-CALENDAR-TYPE-INVALID                       08420000
077200                DISPLAY '** DPG54-CALENDAR-TYPE-INVALID'          08430000
077300                DISPLAY '** DPG51-CALENDAR-TYPE: '                08440000
077400                         DPG51-CALENDAR-TYPE                      08450000
077500             END-IF                                               08460000
077600             IF DPG54-DATE-INVALID                                08470000
077700                DISPLAY '** DPG54-DATE-INVALID'                   08480000
077800                DISPLAY '** DPG52-LK-DATE-INPUT: '                08490000
077900                         DPG52-LK-DATE-INPUT                      08500000
078000             END-IF                                               08510000
078100             IF DPG54-INCR-DECR-INVALID                           08520000
078200                DISPLAY '** DPG54-INCR-DECR-INVALID'              08530000
078300                DISPLAY '** DPG51-INCREMENT-DECREMENT-FLAG: '     08540000
078400                         DPG51-INCREMENT-DECREMENT-FLAG           08550000
078500             END-IF                                               08560000
078600             MOVE DPG54-ERROR-MESSAGE TO PV-OPERATION-MSG-2       08570000
078700             SET ABEND-4019-DATE-ROUTINE-ERROR TO TRUE            08580000
078800             PERFORM Z910-ABEND                                   08590000
078900     END-EVALUATE.                                                08600000
079000                                                                  08610000
079100******************************************************************08620000
079200* Z910-ABEND - PERFORMS A NON-SQL-ABEND                          *08630000
079300******************************************************************08640000
079400 Z910-ABEND.                                                      08650000
079500                                                                  08660000
079600     DISPLAY '** ABEND           **'.                             08670000
079700     DISPLAY '** PROGRAM         ** = ' PC-CURRENT-PROGRAM-NAME.  08680000
079800     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        08690000
079900     DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG-1.       08700000
080000     DISPLAY '**                 ** = ' PV-OPERATION-MSG-2.       08710000
080100                                                                  08720000
080200     CALL 'ILBOABN0' USING ABEND-CODE.                            08730000
