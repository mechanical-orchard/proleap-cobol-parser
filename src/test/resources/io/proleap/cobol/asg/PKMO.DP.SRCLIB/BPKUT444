000100******************************************************************00010030
000200******************************************************************00020030
000300 IDENTIFICATION DIVISION.                                         00030030
000400******************************************************************00040030
000500******************************************************************00050030
000600                                                                  00060030
000700 PROGRAM-ID.     BPKUT444.                                        00070037
000800 AUTHOR.         COGNIZANT.                                       00080030
000900 INSTALLATION.   KOHLS DEPARTMENT STORES.                         00090030
001000 DATE-WRITTEN.   04/28/2010.                                      00100030
001100 DATE-COMPILED.                                                   00110030
001200                                                                  00120030
001300******************************************************************00130030
001400*                                                                 00140030
001500*      CREATE THE DATE CONTROL CARD FOR THE PLATINUM UNLOADS      00150030
001600*                                                                 00160030
001700******************************************************************00170030
001800                                                                  00180030
001900******************************************************************00190030
002000*  CHANGES:                                                       00200030
002100*                                                                 00210030
002200*  04/28/2010     COGNIZANT    WR# 2344                           00220030
002300*  EP UPGRADE                                                     00230030
002400*     -  THIS PROGRAM IS TO EXTRACT THE CONTROL CARD FILES FOR    00240030
002500*        EP. CHANGED TO HAVE WITH UR IN THE QUERIES AND REMOVED   00250030
002600*        THE HARDCODED STORE-NBR FOR TWKPOSS CONTROL CARD FILES.  00260030
002700*                                                                 00270034
002800*  12/14/2011     COGNIZANT    CRQ# 16360                         00280034
002900*     -  MODIFY EXTRACT DATE LOGIC TO HAVE THE MONTH BEGIN DATE   00290034
003000*        AS START DATE AND LAST WEEKEND DATE AS END DATE.         00300034
11752A*                                                                 00300138
11752A*  06/09/2017     J SELWITSCHKA                                   00301036
11752A*     -  CHANGES FOR EP UPGRADE.                                  00302036
11752A*        MODIFY EXTRACT DATE LOGIC TO HAVE THE WEEK BEGIN DATE    00302136
11752A*        AS START DATE INSTEAD OF THE MONTH BEGIN DATE.           00303036
11752A*                                                                 00304038
11752A*  06/22/2017     J SELWITSCHKA                                   00305039
11752A*     - NEW VERSION BPKUT444 IS A COPY OF BPKUT440 WITH EP        00306039
11752A*       UPGRADE CHANGES. CREATED BECAUSE EP UPGRADE VERSION       00307039
11752A*       WILL BE RUNNING IN PARALLEL WITH OLD VERSION.             00308039
11752A*                                                                 00309039
003100******************************************************************00310030
003200                                                                  00320030
003300******************************************************************00330030
003400******************************************************************00340030
003500 ENVIRONMENT DIVISION.                                            00350030
003600******************************************************************00360030
003700******************************************************************00370030
003800                                                                  00380030
003900******************************************************************00390030
004000 CONFIGURATION SECTION.                                           00400030
004100******************************************************************00410030
004200                                                                  00420030
004300 SOURCE-COMPUTER.        IBM-3090.                                00430030
004400 OBJECT-COMPUTER.        IBM-3090.                                00440030
004500                                                                  00450030
004600******************************************************************00460030
004700 INPUT-OUTPUT SECTION.                                            00470030
004800******************************************************************00480030
004900                                                                  00490030
005000 FILE-CONTROL.                                                    00500030
005100                                                                  00510030
005200     SELECT CONTROL-CARD-FILE                                     00520030
005300         ASSIGN TO INP01.                                         00530030
005400                                                                  00540030
005500     SELECT PLAT-CNTL-FILE-STORES-CHNL                            00550030
005600         ASSIGN TO OUT01.                                         00560030
005700                                                                  00570030
005800     SELECT PLAT-CNTL-FILE-ECOM-CHNL                              00580030
005900         ASSIGN TO OUT02.                                         00590030
006000                                                                  00600030
006100     SELECT PLAT-CNTL-FILE-STORE-STR                              00610030
006200         ASSIGN TO OUT03.                                         00620030
006300                                                                  00630030
006400******************************************************************00640030
006500******************************************************************00650030
006600 DATA DIVISION.                                                   00660030
006700******************************************************************00670030
006800******************************************************************00680030
006900                                                                  00690030
007000******************************************************************00700030
007100 FILE SECTION.                                                    00710030
007200******************************************************************00720030
007300                                                                  00730030
007400 FD  CONTROL-CARD-FILE                                            00740030
007500     RECORDING MODE IS F                                          00750030
007600     LABEL RECORDS ARE STANDARD                                   00760030
007700     BLOCK CONTAINS 0 RECORDS.                                    00770030
007800                                                                  00780030
007900 01  CONTROL-CARD-RECORD              PIC X(80).                  00790030
008000                                                                  00800030
008100 FD  PLAT-CNTL-FILE-STORES-CHNL                                   00810030
008200     RECORDING MODE IS F                                          00820030
008300     LABEL RECORDS ARE STANDARD                                   00830030
008400     BLOCK CONTAINS 0 RECORDS.                                    00840030
008500                                                                  00850030
008600 01  PLAT-CNTL-RECORD-STORES-CHNL     PIC X(80).                  00860030
008700                                                                  00870030
008800 FD  PLAT-CNTL-FILE-ECOM-CHNL                                     00880030
008900     RECORDING MODE IS F                                          00890030
009000     LABEL RECORDS ARE STANDARD                                   00900030
009100     BLOCK CONTAINS 0 RECORDS.                                    00910030
009200                                                                  00920030
009300 01  PLAT-CNTL-RECORD-ECOM-CHNL       PIC X(80).                  00930030
009400                                                                  00940030
009500 FD  PLAT-CNTL-FILE-STORE-STR                                     00950030
009600     RECORDING MODE IS F                                          00960030
009700     LABEL RECORDS ARE STANDARD                                   00970030
009800     BLOCK CONTAINS 0 RECORDS.                                    00980030
009900                                                                  00990030
010000 01  PLAT-CNTL-RECORD-STORE-STR      PIC X(80).                   01000030
010100                                                                  01010030
010200******************************************************************01020030
010300 WORKING-STORAGE SECTION.                                         01030030
010400******************************************************************01040030
010500                                                                  01050030
010600 01  PS-PROGRAM-SWITCHES.                                         01060030
010700     05  PS-END-OF-CONTROL-CARDS-SW   PIC X      VALUE 'N'.       01070030
010800         88  PS-END-OF-CONTROL-CARDS             VALUE 'Y'.       01080030
010900                                                                  01090030
011000 01  PV-PROGRAM-VARIABLES.                                        01100030
011100     05  PV-EXTRACT-START-DATE        PIC X(10).                  01110030
011200     05  PV-EXTRACT-END-DATE          PIC X(10).                  01120030
011300     05  PV-EXTRACT-WK-NBR-START      PIC X(02).                  01130030
011400     05  PV-EXTRACT-WK-NBR-END        PIC X(02).                  01140030
011500     05  PV-PARAGRAPH-NAME            PIC X(30).                  01150030
011600     05  PV-DB2-OPER-ATTEMPTED        PIC X(30).                  01160030
011700     05  PV-ABEND-CODE                PIC S9(04) COMP VALUE ZERO. 01170030
011800                                                                  01180030
011900 01  PV-PLAT-CNTL-RECORD.                                         01190030
012000     05  FILLER                  PIC X(33)   VALUE                01200030
012100         '  WHERE FSCL_WK_END_DTE BETWEEN '''.                    01210030
012200     05  PV-BEGIN-DATE           PIC X(10)   VALUE SPACES.        01220030
012300     05  FILLER                  PIC X(07)   VALUE                01230030
012400         ''' AND '''.                                             01240030
012500     05  PV-END-DATE             PIC X(10)   VALUE SPACES.        01250030
012600     05  FILLER                  PIC X(05)   VALUE ''' AND'.      01260030
012700     05  FILLER                  PIC X(15)   VALUE SPACES.        01270030
012800                                                                  01280030
012900 01  PV-PLAT-CNTL-RECORD1.                                        01290030
013000     05  FILLER                  PIC X(33)   VALUE                01300030
013100         '  AND A.FSCL_WK_END_DTE BETWEEN '''.                    01310030
013200     05  PV-BEGIN-DATE1          PIC X(10)   VALUE SPACES.        01320030
013300     05  FILLER                  PIC X(07)   VALUE                01330030
013400         ''' AND '''.                                             01340030
013500     05  PV-END-DATE1            PIC X(10)   VALUE SPACES.        01350030
013600     05  FILLER                  PIC X(01)   VALUE ''''.          01360030
013700     05  FILLER                  PIC X(19)   VALUE SPACES.        01370030
013800                                                                  01380030
013900 01  PV-STR-RECORD-STORES-CHNL.                                   01390030
014000     05  FILLER                  PIC X(19)   VALUE                01400030
014100         '       CHNL_CDE = '''.                                  01410030
014200     05  FILLER                  PIC X(02)   VALUE 'P'''.         01420030
014300     05  FILLER                  PIC X(09)   VALUE ' WITH UR;'.   01430030
014400     05  FILLER                  PIC X(50)   VALUE SPACES.        01440030
014500                                                                  01450030
014600 01  PV-STR-RECORD-ECOM-CHNL.                                     01460030
014700     05  FILLER                  PIC X(19)   VALUE                01470030
014800         '       CHNL_CDE = '''.                                  01480030
014900     05  FILLER                  PIC X(02)   VALUE 'V'''.         01490030
015000     05  FILLER                  PIC X(09)   VALUE ' WITH UR;'.   01500030
015100     05  FILLER                  PIC X(50)   VALUE SPACES.        01510030
015200                                                                  01520030
015300 01  PV-STR-RECORD-STORE-STR-LINE0.                               01530030
015400     05  FILLER                  PIC X(29)   VALUE                01540030
015500         '  AND A.FSCL_WK_NBR BETWEEN '''.                        01550030
015600     05  PV-WK-NBR-START         PIC X(02)   VALUE SPACES.        01560030
015700     05  FILLER                  PIC X(07)   VALUE                01570030
015800         ''' AND '''.                                             01580030
015900     05  PV-WK-NBR-END           PIC X(02)   VALUE SPACES.        01590030
016000     05  FILLER                  PIC X(10)   VALUE                01600030
016100                                              ''' WITH UR;'.      01610030
016200     05  FILLER                  PIC X(30)   VALUE SPACES.        01620030
016300                                                                  01630030
016400****************************************************************  01640030
016500* RECORD LAYOUT FOR CONTROL CARD FILE.                            01650030
016600****************************************************************  01660030
016700                                                                  01670030
016800 01  CC-CONTROL-CARD.                                             01680030
016900     05  CC-EXTRACT-START-DATE        PIC X(10).                  01690030
017000     05  FILLER                       PIC X(01).                  01700030
017100     05  CC-EXTRACT-END-DATE          PIC X(10).                  01710030
017200     05  FILLER                       PIC X(01).                  01720030
017300     05  CC-EXTRACT-WK-NBR-START      PIC X(02).                  01730030
017400     05  FILLER                       PIC X(01).                  01740030
017500     05  CC-EXTRACT-WK-NBR-END        PIC X(02).                  01750030
017600     05  FILLER                       PIC X(53).                  01760030
017700                                                                  01770030
017800****************************************************************  01780030
017900* MERCHANDISE LEDGER CONTROL TABLE                                01790030
018000****************************************************************  01800030
018100                                                                  01810030
018200     EXEC SQL                                                     01820030
018300         INCLUDE TMLCNTL                                          01830030
018400     END-EXEC.                                                    01840030
018500                                                                  01850030
018600****************************************************************  01860030
018700* DATE ATTRIBUTE TABLE                                            01870030
018800****************************************************************  01880030
018900                                                                  01890030
019000     EXEC SQL                                                     01900030
019100         INCLUDE TDTATTR                                          01910030
019200     END-EXEC.                                                    01920030
019300                                                                  01930030
019400****************************************************************  01940030
019500*  COMMUNICATION AREAS FOR DB2                                    01950030
019600****************************************************************  01960030
019700                                                                  01970030
019800     EXEC SQL                                                     01980030
019900         INCLUDE SQLCA                                            01990030
020000     END-EXEC.                                                    02000030
020100                                                                  02010030
020200******************************************************************02020030
020300* DB2 COMMUNICATION AREA 2                                        02030030
020400******************************************************************02040030
020500                                                                  02050030
020600     COPY SQLCA2.                                                 02060030
020700                                                                  02070030
020800******************************************************************02080030
020900******************************************************************02090030
021000 PROCEDURE DIVISION.                                              02100030
021100******************************************************************02110030
021200******************************************************************02120030
021300                                                                  02130030
021400 0000-MAINLINE.                                                   02140030
021500                                                                  02150030
021600     PERFORM 1000-INITIALIZE.                                     02160030
021700                                                                  02170030
021800     PERFORM 2000-CREATE-DATE-CNTL-FILE.                          02180030
021900                                                                  02190030
022000     CLOSE CONTROL-CARD-FILE                                      02200030
022100           PLAT-CNTL-FILE-STORES-CHNL                             02210030
022200           PLAT-CNTL-FILE-ECOM-CHNL                               02220030
022300           PLAT-CNTL-FILE-STORE-STR.                              02230030
022400                                                                  02240030
022500     STOP RUN.                                                    02250030
022600                                                                  02260030
022700                                                                  02270030
022800******************************************************************02280030
022900*                                                                 02290030
023000*  OPEN INPUT AND OUTPUT FILES AND DETERMINE THE PROCESSING DATES 02300030
023100*                                                                 02310030
023200******************************************************************02320030
023300 1000-INITIALIZE.                                                 02330030
023400     OPEN INPUT  CONTROL-CARD-FILE                                02340030
023500          OUTPUT PLAT-CNTL-FILE-STORES-CHNL                       02350030
023600                 PLAT-CNTL-FILE-ECOM-CHNL                         02360030
023700                 PLAT-CNTL-FILE-STORE-STR.                        02370030
023800                                                                  02380030
023900     PERFORM 1100-SET-EXTRACT-DATES.                              02390030
024000                                                                  02400030
024100******************************************************************02410030
024200*                                                                 02420030
024300* IF THERE ARE DATES ON THE CONTROL CARD, WE WILL USE THEM IN OUR 02430030
024400* PROCESSING (OVERRIDE).  IF NOT, WE WILL EXTRACT THE PROCESSING  02440030
024500* DATES FROM THE MERCHANDISE LEDGER CONTROL TABLE                 02450030
024600*                                                                 02460030
024700******************************************************************02470030
024800 1100-SET-EXTRACT-DATES.                                          02480030
024900     PERFORM 7000-READ-CONTROL-CARD-FILE.                         02490030
025000                                                                  02500030
025100     IF CC-EXTRACT-START-DATE = SPACE                             02510030
025200         PERFORM 1110-USE-ML-CNTL-DATES                           02520030
025300         DISPLAY 'BPKUT444 - EXTRACT DATES'                       02530037
025400         DISPLAY 'BPKUT444 - BEGIN DATE ' PV-EXTRACT-START-DATE   02540037
025500         DISPLAY 'BPKUT444 - END DATE   ' PV-EXTRACT-END-DATE     02550037
025600         DISPLAY 'BPKUT444 - BEG WK NBR ' PV-EXTRACT-WK-NBR-START 02560037
025700         DISPLAY 'BPKUT444 - END WK NBR ' PV-EXTRACT-WK-NBR-END   02570037
025800     ELSE                                                         02580030
025900         DISPLAY '***********************************************'02590030
026000         DISPLAY '** OVERRIDE DATE USED: ' CC-CONTROL-CARD        02600030
026100         DISPLAY '***********************************************'02610030
026200         PERFORM 1120-USE-OVERRIDE-DATE                           02620030
026300     END-IF.                                                      02630030
026400                                                                  02640030
026500                                                                  02650030
026600******************************************************************02660030
026700*                                                                 02670030
026800* GET THE OPEN FISCAL WEEK DATE AND THE MAX POSTING FISCAL WEEK   02680030
026900* DATE FROM THE MERCHANDISE LEDGER CONTROL TABLE FOR PROCESSING   02690030
027000*                                                                 02700030
027100******************************************************************02710030
027200 1110-USE-ML-CNTL-DATES.                                          02720030
027300     EXEC SQL                                                     02730030
027400          SELECT                                                  02740030
11752A*                FSCL_MN_BEG_DTE                                  02750036
11752A                 FSCL_WK_BEG_DTE                                  02751036
027600                ,MXPSTG_FSCL_WK_DTE                               02760030
027700                ,MXPSTG_FSCL_WK_NBR                               02770030
027800            INTO                                                  02780030
11752A*                :DTATTR-FSCL-MN-BEG-DTE                          02790036
11752A                 :DTATTR-FSCL-WK-BEG-DTE                          02791036
028000                ,:MLCNTL-MXPSTG-FSCL-WK-DTE                       02800030
028100                ,:MLCNTL-MXPSTG-FSCL-WK-NBR                       02810030
028200            FROM                                                  02820030
028300                 TMLCNTL                                          02830030
028400                ,TDTATTR                                          02840030
028500            WHERE                                                 02850030
028600                KY_DTE = OPN_FSCL_WK_DTE                          02860030
028700     END-EXEC.                                                    02870030
028800                                                                  02880030
028900     EVALUATE TRUE                                                02890030
029000         WHEN SQLCODE = ZERO                                      02900030
11752A*            MOVE DTATTR-FSCL-MN-BEG-DTE   TO                     02910036
11752A             MOVE DTATTR-FSCL-WK-BEG-DTE   TO                     02911036
029200                  PV-EXTRACT-START-DATE                           02920030
029300             MOVE MLCNTL-MXPSTG-FSCL-WK-DTE TO                    02930030
029400                  PV-EXTRACT-END-DATE                             02940030
029500             MOVE MLCNTL-MXPSTG-FSCL-WK-NBR TO                    02950030
029600                  PV-EXTRACT-WK-NBR-END                           02960030
029700         WHEN OTHER                                               02970030
029800             MOVE '1110-USE-ML-CNTL-DATES' TO PV-PARAGRAPH-NAME   02980030
029900             MOVE 'SELECT ROW FROM TMLCNTL'                       02990030
030000                                          TO PV-DB2-OPER-ATTEMPTED03000030
030100             PERFORM 9999-SQL-ABEND                               03010030
030200     END-EVALUATE.                                                03020030
030300                                                                  03030030
030400*    GET FISCAL WEEK NO FOR THE MONTH BEGIN DATE                  03040030
030500*                                                                 03050030
030600     EXEC SQL                                                     03060030
030700          SELECT                                                  03070030
030800              FSCL_WK_NBR                                         03080030
030900          INTO                                                    03090030
031000              :DTATTR-FSCL-WK-NBR                                 03100030
031100          FROM                                                    03110030
031200              TDTATTR A                                           03120030
031300          WHERE                                                   03130030
031400              A.KY_DTE = :PV-EXTRACT-START-DATE                   03140030
031500     END-EXEC.                                                    03150030
031600                                                                  03160030
031700     EVALUATE TRUE                                                03170030
031800         WHEN SQLCODE = ZERO                                      03180030
031900             MOVE DTATTR-FSCL-WK-NBR   TO PV-EXTRACT-WK-NBR-START 03190030
032000         WHEN OTHER                                               03200030
11752A*            DISPLAY '** SELECT WK NUM FOR MTH BEG DTE   '        03210036
11752A*            DISPLAY '** MONTH BEGIN DATE= ' PV-EXTRACT-START-DATE03220036
11752A             DISPLAY '** SELECT WK NUM FOR WK BEG DTE   '         03220136
11752A             DISPLAY '** WEEK BEGIN DATE= ' PV-EXTRACT-START-DATE 03221036
032300             MOVE    '1110-USE-ML-CNTL-DATES'                     03230030
032400                                          TO PV-PARAGRAPH-NAME    03240030
032500             PERFORM 9999-SQL-ABEND                               03250030
032600     END-EVALUATE.                                                03260030
032700                                                                  03270030
032800                                                                  03280030
032900******************************************************************03290030
033000*                                                                 03300030
033100*          USE THE OVERRIDE DATES FROM THE CONTROL CARD           03310030
033200*                                                                 03320030
033300******************************************************************03330030
033400 1120-USE-OVERRIDE-DATE.                                          03340030
033500     MOVE CC-EXTRACT-START-DATE TO PV-EXTRACT-START-DATE.         03350030
033600     MOVE CC-EXTRACT-END-DATE   TO PV-EXTRACT-END-DATE.           03360030
033700     MOVE CC-EXTRACT-WK-NBR-START TO PV-EXTRACT-WK-NBR-START.     03370030
033800     MOVE CC-EXTRACT-WK-NBR-END   TO PV-EXTRACT-WK-NBR-END.       03380030
033900                                                                  03390030
034000                                                                  03400030
034100******************************************************************03410030
034200*                                                                 03420030
034300*                                                                 03430030
034400******************************************************************03440030
034500 2000-CREATE-DATE-CNTL-FILE.                                      03450030
034600     MOVE PV-EXTRACT-START-DATE TO PV-BEGIN-DATE                  03460030
034700                                   PV-BEGIN-DATE1.                03470030
034800     MOVE PV-EXTRACT-END-DATE   TO PV-END-DATE                    03480030
034900                                   PV-END-DATE1.                  03490030
035000     MOVE PV-EXTRACT-WK-NBR-START TO PV-WK-NBR-START.             03500030
035100     MOVE PV-EXTRACT-WK-NBR-END   TO PV-WK-NBR-END.               03510030
035200                                                                  03520030
035300******************************************************************03530030
035400*           WRITE THE PLATINUM UNLOAD DATE CONTROL CARD           03540030
035500*              FOR BRICK & MORTAR STORES (BY CHANNEL)             03550030
035600******************************************************************03560030
035700     WRITE PLAT-CNTL-RECORD-STORES-CHNL                           03570030
035800         FROM  PV-PLAT-CNTL-RECORD.                               03580030
035900                                                                  03590030
036000     WRITE PLAT-CNTL-RECORD-STORES-CHNL                           03600030
036100         FROM  PV-STR-RECORD-STORES-CHNL.                         03610030
036200                                                                  03620030
036300******************************************************************03630030
036400*           WRITE THE PLATINUM UNLOAD DATE CONTROL CARD           03640030
036500*              FOR THE E-COMMERCE STORE (BY CHANNEL)              03650030
036600******************************************************************03660030
036700     WRITE PLAT-CNTL-RECORD-ECOM-CHNL                             03670030
036800         FROM  PV-PLAT-CNTL-RECORD.                               03680030
036900                                                                  03690030
037000     WRITE PLAT-CNTL-RECORD-ECOM-CHNL                             03700030
037100         FROM  PV-STR-RECORD-ECOM-CHNL.                           03710030
037200                                                                  03720030
037300******************************************************************03730030
037400*           WRITE THE PLATINUM UNLOAD DATE CONTROL CARD           03740030
037500*           FOR BRICK & MORTAR STORES (BY STORE NUMBER)           03750030
037600******************************************************************03760030
037700     WRITE PLAT-CNTL-RECORD-STORE-STR                             03770030
037800         FROM  PV-PLAT-CNTL-RECORD1.                              03780030
037900                                                                  03790030
038000     WRITE PLAT-CNTL-RECORD-STORE-STR                             03800030
038100         FROM  PV-STR-RECORD-STORE-STR-LINE0.                     03810030
038200                                                                  03820030
038300                                                                  03830030
038400******************************************************************03840030
038500*                                                                 03850030
038600*  READS THE CONTROL CARD TO DETERMINE IF THEIR ARE ANY OVERRIDE  03860030
038700*                   DATES TO USE FOR PROCESSING                   03870030
038800*                                                                 03880030
038900******************************************************************03890030
039000 7000-READ-CONTROL-CARD-FILE.                                     03900030
039100     READ CONTROL-CARD-FILE INTO CC-CONTROL-CARD                  03910030
039200         AT END SET PS-END-OF-CONTROL-CARDS TO TRUE.              03920030
039300                                                                  03930030
039400                                                                  03940030
039500******************************************************************03950030
039600*                                                                *03960030
039700*  PERFORMS THE ABEND FOR THE PROGRAM IN THE EVENT THAT AN SQL   *03970030
039800*                  ERROR OR WARNING CODE OCCURS                  *03980030
039900*                                                                *03990030
040000******************************************************************04000030
040100 9999-SQL-ABEND.                                                  04010030
040200                                                                  04020030
040300     MOVE SQLCODE        TO  SQLCODE2.                            04030030
040400     MOVE SQLERRD(3)     TO  SQLERRD3.                            04040030
040500                                                                  04050030
040600     DISPLAY '***************************'                        04060030
040700     DISPLAY '**       ABEND           **'                        04070030
040800     DISPLAY '**  IN PROGRAM BPKUT444  **'                        04080037
040900     DISPLAY '***************************'                        04090030
041000     DISPLAY '** PARAGRAPH **      = ' PV-PARAGRAPH-NAME          04100030
041100     DISPLAY '** OPERATION **      = ' PV-DB2-OPER-ATTEMPTED      04110030
041200     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  04120030
041300     DISPLAY '** SQLCODE **        = ' SQLCODE2.                  04130030
041400                                                                  04140030
041500     MOVE +4013         TO PV-ABEND-CODE.                         04150030
041600     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         04160030
