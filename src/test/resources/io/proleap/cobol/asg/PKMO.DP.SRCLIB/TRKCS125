000100*-----------------------*                                         00010062
000200 IDENTIFICATION DIVISION.                                         00020062
000300*-----------------------*                                         00030062
000400 PROGRAM-ID.    TRKCS125.                                         00040062
000500 AUTHOR.        STEPHANIE HERON.                                  00050062
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060062
000700 DATE-WRITTEN.  03-17-95.                                         00070062
000800 DATE-COMPILED.                                                   00080062
000900*----------------------------------------------------------------*00090062
001000*    Y125 - ADD FORECAST SHIPMENT                                *00100062
001100*                                                                *00110062
001200*    THIS PROGRAM ALLOWS THE USER TO ADD A NEW FORECAST SHIPMENTS*00120062
001300*    TO THE SYSTEM.                                              *00130062
001400*                                                                *00140062
001500*    TO ADD A FORECAST SHIPMENT THE PO NUMBER, FREIGHT BILL      *00150062
001600*    CARTON COUNT, THE FRIEGHT BILL -OR- BILL OF LADING, THE     *00160062
001700*    ETA DATE AND THE SCAC (DELIVERY -OR- ORIGIN) MUST BE ENTERED*00170062
001800*                                                                *00180062
001900*    THE USER MAY INQUIRE ON THE PO TO OBTAIN THE PO STATUS      *00190062
002000*    BEFORE ENTERING ALL THE ABOVE INFORMATION.                  *00200062
002100*----------------------------------------------------------------*00210062
002200* 2011-12-14 CHRISTINE TWIEHAUS WR40574                          *00220062
002300*            ADDING CAN (CARR-AUTH-ID) ENTRY TO UPDATE           *00230062
002400*            TSHIPMT AND TAUSHIP                                 *00240062
002500*----------------------------------------------------------------*00250062
002510* 2014-10-29 CHERI PARMLEY      CHG0094517                       *00251080
002520*            EXPANDED PO# FROM 7 TO 8 DIGITS                     *00252074
002540*----------------------------------------------------------------*00254074
273427* 2022-08-17 BARB SCHULTZ       CHG0273427                       *00255083
273427* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE    *00256083
273427* MAKING THE CALL DYNAMIC VS STATIC.                             *00256183
002540*----------------------------------------------------------------*00257082
CICS  * CHANGED 11/21/2022    BY JIM HUNTER      WR: CHG0278495         00258085
CICS  * ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL        00259085
CICS  * DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.       00259185
CICS  *-----------------------------------------------------------------00259285
002600                                                                  00260062
002700 ENVIRONMENT DIVISION.                                            00270062
002800                                                                  00280062
002900 DATA DIVISION.                                                   00290062
003000                                                                  00300062
003100 WORKING-STORAGE SECTION.                                         00310062
003200                                                                  00320062
003300 01  DK-DB2-KEYS.                                                 00330062
003400     05  DK-OPERATING-COMPANY           PIC  X(02)  VALUE SPACE.  00340062
003500     05  DK-APLSYS-CDE                  PIC  X(02)  VALUE SPACE.  00350062
003600     05  DK-VEH-NBR                     PIC  X(10) VALUE SPACES.  00360062
003700     05  DK-TRIP-ID                     PIC  S9(9)  COMP VALUE +0.00370062
003800     05  DK-PRO-NBR                     PIC X(22).                00380062
003900     05  DK-BOL-NBR                     PIC X(30).                00390062
004000     05  DK-PO-NBR                PIC S9(9)   VALUE +0 COMP.      00400062
004100     05  DK-PO-CARTON-CNT         PIC S9(4)   VALUE +0 COMP.      00410062
004200     05  DK-FB-CARTON-CNT         PIC S9(4)   VALUE +0 COMP.      00420062
004300     05  DK-SCAC                  PIC X(04).                      00430062
004400     05  DK-ORIG-SCAC             PIC X(04).                      00440062
004500     05  DK-PRO-SCAC              PIC X(04).                      00450062
004600*                                                                 00460062
004700 01  DN-DB2-NULL-INDICATORS.                                      00470062
004800     05  DN-TRIP-ID                   PIC S9(04) COMP VALUE +0.   00480062
004900     05  DN-EST-AR-TMST               PIC S9(04) COMP VALUE +0.   00490062
005000     05  DN-VEH-NBR                   PIC S9(04) COMP VALUE +0.   00500062
005100     05  DN-CURR-TRIP-ID              PIC S9(04) COMP VALUE +0.   00510062
005200*                                                                 00520062
005300 01  PC-PROGRAM-CONSTANTS.                                        00530062
005400     05  PC-CURRENT-MAP-NAME      PIC  X(08)  VALUE  'TR125A  '.  00540062
005500     05  PC-CURRENT-MAPSET-NAME   PIC  X(08)  VALUE  'TRKM125 '.  00550062
005600     05  PC-CURRENT-PROGRAM-NAME  PIC  X(08)  VALUE  'TRKCS125'.  00560062
005700     05  PC-RANDNBR-PGM                 PIC X(08)   VALUE         00570062
005800                                                    'DPKUT902'.   00580079
006100     05  PC-RCKUT023                    PIC X(08)   VALUE         00610062
006200         'RCKUT023'.                                              00620062
006300     05  PC-DEFAULT-DATE                PIC  X(10)  VALUE         00630062
006400                                                    '0001-01-01'. 00640062
006500     05  PC-DEFAULT-DATE-RDF            PIC  X(10)  VALUE         00650062
006600                                                    '01/01/0001'. 00660062
006700     05  PC-DEFAULT-TIME                PIC  X(08)  VALUE         00670062
006800                                                    '00.00.00'.   00680062
006900     05  PC-DEFAULT-TMST                PIC  X(26)  VALUE         00690062
007000                                   '0001-01-01-00.00.00.000000'.  00700062
007100     05  PC-ACTIVE                PIC X(01)   VALUE 'A'.          00710062
007200     05  PC-PO-ACTIVE             PIC X(02)   VALUE 'AC'.         00720062
007300     05  PC-APPROVED              PIC X(02)   VALUE 'AP'.         00730062
007400     05  PC-CANCELLED             PIC X(02)   VALUE 'CA'.         00740062
007500     05  PC-COMPLETE              PIC X(02)   VALUE 'CM'.         00750062
007600     05  PC-A                     PIC X(01)   VALUE 'A'.          00760062
007700     05  PC-Y                     PIC X(1)    VALUE 'Y'.          00770062
007800     05  PC-24                    PIC 9(02)   VALUE 24.           00780062
007900     05  PC-59                    PIC 9(02)   VALUE 59.           00790062
008000     05  PC-MAX-RETRIES           PIC S9(04)  VALUE  +3           00800062
008100                                              COMP.               00810062
008200     05  PC-INTER-APPL-CODES.                                     00820062
008300         10  PC-INTER-APPL-CRIT-SPEC   PIC X(01)  VALUE '1'.      00830062
008400         10  PC-INTER-APPL-LIST        PIC X(01)  VALUE '2'.      00840062
008500     05  PC-VALID-VND-DT-RANGE    PIC 9(05)   VALUE 7.            00850062
008600     05  PC-TSYMSG-NUMBERS.                                       00860062
008700         10  PC-TSYMSG-00005      PIC  9(05)  VALUE  00005.       00870062
008800*   PRESS F2 TO CONFIRM                                           00880062
008900         10  PC-TSYMSG-00007      PIC  9(05)  VALUE  00007.       00890062
009000*   REQUIRED ENTRY                                                00900062
009100         10  PC-TSYMSG-00008      PIC  9(05)  VALUE  00008.       00910062
009200*   MUST BE NUMERIC                                               00920062
009300         10  PC-TSYMSG-00009      PIC  9(05)  VALUE  00009.       00930062
009400*   INVALID DATE                                                  00940062
009500         10  PC-TSYMSG-00034      PIC  9(05)  VALUE  00034.       00950062
009600*   ADD SUCCESSFUL                                                00960062
009700         10  PC-TSYMSG-00045      PIC  9(05)  VALUE  00045.       00970062
009800*   INVALID FUNCTION KEY                                          00980062
009900         10  PC-TSYMSG-00083      PIC  9(05)  VALUE  00083.       00990062
010000*   PURCHASE ORDER DOES NOT EXIST                                 01000062
010100         10  PC-TSYMSG-00148      PIC  9(05)  VALUE  00148.       01010062
010200*   DATA DOES NOT EXIST                                           01020062
010300         10  PC-TSYMSG-00461      PIC  9(05)  VALUE  00461.       01030062
010400*   PURCHASE ORDER NUMBER REQUIRED                                01040062
010500         10  PC-TSYMSG-00991      PIC  9(05)  VALUE  00991.       01050062
010600*   PLEASE ENTER THE FREIGHT BILL OR BILL OF LADING NUMBER        01060062
010700         10  PC-TSYMSG-00992      PIC  9(05)  VALUE  00992.       01070062
010800*   SHIPMENT EXIST WITH A STATUS OF &VAR                          01080062
010900         10  PC-TSYMSG-00993      PIC  9(05)  VALUE  00993.       01090062
011000*   THE FORECAST SHIPMENT UPDATE SCREEN MUST BE USED TO UPDATE    01100062
011100*   THIS INFO                                                     01110062
011200         10  PC-TSYMSG-00997      PIC  9(05)  VALUE  00997.       01120062
011300*   SCAC REQUIRED WHEN FREIGHT BILL ENTERED                       01130062
011400         10  PC-TSYMSG-00998      PIC  9(05)  VALUE  00998.       01140062
011500*   ADD REQUESTED BEFORE CONFIRM                                  01150062
011600         10  PC-TSYMSG-01003      PIC  9(05)  VALUE  01003.       01160062
011700*   INQUIRE MUST BE DONE BEFORE ADDING A NEW SHIPMENT             01170062
011800         10  PC-TSYMSG-01004      PIC  9(05)  VALUE  01004.       01180062
011900*   INVALID OPERATING UNIT/FACILITY ID ENTERED                    01190062
012000         10  PC-TSYMSG-01008      PIC  9(05)  VALUE  01008.       01200062
012100*   MULT SHIP EXIST FOR THIS BOL, F14 TO CREATE NEW OF F21 TO LIST01210062
012200         10  PC-TSYMSG-01009      PIC  9(05)  VALUE  01009.       01220062
012300*   PRESS F13 TO ADD PO TO THIS SHIPMENT OR F14 TO CREATE A NEW   01230062
012400*   SHIPMENT                                                      01240062
012500         10  PC-TSYMSG-01010      PIC  9(05)  VALUE  01010.       01250062
012600*   MULT SHIP EXIST FOR THIS FB, F14 TO CREATE NEW OF F21 TO LIST 01260062
012700         10  PC-TSYMSG-01019      PIC  9(05)  VALUE  01019.       01270062
012800*   SHIPMENT EXISTS UNDER OPER ID &VAR                            01280062
012900         10  PC-TSYMSG-01838      PIC  9(05)  VALUE  01838.       01290062
013000*   DATE OUTSIDE RECOMMENDED RANGE - PRESS F2 TO CONFIRM          01300062
013100                                                                  01310062
013200 01  PS-PROGRAM-SWITCHES.                                         01320062
013300     05  PS-ERROR-SW              PIC  X(01)  VALUE  'N'.         01330062
013400         88  PS-ERROR                         VALUE  'Y'.         01340062
013500         88  PS-NO-ERROR                      VALUE  'N'.         01350062
013600     05  PS-FIRST-TIME-SW         PIC  X(01)  VALUE  'N'.         01360062
013700         88  PS-FIRST-TIME                    VALUE  'Y'.         01370062
013800         88  PS-NOT-FIRST-TIME                VALUE  'N'.         01380062
013900     05  PS-INQ-BEF-ADD-SW        PIC  X(01)  VALUE  'N'.         01390062
014000         88  PS-INQ-BEF-ADD                   VALUE  'Y'.         01400062
014100         88  PS-INQ-OK                        VALUE  'N'.         01410062
014200     05  PS-MSG-SET-SW            PIC  X(01)  VALUE 'N'.          01420062
014300         88  PS-MSG-SET                       VALUE 'Y'.          01430062
014400         88  PS-MSG-NOT-SET                   VALUE 'N'.          01440062
014500     05  PS-DONE-SW               PIC  X(01)  VALUE 'N'.          01450062
014600         88  PS-DONE                          VALUE 'Y'.          01460062
014700         88  PS-NOT-DONE                      VALUE 'N'.          01470062
014800     05  PS-FOUND-SW              PIC  X(01)  VALUE ' '.          01480062
014900         88  PS-FOUND                         VALUE 'Y'.          01490062
015000         88  PS-NOT-FOUND                     VALUE 'N'.          01500062
015100     05  PS-SHIP-EXIST-SW         PIC  X(01)  VALUE 'N'.          01510062
015200         88  PS-SHIP-EXIST                    VALUE 'Y'.          01520062
015300         88  PS-NO-SHIP-EXIST                 VALUE 'N'.          01530062
015400     05  PS-DPT-NOT-FOUND-SW      PIC  X(01)  VALUE 'N'.          01540062
015500         88  PS-DPT-NOT-FOUND                 VALUE 'Y'.          01550062
015600         88  PS-DPT-FOUND                     VALUE 'N'.          01560062
015700     05  PS-NO-DISTRO-SW          PIC  X(01)  VALUE 'N'.          01570062
015800         88  PS-DISTRO                        VALUE 'Y'.          01580062
015900         88  PS-NO-DISTRO                     VALUE 'N'.          01590062
016000     05  PS-DISPLAY-DISTRO-SW     PIC  X(01)  VALUE 'N'.          01600062
016100         88  PS-DISPLAY-DISTRO-MSG            VALUE 'Y'.          01610062
016200         88  PS-DONT-DISPLAY-DISTRO-MSG       VALUE 'N'.          01620062
016300     05  PS-VALID-DATE-SW               PIC X(01)    VALUE 'N'.   01630062
016400         88  PS-VALID-DATE                           VALUE 'Y'.   01640062
016500         88  PS-INVALID-DATE                         VALUE 'N'.   01650062
016600     05  PS-VALID-ETA-DTE-SW            PIC X(01)    VALUE 'N'.   01660062
016700         88  PS-VALID-ETA-DTE                        VALUE 'Y'.   01670062
016800         88  PS-INVALID-ETA-DTE                      VALUE 'N'.   01680062
016900     05  PS-VALID-VND-DTE-SW            PIC X(01)    VALUE 'N'.   01690062
017000         88  PS-VALID-VND-DTE                        VALUE 'Y'.   01700062
017100         88  PS-INVALID-VND-DTE                      VALUE 'N'.   01710062
017200     05  PS-VALID-AUTH-DTE-SW           PIC X(01)    VALUE 'N'.   01720062
017300         88  PS-VALID-AUTH-DTE                       VALUE 'Y'.   01730062
017400         88  PS-INVALID-AUTH-DTE                     VALUE 'N'.   01740062
017500     05  PS-VALID-SCAC-SW               PIC X(01)    VALUE 'N'.   01750062
017600         88  PS-VALID-SCAC                           VALUE 'Y'.   01760062
017700         88  PS-INVALID-SCAC                         VALUE 'N'.   01770062
017800     05  PS-PO-INQUIRY-SW               PIC X(01)    VALUE 'N'.   01780062
017900         88  PS-PO-INQUIRY                           VALUE 'Y'.   01790062
018000         88  PS-NOT-PO-INQUIRY                       VALUE 'N'.   01800062
018100     05  PS-USE-TRIP-SW                 PIC X(01)    VALUE 'N'.   01810062
018200         88  PS-USE-TRIP                             VALUE 'Y'.   01820062
018300     05  PS-INSERT-INDICATORS-SW        PIC X(01)    VALUE ' '.   01830062
018400         88  PS-ADD-NEW-TRIP                         VALUE '1'.   01840062
018500         88  PS-LINK-SHIPMENT                        VALUE '2'.   01850062
018600         88  PS-ADD-NEW-TRAILER                      VALUE '3'.   01860062
018700         88  PS-LINK-TRIP                            VALUE '4'.   01870062
018800     05  PS-USE-VEHICLE-NBR-SW          PIC X(01)    VALUE ' '.   01880062
018900         88  PS-NULL-VEHICLE-NBR                     VALUE '1'.   01890062
019000     05  PS-TALLPLN-SW                  PIC  X(01)   VALUE 'N'.   01900062
019100         88  PS-TALLPLN-NOT-FOUND                    VALUE 'N'.   01910062
019200         88  PS-TALLPLN-FOUND                        VALUE 'Y'.   01920062
019300     05  PS-TALLPLN-EXIST-SW            PIC  X(01)   VALUE 'N'.   01930062
019400         88  PS-NO-TALLPLN-EXIST                     VALUE 'N'.   01940062
019500         88  PS-TALLPLN-EXIST                        VALUE 'Y'.   01950062
019600     05  PS-VALID-VND-DT-RANGE-SW       PIC X(01)    VALUE 'Y'.   01960062
019700         88  PS-VALID-VND-DT-RANGE                   VALUE 'Y'.   01970062
019800         88  PS-INVALID-VND-DT-RANGE                 VALUE 'N'.   01980062
019900     05  PS-VND-DT-MM-SW                PIC X(01)    VALUE 'N'.   01990062
020000         88  PS-VND-DT-MM-CHGD                       VALUE 'Y'.   02000062
020100         88  PS-VND-DT-MM-NOT-CHGD                   VALUE 'N'.   02010062
020200     05  PS-VND-DT-DD-SW                PIC X(01)    VALUE 'N'.   02020062
020300         88  PS-VND-DT-DD-CHGD                       VALUE 'Y'.   02030062
020400         88  PS-VND-DT-DD-NOT-CHGD                   VALUE 'N'.   02040062
020500     05  PS-VND-DT-YY-SW                PIC X(01)    VALUE 'N'.   02050062
020600         88  PS-VND-DT-YY-CHGD                       VALUE 'Y'.   02060062
020700         88  PS-VND-DT-YY-NOT-CHGD                   VALUE 'N'.   02070062
020800                                                                  02080062
020900*                                                                 02090062
021000 01  PV-PROGRAM-VARIABLES.                                        02100062
021100     05  PV-RETRY-COUNTER         PIC S9(04)  VALUE +0            02110062
021200                                              COMP SYNC.          02120062
021300     05  PV-ABSTIME               PIC S9(15)  COMP.               02130062
021400     05  PV-CURRENT-DATE          PIC  9(06).                     02140062
021500     05  PV-CURRENT-TIME          PIC  9(06).                     02150062
021600     05  PV-CURR-TRIP-ID          PIC S9(09)  VALUE +0            02160062
021700                                              COMP.               02170062
021800     05  PV-CURR-SHIPT-ID         PIC S9(09)  VALUE +0            02180062
021900                                              COMP.               02190062
022000     05  PV-VHTRIP-COUNT          PIC S9(09)  VALUE +0            02200062
022100                                              COMP-3.             02210062
022200     05  PV-SHIPMT-COUNT          PIC S9(09)  VALUE +0            02220062
022300                                              COMP-3.             02230062
022400     05  PV-VHTRIP-TRIP-ID        PIC  S9(9) COMP.                02240062
022500     05  PV-TEMP-SHIPT-ID         PIC  S9(9) COMP.                02250062
022600     05  PV-TEMP-TMST.                                            02260062
022700         10  PV-TMST-CCYY             PIC X(04).                  02270062
022800         10  FILLER                   PIC X(01).                  02280062
022900         10  PV-TMST-MM               PIC X(02).                  02290062
023000         10  FILLER                   PIC X(01).                  02300062
023100         10  PV-TMST-DD               PIC X(02).                  02310062
023200         10  FILLER                   PIC X(01).                  02320062
023300         10  PV-TMST-HH               PIC X(02).                  02330062
023400         10  FILLER                   PIC X(01).                  02340062
023500         10  PV-TMST-MN               PIC X(02).                  02350062
023600         10  FILLER                   PIC X(01).                  02360062
023700         10  PV-TMST-SEC              PIC X(02).                  02370062
023800         10  FILLER                   PIC X(07).                  02380062
023900     05  PV-DATE                      PIC X(10).                  02390062
024000     05  PV-TEMP-DATE.                                            02400062
024100         10  PV-DATE-CCYY             PIC X(04).                  02410062
024200         10  FILLER                   PIC X(01).                  02420062
024300         10  PV-DATE-MM               PIC X(02).                  02430062
024400         10  FILLER                   PIC X(01).                  02440062
024500         10  PV-DATE-DD               PIC X(02).                  02450062
024600     05  PV-DB2-DATE.                                             02460062
024700         10  PV-DB2-CCYY              PIC X(04).                  02470062
024800         10  FILLER                   PIC X(01) VALUE '-'.        02480062
024900         10  PV-DB2-MM                PIC X(02).                  02490062
025000         10  FILLER                   PIC X(01) VALUE '-'.        02500062
025100         10  PV-DB2-DD                PIC X(02).                  02510062
025200     05  PV-WORK-DATE.                                            02520062
025300         10  PV-WK-DTE-MM             PIC X(02).                  02530062
025400         10  FILLER                   PIC X(01) VALUE '/'.        02540062
025500         10  PV-WK-DTE-DD             PIC X(02).                  02550062
025600         10  FILLER                   PIC X(01) VALUE '/'.        02560062
025700         10  PV-WK-DTE-YY             PIC X(04).                  02570062
025800     05  PV-WORK-DATE2.                                           02580062
025900         10  PV-WK2-DTE-MM            PIC X(02).                  02590062
026000         10  PV-WK2-DTE-DD            PIC X(02).                  02600062
026100         10  PV-WK2-DTE-YY            PIC X(04).                  02610062
026200     05  PV-TEMP-YYMM.                                            02620062
026300         10  PV-TEMP-YY               PIC X(02).                  02630062
026400         10  PV-TEMP-MM               PIC X(02).                  02640062
026500     05  PV-VEND-SHIP-DTE.                                        02650062
026600         10  PV-VEND-SHIP-CCYY        PIC X(04).                  02660062
026700         10  PV-VEND-SHIP-MM          PIC X(02).                  02670062
026800         10  PV-VEND-SHIP-DD          PIC X(02).                  02680062
026900     05  PV-DONT-SHIP-BEF-DTE.                                    02690062
027000         10  PV-DONT-SHIP-CCYY        PIC X(04).                  02700062
027100         10  PV-DONT-SHIP-MM          PIC X(02).                  02710062
027200         10  PV-DONT-SHIP-DD          PIC X(02).                  02720062
027300     05  PV-CAN-IFNOT-SHIP-DTE.                                   02730062
027400         10  PV-CAN-IFNOT-CCYY        PIC X(04).                  02740062
027500         10  PV-CAN-IFNOT-MM          PIC X(02).                  02750062
027600         10  PV-CAN-IFNOT-DD          PIC X(02).                  02760062
027700     05  PV-EXT-CAN-DTE.                                          02770062
027800         10  PV-EXT-CAN-CCYY          PIC X(04).                  02780062
027900         10  PV-EXT-CAN-MM            PIC X(02).                  02790062
028000         10  PV-EXT-CAN-DD            PIC X(02).                  02800062
028100     05  PV-W-FIRST-NAME.                                         02810062
028200         10  PV-WORKER-FIR-NAME       PIC X(10).                  02820062
028300         10  FILLER                   PIC X(02).                  02830062
028400     05  PV-W-LAST-NAME.                                          02840062
028500         10  PV-WORKER-LAST-NAME      PIC X(10).                  02850062
028600         10  FILLER                   PIC X(08).                  02860062
028700     05  PV-WORKER-NAME.                                          02870062
028800         10  PV-WORKER-FIRST          PIC X(10).                  02880062
028900         10  PV-WORKER-LAST           PIC X(10).                  02890062
029000     05  PV-INPUT-DATE.                                           02900062
029100         10  PV-INPUT-DATE-MM           PIC 9(2)     VALUE ZEROES.02910062
029200         10  PV-INPUT-DATE-DD           PIC 9(2)     VALUE ZEROES.02920062
029300         10  PV-INPUT-DATE-CCYY         PIC 9(4)     VALUE ZEROES.02930062
029400         10  FILLER REDEFINES PV-INPUT-DATE-CCYY.                 02940062
029500             15  PV-INPUT-DATE-CC       PIC 9(2).                 02950062
029600             15  PV-INPUT-DATE-YY       PIC 9(2).                 02960062
029700     05  PV-VALID-DATE.                                           02970062
029800         10  PV-VALID-DATE-MM           PIC X(2)     VALUE SPACES.02980062
029900         10  PV-VALID-DATE-DD           PIC X(2)     VALUE SPACES.02990062
030000         10  PV-VALID-DATE-CCYY         PIC X(4)     VALUE SPACES.03000062
030100         10  FILLER REDEFINES PV-VALID-DATE-CCYY.                 03010062
030200             15  PV-VALID-DATE-CC       PIC X(2).                 03020062
030300             15  PV-VALID-DATE-YY       PIC X(2).                 03030062
030400     05  PV-OPER-UNT-ID                 PIC S9(04)   VALUE ZEROS  03040062
030500                                                     COMP.        03050062
030600     05  PV-FCLTY-ID                    PIC S9(04)   VALUE ZEROS  03060062
030700                                                     COMP.        03070062
030800     05  PV-DISPLAY-LOCATION.                                     03080062
030900         10  PV-DISPLAY-OPER-ID         PIC X(04).                03090062
031000         10  FILLER                     PIC X(01) VALUE '-'.      03100062
031100         10  PV-DISPLAY-FCLTY-ID        PIC X(04).                03110062
031200     05  PV-VALID-ETA-DTE               PIC X(8)     VALUE SPACES.03120062
031300     05  PV-VALID-ETA-DTE-2             PIC X(8)     VALUE SPACES.03130062
031400     05  PV-MESSAGE.                                              03140062
031500         10  PV-MESSAGE1                PIC X(10).                03150062
031600         10  PV-FILLER                  PIC X(01).                03160062
031700         10  PV-MESSAGE2                PIC X(10).                03170062
031800         10  PV-FILLER                  PIC X(01).                03180062
031900         10  PV-MESSAGE3                PIC X(10).                03190062
032000     05  PV-DB2-CURRENT-DATE            PIC X(10).                03200062
032100     05  PV-DB2-CURRENT-DATE-M7DD       PIC X(10).                03210062
032200     05  PV-VND-SHIP-DATE-FMT.                                    03220062
032300         10  PV-VND-SHIP-CCYY         PIC X(04).                  03230062
032400         10  FILLER                   PIC X(01)  VALUE '-'.       03240062
032500         10  PV-VND-SHIP-MM           PIC X(02).                  03250062
032600         10  FILLER                   PIC X(01)  VALUE '-'.       03260062
032700         10  PV-VND-SHIP-DD           PIC X(02).                  03270062
032800     05  PV-TEMP-FIELDS.                                          03280062
032810*CLP 10/29/14                                                     03281074
032900         10  PV-TEMP-PO-NBR           PIC 9(08)  VALUE ZEROS.     03290074
033000         10  PV-TEMP-OPER-UNT         PIC 9(04)  VALUE ZEROS.     03300062
033100         10  PV-TEMP-FCLTY            PIC 9(04)  VALUE ZEROS.     03310062
033200         10  PV-TEMP-PO-CARTON-CNT    PIC 9(04)  VALUE ZEROS.     03320062
033300         10  PV-TEMP-FB-CARTON-CNT    PIC 9(04)  VALUE ZEROS.     03330062
033400                                                                  03340062
033500 EJECT                                                            03350062
033600*----------------------------------------------------------------*03360062
033700*    CALLING PARAMETERS FOR LOCKING MODULE DPKCS044              *03370062
033800*----------------------------------------------------------------*03380062
033900                                                                  03390062
034000     COPY DPWS044.                                                03400062
034100 EJECT                                                            03410062
034200*----------------------------------------------------------------*03420062
034300*    MAP LAYOUT                                                  *03430062
034400*----------------------------------------------------------------*03440062
034500                                                                  03450062
034600     COPY TRKM125.                                                03460062
034700                                                                  03470062
034800                                                                  03480062
034900     EJECT                                                        03490062
035000*----------------------------------------------------------------*03500062
035100*    ATTRIBUTE SETTINGS COPYBOOK.                                *03510062
035200*----------------------------------------------------------------*03520062
035300                                                                  03530062
035400     COPY DPWS015.                                                03540062
035500                                                                  03550062
035600*----------------------------------------------------------------*03560062
035700*    FUNCTION KEYS COPYBOOK                                      *03570062
035800*----------------------------------------------------------------*03580062
035900                                                                  03590062
036000     COPY DPWS016.                                                03600062
036100 EJECT                                                            03610062
036200******************************************************************03620062
036300** THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT    **03630062
036400** SUB-ROUTINE (DPKUT100).                                      **03640062
036500******************************************************************03650062
036600     COPY DPWS010I.                                               03660062
036700 EJECT                                                            03670062
036800*----------------------------------------------------------------*03680062
036900*  COPYBOOK FOR RANDOM NUMBER GENERATOR DPKUT902                 *03690079
037000*----------------------------------------------------------------*03700062
037100     COPY DPWS902.                                                03710079
037200                                                                  03720062
037300***************************************************************** 03730062
037400*    COPY BOOKS FOR THE CALENDAR ROUTINE - DPKUT500               03740062
037500***************************************************************** 03750062
037600                                                                  03760062
037700     COPY DPWS500.                                                03770062
037800                                                                  03780062
037900 EJECT                                                            03790062
038000***************************************************************** 03800062
038100*    COPY BOOKS FOR THE VALIDATION ROUTINE FOR THE FREIGHT BILL   03810062
038200*    BILL OF LADING, AND VEHICLE NUMBER                           03820062
038300***************************************************************** 03830062
038400     COPY RCWS023.                                                03840062
038500                                                                  03850062
038600 EJECT                                                            03860062
038700***************************************************************** 03870062
CICS  *    PARAMETERS FOR CALLING THE CICS ARCHITECTURE API.            03880085
038900***************************************************************** 03890062
039000     COPY DPWS030.                                                03900062
CICS       COPY DPWS930.                                                03901085
039100 EJECT                                                            03910062
039200***************************************************************** 03920062
039300*    STANDARD COMMAREA.                                           03930062
039400***************************************************************** 03940062
039500                                                                  03950062
039600     COPY DPWS020.                                                03960062
039700     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                03970062
039800                                                                  03980062
039900***************************************************************** 03990062
040000*    INTER-APPLICATION COMMAREA.                                  04000062
040100***************************************************************** 04010062
040200                                                                  04020062
040300         10  INTER-APPL-COMM-AREA PIC X(200).                     04030062
040400     COPY TRWS001.                                                04040062
040500     COPY DPWS058.                                                04050062
040600***************************************************************** 04060062
040700*    SPECIFIC COMMMAREA FOR TRKCS125.                             04070062
040800***************************************************************** 04080062
040900         10  ASC-SPECIFIC-COMMAREA.                               04090062
041000             15  ASC-INT-APPL-FORMAT-IND     PIC X(01).           04100062
041100             15  ASC-NEW-SHIPMENT-SW         PIC  X(01).          04110062
041200                 88  ASC-NEW-SHIPMENT                   VALUE 'Y'.04120062
041300                 88  ASC-SAME-SHIPMENT                  VALUE 'N'.04130062
041400             15  ASC-MULTMATCH-SW            PIC  X(01).          04140062
041500                 88  ASC-MULTMATCH                      VALUE 'Y'.04150062
041600                 88  ASC-OK-MATCH                       VALUE 'N'.04160062
041700             15  ASC-INVALID-PO-STATUS-SW    PIC  X(01).          04170062
041800                 88  ASC-INVALID-PO-STATUS              VALUE 'Y'.04180062
041900                 88  ASC-VALID-PO-STATUS                VALUE 'N'.04190062
042000             15  ASC-SHIPT-STATUS-OK-SW    PIC X(01).             04200062
042100                 88  ASC-SHIPT-STATUS-OK                VALUE 'Y'.04210062
042200                 88  ASC-SHIPT-STATUS-NOTOK             VALUE 'N'.04220062
042300             15  ASC-ADD-SHIPMENT-SW       PIC X(01).             04230062
042400                 88  ASC-ADD-SHIPMENT                   VALUE '1'.04240062
042500                 88  ASC-SHIPMENT-EXIST                 VALUE '2'.04250062
042600                 88  ASC-MULT-SHIP-EXIST                VALUE '3'.04260062
042700             15  ASC-UPD-PRO-SW            PIC X(01).             04270062
042800                 88  ASC-UPD-PRO                        VALUE 'Y'.04280062
042900                 88  ASC-NO-UPD-PRO                     VALUE 'N'.04290062
042910* 2011-12-14 CHRISTINE TWIEHAUS WR40574 START                    *04291062
042911             15  ASC-UPD-CAN-SW            PIC X(01).             04291162
042912                 88  ASC-UPD-CAN                        VALUE 'Y'.04291262
042913                 88  ASC-NO-UPD-CAN                     VALUE 'N'.04291362
042930* 2011-12-14 CHRISTINE TWIEHAUS WR40574 END                      *04293062
043000             15  ASC-UPD-BOL-SW            PIC X(01).             04300062
043100                 88  ASC-UPD-BOL                        VALUE 'Y'.04310062
043200                 88  ASC-NO-UPD-BOL                     VALUE 'N'.04320062
043300             15  ASC-ENT-ID                  PIC S9(9) COMP.      04330062
043400             15  ASC-TRIP-STATUS-CDE         PIC X(02).           04340062
043500             15  ASC-TRIP-ID                 PIC S9(9) COMP.      04350062
043600             15  ASC-SHIPT-ID                PIC S9(9) COMP.      04360062
043700             15  ASC-SCREEN-FIELDS.                               04370062
043710*CLP 10/29/14                                                     04371074
043800                 20  ASC-PO-NBR              PIC X(08).           04380074
043900                 20  ASC-PO-NBR-N REDEFINES                       04390062
044000                     ASC-PO-NBR              PIC 9(08).           04400074
044100                 20  ASC-NO-DISTRO-MSG       PIC X(09).           04410062
044200                 20  ASC-PO-CARTON-CNT       PIC X(04).           04420062
044300                 20  ASC-PO-CARTON-CNT-N REDEFINES                04430062
044400                     ASC-PO-CARTON-CNT       PIC 9(04).           04440062
044500                 20  ASC-OPER-UNT-ID         PIC X(04).           04450062
044600                 20  ASC-OPER-UNT-ID-N REDEFINES                  04460062
044700                     ASC-OPER-UNT-ID         PIC 9(04).           04470062
044800                 20  ASC-FCLTY-ID            PIC X(04).           04480062
044900                 20  ASC-FCLTY-ID-N    REDEFINES                  04490062
045000                     ASC-FCLTY-ID            PIC 9(04).           04500062
045100                 20  ASC-FCLTY-NME           PIC X(25).           04510062
045200                 20  ASC-PRO-NBR             PIC X(22).           04520062
045300                 20  ASC-COMPLETE-PRO-NBR    PIC X(22).           04530062
045400                 20  ASC-BOL-NBR             PIC X(30).           04540062
045500                 20  ASC-COMPLETE-BOL-NBR    PIC X(30).           04550062
045600                 20  ASC-FB-CARTON-CNT       PIC X(05).           04560062
045700                 20  ASC-FB-CARTON-CNT-N REDEFINES                04570062
045800                     ASC-FB-CARTON-CNT       PIC 9(05).           04580062
045900                 20  ASC-VEND-SHIP-DTE.                           04590062
046000                     25  ASC-VEND-SHIP-MM    PIC X(02).           04600062
046100                     25  ASC-VEND-SHIP-DD    PIC X(02).           04610062
046200                     25  ASC-VEND-SHIP-CCYY.                      04620062
046300                         30 ASC-VEND-SHIP-CC PIC X(02).           04630062
046400                         30 ASC-VEND-SHIP-YY PIC X(02).           04640062
046500                 20  ASC-AUTH-NBR            PIC X(07).           04650062
046600                 20  ASC-AUTH-DTE.                                04660062
046700                     25  ASC-AUTH-MM         PIC X(02).           04670062
046800                     25  ASC-AUTH-DD         PIC X(02).           04680062
046900                     25  ASC-AUTH-CCYY.                           04690062
047000                         30 ASC-AUTH-CC      PIC X(02).           04700062
047100                         30 ASC-AUTH-YY      PIC X(02).           04710062
047200                 20  ASC-PRO-SCAC-ID         PIC X(04).           04720062
047300                 20  ASC-PRO-SCAC-DESC       PIC X(25).           04730062
047400                 20  ASC-ORIG-SCAC-ID        PIC X(04).           04740062
047500                 20  ASC-ORIG-SCAC-DESC      PIC X(25).           04750062
047600                 20  ASC-VEH-NBR             PIC X(10).           04760062
047610* 2011-12-14 CHRISTINE TWIEHAUS WR40574 START                    *04761062
047611                 20  ASC-CAN                 PIC X(30).           04761162
047612                 20  ASC-COMPLETE-CAN        PIC X(30).           04761262
047630* 2011-12-14 CHRISTINE TWIEHAUS WR40574 END                      *04763062
047700                 20  ASC-ETA-DTE.                                 04770062
047800                     25  ASC-ETA-MM          PIC X(02).           04780062
047900                     25  ASC-ETA-DD          PIC X(02).           04790062
048000                     25  ASC-ETA-CCYY.                            04800062
048100                         30 ASC-ETA-CC       PIC X(02).           04810062
048200                         30 ASC-ETA-YY       PIC X(02).           04820062
048300                 20  ASC-ETA-TIME.                                04830062
048400                     25  ASC-ETA-TIME-HH     PIC X(02).           04840062
048500                     25  ASC-ETA-TIME-HH-N REDEFINES              04850062
048600                         ASC-ETA-TIME-HH     PIC 9(02).           04860062
048700                     25  ASC-ETA-TIME-MN     PIC X(02).           04870062
048800                     25  ASC-ETA-TIME-MN-N REDEFINES              04880062
048900                         ASC-ETA-TIME-MN     PIC 9(02).           04890062
049000                 20  ASC-PO-STATUS           PIC X(02).           04900062
049100                 20  ASC-PO-STATUS-DESC      PIC X(20).           04910062
049200                 20  ASC-DONT-SHIP-BEF-DTE   PIC X(10).           04920062
049300                 20  ASC-CANCEL-DTE          PIC X(10).           04930062
049400                 20  ASC-EXT-CAN-DTE         PIC X(10).           04940062
049500                 20  ASC-DEPT-NBR            PIC X(04).           04950062
049600                 20  ASC-DEPT-NBR-N REDEFINES                     04960062
049700                     ASC-DEPT-NBR            PIC 9(04).           04970062
049800                 20  ASC-DEPT-DESC           PIC X(25).           04980062
049900                 20  ASC-BUYER-NME           PIC X(25).           04990062
050000             15  ASC-PREV-SCREEN-FIELDS.                          05000062
050100                 20  ASC-PREV-PRO-NBR        PIC X(22).           05010062
050200                 20  ASC-ORIG-PRO-NBR        PIC X(22).           05020062
050300                 20  ASC-PREV-COMP-PRO-NBR   PIC X(22).           05030062
050400                 20  ASC-ORIG-COMP-PRO-NBR   PIC X(22).           05040062
050410* 2011-12-14 CHRISTINE TWIEHAUS WR40574 START                    *05041062
050420                 20  ASC-PREV-CAN            PIC X(30).           05042062
050430                 20  ASC-ORIG-CAN            PIC X(30).           05043062
050440                 20  ASC-PREV-COMP-CAN       PIC X(30).           05044062
050450                 20  ASC-ORIG-COMP-CAN       PIC X(30).           05045062
050460* 2011-12-14 CHRISTINE TWIEHAUS WR40574 START                    *05046062
050500                 20  ASC-PREV-BOL-NBR        PIC X(30).           05050062
050600                 20  ASC-ORIG-BOL-NBR        PIC X(30).           05060062
050700                 20  ASC-PREV-COMP-BOL-NBR   PIC X(30).           05070062
050800                 20  ASC-ORIG-COMP-BOL-NBR   PIC X(30).           05080062
050900                 20  ASC-PREV-PRO-SCAC-ID    PIC X(04).           05090062
051000             15  ASC-VND-DT-EDIT-FIELDS.                          05100062
051100                 20  ASC-VND-DT-F2-REQUIRED-SW    PIC X(01).      05110062
051200                     88  ASC-VND-DT-F2-REQUIRED       VALUE 'Y'.  05120062
051300                     88  ASC-VND-DT-F2-NOT-REQUIRED   VALUE 'N'.  05130062
051400                 20  ASC-VND-DT-CHGD-SW           PIC X(01).      05140062
051500                     88  ASC-VND-DT-CHGD              VALUE 'Y'.  05150062
051600                     88  ASC-VND-DT-NOT-CHGD          VALUE 'N'.  05160062
051700                 20  ASC-VND-DT-CHG-PENDING-SW    PIC X(01).      05170062
051800                     88  ASC-VND-DT-CHG-PENDING       VALUE 'Y'.  05180062
051900                     88  ASC-VND-DT-CHG-NOT-PENDING   VALUE 'N'.  05190062
052000                 20  ASC-WHICH-ADD-SW             PIC X(01).      05200062
052100********************* FUNC-01                                     05210062
052200                     88  ASC-ADD                      VALUE 'A'.  05220062
052300********************* FUNC-02 --ADD ORIGINAL SCAC                 05230062
052400                     88  ASC-ADD-ORIG-SCAC            VALUE 'O'.  05240062
052500                 20  ASC-VEND-SHIP-DATE-OLD.                      05250062
052600                     25  ASC-VEND-SHIP-MM-OLD     PIC X(02).      05260062
052700                     25  ASC-VEND-SHIP-DD-OLD     PIC X(02).      05270062
052800                     25  ASC-VEND-SHIP-CCYY-OLD.                  05280062
052900                         30  ASC-VEND-SHIP-CC-OLD PIC X(02).      05290062
053000                         30  ASC-VEND-SHIP-YY-OLD PIC X(02).      05300062
053100*        10  FILLER                          PIC  X(2787).        05310062
053200     EJECT                                                        05320062
053300*----------------------------------------------------------------*05330062
053400*    ABEND PROCESSING COPYBOOK.                                  *05340062
053500*----------------------------------------------------------------*05350062
053600                                                                  05360062
053700     COPY DPWS013.                                                05370062
053800                                                                  05380062
053900*    DB2 AREA FOR TSYMSG  (SYSTEM MESSAGE - SHORT MESSAGE)        05390062
054000                                                                  05400062
054100     EXEC SQL                                                     05410062
054200          INCLUDE TSYMSG                                          05420062
054300     END-EXEC.                                                    05430062
054400                                                                  05440062
054500*    DB2 AREA FOR TAPLSYS (APPLICATION SYSTEM MASTER)             05450062
054600                                                                  05460062
054700     EXEC SQL                                                     05470062
054800          INCLUDE TAPLSYS                                         05480062
054900     END-EXEC.                                                    05490062
055000                                                                  05500062
055100*    DB2 AREA FOR COMMUNICATIONS                                  05510062
055200                                                                  05520062
055300     EXEC SQL                                                     05530062
055400          INCLUDE SQLCA                                           05540062
055500     END-EXEC.                                                    05550062
055600                                                                  05560062
055700*    DB2 AREA FOR SHIPMENT TABLE                                  05570062
055800                                                                  05580062
055900     EXEC SQL                                                     05590062
056000          INCLUDE TSHIPMT                                         05600062
056100     END-EXEC.                                                    05610062
056200                                                                  05620062
056300*    DB2 AREA FOR PO ASSOCIATION TABLE                            05630062
056400                                                                  05640062
056500     EXEC SQL                                                     05650062
056600          INCLUDE TSHPTPO                                         05660062
056700     END-EXEC.                                                    05670062
056800                                                                  05680062
056900*    DB2 AREA FOR TRIP TABLE                                      05690062
057000                                                                  05700062
057100     EXEC SQL                                                     05710062
057200          INCLUDE TVHTRIP                                         05720062
057300     END-EXEC.                                                    05730062
057400                                                                  05740062
057500*    DB2 AREA FOR PLANNED SHIPMENT TABLE                          05750062
057600                                                                  05760062
057700     EXEC SQL                                                     05770062
057800          INCLUDE TPLNSHP                                         05780062
057900     END-EXEC.                                                    05790062
058000                                                                  05800062
058100*    DB2 AREA FOR PURCHASE HEADER TABLE                           05810062
058200                                                                  05820062
058300     EXEC SQL                                                     05830062
058400          INCLUDE TPURCHS                                         05840062
058500     END-EXEC.                                                    05850062
058600                                                                  05860062
058700*    DB2 AREA FOR VEHICLE TABLE                                   05870062
058800                                                                  05880062
058900     EXEC SQL                                                     05890062
059000          INCLUDE TVEHICL                                         05900062
059100     END-EXEC.                                                    05910062
059200                                                                  05920062
059300*    DB2 AREA FOR VEHICLE AUDIT TRAIL                             05930062
059400                                                                  05940062
059500     EXEC SQL                                                     05950062
059600          INCLUDE TAUVHCL                                         05960062
059700     END-EXEC.                                                    05970062
059800                                                                  05980062
059900*    DB2 AREA FOR TRIP AUDIT TRAIL                                05990062
060000                                                                  06000062
060100     EXEC SQL                                                     06010062
060200          INCLUDE TAUTRIP                                         06020062
060300     END-EXEC.                                                    06030062
060400                                                                  06040062
060500*    DB2 AREA FOR PO ASSOCIATION AUDIT TRAIL                      06050062
060600                                                                  06060062
060700     EXEC SQL                                                     06070062
060800          INCLUDE TAUSHPO                                         06080062
060900     END-EXEC.                                                    06090062
061000                                                                  06100062
061100*    DB2 AREA FOR SHIPMENT AUDIT TRAIL                            06110062
061200                                                                  06120062
061300     EXEC SQL                                                     06130062
061400          INCLUDE TAUSHIP                                         06140062
061500     END-EXEC.                                                    06150062
061600                                                                  06160062
061700*    DB2 AREA FOR VENDOR NAME                                     06170062
061800                                                                  06180062
061900     EXEC SQL                                                     06190062
062000          INCLUDE TENTNME                                         06200062
062100     END-EXEC.                                                    06210062
062200                                                                  06220062
062300*    DB2 AREA FOR TRIP STATUS                                     06230062
062400                                                                  06240062
062500     EXEC SQL                                                     06250062
062600          INCLUDE TTRIPST                                         06260062
062700     END-EXEC.                                                    06270062
062800                                                                  06280062
062900*    DB2 AREA FOR SHIPMENT STATUS                                 06290062
063000                                                                  06300062
063100     EXEC SQL                                                     06310062
063200          INCLUDE TSHIPST                                         06320062
063300     END-EXEC.                                                    06330062
063400                                                                  06340062
063500*    DB2 AREA FOR PO LINE ITEM TABLE                              06350062
063600                                                                  06360062
063700     EXEC SQL                                                     06370062
063800          INCLUDE TPURITM                                         06380062
063900     END-EXEC.                                                    06390062
064000                                                                  06400062
064100*    DB2 AREA FOR DC ALLOC SPLIT TABLE                            06410062
064200                                                                  06420062
064300     EXEC SQL                                                     06430062
064400          INCLUDE TALLPLN                                         06440062
064500     END-EXEC.                                                    06450062
064600                                                                  06460062
064700*    DB2 AREA FOR STORE ALLOCATION PLAN TABLE                     06470062
064800                                                                  06480062
064900     EXEC SQL                                                     06490062
065000          INCLUDE TMESTDS                                         06500062
065100     END-EXEC.                                                    06510062
065200                                                                  06520062
065300*    DB2 AREA FOR MERCHANDISE AREA                                06530062
065400                                                                  06540062
065500     EXEC SQL                                                     06550062
065600          INCLUDE TMDSEAR                                         06560062
065700     END-EXEC.                                                    06570062
065800                                                                  06580062
065900*    DB2 AREA FOR RESPONSIBILITY AREA                             06590062
066000                                                                  06600062
066100     EXEC SQL                                                     06610062
066200          INCLUDE TRSPBAR                                         06620062
066300     END-EXEC.                                                    06630062
066400                                                                  06640062
066500*    DB2 AREA FOR THE STATUS CODE DESCRIPTIONS                    06650062
066600                                                                  06660062
066700     EXEC SQL                                                     06670062
066800          INCLUDE TSTATCD                                         06680062
066900     END-EXEC.                                                    06690062
067000                                                                  06700062
067100*    DB2 AREA FOR THE EXTERMAL ENTERPRISE TABLE                   06710062
067200                                                                  06720062
067300     EXEC SQL                                                     06730062
067400          INCLUDE TEXTENT                                         06740062
067500     END-EXEC.                                                    06750062
067600                                                                  06760062
067700*    DB2 AREA FOR THE TRIP STATUS TABLE                           06770062
067800                                                                  06780062
067900     EXEC SQL                                                     06790062
068000          INCLUDE TTRSTYP                                         06800062
068100     END-EXEC.                                                    06810062
068200                                                                  06820062
068300*    DB2 AREA FOR THE TRIP STATUS TABLE                           06830062
068400     EXEC SQL                                                     06840062
068500          INCLUDE TFACLTY                                         06850062
068600     END-EXEC.                                                    06860062
068700                                                                  06870062
068800 EJECT                                                            06880062
068900*    CURSOR USED TO DETERMINE IF THE 'NO DISTRO' MESSAGE SHOULD BE06890062
069000*    DISPLAYED.                                                   06900062
069100                                                                  06910062
069200     EXEC SQL                                                     06920062
069300          DECLARE PO_CSR CURSOR FOR                               06930062
069400            SELECT DISTINCT(B.PO_LNE_NBR)                         06940062
069500            FROM   TPURCHS A                                      06950062
069600                  ,TPURITM B                                      06960062
069700            WHERE  A.PO_NBR = B.PO_NBR                            06970062
069800            AND    A.PO_NBR = :DK-PO-NBR                          06980062
069900            AND    A.VER_STATUS_CDE = B.VER_STATUS_CDE            06990062
070000            AND    A.VER_STATUS_CDE = :PC-ACTIVE                  07000062
070100     END-EXEC.                                                    07010062
070200 EJECT                                                            07020062
070300 LINKAGE SECTION.                                                 07030062
070400                                                                  07040062
070500 01  DFHCOMMAREA.                                                 07050062
070600     05  FILLER                         OCCURS  1 TO 4072 TIMES   07060062
070700                                        DEPENDING ON EIBCALEN.    07070062
070800         10  FILLER                     PIC  X(01).               07080062
070900                                                                  07090062
071000                                                                  07100062
071100 PROCEDURE DIVISION.                                              07110062
071200***************************************************************** 07120062
071300** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** 07130062
071400** THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  ** 07140062
071500** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            ** 07150062
071600**                                                             ** 07160062
071700** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  ** 07170062
071800** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       ** 07180062
071900***************************************************************** 07190062
072000 0000-MAIN-MODULE.                                                07200062
072100     INITIALIZE DP030-CICS-API-FIELDS.                            07210062
072200     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       07220062
072300     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          07230062
072400     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         07240062
072500     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       07250062
072600     MOVE LENGTH OF TR125AI        TO DP030-MAP-LENGTH (1).       07260062
072700     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     07270062
072800     PERFORM 0001-CALL-CICS-ARCH-API.                             07280062
072900*                                                                 07290062
073000     PERFORM 1000-CONTROL-PROCESSING                              07300062
073100*                                                                 07310062
073200     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     07320062
073300     PERFORM 0001-CALL-CICS-ARCH-API.                             07330062
073400                                                                  07340062
073500 0001-CALL-CICS-ARCH-API.                                         07350062
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      07360085
073700                                    DFHCOMMAREA                   07370085
073800                                    DP030-CICS-API-FIELDS         07380085
073900                                    DP020-STANDARD-COMMAREA       07390085
074000                                    TR125AI.                      07400085
074100*                                                                 07410062
074200     IF  DP030-RC-CALL-SUCCESSFUL                                 07420062
074300         CONTINUE                                                 07430062
074400     ELSE                                                         07440062
074500         SET DP013-NO-ROLLBACK                                    07450062
074600             DP013-XCTL-DISPLAY-RESTART                           07460062
074700             DP013-CICS-ABEND      TO TRUE                        07470062
074800         MOVE 'BEFORE 0000-MAIN-MODULE'                           07480062
074900                                   TO DP013-PARAGRAPH             07490062
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O07500085
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      07510085
075200         MOVE DP030-RETURN-CODE                                   07520062
075300                                   TO DP013-MESSAGE-TEXT (3)      07530062
075400         PERFORM DP013-0000-PROCESS-ABEND                         07540062
075500     END-IF.                                                      07550062
075600 EJECT                                                            07560062
075700*----------------------------------------------------------------*07570062
075800*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *07580062
075900*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *07590062
076000*----------------------------------------------------------------*07600062
076100                                                                  07610062
076200 1000-CONTROL-PROCESSING.                                         07620062
076300                                                                  07630062
076400     EVALUATE TRUE                                                07640062
076500         WHEN DP020-NEXT-ACT-INITIAL                              07650062
076600             INITIALIZE ASC-SPECIFIC-COMMAREA                     07660062
076700             SET ASC-SHIPMENT-EXIST                               07670062
076800                 PS-PO-INQUIRY  TO TRUE                           07680062
076900             PERFORM 1100-PROCESS-INTER-APPL-COMM                 07690062
077000             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   07700062
077100             PERFORM 4000-BUILD-INITIAL-PANEL                     07710062
077200                                                                  07720062
077300         WHEN DP020-NEXT-ACT-READ-MAP                             07730062
077400             PERFORM 2000-PROCESS-PANEL                           07740062
077500                                                                  07750062
077600         WHEN DP020-NEXT-ACT-RETURN                               07760062
077700             IF DP020-INT-APPL-FORMAT-IND = PC-INTER-APPL-LIST    07770062
077800                MOVE TR001-PRO-NBR TO ASC-COMPLETE-PRO-NBR        07780062
077900                MOVE TR001-BOL-NBR TO ASC-COMPLETE-BOL-NBR        07790062
078000                MOVE TR001-SCAC    TO ASC-PRO-SCAC-ID             07800062
078100                IF TR001-NEW-SHIP                                 07810062
078200                   PERFORM 3060-UNPROTECT-SHIP-FIELDS             07820062
078300                ELSE                                              07830062
078400                   PERFORM 3035-PROTECT-FIELDS                    07840062
078500                   MOVE TR001-SHIPT-ID TO ASC-SHIPT-ID            07850062
078600                   SET ASC-SHIPMENT-EXIST TO TRUE                 07860062
078700                END-IF                                            07870062
078800             ELSE                                                 07880062
078900                MOVE SPACES        TO ASC-PREV-PRO-NBR            07890062
079000                                      ASC-PREV-BOL-NBR            07900062
079010* 2011-12-14 CHRISTINE TWIEHAUS WR40574 START                    *07901062
079020                                      ASC-PREV-CAN                07902062
079030* 2011-12-14 CHRISTINE TWIEHAUS WR40574 END                      *07903062
079100             END-IF                                               07910062
079200             SET PS-PO-INQUIRY TO TRUE                            07920062
079300             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   07930062
079400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 07940062
079500             PERFORM 4000-BUILD-INITIAL-PANEL                     07950062
079600                                                                  07960062
079700         WHEN OTHER                                               07970062
079800             SET DP013-LOGIC-ABEND                                07980062
079900                 DP013-NO-ROLLBACK TO TRUE                        07990062
080000             MOVE '1000-CONTROL-PROCESSING'                       08000062
080100                                   TO DP013-PARAGRAPH             08010062
080200             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   08020062
080300                                   TO DP013-MESSAGE-TEXT(1)       08030062
080400             MOVE DP020-NEXT-APPL-ACTIVITY                        08040062
080500                                   TO DP013-MESSAGE-TEXT(2)       08050062
080600             PERFORM DP013-0000-PROCESS-ABEND                     08060062
080700     END-EVALUATE.                                                08070062
080800                                                                  08080062
080900*----------------------------------------------------------------*08090062
081000* LOAD THE APPLICATION SPECIFIC COMMAREA                         *08100062
081100*----------------------------------------------------------------*08110062
081200 1100-PROCESS-INTER-APPL-COMM.                                    08120062
081300                                                                  08130062
081400     MOVE DP020-INT-APPL-FORMAT-IND TO ASC-INT-APPL-FORMAT-IND.   08140062
081500                                                                  08150062
081600     EVALUATE DP020-INT-APPL-FORMAT-IND                           08160062
081700        WHEN PC-INTER-APPL-CRIT-SPEC                              08170062
081800            SET PS-FIRST-TIME TO TRUE                             08180062
081900            IF TR001-PO-NBR = SPACES                              08190062
082000               SET DP020-NEXT-ACT-APPL-ERROR TO TRUE              08200062
082100               MOVE PC-TSYMSG-00461 TO DP020-MSG-NUMBER           08210062
082200               SET DP020-MSG-FATAL                                08220062
082300                   PS-ERROR        TO TRUE                        08230062
082400            END-IF                                                08240062
082500            IF (TR001-PRO-NBR > SPACES OR TR001-BOL-NBR > SPACES) 08250062
082600                AND PS-NO-ERROR                                   08260062
082700                IF TR001-SCAC > SPACES                            08270062
082800                   CONTINUE                                       08280062
082900                ELSE                                              08290062
083000                   SET DP020-NEXT-ACT-APPL-ERROR TO TRUE          08300062
083100                   MOVE PC-TSYMSG-00997 TO DP020-MSG-NUMBER       08310062
083200                   SET DP020-MSG-FATAL                            08320062
083300                       PS-ERROR      TO TRUE                      08330062
083400                END-IF                                            08340062
083500            END-IF                                                08350062
083600            IF PS-NO-ERROR                                        08360062
083610*CLP 10/29/14 *                                                   08361078
083700               MOVE TR001-PO-NBR      TO ASC-PO-NBR-N             08370077
083800                                         DK-PO-NBR                08380062
083900               IF TR001-OPER-UNT-ID = SPACES                      08390062
084000                  MOVE DP020-LOCATION TO ASC-OPER-UNT-ID          08400062
084100               ELSE                                               08410062
084200                  MOVE TR001-OPER-UNT-ID-N TO ASC-OPER-UNT-ID     08420062
084300               END-IF                                             08430062
084400                                                                  08440062
084500               IF TR001-FCLTY-ID = SPACES                         08450062
084600                  MOVE DP020-FCLTY-ID TO ASC-FCLTY-ID             08460062
084700               ELSE                                               08470062
084800                  MOVE TR001-FCLTY-ID TO ASC-FCLTY-ID             08480062
084900               END-IF                                             08490062
085000               MOVE TR001-PRO-NBR     TO ASC-COMPLETE-PRO-NBR     08500062
085100               MOVE TR001-BOL-NBR     TO ASC-COMPLETE-BOL-NBR     08510062
085200               MOVE TR001-SCAC        TO ASC-PRO-SCAC-ID          08520062
085300               MOVE TR001-TRLR-NBR    TO ASC-VEH-NBR              08530062
085400               SET PS-FIRST-TIME      TO TRUE                     08540062
085500            END-IF                                                08550062
085600        WHEN OTHER                                                08560062
085700            SET DP013-LOGIC-ABEND TO TRUE                         08570062
085800            SET DP013-NO-ROLLBACK TO TRUE                         08580062
085900            MOVE '1100-PROCESS-INTER-APPL-COMM'                   08590062
086000                                  TO DP013-PARAGRAPH              08600062
086100            MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'    08610062
086200                                  TO DP013-MESSAGE-TEXT(1)        08620062
086300            MOVE DP020-NEXT-APPL-ACTIVITY                         08630062
086400                                  TO DP013-MESSAGE-TEXT(2)        08640062
086500            PERFORM DP013-0000-PROCESS-ABEND                      08650062
086600     END-EVALUATE.                                                08660062
086700                                                                  08670062
086800*----------------------------------------------------------------*08680062
086900* FURTHER DETERMINE PROCESSING PATH BASED ON FUNCTION KEY ACTIONS*08690062
087000* SPECIFIC FUNCTION KEYS LISTED HERE ARE ACTED UPON REGARDLESS OF*08700062
087100* EDITS.                                                         *08710062
087200*----------------------------------------------------------------*08720062
087300 2000-PROCESS-PANEL.                                              08730062
087400                                                                  08740062
087500     EVALUATE TRUE                                                08750062
087600                                                                  08760062
087700         WHEN DP020-SRC-AID = DP016-ENTER                         08770062
087800             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 08780062
087900             SET PS-PO-INQUIRY TO TRUE                            08790062
088000             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   08800062
088100                                                                  08810062
088200         WHEN DP020-SRC-AID = DP016-CLEAR                         08820062
088300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08830062
088400             SET PS-PO-INQUIRY TO TRUE                            08840062
088500             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   08850062
088600                                                                  08860062
088700         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     08870062
088710**CLP 10/29/14 *                                                  08871078
088800             MOVE TR001-PO-NBR TO ASC-PO-NBR-N                    08880077
088900                                  DK-PO-NBR                       08890062
089000             IF TR001-SCAC > SPACES AND (TR001-PRO-NBR > SPACES   08900062
089100                OR TR001-BOL-NBR > SPACES)                        08910062
089200                MOVE TR001-PRO-NBR TO ASC-COMPLETE-PRO-NBR        08920062
089300                MOVE TR001-BOL-NBR TO ASC-COMPLETE-BOL-NBR        08930062
089400                MOVE TR001-SCAC    TO ASC-PRO-SCAC-ID             08940062
089500                MOVE SPACES        TO ASC-PREV-PRO-NBR            08950062
089600                                      ASC-PREV-BOL-NBR            08960062
089700                                      ASC-PREV-COMP-PRO-NBR       08970062
089800                                      ASC-PREV-COMP-BOL-NBR       08980062
089900             ELSE                                                 08990062
090000                MOVE SPACES        TO ASC-PRO-NBR                 09000062
090100                                      ASC-COMPLETE-PRO-NBR        09010062
090200                                      ASC-PREV-COMP-PRO-NBR       09020062
090400                                      ASC-PREV-PRO-NBR            09040062
090401                                      ASC-PRO-SCAC-ID             09040162
090410* 2011-12-14 CHRISTINE TWIEHAUS WR40574 START                    *09041062
090420                                      ASC-CAN                     09042062
090430                                      ASC-COMPLETE-CAN            09043062
090440                                      ASC-PREV-COMP-CAN           09044062
090450                                      ASC-PREV-CAN                09045062
090460* 2011-12-14 CHRISTINE TWIEHAUS WR40574 END                      *09046062
090500                                      ASC-BOL-NBR                 09050062
090600                                      ASC-COMPLETE-BOL-NBR        09060062
090700                                      ASC-PREV-COMP-BOL-NBR       09070062
090800                                      ASC-PREV-BOL-NBR            09080062
090900             END-IF                                               09090062
091000             SET PS-PO-INQUIRY TO TRUE                            09100062
091100             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   09110062
091200             PERFORM 4000-BUILD-INITIAL-PANEL                     09120062
091300                                                                  09130062
091400         WHEN OTHER                                               09140062
091500             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 09150062
091600             IF DP020-FK-LOCAL-GOTO (DP020-SRC-AID) OR            09160062
091700                DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)            09170062
091800                SET PS-PO-INQUIRY TO TRUE                         09180062
091900             END-IF                                               09190062
092000             IF DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)            09200062
092100                SET ASC-ADD       TO TRUE                         09210062
092200             END-IF                                               09220062
092300             IF DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)            09230062
092400                SET ASC-ADD-ORIG-SCAC   TO TRUE                   09240062
092500             END-IF                                               09250062
092600             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   09260062
092700             IF  PS-NO-ERROR                                      09270062
092800                 PERFORM 2100-CHECK-FUNCTION-KEY                  09280062
092900                 SET DP030-CONTINUE-GO TO TRUE                    09290062
093000             ELSE                                                 09300062
093100                 SET DP030-OVERRIDE-GO TO TRUE                    09310062
093200             END-IF                                               09320062
093300     END-EVALUATE.                                                09330062
093400                                                                  09340062
093500 EJECT                                                            09350062
093600******************************************************************09360062
093700** ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED     **09370062
093800** FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED **09380062
093900** FROM THE CICS ARCHITECTURE API.                              **09390062
094000******************************************************************09400062
094100 2100-CHECK-FUNCTION-KEY.                                         09410062
094200                                                                  09420062
094300     EVALUATE TRUE                                                09430062
094400                                                                  09440062
094500         WHEN DP020-FK-LOCAL-GOTO (DP020-SRC-AID)                 09450062
094600             SET ASC-VND-DT-CHG-NOT-PENDING                       09460062
094700                 ASC-VND-DT-NOT-CHGD       TO TRUE                09470062
094800             PERFORM 2110-PREPARE-INTER-APPL-COMM                 09480062
094900                                                                  09490062
095000         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              09500062
095100******* CHECK IF VENDOR DATE IS WITHIN THE REQUIRED RANGE         09510062
095200*******    VENDOR DATE NOT > CURRENT DATE  OR                     09520062
095300*******      < CURRENT-DATE - PC-VALID-VND-DT-RANGE  DAYS         09530062
095400             IF ASC-VND-DT-CHG-PENDING                            09540062
095500                 PERFORM 3400-CHK-VND-DATE-RANGE                  09550062
095600                 IF PS-VALID-VND-DT-RANGE                         09560062
095700                     PERFORM 2150-ADD                             09570062
095800                     SET ASC-VND-DT-CHG-NOT-PENDING TO TRUE       09580062
095900                 ELSE                                             09590062
096000                     SET ASC-VND-DT-F2-REQUIRED                   09600062
096100                         PS-ERROR                                 09610062
096200                         DP020-MSG-WARNING  TO TRUE               09620062
096300                     MOVE DP015-YELLOW      TO AVNDMMC            09630062
096400                                               AVNDDDC            09640062
096500                                               AVNDYYC            09650062
096600                     MOVE DP015-REVERSE     TO AVNDMMH            09660062
096700                                               AVNDDDH            09670062
096800                                               AVNDYYH            09680062
096900                     MOVE -1                TO AVNDMML            09690062
097000                     MOVE PC-TSYMSG-01838   TO DP020-MSG-NUMBER   09700062
097100                     SET DP030-SET-CURSOR-APPL-1 TO TRUE          09710062
097200                 END-IF                                           09720062
097300             ELSE                                                 09730062
097400                 PERFORM 2150-ADD                                 09740062
097500             END-IF                                               09750062
097600                                                                  09760062
097700         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              09770062
097800             PERFORM 2160-ADD-ORG                                 09780062
097900                                                                  09790062
098000         WHEN DP020-FK-CONFIRM (DP020-SRC-AID)                    09800062
098100             IF ASC-VND-DT-F2-REQUIRED                            09810062
098200*** ONCE F2 PRESSED NO LONGER KNOW IF FUNC-01 OR FUNC-02          09820062
098300*** F2 IS VALID ONLY FOR FUNC-01                                  09830062
098400*****************IF DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)        09840062
098500                 IF ASC-ADD                                       09850062
098600                     IF (ASC-VEND-SHIP-MM = ASC-VEND-SHIP-MM-OLD  09860062
098700                         AND ASC-VEND-SHIP-DD =                   09870062
098800                                             ASC-VEND-SHIP-DD-OLD 09880062
098900                         AND ASC-VEND-SHIP-CCYY =                 09890062
099000                                          ASC-VEND-SHIP-CCYY-OLD) 09900062
099100                         AND ASC-VND-DT-CHG-PENDING               09910062
099200                        PERFORM 2150-ADD                          09920062
099300                        SET ASC-VND-DT-CHG-NOT-PENDING TO TRUE    09930062
099400                     ELSE                                         09940062
099500                         PERFORM 3400-CHK-VND-DATE-RANGE          09950062
099600                         IF PS-VALID-VND-DT-RANGE                 09960062
099700                             PERFORM 2150-ADD                     09970062
099800                             SET ASC-VND-DT-CHG-NOT-PENDING       09980062
099900                                                          TO TRUE 09990062
100000                         ELSE                                     10000062
100100                             SET ASC-VND-DT-F2-REQUIRED           10010062
100200                                 PS-ERROR                         10020062
100300                                 DP020-MSG-WARNING  TO TRUE       10030062
100400                             MOVE DP015-YELLOW      TO AVNDMMC    10040062
100500                                                       AVNDDDC    10050062
100600                                                       AVNDYYC    10060062
100700                             MOVE DP015-REVERSE     TO AVNDMMH    10070062
100800                                                       AVNDDDH    10080062
100900                                                       AVNDYYH    10090062
101000                             MOVE -1                TO AVNDMML    10100062
101100                             MOVE PC-TSYMSG-01838 TO              10110062
101200                                                 DP020-MSG-NUMBER 10120062
101300                             SET DP030-SET-CURSOR-APPL-1 TO TRUE  10130062
101400                         END-IF                                   10140062
101500                     END-IF                                       10150062
101600                 ELSE                                             10160062
101700                     SET PS-ERROR                                 10170062
101800                         DP020-MSG-WARNING TO TRUE                10180062
101900                     MOVE PC-TSYMSG-00045 TO DP020-MSG-NUMBER     10190062
102000                 END-IF                                           10200062
102100             ELSE                                                 10210062
102200                 SET PS-ERROR                                     10220062
102300                     DP020-MSG-WARNING  TO TRUE                   10230062
102400                 MOVE PC-TSYMSG-00045 TO DP020-MSG-NUMBER         10240062
102500             END-IF                                               10250062
102600                                                                  10260062
102700         WHEN DP020-SRC-AID = DP016-ENTER                         10270062
102800             CONTINUE                                             10280062
102900                                                                  10290062
103000         WHEN OTHER                                               10300062
103100             SET DP013-NO-ROLLBACK                                10310062
103200                 DP013-XCTL-DISPLAY-RESTART                       10320062
103300                 DP013-CICS-ABEND  TO TRUE                        10330062
103400             MOVE '2100-CHECK-FUNCTION-KEY'                       10340062
103500                                   TO DP013-PARAGRAPH             10350062
103600             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      10360062
103700                                   TO DP013-MESSAGE-TEXT (1)      10370062
103800             PERFORM DP013-0000-PROCESS-ABEND                     10380062
103900     END-EVALUATE.                                                10390062
104000 EJECT                                                            10400062
104100******************************************************************10410062
104200** MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE   **10420062
104300** INTER-APPLICATION COMMAREA.                                  **10430062
104400******************************************************************10440062
104500 2110-PREPARE-INTER-APPL-COMM.                                    10450062
104600                                                                  10460062
104700     INITIALIZE TR001-INTER-APPL-COMMAREA.                        10470062
104800**CLP 10/29/14 *                                                  10480078
104900     MOVE ASC-PO-NBR-N             TO TR001-PO-NBR.               10490077
105000     MOVE ASC-COMPLETE-PRO-NBR     TO TR001-PRO-NBR.              10500062
105100     MOVE ASC-COMPLETE-BOL-NBR     TO TR001-BOL-NBR.              10510062
105200     MOVE ASC-VEH-NBR              TO TR001-TRLR-NBR.             10520062
105300     MOVE ASC-OPER-UNT-ID          TO TR001-OPER-UNT-ID.          10530062
105400     MOVE ASC-FCLTY-ID             TO TR001-FCLTY-ID.             10540062
105500     MOVE ASC-FCLTY-NME            TO TR001-FCLTY-NME.            10550062
105600     MOVE ASC-PRO-SCAC-ID          TO TR001-SCAC.                 10560062
105700     MOVE ASC-PRO-SCAC-DESC        TO TR001-NAME.                 10570062
105800     MOVE ASC-ETA-DTE              TO TR001-ETA-DTE.              10580062
105900     MOVE ASC-ETA-TIME             TO TR001-ETA-TIME.             10590062
106000     MOVE ASC-SHIPT-ID             TO TR001-SHIPT-ID.             10600062
106100                                                                  10610062
106200******************************************************************10620062
106300**   PROCESSING DONE WHEN DP020-FK-LOCAL-FUNC-01                  10630062
106400******************************************************************10640062
106500 2150-ADD.                                                        10650062
106600     IF ASC-INVALID-PO-STATUS                                     10660062
106700        MOVE PC-TSYMSG-00998 TO DP020-MSG-NUMBER                  10670062
106800        MOVE ASC-PO-STATUS   TO DP020-MSG-TEXT                    10680062
106900        MOVE -1              TO APONBRL                           10690062
107000        SET DP020-MSG-FATAL                                       10700062
107100            DP030-SET-CURSOR-APPL-1                               10710062
107200            PS-ERROR         TO TRUE                              10720062
107300     ELSE                                                         10730062
107400        PERFORM 2300-CHECK-SHIPMENT                               10740062
107500        IF PS-SHIP-EXIST                                          10750062
107600            SET PS-ERROR                                          10760062
107700                DP020-MSG-FATAL TO TRUE                           10770062
107800            MOVE PC-TSYMSG-00993 TO DP020-MSG-NUMBER              10780062
107900            MOVE DP015-UNP-ALP-BRT-OFF                            10790062
108000                                TO AFBNBRA                        10800062
108100                                   ABOLNBRA                       10810062
108200                                   ADSCACA                        10820062
108300            MOVE DP015-RED      TO AFBNBRC                        10830062
108400                                   ABOLNBRC                       10840062
108500                                   ADSCACC                        10850062
108600            MOVE DP015-REVERSE  TO AFBNBRH                        10860062
108700                                   ABOLNBRH                       10870062
108800                                   ADSCACH                        10880062
108900            MOVE -1             TO AFBNBRL                        10890062
109000            SET DP030-SET-CURSOR-APPL-1 TO TRUE                   10900062
109100        ELSE                                                      10910062
109200            PERFORM 3020-DETERMINE-ADD                            10920062
109300        END-IF                                                    10930062
109400     END-IF.                                                      10940062
109500                                                                  10950062
109600     IF ASC-VND-DT-CHG-PENDING                                    10960062
109700         MOVE DP015-UNP-ALP-NOR-OFF TO AVNDMMA                    10970062
109800                                       AVNDDDA                    10980062
109900                                       AVNDYYA                    10990062
110000         MOVE DP015-GREEN       TO AVNDMMC                        11000062
110100                                   AVNDDDC                        11010062
110200                                   AVNDYYC                        11020062
110300         MOVE DP015-UNDERLINE   TO AVNDMMH                        11030062
110400                                   AVNDDDH                        11040062
110500                                   AVNDYYH                        11050062
110600     END-IF.                                                      11060062
110700                                                                  11070062
110800******************************************************************11080062
110900**   PROCESSING DONE WHEN DP020-FK-LOCAL-FUNC-02                  11090062
111000******************************************************************11100062
111100 2160-ADD-ORG.                                                    11110062
111200     IF ASC-MULTMATCH                                             11120062
111300        SET ASC-OK-MATCH                                          11130062
111400            ASC-ADD-SHIPMENT       TO TRUE                        11140062
111500        MOVE ASC-ORIG-PRO-NBR      TO ASC-PRO-NBR                 11150062
111600                                      ASC-PREV-PRO-NBR            11160062
111700        MOVE ASC-ORIG-COMP-PRO-NBR TO ASC-COMPLETE-PRO-NBR        11170062
111710* 2011-12-14 CHRISTINE TWIEHAUS WR40574 START                    *11171062
111720        MOVE ASC-ORIG-CAN          TO ASC-CAN                     11172062
111730                                      ASC-PREV-CAN                11173062
111740        MOVE ASC-ORIG-COMP-CAN     TO ASC-COMPLETE-CAN            11174062
111750* 2011-12-14 CHRISTINE TWIEHAUS WR40574 END                      *11175068
111800        MOVE ASC-ORIG-BOL-NBR      TO ASC-BOL-NBR                 11180062
111900                                      ASC-PREV-BOL-NBR            11190062
112000        MOVE ASC-ORIG-COMP-BOL-NBR TO ASC-COMPLETE-BOL-NBR        11200062
112100        MOVE SPACES           TO ASC-FB-CARTON-CNT                11210062
112200                                 ASC-PO-CARTON-CNT                11220062
112300                                 ASC-AUTH-CCYY                    11230062
112400                                 ASC-AUTH-MM                      11240062
112500                                 ASC-AUTH-DD                      11250062
112600                                 ASC-AUTH-NBR                     11260062
112700                                 ASC-VEND-SHIP-CCYY               11270062
112800                                 ASC-VEND-SHIP-MM                 11280062
112900                                 ASC-VEND-SHIP-DD                 11290062
113000                                 ASC-VEH-NBR                      11300062
113130                                 ASC-ETA-DTE                      11313062
113200                                 ASC-ETA-TIME                     11320062
113300        PERFORM 3060-UNPROTECT-SHIP-FIELDS                        11330062
113400     ELSE                                                         11340062
113500        SET  PS-ERROR                                             11350062
113600             DP020-MSG-FATAL  TO TRUE                             11360062
113700        MOVE PC-TSYMSG-00045  TO DP020-MSG-NUMBER                 11370062
113800     END-IF.                                                      11380062
113900                                                                  11390062
114000                                                                  11400062
114100*----------------------------------------------------------------*11410062
114200* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS IN*11420062
114300* THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN THE  *11430062
114400* APPLICATION-SPECIFIC COMMAREA, NOT ON THE SCREEN.              *11440062
114500*----------------------------------------------------------------*11450062
114600                                                                  11460062
114700 2200-MOVE-SCREEN-TO-COMMAREA.                                    11470062
114800                                                                  11480062
114900     IF  AOPERL > ZERO                                            11490062
115000         MOVE AOPERI              TO ASC-OPER-UNT-ID              11500062
115100     ELSE                                                         11510062
115200         IF AOPERF = DP015-ERASE-EOF                              11520062
115300            MOVE DP020-LOCATION   TO ASC-OPER-UNT-ID              11530062
115400         END-IF                                                   11540062
115500     END-IF.                                                      11550062
115600                                                                  11560062
115700     IF  AFCLTYL > ZERO                                           11570062
115800         MOVE AFCLTYI             TO ASC-FCLTY-ID                 11580062
115900     ELSE                                                         11590062
116000         IF AFCLTYF = DP015-ERASE-EOF                             11600062
116100            MOVE DP020-FCLTY-ID   TO ASC-FCLTY-ID                 11610062
116200         END-IF                                                   11620062
116300     END-IF.                                                      11630062
116400                                                                  11640062
116500     IF  APONBRL > ZERO                                           11650062
116600         MOVE APONBRI             TO ASC-PO-NBR                   11660062
116700                                     DK-PO-NBR                    11670062
116800     ELSE                                                         11680062
116900         IF  APONBRF = DP015-ERASE-EOF                            11690062
117000             MOVE SPACES           TO ASC-PO-NBR                  11700062
117100             MOVE ZEROES           TO DK-PO-NBR                   11710062
117200         END-IF                                                   11720062
117300     END-IF.                                                      11730062
117400                                                                  11740062
117500     IF APOCNTL > ZERO                                            11750062
117600        MOVE APOCNTI              TO ASC-PO-CARTON-CNT            11760062
117700     ELSE                                                         11770062
117800        IF APOCNTF = DP015-ERASE-EOF                              11780062
117900           MOVE SPACES            TO ASC-PO-CARTON-CNT            11790062
118000        END-IF                                                    11800062
118100     END-IF.                                                      11810062
118200                                                                  11820062
118300     IF AFBNBRL > ZERO                                            11830062
118400        MOVE AFBNBRI              TO ASC-COMPLETE-PRO-NBR         11840062
118500     ELSE                                                         11850062
118600        IF AFBNBRF = DP015-ERASE-EOF                              11860062
118700           MOVE SPACES            TO ASC-COMPLETE-PRO-NBR         11870062
118800                                     ASC-PRO-NBR                  11880062
118900        END-IF                                                    11890062
119000     END-IF.                                                      11900062
119100                                                                  11910062
119110* 2011-12-14 CHRISTINE TWIEHAUS WR40574 START                    *11911062
119120     IF ACANL   > ZERO                                            11912062
119130        MOVE ACANI                TO ASC-COMPLETE-CAN             11913062
119140     ELSE                                                         11914062
119150        IF ACANF   = DP015-ERASE-EOF                              11915062
119160           MOVE SPACES            TO ASC-COMPLETE-CAN             11916062
119170                                     ASC-CAN                      11917062
119180        END-IF                                                    11918062
119190     END-IF.                                                      11919062
119191                                                                  11919162
119192* 2011-12-14 CHRISTINE TWIEHAUS WR40574 END                      *11919262
119200     IF ABOLNBRL > ZERO                                           11920062
119300        MOVE ABOLNBRI             TO ASC-COMPLETE-BOL-NBR         11930062
119400     ELSE                                                         11940062
119500        IF ABOLNBRF = DP015-ERASE-EOF                             11950062
119600           MOVE SPACES            TO ASC-COMPLETE-BOL-NBR         11960062
119700                                     ASC-BOL-NBR                  11970062
119800        END-IF                                                    11980062
119900     END-IF.                                                      11990062
120000                                                                  12000062
120100     IF AFBCNTL > ZERO                                            12010062
120200        MOVE AFBCNTI              TO ASC-FB-CARTON-CNT            12020062
120300     ELSE                                                         12030062
120400        IF AFBCNTF = DP015-ERASE-EOF                              12040062
120500           MOVE SPACES            TO ASC-FB-CARTON-CNT            12050062
120600        END-IF                                                    12060062
120700     END-IF.                                                      12070062
120800                                                                  12080062
120900     IF AVNDMML > ZERO                                            12090062
121000        MOVE AVNDMMI              TO ASC-VEND-SHIP-MM             12100062
121100        SET PS-VND-DT-MM-CHGD     TO TRUE                         12110062
121200     ELSE                                                         12120062
121300        SET PS-VND-DT-MM-NOT-CHGD TO TRUE                         12130062
121400        IF AVNDMMF = DP015-ERASE-EOF                              12140062
121500           MOVE SPACES            TO ASC-VEND-SHIP-MM             12150062
121600        END-IF                                                    12160062
121700     END-IF.                                                      12170062
121800                                                                  12180062
121900     IF AVNDDDL > ZERO                                            12190062
122000        MOVE AVNDDDI              TO ASC-VEND-SHIP-DD             12200062
122100        SET PS-VND-DT-DD-CHGD     TO TRUE                         12210062
122200     ELSE                                                         12220062
122300        SET PS-VND-DT-DD-NOT-CHGD TO TRUE                         12230062
122400        IF AVNDDDF = DP015-ERASE-EOF                              12240062
122500           MOVE SPACES            TO ASC-VEND-SHIP-DD             12250062
122600        END-IF                                                    12260062
122700     END-IF.                                                      12270062
122800                                                                  12280062
122900     IF AVNDYYL > ZERO                                            12290062
123000        MOVE AVNDYYI              TO ASC-VEND-SHIP-YY             12300062
123100        SET PS-VND-DT-YY-CHGD     TO TRUE                         12310062
123200        IF ASC-VEND-SHIP-YY > '60'                                12320062
123300           MOVE '19'              TO ASC-VEND-SHIP-CC             12330062
123400        ELSE                                                      12340062
123500           MOVE '20'              TO ASC-VEND-SHIP-CC             12350062
123600        END-IF                                                    12360062
123700     ELSE                                                         12370062
123800        SET PS-VND-DT-YY-NOT-CHGD TO TRUE                         12380062
123900        IF AVNDYYF = DP015-ERASE-EOF                              12390062
124000           MOVE SPACES            TO ASC-VEND-SHIP-YY             12400062
124100        END-IF                                                    12410062
124200     END-IF.                                                      12420062
124300                                                                  12430062
124400     IF PS-VND-DT-MM-CHGD OR                                      12440062
124500        PS-VND-DT-DD-CHGD OR                                      12450062
124600        PS-VND-DT-YY-CHGD                                         12460062
124700          SET ASC-VND-DT-CHGD                                     12470062
124800              ASC-VND-DT-CHG-PENDING TO TRUE                      12480062
124900     END-IF.                                                      12490062
125000                                                                  12500062
125100     IF AATHNBRL > ZERO                                           12510062
125200        MOVE AATHNBRI             TO ASC-AUTH-NBR                 12520062
125300     ELSE                                                         12530062
125400        IF AATHNBRF = DP015-ERASE-EOF                             12540062
125500           MOVE SPACES            TO ASC-AUTH-NBR                 12550062
125600        END-IF                                                    12560062
125700     END-IF.                                                      12570062
125800                                                                  12580062
125900     IF AATHMML > ZERO                                            12590062
126000        MOVE AATHMMI              TO ASC-AUTH-MM                  12600062
126100     ELSE                                                         12610062
126200        IF AATHMMF = DP015-ERASE-EOF                              12620062
126300           MOVE SPACES            TO ASC-AUTH-MM                  12630062
126400        END-IF                                                    12640062
126500     END-IF.                                                      12650062
126600                                                                  12660062
126700     IF AATHDDL > ZERO                                            12670062
126800        MOVE AATHDDI              TO ASC-AUTH-DD                  12680062
126900     ELSE                                                         12690062
127000        IF AATHDDF = DP015-ERASE-EOF                              12700062
127100           MOVE SPACES            TO ASC-AUTH-DD                  12710062
127200        END-IF                                                    12720062
127300     END-IF.                                                      12730062
127400                                                                  12740062
127500     IF AATHYYL > ZERO                                            12750062
127600        MOVE AATHYYI              TO ASC-AUTH-YY                  12760062
127700        IF ASC-AUTH-YY > '60'                                     12770062
127800           MOVE '19'              TO ASC-AUTH-CC                  12780062
127900        ELSE                                                      12790062
128000           MOVE '20'              TO ASC-AUTH-CC                  12800062
128100        END-IF                                                    12810062
128200     ELSE                                                         12820062
128300        IF AATHYYF = DP015-ERASE-EOF                              12830062
128400           MOVE SPACES            TO ASC-AUTH-YY                  12840062
128500        END-IF                                                    12850062
128600     END-IF.                                                      12860062
128700                                                                  12870062
128800     IF AOSCACL > ZERO                                            12880062
128900        MOVE AOSCACI              TO ASC-ORIG-SCAC-ID             12890062
129000     ELSE                                                         12900062
129100        IF AOSCACF = DP015-ERASE-EOF                              12910062
129200           MOVE SPACES            TO ASC-ORIG-SCAC-ID             12920062
129300        END-IF                                                    12930062
129400     END-IF.                                                      12940062
129500                                                                  12950062
129600     IF ADSCACL > ZERO                                            12960062
129700        MOVE ADSCACI              TO ASC-PRO-SCAC-ID              12970062
129800     ELSE                                                         12980062
129900        IF ADSCACF = DP015-ERASE-EOF                              12990062
130000           MOVE SPACES            TO ASC-PRO-SCAC-ID              13000062
130100        END-IF                                                    13010062
130200     END-IF.                                                      13020062
130300                                                                  13030062
130400     IF ATRLRNOL > ZERO                                           13040062
130500        MOVE ATRLRNOI             TO ASC-VEH-NBR                  13050062
130600     ELSE                                                         13060062
130700        IF ATRLRNOF = DP015-ERASE-EOF                             13070062
130800           MOVE SPACES            TO ASC-VEH-NBR                  13080062
130900        END-IF                                                    13090062
131000     END-IF.                                                      13100062
131100                                                                  13110062
131200* 2011-12-14 CHRISTINE TWIEHAUS WR40574 START                    *13120062
131300     IF ACANL > ZERO                                              13130062
131400        MOVE ACANI             TO ASC-CAN                         13140062
131500     ELSE                                                         13150062
131600        IF ACANF = DP015-ERASE-EOF                                13160062
131700           MOVE SPACES            TO ASC-CAN                      13170062
131800        END-IF                                                    13180062
131900     END-IF.                                                      13190062
132000                                                                  13200062
132100* 2011-12-14 CHRISTINE TWIEHAUS WR40574 END                      *13210062
132200     IF AETAMML > ZERO                                            13220062
132300        MOVE AETAMMI              TO ASC-ETA-MM                   13230062
132400     ELSE                                                         13240062
132500        IF AETAMMF = DP015-ERASE-EOF                              13250062
132600           MOVE SPACES            TO ASC-ETA-MM                   13260062
132700        END-IF                                                    13270062
132800     END-IF.                                                      13280062
132900                                                                  13290062
133000     IF AETADDL > ZERO                                            13300062
133100        MOVE AETADDI              TO ASC-ETA-DD                   13310062
133200     ELSE                                                         13320062
133300        IF AETADDF = DP015-ERASE-EOF                              13330062
133400           MOVE SPACES               TO ASC-ETA-DD                13340062
133500        END-IF                                                    13350062
133600     END-IF.                                                      13360062
133700                                                                  13370062
133800     IF AETAYYL > ZERO                                            13380062
133900        MOVE AETAYYI              TO ASC-ETA-YY                   13390062
134000        IF ASC-ETA-YY > '60'                                      13400062
134100           MOVE '19'              TO ASC-ETA-CC                   13410062
134200        ELSE                                                      13420062
134300           MOVE '20'              TO ASC-ETA-CC                   13430062
134400        END-IF                                                    13440062
134500     ELSE                                                         13450062
134600        IF AETAYYF = DP015-ERASE-EOF                              13460062
134700           MOVE SPACES            TO ASC-ETA-YY                   13470062
134800        END-IF                                                    13480062
134900     END-IF.                                                      13490062
135000                                                                  13500062
135100     IF AETAHHL > ZERO                                            13510062
135200        MOVE AETAHHI              TO ASC-ETA-TIME-HH              13520062
135300     ELSE                                                         13530062
135400        IF AETAHHF = DP015-ERASE-EOF                              13540062
135500           MOVE SPACES            TO ASC-ETA-TIME-HH              13550062
135600        END-IF                                                    13560062
135700     END-IF.                                                      13570062
135800                                                                  13580062
135900     IF AETAMNL > ZERO                                            13590062
136000        MOVE AETAMNI              TO ASC-ETA-TIME-MN              13600062
136100     ELSE                                                         13610062
136200        IF AETAMNF = DP015-ERASE-EOF                              13620062
136300           MOVE SPACES            TO ASC-ETA-TIME-MN              13630062
136400        END-IF                                                    13640062
136500     END-IF.                                                      13650062
136600                                                                  13660062
136700     IF ASC-ETA-TIME = SPACES                                     13670062
136800        MOVE '0000'               TO ASC-ETA-TIME                 13680062
136900     END-IF.                                                      13690062
137000                                                                  13700062
137100*----------------------------------------------------------------*13710062
137200* CHECK IF THERE IS ALREADY A SHIPMENT ON THE TABLE THE CURRENT  *13720062
137300* PRO, BOL AND DELIVERY SCAC -- IF SO, DO NOT LET THEM ADD IT.   *13730062
137400*----------------------------------------------------------------*13740062
137500 2300-CHECK-SHIPMENT.                                             13750062
137600                                                                  13760062
137700     PERFORM                                                      13770062
137800         WITH TEST AFTER                                          13780062
137900         VARYING PV-RETRY-COUNTER                                 13790062
138000         FROM 1 BY 1                                              13800062
138100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               13810062
138200             OR (SQLCODE = +100)                                  13820062
138300             OR (SQLCODE = -811)                                  13830062
138400             OR (SQLCODE = +0))                                   13840062
138500                                                                  13850062
138600         EXEC SQL                                                 13860062
138700            SELECT   SHIPT_ID                                     13870062
138800            INTO     :PV-TEMP-SHIPT-ID                            13880062
138900           FROM   TSHIPMT                                         13890062
139000           WHERE  PRO_NBR     = :DK-PRO-NBR                       13900062
139100             AND  BOL_NBR     = :DK-BOL-NBR                       13910062
139200             AND  PRO_SCAC_ID = :DK-PRO-SCAC                      13920062
139300         END-EXEC                                                 13930062
139400                                                                  13940062
139500         EVALUATE TRUE                                            13950062
139600             WHEN SQLCODE = +0                                    13960062
139700             WHEN SQLCODE = -811                                  13970062
139800                 SET PS-SHIP-EXIST      TO TRUE                   13980062
139900                                                                  13990062
140000             WHEN SQLCODE = +100                                  14000062
140100                 SET PS-NO-SHIP-EXIST   TO TRUE                   14010062
140200                                                                  14020062
140300             WHEN SQLCODE = -904                                  14030062
140400             WHEN SQLCODE = -913                                  14040062
140500                 CONTINUE                                         14050062
140600                                                                  14060062
140700             WHEN SQLWARN0 NOT = SPACES                           14070062
140800             WHEN SQLCODE < +0                                    14080062
140900             WHEN SQLCODE > +0                                    14090062
141000                 MOVE '2300-CHECK-SHIPMENT'                       14100062
141100                                   TO DP013-PARAGRAPH             14110062
141200                 MOVE 'SELECTING FROM TSHIPMT '                   14120062
141300                                   TO DP013-MESSAGE-TEXT(1)       14130062
141400                 STRING DK-PRO-NBR     DELIMITED BY SIZE          14140062
141500                        DK-BOL-NBR     DELIMITED BY SIZE          14150062
141600                        DK-PRO-SCAC    DELIMITED BY SIZE          14160062
141700                                 INTO DP013-MESSAGE-TEXT(2)       14170062
141800                                                                  14180062
141900                 MOVE SQLCA        TO DP013-SQLCA                 14190062
142000                 MOVE 'TSHIPMT'    TO DP013-DB2-TABLE-NAME (1)    14200062
142100                 SET DP013-DB2-ABEND                              14210062
142200                     DP013-XCTL-DISPLAY-RESTART TO TRUE           14220062
142300                 PERFORM DP013-0000-PROCESS-ABEND                 14230062
142400         END-EVALUATE                                             14240062
142500     END-PERFORM.                                                 14250062
142600                                                                  14260062
142700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    14270062
142800         SQLCODE NOT = +0                                         14280062
142900         MOVE '2300-CHECK-SHIPMENT'                               14290062
143000                                   TO DP013-PARAGRAPH             14300062
143100         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              14310062
143200                                   TO DP013-MESSAGE-TEXT (1)      14320062
143300         MOVE 'TO SELECT A TSHIPMT ROW'                           14330062
143400                                   TO DP013-MESSAGE-TEXT (2)      14340062
143500         STRING DK-PRO-NBR     DELIMITED BY SIZE                  14350062
143600                DK-BOL-NBR     DELIMITED BY SIZE                  14360062
143700                DK-PRO-SCAC    DELIMITED BY SIZE                  14370062
143800                         INTO DP013-MESSAGE-TEXT(3)               14380062
143900         MOVE SQLCA                TO DP013-SQLCA                 14390062
144000         MOVE 'TSHIPMT'            TO DP013-DB2-TABLE-NAME (1)    14400062
144100         SET DP013-DB2-ABEND                                      14410062
144200             DP013-XCTL-DISPLAY-RESTART                           14420062
144300                                   TO TRUE                        14430062
144400         PERFORM DP013-0000-PROCESS-ABEND                         14440062
144500     END-IF.                                                      14450062
144600                                                                  14460062
144700                                                                  14470062
144800*----------------------------------------------------------------*14480062
144900* PERFORM EDITS ON EACH FIELD ENTERED BY THE USER.  IF AN ERROR  *14490062
145000* IS FOUND THE CURSOR IS POSITIONED AT THAT FIELD AND AN         *14500062
145100* APPROPRIATE ERROR MESSAGE IS DISPLAYED.                        *14510062
145200*----------------------------------------------------------------*14520062
145300                                                                  14530062
145400 3000-EDIT-DATA-IN-COMMAREA.                                      14540062
145500                                                                  14550062
145600     PERFORM 3200-RESET-ATTRIBUTES.                               14560062
145700                                                                  14570062
145800     IF  ASC-OPER-UNT-ID    > SPACES                              14580062
145900         MOVE ASC-OPER-UNT-ID    TO DP010I-UNEDITED-FIELD         14590062
146000         MOVE LENGTH OF ASC-OPER-UNT-ID                           14600062
146100                                 TO DP010I-MAXIMUM-DIGITS         14610062
146200         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       14620062
146300         SET DP010I-NEGATIVE-NOT-ALLOWED                          14630062
146400                                 TO TRUE                          14640062
273427         CALL DP010I-NUMERIC-EDIT-ROUTINE                         14651083
273427              USING DP010I-NUMERIC-EDIT-AREA                      14652083
146600         IF  DP010I-ERROR-DETECTED                                14660062
146700             SET PS-ERROR                                         14670062
146800                 DP020-MSG-FATAL TO TRUE                          14680062
146900             MOVE PC-TSYMSG-00008                                 14690062
147000                                 TO DP020-MSG-NUMBER              14700062
147100             MOVE DP015-UNP-ALP-BRT-OFF                           14710062
147200                                 TO AOPERA                        14720062
147300             MOVE DP015-RED      TO AOPERC                        14730062
147400             MOVE DP015-REVERSE  TO AOPERH                        14740062
147500             MOVE -1             TO AOPERL                        14750062
147600             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  14760062
147700         ELSE                                                     14770062
147800             MOVE DP010I-NUMERIC-FIELD TO PV-TEMP-OPER-UNT        14780062
147900             MOVE PV-TEMP-OPER-UNT TO ASC-OPER-UNT-ID-N           14790062
148000                                    PV-OPER-UNT-ID                14800062
148100             MOVE ASC-OPER-UNT-ID                                 14810062
148200                                 TO AOPERO                        14820062
148300             PERFORM 3900-VALIDATE-OPER-UNT-ID                    14830062
148400         END-IF                                                   14840062
148500     END-IF.                                                      14850062
148600                                                                  14860062
148700     IF  ASC-FCLTY-ID > SPACES                                    14870062
148800         MOVE ASC-FCLTY-ID       TO DP010I-UNEDITED-FIELD         14880062
148900         MOVE LENGTH OF ASC-FCLTY-ID                              14890062
149000                                 TO DP010I-MAXIMUM-DIGITS         14900062
149100         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       14910062
149200         SET DP010I-NEGATIVE-NOT-ALLOWED                          14920062
149300                                 TO TRUE                          14930062
273427         CALL DP010I-NUMERIC-EDIT-ROUTINE                         14941083
273427              USING DP010I-NUMERIC-EDIT-AREA                      14942083
149500         IF  DP010I-ERROR-DETECTED                                14950062
149600             SET PS-ERROR                                         14960062
149700                 DP020-MSG-FATAL TO TRUE                          14970062
149800             MOVE PC-TSYMSG-00008                                 14980062
149900                                 TO DP020-MSG-NUMBER              14990062
150000             MOVE DP015-UNP-ALP-BRT-OFF                           15000062
150100                                 TO AFCLTYA                       15010062
150200             MOVE DP015-RED      TO AFCLTYC                       15020062
150300             MOVE DP015-REVERSE  TO AFCLTYH                       15030062
150400             MOVE -1             TO AFCLTYL                       15040062
150500             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  15050062
150600         ELSE                                                     15060062
150700             MOVE DP010I-NUMERIC-FIELD TO PV-TEMP-FCLTY           15070062
150800             MOVE PV-TEMP-FCLTY  TO ASC-FCLTY-ID-N                15080062
150900                                    PV-FCLTY-ID                   15090062
151000             MOVE ASC-FCLTY-ID TO AFCLTYO                         15100062
151100         END-IF                                                   15110062
151200     END-IF.                                                      15120062
151300                                                                  15130062
151400     IF ASC-FCLTY-ID-N      > ZEROS AND                           15140062
151500        ASC-OPER-UNT-ID-N > ZEROS                                 15150062
151600         MOVE ASC-FCLTY-ID TO PV-FCLTY-ID                         15160062
151700         MOVE ASC-OPER-UNT-ID TO PV-OPER-UNT-ID                   15170062
151800         PERFORM 3800-VALIDATE-FCLTY-ID                           15180062
151900     ELSE                                                         15190062
152000         MOVE SPACES TO ASC-FCLTY-NME                             15200062
152100                        AFDESCO                                   15210062
152200     END-IF.                                                      15220062
152300                                                                  15230062
152400     IF ASC-PO-NBR > SPACES                                       15240062
152500        MOVE ASC-PO-NBR        TO DP010I-UNEDITED-FIELD           15250062
152510*CLP 10/29/14                                                     15251076
152600        MOVE +8                TO DP010I-MAXIMUM-DIGITS           15260076
152700        MOVE +0                TO DP010I-MAXIMUM-DECIMALS         15270062
152800                                                                  15280062
152900        SET DP010I-NEGATIVE-NOT-ALLOWED                           15290062
153000                                    TO TRUE                       15300062
273427        CALL DP010I-NUMERIC-EDIT-ROUTINE                          15311083
273427             USING DP010I-NUMERIC-EDIT-AREA                       15312083
153200        IF DP010I-ERROR-DETECTED                                  15320062
153300            MOVE DP015-RED      TO APONBRC                        15330062
153400            MOVE DP015-REVERSE  TO APONBRH                        15340062
153500            MOVE -1             TO APONBRL                        15350062
153600            MOVE PC-TSYMSG-00008                                  15360062
153700                                TO DP020-MSG-NUMBER               15370062
153800            SET DP020-MSG-FATAL TO TRUE                           15380062
153900            SET PS-ERROR        TO TRUE                           15390062
154000            SET DP030-SET-CURSOR-APPL-1 TO TRUE                   15400062
154100        ELSE                                                      15410062
154200            MOVE DP010I-NUMERIC-FIELD TO PV-TEMP-PO-NBR           15420062
154300            MOVE PV-TEMP-PO-NBR       TO ASC-PO-NBR-N             15430062
154400                                       DK-PO-NBR                  15440062
154500                                       APONBRO                    15450062
154600                                                                  15460062
154700            IF ASC-PO-NBR > SPACES AND PS-NO-ERROR                15470062
154800               PERFORM 4100-GET-PO-INFO                           15480062
154900               PERFORM 3160-SELECT-TSHPTPO                        15490062
155000               IF PS-FOUND                                        15500062
155100                  MOVE SHPTPO-EXPTED-CART-CNT TO                  15510062
155200                       ASC-PO-CARTON-CNT                          15520062
155300                       APOCNTO                                    15530062
155400               ELSE                                               15540062
155500                  IF DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)       15550062
155600                     OR  (DP020-FK-CONFIRM (DP020-SRC-AID) AND    15560062
155700                             ASC-ADD)                             15570062
155800                     CONTINUE                                     15580062
155900                  ELSE                                            15590062
156000                     MOVE ZEROES TO ASC-PO-CARTON-CNT             15600062
156100                                    APOCNTO                       15610062
156200                  END-IF                                          15620062
156300               END-IF                                             15630062
156400            END-IF                                                15640062
156500        END-IF                                                    15650062
156600     ELSE                                                         15660062
156700        MOVE SPACES  TO ASC-NO-DISTRO-MSG                         15670062
156800                        ADISTOO                                   15680062
156900                        ASC-PO-STATUS-DESC                        15690062
157000                        APOSTATO                                  15700062
157100                        ASC-DONT-SHIP-BEF-DTE                     15710062
157200                        ABEFDTEO                                  15720062
157300                        ASC-CANCEL-DTE                            15730062
157400                        ACANDTEO                                  15740062
157500                        ASC-EXT-CAN-DTE                           15750062
157600                        AEXCDTEO                                  15760062
157700                        ASC-DEPT-NBR                              15770062
157800                        ASC-DEPT-DESC                             15780062
157900                        ADPTDSCO                                  15790062
158000                        ASC-BUYER-NME                             15800062
158100                        ABUYNMEO                                  15810062
158200        MOVE ZEROES  TO ADPTNBRO                                  15820062
158300     END-IF.                                                      15830062
158400*                                                                 15840062
158500     IF  ASC-PO-CARTON-CNT > SPACES                               15850062
158600        MOVE ASC-PO-CARTON-CNT TO DP010I-UNEDITED-FIELD           15860062
158700        MOVE +5                TO DP010I-MAXIMUM-DIGITS           15870062
158800        MOVE +0                TO DP010I-MAXIMUM-DECIMALS         15880062
158900        SET DP010I-NEGATIVE-NOT-ALLOWED                           15890062
159000                                    TO TRUE                       15900062
273427        CALL DP010I-NUMERIC-EDIT-ROUTINE                          15911083
273427             USING DP010I-NUMERIC-EDIT-AREA                       15912083
159200        IF DP010I-ERROR-DETECTED                                  15920062
159300            MOVE DP015-RED      TO APOCNTC                        15930062
159400            MOVE DP015-REVERSE  TO APOCNTH                        15940062
159500            MOVE -1             TO APOCNTL                        15950062
159600            MOVE PC-TSYMSG-00008                                  15960062
159700                                TO DP020-MSG-NUMBER               15970062
159800            SET DP020-MSG-FATAL TO TRUE                           15980062
159900            SET PS-ERROR        TO TRUE                           15990062
160000            SET DP030-SET-CURSOR-APPL-1 TO TRUE                   16000062
160100        ELSE                                                      16010062
160200            MOVE DP010I-NUMERIC-FIELD TO PV-TEMP-PO-CARTON-CNT    16020062
160300            MOVE PV-TEMP-PO-CARTON-CNT   TO ASC-PO-CARTON-CNT-N   16030062
160400                                       DK-PO-CARTON-CNT           16040062
160500                                       APOCNTO                    16050062
160600        END-IF                                                    16060062
160700      END-IF.                                                     16070062
160800                                                                  16080062
160900     IF  ASC-FB-CARTON-CNT > SPACES AND PS-NO-ERROR               16090062
161000        MOVE ASC-FB-CARTON-CNT TO DP010I-UNEDITED-FIELD           16100062
161100        MOVE +5                TO DP010I-MAXIMUM-DIGITS           16110062
161200        MOVE +0                TO DP010I-MAXIMUM-DECIMALS         16120062
161300        SET DP010I-NEGATIVE-NOT-ALLOWED                           16130062
161400                                    TO TRUE                       16140062
273427        CALL DP010I-NUMERIC-EDIT-ROUTINE                          16151083
273427             USING DP010I-NUMERIC-EDIT-AREA                       16152083
161600        IF DP010I-ERROR-DETECTED                                  16160062
161700            MOVE DP015-RED      TO AFBCNTC                        16170062
161800            MOVE DP015-REVERSE  TO AFBCNTH                        16180062
161900            MOVE -1             TO AFBCNTL                        16190062
162000            MOVE PC-TSYMSG-00008                                  16200062
162100                                TO DP020-MSG-NUMBER               16210062
162200            SET DP020-MSG-FATAL TO TRUE                           16220062
162300            SET PS-ERROR        TO TRUE                           16230062
162400            SET DP030-SET-CURSOR-APPL-1 TO TRUE                   16240062
162500        ELSE                                                      16250062
162600            MOVE DP010I-NUMERIC-FIELD TO PV-TEMP-FB-CARTON-CNT    16260062
162700            MOVE PV-TEMP-FB-CARTON-CNT   TO ASC-FB-CARTON-CNT-N   16270062
162800                                       DK-FB-CARTON-CNT           16280062
162900                                       AFBCNTO                    16290062
163000        END-IF                                                    16300062
163100      END-IF.                                                     16310062
163200                                                                  16320062
163300     IF ASC-COMPLETE-PRO-NBR > SPACES AND PS-NO-ERROR             16330062
163400        MOVE ASC-COMPLETE-PRO-NBR       TO RC023-FREIGHT-BILL     16340062
163500                                           AFBNBRO                16350062
163600        CALL PC-RCKUT023 USING RC023-FORMAT-DATA-AREA             16360062
163700        MOVE RC023-FREIGHT-BILL  TO ASC-PRO-NBR                   16370062
163800     ELSE                                                         16380062
163900        IF PS-NO-ERROR                                            16390062
164000           MOVE SPACES           TO ASC-PRO-NBR                   16400062
164100        END-IF                                                    16410062
164200     END-IF.                                                      16420062
164300                                                                  16430062
164400     IF ASC-COMPLETE-BOL-NBR > SPACES AND PS-NO-ERROR             16440062
164500        MOVE ASC-COMPLETE-BOL-NBR       TO RC023-BILL-OF-LADING   16450062
164600                                           ABOLNBRO               16460062
164700        CALL PC-RCKUT023 USING RC023-FORMAT-DATA-AREA             16470062
164800        MOVE RC023-BILL-OF-LADING  TO ASC-BOL-NBR                 16480062
164900     ELSE                                                         16490062
165000        IF PS-NO-ERROR                                            16500062
165100           MOVE SPACES             TO ASC-BOL-NBR                 16510062
165200        END-IF                                                    16520062
165300     END-IF.                                                      16530062
165400                                                                  16540062
165500     IF ASC-VEH-NBR > SPACES AND PS-NO-ERROR                      16550062
165600        MOVE ASC-VEH-NBR       TO RC023-VEHICLE                   16560062
165700        CALL PC-RCKUT023 USING RC023-FORMAT-DATA-AREA             16570062
165800        MOVE RC023-VEHICLE     TO ASC-VEH-NBR                     16580062
165900                                  ATRLRNOO                        16590062
166000      END-IF.                                                     16600062
166100                                                                  16610062
166200* 2011-12-14 CHRISTINE TWIEHAUS WR40574 START                    *16620062
166310     IF ASC-COMPLETE-CAN     > SPACES AND PS-NO-ERROR             16631062
166320        MOVE ASC-COMPLETE-CAN    TO ACANO                         16632066
166350                                    ASC-CAN                       16635062
166360     ELSE                                                         16636062
166370        IF PS-NO-ERROR                                            16637062
166380           MOVE SPACES           TO ASC-CAN                       16638062
166390        END-IF                                                    16639062
166391     END-IF.                                                      16639162
166392                                                                  16639262
166900* 2011-12-14 CHRISTINE TWIEHAUS WR40574 END                      *16690062
167000                                                                  16700062
167100     IF ASC-VEND-SHIP-DTE > SPACES AND PS-NO-ERROR                16710062
167200         PERFORM 3360-VALIDATE-VEND-SHIP-DTE                      16720062
167300         IF PS-INVALID-VND-DTE                                    16730062
167400             MOVE DP015-RED      TO AVNDMMC                       16740062
167500                                    AVNDDDC                       16750062
167600                                    AVNDYYC                       16760062
167700             MOVE DP015-REVERSE TO AVNDMMH                        16770062
167800                                   AVNDDDH                        16780062
167900                                   AVNDYYH                        16790062
168000             MOVE -1             TO AVNDMML                       16800062
168100             MOVE PC-TSYMSG-00009 TO DP020-MSG-NUMBER             16810062
168200             SET DP020-MSG-FATAL TO TRUE                          16820062
168300             SET PS-ERROR        TO TRUE                          16830062
168400             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  16840062
168500         END-IF                                                   16850062
168600     END-IF.                                                      16860062
168700                                                                  16870062
168800     IF  ASC-AUTH-DTE > SPACES AND PS-NO-ERROR                    16880062
168900         PERFORM 3370-VALIDATE-AUTH-DTE                           16890062
169000         IF  PS-INVALID-AUTH-DTE                                  16900062
169100             MOVE DP015-RED      TO AATHMMC                       16910062
169200                                    AATHDDC                       16920062
169300                                    AATHYYC                       16930062
169400             MOVE DP015-REVERSE  TO AATHMMH                       16940062
169500                                    AATHDDH                       16950062
169600                                    AATHYYH                       16960062
169700             MOVE -1             TO AATHMML                       16970062
169800             MOVE PC-TSYMSG-00009                                 16980062
169900                                 TO DP020-MSG-NUMBER              16990062
170000             SET DP020-MSG-FATAL TO TRUE                          17000062
170100             SET PS-ERROR        TO TRUE                          17010062
170200             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  17020062
170300         END-IF                                                   17030062
170400     END-IF.                                                      17040062
170500                                                                  17050062
170600                                                                  17060062
170700     IF  ASC-ETA-DTE > SPACES AND PS-NO-ERROR                     17070062
170800         PERFORM 3350-VALIDATE-ETA-DTE                            17080062
170900         IF  PS-INVALID-ETA-DTE                                   17090062
171000             MOVE DP015-RED      TO AETAMMC                       17100062
171100                                    AETADDC                       17110062
171200                                    AETAYYC                       17120062
171300             MOVE DP015-REVERSE  TO AETAMMH                       17130062
171400                                    AETADDH                       17140062
171500                                    AETAYYH                       17150062
171600             MOVE -1             TO AETAMML                       17160062
171700             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  17170062
171800             MOVE PC-TSYMSG-00009                                 17180062
171900                                 TO DP020-MSG-NUMBER              17190062
172000             SET DP020-MSG-FATAL TO TRUE                          17200062
172100             SET PS-ERROR        TO TRUE                          17210062
172200         END-IF                                                   17220062
172300     END-IF.                                                      17230062
172400                                                                  17240062
172500     IF ASC-ETA-TIME-MN = SPACES                                  17250062
172600        MOVE '00' TO ASC-ETA-TIME-MN                              17260062
172700     END-IF.                                                      17270062
172800                                                                  17280062
172900     IF ASC-ETA-TIME-HH = SPACES                                  17290062
173000        MOVE '00' TO ASC-ETA-TIME-HH                              17300062
173100     END-IF.                                                      17310062
173200                                                                  17320062
173300     IF ASC-ETA-TIME-HH = SPACES OR                               17330062
173400        ASC-ETA-TIME-HH = '00' OR PS-ERROR                        17340062
173500         CONTINUE                                                 17350062
173600     ELSE                                                         17360062
173700         MOVE ASC-ETA-TIME-HH      TO DP010I-UNEDITED-FIELD       17370062
173800         MOVE LENGTH OF ASC-ETA-TIME-HH TO DP010I-MAXIMUM-DIGITS  17380062
173900         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     17390062
174000         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  17400062
273427         CALL DP010I-NUMERIC-EDIT-ROUTINE                         17411083
273427              USING DP010I-NUMERIC-EDIT-AREA                      17412083
174200         IF  DP010I-ERROR-DETECTED                                17420062
174300             SET PS-ERROR                                         17430062
174400                 DP020-MSG-FATAL   TO TRUE                        17440062
174500             MOVE PC-TSYMSG-00008      TO DP020-MSG-NUMBER        17450062
174600             MOVE DP015-UNP-NUM-BRT-OFF                           17460062
174700                                       TO AETAHHA                 17470062
174800             MOVE DP015-RED            TO AETAHHC                 17480062
174900             MOVE DP015-REVERSE        TO AETAHHH                 17490062
175000             MOVE -1                   TO AETAHHL                 17500062
175100             SET DP030-SET-CURSOR-APPL-1                          17510062
175200                 PS-ERROR TO TRUE                                 17520062
175300         ELSE                                                     17530062
175400             IF DP010I-NUMERIC-FIELD > PC-24                      17540062
175500                 SET PS-ERROR              TO TRUE                17550062
175600                 SET DP020-MSG-FATAL       TO TRUE                17560062
175700                 MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER    17570062
175800                 MOVE DP015-UNP-NUM-BRT-OFF                       17580062
175900                                           TO AETAHHA             17590062
176000                 MOVE DP015-RED            TO AETAHHC             17600062
176100                 MOVE DP015-REVERSE        TO AETAHHH             17610062
176200                 MOVE -1                   TO AETAHHL             17620062
176300                 SET DP030-SET-CURSOR-APPL-1                      17630062
176400                     PS-ERROR TO TRUE                             17640062
176500             ELSE                                                 17650062
176600                 MOVE DP010I-NUMERIC-FIELD TO ASC-ETA-TIME-HH-N   17660062
176700                 MOVE ASC-ETA-TIME-HH  TO AETAHHO                 17670062
176800             END-IF                                               17680062
176900         END-IF                                                   17690062
177000     END-IF.                                                      17700062
177100                                                                  17710062
177200                                                                  17720062
177300     IF PS-ERROR OR                                               17730062
177400        ASC-ETA-TIME-MN = '00'                                    17740062
177500         CONTINUE                                                 17750062
177600     ELSE                                                         17760062
177700         MOVE ASC-ETA-TIME-MN      TO DP010I-UNEDITED-FIELD       17770062
177800         MOVE LENGTH OF ASC-ETA-TIME-MN TO DP010I-MAXIMUM-DIGITS  17780062
177900         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     17790062
178000         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  17800062
273427         CALL DP010I-NUMERIC-EDIT-ROUTINE                         17811083
273427              USING DP010I-NUMERIC-EDIT-AREA                      17812083
178200         IF  DP010I-ERROR-DETECTED                                17820062
178300             SET PS-ERROR                                         17830062
178400                 DP020-MSG-FATAL   TO TRUE                        17840062
178500             MOVE PC-TSYMSG-00008      TO DP020-MSG-NUMBER        17850062
178600             MOVE DP015-UNP-NUM-BRT-OFF                           17860062
178700                                       TO AETAMNA                 17870062
178800             MOVE DP015-RED            TO AETAMNC                 17880062
178900             MOVE DP015-REVERSE        TO AETAMNH                 17890062
179000             MOVE -1                   TO AETAMNL                 17900062
179100             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  17910062
179200         ELSE                                                     17920062
179300             IF DP010I-NUMERIC-FIELD > PC-59                      17930062
179400                 SET PS-ERROR              TO TRUE                17940062
179500                 SET DP020-MSG-FATAL       TO TRUE                17950062
179600                 MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER    17960062
179700                 MOVE DP015-UNP-NUM-BRT-OFF                       17970062
179800                                           TO AETAMNA             17980062
179900                 MOVE DP015-RED            TO AETAMNC             17990062
180000                 MOVE DP015-REVERSE        TO AETAMNH             18000062
180100                 MOVE -1                   TO AETAMNL             18010062
180200                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              18020062
180300             ELSE                                                 18030062
180400                 MOVE DP010I-NUMERIC-FIELD TO ASC-ETA-TIME-MN-N   18040062
180500                 MOVE ASC-ETA-TIME-MN  TO AETAMNO                 18050062
180600             END-IF                                               18060062
180700         END-IF                                                   18070062
180800      END-IF.                                                     18080062
180900                                                                  18090062
181000*  WHEN THE USER CHANGES THE FREIGHT BILL OR BILL OF LADING NUMBER18100062
181100*  THIS SHOULD BE THE START OF A NEW SHIPMENT.  IF THE FREIGHT BIL18110062
181200*  OR BILL OF LADING DID NOT CHANGE BUT THEY CHANGE OTHER SHIPMENT18120062
181300*  INFORMATION THIS IS AN ERROR AND THEY WILL BE DIRECTED TO GO TO18130062
181400*  THE SHIPMENT MAINTENANCE SCREEN.                               18140062
181500*                                                                 18150062
181600     IF ASC-PRO-NBR = SPACES AND ASC-BOL-NBR = SPACES             18160062
181700        PERFORM 3060-UNPROTECT-SHIP-FIELDS                        18170062
181800        PERFORM 3035-PROTECT-FIELDS                               18180062
181900     ELSE                                                         18190062
182000        IF ASC-PRO-NBR     NOT EQUAL ASC-PREV-PRO-NBR     OR      18200062
182100           ASC-BOL-NBR     NOT EQUAL ASC-PREV-BOL-NBR     OR      18210062
182200           ASC-PRO-SCAC-ID NOT EQUAL ASC-PREV-PRO-SCAC-ID         18220069
182300           IF DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              18230062
182400              OR (DP020-FK-CONFIRM (DP020-SRC-AID) AND ASC-ADD)   18240062
182500               SET PS-ERROR                                       18250062
182600                   PS-INQ-BEF-ADD  TO TRUE                        18260062
182700           ELSE                                                   18270062
182800               SET ASC-NEW-SHIPMENT                               18280062
182900                   ASC-OK-MATCH                                   18290062
183000                   ASC-SHIPT-STATUS-OK   TO TRUE                  18300062
183100               IF ASC-ORIG-SCAC-ID > SPACES OR                    18310062
183200                  ASC-PRO-SCAC-ID > SPACES                        18320062
183300                  PERFORM 3100-DETERMINE-EXIST-SHIP               18330062
183400                  IF ASC-SHIPMENT-EXIST                           18340062
183500                     PERFORM 3030-MOVE-SHIPMENT-INFO              18350062
183600                     PERFORM 3035-PROTECT-FIELDS                  18360062
183700                     PERFORM 3140-CHECK-SHIPT-STATUS              18370062
183800                     IF ASC-PO-NBR > SPACES AND PS-NO-ERROR       18380062
183900                        PERFORM 3160-SELECT-TSHPTPO               18390062
184000                        IF PS-FOUND                               18400062
184100                           MOVE SHPTPO-EXPTED-CART-CNT TO         18410062
184200                                ASC-PO-CARTON-CNT                 18420062
184300                                APOCNTO                           18430062
184400                        END-IF                                    18440062
184500                     END-IF                                       18450062
184600                  ELSE                                            18460062
184700                     IF ASC-MULT-SHIP-EXIST                       18470062
184800                        MOVE ASC-ORIG-PRO-NBR  TO ASC-PRO-NBR     18480062
184900                                                  ASC-PREV-PRO-NBR18490062
185000                        MOVE ASC-ORIG-COMP-PRO-NBR                18500062
185100                                        TO ASC-COMPLETE-PRO-NBR   18510062
185200                        MOVE ASC-ORIG-BOL-NBR  TO ASC-BOL-NBR     18520062
185300                                                  ASC-PREV-BOL-NBR18530062
185400                        MOVE ASC-ORIG-COMP-BOL-NBR                18540062
185500                                        TO ASC-COMPLETE-BOL-NBR   18550062
185510* 2011-12-14 CHRISTINE TWIEHAUS WR40574 START                    *18551062
185520                        MOVE ASC-ORIG-CAN TO ASC-CAN              18552066
185530                                             ASC-PREV-CAN         18553066
185540                        MOVE ASC-ORIG-COMP-CAN                    18554062
185550                                        TO ASC-COMPLETE-CAN       18555062
185560* 2011-12-14 CHRISTINE TWIEHAUS WR40574 END                      *18556068
185600                        MOVE SPACES     TO ASC-FB-CARTON-CNT      18560062
185700                                           ASC-PO-CARTON-CNT      18570062
185800                                           ASC-AUTH-CCYY          18580062
185900                                           ASC-AUTH-MM            18590062
186000                                           ASC-AUTH-DD            18600062
186100                                           ASC-AUTH-NBR           18610062
186200                                           ASC-VEND-SHIP-CCYY     18620062
186300                                           ASC-VEND-SHIP-MM       18630062
186400                                           ASC-VEND-SHIP-DD       18640062
186500                                           ASC-VEH-NBR            18650062
186600                                           ASC-ETA-DTE            18660062
186700                                           ASC-ETA-TIME           18670062
186800                        PERFORM 3035-PROTECT-FIELDS               18680062
186900                        SET ASC-MULTMATCH TO TRUE                 18690062
187000                        PERFORM 4400-MOVE-COMMAREA-TO-SCREEN      18700062
187100                     ELSE                                         18710062
187200                        PERFORM 3060-UNPROTECT-SHIP-FIELDS        18720062
187300                     END-IF                                       18730062
187400                  END-IF                                          18740062
187500               ELSE                                               18750062
187600                  MOVE DP015-RED      TO  ADSCACC                 18760062
187700                  MOVE DP015-REVERSE  TO  ADSCACH                 18770062
187800                  MOVE -1             TO  ADSCACL                 18780062
187900                  MOVE PC-TSYMSG-00007 TO DP020-MSG-NUMBER        18790062
188000                  SET DP030-SET-CURSOR-APPL-1                     18800062
188100                      DP020-MSG-FATAL                             18810062
188200                      PS-ERROR         TO TRUE                    18820062
188300               END-IF                                             18830062
188400           END-IF                                                 18840062
188500        END-IF                                                    18850062
188600     END-IF.                                                      18860062
188700                                                                  18870062
188800                                                                  18880062
188900     IF ASC-SHIPT-STATUS-NOTOK                                    18890062
189000        MOVE PC-TSYMSG-00992 TO DP020-MSG-NUMBER                  18900062
189100        MOVE ASC-TRIP-STATUS-CDE                                  18910062
189200                             TO DP020-MSG-TEXT                    18920062
189300        MOVE -1             TO APONBRL                            18930062
189400        SET DP030-SET-CURSOR-APPL-1 TO TRUE                       18940062
189500        SET DP020-MSG-FATAL TO TRUE                               18950062
189600        SET PS-ERROR                                              18960062
189700            PS-MSG-SET      TO TRUE                               18970062
189800     END-IF.                                                      18980062
189900                                                                  18990062
190000     IF  ASC-ORIG-SCAC-ID > SPACES AND PS-NO-ERROR                19000062
190100         MOVE ASC-ORIG-SCAC-ID TO DK-SCAC                         19010062
190200         PERFORM 3340-VALIDATE-SCAC                               19020062
190300         IF  PS-INVALID-SCAC                                      19030062
190400             MOVE DP015-RED      TO AOSCACC                       19040062
190500             MOVE DP015-REVERSE  TO AOSCACH                       19050062
190600             MOVE -1             TO AOSCACL                       19060062
190700             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  19070062
190800             MOVE PC-TSYMSG-00148                                 19080062
190900                                 TO DP020-MSG-NUMBER              19090062
191000             SET DP020-MSG-FATAL TO TRUE                          19100062
191100             SET PS-ERROR        TO TRUE                          19110062
191200         ELSE                                                     19120062
191300             PERFORM 3345-GET-SCAC-NAME                           19130062
191400             MOVE ENTNME-ENT-NAME-DESC                            19140062
191500                             TO ASC-ORIG-SCAC-DESC                19150062
191600                                AOSCDSCO                          19160062
191700         END-IF                                                   19170062
191800     ELSE                                                         19180062
191900         IF PS-NO-ERROR                                           19190062
192000            MOVE SPACES TO ASC-ORIG-SCAC-DESC                     19200062
192100                           AOSCDSCO                               19210062
192200         END-IF                                                   19220062
192300     END-IF.                                                      19230062
192400                                                                  19240062
192500     IF  ASC-PRO-SCAC-ID > SPACES AND PS-NO-ERROR                 19250062
192600         MOVE ASC-PRO-SCAC-ID TO DK-SCAC                          19260062
192700         PERFORM 3340-VALIDATE-SCAC                               19270062
192800         IF  PS-INVALID-SCAC                                      19280062
192900             MOVE DP015-RED      TO ADSCACC                       19290062
193000             MOVE DP015-REVERSE  TO ADSCACH                       19300062
193100             MOVE -1             TO ADSCACL                       19310062
193200             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  19320062
193300             MOVE PC-TSYMSG-00148                                 19330062
193400                                 TO DP020-MSG-NUMBER              19340062
193500             SET DP020-MSG-FATAL TO TRUE                          19350062
193600             SET PS-ERROR        TO TRUE                          19360062
193700         ELSE                                                     19370062
193800             PERFORM 3345-GET-SCAC-NAME                           19380062
193900             MOVE ENTNME-ENT-NAME-DESC                            19390062
194000                             TO ASC-PRO-SCAC-DESC                 19400062
194100                                ADSCDSCO                          19410062
194200         END-IF                                                   19420062
194300      ELSE                                                        19430062
194400         IF PS-NO-ERROR                                           19440062
194500            MOVE SPACES TO ASC-PRO-SCAC-DESC                      19450062
194600                           ADSCDSCO                               19460062
194700         END-IF                                                   19470062
194800     END-IF.                                                      19480062
194900                                                                  19490062
195000     IF (ASC-VEND-SHIP-DTE > SPACES AND ASC-VEND-SHIP-DTE         19500062
195100         NOT EQUAL '01010001') AND PS-NO-ERROR                    19510062
195200        PERFORM 4340-CONV-DATES-TO-CCYYMMDD                       19520062
195300        IF PV-VEND-SHIP-DTE < PV-DONT-SHIP-BEF-DTE                19530062
195400           MOVE DP015-YELLOW       TO ABEFDTEC                    19540062
195500                                      AVNDMMC                     19550062
195600                                      AVNDDDC                     19560062
195700                                      AVNDYYC                     19570062
195800        ELSE                                                      19580062
195900           IF ASC-EXT-CAN-DTE = PC-DEFAULT-DATE-RDF               19590062
196000              IF PV-VEND-SHIP-DTE > PV-CAN-IFNOT-SHIP-DTE         19600062
196100                 MOVE DP015-YELLOW TO AVNDMMC                     19610062
196200                                      AVNDDDC                     19620062
196300                                      AVNDYYC                     19630062
196400                                      ACANDTEC                    19640062
196500              END-IF                                              19650062
196600           ELSE                                                   19660062
196700              IF PV-VEND-SHIP-DTE > PV-EXT-CAN-DTE                19670062
196800                 MOVE DP015-YELLOW TO AVNDMMC                     19680062
196900                                      AVNDDDC                     19690062
197000                                      AVNDYYC                     19700062
197100                                      AEXCDTEC                    19710062
197200              END-IF                                              19720062
197300           END-IF                                                 19730062
197400        END-IF                                                    19740062
197500     END-IF.                                                      19750062
197600                                                                  19760062
197700     IF PS-INQ-BEF-ADD AND PS-MSG-NOT-SET                         19770062
197800        SET PS-INQ-OK TO TRUE                                     19780062
197900        MOVE PC-TSYMSG-01003 TO DP020-MSG-NUMBER                  19790062
198000        MOVE -1 TO APONBRL                                        19800062
198100        SET DP020-MSG-FATAL                                       19810062
198200            DP030-SET-CURSOR-APPL-1 TO TRUE                       19820062
198300     END-IF.                                                      19830062
198400                                                                  19840062
198500     IF  PS-NO-ERROR                                              19850062
198600         MOVE ASC-PRO-NBR          TO ASC-PREV-PRO-NBR            19860062
198700         MOVE ASC-COMPLETE-PRO-NBR TO ASC-PREV-COMP-PRO-NBR       19870062
198701* 2011-12-14 CHRISTINE TWIEHAUS WR40574 START                    *19870173
198710         MOVE ASC-CAN              TO ASC-PREV-CAN                19871062
198720         MOVE ASC-COMPLETE-CAN     TO ASC-PREV-COMP-CAN           19872062
198730* 2011-12-14 CHRISTINE TWIEHAUS WR40574 END                      *19873073
198800         MOVE ASC-BOL-NBR          TO ASC-PREV-BOL-NBR            19880062
198900         MOVE ASC-COMPLETE-BOL-NBR TO ASC-PREV-COMP-BOL-NBR       19890062
199000         MOVE ASC-PRO-SCAC-ID      TO ASC-PREV-PRO-SCAC-ID        19900062
199100     END-IF.                                                      19910062
199200                                                                  19920062
199300     IF PS-PO-INQUIRY                                             19930062
199400        NEXT SENTENCE                                             19940062
199500     ELSE                                                         19950062
199600        IF ASC-ETA-DTE = SPACES                                   19960062
199700           SET PS-ERROR                                           19970062
199800               DP020-MSG-FATAL       TO TRUE                      19980062
199900           MOVE PC-TSYMSG-00007      TO DP020-MSG-NUMBER          19990062
200000           MOVE DP015-UNP-ALP-BRT-OFF                             20000062
200100                                     TO AETAMMA                   20010062
200200           MOVE DP015-RED            TO AETAMMC                   20020062
200300           MOVE DP015-REVERSE        TO AETAMMH                   20030062
200400           MOVE -1                   TO AETAMML                   20040062
200500           MOVE DP015-UNP-ALP-BRT-OFF                             20050062
200600                                     TO AETADDA                   20060062
200700           MOVE DP015-RED            TO AETADDC                   20070062
200800           MOVE DP015-REVERSE        TO AETADDH                   20080062
200900           MOVE -1                   TO AETADDL                   20090062
201000           MOVE DP015-UNP-ALP-BRT-OFF                             20100062
201100                                     TO AETAYYA                   20110062
201200           MOVE DP015-RED            TO AETAYYC                   20120062
201300           MOVE DP015-REVERSE        TO AETAYYH                   20130062
201400           MOVE -1                   TO AETAYYL                   20140062
201500           SET DP030-SET-CURSOR-APPL-1                            20150062
201600                                     TO TRUE                      20160062
201700        END-IF                                                    20170062
201800        IF ASC-PRO-SCAC-ID = SPACES                               20180062
201900          IF ASC-ORIG-SCAC-ID = SPACES                            20190062
202000              SET PS-ERROR                                        20200062
202100                  DP020-MSG-FATAL       TO TRUE                   20210062
202200*          ---- REQUIRED FIELD ----                               20220062
202300              MOVE PC-TSYMSG-00007      TO DP020-MSG-NUMBER       20230062
202400              MOVE DP015-UNP-ALP-BRT-OFF                          20240062
202500                                        TO AOSCACA                20250062
202600              MOVE DP015-RED            TO AOSCACC                20260062
202700              MOVE DP015-REVERSE        TO AOSCACH                20270062
202800              MOVE -1                   TO AOSCACL                20280062
202900              SET DP030-SET-CURSOR-APPL-1                         20290062
203000                                        TO TRUE                   20300062
203100          END-IF                                                  20310062
203200        END-IF                                                    20320062
203300                                                                  20330062
203400        IF ASC-COMPLETE-PRO-NBR = SPACES                          20340062
203500           IF ASC-COMPLETE-BOL-NBR = SPACES                       20350062
203600              SET PS-ERROR                                        20360062
203700                  DP020-MSG-FATAL       TO TRUE                   20370062
203800              MOVE PC-TSYMSG-00991      TO DP020-MSG-NUMBER       20380062
203900              MOVE DP015-UNP-ALP-BRT-OFF                          20390062
204000                                        TO AFBNBRA                20400062
204100              MOVE DP015-RED            TO AFBNBRC                20410062
204200              MOVE DP015-REVERSE        TO AFBNBRH                20420062
204300              MOVE -1                   TO AFBNBRL                20430062
204400              SET DP030-SET-CURSOR-APPL-1                         20440062
204500                                        TO TRUE                   20450062
204600           END-IF                                                 20460062
204700        END-IF                                                    20470062
204800                                                                  20480062
204900        IF ASC-FB-CARTON-CNT = SPACES                             20490062
205000           SET PS-ERROR                                           20500062
205100               DP020-MSG-FATAL       TO TRUE                      20510062
205200           MOVE PC-TSYMSG-00007      TO DP020-MSG-NUMBER          20520062
205300           MOVE DP015-UNP-ALP-BRT-OFF                             20530062
205400                                     TO AFBCNTA                   20540062
205500           MOVE DP015-RED            TO AFBCNTC                   20550062
205600           MOVE DP015-REVERSE        TO AFBCNTH                   20560062
205700           MOVE -1                   TO AFBCNTL                   20570062
205800           SET DP030-SET-CURSOR-APPL-1                            20580062
205900                                     TO TRUE                      20590062
206000        END-IF                                                    20600062
206100                                                                  20610062
206200        IF ASC-PO-NBR = ZEROES OR SPACES                          20620062
206300           SET PS-ERROR                                           20630062
206400               DP020-MSG-FATAL       TO TRUE                      20640062
206500*          ---- REQUIRED FIELD ----                               20650062
206600           MOVE PC-TSYMSG-00007      TO DP020-MSG-NUMBER          20660062
206700           MOVE DP015-UNP-ALP-BRT-OFF                             20670062
206800                                     TO APONBRA                   20680062
206900           MOVE DP015-RED            TO APONBRC                   20690062
207000           MOVE DP015-REVERSE        TO APONBRH                   20700062
207100           MOVE -1                   TO APONBRL                   20710062
207200           SET DP030-SET-CURSOR-APPL-1                            20720062
207300                                     TO TRUE                      20730062
207400        END-IF                                                    20740062
207500     END-IF.                                                      20750062
207600                                                                  20760062
207700     IF PS-NO-ERROR                                               20770062
207800         MOVE -1                   TO APONBRL                     20780062
207900         SET DP030-SET-CURSOR-APPL-1                              20790062
208000                                   TO TRUE                        20800062
208100     END-IF.                                                      20810062
208200*                                                                 20820062
208300*                                                                 20830062
208400 3020-DETERMINE-ADD.                                              20840062
208500                                                                  20850062
208600     IF ASC-SHIPMENT-EXIST                                        20860062
208700        PERFORM 5000-INSERT-TSHPTPO                               20870062
208800        IF PS-FOUND                                               20880062
208900           MOVE DP015-RED      TO APONBRC                         20890062
209000           MOVE DP015-REVERSE  TO APONBRH                         20900062
209100           MOVE -1             TO APONBRL                         20910062
209200           SET DP030-SET-CURSOR-APPL-1 TO TRUE                    20920062
209300           MOVE PC-TSYMSG-00993                                   20930062
209400                               TO DP020-MSG-NUMBER                20940062
209500           SET DP020-MSG-FATAL TO TRUE                            20950062
209600           SET PS-ERROR        TO TRUE                            20960062
209700        ELSE                                                      20970062
209800           MOVE PC-TSYMSG-00034  TO DP020-MSG-NUMBER              20980062
209900           SET DP020-MSG-INFORMATIONAL TO TRUE                    20990062
210000           PERFORM 3035-PROTECT-FIELDS                            21000062
210100           PERFORM 4350-INITIALIZE-PO-FIELDS                      21010062
210110* 2011-12-14 CHRISTINE TWIEHAUS WR40574 START                    *21011062
210200           IF ASC-UPD-PRO OR                                      21020062
210210              ASC-UPD-CAN                                         21021066
210220* 2011-12-14 CHRISTINE TWIEHAUS WR40574 END                      *21022062
210300              PERFORM 5100-UPDATE-TSHIPMT                         21030062
210400           END-IF                                                 21040062
210500           IF ASC-UPD-BOL                                         21050062
210600              PERFORM 5200-UPDATE-TSHIPMT2                        21060062
210700           END-IF                                                 21070062
210800        END-IF                                                    21080062
210900     ELSE                                                         21090062
211000        IF ASC-VEH-NBR > SPACES                                   21100062
211100           PERFORM 3050-CHECK-TRIP                                21110062
211200           IF PS-FOUND                                            21120062
211300              IF DN-TRIP-ID = -1                                  21130062
211400                 SET PS-LINK-SHIPMENT TO TRUE                     21140062
211500              ELSE                                                21150062
211600                 PERFORM 3070-GET-ETA-DATE                        21160062
211700              END-IF                                              21170062
211800           ELSE                                                   21180062
211900              SET PS-ADD-NEW-TRAILER TO TRUE                      21190062
212000           END-IF                                                 21200062
212100        ELSE                                                      21210062
212200           SET PS-ADD-NEW-TRIP                                    21220062
212300               PS-NULL-VEHICLE-NBR TO TRUE                        21230062
212400        END-IF                                                    21240062
212500        IF ASC-NEW-SHIPMENT                                       21250062
212600           SET ASC-SAME-SHIPMENT TO TRUE                          21260062
212700           IF PS-USE-TRIP                                         21270062
212800              CONTINUE                                            21280062
212900           ELSE                                                   21290062
213000              PERFORM 4500-GET-RANDOM-NUMBER                      21300062
213100              PERFORM 4550-READ-DUPL-TVHTRIP                      21310062
213200                   WITH TEST AFTER                                21320062
213300                   UNTIL PV-VHTRIP-COUNT = 0                      21330062
213400              MOVE PV-CURR-TRIP-ID TO ASC-TRIP-ID                 21340062
213500           END-IF                                                 21350062
213600           PERFORM 4500-GET-RANDOM-NUMBER                         21360062
213700           PERFORM 4560-READ-DUPL-TSHIPMT                         21370062
213800                WITH TEST AFTER                                   21380062
213900                UNTIL PV-SHIPMT-COUNT = 0                         21390062
214000           MOVE PV-CURR-SHIPT-ID TO ASC-SHIPT-ID                  21400062
214100        END-IF                                                    21410062
214200        EVALUATE TRUE                                             21420062
214300           WHEN PS-ADD-NEW-TRIP                                   21430062
214400                PERFORM 5010-INSERT-TVHTRIP                       21440062
214500                PERFORM 5020-INSERT-TSHIPMT                       21450062
214600                PERFORM 5000-INSERT-TSHPTPO                       21460062
214700           WHEN PS-ADD-NEW-TRAILER                                21470062
214800                PERFORM 5050-INSERT-TVEHICL                       21480062
214900                PERFORM 5010-INSERT-TVHTRIP                       21490062
215000                PERFORM 5020-INSERT-TSHIPMT                       21500062
215100                PERFORM 5000-INSERT-TSHPTPO                       21510062
215200           WHEN PS-LINK-SHIPMENT                                  21520062
215300                PERFORM 5060-UPDATE-TVEHICL                       21530062
215400                PERFORM 5010-INSERT-TVHTRIP                       21540062
215500                PERFORM 5020-INSERT-TSHIPMT                       21550062
215600                PERFORM 5000-INSERT-TSHPTPO                       21560062
215700           WHEN PS-LINK-TRIP                                      21570062
215800                PERFORM 5020-INSERT-TSHIPMT                       21580062
215900                PERFORM 5000-INSERT-TSHPTPO                       21590062
216000           WHEN OTHER                                             21600062
216100                MOVE                                              21610062
216200                'PROGRAM ERROR IN 3020-DETERMINE-ADD'             21620062
216300                              TO DP020-MSG-TEXT                   21630062
216400                 MOVE -1             TO APONBRL                   21640062
216500                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              21650062
216600                 SET DP020-MSG-FATAL TO TRUE                      21660062
216700                 SET PS-ERROR        TO TRUE                      21670062
216800        END-EVALUATE                                              21680062
216900        MOVE PC-TSYMSG-00034  TO DP020-MSG-NUMBER                 21690062
217000        SET DP020-MSG-INFORMATIONAL TO TRUE                       21700062
217100        SET ASC-SHIPMENT-EXIST TO TRUE                            21710062
217200        PERFORM 3035-PROTECT-FIELDS                               21720062
217300        PERFORM 4350-INITIALIZE-PO-FIELDS                         21730062
217400     END-IF.                                                      21740062
217500                                                                  21750062
217600                                                                  21760062
217700 3030-MOVE-SHIPMENT-INFO.                                         21770062
217800                                                                  21780062
217900     IF ASC-UPD-PRO                                               21790062
218000        CONTINUE                                                  21800062
218100     ELSE                                                         21810062
218200        MOVE SHIPMT-PRO-NBR          TO ASC-PRO-NBR               21820062
218300     END-IF.                                                      21830062
218400                                                                  21840062
218410* 2011-12-14 CHRISTINE TWIEHAUS WR40574 START                    *21841062
218420     IF ASC-UPD-CAN                                               21842062
218430        CONTINUE                                                  21843062
218440     ELSE                                                         21844062
218450        MOVE SHIPMT-CARR-AUTH-ID     TO ASC-CAN                   21845062
218460     END-IF.                                                      21846062
218461* 2011-12-14 CHRISTINE TWIEHAUS WR40574 END                      *21846162
218470                                                                  21847062
218500     IF ASC-UPD-BOL                                               21850062
218600        CONTINUE                                                  21860062
218700     ELSE                                                         21870062
218800        MOVE SHIPMT-BOL-NBR          TO ASC-BOL-NBR               21880062
218900     END-IF.                                                      21890062
219000                                                                  21900062
219100     MOVE SHIPMT-EXPTED-PKG-QTY   TO ASC-FB-CARTON-CNT-N.         21910062
219200     MOVE SHIPMT-AUTH-DTE         TO PV-TEMP-DATE.                21920062
219300     MOVE PV-DATE-CCYY            TO ASC-AUTH-CCYY.               21930062
219400     MOVE PV-DATE-MM              TO ASC-AUTH-MM.                 21940062
219500     MOVE PV-DATE-DD              TO ASC-AUTH-DD.                 21950062
219510* 2011-12-14 CHRISTINE TWIEHAUS WR40574 START                    *21951062
219600     MOVE SHIPMT-CARR-AUTH-ID     TO ASC-CAN.                     21960062
219610* 2011-12-14 CHRISTINE TWIEHAUS WR40574 END                      *21961062
219620     MOVE SHIPMT-AUTH-NBR         TO ASC-AUTH-NBR.                21962062
219700     MOVE SHIPMT-ORIG-SCAC-ID     TO ASC-ORIG-SCAC-ID.            21970062
219800     MOVE SHIPMT-PRO-SCAC-ID      TO ASC-PRO-SCAC-ID.             21980062
219900     MOVE SHIPMT-VEND-SHIP-DTE    TO PV-TEMP-DATE.                21990062
220000     MOVE PV-DATE-CCYY            TO ASC-VEND-SHIP-CCYY.          22000062
220100     MOVE PV-DATE-MM              TO ASC-VEND-SHIP-MM.            22010062
220200     MOVE PV-DATE-DD              TO ASC-VEND-SHIP-DD.            22020062
220300                                                                  22030062
220400     IF DN-VEH-NBR = -1                                           22040062
220500        MOVE SPACES               TO ASC-VEH-NBR                  22050062
220600     ELSE                                                         22060062
220700        MOVE VHTRIP-VEH-NBR       TO ASC-VEH-NBR                  22070062
220800     END-IF.                                                      22080062
220900                                                                  22090062
221000     IF DN-EST-AR-TMST = -1                                       22100062
221100        MOVE SPACES               TO ASC-ETA-DTE                  22110062
221200                                     ASC-ETA-TIME                 22120062
221300     ELSE                                                         22130062
221400        MOVE VHTRIP-EST-AR-TMST   TO PV-TEMP-TMST                 22140062
221500        MOVE PV-TMST-CCYY         TO ASC-ETA-CCYY                 22150062
221600        MOVE PV-TMST-MM           TO ASC-ETA-MM                   22160062
221700        MOVE PV-TMST-DD           TO ASC-ETA-DD                   22170062
221800        MOVE PV-TMST-HH           TO ASC-ETA-TIME-HH              22180062
221900        MOVE PV-TMST-MN           TO ASC-ETA-TIME-MN              22190062
222000     END-IF.                                                      22200062
222100                                                                  22210062
222200     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        22220062
222300                                                                  22230062
222400 3035-PROTECT-FIELDS.                                             22240062
222500                                                                  22250062
222600     MOVE DP015-ASK-NOR-OFF       TO  AVNDMMA                     22260062
222700                                      AVNDDDA                     22270062
222800                                      AVNDYYA                     22280062
222900                                      AFBCNTA                     22290062
223000                                      AATHNBRA                    22300062
223100                                      AATHMMA                     22310062
223200                                      AATHDDA                     22320062
223300                                      AATHYYA                     22330062
223400                                      ATRLRNOA                    22340062
223500                                      AETAMMA                     22350062
223600                                      AETADDA                     22360062
223700                                      AETAYYA                     22370062
223800                                      AETAHHA                     22380062
223900                                      AETAMNA.                    22390062
224000                                                                  22400062
224100     MOVE DP015-BLUE              TO  AVNDMMC                     22410062
224200                                      AVNDDDC                     22420062
224300                                      AVNDYYC                     22430062
224400                                      AFBCNTC                     22440062
224500                                      AATHNBRC                    22450062
224600                                      AATHMMC                     22460062
224700                                      AATHDDC                     22470062
224800                                      AATHYYC                     22480062
224900                                      ATRLRNOC                    22490062
225000                                      AETAMMC                     22500062
225100                                      AETADDC                     22510062
225200                                      AETAYYC                     22520062
225300                                      AETAHHC                     22530062
225400                                      AETAMNC.                    22540062
225500                                                                  22550062
225600 3050-CHECK-TRIP.                                                 22560062
225700                                                                  22570062
225800     IF ASC-PRO-SCAC-ID = SPACES                                  22580062
225900        MOVE ASC-ORIG-SCAC-ID TO DK-SCAC                          22590062
226000     ELSE                                                         22600062
226100        MOVE ASC-PRO-SCAC-ID  TO DK-SCAC                          22610062
226200     END-IF.                                                      22620062
226300                                                                  22630062
226400     PERFORM WITH TEST AFTER                                      22640062
226500         VARYING PV-RETRY-COUNTER                                 22650062
226600         FROM 1 BY 1                                              22660062
226700         UNTIL (PV-RETRY-COUNTER > PC-MAX-RETRIES                 22670062
226800                 OR SQLCODE = 0                                   22680062
226900                 OR SQLCODE = +100)                               22690062
227000                                                                  22700062
227100         EXEC SQL                                                 22710062
227200             SELECT CURR_STATUS_CDE                               22720062
227300                   ,CURR_TRIP_ID                                  22730062
227400             INTO   :VEHICL-CURR-STATUS-CDE                       22740062
227500                   ,:VEHICL-CURR-TRIP-ID :DN-TRIP-ID              22750062
227600             FROM   TVEHICL                                       22760062
227700             WHERE  VEH_NBR       = :ASC-VEH-NBR                  22770062
227800               AND  OWNER_SCAC_ID = :DK-SCAC                      22780062
227900         END-EXEC                                                 22790062
228000                                                                  22800062
228100         EVALUATE TRUE                                            22810062
228200             WHEN SQLCODE = ZERO                                  22820062
228300             WHEN SQLCODE = +100                                  22830062
228400             WHEN SQLCODE = -904                                  22840062
228500             WHEN SQLCODE = -913                                  22850062
228600                 CONTINUE                                         22860062
228700             WHEN SQLWARN0 NOT = SPACES                           22870062
228800             WHEN SQLCODE NOT EQUAL ZERO                          22880062
228900                 MOVE SPACES TO PV-MESSAGE                        22890062
229000                 MOVE ASC-VEH-NBR TO PV-MESSAGE1                  22900062
229100                 MOVE DK-SCAC     TO PV-MESSAGE2                  22910062
229200                 MOVE '3050-CHECK-TRIP '                          22920062
229300                                 TO DP013-PARAGRAPH               22930062
229400                 MOVE 'CHECK TRIP EXISTANCE'                      22940062
229500                                 TO DP013-MESSAGE-TEXT(1)         22950062
229600                 MOVE PV-MESSAGE TO DP013-MESSAGE-TEXT(2)         22960062
229700                 MOVE SQLCA      TO DP013-SQLCA                   22970062
229800                 MOVE 'TVEHICL'  TO DP013-DB2-TABLE-NAME(1)       22980062
229900                 SET DP013-DB2-ABEND                              22990062
230000                                 TO TRUE                          23000062
230100                 SET DP013-NO-ROLLBACK                            23010062
230200                                 TO TRUE                          23020062
230300                 SET DP013-XCTL-DISPLAY-RESTART                   23030062
230400                                 TO TRUE                          23040062
230500                 PERFORM DP013-0000-PROCESS-ABEND                 23050062
230600         END-EVALUATE                                             23060062
230700     END-PERFORM.                                                 23070062
230800                                                                  23080062
230900     IF PV-RETRY-COUNTER > PC-MAX-RETRIES AND                     23090062
231000         SQLCODE NOT = +0                                         23100062
231100         MOVE '3050-CHECK-TRIP '                                  23110062
231200                                 TO DP013-PARAGRAPH               23120062
231300         MOVE 'CHECK TRIP EXISTANCE' TO DP013-MESSAGE-TEXT(1)     23130062
231400         MOVE 'MAX NUMBER OF RETRIES EXCEEDED'                    23140062
231500                                 TO DP013-MESSAGE-TEXT(2)         23150062
231600         MOVE SQLCA              TO DP013-SQLCA                   23160062
231700         MOVE 'TVEHICL'          TO DP013-DB2-TABLE-NAME(1)       23170062
231800         SET DP013-DB2-ABEND     TO TRUE                          23180062
231900         SET DP013-NO-ROLLBACK   TO TRUE                          23190062
232000         SET DP013-XCTL-DISPLAY-RESTART                           23200062
232100                                 TO TRUE                          23210062
232200         PERFORM DP013-0000-PROCESS-ABEND                         23220062
232300     END-IF.                                                      23230062
232400                                                                  23240062
232500     EVALUATE TRUE                                                23250062
232600         WHEN SQLCODE = ZERO                                      23260062
232700              SET PS-FOUND TO TRUE                                23270062
232800         WHEN SQLCODE = +100                                      23280062
232900              SET PS-NOT-FOUND TO TRUE                            23290062
233000     END-EVALUATE.                                                23300062
233100                                                                  23310062
233200                                                                  23320062
233300                                                                  23330062
233400 3060-UNPROTECT-SHIP-FIELDS.                                      23340062
233500                                                                  23350062
233600     MOVE SPACES                  TO ASC-FB-CARTON-CNT            23360062
233700                                     ASC-PO-CARTON-CNT            23370062
233800                                     ASC-AUTH-CCYY                23380062
233900                                     ASC-AUTH-MM                  23390062
234000                                     ASC-AUTH-DD                  23400062
234100                                     ASC-AUTH-NBR                 23410062
234200*                                    ASC-ORIG-SCAC-ID             23420062
234300*                                    ASC-PRO-SCAC-ID              23430062
234400*                                    ASC-ORIG-SCAC-DESC           23440062
234500*                                    ASC-PRO-SCAC-DESC            23450062
234600                                     ASC-VEND-SHIP-CCYY           23460062
234700                                     ASC-VEND-SHIP-MM             23470062
234800                                     ASC-VEND-SHIP-DD             23480062
234900                                     ASC-VEH-NBR                  23490062
234910* 2011-12-14 CHRISTINE TWIEHAUS WR40574 START                    *23491062
234920                                     ASC-CAN                      23492062
234930* 2011-12-14 CHRISTINE TWIEHAUS WR40574 END                      *23493062
235000                                     ASC-ETA-DTE                  23500062
235100                                     ASC-ETA-TIME.                23510062
235200                                                                  23520062
235300     MOVE DP015-UNP-ALP-NOR-OFF    TO AFBNBRA                     23530062
235400                                      ABOLNBRA                    23540062
235500                                      AVNDMMA                     23550062
235600                                      AVNDDDA                     23560062
235700                                      AFBCNTA                     23570062
235800                                      AVNDYYA                     23580062
235900                                      AATHNBRA                    23590062
236000                                      AATHMMA                     23600062
236100                                      AATHDDA                     23610062
236200                                      AATHYYA                     23620062
236300                                      AOSCACA                     23630062
236400                                      ADSCACA                     23640062
236500                                      ATRLRNOA                    23650062
236510* 2011-12-14 CHRISTINE TWIEHAUS WR40574 START                    *23651062
236520                                      ACANA                       23652062
236530* 2011-12-14 CHRISTINE TWIEHAUS WR40574 END                      *23653062
236600                                      AETAMMA                     23660062
236700                                      AETADDA                     23670062
236800                                      AETAYYA                     23680062
236900                                      AETAHHA                     23690062
237000                                      AETAMNA.                    23700062
237100                                                                  23710062
237200     MOVE DP015-GREEN              TO AFBNBRC                     23720062
237300                                      ABOLNBRC                    23730062
237400                                      AVNDMMC                     23740062
237500                                      AVNDDDC                     23750062
237600                                      AVNDYYC                     23760062
237700                                      AFBCNTC                     23770062
237800                                      AATHNBRC                    23780062
237900                                      AATHMMC                     23790062
238000                                      AATHDDC                     23800062
238100                                      AATHYYC                     23810062
238200                                      AOSCACC                     23820062
238300                                      ADSCACC                     23830062
238400                                      ATRLRNOC                    23840062
238410* 2011-12-14 CHRISTINE TWIEHAUS WR40574 START                    *23841062
238420                                      ACANC                       23842062
238430* 2011-12-14 CHRISTINE TWIEHAUS WR40574 END                      *23843062
238500                                      AETAMMC                     23850062
238600                                      AETADDC                     23860062
238700                                      AETAYYC                     23870062
238800                                      AETAHHC                     23880062
238900                                      AETAMNC.                    23890062
239000                                                                  23900062
239100     MOVE DP015-UNDERLINE          TO AFBNBRH                     23910062
239200                                      ABOLNBRH                    23920062
239300                                      AFBCNTH                     23930062
239400                                      AVNDMMH                     23940062
239500                                      AVNDDDH                     23950062
239600                                      AVNDYYH                     23960062
239700                                      AATHNBRH                    23970062
239800                                      AATHMMH                     23980062
239900                                      AATHDDH                     23990062
240000                                      AATHYYH                     24000062
240100                                      AOSCACH                     24010062
240200                                      ADSCACH                     24020062
240300                                      ATRLRNOH                    24030062
240310* 2011-12-14 CHRISTINE TWIEHAUS WR40574 START                    *24031062
240320                                      ACANH                       24032062
240330* 2011-12-14 CHRISTINE TWIEHAUS WR40574 END                      *24033062
240400                                      AETAMMH                     24040062
240500                                      AETADDH                     24050062
240600                                      AETAYYH                     24060062
240700                                      AETAHHH                     24070062
240800                                      AETAMNH.                    24080062
240900                                                                  24090062
241000     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        24100062
241100                                                                  24110062
241200 3070-GET-ETA-DATE.                                               24120062
241300                                                                  24130062
241400     PERFORM WITH TEST AFTER                                      24140062
241500         VARYING PV-RETRY-COUNTER                                 24150062
241600         FROM 1 BY 1                                              24160062
241700         UNTIL (PV-RETRY-COUNTER > PC-MAX-RETRIES                 24170062
241800                 OR SQLCODE = 0                                   24180062
241900                 OR SQLCODE = +100)                               24190062
242000                                                                  24200062
242100         EXEC SQL                                                 24210062
242200             SELECT (DATE(EST_AR_TMST))                           24220062
242300                   , TRIP_ID                                      24230062
242400             INTO   :PV-DATE :DN-EST-AR-TMST                      24240062
242500                   ,:PV-VHTRIP-TRIP-ID                            24250062
242600             FROM   TVHTRIP                                       24260062
242700             WHERE  VEH_NBR       = :ASC-VEH-NBR                  24270062
242800               AND  OWNER_SCAC_ID = :DK-SCAC                      24280062
242900               AND  TRIP_ID       = :VEHICL-CURR-TRIP-ID          24290062
243000         END-EXEC                                                 24300062
243100                                                                  24310062
243200         EVALUATE TRUE                                            24320062
243300             WHEN SQLCODE = ZERO                                  24330062
243400             WHEN SQLCODE = +100                                  24340062
243500             WHEN SQLCODE = -904                                  24350062
243600             WHEN SQLCODE = -913                                  24360062
243700                 CONTINUE                                         24370062
243800             WHEN SQLWARN0 NOT = SPACES                           24380062
243900             WHEN SQLCODE NOT EQUAL ZERO                          24390062
244000                 MOVE SPACES TO PV-MESSAGE                        24400062
244100                 MOVE ASC-VEH-NBR TO PV-MESSAGE1                  24410062
244200                 MOVE DK-SCAC     TO PV-MESSAGE2                  24420062
244300                 MOVE VEHICL-CURR-TRIP-ID TO PV-MESSAGE3          24430062
244400                 MOVE '3070-GET-ETA-DATE'                         24440062
244500                                 TO DP013-PARAGRAPH               24450062
244600                 MOVE 'GET ETA DATE '                             24460062
244700                                 TO DP013-MESSAGE-TEXT(1)         24470062
244800                 MOVE PV-MESSAGE TO DP013-MESSAGE-TEXT(2)         24480062
244900                 MOVE SQLCA      TO DP013-SQLCA                   24490062
245000                 MOVE 'TVHTRIP'  TO DP013-DB2-TABLE-NAME(1)       24500062
245100                 SET DP013-DB2-ABEND                              24510062
245200                                 TO TRUE                          24520062
245300                 SET DP013-NO-ROLLBACK                            24530062
245400                                 TO TRUE                          24540062
245500                 SET DP013-XCTL-DISPLAY-RESTART                   24550062
245600                                 TO TRUE                          24560062
245700                 PERFORM DP013-0000-PROCESS-ABEND                 24570062
245800         END-EVALUATE                                             24580062
245900     END-PERFORM.                                                 24590062
246000                                                                  24600062
246100     IF PV-RETRY-COUNTER > PC-MAX-RETRIES AND                     24610062
246200         SQLCODE NOT = +0                                         24620062
246300         MOVE '3070-GET-ETA-DATE'                                 24630062
246400                                 TO DP013-PARAGRAPH               24640062
246500         MOVE 'GET ETA DATE '        TO DP013-MESSAGE-TEXT(1)     24650062
246600         MOVE 'MAX NUMBER OF RETRIES EXCEEDED'                    24660062
246700                                 TO DP013-MESSAGE-TEXT(2)         24670062
246800         MOVE SQLCA              TO DP013-SQLCA                   24680062
246900         MOVE 'TVHTRIP'          TO DP013-DB2-TABLE-NAME(1)       24690062
247000         SET DP013-DB2-ABEND     TO TRUE                          24700062
247100         SET DP013-NO-ROLLBACK   TO TRUE                          24710062
247200         SET DP013-XCTL-DISPLAY-RESTART                           24720062
247300                                 TO TRUE                          24730062
247400         PERFORM DP013-0000-PROCESS-ABEND                         24740062
247500     END-IF.                                                      24750062
247600                                                                  24760062
247700     EVALUATE TRUE                                                24770062
247800         WHEN SQLCODE = ZERO                                      24780062
247900              IF  DN-EST-AR-TMST NOT EQUAL -1                     24790062
248000                  MOVE PV-DATE TO PV-TEMP-DATE                    24800062
248100                  MOVE PV-DATE-CCYY TO PV-VALID-DATE-CCYY         24810062
248200                  MOVE PV-DATE-MM   TO PV-VALID-DATE-MM           24820062
248300                  MOVE PV-DATE-DD   TO PV-VALID-DATE-DD           24830062
248400                  MOVE PV-VALID-DATE TO PV-VALID-ETA-DTE-2        24840062
248500                  PERFORM 3075-GET-PRTY-CDE                       24850062
248600                  IF TRSTYP-PRTY-CDE <= '30'                      24860062
248700                     PERFORM 3600-CALL-DATE-RANGE-RTN             24870062
248800                     IF DPG54-DATE-VALID                          24880062
248900                        IF DPG55-DAYS-DIFFERENCE > 3 OR           24890062
249000                           DPG55-DAYS-DIFFERENCE < -3             24900062
249100                           SET PS-ADD-NEW-TRIP                    24910062
249200                               PS-NULL-VEHICLE-NBR TO TRUE        24920062
249300                        ELSE                                      24930062
249400                           SET PS-LINK-TRIP TO TRUE               24940062
249500                           SET PS-USE-TRIP TO TRUE                24950062
249600                           MOVE VEHICL-CURR-TRIP-ID               24960062
249700                                           TO ASC-TRIP-ID         24970062
249800                        END-IF                                    24980062
249900                     ELSE                                         24990062
250000                        MOVE '3070-GET-ETA-DATE'                  25000062
250100                                       TO DP013-PARAGRAPH         25010062
250200                        MOVE 'INVALID DATE RANGE'                 25020062
250300                                  TO DP013-MESSAGE-TEXT(1)        25030062
250400                        MOVE PV-VALID-ETA-DTE                     25040062
250500                                  TO DP013-MESSAGE-TEXT(2)        25050062
250600                        MOVE PV-VALID-ETA-DTE-2                   25060062
250700                                  TO DP013-MESSAGE-TEXT(3)        25070062
250800                        SET DP013-CICS-ABEND                      25080062
250900                            DP013-XCTL-DISPLAY-RESTART            25090062
251000                                          TO TRUE                 25100062
251100                        PERFORM DP013-0000-PROCESS-ABEND          25110062
251200                     END-IF                                       25120062
251300                  ELSE                                            25130062
251400                     SET PS-ADD-NEW-TRIP                          25140062
251500                         PS-NULL-VEHICLE-NBR TO TRUE              25150062
251600                  END-IF                                          25160062
251700              END-IF                                              25170062
251800                                                                  25180062
251900         WHEN SQLCODE = +100                                      25190062
252000              SET PS-ADD-NEW-TRIP                                 25200062
252100                  PS-NULL-VEHICLE-NBR TO TRUE                     25210062
252200     END-EVALUATE.                                                25220062
252300                                                                  25230062
252400 3075-GET-PRTY-CDE.                                               25240062
252500                                                                  25250062
252600     PERFORM WITH TEST AFTER                                      25260062
252700         VARYING PV-RETRY-COUNTER                                 25270062
252800         FROM 1 BY 1                                              25280062
252900         UNTIL (PV-RETRY-COUNTER > PC-MAX-RETRIES                 25290062
253000                 OR SQLCODE = 0)                                  25300062
253100                                                                  25310062
253200         EXEC SQL                                                 25320062
253300             SELECT  PRTY_CDE                                     25330062
253400             INTO   :TRSTYP-PRTY-CDE                              25340062
253500             FROM   TTRSTYP                                       25350062
253600             WHERE  TRIP_STATUS_CDE = :VEHICL-CURR-STATUS-CDE     25360062
253700         END-EXEC                                                 25370062
253800                                                                  25380062
253900         EVALUATE TRUE                                            25390062
254000             WHEN SQLCODE = ZERO                                  25400062
254100             WHEN SQLCODE = -904                                  25410062
254200             WHEN SQLCODE = -913                                  25420062
254300                 CONTINUE                                         25430062
254400             WHEN SQLWARN0 NOT = SPACES                           25440062
254500             WHEN SQLCODE NOT EQUAL ZERO                          25450062
254600                 MOVE '3075-GET-PRTY-CDE'                         25460062
254700                                 TO DP013-PARAGRAPH               25470062
254800                 MOVE 'GET PRTY CDE '                             25480062
254900                                 TO DP013-MESSAGE-TEXT(1)         25490062
255000                 MOVE VEHICL-CURR-STATUS-CDE                      25500062
255100                                 TO DP013-MESSAGE-TEXT(2)         25510062
255200                 MOVE SQLCA      TO DP013-SQLCA                   25520062
255300                 MOVE 'TTRSTYP'  TO DP013-DB2-TABLE-NAME(1)       25530062
255400                 SET DP013-DB2-ABEND                              25540062
255500                                 TO TRUE                          25550062
255600                 SET DP013-NO-ROLLBACK                            25560062
255700                                 TO TRUE                          25570062
255800                 SET DP013-XCTL-DISPLAY-RESTART                   25580062
255900                                 TO TRUE                          25590062
256000                 PERFORM DP013-0000-PROCESS-ABEND                 25600062
256100         END-EVALUATE                                             25610062
256200     END-PERFORM.                                                 25620062
256300                                                                  25630062
256400     IF PV-RETRY-COUNTER > PC-MAX-RETRIES AND                     25640062
256500         SQLCODE NOT = +0                                         25650062
256600         MOVE '3075-GET-PRTY-CDE'                                 25660062
256700                                 TO DP013-PARAGRAPH               25670062
256800         MOVE 'GET PRTY CDE '        TO DP013-MESSAGE-TEXT(1)     25680062
256900         MOVE 'MAX NUMBER OF RETRIES EXCEEDED'                    25690062
257000                                 TO DP013-MESSAGE-TEXT(2)         25700062
257100         MOVE SQLCA              TO DP013-SQLCA                   25710062
257200         MOVE 'TTRSTYP'          TO DP013-DB2-TABLE-NAME(1)       25720062
257300         SET DP013-DB2-ABEND     TO TRUE                          25730062
257400         SET DP013-NO-ROLLBACK   TO TRUE                          25740062
257500         SET DP013-XCTL-DISPLAY-RESTART                           25750062
257600                                 TO TRUE                          25760062
257700         PERFORM DP013-0000-PROCESS-ABEND                         25770062
257800     END-IF.                                                      25780062
257900                                                                  25790062
258000 3100-DETERMINE-EXIST-SHIP.                                       25800062
258100                                                                  25810062
258200     IF ASC-ORIG-SCAC-ID > SPACES                                 25820062
258300        IF ASC-PRO-SCAC-ID > SPACES                               25830062
258400           MOVE ASC-ORIG-SCAC-ID TO DK-ORIG-SCAC                  25840062
258500           MOVE ASC-PRO-SCAC-ID  TO DK-PRO-SCAC                   25850062
258600        ELSE                                                      25860062
258700           MOVE ASC-ORIG-SCAC-ID TO DK-ORIG-SCAC                  25870062
258800           MOVE SPACES           TO DK-PRO-SCAC                   25880062
258900        END-IF                                                    25890062
259000     ELSE                                                         25900062
259100        IF ASC-PRO-SCAC-ID > SPACES                               25910062
259200           MOVE SPACES           TO DK-ORIG-SCAC                  25920062
259300           MOVE ASC-PRO-SCAC-ID  TO DK-PRO-SCAC                   25930062
259400        END-IF                                                    25940062
259500     END-IF.                                                      25950062
259600                                                                  25960062
259700     SET ASC-NO-UPD-PRO                                           25970062
259710* 2011-12-14 CHRISTINE TWIEHAUS WR40574 START                    *25971073
259720         ASC-NO-UPD-CAN                                           25972071
259730* 2011-12-14 CHRISTINE TWIEHAUS WR40574 END                      *25973071
259800         ASC-NO-UPD-BOL TO TRUE.                                  25980062
259900                                                                  25990062
260000     IF ASC-PRO-NBR > SPACES                                      26000062
260100        IF ASC-BOL-NBR > SPACES                                   26010062
260200*          * BOTH FILLED IN *                                     26020062
260300           MOVE ASC-PRO-NBR TO DK-PRO-NBR                         26030062
260400           MOVE ASC-BOL-NBR TO DK-BOL-NBR                         26040062
260500           PERFORM 3110-SELECT-SHIP1                              26050062
260600           IF ASC-SHIPMENT-EXIST                                  26060062
260700              NEXT SENTENCE                                       26070062
260800           ELSE                                                   26080062
260900              MOVE SPACES TO  DK-PRO-NBR                          26090062
261000              PERFORM 3110-SELECT-SHIP1                           26100062
261100              IF ASC-SHIPMENT-EXIST                               26110062
261200                 SET ASC-UPD-PRO TO TRUE                          26120062
261210* 2011-12-14 CHRISTINE TWIEHAUS WR40574 START                    *26121062
261220                 SET ASC-UPD-CAN TO TRUE                          26122062
261230* 2011-12-14 CHRISTINE TWIEHAUS WR40574 END                      *26123062
261300              ELSE                                                26130062
261400                 MOVE ASC-PRO-NBR TO DK-PRO-NBR                   26140062
261500                 MOVE SPACES      TO DK-BOL-NBR                   26150062
261600                 PERFORM 3110-SELECT-SHIP1                        26160062
261700                 IF ASC-SHIPMENT-EXIST                            26170062
261800                    SET ASC-UPD-BOL TO TRUE                       26180062
261900                 END-IF                                           26190062
262000              END-IF                                              26200062
262100           END-IF                                                 26210062
262200        ELSE                                                      26220062
262300*          * JUST PRO FILLED IN *                                 26230062
262400           MOVE ASC-PRO-NBR TO DK-PRO-NBR                         26240062
262500           MOVE SPACES      TO DK-BOL-NBR                         26250062
262600           PERFORM 3110-SELECT-SHIP1                              26260062
262700           IF ASC-SHIPMENT-EXIST                                  26270062
262800              NEXT SENTENCE                                       26280062
262900           ELSE                                                   26290062
263000              PERFORM 3120-SELECT-SHIP2                           26300062
263100              IF ASC-SHIPMENT-EXIST                               26310062
263200                 IF SHIPMT-BOL-NBR > SPACES                       26320062
263300                    MOVE ASC-PRO-NBR     TO ASC-ORIG-PRO-NBR      26330062
263400                    MOVE ASC-COMPLETE-PRO-NBR                     26340062
263500                                         TO ASC-ORIG-COMP-PRO-NBR 26350062
263510* 2011-12-14 CHRISTINE TWIEHAUS WR40574 START                    *26351062
263520                    MOVE ASC-CAN         TO ASC-ORIG-CAN          26352062
263530                    MOVE ASC-COMPLETE-CAN                         26353062
263540                                         TO ASC-ORIG-COMP-CAN     26354062
263550* 2011-12-14 CHRISTINE TWIEHAUS WR40574 END                      *26355062
263600                    MOVE ASC-BOL-NBR     TO ASC-ORIG-BOL-NBR      26360062
263700                    MOVE ASC-COMPLETE-BOL-NBR                     26370062
263800                                         TO ASC-ORIG-COMP-BOL-NBR 26380062
263900                    MOVE SHIPMT-BOL-NBR  TO ASC-BOL-NBR           26390062
264000                    MOVE SHIPMT-COMPLETE-BOL-NBR                  26400062
264100                                         TO ABOLNBRO              26410062
264200                                            ASC-COMPLETE-BOL-NBR  26420062
264300                    MOVE DP015-RED       TO ABOLNBRC              26430062
264400                    MOVE PC-TSYMSG-01009 TO DP020-MSG-NUMBER      26440062
264500                    SET ASC-MULTMATCH                             26450062
264600                        PS-MSG-SET                                26460062
264700                        DP020-MSG-FATAL  TO TRUE                  26470062
264800                 END-IF                                           26480062
264900              ELSE                                                26490062
265000                 IF ASC-MULT-SHIP-EXIST                           26500062
265100                    MOVE ASC-PRO-NBR     TO ASC-ORIG-PRO-NBR      26510062
265200                    MOVE ASC-COMPLETE-PRO-NBR                     26520062
265300                                         TO ASC-ORIG-COMP-PRO-NBR 26530062
265310* 2011-12-14 CHRISTINE TWIEHAUS WR40574 START                    *26531062
265320                    MOVE ASC-CAN         TO ASC-ORIG-CAN          26532062
265330                    MOVE ASC-COMPLETE-CAN                         26533062
265340                                         TO ASC-ORIG-COMP-CAN     26534062
265350* 2011-12-14 CHRISTINE TWIEHAUS WR40574 END                      *26535062
265400                    MOVE ASC-BOL-NBR     TO ASC-ORIG-BOL-NBR      26540062
265500                    MOVE ASC-COMPLETE-BOL-NBR                     26550062
265600                                         TO ASC-ORIG-COMP-BOL-NBR 26560062
265700                    MOVE SPACES          TO ASC-BOL-NBR           26570062
265800                                            ABOLNBRO              26580062
265900                                            ASC-COMPLETE-BOL-NBR  26590062
266000              END-IF                                              26600062
266100           END-IF                                                 26610062
266200        END-IF                                                    26620062
266300     ELSE                                                         26630062
266400        IF ASC-BOL-NBR > SPACES                                   26640062
266500*          * JUST BOL FILLED IN *                                 26650062
266600           MOVE SPACES      TO DK-PRO-NBR                         26660062
266700           MOVE ASC-BOL-NBR TO DK-BOL-NBR                         26670062
266800           PERFORM 3110-SELECT-SHIP1                              26680062
266900           IF ASC-SHIPMENT-EXIST                                  26690062
267000              NEXT SENTENCE                                       26700062
267100           ELSE                                                   26710062
267200              PERFORM 3130-SELECT-SHIP3                           26720062
267300              IF ASC-SHIPMENT-EXIST                               26730062
267400                 IF SHIPMT-PRO-NBR > SPACES                       26740062
267500                    MOVE ASC-PRO-NBR     TO ASC-ORIG-PRO-NBR      26750062
267600                    MOVE ASC-COMPLETE-PRO-NBR                     26760062
267700                                         TO ASC-ORIG-COMP-PRO-NBR 26770062
267800                    MOVE ASC-BOL-NBR     TO ASC-ORIG-BOL-NBR      26780062
267900                    MOVE ASC-COMPLETE-BOL-NBR                     26790062
268000                                         TO ASC-ORIG-COMP-BOL-NBR 26800062
268100                    MOVE SHIPMT-PRO-NBR  TO ASC-PRO-NBR           26810062
268200                    MOVE SHIPMT-COMPLETE-PRO-NBR                  26820062
268300                                         TO AFBNBRO               26830062
268400                                            ASC-COMPLETE-PRO-NBR  26840062
268410* 2011-12-14 CHRISTINE TWIEHAUS WR40574 START                    *26841062
268420                    MOVE SHIPMT-CARR-AUTH-ID TO ASC-CAN           26842062
268421                                                ACANO             26842172
268430* 2011-12-14 CHRISTINE TWIEHAUS WR40574 END                      *26843062
268500                    MOVE DP015-RED       TO AFBNBRC               26850062
268600                    MOVE PC-TSYMSG-01009 TO DP020-MSG-NUMBER      26860062
268700                    SET ASC-MULTMATCH                             26870062
268800                        PS-MSG-SET                                26880062
268900                        DP020-MSG-FATAL  TO TRUE                  26890062
269000                 END-IF                                           26900062
269100              ELSE                                                26910062
269200                 IF ASC-MULT-SHIP-EXIST                           26920062
269300                    MOVE ASC-PRO-NBR     TO ASC-ORIG-PRO-NBR      26930062
269400                    MOVE ASC-COMPLETE-PRO-NBR                     26940062
269500                                         TO ASC-ORIG-COMP-PRO-NBR 26950062
269600                    MOVE ASC-BOL-NBR     TO ASC-ORIG-BOL-NBR      26960062
269610* 2011-12-14 CHRISTINE TWIEHAUS WR40574 START                    *26961062
269611                    MOVE ASC-CAN         TO ASC-ORIG-CAN          26961166
269630* 2011-12-14 CHRISTINE TWIEHAUS WR40574 END                      *26963062
269700                    MOVE ASC-COMPLETE-BOL-NBR                     26970062
269800                                         TO ASC-ORIG-COMP-BOL-NBR 26980062
269900                    MOVE SPACES          TO ASC-PRO-NBR           26990062
270000                                            AFBNBRO               27000062
270100                                            ASC-COMPLETE-PRO-NBR  27010062
270200              END-IF                                              27020062
270300           END-IF                                                 27030062
270400        END-IF                                                    27040062
270500     END-IF.                                                      27050062
270600                                                                  27060062
270700     IF ASC-SHIPMENT-EXIST                                        27070062
270800        MOVE SHIPMT-TRIP-ID   TO ASC-TRIP-ID                      27080062
270900        MOVE SHIPMT-SHIPT-ID  TO ASC-SHIPT-ID                     27090062
271000     END-IF.                                                      27100062
271100*                                                                 27110062
271200*                                                                 27120062
271300 3110-SELECT-SHIP1.                                               27130062
271400*----------------------------------------------------------------*27140062
271500*    BOTH THE FREIGHT BILL AND BILL OF LADING NUMBERS WHERE      *27150062
271600*    ENTERED, FIRST TRY TO MATCH TO A SHIPMENT THAT HAS THE SAME *27160062
271700*    FREIGHT AND BILL OF LADING NUMBER.  IF NO MATCH IS FOUND,   *27170062
271800*    THEN TRY TO MATCH A SHIPMENT THAT HAS THE SAME BILL OF LADING27180062
271900*    NUMBER.  IF NO MATCH, THEN TRY TO MATCH A SHIPMENT THAT HAS *27190062
272000*    THE SAME FREIGHT BILL.  IF NO MATCH THEN THE SHIPMENT DOESN'T27200062
272100*    EXIST.                                                      *27210062
272200*----------------------------------------------------------------*27220062
272300                                                                  27230062
272400     PERFORM WITH TEST AFTER                                      27240062
272500         VARYING PV-RETRY-COUNTER                                 27250062
272600         FROM 1 BY 1                                              27260062
272700         UNTIL (PV-RETRY-COUNTER > PC-MAX-RETRIES                 27270062
272800                 OR SQLCODE = 0                                   27280062
272900                 OR SQLCODE = +100                                27290062
273000                 OR SQLCODE = -811)                               27300062
273100                                                                  27310062
273110* 2011-12-14 CHRISTINE TWIEHAUS WR40574 ADDED CARR-AUTH-ID BELOW *27311062
273200         EXEC SQL                                                 27320062
273300             SELECT A.TRIP_ID,                                    27330062
273400                    A.SHIPT_ID,                                   27340062
273500                    A.PRO_SCAC_ID,                                27350062
273600                    A.EXPTED_PKG_QTY,                             27360062
273700                    A.VEND_SHIP_DTE,                              27370062
273800                    A.AUTH_NBR,                                   27380062
273900                    A.AUTH_DTE,                                   27390062
274000                    A.ORIG_SCAC_ID,                               27400062
274100                    A.PRO_NBR,                                    27410062
274200                    A.BOL_NBR,                                    27420062
274300                    A.COMPLETE_PRO_NBR,                           27430062
274400                    A.COMPLETE_BOL_NBR,                           27440062
274500                    B.EST_AR_TMST,                                27450062
274600                    B.VEH_NBR,                                    27460062
274700                    B.OWNER_SCAC_ID,                              27470062
274701                    A.CARR_AUTH_ID                                27470162
274800             INTO   :SHIPMT-TRIP-ID,                              27480062
274900                    :SHIPMT-SHIPT-ID,                             27490062
275000                    :SHIPMT-PRO-SCAC-ID,                          27500062
275100                    :SHIPMT-EXPTED-PKG-QTY,                       27510062
275200                    :SHIPMT-VEND-SHIP-DTE,                        27520062
275300                    :SHIPMT-AUTH-NBR,                             27530062
275400                    :SHIPMT-AUTH-DTE,                             27540062
275500                    :SHIPMT-ORIG-SCAC-ID,                         27550062
275600                    :SHIPMT-PRO-NBR,                              27560062
275700                    :SHIPMT-BOL-NBR,                              27570062
275800                    :SHIPMT-COMPLETE-PRO-NBR,                     27580062
275900                    :SHIPMT-COMPLETE-BOL-NBR,                     27590062
276000                    :VHTRIP-EST-AR-TMST :DN-EST-AR-TMST,          27600062
276100                    :VHTRIP-VEH-NBR :DN-VEH-NBR,                  27610062
276200                    :VHTRIP-OWNER-SCAC-ID,                        27620062
276210                    :SHIPMT-CARR-AUTH-ID                          27621064
276300             FROM   TSHIPMT A,                                    27630062
276400                    TVHTRIP B                                     27640062
276500             WHERE  A.PRO_SCAC_ID  IN                             27650062
276600                                   (:DK-ORIG-SCAC, :DK-PRO-SCAC)  27660062
276700             AND    A.PRO_NBR       = :DK-PRO-NBR                 27670062
276800             AND    A.BOL_NBR       = :DK-BOL-NBR                 27680062
276900             AND    A.TRIP_ID       = B.TRIP_ID                   27690062
277000         END-EXEC                                                 27700062
277100                                                                  27710062
277200         EVALUATE TRUE                                            27720062
277300             WHEN SQLCODE = ZERO                                  27730062
277400             WHEN SQLCODE = +100                                  27740062
277500             WHEN SQLCODE = -811                                  27750062
277600             WHEN SQLCODE = -904                                  27760062
277700             WHEN SQLCODE = -913                                  27770062
277800                 CONTINUE                                         27780062
277900             WHEN SQLWARN0 NOT = SPACES                           27790062
278000             WHEN SQLCODE NOT EQUAL ZERO                          27800062
278100                 MOVE SPACES TO PV-MESSAGE                        27810062
278200                 MOVE DK-ORIG-SCAC TO PV-MESSAGE1                 27820062
278300                 MOVE DK-PRO-SCAC  TO PV-MESSAGE2                 27830062
278400                 MOVE DK-PRO-NBR   TO PV-MESSAGE3                 27840062
278500                 MOVE '3110-SELECT-SHIP1'                         27850062
278600                                 TO DP013-PARAGRAPH               27860062
278700                 MOVE 'CHECK SHIPMENT'                            27870062
278800                                 TO DP013-MESSAGE-TEXT(1)         27880062
278900                 MOVE PV-MESSAGE TO DP013-MESSAGE-TEXT(2)         27890062
279000                 MOVE DK-BOL-NBR TO DP013-MESSAGE-TEXT(3)         27900062
279100                 MOVE SQLCA      TO DP013-SQLCA                   27910062
279200                 MOVE 'TSHIPMT'  TO DP013-DB2-TABLE-NAME(1)       27920062
279300                 SET DP013-DB2-ABEND                              27930062
279400                                 TO TRUE                          27940062
279500                 SET DP013-NO-ROLLBACK                            27950062
279600                                 TO TRUE                          27960062
279700                 SET DP013-XCTL-DISPLAY-RESTART                   27970062
279800                                 TO TRUE                          27980062
279900                 PERFORM DP013-0000-PROCESS-ABEND                 27990062
280000         END-EVALUATE                                             28000062
280100     END-PERFORM.                                                 28010062
280200                                                                  28020062
280300     IF PV-RETRY-COUNTER > PC-MAX-RETRIES AND                     28030062
280400         SQLCODE NOT = +0                                         28040062
280500         MOVE '3110-SELECT-SHIP1'                                 28050062
280600                                 TO DP013-PARAGRAPH               28060062
280700         MOVE 'CHECK SHIPMENT'   TO DP013-MESSAGE-TEXT(1)         28070062
280800         MOVE 'MAX NUMBER OF RETRIES EXCEEDED'                    28080062
280900                                 TO DP013-MESSAGE-TEXT(2)         28090062
281000         MOVE SQLCA              TO DP013-SQLCA                   28100062
281100         MOVE 'TSHIPMT'          TO DP013-DB2-TABLE-NAME(1)       28110062
281200         SET DP013-DB2-ABEND     TO TRUE                          28120062
281300         SET DP013-NO-ROLLBACK   TO TRUE                          28130062
281400         SET DP013-XCTL-DISPLAY-RESTART                           28140062
281500                                 TO TRUE                          28150062
281600         PERFORM DP013-0000-PROCESS-ABEND                         28160062
281700     END-IF.                                                      28170062
281800                                                                  28180062
281900     EVALUATE TRUE                                                28190062
282000         WHEN SQLCODE = ZERO                                      28200062
282100         WHEN SQLCODE = -811                                      28210062
282200              SET ASC-SHIPMENT-EXIST TO TRUE                      28220062
282300         WHEN SQLCODE = +100                                      28230062
282400              SET ASC-ADD-SHIPMENT TO TRUE                        28240062
282500     END-EVALUATE.                                                28250062
282600                                                                  28260062
282700 EJECT                                                            28270062
282800                                                                  28280062
282900*                                                                 28290062
283000 3120-SELECT-SHIP2.                                               28300062
283100*----------------------------------------------------------------*28310062
283200*    TRY TO MATCH A SHIPMENT USING THE FREIGHT BILL NUMBER.       28320062
283300*----------------------------------------------------------------*28330062
283400                                                                  28340062
283500     PERFORM WITH TEST AFTER                                      28350062
283600         VARYING PV-RETRY-COUNTER                                 28360062
283700         FROM 1 BY 1                                              28370062
283800         UNTIL (PV-RETRY-COUNTER > PC-MAX-RETRIES                 28380062
283900                 OR SQLCODE = 0                                   28390062
284000                 OR SQLCODE = -811                                28400062
284100                 OR SQLCODE = +100)                               28410062
284200                                                                  28420062
284210* 2011-12-14 CHRISTINE TWIEHAUS WR40574 ADDED CARR-AUTH-ID BELOW *28421062
284300         EXEC SQL                                                 28430062
284400             SELECT A.TRIP_ID,                                    28440062
284500                    A.SHIPT_ID,                                   28450062
284600                    A.PRO_SCAC_ID,                                28460062
284700                    A.EXPTED_PKG_QTY,                             28470062
284800                    A.VEND_SHIP_DTE,                              28480062
284900                    A.AUTH_NBR,                                   28490062
285000                    A.AUTH_DTE,                                   28500062
285100                    A.ORIG_SCAC_ID,                               28510062
285200                    A.PRO_NBR,                                    28520062
285300                    A.BOL_NBR,                                    28530062
285400                    A.COMPLETE_PRO_NBR,                           28540062
285500                    A.COMPLETE_BOL_NBR,                           28550062
285600                    B.EST_AR_TMST,                                28560062
285700                    B.VEH_NBR,                                    28570062
285800                    B.OWNER_SCAC_ID,                              28580062
285810                    A.CARR_AUTH_ID                                28581064
285900             INTO   :SHIPMT-TRIP-ID,                              28590062
286000                    :SHIPMT-SHIPT-ID,                             28600062
286100                    :SHIPMT-PRO-SCAC-ID,                          28610062
286200                    :SHIPMT-EXPTED-PKG-QTY,                       28620062
286300                    :SHIPMT-VEND-SHIP-DTE,                        28630062
286400                    :SHIPMT-AUTH-NBR,                             28640062
286500                    :SHIPMT-AUTH-DTE,                             28650062
286600                    :SHIPMT-ORIG-SCAC-ID,                         28660062
286700                    :SHIPMT-PRO-NBR,                              28670062
286800                    :SHIPMT-BOL-NBR,                              28680062
286900                    :SHIPMT-COMPLETE-PRO-NBR,                     28690062
287000                    :SHIPMT-COMPLETE-BOL-NBR,                     28700062
287100                    :VHTRIP-EST-AR-TMST :DN-EST-AR-TMST,          28710062
287200                    :VHTRIP-VEH-NBR :DN-VEH-NBR,                  28720062
287300                    :VHTRIP-OWNER-SCAC-ID,                        28730062
287310                    :SHIPMT-CARR-AUTH-ID                          28731062
287400             FROM   TSHIPMT A,                                    28740062
287500                    TVHTRIP B                                     28750062
287600             WHERE  A.PRO_SCAC_ID  IN                             28760062
287700                                   (:DK-ORIG-SCAC, :DK-PRO-SCAC)  28770062
287800             AND    A.PRO_NBR       = :ASC-PRO-NBR                28780062
287900             AND    A.TRIP_ID       = B.TRIP_ID                   28790062
288000         END-EXEC                                                 28800062
288100                                                                  28810062
288200         EVALUATE TRUE                                            28820062
288300             WHEN SQLCODE = ZERO                                  28830062
288400             WHEN SQLCODE = +100                                  28840062
288500             WHEN SQLCODE = -904                                  28850062
288600             WHEN SQLCODE = -913                                  28860062
288700             WHEN SQLCODE = -811                                  28870062
288800                 CONTINUE                                         28880062
288900             WHEN SQLWARN0 NOT = SPACES                           28890062
289000             WHEN SQLCODE NOT EQUAL ZERO                          28900062
289100                 MOVE SPACES TO PV-MESSAGE                        28910062
289200                 MOVE DK-ORIG-SCAC TO PV-MESSAGE1                 28920062
289300                 MOVE DK-PRO-SCAC  TO PV-MESSAGE2                 28930062
289400                 MOVE ASC-PRO-NBR  TO PV-MESSAGE3                 28940062
289500                 MOVE '3120-SELECT-SHIP2'                         28950062
289600                                 TO DP013-PARAGRAPH               28960062
289700                 MOVE 'CHECK SHIPMENT'                            28970062
289800                                 TO DP013-MESSAGE-TEXT(1)         28980062
289900                 MOVE PV-MESSAGE TO DP013-MESSAGE-TEXT(2)         28990062
290000                 MOVE SQLCA      TO DP013-SQLCA                   29000062
290100                 MOVE 'TSHIPMT'  TO DP013-DB2-TABLE-NAME(1)       29010062
290200                 SET DP013-DB2-ABEND                              29020062
290300                                 TO TRUE                          29030062
290400                 SET DP013-NO-ROLLBACK                            29040062
290500                                 TO TRUE                          29050062
290600                 SET DP013-XCTL-DISPLAY-RESTART                   29060062
290700                                 TO TRUE                          29070062
290800                 PERFORM DP013-0000-PROCESS-ABEND                 29080062
290900         END-EVALUATE                                             29090062
291000     END-PERFORM.                                                 29100062
291100                                                                  29110062
291200     IF PV-RETRY-COUNTER > PC-MAX-RETRIES AND                     29120062
291300         SQLCODE NOT = +0                                         29130062
291400         MOVE '3120-SELECT-SHIP2'                                 29140062
291500                                 TO DP013-PARAGRAPH               29150062
291600         MOVE 'CHECK SHIPMENT'   TO DP013-MESSAGE-TEXT(1)         29160062
291700         MOVE 'MAX NUMBER OF RETRIES EXCEEDED'                    29170062
291800                                 TO DP013-MESSAGE-TEXT(2)         29180062
291900         MOVE SQLCA              TO DP013-SQLCA                   29190062
292000         MOVE 'TSHIPMT'          TO DP013-DB2-TABLE-NAME(1)       29200062
292100         SET DP013-DB2-ABEND     TO TRUE                          29210062
292200         SET DP013-NO-ROLLBACK   TO TRUE                          29220062
292300         SET DP013-XCTL-DISPLAY-RESTART                           29230062
292400                                 TO TRUE                          29240062
292500         PERFORM DP013-0000-PROCESS-ABEND                         29250062
292600     END-IF.                                                      29260062
292700                                                                  29270062
292800     EVALUATE TRUE                                                29280062
292900         WHEN SQLCODE = ZERO                                      29290062
293000              SET ASC-SHIPMENT-EXIST TO TRUE                      29300062
293100         WHEN SQLCODE = +100                                      29310062
293200              SET ASC-ADD-SHIPMENT   TO TRUE                      29320062
293300         WHEN SQLCODE = -811                                      29330062
293400              SET ASC-MULT-SHIP-EXIST                             29340062
293500                  DP020-MSG-FATAL    TO TRUE                      29350062
293600              MOVE PC-TSYMSG-01010   TO DP020-MSG-NUMBER          29360062
293700     END-EVALUATE.                                                29370062
293800                                                                  29380062
293900 EJECT                                                            29390062
294000                                                                  29400062
294100 3130-SELECT-SHIP3.                                               29410062
294200*----------------------------------------------------------------*29420062
294300*    TRY TO MATCH A SHIPMENT USING THE BILL OF LADING NUMBER.     29430062
294400*----------------------------------------------------------------*29440062
294500                                                                  29450062
294600     PERFORM WITH TEST AFTER                                      29460062
294700         VARYING PV-RETRY-COUNTER                                 29470062
294800         FROM 1 BY 1                                              29480062
294900         UNTIL (PV-RETRY-COUNTER > PC-MAX-RETRIES                 29490062
295000                 OR SQLCODE = 0                                   29500062
295100                 OR SQLCODE = -811                                29510062
295200                 OR SQLCODE = +100)                               29520062
295300                                                                  29530062
295310* 2011-12-14 CHRISTINE TWIEHAUS WR40574 ADDED CARR-AUTH-ID BELOW *29531062
295400         EXEC SQL                                                 29540062
295500             SELECT A.TRIP_ID,                                    29550062
295600                    A.SHIPT_ID,                                   29560062
295700                    A.PRO_SCAC_ID,                                29570062
295800                    A.EXPTED_PKG_QTY,                             29580062
295900                    A.VEND_SHIP_DTE,                              29590062
296000                    A.AUTH_NBR,                                   29600062
296100                    A.AUTH_DTE,                                   29610062
296200                    A.ORIG_SCAC_ID,                               29620062
296300                    A.PRO_NBR,                                    29630062
296400                    A.BOL_NBR,                                    29640062
296500                    A.COMPLETE_PRO_NBR,                           29650062
296600                    A.COMPLETE_BOL_NBR,                           29660062
296700                    B.EST_AR_TMST,                                29670062
296800                    B.VEH_NBR,                                    29680062
296900                    B.OWNER_SCAC_ID,                              29690064
296910                    A.CARR_AUTH_ID                                29691062
297000             INTO   :SHIPMT-TRIP-ID,                              29700062
297100                    :SHIPMT-SHIPT-ID,                             29710062
297200                    :SHIPMT-PRO-SCAC-ID,                          29720062
297300                    :SHIPMT-EXPTED-PKG-QTY,                       29730062
297400                    :SHIPMT-VEND-SHIP-DTE,                        29740062
297500                    :SHIPMT-AUTH-NBR,                             29750062
297600                    :SHIPMT-AUTH-DTE,                             29760062
297700                    :SHIPMT-ORIG-SCAC-ID,                         29770062
297800                    :SHIPMT-PRO-NBR,                              29780062
297900                    :SHIPMT-BOL-NBR,                              29790062
298000                    :SHIPMT-COMPLETE-PRO-NBR,                     29800062
298100                    :SHIPMT-COMPLETE-BOL-NBR,                     29810062
298200                    :VHTRIP-EST-AR-TMST :DN-EST-AR-TMST,          29820062
298300                    :VHTRIP-VEH-NBR :DN-VEH-NBR,                  29830062
298400                    :VHTRIP-OWNER-SCAC-ID,                        29840062
298410                    :SHIPMT-CARR-AUTH-ID                          29841062
298500             FROM   TSHIPMT A,                                    29850062
298600                    TVHTRIP B                                     29860062
298700             WHERE  A.PRO_SCAC_ID  IN                             29870062
298800                                   (:DK-ORIG-SCAC, :DK-PRO-SCAC)  29880062
298900             AND    A.BOL_NBR       = :ASC-BOL-NBR                29890062
299000             AND    A.TRIP_ID       = B.TRIP_ID                   29900062
299100         END-EXEC                                                 29910062
299200                                                                  29920062
299300         EVALUATE TRUE                                            29930062
299400             WHEN SQLCODE = ZERO                                  29940062
299500             WHEN SQLCODE = +100                                  29950062
299600             WHEN SQLCODE = -904                                  29960062
299700             WHEN SQLCODE = -913                                  29970062
299800             WHEN SQLCODE = -811                                  29980062
299900                 CONTINUE                                         29990062
300000             WHEN SQLWARN0 NOT = SPACES                           30000062
300100             WHEN SQLCODE NOT EQUAL ZERO                          30010062
300200                 MOVE SPACES TO PV-MESSAGE                        30020062
300300                 MOVE DK-ORIG-SCAC TO PV-MESSAGE1                 30030062
300400                 MOVE DK-PRO-SCAC  TO PV-MESSAGE2                 30040062
300500                 MOVE ASC-BOL-NBR  TO PV-MESSAGE3                 30050062
300600                 MOVE '3130-SELECT-SHIP3'                         30060062
300700                                 TO DP013-PARAGRAPH               30070062
300800                 MOVE 'CHECK SHIPMENT'                            30080062
300900                                 TO DP013-MESSAGE-TEXT(1)         30090062
301000                 MOVE PV-MESSAGE TO DP013-MESSAGE-TEXT(2)         30100062
301100                 MOVE SQLCA      TO DP013-SQLCA                   30110062
301200                 MOVE 'TSHIPMT'  TO DP013-DB2-TABLE-NAME(1)       30120062
301300                 SET DP013-DB2-ABEND                              30130062
301400                                 TO TRUE                          30140062
301500                 SET DP013-NO-ROLLBACK                            30150062
301600                                 TO TRUE                          30160062
301700                 SET DP013-XCTL-DISPLAY-RESTART                   30170062
301800                                 TO TRUE                          30180062
301900                 PERFORM DP013-0000-PROCESS-ABEND                 30190062
302000         END-EVALUATE                                             30200062
302100     END-PERFORM.                                                 30210062
302200                                                                  30220062
302300     IF PV-RETRY-COUNTER > PC-MAX-RETRIES AND                     30230062
302400         SQLCODE NOT = +0                                         30240062
302500         MOVE '3130-SELECT-SHIP3'                                 30250062
302600                                 TO DP013-PARAGRAPH               30260062
302700         MOVE 'CHECK SHIPMENT'   TO DP013-MESSAGE-TEXT(1)         30270062
302800         MOVE 'MAX NUMBER OF RETRIES EXCEEDED'                    30280062
302900                                 TO DP013-MESSAGE-TEXT(2)         30290062
303000         MOVE SQLCA              TO DP013-SQLCA                   30300062
303100         MOVE 'TSHIPMT'          TO DP013-DB2-TABLE-NAME(1)       30310062
303200         SET DP013-DB2-ABEND     TO TRUE                          30320062
303300         SET DP013-NO-ROLLBACK   TO TRUE                          30330062
303400         SET DP013-XCTL-DISPLAY-RESTART                           30340062
303500                                 TO TRUE                          30350062
303600         PERFORM DP013-0000-PROCESS-ABEND                         30360062
303700     END-IF.                                                      30370062
303800                                                                  30380062
303900     EVALUATE TRUE                                                30390062
304000         WHEN SQLCODE = ZERO                                      30400062
304100              SET ASC-SHIPMENT-EXIST TO TRUE                      30410062
304200         WHEN SQLCODE = +100                                      30420062
304300              SET ASC-ADD-SHIPMENT TO TRUE                        30430062
304400         WHEN SQLCODE = -811                                      30440062
304500              SET ASC-MULT-SHIP-EXIST                             30450062
304600                  ASC-MULTMATCH                                   30460062
304700                  DP020-MSG-FATAL TO TRUE                         30470062
304800              MOVE PC-TSYMSG-01008 TO DP020-MSG-NUMBER            30480062
304900     END-EVALUATE.                                                30490062
305000                                                                  30500062
305100 EJECT                                                            30510062
305200*----------------------------------------------------------------*30520062
305300*  ADDITIONAL PO'S CAN ONLY BE ADDED TO SHIPMENTS THAT HAVE A     30530062
305400*  STATUS OF ENROUTE.  THE SHIPMENT STATUS IS CHECKED BEFORE ANY  30540062
305500*  ADDS CAN TABLE PLACE.                                          30550062
305600*----------------------------------------------------------------*30560062
305700 3140-CHECK-SHIPT-STATUS.                                         30570062
305800                                                                  30580062
305900     PERFORM WITH TEST AFTER                                      30590062
306000         VARYING PV-RETRY-COUNTER                                 30600062
306100         FROM 1 BY 1                                              30610062
306200         UNTIL (PV-RETRY-COUNTER > PC-MAX-RETRIES                 30620062
306300                 OR SQLCODE = 0                                   30630062
306400                 OR SQLCODE = +100)                               30640062
306500                                                                  30650062
306600         EXEC SQL                                                 30660062
306700           SELECT DISTINCT                                        30670062
306800                  A.TRIP_STATUS_CDE                               30680062
306900                 ,A.OPER_UNT_ID                                   30690062
307000                 ,A.FCLTY_ID                                      30700062
307100                 ,B.PRTY_CDE                                      30710062
307200           INTO   :TRIPST-TRIP-STATUS-CDE                         30720062
307300                 ,:TRIPST-OPER-UNT-ID                             30730062
307400                 ,:TRIPST-FCLTY-ID                                30740062
307500                 ,:TRSTYP-PRTY-CDE                                30750062
307600           FROM   TTRIPST A                                       30760062
307700                 ,TTRSTYP B                                       30770062
307800           WHERE  A.TRIP_ID     = :SHIPMT-TRIP-ID                 30780062
307900             AND  A.TRIP_STATUS_CDE = B.TRIP_STATUS_CDE           30790062
308000             AND  B.PRTY_CDE =                                    30800062
308100                 (SELECT DISTINCT                                 30810062
308200                      MAX(D.PRTY_CDE)                             30820062
308300                   FROM   TTRIPST C                               30830062
308400                         ,TTRSTYP D                               30840062
308500                   WHERE  C.TRIP_ID     = :SHIPMT-TRIP-ID         30850062
308600                     AND  C.TRIP_STATUS_CDE = D.TRIP_STATUS_CDE)  30860062
308700         END-EXEC                                                 30870062
308800                                                                  30880062
308900         EVALUATE TRUE                                            30890062
309000             WHEN SQLCODE = ZERO                                  30900062
309100             WHEN SQLCODE = +100                                  30910062
309200             WHEN SQLCODE = -904                                  30920062
309300             WHEN SQLCODE = -913                                  30930062
309400                 CONTINUE                                         30940062
309500             WHEN SQLWARN0 NOT = SPACES                           30950062
309600             WHEN SQLCODE NOT EQUAL ZERO                          30960062
309700                 MOVE '3140-CHECK-SHIPT-STATUS'                   30970062
309800                                 TO DP013-PARAGRAPH               30980062
309900                 MOVE 'CHECK TRIP STATUS'                         30990062
310000                                 TO DP013-MESSAGE-TEXT(1)         31000062
310100                 MOVE SHIPMT-TRIP-ID                              31010062
310200                                 TO DP013-MESSAGE-TEXT(2)         31020062
310300                 MOVE SQLCA      TO DP013-SQLCA                   31030062
310400                 MOVE 'TTRIPST'  TO DP013-DB2-TABLE-NAME(1)       31040062
310500                 SET DP013-DB2-ABEND                              31050062
310600                                 TO TRUE                          31060062
310700                 SET DP013-NO-ROLLBACK                            31070062
310800                                 TO TRUE                          31080062
310900                 SET DP013-XCTL-DISPLAY-RESTART                   31090062
311000                                 TO TRUE                          31100062
311100                 PERFORM DP013-0000-PROCESS-ABEND                 31110062
311200         END-EVALUATE                                             31120062
311300     END-PERFORM.                                                 31130062
311400                                                                  31140062
311500     IF PV-RETRY-COUNTER > PC-MAX-RETRIES AND                     31150062
311600         SQLCODE NOT = +0                                         31160062
311700         MOVE '3140-CHECK-SHIPT-STATUS'                           31170062
311800                                 TO DP013-PARAGRAPH               31180062
311900         MOVE 'CHECK TRIP STATUS'  TO DP013-MESSAGE-TEXT(1)       31190062
312000         MOVE 'MAX NUMBER OF RETRIES EXCEEDED'                    31200062
312100                                 TO DP013-MESSAGE-TEXT(2)         31210062
312200         MOVE SQLCA              TO DP013-SQLCA                   31220062
312300         MOVE 'TTRIPST'          TO DP013-DB2-TABLE-NAME(1)       31230062
312400         SET DP013-DB2-ABEND     TO TRUE                          31240062
312500         SET DP013-NO-ROLLBACK   TO TRUE                          31250062
312600         SET DP013-XCTL-DISPLAY-RESTART                           31260062
312700                                 TO TRUE                          31270062
312800         PERFORM DP013-0000-PROCESS-ABEND                         31280062
312900     END-IF.                                                      31290062
313000                                                                  31300062
313100     EVALUATE TRUE                                                31310062
313200         WHEN SQLCODE = ZERO                                      31320062
313300              MOVE TRIPST-TRIP-STATUS-CDE TO ASC-TRIP-STATUS-CDE  31330062
313400              IF TRSTYP-PRTY-CDE <= '30'                          31340062
313500                 SET ASC-SHIPT-STATUS-OK TO TRUE                  31350062
313600                 IF PS-MSG-SET                                    31360062
313700                     SET PS-MSG-NOT-SET TO TRUE                   31370062
313800                 ELSE                                             31380062
313900                     MOVE PC-TSYMSG-01019 TO DP020-MSG-NUMBER     31390062
314000                     MOVE TRIPST-OPER-UNT-ID                      31400062
314100                                          TO PV-DISPLAY-OPER-ID   31410062
314200                     MOVE TRIPST-FCLTY-ID TO PV-DISPLAY-FCLTY-ID  31420062
314300                     MOVE PV-DISPLAY-LOCATION TO DP020-MSG-TEXT   31430062
314400                     SET DP020-MSG-INFORMATIONAL TO TRUE          31440062
314500                 END-IF                                           31450062
314600              ELSE                                                31460062
314700                 SET ASC-SHIPT-STATUS-NOTOK TO TRUE               31470062
314800              END-IF                                              31480062
314900         WHEN SQLCODE = +100                                      31490062
315000              SET ASC-SHIPT-STATUS-NOTOK TO TRUE                  31500062
315100              MOVE SPACES TO ASC-TRIP-STATUS-CDE                  31510062
315200     END-EVALUATE.                                                31520062
315300                                                                  31530062
315400*----------------------------------------------------------------*31540062
315500*  DETERMINE IF THE PO ENTERED IS ALREADY ON THE SHIPMENT.        31550062
315600*----------------------------------------------------------------*31560062
315700 3160-SELECT-TSHPTPO.                                             31570062
315800                                                                  31580062
315900     PERFORM WITH TEST AFTER                                      31590062
316000         VARYING PV-RETRY-COUNTER                                 31600062
316100         FROM 1 BY 1                                              31610062
316200         UNTIL (PV-RETRY-COUNTER > PC-MAX-RETRIES                 31620062
316300                 OR SQLCODE = 0                                   31630062
316400                 OR SQLCODE = +100)                               31640062
316500                                                                  31650062
316600         EXEC SQL                                                 31660062
316700             SELECT EXPTED_CART_CNT                               31670062
316800             INTO   :SHPTPO-EXPTED-CART-CNT                       31680062
316900             FROM   TSHPTPO                                       31690062
317000             WHERE  SHIPT_ID    = :ASC-SHIPT-ID                   31700062
317100             AND    PO_NBR      = :DK-PO-NBR                      31710062
317200         END-EXEC                                                 31720062
317300                                                                  31730062
317400         EVALUATE TRUE                                            31740062
317500             WHEN SQLCODE = ZERO                                  31750062
317600             WHEN SQLCODE = +100                                  31760062
317700             WHEN SQLCODE = -904                                  31770062
317800             WHEN SQLCODE = -913                                  31780062
317900                 CONTINUE                                         31790062
318000             WHEN SQLWARN0 NOT = SPACES                           31800062
318100             WHEN SQLCODE NOT EQUAL ZERO                          31810062
318200                 MOVE '3160-SELECT-TSHPTPO'                       31820062
318300                                 TO DP013-PARAGRAPH               31830062
318400                 MOVE 'CHECK SHIPT/PO   '                         31840062
318500                                 TO DP013-MESSAGE-TEXT(1)         31850062
318600                 MOVE ASC-SHIPT-ID TO DP013-MESSAGE-TEXT(2)       31860062
318700                 MOVE DK-PO-NBR  TO DP013-MESSAGE-TEXT(3)         31870062
318800                 MOVE SQLCA      TO DP013-SQLCA                   31880062
318900                 MOVE 'TSHPTPO'  TO DP013-DB2-TABLE-NAME(1)       31890062
319000                 SET DP013-DB2-ABEND                              31900062
319100                                 TO TRUE                          31910062
319200                 SET DP013-NO-ROLLBACK                            31920062
319300                                 TO TRUE                          31930062
319400                 SET DP013-XCTL-DISPLAY-RESTART                   31940062
319500                                 TO TRUE                          31950062
319600                 PERFORM DP013-0000-PROCESS-ABEND                 31960062
319700         END-EVALUATE                                             31970062
319800     END-PERFORM.                                                 31980062
319900                                                                  31990062
320000     IF PV-RETRY-COUNTER > PC-MAX-RETRIES AND                     32000062
320100         SQLCODE NOT = +0                                         32010062
320200         MOVE '3150-SELECT-TSHPTPO'                               32020062
320300                                 TO DP013-PARAGRAPH               32030062
320400         MOVE 'CHECK SHIPT/PO   '  TO DP013-MESSAGE-TEXT(1)       32040062
320500         MOVE 'MAX NUMBER OF RETRIES EXCEEDED'                    32050062
320600                                 TO DP013-MESSAGE-TEXT(2)         32060062
320700         MOVE SQLCA              TO DP013-SQLCA                   32070062
320800         MOVE 'TSHPTPO'          TO DP013-DB2-TABLE-NAME(1)       32080062
320900         SET DP013-DB2-ABEND     TO TRUE                          32090062
321000         SET DP013-NO-ROLLBACK   TO TRUE                          32100062
321100         SET DP013-XCTL-DISPLAY-RESTART                           32110062
321200                                 TO TRUE                          32120062
321300         PERFORM DP013-0000-PROCESS-ABEND                         32130062
321400     END-IF.                                                      32140062
321500                                                                  32150062
321600     EVALUATE TRUE                                                32160062
321700         WHEN SQLCODE = ZERO                                      32170062
321800              SET PS-FOUND TO TRUE                                32180062
321900         WHEN SQLCODE = +100                                      32190062
322000              SET PS-NOT-FOUND TO TRUE                            32200062
322100     END-EVALUATE.                                                32210062
322200                                                                  32220062
322300 3200-RESET-ATTRIBUTES.                                           32230062
322400*                                                                 32240062
322500     IF ASC-SHIPMENT-EXIST                                        32250062
322600        PERFORM 3035-PROTECT-FIELDS                               32260062
322700     ELSE                                                         32270062
322800        MOVE DP015-UNP-ALP-NOR-OFF    TO AFBNBRA                  32280062
322900                                         ABOLNBRA                 32290062
323000                                         AVNDMMA                  32300062
323100                                         AVNDDDA                  32310062
323200                                         AFBCNTA                  32320062
323300                                         AVNDYYA                  32330062
323400                                         AATHNBRA                 32340062
323500                                         AATHMMA                  32350062
323600                                         AATHDDA                  32360062
323700                                         AATHYYA                  32370062
323800                                         AOSCACA                  32380062
323900                                         ADSCACA                  32390062
324000                                         ATRLRNOA                 32400062
324010* 2011-12-14 CHRISTINE TWIEHAUS WR40574 START                    *32401062
324020                                         ACANA                    32402062
324030* 2011-12-14 CHRISTINE TWIEHAUS WR40574 END                      *32403062
324100                                         AETAMMA                  32410062
324200                                         AETADDA                  32420062
324300                                         AETAYYA                  32430062
324400                                         AETAHHA                  32440062
324500                                         AETAMNA                  32450062
324600        MOVE DP015-GREEN              TO AFBNBRC                  32460062
324700                                         ABOLNBRC                 32470062
324800                                         AVNDMMC                  32480062
324900                                         AVNDDDC                  32490062
325000                                         AVNDYYC                  32500062
325100                                         AFBCNTC                  32510062
325200                                         AATHNBRC                 32520062
325300                                         AATHMMC                  32530062
325400                                         AATHDDC                  32540062
325500                                         AATHYYC                  32550062
325600                                         AOSCACC                  32560062
325700                                         ADSCACC                  32570062
325800                                         ATRLRNOC                 32580062
325810* 2011-12-14 CHRISTINE TWIEHAUS WR40574 START                    *32581062
325820                                         ACANC                    32582062
325830* 2011-12-14 CHRISTINE TWIEHAUS WR40574 END                      *32583062
325900                                         AETAMMC                  32590062
326000                                         AETADDC                  32600062
326100                                         AETAYYC                  32610062
326200                                         AETAHHC                  32620062
326300                                         AETAMNC                  32630062
326400        MOVE DP015-UNDERLINE          TO AFBNBRH                  32640062
326500                                         ABOLNBRH                 32650062
326600                                         AFBCNTH                  32660062
326700                                         AVNDMMH                  32670062
326800                                         AVNDDDH                  32680062
326900                                         AVNDYYH                  32690062
327000                                         AATHNBRH                 32700062
327100                                         AATHMMH                  32710062
327200                                         AATHDDH                  32720062
327300                                         AATHYYH                  32730062
327400                                         AOSCACH                  32740062
327500                                         ADSCACH                  32750062
327600                                         ATRLRNOH                 32760062
327610* 2011-12-14 CHRISTINE TWIEHAUS WR40574 START                    *32761062
327620                                         ACANH                    32762062
327630* 2011-12-14 CHRISTINE TWIEHAUS WR40574 END                      *32763062
327700                                         AETAMMH                  32770062
327800                                         AETADDH                  32780062
327900                                         AETAYYH                  32790062
328000                                         AETAHHH                  32800062
328100                                         AETAMNH                  32810062
328200                                                                  32820062
328300     END-IF.                                                      32830062
328400                                                                  32840062
328500     MOVE DP015-UNP-ALP-NOR-OFF    TO APONBRA                     32850062
328600                                      APOCNTA                     32860062
328700                                      AFBNBRA                     32870062
328800                                      ABOLNBRA                    32880062
328900                                      AOSCACA                     32890062
329000                                      ADSCACA.                    32900062
329100     MOVE DP015-GREEN              TO APONBRC                     32910062
329200                                      APOCNTC                     32920062
329300                                      AFBNBRC                     32930062
329400                                      ABOLNBRC                    32940062
329500                                      AOSCACC                     32950062
329600                                      ADSCACC.                    32960062
329700                                                                  32970062
329800     MOVE DP015-UNDERLINE          TO APONBRH                     32980062
329900                                      APOCNTH                     32990062
330000                                      AFBNBRH                     33000062
330100                                      ABOLNBRH                    33010062
330200                                      AOSCACH                     33020062
330300                                      ADSCACH.                    33030062
330400                                                                  33040062
330500*    MOVE DP015-PRO-NOR-OFF        TO APOSTATA                    33050062
330600*                                     ABEFDTEA                    33060062
330700*                                     ACANDTEA                    33070062
330800*                                     AEXCDTEA.                   33080062
330900*                                                                 33090062
331000     MOVE DP015-BLUE               TO ABEFDTEC                    33100062
331100                                      APOSTATC                    33110062
331200                                      ACANDTEC                    33120062
331300                                      AEXCDTEC.                   33130062
331400 3340-VALIDATE-SCAC.                                              33140062
331500*----------------------------------------------------------------*33150062
331600*    ENSURE THE STANDARD CARRIER ALPHA CODE (SCAC) ENTERED ON    *33160062
331700*    THE SCREEN IS SET UP ON THE VENDOR DATABASE.                *33170062
331800*                                                                *33180062
331900*    PERFORMED FROM 3300-EDIT-DATA-IN-COMMAREA.                  *33190062
332000*----------------------------------------------------------------*33200062
332010* 2012-03-16 CHRISTINE TWIEHAUS WR40574 WITH UR BELOW            *33201073
332100                                                                  33210062
332200     PERFORM WITH TEST AFTER                                      33220062
332300         VARYING PV-RETRY-COUNTER                                 33230062
332400         FROM 1 BY 1                                              33240062
332500         UNTIL (PV-RETRY-COUNTER > PC-MAX-RETRIES                 33250062
332600                 OR SQLCODE = 0                                   33260062
332700                 OR SQLCODE = +100)                               33270062
332800                                                                  33280062
332900         EXEC SQL                                                 33290062
333000             SELECT SCAC_CDE                                      33300062
333100             INTO   :EXTENT-SCAC-CDE                              33310062
333200             FROM   TEXTENT                                       33320062
333300             WHERE  SCAC_CDE    = :DK-SCAC                        33330062
333400             AND    CARRIER_IND = :PC-Y                           33340062
333410             WITH UR                                              33341073
333500         END-EXEC                                                 33350062
333600                                                                  33360062
333700         EVALUATE TRUE                                            33370062
333800             WHEN SQLCODE = ZERO                                  33380062
333900             WHEN SQLCODE = +100                                  33390062
334000             WHEN SQLCODE = -904                                  33400062
334100             WHEN SQLCODE = -913                                  33410062
334200                 CONTINUE                                         33420062
334300             WHEN SQLWARN0 NOT = SPACES                           33430062
334400             WHEN SQLCODE NOT EQUAL ZERO                          33440062
334500                 MOVE '3340-VALIDATE-SCAC'                        33450062
334600                                 TO DP013-PARAGRAPH               33460062
334700                 MOVE 'VALIDATE SCAC'                             33470062
334800                                 TO DP013-MESSAGE-TEXT(1)         33480062
334900                 MOVE DK-SCAC    TO DP013-MESSAGE-TEXT(2)         33490062
335000                 MOVE SQLCA      TO DP013-SQLCA                   33500062
335100                 MOVE 'TEXTENT'  TO DP013-DB2-TABLE-NAME(1)       33510062
335200                 SET DP013-DB2-ABEND                              33520062
335300                                 TO TRUE                          33530062
335400                 SET DP013-NO-ROLLBACK                            33540062
335500                                 TO TRUE                          33550062
335600                 SET DP013-XCTL-DISPLAY-RESTART                   33560062
335700                                 TO TRUE                          33570062
335800                 PERFORM DP013-0000-PROCESS-ABEND                 33580062
335900         END-EVALUATE                                             33590062
336000     END-PERFORM.                                                 33600062
336100                                                                  33610062
336200     IF PV-RETRY-COUNTER > PC-MAX-RETRIES AND                     33620062
336300         SQLCODE NOT = +0                                         33630062
336400         MOVE '3340-VALIDATE-SCAC'                                33640062
336500                                 TO DP013-PARAGRAPH               33650062
336600         MOVE 'VALIDATE SCAC'    TO DP013-MESSAGE-TEXT(1)         33660062
336700         MOVE 'MAX NUMBER OF RETRIES EXCEEDED'                    33670062
336800                                 TO DP013-MESSAGE-TEXT(2)         33680062
336900         MOVE SQLCA              TO DP013-SQLCA                   33690062
337000         MOVE 'TEXTENT'          TO DP013-DB2-TABLE-NAME(1)       33700062
337100         SET DP013-DB2-ABEND     TO TRUE                          33710062
337200         SET DP013-NO-ROLLBACK   TO TRUE                          33720062
337300         SET DP013-XCTL-DISPLAY-RESTART                           33730062
337400                                 TO TRUE                          33740062
337500         PERFORM DP013-0000-PROCESS-ABEND                         33750062
337600     END-IF.                                                      33760062
337700                                                                  33770062
337800     EVALUATE TRUE                                                33780062
337900         WHEN SQLCODE = ZERO                                      33790062
338000              SET PS-VALID-SCAC  TO TRUE                          33800062
338100         WHEN SQLCODE = +100                                      33810062
338200              SET PS-INVALID-SCAC                                 33820062
338300                                 TO TRUE                          33830062
338400     END-EVALUATE.                                                33840062
338500                                                                  33850062
338600 EJECT                                                            33860062
338700                                                                  33870062
338800*----------------------------------------------------------------*33880062
338900*    GET THE SCAC DESC FROM THE EXTERNAL ENTERPRISE NAME TABLE   *33890062
339000*----------------------------------------------------------------*33900062
339010* 2012-03-16 CHRISTINE TWIEHAUS WR40574 WITH UR BELOW            *33901073
339100                                                                  33910062
339200 3345-GET-SCAC-NAME.                                              33920062
339300                                                                  33930062
339400     PERFORM                                                      33940062
339500         WITH TEST AFTER                                          33950062
339600         VARYING PV-RETRY-COUNTER                                 33960062
339700         FROM 1 BY 1                                              33970062
339800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               33980062
339900             OR (SQLCODE = +0)                                    33990062
340000             OR (SQLCODE = +100))                                 34000062
340100                                                                  34010062
340200         EXEC SQL                                                 34020062
340300              SELECT ENT_NAME_DESC                                34030062
340400                INTO :ENTNME-ENT-NAME-DESC                        34040062
340500                FROM TEXTENT A                                    34050062
340600                    ,TENTNME B                                    34060062
340700               WHERE A.SCAC_CDE    = :DK-SCAC                     34070062
340800                 AND A.CARRIER_IND = 'Y'                          34080062
340900                 AND B.TYPE_CDE    = '01'                         34090062
341000                 AND A.ENT_ID = B.ENT_ID                          34100062
341010                 WITH UR                                          34101073
341100         END-EXEC                                                 34110062
341200                                                                  34120062
341300         EVALUATE TRUE                                            34130062
341400             WHEN SQLCODE = +0                                    34140062
341500             WHEN SQLCODE = +100                                  34150062
341600             WHEN SQLCODE = -904                                  34160062
341700             WHEN SQLCODE = -913                                  34170062
341800                  CONTINUE                                        34180062
341900                                                                  34190062
342000             WHEN SQLWARN0 NOT = SPACES                           34200062
342100             WHEN SQLCODE < +0                                    34210062
342200             WHEN SQLCODE > +0                                    34220062
342300                  MOVE '3345-GET-SCAC-NAME'                       34230062
342400                                  TO DP013-PARAGRAPH              34240062
342500                  MOVE 'UNSUCCESSFUL SELECT ON TENTNME TABLE'     34250062
342600                                  TO DP013-MESSAGE-TEXT (1)       34260062
342700                  MOVE DK-SCAC    TO DP013-MESSAGE-TEXT (2)       34270062
342800                  MOVE SQLCA      TO DP013-SQLCA                  34280062
342900                  MOVE 'TEXTENT ' TO DP013-DB2-TABLE-NAME (1)     34290062
343000                  MOVE 'TENTNME ' TO DP013-DB2-TABLE-NAME (2)     34300062
343100                  SET DP013-DB2-ABEND                             34310062
343200                      DP013-XCTL-DISPLAY-RESTART                  34320062
343300                                  TO TRUE                         34330062
343400                  PERFORM DP013-0000-PROCESS-ABEND                34340062
343500         END-EVALUATE                                             34350062
343600     END-PERFORM.                                                 34360062
343700                                                                  34370062
343800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    34380062
343900         SQLCODE NOT = +0                                         34390062
344000         MOVE '3345-GET-SCAC-NAME'                                34400062
344100                                  TO DP013-PARAGRAPH              34410062
344200         MOVE 'MAX RETRIES EXCEEDED ON SELECT TENTNME TABLE'      34420062
344300                                  TO DP013-MESSAGE-TEXT (1)       34430062
344400         MOVE SQLCA               TO DP013-SQLCA                  34440062
344500         MOVE 'TEXTENT'           TO DP013-DB2-TABLE-NAME (1)     34450062
344600         MOVE 'TENTNME'           TO DP013-DB2-TABLE-NAME (2)     34460062
344700         SET DP013-DB2-ABEND                                      34470062
344800             DP013-XCTL-DISPLAY-RESTART                           34480062
344900                                  TO TRUE                         34490062
345000         PERFORM DP013-0000-PROCESS-ABEND                         34500062
345100     END-IF.                                                      34510062
345200                                                                  34520062
345300 3350-VALIDATE-ETA-DTE.                                           34530062
345400*----------------------------------------------------------------*34540062
345500*    ENSURE THE ESTIMATED TIME OF ARRIVAL ENTERED ON THE SCREEN  *34550062
345600*    IS IN VALID MM DD CCYY FORMAT.  IF THE CCYY IS NOT ENTERED, *34560062
345700*    THE CURRENT CCYY IS USED.                                   *34570062
345800*                                                                *34580062
345900*    PERFORMED FROM 3000-EDIT-DATA-IN-COMMAREA.                  *34590062
346000*----------------------------------------------------------------*34600062
346100                                                                  34610062
346200     MOVE ASC-ETA-MM             TO PV-INPUT-DATE-MM              34620062
346300                                    PV-VALID-DATE-MM.             34630062
346400     MOVE ASC-ETA-DD             TO PV-INPUT-DATE-DD              34640062
346500                                    PV-VALID-DATE-DD.             34650062
346600                                                                  34660062
346700     MOVE ASC-ETA-CCYY           TO PV-INPUT-DATE-CCYY            34670062
346800                                    PV-VALID-DATE-CCYY.           34680062
346900                                                                  34690062
347000     PERFORM 3700-VALIDATE-DATE.                                  34700062
347100                                                                  34710062
347200     IF PS-VALID-DATE                                             34720062
347300*        MOVE PV-INPUT-DATE-MM   TO AETAMMO                       34730062
347400         MOVE PV-INPUT-DATE-MM   TO                               34740062
347500                                    ASC-ETA-MM                    34750062
347600*        MOVE PV-INPUT-DATE-DD   TO AETADDO                       34760062
347700         MOVE PV-INPUT-DATE-DD   TO                               34770062
347800                                    ASC-ETA-DD                    34780062
347900         MOVE PV-INPUT-DATE-CCYY TO ASC-ETA-CCYY                  34790062
348000*        MOVE ASC-ETA-YY         TO AETAYYO                       34800062
348100         PERFORM 3500-CALL-DATE-RTN                               34810062
348200                                                                  34820062
348300         IF DPG54-DATE-VALID                                      34830062
348400             SET PS-VALID-ETA-DTE  TO TRUE                        34840062
348500             MOVE DPG55-GREG-CC-DATE                              34850062
348600                                 TO PV-VALID-ETA-DTE              34860062
348700         ELSE                                                     34870062
348800             SET PS-INVALID-ETA-DTE                               34880062
348900                                   TO TRUE                        34890062
349000         END-IF                                                   34900062
349100     ELSE                                                         34910062
349200         SET PS-INVALID-ETA-DTE    TO TRUE                        34920062
349300     END-IF.                                                      34930062
349400                                                                  34940062
349500 EJECT                                                            34950062
349600                                                                  34960062
349700 3360-VALIDATE-VEND-SHIP-DTE.                                     34970062
349800*----------------------------------------------------------------*34980062
349900*                                                                *34990062
350000*    PERFORMED FROM 3000-EDIT-DATA-IN-COMMAREA.                  *35000062
350100*----------------------------------------------------------------*35010062
350200                                                                  35020062
350300     MOVE ASC-VEND-SHIP-MM       TO PV-INPUT-DATE-MM              35030062
350400                                    PV-VALID-DATE-MM.             35040062
350500     MOVE ASC-VEND-SHIP-DD       TO PV-INPUT-DATE-DD              35050062
350600                                    PV-VALID-DATE-DD.             35060062
350700                                                                  35070062
350800     MOVE ASC-VEND-SHIP-CCYY     TO PV-INPUT-DATE-CCYY            35080062
350900                                    PV-VALID-DATE-CCYY.           35090062
351000                                                                  35100062
351100     PERFORM 3700-VALIDATE-DATE.                                  35110062
351200                                                                  35120062
351300     IF PS-VALID-DATE                                             35130062
351400*        MOVE PV-INPUT-DATE-MM   TO AVNDMMO                       35140062
351500         MOVE PV-INPUT-DATE-MM   TO ASC-VEND-SHIP-MM-OLD          35150062
351600                                    ASC-VEND-SHIP-MM              35160062
351700*        MOVE PV-INPUT-DATE-DD   TO AVNDDDO                       35170062
351800         MOVE PV-INPUT-DATE-DD   TO ASC-VEND-SHIP-DD-OLD          35180062
351900                                    ASC-VEND-SHIP-DD              35190062
352000         MOVE PV-INPUT-DATE-CCYY TO ASC-VEND-SHIP-CCYY-OLD        35200062
352100                                    ASC-VEND-SHIP-CCYY            35210062
352200*        MOVE ASC-VEND-SHIP-YY   TO AVNDYYO                       35220062
352300         PERFORM 3500-CALL-DATE-RTN                               35230062
352400                                                                  35240062
352500         IF DPG54-DATE-VALID                                      35250062
352600             SET PS-VALID-VND-DTE  TO TRUE                        35260062
352700         ELSE                                                     35270062
352800             SET PS-INVALID-VND-DTE                               35280062
352900                                   TO TRUE                        35290062
353000         END-IF                                                   35300062
353100     ELSE                                                         35310062
353200         SET PS-INVALID-VND-DTE    TO TRUE                        35320062
353300     END-IF.                                                      35330062
353400                                                                  35340062
353500 EJECT                                                            35350062
353600                                                                  35360062
353700 3370-VALIDATE-AUTH-DTE.                                          35370062
353800*----------------------------------------------------------------*35380062
353900*                                                                *35390062
354000*    PERFORMED FROM 3000-EDIT-DATA-IN-COMMAREA.                  *35400062
354100*----------------------------------------------------------------*35410062
354200                                                                  35420062
354300     MOVE ASC-AUTH-MM            TO PV-INPUT-DATE-MM              35430062
354400                                    PV-VALID-DATE-MM.             35440062
354500     MOVE ASC-AUTH-DD            TO PV-INPUT-DATE-DD              35450062
354600                                    PV-VALID-DATE-DD.             35460062
354700                                                                  35470062
354800     MOVE ASC-AUTH-CCYY          TO PV-INPUT-DATE-CCYY            35480062
354900                                    PV-VALID-DATE-CCYY.           35490062
355000                                                                  35500062
355100     PERFORM 3700-VALIDATE-DATE.                                  35510062
355200                                                                  35520062
355300     IF PS-VALID-DATE                                             35530062
355400*        MOVE PV-INPUT-DATE-MM   TO AATHMMO                       35540062
355500         MOVE PV-INPUT-DATE-MM   TO                               35550062
355600                                    ASC-AUTH-MM                   35560062
355700*        MOVE PV-INPUT-DATE-DD   TO AATHDDO                       35570062
355800         MOVE PV-INPUT-DATE-DD   TO                               35580062
355900                                    ASC-AUTH-DD                   35590062
356000         MOVE PV-INPUT-DATE-CCYY TO ASC-AUTH-CCYY                 35600062
356100*        MOVE ASC-AUTH-YY        TO AATHYYO                       35610062
356200         PERFORM 3500-CALL-DATE-RTN                               35620062
356300                                                                  35630062
356400         IF DPG54-DATE-VALID                                      35640062
356500             SET PS-VALID-AUTH-DTE TO TRUE                        35650062
356600         ELSE                                                     35660062
356700             SET PS-INVALID-AUTH-DTE                              35670062
356800                                   TO TRUE                        35680062
356900         END-IF                                                   35690062
357000     ELSE                                                         35700062
357100         SET PS-INVALID-AUTH-DTE   TO TRUE                        35710062
357200     END-IF.                                                      35720062
357300                                                                  35730062
357400 3400-CHK-VND-DATE-RANGE.                                         35740062
357500     EXEC SQL                                                     35750062
357600         SET :PV-DB2-CURRENT-DATE = CURRENT_DATE                  35760062
357700     END-EXEC.                                                    35770062
357800                                                                  35780062
357900****** GET CURRENT DATE MINUS PC-VALID-VND-DT-RANGE               35790062
358000     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              35800062
358100     SET DPG51-ACTUAL-CALENDAR-ONLY                               35810062
358200         DPG51-DECREMENT-DATE                                     35820062
358300         DPG52-LK-DTE-ISO-FMT      TO TRUE.                       35830062
358400                                                                  35840062
358500     MOVE PC-VALID-VND-DT-RANGE TO DPG51-INCR-DECR-DAYS-9.        35850062
358600     MOVE PV-DB2-CURRENT-DATE TO DPG52-LK-DATE-INPUT.             35860062
358700                                                                  35870062
358800     CALL DP500-KOHLS-CALENDAR-ROUTINE                            35880062
358900             USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.           35890062
359000                                                                  35900062
359100     IF DPG54-INCR-DECR-VALID                                     35910062
359200         MOVE DPG55-DB2-ISO-DATE-FMT TO PV-DB2-CURRENT-DATE-M7DD  35920062
359300         MOVE ASC-VEND-SHIP-MM   TO PV-VND-SHIP-MM                35930062
359400         MOVE ASC-VEND-SHIP-DD   TO PV-VND-SHIP-DD                35940062
359500         MOVE ASC-VEND-SHIP-CCYY TO PV-VND-SHIP-CCYY              35950062
359600***** CHECK IF VEND SHIP DATE WITHIN THE RANGE                    35960062
359700         IF PV-VND-SHIP-DATE-FMT > PV-DB2-CURRENT-DATE OR         35970062
359800            PV-VND-SHIP-DATE-FMT < PV-DB2-CURRENT-DATE-M7DD       35980062
359900             SET PS-INVALID-VND-DT-RANGE TO TRUE                  35990062
360000         ELSE                                                     36000062
360100             SET PS-VALID-VND-DT-RANGE TO TRUE                    36010062
360200         END-IF                                                   36020062
360300     ELSE                                                         36030062
360400         SET PS-INVALID-VND-DT-RANGE TO TRUE                      36040062
360500     END-IF.                                                      36050062
360600                                                                  36060062
360700                                                                  36070062
360800 3600-CALL-DATE-RANGE-RTN.                                        36080062
360900*----------------------------------------------------------------*36090062
361000*    SETS ALL THE PROPER INDICATORS FOR A DATE VALIDATION AND    *36100062
361100*    DATE RANGE COMPARISON.                                      *36110062
361200*                                                                *36120062
361300*    PERFORMED FROM 3000-EDIT-DATA-IN-COMMAREA.                  *36130062
361400*----------------------------------------------------------------*36140062
361500                                                                  36150062
361600     INITIALIZE DPG51 DPG52 DPG53                                 36160062
361700                DPG54 DPG55 DPG56.                                36170062
361800     SET DPG51-ACTUAL-CALENDAR-ONLY                               36180062
361900                                 TO TRUE.                         36190062
362000     SET DPG52-LK-DTE-GREG-CC    TO TRUE.                         36200062
362100*    SET DPG52-LK-DTE-GREG       TO TRUE.                         36210062
362200     SET DPG53-LK-CMPR-DTE-GREG-CC                                36220062
362300*    SET DPG53-LK-CMPR-DTE-GREG                                   36230062
362400                                 TO TRUE.                         36240062
362500     SET DPG51-DO-NOT-INCR-DECR-DATE TO TRUE.                     36250062
362600                                                                  36260062
362700     MOVE PV-VALID-ETA-DTE       TO DPG52-LK-DATE-INPUT.          36270062
362800     MOVE PV-VALID-ETA-DTE-2     TO DPG53-LK-CMPR-DATE-INPUT.     36280062
362900                                                                  36290062
363000     CALL DP500-KOHLS-CALENDAR-ROUTINE                            36300062
363100         USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.               36310062
363200                                                                  36320062
363300 EJECT                                                            36330062
363400                                                                  36340062
363500 3500-CALL-DATE-RTN.                                              36350062
363600*----------------------------------------------------------------*36360062
363700*    SETS ALL THE PROPER INDICATORS FOR A DATE VALIDATION        *36370062
363800*                                                                *36380062
363900*    PERFORMED BY 3350-VALIDATE-ETA-DATE.                        *36390062
364000*----------------------------------------------------------------*36400062
364100                                                                  36410062
364200     INITIALIZE DPG51 DPG52 DPG53                                 36420062
364300                DPG54 DPG55 DPG56.                                36430062
364400     SET DPG51-ACTUAL-CALENDAR-ONLY                               36440062
364500                                 TO TRUE.                         36450062
364600     SET DPG52-LK-DTE-GREG-CC    TO TRUE.                         36460062
364700                                                                  36470062
364800     MOVE PV-INPUT-DATE          TO DPG52-LK-DATE-INPUT.          36480062
364900                                                                  36490062
365000     CALL DP500-KOHLS-CALENDAR-ROUTINE                            36500062
365100         USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.               36510062
365200                                                                  36520062
365300 EJECT                                                            36530062
365400                                                                  36540062
365500 3700-VALIDATE-DATE.                                              36550062
365600*----------------------------------------------------------------*36560062
365700*    TAKES THE DATE FIELDS ENTERED AND ADDS LEADING ZEROS IF     *36570062
365800*    NEEDED.  IF THE FIELDS ENTERED ON THE SCREEN ARE NOT NUMERIC*36580062
365900*    A SWITCH IS SET.                                            *36590062
366000*                                                                *36600062
366100*    PERFORMED BY 3350-VALIDATE-ETA-DATE.                        *36610062
366200*----------------------------------------------------------------*36620062
366300                                                                  36630062
366400     SET PS-VALID-DATE           TO TRUE.                         36640062
366500                                                                  36650062
366600     MOVE PV-VALID-DATE-MM       TO DP010I-UNEDITED-FIELD.        36660062
366700     MOVE +2                     TO DP010I-MAXIMUM-DIGITS.        36670062
366800     MOVE +0                     TO DP010I-MAXIMUM-DECIMALS.      36680062
366900                                                                  36690062
367000     SET DP010I-NEGATIVE-NOT-ALLOWED                              36700062
367100                                 TO TRUE.                         36710062
367200                                                                  36720062
273427     CALL DP010I-NUMERIC-EDIT-ROUTINE                             36731083
273427          USING DP010I-NUMERIC-EDIT-AREA.                         36732084
367400                                                                  36740062
367500     IF DP010I-ERROR-DETECTED                                     36750062
367600         SET PS-INVALID-DATE     TO TRUE                          36760062
367700     ELSE                                                         36770062
367800         MOVE DP010I-NUMERIC-FIELD                                36780062
367900                                 TO PV-INPUT-DATE-MM              36790062
368000     END-IF.                                                      36800062
368100                                                                  36810062
368200     MOVE PV-VALID-DATE-DD       TO DP010I-UNEDITED-FIELD.        36820062
368300     MOVE +2                     TO DP010I-MAXIMUM-DIGITS.        36830062
368400     MOVE +0                     TO DP010I-MAXIMUM-DECIMALS.      36840062
368500                                                                  36850062
368600     SET DP010I-NEGATIVE-NOT-ALLOWED                              36860062
368700                                 TO TRUE.                         36870062
368800                                                                  36880062
273427     CALL DP010I-NUMERIC-EDIT-ROUTINE                             36891083
273427          USING DP010I-NUMERIC-EDIT-AREA.                         36892083
369000                                                                  36900062
369100     IF DP010I-ERROR-DETECTED                                     36910062
369200         SET PS-INVALID-DATE     TO TRUE                          36920062
369300     ELSE                                                         36930062
369400         MOVE DP010I-NUMERIC-FIELD                                36940062
369500                                 TO PV-INPUT-DATE-DD              36950062
369600     END-IF.                                                      36960062
369700                                                                  36970062
369800     MOVE PV-VALID-DATE-CCYY     TO DP010I-UNEDITED-FIELD.        36980062
369900     MOVE +4                     TO DP010I-MAXIMUM-DIGITS.        36990062
370000     MOVE +0                     TO DP010I-MAXIMUM-DECIMALS.      37000062
370100                                                                  37010062
370200     SET DP010I-NEGATIVE-NOT-ALLOWED                              37020062
370300                                 TO TRUE.                         37030062
370400                                                                  37040062
273427     CALL DP010I-NUMERIC-EDIT-ROUTINE                             37051083
273427          USING DP010I-NUMERIC-EDIT-AREA.                         37052083
370600                                                                  37060062
370700     IF DP010I-ERROR-DETECTED                                     37070062
370800         SET PS-INVALID-DATE     TO TRUE                          37080062
370900     ELSE                                                         37090062
371000         MOVE DP010I-NUMERIC-FIELD                                37100062
371100                                 TO PV-INPUT-DATE-CCYY            37110062
371200     END-IF.                                                      37120062
371300                                                                  37130062
371400*                                                                 37140062
371500*                                                                 37150062
371600 3800-VALIDATE-FCLTY-ID.                                          37160062
371700                                                                  37170062
371800     PERFORM                                                      37180062
371900         WITH TEST AFTER                                          37190062
372000         VARYING PV-RETRY-COUNTER                                 37200062
372100         FROM 1 BY 1                                              37210062
372200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               37220062
372300                   OR (SQLCODE = ZERO)                            37230062
372400                   OR (SQLCODE = +100))                           37240062
372500                                                                  37250062
372600         EXEC SQL                                                 37260062
372700            SELECT  FCLTY_ID                                      37270062
372800                   ,FCLTY_NME                                     37280062
372900              INTO :FACLTY-FCLTY-ID                               37290062
373000                  ,:FACLTY-FCLTY-NME                              37300062
373100              FROM  TFACLTY                                       37310062
373200             WHERE  OPER_UNT_ID = :PV-OPER-UNT-ID                 37320062
373300               AND  FCLTY_ID    = :PV-FCLTY-ID                    37330062
373400         END-EXEC                                                 37340062
373500                                                                  37350062
373600         EVALUATE TRUE                                            37360062
373700             WHEN SQLCODE = ZERO                                  37370062
373800                 MOVE FACLTY-FCLTY-NME                            37380062
373900                                 TO ASC-FCLTY-NME                 37390062
374000                                    AFDESCO                       37400062
374100                                                                  37410062
374200             WHEN SQLCODE = +100                                  37420062
374300             WHEN SQLCODE = -904                                  37430062
374400             WHEN SQLCODE = -913                                  37440062
374500                 CONTINUE                                         37450062
374600                                                                  37460062
374700             WHEN SQLWARN0 NOT = SPACES                           37470062
374800             WHEN SQLCODE < ZERO                                  37480062
374900             WHEN SQLCODE > ZERO                                  37490062
375000                 MOVE SPACES TO PV-MESSAGE                        37500062
375100                 MOVE PV-OPER-UNT-ID TO PV-MESSAGE1               37510062
375200                 MOVE PV-FCLTY-ID TO PV-MESSAGE2                  37520062
375300                 MOVE '3800-VALIDATE-FCLTY-ID'                    37530062
375400                                 TO DP013-PARAGRAPH               37540062
375500                 MOVE 'GET FCLTY NAME     '                       37550062
375600                                 TO DP013-MESSAGE-TEXT (1)        37560062
375700                 MOVE PV-MESSAGE TO DP013-MESSAGE-TEXT (2)        37570062
375800                 MOVE SQLCA      TO DP013-SQLCA                   37580062
375900                 MOVE 'TFACLTY'  TO DP013-DB2-TABLE-NAME (1)      37590062
376000                 SET DP013-DB2-ABEND                              37600062
376100                                 TO TRUE                          37610062
376200                 SET DP013-XCTL-DISPLAY-RESTART                   37620062
376300                                 TO TRUE                          37630062
376400                 PERFORM DP013-0000-PROCESS-ABEND                 37640062
376500         END-EVALUATE                                             37650062
376600     END-PERFORM.                                                 37660062
376700                                                                  37670062
376800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    37680062
376900         SQLCODE NOT = +0                                         37690062
377000         MOVE '3800-VALIDATE-FCLTY-ID'                            37700062
377100                                 TO DP013-PARAGRAPH               37710062
377200         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     37720062
377300                                 TO DP013-MESSAGE-TEXT (1)        37730062
377400         MOVE 'GET FCLTY NAME'   TO DP013-MESSAGE-TEXT (2)        37740062
377500         MOVE SQLCA              TO DP013-SQLCA                   37750062
377600         MOVE 'TFACLTY'          TO DP013-DB2-TABLE-NAME (1)      37760062
377700         SET DP013-DB2-ABEND     TO TRUE                          37770062
377800         SET DP013-XCTL-DISPLAY-RESTART                           37780062
377900                                 TO TRUE                          37790062
378000         PERFORM DP013-0000-PROCESS-ABEND                         37800062
378100     END-IF.                                                      37810062
378200                                                                  37820062
378300     IF SQLCODE = +100                                            37830062
378400        SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                     37840062
378500        MOVE PC-TSYMSG-01004 TO DP020-MSG-NUMBER                  37850062
378600        SET DP020-MSG-FATAL                                       37860062
378700            PS-ERROR      TO TRUE                                 37870062
378800     END-IF.                                                      37880062
378900                                                                  37890062
379000 3900-VALIDATE-OPER-UNT-ID.                                       37900062
379100                                                                  37910062
379200     PERFORM                                                      37920062
379300         WITH TEST AFTER                                          37930062
379400         VARYING PV-RETRY-COUNTER                                 37940062
379500         FROM 1 BY 1                                              37950062
379600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               37960062
379700                   OR (SQLCODE = ZERO)                            37970062
379800                   OR (SQLCODE = +100)                            37980062
379900                   OR (SQLCODE = -811))                           37990062
380000                                                                  38000062
380100         EXEC SQL                                                 38010062
380200            SELECT  OPER_UNT_ID                                   38020062
380300              INTO :FACLTY-OPER-UNT-ID                            38030062
380400              FROM  TFACLTY                                       38040062
380500             WHERE  OPER_UNT_ID = :PV-OPER-UNT-ID                 38050062
380600         END-EXEC                                                 38060062
380700                                                                  38070062
380800         EVALUATE TRUE                                            38080062
380900             WHEN SQLCODE = ZERO                                  38090062
381000             WHEN SQLCODE = +100                                  38100062
381100             WHEN SQLCODE = -811                                  38110062
381200             WHEN SQLCODE = -904                                  38120062
381300             WHEN SQLCODE = -913                                  38130062
381400                 CONTINUE                                         38140062
381500             WHEN SQLWARN0 NOT = SPACES                           38150062
381600             WHEN SQLCODE < ZERO                                  38160062
381700             WHEN SQLCODE > ZERO                                  38170062
381800                 MOVE '3900-VALIDATE-FCLTY-ID'                    38180062
381900                                 TO DP013-PARAGRAPH               38190062
382000                 MOVE 'SELECT STORE NUMBER'                       38200062
382100                                 TO DP013-MESSAGE-TEXT (1)        38210062
382200                 MOVE PV-OPER-UNT-ID                              38220062
382300                                 TO DP013-MESSAGE-TEXT (2)        38230062
382400                 MOVE SQLCA      TO DP013-SQLCA                   38240062
382500                 MOVE 'TFACLTY'  TO DP013-DB2-TABLE-NAME (1)      38250062
382600                 SET DP013-DB2-ABEND                              38260062
382700                                 TO TRUE                          38270062
382800                 SET DP013-XCTL-DISPLAY-RESTART                   38280062
382900                                 TO TRUE                          38290062
383000                 PERFORM DP013-0000-PROCESS-ABEND                 38300062
383100         END-EVALUATE                                             38310062
383200     END-PERFORM.                                                 38320062
383300                                                                  38330062
383400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    38340062
383500         SQLCODE NOT = +0                                         38350062
383600         MOVE '3900-VALIDATE-FCLTY-ID'                            38360062
383700                                 TO DP013-PARAGRAPH               38370062
383800         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     38380062
383900                                 TO DP013-MESSAGE-TEXT (1)        38390062
384000         MOVE 'STORE NUMBER  '   TO DP013-MESSAGE-TEXT (2)        38400062
384100         MOVE SQLCA              TO DP013-SQLCA                   38410062
384200         MOVE 'TFACLTY'          TO DP013-DB2-TABLE-NAME (1)      38420062
384300         SET DP013-DB2-ABEND     TO TRUE                          38430062
384400         SET DP013-XCTL-DISPLAY-RESTART                           38440062
384500                                 TO TRUE                          38450062
384600         PERFORM DP013-0000-PROCESS-ABEND                         38460062
384700     END-IF.                                                      38470062
384800                                                                  38480062
384900     IF SQLCODE = +100                                            38490062
385000        SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                     38500062
385100        MOVE PC-TSYMSG-01004 TO DP020-MSG-NUMBER                  38510062
385200        SET DP020-MSG-FATAL                                       38520062
385300            PS-ERROR      TO TRUE                                 38530062
385400     END-IF.                                                      38540062
385500                                                                  38550062
385600 EJECT                                                            38560062
385700                                                                  38570062
385800*----------------------------------------------------------------*38580062
385900* OBTAIN THE PURCHASE ORDER INFORMATION FROM THE PO TABLES AND   *38590062
386000* DISPLAY THEM ON THE SCREEN.                                    *38600062
386100*----------------------------------------------------------------*38610062
386200                                                                  38620062
386300                                                                  38630062
386400 4000-BUILD-INITIAL-PANEL.                                        38640062
386500                                                                  38650062
386600     SET DP030-SET-CURSOR-APPL-1   TO TRUE.                       38660062
386700     MOVE -1                       TO APONBRL.                    38670062
386800                                                                  38680062
386900                                                                  38690062
387000 EJECT                                                            38700062
387100*----------------------------------------------------------------*38710062
387200*    SELECT THE NEEDED INFORMATION FROM THE PURCHASE ORDER HEADER*38720062
387300*    TALBE.                                                      *38730062
387400*----------------------------------------------------------------*38740062
387500                                                                  38750062
387600 4100-GET-PO-INFO.                                                38760062
387700                                                                  38770062
387800     PERFORM 4150-SELECT-TPURCHS.                                 38780062
387900                                                                  38790062
388000     IF PS-FOUND                                                  38800062
388100        PERFORM 4160-CHECK-STATUS                                 38810062
388200        PERFORM 4200-SELECT-TPLNSHP                               38820062
388300        PERFORM 4250-SELECT-DPT-BYR                               38830062
388400        PERFORM 4300-DETERMINE-NO-DISTRO                          38840062
388500        MOVE ASC-OPER-UNT-ID          TO AOPERO                   38850062
388600        MOVE ASC-FCLTY-ID             TO AFCLTYO                  38860062
388700        MOVE ASC-FCLTY-NME            TO AFDESCO                  38870062
388800        MOVE ASC-PO-NBR               TO APONBRO                  38880062
388900        MOVE ASC-PO-STATUS-DESC       TO APOSTATO                 38890062
389000                                                                  38900062
389100        IF  ASC-DONT-SHIP-BEF-DTE = '01/01/0001'                  38910062
389200            MOVE SPACES               TO ABEFDTEO                 38920062
389300        ELSE                                                      38930062
389400            MOVE ASC-DONT-SHIP-BEF-DTE                            38940062
389500                                      TO ABEFDTEO                 38950062
389600        END-IF                                                    38960062
389700                                                                  38970062
389800        IF  ASC-CANCEL-DTE = '01/01/0001'                         38980062
389900            MOVE SPACES               TO ACANDTEO                 38990062
390000        ELSE                                                      39000062
390100            MOVE ASC-CANCEL-DTE       TO ACANDTEO                 39010062
390200        END-IF                                                    39020062
390300                                                                  39030062
390400        IF  ASC-EXT-CAN-DTE = '01/01/0001'                        39040062
390500            MOVE SPACES               TO AEXCDTEO                 39050062
390600        ELSE                                                      39060062
390700            MOVE ASC-EXT-CAN-DTE      TO AEXCDTEO                 39070062
390800        END-IF                                                    39080062
390900                                                                  39090062
391000        MOVE ASC-DEPT-NBR-N           TO ADPTNBRO                 39100062
391100        MOVE ASC-DEPT-DESC            TO ADPTDSCO                 39110062
391200        MOVE ASC-BUYER-NME            TO ABUYNMEO                 39120062
391300        MOVE ASC-NO-DISTRO-MSG        TO ADISTOO                  39130062
391400     ELSE                                                         39140062
391500        SET PS-ERROR              TO TRUE                         39150062
391600        SET DP020-MSG-FATAL       TO TRUE                         39160062
391700        MOVE -1                   TO APONBRL                      39170062
391800        SET DP030-SET-CURSOR-APPL-1 TO TRUE                       39180062
391900        MOVE PC-TSYMSG-00083      TO DP020-MSG-NUMBER             39190062
392000        MOVE SPACES               TO ASC-PO-STATUS-DESC           39200062
392100                                     APOSTATO                     39210062
392200                                     ASC-DONT-SHIP-BEF-DTE        39220062
392300                                     ABEFDTEO                     39230062
392400                                     ASC-CANCEL-DTE               39240062
392500                                     ACANDTEO                     39250062
392600                                     ASC-EXT-CAN-DTE              39260062
392700                                     AEXCDTEO                     39270062
392800                                     ASC-DEPT-NBR                 39280062
392900                                     ASC-DEPT-DESC                39290062
393000                                     ADPTDSCO                     39300062
393100                                     ASC-BUYER-NME                39310062
393200                                     ABUYNMEO                     39320062
393300*                                    ASC-NO-DISTRO-MSG            39330062
393400                                     ADISTOO                      39340062
393500        MOVE ZEROES               TO ASC-PO-CARTON-CNT            39350062
393600                                     APOCNTO                      39360062
393700                                     ADPTNBRO                     39370062
393800     END-IF.                                                      39380062
393900                                                                  39390062
394000*    PERFORM 4340-CONV-DATES-TO-CCYYMMDD.                         39400062
394100                                                                  39410062
394200 4150-SELECT-TPURCHS.                                             39420062
394300*----------------------------------------------------------------*39430062
394400****   SELECT THE TPURCHS INFORMATION   *****                     39440062
394500*----------------------------------------------------------------*39450062
394600     PERFORM WITH TEST AFTER                                      39460062
394700         VARYING PV-RETRY-COUNTER                                 39470062
394800         FROM 1 BY 1                                              39480062
394900         UNTIL (PV-RETRY-COUNTER > PC-MAX-RETRIES                 39490062
395000                 OR SQLCODE = 0                                   39500062
395100                 OR SQLCODE = +100)                               39510062
395200                                                                  39520062
395300         EXEC SQL                                                 39530062
395400             SELECT STATUS_CDE                                    39540062
395500                   ,DEPT_NBR                                      39550062
395600                   ,ENT_ID                                        39560062
395700             INTO   :PURCHS-STATUS-CDE                            39570062
395800                   ,:PURCHS-DEPT-NBR                              39580062
395900                   ,:PURCHS-ENT-ID                                39590062
396000             FROM   TPURCHS                                       39600062
396100             WHERE  PO_NBR         = :DK-PO-NBR                   39610062
396200             AND    VER_STATUS_CDE = :PC-ACTIVE                   39620062
396300         END-EXEC                                                 39630062
396400                                                                  39640062
396500         EVALUATE TRUE                                            39650062
396600             WHEN SQLCODE = +0                                    39660062
396700                  SET PS-FOUND TO TRUE                            39670062
396800                  MOVE PURCHS-DEPT-NBR TO ASC-DEPT-NBR-N          39680062
396900                  MOVE PURCHS-ENT-ID   TO ASC-ENT-ID              39690062
397000                                                                  39700062
397100             WHEN SQLCODE = +100                                  39710062
397200                  SET PS-NOT-FOUND TO TRUE                        39720062
397300                  MOVE SPACES  TO ASC-NO-DISTRO-MSG               39730062
397400                                  ASC-PO-STATUS-DESC              39740062
397500                                  ASC-DONT-SHIP-BEF-DTE           39750062
397600                                  ASC-CANCEL-DTE                  39760062
397700                                  ASC-EXT-CAN-DTE                 39770062
397800                                  ASC-DEPT-NBR                    39780062
397900                                  ASC-DEPT-DESC                   39790062
398000                                  ASC-BUYER-NME                   39800062
398100             WHEN SQLCODE = -904                                  39810062
398200             WHEN SQLCODE = -911                                  39820062
398300             WHEN SQLCODE = -913                                  39830062
398400                  CONTINUE                                        39840062
398500                                                                  39850062
398600             WHEN OTHER                                           39860062
398700                  SET  PS-DONE TO TRUE                            39870062
398800                  MOVE '4150-SELECT-PURCHS'                       39880062
398900                                  TO DP013-PARAGRAPH              39890062
399000                  MOVE 'UNSUCCESSFUL SELECT ON TPURCHS  '         39900062
399100                                  TO DP013-MESSAGE-TEXT (1)       39910062
399200                  MOVE DK-PO-NBR  TO DP013-MESSAGE-TEXT (2)       39920062
399300                  MOVE SQLCA      TO DP013-SQLCA                  39930062
399400                  MOVE 'TPURCHS ' TO DP013-DB2-TABLE-NAME (1)     39940062
399500                  SET DP013-DB2-ABEND                             39950062
399600                      DP013-XCTL-DISPLAY-RESTART                  39960062
399700                                  TO TRUE                         39970062
399800                  PERFORM DP013-0000-PROCESS-ABEND                39980062
399900         END-EVALUATE                                             39990062
400000     END-PERFORM.                                                 40000062
400100                                                                  40010062
400200     IF PV-RETRY-COUNTER > PC-MAX-RETRIES AND                     40020062
400300         SQLCODE NOT = +0                                         40030062
400400         SET  PS-DONE TO TRUE                                     40040062
400500         MOVE '4150-SELECT-TPURCHS '                              40050062
400600                         TO DP013-PARAGRAPH                       40060062
400700         MOVE 'UNSUCCESSFUL SELECT ON TPURCHS  '                  40070062
400800                         TO DP013-MESSAGE-TEXT (1)                40080062
400900         MOVE SQLCA      TO DP013-SQLCA                           40090062
401000         MOVE 'TPURCHS ' TO DP013-DB2-TABLE-NAME (1)              40100062
401100         SET DP013-DB2-ABEND                                      40110062
401200             DP013-XCTL-DISPLAY-RESTART                           40120062
401300                         TO TRUE                                  40130062
401400         PERFORM DP013-0000-PROCESS-ABEND                         40140062
401500     END-IF.                                                      40150062
401600                                                                  40160062
401700*                                                                 40170062
401800****   GET THE STATUS DESCRIPTION       *****                     40180062
401900*                                                                 40190062
402000     IF PS-FOUND                                                  40200062
402100        PERFORM WITH TEST AFTER                                   40210062
402200            VARYING PV-RETRY-COUNTER                              40220062
402300            FROM 1 BY 1                                           40230062
402400            UNTIL (PV-RETRY-COUNTER > PC-MAX-RETRIES              40240062
402500                    OR SQLCODE = 0                                40250062
402600                    OR SQLCODE = +100)                            40260062
402700                                                                  40270062
402800            EXEC SQL                                              40280062
402900                SELECT STATUS_DESC                                40290062
403000                INTO   :STATCD-STATUS-DESC                        40300062
403100                FROM   TSTATCD                                    40310062
403200                WHERE  STATUS_CDE     = :PURCHS-STATUS-CDE        40320062
403300                AND    STATUS_TYP_CDE = 'P'                       40330062
403400            END-EXEC                                              40340062
403500                                                                  40350062
403600            EVALUATE TRUE                                         40360062
403700                WHEN SQLCODE = +0                                 40370062
403800                     MOVE PURCHS-STATUS-CDE  TO ASC-PO-STATUS     40380062
403900                     MOVE STATCD-STATUS-DESC TO ASC-PO-STATUS-DESC40390062
404000                                                                  40400062
404100                WHEN SQLCODE = +100                               40410062
404200                     SET PS-NOT-FOUND TO TRUE                     40420062
404300                WHEN SQLCODE = -904                               40430062
404400                WHEN SQLCODE = -911                               40440062
404500                WHEN SQLCODE = -913                               40450062
404600                     CONTINUE                                     40460062
404700                                                                  40470062
404800                WHEN OTHER                                        40480062
404900                     SET  PS-DONE TO TRUE                         40490062
405000                     MOVE '4150-SELECT-TSTATCD'                   40500062
405100                                     TO DP013-PARAGRAPH           40510062
405200                     MOVE 'UNSUCCESSFUL SELECT ON TSTATCD  '      40520062
405300                                     TO DP013-MESSAGE-TEXT (1)    40530062
405400                     MOVE PURCHS-STATUS-CDE                       40540062
405500                                     TO DP013-MESSAGE-TEXT (2)    40550062
405600                     MOVE SQLCA      TO DP013-SQLCA               40560062
405700                     MOVE 'TSTATCD ' TO DP013-DB2-TABLE-NAME (1)  40570062
405800                     SET DP013-DB2-ABEND                          40580062
405900                         DP013-XCTL-DISPLAY-RESTART               40590062
406000                                     TO TRUE                      40600062
406100                     PERFORM DP013-0000-PROCESS-ABEND             40610062
406200            END-EVALUATE                                          40620062
406300        END-PERFORM                                               40630062
406400     END-IF.                                                      40640062
406500                                                                  40650062
406600     IF PV-RETRY-COUNTER > PC-MAX-RETRIES AND                     40660062
406700         SQLCODE NOT = +0                                         40670062
406800         SET  PS-DONE TO TRUE                                     40680062
406900         MOVE '4150-SELECT-TSTATCD '                              40690062
407000                         TO DP013-PARAGRAPH                       40700062
407100         MOVE 'UNSUCCESSFUL SELECT ON TSTATCD  '                  40710062
407200                         TO DP013-MESSAGE-TEXT (1)                40720062
407300         MOVE SQLCA      TO DP013-SQLCA                           40730062
407400         MOVE 'TSTATCD ' TO DP013-DB2-TABLE-NAME (1)              40740062
407500         SET DP013-DB2-ABEND                                      40750062
407600             DP013-XCTL-DISPLAY-RESTART                           40760062
407700                         TO TRUE                                  40770062
407800         PERFORM DP013-0000-PROCESS-ABEND                         40780062
407900     END-IF.                                                      40790062
408000                                                                  40800062
408100 4160-CHECK-STATUS.                                               40810062
408200*----------------------------------------------------------------*40820062
408300*  A PO MAY NOT BE ADDED TO THE FORECAST SYSTEM IF THE PO STATUS  40830062
408400*  IS NOT ONE OF THE FOLLOWING STATUS - ACTIVE, APPROVED, COMPLETE40840062
408500*  , CANCELLED, OR CANCEL BALANCE.  THE STATUS WILL BE HIGHLIGHTED40850062
408600*  IF NOT 'ACTIVE' OR 'APPROVED'.                                 40860062
408700*----------------------------------------------------------------*40870062
408800                                                                  40880062
408900      SET ASC-VALID-PO-STATUS TO TRUE.                            40890062
409000                                                                  40900062
409100      EVALUATE PURCHS-STATUS-CDE                                  40910062
409200         WHEN PC-PO-ACTIVE                                        40920062
409300         WHEN PC-APPROVED                                         40930062
409400              CONTINUE                                            40940062
409500         WHEN PC-CANCELLED                                        40950062
409600         WHEN PC-COMPLETE                                         40960062
409700              MOVE DP015-YELLOW       TO APOSTATC                 40970062
409800         WHEN OTHER                                               40980062
409900              SET ASC-INVALID-PO-STATUS TO TRUE                   40990062
410000              MOVE DP015-YELLOW       TO APOSTATC                 41000062
410100      END-EVALUATE.                                               41010062
410200                                                                  41020062
410300 4200-SELECT-TPLNSHP.                                             41030062
410400*----------------------------------------------------------------*41040062
410500*  SELECT THE NEEDED INFORMATION FROM THE TPLNSHP TABLE           41050062
410600*----------------------------------------------------------------*41060062
410700                                                                  41070062
410800     PERFORM WITH TEST AFTER                                      41080062
410900         VARYING PV-RETRY-COUNTER                                 41090062
411000         FROM 1 BY 1                                              41100062
411100         UNTIL (PV-RETRY-COUNTER > PC-MAX-RETRIES                 41110062
411200                 OR SQLCODE = 0                                   41120062
411300                 OR SQLCODE = +100)                               41130062
411400                                                                  41140062
411500         EXEC SQL                                                 41150062
411600             SELECT DONT_SHIP_BEF_DTE                             41160062
411700                   ,CAN_IFNOT_SHIP_DTE                            41170062
411800                   ,EXT_CAN_DTE                                   41180062
411900             INTO   :PLNSHP-DONT-SHIP-BEF-DTE                     41190062
412000                   ,:PLNSHP-CAN-IFNOT-SHIP-DTE                    41200062
412100                   ,:PLNSHP-EXT-CAN-DTE                           41210062
412200             FROM   TPLNSHP                                       41220062
412300             WHERE  PO_NBR         = :DK-PO-NBR                   41230062
412400             AND    VER_STATUS_CDE = :PC-ACTIVE                   41240062
412500         END-EXEC                                                 41250062
412600                                                                  41260062
412700         EVALUATE TRUE                                            41270062
412800             WHEN SQLCODE = +0                                    41280062
412900                MOVE PLNSHP-DONT-SHIP-BEF-DTE TO PV-TEMP-DATE     41290062
413000                MOVE PV-DATE-CCYY  TO PV-WK-DTE-YY                41300062
413100                MOVE PV-DATE-MM    TO PV-WK-DTE-MM                41310062
413200                MOVE PV-DATE-DD    TO PV-WK-DTE-DD                41320062
413300                MOVE PV-WORK-DATE  TO ASC-DONT-SHIP-BEF-DTE       41330062
413400                                                                  41340062
413500                MOVE PLNSHP-CAN-IFNOT-SHIP-DTE TO PV-TEMP-DATE    41350062
413600                MOVE PV-DATE-CCYY  TO PV-WK-DTE-YY                41360062
413700                MOVE PV-DATE-MM    TO PV-WK-DTE-MM                41370062
413800                MOVE PV-DATE-DD    TO PV-WK-DTE-DD                41380062
413900                MOVE PV-WORK-DATE  TO ASC-CANCEL-DTE              41390062
414000                                                                  41400062
414100                MOVE PLNSHP-EXT-CAN-DTE TO PV-TEMP-DATE           41410062
414200                MOVE PV-DATE-CCYY  TO PV-WK-DTE-YY                41420062
414300                MOVE PV-DATE-MM    TO PV-WK-DTE-MM                41430062
414400                MOVE PV-DATE-DD    TO PV-WK-DTE-DD                41440062
414500                MOVE PV-WORK-DATE  TO ASC-EXT-CAN-DTE             41450062
414600                                                                  41460062
414700             WHEN SQLCODE = +100                                  41470062
414800                  SET PS-DONE  TO TRUE                            41480062
414900             WHEN SQLCODE = -904                                  41490062
415000             WHEN SQLCODE = -911                                  41500062
415100             WHEN SQLCODE = -913                                  41510062
415200                  CONTINUE                                        41520062
415300                                                                  41530062
415400             WHEN OTHER                                           41540062
415500                  SET  PS-DONE TO TRUE                            41550062
415600                  MOVE '4200-SELECT-TPLNSHP'                      41560062
415700                                  TO DP013-PARAGRAPH              41570062
415800                  MOVE 'UNSUCCESSFUL SELECT ON TPLNSHP  '         41580062
415900                                  TO DP013-MESSAGE-TEXT (1)       41590062
416000                  MOVE DK-PO-NBR  TO DP013-MESSAGE-TEXT (2)       41600062
416100                  MOVE SQLCA      TO DP013-SQLCA                  41610062
416200                  MOVE 'TPLNSHP ' TO DP013-DB2-TABLE-NAME (1)     41620062
416300                  SET DP013-DB2-ABEND                             41630062
416400                      DP013-XCTL-DISPLAY-RESTART                  41640062
416500                                  TO TRUE                         41650062
416600                  PERFORM DP013-0000-PROCESS-ABEND                41660062
416700         END-EVALUATE                                             41670062
416800     END-PERFORM.                                                 41680062
416900                                                                  41690062
417000     IF PV-RETRY-COUNTER > PC-MAX-RETRIES AND                     41700062
417100         SQLCODE NOT = +0                                         41710062
417200         SET  PS-DONE TO TRUE                                     41720062
417300         MOVE '4200-SELECT-TPLNSHP'                               41730062
417400                         TO DP013-PARAGRAPH                       41740062
417500         MOVE 'UNSUCCESSFUL SELECT ON TPLNSHP  '                  41750062
417600                         TO DP013-MESSAGE-TEXT (1)                41760062
417700         MOVE SQLCA      TO DP013-SQLCA                           41770062
417800         MOVE 'TPLNSHP ' TO DP013-DB2-TABLE-NAME (1)              41780062
417900         SET DP013-DB2-ABEND                                      41790062
418000             DP013-XCTL-DISPLAY-RESTART                           41800062
418100                         TO TRUE                                  41810062
418200         PERFORM DP013-0000-PROCESS-ABEND                         41820062
418300     END-IF.                                                      41830062
418400                                                                  41840062
418500 4250-SELECT-DPT-BYR.                                             41850062
418600*----------------------------------------------------------------*41860062
418700*  SELECT THE NEEDED INFORMATION FROM THE TMDSEAR AND TRSPBAR     41870062
418800*  TABLES                                                         41880062
418900*----------------------------------------------------------------*41890062
419000                                                                  41900062
419100     PERFORM WITH TEST AFTER                                      41910062
419200         VARYING PV-RETRY-COUNTER                                 41920062
419300         FROM 1 BY 1                                              41930062
419400         UNTIL (PV-RETRY-COUNTER > PC-MAX-RETRIES                 41940062
419500                 OR SQLCODE = 0                                   41950062
419600                 OR SQLCODE = +100)                               41960062
419700                                                                  41970062
419800         EXEC SQL                                                 41980062
419900             SELECT MDSEAR_DKEY                                   41990062
420000                   ,BYR_NBR                                       42000062
420100                   ,MDSEAR_DESC                                   42010062
420200             INTO   :MDSEAR-DKEY                                  42020062
420300                   ,:MDSEAR-BYR-NBR                               42030062
420400                   ,:MDSEAR-DESC                                  42040062
420500             FROM   TMDSEAR                                       42050062
420600             WHERE  DEPT_NBR       = :PURCHS-DEPT-NBR             42060062
420700             AND    MDSELV_CDE     = 'DPT'                        42070062
420800             AND    CURRENT DATE BETWEEN STRT_DTE AND END_DTE     42080062
420900         END-EXEC                                                 42090062
421000                                                                  42100062
421100         EVALUATE TRUE                                            42110062
421200             WHEN SQLCODE = +0                                    42120062
421300                  MOVE MDSEAR-DESC TO ASC-DEPT-DESC               42130062
421400                                                                  42140062
421500             WHEN SQLCODE = +100                                  42150062
421600                  SET PS-DONE PS-DPT-NOT-FOUND TO TRUE            42160062
421700                  MOVE SPACES TO ASC-DEPT-DESC                    42170062
421800             WHEN SQLCODE = -904                                  42180062
421900             WHEN SQLCODE = -911                                  42190062
422000             WHEN SQLCODE = -913                                  42200062
422100                  CONTINUE                                        42210062
422200                                                                  42220062
422300             WHEN OTHER                                           42230062
422400                  SET  PS-DONE TO TRUE                            42240062
422500                  MOVE '4250-SELECT-DPT-BYR'                      42250062
422600                                  TO DP013-PARAGRAPH              42260062
422700                  MOVE 'UNSUCCESSFUL SELECT ON TMDSEAR  '         42270062
422800                                  TO DP013-MESSAGE-TEXT (1)       42280062
422900                  MOVE PURCHS-DEPT-NBR                            42290062
423000                                  TO DP013-MESSAGE-TEXT (2)       42300062
423100                  MOVE SQLCA      TO DP013-SQLCA                  42310062
423200                  MOVE 'TMDSEAR ' TO DP013-DB2-TABLE-NAME (1)     42320062
423300                  SET DP013-DB2-ABEND                             42330062
423400                      DP013-XCTL-DISPLAY-RESTART                  42340062
423500                                  TO TRUE                         42350062
423600                  PERFORM DP013-0000-PROCESS-ABEND                42360062
423700         END-EVALUATE                                             42370062
423800     END-PERFORM.                                                 42380062
423900                                                                  42390062
424000     IF PV-RETRY-COUNTER > PC-MAX-RETRIES AND                     42400062
424100         SQLCODE NOT = +0                                         42410062
424200         SET  PS-DONE TO TRUE                                     42420062
424300         MOVE '4250-SELECT-DPT-BYR'                               42430062
424400                         TO DP013-PARAGRAPH                       42440062
424500         MOVE 'UNSUCCESSFUL SELECT ON TMDSEAR  '                  42450062
424600                         TO DP013-MESSAGE-TEXT (1)                42460062
424700         MOVE SQLCA      TO DP013-SQLCA                           42470062
424800         MOVE 'TMDSEAR ' TO DP013-DB2-TABLE-NAME (1)              42480062
424900         SET DP013-DB2-ABEND                                      42490062
425000             DP013-XCTL-DISPLAY-RESTART                           42500062
425100                         TO TRUE                                  42510062
425200         PERFORM DP013-0000-PROCESS-ABEND                         42520062
425300     END-IF.                                                      42530062
425400                                                                  42540062
425500*                                                                 42550062
425600****   SELECT THE TRSPBAR INFORMATION   *****                     42560062
425700*                                                                 42570062
425800     IF PS-DPT-NOT-FOUND                                          42580062
425900        CONTINUE                                                  42590062
426000     ELSE                                                         42600062
426100        PERFORM WITH TEST AFTER                                   42610062
426200            VARYING PV-RETRY-COUNTER                              42620062
426300            FROM 1 BY 1                                           42630062
426400            UNTIL (PV-RETRY-COUNTER > PC-MAX-RETRIES              42640062
426500                    OR SQLCODE = 0                                42650062
426600                    OR SQLCODE = +100)                            42660062
426700                                                                  42670062
426800            EXEC SQL                                              42680062
426900                SELECT WORKER_NBR                                 42690062
427000                      ,WORKER_FIR_NAME                            42700062
427100                      ,WORKER_LAST_NAME                           42710062
427200                INTO   :RSPBAR-WORKER-NBR                         42720062
427300                      ,:RSPBAR-WORKER-FIR-NAME                    42730062
427400                      ,:RSPBAR-WORKER-LAST-NAME                   42740062
427500                FROM   TRSPBAR                                    42750062
427600                WHERE  MDSEAR_DKEY    = :MDSEAR-DKEY              42760062
427700                AND    RSPLVL_CDE    = 'BYR'                      42770062
427800                AND    CURRENT DATE BETWEEN WORKER_STRT_DTE AND   42780062
427900                                            WORKER_END_DTE        42790062
428000            END-EXEC                                              42800062
428100                                                                  42810062
428200            EVALUATE TRUE                                         42820062
428300                WHEN SQLCODE = +0                                 42830062
428400                  MOVE RSPBAR-WORKER-FIR-NAME TO PV-W-FIRST-NAME  42840062
428500                  MOVE RSPBAR-WORKER-LAST-NAME TO PV-W-LAST-NAME  42850062
428600                  MOVE PV-W-FIRST-NAME TO PV-WORKER-FIRST         42860062
428700                  MOVE PV-W-LAST-NAME  TO PV-WORKER-LAST          42870062
428800                  MOVE PV-WORKER-NAME  TO ASC-BUYER-NME           42880062
428900                                                                  42890062
429000                WHEN SQLCODE = +100                               42900062
429100                     SET PS-DONE  TO TRUE                         42910062
429200                WHEN SQLCODE = -904                               42920062
429300                WHEN SQLCODE = -911                               42930062
429400                WHEN SQLCODE = -913                               42940062
429500                     CONTINUE                                     42950062
429600                                                                  42960062
429700                WHEN OTHER                                        42970062
429800                     SET  PS-DONE TO TRUE                         42980062
429900                     MOVE '4250-SELECT-DPT-BYR'                   42990062
430000                                     TO DP013-PARAGRAPH           43000062
430100                     MOVE 'UNSUCCESSFUL SELECT ON TRSPBAR  '      43010062
430200                                     TO DP013-MESSAGE-TEXT (1)    43020062
430300                     MOVE MDSEAR-DKEY TO DP013-MESSAGE-TEXT (2)   43030062
430400                     MOVE SQLCA      TO DP013-SQLCA               43040062
430500                     MOVE 'TRSPBAR ' TO DP013-DB2-TABLE-NAME (1)  43050062
430600                     SET DP013-DB2-ABEND                          43060062
430700                         DP013-XCTL-DISPLAY-RESTART               43070062
430800                                     TO TRUE                      43080062
430900                     PERFORM DP013-0000-PROCESS-ABEND             43090062
431000            END-EVALUATE                                          43100062
431100        END-PERFORM                                               43110062
431200     END-IF.                                                      43120062
431300                                                                  43130062
431400     IF PV-RETRY-COUNTER > PC-MAX-RETRIES AND                     43140062
431500         SQLCODE NOT = +0                                         43150062
431600         SET  PS-DONE TO TRUE                                     43160062
431700         MOVE '4250-SELECT-DPT-BYR'                               43170062
431800                         TO DP013-PARAGRAPH                       43180062
431900         MOVE 'UNSUCCESSFUL SELECT ON TRSPBAR  '                  43190062
432000                         TO DP013-MESSAGE-TEXT (1)                43200062
432100         MOVE SQLCA      TO DP013-SQLCA                           43210062
432200         MOVE 'TRSPBAR ' TO DP013-DB2-TABLE-NAME (1)              43220062
432300         SET DP013-DB2-ABEND                                      43230062
432400             DP013-XCTL-DISPLAY-RESTART                           43240062
432500                         TO TRUE                                  43250062
432600         PERFORM DP013-0000-PROCESS-ABEND                         43260062
432700     END-IF.                                                      43270062
432800                                                                  43280062
432900                                                                  43290062
433000 4300-DETERMINE-NO-DISTRO.                                        43300062
433100******************************************************************43310062
433200*    THIS PARAGRAPH DETERMINES IF THE 'NO DISTRO' SHOULD BE       43320062
433300*    DISPLAYED FOR THE PO.                                        43330062
433400******************************************************************43340062
433500                                                                  43350062
433600                                                                  43360062
433700     PERFORM 4310-OPEN-PO-CSR.                                    43370062
433800     PERFORM 4320-FETCH-PO-CSR.                                   43380062
433900     SET PS-NOT-DONE TO TRUE.                                     43390062
434000     MOVE ASC-OPER-UNT-ID TO PV-OPER-UNT-ID.                      43400062
434100     PERFORM 4330-PROCESS-PO-CSR UNTIL PS-DONE.                   43410062
434200                                                                  43420062
434300     IF PS-NO-TALLPLN-EXIST                                       43430062
434400        MOVE 'MISDIRECT'      TO ASC-NO-DISTRO-MSG                43440062
434500     ELSE                                                         43450062
434600     IF PS-DISPLAY-DISTRO-MSG                                     43460062
434700        MOVE 'NO DISTRO'      TO ASC-NO-DISTRO-MSG                43470062
434800     ELSE                                                         43480062
434900        MOVE SPACES           TO ASC-NO-DISTRO-MSG                43490062
435000     END-IF.                                                      43500062
435100                                                                  43510062
435200 4310-OPEN-PO-CSR.                                                43520062
435300                                                                  43530062
435400     PERFORM                                                      43540062
435500         WITH TEST AFTER                                          43550062
435600         VARYING PV-RETRY-COUNTER                                 43560062
435700         FROM 1 BY 1                                              43570062
435800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               43580062
435900            OR (SQLCODE = +0))                                    43590062
436000                                                                  43600062
436100         EXEC SQL                                                 43610062
436200              OPEN PO_CSR                                         43620062
436300         END-EXEC                                                 43630062
436400                                                                  43640062
436500         EVALUATE TRUE                                            43650062
436600             WHEN SQLCODE = +0                                    43660062
436700                  CONTINUE                                        43670062
436800             WHEN SQLCODE = -904                                  43680062
436900             WHEN SQLCODE = -913                                  43690062
437000                  CONTINUE                                        43700062
437100             WHEN SQLWARN0 NOT = SPACE                            43710062
437200             WHEN SQLCODE  NOT = +0                               43720062
437300                  MOVE '4310-OPEN-PO-CSR'                         43730062
437400                                   TO DP013-PARAGRAPH             43740062
437500                  MOVE 'OPEN PO CURSOR'                           43750062
437600                                   TO DP013-MESSAGE-TEXT (1)      43760062
437700                  MOVE DK-PO-NBR   TO DP013-MESSAGE-TEXT (2)      43770062
437800                  MOVE SQLCA       TO DP013-SQLCA                 43780062
437900                  MOVE 'TPURCHS'   TO DP013-DB2-TABLE-NAME (1)    43790062
438000                  SET DP013-DB2-ABEND                             43800062
438100                                   TO TRUE                        43810062
438200                  PERFORM DP013-0000-PROCESS-ABEND                43820062
438300         END-EVALUATE                                             43830062
438400     END-PERFORM.                                                 43840062
438500                                                                  43850062
438600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    43860062
438700         SQLCODE NOT = +0                                         43870062
438800         MOVE '4310-OPEN-PO-CSR' TO DP013-PARAGRAPH               43880062
438900         MOVE 'MAX RETRIES EXCEEDED FOR OPEN PO CURSOR'           43890062
439000                                   TO DP013-MESSAGE-TEXT (1)      43900062
439100         MOVE SQLCA                TO DP013-SQLCA                 43910062
439200         SET DP013-DB2-ABEND       TO TRUE                        43920062
439300         PERFORM DP013-0000-PROCESS-ABEND                         43930062
439400     END-IF.                                                      43940062
439500                                                                  43950062
439600 4320-FETCH-PO-CSR.                                               43960062
439700                                                                  43970062
439800     EXEC SQL                                                     43980062
439900          FETCH PO_CSR                                            43990062
440000          INTO :PURITM-PO-LNE-NBR                                 44000062
440100     END-EXEC                                                     44010062
440200                                                                  44020062
440300     EVALUATE TRUE                                                44030062
440400         WHEN SQLCODE = +0                                        44040062
440500              CONTINUE                                            44050062
440600                                                                  44060062
440700         WHEN SQLCODE = +100                                      44070062
440800              SET PS-DONE TO TRUE                                 44080062
440900                                                                  44090062
441000         WHEN SQLWARN0 NOT = SPACE                                44100062
441100         WHEN SQLCODE < +0                                        44110062
441200         WHEN SQLCODE > +0                                        44120062
441300              MOVE '4320-FETCH-PO-CSR'                            44130062
441400                                   TO DP013-PARAGRAPH             44140062
441500              MOVE 'FETCH PO CURSOR'                              44150062
441600                                   TO DP013-MESSAGE-TEXT (1)      44160062
441700              MOVE PURITM-PO-LNE-NBR                              44170062
441800                                   TO DP013-MESSAGE-TEXT (2)      44180062
441900              MOVE SQLCA           TO DP013-SQLCA                 44190062
442000              MOVE 'TPURCHS'       TO DP013-DB2-TABLE-NAME (1)    44200062
442100              SET DP013-DB2-ABEND  TO TRUE                        44210062
442200              PERFORM DP013-0000-PROCESS-ABEND                    44220062
442300     END-EVALUATE.                                                44230062
442400                                                                  44240062
442500 4330-PROCESS-PO-CSR.                                             44250062
442600******************************************************************44260062
442700*    THIS PARAGRAPH DETERMINES IF THERE ARE TALLPLAN AND TMESTDS  44270062
442800*    ROWS FOUND FOR A PO. FOR EACH LINE ITEM, OF A PO, A SELECT   44280062
442900*    IS DONE ON TALLPLN. IF 'FOUND' 2 SWITCHES ARE SET, ONE IS    44290062
443000*    THAT A TALLPLN ROW EXISTS (PS-TALLPLN-EXIST-SW) AND THE      44300062
443100*    OTHER IS USED TO SELECT TMESTDS ROWS (PS-TALLPLN-SW). FOR    44310062
443200*    EACH TALLPLN THERE MUST BE A TMESTDS, IF NOT A 'NO DISTRO'   44320062
443300*    MSG DISPLAYS. FOR 'A' LINE ITEM, OF A PO, THERE MUST BE A    44330062
443400*    TALLPLN, IF 'NON EXISTS' A 'MISDIRECT' MSG DISPLAYS.         44340062
443500******************************************************************44350062
443600                                                                  44360062
443700                                                                  44370062
443800     PERFORM                                                      44380062
443900         WITH TEST AFTER                                          44390062
444000         VARYING PV-RETRY-COUNTER                                 44400062
444100         FROM 1 BY 1                                              44410062
444200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               44420062
444300            OR  (SQLCODE = +100)                                  44430062
444400            OR  (SQLCODE = +0))                                   44440062
444500                                                                  44450062
444600         EXEC SQL                                                 44460062
444700            SELECT  PLAN_NBR                                      44470062
444800            INTO   :ALLPLN-PLAN-NBR                               44480062
444900            FROM    TALLPLN                                       44490062
445000            WHERE   PO_NBR     = :DK-PO-NBR                       44500062
445100            AND     PO_LNE_NBR = :PURITM-PO-LNE-NBR               44510062
445200            AND     DEST_NBR   = :PV-OPER-UNT-ID                  44520062
445300            AND     STATUS_CDE = :PC-PO-ACTIVE                    44530062
445400         END-EXEC                                                 44540062
445500                                                                  44550062
445600         EVALUATE TRUE                                            44560062
445700             WHEN SQLCODE = +100                                  44570062
445800             WHEN SQLCODE = -904                                  44580062
445900             WHEN SQLCODE = -913                                  44590062
446000                  CONTINUE                                        44600062
446100                                                                  44610062
446200             WHEN SQLCODE = +0                                    44620062
446300                  SET PS-TALLPLN-FOUND  TO TRUE                   44630062
446400                  SET PS-TALLPLN-EXIST  TO TRUE                   44640062
446500                                                                  44650062
446600             WHEN SQLWARN0 NOT = SPACE                            44660062
446700             WHEN SQLCODE < +0                                    44670062
446800             WHEN SQLCODE > +0                                    44680062
446900                  MOVE SPACES TO PV-MESSAGE                       44690062
447000                  MOVE DK-PO-NBR TO PV-MESSAGE1                   44700062
447100                  MOVE PURITM-PO-LNE-NBR TO PV-MESSAGE2           44710062
447200                  MOVE PV-OPER-UNT-ID TO PV-MESSAGE3              44720062
447300                  MOVE '4330-PROCESS-PO-CSR '                     44730062
447400                                   TO DP013-PARAGRAPH             44740062
447500                  MOVE 'SELECT ON TALLPLN'                        44750062
447600                                   TO DP013-MESSAGE-TEXT (1)      44760062
447700                  MOVE PV-MESSAGE  TO DP013-MESSAGE-TEXT (2)      44770062
447800                  MOVE SQLCA       TO DP013-SQLCA                 44780062
447900                  MOVE 'TALLPLN'   TO DP013-DB2-TABLE-NAME (1)    44790062
448000                  SET DP013-DB2-ABEND                             44800062
448100                      DP013-XCTL-DISPLAY-RESTART                  44810062
448200                                   TO TRUE                        44820062
448300                  PERFORM DP013-0000-PROCESS-ABEND                44830062
448400         END-EVALUATE                                             44840062
448500     END-PERFORM.                                                 44850062
448600                                                                  44860062
448700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    44870062
448800         SQLCODE NOT = +0                                         44880062
448900         MOVE '4330-PROCESS-PO-CSR '                              44890062
449000                                   TO DP013-PARAGRAPH             44900062
449100         MOVE 'MAX RETRIES EXCEEDED FOR SELECT'                   44910062
449200                                   TO DP013-MESSAGE-TEXT (1)      44920062
449300         MOVE 'ON TABLE TALLPLN '  TO DP013-MESSAGE-TEXT (2)      44930062
449400         MOVE SQLCA                TO DP013-SQLCA                 44940062
449500         SET DP013-DB2-ABEND                                      44950062
449600             DP013-XCTL-DISPLAY-RESTART                           44960062
449700                                   TO TRUE                        44970062
449800         PERFORM DP013-0000-PROCESS-ABEND                         44980062
449900     END-IF.                                                      44990062
450000                                                                  45000062
450100                                                                  45010062
450200     IF PS-TALLPLN-FOUND                                          45020062
450300        SET PS-TALLPLN-NOT-FOUND TO TRUE                          45030062
450400        PERFORM                                                   45040062
450500            WITH TEST AFTER                                       45050062
450600            VARYING PV-RETRY-COUNTER                              45060062
450700            FROM 1 BY 1                                           45070062
450800            UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)            45080062
450900               OR  (SQLCODE = +100)                               45090062
451000               OR  (SQLCODE = -811)                               45100062
451100               OR  (SQLCODE = +0))                                45110062
451200                                                                  45120062
451300            EXEC SQL                                              45130062
451400               SELECT  PO_NBR                                     45140062
451500               INTO   :MESTDS-PO-NBR                              45150062
451600               FROM    TMESTDS                                    45160062
451700               WHERE   PO_NBR     = :DK-PO-NBR                    45170062
451800               AND     PO_LNE_NBR = :PURITM-PO-LNE-NBR            45180062
451900               AND     PLAN_NBR   = :ALLPLN-PLAN-NBR              45190062
452000            END-EXEC                                              45200062
452100                                                                  45210062
452200            EVALUATE TRUE                                         45220062
452300                WHEN SQLCODE = -904                               45230062
452400                WHEN SQLCODE = -913                               45240062
452500                     CONTINUE                                     45250062
452600                                                                  45260062
452700                WHEN SQLCODE = +0                                 45270062
452800                WHEN SQLCODE = -811                               45280062
452900                     SET PS-DISTRO         TO TRUE                45290062
453000                                                                  45300062
453100                WHEN SQLCODE = +100                               45310062
453200                     SET PS-NO-DISTRO      TO TRUE                45320062
453300                                                                  45330062
453400                WHEN SQLWARN0 NOT = SPACE                         45340062
453500                WHEN SQLCODE < +0                                 45350062
453600                WHEN SQLCODE > +0                                 45360062
453700                     MOVE SPACES TO PV-MESSAGE                    45370062
453800                     MOVE DK-PO-NBR TO PV-MESSAGE1                45380062
453900                     MOVE PURITM-PO-LNE-NBR TO PV-MESSAGE2        45390062
454000                     MOVE ALLPLN-PLAN-NBR TO PV-MESSAGE3          45400062
454100                     MOVE '4330-PROCESS-PO-CSR '                  45410062
454200                                      TO DP013-PARAGRAPH          45420062
454300                     MOVE 'SELECT ON TMESTDS'                     45430062
454400                                      TO DP013-MESSAGE-TEXT (1)   45440062
454500                     MOVE PV-MESSAGE  TO DP013-MESSAGE-TEXT (2)   45450062
454600                     MOVE SQLCA       TO DP013-SQLCA              45460062
454700                     MOVE 'TMESTDS'   TO DP013-DB2-TABLE-NAME (1) 45470062
454800                     SET DP013-DB2-ABEND                          45480062
454900                         DP013-XCTL-DISPLAY-RESTART               45490062
455000                                      TO TRUE                     45500062
455100                     PERFORM DP013-0000-PROCESS-ABEND             45510062
455200            END-EVALUATE                                          45520062
455300        END-PERFORM                                               45530062
455400                                                                  45540062
455500        IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                 45550062
455600            SQLCODE NOT = +0                                      45560062
455700            MOVE '4330-PROCESS-PO-CSR '                           45570062
455800                                      TO DP013-PARAGRAPH          45580062
455900            MOVE 'MAX RETRIES EXCEEDED FOR SELECT'                45590062
456000                                      TO DP013-MESSAGE-TEXT (1)   45600062
456100            MOVE 'ON TABLE TMESTDS '  TO DP013-MESSAGE-TEXT (2)   45610062
456200            MOVE SQLCA                TO DP013-SQLCA              45620062
456300            SET DP013-DB2-ABEND                                   45630062
456400                DP013-XCTL-DISPLAY-RESTART                        45640062
456500                                      TO TRUE                     45650062
456600            PERFORM DP013-0000-PROCESS-ABEND                      45660062
456700        END-IF                                                    45670062
456800     END-IF.                                                      45680062
456900                                                                  45690062
457000     IF PS-NO-DISTRO                                              45700062
457100        SET PS-DISPLAY-DISTRO-MSG TO TRUE                         45710062
457200        SET PS-DONE TO TRUE                                       45720062
457300     ELSE                                                         45730062
457400        PERFORM 4320-FETCH-PO-CSR                                 45740062
457500     END-IF.                                                      45750062
457600                                                                  45760062
457700                                                                  45770062
457800 4340-CONV-DATES-TO-CCYYMMDD.                                     45780062
457900******************************************************************45790062
458000*    THIS PARAGRAPH CONVERTS ALL DATES PERTINENT TO THE EARLY/LATE45800062
458100*    TROUBLE CHECK TO THE SAME DATE FORMAT.                       45810062
458200******************************************************************45820062
458300                                                                  45830062
458400     MOVE ASC-VEND-SHIP-DTE         TO PV-WORK-DATE2.             45840062
458500     MOVE PV-WK2-DTE-YY             TO PV-VEND-SHIP-CCYY.         45850062
458600     MOVE PV-WK2-DTE-MM             TO PV-VEND-SHIP-MM.           45860062
458700     MOVE PV-WK2-DTE-DD             TO PV-VEND-SHIP-DD.           45870062
458800                                                                  45880062
458900     MOVE ASC-DONT-SHIP-BEF-DTE     TO PV-WORK-DATE.              45890062
459000     MOVE PV-WK-DTE-YY              TO PV-DONT-SHIP-CCYY.         45900062
459100     MOVE PV-WK-DTE-MM              TO PV-DONT-SHIP-MM.           45910062
459200     MOVE PV-WK-DTE-DD              TO PV-DONT-SHIP-DD.           45920062
459300                                                                  45930062
459400     MOVE ASC-CANCEL-DTE TO PV-WORK-DATE.                         45940062
459500     MOVE PV-WK-DTE-YY              TO PV-CAN-IFNOT-CCYY.         45950062
459600     MOVE PV-WK-DTE-MM              TO PV-CAN-IFNOT-MM.           45960062
459700     MOVE PV-WK-DTE-DD              TO PV-CAN-IFNOT-DD.           45970062
459800                                                                  45980062
459900     MOVE ASC-EXT-CAN-DTE           TO PV-WORK-DATE.              45990062
460000     MOVE PV-WK-DTE-YY              TO PV-EXT-CAN-CCYY.           46000062
460100     MOVE PV-WK-DTE-MM              TO PV-EXT-CAN-MM.             46010062
460200     MOVE PV-WK-DTE-DD              TO PV-EXT-CAN-DD.             46020062
460300                                                                  46030062
460400 4350-INITIALIZE-PO-FIELDS.                                       46040062
460500******************************************************************46050062
460600*    THIS PARAGRAPH WILL MOVE SPACES TO ALL THE PO FIELDS         46060062
460700******************************************************************46070062
460800                                                                  46080062
460900                                                                  46090062
461000        MOVE SPACES                     TO ASC-PO-NBR.            46100062
461100        MOVE ZEROS                      TO APONBRO                46110062
461200                                           ASC-PO-CARTON-CNT      46120062
461300                                           ADPTNBRO               46130062
461400                                           APOCNTO.               46140062
461500        MOVE SPACES                     TO ASC-NO-DISTRO-MSG      46150062
461600                                           ADISTOO                46160062
461700                                           ASC-PO-STATUS-DESC     46170062
461800                                           APOSTATO               46180062
461900                                           ASC-DONT-SHIP-BEF-DTE  46190062
462000                                           ABEFDTEO               46200062
462100                                           ASC-CANCEL-DTE         46210062
462200                                           ACANDTEO               46220062
462300                                           ASC-EXT-CAN-DTE        46230062
462400                                           AEXCDTEO               46240062
462500                                           ASC-DEPT-NBR           46250062
462600                                           ASC-DEPT-DESC          46260062
462700                                           ADPTDSCO               46270062
462800                                           ASC-BUYER-NME          46280062
462900                                           ABUYNMEO.              46290062
463000 EJECT                                                            46300062
463100*----------------------------------------------------------------*46310062
463200*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *46320062
463300*----------------------------------------------------------------*46330062
463400                                                                  46340062
463500 4400-MOVE-COMMAREA-TO-SCREEN.                                    46350062
463600     MOVE ASC-OPER-UNT-ID          TO AOPERO.                     46360062
463700     MOVE ASC-FCLTY-ID             TO AFCLTYO.                    46370062
463800     MOVE ASC-FCLTY-NME            TO AFDESCO.                    46380062
463900     MOVE ASC-PO-NBR               TO APONBRO.                    46390062
464000     MOVE ASC-PO-CARTON-CNT        TO APOCNTO.                    46400062
464100     MOVE ASC-NO-DISTRO-MSG        TO ADISTOO.                    46410062
464200     MOVE ASC-PO-STATUS-DESC       TO APOSTATO.                   46420062
464300                                                                  46430062
464400     IF  ASC-DONT-SHIP-BEF-DTE = '01/01/0001'                     46440062
464500         MOVE SPACES               TO ABEFDTEO                    46450062
464600     ELSE                                                         46460062
464700         MOVE ASC-DONT-SHIP-BEF-DTE                               46470062
464800                                   TO ABEFDTEO                    46480062
464900     END-IF                                                       46490062
465000                                                                  46500062
465100     MOVE ASC-COMPLETE-PRO-NBR     TO AFBNBRO.                    46510062
465200                                                                  46520062
465300     IF  ASC-CANCEL-DTE = '01/01/0001'                            46530062
465400         MOVE SPACES               TO ACANDTEO                    46540062
465500     ELSE                                                         46550062
465600         MOVE ASC-CANCEL-DTE       TO ACANDTEO                    46560062
465700     END-IF                                                       46570062
465800                                                                  46580062
465900     MOVE ASC-COMPLETE-BOL-NBR     TO ABOLNBRO.                   46590062
466000                                                                  46600062
466100     IF  ASC-EXT-CAN-DTE = '01/01/0001'                           46610062
466200         MOVE SPACES               TO AEXCDTEO                    46620062
466300     ELSE                                                         46630062
466400         MOVE ASC-EXT-CAN-DTE      TO AEXCDTEO                    46640062
466500     END-IF.                                                      46650062
466600     MOVE ASC-FB-CARTON-CNT        TO AFBCNTO.                    46660062
466700     MOVE ASC-DEPT-NBR-N           TO ADPTNBRO.                   46670062
466800     MOVE ASC-DEPT-DESC            TO ADPTDSCO.                   46680062
466900                                                                  46690062
467000     IF  ASC-VEND-SHIP-DTE = '01010001'                           46700062
467100         MOVE SPACES               TO AVNDMMO                     46710062
467200                                      AVNDDDO                     46720062
467300                                      AVNDYYO                     46730062
467400     ELSE                                                         46740062
467500         MOVE ASC-VEND-SHIP-MM     TO AVNDMMO                     46750062
467600         MOVE ASC-VEND-SHIP-DD     TO AVNDDDO                     46760062
467700         MOVE ASC-VEND-SHIP-YY     TO AVNDYYO                     46770062
467800     END-IF.                                                      46780062
467900                                                                  46790062
468000     MOVE ASC-BUYER-NME            TO ABUYNMEO.                   46800062
468100     MOVE ASC-AUTH-NBR             TO AATHNBRO.                   46810062
468200                                                                  46820062
468300     IF  ASC-AUTH-DTE  = '01010001'                               46830062
468400         MOVE SPACES               TO AATHMMO                     46840062
468500                                      AATHDDO                     46850062
468600                                      AATHYYO                     46860062
468700     ELSE                                                         46870062
468800         MOVE ASC-AUTH-MM          TO AATHMMO                     46880062
468900         MOVE ASC-AUTH-DD          TO AATHDDO                     46890062
469000         MOVE ASC-AUTH-YY          TO AATHYYO                     46900062
469100     END-IF.                                                      46910062
469200                                                                  46920062
469300     MOVE ASC-PRO-SCAC-ID          TO ADSCACO.                    46930062
469400     MOVE ASC-PRO-SCAC-DESC        TO ADSCDSCO.                   46940062
469500     MOVE ASC-ORIG-SCAC-ID         TO AOSCACO.                    46950062
469600     MOVE ASC-ORIG-SCAC-DESC       TO AOSCDSCO.                   46960062
469700     MOVE ASC-VEH-NBR              TO ATRLRNOO.                   46970062
469710* 2011-12-14 CHRISTINE TWIEHAUS WR40574 START                    *46971062
469711     MOVE ASC-CAN                  TO ACANO.                      46971162
469730* 2011-12-14 CHRISTINE TWIEHAUS WR40574 END                      *46973062
469800                                                                  46980062
469900     IF  ASC-ETA-DTE  = '01010001'                                46990062
470000         MOVE SPACES               TO AETAMMO                     47000062
470100                                      AETADDO                     47010062
470200                                      AETAYYO                     47020062
470300     ELSE                                                         47030062
470400         MOVE ASC-ETA-MM           TO AETAMMO                     47040062
470500         MOVE ASC-ETA-DD           TO AETADDO                     47050062
470600         MOVE ASC-ETA-YY           TO AETAYYO                     47060062
470700     END-IF.                                                      47070062
470800                                                                  47080062
470900     IF ASC-ETA-TIME-HH = '00' AND ASC-ETA-TIME-MN = '00'         47090062
471000        MOVE SPACES TO ASC-ETA-TIME-HH ASC-ETA-TIME-MN            47100062
471100     END-IF.                                                      47110062
471200     MOVE ASC-ETA-TIME-HH          TO AETAHHO.                    47120062
471300     MOVE ASC-ETA-TIME-MN          TO AETAMNO.                    47130062
471400                                                                  47140062
471500 EJECT                                                            47150062
471600*----------------------------------------------------------------*47160062
471700*  RETREIVE A RANDMON NUMBER                                     *47170062
471800*----------------------------------------------------------------*47180062
471900 4500-GET-RANDOM-NUMBER.                                          47190062
472000     INITIALIZE DP902-RANDNBR-ROUTINE-FIELDS.                     47200079
473300                                                                  47330062
473400     CALL PC-RANDNBR-PGM USING DFHEIBLK                           47340080
473410                               DFHCOMMAREA                        47341080
473420                               DP902-RANDNBR-ROUTINE-FIELDS.      47342080
473500                                                                  47350062
473600     IF  DP902-SUCCESSFUL                                         47360079
473700         NEXT SENTENCE                                            47370062
473800     ELSE                                                         47380062
473900         MOVE '4500-GET-RANDOM-NUMBER'  TO DP013-PARAGRAPH        47390062
474000         MOVE 'CALL TO DPKUT902 FAILED'                           47400079
474100                                   TO DP013-MESSAGE-TEXT(1)       47410062
474200         SET DP013-XCTL-DISPLAY-RESTART                           47420062
474300                                   TO TRUE                        47430062
474400         PERFORM DP013-0000-PROCESS-ABEND                         47440062
474500     END-IF.                                                      47450062
474600  EJECT                                                           47460062
474700                                                                  47470062
474800 4550-READ-DUPL-TVHTRIP.                                          47480062
474900                                                                  47490062
475000     MOVE DP902-RANDOM-NUMBER   TO PV-CURR-TRIP-ID.               47500079
475100                                                                  47510062
475200     PERFORM                                                      47520062
475300         WITH TEST AFTER                                          47530062
475400         VARYING PV-RETRY-COUNTER                                 47540062
475500         FROM 1 BY 1                                              47550062
475600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               47560062
475700             OR (SQLCODE = +0))                                   47570062
475800                                                                  47580062
475900         EXEC SQL                                                 47590062
476000              SELECT COUNT(*)                                     47600062
476100               INTO :PV-VHTRIP-COUNT                              47610062
476200                FROM  TVHTRIP                                     47620062
476300               WHERE (TRIP_ID         = :PV-CURR-TRIP-ID)         47630062
476400         END-EXEC                                                 47640062
476500                                                                  47650062
476600         EVALUATE TRUE                                            47660062
476700             WHEN SQLCODE = +0                                    47670062
476800             WHEN SQLCODE = -904                                  47680062
476900             WHEN SQLCODE = -913                                  47690062
477000                 CONTINUE                                         47700062
477100                                                                  47710062
477200             WHEN SQLWARN0 NOT = SPACES                           47720062
477300             WHEN SQLCODE < +0                                    47730062
477400             WHEN SQLCODE > +0                                    47740062
477500                 MOVE '4550-READ-DUPL-TVHTRIP'                    47750062
477600                                   TO DP013-PARAGRAPH             47760062
477700                 MOVE 'GET COUNT OF TRIPS'                        47770062
477800                                   TO DP013-MESSAGE-TEXT(1)       47780062
477900                 MOVE PV-CURR-TRIP-ID                             47790062
478000                                   TO DP013-MESSAGE-TEXT(2)       47800062
478100                 MOVE SQLCA        TO DP013-SQLCA                 47810062
478200                 MOVE 'TVHTRIP'    TO DP013-DB2-TABLE-NAME (1)    47820062
478300                 SET DP013-DB2-ABEND                              47830062
478400                     DP013-XCTL-DISPLAY-RESTART TO TRUE           47840062
478500                 PERFORM DP013-0000-PROCESS-ABEND                 47850062
478600         END-EVALUATE                                             47860062
478700     END-PERFORM.                                                 47870062
478800                                                                  47880062
478900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    47890062
479000         SQLCODE NOT = +0                                         47900062
479100         MOVE '4550-READ-DUPL-TVHTRIP'                            47910062
479200                                   TO DP013-PARAGRAPH             47920062
479300         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              47930062
479400                                   TO DP013-MESSAGE-TEXT (1)      47940062
479500         MOVE 'TO COUNT TVHTRIP ROWS'                             47950062
479600                                   TO DP013-MESSAGE-TEXT (2)      47960062
479700         MOVE SQLCA                TO DP013-SQLCA                 47970062
479800         MOVE 'TVHTRIP'            TO DP013-DB2-TABLE-NAME (1)    47980062
479900         SET DP013-DB2-ABEND                                      47990062
480000             DP013-XCTL-DISPLAY-RESTART                           48000062
480100                                   TO TRUE                        48010062
480200         PERFORM DP013-0000-PROCESS-ABEND                         48020062
480300     END-IF.                                                      48030062
480400                                                                  48040062
480500     IF PV-VHTRIP-COUNT > 0                                       48050062
480600         PERFORM 4500-GET-RANDOM-NUMBER                           48060062
480700     END-IF.                                                      48070062
480800                                                                  48080062
480900 4560-READ-DUPL-TSHIPMT.                                          48090062
481000                                                                  48100062
481100     MOVE DP902-RANDOM-NUMBER   TO PV-CURR-SHIPT-ID.              48110079
481200                                                                  48120062
481300     PERFORM                                                      48130062
481400         WITH TEST AFTER                                          48140062
481500         VARYING PV-RETRY-COUNTER                                 48150062
481600         FROM 1 BY 1                                              48160062
481700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               48170062
481800             OR (SQLCODE = +0))                                   48180062
481900                                                                  48190062
482000         EXEC SQL                                                 48200062
482100              SELECT COUNT(*)                                     48210062
482200               INTO :PV-SHIPMT-COUNT                              48220062
482300                FROM  TSHIPMT                                     48230062
482400               WHERE (SHIPT_ID        = :PV-CURR-SHIPT-ID)        48240062
482500         END-EXEC                                                 48250062
482600                                                                  48260062
482700         EVALUATE TRUE                                            48270062
482800             WHEN SQLCODE = +0                                    48280062
482900             WHEN SQLCODE = -904                                  48290062
483000             WHEN SQLCODE = -913                                  48300062
483100                 CONTINUE                                         48310062
483200                                                                  48320062
483300             WHEN SQLWARN0 NOT = SPACES                           48330062
483400             WHEN SQLCODE < +0                                    48340062
483500             WHEN SQLCODE > +0                                    48350062
483600                 MOVE '4550-READ-DUPL-TVHTRIP'                    48360062
483700                                   TO DP013-PARAGRAPH             48370062
483800                 MOVE 'GET COUNT OF TRIPS'                        48380062
483900                                   TO DP013-MESSAGE-TEXT(1)       48390062
484000                 MOVE PV-CURR-SHIPT-ID                            48400062
484100                                   TO DP013-MESSAGE-TEXT(2)       48410062
484200                 MOVE SQLCA        TO DP013-SQLCA                 48420062
484300                 MOVE 'TVHTRIP'    TO DP013-DB2-TABLE-NAME (1)    48430062
484400                 SET DP013-DB2-ABEND                              48440062
484500                     DP013-XCTL-DISPLAY-RESTART TO TRUE           48450062
484600                 PERFORM DP013-0000-PROCESS-ABEND                 48460062
484700         END-EVALUATE                                             48470062
484800     END-PERFORM.                                                 48480062
484900                                                                  48490062
485000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    48500062
485100         SQLCODE NOT = +0                                         48510062
485200         MOVE '4550-READ-DUPL-TVHTRIP'                            48520062
485300                                   TO DP013-PARAGRAPH             48530062
485400         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              48540062
485500                                   TO DP013-MESSAGE-TEXT (1)      48550062
485600         MOVE 'TO COUNT TVHTRIP ROWS'                             48560062
485700                                   TO DP013-MESSAGE-TEXT (2)      48570062
485800         MOVE SQLCA                TO DP013-SQLCA                 48580062
485900         MOVE 'TVHTRIP'            TO DP013-DB2-TABLE-NAME (1)    48590062
486000         SET DP013-DB2-ABEND                                      48600062
486100             DP013-XCTL-DISPLAY-RESTART                           48610062
486200                                   TO TRUE                        48620062
486300         PERFORM DP013-0000-PROCESS-ABEND                         48630062
486400     END-IF.                                                      48640062
486500                                                                  48650062
486600     IF PV-SHIPMT-COUNT > 0                                       48660062
486700         PERFORM 4500-GET-RANDOM-NUMBER                           48670062
486800     END-IF.                                                      48680062
486900                                                                  48690062
487000*----------------------------------------------------------------*48700062
487100*  INSERT THE PO TO THE SHIPEMENT PO ASSOCIATION TABLE            48710062
487200*----------------------------------------------------------------*48720062
487300 5000-INSERT-TSHPTPO.                                             48730062
487400                                                                  48740062
487500     INITIALIZE DCLTSHPTPO.                                       48750062
487600                                                                  48760062
487700     PERFORM 5070-GET-VEND-NAME.                                  48770062
487800                                                                  48780062
487900     MOVE ASC-SHIPT-ID          TO SHPTPO-SHIPT-ID.               48790062
488000     MOVE ASC-PO-NBR               TO SHPTPO-PO-NBR.              48800062
488100     MOVE '0'                      TO SHPTPO-REC-SEQ-NBR.         48810062
488200     MOVE ASC-PO-CARTON-CNT        TO SHPTPO-EXPTED-CART-CNT.     48820062
488300     MOVE ZEROES                   TO SHPTPO-ACTL-CART-CNT        48830062
488400                                      SHPTPO-DMG-CART-CNT.        48840062
488500     MOVE 'N'                      TO SHPTPO-PKSL-IND.            48850062
488600     MOVE ENTNME-ENT-NAME-DESC     TO SHPTPO-VEND-NAME.           48860062
488700     MOVE ZEROES                   TO SHPTPO-FRGT-CHG-AMT.        48870062
488800                                                                  48880062
488900     PERFORM                                                      48890062
489000         WITH TEST AFTER                                          48900062
489100         VARYING PV-RETRY-COUNTER                                 48910062
489200         FROM 1 BY 1                                              48920062
489300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               48930062
489400             OR (SQLCODE = -803) OR (SQLCODE = +0))               48940062
489500                                                                  48950062
489600         EXEC SQL                                                 48960062
489700             INSERT  INTO TSHPTPO                                 48970062
489800                    (SHIPT_ID                                     48980062
489900                    ,PO_NBR                                       48990062
490000                    ,REC_SEQ_NBR                                  49000062
490100                    ,EXPTED_CART_CNT                              49010062
490200                    ,ACTL_CART_CNT                                49020062
490300                    ,DMG_CART_CNT                                 49030062
490400                    ,PKSL_IND                                     49040062
490500                    ,VEND_NAME                                    49050062
490600                    ,FRGT_CHG_AMT                                 49060062
490700                    ,LAST_UPD_PGM_ID                              49070062
490800                    ,CRE_USER_ID                                  49080062
490900                    ,CARR_LAST_UPD_DTE                            49090062
491000                    ,CARR_LAST_UPD_TIME                           49100062
491100                    ,VEND_LAST_UPD_DTE                            49110062
491200                    ,VEND_LAST_UPD_TIME                           49120062
491300                    ,LAST_UPD_USER_ID                             49130062
491400                    ,PRIM_SHIPT_IND                               49140062
491500                    ,SPLT_XMIT_IND                                49150062
491600                    ,SPLT_XMIT_DTE                                49160062
491700                    ,SPLT_XMIT_TM )                               49170062
491800             VALUES                                               49180062
491900                    (:SHPTPO-SHIPT-ID                             49190062
492000                    ,:SHPTPO-PO-NBR                               49200062
492100                    ,:SHPTPO-REC-SEQ-NBR                          49210062
492200                    ,:SHPTPO-EXPTED-CART-CNT                      49220062
492300                    ,:SHPTPO-ACTL-CART-CNT                        49230062
492400                    ,:SHPTPO-DMG-CART-CNT                         49240062
492500                    ,:SHPTPO-PKSL-IND                             49250062
492600                    ,:SHPTPO-VEND-NAME                            49260062
492700                    ,:SHPTPO-FRGT-CHG-AMT                         49270062
492800                    ,:PC-CURRENT-PROGRAM-NAME                     49280062
492900                    ,:DP020-USERID                                49290062
493000                    ,:PC-DEFAULT-DATE                             49300062
493100                    ,:PC-DEFAULT-TIME                             49310062
493200                    ,:PC-DEFAULT-DATE                             49320062
493300                    ,:PC-DEFAULT-TIME                             49330062
493400                    ,:DP020-USERID                                49340062
493500                    ,:PC-Y                                        49350062
493600                    ,:SHPTPO-SPLT-XMIT-IND                        49360062
493700                    ,:PC-DEFAULT-DATE                             49370062
493800                    ,:PC-DEFAULT-TIME )                           49380062
493900         END-EXEC                                                 49390062
494000                                                                  49400062
494100         EVALUATE TRUE                                            49410062
494200             WHEN SQLCODE = +0                                    49420062
494300             WHEN SQLCODE = -803                                  49430062
494400             WHEN SQLCODE = -904                                  49440062
494500             WHEN SQLCODE = -913                                  49450062
494600                 CONTINUE                                         49460062
494700                                                                  49470062
494800             WHEN SQLWARN0 NOT = SPACES                           49480062
494900             WHEN SQLCODE < +0                                    49490062
495000             WHEN SQLCODE > +0                                    49500062
495100                 MOVE SPACES TO PV-MESSAGE                        49510062
495200                 MOVE SHPTPO-SHIPT-ID TO PV-MESSAGE1              49520062
495300                 MOVE SHPTPO-PO-NBR   TO PV-MESSAGE2              49530062
495400                 MOVE '5000-INSERT-TSHPTPO'                       49540062
495500                                   TO DP013-PARAGRAPH             49550062
495600                 MOVE 'INSERT A ROW ON TSHPTPO'                   49560062
495700                                   TO DP013-MESSAGE-TEXT(1)       49570062
495800                 MOVE PV-MESSAGE   TO DP013-MESSAGE-TEXT(2)       49580062
495900                 MOVE SQLCA        TO DP013-SQLCA                 49590062
496000                 MOVE 'TSHPTPO'    TO DP013-DB2-TABLE-NAME (1)    49600062
496100                 SET DP013-DB2-ABEND                              49610062
496200                     DP013-XCTL-DISPLAY-RESTART TO TRUE           49620062
496300                 PERFORM DP013-0000-PROCESS-ABEND                 49630062
496400         END-EVALUATE                                             49640062
496500     END-PERFORM.                                                 49650062
496600                                                                  49660062
496700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    49670062
496800         SQLCODE NOT = +0                                         49680062
496900         MOVE '5000-INSERT-TSHPTPO'                               49690062
497000                                   TO DP013-PARAGRAPH             49700062
497100         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              49710062
497200                                   TO DP013-MESSAGE-TEXT (1)      49720062
497300         MOVE 'TO INSERT A TSHPTPO ROW'                           49730062
497400                                   TO DP013-MESSAGE-TEXT (2)      49740062
497500         MOVE SQLCA                TO DP013-SQLCA                 49750062
497600         MOVE 'TSHPTPO'            TO DP013-DB2-TABLE-NAME (1)    49760062
497700         SET DP013-DB2-ABEND                                      49770062
497800             DP013-XCTL-DISPLAY-RESTART                           49780062
497900                                   TO TRUE                        49790062
498000         PERFORM DP013-0000-PROCESS-ABEND                         49800062
498100     END-IF.                                                      49810062
498200                                                                  49820062
498300     EVALUATE TRUE                                                49830062
498400         WHEN SQLCODE = ZERO                                      49840062
498500              SET PS-NOT-FOUND TO TRUE                            49850062
498600              PERFORM 5005-INSERT-TAUSHPO                         49860062
498700         WHEN SQLCODE = -803                                      49870062
498800              SET PS-FOUND                                        49880062
498900                  PS-ERROR          TO TRUE                       49890062
499000     END-EVALUATE.                                                49900062
499100                                                                  49910062
499200 EJECT                                                            49920062
499300*----------------------------------------------------------------*49930062
499400*  INSERT THE PO TO THE SHIPEMENT PO ASSOCIATION AUDIT TABLE      49940062
499500*                                                                 49950062
499600*  PERFORMED FROM 5000-INSERT-TAUSHPO                             49960062
499700*----------------------------------------------------------------*49970062
499800                                                                  49980062
499900 5005-INSERT-TAUSHPO.                                             49990062
500000                                                                  50000062
500100     PERFORM                                                      50010062
500200         WITH TEST AFTER                                          50020062
500300         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     50030062
500400         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            50040062
500500                (SQLCODE = ZERO)   OR                             50050062
500600                (SQLCODE = +100)                                  50060062
500700                                                                  50070062
500800         EXEC SQL                                                 50080062
500900             SELECT SHIPT_ID,                                     50090062
501000                    PO_NBR,                                       50100062
501100                    REC_SEQ_NBR,                                  50110062
501200                    EXPTED_CART_CNT,                              50120062
501300                    ACTL_CART_CNT,                                50130062
501400                    DMG_CART_CNT,                                 50140062
501500                    PKSL_IND,                                     50150062
501600                    VEND_NAME,                                    50160062
501700                    FRGT_CHG_AMT,                                 50170062
501800                    LAST_UPD_PGM_ID,                              50180062
501900                    CRE_USER_ID,                                  50190062
502000                    CARR_CART_CT,                                 50200062
502100                    CARR_LAST_UPD_DTE,                            50210062
502200                    CARR_LAST_UPD_TIME,                           50220062
502300                    VEND_CART_CT,                                 50230062
502400                    VEND_LAST_UPD_DTE,                            50240062
502500                    VEND_LAST_UPD_TIME,                           50250062
502600                    CRE_TMST,                                     50260062
502700                    LAST_UPD_DTE,                                 50270062
502800                    LAST_UPD_TIME,                                50280062
502900                    LAST_UPD_USER_ID,                             50290062
503000                    PRIM_SHIPT_IND                                50300062
503100                   ,SPLT_XMIT_IND                                 50310062
503200                   ,SPLT_XMIT_DTE                                 50320062
503300                   ,SPLT_XMIT_TM                                  50330062
503400               INTO :SHPTPO-SHIPT-ID,                             50340062
503500                    :SHPTPO-PO-NBR,                               50350062
503600                    :SHPTPO-REC-SEQ-NBR,                          50360062
503700                    :SHPTPO-EXPTED-CART-CNT,                      50370062
503800                    :SHPTPO-ACTL-CART-CNT,                        50380062
503900                    :SHPTPO-DMG-CART-CNT,                         50390062
504000                    :SHPTPO-PKSL-IND,                             50400062
504100                    :SHPTPO-VEND-NAME,                            50410062
504200                    :SHPTPO-FRGT-CHG-AMT,                         50420062
504300                    :SHPTPO-LAST-UPD-PGM-ID,                      50430062
504400                    :SHPTPO-CRE-USER-ID,                          50440062
504500                    :SHPTPO-CARR-CART-CT,                         50450062
504600                    :SHPTPO-CARR-LAST-UPD-DTE,                    50460062
504700                    :SHPTPO-CARR-LAST-UPD-TIME,                   50470062
504800                    :SHPTPO-VEND-CART-CT,                         50480062
504900                    :SHPTPO-VEND-LAST-UPD-DTE,                    50490062
505000                    :SHPTPO-VEND-LAST-UPD-TIME,                   50500062
505100                    :SHPTPO-CRE-TMST,                             50510062
505200                    :SHPTPO-LAST-UPD-DTE,                         50520062
505300                    :SHPTPO-LAST-UPD-TIME,                        50530062
505400                    :SHPTPO-LAST-UPD-USER-ID,                     50540062
505500                    :SHPTPO-PRIM-SHIPT-IND                        50550062
505600                   ,:SHPTPO-SPLT-XMIT-IND                         50560062
505700                   ,:SHPTPO-SPLT-XMIT-DTE                         50570062
505800                   ,:SHPTPO-SPLT-XMIT-TM                          50580062
505900               FROM TSHPTPO                                       50590062
506000              WHERE SHIPT_ID = :SHPTPO-SHIPT-ID                   50600062
506100                AND PO_NBR   = :SHPTPO-PO-NBR                     50610062
506200         END-EXEC                                                 50620062
506300                                                                  50630062
506400         EVALUATE TRUE                                            50640062
506500             WHEN SQLCODE = ZERO                                  50650062
506600             WHEN SQLCODE = +100                                  50660062
506700             WHEN SQLCODE = -904                                  50670062
506800             WHEN SQLCODE = -913                                  50680062
506900                 CONTINUE                                         50690062
507000                                                                  50700062
507100             WHEN SQLWARN0 NOT = SPACE                            50710062
507200             WHEN SQLCODE  NOT = +0                               50720062
507300                  MOVE SPACES TO PV-MESSAGE                       50730062
507400                  MOVE SHPTPO-SHIPT-ID TO PV-MESSAGE1             50740062
507500                  MOVE SHPTPO-PO-NBR   TO PV-MESSAGE2             50750062
507600                  MOVE '5005-INSERT-TAUSHPO'                      50760062
507700                                   TO DP013-PARAGRAPH             50770062
507800                  MOVE 'SELECT TSHPTPO DATA'                      50780062
507900                                   TO DP013-MESSAGE-TEXT (1)      50790062
508000                  MOVE PV-MESSAGE  TO DP013-MESSAGE-TEXT (2)      50800062
508100                  MOVE SQLCA       TO DP013-SQLCA                 50810062
508200                  MOVE 'TSHPTPO'   TO DP013-DB2-TABLE-NAME (1)    50820062
508300                  SET DP013-DB2-ABEND                             50830062
508400                                   TO TRUE                        50840062
508500                  PERFORM DP013-0000-PROCESS-ABEND                50850062
508600         END-EVALUATE                                             50860062
508700                                                                  50870062
508800     END-PERFORM.                                                 50880062
508900                                                                  50890062
509000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    50900062
509100         SQLCODE NOT = +0                                         50910062
509200         MOVE '5005-INSERT-TAUSHPO'                               50920062
509300                                   TO DP013-PARAGRAPH             50930062
509400         MOVE 'MAX RETRIES EXCEEDED FOR SELECT TAUSHPO'           50940062
509500                                   TO DP013-MESSAGE-TEXT (1)      50950062
509600         MOVE SQLCA                TO DP013-SQLCA                 50960062
509700         SET DP013-DB2-ABEND       TO TRUE                        50970062
509800         PERFORM DP013-0000-PROCESS-ABEND                         50980062
509900     END-IF.                                                      50990062
510000                                                                  51000062
510100     PERFORM                                                      51010062
510200         WITH TEST AFTER                                          51020062
510300         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     51030062
510400         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            51040062
510500                 SQLCODE = ZERO                                   51050062
510600                                                                  51060062
510700         EXEC SQL                                                 51070062
510800             INSERT INTO TAUSHPO                                  51080062
510900                   (SHIPT_ID,                                     51090062
511000                    PO_NBR,                                       51100062
511100                    REC_SEQ_NBR,                                  51110062
511200                    EXPTED_CART_CNT,                              51120062
511300                    ACTL_CART_CNT,                                51130062
511400                    DMG_CART_CNT,                                 51140062
511500                    PKSL_IND,                                     51150062
511600                    VEND_NAME,                                    51160062
511700                    FRGT_CHG_AMT,                                 51170062
511800                    LAST_UPD_PGM_ID,                              51180062
511900                    CRE_USER_ID,                                  51190062
512000                    CARR_CART_CT,                                 51200062
512100                    CARR_LAST_UPD_DTE,                            51210062
512200                    CARR_LAST_UPD_TIME,                           51220062
512300                    VEND_CART_CT,                                 51230062
512400                    VEND_LAST_UPD_DTE,                            51240062
512500                    VEND_LAST_UPD_TIME,                           51250062
512600                    CRE_TMST,                                     51260062
512700                    LAST_UPD_DTE,                                 51270062
512800                    LAST_UPD_TIME,                                51280062
512900                    LAST_UPD_USER_ID,                             51290062
513000                    PRIM_SHIPT_IND                                51300062
513100                   ,SPLT_XMIT_IND                                 51310062
513200                   ,SPLT_XMIT_DTE                                 51320062
513300                   ,SPLT_XMIT_TM                                  51330062
513400                   ,TRN_CDE )                                     51340062
513500             VALUES                                               51350062
513600                  (:SHPTPO-SHIPT-ID,                              51360062
513700                   :SHPTPO-PO-NBR,                                51370062
513800                   :SHPTPO-REC-SEQ-NBR,                           51380062
513900                   :SHPTPO-EXPTED-CART-CNT,                       51390062
514000                   :SHPTPO-ACTL-CART-CNT,                         51400062
514100                   :SHPTPO-DMG-CART-CNT,                          51410062
514200                   :SHPTPO-PKSL-IND,                              51420062
514300                   :SHPTPO-VEND-NAME,                             51430062
514400                   :SHPTPO-FRGT-CHG-AMT,                          51440062
514500                   :SHPTPO-LAST-UPD-PGM-ID,                       51450062
514600                   :SHPTPO-CRE-USER-ID,                           51460062
514700                   :SHPTPO-CARR-CART-CT,                          51470062
514800                   :SHPTPO-CARR-LAST-UPD-DTE,                     51480062
514900                   :SHPTPO-CARR-LAST-UPD-TIME,                    51490062
515000                   :SHPTPO-VEND-CART-CT,                          51500062
515100                   :SHPTPO-VEND-LAST-UPD-DTE,                     51510062
515200                   :SHPTPO-VEND-LAST-UPD-TIME,                    51520062
515300                   :SHPTPO-CRE-TMST,                              51530062
515400                   :SHPTPO-LAST-UPD-DTE,                          51540062
515500                   :SHPTPO-LAST-UPD-TIME,                         51550062
515600                   :SHPTPO-LAST-UPD-USER-ID,                      51560062
515700                   :SHPTPO-PRIM-SHIPT-IND                         51570062
515800                  ,:SHPTPO-SPLT-XMIT-IND                          51580062
515900                  ,:SHPTPO-SPLT-XMIT-DTE                          51590062
516000                  ,:SHPTPO-SPLT-XMIT-TM                           51600062
516100                  ,:PC-A )                                        51610062
516200         END-EXEC                                                 51620062
516300                                                                  51630062
516400                                                                  51640062
516500         EVALUATE TRUE                                            51650062
516600             WHEN SQLCODE = +0                                    51660062
516700             WHEN SQLCODE = -904                                  51670062
516800             WHEN SQLCODE = -913                                  51680062
516900                 CONTINUE                                         51690062
517000                                                                  51700062
517100             WHEN SQLWARN0 NOT = SPACES                           51710062
517200             WHEN SQLCODE < +0                                    51720062
517300             WHEN SQLCODE > +0                                    51730062
517400                 MOVE SPACES TO PV-MESSAGE                        51740062
517500                 MOVE SHPTPO-SHIPT-ID TO PV-MESSAGE1              51750062
517600                 MOVE SHPTPO-PO-NBR   TO PV-MESSAGE2              51760062
517700                 MOVE '5005-INSERT-TAUSHPO'                       51770062
517800                                   TO DP013-PARAGRAPH             51780062
517900                 MOVE 'INSERT A ROW ON TAUSHPO'                   51790062
518000                                   TO DP013-MESSAGE-TEXT(1)       51800062
518100                 MOVE PV-MESSAGE   TO DP013-MESSAGE-TEXT(2)       51810062
518200                 MOVE SQLCA        TO DP013-SQLCA                 51820062
518300                 MOVE 'TAUSHPO'    TO DP013-DB2-TABLE-NAME (1)    51830062
518400                 SET DP013-DB2-ABEND                              51840062
518500                     DP013-XCTL-DISPLAY-RESTART TO TRUE           51850062
518600                 PERFORM DP013-0000-PROCESS-ABEND                 51860062
518700         END-EVALUATE                                             51870062
518800     END-PERFORM.                                                 51880062
518900                                                                  51890062
519000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    51900062
519100         SQLCODE NOT = +0                                         51910062
519200         MOVE '5000-INSERT-TAUSHPO'                               51920062
519300                                   TO DP013-PARAGRAPH             51930062
519400         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              51940062
519500                                   TO DP013-MESSAGE-TEXT (1)      51950062
519600         MOVE 'TO INSERT A TAUSHPO ROW'                           51960062
519700                                   TO DP013-MESSAGE-TEXT (2)      51970062
519800         MOVE SQLCA                TO DP013-SQLCA                 51980062
519900         MOVE 'TAUSHPO'            TO DP013-DB2-TABLE-NAME (1)    51990062
520000         SET DP013-DB2-ABEND                                      52000062
520100             DP013-XCTL-DISPLAY-RESTART                           52010062
520200                                   TO TRUE                        52020062
520300         PERFORM DP013-0000-PROCESS-ABEND                         52030062
520400     END-IF.                                                      52040062
520500                                                                  52050062
520600 EJECT                                                            52060062
520700*----------------------------------------------------------------*52070062
520800*  INSERT A ROW TO THE TRIP TABLE                                 52080062
520900*                                                                 52090062
521000*  PERFORMED FROM 3020-DETERMINE-ADD                              52100062
521100*----------------------------------------------------------------*52110062
521200 5010-INSERT-TVHTRIP.                                             52120062
521300                                                                  52130062
521400     INITIALIZE DCLTVHTRIP.                                       52140062
521500                                                                  52150062
521600     MOVE DK-SCAC                  TO VHTRIP-OWNER-SCAC-ID.       52160062
521700                                                                  52170062
521800     IF PS-NULL-VEHICLE-NBR OR ASC-VEH-NBR = SPACES               52180062
521900        MOVE -1            TO DN-VEH-NBR                          52190062
522000     ELSE                                                         52200062
522100        MOVE +1            TO DN-VEH-NBR                          52210062
522200        MOVE ASC-VEH-NBR   TO VHTRIP-VEH-NBR                      52220062
522300     END-IF.                                                      52230062
522400                                                                  52240062
522500     MOVE ASC-TRIP-ID              TO VHTRIP-TRIP-ID              52250062
522600                                      VHTRIP-REF-TRIP-ID          52260062
522700                                      DK-TRIP-ID.                 52270062
522800     MOVE 'CE'                     TO VHTRIP-CRT-SRC-CDE.         52280062
522900     MOVE SPACES                   TO VHTRIP-MANIFEST-NBR         52290062
523000                                      VHTRIP-PLND-ACTVY-CDE.      52300062
523100     MOVE ZEROES                   TO VHTRIP-PLND-TRIP-SEQ.       52310062
523200     MOVE PC-DEFAULT-TMST          TO PV-TEMP-TMST.               52320062
523300     MOVE ASC-ETA-MM               TO PV-TMST-MM.                 52330062
523400     MOVE ASC-ETA-DD               TO PV-TMST-DD.                 52340062
523500     MOVE ASC-ETA-CCYY             TO PV-TMST-CCYY.               52350062
523600     MOVE ASC-ETA-TIME-HH          TO PV-TMST-HH.                 52360062
523700     MOVE ASC-ETA-TIME-MN          TO PV-TMST-MN.                 52370062
523800     MOVE PV-TEMP-TMST             TO VHTRIP-EST-AR-TMST.         52380062
523900                                                                  52390062
524000     PERFORM                                                      52400062
524100         WITH TEST AFTER                                          52410062
524200         VARYING PV-RETRY-COUNTER                                 52420062
524300         FROM 1 BY 1                                              52430062
524400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               52440062
524500             OR (SQLCODE = +0))                                   52450062
524600                                                                  52460062
524700         EXEC SQL                                                 52470062
524800             INSERT  INTO TVHTRIP                                 52480062
524900                   ( OWNER_SCAC_ID                                52490062
525000                    ,VEH_NBR                                      52500062
525100                    ,TRIP_ID                                      52510062
525200                    ,CRT_SRC_CDE                                  52520062
525300                    ,LAST_UPD_UID                                 52530062
525400                    ,MANIFEST_NBR                                 52540062
525500                    ,PLND_TRIP_SEQ                                52550062
525600                    ,PLND_ACTVY_CDE                               52560062
525700                    ,OWNR_SCAC_SHIP_DTE                           52570062
525800                    ,REF_TRIP_ID                                  52580062
525900                    ,EST_AR_TMST                                  52590062
526000                    ,SPLT_XMIT_IND                                52600062
526100                    ,SPLT_XMIT_DTE                                52610062
526200                    ,SPLT_XMIT_TM )                               52620062
526300             VALUES                                               52630062
526400                   ( :VHTRIP-OWNER-SCAC-ID                        52640062
526500                    ,:VHTRIP-VEH-NBR :DN-VEH-NBR                  52650062
526600                    ,:VHTRIP-TRIP-ID                              52660062
526700                    ,:VHTRIP-CRT-SRC-CDE                          52670062
526800                    ,:DP020-USERID                                52680062
526900                    ,:VHTRIP-MANIFEST-NBR                         52690062
527000                    ,:VHTRIP-PLND-TRIP-SEQ                        52700062
527100                    ,:VHTRIP-PLND-ACTVY-CDE                       52710062
527200                    ,:PC-DEFAULT-DATE                             52720062
527300                    ,:VHTRIP-REF-TRIP-ID                          52730062
527400                    ,:VHTRIP-EST-AR-TMST                          52740062
527500                    ,:VHTRIP-SPLT-XMIT-IND                        52750062
527600                    ,:PC-DEFAULT-DATE                             52760062
527700                    ,:PC-DEFAULT-TIME )                           52770062
527800         END-EXEC                                                 52780062
527900                                                                  52790062
528000         EVALUATE TRUE                                            52800062
528100             WHEN SQLCODE = +0                                    52810062
528200             WHEN SQLCODE = -904                                  52820062
528300             WHEN SQLCODE = -913                                  52830062
528400                 CONTINUE                                         52840062
528500                                                                  52850062
528600             WHEN SQLWARN0 NOT = SPACES                           52860062
528700             WHEN SQLCODE < +0                                    52870062
528800             WHEN SQLCODE > +0                                    52880062
528900                 MOVE SPACES TO PV-MESSAGE                        52890062
529000                 MOVE VHTRIP-OWNER-SCAC-ID TO PV-MESSAGE1         52900062
529100                 MOVE VHTRIP-VEH-NBR       TO PV-MESSAGE2         52910062
529200                 MOVE VHTRIP-TRIP-ID       TO PV-MESSAGE3         52920062
529300                 MOVE '5010-INSERT-TVHTRIP'                       52930062
529400                                   TO DP013-PARAGRAPH             52940062
529500                 MOVE 'INSERT A ROW ON TVHTRIP'                   52950062
529600                                   TO DP013-MESSAGE-TEXT(1)       52960062
529700                 MOVE PV-MESSAGE   TO DP013-MESSAGE-TEXT(2)       52970062
529800                 MOVE SQLCA        TO DP013-SQLCA                 52980062
529900                 MOVE 'TVHTRIP'    TO DP013-DB2-TABLE-NAME (1)    52990062
530000                 SET DP013-DB2-ABEND                              53000062
530100                     DP013-XCTL-DISPLAY-RESTART TO TRUE           53010062
530200                 PERFORM DP013-0000-PROCESS-ABEND                 53020062
530300         END-EVALUATE                                             53030062
530400     END-PERFORM.                                                 53040062
530500                                                                  53050062
530600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    53060062
530700         SQLCODE NOT = +0                                         53070062
530800         MOVE '5010-INSERT-TVHTRIP'                               53080062
530900                                   TO DP013-PARAGRAPH             53090062
531000         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              53100062
531100                                   TO DP013-MESSAGE-TEXT (1)      53110062
531200         MOVE 'TO INSERT A TVHTRIP ROW'                           53120062
531300                                   TO DP013-MESSAGE-TEXT (2)      53130062
531400         MOVE SQLCA                TO DP013-SQLCA                 53140062
531500         MOVE 'TVHTRIP'            TO DP013-DB2-TABLE-NAME (1)    53150062
531600         SET DP013-DB2-ABEND                                      53160062
531700             DP013-XCTL-DISPLAY-RESTART                           53170062
531800                                   TO TRUE                        53180062
531900         PERFORM DP013-0000-PROCESS-ABEND                         53190062
532000     END-IF.                                                      53200062
532100                                                                  53210062
532200     EVALUATE TRUE                                                53220062
532300         WHEN SQLCODE = ZERO                                      53230062
532400              PERFORM 5030-INSERT-TTRIPST                         53240062
532500              PERFORM 5015-INSERT-TAUTRIP                         53250062
532600     END-EVALUATE.                                                53260062
532700                                                                  53270062
532800*----------------------------------------------------------------*53280062
532900*  INSERT A ROW TO THE TRIP AUDIT TABLE                           53290062
533000*                                                                 53300062
533100*  PERFORMED FROM 5015-INSERT-TVHTRIP                             53310062
533200*----------------------------------------------------------------*53320062
533300 5015-INSERT-TAUTRIP.                                             53330062
533400                                                                  53340062
533500                                                                  53350062
533600     INITIALIZE DCLTAUTRIP.                                       53360062
533700                                                                  53370062
533800     PERFORM                                                      53380062
533900         WITH TEST AFTER                                          53390062
534000         VARYING PV-RETRY-COUNTER                                 53400062
534100         FROM 1 BY 1                                              53410062
534200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               53420062
534300             OR (SQLCODE = +0))                                   53430062
534400                                                                  53440062
534500         EXEC SQL                                                 53450062
534600             SELECT  OWNER_SCAC_ID                                53460062
534700                    ,VEH_NBR                                      53470062
534800                    ,TRIP_ID                                      53480062
534900                    ,TRIP_BEG_DTE                                 53490062
535000                    ,TRIP_BEG_TME                                 53500062
535100                    ,CRT_SRC_CDE                                  53510062
535200                    ,LAST_UPD_DTE                                 53520062
535300                    ,LAST_UPD_TME                                 53530062
535400                    ,LAST_UPD_UID                                 53540062
535500                    ,MANIFEST_NBR                                 53550062
535600                    ,PLND_TRIP_SEQ                                53560062
535700                    ,PLND_ACTVY_CDE                               53570062
535800                    ,OWNR_SCAC_SHIP_DTE                           53580062
535900                    ,REF_TRIP_ID                                  53590062
536000                    ,EST_AR_TMST                                  53600062
536100                    ,SPLT_XMIT_IND                                53610062
536200                    ,SPLT_XMIT_DTE                                53620062
536300                    ,SPLT_XMIT_TM                                 53630062
536400            INTO     :VHTRIP-OWNER-SCAC-ID                        53640062
536500                    ,:VHTRIP-VEH-NBR                              53650062
536600                       :DN-VEH-NBR                                53660062
536700                    ,:VHTRIP-TRIP-ID                              53670062
536800                    ,:VHTRIP-TRIP-BEG-DTE                         53680062
536900                    ,:VHTRIP-TRIP-BEG-TME                         53690062
537000                    ,:VHTRIP-CRT-SRC-CDE                          53700062
537100                    ,:VHTRIP-LAST-UPD-DTE                         53710062
537200                    ,:VHTRIP-LAST-UPD-TME                         53720062
537300                    ,:VHTRIP-LAST-UPD-UID                         53730062
537400                    ,:VHTRIP-MANIFEST-NBR                         53740062
537500                    ,:VHTRIP-PLND-TRIP-SEQ                        53750062
537600                    ,:VHTRIP-PLND-ACTVY-CDE                       53760062
537700                    ,:VHTRIP-OWNR-SCAC-SHIP-DTE                   53770062
537800                    ,:VHTRIP-REF-TRIP-ID                          53780062
537900                    ,:VHTRIP-EST-AR-TMST                          53790062
538000                           :DN-EST-AR-TMST                        53800062
538100                    ,:VHTRIP-SPLT-XMIT-IND                        53810062
538200                    ,:VHTRIP-SPLT-XMIT-DTE                        53820062
538300                    ,:VHTRIP-SPLT-XMIT-TM                         53830062
538400           FROM   TVHTRIP                                         53840062
538500           WHERE  OWNER_SCAC_ID = :DK-SCAC                        53850062
538600             AND  TRIP_ID       = :DK-TRIP-ID                     53860062
538700         END-EXEC                                                 53870062
538800                                                                  53880062
538900         EVALUATE TRUE                                            53890062
539000             WHEN SQLCODE = +0                                    53900062
539100             WHEN SQLCODE = -904                                  53910062
539200             WHEN SQLCODE = -913                                  53920062
539300                 CONTINUE                                         53930062
539400                                                                  53940062
539500             WHEN SQLWARN0 NOT = SPACES                           53950062
539600             WHEN SQLCODE < +0                                    53960062
539700             WHEN SQLCODE > +0                                    53970062
539800                 MOVE SPACES TO PV-MESSAGE                        53980062
539900                 MOVE VHTRIP-OWNER-SCAC-ID TO PV-MESSAGE1         53990062
540000                 MOVE VHTRIP-VEH-NBR       TO PV-MESSAGE2         54000062
540100                 MOVE VHTRIP-TRIP-ID       TO PV-MESSAGE3         54010062
540200                 MOVE '5015-INSERT-TAUTRIP'                       54020062
540300                                   TO DP013-PARAGRAPH             54030062
540400                 MOVE 'SELECT A ROW ON TVHTRIP'                   54040062
540500                                   TO DP013-MESSAGE-TEXT(1)       54050062
540600                 MOVE PV-MESSAGE   TO DP013-MESSAGE-TEXT(2)       54060062
540700                 MOVE SQLCA        TO DP013-SQLCA                 54070062
540800                 MOVE 'TVHTRIP'    TO DP013-DB2-TABLE-NAME (1)    54080062
540900                 SET DP013-DB2-ABEND                              54090062
541000                     DP013-XCTL-DISPLAY-RESTART TO TRUE           54100062
541100                 PERFORM DP013-0000-PROCESS-ABEND                 54110062
541200         END-EVALUATE                                             54120062
541300     END-PERFORM.                                                 54130062
541400                                                                  54140062
541500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    54150062
541600         SQLCODE NOT = +0                                         54160062
541700         MOVE '5015-INSERT-TAUTRIP'                               54170062
541800                                   TO DP013-PARAGRAPH             54180062
541900         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              54190062
542000                                   TO DP013-MESSAGE-TEXT (1)      54200062
542100         MOVE 'TO SELECT A TVHTRIP ROW'                           54210062
542200                                   TO DP013-MESSAGE-TEXT (2)      54220062
542300         MOVE SQLCA                TO DP013-SQLCA                 54230062
542400         MOVE 'TVHTRIP'            TO DP013-DB2-TABLE-NAME (1)    54240062
542500         SET DP013-DB2-ABEND                                      54250062
542600             DP013-XCTL-DISPLAY-RESTART                           54260062
542700                                   TO TRUE                        54270062
542800         PERFORM DP013-0000-PROCESS-ABEND                         54280062
542900     END-IF.                                                      54290062
543000                                                                  54300062
543100     MOVE 'CE'                     TO VHTRIP-CRT-SRC-CDE.         54310062
543200                                                                  54320062
543300     PERFORM                                                      54330062
543400         WITH TEST AFTER                                          54340062
543500         VARYING PV-RETRY-COUNTER                                 54350062
543600         FROM 1 BY 1                                              54360062
543700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               54370062
543800             OR (SQLCODE = +0))                                   54380062
543900                                                                  54390062
544000         EXEC SQL                                                 54400062
544100             INSERT  INTO TAUTRIP                                 54410062
544200                    (OWNER_SCAC_ID                                54420062
544300                    ,VEH_NBR                                      54430062
544400                    ,TRIP_ID                                      54440062
544500                    ,TRIP_BEG_DTE                                 54450062
544600                    ,TRIP_BEG_TME                                 54460062
544700                    ,CRT_SRC_CDE                                  54470062
544800                    ,LAST_UPD_DTE                                 54480062
544900                    ,LAST_UPD_TME                                 54490062
545000                    ,LAST_UPD_UID                                 54500062
545100                    ,MANIFEST_NBR                                 54510062
545200                    ,PLND_TRIP_SEQ                                54520062
545300                    ,PLND_ACTVY_CDE                               54530062
545400                    ,OWNR_SCAC_SHIP_DTE                           54540062
545500                    ,REF_TRIP_ID                                  54550062
545600                    ,EST_AR_TMST                                  54560062
545700                    ,AUD_STATUS_CDE                               54570062
545800                    ,SPLT_XMIT_IND                                54580062
545900                    ,SPLT_XMIT_DTE                                54590062
546000                    ,SPLT_XMIT_TM )                               54600062
546100            VALUES  (:VHTRIP-OWNER-SCAC-ID                        54610062
546200                    ,:VHTRIP-VEH-NBR                              54620062
546300                       :DN-VEH-NBR                                54630062
546400                    ,:VHTRIP-TRIP-ID                              54640062
546500                    ,:VHTRIP-TRIP-BEG-DTE                         54650062
546600                    ,:VHTRIP-TRIP-BEG-TME                         54660062
546700                    ,:VHTRIP-CRT-SRC-CDE                          54670062
546800                    ,:VHTRIP-LAST-UPD-DTE                         54680062
546900                    ,:VHTRIP-LAST-UPD-TME                         54690062
547000                    ,:VHTRIP-LAST-UPD-UID                         54700062
547100                    ,:VHTRIP-MANIFEST-NBR                         54710062
547200                    ,:VHTRIP-PLND-TRIP-SEQ                        54720062
547300                    ,:VHTRIP-PLND-ACTVY-CDE                       54730062
547400                    ,:VHTRIP-OWNR-SCAC-SHIP-DTE                   54740062
547500                    ,:VHTRIP-REF-TRIP-ID                          54750062
547600                    ,:VHTRIP-EST-AR-TMST                          54760062
547700                           :DN-EST-AR-TMST                        54770062
547800                    ,:TRIPST-TRIP-STATUS-CDE                      54780062
547900                    ,:VHTRIP-SPLT-XMIT-IND                        54790062
548000                    ,:VHTRIP-SPLT-XMIT-DTE                        54800062
548100                    ,:VHTRIP-SPLT-XMIT-TM )                       54810062
548200         END-EXEC                                                 54820062
548300         EVALUATE TRUE                                            54830062
548400             WHEN SQLCODE = +0                                    54840062
548500             WHEN SQLCODE = -904                                  54850062
548600             WHEN SQLCODE = -913                                  54860062
548700                 CONTINUE                                         54870062
548800                                                                  54880062
548900             WHEN SQLWARN0 NOT = SPACES                           54890062
549000             WHEN SQLCODE < +0                                    54900062
549100             WHEN SQLCODE > +0                                    54910062
549200                 MOVE SPACES TO PV-MESSAGE                        54920062
549300                 MOVE VHTRIP-OWNER-SCAC-ID TO PV-MESSAGE1         54930062
549400                 MOVE VHTRIP-VEH-NBR       TO PV-MESSAGE2         54940062
549500                 MOVE VHTRIP-TRIP-ID       TO PV-MESSAGE3         54950062
549600                 MOVE '5015-INSERT-TAUTRIP'                       54960062
549700                                   TO DP013-PARAGRAPH             54970062
549800                 MOVE 'INSERT A ROW ON TAUTRIP'                   54980062
549900                                   TO DP013-MESSAGE-TEXT(1)       54990062
550000                 MOVE PV-MESSAGE   TO DP013-MESSAGE-TEXT(2)       55000062
550100                 MOVE SQLCA        TO DP013-SQLCA                 55010062
550200                 MOVE 'TAUTRIP'    TO DP013-DB2-TABLE-NAME (1)    55020062
550300                 SET DP013-DB2-ABEND                              55030062
550400                     DP013-XCTL-DISPLAY-RESTART TO TRUE           55040062
550500                 PERFORM DP013-0000-PROCESS-ABEND                 55050062
550600         END-EVALUATE                                             55060062
550700     END-PERFORM.                                                 55070062
550800                                                                  55080062
550900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    55090062
551000         SQLCODE NOT = +0                                         55100062
551100         MOVE '5015-INSERT-TAUTRIP'                               55110062
551200                                   TO DP013-PARAGRAPH             55120062
551300         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              55130062
551400                                   TO DP013-MESSAGE-TEXT (1)      55140062
551500         MOVE 'TO INSERT A TAUTRIP ROW'                           55150062
551600                                   TO DP013-MESSAGE-TEXT (2)      55160062
551700         MOVE SQLCA                TO DP013-SQLCA                 55170062
551800         MOVE 'TAUTRIP'            TO DP013-DB2-TABLE-NAME (1)    55180062
551900         SET DP013-DB2-ABEND                                      55190062
552000             DP013-XCTL-DISPLAY-RESTART                           55200062
552100                                   TO TRUE                        55210062
552200         PERFORM DP013-0000-PROCESS-ABEND                         55220062
552300     END-IF.                                                      55230062
552400                                                                  55240062
552500*----------------------------------------------------------------*55250062
552600*  INSERT A ROW TO THE SHIPTMENT TABLE                            55260062
552700*                                                                 55270062
552800*  PERFORMED FROM 3020-DETERMINE-ADD                              55280062
552900*----------------------------------------------------------------*55290062
553000 5020-INSERT-TSHIPMT.                                             55300062
553100                                                                  55310062
553200     INITIALIZE DCLTSHIPMT.                                       55320062
553300                                                                  55330062
553400     MOVE ASC-TRIP-ID              TO SHIPMT-TRIP-ID.             55340062
553500     MOVE ASC-SHIPT-ID             TO SHIPMT-SHIPT-ID.            55350062
553600     MOVE 'CE'                     TO SHIPMT-CRT-SRC-CDE.         55360062
553700     MOVE DK-SCAC                  TO SHIPMT-PRO-SCAC-ID.         55370062
553800     MOVE ASC-PRO-NBR              TO SHIPMT-PRO-NBR.             55380062
553810* 2011-12-14 CHRISTINE TWIEHAUS WR40574 START                    *55381062
553820     MOVE ASC-CAN                  TO SHIPMT-CARR-AUTH-ID.        55382062
553830* 2011-12-14 CHRISTINE TWIEHAUS WR40574 END                      *55383062
553900     MOVE ASC-BOL-NBR              TO SHIPMT-BOL-NBR.             55390062
554000     MOVE ASC-COMPLETE-PRO-NBR     TO SHIPMT-COMPLETE-PRO-NBR.    55400062
554100     MOVE ASC-COMPLETE-BOL-NBR     TO SHIPMT-COMPLETE-BOL-NBR.    55410062
554200     MOVE +1                       TO SHIPMT-SHIPT-TYP-CDE.       55420062
554300     MOVE 'CTN'                    TO SHIPMT-PKG-TYP-CDE          55430062
554400     MOVE SPACES                   TO SHIPMT-FRGT-TERMS-CDE       55440062
554500     MOVE ASC-FB-CARTON-CNT        TO SHIPMT-EXPTED-PKG-QTY.      55450062
554600     MOVE ZEROES                   TO SHIPMT-FRGT-CHG-AMT         55460062
554700                                      SHIPMT-EXPTED-PLT-QTY       55470062
554800     IF ASC-VEND-SHIP-DTE = SPACES                                55480062
554900        MOVE PC-DEFAULT-DATE       TO SHIPMT-VEND-SHIP-DTE        55490062
555000     ELSE                                                         55500062
555100        MOVE ASC-VEND-SHIP-MM      TO PV-DB2-MM                   55510062
555200        MOVE ASC-VEND-SHIP-DD      TO PV-DB2-DD                   55520062
555300        MOVE ASC-VEND-SHIP-CCYY    TO PV-DB2-CCYY                 55530062
555400        MOVE PV-DB2-DATE           TO SHIPMT-VEND-SHIP-DTE        55540062
555500     END-IF.                                                      55550062
555600                                                                  55560062
555700     MOVE PC-DEFAULT-TMST          TO PV-TEMP-TMST.               55570062
555800     MOVE ASC-ETA-MM               TO PV-TMST-MM.                 55580062
555900     MOVE ASC-ETA-DD               TO PV-TMST-DD.                 55590062
556000     MOVE ASC-ETA-CCYY             TO PV-TMST-CCYY.               55600062
556100     MOVE ASC-ETA-TIME-HH          TO PV-TMST-HH.                 55610062
556200     MOVE ASC-ETA-TIME-MN          TO PV-TMST-MN.                 55620062
556300     MOVE PV-TEMP-TMST             TO SHIPMT-EST-AR-TMST.         55630062
556400                                                                  55640062
556500     IF ASC-ORIG-SCAC-ID = SPACES                                 55650062
556600        MOVE ASC-PRO-SCAC-ID       TO SHIPMT-ORIG-SCAC-ID         55660062
556700     ELSE                                                         55670062
556800        MOVE ASC-ORIG-SCAC-ID      TO SHIPMT-ORIG-SCAC-ID         55680062
556900     END-IF.                                                      55690062
557000                                                                  55700062
557100     MOVE PC-CURRENT-PROGRAM-NAME  TO SHIPMT-LAST-UPD-PGM-ID.     55710062
557200     MOVE PC-DEFAULT-DATE          TO SHIPMT-CARR-LAST-UPD-DTE    55720062
557300                                      SHIPMT-CONFIRM-DTE          55730062
557400                                      SHIPMT-PROCESSED-DTE        55740062
557500                                      SHIPMT-VEND-LAST-UPD-DTE.   55750062
557600     MOVE PC-DEFAULT-TIME          TO SHIPMT-CARR-LAST-UPD-TIME   55760062
557700                                      SHIPMT-CONFIRM-TIME         55770062
557800                                      SHIPMT-VEND-LAST-UPD-TIME.  55780062
557900     MOVE ZEROES                   TO SHIPMT-CARR-CART-CT         55790062
558000                                      SHIPMT-VEND-CART-CT.        55800062
558100     MOVE ASC-VEH-NBR              TO SHIPMT-VEH-NBR.             55810062
558200     MOVE ASC-AUTH-NBR             TO SHIPMT-AUTH-NBR.            55820062
558300     IF ASC-AUTH-DTE = SPACES                                     55830062
558400        MOVE PC-DEFAULT-DATE       TO SHIPMT-AUTH-DTE             55840062
558500     ELSE                                                         55850062
558600        MOVE ASC-AUTH-MM           TO PV-DB2-MM                   55860062
558700        MOVE ASC-AUTH-DD           TO PV-DB2-DD                   55870062
558800        MOVE ASC-AUTH-CCYY         TO PV-DB2-CCYY                 55880062
558900        MOVE PV-DB2-DATE           TO SHIPMT-AUTH-DTE             55890062
559000     END-IF.                                                      55900062
559100                                                                  55910062
559200     PERFORM                                                      55920062
559300         WITH TEST AFTER                                          55930062
559400         VARYING PV-RETRY-COUNTER                                 55940062
559500         FROM 1 BY 1                                              55950062
559600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               55960062
559700             OR (SQLCODE = +0))                                   55970062
559800                                                                  55980062
559810* 2011-12-14 CHRISTINE TWIEHAUS WR40574 ADDED CARR-AUTH-ID BELOW *55981062
559900         EXEC SQL                                                 55990062
560000             INSERT  INTO TSHIPMT                                 56000062
560100                   ( TRIP_ID                                      56010062
560200                    ,SHIPT_ID                                     56020062
560300                    ,CRT_SRC_CDE                                  56030062
560400                    ,LAST_UPD_UID                                 56040062
560500                    ,PRO_SCAC_ID                                  56050062
560600                    ,PRO_NBR                                      56060062
560700                    ,BOL_NBR                                      56070062
560800                    ,SHIPPER_NME                                  56080062
560900                    ,SHIPT_TYP_CDE                                56090062
561000                    ,PKG_TYP_CDE                                  56100062
561100                    ,EXPTED_PKG_QTY                               56110062
561200                    ,FRGT_CHG_AMT                                 56120062
561300                    ,FRGT_TERMS_CDE                               56130062
561400                    ,EXPTED_PLT_QTY                               56140062
561500                    ,VEND_SHIP_DTE                                56150062
561600                    ,EST_AR_TMST                                  56160062
561700                    ,ORIG_SCAC_ID                                 56170062
561800                    ,LAST_UPD_PGM_ID                              56180062
561900                    ,CRE_USER_ID                                  56190062
562000                    ,CARR_CART_CT                                 56200062
562100                    ,CARR_LAST_UPD_DTE                            56210062
562200                    ,CARR_LAST_UPD_TIME                           56220062
562300                    ,VEND_CART_CT                                 56230062
562400                    ,VEND_LAST_UPD_DTE                            56240062
562500                    ,VEND_LAST_UPD_TIME                           56250062
562600                    ,VEH_NBR                                      56260062
562700                    ,AUTH_NBR                                     56270062
562800                    ,AUTH_DTE                                     56280062
562900                    ,CONFIRM_DTE                                  56290062
563000                    ,CONFIRM_TIME                                 56300062
563100                    ,COMPLETE_PRO_NBR                             56310062
563200                    ,COMPLETE_BOL_NBR                             56320062
563300                    ,PROCESSED_DTE                                56330062
563310                    ,CARR_AUTH_ID  )                              56331065
563400             VALUES                                               56340062
563500                   ( :SHIPMT-TRIP-ID                              56350062
563600                    ,:SHIPMT-SHIPT-ID                             56360062
563700                    ,:SHIPMT-CRT-SRC-CDE                          56370062
563800                    ,:DP020-USERID                                56380062
563900                    ,:SHIPMT-PRO-SCAC-ID                          56390062
564000                    ,:SHIPMT-PRO-NBR                              56400062
564100                    ,:SHIPMT-BOL-NBR                              56410062
564200                    ,:SHIPMT-SHIPPER-NME                          56420062
564300                    ,:SHIPMT-SHIPT-TYP-CDE                        56430062
564400                    ,:SHIPMT-PKG-TYP-CDE                          56440062
564500                    ,:SHIPMT-EXPTED-PKG-QTY                       56450062
564600                    ,:SHIPMT-FRGT-CHG-AMT                         56460062
564700                    ,:SHIPMT-FRGT-TERMS-CDE                       56470062
564800                    ,:SHIPMT-EXPTED-PLT-QTY                       56480062
564900                    ,:SHIPMT-VEND-SHIP-DTE                        56490062
565000                    ,:SHIPMT-EST-AR-TMST                          56500062
565100                    ,:SHIPMT-ORIG-SCAC-ID                         56510062
565200                    ,:PC-CURRENT-PROGRAM-NAME                     56520062
565300                    ,:DP020-USERID                                56530062
565400                    ,:SHIPMT-CARR-CART-CT                         56540062
565500                    ,:PC-DEFAULT-DATE                             56550062
565600                    ,:PC-DEFAULT-TIME                             56560062
565700                    ,:SHIPMT-VEND-CART-CT                         56570062
565800                    ,:PC-DEFAULT-DATE                             56580062
565900                    ,:PC-DEFAULT-TIME                             56590062
566000                    ,:SHIPMT-VEH-NBR                              56600062
566100                    ,:SHIPMT-AUTH-NBR                             56610062
566200                    ,:SHIPMT-AUTH-DTE                             56620062
566300                    ,:PC-DEFAULT-DATE                             56630062
566400                    ,:PC-DEFAULT-TIME                             56640062
566500                    ,:SHIPMT-COMPLETE-PRO-NBR                     56650062
566600                    ,:SHIPMT-COMPLETE-BOL-NBR                     56660062
566610                    ,:SHIPMT-PROCESSED-DTE                        56661062
566620                    ,:SHIPMT-CARR-AUTH-ID  )                      56662062
566800         END-EXEC                                                 56680062
566900                                                                  56690062
567000         EVALUATE TRUE                                            56700062
567100             WHEN SQLCODE = +0                                    56710062
567200             WHEN SQLCODE = -904                                  56720062
567300             WHEN SQLCODE = -913                                  56730062
567400                 CONTINUE                                         56740062
567500                                                                  56750062
567600             WHEN SQLWARN0 NOT = SPACES                           56760062
567700             WHEN SQLCODE < +0                                    56770062
567800             WHEN SQLCODE > +0                                    56780062
567900                 MOVE SPACES TO PV-MESSAGE                        56790062
568000                 MOVE SHIPMT-SHIPT-ID TO PV-MESSAGE1              56800062
568100                 MOVE SHIPMT-TRIP-ID  TO PV-MESSAGE2              56810062
568200                 MOVE SHIPMT-PRO-SCAC-ID TO PV-MESSAGE3           56820062
568300                 MOVE '5020-INSERT-TSHIPMT'                       56830062
568400                                   TO DP013-PARAGRAPH             56840062
568500                 MOVE 'INSERT A ROW ON TSHIPMT'                   56850062
568600                                   TO DP013-MESSAGE-TEXT(1)       56860062
568700                 MOVE PV-MESSAGE   TO DP013-MESSAGE-TEXT(2)       56870062
568800                 MOVE SPACES TO PV-MESSAGE                        56880062
568900                 MOVE SHIPMT-PRO-NBR  TO PV-MESSAGE1              56890062
569000                 MOVE SHIPMT-BOL-NBR  TO PV-MESSAGE2              56900062
569100                 MOVE PV-MESSAGE   TO DP013-MESSAGE-TEXT(3)       56910062
569200                 MOVE SQLCA        TO DP013-SQLCA                 56920062
569300                 MOVE 'TSHIPMT'    TO DP013-DB2-TABLE-NAME (1)    56930062
569400                 SET DP013-DB2-ABEND                              56940062
569500                     DP013-XCTL-DISPLAY-RESTART TO TRUE           56950062
569600                 PERFORM DP013-0000-PROCESS-ABEND                 56960062
569700         END-EVALUATE                                             56970062
569800     END-PERFORM.                                                 56980062
569900                                                                  56990062
570000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    57000062
570100         SQLCODE NOT = +0                                         57010062
570200         MOVE '5030-INSERT-TSHIPMT'                               57020062
570300                                   TO DP013-PARAGRAPH             57030062
570400         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              57040062
570500                                   TO DP013-MESSAGE-TEXT (1)      57050062
570600         MOVE 'TO INSERT A TSHIPMT ROW'                           57060062
570700                                   TO DP013-MESSAGE-TEXT (2)      57070062
570800         MOVE SQLCA                TO DP013-SQLCA                 57080062
570900         MOVE 'TSHIPMT'            TO DP013-DB2-TABLE-NAME (1)    57090062
571000         SET DP013-DB2-ABEND                                      57100062
571100             DP013-XCTL-DISPLAY-RESTART                           57110062
571200                                   TO TRUE                        57120062
571300         PERFORM DP013-0000-PROCESS-ABEND                         57130062
571400     END-IF.                                                      57140062
571500                                                                  57150062
571600     EVALUATE TRUE                                                57160062
571700         WHEN SQLCODE = ZERO                                      57170062
571800              PERFORM 5040-INSERT-TSHIPST                         57180062
571900              PERFORM 5025-INSERT-TAUSHIP                         57190062
572000     END-EVALUATE.                                                57200062
572100 EJECT                                                            57210062
572200*----------------------------------------------------------------*57220062
572300*  INSERT A ROW TO THE SHIPTMENT AUDIT TABLE                      57230062
572400*----------------------------------------------------------------*57240062
572500 5025-INSERT-TAUSHIP.                                             57250062
572600                                                                  57260062
572700     INITIALIZE DCLTAUSHIP.                                       57270062
572800                                                                  57280062
572900     PERFORM                                                      57290062
573000         WITH TEST AFTER                                          57300062
573100         VARYING PV-RETRY-COUNTER                                 57310062
573200         FROM 1 BY 1                                              57320062
573300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               57330062
573400             OR (SQLCODE = +0))                                   57340062
573500                                                                  57350062
573510* 2011-12-14 CHRISTINE TWIEHAUS WR40574 ADDED CARR-AUTH-ID BELOW *57351062
573600         EXEC SQL                                                 57360062
573700             SELECT  A.TRIP_ID                                    57370062
573800                    ,A.SHIPT_ID                                   57380062
573900                    ,A.CRT_SRC_CDE                                57390062
574000                    ,A.LAST_UPD_DTE                               57400062
574100                    ,A.LAST_UPD_TME                               57410062
574200                    ,A.LAST_UPD_UID                               57420062
574300                    ,A.PRO_SCAC_ID                                57430062
574400                    ,A.PRO_NBR                                    57440062
574500                    ,A.BOL_NBR                                    57450062
574600                    ,A.SHIPPER_NME                                57460062
574700                    ,A.SHIPT_TYP_CDE                              57470062
574800                    ,A.EXPTED_GRO_WGHT                            57480062
574900                    ,A.PKG_TYP_CDE                                57490062
575000                    ,A.EXPTED_PKG_QTY                             57500062
575100                    ,A.FRGT_CHG_AMT                               57510062
575200                    ,A.FRGT_TERMS_CDE                             57520062
575300                    ,A.EXPTED_PLT_QTY                             57530062
575400                    ,A.VEND_SHIP_DTE                              57540062
575500                    ,A.EST_AR_TMST                                57550062
575600                    ,A.ORIG_SCAC_ID                               57560062
575700                    ,A.LAST_UPD_PGM_ID                            57570062
575800                    ,A.CRE_USER_ID                                57580062
575900                    ,A.CARR_CART_CT                               57590062
576000                    ,A.CARR_LAST_UPD_DTE                          57600062
576100                    ,A.CARR_LAST_UPD_TIME                         57610062
576200                    ,A.VEND_CART_CT                               57620062
576300                    ,A.VEND_LAST_UPD_DTE                          57630062
576400                    ,A.VEND_LAST_UPD_TIME                         57640062
576500                    ,A.VEH_NBR                                    57650062
576600                    ,A.AUTH_NBR                                   57660062
576700                    ,A.AUTH_DTE                                   57670062
576800                    ,A.CONFIRM_DTE                                57680062
576900                    ,A.CONFIRM_TIME                               57690062
577000                    ,A.COMPLETE_PRO_NBR                           57700062
577100                    ,A.COMPLETE_BOL_NBR                           57710062
577200                    ,A.PROCESSED_DTE                              57720062
577300                    ,A.INVC_NBR                                   57730062
577310                    ,A.CARR_AUTH_ID                               57731064
577400            INTO     :SHIPMT-TRIP-ID                              57740062
577500                       :DN-TRIP-ID                                57750062
577600                    ,:SHIPMT-SHIPT-ID                             57760062
577700                    ,:SHIPMT-CRT-SRC-CDE                          57770062
577800                    ,:SHIPMT-LAST-UPD-DTE                         57780062
577900                    ,:SHIPMT-LAST-UPD-TME                         57790062
578000                    ,:SHIPMT-LAST-UPD-UID                         57800062
578100                    ,:SHIPMT-PRO-SCAC-ID                          57810062
578200                    ,:SHIPMT-PRO-NBR                              57820062
578300                    ,:SHIPMT-BOL-NBR                              57830062
578400                    ,:SHIPMT-SHIPPER-NME                          57840062
578500                    ,:SHIPMT-SHIPT-TYP-CDE                        57850062
578600                    ,:SHIPMT-EXPTED-GRO-WGHT                      57860062
578700                    ,:SHIPMT-PKG-TYP-CDE                          57870062
578800                    ,:SHIPMT-EXPTED-PKG-QTY                       57880062
578900                    ,:SHIPMT-FRGT-CHG-AMT                         57890062
579000                    ,:SHIPMT-FRGT-TERMS-CDE                       57900062
579100                    ,:SHIPMT-EXPTED-PLT-QTY                       57910062
579200                    ,:SHIPMT-VEND-SHIP-DTE                        57920062
579300                    ,:SHIPMT-EST-AR-TMST                          57930062
579400                       :DN-EST-AR-TMST                            57940062
579500                    ,:SHIPMT-ORIG-SCAC-ID                         57950062
579600                    ,:SHIPMT-LAST-UPD-PGM-ID                      57960062
579700                    ,:SHIPMT-CRE-USER-ID                          57970062
579800                    ,:SHIPMT-CARR-CART-CT                         57980062
579900                    ,:SHIPMT-CARR-LAST-UPD-DTE                    57990062
580000                    ,:SHIPMT-CARR-LAST-UPD-TIME                   58000062
580100                    ,:SHIPMT-VEND-CART-CT                         58010062
580200                    ,:SHIPMT-VEND-LAST-UPD-DTE                    58020062
580300                    ,:SHIPMT-VEND-LAST-UPD-TIME                   58030062
580400                    ,:SHIPMT-VEH-NBR                              58040062
580500                    ,:SHIPMT-AUTH-NBR                             58050062
580600                    ,:SHIPMT-AUTH-DTE                             58060062
580700                    ,:SHIPMT-CONFIRM-DTE                          58070062
580800                    ,:SHIPMT-CONFIRM-TIME                         58080062
580900                    ,:SHIPMT-COMPLETE-PRO-NBR                     58090062
581000                    ,:SHIPMT-COMPLETE-BOL-NBR                     58100062
581100                    ,:SHIPMT-PROCESSED-DTE                        58110062
581200                    ,:SHIPMT-INVC-NBR                             58120062
581210                    ,:SHIPMT-CARR-AUTH-ID                         58121062
581300           FROM   TSHIPMT A                                       58130062
581400           WHERE  A.SHIPT_ID         = :SHIPMT-SHIPT-ID           58140062
581500         END-EXEC                                                 58150062
581600                                                                  58160062
581700         EVALUATE TRUE                                            58170062
581800             WHEN SQLCODE = +0                                    58180062
581900             WHEN SQLCODE = -904                                  58190062
582000             WHEN SQLCODE = -913                                  58200062
582100                 CONTINUE                                         58210062
582200                                                                  58220062
582300             WHEN SQLWARN0 NOT = SPACES                           58230062
582400             WHEN SQLCODE < +0                                    58240062
582500             WHEN SQLCODE > +0                                    58250062
582600                 MOVE '5025-INSERT-TAUSHIP'                       58260062
582700                                   TO DP013-PARAGRAPH             58270062
582800                 MOVE 'SELECT A TSHIPMT ROW   '                   58280062
582900                                   TO DP013-MESSAGE-TEXT(1)       58290062
583000                 MOVE SHIPMT-SHIPT-ID TO DP013-MESSAGE-TEXT(2)    58300062
583100                 MOVE SQLCA        TO DP013-SQLCA                 58310062
583200                 MOVE 'TSHIPMT'    TO DP013-DB2-TABLE-NAME (1)    58320062
583300                 SET DP013-DB2-ABEND                              58330062
583400                     DP013-XCTL-DISPLAY-RESTART TO TRUE           58340062
583500                 PERFORM DP013-0000-PROCESS-ABEND                 58350062
583600         END-EVALUATE                                             58360062
583700     END-PERFORM.                                                 58370062
583800                                                                  58380062
583900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    58390062
584000         SQLCODE NOT = +0                                         58400062
584100         MOVE '5025-INSERT-TAUSHIP'                               58410062
584200                                   TO DP013-PARAGRAPH             58420062
584300         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              58430062
584400                                   TO DP013-MESSAGE-TEXT (1)      58440062
584500         MOVE 'TO SELECT A TSHIPMT ROW'                           58450062
584600                                   TO DP013-MESSAGE-TEXT (2)      58460062
584700         MOVE SQLCA                TO DP013-SQLCA                 58470062
584800         MOVE 'TSHIPMT'            TO DP013-DB2-TABLE-NAME (1)    58480062
584900         SET DP013-DB2-ABEND                                      58490062
585000             DP013-XCTL-DISPLAY-RESTART                           58500062
585100                                   TO TRUE                        58510062
585200         PERFORM DP013-0000-PROCESS-ABEND                         58520062
585300     END-IF.                                                      58530062
585400                                                                  58540062
585500     PERFORM                                                      58550062
585600         WITH TEST AFTER                                          58560062
585700         VARYING PV-RETRY-COUNTER                                 58570062
585800         FROM 1 BY 1                                              58580062
585900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               58590062
586000             OR (SQLCODE = +0))                                   58600062
586100                                                                  58610062
586200         EXEC SQL                                                 58620062
586300             INSERT  INTO TAUSHIP                                 58630062
586400                    (TRIP_ID                                      58640062
586500                    ,SHIPT_ID                                     58650062
586600                    ,CRT_SRC_CDE                                  58660062
586700                    ,LAST_UPD_DTE                                 58670062
586800                    ,LAST_UPD_TME                                 58680062
586900                    ,LAST_UPD_UID                                 58690062
587000                    ,PRO_SCAC_ID                                  58700062
587100                    ,PRO_NBR                                      58710062
587200                    ,BOL_NBR                                      58720062
587300                    ,SHIPPER_NME                                  58730062
587400                    ,SHIPT_TYP_CDE                                58740062
587500                    ,EXPTED_GRO_WGHT                              58750062
587600                    ,PKG_TYP_CDE                                  58760062
587700                    ,EXPTED_PKG_QTY                               58770062
587800                    ,FRGT_CHG_AMT                                 58780062
587900                    ,FRGT_TERMS_CDE                               58790062
588000                    ,EST_AR_TMST                                  58800062
588100                    ,VEND_SHIP_DTE                                58810062
588200                    ,EXPTED_PLT_QTY                               58820062
588300                    ,ORIG_SCAC_ID                                 58830062
588400                    ,LAST_UPD_PGM_ID                              58840062
588500                    ,CRE_USER_ID                                  58850062
588600                    ,CARR_CART_CT                                 58860062
588700                    ,CARR_LAST_UPD_DTE                            58870062
588800                    ,CARR_LAST_UPD_TIME                           58880062
588900                    ,VEND_CART_CT                                 58890062
589000                    ,VEND_LAST_UPD_DTE                            58900062
589100                    ,VEND_LAST_UPD_TIME                           58910062
589200                    ,VEH_NBR                                      58920062
589300                    ,AUTH_NBR                                     58930062
589400                    ,AUTH_DTE                                     58940062
589500                    ,CONFIRM_DTE                                  58950062
589600                    ,CONFIRM_TIME                                 58960062
589700                    ,AUD_STATUS_CDE                               58970062
589800                    ,PROCESSED_DTE                                58980062
589900                    ,INVC_NBR )                                   58990062
590000            VALUES  (:SHIPMT-TRIP-ID                              59000062
590100                       :DN-TRIP-ID                                59010062
590200                    ,:SHIPMT-SHIPT-ID                             59020062
590300                    ,:SHIPMT-CRT-SRC-CDE                          59030062
590400                    ,:SHIPMT-LAST-UPD-DTE                         59040062
590500                    ,:SHIPMT-LAST-UPD-TME                         59050062
590600                    ,:SHIPMT-LAST-UPD-UID                         59060062
590700                    ,:SHIPMT-PRO-SCAC-ID                          59070062
590800                    ,:SHIPMT-COMPLETE-PRO-NBR                     59080062
590900                    ,:SHIPMT-COMPLETE-BOL-NBR                     59090062
591000                    ,:SHIPMT-SHIPPER-NME                          59100062
591100                    ,:SHIPMT-SHIPT-TYP-CDE                        59110062
591200                    ,:SHIPMT-EXPTED-GRO-WGHT                      59120062
591300                    ,:SHIPMT-PKG-TYP-CDE                          59130062
591400                    ,:SHIPMT-EXPTED-PKG-QTY                       59140062
591500                    ,:SHIPMT-FRGT-CHG-AMT                         59150062
591600                    ,:SHIPMT-FRGT-TERMS-CDE                       59160062
591700                    ,:SHIPMT-EST-AR-TMST                          59170062
591800                       :DN-EST-AR-TMST                            59180062
591900                    ,:SHIPMT-VEND-SHIP-DTE                        59190062
592000                    ,:SHIPMT-EXPTED-PLT-QTY                       59200062
592100                    ,:SHIPMT-ORIG-SCAC-ID                         59210062
592200                    ,:SHIPMT-LAST-UPD-PGM-ID                      59220062
592300                    ,:SHIPMT-CRE-USER-ID                          59230062
592400                    ,:SHIPMT-CARR-CART-CT                         59240062
592500                    ,:SHIPMT-CARR-LAST-UPD-DTE                    59250062
592600                    ,:SHIPMT-CARR-LAST-UPD-TIME                   59260062
592700                    ,:SHIPMT-VEND-CART-CT                         59270062
592800                    ,:SHIPMT-VEND-LAST-UPD-DTE                    59280062
592900                    ,:SHIPMT-VEND-LAST-UPD-TIME                   59290062
593000                    ,:SHIPMT-VEH-NBR                              59300062
593100                    ,:SHIPMT-AUTH-NBR                             59310062
593200                    ,:SHIPMT-AUTH-DTE                             59320062
593300                    ,:SHIPMT-CONFIRM-DTE                          59330062
593400                    ,:SHIPMT-CONFIRM-TIME                         59340062
593500                    ,:SHIPST-SHIPT-STATUS-CDE                     59350062
593600                    ,:SHIPMT-PROCESSED-DTE                        59360062
593700                    ,:SHIPMT-INVC-NBR )                           59370062
593800         END-EXEC                                                 59380062
593900                                                                  59390062
594000                                                                  59400062
594100         EVALUATE TRUE                                            59410062
594200             WHEN SQLCODE = +0                                    59420062
594300             WHEN SQLCODE = -904                                  59430062
594400             WHEN SQLCODE = -913                                  59440062
594500                 CONTINUE                                         59450062
594600                                                                  59460062
594700             WHEN SQLWARN0 NOT = SPACES                           59470062
594800             WHEN SQLCODE < +0                                    59480062
594900             WHEN SQLCODE > +0                                    59490062
595000                 MOVE '5025-INSERT-TAUSHIP'                       59500062
595100                                   TO DP013-PARAGRAPH             59510062
595200                 MOVE 'INSERT A ROW ON TAUSHIP'                   59520062
595300                                   TO DP013-MESSAGE-TEXT(1)       59530062
595400                 MOVE SHIPMT-SHIPT-ID TO DP013-MESSAGE-TEXT(2)    59540062
595500                 MOVE SQLCA        TO DP013-SQLCA                 59550062
595600                 MOVE 'TAUSHIP'    TO DP013-DB2-TABLE-NAME (1)    59560062
595700                 SET DP013-DB2-ABEND                              59570062
595800                     DP013-XCTL-DISPLAY-RESTART TO TRUE           59580062
595900                 PERFORM DP013-0000-PROCESS-ABEND                 59590062
596000         END-EVALUATE                                             59600062
596100     END-PERFORM.                                                 59610062
596200                                                                  59620062
596300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    59630062
596400         SQLCODE NOT = +0                                         59640062
596500         MOVE '5025-INSERT-TAUSHIP'                               59650062
596600                                   TO DP013-PARAGRAPH             59660062
596700         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              59670062
596800                                   TO DP013-MESSAGE-TEXT (1)      59680062
596900         MOVE 'TO INSERT A TAUSHIP ROW'                           59690062
597000                                   TO DP013-MESSAGE-TEXT (2)      59700062
597100         MOVE SQLCA                TO DP013-SQLCA                 59710062
597200         MOVE 'TAUSHIP'            TO DP013-DB2-TABLE-NAME (1)    59720062
597300         SET DP013-DB2-ABEND                                      59730062
597400             DP013-XCTL-DISPLAY-RESTART                           59740062
597500                                   TO TRUE                        59750062
597600         PERFORM DP013-0000-PROCESS-ABEND                         59760062
597700     END-IF.                                                      59770062
597800                                                                  59780062
597900*----------------------------------------------------------------*59790062
598000*  INSERT A ROW TO THE TRIP STATUS TABLE                          59800062
598100*                                                                 59810062
598200*  PERFORMED FROM 5010-INSERT-TVHTRIP.                            59820062
598300*----------------------------------------------------------------*59830062
598400 5030-INSERT-TTRIPST.                                             59840062
598500                                                                  59850062
598600     INITIALIZE DCLTTRIPST.                                       59860062
598700                                                                  59870062
598800     MOVE ASC-TRIP-ID              TO TRIPST-TRIP-ID.             59880062
598900     MOVE 'EN'                     TO TRIPST-TRIP-STATUS-CDE.     59890062
599000     MOVE ASC-OPER-UNT-ID          TO TRIPST-OPER-UNT-ID.         59900062
599100     MOVE ASC-FCLTY-ID             TO TRIPST-FCLTY-ID.            59910062
599200     MOVE SPACES                   TO TRIPST-FCLTY-AREA-ID.       59920062
599300                                                                  59930062
599400     PERFORM                                                      59940062
599500         WITH TEST AFTER                                          59950062
599600         VARYING PV-RETRY-COUNTER                                 59960062
599700         FROM 1 BY 1                                              59970062
599800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               59980062
599900             OR (SQLCODE = +0))                                   59990062
600000                                                                  60000062
600100         EXEC SQL                                                 60010062
600200             INSERT  INTO TTRIPST                                 60020062
600300                   ( TRIP_ID                                      60030062
600400                    ,TRIP_STATUS_CDE                              60040062
600500                    ,STATUS_UID                                   60050062
600600                    ,OPER_UNT_ID                                  60060062
600700                    ,FCLTY_ID                                     60070062
600800                    ,FCLTY_AREA_ID )                              60080062
600900             VALUES                                               60090062
601000                   ( :TRIPST-TRIP-ID                              60100062
601100                    ,:TRIPST-TRIP-STATUS-CDE                      60110062
601200                    ,:DP020-USERID                                60120062
601300                    ,:TRIPST-OPER-UNT-ID                          60130062
601400                    ,:TRIPST-FCLTY-ID                             60140062
601500                    ,:TRIPST-FCLTY-AREA-ID )                      60150062
601600         END-EXEC                                                 60160062
601700                                                                  60170062
601800         EVALUATE TRUE                                            60180062
601900             WHEN SQLCODE = +0                                    60190062
602000             WHEN SQLCODE = -904                                  60200062
602100             WHEN SQLCODE = -913                                  60210062
602200                 CONTINUE                                         60220062
602300                                                                  60230062
602400             WHEN SQLWARN0 NOT = SPACES                           60240062
602500             WHEN SQLCODE < +0                                    60250062
602600             WHEN SQLCODE > +0                                    60260062
602700                 MOVE SPACES TO PV-MESSAGE                        60270062
602800                 MOVE TRIPST-TRIP-ID TO PV-MESSAGE1               60280062
602900                 MOVE TRIPST-TRIP-STATUS-CDE TO PV-MESSAGE2       60290062
603000                 MOVE '5030-INSERT-TTRIPST'                       60300062
603100                                   TO DP013-PARAGRAPH             60310062
603200                 MOVE 'INSERT A ROW ON TTRIPST'                   60320062
603300                                   TO DP013-MESSAGE-TEXT(1)       60330062
603400                 MOVE PV-MESSAGE   TO DP013-MESSAGE-TEXT(2)       60340062
603500                 MOVE SQLCA        TO DP013-SQLCA                 60350062
603600                 MOVE 'TTRIPST'    TO DP013-DB2-TABLE-NAME (1)    60360062
603700                 SET DP013-DB2-ABEND                              60370062
603800                     DP013-XCTL-DISPLAY-RESTART TO TRUE           60380062
603900                 PERFORM DP013-0000-PROCESS-ABEND                 60390062
604000         END-EVALUATE                                             60400062
604100     END-PERFORM.                                                 60410062
604200                                                                  60420062
604300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    60430062
604400         SQLCODE NOT = +0                                         60440062
604500         MOVE '5030-INSERT-TTRIPST'                               60450062
604600                                   TO DP013-PARAGRAPH             60460062
604700         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              60470062
604800                                   TO DP013-MESSAGE-TEXT (1)      60480062
604900         MOVE 'TO INSERT A TTRIPST ROW'                           60490062
605000                                   TO DP013-MESSAGE-TEXT (2)      60500062
605100         MOVE SQLCA                TO DP013-SQLCA                 60510062
605200         MOVE 'TTRIPST'            TO DP013-DB2-TABLE-NAME (1)    60520062
605300         SET DP013-DB2-ABEND                                      60530062
605400             DP013-XCTL-DISPLAY-RESTART                           60540062
605500                                   TO TRUE                        60550062
605600         PERFORM DP013-0000-PROCESS-ABEND                         60560062
605700     END-IF.                                                      60570062
605800                                                                  60580062
605900*----------------------------------------------------------------*60590062
606000*  INSERT A ROW TO THE SHIPMENT STATUS TABLE                      60600062
606100*                                                                 60610062
606200*  PERFORMED FROM 5020-INSERT-TSHIPST.                            60620062
606300*----------------------------------------------------------------*60630062
606400 5040-INSERT-TSHIPST.                                             60640062
606500                                                                  60650062
606600     INITIALIZE DCLTSHIPST.                                       60660062
606700                                                                  60670062
606800     MOVE ASC-SHIPT-ID             TO SHIPST-SHIPT-ID.            60680062
606900     MOVE 'EN'                     TO SHIPST-SHIPT-STATUS-CDE.    60690062
607000                                                                  60700062
607100     PERFORM                                                      60710062
607200         WITH TEST AFTER                                          60720062
607300         VARYING PV-RETRY-COUNTER                                 60730062
607400         FROM 1 BY 1                                              60740062
607500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               60750062
607600             OR (SQLCODE = +0))                                   60760062
607700                                                                  60770062
607800         EXEC SQL                                                 60780062
607900             INSERT  INTO TSHIPST                                 60790062
608000                   ( SHIPT_ID                                     60800062
608100                    ,SHIPT_STATUS_CDE                             60810062
608200                    ,STATUS_UID )                                 60820062
608300             VALUES                                               60830062
608400                   ( :SHIPST-SHIPT-ID                             60840062
608500                    ,:SHIPST-SHIPT-STATUS-CDE                     60850062
608600                    ,:DP020-USERID )                              60860062
608700         END-EXEC                                                 60870062
608800                                                                  60880062
608900         EVALUATE TRUE                                            60890062
609000             WHEN SQLCODE = +0                                    60900062
609100             WHEN SQLCODE = -904                                  60910062
609200             WHEN SQLCODE = -913                                  60920062
609300                 CONTINUE                                         60930062
609400                                                                  60940062
609500             WHEN SQLWARN0 NOT = SPACES                           60950062
609600             WHEN SQLCODE < +0                                    60960062
609700             WHEN SQLCODE > +0                                    60970062
609800                 MOVE SPACES TO PV-MESSAGE                        60980062
609900                 MOVE SHIPST-SHIPT-ID TO PV-MESSAGE1              60990062
610000                 MOVE SHIPST-SHIPT-STATUS-CDE TO PV-MESSAGE2      61000062
610100                 MOVE '5040-INSERT-TSHIPST'                       61010062
610200                                   TO DP013-PARAGRAPH             61020062
610300                 MOVE 'INSERT A ROW ON TSHIPST'                   61030062
610400                                   TO DP013-MESSAGE-TEXT(1)       61040062
610500                 MOVE PV-MESSAGE   TO DP013-MESSAGE-TEXT(2)       61050062
610600                 MOVE SQLCA        TO DP013-SQLCA                 61060062
610700                 MOVE 'TSHIPST'    TO DP013-DB2-TABLE-NAME (1)    61070062
610800                 SET DP013-DB2-ABEND                              61080062
610900                     DP013-XCTL-DISPLAY-RESTART TO TRUE           61090062
611000                 PERFORM DP013-0000-PROCESS-ABEND                 61100062
611100         END-EVALUATE                                             61110062
611200     END-PERFORM.                                                 61120062
611300                                                                  61130062
611400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    61140062
611500         SQLCODE NOT = +0                                         61150062
611600         MOVE '5040-INSERT-TSHIPST'                               61160062
611700                                   TO DP013-PARAGRAPH             61170062
611800         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              61180062
611900                                   TO DP013-MESSAGE-TEXT (1)      61190062
612000         MOVE 'TO INSERT A TSHIPST ROW'                           61200062
612100                                   TO DP013-MESSAGE-TEXT (2)      61210062
612200         MOVE SQLCA                TO DP013-SQLCA                 61220062
612300         MOVE 'TSHIPST'            TO DP013-DB2-TABLE-NAME (1)    61230062
612400         SET DP013-DB2-ABEND                                      61240062
612500             DP013-XCTL-DISPLAY-RESTART                           61250062
612600                                   TO TRUE                        61260062
612700         PERFORM DP013-0000-PROCESS-ABEND                         61270062
612800     END-IF.                                                      61280062
612900                                                                  61290062
613000 EJECT                                                            61300062
613100*----------------------------------------------------------------*61310062
613200*  INSERT A ROW TO THE VEHICLE TABLE                              61320062
613300*                                                                 61330062
613400*  PERFORMED FROM 2100-CHECK-FUNCTION-KEY                         61340062
613500*----------------------------------------------------------------*61350062
613600 5050-INSERT-TVEHICL.                                             61360062
613700                                                                  61370062
613800     INITIALIZE DCLTVEHICL.                                       61380062
613900                                                                  61390062
614000     MOVE ASC-PRO-SCAC-ID          TO VEHICL-OWNER-SCAC-ID        61400062
614100                                      DK-SCAC.                    61410062
614200     MOVE ASC-VEH-NBR              TO VEHICL-VEH-NBR              61420062
614300                                      DK-VEH-NBR.                 61430062
614400     MOVE 'CE'                     TO VEHICL-CRT-SRC-CDE.         61440062
614500     MOVE 'RCV'                    TO VEHICL-USAGE-CDE.           61450062
614600     MOVE 'TR'                     TO VEHICL-VEH-TYP-CDE.         61460062
614700     MOVE 'EN'                     TO VEHICL-CURR-STATUS-CDE.     61470062
614800     MOVE ASC-OPER-UNT-ID          TO VEHICL-CURR-OPER-UNT-ID.    61480062
614900     MOVE ASC-FCLTY-ID             TO VEHICL-CURR-FCLTY-ID.       61490062
615000     MOVE ASC-TRIP-ID              TO VEHICL-CURR-TRIP-ID.        61500062
615100     MOVE +1                       TO DN-TRIP-ID.                 61510062
615200                                                                  61520062
615300     PERFORM                                                      61530062
615400         WITH TEST AFTER                                          61540062
615500         VARYING PV-RETRY-COUNTER                                 61550062
615600         FROM 1 BY 1                                              61560062
615700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               61570062
615800             OR (SQLCODE = +0))                                   61580062
615900                                                                  61590062
616000         EXEC SQL                                                 61600062
616100             INSERT  INTO TVEHICL                                 61610062
616200                   ( OWNER_SCAC_ID                                61620062
616300                    ,VEH_NBR                                      61630062
616400                    ,CRT_SRC_CDE                                  61640062
616500                    ,LAST_UPD_UID                                 61650062
616600                    ,USAGE_CDE                                    61660062
616700                    ,VEH_TYP_CDE                                  61670062
616800                    ,CURR_STATUS_CDE                              61680062
616900                    ,CURR_STATUS_DTE                              61690062
617000                    ,CURR_STATUS_TME                              61700062
617100                    ,CURR_OPER_UNT_ID                             61710062
617200                    ,CURR_FCLTY_ID                                61720062
617300                    ,CURR_TRIP_ID )                               61730062
617400             VALUES                                               61740062
617500                   ( :VEHICL-OWNER-SCAC-ID                        61750062
617600                    ,:VEHICL-VEH-NBR                              61760062
617700                    ,:VEHICL-CRT-SRC-CDE                          61770062
617800                    ,:DP020-USERID                                61780062
617900                    ,:VEHICL-USAGE-CDE                            61790062
618000                    ,:VEHICL-VEH-TYP-CDE                          61800062
618100                    ,:VEHICL-CURR-STATUS-CDE                      61810062
618200                    ,CURRENT DATE                                 61820062
618300                    ,CURRENT TIME                                 61830062
618400                    ,:VEHICL-CURR-OPER-UNT-ID                     61840062
618500                    ,:VEHICL-CURR-FCLTY-ID                        61850062
618600                    ,:VEHICL-CURR-TRIP-ID :DN-TRIP-ID)            61860062
618700         END-EXEC                                                 61870062
618800                                                                  61880062
618900         EVALUATE TRUE                                            61890062
619000             WHEN SQLCODE = +0                                    61900062
619100             WHEN SQLCODE = -904                                  61910062
619200             WHEN SQLCODE = -913                                  61920062
619300                 CONTINUE                                         61930062
619400                                                                  61940062
619500             WHEN SQLWARN0 NOT = SPACES                           61950062
619600             WHEN SQLCODE < +0                                    61960062
619700             WHEN SQLCODE > +0                                    61970062
619800                 MOVE SPACES TO PV-MESSAGE                        61980062
619900                 MOVE VEHICL-OWNER-SCAC-ID TO PV-MESSAGE1         61990062
620000                 MOVE VEHICL-VEH-NBR       TO PV-MESSAGE2         62000062
620100                 MOVE '5050-INSERT-TVEHICL'                       62010062
620200                                   TO DP013-PARAGRAPH             62020062
620300                 MOVE 'INSERT A ROW ON TVEHICL'                   62030062
620400                                   TO DP013-MESSAGE-TEXT(1)       62040062
620500                 MOVE PV-MESSAGE   TO DP013-MESSAGE-TEXT(2)       62050062
620600                 MOVE SQLCA        TO DP013-SQLCA                 62060062
620700                 MOVE 'TVEHICL'    TO DP013-DB2-TABLE-NAME (1)    62070062
620800                 SET DP013-DB2-ABEND                              62080062
620900                     DP013-XCTL-DISPLAY-RESTART TO TRUE           62090062
621000                 PERFORM DP013-0000-PROCESS-ABEND                 62100062
621100         END-EVALUATE                                             62110062
621200     END-PERFORM.                                                 62120062
621300                                                                  62130062
621400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    62140062
621500         SQLCODE NOT = +0                                         62150062
621600         MOVE '5050-INSERT-TVEHICL'                               62160062
621700                                   TO DP013-PARAGRAPH             62170062
621800         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              62180062
621900                                   TO DP013-MESSAGE-TEXT (1)      62190062
622000         MOVE 'TO INSERT A TVEHICL ROW'                           62200062
622100                                   TO DP013-MESSAGE-TEXT (2)      62210062
622200         MOVE SQLCA                TO DP013-SQLCA                 62220062
622300         MOVE 'TVEHICL'            TO DP013-DB2-TABLE-NAME (1)    62230062
622400         SET DP013-DB2-ABEND                                      62240062
622500             DP013-XCTL-DISPLAY-RESTART                           62250062
622600                                   TO TRUE                        62260062
622700         PERFORM DP013-0000-PROCESS-ABEND                         62270062
622800     END-IF.                                                      62280062
622900                                                                  62290062
623000     IF SQLCODE = ZERO                                            62300062
623100        PERFORM 5055-INSERT-TAUVHCL                               62310062
623200     END-IF.                                                      62320062
623300 EJECT                                                            62330062
623400*----------------------------------------------------------------*62340062
623500*  INSERT A ROW TO THE VEHICLE AUDIT TABLE                        62350062
623600*                                                                 62360062
623700*  PERFORMED FROM 5050-INSERT-TVEHICL                             62370062
623800*----------------------------------------------------------------*62380062
623900 5055-INSERT-TAUVHCL.                                             62390062
624000                                                                  62400062
624100     INITIALIZE DCLTAUVHCL.                                       62410062
624200                                                                  62420062
624300     PERFORM                                                      62430062
624400         WITH TEST AFTER                                          62440062
624500         VARYING PV-RETRY-COUNTER                                 62450062
624600         FROM 1 BY 1                                              62460062
624700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               62470062
624800             OR (SQLCODE = +0))                                   62480062
624900                                                                  62490062
625000         EXEC SQL                                                 62500062
625100             SELECT  OWNER_SCAC_ID                                62510062
625200                    ,VEH_NBR                                      62520062
625300                    ,CRT_SRC_CDE                                  62530062
625400                    ,LAST_UPD_DTE                                 62540062
625500                    ,LAST_UPD_TME                                 62550062
625600                    ,LAST_UPD_UID                                 62560062
625700                    ,USAGE_CDE                                    62570062
625800                    ,VEH_TYP_CDE                                  62580062
625900                    ,CURR_STATUS_CDE                              62590062
626000                    ,CURR_STATUS_DTE                              62600062
626100                    ,CURR_STATUS_TME                              62610062
626200                    ,CURR_OPER_UNT_ID                             62620062
626300                    ,CURR_FCLTY_ID                                62630062
626400                    ,CURR_FAC_AREA_ID                             62640062
626500                    ,CURR_LOC_DTE                                 62650062
626600                    ,CURR_LOC_TME                                 62660062
626700                    ,CURR_TRIP_ID                                 62670062
626800                    ,VEH_SIZE_CDE                                 62680062
626900            INTO     :VEHICL-OWNER-SCAC-ID                        62690062
627000                    ,:VEHICL-VEH-NBR                              62700062
627100                    ,:VEHICL-CRT-SRC-CDE                          62710062
627200                    ,:VEHICL-LAST-UPD-DTE                         62720062
627300                    ,:VEHICL-LAST-UPD-TME                         62730062
627400                    ,:VEHICL-LAST-UPD-UID                         62740062
627500                    ,:VEHICL-USAGE-CDE                            62750062
627600                    ,:VEHICL-VEH-TYP-CDE                          62760062
627700                    ,:VEHICL-CURR-STATUS-CDE                      62770062
627800                    ,:VEHICL-CURR-STATUS-DTE                      62780062
627900                    ,:VEHICL-CURR-STATUS-TME                      62790062
628000                    ,:VEHICL-CURR-OPER-UNT-ID                     62800062
628100                    ,:VEHICL-CURR-FCLTY-ID                        62810062
628200                    ,:VEHICL-CURR-FAC-AREA-ID                     62820062
628300                    ,:VEHICL-CURR-LOC-DTE                         62830062
628400                    ,:VEHICL-CURR-LOC-TME                         62840062
628500                    ,:VEHICL-CURR-TRIP-ID                         62850062
628600                       :DN-CURR-TRIP-ID                           62860062
628700                    ,:VEHICL-VEH-SIZE-CDE                         62870062
628800           FROM   TVEHICL                                         62880062
628900           WHERE  VEH_NBR       = :DK-VEH-NBR                     62890062
629000             AND  OWNER_SCAC_ID = :DK-SCAC                        62900062
629100         END-EXEC                                                 62910062
629200                                                                  62920062
629300         EVALUATE TRUE                                            62930062
629400             WHEN SQLCODE = +0                                    62940062
629500             WHEN SQLCODE = -904                                  62950062
629600             WHEN SQLCODE = -913                                  62960062
629700                 CONTINUE                                         62970062
629800                                                                  62980062
629900             WHEN SQLWARN0 NOT = SPACES                           62990062
630000             WHEN SQLCODE < +0                                    63000062
630100             WHEN SQLCODE > +0                                    63010062
630200                 MOVE SPACES TO PV-MESSAGE                        63020062
630300                 MOVE DK-VEH-NBR TO PV-MESSAGE1                   63030062
630400                 MOVE DK-SCAC    TO PV-MESSAGE2                   63040062
630500                 MOVE '5055-INSERT-TAUVHCL'                       63050062
630600                                   TO DP013-PARAGRAPH             63060062
630700                 MOVE 'SELECT A TVEHICL ROW   '                   63070062
630800                                   TO DP013-MESSAGE-TEXT(1)       63080062
630900                 MOVE PV-MESSAGE   TO DP013-MESSAGE-TEXT(2)       63090062
631000                 MOVE SQLCA        TO DP013-SQLCA                 63100062
631100                 MOVE 'TVEHICL'    TO DP013-DB2-TABLE-NAME (1)    63110062
631200                 SET DP013-DB2-ABEND                              63120062
631300                     DP013-XCTL-DISPLAY-RESTART TO TRUE           63130062
631400                 PERFORM DP013-0000-PROCESS-ABEND                 63140062
631500         END-EVALUATE                                             63150062
631600     END-PERFORM.                                                 63160062
631700                                                                  63170062
631800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    63180062
631900         SQLCODE NOT = +0                                         63190062
632000         MOVE '5055-INSERT-TAUVHCL'                               63200062
632100                                   TO DP013-PARAGRAPH             63210062
632200         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              63220062
632300                                   TO DP013-MESSAGE-TEXT (1)      63230062
632400         MOVE 'TO SELECT A TVEHICL ROW'                           63240062
632500                                   TO DP013-MESSAGE-TEXT (2)      63250062
632600         MOVE SQLCA                TO DP013-SQLCA                 63260062
632700         MOVE 'TVEHICL'            TO DP013-DB2-TABLE-NAME (1)    63270062
632800         SET DP013-DB2-ABEND                                      63280062
632900             DP013-XCTL-DISPLAY-RESTART                           63290062
633000                                   TO TRUE                        63300062
633100         PERFORM DP013-0000-PROCESS-ABEND                         63310062
633200     END-IF.                                                      63320062
633300                                                                  63330062
633400                                                                  63340062
633500     PERFORM                                                      63350062
633600         WITH TEST AFTER                                          63360062
633700         VARYING PV-RETRY-COUNTER                                 63370062
633800         FROM 1 BY 1                                              63380062
633900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               63390062
634000             OR (SQLCODE = +0))                                   63400062
634100                                                                  63410062
634200         EXEC SQL                                                 63420062
634300             INSERT  INTO TAUVHCL                                 63430062
634400                    (OWNER_SCAC_ID                                63440062
634500                    ,VEH_NBR                                      63450062
634600                    ,CRT_SRC_CDE                                  63460062
634700                    ,LAST_UPD_DTE                                 63470062
634800                    ,LAST_UPD_TME                                 63480062
634900                    ,LAST_UPD_UID                                 63490062
635000                    ,USAGE_CDE                                    63500062
635100                    ,VEH_TYP_CDE                                  63510062
635200                    ,CURR_STATUS_CDE                              63520062
635300                    ,CURR_STATUS_DTE                              63530062
635400                    ,CURR_STATUS_TME                              63540062
635500                    ,CURR_OPER_UNT_ID                             63550062
635600                    ,CURR_FCLTY_ID                                63560062
635700                    ,CURR_FAC_AREA_ID                             63570062
635800                    ,CURR_LOC_DTE                                 63580062
635900                    ,CURR_LOC_TME                                 63590062
636000                    ,CURR_TRIP_ID                                 63600062
636100                    ,VEH_SIZE_CDE)                                63610062
636200            VALUES  (:VEHICL-OWNER-SCAC-ID                        63620062
636300                    ,:VEHICL-VEH-NBR                              63630062
636400                    ,:VEHICL-CRT-SRC-CDE                          63640062
636500                    ,:VEHICL-LAST-UPD-DTE                         63650062
636600                    ,:VEHICL-LAST-UPD-TME                         63660062
636700                    ,:VEHICL-LAST-UPD-UID                         63670062
636800                    ,:VEHICL-USAGE-CDE                            63680062
636900                    ,:VEHICL-VEH-TYP-CDE                          63690062
637000                    ,:VEHICL-CURR-STATUS-CDE                      63700062
637100                    ,:VEHICL-CURR-STATUS-DTE                      63710062
637200                    ,:VEHICL-CURR-STATUS-TME                      63720062
637300                    ,:VEHICL-CURR-OPER-UNT-ID                     63730062
637400                    ,:VEHICL-CURR-FCLTY-ID                        63740062
637500                    ,:VEHICL-CURR-FAC-AREA-ID                     63750062
637600                    ,:VEHICL-CURR-LOC-DTE                         63760062
637700                    ,:VEHICL-CURR-LOC-TME                         63770062
637800                    ,:VEHICL-CURR-TRIP-ID                         63780062
637900                       :DN-CURR-TRIP-ID                           63790062
638000                    ,:VEHICL-VEH-SIZE-CDE)                        63800062
638100         END-EXEC                                                 63810062
638200                                                                  63820062
638300         EVALUATE TRUE                                            63830062
638400             WHEN SQLCODE = +0                                    63840062
638500             WHEN SQLCODE = -904                                  63850062
638600             WHEN SQLCODE = -913                                  63860062
638700                 CONTINUE                                         63870062
638800                                                                  63880062
638900             WHEN SQLWARN0 NOT = SPACES                           63890062
639000             WHEN SQLCODE < +0                                    63900062
639100             WHEN SQLCODE > +0                                    63910062
639200                 MOVE SPACES TO PV-MESSAGE                        63920062
639300                 MOVE DK-VEH-NBR TO PV-MESSAGE1                   63930062
639400                 MOVE DK-SCAC    TO PV-MESSAGE2                   63940062
639500                 MOVE '5055-INSERT-TAUVHCL'                       63950062
639600                                   TO DP013-PARAGRAPH             63960062
639700                 MOVE 'INSERT A ROW ON TAUVHCL'                   63970062
639800                                   TO DP013-MESSAGE-TEXT(1)       63980062
639900                 MOVE PV-MESSAGE   TO DP013-MESSAGE-TEXT(2)       63990062
640000                 MOVE SQLCA        TO DP013-SQLCA                 64000062
640100                 MOVE 'TAUVHCL'    TO DP013-DB2-TABLE-NAME (1)    64010062
640200                 SET DP013-DB2-ABEND                              64020062
640300                     DP013-XCTL-DISPLAY-RESTART TO TRUE           64030062
640400                 PERFORM DP013-0000-PROCESS-ABEND                 64040062
640500         END-EVALUATE                                             64050062
640600     END-PERFORM.                                                 64060062
640700                                                                  64070062
640800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    64080062
640900         SQLCODE NOT = +0                                         64090062
641000         MOVE '5055-INSERT-TAUVHCL'                               64100062
641100                                   TO DP013-PARAGRAPH             64110062
641200         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              64120062
641300                                   TO DP013-MESSAGE-TEXT (1)      64130062
641400         MOVE 'TO INSERT A TAUVHCL ROW'                           64140062
641500                                   TO DP013-MESSAGE-TEXT (2)      64150062
641600         MOVE SQLCA                TO DP013-SQLCA                 64160062
641700         MOVE 'TAUVHCL'            TO DP013-DB2-TABLE-NAME (1)    64170062
641800         SET DP013-DB2-ABEND                                      64180062
641900             DP013-XCTL-DISPLAY-RESTART                           64190062
642000                                   TO TRUE                        64200062
642100         PERFORM DP013-0000-PROCESS-ABEND                         64210062
642200     END-IF.                                                      64220062
642300                                                                  64230062
642400 EJECT                                                            64240062
642500*----------------------------------------------------------------*64250062
642600*  LINK THE NEW SHIPMENT TO THE VEHICLE BY UPDATING THE CURRENT   64260062
642700*  INFORMATION ON TVEHICL                                         64270062
642800*                                                                 64280062
642900*  PERFORMED FROM 3020-DETERMINE-ADD                              64290062
643000*----------------------------------------------------------------*64300062
643100 5060-UPDATE-TVEHICL.                                             64310062
643200                                                                  64320062
643300     MOVE ASC-OPER-UNT-ID       TO VEHICL-CURR-OPER-UNT-ID.       64330062
643400     MOVE ASC-FCLTY-ID          TO VEHICL-CURR-FCLTY-ID.          64340062
643500                                                                  64350062
643600     PERFORM                                                      64360062
643700         WITH TEST AFTER                                          64370062
643800         VARYING PV-RETRY-COUNTER                                 64380062
643900         FROM 1 BY 1                                              64390062
644000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               64400062
644100             OR (SQLCODE = +0))                                   64410062
644200                                                                  64420062
644300         EXEC SQL                                                 64430062
644400             UPDATE  TVEHICL                                      64440062
644500              SET  LAST_UPD_DTE       =  CURRENT DATE             64450062
644600                  ,LAST_UPD_TME       =  CURRENT TIME             64460062
644700                  ,LAST_UPD_UID       = :DP020-USERID             64470062
644800                  ,CURR_STATUS_CDE    = 'EN'                      64480062
644900                  ,CURR_STATUS_DTE    =  CURRENT DATE             64490062
645000                  ,CURR_STATUS_TME    =  CURRENT TIME             64500062
645100                  ,CURR_OPER_UNT_ID   = :VEHICL-CURR-OPER-UNT-ID  64510062
645200                  ,CURR_FCLTY_ID      = :VEHICL-CURR-FCLTY-ID     64520062
645300                  ,CURR_TRIP_ID       = :ASC-TRIP-ID              64530062
645400              WHERE OWNER_SCAC_ID     = :DK-SCAC                  64540062
645500                AND VEH_NBR           = :ASC-VEH-NBR              64550062
645600         END-EXEC                                                 64560062
645700                                                                  64570062
645800         EVALUATE TRUE                                            64580062
645900             WHEN SQLCODE = +0                                    64590062
646000             WHEN SQLCODE = -904                                  64600062
646100             WHEN SQLCODE = -913                                  64610062
646200                 CONTINUE                                         64620062
646300                                                                  64630062
646400             WHEN SQLWARN0 NOT = SPACES                           64640062
646500             WHEN SQLCODE < +0                                    64650062
646600             WHEN SQLCODE > +0                                    64660062
646700                 MOVE SPACES TO PV-MESSAGE                        64670062
646800                 MOVE DK-SCAC TO PV-MESSAGE1                      64680062
646900                 MOVE ASC-VEH-NBR TO PV-MESSAGE2                  64690062
647000                 MOVE '5060-UPDATE-TVEHICL'                       64700062
647100                                   TO DP013-PARAGRAPH             64710062
647200                 MOVE 'UPDATE A ROW ON TVEHICL'                   64720062
647300                                   TO DP013-MESSAGE-TEXT(1)       64730062
647400                 MOVE PV-MESSAGE   TO DP013-MESSAGE-TEXT(2)       64740062
647500                 MOVE SQLCA        TO DP013-SQLCA                 64750062
647600                 MOVE 'TVEHICL'    TO DP013-DB2-TABLE-NAME (1)    64760062
647700                 SET DP013-DB2-ABEND                              64770062
647800                     DP013-XCTL-DISPLAY-RESTART TO TRUE           64780062
647900                 PERFORM DP013-0000-PROCESS-ABEND                 64790062
648000         END-EVALUATE                                             64800062
648100     END-PERFORM.                                                 64810062
648200                                                                  64820062
648300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    64830062
648400         SQLCODE NOT = +0                                         64840062
648500         MOVE '5060-UPDATE-TVEHICL'                               64850062
648600                                   TO DP013-PARAGRAPH             64860062
648700         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              64870062
648800                                   TO DP013-MESSAGE-TEXT (1)      64880062
648900         MOVE 'TO UPDATE A TVEHICL ROW'                           64890062
649000                                   TO DP013-MESSAGE-TEXT (2)      64900062
649100         MOVE SQLCA                TO DP013-SQLCA                 64910062
649200         MOVE 'TVEHICL'            TO DP013-DB2-TABLE-NAME (1)    64920062
649300         SET DP013-DB2-ABEND                                      64930062
649400             DP013-XCTL-DISPLAY-RESTART                           64940062
649500                                   TO TRUE                        64950062
649600         PERFORM DP013-0000-PROCESS-ABEND                         64960062
649700     END-IF.                                                      64970062
649800                                                                  64980062
649900     EVALUATE TRUE                                                64990062
650000        WHEN SQLCODE = +0                                         65000062
650100             MOVE ASC-VEH-NBR TO DK-VEH-NBR                       65010062
650200             PERFORM 5055-INSERT-TAUVHCL                          65020062
650300     END-EVALUATE.                                                65030062
650400                                                                  65040062
650500*----------------------------------------------------------------*65050062
650600*  GET THE VENDOR NAME FROM TENTNME TABLE                         65060062
650700*                                                                 65070062
650800*  PERFORMED FROM 5000-INSERT-TSHPTPO                             65080062
650900*  PERFORMED FROM 5020-INSERT-TSHIPMT                             65090062
651000*----------------------------------------------------------------*65100062
651100 5070-GET-VEND-NAME.                                              65110062
651200                                                                  65120062
651300     PERFORM WITH TEST AFTER                                      65130062
651400         VARYING PV-RETRY-COUNTER                                 65140062
651500         FROM 1 BY 1                                              65150062
651600         UNTIL (PV-RETRY-COUNTER > PC-MAX-RETRIES                 65160062
651700                 OR SQLCODE = 0                                   65170062
651800                 OR SQLCODE = +100)                               65180062
651900                                                                  65190062
652000         EXEC SQL                                                 65200062
652100             SELECT ENT_NAME_DESC                                 65210062
652200             INTO   :ENTNME-ENT-NAME-DESC                         65220062
652300             FROM   TENTNME                                       65230062
652400             WHERE  ENT_ID      = :ASC-ENT-ID                     65240062
652500             AND    TYPE_CDE    = '01'                            65250062
652600         END-EXEC                                                 65260062
652700                                                                  65270062
652800         EVALUATE TRUE                                            65280062
652900             WHEN SQLCODE = ZERO                                  65290062
653000             WHEN SQLCODE = -904                                  65300062
653100             WHEN SQLCODE = -913                                  65310062
653200                 CONTINUE                                         65320062
653300             WHEN SQLCODE = +100                                  65330062
653400                 MOVE SPACES TO ENTNME-ENT-NAME-DESC              65340062
653500             WHEN SQLWARN0 NOT = SPACES                           65350062
653600             WHEN SQLCODE NOT EQUAL ZERO                          65360062
653700                 MOVE '5070-GET-VEND-NAME '                       65370062
653800                                 TO DP013-PARAGRAPH               65380062
653900                 MOVE 'GET VENDOR NAME  '                         65390062
654000                                 TO DP013-MESSAGE-TEXT(1)         65400062
654100                 MOVE ASC-ENT-ID TO DP013-MESSAGE-TEXT(2)         65410062
654200                 MOVE SQLCA      TO DP013-SQLCA                   65420062
654300                 MOVE 'TENTNME'  TO DP013-DB2-TABLE-NAME(1)       65430062
654400                 SET DP013-DB2-ABEND                              65440062
654500                                 TO TRUE                          65450062
654600                 SET DP013-NO-ROLLBACK                            65460062
654700                                 TO TRUE                          65470062
654800                 SET DP013-XCTL-DISPLAY-RESTART                   65480062
654900                                 TO TRUE                          65490062
655000                 PERFORM DP013-0000-PROCESS-ABEND                 65500062
655100         END-EVALUATE                                             65510062
655200     END-PERFORM.                                                 65520062
655300                                                                  65530062
655400     IF PV-RETRY-COUNTER > PC-MAX-RETRIES AND                     65540062
655500         SQLCODE NOT = +0                                         65550062
655600         MOVE '5070-GET-VEND-NAME '                               65560062
655700                                 TO DP013-PARAGRAPH               65570062
655800         MOVE 'GET VENDOR NAME  '  TO DP013-MESSAGE-TEXT(1)       65580062
655900         MOVE 'MAX NUMBER OF RETRIES EXCEEDED'                    65590062
656000                                 TO DP013-MESSAGE-TEXT(2)         65600062
656100         MOVE SQLCA              TO DP013-SQLCA                   65610062
656200         MOVE 'TENTNME'          TO DP013-DB2-TABLE-NAME(1)       65620062
656300         SET DP013-DB2-ABEND     TO TRUE                          65630062
656400         SET DP013-NO-ROLLBACK   TO TRUE                          65640062
656500         SET DP013-XCTL-DISPLAY-RESTART                           65650062
656600                                 TO TRUE                          65660062
656700         PERFORM DP013-0000-PROCESS-ABEND                         65670062
656800     END-IF.                                                      65680062
656900                                                                  65690062
657000*----------------------------------------------------------------*65700062
657100*  UPDATE THE FIELDS ON THE TSHIPMT  TABLE, TAKE A SNAPSHOT OF   *65710062
657200*  UPDATED TABLE AND INSERT IT TO THE AUDIT TABLE (TAUSHIP)      *65720062
657300*                                                                *65730062
657400*  PERFORMED FROM 3030-DETERMINE-UPDATES                         *65740062
657500*----------------------------------------------------------------*65750062
657600 5100-UPDATE-TSHIPMT.                                             65760062
657700                                                                  65770062
657800     PERFORM                                                      65780062
657900         WITH TEST AFTER                                          65790062
658000         VARYING PV-RETRY-COUNTER                                 65800062
658100         FROM 1 BY 1                                              65810062
658200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               65820062
658300             OR (SQLCODE = +0))                                   65830062
658400                                                                  65840062
658410* 2011-12-14 CHRISTINE TWIEHAUS WR40574 ADDED CARR-AUTH-ID BELOW *65841062
658500         EXEC SQL                                                 65850062
658600           UPDATE TSHIPMT                                         65860062
658700              SET PRO_NBR          =  :ASC-PRO-NBR                65870062
658800                 ,COMPLETE_PRO_NBR =  :ASC-COMPLETE-PRO-NBR       65880062
658810                 ,CARR_AUTH_ID     =  :ASC-CAN                    65881064
658900                 ,LAST_UPD_DTE     =  CURRENT DATE                65890062
659000                 ,LAST_UPD_TME     =  CURRENT TIME                65900062
659100                 ,LAST_UPD_UID     =  :DP020-USERID               65910062
659200                 ,LAST_UPD_PGM_ID  =  :PC-CURRENT-PROGRAM-NAME    65920062
659300           WHERE  TRIP_ID          =  :ASC-TRIP-ID                65930062
659400         END-EXEC                                                 65940062
659500                                                                  65950062
659600         EVALUATE TRUE                                            65960062
659700             WHEN SQLCODE = +0                                    65970062
659800             WHEN SQLCODE = -904                                  65980062
659900             WHEN SQLCODE = -913                                  65990062
660000                 CONTINUE                                         66000062
660100                                                                  66010062
660200             WHEN SQLWARN0 NOT = SPACES                           66020062
660300             WHEN SQLCODE < +0                                    66030062
660400             WHEN SQLCODE > +0                                    66040062
660500                 MOVE '5100-UPDATE-TSHIPMT'                       66050062
660600                                   TO DP013-PARAGRAPH             66060062
660700                 MOVE 'UPDATE TSHIPMT TABLE '                     66070062
660800                                   TO DP013-MESSAGE-TEXT(1)       66080062
660900                 MOVE ASC-TRIP-ID  TO DP013-MESSAGE-TEXT(2)       66090062
661000                 MOVE SQLCA        TO DP013-SQLCA                 66100062
661100                 MOVE 'TSHIPMT'    TO DP013-DB2-TABLE-NAME (1)    66110062
661200                 SET DP013-DB2-ABEND                              66120062
661300                     DP013-XCTL-DISPLAY-RESTART TO TRUE           66130062
661400                 PERFORM DP013-0000-PROCESS-ABEND                 66140062
661500         END-EVALUATE                                             66150062
661600     END-PERFORM.                                                 66160062
661700                                                                  66170062
661800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    66180062
661900         SQLCODE NOT = +0                                         66190062
662000         MOVE '5100-UPDATE-TSHIPMT'                               66200062
662100                                   TO DP013-PARAGRAPH             66210062
662200         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              66220062
662300                                   TO DP013-MESSAGE-TEXT (1)      66230062
662400         MOVE 'TO UPDATE A TSHIPMT ROW'                           66240062
662500                                   TO DP013-MESSAGE-TEXT (2)      66250062
662600         MOVE SQLCA                TO DP013-SQLCA                 66260062
662700         MOVE 'TSHIPMT'            TO DP013-DB2-TABLE-NAME (1)    66270062
662800         SET DP013-DB2-ABEND                                      66280062
662900             DP013-XCTL-DISPLAY-RESTART                           66290062
663000                                   TO TRUE                        66300062
663100         PERFORM DP013-0000-PROCESS-ABEND                         66310062
663200     END-IF.                                                      66320062
663300                                                                  66330062
663400     INITIALIZE DCLTAUSHIP.                                       66340062
663500                                                                  66350062
663600     PERFORM                                                      66360062
663700         WITH TEST AFTER                                          66370062
663800         VARYING PV-RETRY-COUNTER                                 66380062
663900         FROM 1 BY 1                                              66390062
664000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               66400062
664100             OR (SQLCODE = +0))                                   66410062
664200                                                                  66420062
664210* 2011-12-14 CHRISTINE TWIEHAUS WR40574 ADDED CARR-AUTH-ID BELOW *66421062
664300         EXEC SQL                                                 66430062
664400            SELECT   TRIP_ID                                      66440062
664500                    ,SHIPT_ID                                     66450062
664600                    ,CRT_SRC_CDE                                  66460062
664700                    ,LAST_UPD_DTE                                 66470062
664800                    ,LAST_UPD_TME                                 66480062
664900                    ,LAST_UPD_UID                                 66490062
665000                    ,PRO_SCAC_ID                                  66500062
665100                    ,PRO_NBR                                      66510062
665200                    ,BOL_NBR                                      66520062
665300                    ,SHIPPER_NME                                  66530062
665400                    ,SHIPT_TYP_CDE                                66540062
665500                    ,EXPTED_GRO_WGHT                              66550062
665600                    ,PKG_TYP_CDE                                  66560062
665700                    ,EXPTED_PKG_QTY                               66570062
665800                    ,FRGT_CHG_AMT                                 66580062
665900                    ,FRGT_TERMS_CDE                               66590062
666000                    ,EXPTED_PLT_QTY                               66600062
666100                    ,VEND_SHIP_DTE                                66610062
666200                    ,EST_AR_TMST                                  66620062
666300                    ,ORIG_SCAC_ID                                 66630062
666400                    ,LAST_UPD_PGM_ID                              66640062
666500                    ,CRE_USER_ID                                  66650062
666600                    ,CARR_CART_CT                                 66660062
666700                    ,CARR_LAST_UPD_DTE                            66670062
666800                    ,CARR_LAST_UPD_TIME                           66680062
666900                    ,VEND_CART_CT                                 66690062
667000                    ,VEND_LAST_UPD_DTE                            66700062
667100                    ,VEND_LAST_UPD_TIME                           66710062
667200                    ,VEH_NBR                                      66720062
667300                    ,AUTH_NBR                                     66730062
667400                    ,AUTH_DTE                                     66740062
667500                    ,CONFIRM_DTE                                  66750062
667600                    ,CONFIRM_TIME                                 66760062
667610                    ,CARR_AUTH_ID                                 66761062
667700            INTO     :SHIPMT-TRIP-ID :DN-TRIP-ID                  66770062
667800                    ,:SHIPMT-SHIPT-ID                             66780062
667900                    ,:SHIPMT-CRT-SRC-CDE                          66790062
668000                    ,:SHIPMT-LAST-UPD-DTE                         66800062
668100                    ,:SHIPMT-LAST-UPD-TME                         66810062
668200                    ,:SHIPMT-LAST-UPD-UID                         66820062
668300                    ,:SHIPMT-PRO-SCAC-ID                          66830062
668400                    ,:SHIPMT-PRO-NBR                              66840062
668500                    ,:SHIPMT-BOL-NBR                              66850062
668600                    ,:SHIPMT-SHIPPER-NME                          66860062
668700                    ,:SHIPMT-SHIPT-TYP-CDE                        66870062
668800                    ,:SHIPMT-EXPTED-GRO-WGHT                      66880062
668900                    ,:SHIPMT-PKG-TYP-CDE                          66890062
669000                    ,:SHIPMT-EXPTED-PKG-QTY                       66900062
669100                    ,:SHIPMT-FRGT-CHG-AMT                         66910062
669200                    ,:SHIPMT-FRGT-TERMS-CDE                       66920062
669300                    ,:SHIPMT-EXPTED-PLT-QTY                       66930062
669400                    ,:SHIPMT-VEND-SHIP-DTE                        66940062
669500                    ,:SHIPMT-EST-AR-TMST                          66950062
669600                       :DN-EST-AR-TMST                            66960062
669700                    ,:SHIPMT-ORIG-SCAC-ID                         66970062
669800                    ,:SHIPMT-LAST-UPD-PGM-ID                      66980062
669900                    ,:SHIPMT-CRE-USER-ID                          66990062
670000                    ,:SHIPMT-CARR-CART-CT                         67000062
670100                    ,:SHIPMT-CARR-LAST-UPD-DTE                    67010062
670200                    ,:SHIPMT-CARR-LAST-UPD-TIME                   67020062
670300                    ,:SHIPMT-VEND-CART-CT                         67030062
670400                    ,:SHIPMT-VEND-LAST-UPD-DTE                    67040062
670500                    ,:SHIPMT-VEND-LAST-UPD-TIME                   67050062
670600                    ,:SHIPMT-VEH-NBR                              67060062
670700                    ,:SHIPMT-AUTH-NBR                             67070062
670800                    ,:SHIPMT-AUTH-DTE                             67080062
670900                    ,:SHIPMT-CONFIRM-DTE                          67090062
671000                    ,:SHIPMT-CONFIRM-TIME                         67100062
671010                    ,:SHIPMT-CARR-AUTH-ID                         67101062
671100           FROM   TSHIPMT                                         67110062
671200           WHERE  TRIP_ID = :ASC-TRIP-ID                          67120062
671300             AND  SHIPT_ID = :ASC-SHIPT-ID                        67130062
671400         END-EXEC                                                 67140062
671500                                                                  67150062
671600         EVALUATE TRUE                                            67160062
671700             WHEN SQLCODE = +0                                    67170062
671800             WHEN SQLCODE = -904                                  67180062
671900             WHEN SQLCODE = -913                                  67190062
672000                 CONTINUE                                         67200062
672100                                                                  67210062
672200             WHEN SQLWARN0 NOT = SPACES                           67220062
672300             WHEN SQLCODE < +0                                    67230062
672400             WHEN SQLCODE > +0                                    67240062
672500                 MOVE '5100-UPDATE-TSHIPMT'                       67250062
672600                                   TO DP013-PARAGRAPH             67260062
672700                 MOVE 'SELECTING FROM TSHIPMT '                   67270062
672800                                   TO DP013-MESSAGE-TEXT(1)       67280062
672900                 MOVE ASC-TRIP-ID  TO DP013-MESSAGE-TEXT(2)       67290062
673000                 MOVE ASC-SHIPT-ID TO DP013-MESSAGE-TEXT(3)       67300062
673100                 MOVE SQLCA        TO DP013-SQLCA                 67310062
673200                 MOVE 'TSHIPMT'    TO DP013-DB2-TABLE-NAME (1)    67320062
673300                 SET DP013-DB2-ABEND                              67330062
673400                     DP013-XCTL-DISPLAY-RESTART TO TRUE           67340062
673500                 PERFORM DP013-0000-PROCESS-ABEND                 67350062
673600         END-EVALUATE                                             67360062
673700     END-PERFORM.                                                 67370062
673800                                                                  67380062
673900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    67390062
674000         SQLCODE NOT = +0                                         67400062
674100         MOVE '5100-UPDATE-TSHIPMT'                               67410062
674200                                   TO DP013-PARAGRAPH             67420062
674300         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              67430062
674400                                   TO DP013-MESSAGE-TEXT (1)      67440062
674500         MOVE 'TO SELECT A TSHIPMT ROW'                           67450062
674600                                   TO DP013-MESSAGE-TEXT (2)      67460062
674700         MOVE SQLCA                TO DP013-SQLCA                 67470062
674800         MOVE 'TSHIPMT'            TO DP013-DB2-TABLE-NAME (1)    67480062
674900         SET DP013-DB2-ABEND                                      67490062
675000             DP013-XCTL-DISPLAY-RESTART                           67500062
675100                                   TO TRUE                        67510062
675200         PERFORM DP013-0000-PROCESS-ABEND                         67520062
675300     END-IF.                                                      67530062
675400                                                                  67540062
675500     PERFORM                                                      67550062
675600         WITH TEST AFTER                                          67560062
675700         VARYING PV-RETRY-COUNTER                                 67570062
675800         FROM 1 BY 1                                              67580062
675900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               67590062
676000             OR (SQLCODE = +0))                                   67600062
676100                                                                  67610062
676110* 2011-12-14 CHRISTINE TWIEHAUS WR40574 ADDED CARR-AUTH-ID BELOW *67611062
676200         EXEC SQL                                                 67620062
676300             INSERT  INTO TAUSHIP                                 67630062
676400                    (TRIP_ID                                      67640062
676500                    ,SHIPT_ID                                     67650062
676600                    ,CRT_SRC_CDE                                  67660062
676700                    ,LAST_UPD_DTE                                 67670062
676800                    ,LAST_UPD_TME                                 67680062
676900                    ,LAST_UPD_UID                                 67690062
677000                    ,PRO_SCAC_ID                                  67700062
677100                    ,PRO_NBR                                      67710062
677200                    ,BOL_NBR                                      67720062
677300                    ,SHIPPER_NME                                  67730062
677400                    ,SHIPT_TYP_CDE                                67740062
677500                    ,EXPTED_GRO_WGHT                              67750062
677600                    ,PKG_TYP_CDE                                  67760062
677700                    ,EXPTED_PKG_QTY                               67770062
677800                    ,FRGT_CHG_AMT                                 67780062
677900                    ,FRGT_TERMS_CDE                               67790062
678000                    ,EST_AR_TMST                                  67800062
678100                    ,VEND_SHIP_DTE                                67810062
678200                    ,EXPTED_PLT_QTY                               67820062
678300                    ,ORIG_SCAC_ID                                 67830062
678400                    ,LAST_UPD_PGM_ID                              67840062
678500                    ,CRE_USER_ID                                  67850062
678600                    ,CARR_CART_CT                                 67860062
678700                    ,CARR_LAST_UPD_DTE                            67870062
678800                    ,CARR_LAST_UPD_TIME                           67880062
678900                    ,VEND_CART_CT                                 67890062
679000                    ,VEND_LAST_UPD_DTE                            67900062
679100                    ,VEND_LAST_UPD_TIME                           67910062
679200                    ,VEH_NBR                                      67920062
679300                    ,AUTH_NBR                                     67930062
679400                    ,AUTH_DTE                                     67940062
679500                    ,CONFIRM_DTE                                  67950062
679600                    ,CONFIRM_TIME                                 67960062
679700                    ,AUD_STATUS_CDE                               67970062
679710                    ,CARR_AUTH_ID  )                              67971062
679800            VALUES  (:SHIPMT-TRIP-ID                              67980062
679900                       :DN-TRIP-ID                                67990062
680000                    ,:SHIPMT-SHIPT-ID                             68000062
680100                    ,:SHIPMT-CRT-SRC-CDE                          68010062
680200                    ,:SHIPMT-LAST-UPD-DTE                         68020062
680300                    ,:SHIPMT-LAST-UPD-TME                         68030062
680400                    ,:SHIPMT-LAST-UPD-UID                         68040062
680500                    ,:SHIPMT-PRO-SCAC-ID                          68050062
680600                    ,:SHIPMT-PRO-NBR                              68060062
680700                    ,:SHIPMT-BOL-NBR                              68070062
680800                    ,:SHIPMT-SHIPPER-NME                          68080062
680900                    ,:SHIPMT-SHIPT-TYP-CDE                        68090062
681000                    ,:SHIPMT-EXPTED-GRO-WGHT                      68100062
681100                    ,:SHIPMT-PKG-TYP-CDE                          68110062
681200                    ,:SHIPMT-EXPTED-PKG-QTY                       68120062
681300                    ,:SHIPMT-FRGT-CHG-AMT                         68130062
681400                    ,:SHIPMT-FRGT-TERMS-CDE                       68140062
681500                    ,:SHIPMT-EST-AR-TMST                          68150062
681600                       :DN-EST-AR-TMST                            68160062
681700                    ,:SHIPMT-VEND-SHIP-DTE                        68170062
681800                    ,:SHIPMT-EXPTED-PLT-QTY                       68180062
681900                    ,:SHIPMT-ORIG-SCAC-ID                         68190062
682000                    ,:SHIPMT-LAST-UPD-PGM-ID                      68200062
682100                    ,:SHIPMT-CRE-USER-ID                          68210062
682200                    ,:SHIPMT-CARR-CART-CT                         68220062
682300                    ,:SHIPMT-CARR-LAST-UPD-DTE                    68230062
682400                    ,:SHIPMT-CARR-LAST-UPD-TIME                   68240062
682500                    ,:SHIPMT-VEND-CART-CT                         68250062
682600                    ,:SHIPMT-VEND-LAST-UPD-DTE                    68260062
682700                    ,:SHIPMT-VEND-LAST-UPD-TIME                   68270062
682800                    ,:SHIPMT-VEH-NBR                              68280062
682900                    ,:SHIPMT-AUTH-NBR                             68290062
683000                    ,:SHIPMT-AUTH-DTE                             68300062
683100                    ,:SHIPMT-CONFIRM-DTE                          68310062
683200                    ,:SHIPMT-CONFIRM-TIME                         68320062
683300                    ,:ASC-TRIP-STATUS-CDE                         68330062
683310                    ,:ASC-CAN             )                       68331063
683400         END-EXEC                                                 68340062
683500                                                                  68350062
683600         EVALUATE TRUE                                            68360062
683700             WHEN SQLCODE = +0                                    68370062
683800             WHEN SQLCODE = -904                                  68380062
683900             WHEN SQLCODE = -913                                  68390062
684000                 CONTINUE                                         68400062
684100                                                                  68410062
684200             WHEN SQLWARN0 NOT = SPACES                           68420062
684300             WHEN SQLCODE < +0                                    68430062
684400             WHEN SQLCODE > +0                                    68440062
684500                 MOVE '5100-UPDATE-TSHIPMT'                       68450062
684600                                   TO DP013-PARAGRAPH             68460062
684700                 MOVE 'INSERT A ROW ON TAUSHIP'                   68470062
684800                                   TO DP013-MESSAGE-TEXT(1)       68480062
684900                 MOVE ASC-TRIP-ID  TO DP013-MESSAGE-TEXT(2)       68490062
685000                 MOVE ASC-SHIPT-ID TO DP013-MESSAGE-TEXT(3)       68500062
685100                 MOVE SQLCA        TO DP013-SQLCA                 68510062
685200                 MOVE 'TAUSHIP'    TO DP013-DB2-TABLE-NAME (1)    68520062
685300                 SET DP013-DB2-ABEND                              68530062
685400                     DP013-XCTL-DISPLAY-RESTART TO TRUE           68540062
685500                 PERFORM DP013-0000-PROCESS-ABEND                 68550062
685600         END-EVALUATE                                             68560062
685700     END-PERFORM.                                                 68570062
685800                                                                  68580062
685900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    68590062
686000         SQLCODE NOT = +0                                         68600062
686100         MOVE '5100-UPDATE-TSHIPMT'                               68610062
686200                                   TO DP013-PARAGRAPH             68620062
686300         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              68630062
686400                                   TO DP013-MESSAGE-TEXT (1)      68640062
686500         MOVE 'TO INSERT A TAUSHIP ROW'                           68650062
686600                                   TO DP013-MESSAGE-TEXT (2)      68660062
686700         MOVE SQLCA                TO DP013-SQLCA                 68670062
686800         MOVE 'TAUSHIP'            TO DP013-DB2-TABLE-NAME (1)    68680062
686900         SET DP013-DB2-ABEND                                      68690062
687000             DP013-XCTL-DISPLAY-RESTART                           68700062
687100                                   TO TRUE                        68710062
687200         PERFORM DP013-0000-PROCESS-ABEND                         68720062
687300     END-IF.                                                      68730062
687400                                                                  68740062
687500*----------------------------------------------------------------*68750062
687600*  UPDATE THE ESTIMATED ARRIVAL TIMESTAMP AND THE VEHICLE NUMBER *68760062
687700*  ON THE TRIP TABLE                                             *68770062
687800*                                                                *68780062
687900*  PERFORMED FROM 3030-DETERMINE-UPDATES                         *68790062
688000*----------------------------------------------------------------*68800062
688100 5200-UPDATE-TSHIPMT2.                                            68810062
688200                                                                  68820062
688300     PERFORM                                                      68830062
688400         WITH TEST AFTER                                          68840062
688500         VARYING PV-RETRY-COUNTER                                 68850062
688600         FROM 1 BY 1                                              68860062
688700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               68870062
688800             OR (SQLCODE = +0))                                   68880062
688900                                                                  68890062
689000         EXEC SQL                                                 68900062
689100           UPDATE TSHIPMT                                         68910062
689200              SET BOL_NBR          =  :ASC-BOL-NBR                68920062
689300                 ,COMPLETE_BOL_NBR =  :ASC-COMPLETE-BOL-NBR       68930062
689400                 ,LAST_UPD_DTE     =  CURRENT DATE                68940062
689500                 ,LAST_UPD_TME     =  CURRENT TIME                68950062
689600                 ,LAST_UPD_UID     =  :DP020-USERID               68960062
689700           WHERE  TRIP_ID          =  :ASC-TRIP-ID                68970062
689800         END-EXEC                                                 68980062
689900                                                                  68990062
690000         EVALUATE TRUE                                            69000062
690100             WHEN SQLCODE = +0                                    69010062
690200             WHEN SQLCODE = -904                                  69020062
690300             WHEN SQLCODE = -913                                  69030062
690400                 CONTINUE                                         69040062
690500                                                                  69050062
690600             WHEN SQLWARN0 NOT = SPACES                           69060062
690700             WHEN SQLCODE < +0                                    69070062
690800             WHEN SQLCODE > +0                                    69080062
690900                 MOVE '5200-UPDATE-TSHIPMT2'                      69090062
691000                                   TO DP013-PARAGRAPH             69100062
691100                 MOVE 'UPDATE TSHIPMT TABLE '                     69110062
691200                                   TO DP013-MESSAGE-TEXT(1)       69120062
691300                 MOVE ASC-TRIP-ID  TO DP013-MESSAGE-TEXT(2)       69130062
691400                 MOVE SQLCA        TO DP013-SQLCA                 69140062
691500                 MOVE 'TSHIPMT'    TO DP013-DB2-TABLE-NAME (1)    69150062
691600                 SET DP013-DB2-ABEND                              69160062
691700                     DP013-XCTL-DISPLAY-RESTART TO TRUE           69170062
691800                 PERFORM DP013-0000-PROCESS-ABEND                 69180062
691900         END-EVALUATE                                             69190062
692000     END-PERFORM.                                                 69200062
692100                                                                  69210062
692200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    69220062
692300         SQLCODE NOT = +0                                         69230062
692400         MOVE '5200-UPDATE-TSHIPMT2'                              69240062
692500                                   TO DP013-PARAGRAPH             69250062
692600         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              69260062
692700                                   TO DP013-MESSAGE-TEXT (1)      69270062
692800         MOVE 'TO UPDATE A TSHIPMT ROW'                           69280062
692900                                   TO DP013-MESSAGE-TEXT (2)      69290062
693000         MOVE SQLCA                TO DP013-SQLCA                 69300062
693100         MOVE 'TSHIPMT'            TO DP013-DB2-TABLE-NAME (1)    69310062
693200         SET DP013-DB2-ABEND                                      69320062
693300             DP013-XCTL-DISPLAY-RESTART                           69330062
693400                                   TO TRUE                        69340062
693500         PERFORM DP013-0000-PROCESS-ABEND                         69350062
693600     END-IF.                                                      69360062
693700                                                                  69370062
693800     INITIALIZE DCLTAUSHIP.                                       69380062
693900                                                                  69390062
694000     PERFORM                                                      69400062
694100         WITH TEST AFTER                                          69410062
694200         VARYING PV-RETRY-COUNTER                                 69420062
694300         FROM 1 BY 1                                              69430062
694400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               69440062
694500             OR (SQLCODE = +0))                                   69450062
694600                                                                  69460062
694610* 2011-12-14 CHRISTINE TWIEHAUS WR40574 ADDED CARR-AUTH-ID BELOW *69461062
694700         EXEC SQL                                                 69470062
694800            SELECT   TRIP_ID                                      69480062
694900                    ,SHIPT_ID                                     69490062
695000                    ,CRT_SRC_CDE                                  69500062
695100                    ,LAST_UPD_DTE                                 69510062
695200                    ,LAST_UPD_TME                                 69520062
695300                    ,LAST_UPD_UID                                 69530062
695400                    ,PRO_SCAC_ID                                  69540062
695500                    ,PRO_NBR                                      69550062
695600                    ,BOL_NBR                                      69560062
695700                    ,SHIPPER_NME                                  69570062
695800                    ,SHIPT_TYP_CDE                                69580062
695900                    ,EXPTED_GRO_WGHT                              69590062
696000                    ,PKG_TYP_CDE                                  69600062
696100                    ,EXPTED_PKG_QTY                               69610062
696200                    ,FRGT_CHG_AMT                                 69620062
696300                    ,FRGT_TERMS_CDE                               69630062
696400                    ,EXPTED_PLT_QTY                               69640062
696500                    ,VEND_SHIP_DTE                                69650062
696600                    ,EST_AR_TMST                                  69660062
696700                    ,ORIG_SCAC_ID                                 69670062
696800                    ,LAST_UPD_PGM_ID                              69680062
696900                    ,CRE_USER_ID                                  69690062
697000                    ,CARR_CART_CT                                 69700062
697100                    ,CARR_LAST_UPD_DTE                            69710062
697200                    ,CARR_LAST_UPD_TIME                           69720062
697300                    ,VEND_CART_CT                                 69730062
697400                    ,VEND_LAST_UPD_DTE                            69740062
697500                    ,VEND_LAST_UPD_TIME                           69750062
697600                    ,VEH_NBR                                      69760062
697700                    ,AUTH_NBR                                     69770062
697800                    ,AUTH_DTE                                     69780062
697900                    ,CONFIRM_DTE                                  69790062
698000                    ,CONFIRM_TIME                                 69800062
698010                    ,CARR_AUTH_ID                                 69801062
698100            INTO     :SHIPMT-TRIP-ID :DN-TRIP-ID                  69810062
698200                    ,:SHIPMT-SHIPT-ID                             69820062
698300                    ,:SHIPMT-CRT-SRC-CDE                          69830062
698400                    ,:SHIPMT-LAST-UPD-DTE                         69840062
698500                    ,:SHIPMT-LAST-UPD-TME                         69850062
698600                    ,:SHIPMT-LAST-UPD-UID                         69860062
698700                    ,:SHIPMT-PRO-SCAC-ID                          69870062
698800                    ,:SHIPMT-PRO-NBR                              69880062
698900                    ,:SHIPMT-BOL-NBR                              69890062
699000                    ,:SHIPMT-SHIPPER-NME                          69900062
699100                    ,:SHIPMT-SHIPT-TYP-CDE                        69910062
699200                    ,:SHIPMT-EXPTED-GRO-WGHT                      69920062
699300                    ,:SHIPMT-PKG-TYP-CDE                          69930062
699400                    ,:SHIPMT-EXPTED-PKG-QTY                       69940062
699500                    ,:SHIPMT-FRGT-CHG-AMT                         69950062
699600                    ,:SHIPMT-FRGT-TERMS-CDE                       69960062
699700                    ,:SHIPMT-EXPTED-PLT-QTY                       69970062
699800                    ,:SHIPMT-VEND-SHIP-DTE                        69980062
699900                    ,:SHIPMT-EST-AR-TMST                          69990062
700000                       :DN-EST-AR-TMST                            70000062
700100                    ,:SHIPMT-ORIG-SCAC-ID                         70010062
700200                    ,:SHIPMT-LAST-UPD-PGM-ID                      70020062
700300                    ,:SHIPMT-CRE-USER-ID                          70030062
700400                    ,:SHIPMT-CARR-CART-CT                         70040062
700500                    ,:SHIPMT-CARR-LAST-UPD-DTE                    70050062
700600                    ,:SHIPMT-CARR-LAST-UPD-TIME                   70060062
700700                    ,:SHIPMT-VEND-CART-CT                         70070062
700800                    ,:SHIPMT-VEND-LAST-UPD-DTE                    70080062
700900                    ,:SHIPMT-VEND-LAST-UPD-TIME                   70090062
701000                    ,:SHIPMT-VEH-NBR                              70100062
701100                    ,:SHIPMT-AUTH-NBR                             70110062
701200                    ,:SHIPMT-AUTH-DTE                             70120062
701300                    ,:SHIPMT-CONFIRM-DTE                          70130062
701400                    ,:SHIPMT-CONFIRM-TIME                         70140062
701410                    ,:SHIPMT-CARR-AUTH-ID                         70141062
701500           FROM   TSHIPMT                                         70150062
701600           WHERE  TRIP_ID = :ASC-TRIP-ID                          70160062
701700             AND  SHIPT_ID = :ASC-SHIPT-ID                        70170062
701800         END-EXEC                                                 70180062
701900                                                                  70190062
702000         EVALUATE TRUE                                            70200062
702100             WHEN SQLCODE = +0                                    70210062
702200             WHEN SQLCODE = -904                                  70220062
702300             WHEN SQLCODE = -913                                  70230062
702400                 CONTINUE                                         70240062
702500                                                                  70250062
702600             WHEN SQLWARN0 NOT = SPACES                           70260062
702700             WHEN SQLCODE < +0                                    70270062
702800             WHEN SQLCODE > +0                                    70280062
702900                 MOVE '5200-UPDATE-TSHIPMT2'                      70290062
703000                                   TO DP013-PARAGRAPH             70300062
703100                 MOVE 'SELECTING FROM TSHIPMT '                   70310062
703200                                   TO DP013-MESSAGE-TEXT(1)       70320062
703300                 MOVE ASC-TRIP-ID  TO DP013-MESSAGE-TEXT(2)       70330062
703400                 MOVE ASC-SHIPT-ID TO DP013-MESSAGE-TEXT(3)       70340062
703500                 MOVE SQLCA        TO DP013-SQLCA                 70350062
703600                 MOVE 'TSHIPMT'    TO DP013-DB2-TABLE-NAME (1)    70360062
703700                 SET DP013-DB2-ABEND                              70370062
703800                     DP013-XCTL-DISPLAY-RESTART TO TRUE           70380062
703900                 PERFORM DP013-0000-PROCESS-ABEND                 70390062
704000         END-EVALUATE                                             70400062
704100     END-PERFORM.                                                 70410062
704200                                                                  70420062
704300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    70430062
704400         SQLCODE NOT = +0                                         70440062
704500         MOVE '5200-UPDATE-TSHIPMT2'                              70450062
704600                                   TO DP013-PARAGRAPH             70460062
704700         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              70470062
704800                                   TO DP013-MESSAGE-TEXT (1)      70480062
704900         MOVE 'TO SELECT A TSHIPMT ROW'                           70490062
705000                                   TO DP013-MESSAGE-TEXT (2)      70500062
705100         MOVE SQLCA                TO DP013-SQLCA                 70510062
705200         MOVE 'TSHIPMT'            TO DP013-DB2-TABLE-NAME (1)    70520062
705300         SET DP013-DB2-ABEND                                      70530062
705400             DP013-XCTL-DISPLAY-RESTART                           70540062
705500                                   TO TRUE                        70550062
705600         PERFORM DP013-0000-PROCESS-ABEND                         70560062
705700     END-IF.                                                      70570062
705800                                                                  70580062
705900     PERFORM                                                      70590062
706000         WITH TEST AFTER                                          70600062
706100         VARYING PV-RETRY-COUNTER                                 70610062
706200         FROM 1 BY 1                                              70620062
706300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               70630062
706400             OR (SQLCODE = +0))                                   70640062
706500                                                                  70650062
706510* 2011-12-14 CHRISTINE TWIEHAUS WR40574 ADDED CARR-AUTH-ID BELOW *70651062
706600         EXEC SQL                                                 70660062
706700             INSERT  INTO TAUSHIP                                 70670062
706800                    (TRIP_ID                                      70680062
706900                    ,SHIPT_ID                                     70690062
707000                    ,CRT_SRC_CDE                                  70700062
707100                    ,LAST_UPD_DTE                                 70710062
707200                    ,LAST_UPD_TME                                 70720062
707300                    ,LAST_UPD_UID                                 70730062
707400                    ,PRO_SCAC_ID                                  70740062
707500                    ,PRO_NBR                                      70750062
707600                    ,BOL_NBR                                      70760062
707700                    ,SHIPPER_NME                                  70770062
707800                    ,SHIPT_TYP_CDE                                70780062
707900                    ,EXPTED_GRO_WGHT                              70790062
708000                    ,PKG_TYP_CDE                                  70800062
708100                    ,EXPTED_PKG_QTY                               70810062
708200                    ,FRGT_CHG_AMT                                 70820062
708300                    ,FRGT_TERMS_CDE                               70830062
708400                    ,EST_AR_TMST                                  70840062
708500                    ,VEND_SHIP_DTE                                70850062
708600                    ,EXPTED_PLT_QTY                               70860062
708700                    ,ORIG_SCAC_ID                                 70870062
708800                    ,LAST_UPD_PGM_ID                              70880062
708900                    ,CRE_USER_ID                                  70890062
709000                    ,CARR_CART_CT                                 70900062
709100                    ,CARR_LAST_UPD_DTE                            70910062
709200                    ,CARR_LAST_UPD_TIME                           70920062
709300                    ,VEND_CART_CT                                 70930062
709400                    ,VEND_LAST_UPD_DTE                            70940062
709500                    ,VEND_LAST_UPD_TIME                           70950062
709600                    ,VEH_NBR                                      70960062
709700                    ,AUTH_NBR                                     70970062
709800                    ,AUTH_DTE                                     70980062
709900                    ,CONFIRM_DTE                                  70990062
710000                    ,CONFIRM_TIME                                 71000062
710100                    ,AUD_STATUS_CDE                               71010062
710110                    ,CARR_AUTH_ID  )                              71011062
710200            VALUES  (:SHIPMT-TRIP-ID                              71020062
710300                       :DN-TRIP-ID                                71030062
710400                    ,:SHIPMT-SHIPT-ID                             71040062
710500                    ,:SHIPMT-CRT-SRC-CDE                          71050062
710600                    ,:SHIPMT-LAST-UPD-DTE                         71060062
710700                    ,:SHIPMT-LAST-UPD-TME                         71070062
710800                    ,:SHIPMT-LAST-UPD-UID                         71080062
710900                    ,:SHIPMT-PRO-SCAC-ID                          71090062
711000                    ,:SHIPMT-PRO-NBR                              71100062
711100                    ,:SHIPMT-BOL-NBR                              71110062
711200                    ,:SHIPMT-SHIPPER-NME                          71120062
711300                    ,:SHIPMT-SHIPT-TYP-CDE                        71130062
711400                    ,:SHIPMT-EXPTED-GRO-WGHT                      71140062
711500                    ,:SHIPMT-PKG-TYP-CDE                          71150062
711600                    ,:SHIPMT-EXPTED-PKG-QTY                       71160062
711700                    ,:SHIPMT-FRGT-CHG-AMT                         71170062
711800                    ,:SHIPMT-FRGT-TERMS-CDE                       71180062
711900                    ,:SHIPMT-EST-AR-TMST                          71190062
712000                       :DN-EST-AR-TMST                            71200062
712100                    ,:SHIPMT-VEND-SHIP-DTE                        71210062
712200                    ,:SHIPMT-EXPTED-PLT-QTY                       71220062
712300                    ,:SHIPMT-ORIG-SCAC-ID                         71230062
712400                    ,:SHIPMT-LAST-UPD-PGM-ID                      71240062
712500                    ,:SHIPMT-CRE-USER-ID                          71250062
712600                    ,:SHIPMT-CARR-CART-CT                         71260062
712700                    ,:SHIPMT-CARR-LAST-UPD-DTE                    71270062
712800                    ,:SHIPMT-CARR-LAST-UPD-TIME                   71280062
712900                    ,:SHIPMT-VEND-CART-CT                         71290062
713000                    ,:SHIPMT-VEND-LAST-UPD-DTE                    71300062
713100                    ,:SHIPMT-VEND-LAST-UPD-TIME                   71310062
713200                    ,:SHIPMT-VEH-NBR                              71320062
713300                    ,:SHIPMT-AUTH-NBR                             71330062
713400                    ,:SHIPMT-AUTH-DTE                             71340062
713500                    ,:SHIPMT-CONFIRM-DTE                          71350062
713600                    ,:SHIPMT-CONFIRM-TIME                         71360062
713700                    ,:ASC-TRIP-STATUS-CDE                         71370062
713710                    ,:SHIPMT-CARR-AUTH-ID )                       71371062
713800         END-EXEC                                                 71380062
713900                                                                  71390062
714000         EVALUATE TRUE                                            71400062
714100             WHEN SQLCODE = +0                                    71410062
714200             WHEN SQLCODE = -904                                  71420062
714300             WHEN SQLCODE = -913                                  71430062
714400                 CONTINUE                                         71440062
714500                                                                  71450062
714600             WHEN SQLWARN0 NOT = SPACES                           71460062
714700             WHEN SQLCODE < +0                                    71470062
714800             WHEN SQLCODE > +0                                    71480062
714900                 MOVE '5200-UPDATE-TSHIPMT2'                      71490062
715000                                   TO DP013-PARAGRAPH             71500062
715100                 MOVE 'INSERT A ROW ON TAUSHIP'                   71510062
715200                                   TO DP013-MESSAGE-TEXT(1)       71520062
715300                 MOVE ASC-TRIP-ID  TO DP013-MESSAGE-TEXT(2)       71530062
715400                 MOVE ASC-SHIPT-ID TO DP013-MESSAGE-TEXT(3)       71540062
715500                 MOVE SQLCA        TO DP013-SQLCA                 71550062
715600                 MOVE 'TAUSHIP'    TO DP013-DB2-TABLE-NAME (1)    71560062
715700                 SET DP013-DB2-ABEND                              71570062
715800                     DP013-XCTL-DISPLAY-RESTART TO TRUE           71580062
715900                 PERFORM DP013-0000-PROCESS-ABEND                 71590062
716000         END-EVALUATE                                             71600062
716100     END-PERFORM.                                                 71610062
716200                                                                  71620062
716300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    71630062
716400         SQLCODE NOT = +0                                         71640062
716500         MOVE '5200-UPDATE-TSHIPMT2'                              71650062
716600                                   TO DP013-PARAGRAPH             71660062
716700         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              71670062
716800                                   TO DP013-MESSAGE-TEXT (1)      71680062
716900         MOVE 'TO INSERT A TAUSHIP ROW'                           71690062
717000                                   TO DP013-MESSAGE-TEXT (2)      71700062
717100         MOVE SQLCA                TO DP013-SQLCA                 71710062
717200         MOVE 'TAUSHIP'            TO DP013-DB2-TABLE-NAME (1)    71720062
717300         SET DP013-DB2-ABEND                                      71730062
717400             DP013-XCTL-DISPLAY-RESTART                           71740062
717500                                   TO TRUE                        71750062
717600         PERFORM DP013-0000-PROCESS-ABEND                         71760062
717700     END-IF.                                                      71770062
717800*----------------------------------------------------------------*71780062
717900*    ABEND PROCESSOR MODULE                                      *71790062
718000*----------------------------------------------------------------*71800062
718100                                                                  71810062
718200     COPY DPPD013.                                                71820062
718300                                                                  71830062
718400*----------------------------------------------------------------*71840062
718500*    LINK TO CICS OBJECT LOCKING MODULE                          *71850062
718600*----------------------------------------------------------------*71860062
718700                                                                  71870062
718800     COPY DPPD044.                                                71880062
