000100***************************************************************** 00010001
000200 IDENTIFICATION DIVISION.                                         00020001
000300***************************************************************** 00030001
000400                                                                  00040001
000500 PROGRAM-ID.             SNKUP002.                                00050001
000600 AUTHOR.                 PAT LEE.                                 00060001
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070001
000800 DATE-WRITTEN            05-11-92.                                00080001
000900 DATE-COMPILED.                                                   00090001
001000                                                                  00100001
001100***************************************************************** 00110001
001200*     VERIFY ASN/PO EXISTS                                      * 00120001
001300*                                                               * 00130001
001400*  THIS PROGRAM WILL READ THE ASN ORDERS WICH ARE NOT MATCHED;  * 00140001
001500*  THIS INCLUDES THOSE RECENTLY RECEIVED AND THOSE PREVIOUSLY   * 00150001
001600*  RECEIVED BUT NOT YET MATCHED.  THESE ORXERS CAN BE IDENTIFIED* 00160001
001700*  BY HAVING A MTCH-PO-CDE OF 'N', 'C', OR 'U'.                 * 00170001
001800*                                                               * 00180001
001900*  IF A MATCHING PO EXISTS THAT IS NOT CANCELED OR COMPLETED    * 00190001
002000*  THE MTCH-PO-CDE WILL BE RESET TO 'P'.  IF A VALID PO DOES    * 00200001
002100*  NOT EXIST THE ORDER IS CONSIDERED UNMATCHED.                 * 00210001
002200***************************************************************** 00220001
002300*  CHANGE MADE:                                                 * 00230001
002400*                                                               * 00240001
002500***************************************************************** 00250001
002600* CHANGED 11/07/14 BY PRITHIVIRAJ SUBRAMANIAN (COGNIZANT)       * 00260003
001300*              CHANGES THRU OUT THE PROGRAM TO INCREASE SIZE OF * 00270003
001300*              PO# FROM 7 DIGITS TO 8 DIGITS.                   * 00280003
001300*              CHANGE TAGGED WITH *PS 11/07/2014                * 00290003
002800*                                                               * 00300003
003000***************************************************************** 00310001
263627* CHANGED 11/04/2021    BY JIM HUNTER      WR: CHG0263627         00312010
263627* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00313010
263627* MAKING THE CALL DYNAMIC VS STATIC.                              00314010
003000***************************************************************** 00314110
003100 ENVIRONMENT DIVISION.                                            00320001
003200***************************************************************** 00330001
003300                                                                  00340001
003400 CONFIGURATION SECTION.                                           00350001
003500                                                                  00360001
003600 SOURCE-COMPUTER.        IBM-3090.                                00370001
003700 OBJECT-COMPUTER.        IBM-3090.                                00380001
003800                                                                  00390001
003900 INPUT-OUTPUT SECTION.                                            00400001
004000                                                                  00410001
004100 FILE-CONTROL.                                                    00420001
004200*                                                                 00430001
004300***************************************************************** 00440001
004400 DATA DIVISION.                                                   00450001
004500***************************************************************** 00460001
004600*                                                                 00470001
004700 FILE SECTION.                                                    00480001
004800*                                                                 00490001
004900 WORKING-STORAGE SECTION.                                         00500001
005000*                                                                 00510001
005100 01  FILLER.                                                      00520001
005200     05  FILLER                      PIC  X(36)    VALUE          00530001
005300         ' ***** WORKING STORAGE PGM=SNKUP002 '.                  00540001
005400     05  PGM-COMPILED                PIC  X(20)    VALUE SPACE.   00550001
005500     05  FILLER                      PIC  X(10)    VALUE          00560001
005600         ' LOCATION='.                                            00570001
005700     05  PGM-LOCATION                PIC  X(04)    VALUE SPACE.   00580001
005800     05  FILLER                      PIC  X(06)    VALUE          00590001
005900         ' *****'.                                                00600001
006000/                                                                 00610001
006100 01  PROGRAM-SWITCHES.                                            00620001
006200     05  PS-END-OF-ASN-IND           PIC  X(01)    VALUE 'N'.     00630001
006300         88  PS-END-OF-ASN                         VALUE 'Y'.     00640001
006400     05  PS-END-OF-ASN-DETAIL-IND    PIC  X(01)    VALUE 'N'.     00650001
006500         88  PS-END-OF-ASN-DETAIL                  VALUE 'Y'.     00660001
006600     05  PS-VALID-ASNORD-PO-NBR-IND  PIC X(01)     VALUE 'N'.     00670001
006700         88  PS-VALID-ASNORD-PO-NBR                VALUE 'Y'.     00680001
006800         88  PS-INVALID-ASNORD-PO-NBR              VALUE 'N'.     00690001
006900*                                                                 00700001
007000 01  PC-CONSTANTS.                                                00710001
007100     05  PC-3                        PIC X(02)     VALUE '03'.    00720001
007300*PS 11/07/2014 CHANGE STARTS                                      00730003
007200     05  PC-POS-8                    PIC S9(04)    VALUE +8       00740003
007300                                                   COMP SYNC.     00750003
007300*PS 11/07/2014 CHANGE ENDS                                        00760003
007400     05  PC-NEG-1                    PIC S9(04)    VALUE -1       00770001
007500                                                   COMP SYNC.     00780001
007600     05  PC-NEG-904                  PIC S9(04)    VALUE -904     00790001
007700                                                   COMP SYNC.     00800001
007800     05  PC-NEG-913                  PIC S9(04)    VALUE -913     00810001
007900                                                   COMP SYNC.     00820001
008000     05  PC-ROW-NOT-FOUND            PIC S9(04)    VALUE +100     00830001
008100                                                   COMP SYNC.     00840001
008200     05  PC-ILBOABN0                 PIC  X(08)    VALUE          00850001
008300                                                   'ILBOABN0'.    00860001
008400     05  PC-ASTERISK                 PIC  X(30)    VALUE          00870001
008500         '*****************************'.                         00880001
008600     05  PC-NO-ASN-ORDERS            PIC  X(30)    VALUE          00890001
008700         'NO ASN NUMBERS WERE FOUND    '.                         00900001
008800     05  PC-MAX-RETRIES              PIC S9(03)    VALUE +5       00910001
008900                                                   COMP-3.        00920001
009000     05  PC-N                        PIC  X(01)    VALUE 'N'.     00930001
009100     05  PC-C                        PIC  X(01)    VALUE 'C'.     00940001
009200     05  PC-U                        PIC  X(01)    VALUE 'U'.     00950001
009300     05  PC-P                        PIC  X(01)    VALUE 'P'.     00960001
009400     05  PC-Y                        PIC  X(01)    VALUE 'Y'.     00970001
009500/                                                                 00980001
009600*                                                                 00990001
009700 01  PV-MISC-FIELDS.                                              01000001
009800     05  PV-ABEND-CODE               PIC S9(04)    VALUE ZERO     01010001
009900                                                   COMP SYNC.     01020001
010000     05  PV-ABEND-PARAGRAPH          PIC  X(30)    VALUE SPACES.  01030001
010100     05  PV-RETRY-COUNTER            PIC S9(04)    VALUE +0       01040001
010200                                                   COMP SYNC.     01050001
010300*PS 11/07/2014 CHANGE STARTS                                      01060003
010300     05  PV-NUMERIC-PO-NBR           PIC  9(08)    VALUE ZERO.    01070003
010300*PS 11/07/2014 CHANGE ENDS                                        01080003
010400     05  PV-INTEGER-PO-NBR           PIC S9(09)    COMP           01090001
010500                                                   VALUE +0.      01100001
C94517 01  PV-VALUE1-8.                                                 01110006
C94517     05  FILLER                      PIC X(01)     VALUE SPACE.   01120006
C94517     05  PV-VALUE2-8                 PIC X(07)     VALUE SPACE.   01130006
C94517                                                                  01140006
010600/                                                                 01150001
010700******************************************************************01160001
010800*       NUMERIC EDIT LAYOUT                                       01170001
010900******************************************************************01180001
011000*                                                                 01190001
011100     COPY DPWS010I.                                               01200002
011200/                                                                 01210001
011300******************************************************************01220001
011400*       ASSOCIATE ASN TO PO LAYOUT                                01230001
011500******************************************************************01240001
011600*                                                                 01250001
011700     COPY MAWS900.                                                01260002
012800/                                                                 01270001
012900*  ASN ORDER TABLE LAYOUT                                         01280001
013000*                                                                 01290001
013100     EXEC SQL                                                     01300001
013200         INCLUDE TASNORD                                          01310001
013300     END-EXEC.                                                    01320001
013400/                                                                 01330001
013500*   PURCHASE ORDER TABLE LAYOUT                                   01340001
013600*                                                                 01350001
013700     EXEC SQL                                                     01360001
013800         INCLUDE TPURCHS                                          01370001
013900     END-EXEC.                                                    01380001
014000/                                                                 01390001
014100*  DB2 COMMUNICATION AREA                                         01400001
014200*                                                                 01410001
014300     EXEC SQL                                                     01420001
014400         INCLUDE SQLCA                                            01430001
014500     END-EXEC.                                                    01440001
014600/                                                                 01450001
014700*  DB2 COMMUNICATION AREA2                                        01460001
014800*                                                                 01470001
014900     COPY SQLCA2.                                                 01480002
015000/                                                                 01490001
015100*                                                                 01500001
015200*  CURSOR TO FETCH ASN ORDER INFORMATION                          01510001
015300*                                                                 01520001
015400/                                                                 01530001
015500*                                                                 01540001
015600*  CURSOR TO FETCH ASN ORDER INFORMATION                          01550001
015700*                                                                 01560001
015800     EXEC SQL                                                     01570001
015900       DECLARE ASN_ORDER_CURSOR CURSOR FOR                        01580001
016000         SELECT DISTINCT                                          01590001
016100                  PO_NBR,                                         01600001
016200                  SELR_INV_NBR,                                   01610001
016300                  MTCH_PO_CDE,                                    01620001
016400                  ASNHDR_ID                                       01630001
016500           FROM   TASNORD                                         01640001
016600           WHERE    MTCH_PO_CDE  = :PC-N                          01650001
016700              OR    MTCH_PO_CDE  = :PC-C                          01660001
016800              OR    MTCH_PO_CDE  = :PC-U                          01670001
016900        ORDER BY    PO_NBR                                        01680001
017000     END-EXEC.                                                    01690001
017100/                                                                 01700002
017800***************************************************************** 01710001
017900 PROCEDURE DIVISION.                                              01720001
018000*                                                                 01730001
018100*                                                                 01740001
018200 A000-MAINLINE-PROCESSING.                                        01750001
018300*                                                                 01760001
018400     MOVE 'A000'                  TO PGM-LOCATION.                01770001
018500     MOVE 'A000-MAINLINE-PROCESSING'                              01780001
018600                                  TO PV-ABEND-PARAGRAPH.          01790001
018700*    DISPLAY PV-ABEND-PARAGRAPH.                                  01800001
018800*                                                                 01810001
018900     PERFORM Y000-OPEN-ASN-ORDER-CURSOR.                          01820001
019000*                                                                 01830001
019100     PERFORM S000-FETCH-ASN-ORDER-INFO.                           01840001
019200*                                                                 01850001
019300     IF SQLCODE = PC-ROW-NOT-FOUND                                01860001
019400         DISPLAY PC-ASTERISK                                      01870001
019500         DISPLAY PC-NO-ASN-ORDERS                                 01880001
019600         DISPLAY PC-ASTERISK                                      01890001
019700     ELSE                                                         01900001
019800         PERFORM A100-PROCESS-ASN                                 01910001
019900           UNTIL PS-END-OF-ASN                                    01920001
020000     END-IF.                                                      01930001
020100*                                                                 01940001
020200     PERFORM Y300-CLOSE-ASN-ORDER-CURSOR.                         01950001
020300*                                                                 01960001
020400     GOBACK.                                                      01970001
020500*                                                                 01980001
020600/                                                                 01990001
020700******************************************************************02000001
020800*  THIS IS THE MAIN CONTROLING PARAGRAPH FOR PROCESSING ASN      *02010001
020900*  INFORMATION.                                                  *02020001
021000******************************************************************02030001
021100 A100-PROCESS-ASN.                                                02040001
021200*                                                                 02050001
021300     MOVE 'A100'                  TO PGM-LOCATION.                02060001
021400     MOVE 'A100-PROCESS-ASN             '                         02070001
021500                                  TO PV-ABEND-PARAGRAPH.          02080001
021600*    DISPLAY PV-ABEND-PARAGRAPH.                                  02090001
021700*                                                                 02100001
021800                                                                  02110001
021900     PERFORM B000-EDIT-ASNORD-PO-NBR.                             02120001
022000                                                                  02130001
022100                                                                  02140001
022200*                                                                 02150001
022300     IF PS-VALID-ASNORD-PO-NBR                                    02160001
022400         PERFORM B200-GET-PURCHASE-ORDER                          02170001
022500         IF SQLCODE = ZERO                                        02180001
022600             IF  ( PURCHS-STATUS-CDE = 'CA' OR 'CM')              02190001
022700             AND (ASNORD-MTCH-PO-CDE NOT = 'C')                   02200001
022800                 MOVE PC-C        TO ASNORD-MTCH-PO-CDE           02210001
022900             ELSE                                                 02220001
023000****** CHANGE ***********                                         02230001
023100                 IF  PURCHS-STATUS-CDE = 'CA' OR 'CM'             02240001
023200                 AND (ASNORD-MTCH-PO-CDE = 'C')                   02250001
023300                    MOVE PC-Y     TO ASNORD-MTCH-PO-CDE           02260001
023400                 ELSE                                             02270001
023500****** CHANGE ***********                                         02280001
023600                    MOVE PC-P     TO ASNORD-MTCH-PO-CDE           02290001
023700                 END-IF                                           02300001
023800             END-IF                                               02310001
023900         ELSE                                                     02320001
024000             MOVE PC-U            TO ASNORD-MTCH-PO-CDE           02330001
024100         END-IF                                                   02340001
024200     ELSE                                                         02350001
024300         MOVE PC-U                TO ASNORD-MTCH-PO-CDE           02360001
024400     END-IF.                                                      02370001
024500*                                                                 02380001
024600     PERFORM U000-UPDATE-ASNORD.                                  02390001
024700*                                                                 02400001
024800     PERFORM S000-FETCH-ASN-ORDER-INFO.                           02410001
024900*                                                                 02420001
025000/                                                                 02430001
025100******************************************************************02440001
025200*  FORMAT PO NUMBER INTO A VALID NUMERIC FIELD                   *02450001
025300******************************************************************02460001
025400 B000-EDIT-ASNORD-PO-NBR.                                         02470001
025500*                                                                 02480001
025600     MOVE 'B000'                  TO PGM-LOCATION.                02490001
025700     MOVE 'B000-VALIDATE-ASNORD-PO-NBR  '                         02500001
025800                                  TO PV-ABEND-PARAGRAPH.          02510001
025900*    DISPLAY PV-ABEND-PARAGRAPH.                                  02520001
026000*PS 11/07/2014 CHANGE STARTS                                      02530003
026100     IF ASNORD-PO-NBR (9:14) = SPACES                             02540006
C94517         IF ASNORD-PO-NBR (8:1) = SPACE                           02550006
026300            MOVE SPACES          TO PV-VALUE2-8                   02560006
026200            MOVE ASNORD-PO-NBR (1:7)                              02570006
026300                                 TO PV-VALUE2-8                   02580006
026300            MOVE PV-VALUE1-8     TO DP010I-UNEDITED-FIELD         02590006
C94517         ELSE                                                     02600006
026200            MOVE ASNORD-PO-NBR (1:8)                              02610006
026300                                 TO DP010I-UNEDITED-FIELD         02620006
C94517         END-IF                                                   02630006
026400         MOVE PC-POS-8           TO DP010I-MAXIMUM-DIGITS         02640003
026000*PS 11/07/2014 CHANGE ENDS                                        02650003
026500         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       02660001
026600         SET DP010I-NEGATIVE-NOT-ALLOWED                          02670001
026700                                 TO TRUE                          02680001
263627         CALL DP010I-NUMERIC-EDIT-ROUTINE                         02691010
263627              USING DP010I-NUMERIC-EDIT-AREA                      02692010
026900         IF DP010I-ERROR-DETECTED                                 02700001
027000             SET PS-INVALID-ASNORD-PO-NBR                         02710001
027100                                 TO TRUE                          02720001
027200         ELSE                                                     02730001
027300             SET PS-VALID-ASNORD-PO-NBR                           02740001
027400                                 TO TRUE                          02750001
027500             MOVE DP010I-NUMERIC-FIELD                            02760007
027600                                 TO PV-NUMERIC-PO-NBR             02770001
027700             MOVE PV-NUMERIC-PO-NBR  TO PV-INTEGER-PO-NBR         02780001
027800         END-IF                                                   02790001
027900     ELSE                                                         02800001
028000         SET PS-INVALID-ASNORD-PO-NBR                             02810001
028100                                 TO TRUE                          02820001
028200     END-IF.                                                      02830001
028300*                                                                 02840001
028400/                                                                 02850001
028500******************************************************************02860001
028600*  GETS THE PURCHASE ORDER FROM THE PO DATABASE.                 *02870001
028700******************************************************************02880001
028800 B200-GET-PURCHASE-ORDER.                                         02890001
028900*                                                                 02900001
029000     MOVE 'B200'                  TO PGM-LOCATION.                02910001
029100     MOVE 'B200-GET-PURCHASE-ORDER      '                         02920001
029200                                  TO PV-ABEND-PARAGRAPH.          02930001
029300*    DISPLAY PV-ABEND-PARAGRAPH.                                  02940001
029400     EXEC SQL                                                     02950001
029500       SELECT  PO_NBR,                                            02960001
029600               STATUS_CDE                                         02970001
029700       INTO    :PURCHS-PO-NBR,                                    02980001
029800               :PURCHS-STATUS-CDE                                 02990001
029900       FROM    TPURCHS                                            03000001
030000       WHERE   PO_NBR         = :PV-INTEGER-PO-NBR                03010001
030100        AND    VER_STATUS_CDE = 'A'                               03020001
030200        AND    STATUS_CDE IN ('AC','AP','RI','CA','CM','IN','IP') 03030001
030300     END-EXEC.                                                    03040001
030400*                                                                 03050001
030500     EVALUATE TRUE                                                03060001
030600       WHEN SQLCODE = ZEROS                                       03070001
030700       WHEN SQLCODE = +100                                        03080001
030800         CONTINUE                                                 03090001
030900       WHEN OTHER                                                 03100001
031000         DISPLAY PV-ABEND-PARAGRAPH                               03110001
031100         DISPLAY 'ERROR ISSUED ON SELECT PO FROM TPURCHS'         03120001
031200         DISPLAY 'PO-NBR = ' PV-INTEGER-PO-NBR                    03130001
031300         PERFORM Z999-SQL-ERROR                                   03140001
031400     END-EVALUATE.                                                03150001
031500*                                                                 03160001
031600/                                                                 03170001
031700******************************************************************03180001
031800*  FETCHES THE ASN ORDER INFORMATION.                            *03190001
031900******************************************************************03200001
032000 S000-FETCH-ASN-ORDER-INFO.                                       03210001
032100*                                                                 03220001
032200     MOVE 'S000'                  TO PGM-LOCATION.                03230001
032300     MOVE 'S000-FETCH-ASN-ORDER-INFO'                             03240001
032400                                  TO PV-ABEND-PARAGRAPH.          03250001
032500*    DISPLAY PV-ABEND-PARAGRAPH.                                  03260001
032600*                                                                 03270001
032700     EXEC SQL                                                     03280001
032800         FETCH ASN_ORDER_CURSOR                                   03290001
032900           INTO :ASNORD-PO-NBR,                                   03300001
033000                :ASNORD-SELR-INV-NBR,                             03310001
033100                :ASNORD-MTCH-PO-CDE,                              03320001
033200                :ASNORD-ASNHDR-ID                                 03330001
033300     END-EXEC.                                                    03340001
033400*                                                                 03350001
033500     EVALUATE TRUE                                                03360001
033600       WHEN SQLCODE = ZEROS                                       03370001
033700         CONTINUE                                                 03380001
033800       WHEN SQLCODE = PC-ROW-NOT-FOUND                            03390001
033900         SET PS-END-OF-ASN        TO TRUE                         03400001
034000       WHEN OTHER                                                 03410001
034100         DISPLAY PV-ABEND-PARAGRAPH                               03420001
034200         DISPLAY 'ERROR ISSUED ON FETCH OF ORDER CURSOR'          03430001
034300         PERFORM Z999-SQL-ERROR                                   03440001
034400     END-EVALUATE.                                                03450001
034500*                                                                 03460001
034600/                                                                 03470001
034700******************************************************************03480001
034800*  UPDATES THE ASN ORDER INFORMATION.                            *03490001
034900******************************************************************03500001
035000 U000-UPDATE-ASNORD.                                              03510001
035100                                                                  03520001
035200     MOVE 'U000'                  TO PGM-LOCATION.                03530001
035300     MOVE 'U000-UPDATE-ASNORD'    TO PV-ABEND-PARAGRAPH.          03540001
035400*    DISPLAY PV-ABEND-PARAGRAPH.                                  03550001
035500                                                                  03560001
035600     PERFORM                                                      03570001
035700       WITH TEST AFTER                                            03580001
035800       VARYING PV-RETRY-COUNTER FROM 1 BY 1                       03590001
035900       UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR              03600001
036000               SQLCODE = ZERO                                     03610001
036100                                                                  03620001
036200         EXEC SQL                                                 03630001
036300           UPDATE TASNORD                                         03640001
036400              SET MTCH_PO_CDE  = :ASNORD-MTCH-PO-CDE              03650001
036500            WHERE ASNHDR_ID    = :ASNORD-ASNHDR-ID                03660001
036600              AND PO_NBR       = :ASNORD-PO-NBR                   03670001
036700              AND SELR_INV_NBR = :ASNORD-SELR-INV-NBR             03680001
036800         END-EXEC                                                 03690001
036900                                                                  03700001
037000         EVALUATE TRUE                                            03710001
037100           WHEN SQLCODE = ZERO                                    03720001
037200           WHEN SQLCODE = PC-NEG-904                              03730001
037300           WHEN SQLCODE = PC-NEG-913                              03740001
037400                 CONTINUE                                         03750001
037500                                                                  03760001
037600           WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                03770001
037700                 DISPLAY '**************************************' 03780001
037800                 DISPLAY  PV-ABEND-PARAGRAPH                      03790001
037900                 DISPLAY 'WARNING ISSUED ON UPDATE OF TASNORD   ' 03800001
038000                 DISPLAY 'ASNORD-ASNHDR-ID :       '              03810001
038100                          ASNORD-ASNHDR-ID                        03820001
038200                 DISPLAY 'ASNORD-PO-NBR:           '              03830001
038300                          ASNORD-PO-NBR                           03840001
038400                 DISPLAY 'ASNORD-SELR-INV-NBR:     '              03850001
038500                          ASNORD-SELR-INV-NBR                     03860001
038600                 DISPLAY '**********************************'     03870001
038700                 PERFORM Z998-SQL-WARNING                         03880001
038800                                                                  03890001
038900           WHEN  SQLCODE < ZERO                                   03900001
039000                 DISPLAY '**************************************' 03910001
039100                 DISPLAY  PV-ABEND-PARAGRAPH                      03920001
039200                 DISPLAY 'ERROR ISSUED ON UPDATE OF TASNORD     ' 03930001
039300                 DISPLAY 'ASNORD-ASNHDR-ID :       '              03940001
039400                          ASNORD-ASNHDR-ID                        03950001
039500                 DISPLAY 'ASNORD-PO-NBR:           '              03960001
039600                          ASNORD-PO-NBR                           03970001
039700                 DISPLAY 'ASNORD-SELR-INV-NBR:     '              03980001
039800                          ASNORD-SELR-INV-NBR                     03990001
039900                 DISPLAY '**************************************' 04000001
040000                 PERFORM Z999-SQL-ERROR                           04010001
040100                                                                  04020001
040200         END-EVALUATE                                             04030001
040300                                                                  04040001
040400     END-PERFORM.                                                 04050001
040500                                                                  04060001
040600     EVALUATE TRUE                                                04070001
040700       WHEN SQLCODE = ZERO                                        04080001
040800         CONTINUE                                                 04090001
040900       WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                    04100001
041000             DISPLAY '******************************************' 04110001
041100             DISPLAY  PV-ABEND-PARAGRAPH                          04120001
041200             DISPLAY 'WARNING ISSUED ON UPDATE OF TASNORD       ' 04130001
041300             DISPLAY 'ASNORD-ASNHDR-ID:       '                   04140001
041400                      ASNORD-ASNHDR-ID                            04150001
041500             DISPLAY 'ASNORD-PO-NBR:           '                  04160001
041600                      ASNORD-PO-NBR                               04170001
041700             DISPLAY 'ASNORD-SELR-INV-NBR:     '                  04180001
041800                      ASNORD-SELR-INV-NBR                         04190001
041900             DISPLAY '******************************************' 04200001
042000             PERFORM Z998-SQL-WARNING                             04210001
042100                                                                  04220001
042200       WHEN  SQLCODE < ZERO                                       04230001
042300             DISPLAY '******************************************' 04240001
042400             DISPLAY  PV-ABEND-PARAGRAPH                          04250001
042500             DISPLAY 'ERROR ISSUED ON UPDATE OF TASNORD         ' 04260001
042600             DISPLAY 'ASNORD-ASNHDR-ID :       '                  04270001
042700                      ASNORD-ASNHDR-ID                            04280001
042800             DISPLAY 'ASNORD-PO-NBR:           '                  04290001
042900                      ASNORD-PO-NBR                               04300001
043000             DISPLAY 'ASNORD-SELR-INV-NBR:     '                  04310001
043100                      ASNORD-SELR-INV-NBR                         04320001
043200             DISPLAY '******************************************' 04330001
043300             PERFORM Z999-SQL-ERROR                               04340001
043400                                                                  04350001
043500     END-EVALUATE.                                                04360001
043600******************************************************************04370001
043700*     OPENS THE ASN ORDER CURSOR                                 *04380001
043800*                                                                *04390001
043900******************************************************************04400001
044000 Y000-OPEN-ASN-ORDER-CURSOR.                                      04410001
044100*                                                                 04420001
044200     MOVE 'Y000'                  TO PGM-LOCATION.                04430001
044300     MOVE 'Y000-OPEN-ASN-ORDER-CURSOR'                            04440001
044400                                  TO PV-ABEND-PARAGRAPH.          04450001
044500*    DISPLAY PV-ABEND-PARAGRAPH.                                  04460001
044600*                                                                 04470001
044700     EXEC SQL                                                     04480001
044800         OPEN ASN_ORDER_CURSOR                                    04490001
044900     END-EXEC.                                                    04500001
045000*                                                                 04510001
045100     EVALUATE TRUE                                                04520001
045200       WHEN SQLCODE         = ZERO                                04530001
045300       WHEN SQLCODE         = PC-ROW-NOT-FOUND                    04540001
045400         CONTINUE                                                 04550001
045500       WHEN OTHER                                                 04560001
045600         DISPLAY PV-ABEND-PARAGRAPH                               04570001
045700         PERFORM Z999-SQL-ERROR                                   04580001
045800     END-EVALUATE.                                                04590001
045900*                                                                 04600001
046000/                                                                 04610001
046100******************************************************************04620001
046200*     CLOSES THE ASN ORDER CURSOR                                *04630001
046300*                                                                *04640001
046400******************************************************************04650001
046500 Y300-CLOSE-ASN-ORDER-CURSOR.                                     04660001
046600*                                                                 04670001
046700     MOVE 'Y300'                  TO PGM-LOCATION.                04680001
046800     MOVE 'Y300-CLOSE-ASN-ORDER-CURSOR'                           04690001
046900                                  TO PV-ABEND-PARAGRAPH.          04700001
047000*    DISPLAY PV-ABEND-PARAGRAPH.                                  04710001
047100*                                                                 04720001
047200     EXEC SQL                                                     04730001
047300         CLOSE ASN_ORDER_CURSOR                                   04740001
047400     END-EXEC.                                                    04750001
047500*                                                                 04760001
047600     EVALUATE TRUE                                                04770001
047700       WHEN SQLCODE         = ZERO                                04780001
047800       WHEN SQLCODE         = PC-ROW-NOT-FOUND                    04790001
047900         CONTINUE                                                 04800001
048000       WHEN OTHER                                                 04810001
048100         DISPLAY PV-ABEND-PARAGRAPH                               04820001
048200         PERFORM Z999-SQL-ERROR                                   04830001
048300     END-EVALUATE.                                                04840001
048400*                                                                 04850001
048500 EJECT                                                            04860001
048600******************************************************************04870001
048700*     SQL WARNING OR ERROR PROCESSING                            *04880001
048800*                                                                *04890001
048900******************************************************************04900001
049000                                                                  04910001
049100 Z998-SQL-WARNING.                                                04920001
049200*-----------------                                                04930001
049300                                                                  04940001
049400     MOVE SQLCODE    TO SQLCODE2.                                 04950001
049500     MOVE SQLERRD(3) TO SQLERRD3.                                 04960001
049600     DISPLAY '** ABEND **       ** = SQLWARNING'.                 04970001
049700     DISPLAY '** PROGRAM        ** = SNKUP002'.                   04980001
049800     DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  04990001
049900     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  05000001
050000     DISPLAY '** SQLWARN0       ** = ' SQLWARN0.                  05010001
050100     DISPLAY '** SQLWARN1       ** = ' SQLWARN1.                  05020001
050200     DISPLAY '** SQLWARN2       ** = ' SQLWARN2.                  05030001
050300     DISPLAY '** SQLWARN3       ** = ' SQLWARN3.                  05040001
050400     DISPLAY '** SQLWARN4       ** = ' SQLWARN4.                  05050001
050500     DISPLAY '** SQLWARN5       ** = ' SQLWARN5.                  05060001
050600     DISPLAY '** SQLWARN6       ** = ' SQLWARN6.                  05070001
050700     DISPLAY '** SQLWARN7       ** = ' SQLWARN7.                  05080001
050800     EXEC SQL                                                     05090001
050900         COMMIT                                                   05100001
051000     END-EXEC.                                                    05110001
051100     MOVE +4013 TO PV-ABEND-CODE.                                 05120001
051200     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         05130001
051300*                                                                 05140001
051400 Z999-SQL-ERROR.                                                  05150001
051500*---------------                                                  05160001
051600                                                                  05170001
051700     MOVE SQLCODE    TO SQLCODE2.                                 05180001
051800     MOVE SQLERRD(3) TO SQLERRD3.                                 05190001
051900     DISPLAY '** ABEND **       ** = SQLERROR'.                   05200001
052000     DISPLAY '** PROGRAM        ** = SNKUP002'.                   05210001
052100     DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  05220001
052200     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  05230001
052300     DISPLAY '** SQLERRM        ** = ' SQLERRM.                   05240001
052400     DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                  05250001
052500     EXEC SQL                                                     05260001
052600         COMMIT                                                   05270001
052700     END-EXEC.                                                    05280001
052800     MOVE +4013 TO PV-ABEND-CODE.                                 05290001
052900     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         05300001
053000*                                                                 05310001
