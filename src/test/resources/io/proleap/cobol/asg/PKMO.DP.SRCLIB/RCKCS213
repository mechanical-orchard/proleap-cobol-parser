000010 IDENTIFICATION DIVISION.                                         00001000
000020 PROGRAM-ID.    RCKCS213.                                         00002000
000030 AUTHOR.        ANNE RECKNAGEL / DENNIS STEFFEN.                  00003000
000040 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00004000
000050 DATE-WRITTEN.  01-27-94                                          00005000
000060 DATE-COMPILED.                                                   00006000
000070                                                                  00007000
000080******************************************************************00008000
000090*    E213 - PACK SLIP SELECTION LIST                              00009000
000100*                                                                 00010000
000110*    DISPLAY A LIST OF PACK SLIPS BASED ON CRITERIA SPECIFIED     00011000
000120*                                                                 00012000
000130*    FUNC-01   ADD TO RECEIVER                                    00013000
000140*    FUNC-02   INACTIVATE PACKSLIP (LOCAL)                        00014000
000150*    FUNC-03   TRANSCRIBE PACKSLIP (LOCAL)                        00015000
000160*    FUNC-04   PRE-RECEIVER ADD                                   00016000
000170*    FUNC-05   XFER TO RECEIVER ITEM LIST (RCLPOPKS ONLY)         00017000
000180*    FUNC-06   XFER TO RCKCS800 RECEIVER PACK LIST                00018000
000190*                                                                 00019000
000200*                                                                 00020000
000210*    THE DP030-OVERRIDE-APPL-ERROR SWITCH IS SET TO TRUE WHEN     00021000
000220*        ENTERING THE PROGRAM IN ORDER TO GIVE CONTROL BACK TO THE00022000
000230*        LIST WHEN A NEXT-ACT-APPL-ERROR IS SENT BACK FROM THE    00023000
000240*        UPDATE.  THE DP030-RC-APPL-ERROR IS CHECKED TO DETERMINE 00024000
000250*        IF A NEXT-ACT-APPL-ERROR IS BEING RETURNED TO THE LIST.  00025000
000260*                                                                 00026000
000270******************************************************************00027000
000271*---------------------------------------------------------------* 00027124
000272* CHANGED 11/10/2021    BY JIM HUNTER      WR: CHG0263784         00027225
000273* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00027325
000274* MAKING THE CALL DYNAMIC VS STATIC.                              00027425
000275*---------------------------------------------------------------* 00027525
000280 ENVIRONMENT DIVISION.                                            00028000
000290 DATA DIVISION.                                                   00029000
000300 WORKING-STORAGE SECTION.                                         00030000
000310                                                                  00031000
000320 01  PC-PROGRAM-CONSTANTS.                                        00032000
000330     05  PC-CURRENT-MAP-NAME          PIC X(8)  VALUE 'RC213A  '. 00033000
000340     05  PC-CURRENT-MAPSET-NAME       PIC X(8)  VALUE 'RCKM213 '. 00034000
000350     05  PC-CURRENT-PROGRAM-NAME      PIC X(8)  VALUE 'RCKCS213'. 00035000
000360     05  PC-TROUBLE-RTN               PIC X(8)  VALUE 'TMKCS520'. 00036000
000361     05  PC-TMKCS521                  PIC X(8)  VALUE 'TMKCS521'. 00036141
000370     05  PC-AUDIT-RTN                 PIC X(8)  VALUE  'RCKCS290'.00037000
000380     05  PC-AUDIT-RTN-LENGTH          PIC S9(4) VALUE +300        00038000
000390                                                COMP SYNC.        00039000
000400     05  PC-WMS-CONTROL-MOD           PIC X(8)  VALUE  'WSKCS305'.00040020
000410     05  PC-RCKCS806                  PIC X(8)  VALUE  'RCKCS806'.00041000
000420     05  PC-RCKUP006                  PIC X(8)  VALUE  'RCKUP006'.00042000
000430     05  PC-LIST-QUEUE-SEQ            PIC 9     VALUE 1.          00043000
000440     05  PC-SEL-QUEUE-SEQ             PIC 9     VALUE 2.          00044000
000450     05  PC-ITEMS-PER-PANEL           PIC S9(4) VALUE +12         00045000
000460                                                COMP SYNC.        00046000
000470     05  PC-MAX-BLOCKS-IN-ARRAY       PIC S9(4) VALUE +2          00047000
000480                                                COMP SYNC.        00048000
000490     05  PC-MAX-ITEMS                 PIC S9(4) VALUE +9999       00049000
000500                                                COMP SYNC.        00050000
000510     05  PC-MAX-PKITEMS               PIC S9(4) VALUE +1000       00051000
000520                                                COMP SYNC.        00052000
000530     05  PC-MAX-UNPKSLS               PIC S9(4) VALUE +1000       00053000
000540                                                COMP SYNC.        00054000
000550     05  PC-MAX-RETRIES               PIC S9(4) VALUE +3          00055000
000560                                                COMP SYNC.        00056000
000570     05  PC-TROUBLE-RTN-LENGTH        PIC S9(4) VALUE +600        00057000
000580                                                COMP.             00058000
000590     05  PC-ARRAY-MAX                 PIC S9(4) VALUE +500        00059000
000600                                                COMP.             00060000
000610     05  PC-ERR                       PIC X(03) VALUE 'ERR'.      00061000
000620     05  PC-A                         PIC X(01) VALUE 'A'.        00062000
000630     05  PC-CURRENT-DATE              PIC X(10) VALUE SPACE.      00063000
000640     05  PC-DEFAULT-DATE              PIC X(10) VALUE             00064000
000650                                                '9999-09-09'.     00065000
000660     05  PC-DEFAULT-TIME              PIC X(08) VALUE             00066000
000670                                                '09.09.09'.       00067000
000680     05  PC-DEFAULT-TMST              PIC X(26)  VALUE            00068000
000690         '9999-09-09-09.09.09.999999'.                            00069000
000700     05  PC-9000                      PIC S9(9) VALUE +9000       00070000
000710                                                COMP.             00071000
000720     05  PC-SUBCLASS-MDSELV-CDE      PIC X(03) VALUE 'SCL'.       00072000
000730     05  PC-MULTIPLE-SKU-PPK         PIC  X(21)  VALUE            00073000
000740         'M - MULTI SKU PREPACK'.                                 00074000
000750     05  PC-SINGLE-SKU-PPK           PIC  X(22)  VALUE            00075000
000760         'S - SINGLE SKU PREPACK'.                                00076000
000770     05  PC-INNER-PPK                PIC  X(17)  VALUE            00077000
000780         'I - INNER PREPACK'.                                     00078000
000790     05  PC-BULK-PPK                 PIC  X(13)  VALUE            00079000
000800         'B - BULK PACK'.                                         00080000
000810     05  PC-CASEPACK                 PIC  X(12)  VALUE            00081000
000820         'C - CASEPACK'.                                          00082000
000830     05  PC-PKG-NOT-FOUND            PIC  X(20)  VALUE            00083000
000840         'NOT FOUND, NO VENDOR'.                                  00084000
000850     05  PC-UPC-MSG                  PIC  X(10)  VALUE            00085000
000860         'NO UPC/ASN'.                                            00086000
000870     05  PC-MAJCLASS-MDSELV-CDE      PIC X(03) VALUE 'MCL'.       00087000
000880     05  PC-DPT-MDSELV-CDE           PIC X(03) VALUE 'DPT'.       00088000
000890     05  PC-VS-TICKET-TYPE-CDE       PIC S9(04) COMP              00089000
000900                                                VALUE +2.         00090000
000910     05  PC-AUTOVE-MODULE           PIC  X(08) VALUE 'RCKUT127'.  00091000
000920     05  PC-AUTOVE-MODULE-LENGTH    PIC S9(04) VALUE  +400        00092000
000930                                                    COMP SYNC.    00093000
000940     05  PC-INTER-APPL-CODES.                                     00094000
000950         10  PC-INTER-APPL-PACK-SLIP  PIC X(01) VALUE '1'.        00095000
000960         10  PC-INTER-APPL-RCVG-LIST  PIC X(01) VALUE '2'.        00096000
000970         10  PC-INTER-APPL-RCVG       PIC X(01) VALUE '3'.        00097000
000980         10  PC-INTER-APPL-SHPPO-LST  PIC X(01) VALUE '4'.        00098000
000990         10  PC-INTER-APPL-PRERCV-ADD PIC X(01) VALUE '5'.        00099000
001000         10  PC-INTER-APPL-RCVPO-LST  PIC X(01) VALUE '6'.        00100000
001010         10  PC-INTER-APPL-TRPPO-LST  PIC X(01) VALUE '7'.        00101000
001020         10  PC-INTER-APPL-EXCPT-SCR  PIC X(01) VALUE '8'.        00102000
001030     05  PC-000                       PIC X(03) VALUE '000'.      00103000
001040     05  PC-999                       PIC X(03) VALUE '999'.      00104000
001050*                                                                 00105000
001060     05  PC-TSYMSG-NUMBERS.                                       00106000
001070         10  PC-TSYMSG-00004          PIC 9(5)  VALUE 00004.      00107000
001080*            PRESS F2 TO CONFIRM REQUEST                          00108000
001090         10  PC-TSYMSG-00005          PIC 9(5)  VALUE 00005.      00109000
001100*            INVALID VALUE                                        00110000
001110         10  PC-TSYMSG-00008          PIC 9(5)  VALUE 00008.      00111000
001120*            MUST BE NUMERIC                                      00112000
001130         10  PC-TSYMSG-00016          PIC 9(5)  VALUE 00016.      00113000
001140*            UPDATE MUST BE REQUESTED BEFORE CONFIRM              00114000
001150         10  PC-TSYMSG-00047          PIC 9(5)  VALUE 00047.      00115000
001160*            ONLY ONE LIST ITEM MAY BE SELECTED FOR THIS FUNCTION 00116000
001170         10  PC-TSYMSG-00050          PIC 9(5)  VALUE 00050.      00117000
001180*            NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED  00118000
001190         10  PC-TSYMSG-00051          PIC 9(5)  VALUE 00051.      00119000
001200*            NO END OF RANGE HAS BEEN SPECIFIED                   00120000
001210         10  PC-TSYMSG-00052          PIC 9(5)  VALUE 00052.      00121000
001220*            END OF RANGE PRECEDES START OF RANGE                 00122000
001230         10  PC-TSYMSG-00053          PIC 9(5)  VALUE 00053.      00123000
001240*            NO START OF RANGE HAS BEEN SPECIFIED                 00124000
001250         10  PC-TSYMSG-00054          PIC 9(5)  VALUE 00054.      00125000
001260*            ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED   00126000
001270         10  PC-TSYMSG-00055          PIC 9(5)  VALUE 00055.      00127000
001280*            ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED     00128000
001290         10  PC-TSYMSG-00057          PIC 9(5)  VALUE 00057.      00129000
001300*            A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION       00130000
001310         10  PC-TSYMSG-00059          PIC 9(5)  VALUE 00059.      00131000
001320*            UPDATE(S) SUCCESSFUL                                 00132000
001330         10  PC-TSYMSG-00069          PIC 9(5)  VALUE 00069.      00133000
001340*            TOP OF LIST                                          00134000
001350         10  PC-TSYMSG-00070          PIC 9(5)  VALUE 00070.      00135000
001360*            BOTTOM OF LIST                                       00136000
001370         10  PC-TSYMSG-00101          PIC 9(5)  VALUE 00101.      00137000
001380*            VALUE MUST BE GREATER THAN ZERO AND < 1,000,000      00138000
001390         10  PC-TSYMSG-00279          PIC 9(5)  VALUE 00279.      00139000
001400*            MORE ITEMS TO DISPLAY                                00140000
001410         10  PC-TSYMSG-00551          PIC 9(5)  VALUE 00551.      00141000
001420*            WAIT 15 SECONDS;RETRY FUNCTION AGAIN;IF UNSUCCESSFUL 00142000
001430*            CALL HELP DESK                                       00143000
001440         10  PC-TSYMSG-00723          PIC 9(5)  VALUE 00723.      00144000
001450*            THIS FUNCTION MAY ONLY BE USED FOR STATUS OF INACTIVE00145000
001460         10  PC-TSYMSG-00724          PIC 9(5)  VALUE 00724.      00146000
001470*            UPDATE OR DELETE IS ONLY VALID FOR ACTIVE/INACTIVE   00147000
001480         10  PC-TSYMSG-00734          PIC 9(5)  VALUE 00734.      00148000
001490*            NO UPDATES ALLOWED FOR RECEIVER STATUS               00149000
001500         10  PC-TSYMSG-00737          PIC 9(5)  VALUE 00737.      00150000
001510*            RECEIVER SEQUENCE NUMBER REQUIRED                    00151000
001520         10  PC-TSYMSG-00790          PIC 9(5)  VALUE 00790.      00152000
001530*            TRANSCRIPTION COMPLETE -&VAR LINES IN TROUBLE        00153000
001540                                                                  00154000
001550         10  PC-TSYMSG-00807          PIC 9(5)  VALUE 00807.      00155000
001560*            INVALID COMBINATION OF STATUSES                      00156000
001570                                                                  00157000
001580         10  PC-TSYMSG-00816          PIC 9(5)  VALUE 00816.      00158000
001590*            BULK AND PACKED BY STORE PACKSLIPS CANNOT BE COMB    00159000
001600         10  PC-TSYMSG-00818          PIC 9(5)  VALUE 00818.      00160000
001610*            STR DEST CONFLICTS WITH RCVR PACKED BY STR IND       00161000
001620         10  PC-TSYMSG-00955          PIC 9(5)  VALUE 00955.      00162000
001630*            WRONG OPERATING UNIT/FACILITY FOR THIS RECEIVER      00163000
001640         10  PC-TSYMSG-00966          PIC 9(5)  VALUE 00966.      00164000
001650*            INVALID FUNCTION FOR RECEIVER/RECEIPT ITEM STATUS    00165000
001660         10  PC-TSYMSG-00967          PIC 9(5)  VALUE 00967.      00166000
001670*            WORK ORDER(S) EXIST FOR ITEM SELECTED FOR INACTIVATE 00167000
001680         10  PC-TSYMSG-00972          PIC 9(5)  VALUE 00972.      00168000
001690*            PACKSLIPS WITH NO LINES WERE NOT TRANSCRIBED AND ARE 00169000
001700*              STILL INACTIVE                                     00170000
001710                                                                  00171000
001720         10  PC-TSYMSG-00976          PIC 9(5)  VALUE 00976.      00172000
001730*            TRANSCRIPTION CANNOT BE PERFORMED BECAUSE OF DUPLICAT00173000
001740*            STORE NUMBERS                                        00174000
001750                                                                  00175000
001760         10  PC-TSYMSG-00977          PIC 9(5)  VALUE 00977.      00176000
001770*            THE PACKSLIP NUMBERS ARE NOT THE SAME - F2 TO CONFIRM00177000
001780                                                                  00178000
001790         10  PC-TSYMSG-00984          PIC 9(5)  VALUE 00984.      00179000
001800*            DATABASE IS BUSY, TRY AGAIN IN A FEW MINUTES         00180001
001810                                                                  00181000
001820         10  PC-TSYMSG-01002          PIC 9(5)  VALUE 01002.      00182000
001830* TRANSCRIPTION COMPLETE -&VAR LINES IN TROUBLE;PO TROUBLE EXISTS 00183000
001840                                                                  00184000
001850         10  PC-TSYMSG-01047          PIC 9(5)  VALUE 01047.      00185000
001860*        MULTIPLE BOL, F/B, SCAC, OR VENDOR SHIP DATE COMBINATIONS00186000
001870                                                                  00187000
001880         10  PC-TSYMSG-01096          PIC 9(5)  VALUE 01096.      00188000
001890*        PROGRAM ERROR WHILE ATTEMPTING TO CALCULATE OTR          00189000
001900                                                                  00190000
001910         10  PC-TSYMSG-01208          PIC 9(5)  VALUE 01208.      00191000
001920*DETAIL CHECK QTY ENTERED FOR THIS RECEIVER, F2 TO CONFIRM INACTIV00192000
001930                                                                  00193000
001940         10  PC-TSYMSG-01256          PIC 9(5)  VALUE 01256.      00194000
001950*UPDATES NOT ALLOWED: ADJUSTMENT HAVE BEEN MADE TO THE VERIFIED QU00195000
001960                                                                  00196000
001970         10  PC-TSYMSG-01263          PIC 9(5)  VALUE 01263.      00197000
001980*THE STORE MUST BE OPEN--IT IS NOT VALID AT THIS TIME             00198000
001990                                                                  00199000
002000         10  PC-TSYMSG-01525          PIC 9(5)  VALUE 01525.      00200000
002010*SELECT ONLY ONE RECEIVER TO PROCESS                              00201000
002020                                                                  00202000
002030         10  PC-TSYMSG-01529          PIC 9(5)  VALUE 01529.      00203000
002040*&VAR ARRAY IS TOO SMALL - CONTACT DP                             00204000
002050                                                                  00205000
002060         10  PC-TSYMSG-01794          PIC 9(5)  VALUE 01794.      00206000
002070*CANNOT INACTIVATE PACKSLIP -CASEPACK SPLIT PROCESS HAS BEEN PERFM00207000
002080                                                                  00208000
002090         10  PC-TSYMSG-01843          PIC 9(5)  VALUE 01843.      00209000
002100*SKU DOES NOT EXIST FOR PO LINE &VAR - CONTACT BUYING OFFICE      00210000
002110                                                                  00211000
002120         10  PC-TSYMSG-01874          PIC 9(5)  VALUE 01874.      00212000
002130* PACKSLIP IS ALREADY INACTIVE                                    00213000
002140                                                                  00214000
002150         10  PC-TSYMSG-02066          PIC 9(5)  VALUE 02066.      00215000
002160* CANNOT ADD TO RECEIVER - CASEPACK SPLIT HAS BEEN PERFORMED.     00216000
002170                                                                  00217000
002180         10  PC-TSYMSG-02229          PIC 9(5)  VALUE 02229.      00218000
002190* PREPACK SYSTEM ERROR                                            00219000
002200                                                                  00220000
002210         10  PC-TSYMSG-02452          PIC 9(5)  VALUE 02452.      00221000
002220*   ALLOCATION IS INCORRECT; PLEASE REVIEW DISTRO                 00222000
002230                                                                  00223000
002240         10  PC-TSYMSG-02453          PIC 9(5)  VALUE 02453.      00224000
002250*   TRANSCRIPTION COMPLETE - NO TROUBLE EXISTS                    00225000
002260                                                                  00226000
002270         10  PC-TSYMSG-02454          PIC 9(5)  VALUE 02454.      00227000
002280*   TRANSCRIPTION COMPLETE - &VAR TROUBLE EXISTS                  00228000
002290                                                                  00229000
002300         10  PC-TSYMSG-02745          PIC 9(5)  VALUE 02745.      00230000
002310*CANNOT ADD TO RECEIVER - SMOOTHING HAS BEEN PERFORMED            00231000
002320                                                                  00232000
002330         10  PC-TSYMSG-02746          PIC 9(5)  VALUE 02746.      00233000
002340*CANNOT INACTIVATE PACKSLIP - SMOOTHING PROCESS HAS BEEN PERFORMED00234000
002350                                                                  00235000
002360         10  PC-TSYMSG-03138          PIC 9(5)  VALUE 03138.      00236000
002370                                                                  00237000
002380         10  PC-TSYMSG-03225          PIC 9(5)  VALUE 03225.      00238000
002390*UNABLE TO INACTIVATE, MUST RECLAIM ACTIVE CARTONS FIRST          00239000
002400                                                                  00240000
002410         10  PC-TSYMSG-03226          PIC 9(5)  VALUE 03226.      00241000
002420                                                                  00242000
002430         10  PC-TSYMSG-03354          PIC 9(5)  VALUE 03354.      00243000
002440*YOU MUST DELETE ALL MANUALLY CREATED PACKSLIPS BEFORE            00244000
002450*INACTIVATING                                                     00245000
002460                                                                  00246000
002470         10  PC-TSYMSG-03537          PIC 9(5)  VALUE 03537.      00247000
002480*RECEIVING HAS BEGUN ON TRAILER - UNABLE IN INACTIVATE PACKSLIP   00248000
002490                                                                  00249000
002500         10  PC-TSYMSG-03546          PIC 9(5)  VALUE 03546.      00250000
002510*ERROR IN WMS DOWNLOAD MODULE - CONTACT HELP DESK                 00251000
002520                                                                  00252000
002530* JAK 06/2007 - ADD NEW ERROR MSGS FOR WMS                        00253000
002540         10  PC-TSYMSG-03572          PIC 9(5)  VALUE 03572.      00254000
002550*   TRANSCRIPTION COMPLETE-LINES IN TROUBLE & ASN DWNLDED TO WMS  00255000
002560         10  PC-TSYMSG-03573          PIC 9(5)  VALUE 03573.      00256000
002570*   TRANSCRIPTION COMPLETE-TROUBLE EXISTS & ASN DWNLDED TO WMS    00257000
002580         10  PC-TSYMSG-03574          PIC 9(5)  VALUE 03574.      00258000
002590*   TRNSCRPTN CMPLT-LINES IN TRBL;PO TRBL EXIST & ASN DWNLD TO WMS00259000
002600         10  PC-TSYMSG-03575          PIC 9(5)  VALUE 03575.      00260000
002610*   UPDATE SUCCESSFUL AND WMS WILL BE UPDATED ACCORDINGLY         00261000
002620         10  PC-TSYMSG-03584          PIC 9(5)  VALUE 03584.      00262000
002630*   TRNSCRPTN COMPLETE-NO LINES IN TROUBLE & ASN DWNLDED TO WMS   00263000
002640* JAK 06/2007 - END                                               00264000
002650         10  PC-TSYMSG-03599          PIC 9(5)  VALUE 03599.      00265000
002660*   TRANSCRIPTION FAILED - THERE IS A STORE(S) NOT OPEN TO RECEIVE00266000
002670         10  PC-TSYMSG-03687          PIC 9(5)  VALUE 03687.      00267002
002680*    ERROR - MISSING DC SPLITS                                    00268000
002690         10  PC-TSYMSG-03688          PIC 9(5)  VALUE 03688.      00269000
002700*     ERROR - MISSING STORE ALLOCATIONS                           00270000
002710         10  PC-TSYMSG-99910          PIC 9(5)  VALUE 99910.      00271000
002720*   YOU DO NOT HAVE SECURITY CLEARANCE FOR THE REQUESTED FUNCTION 00272000
002730                                                                  00273000
002740/                                                                 00274000
002750 01  PS-PROGRAM-SWITCHES.                                         00275000
002760     05  PS-DIFFERENT-PACKSLIPS-SW    PIC  X    VALUE 'N'.        00276000
002770         88  PS-DIFFERENT-PACKSLIPS             VALUE 'Y'.        00277000
002780         88  PS-NOT-DIFFERENT-PACKSLIPS         VALUE 'N'.        00278000
002790     05  PS-ORIG-ASN-PKSLIP-SW        PIC  X    VALUE 'N'.        00279000
002800         88  PS-ORIG-ASN-PKSLIP-YES             VALUE 'Y'.        00280000
002810         88  PS-ORIG-ASN-PKSLIP-NO              VALUE 'N'.        00281000
002820     05  PS-DUPLICATE-STORE-SW        PIC  X    VALUE 'N'.        00282000
002830         88  PS-DUPLICATE-STORE                 VALUE 'Y'.        00283000
002840         88  PS-NOT-DUPLICATE-STORE             VALUE 'N'.        00284000
002850     05  PS-ODD-UNIT-DELETE-SW        PIC  X    VALUE 'N'.        00285000
002860         88  PS-7630-DELETE                     VALUE 'A'.        00286000
002870         88  PS-7635-DELETE                     VALUE 'B'.        00287000
002880         88  PS-7814-DELETE                     VALUE 'C'.        00288000
002890     05  PS-FIRST-SELECTED-SW         PIC  X    VALUE 'N'.        00289000
002900         88  PS-FIRST-SELECTED                  VALUE 'Y'.        00290000
002910         88  PS-NOT-FIRST-SELECTED              VALUE 'N'.        00291000
002920     05  PS-NO-ERROR-MSG-SW           PIC  X    VALUE 'N'.        00292000
002930         88  PS-NO-ERROR-MSG                    VALUE 'N'.        00293000
002940         88  PS-ERROR-MSG                       VALUE 'Y'.        00294000
002950     05  PS-SINGLE-OPER-UNT-ID-SW     PIC  X    VALUE 'N'.        00295000
002960         88  PS-SINGLE-OPER-UNT-ID              VALUE 'Y'.        00296000
002970         88  PS-MULT-OPER-UNT-ID                VALUE 'N'.        00297000
002980     05  PS-ERROR-SW                  PIC  X    VALUE 'N'.        00298000
002990         88  PS-NO-ERROR                        VALUE 'N'.        00299000
003000         88  PS-ERROR                           VALUE 'Y'.        00300000
003010     05  PS-MATCH-SW                  PIC  X    VALUE 'N'.        00301000
003020         88  PS-NO-MATCH                        VALUE 'N'.        00302000
003030         88  PS-MATCH                           VALUE 'Y'.        00303000
003040     05  PS-RECITM-SW                 PIC  X    VALUE 'N'.        00304000
003050         88  PS-RECITM-NOT-FOUND                VALUE 'N'.        00305000
003060         88  PS-RECITM-FOUND                    VALUE 'Y'.        00306000
003070         88  PS-IN-RECITM-FOUND                 VALUE 'I'.        00307000
003080     05  PS-PURITM-SW                 PIC  X    VALUE 'N'.        00308000
003090         88  PS-PURITM-NOT-FOUND                VALUE 'N'.        00309000
003100         88  PS-PURITM-FOUND                    VALUE 'Y'.        00310000
003110     05  PS-RECDIS-SW                 PIC  X    VALUE 'N'.        00311000
003120         88  PS-RECDIS-NOT-FOUND                VALUE 'N'.        00312000
003130         88  PS-RECDIS-FOUND                    VALUE 'Y'.        00313000
003140     05  PS-PKSLIP-ITEM-CSR-SW        PIC  X    VALUE 'N'.        00314000
003150         88  PS-NOT-END-OF-PKSLIP-ITEM-CSR      VALUE 'N'.        00315000
003160         88  PS-END-OF-PKSLIP-ITEM-CSR          VALUE 'Y'.        00316000
003170     05  PS-UNPKSL-ITEM-CSR-SW        PIC  X    VALUE 'N'.        00317000
003180         88  PS-NOT-END-OF-UNPKSL-ITEM-CSR      VALUE 'N'.        00318000
003190         88  PS-END-OF-UNPKSL-ITEM-CSR          VALUE 'Y'.        00319000
003200     05  PS-UNPKSL-LINE-CSR-SW        PIC  X    VALUE 'N'.        00320000
003210         88  PS-NOT-END-OF-UNPKSL-LINE-CSR      VALUE 'N'.        00321000
003220         88  PS-END-OF-UNPKSL-LINE-CSR          VALUE 'Y'.        00322000
003230     05  PS-RECDIS-CSR-SW             PIC  X    VALUE 'N'.        00323000
003240         88  PS-NOT-EOF-RECDIS-CSR              VALUE 'N'.        00324000
003250         88  PS-EOF-RECDIS-CSR                  VALUE 'Y'.        00325000
003260     05  PS-DONE-SW                   PIC  X    VALUE 'N'.        00326000
003270         88  PS-NOT-DONE                        VALUE 'N'.        00327000
003280         88  PS-DONE                            VALUE 'Y'.        00328000
003290     05  PS-PLAN-SW                   PIC  X    VALUE 'M'.        00329000
003300         88  PS-MASTER-PLAN                     VALUE 'M'.        00330000
003310         88  PS-SPECIFIC-PLAN                   VALUE 'S'.        00331000
003320     05  PS-MORE-PLAN-SW              PIC  X    VALUE 'Y'.        00332000
003330         88  PS-NO-MORE-PLAN                    VALUE 'N'.        00333000
003340         88  PS-MORE-PLAN                       VALUE 'Y'.        00334000
003350     05  PS-PACKING-IND               PIC  X    VALUE ' '.        00335000
003360         88  PS-PACKED-BY-STORE                 VALUE 'S'.        00336000
003370         88  PS-BULK-SHIPMENT                   VALUE 'B'.        00337000
003380     05  PS-INACT-ALLOWED-SW          PIC  X    VALUE 'N'.        00338000
003390         88  PS-INACT-ALLOWED                   VALUE 'Y'.        00339000
003400         88  PS-INACT-NOT-ALLOWED               VALUE 'N'.        00340000
003410     05  PS-PKSLIP-LIST-SW            PIC X     VALUE 'N'.        00341000
003420         88  PS-PKSLIP-LIST-ALLOWED             VALUE 'Y'.        00342000
003430         88  PS-PKSLIP-LIST-NOT-ALLOWED         VALUE 'N'.        00343000
003440     05  PS-AGMT-PACK-BY-STR-SW       PIC  X    VALUE 'N'.        00344000
003450         88  PS-AGMT-IS-PK-BY-STR               VALUE 'Y'.        00345000
003460         88  PS-AGMT-NOT-PK-BY-STR              VALUE 'N'.        00346000
003470     05  PS-INITIAL-PANEL-SW          PIC X     VALUE 'N'.        00347000
003480         88  PS-INITIAL-PANEL                   VALUE 'Y'.        00348000
003490     05  PS-STORE-TABLE-SW            PIC X     VALUE 'N'.        00349000
003500         88  PS-INSERT-TO-TABLE                 VALUE 'N'.        00350000
003510         88  PS-INSERT-STORE                    VALUE 'Y'.        00351000
003520         88  PS-DUP-STORE                       VALUE 'D'.        00352000
003530         88  PS-TABLE-FULL                      VALUE 'F'.        00353000
003540     05  PS-PRETICKET-SW              PIC X     VALUE 'N'.        00354000
003550         88  PS-NOT-PRETICKET                   VALUE 'N'.        00355000
003560         88  PS-PRETICKET                       VALUE 'Y'.        00356000
003570     05  PS-VSM-SW                    PIC X     VALUE 'N'.        00357000
003580         88  PS-NOT-VSM                         VALUE 'N'.        00358000
003590         88  PS-VSM                             VALUE 'Y'.        00359000
003600     05  PS-TRNSC-ALLOWED-SW          PIC  X    VALUE 'N'.        00360000
003610         88  PS-TRNSC-ALLOWED                   VALUE 'Y'.        00361000
003620         88  PS-TRNSC-NOT-ALLOWED               VALUE 'N'.        00362000
003630     05  PS-PRPK-PKSLIP-ITEM-CSR-SW   PIC X(01) VALUE 'N'.        00363000
003640         88  PS-END-PRPK-PKSLIP-ITEM-CSR        VALUE 'Y'.        00364000
003650         88  PS-START-PRPK-PKSLIP-ITEM-CSR      VALUE 'N'.        00365000
003660     05  PS-UPC-MSG-SW                PIC X(01) VALUE 'N'.        00366000
003670         88  PS-DISPLAY-UPC-MSG                 VALUE 'Y'.        00367000
003680     05  PS-ACTIVE-CARTONS-SW         PIC X(01) VALUE 'N'.        00368000
003690         88  PS-ACTIVE-CARTONS-YES              VALUE 'Y'.        00369000
003700         88  PS-ACTIVE-CARTONS-NO               VALUE 'N'.        00370000
003710     05  PS-TROUBLE-FOUND-SW          PIC X(01) VALUE 'N'.        00371000
003720         88  PS-TROUBLE-FOUND                   VALUE 'Y'.        00372000
003730         88  PS-NO-TROUBLE-FOUND                VALUE 'N'.        00373000
003740     05  PS-ASNS-TO-WMS-SW            PIC X(01) VALUE 'N'.        00374000
003750         88  PS-ASNS-TO-WMS-YES                 VALUE 'Y'.        00375000
003760         88  PS-ASNS-TO-WMS-NO                  VALUE 'N'.        00376000
003770     05  PS-INACTIVATE-SW             PIC X(01) VALUE 'N'.        00377000
003780         88  PS-INACTIVATE-YES                  VALUE 'Y'.        00378000
003790         88  PS-INACTIVATE-NO                   VALUE 'N'.        00379000
003800     05  PS-VALID-TRIP-SW             PIC X(01) VALUE 'N'.        00380000
003810         88  PS-VALID-TRIP                      VALUE 'Y'.        00381000
003820         88  PS-VALID-TRIP-NO                   VALUE 'N'.        00382000
003830* JAK 04/2007 ADD SWITCHES                                        00383000
003840     05  PS-DISTRO-TROUBLE-SW         PIC X(01) VALUE 'N'.        00384000
003850         88  PS-DISTRO-TROUBLE-YES              VALUE 'Y'.        00385000
003860         88  PS-DISTRO-TROUBLE-NO               VALUE 'N'.        00386000
003870* JAK 09/2007 ADD NEW SWITCH                                      00387000
003880     05  PS-LOAD-LNE-NBR-SW           PIC X(01) VALUE 'N'.        00388000
003890         88  PS-LOAD-LNE-NBR-YES                VALUE 'Y'.        00389000
003900         88  PS-LOAD-LNE-NBR-NO                 VALUE 'N'.        00390000
003910                                                                  00391000
003912     05  PS-CREATE-DC-EFC-LVL-SW      PIC X(04) VALUE SPACES.     00391241
003913         88  PS-CREATE-DC-ONLY                  VALUE 'DC  '.     00391336
003914         88  PS-CREATE-EFC-ONLY                 VALUE 'EFC '.     00391436
003915         88  PS-CREATE-BOTH                     VALUE 'BOTH'.     00391536
003916     05  PS-DC-EFC-LOC-SW             PIC X(01) VALUE 'N'.        00391650
003917         88  PS-DC-LOCATION                     VALUE 'N'.        00391750
003918         88  PS-EFC-LOCATION                    VALUE 'Y'.        00391837
003919     05  PS-PRO-LEVEL-TRBL-CHECK-SW   PIC X(01) VALUE 'N'.        00391941
003920         88  PS-PRO-LEVEL-TRBL-CHECK            VALUE 'Y'.        00392041
003921         88  PS-PRO-LEVEL-TRBL-CHECK-NO         VALUE 'N'.        00392141
003922     05  PS-PROTR1-SW                 PIC X(01) VALUE 'N'.        00392241
003923         88  PS-PROTR1                          VALUE 'Y'.        00392341
003924         88  PS-PROTR1-NO                       VALUE 'N'.        00392441
003925     05  PS-AUTRB3-SW                 PIC X(01) VALUE 'N'.        00392541
003926         88  PS-AUTRB3                          VALUE 'Y'.        00392641
003927         88  PS-AUTRB3-NO                       VALUE 'N'.        00392741
003928                                                                  00392836
003929 01  DK-DB2-KEYS.                                                 00392900
003930     05  DK-PO-NBR                    PIC S9(9) COMP VALUE +0.    00393000
003940     05  DK-PO-LNE-NBR                PIC S9(9) COMP VALUE +0.    00394000
003950     05  DK-SHIPT-ID                  PIC S9(9) COMP VALUE +0.    00395000
003960     05  DK-TRIP-ID                   PIC S9(9) COMP VALUE +0.    00396000
003970     05  DK-OPER-UNT-ID               PIC S9(4) COMP VALUE +0.    00397000
003980     05  DK-OPER-UNT-ID-B             PIC S9(4) COMP VALUE +0.    00398000
003990     05  DK-OPER-UNT-ID-E             PIC S9(4) COMP VALUE +9999. 00399000
004000     05  DK-OPER-UNT-ID-00            PIC S9(4) COMP VALUE +0.    00400000
004010     05  DK-FCLTY-ID                  PIC S9(4) COMP VALUE +0.    00401000
004020     05  DK-FCLTY-ID-B                PIC S9(4) COMP VALUE +0.    00402000
004030     05  DK-FCLTY-ID-E                PIC S9(4) COMP VALUE +9999. 00403000
004040     05  DK-STR-DEST-NBR              PIC S9(4) COMP VALUE +0.    00404000
004050     05  DK-PRO-NBR-B                 PIC X(16) VALUE SPACES.     00405000
004060     05  DK-PRO-NBR-E                 PIC X(16) VALUE             00406000
004070         '9999999999999999'.                                      00407000
004080     05  DK-BOL-NBR-B                 PIC X(16) VALUE SPACES.     00408000
004090     05  DK-BOL-NBR-E                 PIC X(16) VALUE             00409000
004100         '9999999999999999'.                                      00410000
004110     05  DK-SCAC-ID-B                 PIC X(04) VALUE SPACES.     00411000
004120     05  DK-SCAC-ID-E                 PIC X(04) VALUE '9999'.     00412000
004130     05  DK-PKSL-NBR-B                PIC X(10) VALUE SPACES.     00413000
004140     05  DK-PKSL-NBR-E                PIC X(10) VALUE             00414000
004150         '9999999999'.                                            00415000
004160     05  DK-PKSL-STAT-CDE-B           PIC X(02) VALUE SPACES.     00416000
004170     05  DK-PKSL-STAT-CDE-E           PIC X(02) VALUE '99'.       00417000
004180     05  DK-AC-STAT                   PIC X(02) VALUE SPACES.     00418000
004190     05  DK-IN-STAT                   PIC X(02) VALUE SPACES.     00419000
004200     05  DK-IP-STAT                   PIC X(02) VALUE SPACES.     00420000
004210     05  DK-CM-STAT                   PIC X(02) VALUE SPACES.     00421000
004220     05  DK-VE-STAT                   PIC X(02) VALUE SPACES.     00422000
004230     05  DK-REC-SEQ-NBR               PIC S9(9) COMP VALUE +0.    00423000
004240     05  DK-REC-SEQ-NBR-B             PIC S9(9) COMP VALUE +0.    00424000
004250     05  DK-REC-SEQ-NBR-E             PIC S9(9) COMP VALUE +9999. 00425000
004260     05  DK-REC-SEQ-NBR-UPD           PIC S9(9) COMP VALUE +0.    00426000
004270     05  DK-TYP-CDE                   PIC S9(4) COMP VALUE +4.    00427000
004280*    05  DK-MERCH-DEPT-NMBR           PIC X(03) VALUE SPACE.      00428000
004290*    05  DK-MERCH-CLASS-NMBR          PIC X(03) VALUE SPACE.      00429000
004300     05  DK-SUBCLASS-NBR              PIC X(03) VALUE SPACE.      00430000
004310     05  DK-MAJCLASS-NBR              PIC X(02) VALUE SPACE.      00431000
004320     05  DK-TICKET-DESC               PIC X(20) VALUE SPACE.      00432000
004330     05  DK-ENT-ID                    PIC S9(9) COMP VALUE +0.    00433000
004340     05  DK-MDSEAR-ID                 PIC S9(9) COMP VALUE +0.    00434000
004350     05  DK-CHARTC-SEQ-NBR            PIC S9(4) COMP VALUE +0.    00435000
004360     05  DK-TKT-TYP-SEQ-NBR           PIC S9(4) COMP VALUE +0.    00436000
004370     05  DK-VS-ID                     PIC S9(09) COMP VALUE +0.   00437000
004380     05  DK-PREPK-ID                  PIC S9(04) COMP VALUE ZERO. 00438000
004390     05  DK-ASN-OPER-NBR              PIC S9(04) COMP-3.          00439000
004400     05  DK-SEQ-NBR                   PIC S9(04) COMP.            00440022
004410                                                                  00441000
004420 01  DN-DB2-NULL-INDICATORS.                                      00442000
004430     05  DN-VEH-NBR                 PIC S9(04) COMP VALUE ZEROES. 00443000
004440                                                                  00444000
004450 01  PV-PROGRAM-VARIABLES.                                        00445000
004460     05  PV-NUMBER-OF-SELECTED-ITEM   PIC S9(9) VALUE ZERO        00446000
004470                                                COMP-3.           00447000
004480     05  PV-SUB                       PIC S9(4) VALUE ZERO        00448000
004490                                                COMP SYNC.        00449000
004500     05  PV-SUB-1                     PIC S9(4) VALUE ZERO        00450000
004510                                                COMP SYNC.        00451000
004520     05  PV-REMAINDER                 PIC S9(4) VALUE ZERO        00452000
004530                                                COMP SYNC.        00453000
004540     05  PV-READ-COUNT                PIC S9(9) VALUE ZERO        00454000
004550                                                COMP-3.           00455000
004560     05  PV-ITEMS-PROCESSED           PIC S9(9) VALUE ZERO        00456000
004570                                                COMP-3.           00457000
004580     05  PV-HOLD-SELECTED-ITEMS       PIC S9(9) VALUE ZERO        00458000
004590                                                COMP-3.           00459000
004600     05  PV-HOLD-ASN-NBR              PIC X(30).                  00460000
004610     05  PV-HOLD-OPER-UNT-ID          PIC S9(4) COMP.             00461000
004620     05  PV-ITEM-IN-USE               PIC S9(9) VALUE ZERO        00462000
004630                                                COMP-3.           00463000
004640     05  PV-TOP-ITEM                  PIC S9(9) VALUE ZERO        00464000
004650                                                COMP-3.           00465000
004660     05  PV-BOTTOM-ITEM               PIC S9(9) VALUE ZERO        00466000
004670                                                COMP-3.           00467000
004680     05  PV-TEMP-BLOCK-NUMBER         PIC S9(9) VALUE ZERO        00468000
004690                                                COMP-3.           00469000
004700     05  PV-DB2-COUNT                 PIC S9(9) VALUE ZERO        00470000
004710                                                COMP-3.           00471000
004720     05  PV-SMOOTH-COUNT              PIC S9(9) VALUE ZERO        00472000
004730                                                COMP-3.           00473000
004740     05  PV-TOT-SMOOTH-COUNT          PIC S9(9) VALUE ZERO        00474000
004750                                                COMP-3.           00475000
004760     05  PV-PACK-TRBL-COUNT           PIC S9(9) VALUE ZERO        00476000
004770                                                COMP-3.           00477000
004780     05  PV-LINE-TRBL-COUNT           PIC S9(9) VALUE ZERO        00478000
004790                                                COMP-3.           00479000
004800     05  PV-PO-TRBL-COUNT             PIC S9(9) VALUE ZERO        00480000
004810                                                COMP-3.           00481000
004820     05  PV-NEW-TROUBLE-COUNT         PIC S9(9) VALUE ZERO        00482000
004830                                                COMP-3.           00483000
004840     05  PV-DB2-DTL-CHK-COUNT         PIC S9(9) VALUE ZERO        00484000
004850                                                COMP-3.           00485000
004860     05  PV-BLOCK-NUMBER              PIC S9(4) VALUE ZERO        00486000
004870                                                COMP SYNC.        00487000
004880     05  PV-CICS-RESP                 PIC S9(4) VALUE ZERO        00488000
004890                                                COMP SYNC.        00489000
004900     05  PV-ITEM                      PIC S9(4) VALUE ZERO        00490000
004910                                                COMP SYNC.        00491000
004920     05  PV-NULL-IND                  PIC S9(4) VALUE ZERO        00492000
004930                                                COMP SYNC.        00493000
004940     05  PV-SEL-QUEUE-ITEM            PIC S9(4) VALUE ZERO        00494000
004950                                                COMP SYNC.        00495000
004960     05  PV-HIGHEST-BLOCK-WRITTEN     PIC S9(4) VALUE ZERO        00496000
004970                                                COMP SYNC.        00497000
004980     05  PV-LIST-ITEM-NUMBER          PIC S9(4) VALUE ZERO        00498000
004990                                                COMP SYNC.        00499000
005000     05  PV-FIRST-BLOCK-IN-ARRAY      PIC S9(4) VALUE ZERO        00500000
005010                                                COMP SYNC.        00501000
005020     05  PV-NEXT-BLOCK-IN-ARRAY       PIC S9(4) VALUE ZERO        00502000
005030                                                COMP SYNC.        00503000
005040     05  PV-PREV-BLOCK-IN-ARRAY       PIC S9(4) VALUE ZERO        00504000
005050                                                COMP SYNC.        00505000
005060     05  PV-FIRST-BLOCK-IN-RANGE      PIC S9(4) VALUE ZERO        00506000
005070                                                COMP SYNC.        00507000
005080     05  PV-LAST-BLOCK-IN-RANGE       PIC S9(4) VALUE ZERO        00508000
005090                                                COMP SYNC.        00509000
005100     05  PV-START-OF-SELECTED-RANGE   PIC S9(4) VALUE ZERO        00510000
005110                                                COMP SYNC.        00511000
005120     05  PV-END-OF-SELECTED-RANGE     PIC S9(4) VALUE ZERO        00512000
005130                                                COMP SYNC.        00513000
005140     05  PV-SQL-SUB                   PIC S9(4) VALUE ZERO        00514000
005150                                                COMP SYNC.        00515000
005160     05  PV-MATCHED-ITEMS             PIC S9(9) VALUE ZERO        00516000
005170                                                COMP.             00517000
005180     05  PV-UNMATCHED-ITEMS           PIC S9(9) VALUE ZERO        00518000
005190                                                COMP.             00519000
005200     05  PV-INPKSU-CRTN-CNT           PIC S9(9) VALUE ZERO        00520000
005210                                                COMP.             00521000
005220     05  PV-PBS-ERROR-COUNT           PIC S9(9) VALUE ZERO        00522000
005230                                                COMP.             00523000
005240     05  PV-LINE-QTY                  PIC S9(9) VALUE ZERO        00524000
005250                                                COMP.             00525000
005260     05  PV-UNMATCHED-IND             PIC S9(4) VALUE ZERO        00526000
005270                                                COMP.             00527000
005280     05  PV-MATCHED-IND               PIC S9(4) VALUE ZERO        00528000
005290                                                COMP.             00529000
005300     05  PV-LINE-QTY-IND              PIC S9(4) VALUE ZERO        00530000
005310                                                COMP.             00531000
005320     05  PV-LINE-NBR-IND              PIC S9(4) VALUE ZERO        00532000
005330                                                COMP.             00533000
005340     05  PV-COUNT-IND                 PIC S9(4) VALUE ZERO        00534000
005350                                                COMP.             00535000
005360     05  PV-RECDIS-COUNT              PIC S9(4) VALUE ZERO        00536000
005370                                                COMP.             00537000
005380     05  PV-COUNT-NOT-ACTIVE-PKSLIP   PIC S9(4) VALUE ZERO        00538000
005390                                                COMP.             00539000
005400     05  PV-COUNT-NOT-INACTIVE-PKSLIP PIC S9(4) VALUE ZERO        00540000
005410                                                COMP.             00541000
005420     05  PV-COUNT-LINE-ACTIVE-PKSLIP  PIC S9(4) VALUE ZERO        00542000
005430                                                COMP.             00543000
005440     05  PV-COUNT-PKITEM              PIC S9(9) VALUE ZERO        00544000
005450                                                COMP.             00545000
005460     05  PV-UNPKSL-COUNT              PIC S9(9) VALUE ZERO        00546000
005470                                                COMP.             00547000
005480     05  PV-PKSL-LNE-NBR              PIC S9(9) VALUE ZERO        00548000
005490                                                COMP.             00549000
005500     05  PV-ORIG-PKSL-ITM-QTY         PIC S9(9) VALUE ZERO        00550000
005510                                                COMP.             00551000
005520     05  PV-NEXT-LINE-NBR             PIC S9(9) VALUE +9000       00552000
005530                                                COMP.             00553000
005540     05  PV-PKSL-ITM-QTY              PIC S9(9) VALUE ZERO        00554000
005550                                                COMP.             00555000
005560     05  PV-FIRST-REC-SEQ-NBR         PIC S9(4) VALUE ZERO        00556000
005570                                                COMP.             00557000
005580     05  PV-SUM-STR-PLAN-QTY          PIC S9(9) VALUE ZERO        00558000
005590                                                COMP.             00559000
005600     05  PV-STR-PLAN-IND              PIC S9(4) VALUE ZERO        00560000
005610                                                COMP.             00561000
005620     05  PV-SAVE-PKSL-NBR             PIC X(10).                  00562000
005630     05  PV-SAVE-STORE-NBR            PIC 9(04).                  00563000
005640     05  PV-SAVE-ITEM                 PIC S9(4) VALUE ZERO        00564000
005650                                                COMP SYNC.        00565000
005660     05  PV-SAVE-FIELDS.                                          00566000
005670         10  PV-SAVE-PRO-NBR          PIC X(16).                  00567000
005680         10  PV-SAVE-BOL-NBR          PIC X(16).                  00568000
005690         10  PV-SAVE-SCAC-ID          PIC X(04).                  00569000
005700         10  PV-SAVE-VND-SHP-DTE      PIC X(10).                  00570000
005710     05  PV-DISPLAY-TASK              PIC 9(05).                  00571000
005720     05  PV-DISPLAY-NUMBER            PIC 9(05).                  00572000
005730     05  PV-NEW-STATUS                PIC X(02) VALUE SPACES.     00573000
005740     05  PV-TROUBLE-COUNT             PIC 9(03) VALUE ZEROS.      00574000
005750     05  PV-NOT-IN-TROUBLE-COUNT      PIC 9(03) VALUE ZEROS.      00575000
005760     05  PV-BULK-STR-CNT              PIC 9(04) VALUE ZEROS.      00576000
005770     05  PV-PACK-BY-STR-CNT           PIC 9(04) VALUE ZEROS.      00577000
005780     05  PV-DB2-TIMESTAMP             PIC X(26).                  00578000
005790     05  PV-CURRENT-DATE              PIC X(10).                  00579000
005800     05  PV-DISPLAY-PO                PIC  9(09) VALUE ZEROES.    00580000
005810     05  PV-DISPLAY-PO-RCVR           PIC  9(09) VALUE ZEROES.    00581000
005820     05  PV-MSG-KEYS-1.                                           00582000
005830         10  FILLER                   PIC X(09) VALUE ' OPER ID '.00583000
005840         10  PV-MSG-OPER-ID           PIC X(04) VALUE SPACES.     00584000
005850         10  FILLER                   PIC X(06) VALUE ' USER '.   00585000
005860         10  PV-MSG-USER-ID           PIC X(08) VALUE SPACES.     00586000
005870     05  PV-MSG-KEYS.                                             00587000
005880         10  FILLER                   PIC X(03) VALUE 'PO '.      00588000
005890* CHG0094517  EXPANDED PO FIELD FROM 7 TO 8                       00589018
005900         10  PV-MSG-KEY-PO            PIC X(08) VALUE SPACES.     00590013
005910         10  FILLER                   PIC X(05) VALUE ' SEQ '.    00591000
005920         10  PV-MSG-KEY-REC-SEQ-NBR.                              00592000
005930             15  PV-MSG-KEY-REC-SEQ-NBR-N                         00593000
005940                                      PIC 9(03) VALUE ZEROS.      00594000
005950         10  FILLER                   PIC X(06) VALUE ' LINE '.   00595000
005960         10  PV-MSG-KEY-PO-LNE-NBR.                               00596000
005970             15  PV-MSG-KEY-PO-LNE-NBR-N                          00597000
005980                                      PIC 9(03) VALUE ZEROS.      00598000
005990         10  FILLER                   PIC X(05) VALUE ' STR '.    00599000
006000         10  PV-MSG-KEY-STR-NBR       PIC 9(04) VALUE ZERO.       00600000
006010     05  PV-PO-RCVR.                                              00601000
006020* CHG0094517  EXPANDED PO FIELD FROM 7 TO 8                       00602018
006030         10  PV-PO                      PIC 9(08).                00603013
006040         10  FILLER                     PIC X(01) VALUE '-'.      00604000
006050         10  PV-RCVR                    PIC 9(04).                00605000
006060     05  PV-PRO-NBR-R                 PIC X(16) VALUE SPACES.     00606000
006070                                                                  00607000
006080     05  PV-CHAR-COUNT                PIC S9(04)  VALUE ZEROS     00608000
006090                                                     COMP SYNC.   00609000
006100     05  PV-PRO-BEGIN                 PIC S9(04)  VALUE ZEROS     00610000
006110                                                     COMP SYNC.   00611000
006120     05  PV-CICS-MSG-AREA             PIC X(75)  VALUE SPACE.     00612000
006130     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     00613000
006140                                                     COMP SYNC.   00614000
006150     05  PV-STACK-SUB                 PIC S9(04) VALUE ZERO.      00615000
006160     05  PV-LAST-PARAGRAPH            PIC X(40)  VALUE SPACE.     00616000
006170     05  PV-BOMB-TMST                 PIC X(26)  VALUE SPACE.     00617000
006180     05  PV-ZAP-NUMBER                PIC ZZZ.                    00618000
006190     05  PV-ZAP-NUMBER2               PIC ZZZ.                    00619000
006200     05  PV-ZAP-THREE                 PIC Z(2)9.                  00620000
006210                                                                  00621000
006220     05  PV-PREV-PO-PREPK-ID          PIC S9(4) VALUE ZERO COMP.  00622000
006230     05  PV-DRIVER-LNE-CNT            PIC S9(4) COMP VALUE ZERO.  00623000
006240     05  PV-PREPACK-TROUBLE-VARIABLE  PIC X(22) VALUE SPACES.     00624000
006250     05  PV-TRBL-POINTER              PIC 999   VALUE 1.          00625000
006260     05  PV-ZAP2X.                                                00626000
006270         10  PV-ZAP2                  PIC ZZ.                     00627000
006280     05  PV-ZAP3X.                                                00628000
006290         10  PV-ZAP3                  PIC ZZZ.                    00629000
006300     05  PV-RETRY-COUNTER             PIC S9(04) VALUE +0         00630000
006310                                                 COMP SYNC.       00631000
006320     05  PV-LOCATION-NBR              PIC 9(04).                  00632000
006330                                                                  00633000
006340     05  PV-RETURN-MSG                PIC X(17).                  00634000
006350* 3/19/13                                                         00635006
006360     05  PV-PO-PBS-ERROR              PIC  S9(9) COMP.            00636006
006370     05  PV-PO-ACTIVE-PKSLIP          PIC  S9(9) COMP.            00637006
006380     05  PV-PO-INACTIVE-PKSLIP        PIC  S9(9) COMP.            00638008
006390     05  PV-PO-ACTIVE-RECITM          PIC  S9(9) COMP.            00639008
006400     05  PV-PO-CASEPK-DWNLD           PIC  S9(9) COMP.            00640008
006410     05  PV-PO-IN-TROUBLE             PIC  S9(9) COMP.            00641008
006420     05  PV-PO-SPEC-INSTR             PIC  S9(9) COMP.            00642008
006430     05  PV-PO-PKITEM                 PIC  S9(9) COMP.            00643008
006440     05  PV-PO-LINES-IN-PACK          PIC  S9(9) COMP.            00644008
006450     05  PV-PO-SMOOTH-CRTNS           PIC  S9(9) COMP.            00645008
006451//* PRB0052549 START                                              00645119
006452     05  PV-PO-NBR-1                  PIC  9(07).                 00645219
006453     05  PV-PO-NBR-A                  PIC  X(08).                 00645319
006454//* END                                                           00645419
006460                                                                  00646008
006461* DMH - 10/11/19 - BEGIN                                          00646120
006462     05  PV-DISP-SQL                  PIC -999   VALUE ZEROES.    00646248
006463     05  PV-DISP-AUTRBL03-NBR         PIC Z(04)  VALUE ZEROES.    00646348
006464     05  PV-DISP-TRBRSN               PIC  Z(04) VALUE ZEROES.    00646448
006465     05  PV-DISP-TRBL                 PIC  Z(04) VALUE ZEROES.    00646548
006466     05  PV-DISP-PO                   PIC  9(09) VALUE ZEROES.    00646648
006467     05  PV-DISP-RCVR                 PIC  9(04) VALUE ZEROES.    00646748
006468     05  PV-DISP-SSCC                 PIC  9(18) VALUE ZEROES.    00646848
006469     05  PV-DISP-OPER-B               PIC -9(04) VALUE ZEROES.    00646948
006470     05  PV-DISP-OPER-E               PIC -9(04) VALUE ZEROES.    00647048
006471     05  PV-DISP-FCLTY-B              PIC -9(04) VALUE ZEROES.    00647148
006472     05  PV-DISP-FCLTY-E              PIC -9(04) VALUE ZEROES.    00647248
006474     05  PV-DISP-REC-SEQ-B            PIC -9(04) VALUE ZEROES.    00647420
006475     05  PV-DISP-REC-SEQ-E            PIC -9(04) VALUE ZEROES.    00647520
006476     05  PV-DISP-PKSL-NBR-B           PIC -9(06) VALUE ZEROES.    00647620
006477     05  PV-DISP-PKSL-NBR-E           PIC -9(06) VALUE ZEROES.    00647720
006478     05  PV-DISP-BOL-NBR-B            PIC  X(16) VALUE SPACES.    00647820
006479     05  PV-DISP-BOL-NBR-E            PIC  X(16) VALUE SPACES.    00647920
006480     05  PV-DISP-PRO-NBR-B            PIC  X(10) VALUE SPACES.    00648020
006481     05  PV-DISP-PRO-NBR-E            PIC  X(10) VALUE SPACES.    00648120
006482     05  PV-MSG-STRING-1              PIC  X(80) VALUE SPACES.    00648220
006483     05  PV-MSG-STRING-2              PIC  X(80) VALUE SPACES.    00648320
006484     05  PV-MSG-STRING-3              PIC  X(80) VALUE SPACES.    00648420
006485* DMH - 10/11/19 - END                                            00648520
006486     05  PV-AUTRBL03-NBR              PIC  S9(10)V9(5) COMP-3.    00648638
006487     05  PV-CNTLFLOW-TRBRSN           PIC  S9(10)V9(5) COMP-3.    00648738
006488     05  PV-HAS-PRO-TRBL-CNT          PIC  S9(09)  COMP.          00648838
006489                                                                  00648938
006490 01  LQW-LIST-QUEUE-WORK-AREA.                                    00649038
006491     05  LQW-BLOCK-MODIFIED           PIC X(01)  VALUE SPACE.     00649138
006492     05  LQW-ITEM-ENTRIES             OCCURS 12 TIMES             00649238
006500                                      INDEXED BY LQW-IDX.         00650000
006510         10  LQW-LIST-ITEM-NUMBER     PIC S9(9)  COMP-3.          00651000
006520         10  LQW-TEMP-SELECTED-SW     PIC X(01).                  00652000
006530             88  LQW-TEMP-SELECT                 VALUE 'S'.       00653000
006540         10  LQW-SELECTED-SW          PIC X(01).                  00654000
006550             88  LQW-SELECT                      VALUE 'S'.       00655000
006560             88  LQW-DESELECT                    VALUE ' '.       00656000
006570         10  LQW-ACTION               PIC X(03).                  00657000
006580         10  LQW-REC-SEQ-NBR          PIC 9(04).                  00658000
006590         10  LQW-PKSL-STAT-CDE        PIC X(02).                  00659000
006600         10  LQW-STR-DEST-NBR         PIC 9(04).                  00660000
006610         10  LQW-PRO-NBR              PIC X(10).                  00661000
006620         10  LQW-BOL-NBR              PIC X(16).                  00662000
006630         10  LQW-CARTON-COUNT         PIC 9(05).                  00663000
006640         10  LQW-SCAC-ID              PIC X(04).                  00664000
006650         10  LQW-OPER-UNT-ID          PIC 9(04).                  00665000
006660         10  LQW-PKSL-ITM-QTY         PIC 9(06).                  00666000
006670         10  LQW-PKSL-NBR             PIC X(10).                  00667000
006680         10  LQW-SEQ-NBR              PIC S9(4)  COMP.            00668000
006690         10  LQW-VND-SHP-DTE          PIC X(10).                  00669000
006700         10  LQW-UPC-PROBLEM-SW       PIC X.                      00670000
006710             88  LQW-UPC-PROBLEM      VALUE 'Y'.                  00671000
006720         10  LQW-INPKSU-COUNT         PIC 9(05).                  00672000
006730         10  LQW-PBS-ERRORS-SW          PIC  X(01).               00673000
006740             88  LQW-PBS-ERRORS-FOUND               VALUE 'Y'.    00674000
006750                                                                  00675000
006760******************************************************************00676000
006770*    SELECTED ITEMS TEMPORARY STORAGE QUEUE ITEM LAYOUT           00677000
006780******************************************************************00678000
006790     COPY RCWS013.                                                00679000
006800                                                                  00680000
006810******************************************************************00681000
006820*    SELECTED ITEMS TEMPORARY STORAGE QUEUE ITEM LAYOUT           00682000
006830*    FROM THE SHIPMENT/PO LIST PROGRAM                            00683000
006840******************************************************************00684000
006850     COPY TRWS018.                                                00685000
006860                                                                  00686000
006870******************************************************************00687000
006880*    SELECTED ITEMS TEMPORARY STORAGE QUEUE ITEM LAYOUT           00688000
006890*    FROM THE TRIP PO/RECIEVER LIST (PRINT PACKAGE                00689000
006900******************************************************************00690000
006910     COPY DSWS002.                                                00691000
006920                                                                  00692000
006930******************************************************************00693000
006940*   COPYBOOK FOR THE FIELDS PASSED TO THE TROUBLE LINE SUBROUTINE*00694000
006950******************************************************************00695000
006960     COPY TMWS500.                                                00696000
006970                                                                  00697000
006980     COPY TMWS508.                                                00698000
006990                                                                  00699000
007000     COPY RCWS031.                                                00700000
007010                                                                  00701000
007020***************************************************************** 00702000
007030*    COPY BOOKS FOR THE VALIDATION ROUTINE FOR THE FREIGHT BILL   00703000
007040*    BILL OF LADING, AND VEHICLE NUMBER                           00704000
007050***************************************************************** 00705000
007060     COPY RCWS023.                                                00706000
007070                                                                  00707000
007080*---------------------------------------------------------------* 00708000
007090* COPYBOOK FOR LOGISTICS DOMAIN ITEM ACCESS MODULE              * 00709000
007100*---------------------------------------------------------------* 00710000
007110     COPY XLWS001.                                                00711000
007120                                                                  00712000
007130*----------------------------------------------------------------*00713000
007140*  COPYBOOK FOR LOCATION CALL MODULE                              00714000
007150*-----------------------------------------------------------------00715000
007160     COPY XLWS071.                                                00716000
007170                                                                  00717000
007180                                                                  00718000
007190***************************************************************** 00719000
007200*   RCWS040 - IS THE LAYOUT THAT IS USED TO PASS INFO TO THE    * 00720000
007210*             AUTOVERIFY (AUTOVE) ELIGIBILITY MODULE (RCKUT127).* 00721000
007220***************************************************************** 00722000
007230     COPY RCWS040.                                                00723000
007240                                                                  00724000
007250/                                                                 00725000
007260***************************************************************** 00726000
007270* COPYBOOK FOR WMS VENDOR SHIPMENT CONTROL MODULE               * 00727000
007280***************************************************************** 00728000
007290     COPY WSWS001.                                                00729000
007300/                                                                 00730000
007310*---------------------------------------------------------------* 00731000
007320**  SECURITY SUBROUTINE PARAMETERS                                00732000
007330*----------------------------------------------------------------*00733000
007340     COPY DPWS008.                                                00734000
007350                                                                  00735000
007360******************************************************************00736000
007370*    BMS MAP                                                      00737000
007380******************************************************************00738000
007390     COPY RCKM213.                                                00739000
007400                                                                  00740000
007410 01  MR-OCCURS-LAYOUT                 REDEFINES RC213AO.          00741000
007420* CHG0094517  EXPANDED FILLER FIELD FROM 162 TO 163               00742018
007430     05  FILLER                       PIC X(163).                 00743016
007440     05  MR-SCROLL-AREA               OCCURS 12 TIMES.            00744000
007450         10  MR-SELECTL               PIC S9(4) COMP.             00745000
007460         10  MR-SELECTA               PIC X.                      00746000
007470         10  MR-SELECTC               PIC X.                      00747000
007480         10  MR-SELECTH               PIC X.                      00748000
007490         10  MR-SELECTI               PIC X.                      00749000
007500                                                                  00750000
007510         10  MR-RCVR-SEQ-NBR-L        PIC S9(4) COMP.             00751000
007520         10  MR-RCVR-SEQ-NBR-A        PIC X.                      00752000
007530         10  MR-RCVR-SEQ-NBR-C        PIC X.                      00753000
007540         10  MR-RCVR-SEQ-NBR-H        PIC X.                      00754000
007550         10  MR-RCVR-SEQ-NBR          PIC X(04).                  00755000
007560                                                                  00756000
007570         10  MR-OP-L                  PIC S9(4) COMP.             00757000
007580         10  MR-OP-A                  PIC X.                      00758000
007590         10  MR-OP-C                  PIC X.                      00759000
007600         10  MR-OP-H                  PIC X.                      00760000
007610         10  MR-OP                    PIC X(04).                  00761000
007620                                                                  00762000
007630         10  MR-STATUS-L              PIC S9(4) COMP.             00763000
007640         10  MR-STATUS-A              PIC X.                      00764000
007650         10  MR-STATUS-C              PIC X.                      00765000
007660         10  MR-STATUS-H              PIC X.                      00766000
007670         10  MR-STATUS                PIC X(02).                  00767000
007680                                                                  00768000
007690         10  MR-STR-DEST-NBR-L        PIC S9(4) COMP.             00769000
007700         10  MR-STR-DEST-NBR-A        PIC X.                      00770000
007710         10  MR-STR-DEST-NBR-C        PIC X.                      00771000
007720         10  MR-STR-DEST-NBR-H        PIC X.                      00772000
007730         10  MR-STR-DEST-NBR          PIC X(04).                  00773000
007740                                                                  00774000
007750         10  MR-PRO-NBR-L             PIC S9(4) COMP.             00775000
007760         10  MR-PRO-NBR-A             PIC X.                      00776000
007770         10  MR-PRO-NBR-C             PIC X.                      00777000
007780         10  MR-PRO-NBR-H             PIC X.                      00778000
007790         10  MR-PRO-NBR               PIC X(10).                  00779000
007800                                                                  00780000
007810         10  MR-BOL-NBR-L             PIC S9(4) COMP.             00781000
007820         10  MR-BOL-NBR-A             PIC X.                      00782000
007830         10  MR-BOL-NBR-C             PIC X.                      00783000
007840         10  MR-BOL-NBR-H             PIC X.                      00784000
007850         10  MR-BOL-NBR               PIC X(16).                  00785000
007860                                                                  00786000
007870         10  MR-CARTONS-L             PIC S9(4) COMP.             00787000
007880         10  MR-CARTONS-A             PIC X.                      00788000
007890         10  MR-CARTONS-C             PIC X.                      00789000
007900         10  MR-CARTONS-H             PIC X.                      00790000
007910         10  MR-CARTONS.                                          00791000
007920             15  MR-CARTONS-EDITED    PIC ZZZZ9.                  00792000
007930                                                                  00793000
007940         10  MR-INPKSU-CNT-L          PIC S9(4) COMP.             00794000
007950         10  MR-INPKSU-CNT-A          PIC X.                      00795000
007960         10  MR-INPKSU-CNT-C          PIC X.                      00796000
007970         10  MR-INPKSU-CNT-H          PIC X.                      00797000
007980         10  MR-INPKSU-CNT.                                       00798000
007990             15  MR-INPKSU-CNT-EDITED PIC ZZZZ9.                  00799000
008000                                                                  00800000
008010         10  MR-UNITS-L               PIC S9(4) COMP.             00801000
008020         10  MR-UNITS-A               PIC X.                      00802000
008030         10  MR-UNITS-C               PIC X.                      00803000
008040         10  MR-UNITS-H               PIC X.                      00804000
008050         10  MR-UNITS.                                            00805000
008060             15  MR-UNITS-EDITED      PIC ZZZZZ9.                 00806000
008070                                                                  00807000
008080         10  MR-PACK-SLIP-L           PIC S9(4) COMP.             00808000
008090         10  MR-PACK-SLIP-A           PIC X.                      00809000
008100         10  MR-PACK-SLIP-C           PIC X.                      00810000
008110         10  MR-PACK-SLIP-H           PIC X.                      00811000
008120         10  MR-PACK-SLIP             PIC X(10).                  00812000
008130/                                                                 00813000
008140******************************************************************00814000
008150*    BMS ATTRIBUTES                                               00815000
008160******************************************************************00816000
008170     COPY DPWS015.                                                00817000
008180                                                                  00818000
008190******************************************************************00819000
008200*    FUNCTION KEYS                                                00820000
008210******************************************************************00821000
008220     COPY DPWS016.                                                00822000
008230                                                                  00823000
008240******************************************************************00824000
008250*    PARAMETER LIST FOR NUMERIC EDIT SUBROUTINE                   00825000
008260******************************************************************00826000
008270     COPY DPWS010I.                                               00827000
008280                                                                  00828000
008290******************************************************************00829000
008300*    PARAMETER LIST FOR CICS API                                  00830000
008310******************************************************************00831000
008320     COPY DPWS030.                                                00832000
008321     COPY DPWS930.                                                00832125
008330                                                                  00833000
008340******************************************************************00834000
008350*    GLOBAL COMMUNICATION AREA                                    00835000
008360******************************************************************00836000
008370     COPY DPWS020.                                                00837000
008380     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                00838000
008390                                                                  00839000
008400******************************************************************00840000
008410*    INTER-APPLICATION COMMUNICATION AREA                         00841000
008420*    RCWS012 = INPUT FROM CRITERIA SPECIFICATION PROGRAM          00842000
008430*    RCWS015 = OUTPUT TO PACK SLIP HEADER MAINTENANCE PROGRAM     00843000
008440*    TRWS017 = INPUT FROM SHIPMENT/PO LIST PROGRAM.               00844000
008450*    DSWS003 = INPUT FROM TRIP/PO RECEIVER LIST (PRINT PACKAGE)   00845000
008460******************************************************************00846000
008470         10  INTER-APPL-COMM-AREA       PIC X(200).               00847000
008480     COPY RCWS012.                                                00848000
008490     COPY RCWS015.                                                00849000
008500     COPY TRWS017.                                                00850000
008510     COPY TRWS001.                                                00851000
008520     COPY DSWS003.                                                00852000
008530     COPY SUWS046.                                                00853000
008540                                                                  00854000
008550******************************************************************00855000
008560*    APPLICATION SPECIFIC COMMUNICATION AREA                      00856000
008570******************************************************************00857000
008580         10  ASC-SPECIFIC-COMMAREA.                               00858000
008590             15  ASC-LIST-HEADER-INFO.                            00859000
008600                 20  ASC-KEY-PO-NBR.                              00860000
008610* CHG0094517  EXPANDED PO FIELD FROM 7 TO 8                       00861018
008620                     25  ASC-KEY-PO-NBR-N       PIC 9(08).        00862013
008630                     25  ASC-KEY-PO-NBR-A REDEFINES               00863000
008640                                          ASC-KEY-PO-NBR-N        00864000
008650                                                PIC X(08).        00865013
008660                 20  ASC-KEY-OPER-UNT-ID        PIC 9(04).        00866000
008670                 20  ASC-KEY-FCLTY-ID           PIC 9(04).        00867000
008680                 20  ASC-KEY-VENDOR-NAME        PIC X(30).        00868000
008690                 20  ASC-KEY-PKSL-STAT-CDES.                      00869000
008700                     25  ASC-KEY-AC-STAT        PIC X(02).        00870000
008710                     25  ASC-KEY-IN-STAT        PIC X(02).        00871000
008720                     25  ASC-KEY-IP-STAT        PIC X(02).        00872000
008730                     25  ASC-KEY-CM-STAT        PIC X(02).        00873000
008740                     25  ASC-KEY-VE-STAT        PIC X(02).        00874000
008750                 20  ASC-KEY-REC-SEQ-NBR        PIC 9(04).        00875000
008760                 20  ASC-KEY-PKSL-NBR           PIC X(10).        00876000
008770                 20  ASC-KEY-BOL-NBR            PIC X(16).        00877000
008780                 20  ASC-KEY-PRO-NBR            PIC X(16).        00878000
008790                 20  ASC-KEY-PRE-TKT-IND        PIC X(01).        00879000
008800                 20  ASC-KEY-TKT-FMT-ID         PIC X(06).        00880000
008810                 20  ASC-KEY-EXPTED-CART-CNT    PIC S9(9).        00881045
008820                 20  ASC-TRNSCRP-PENDING-SW     PIC  X(1).        00882000
008830                     88  ASC-TRNSCRP-PENDING      VALUE 'Y'.      00883000
008840                     88  ASC-TRNSCRP-NOT-PENDING  VALUE 'N'.      00884000
008850                 20  ASC-INACTIVATE-PENDING-SW  PIC  X(1).        00885000
008860                     88  ASC-INACTIVATE-PENDING     VALUE 'Y'.    00886000
008870                     88  ASC-INACTIVATE-NOT-PENDING VALUE 'N'.    00887000
008880                 20  ASC-CARTON-TOTAL           PIC 9(06).        00888000
008890                 20  ASC-UNIT-TOTAL             PIC 9(08).        00889000
008900                 20  ASC-SAVE-F2-ACTION         PIC X(01).        00890000
008910                 20  ASC-SHIPT-UNT-ID           PIC S9(18) COMP-3.00891000
008920                 20  ASC-AUTO-VE-SW             PIC X(01).        00892000
008930                     88 ASC-AUTO-VE               VALUE 'Y'.      00893000
008940                     88 ASC-AUTO-VE-NO            VALUE 'N'.      00894000
008950                                                                  00895000
008960             15  ASC-BLOCK-ENTRIES  OCCURS 2 TIMES.               00896000
008970                 20  ASC-BLOCK-MODIFIED-SW           PIC X.       00897000
008980                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   00898000
008990                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   00899000
009000                                                                  00900000
009010                 20  ASC-ITEM-ARRAY.                              00901000
009020                     25  ASC-ITEM-ENTRIES  OCCURS 12 TIMES.       00902000
009030                         30  ASC-LIST-ITEM-NUMBER    PIC S9(9)    00903000
009040                                                     COMP-3.      00904000
009050                         30  ASC-TEMP-SELECTED-SW    PIC X.       00905000
009060                             88  ASC-VALID-SELECT    VALUE ' '    00906000
009070                                                           'S'    00907000
009080                                                           'B'    00908000
009090                                                           'E'.   00909000
009100                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   00910000
009110                             88  ASC-TEMP-SELECT     VALUE 'S'.   00911000
009120                             88  ASC-TEMP-BEGIN      VALUE 'B'.   00912000
009130                             88  ASC-TEMP-END        VALUE 'E'.   00913000
009140                         30  ASC-SELECTED-SW         PIC  X.      00914000
009150                             88  ASC-NO-SELECT       VALUE ' '.   00915000
009160                             88  ASC-SELECT          VALUE 'S'.   00916000
009170                             88  ASC-BEGIN           VALUE 'B'.   00917000
009180                             88  ASC-END             VALUE 'E'.   00918000
009190                         30  ASC-ACTION              PIC XXX.     00919000
009200                         30  ASC-REC-SEQ-NBR.                     00920000
009210                             35  ASC-REC-SEQ-NBR-N   PIC 9(04).   00921000
009220                         30  ASC-PKSL-STAT-CDE       PIC X(02).   00922000
009230                         30  ASC-STR-DEST-NBR.                    00923000
009240                             35  ASC-STR-DEST-NBR-N  PIC 9(04).   00924000
009250                         30  ASC-PRO-NBR             PIC X(10).   00925000
009260                         30  ASC-BOL-NBR             PIC X(16).   00926000
009270                         30  ASC-CARTON-COUNT        PIC 9(05).   00927000
009280                         30  ASC-SCAC-ID             PIC X(04).   00928000
009290                         30  ASC-OPER-UNT-ID         PIC 9(04).   00929000
009300                         30  ASC-PKSL-ITM-QTY.                    00930000
009310                             35  ASC-PKSL-ITM-QTY-N  PIC 9(06).   00931000
009320                         30  ASC-PKSL-NBR            PIC X(10).   00932000
009330                         30  ASC-SEQ-NBR             PIC S9(4)    00933000
009340                                                     COMP.        00934000
009350                         30  ASC-VND-SHP-DTE         PIC X(10).   00935000
009360                         30  ASC-UPC-PROBLEM-SW      PIC X.       00936000
009370                             88  ASC-UPC-PROBLEM     VALUE 'Y'.   00937000
009380                         30  ASC-INPKSU-COUNT        PIC  9(05).  00938000
009390                         30  ASC-PBS-ERRORS-SW      PIC  X(01).   00939000
009400                             88  ASC-PBS-ERRORS-FOUND VALUE 'Y'.  00940000
009410                                                                  00941000
009420             15  ASC-BLK-SUB                         PIC S9(4)    00942000
009430                                                     COMP SYNC.   00943000
009440             15  ASC-ITEM-SUB                        PIC S9(4)    00944000
009450                                                     COMP SYNC.   00945000
009460             15  ASC-SEL-SUB                         PIC S9(4)    00946000
009470                                                     COMP.        00947000
009480             15  ASC-SEL-ITEM                        PIC S9(4)    00948000
009490                                                     COMP.        00949000
009500             15  ASC-NUMBER-OF-ITEMS-READ            PIC S9(9)    00950000
009510                                                     COMP-3.      00951000
009520             15  ASC-NUMBER-OF-SELECTED-ITEMS        PIC S9(9)    00952000
009530                                                     COMP-3.      00953000
009540             15  ASC-SELECTED-CARTON-COUNT           PIC S9(9)    00954000
009550                                                     COMP-3.      00955000
009560             15  ASC-NUMBER-OF-TS-ITEMS              PIC S9(5)    00956000
009570                                                     COMP-3.      00957000
009580             15  ASC-ITEMS-DISPLAYED                 PIC S999     00958000
009590                                                     COMP-3.      00959000
009600             15  ASC-ITEM-AT-TOP-OF-PANEL            PIC S9(9)    00960000
009610                                                     COMP-3.      00961000
009620             15  ASC-ITEM-AT-BOT-OF-PANEL            PIC S9(9)    00962000
009630                                                     COMP-3.      00963000
009640             15  ASC-HIGHEST-BLOCK-WRITTEN           PIC S9(4)    00964000
009650                                                     COMP SYNC.   00965000
009660             15  ASC-START-OF-SELECTED-RANGE         PIC S9(9)    00966000
009670                                                     COMP-3.      00967000
009680             15  ASC-END-OF-SELECTED-RANGE           PIC S9(9)    00968000
009690                                                     COMP-3.      00969000
009700             15  ASC-TEMP-QUEUE-UPDATE-SW            PIC X.       00970000
009710                 88  ASC-UPDATE-TSQ                  VALUE 'Y'.   00971000
009720                 88  ASC-NO-TSQ-UPDATE               VALUE ' '.   00972000
009730             15  ASC-LIST-QUEUE-NAME.                             00973000
009740                 20  ASC-LIST-TERM-ID                PIC X(4).    00974000
009750                 20  ASC-LIST-TASK-NUMBER            PIC S9(5)    00975000
009760                                                     COMP-3.      00976000
009770                 20  ASC-LIST-SEQ                    PIC 9.       00977000
009780             15  ASC-SEL-QUEUE-NAME-IN               PIC X(8).    00978000
009790             15  ASC-SEL-QUEUE-NAME-OUT.                          00979000
009800                 20  ASC-SEL-TERM-ID                 PIC X(4).    00980000
009810                 20  ASC-SEL-TASK-NUMBER             PIC S9(5)    00981000
009820                                                     COMP-3.      00982000
009830                 20  ASC-SEL-SEQ                     PIC 9.       00983000
009840             15  ASC-START-ITEM-REQUEST.                          00984000
009850                 20  ASC-START-ITEM-REQUEST-N        PIC 9(5).    00985000
009860             15  ASC-PACK-SLIPS-SW                   PIC X.       00986000
009870                 88  ASC-MORE-PACK-SLIPS             VALUE 'Y'.   00987000
009880                 88  ASC-NO-MORE-PACK-SLIPS          VALUE 'N'.   00988000
009890             15  ASC-ORIGINATION-IND                 PIC X.       00989000
009900                 88  ASC-CAME-FROM-PACK-SLIP         VALUE 'P'.   00990000
009910                 88  ASC-CAME-FROM-RCVG              VALUE 'R'.   00991000
009920                 88  ASC-CAME-FROM-EXCPT             VALUE 'X'.   00992000
009930             15  ASC-READ-ONLY-SW                    PIC X.       00993000
009940                 88  ASC-READ-ONLY                   VALUE 'R'.   00994000
009950                 88  ASC-UPDATES-ALLOWED             VALUE 'U'.   00995000
009960             15  ASC-PACK-BY-ST-IND                  PIC X.       00996000
009970             15  ASC-STORE-TYPE-CODE                 PIC XX.      00997000
009980             15  ASC-USE-SELECTION-QUEUE-IND         PIC X(1).    00998000
009990                 88  ASC-USE-SELECTION-QUEUE         VALUE 'Y'.   00999000
010000             15  ASC-SPEC-INSTR                      PIC X(26).   01000000
010010             15  ASC-PACKAGE-TYPE-CDE                PIC X(01).   01001000
010020             15  ASC-TRECEIV-PKGNG-CDE               PIC X(01).   01002000
010030             15  ASC-ENT-ID           PIC S9(09) COMP.            01003000
010040             15  ASC-HOLD-INTER-APPL                 PIC X(200).  01004000
010050/                                                                 01005000
010060******************************************************************01006000
010070*    ABEND PROCESSING                                             01007000
010080******************************************************************01008000
010090     COPY DPWS013.                                                01009000
010100/                                                                 01010000
010110******************************************************************01011000
010120*    PREPACK VERIFICATION                                         01012000
010130******************************************************************01013000
010140     COPY RCWS806.                                                01014000
010150/                                                                 01015000
010160******************************************************************01016000
010170*    DB2 SQL COMMUNICATION AREA                                   01017000
010180******************************************************************01018000
010190     EXEC SQL                                                     01019000
010200          INCLUDE SQLCA                                           01020000
010210     END-EXEC.                                                    01021000
010220/                                                                 01022000
010230******************************************************************01023000
010240*    DB2 DCLGEN FOR DISTRIBUTION HEADER TABLE                     01024000
010250******************************************************************01025000
010260     EXEC SQL                                                     01026000
010270          INCLUDE TDISTHD                                         01027000
010280     END-EXEC.                                                    01028000
010290/                                                                 01029000
010300******************************************************************01030000
010310*    DB2 DCLGEN FOR PACK SLIP HEADER TABLE                        01031000
010320******************************************************************01032000
010330     EXEC SQL                                                     01033000
010340          INCLUDE TPKSLIP                                         01034000
010350     END-EXEC.                                                    01035000
010360/                                                                 01036000
010370******************************************************************01037000
010380*    DB2 DCLGEN FOR PACK SLIP ITEM TABLE                          01038000
010390******************************************************************01039000
010400     EXEC SQL                                                     01040000
010410          INCLUDE TPKITEM                                         01041000
010420     END-EXEC.                                                    01042000
010430/                                                                 01043000
010440******************************************************************01044000
010450*    DB2 DCLGEN FOR UNMATCHED PACK SLIP ITEM TABLE                01045000
010460******************************************************************01046000
010470     EXEC SQL                                                     01047000
010480          INCLUDE TUNPKSL                                         01048000
010490     END-EXEC.                                                    01049000
010500/                                                                 01050000
010510******************************************************************01051000
010520*    DB2 DCLGEN FOR PURCHASE ORDER TABLE                          01052000
010530******************************************************************01053000
010540     EXEC SQL                                                     01054000
010550          INCLUDE TPURCHS                                         01055000
010560     END-EXEC.                                                    01056000
010570/                                                                 01057000
010580******************************************************************01058000
010590*    DB2 DCLGEN FOR PO INSTRUCTION TABLE                          01059000
010600******************************************************************01060000
010610     EXEC SQL                                                     01061000
010620          INCLUDE TPOINST                                         01062000
010630     END-EXEC.                                                    01063000
010640/                                                                 01064000
010650******************************************************************01065000
010660*    DB2 DCLGEN FOR PURCHASE ORDER LINE ITEM TABLE                01066000
010670******************************************************************01067000
010680     EXEC SQL                                                     01068000
010690          INCLUDE TPURITM                                         01069000
010700     END-EXEC.                                                    01070000
010710/                                                                 01071000
010720******************************************************************01072000
010730*    DB2 DCLGEN FOR VENDOR ENTERPRISE NAME TABLE                  01073000
010740******************************************************************01074000
010750     EXEC SQL                                                     01075000
010760          INCLUDE TENTNME                                         01076000
010770     END-EXEC.                                                    01077000
010780/                                                                 01078000
010790******************************************************************01079000
010800*    DB2 DCLGEN FOR THE RECEIVER TABLE                            01080000
010810******************************************************************01081000
010820     EXEC SQL                                                     01082000
010830          INCLUDE TRECEIV                                         01083000
010840     END-EXEC.                                                    01084000
010850/                                                                 01085000
010860******************************************************************01086000
010870*    DB2 DCLGEN FOR THE RECEIVER ITEM TABLE                       01087000
010880******************************************************************01088000
010890     EXEC SQL                                                     01089000
010900          INCLUDE TRECITM                                         01090000
010910     END-EXEC.                                                    01091000
010920/                                                                 01092000
010930******************************************************************01093000
010940*    DB2 DCLGEN FOR THE RECEIPT DISTRIBUTION TABLE                01094000
010950******************************************************************01095000
010960     EXEC SQL                                                     01096000
010970          INCLUDE TRECDIS                                         01097000
010980     END-EXEC.                                                    01098000
010990/                                                                 01099000
011000******************************************************************01100000
011010*    DB2 DCLGEN FOR THE ODD UNIT TABLE (RCT_VRFD_ODD_UNT)         01101000
011020******************************************************************01102000
011030     EXEC SQL                                                     01103000
011040          INCLUDE RCT00009                                        01104000
011050     END-EXEC.                                                    01105000
011060/                                                                 01106000
011070******************************************************************01107000
011080*    DB2 DCLGEN FOR ALLOCATION PLAN TABLE                         01108000
011090******************************************************************01109000
011100     EXEC SQL                                                     01110000
011110          INCLUDE TALLPLN                                         01111000
011120     END-EXEC.                                                    01112000
011130/                                                                 01113000
011140******************************************************************01114000
011150*    DB2 DCLGEN FOR MERCHANDISE STORE DISTRIBUTION PLAN TABLE     01115000
011160******************************************************************01116000
011170     EXEC SQL                                                     01117000
011180          INCLUDE TMESTDS                                         01118000
011190     END-EXEC.                                                    01119000
011200/                                                                 01120000
011210******************************************************************01121000
011220*    DB2 DCLGEN FOR WORK ORDER TABLE                              01122000
011230******************************************************************01123000
011240     EXEC SQL                                                     01124000
011250          INCLUDE TWRKORD                                         01125000
011260     END-EXEC.                                                    01126000
011270/                                                                 01127000
011280******************************************************************01128000
011290*    DB2 DCLGEN FOR WORK ORDER INSTRUCTION TABLE                  01129000
011300******************************************************************01130000
011310     EXEC SQL                                                     01131000
011320          INCLUDE TWKORIN                                         01132000
011330     END-EXEC.                                                    01133000
011340/                                                                 01134000
011420******************************************************************01142000
011430*    DB2 DCLGEN FOR TROUBLE NOTIFICATION TABLE                    01143000
011440******************************************************************01144000
011450     EXEC SQL                                                     01145000
011460          INCLUDE TTRBNTF                                         01146000
011470     END-EXEC.                                                    01147000
011480     EXEC SQL                                                     01148000
011490          INCLUDE TTRBRSN                                         01149000
011500     END-EXEC.                                                    01150000
011510     EXEC SQL                                                     01151000
011520          INCLUDE TTRBRCN                                         01152000
011530     END-EXEC.                                                    01153000
011540/                                                                 01154000
011550******************************************************************01155000
011560*    DB2 DCLGEN FOR THE PRE TICKET REQUEST TABLE                  01156000
011570******************************************************************01157000
011580     EXEC SQL                                                     01158000
011590          INCLUDE TPTKREQ                                         01159000
011600     END-EXEC.                                                    01160000
011610/                                                                 01161000
011620******************************************************************01162000
011630*    DB2 DCLGEN FOR THE TICKET FORMAT TABLE                       01163000
011640******************************************************************01164000
011650     EXEC SQL                                                     01165000
011660          INCLUDE TTKTFMT                                         01166000
011670     END-EXEC.                                                    01167000
011680/                                                                 01168000
011690******************************************************************01169000
011700*    DB2 DCLGEN FOR THE PRE TICKET LINE DETAIL TABLE              01170000
011710******************************************************************01171000
011720     EXEC SQL                                                     01172000
011730          INCLUDE TPTKLNE                                         01173000
011740     END-EXEC.                                                    01174000
011750/                                                                 01175000
011760/                                                                 01176000
011770******************************************************************01177000
011780*    PO PREPACK TABLE                                             01178000
011790******************************************************************01179000
011800     EXEC SQL                                                     01180000
011810         INCLUDE TPOPRPK                                          01181000
011820     END-EXEC.                                                    01182000
011830/                                                                 01183000
011840******************************************************************01184000
011850*    CARTON MASTER                                                01185000
011860******************************************************************01186000
011870     EXEC SQL                                                     01187000
011880         INCLUDE SUT00024                                         01188000
011890     END-EXEC.                                                    01189000
011900/                                                                 01190000
011910******************************************************************01191000
011920*    CARTON UPC                                                   01192000
011930******************************************************************01193000
011940     EXEC SQL                                                     01194000
011950         INCLUDE SUT00028                                         01195000
011960     END-EXEC.                                                    01196000
011970/                                                                 01197000
011980******************************************************************01198000
011990*    ASN HEADER                                                   01199000
012000******************************************************************01200000
012010     EXEC SQL                                                     01201000
012020         INCLUDE TASNHDR                                          01202000
012030     END-EXEC.                                                    01203000
012040/                                                                 01204000
012050******************************************************************01205000
012060*    ASN DETAIL                                                   01206000
012070******************************************************************01207000
012080     EXEC SQL                                                     01208000
012090         INCLUDE TASNDTL                                          01209000
012100     END-EXEC.                                                    01210000
012110/                                                                 01211000
012120******************************************************************01212000
012130*    ASN DETAIL PO ITEM ASSOCIATION                               01213000
012140******************************************************************01214000
012150     EXEC SQL                                                     01215000
012160         INCLUDE TASDTPL                                          01216000
012170     END-EXEC.                                                    01217000
012180***************************************************************** 01218000
012190*    DB2 AREA FOR THE ENTERPRISE TABLE                          * 01219000
012200***************************************************************** 01220000
012210     EXEC SQL                                                     01221000
012220          INCLUDE TEXTENT                                         01222000
012230     END-EXEC.                                                    01223000
012240                                                                  01224000
012250***************************************************************** 01225000
012260*    DB2 AREA FOR THE SHIPT UNIT TABLE                          * 01226000
012270***************************************************************** 01227000
012280     EXEC SQL                                                     01228000
012290          INCLUDE TSHPUNT                                         01229000
012300     END-EXEC.                                                    01230000
012310                                                                  01231000
012320***************************************************************** 01232000
012330*    DB2 AREA FOR THE INPKSU TABLE                              * 01233000
012340***************************************************************** 01234000
012350     EXEC SQL                                                     01235000
012360          INCLUDE TINPKSU                                         01236000
012370     END-EXEC.                                                    01237000
012380                                                                  01238000
012390***************************************************************** 01239000
012400*    DB2 AREA FOR THE INPKSU TABLE                              * 01240000
012410***************************************************************** 01241000
012420     EXEC SQL                                                     01242000
012430          INCLUDE TSHUNLO                                         01243000
012440     END-EXEC.                                                    01244000
012450                                                                  01245000
012460***************************************************************** 01246000
012470*    DB2 AREA FOR THE PARM   TABLE                              * 01247000
012480***************************************************************** 01248000
012490     EXEC SQL                                                     01249000
012500          INCLUDE TKRPRPM                                         01250000
012510     END-EXEC.                                                    01251000
012520                                                                  01252000
012530***************************************************************** 01253000
012540*    DB2 AREA FOR THE SHPTPO TABLE                              * 01254000
012550***************************************************************** 01255000
012560     EXEC SQL                                                     01256000
012570          INCLUDE TSHPTPO                                         01257000
012580     END-EXEC.                                                    01258000
012590                                                                  01259000
012600***************************************************************** 01260000
012610*    DB2 AREA FOR THE SHIPMT TABLE                              * 01261000
012620***************************************************************** 01262000
012630     EXEC SQL                                                     01263000
012640          INCLUDE TSHIPMT                                         01264000
012650     END-EXEC.                                                    01265000
012660                                                                  01266000
012670******************************************************************01267000
012680*    DB2 DCLGEN FOR THE TVHTRIP TABLE                             01268000
012690******************************************************************01269000
012700     EXEC SQL                                                     01270000
012710          INCLUDE TVHTRIP                                         01271000
012720     END-EXEC.                                                    01272000
012730/                                                                 01273000
012740******************************************************************01274000
012750*    DB2 DCLGEN FOR THE WST_SHPMT_XREF_HDR TABLE                  01275000
012760******************************************************************01276000
012770     EXEC SQL                                                     01277000
012780          INCLUDE WST00001                                        01278000
012790     END-EXEC.                                                    01279000
012800/                                                                 01280000
012801******************************************************************01280138
012802*    DB2 DCLGEN FOR THE WST_INTGRTN_TYP TABLE                     01280238
012803******************************************************************01280338
012804     EXEC SQL                                                     01280438
012805          INCLUDE WST00008                                        01280538
012806     END-EXEC.                                                    01280638
012807/                                                                 01280738
012808******************************************************************01280838
012809*    DB2 DCLGEN FOR THE WST_ATTR_DEFN TABLE                       01280938
012810******************************************************************01281038
012811     EXEC SQL                                                     01281138
012812          INCLUDE WST00009                                        01281238
012813     END-EXEC.                                                    01281338
012814/                                                                 01281438
012815******************************************************************01281538
012816*    DB2 DCLGEN FOR THE WST_ATTR_ELEM TABLE                       01281638
012817******************************************************************01281738
012818     EXEC SQL                                                     01281838
012819          INCLUDE WST00010                                        01281938
012820     END-EXEC.                                                    01282038
012821/                                                                 01282138
012822******************************************************************01282235
012823*    DB2 DCLGEN FOR THE RCT_PO_RCVR_TRKG TABLE                    01282335
012824******************************************************************01282435
012825     EXEC SQL                                                     01282535
012826          INCLUDE RCT00017                                        01282635
012827     END-EXEC.                                                    01282735
012828/                                                                 01282835
012829******************************************************************01282938
012830*    DB2 DCLGEN FOR THE XLT_LOC TABLE                             01283038
012831******************************************************************01283138
012832     EXEC SQL                                                     01283238
012833          INCLUDE XLT00010                                        01283338
012834     END-EXEC.                                                    01283438
012835/                                                                 01283538
012836***************************************************************** 01283600
012837*    DB2 AREA FOR THE SYSIBM SYSDUMMY TABLE                     * 01283700
012838***************************************************************** 01283800
012840     EXEC SQL                                                     01284000
012850          INCLUDE SYSDUMMY                                        01285000
012860     END-EXEC.                                                    01286000
012870                                                                  01287000
012880/                                                                 01288000
012890******************************************************************01289000
012900*    DB2 CURSOR DEFINITION FOR RETRIEVAL OF PACK SLIP HEADERS     01290000
012910******************************************************************01291000
012920     EXEC SQL                                                     01292000
012930          DECLARE PKSLIP-CURSOR CURSOR FOR                        01293000
012940           SELECT OPER_UNT_ID,                                    01294000
012950                  SHIPT_ID,                                       01295000
012960                  PKSL_NBR,                                       01296000
012970                  STR_DEST_NBR,                                   01297000
012980                  REC_SEQ_NBR,                                    01298000
012990                  BOL_NBR,                                        01299000
013000                  STRIP(PRO_NBR)                                  01300000
013010                  PKSL_STAT_CDE,                                  01301000
013020                  SEQ_NBR,                                        01302000
013030                  CRE_TMST,                                       01303000
013040                  EXPTED_PKG_QTY,                                 01304000
013050                  OWNER_SCAC_ID,                                  01305000
013060                  ASN_NBR,                                        01306000
013070                  VEND_SHIP_DTE                                   01307000
013080             FROM TPKSLIP                                         01308000
013090            WHERE PO_NBR              = :DK-PO-NBR                01309000
013100              AND VER_STAT_CDE        = 'A'                       01310000
013110              AND OPER_UNT_ID   BETWEEN :DK-OPER-UNT-ID-B         01311000
013120                                    AND :DK-OPER-UNT-ID-E         01312000
013130              AND FCLTY_ID      BETWEEN :DK-FCLTY-ID-B            01313000
013140                                    AND :DK-FCLTY-ID-E            01314000
013150              AND PKSL_STAT_CDE     IN (:DK-AC-STAT,              01315000
013160                                        :DK-IN-STAT,              01316000
013170                                        :DK-IP-STAT,              01317000
013180                                        :DK-CM-STAT,              01318000
013190                                        :DK-VE-STAT)              01319000
013200              AND (REC_SEQ_NBR        = 0                         01320000
013210               OR  REC_SEQ_NBR  BETWEEN :DK-REC-SEQ-NBR-B         01321000
013220                                    AND :DK-REC-SEQ-NBR-E)        01322000
013230              AND PKSL_NBR      BETWEEN :DK-PKSL-NBR-B            01323000
013240                                    AND :DK-PKSL-NBR-E            01324000
013250              AND BOL_NBR       BETWEEN :DK-BOL-NBR-B             01325000
013260                                    AND :DK-BOL-NBR-E             01326000
013270              AND PRO_NBR       BETWEEN :DK-PRO-NBR-B             01327000
013280                                    AND :DK-PRO-NBR-E             01328000
013290         ORDER BY REC_SEQ_NBR DESC,                               01329000
013300                  PKSL_STAT_CDE,                                  01330000
013310                  STR_DEST_NBR                                    01331000
013320     END-EXEC.                                                    01332000
013330/                                                                 01333000
013340     EXEC SQL                                                     01334000
013350          DECLARE PKSLIP-SING-CURSOR CURSOR FOR                   01335000
013360           SELECT OPER_UNT_ID,                                    01336000
013370                  SHIPT_ID,                                       01337000
013380                  PKSL_NBR,                                       01338000
013390                  STR_DEST_NBR,                                   01339000
013400                  REC_SEQ_NBR,                                    01340000
013410                  BOL_NBR,                                        01341000
013420                  PRO_NBR,                                        01342000
013430                  PKSL_STAT_CDE,                                  01343000
013440                  SEQ_NBR,                                        01344000
013450                  CRE_TMST,                                       01345000
013460                  EXPTED_PKG_QTY,                                 01346000
013470                  OWNER_SCAC_ID,                                  01347000
013480                  ASN_NBR,                                        01348000
013490                  VEND_SHIP_DTE                                   01349000
013500             FROM TPKSLIP                                         01350000
013510            WHERE PO_NBR              = :DK-PO-NBR                01351000
013520              AND VER_STAT_CDE        = 'A'                       01352000
013530              AND OPER_UNT_ID       IN (:DK-OPER-UNT-ID-B,        01353000
013540                                        :DK-OPER-UNT-ID-00)       01354000
013550              AND FCLTY_ID      BETWEEN :DK-FCLTY-ID-B            01355000
013560                                    AND :DK-FCLTY-ID-E            01356000
013570              AND PKSL_STAT_CDE     IN (:DK-AC-STAT,              01357000
013580                                        :DK-IN-STAT,              01358000
013590                                        :DK-IP-STAT,              01359000
013600                                        :DK-CM-STAT,              01360000
013610                                        :DK-VE-STAT)              01361000
013620              AND (REC_SEQ_NBR        = 0                         01362000
013630               OR  REC_SEQ_NBR  BETWEEN :DK-REC-SEQ-NBR-B         01363000
013640                                    AND :DK-REC-SEQ-NBR-E)        01364000
013650              AND PKSL_NBR      BETWEEN :DK-PKSL-NBR-B            01365000
013660                                    AND :DK-PKSL-NBR-E            01366000
013670              AND BOL_NBR       BETWEEN :DK-BOL-NBR-B             01367000
013680                                    AND :DK-BOL-NBR-E             01368000
013690              AND PRO_NBR       BETWEEN :DK-PRO-NBR-B             01369000
013700                                    AND :DK-PRO-NBR-E             01370000
013710         ORDER BY REC_SEQ_NBR DESC,                               01371000
013720                  PKSL_STAT_CDE,                                  01372000
013730                  STR_DEST_NBR                                    01373000
013740     END-EXEC.                                                    01374000
013750/                                                                 01375000
013760     EXEC SQL                                                     01376000
013770          DECLARE PKSLIP-ITEM-CURSOR CURSOR FOR                   01377000
013780           SELECT SUM (PKSL_ITM_QTY),                             01378000
013790                  PKSL_LNE_NBR                                    01379000
013800             FROM TPKITEM                                         01380000
013810            WHERE PO_NBR        = :DK-PO-NBR                      01381000
013820              AND SEQ_NBR       = :PKSLIP-SEQ-NBR                 01382000
013830              AND VER_STAT_CDE  = 'A'                             01383000
013840         GROUP BY PKSL_LNE_NBR                                    01384000
013850         ORDER BY PKSL_LNE_NBR                                    01385000
013860     END-EXEC.                                                    01386000
013870                                                                  01387000
013880/                                                                 01388000
013890     EXEC SQL                                                     01389000
013900          DECLARE PREPACK-ITEM-CSR CURSOR FOR                     01390000
013910       SELECT                                                     01391000
013920                                                                  01392000
013930         CASE                                                     01393000
013940             PURITM.PO_PREPK_ID                                   01394000
013950         WHEN 0                                                   01395000
013960             THEN 99                                              01396000
013970         ELSE                                                     01397000
013980             PURITM.PO_PREPK_ID                                   01398000
013990         END                                                      01399000
014000         AS  PO_PREPK_ID                                          01400000
014010                                                                  01401000
014020       ,  PURITM.VER_NBR                                          01402000
014030       ,  PKITEM.PKSL_LNE_NBR                                     01403000
014040       ,  PURITM.PREPK_RATO_QTY                                   01404000
014050       ,  SUM(PKITEM.PKSL_ITM_QTY) AS TOTAL_ITEM_QTY              01405000
014060     FROM                                                         01406000
014070          TPKITEM PKITEM                                          01407000
014080      ,   TPURITM PURITM                                          01408000
014090                                                                  01409000
014100     WHERE                                                        01410000
014110             PKITEM.PO_NBR          = :DK-PO-NBR                  01411000
014120        AND  PKITEM.SEQ_NBR         = :PKSLIP-SEQ-NBR             01412000
014130        AND  PURITM.VER_STATUS_CDE  = 'A'                         01413000
014140        AND  PKITEM.PO_NBR          = PURITM.PO_NBR               01414000
014150        AND  PKITEM.PKSL_LNE_NBR    = PURITM.APP_PO_LNE_NBR       01415000
014160        AND  PKITEM.VER_STAT_CDE    = 'A'                         01416000
014170     GROUP BY                                                     01417000
014180          PURITM.PO_PREPK_ID                                      01418000
014190       ,  PURITM.VER_NBR                                          01419000
014200       ,  PKITEM.PKSL_LNE_NBR                                     01420000
014210       ,  PURITM.PREPK_RATO_QTY                                   01421000
014220     ORDER BY                                                     01422000
014230          PURITM.PO_PREPK_ID                                      01423000
014240       ,  PKITEM.PKSL_LNE_NBR                                     01424000
014250     END-EXEC.                                                    01425000
014260/                                                                 01426000
014270     EXEC SQL                                                     01427000
014280          DECLARE UNPKSL-ITEM-CURSOR CURSOR FOR                   01428000
014290           SELECT SUM (PKSL_ITM_QTY),                             01429000
014300                  COLOR_DESC,                                     01430000
014310                  SIZE_DESC,                                      01431000
014320                  VEND_STYL_NAME                                  01432000
014330             FROM TUNPKSL                                         01433000
014340            WHERE PO_NBR        = :DK-PO-NBR                      01434000
014350              AND SEQ_NBR       = :PKSLIP-SEQ-NBR                 01435000
014360              AND VER_STAT_CDE  = 'A'                             01436000
014370         GROUP BY VEND_STYL_NAME,                                 01437000
014380                  COLOR_DESC,                                     01438000
014390                  SIZE_DESC                                       01439000
014400     END-EXEC.                                                    01440000
014410                                                                  01441000
014420     EXEC SQL                                                     01442000
014430          DECLARE UNPKSL-LINE-CURSOR CURSOR FOR                   01443000
014440           SELECT PKSL_ITM_QTY,                                   01444000
014450                  PKSL_LNE_NBR                                    01445000
014460             FROM TUNPKSL                                         01446000
014470            WHERE PO_NBR        = :DK-PO-NBR                      01447000
014480              AND SEQ_NBR       = :PKSLIP-SEQ-NBR                 01448000
014490              AND VER_STAT_CDE  = 'A'                             01449000
014500         ORDER BY PKSL_LNE_NBR                                    01450000
014510     END-EXEC.                                                    01451000
014520                                                                  01452000
014530     EXEC SQL                                                     01453000
014540          DECLARE TKTFMT-CURSOR  CURSOR FOR                       01454000
014550           SELECT TKT_DESC,                                       01455000
014560                  A.ACTL_PRT_DTE,                                 01456000
014570                  A.PRT_TM                                        01457000
014580             FROM TPTKREQ A                                       01458000
014590                 ,TPTKLNE B                                       01459000
014600             WHERE A.PO_NBR     = :DK-PO-NBR                      01460000
014610               AND A.PO_REQ_NBR = B.PO_REQ_NBR                    01461000
014620              AND B.PO_LNE_NBR = :RECITM-ORD-LNE-NBR              01462000
014630         ORDER BY A.ACTL_PRT_DTE DESC, A.PRT_TM DESC              01463000
014640     END-EXEC.                                                    01464000
014650                                                                  01465000
014660******************************************************************01466000
014670*    DECLARE PLAN CURSOR                                          01467000
014680******************************************************************01468000
014690     EXEC SQL                                                     01469000
014700          DECLARE PLAN-CSR CURSOR FOR                             01470000
014710          SELECT STR_NBR                                          01471000
014720            FROM TMESTDS                                          01472000
014730           WHERE PO_NBR     = :DK-PO-NBR                          01473000
014740             AND PO_LNE_NBR = :PURITM-PO-LNE-NBR                  01474000
014750             AND PLAN_NBR   = :ALLPLN-PLAN-NBR                    01475000
014760           ORDER BY STR_NBR                                       01476000
014770     END-EXEC.                                                    01477000
014780                                                                  01478000
014790     EXEC SQL                                                     01479000
014800          DECLARE RECDIS-CSR CURSOR WITH HOLD FOR                 01480000
014810          SELECT STR_NBR                                          01481000
014820            FROM TRECDIS                                          01482000
014830            WHERE ORD_NBR        = :DK-PO-NBR                     01483000
014840              AND ORD_LNE_NBR    = :RECITM-ORD-LNE-NBR            01484000
014850              AND REC_SEQ_NBR    = :DK-REC-SEQ-NBR                01485000
014860              AND OPER_UNT_ID    = :DK-OPER-UNT-ID                01486000
014870              AND FCLTY_ID       = :DK-FCLTY-ID                   01487000
014880     END-EXEC.                                                    01488000
014890******************************************************************01489000
014900*    DECLARE SERIAL SHIP CODE CURSOR                              01490000
014910******************************************************************01491000
014920     EXEC SQL                                                     01492000
014930          DECLARE SHIPT-UNT-CSR CURSOR FOR                        01493000
014940          SELECT C.OPER_UNT_ID                                    01494000
014950                ,C.SHIPT_ID                                       01495000
014960                ,C.PKSL_NBR                                       01496000
014970                ,C.STR_DEST_NBR                                   01497000
014980                ,C.REC_SEQ_NBR                                    01498000
014990                ,C.BOL_NBR                                        01499000
015000                ,C.PRO_NBR                                        01500000
015010                ,C.PKSL_STAT_CDE                                  01501000
015020                ,C.SEQ_NBR                                        01502000
015030                ,C.CRE_TMST                                       01503000
015040                ,C.EXPTED_PKG_QTY                                 01504000
015050                ,C.OWNER_SCAC_ID                                  01505000
015060                ,C.ASN_NBR                                        01506000
015070                ,C.VEND_SHIP_DTE                                  01507000
015080            FROM TSHPUNT A                                        01508000
015090                ,TINPKSU B                                        01509000
015100                ,TPKSLIP C                                        01510000
015110           WHERE A.SHIPT_UNT_ID  = :SU046-SHIPT-UNT-ID            01511000
015120             AND A.SHIPT_UNT_ID  = B.SHIPT_UNT_ID                 01512000
015130             AND B.PO_NBR        = C.PO_NBR                       01513000
015140             AND B.SEQ_NBR       = C.SEQ_NBR                      01514000
015150             AND C.VER_STAT_CDE  = 'A'                            01515000
015160             AND C.PKSL_STAT_CDE <> 'DE'                          01516000
015170     END-EXEC.                                                    01517000
015180                                                                  01518000
015190                                                                  01519000
015200 01  PWT-PGM-WORK-TABLES.                                         01520000
015210     05  PWT-MATCHED-TBL OCCURS 1000 TIMES                        01521000
015220                                      INDEXED BY PWT-M-IDX        01522000
015230                                                 PWT-COUNT-IDX.   01523000
015240         10  PWT-PKSL-M-LNE-NBR       PIC S9(9)  VALUE +0         01524000
015250                                                 COMP.            01525000
015260         10  PWT-M-LINE-QTY           PIC S9(9)  VALUE +0         01526000
015270                                                 COMP.            01527000
015280         10  PWT-M-PREPK-ID           PIC S9(4)  VALUE ZERO COMP. 01528000
015290         10  PWT-M-DRIVER-LNE-CDE     PIC X(01).                  01529000
015300             88  PWT-DRIVER-LINE-YES             VALUE 'A'.       01530000
015310             88  PWT-DRIVER-LINE-NO              VALUE SPACE.     01531000
015320         10  PWT-M-PREPK-RATIO-QTY    PIC S9(4)  VALUE ZERO COMP. 01532000
015330         10  PWT-M-PREPK-BEST-CASES   PIC S9(9)  VALUE ZERO COMP. 01533000
015340         10  PWT-M-PREPK-ODD-UNITS    PIC S9(9)  VALUE ZERO COMP. 01534000
015350         10  PWT-M-PREPK-NBR-OF-PACKS PIC S9(9)  VALUE ZERO COMP. 01535000
015360                                                                  01536000
015370                                                                  01537000
015380     05  PWT-UNMATCHED-TBL OCCURS 1000 TIMES                      01538000
015390                                      INDEXED BY PWT-U-IDX        01539000
015400                                      PWT-U-IDX-MAX.              01540000
015410         10  PWT-U-LINE-QTY           PIC S9(9)  VALUE +0         01541000
015420                                                 COMP.            01542000
015430         10  PWT-COLOR-DESC           PIC X(25)  VALUE SPACES.    01543000
015440         10  PWT-SIZE-DESC            PIC X(25)  VALUE SPACES.    01544000
015450         10  PWT-VEND-STYL-NAME       PIC X(20)  VALUE SPACES.    01545000
015460                                                                  01546000
015470********          PREPACK PROCESSING ONLY   **********            01547000
015480* THE PURPOSE OF THIS TABLE IS TO COLLECT LINE DATA FROM ALL      01548000
015490* THE PACKSLIPS SELECTED.  AFTER ALL THE PACKSLIP LINES ARE       01549000
015500* ACCUMULATED, THE DRIVER LINES ARE SENT TO THE TRANSCRIPTION     01550000
015510* PROCESS ONE AT A TIME.  IT OCCURS 1001 TIMES BECAUSE THE        01551000
015520* LINE NUMBER IS SYSTEMATICALLY KEPT TO 3 DIGITS.                 01552000
015530 01  PWT-PACK-STAGING-TABLE.                                      01553000
015540     05  PWT-PACK-INFO OCCURS 1001 TIMES                          01554000
015550                              INDEXED BY PWT-STAGE-IDX.           01555000
015560         10  PWT-STG-PREPK-ID         PIC S9(4) COMP.             01556000
015570         10  PWT-STG-PURITM-VER-NBR   PIC S9(9) COMP.             01557000
015580         10  PWT-STG-LNE-NBR          PIC S9(9) COMP.             01558000
015590         10  PWT-STG-PREPK-RATO-QTY   PIC S9(4) COMP.             01559000
015600         10  PWT-STG-PKSL-ITM-QTY     PIC S9(9) COMP.             01560000
015610                                                                  01561000
015620 01  PWT-PACK-ID-TABLE.                                           01562000
015630     05  PWT-PACK-STUFF               OCCURS 9999 TIMES           01563000
015640                                         INDEXED BY PWT-PACK-IDX. 01564000
015650         10 PWT-PACK-ID               PIC S9(04) COMP VALUE ZERO. 01565000
015660         10 PWT-LINE-NBR              PIC S9(04) COMP VALUE ZERO. 01566000
015670                                                                  01567000
015680 01  PWT-PKSL-NBR-TABLE.                                          01568000
015690     05  PWT-PKSL-NBR                 OCCURS 999 TIMES            01569000
015700                                      PIC X(10)  VALUE SPACES.    01570000
015710                                                                  01571000
015720 01  PST-PKSL-STORE-TABLE.                                        01572000
015730     05  PST-STORE-NBR                OCCURS 300 TIMES            01573000
015740                                      INDEXED BY PST-IDX          01574000
015750                                      PIC 9(04)  VALUE ZERO.      01575000
015760 01  PST-PKSL-STORE-END               PIC 9(04)  VALUE 9999.      01576000
015770                                                                  01577000
015780 LINKAGE SECTION.                                                 01578000
015790                                                                  01579000
015800 01  DFHCOMMAREA.                                                 01580000
015810     05  FILLER                       OCCURS 1 TO 4072 TIMES      01581000
015820                                      DEPENDING ON EIBCALEN.      01582000
015830         10  FILLER                   PIC X.                      01583000
015840                                                                  01584000
015850                                                                  01585000
015860 PROCEDURE DIVISION.                                              01586000
015870                                                                  01587000
015880 0000-MAIN-MODULE.                                                01588000
015890     EXEC SQL                                                     01589000
015900          SET :PV-CURRENT-DATE = CURRENT DATE                     01590000
015910     END-EXEC                                                     01591000
015920                                                                  01592000
015930     INITIALIZE DP030-CICS-API-FIELDS.                            01593000
015940     SET PS-ASNS-TO-WMS-NO       TO TRUE.                         01594000
015950     SET PS-VALID-TRIP-NO        TO TRUE.                         01595000
015960                                                                  01596000
015970     MOVE +1                     TO DP030-NUMBER-OF-MAPS.         01597000
015980     MOVE PC-CURRENT-MAPSET-NAME TO DP030-MAPSET-NAME.            01598000
015990     MOVE PC-CURRENT-MAP-NAME    TO DP030-MAP-NAME (1).           01599000
016000     SET DP030-RECEIVE-APPL-MAP  TO TRUE.                         01600000
016010     MOVE LENGTH OF RC213AI      TO DP030-MAP-LENGTH (1).         01601000
016020     MOVE 'PROGRAM ENTRY CALL'   TO DP013-MESSAGE-TEXT (1).       01602000
016030     SET DP030-OVERRIDE-APPL-ERROR                                01603000
016040                                 TO TRUE.                         01604000
016050                                                                  01605000
016060     PERFORM 0001-CALL-CICS-ARCH-API.                             01606000
016070                                                                  01607000
016080     PERFORM 1000-CONTROL-PROCESSING.                             01608000
016090                                                                  01609000
016100     MOVE ASC-SAVE-F2-ACTION          TO DP020-FK-ACTION(2)       01610000
016110     MOVE 'PROGRAM EXIT CALL'    TO DP013-MESSAGE-TEXT (1).       01611000
016120                                                                  01612000
016130     PERFORM 0001-CALL-CICS-ARCH-API.                             01613000
016140                                                                  01614000
016150 0001-CALL-CICS-ARCH-API.                                         01615000
016160                                                                  01616000
016161     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      01616125
016180                                    DFHCOMMAREA                   01618025
016190                                    DP030-CICS-API-FIELDS         01619025
016200                                    DP020-STANDARD-COMMAREA       01620025
016210                                    RC213AI.                      01621025
016220                                                                  01622000
016230     IF DP030-RC-CALL-SUCCESSFUL OR                               01623000
016240        DP030-RC-APPL-ERROR                                       01624000
016250         CONTINUE                                                 01625000
016260     ELSE                                                         01626000
016270         SET DP013-CICS-ABEND                                     01627000
016280             DP013-NO-ROLLBACK                                    01628000
016290             DP013-XCTL-DISPLAY-RESTART                           01629000
016300                                 TO TRUE                          01630000
016310         MOVE '0001-CALL-CICS-ARCH-API'                           01631000
016320                                 TO DP013-PARAGRAPH               01632000
016321         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN CODE O01632125
016322-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      01632225
016350         MOVE DP030-RETURN-CODE  TO DP013-MESSAGE-TEXT (3)        01635000
016360                                                                  01636000
016370         PERFORM DP013-0000-PROCESS-ABEND.                        01637000
016380                                                                  01638000
016390 1000-CONTROL-PROCESSING.                                         01639000
016400                                                                  01640000
016410     EVALUATE TRUE                                                01641000
016420                                                                  01642000
016430         WHEN DP030-RC-APPL-ERROR                                 01643000
016440                                                                  01644000
016450              PERFORM 2050-DELETE-LIST-QUEUE                      01645000
016460              PERFORM 4000-BUILD-INITIAL-PANEL                    01646000
016470                                                                  01647000
016480                                                                  01648000
016490         WHEN DP020-NEXT-ACT-INITIAL                              01649000
016500              INITIALIZE ASC-SPECIFIC-COMMAREA                    01650000
016510              MOVE EIBTRMID      TO ASC-LIST-TERM-ID              01651000
016520                                    ASC-SEL-TERM-ID               01652000
016530              MOVE DP020-SRC-TASK-NUMBER                          01653000
016540                                 TO ASC-LIST-TASK-NUMBER          01654000
016550                                    ASC-SEL-TASK-NUMBER           01655000
016560              MOVE PC-LIST-QUEUE-SEQ                              01656000
016570                                 TO ASC-LIST-SEQ                  01657000
016580              MOVE PC-SEL-QUEUE-SEQ                               01658000
016590                                 TO ASC-SEL-SEQ                   01659000
016600              SET PS-NO-ERROR    TO TRUE                          01660000
016610              MOVE DP020-FK-ACTION(2) TO ASC-SAVE-F2-ACTION       01661000
016620                                                                  01662000
016630              PERFORM 1100-PROCESS-INTER-APPL-COMM                01663000
016640                                                                  01664000
016650              IF PS-NO-ERROR                                      01665000
016660                  MOVE INTER-APPL-COMM-AREA                       01666000
016670                                 TO ASC-HOLD-INTER-APPL           01667000
016680                  PERFORM 4000-BUILD-INITIAL-PANEL                01668000
016690              END-IF                                              01669000
016700                                                                  01670000
016710                                                                  01671000
016720         WHEN DP020-NEXT-ACT-READ-MAP                             01672000
016730              MOVE ASC-ITEM-AT-TOP-OF-PANEL                       01673000
016740                                 TO PV-TOP-ITEM                   01674000
016750                                                                  01675000
016760              PERFORM 2000-PROCESS-PANEL                          01676000
016770                                                                  01677000
016780                                                                  01678000
016790         WHEN DP020-NEXT-ACT-RETURN                               01679000
016800              MOVE ASC-ITEM-AT-TOP-OF-PANEL                       01680000
016810                                 TO PV-TOP-ITEM                   01681000
016820              MOVE ZERO          TO ASC-ITEM-AT-TOP-OF-PANEL      01682000
016830              MOVE ASC-HOLD-INTER-APPL                            01683000
016840                                 TO INTER-APPL-COMM-AREA          01684000
016850*             THIS PROGRAM REQUIRES THAT ANY ADDED OR CHANGED     01685000
016860*             INFORMATION BE DISPLAYED UPON RETURN TO THIS        01686000
016870*             PROGRAM.  THEREFORE THE LIST QUEUE IS REBUILT.      01687000
016880                                                                  01688000
016890              PERFORM 2050-DELETE-LIST-QUEUE                      01689000
016900              PERFORM 4000-BUILD-INITIAL-PANEL                    01690000
016910                                                                  01691000
016920         WHEN OTHER                                               01692000
016930              SET DP013-LOGIC-ABEND                               01693000
016940                  DP013-NO-ROLLBACK                               01694000
016950                                 TO TRUE                          01695000
016960              MOVE '1000-CONTROL-PROCESSING'                      01696000
016970                                 TO DP013-PARAGRAPH               01697000
016980              MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'   01698000
016990                                 TO DP013-MESSAGE-TEXT(1)         01699000
017000                                                                  01700000
017010              PERFORM DP013-0000-PROCESS-ABEND                    01701000
017020                                                                  01702000
017030     END-EVALUATE.                                                01703000
017040**************************************************************    01704000
017050 1100-PROCESS-INTER-APPL-COMM.                                    01705000
017060                                                                  01706000
017070     MOVE SPACE                  TO ASC-START-ITEM-REQUEST.       01707000
017080                                                                  01708000
017090     EVALUATE DP020-INT-APPL-FORMAT-IND                           01709000
017100         WHEN PC-INTER-APPL-RCVG-LIST                             01710000
017110             EVALUATE TRUE                                        01711000
017120                 WHEN RC015-NUMBER-OF-SELECTED-ITEMS = ZERO       01712000
017130                     SET ASC-NO-TSQ-UPDATE                        01713000
017140                                 TO TRUE                          01714000
017150                     SET DP020-MSG-FATAL                          01715000
017160                         DP020-NEXT-ACT-APPL-ERROR                01716000
017170                         PS-ERROR                                 01717000
017180                                 TO TRUE                          01718000
017190                     MOVE PC-TSYMSG-00057                         01719000
017200                                 TO DP020-MSG-NUMBER              01720000
017210                                                                  01721000
017220                 WHEN RC015-NUMBER-OF-SELECTED-ITEMS > 1          01722000
017230                     SET ASC-NO-TSQ-UPDATE                        01723000
017240                                 TO TRUE                          01724000
017250                     SET DP020-MSG-FATAL                          01725000
017260                         DP020-NEXT-ACT-APPL-ERROR                01726000
017270                         PS-ERROR                                 01727000
017280                                 TO TRUE                          01728000
017290                     MOVE PC-TSYMSG-00047                         01729000
017300                                 TO DP020-MSG-NUMBER              01730000
017310                                                                  01731000
017320                 WHEN OTHER                                       01732000
017330                     SET ASC-USE-SELECTION-QUEUE                  01733000
017340                                 TO TRUE                          01734000
017350                     MOVE RC015-NUMBER-OF-SELECTED-ITEMS          01735000
017360                                 TO ASC-NUMBER-OF-SELECTED-ITEMS  01736000
017370                     MOVE RC015-NUMBER-OF-TS-ITEMS                01737000
017380                                 TO ASC-NUMBER-OF-TS-ITEMS        01738000
017390                     MOVE RC015-SEL-QUEUE-NAME                    01739000
017400                                 TO ASC-SEL-QUEUE-NAME-IN         01740000
017410                     SET ASC-CAME-FROM-RCVG                       01741000
017420                                 TO TRUE                          01742000
017430                     PERFORM 1120-PREPARE-LIST-ENTRY              01743000
017440             END-EVALUATE                                         01744000
017450                                                                  01745000
017460         WHEN PC-INTER-APPL-PACK-SLIP                             01746000
017470             MOVE RC012-PO-NBR   TO ASC-KEY-PO-NBR-N              01747000
017480             MOVE RC012-OPER-UNT-ID                               01748000
017490                                 TO ASC-KEY-OPER-UNT-ID           01749000
017500                                    DK-OPER-UNT-ID                01750000
017510             MOVE RC012-FCLTY-ID TO ASC-KEY-FCLTY-ID              01751000
017520                                    DK-FCLTY-ID                   01752000
017530                                                                  01753000
017540             MOVE RC012-PKSL-STAT-CDES                            01754000
017550                                 TO ASC-KEY-PKSL-STAT-CDES        01755000
017560             MOVE RC012-REC-SEQ-NBR                               01756000
017570                                 TO ASC-KEY-REC-SEQ-NBR           01757000
017580             MOVE RC012-PKSL-NBR TO ASC-KEY-PKSL-NBR              01758000
017590             MOVE RC012-BOL-NBR  TO ASC-KEY-BOL-NBR               01759000
017600             MOVE RC012-PRO-NBR  TO ASC-KEY-PRO-NBR               01760000
017610             SET ASC-CAME-FROM-PACK-SLIP                          01761000
017620                                 TO TRUE                          01762000
017630                                                                  01763000
017640         WHEN PC-INTER-APPL-PRERCV-ADD                            01764000
017650                                                                  01765000
017660             MOVE TR001-PO-NBR   TO ASC-KEY-PO-NBR-N              01766000
017670             MOVE TR001-OPER-UNT-ID                               01767000
017680                                 TO ASC-KEY-OPER-UNT-ID           01768000
017690                                    DK-OPER-UNT-ID                01769000
017700             MOVE TR001-FCLTY-ID TO ASC-KEY-FCLTY-ID              01770000
017710                                    DK-FCLTY-ID                   01771000
017720                                                                  01772000
017730             MOVE 'AC'           TO ASC-KEY-AC-STAT               01773000
017740             MOVE 'IN'           TO ASC-KEY-IN-STAT               01774000
017750             MOVE TR001-REC-SEQ-NBR                               01775000
017760                                 TO ASC-KEY-REC-SEQ-NBR           01776000
017770* CHANGE 11/2/98  ---  STEFFEN                                    01777000
017780             SET ASC-CAME-FROM-PACK-SLIP                          01778000
017790                                 TO TRUE                          01779000
017800* END CHANGE                                                      01780000
017810                                                                  01781000
017820                                                                  01782000
017830         WHEN PC-INTER-APPL-RCVG                                  01783000
017840             MOVE RC012-PO-NBR   TO ASC-KEY-PO-NBR-N              01784000
017850             MOVE RC012-OPER-UNT-ID                               01785000
017860                                 TO ASC-KEY-OPER-UNT-ID           01786000
017870                                    DK-OPER-UNT-ID                01787000
017880             MOVE RC012-FCLTY-ID TO ASC-KEY-FCLTY-ID              01788000
017890                                    DK-FCLTY-ID                   01789000
017900                                                                  01790000
017910             MOVE RC012-PKSL-STAT-CDES                            01791000
017920                                 TO ASC-KEY-PKSL-STAT-CDES        01792000
017930             MOVE RC012-REC-SEQ-NBR                               01793000
017940                                 TO ASC-KEY-REC-SEQ-NBR           01794000
017950             MOVE RC012-PKSL-NBR TO ASC-KEY-PKSL-NBR              01795000
017960             MOVE RC012-BOL-NBR  TO ASC-KEY-BOL-NBR               01796000
017970             MOVE RC012-PRO-NBR  TO ASC-KEY-PRO-NBR               01797000
017980             MOVE RC012-PRE-TKT-IND                               01798000
017990                                 TO ASC-KEY-PRE-TKT-IND           01799000
018000             MOVE RC012-TKT-TYP-DESC                              01800000
018010                                 TO ASC-KEY-TKT-FMT-ID            01801000
018020             MOVE RC012-EXPTED-CART-CNT                           01802000
018030                                 TO ASC-KEY-EXPTED-CART-CNT       01803000
018040             IF RC012-REC-SEQ-NBR = ZERO                          01804000
018050                 SET ASC-CAME-FROM-PACK-SLIP                      01805000
018060                                 TO TRUE                          01806000
018070             ELSE                                                 01807000
018080                 SET ASC-CAME-FROM-RCVG                           01808000
018090                                 TO TRUE                          01809000
018100             END-IF                                               01810000
018110         WHEN PC-INTER-APPL-SHPPO-LST                             01811000
018120             EVALUATE TRUE                                        01812000
018130                 WHEN TR017-NUMBER-OF-SELECTED-ITEMS = ZERO       01813000
018140                     SET ASC-NO-TSQ-UPDATE                        01814000
018150                                 TO TRUE                          01815000
018160                     SET DP020-MSG-FATAL                          01816000
018170                         DP020-NEXT-ACT-APPL-ERROR                01817000
018180                         PS-ERROR                                 01818000
018190                                 TO TRUE                          01819000
018200                     MOVE PC-TSYMSG-00057                         01820000
018210                                 TO DP020-MSG-NUMBER              01821000
018220                                                                  01822000
018230                 WHEN TR017-NUMBER-OF-SELECTED-ITEMS > 1          01823000
018240                     SET ASC-NO-TSQ-UPDATE                        01824000
018250                                 TO TRUE                          01825000
018260                     SET DP020-MSG-FATAL                          01826000
018270                         DP020-NEXT-ACT-APPL-ERROR                01827000
018280                         PS-ERROR                                 01828000
018290                                 TO TRUE                          01829000
018300                     MOVE PC-TSYMSG-00047                         01830000
018310                                 TO DP020-MSG-NUMBER              01831000
018320                                                                  01832000
018330                 WHEN OTHER                                       01833000
018340                     SET ASC-USE-SELECTION-QUEUE                  01834000
018350                                 TO TRUE                          01835000
018360                     MOVE TR017-NUMBER-OF-SELECTED-ITEMS          01836000
018370                                 TO ASC-NUMBER-OF-SELECTED-ITEMS  01837000
018380                     MOVE TR017-NUMBER-OF-TS-ITEMS                01838000
018390                                 TO ASC-NUMBER-OF-TS-ITEMS        01839000
018400                     MOVE TR017-SEL-QUEUE-NAME                    01840000
018410                                 TO ASC-SEL-QUEUE-NAME-IN         01841000
018420                     MOVE TR017-PRO-NBR                           01842000
018430                                 TO ASC-KEY-PRO-NBR               01843000
018440                     MOVE TR017-BOL-NBR                           01844000
018450                                 TO ASC-KEY-BOL-NBR               01845000
018460                                                                  01846000
018470                     SET ASC-CAME-FROM-RCVG                       01847000
018480                                 TO TRUE                          01848000
018490                     PERFORM 1121-PREPARE-PO-LIST-ENTRY           01849000
018500             END-EVALUATE                                         01850000
018510                                                                  01851000
018520         WHEN PC-INTER-APPL-RCVPO-LST                             01852000
018530             EVALUATE TRUE                                        01853000
018540                 WHEN RC015-NUMBER-OF-SELECTED-ITEMS = ZERO       01854000
018550                     SET ASC-NO-TSQ-UPDATE                        01855000
018560                                 TO TRUE                          01856000
018570                     SET DP020-MSG-FATAL                          01857000
018580                         DP020-NEXT-ACT-APPL-ERROR                01858000
018590                         PS-ERROR                                 01859000
018600                                 TO TRUE                          01860000
018610                     MOVE PC-TSYMSG-00057                         01861000
018620                                 TO DP020-MSG-NUMBER              01862000
018630                                                                  01863000
018640                 WHEN RC015-NUMBER-OF-SELECTED-ITEMS > 1          01864000
018650                     SET ASC-NO-TSQ-UPDATE                        01865000
018660                                 TO TRUE                          01866000
018670                     SET DP020-MSG-FATAL                          01867000
018680                         DP020-NEXT-ACT-APPL-ERROR                01868000
018690                         PS-ERROR                                 01869000
018700                                 TO TRUE                          01870000
018710                     MOVE PC-TSYMSG-00047                         01871000
018720                                 TO DP020-MSG-NUMBER              01872000
018730                                                                  01873000
018740                 WHEN OTHER                                       01874000
018750                     SET ASC-USE-SELECTION-QUEUE                  01875000
018760                                 TO TRUE                          01876000
018770                     MOVE RC015-NUMBER-OF-SELECTED-ITEMS          01877000
018780                                 TO ASC-NUMBER-OF-SELECTED-ITEMS  01878000
018790                     MOVE RC015-NUMBER-OF-TS-ITEMS                01879000
018800                                 TO ASC-NUMBER-OF-TS-ITEMS        01880000
018810                     MOVE RC015-SEL-QUEUE-NAME                    01881000
018820                                 TO ASC-SEL-QUEUE-NAME-IN         01882000
018830                     SET ASC-CAME-FROM-RCVG                       01883000
018840                                 TO TRUE                          01884000
018850                     PERFORM 1120-PREPARE-LIST-ENTRY              01885000
018860             END-EVALUATE                                         01886000
018870                                                                  01887000
018880* RECEIVE INFO FROM THE TRIP PO/RECEIVER LIST (PRINT PACKAGE)     01888000
018890         WHEN PC-INTER-APPL-TRPPO-LST                             01889000
018900             EVALUATE TRUE                                        01890000
018910                 WHEN DS003-NUMBER-OF-SELECTED-ITEMS = ZERO       01891000
018920                     SET ASC-NO-TSQ-UPDATE                        01892000
018930                                 TO TRUE                          01893000
018940                     SET DP020-MSG-FATAL                          01894000
018950                         DP020-NEXT-ACT-APPL-ERROR                01895000
018960                         PS-ERROR                                 01896000
018970                                 TO TRUE                          01897000
018980                     MOVE PC-TSYMSG-00057                         01898000
018990                                 TO DP020-MSG-NUMBER              01899000
019000                                                                  01900000
019010                 WHEN DS003-NUMBER-OF-SELECTED-ITEMS > 1          01901000
019020                     SET ASC-NO-TSQ-UPDATE                        01902000
019030                                 TO TRUE                          01903000
019040                     SET DP020-MSG-FATAL                          01904000
019050                         DP020-NEXT-ACT-APPL-ERROR                01905000
019060                         PS-ERROR                                 01906000
019070                                 TO TRUE                          01907000
019080                     MOVE PC-TSYMSG-00047                         01908000
019090                                 TO DP020-MSG-NUMBER              01909000
019100                                                                  01910000
019110                                                                  01911000
019120                 WHEN OTHER                                       01912000
019130                     SET ASC-USE-SELECTION-QUEUE                  01913000
019140                                 TO TRUE                          01914000
019150                     MOVE DS003-NUMBER-OF-SELECTED-ITEMS          01915000
019160                                 TO ASC-NUMBER-OF-SELECTED-ITEMS  01916000
019170                     MOVE DS003-NUMBER-OF-TS-ITEMS                01917000
019180                                 TO ASC-NUMBER-OF-TS-ITEMS        01918000
019190                     MOVE DS003-SEL-QUEUE-NAME                    01919000
019200                                 TO ASC-SEL-QUEUE-NAME-IN         01920000
019210                     SET ASC-CAME-FROM-RCVG                       01921000
019220                                 TO TRUE                          01922000
019230                     PERFORM 1122-PREPARE-TRIP-PO-LIST            01923000
019240             END-EVALUATE                                         01924000
019250                                                                  01925000
019260         WHEN PC-INTER-APPL-EXCPT-SCR                             01926000
019270             MOVE SU046-SHIPT-UNT-ID TO ASC-SHIPT-UNT-ID          01927000
019280             SET ASC-CAME-FROM-EXCPT TO TRUE                      01928000
019290             PERFORM 1160-GET-ADDTLN-INFO                         01929000
019300                                                                  01930000
019310     END-EVALUATE.                                                01931000
019320                                                                  01932000
019330*---------------------------------------------------------------* 01933000
019340*    ENTRY IS FROM A LIST.  GET THE KEYS FROM THE TEMP STORAGE  * 01934000
019350*    QUEUE PASSED FROM THE LIST.                                * 01935000
019360*---------------------------------------------------------------* 01936000
019370 1120-PREPARE-LIST-ENTRY.                                         01937000
019380                                                                  01938000
019390     MOVE RC013-MAX-ITEMS        TO ASC-SEL-SUB.                  01939000
019400     MOVE ZERO                   TO ASC-SEL-ITEM.                 01940000
019410     MOVE RC015-PO-NBR           TO ASC-KEY-PO-NBR-N.             01941000
019420     MOVE RC015-REC-SEQ-NBR      TO ASC-KEY-REC-SEQ-NBR.          01942000
019430                                                                  01943000
019440     MOVE 'AC'                   TO ASC-KEY-AC-STAT.              01944000
019450     MOVE 'IN'                   TO ASC-KEY-IN-STAT.              01945000
019460     MOVE 'IP'                   TO ASC-KEY-IP-STAT.              01946000
019470     MOVE 'CM'                   TO ASC-KEY-CM-STAT.              01947000
019480     MOVE 'VE'                   TO ASC-KEY-VE-STAT.              01948000
019490                                                                  01949000
019500     PERFORM 2300-GET-NEXT-RECORD.                                01950000
019510     MOVE RC013-OPER-UNT-ID (ASC-SEL-SUB)                         01951000
019520                                 TO ASC-KEY-OPER-UNT-ID           01952000
019530                                    DK-OPER-UNT-ID.               01953000
019540     MOVE RC013-FCLTY-ID    (ASC-SEL-SUB)                         01954000
019550                                 TO ASC-KEY-FCLTY-ID              01955000
019560                                    DK-FCLTY-ID.                  01956000
019570/                                                                 01957000
019580*---------------------------------------------------------------* 01958000
019590*    ENTRY IS FROM A LIST.  GET THE KEYS FROM THE TEMP STORAGE  * 01959000
019600*    QUEUE PASSED FROM THE LIST.                                * 01960000
019610*---------------------------------------------------------------* 01961000
019620 1121-PREPARE-PO-LIST-ENTRY.                                      01962000
019630                                                                  01963000
019640     MOVE TR018-MAX-ITEMS        TO ASC-SEL-SUB.                  01964000
019650     MOVE ZERO                   TO ASC-SEL-ITEM.                 01965000
019660     MOVE 'AC'                   TO ASC-KEY-AC-STAT.              01966000
019670     MOVE 'IN'                   TO ASC-KEY-IN-STAT.              01967000
019680     MOVE 'IP'                   TO ASC-KEY-IP-STAT.              01968000
019690     MOVE 'CM'                   TO ASC-KEY-CM-STAT.              01969000
019700     MOVE 'VE'                   TO ASC-KEY-VE-STAT.              01970000
019710                                                                  01971000
019720     PERFORM 2301-GET-NEXT-RECORD-PO-LIST.                        01972000
019730     MOVE TR018-PO-NBR (ASC-SEL-SUB)                              01973000
019740                                 TO ASC-KEY-PO-NBR-N.             01974000
019750     MOVE TR018-REC-SEQ-NBR (ASC-SEL-SUB)                         01975000
019760                                 TO ASC-KEY-REC-SEQ-NBR.          01976000
019770                                                                  01977000
019780     MOVE TR017-OPER-UNIT        TO ASC-KEY-OPER-UNT-ID           01978000
019790                                    DK-OPER-UNT-ID.               01979000
019800     MOVE TR017-FCLTY-ID         TO ASC-KEY-FCLTY-ID              01980000
019810                                    DK-FCLTY-ID.                  01981000
019820/                                                                 01982000
019830*---------------------------------------------------------------* 01983000
019840*    ENTRY IS FROM A LIST.  GET THE KEYS FROM THE TEMP STORAGE  * 01984000
019850*    QUEUE PASSED FROM THE LIST.                                * 01985000
019860*---------------------------------------------------------------* 01986000
019870 1122-PREPARE-TRIP-PO-LIST.                                       01987000
019880                                                                  01988000
019890     MOVE DS002-MAX-ITEMS        TO ASC-SEL-SUB.                  01989000
019900     MOVE ZERO                   TO ASC-SEL-ITEM.                 01990000
019910     MOVE 'AC'                   TO ASC-KEY-AC-STAT.              01991000
019920     MOVE 'IN'                   TO ASC-KEY-IN-STAT.              01992000
019930     MOVE 'IP'                   TO ASC-KEY-IP-STAT.              01993000
019940     MOVE 'CM'                   TO ASC-KEY-CM-STAT.              01994000
019950     MOVE 'VE'                   TO ASC-KEY-VE-STAT.              01995000
019960                                                                  01996000
019970     PERFORM 2302-GET-NEXT-TRIP-PO-LIST.                          01997000
019980     MOVE DS002-PO-RCVR (ASC-SEL-SUB)                             01998000
019990                                 TO PV-PO-RCVR.                   01999000
020000     MOVE PV-PO                  TO ASC-KEY-PO-NBR-N.             02000000
020010     MOVE PV-RCVR                TO ASC-KEY-REC-SEQ-NBR.          02001000
020020                                                                  02002000
020030     MOVE DS003-OPER-UNT-ID      TO ASC-KEY-OPER-UNT-ID           02003000
020040                                    DK-OPER-UNT-ID.               02004000
020050     MOVE DS003-FCLTY-ID         TO ASC-KEY-FCLTY-ID              02005000
020060                                    DK-FCLTY-ID.                  02006000
020070                                                                  02007000
020080 1160-GET-ADDTLN-INFO.                                            02008000
020090        EXEC SQL                                                  02009000
020100            SELECT B.OPER_UNT_ID                                  02010000
020110                 , B.FCLTY_ID                                     02011000
020120                 , B.PO_NBR                                       02012000
020130                 , B.REC_SEQ_NBR                                  02013000
020140              INTO :PKSLIP-OPER-UNT-ID                            02014000
020150                  ,:PKSLIP-FCLTY-ID                               02015000
020160                  ,:PKSLIP-PO-NBR                                 02016000
020170                  ,:PKSLIP-REC-SEQ-NBR                            02017000
020180              FROM TINPKSU A                                      02018000
020190                  ,TPKSLIP B                                      02019000
020200             WHERE A.SHIPT_UNT_ID  = :ASC-SHIPT-UNT-ID            02020000
020210               AND A.PO_NBR        = B.PO_NBR                     02021000
020220               AND A.SEQ_NBR       = B.SEQ_NBR                    02022000
020230               AND B.VER_STAT_CDE  = 'A'                          02023000
020240               AND B.PKSL_STAT_CDE <> 'DE'                        02024000
020250        END-EXEC.                                                 02025000
020260                                                                  02026000
020270         EVALUATE TRUE                                            02027000
020280             WHEN SQLCODE = ZERO                                  02028000
020290                  MOVE PKSLIP-OPER-UNT-ID TO ASC-KEY-OPER-UNT-ID  02029000
020300                  MOVE PKSLIP-FCLTY-ID    TO ASC-KEY-FCLTY-ID     02030000
020310                  MOVE PKSLIP-PO-NBR      TO ASC-KEY-PO-NBR-N     02031000
020320                  MOVE PKSLIP-REC-SEQ-NBR TO ASC-KEY-REC-SEQ-NBR  02032000
020330             WHEN SQLCODE = +100                                  02033000
020340                  MOVE ZEROES             TO ASC-KEY-OPER-UNT-ID  02034000
020350                                             ASC-KEY-FCLTY-ID     02035000
020360                                             ASC-KEY-PO-NBR       02036000
020370                                             ASC-KEY-REC-SEQ-NBR  02037000
020380             WHEN SQLCODE = -904                                  02038000
020390             WHEN SQLCODE = -911                                  02039000
020400             WHEN SQLCODE = -913                                  02040000
020410                  PERFORM 9900-SOFT-ABORT                         02041000
020420                                                                  02042000
020430             WHEN SQLWARN0 NOT = SPACES                           02043000
020440             WHEN SQLCODE  NOT = ZERO                             02044000
020450                 MOVE '1160-GET-ADDTLN-INFO' TO DP013-PARAGRAPH   02045000
020460                  MOVE 'UNSUCCESSFUL SELECT OF OPER UNIT ID'      02046000
020470                                 TO DP013-MESSAGE-TEXT (1)        02047000
020480                  MOVE ASC-KEY-PO-NBR TO PV-MSG-KEY-PO            02048000
020490                  MOVE ASC-KEY-REC-SEQ-NBR                        02049000
020500                                       TO PV-MSG-KEY-REC-SEQ-NBR-N02050000
020510                  MOVE PV-MSG-KEYS TO DP013-MESSAGE-TEXT (2)      02051000
020520                  MOVE SQLCA     TO DP013-SQLCA                   02052000
020530                  MOVE 'TPKSLIP' TO DP013-DB2-TABLE-NAME (1)      02053000
020540                  SET DP013-DB2-ABEND                             02054000
020550                      DP013-XCTL-DISPLAY-RESTART TO TRUE          02055000
020560                  PERFORM DP013-0000-PROCESS-ABEND                02056000
020570         END-EVALUATE.                                            02057000
020580                                                                  02058000
020590******************************************************************02059000
020600 2000-PROCESS-PANEL.                                              02060000
020610                                                                  02061000
020620     EVALUATE TRUE                                                02062000
020630                                                                  02063000
020640         WHEN DP020-SRC-AID = DP016-CLEAR                         02064000
020650              MOVE ZERO          TO ASC-ITEM-AT-TOP-OF-PANEL      02065000
020660                                                                  02066000
020670              PERFORM 3000-EDIT-DATA-IN-COMMAREA                  02067000
020680                                                                  02068000
020690              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                02069000
020700                                                                  02070000
020710                                                                  02071000
020720         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    02072000
020730                                                                  02073000
020740              PERFORM 2050-DELETE-LIST-QUEUE                      02074000
020750                                                                  02075000
020760              PERFORM 4000-BUILD-INITIAL-PANEL                    02076000
020770                                                                  02077000
020780                                                                  02078000
020790         WHEN DP020-FK-DESELECT (DP020-SRC-AID)                   02079000
020800                                                                  02080000
020810              PERFORM 2140-DESELECT-ALL-ITEMS                     02081000
020820                                                                  02082000
020830              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                02083000
020840                                                                  02084000
020850                                                                  02085000
020860         WHEN DP020-FK-SELECT-ALL (DP020-SRC-AID)                 02086000
020870                                                                  02087000
020880              PERFORM 2150-SELECT-ALL-ITEMS                       02088000
020890                                                                  02089000
020900              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                02090000
020910                                                                  02091000
020920                                                                  02092000
020930         WHEN OTHER                                               02093000
020940                                                                  02094000
020950              PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                02095000
020960                                                                  02096000
020970              PERFORM 3000-EDIT-DATA-IN-COMMAREA                  02097000
020980                                                                  02098000
020990              IF PS-NO-ERROR                                      02099000
021000                  SET DP030-CONTINUE-GO                           02100000
021010                                 TO TRUE                          02101000
021020                                                                  02102000
021030                  PERFORM 2100-CHECK-FUNCTION-KEY                 02103000
021040                                                                  02104000
021050              ELSE                                                02105000
021060                  SET DP030-OVERRIDE-GO                           02106000
021070                                 TO TRUE                          02107000
021080              END-IF                                              02108000
021090                                                                  02109000
021100     END-EVALUATE.                                                02110000
021110                                                                  02111000
021120 2050-DELETE-LIST-QUEUE.                                          02112000
021130                                                                  02113000
021140     EXEC CICS DELETEQ TS QUEUE (ASC-LIST-QUEUE-NAME)             02114000
021150                          RESP  (PV-CICS-RESP)                    02115000
021160                          END-EXEC.                               02116000
021170                                                                  02117000
021180     IF (PV-CICS-RESP = DFHRESP (NORMAL)) OR                      02118000
021190        (PV-CICS-RESP = DFHRESP (QIDERR))                         02119000
021200         CONTINUE                                                 02120000
021210     ELSE                                                         02121000
021220         SET DP013-CICS-ABEND                                     02122000
021230             DP013-NO-ROLLBACK   TO TRUE                          02123000
021240         MOVE '2050-DELETE-LIST-QUEUE'                            02124000
021250                                 TO DP013-PARAGRAPH               02125000
021260         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE DELETE' 02126000
021270                                 TO DP013-MESSAGE-TEXT (1)        02127000
021280                                                                  02128000
021290         PERFORM DP013-0000-PROCESS-ABEND.                        02129000
021300                                                                  02130000
021310     MOVE ZERO                   TO ASC-HIGHEST-BLOCK-WRITTEN.    02131000
021320                                                                  02132000
021330 2100-CHECK-FUNCTION-KEY.                                         02133000
021340                                                                  02134000
021350     IF  ASC-READ-ONLY                                            02135000
021360         IF (DP020-SRC-AID EQUAL DP016-PF14                       02136000
021370         OR  DP020-SRC-AID EQUAL DP016-PF16                       02137000
021380         OR  DP020-SRC-AID EQUAL DP016-PF18                       02138000
021390         OR  DP020-SRC-AID EQUAL DP016-PF23)                      02139000
021400             MOVE PC-TSYMSG-00966                                 02140000
021410                         TO DP020-MSG-NUMBER                      02141000
021420             SET PS-ERROR                                         02142000
021430                 DP030-OVERRIDE-GO                                02143000
021440                 DP020-MSG-FATAL TO  TRUE                         02144000
021450             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 02145000
021460         ELSE                                                     02146000
021470             PERFORM 2101-REAL-PFKEY-CHECK                        02147000
021480             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 02148000
021490         END-IF                                                   02149000
021500     ELSE                                                         02150000
021510         PERFORM 2101-REAL-PFKEY-CHECK                            02151000
021520         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     02152000
021530     END-IF.                                                      02153000
021540                                                                  02154000
021550 2101-REAL-PFKEY-CHECK.                                           02155000
021560                                                                  02156000
021570     IF DP020-FK-CONFIRM (DP020-SRC-AID)                          02157000
021580         IF  ASC-TRNSCRP-PENDING                                  02158000
021590             SET DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID) TO TRUE   02159000
021600                                                                  02160000
021610         ELSE                                                     02161000
021620             IF ASC-INACTIVATE-PENDING                            02162000
021630                 SET DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID) TO    02163000
021640                                 TRUE                             02164000
021650             ELSE                                                 02165000
021660                 MOVE PC-TSYMSG-00016  TO DP020-MSG-NUMBER        02166000
021670                 SET DP020-MSG-WARNING TO TRUE                    02167000
021680             END-IF                                               02168000
021690         END-IF                                                   02169000
021700     END-IF.                                                      02170000
021710                                                                  02171000
021720     EVALUATE TRUE                                                02172000
021730         WHEN DP020-FK-LOCAL-GOTO (DP020-SRC-AID)                 02173000
021740         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              02174000
021750*             XFER TO PRE-RECEIVER ADD                            02175000
021760         WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)              02176000
021770*             XFER TO RCKCS800 RECEIVER PACK LIST                 02177000
021780              INITIALIZE RC015-INTER-APPL-COMMAREA                02178000
021790              MOVE ASC-NUMBER-OF-SELECTED-ITEMS                   02179000
021800                                 TO RC015-NUMBER-OF-SELECTED-ITEMS02180000
021810              MOVE ASC-KEY-PO-NBR-N                               02181000
021820                                 TO DK-PO-NBR                     02182000
021830                                    RC015-PO-NBR                  02183000
021840              MOVE ASC-KEY-OPER-UNT-ID                            02184000
021850                                 TO RC015-OPER-UNT-ID             02185000
021860              MOVE ASC-KEY-FCLTY-ID                               02186000
021870                                 TO RC015-FCLTY-ID                02187000
021880              MOVE 0 TO PV-NUMBER-OF-SELECTED-ITEM                02188000
021890              PERFORM 5000-PREPARE-SEL-QUEUE                      02189000
021900              IF PV-NUMBER-OF-SELECTED-ITEM =  ZERO               02190000
021910                  SET ASC-NO-TSQ-UPDATE                           02191000
021920                                 TO TRUE                          02192000
021930                  IF DP020-SRC-AID EQUAL DP016-PF13               02193000
021940                      IF ASC-CAME-FROM-RCVG                       02194000
021950                          MOVE ASC-KEY-REC-SEQ-NBR                02195000
021960                                     TO RC015-REC-SEQ-NBR         02196000
021970                          SET ASC-CAME-FROM-PACK-SLIP             02197000
021980                                     TO TRUE                      02198000
021990                      END-IF                                      02199000
022000                  ELSE                                            02200000
022010                      MOVE PC-TSYMSG-00050                        02201000
022020                                     TO DP020-MSG-NUMBER          02202000
022030                      SET ASC-NO-TSQ-UPDATE                       02203000
022040                          DP020-MSG-FATAL                         02204000
022050                          PS-ERROR                                02205000
022060                                     TO TRUE                      02206000
022070                  END-IF                                          02207000
022080              END-IF                                              02208000
022090              IF  PS-ERROR                                        02209000
022100                  PERFORM 2105-DISPLAY-ERROR                      02210000
022110              END-IF                                              02211000
022120                                                                  02212000
022130         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              02213000
022140         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              02214000
022150         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              02215000
022160              IF DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)           02216000
022170                 IF ASC-INACTIVATE-PENDING                        02217000
022180                     AND DP020-SRC-AID NOT EQUAL DP016-PF2        02218000
022190                     SET PS-ERROR                                 02219000
022200                         DP020-MSG-WARNING                        02220000
022210                                         TO TRUE                  02221000
022220                     MOVE PC-TSYMSG-00004    TO DP020-MSG-NUMBER  02222000
022230                 ELSE                                             02223000
022240                  PERFORM 2103-RACF-ACCESS                        02224000
022250                  IF PS-INACT-NOT-ALLOWED                         02225000
022260                      SET ASC-NO-TSQ-UPDATE                       02226000
022270                                 TO TRUE                          02227000
022280                      SET DP030-OVERRIDE-GO                       02228000
022290                          DP020-MSG-WARNING                       02229000
022300                                 TO TRUE                          02230000
022310                      MOVE PC-TSYMSG-99910                        02231000
022320                                 TO DP020-MSG-NUMBER              02232000
022330                  END-IF                                          02233000
022340                END-IF                                            02234000
022350                                                                  02235000
022360              END-IF                                              02236000
022370                                                                  02237000
022380              IF DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)  OR       02238000
022390                 DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)           02239000
022400                  PERFORM 2104-RACF-ACCESS-TRANSCRIPTION          02240000
022410                  IF PS-TRNSC-NOT-ALLOWED                         02241000
022420                      SET ASC-NO-TSQ-UPDATE                       02242000
022430                                 TO TRUE                          02243000
022440                      SET DP030-OVERRIDE-GO                       02244000
022450                          DP020-MSG-WARNING                       02245000
022460                                 TO TRUE                          02246000
022470                      MOVE PC-TSYMSG-99910                        02247000
022480                                 TO DP020-MSG-NUMBER              02248000
022490                  END-IF                                          02249000
022500              END-IF                                              02250000
022510                                                                  02251000
022520              IF (DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID) AND      02252000
022530                  PS-TRNSC-ALLOWED)                          OR   02253000
022540                 (DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID) AND      02254000
022550                  PS-TRNSC-ALLOWED)                          OR   02255000
022560                 (DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID) AND      02256000
022570                 PS-INACT-ALLOWED)                                02257000
022580                  IF ASC-NUMBER-OF-SELECTED-ITEMS > ZERO          02258000
022590                      INITIALIZE RC015-INTER-APPL-COMMAREA        02259000
022600                      MOVE ASC-NUMBER-OF-SELECTED-ITEMS           02260000
022610                                TO RC015-NUMBER-OF-SELECTED-ITEMS 02261000
022620                      MOVE ASC-KEY-PO-NBR-N                       02262000
022630                                     TO DK-PO-NBR                 02263000
022640                                        RC015-PO-NBR              02264000
022650                      MOVE ASC-KEY-OPER-UNT-ID                    02265000
022660                                     TO RC015-OPER-UNT-ID         02266000
022670                                        DK-OPER-UNT-ID            02267000
022680                      MOVE ASC-KEY-FCLTY-ID                       02268000
022690                                     TO RC015-FCLTY-ID            02269000
022700                                        DK-FCLTY-ID               02270000
022710                      PERFORM 5000-PREPARE-SEL-QUEUE              02271000
022720                      SET ASC-NO-TSQ-UPDATE                       02272000
022730                                     TO TRUE                      02273000
022740                      IF  PS-ERROR                                02274000
022750                          PERFORM 2105-DISPLAY-ERROR              02275000
022760                      END-IF                                      02276000
022770                  ELSE                                            02277000
022780                      IF ASC-NUMBER-OF-SELECTED-ITEMS = ZERO      02278000
022790                          SET ASC-NO-TSQ-UPDATE                   02279000
022800                                     TO TRUE                      02280000
022810                          SET DP030-OVERRIDE-GO                   02281000
022820                              DP020-MSG-WARNING                   02282000
022830                                     TO TRUE                      02283000
022840                          MOVE PC-TSYMSG-00057                    02284000
022850                                     TO DP020-MSG-NUMBER          02285000
022860                      END-IF                                      02286000
022870                  END-IF                                          02287000
022880              END-IF                                              02288000
022890                                                                  02289000
022900         WHEN DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)              02290000
022910             PERFORM 2101B-FUNC-05                                02291000
022920                                                                  02292000
022930         WHEN DP020-FK-FIRST-PAGE (DP020-SRC-AID)                 02293000
022940             MOVE +1             TO PV-TOP-ITEM                   02294000
022950                                                                  02295000
022960             PERFORM 3200-RESET-ATTRIBUTES                        02296000
022970                                                                  02297000
022980             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 02298000
022990                                                                  02299000
023000                                                                  02300000
023010         WHEN DP020-FK-PREV-PAGE (DP020-SRC-AID)                  02301000
023020                                                                  02302000
023030             PERFORM 2110-BROWSE-BACKWARD                         02303000
023040                                                                  02304000
023050             PERFORM 3200-RESET-ATTRIBUTES                        02305000
023060                                                                  02306000
023070             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 02307000
023080                                                                  02308000
023090                                                                  02309000
023100         WHEN DP020-FK-NEXT-PAGE (DP020-SRC-AID)                  02310000
023110                                                                  02311000
023120             PERFORM 2120-BROWSE-FORWARD                          02312000
023130                                                                  02313000
023140             PERFORM 3200-RESET-ATTRIBUTES                        02314000
023150                                                                  02315000
023160             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 02316000
023170                                                                  02317000
023180                                                                  02318000
023190         WHEN DP020-SRC-AID = DP016-ENTER                         02319000
023200                                                                  02320000
023210             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   02321000
023220                                                                  02322000
023230             IF PS-NO-ERROR                                       02323000
023240                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             02324000
023250             END-IF                                               02325000
023260                                                                  02326000
023270         WHEN DP020-FK-CONFIRM (DP020-SRC-AID)                    02327000
023280             CONTINUE                                             02328000
023290                                                                  02329000
023300         WHEN OTHER                                               02330000
023310             SET DP013-CICS-ABEND                                 02331000
023320                 DP013-NO-ROLLBACK                                02332000
023330                 DP013-XCTL-DISPLAY-RESTART                       02333000
023340                                 TO TRUE                          02334000
023350             MOVE '2100-CHECK-FUNCTION-KEY'                       02335000
023360                                 TO DP013-PARAGRAPH               02336000
023370             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      02337000
023380                                 TO DP013-MESSAGE-TEXT (1)        02338000
023390                                                                  02339000
023400             PERFORM DP013-0000-PROCESS-ABEND                     02340000
023410     END-EVALUATE.                                                02341000
023420/                                                                 02342000
023430 2101B-FUNC-05.                                                   02343000
023440     PERFORM 2104A-RACF-ACCESS-PACKSLP-LIST                       02344000
023450     IF PS-PKSLIP-LIST-NOT-ALLOWED                                02345000
023460         SET ASC-NO-TSQ-UPDATE                                    02346000
023470             DP030-OVERRIDE-GO                                    02347000
023480             DP020-MSG-WARNING        TO TRUE                     02348000
023490         MOVE PC-TSYMSG-99910         TO DP020-MSG-NUMBER         02349000
023500     END-IF                                                       02350000
023510     IF PS-PKSLIP-LIST-ALLOWED                                    02351000
023520         INITIALIZE RC015-INTER-APPL-COMMAREA                     02352000
023530         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        02353000
023540                                      TO                          02354000
023550                               RC015-NUMBER-OF-SELECTED-ITEMS     02355000
023560         MOVE ASC-KEY-PO-NBR-N        TO DK-PO-NBR                02356000
023570                                         RC015-PO-NBR             02357000
023580         MOVE ASC-KEY-OPER-UNT-ID     TO RC015-OPER-UNT-ID        02358000
023590         MOVE ASC-KEY-FCLTY-ID        TO RC015-FCLTY-ID           02359000
023600         MOVE ZERO                    TO                          02360000
023610                              PV-NUMBER-OF-SELECTED-ITEM          02361000
023620         PERFORM 5000-PREPARE-SEL-QUEUE                           02362000
023630         IF PV-NUMBER-OF-SELECTED-ITEM =  ZERO                    02363000
023640             SET ASC-NO-TSQ-UPDATE    TO TRUE                     02364000
023650             IF DP020-SRC-AID EQUAL DP016-PF13                    02365000
023660                 IF ASC-CAME-FROM-RCVG                            02366000
023670                     MOVE ASC-KEY-REC-SEQ-NBR                     02367000
023680                                      TO RC015-REC-SEQ-NBR        02368000
023690                     SET ASC-CAME-FROM-PACK-SLIP                  02369000
023700                                      TO TRUE                     02370000
023710                 END-IF                                           02371000
023720             ELSE                                                 02372000
023730                 MOVE PC-TSYMSG-00050 TO DP020-MSG-NUMBER         02373000
023740                 SET ASC-NO-TSQ-UPDATE                            02374000
023750                          DP020-MSG-FATAL                         02375000
023760                          PS-ERROR                                02376000
023770                                      TO TRUE                     02377000
023780             END-IF                                               02378000
023790         END-IF                                                   02379000
023800     END-IF.                                                      02380000
023810     IF PS-ERROR                                                  02381000
023820         PERFORM 2105-DISPLAY-ERROR                               02382000
023830     END-IF.                                                      02383000
023840                                                                  02384000
023850 2103-RACF-ACCESS.                                                02385000
023860                                                                  02386000
023870* IS THE USER AUTHORIZED TO INACTIVATE PACK SLIPS ON THIS SCREEN? 02387000
023880                                                                  02388000
023890      SET DP008-RSRC-TYPE-FUNC           TO TRUE                  02389000
023900      MOVE 'RCPSINAC'                    TO DP008-FUNCTION-NAME   02390000
023910      SET DP008-ACCESS-TYPE-USE          TO TRUE                  02391000
023920                                                                  02392000
023930      EXEC CICS                                                   02393005
023940         LINK PROGRAM (DP008-SECURITY-SUBROUTINE)                 02394000
023950              COMMAREA (DP008-SECURITY-COMMAREA)                  02395000
023960              LENGTH (DP008-SECURITY-COMMAREA-LENGTH)             02396000
023970      END-EXEC                                                    02397000
023980                                                                  02398000
023990      IF DP008-CALL-SUCCESSFUL                                    02399000
024000         IF DP008-ACCESS-ALLOWED                                  02400000
024010             SET PS-INACT-ALLOWED TO TRUE                         02401000
024020         ELSE                                                     02402000
024030             SET PS-INACT-NOT-ALLOWED TO TRUE                     02403000
024040         END-IF                                                   02404000
024050     ELSE                                                         02405000
024060         MOVE '2103-RACF-ACCESS'                                  02406000
024070                               TO DP013-PARAGRAPH                 02407000
024080          MOVE 'UNABLE TO ACCESS CICS'                            02408000
024090                               TO DP013-MESSAGE-TEXT (1)          02409000
024100          MOVE SQLCA                 TO DP013-SQLCA               02410000
024110          SET DP013-DB2-ABEND                                     02411000
024120              DP013-XCTL-DISPLAY-RESTART                          02412000
024130                               TO TRUE                            02413000
024140          PERFORM DP013-0000-PROCESS-ABEND                        02414000
024150      END-IF.                                                     02415000
024160                                                                  02416000
024170******************************************************************02417000
024180* IS THE USER AUTHORIZED TO ACCESS THESE FUNCTIONS ON THIS SCREEN 02418000
024190*   LOCAL-03 - F14  TRCSPCM      LOCAL-01 - F23  ADDTORCV         02419000
024200******************************************************************02420000
024210 2104-RACF-ACCESS-TRANSCRIPTION.                                  02421000
024220                                                                  02422000
024230      SET DP008-RSRC-TYPE-FUNC           TO TRUE                  02423000
024240      MOVE 'RCTRNSCR'                    TO DP008-FUNCTION-NAME   02424000
024250      SET DP008-ACCESS-TYPE-USE          TO TRUE                  02425000
024260                                                                  02426000
024270      EXEC CICS                                                   02427000
024280         LINK PROGRAM (DP008-SECURITY-SUBROUTINE)                 02428000
024290              COMMAREA (DP008-SECURITY-COMMAREA)                  02429000
024300              LENGTH (DP008-SECURITY-COMMAREA-LENGTH)             02430000
024310      END-EXEC                                                    02431000
024320                                                                  02432000
024330      IF DP008-CALL-SUCCESSFUL                                    02433000
024340         IF DP008-ACCESS-ALLOWED                                  02434000
024350             SET PS-TRNSC-ALLOWED TO TRUE                         02435000
024360         ELSE                                                     02436000
024370             SET PS-TRNSC-NOT-ALLOWED TO TRUE                     02437000
024380         END-IF                                                   02438000
024390     ELSE                                                         02439000
024400         MOVE '2104-RACF-ACCESS-TRANSCRIPTION'                    02440000
024410                               TO DP013-PARAGRAPH                 02441000
024420          MOVE 'UNABLE TO ACCESS CICS'                            02442000
024430                               TO DP013-MESSAGE-TEXT (1)          02443000
024440          MOVE SQLCA                 TO DP013-SQLCA               02444000
024450          SET DP013-DB2-ABEND                                     02445000
024460              DP013-XCTL-DISPLAY-RESTART                          02446000
024470                               TO TRUE                            02447000
024480          PERFORM DP013-0000-PROCESS-ABEND                        02448000
024490      END-IF.                                                     02449000
024500                                                                  02450000
024510/                                                                 02451000
024520******************************************************************02452000
024530* IS THE USER AUTHORIZED TO ACCESS THESE FUNCTIONS ON THIS SCREEN 02453000
024540*   LOCAL-05 - F24  RCVRITEM                                      02454000
024550******************************************************************02455000
024560 2104A-RACF-ACCESS-PACKSLP-LIST.                                  02456000
024570                                                                  02457000
024580      SET DP008-RSRC-TYPE-FUNC           TO TRUE                  02458000
024590      MOVE 'RCRCITEM'                    TO DP008-FUNCTION-NAME   02459000
024600      SET DP008-ACCESS-TYPE-USE          TO TRUE                  02460000
024610                                                                  02461000
024620      EXEC CICS                                                   02462000
024630         LINK PROGRAM (DP008-SECURITY-SUBROUTINE)                 02463000
024640              COMMAREA (DP008-SECURITY-COMMAREA)                  02464000
024650              LENGTH (DP008-SECURITY-COMMAREA-LENGTH)             02465000
024660      END-EXEC                                                    02466000
024670                                                                  02467000
024680      IF DP008-CALL-SUCCESSFUL                                    02468000
024690         IF DP008-ACCESS-ALLOWED                                  02469000
024700             SET PS-PKSLIP-LIST-ALLOWED TO TRUE                   02470000
024710         ELSE                                                     02471000
024720             SET PS-PKSLIP-LIST-NOT-ALLOWED TO TRUE               02472000
024730         END-IF                                                   02473000
024740     ELSE                                                         02474000
024750         MOVE '2104-RACF-ACCESS-TRANSCRIPTION'                    02475000
024760                               TO DP013-PARAGRAPH                 02476000
024770          MOVE 'UNABLE TO ACCESS CICS'                            02477000
024780                               TO DP013-MESSAGE-TEXT (1)          02478000
024790          MOVE SQLCA                 TO DP013-SQLCA               02479000
024800          SET DP013-DB2-ABEND                                     02480000
024810              DP013-XCTL-DISPLAY-RESTART                          02481000
024820                               TO TRUE                            02482000
024830          PERFORM DP013-0000-PROCESS-ABEND                        02483000
024840      END-IF.                                                     02484000
024850                                                                  02485000
024860/                                                                 02486000
024870 2105-DISPLAY-ERROR.                                              02487000
024880                                                                  02488000
024890     SET DP030-OVERRIDE-GO       TO  TRUE.                        02489000
024900     MOVE ZERO                   TO  ASC-ITEM-AT-TOP-OF-PANEL.    02490000
024910     INITIALIZE ASC-BLOCK-ENTRIES (1)                             02491000
024920                ASC-BLOCK-ENTRIES (2).                            02492000
024930                                                                  02493000
024940     DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL                     02494000
024950           GIVING    PV-BLOCK-NUMBER                              02495000
024960           REMAINDER PV-REMAINDER.                                02496000
024970     IF  PV-REMAINDER > ZERO                                      02497000
024980         ADD +1                  TO  PV-BLOCK-NUMBER              02498000
024990     END-IF.                                                      02499000
025000                                                                  02500000
025010     MOVE +1                     TO  ASC-BLK-SUB.                 02501000
025020     PERFORM 4410-READ-TEMP-STORAGE                               02502000
025030     ADD +1                      TO  ASC-BLK-SUB                  02503000
025040                                     PV-BLOCK-NUMBER.             02504000
025050     PERFORM 4410-READ-TEMP-STORAGE.                              02505000
025060     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        02506000
025070/                                                                 02507000
025080 2110-BROWSE-BACKWARD.                                            02508000
025090                                                                  02509000
025100     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    02510000
025110         GIVING PV-TOP-ITEM.                                      02511000
025120                                                                  02512000
025130     IF PV-TOP-ITEM NOT > +1                                      02513000
025140         MOVE +1                 TO PV-TOP-ITEM                   02514000
025150         MOVE PC-TSYMSG-00069    TO DP020-MSG-NUMBER              02515000
025160         SET DP020-MSG-INFORMATIONAL                              02516000
025170                                 TO TRUE.                         02517000
025180                                                                  02518000
025190 2120-BROWSE-FORWARD.                                             02519000
025200                                                                  02520000
025210     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              02521000
025220         GIVING PV-TOP-ITEM.                                      02522000
025230                                                                  02523000
025240     IF PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                    02524000
025250         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            02525000
025260                                 TO PV-TOP-ITEM                   02526000
025270         MOVE PC-TSYMSG-00070    TO DP020-MSG-NUMBER              02527000
025280         SET DP020-MSG-INFORMATIONAL                              02528000
025290                                 TO TRUE                          02529000
025300     ELSE                                                         02530000
025310         COMPUTE PV-BOTTOM-ITEM =                                 02531000
025320             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 02532000
025330         IF PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ             02533000
025340             MOVE PC-TSYMSG-00070                                 02534000
025350                                 TO DP020-MSG-NUMBER              02535000
025360             SET DP020-MSG-INFORMATIONAL                          02536000
025370                                 TO TRUE.                         02537000
025380                                                                  02538000
025390 2130-CHECK-FOR-JUMP-BROWSE.                                      02539000
025400                                                                  02540000
025410     SET PS-NO-ERROR             TO TRUE.                         02541000
025420     IF ASC-START-ITEM-REQUEST = SPACE                            02542000
025430         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            02543000
025440                                 TO PV-TOP-ITEM                   02544000
025450     ELSE                                                         02545000
025460         MOVE ASC-START-ITEM-REQUEST                              02546000
025470                                 TO DP010I-UNEDITED-FIELD         02547000
025480         MOVE +5                 TO DP010I-MAXIMUM-DIGITS         02548000
025490         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       02549000
025500         SET DP010I-NEGATIVE-NOT-ALLOWED                          02550000
025510                                 TO TRUE                          02551000
025520                                                                  02552000
025530         CALL DP010I-NUMERIC-EDIT-ROUTINE                         02553025
025531              USING DP010I-NUMERIC-EDIT-AREA                      02553125
025540                                                                  02554000
025550         IF NOT DP010I-ERROR-DETECTED                             02555000
025560             MOVE DP010I-NUMERIC-FIELD                            02556000
025570                                 TO ASC-START-ITEM-REQUEST-N      02557000
025580             IF ASC-START-ITEM-REQUEST-N > ZERO                   02558000
025590                IF ASC-START-ITEM-REQUEST-N >                     02559000
025600                                          ASC-NUMBER-OF-ITEMS-READ02560000
025610                    MOVE SPACE   TO ASC-START-ITEM-REQUEST        02561000
025620                    COMPUTE PV-TOP-ITEM = ASC-NUMBER-OF-ITEMS-READ02562000
025630                                          - PC-ITEMS-PER-PANEL + 102563000
025640                    IF PV-TOP-ITEM < +1                           02564000
025650                        MOVE +1  TO PV-TOP-ITEM                   02565000
025660                        MOVE PC-TSYMSG-00070                      02566000
025670                                 TO DP020-MSG-NUMBER              02567000
025680                        SET DP020-MSG-INFORMATIONAL               02568000
025690                                 TO TRUE                          02569000
025700                    END-IF                                        02570000
025710                ELSE                                              02571000
025720                    MOVE ASC-START-ITEM-REQUEST-N                 02572000
025730                                 TO PV-TOP-ITEM                   02573000
025740                    MOVE SPACE   TO ASC-START-ITEM-REQUEST        02574000
025750                    COMPUTE PV-BOTTOM-ITEM = PV-TOP-ITEM +        02575000
025760                                            PC-ITEMS-PER-PANEL - 102576000
025770                    IF PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ  02577000
025780                         MOVE PC-TSYMSG-00070                     02578000
025790                                 TO DP020-MSG-NUMBER              02579000
025800                         SET DP020-MSG-INFORMATIONAL              02580000
025810                                 TO TRUE                          02581000
025820                    END-IF                                        02582000
025830                END-IF                                            02583000
025840             ELSE                                                 02584000
025850                 MOVE PC-TSYMSG-00101                             02585000
025860                                 TO DP020-MSG-NUMBER              02586000
025870                 SET DP030-SET-CURSOR-APPL-1                      02587000
025880                                 TO TRUE                          02588000
025890                 MOVE -1         TO ASTRTITL                      02589000
025900                 MOVE DP015-UNP-NUM-BRT-MDT                       02590000
025910                                 TO ASTRTITA                      02591000
025920                 MOVE DP015-RED  TO ASTRTITC                      02592000
025930                 MOVE DP015-REVERSE                               02593000
025940                                 TO ASTRTITH                      02594000
025950                 SET PS-ERROR                                     02595000
025960                     DP020-MSG-FATAL                              02596000
025970                                 TO TRUE                          02597000
025980             END-IF                                               02598000
025990         ELSE                                                     02599000
026000             MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER             02600000
026010             SET DP030-SET-CURSOR-APPL-1                          02601000
026020                                 TO TRUE                          02602000
026030             MOVE -1             TO ASTRTITL                      02603000
026040             MOVE DP015-UNP-NUM-BRT-MDT                           02604000
026050                                 TO ASTRTITA                      02605000
026060             MOVE DP015-RED      TO ASTRTITC                      02606000
026070             MOVE DP015-REVERSE  TO ASTRTITH                      02607000
026080             SET PS-ERROR                                         02608000
026090                 DP020-MSG-FATAL TO TRUE                          02609000
026100         END-IF                                                   02610000
026110     END-IF.                                                      02611000
026120                                                                  02612000
026130 2140-DESELECT-ALL-ITEMS.                                         02613000
026140                                                                  02614000
026150     MOVE +1                     TO ASC-BLK-SUB.                  02615000
026160                                                                  02616000
026170     PERFORM 2141-CLEAR-SELECTED-INDS                             02617000
026180             VARYING ASC-ITEM-SUB  FROM 1 BY 1                    02618000
026190             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           02619000
026200                                                                  02620000
026210     ADD +1                      TO ASC-BLK-SUB.                  02621000
026220                                                                  02622000
026230     PERFORM 2141-CLEAR-SELECTED-INDS                             02623000
026240             VARYING ASC-ITEM-SUB  FROM 1 BY 1                    02624000
026250             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           02625000
026260                                                                  02626000
026270     MOVE ASC-LIST-ITEM-NUMBER (1 1)                              02627000
026280                                 TO PV-LIST-ITEM-NUMBER.          02628000
026290                                                                  02629000
026300     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            02630000
026310             1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).02631000
026320                                                                  02632000
026330     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     02633000
026340              (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)02634000
026350         MOVE +1                 TO ASC-BLK-SUB                   02635000
026360                                                                  02636000
026370         PERFORM 5100-WRITE-TEMP-STORAGE                          02637000
026380                                                                  02638000
026390         MOVE +1                 TO PV-BLOCK-NUMBER               02639000
026400                                                                  02640000
026410         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         02641000
026420                                       PV-FIRST-BLOCK-IN-ARRAY - 102642000
026430                                                                  02643000
026440         PERFORM                                                  02644000
026450           UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY         02645000
026460                                                                  02646000
026470                 PERFORM 4410-READ-TEMP-STORAGE                   02647000
026480                                                                  02648000
026490                 PERFORM 2141-CLEAR-SELECTED-INDS                 02649000
026500                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        02650000
026510                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL02651000
026520                                                                  02652000
026530                 PERFORM 5100-WRITE-TEMP-STORAGE                  02653000
026540                                                                  02654000
026550                 ADD +1          TO PV-BLOCK-NUMBER               02655000
026560                                                                  02656000
026570         END-PERFORM                                              02657000
026580                                                                  02658000
026590         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         02659000
026600                  PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY02660000
026610                                                                  02661000
026620         PERFORM                                                  02662000
026630           UNTIL PV-NEXT-BLOCK-IN-ARRAY >                         02663000
026640                                         ASC-HIGHEST-BLOCK-WRITTEN02664000
026650                                                                  02665000
026660                 MOVE PV-NEXT-BLOCK-IN-ARRAY                      02666000
026670                                 TO PV-BLOCK-NUMBER               02667000
026680                                                                  02668000
026690                 PERFORM 4410-READ-TEMP-STORAGE                   02669000
026700                                                                  02670000
026710                 PERFORM 2141-CLEAR-SELECTED-INDS                 02671000
026720                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        02672000
026730                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL02673000
026740                                                                  02674000
026750                 PERFORM 5100-WRITE-TEMP-STORAGE                  02675000
026760                                                                  02676000
026770                 ADD +1          TO PV-NEXT-BLOCK-IN-ARRAY        02677000
026780                                                                  02678000
026790         END-PERFORM                                              02679000
026800                                                                  02680000
026810         MOVE PV-FIRST-BLOCK-IN-ARRAY                             02681000
026820                                 TO PV-BLOCK-NUMBER               02682000
026830                                                                  02683000
026840         PERFORM 4410-READ-TEMP-STORAGE                           02684000
026850                                                                  02685000
026860     END-IF.                                                      02686000
026870                                                                  02687000
026880     MOVE ZERO                   TO ASC-NUMBER-OF-SELECTED-ITEMS  02688000
026890                                    ASC-SELECTED-CARTON-COUNT     02689000
026900                                    ASC-START-OF-SELECTED-RANGE   02690000
026910                                    ASC-END-OF-SELECTED-RANGE.    02691000
026920                                                                  02692000
026930     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        02693000
026940                                                                  02694000
026950 2141-CLEAR-SELECTED-INDS.                                        02695000
026960                                                                  02696000
026970     IF ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB) NOT = ZERO02697000
026980        IF NOT ASC-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)           02698000
026990            SET ASC-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)          02699000
027000                ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)     02700000
027010                ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                  02701000
027020                                 TO TRUE.                         02702000
027030                                                                  02703000
027040 2150-SELECT-ALL-ITEMS.                                           02704000
027050                                                                  02705000
027060     MOVE +1                     TO ASC-BLK-SUB.                  02706000
027070                                                                  02707000
027080     PERFORM 2151-SET-SELECTED-INDS                               02708000
027090             VARYING ASC-ITEM-SUB FROM 1 BY 1                     02709000
027100             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           02710000
027110                                                                  02711000
027120     ADD +1                      TO ASC-BLK-SUB.                  02712000
027130                                                                  02713000
027140     PERFORM 2151-SET-SELECTED-INDS                               02714000
027150             VARYING ASC-ITEM-SUB FROM 1 BY 1                     02715000
027160             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           02716000
027170                                                                  02717000
027180     MOVE ASC-LIST-ITEM-NUMBER (1 1)                              02718000
027190                                 TO PV-LIST-ITEM-NUMBER.          02719000
027200                                                                  02720000
027210     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            02721000
027220             1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).02722000
027230                                                                  02723000
027240     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     02724000
027250              (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)02725000
027260         MOVE +1                 TO ASC-BLK-SUB                   02726000
027270                                                                  02727000
027280         PERFORM 5100-WRITE-TEMP-STORAGE                          02728000
027290                                                                  02729000
027300         MOVE +1                 TO PV-BLOCK-NUMBER               02730000
027310                                                                  02731000
027320         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         02732000
027330                                       PV-FIRST-BLOCK-IN-ARRAY - 102733000
027340                                                                  02734000
027350         PERFORM                                                  02735000
027360           UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY         02736000
027370                                                                  02737000
027380                 PERFORM 4410-READ-TEMP-STORAGE                   02738000
027390                                                                  02739000
027400                 PERFORM 2151-SET-SELECTED-INDS                   02740000
027410                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        02741000
027420                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL02742000
027430                                                                  02743000
027440                 PERFORM 5100-WRITE-TEMP-STORAGE                  02744000
027450                                                                  02745000
027460                 ADD +1          TO PV-BLOCK-NUMBER               02746000
027470                                                                  02747000
027480         END-PERFORM                                              02748000
027490                                                                  02749000
027500         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         02750000
027510                  PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY02751000
027520                                                                  02752000
027530         PERFORM                                                  02753000
027540           UNTIL PV-NEXT-BLOCK-IN-ARRAY >                         02754000
027550                                         ASC-HIGHEST-BLOCK-WRITTEN02755000
027560                                                                  02756000
027570                 MOVE PV-NEXT-BLOCK-IN-ARRAY                      02757000
027580                                 TO PV-BLOCK-NUMBER               02758000
027590                                                                  02759000
027600                 PERFORM 4410-READ-TEMP-STORAGE                   02760000
027610                                                                  02761000
027620                 PERFORM 2151-SET-SELECTED-INDS                   02762000
027630                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        02763000
027640                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL02764000
027650                                                                  02765000
027660                 PERFORM 5100-WRITE-TEMP-STORAGE                  02766000
027670                                                                  02767000
027680                 ADD +1          TO PV-NEXT-BLOCK-IN-ARRAY        02768000
027690                                                                  02769000
027700         END-PERFORM                                              02770000
027710                                                                  02771000
027720         MOVE PV-FIRST-BLOCK-IN-ARRAY                             02772000
027730                                 TO PV-BLOCK-NUMBER               02773000
027740                                                                  02774000
027750         PERFORM 4410-READ-TEMP-STORAGE                           02775000
027760     END-IF.                                                      02776000
027770                                                                  02777000
027780     MOVE ASC-NUMBER-OF-ITEMS-READ                                02778000
027790                                 TO ASC-NUMBER-OF-SELECTED-ITEMS. 02779000
027800                                                                  02780000
027810     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        02781000
027820                                                                  02782000
027830 2151-SET-SELECTED-INDS.                                          02783000
027840                                                                  02784000
027850     IF ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB) NOT = ZERO02785000
027860        IF NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)              02786000
027870            SET ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)             02787000
027880                ASC-TEMP-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        02788000
027890                ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                  02789000
027900                                 TO TRUE                          02790000
027910        END-IF                                                    02791000
027920     END-IF.                                                      02792000
027930                                                                  02793000
027940 2200-MOVE-SCREEN-TO-COMMAREA.                                    02794000
027950                                                                  02795000
027960     MOVE PV-TOP-ITEM            TO PV-ITEM-IN-USE.               02796000
027970     MOVE +1                     TO PV-SUB.                       02797000
027980                                                                  02798000
027990     PERFORM 3100-SET-SUBSCRIPTS.                                 02799000
028000                                                                  02800000
028010     IF ASTRTITL > ZERO                                           02801000
028020         MOVE ASTRTITI           TO ASC-START-ITEM-REQUEST        02802000
028030     ELSE                                                         02803000
028040         IF ASTRTITF = DP015-ERASE-EOF                            02804000
028050             INITIALIZE ASC-START-ITEM-REQUEST                    02805000
028060         END-IF                                                   02806000
028070     END-IF.                                                      02807000
028080                                                                  02808000
028090     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          02809000
028100             VARYING PV-SUB  FROM 1 BY 1                          02810000
028110             UNTIL   PV-SUB > ASC-ITEMS-DISPLAYED.                02811000
028120                                                                  02812000
028130                                                                  02813000
028140 2210-MOVE-LINES-TO-COMMAREA.                                     02814000
028150                                                                  02815000
028160     IF MR-SELECTL (PV-SUB) > ZERO                                02816000
028170         SET ASC-BLOCK-MODIFIED    (ASC-BLK-SUB)                  02817000
028180                                 TO TRUE                          02818000
028190         MOVE MR-SELECTI (PV-SUB)                                 02819000
028200                                 TO ASC-TEMP-SELECTED-SW          02820000
028210                                   (ASC-BLK-SUB ASC-ITEM-SUB)     02821000
028220     ELSE                                                         02822000
028230         IF MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                 02823000
028240             SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                 02824000
028250                                 TO TRUE                          02825000
028260             MOVE SPACE          TO ASC-TEMP-SELECTED-SW          02826000
028270                                   (ASC-BLK-SUB ASC-ITEM-SUB)     02827000
028280         END-IF                                                   02828000
028290     END-IF.                                                      02829000
028300                                                                  02830000
028310     ADD +1                      TO ASC-ITEM-SUB.                 02831000
028320                                                                  02832000
028330     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         02833000
028340         ADD  +1                 TO ASC-BLK-SUB                   02834000
028350         MOVE +1                 TO ASC-ITEM-SUB                  02835000
028360     END-IF.                                                      02836000
028370                                                                  02837000
028380******************************************************************02838000
028390* GET THE KEYS OF THE NEXT SELECTED OBJECT FROM THE              *02839000
028400* INPUT SELECTED-ITEMS TEMP STORAGE QUEUE.                       *02840000
028410******************************************************************02841000
028420 2300-GET-NEXT-RECORD.                                            02842000
028430                                                                  02843000
028440     ADD +1                        TO ASC-SEL-SUB.                02844000
028450                                                                  02845000
028460     IF ASC-SEL-SUB > RC013-MAX-ITEMS                             02846000
028470         ADD +1                    TO ASC-SEL-ITEM                02847000
028480         MOVE +1                   TO ASC-SEL-SUB                 02848000
028490     END-IF.                                                      02849000
028500                                                                  02850000
028510     IF ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                 02851000
028520         PERFORM 9100-READ-SEL-QUEUE                              02852000
028530         IF RC013-ITEM (ASC-SEL-SUB) > ZERO                       02853000
028540             SET RC013-INQ (ASC-SEL-SUB)                          02854000
028550                                   TO TRUE                        02855000
028560             PERFORM 9200-REWRITE-LIST-QUEUE                      02856000
028570         ELSE                                                     02857000
028580             SUBTRACT +1 FROM ASC-SEL-SUB                         02858000
028590*            --- BOTTOM OF LIST ---                               02859000
028600             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            02860000
028610             SET DP020-MSG-INFORMATIONAL                          02861000
028620                                   TO TRUE                        02862000
028630         END-IF                                                   02863000
028640     ELSE                                                         02864000
028650         SUBTRACT +1 FROM ASC-SEL-ITEM                            02865000
028660         MOVE RC013-MAX-ITEMS      TO ASC-SEL-SUB                 02866000
028670         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            02867000
028680         SET DP020-MSG-INFORMATIONAL                              02868000
028690                                   TO TRUE                        02869000
028700     END-IF.                                                      02870000
028710                                                                  02871000
028720******************************************************************02872000
028730* GET THE KEYS OF THE NEXT SELECTED OBJECT FROM THE              *02873000
028740* INPUT SELECTED-ITEMS TEMP STORAGE QUEUE.                       *02874000
028750******************************************************************02875000
028760 2301-GET-NEXT-RECORD-PO-LIST.                                    02876000
028770                                                                  02877000
028780     ADD +1                        TO ASC-SEL-SUB.                02878000
028790                                                                  02879000
028800     IF ASC-SEL-SUB > TR018-MAX-ITEMS                             02880000
028810         ADD +1                    TO ASC-SEL-ITEM                02881000
028820         MOVE +1                   TO ASC-SEL-SUB                 02882000
028830     END-IF.                                                      02883000
028840                                                                  02884000
028850     IF ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                 02885000
028860         PERFORM 9100-READ-SEL-QUEUE                              02886000
028870         IF TR018-ITEM (ASC-SEL-SUB) > ZERO                       02887000
028880             SET TR018-INQ (ASC-SEL-SUB)                          02888000
028890                                   TO TRUE                        02889000
028900         ELSE                                                     02890000
028910             SUBTRACT +1 FROM ASC-SEL-SUB                         02891000
028920*            --- BOTTOM OF LIST ---                               02892000
028930             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            02893000
028940             SET DP020-MSG-INFORMATIONAL                          02894000
028950                                   TO TRUE                        02895000
028960         END-IF                                                   02896000
028970     ELSE                                                         02897000
028980         SUBTRACT +1 FROM ASC-SEL-ITEM                            02898000
028990         MOVE TR018-MAX-ITEMS      TO ASC-SEL-SUB                 02899000
029000         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            02900000
029010         SET DP020-MSG-INFORMATIONAL                              02901000
029020                                   TO TRUE                        02902000
029030     END-IF.                                                      02903000
029040                                                                  02904000
029050******************************************************************02905000
029060* GET THE KEYS OF THE NEXT SELECTED OBJECT FROM THE              *02906000
029070* INPUT SELECTED-ITEMS TEMP STORAGE QUEUE.                       *02907000
029080******************************************************************02908000
029090 2302-GET-NEXT-TRIP-PO-LIST.                                      02909000
029100                                                                  02910000
029110     ADD +1                        TO ASC-SEL-SUB.                02911000
029120                                                                  02912000
029130     IF ASC-SEL-SUB > DS002-MAX-ITEMS                             02913000
029140         ADD +1                    TO ASC-SEL-ITEM                02914000
029150         MOVE +1                   TO ASC-SEL-SUB                 02915000
029160     END-IF.                                                      02916000
029170                                                                  02917000
029180     IF ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                 02918000
029190         PERFORM 9100-READ-SEL-QUEUE                              02919000
029200         IF DS002-ITEM (ASC-SEL-SUB) > ZERO                       02920000
029210             SET DS002-INQ (ASC-SEL-SUB)                          02921000
029220                                   TO TRUE                        02922000
029230             PERFORM 9200-REWRITE-LIST-QUEUE                      02923000
029240         ELSE                                                     02924000
029250             SUBTRACT +1 FROM ASC-SEL-SUB                         02925000
029260*            --- BOTTOM OF LIST ---                               02926000
029270             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            02927000
029280             SET DP020-MSG-INFORMATIONAL                          02928000
029290                                   TO TRUE                        02929000
029300         END-IF                                                   02930000
029310     ELSE                                                         02931000
029320         SUBTRACT +1 FROM ASC-SEL-ITEM                            02932000
029330         MOVE DS002-MAX-ITEMS      TO ASC-SEL-SUB                 02933000
029340         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            02934000
029350         SET DP020-MSG-INFORMATIONAL                              02935000
029360                                   TO TRUE                        02936000
029370     END-IF.                                                      02937000
029380                                                                  02938000
029390*----------------------------------------------------------------*02939000
029400*    CALL TO (AUTOVE) AUTOVERIFICATION MODULE (RCKUT127)          02940000
029410*----------------------------------------------------------------*02941000
029420 2350-CALL-AUTOVE-MODULE.                                         02942000
029430                                                                  02943000
029440     INITIALIZE RC040-FIELDS.                                     02944000
029450     MOVE DK-OPER-UNT-ID       TO RC040-SIGNON-LOCATION.          02945000
029460     MOVE ASC-KEY-PO-NBR-N     TO RC040-PO-NBR                    02946000
029470     MOVE ASC-KEY-REC-SEQ-NBR  TO RC040-PO-RCVR                   02947000
029480     MOVE DP020-USERID         TO RC040-USER-ID.                  02948000
029490     MOVE 'RCKCS213'           TO RC040-CALLING-PROGRAM.          02949000
029500                                                                  02950000
029510     CALL RC040-AUTOVE-CHECK-PGM USING  DFHEIBLK                  02951000
029520                                        RC040-COMMAREA            02952000
029530                                        RC040-FIELDS.             02953000
029540                                                                  02954000
029550     EVALUATE TRUE                                                02955000
029560         WHEN RC040-SUCCESSFUL                                    02956000
029570              CONTINUE                                            02957000
029580         WHEN RC040-DATABASE-BUSY OR                              02958000
029590              RC040-INVALID-SQL                                   02959000
029600                  MOVE PC-TSYMSG-00984  TO DP020-MSG-NUMBER       02960000
029610                  SET DP020-MSG-WARNING TO TRUE                   02961000
029620                  SET DP030-OVERRIDE-GO TO TRUE                   02962000
029630                  SET PS-ERROR          TO TRUE                   02963000
029640         WHEN RC040-NOT-SUCCESSFUL                                02964000
029650                  MOVE PC-TSYMSG-03138  TO DP020-MSG-NUMBER       02965000
029660                  SET DP020-MSG-WARNING TO TRUE                   02966000
029670                  SET DP030-OVERRIDE-GO TO TRUE                   02967000
029680                  SET PS-ERROR          TO TRUE                   02968000
029690         WHEN OTHER                                               02969000
029700             MOVE '2300-CALL-AUTOVE ' TO DP013-PARAGRAPH          02970000
029710             MOVE 'UNSUCCESSFUL CALL TO AUTO VE MOD'              02971000
029720                                         TO DP013-MESSAGE-TEXT (1)02972000
029730             MOVE RC040-SUCCESS-IND      TO DP013-MESSAGE-TEXT (2)02973000
029740             MOVE RC040-SQLCA            TO DP013-SQLCA           02974000
029750             SET DP013-DB2-ABEND                                  02975000
029760                 DP013-XCTL-DISPLAY-RESTART  TO TRUE              02976000
029770             SET PS-ERROR                    TO TRUE              02977000
029780             PERFORM DP013-0000-PROCESS-ABEND                     02978000
029790                                                                  02979000
029800     END-EVALUATE.                                                02980000
029810/                                                                 02981000
029820*----------------------------------------------------------------*02982000
029830*  WMS PROCESS PRIOR TO INACTIVATION.                             02983000
029840*----------------------------------------------------------------*02984000
029850 2400-WMS-PROCESS.                                                02985000
029860                                                                  02986000
029870     SET PS-ASNS-TO-WMS-NO TO TRUE.                               02987000
029880     PERFORM 2460-SELECT-TRECEIV.                                 02988000
029890     PERFORM 2450-CHECK-TKRPRPM.                                  02989000
029900     IF PS-ASNS-TO-WMS-YES                                        02990000
029910        PERFORM 2500-GET-SHIPMENT-INFO                            02991000
029920        PERFORM 2600-SELECT-WST-XREF                              02992000
029930     ELSE                                                         02993000
029940        SET PS-INACTIVATE-YES TO TRUE                             02994000
029950     END-IF.                                                      02995000
029960                                                                  02996000
029970*----------------------------------------------------------------*02997000
029980*  CHECK PARM TABLE TO SEE IF DC IS TURNED ON TO DOWNLOAD ASN'S   02998000
029990*  TO WMS.                                                        02999000
030000*----------------------------------------------------------------*03000000
030010 2450-CHECK-TKRPRPM.                                              03001000
030020                                                                  03002000
030030     EXEC SQL                                                     03003000
030040          SELECT   FUNC_TXT                                       03004000
030050            INTO  :KRPRPM-FUNC-TXT                                03005000
030060            FROM                                                  03006000
030070                  TKRPRPM A                                       03007000
030080            WHERE                                                 03008000
030090                  LOC_ID            = :RECEIV-CURR-OPER-UNT-ID    03009040
030100              AND SYS_PRC_FUNC_CDE  = 'ASNDWN'                    03010000
030110              AND FUNC_PRC_STAT_CDE = 'AC'                        03011000
030120              AND INTFC_SYS_CDE     = 'KHL'                       03012000
030130              AND FUNC_TXT          = 'Y'                         03013000
030140              AND FUNC_BEG_TMST    < CURRENT TIMESTAMP            03014000
030150     END-EXEC.                                                    03015000
030160                                                                  03016000
030170     EVALUATE TRUE                                                03017000
030180         WHEN SQLCODE = ZERO                                      03018000
030190              SET PS-ASNS-TO-WMS-YES    TO TRUE                   03019000
030200         WHEN SQLCODE = +100                                      03020000
030210              SET PS-ASNS-TO-WMS-NO  TO TRUE                      03021000
030220         WHEN SQLWARN0 NOT = SPACES                               03022000
030230         WHEN SQLCODE  NOT = ZERO                                 03023000
030240             MOVE 'TKRPRPM     ' TO DP013-DB2-TABLE-NAME (1)      03024000
030250             SET DP013-DB2-ABEND                                  03025000
030260                                 TO TRUE                          03026000
030270             SET DP013-XCTL-DISPLAY-RESTART                       03027000
030280                                 TO TRUE                          03028000
030290             PERFORM DP013-0000-PROCESS-ABEND                     03029000
030300     END-EVALUATE.                                                03030000
030310                                                                  03031000
030320****************************************************************  03032000
030330*  THIS PARAGRAPH GETS THE CURRENT OPER ID FOR THE PO/RCVR        03033000
030340****************************************************************  03034000
030350 2460-SELECT-TRECEIV.                                             03035000
030360                                                                  03036000
030370     MOVE ASC-KEY-PO-NBR-N         TO RECEIV-ORD-NBR.             03037000
030380* JAK 06/2007 - USE DK-REC-SEQ-NBR, IF ASC-KEY NOT LOADED         03038000
030390     IF ASC-KEY-REC-SEQ-NBR > 0                                   03039000
030400         MOVE ASC-KEY-REC-SEQ-NBR  TO RECEIV-REC-SEQ-NBR          03040000
030410     ELSE                                                         03041000
030420         MOVE DK-REC-SEQ-NBR       TO RECEIV-REC-SEQ-NBR          03042000
030430     END-IF.                                                      03043000
030440                                                                  03044000
030450     EXEC SQL                                                     03045000
030460          SELECT   CURR_OPER_UNT_ID                               03046000
030470            INTO  :RECEIV-CURR-OPER-UNT-ID                        03047000
030480            FROM                                                  03048000
030490                  TRECEIV                                         03049000
030500            WHERE                                                 03050000
030510                  ORD_NBR           = :RECEIV-ORD-NBR             03051000
030520              AND REC_SEQ_NBR       = :RECEIV-REC-SEQ-NBR         03052000
030530              AND VER_STATUS_CDE    = 'A'                         03053000
030540     END-EXEC.                                                    03054000
030550                                                                  03055000
030560     EVALUATE TRUE                                                03056000
030570         WHEN SQLCODE = ZERO                                      03057000
030580         WHEN SQLCODE = -811                                      03058000
030590              CONTINUE                                            03059000
030600         WHEN SQLCODE = +100                                      03060000
030610              MOVE ZERO             TO RECEIV-CURR-OPER-UNT-ID    03061000
030620         WHEN SQLWARN0 NOT = SPACES                               03062000
030630         WHEN SQLCODE  NOT = ZERO                                 03063000
030640             MOVE '2460-SELECT-TRECEIV'                           03064000
030650                                  TO DP013-PARAGRAPH              03065000
030660             MOVE 'UNSUCCESSFUL SELECT ON TRECEIV'                03066000
030670                                  TO DP013-MESSAGE-TEXT (1)       03067000
030680             MOVE SQLCA      TO DP013-SQLCA                       03068000
030690             MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (1)          03069000
030700             SET DP013-DB2-ABEND                                  03070000
030710                 DP013-XCTL-DISPLAY-RESTART                       03071000
030720                                  TO TRUE                         03072000
030730             PERFORM DP013-0000-PROCESS-ABEND                     03073000
030740     END-EVALUATE.                                                03074000
030750                                                                  03075000
030760*----------------------------------------------------------------*03076000
030770*  OBTAIN TRIP ID THAT THE PO/REC IS ATTACHED TO                  03077000
030780*----------------------------------------------------------------*03078000
030790 2500-GET-SHIPMENT-INFO.                                          03079000
030800                                                                  03080000
030810         EXEC SQL                                                 03081000
030820            SELECT  B.SHIPT_ID                                    03082000
030830                   ,B.TRIP_ID                                     03083000
030840              INTO :SHIPMT-SHIPT-ID                               03084000
030850                  ,:SHIPMT-TRIP-ID                                03085000
030860              FROM  TSHPTPO A                                     03086000
030870                   ,TSHIPMT B                                     03087000
030880          WHERE A.PO_NBR      = :DK-PO-NBR                        03088000
030890            AND A.REC_SEQ_NBR = :DK-REC-SEQ-NBR                   03089000
030900            AND A.PRIM_SHIPT_IND = 'Y'                            03090000
030910            AND A.SHIPT_ID = B.SHIPT_ID                           03091000
030920         END-EXEC                                                 03092000
030930                                                                  03093000
030940         EVALUATE TRUE                                            03094000
030950             WHEN SQLCODE = +0                                    03095000
030960                 MOVE SHIPMT-TRIP-ID  TO DK-TRIP-ID               03096000
030970                 MOVE SHIPMT-SHIPT-ID TO DK-SHIPT-ID              03097000
030980             WHEN SQLCODE = +100                                  03098000
030990             WHEN SQLCODE = -811                                  03099000
031000             WHEN SQLCODE = -904                                  03100000
031010             WHEN SQLCODE = -913                                  03101000
031020                 CONTINUE                                         03102000
031030                                                                  03103000
031040             WHEN SQLWARN0 NOT = SPACE                            03104000
031050             WHEN SQLCODE < +0                                    03105000
031060             WHEN SQLCODE > +0                                    03106000
031070                 MOVE '2500-GET-SHIPMENT-INFO'                    03107000
031080                                 TO DP013-PARAGRAPH               03108000
031090                 MOVE 'SELECT SHIPMENT TABLE'                     03109000
031100                                 TO DP013-MESSAGE-TEXT (1)        03110000
031110                 MOVE SQLCA      TO DP013-SQLCA                   03111000
031120                 MOVE 'TSHPTPO'  TO DP013-DB2-TABLE-NAME (1)      03112000
031130                 MOVE 'TSHIPMT'  TO DP013-DB2-TABLE-NAME (2)      03113000
031140                 SET DP013-DB2-ABEND                              03114000
031150                                 TO TRUE                          03115000
031160                 SET DP013-XCTL-DISPLAY-RESTART                   03116000
031170                                 TO TRUE                          03117000
031180                 PERFORM DP013-0000-PROCESS-ABEND                 03118000
031190         END-EVALUATE.                                            03119000
031200                                                                  03120000
031210*----------------------------------------------------------------*03121000
031220*  CHECK WST_SHPMT_XREF_HDR TABLE TO SEE IF RECEIVING HAS BEGUN   03122000
031230*  WHICH WILL STOP THE PACKSLIP FROM BEING INACTIVATED.           03123000
031240*----------------------------------------------------------------*03124000
031250 2600-SELECT-WST-XREF.                                            03125000
031260                                                                  03126000
031270         EXEC SQL                                                 03127000
031280            SELECT  A.RCPT_TMST                                   03128000
031290              INTO :WST00001-RCPT-TMST                            03129000
031300              FROM  WST_SHPMT_XREF_HDR A                          03130000
031310          WHERE A.INTR_TRIP_ID = :DK-TRIP-ID                      03131000
031320            AND A.SOR_CDE      = 'RC'                             03132000
031330            AND A.RCPT_TMST    < :PC-DEFAULT-TMST                 03133000
031340         END-EXEC                                                 03134000
031350                                                                  03135000
031360         EVALUATE TRUE                                            03136000
031370             WHEN SQLCODE = +0                                    03137000
031380             WHEN SQLCODE = -811                                  03138000
031390                 SET PS-INACTIVATE-NO  TO TRUE                    03139000
031400             WHEN SQLCODE = +100                                  03140000
031410                 SET PS-INACTIVATE-YES TO TRUE                    03141000
031420             WHEN SQLCODE = -904                                  03142000
031430             WHEN SQLCODE = -913                                  03143000
031440                 CONTINUE                                         03144000
031450             WHEN SQLWARN0 NOT = SPACE                            03145000
031460             WHEN SQLCODE < +0                                    03146000
031470             WHEN SQLCODE > +0                                    03147000
031480                 MOVE '2600-SELECT-WST-XREF '                     03148000
031490                                 TO DP013-PARAGRAPH               03149000
031500                 MOVE 'SELECT SHIPMENT TABLE'                     03150000
031510                                 TO DP013-MESSAGE-TEXT (1)        03151000
031520                 MOVE SQLCA      TO DP013-SQLCA                   03152000
031530                 MOVE 'WST_SHPMT_XREF' TO DP013-DB2-TABLE-NAME (1)03153000
031540                 SET DP013-DB2-ABEND                              03154000
031550                                 TO TRUE                          03155000
031560                 SET DP013-XCTL-DISPLAY-RESTART                   03156000
031570                                 TO TRUE                          03157000
031580                 PERFORM DP013-0000-PROCESS-ABEND                 03158000
031590         END-EVALUATE.                                            03159000
031600                                                                  03160000
031610*----------------------------------------------------------------*03161000
031620*  SELECT VEH_NBR FROM TVHTRIP. IF VEH_NBR = NULLS THEN RECIEVER  03162000
031630*  IS ATTACHED TO A DUMMY TRIP. IF NOT = NULLS CALL WMS MODULE.   03163000
031640*----------------------------------------------------------------*03164000
031650 2700-SELECT-TVHTRIP.                                             03165000
031660                                                                  03166000
031670     EXEC SQL                                                     03167000
031680          SELECT  VEH_NBR                                         03168000
031690            INTO :VHTRIP-VEH-NBR :DN-VEH-NBR                      03169000
031700          FROM   TVHTRIP                                          03170000
031710          WHERE  TRIP_ID        = :DK-TRIP-ID                     03171000
031720     END-EXEC.                                                    03172000
031730                                                                  03173000
031740     EVALUATE TRUE                                                03174000
031750         WHEN SQLCODE = +0                                        03175000
031760             IF DN-VEH-NBR = -1                                   03176000
031770                SET  PS-VALID-TRIP-NO   TO TRUE                   03177000
031780             ELSE                                                 03178000
031790                SET  PS-VALID-TRIP      TO TRUE                   03179000
031800             END-IF                                               03180000
031810         WHEN SQLCODE = +100                                      03181000
031820                                                                  03182000
031830         WHEN SQLWARN0 NOT = SPACES                               03183000
031840         WHEN SQLCODE < +0                                        03184000
031850         WHEN SQLCODE > +0                                        03185000
031860              MOVE '2700-SELECT-TVHTRIP'                          03186000
031870                              TO DP013-PARAGRAPH                  03187000
031880              MOVE 'UNSUCCESSFUL SELECT ON TVHTRIP'               03188000
031890                              TO DP013-MESSAGE-TEXT (1)           03189000
031900              MOVE DK-TRIP-ID TO DP013-MESSAGE-TEXT (2)           03190000
031910              MOVE SQLCA      TO DP013-SQLCA                      03191000
031920              MOVE 'TVHTRIP ' TO DP013-DB2-TABLE-NAME (1)         03192000
031930              SET DP013-DB2-ABEND                                 03193000
031940                  DP013-XCTL-DISPLAY-RESTART                      03194000
031950                              TO TRUE                             03195000
031960              PERFORM DP013-0000-PROCESS-ABEND                    03196000
031970     END-EVALUATE.                                                03197000
031980                                                                  03198000
031990*JAK 04/2007 ADD PARAGRAPH 2750                                   03199000
032000*JAK 06/2007 REMOVE PARAGRAPH 2750                                03200000
032010*----------------------------------------------------------------*03201000
032020*  SELECT FROM TRECDIS FOR THE PO AND RCVR.  IF NO ROWS FOUND,    03202000
032030*  THERE IS DISTRO TROUBLE AND THE WMS MODULE CANNOT BE CALLED    03203000
032040*----------------------------------------------------------------*03204000
032050*2750-SELECT-TRECDIS.                                             03205000
032060*                                                                 03206000
032070*    EXEC SQL                                                     03207000
032080*         SELECT  ORD_NBR                                         03208000
032090*           INTO :RECDIS-ORD-NBR                                  03209000
032100*         FROM   TRECDIS                                          03210000
032110*         WHERE  ORD_NBR        = :DK-PO-NBR                      03211000
032120*         AND    REC_SEQ_NBR    = :DK-REC-SEQ-NBR                 03212000
032130*    END-EXEC.                                                    03213000
032140*                                                                 03214000
032150*    EVALUATE TRUE                                                03215000
032160*        WHEN SQLCODE = +0                                        03216000
032170*        WHEN SQLCODE = -811                                      03217000
032180*            SET  PS-DISTRO-TROUBLE-NO   TO TRUE                  03218000
032190*        WHEN SQLCODE = +100                                      03219000
032200*            SET  PS-DISTRO-TROUBLE-YES  TO TRUE                  03220000
032210*                                                                 03221000
032220*        WHEN SQLWARN0 NOT = SPACES                               03222000
032230*        WHEN SQLCODE < +0                                        03223000
032240*        WHEN SQLCODE > +0                                        03224000
032250*             MOVE '2750-SELECT-TRECDIS'                          03225000
032260*                                 TO DP013-PARAGRAPH              03226000
032270*             MOVE 'UNSUCCESSFUL SELECT ON TRECDIS'               03227000
032280*                                 TO DP013-MESSAGE-TEXT (1)       03228000
032290*             MOVE DK-PO-NBR      TO  PV-DISPLAY-PO               03229000
032300*             MOVE PV-DISPLAY-PO  TO DP013-MESSAGE-TEXT (2)       03230000
032310*             MOVE SQLCA          TO DP013-SQLCA                  03231000
032320*             MOVE 'TRECDIS '     TO DP013-DB2-TABLE-NAME (1)     03232000
032330*             SET DP013-DB2-ABEND                                 03233000
032340*                 DP013-XCTL-DISPLAY-RESTART                      03234000
032350*                             TO TRUE                             03235000
032360*             PERFORM DP013-0000-PROCESS-ABEND                    03236000
032370*    END-EVALUATE.                                                03237000
032380                                                                  03238000
032390*----------------------------------------------------------------*03239000
032400* CALL TO WMS VENDOR SHIPMENT CONTROL MODULE (WSKCS305) USING     03240000
032410*  COPYBOOK WSWS001.                                              03241000
032420*----------------------------------------------------------------*03242000
032430 2800-CALL-WMS-MODULE.                                            03243000
032440                                                                  03244000
032450     MOVE SHIPMT-TRIP-ID       TO WS001-TRIP-ID.                  03245000
032460     MOVE SHIPMT-SHIPT-ID      TO WS001-KOHLS-SHIPT-ID.           03246000
032470     MOVE DK-OPER-UNT-ID       TO WS001-OPER-UNT-ID.              03247000
032480     MOVE DP020-USERID         TO WS001-USER-ID.                  03248000
032490     MOVE DP020-SRC-TASK-NUMBER TO WS001-SRC-TASK-NUMBER.         03249000
032500     MOVE ASC-KEY-PO-NBR-N     TO WS001-PO-NBR.                   03250000
032510     MOVE DK-REC-SEQ-NBR       TO WS001-RCVR-NBR.                 03251000
032520* JAK 09/2007 - ADD SWITCH TO INDICATE IF LINE NBR IS LOADED      03252000
032530**** MOVE ZEROS                TO WS001-PO-LNE-NBR.               03253000
032540     IF PS-LOAD-LNE-NBR-YES                                       03254000
032550         MOVE RECITM-ORD-LNE-NBR   TO WS001-PO-LNE-NBR            03255000
032560     ELSE                                                         03256000
032570         MOVE ZEROS                TO WS001-PO-LNE-NBR            03257000
032580     END-IF                                                       03258000
032590     MOVE ZEROS                TO WS001-PREPK-ID.                 03259000
032600     MOVE ZEROS                TO WS001-SKU-NBR.                  03260000
032610     MOVE ZEROS                TO WS001-DTL-ASN-LEVEL-IND.        03261000
032620     MOVE 'RCKCS213'           TO WS001-CALLING-PROGRAM-NAME.     03262000
032630                                                                  03263000
032640                                                                  03264000
032650     MOVE LENGTH OF WS001-FIELDS  TO  PV-COMMAREA-LENGTH.         03265000
032660                                                                  03266000
032670     EXEC CICS                                                    03267000
032680         LINK PROGRAM  (PC-WMS-CONTROL-MOD)                       03268000
032690              COMMAREA (WS001-FIELDS)                             03269000
032700              LENGTH   (PV-COMMAREA-LENGTH)                       03270000
032710     END-EXEC.                                                    03271000
032720     EVALUATE TRUE                                                03272000
032730         WHEN WS001-SUCCESSFUL                                    03273000
032740              CONTINUE                                            03274000
032750         WHEN WS001-DATABASE-BUSY OR                              03275000
032760              WS001-INVALID-SQL                                   03276000
032770                  MOVE PC-TSYMSG-03546  TO DP020-MSG-NUMBER       03277000
032780                  SET DP020-MSG-WARNING TO TRUE                   03278000
032790                  SET DP030-OVERRIDE-GO TO TRUE                   03279000
032800                  SET PS-ERROR          TO TRUE                   03280000
032810                                                                  03281000
032820                                                                  03282000
032830              INITIALIZE PV-CICS-MSG-AREA                         03283000
032840              STRING 'RCKCS213-'                                  03284000
032850                     '2800-CALL-WMS-MODULE - '                    03285000
032860                                           DELIMITED BY SIZE      03286000
032870                                      INTO PV-CICS-MSG-AREA       03287000
032880              PERFORM 9903-WRITE-CICS-LOG                         03288000
032890                                                                  03289000
032900              INITIALIZE PV-CICS-MSG-AREA                         03290000
032910              STRING 'RCKCS213-'                                  03291000
032920                     WS001-CRA-RET-MSG                            03292000
032930                                           DELIMITED BY SIZE      03293000
032940                                      INTO PV-CICS-MSG-AREA       03294000
032950              PERFORM 9903-WRITE-CICS-LOG                         03295000
032960                                                                  03296000
032970                                                                  03297000
032980         WHEN WS001-ERROR                                         03298000
032990                  MOVE PC-TSYMSG-03138  TO DP020-MSG-NUMBER       03299000
033000                  SET DP020-MSG-WARNING TO TRUE                   03300000
033010                  SET DP030-OVERRIDE-GO TO TRUE                   03301000
033020                  SET PS-ERROR          TO TRUE                   03302000
033030                                                                  03303000
033040              INITIALIZE PV-CICS-MSG-AREA                         03304000
033050              STRING 'RCKCS213-'                                  03305000
033060                     '2800-CALL-WMS-MODULE - '                    03306000
033070                                           DELIMITED BY SIZE      03307000
033080                                      INTO PV-CICS-MSG-AREA       03308000
033090              PERFORM 9903-WRITE-CICS-LOG                         03309000
033100                                                                  03310000
033110              INITIALIZE PV-CICS-MSG-AREA                         03311000
033120              STRING 'RCKCS213-'                                  03312000
033130                     WS001-CRA-RET-MSG                            03313000
033140                                           DELIMITED BY SIZE      03314000
033150                                      INTO PV-CICS-MSG-AREA       03315000
033160              PERFORM 9903-WRITE-CICS-LOG                         03316000
033170                                                                  03317000
033180         WHEN OTHER                                               03318000
033190                                                                  03319000
033200              INITIALIZE PV-CICS-MSG-AREA                         03320000
033210              STRING 'RCKCS213-'                                  03321000
033220                     '2800-CALL-WMS-MODULE - '                    03322000
033230                                           DELIMITED BY SIZE      03323000
033240                                      INTO PV-CICS-MSG-AREA       03324000
033250              PERFORM 9903-WRITE-CICS-LOG                         03325000
033260                                                                  03326000
033270              INITIALIZE PV-CICS-MSG-AREA                         03327000
033280              STRING 'RCKCS213-'                                  03328000
033290                     WS001-CRA-RET-MSG                            03329000
033300                                           DELIMITED BY SIZE      03330000
033310                                      INTO PV-CICS-MSG-AREA       03331000
033320              PERFORM 9903-WRITE-CICS-LOG                         03332000
033330                                                                  03333000
033340             MOVE '2800-CALL-WMS-MODULE' TO DP013-PARAGRAPH       03334000
033350             MOVE 'UNSUCCESSFUL CALL TO WMS  MOD'                 03335000
033360                                         TO DP013-MESSAGE-TEXT (1)03336000
033370             MOVE WS001-SUCCESS-IND      TO DP013-MESSAGE-TEXT (2)03337000
033380*            MOVE WS001-SQLCA            TO DP013-SQLCA           03338000
033390             SET DP013-DB2-ABEND                                  03339000
033400                 DP013-XCTL-DISPLAY-RESTART  TO TRUE              03340000
033410             SET PS-ERROR                    TO TRUE              03341000
033420             PERFORM DP013-0000-PROCESS-ABEND                     03342000
033430                                                                  03343000
033440     END-EVALUATE.                                                03344000
033450/                                                                 03345000
033460*----------------------------------------------------------------*03346000
033470 3000-EDIT-DATA-IN-COMMAREA.                                      03347000
033480                                                                  03348000
033490     SET PS-NO-ERROR             TO TRUE.                         03349000
033500                                                                  03350000
033510     PERFORM 3200-RESET-ATTRIBUTES.                               03351000
033520                                                                  03352000
033530     MOVE ASC-ITEMS-DISPLAYED    TO PV-SUB.                       03353000
033540     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       03354000
033550                                          ASC-ITEMS-DISPLAYED - 1.03355000
033560     PERFORM 3100-SET-SUBSCRIPTS.                                 03356000
033570                                                                  03357000
033580     PERFORM 3300-EDIT-SELECTIONS                                 03358000
033590             VARYING PV-SUB  FROM PV-SUB BY -1                    03359000
033600             UNTIL   PV-SUB < +1.                                 03360000
033610                                                                  03361000
033620     IF PS-NO-ERROR                                               03362000
033630         PERFORM 3400-CHECK-RANGE-SEQUENCE                        03363000
033640     END-IF.                                                      03364000
033650                                                                  03365000
033660     IF PS-NO-ERROR AND                                           03366000
033670        ASC-START-OF-SELECTED-RANGE > ZERO AND                    03367000
033680        ASC-END-OF-SELECTED-RANGE > ZERO                          03368000
033690                                                                  03369000
033700         PERFORM 3500-MARK-RANGE-AS-SELECTED                      03370000
033710     END-IF.                                                      03371000
033720                                                                  03372000
033730                                                                  03373000
033740 3100-SET-SUBSCRIPTS.                                             03374000
033750                                                                  03375000
033760     COMPUTE ASC-ITEM-SUB =                                       03376000
033770                (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER (1 1)) + 1.03377000
033780                                                                  03378000
033790     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         03379000
033800         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            03380000
033810         MOVE PC-MAX-BLOCKS-IN-ARRAY                              03381000
033820                                 TO ASC-BLK-SUB                   03382000
033830     ELSE                                                         03383000
033840         MOVE +1                 TO ASC-BLK-SUB                   03384000
033850     END-IF.                                                      03385000
033860                                                                  03386000
033870 3200-RESET-ATTRIBUTES.                                           03387000
033880                                                                  03388000
033890     MOVE DP015-UNP-ALP-NOR-OFF  TO ASTRTITA.                     03389000
033900     MOVE DP015-GREEN            TO ASTRTITC.                     03390000
033910     MOVE DP015-UNDERLINE        TO ASTRTITH.                     03391000
033920                                                                  03392000
033930         PERFORM VARYING PV-SUB  FROM 1 BY 1                      03393000
033940                 UNTIL   PV-SUB > PC-ITEMS-PER-PANEL              03394000
033950                 MOVE DP015-UNP-ALP-NOR-OFF                       03395000
033960                                 TO MR-SELECTA (PV-SUB)           03396000
033970                 MOVE DP015-GREEN                                 03397000
033980                                 TO MR-SELECTC (PV-SUB)           03398000
033990                 MOVE DP015-UNDERLINE                             03399000
034000                                 TO MR-SELECTH (PV-SUB)           03400000
034010         END-PERFORM.                                             03401000
034020                                                                  03402000
034030 3300-EDIT-SELECTIONS.                                            03403000
034040                                                                  03404000
034050     EVALUATE TRUE                                                03405000
034060         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) =   03406000
034070                   ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     03407000
034080              CONTINUE                                            03408000
034090                                                                  03409000
034100         WHEN ASC-TEMP-SELECT   (ASC-BLK-SUB ASC-ITEM-SUB)        03410000
034110              IF NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        03411000
034120                  ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS  03412000
034130                  ADD ASC-CARTON-COUNT (ASC-BLK-SUB ASC-ITEM-SUB) 03413000
034140                                 TO  ASC-SELECTED-CARTON-COUNT    03414000
034150                  MOVE ASC-TEMP-SELECTED-SW                       03415000
034160                                        (ASC-BLK-SUB ASC-ITEM-SUB)03416000
034170                                 TO ASC-SELECTED-SW               03417000
034180                                        (ASC-BLK-SUB ASC-ITEM-SUB)03418000
034190              END-IF                                              03419000
034200                                                                  03420000
034210         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) =   03421000
034220                                                             SPACE03422000
034230              EVALUATE TRUE                                       03423000
034240                  WHEN ASC-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)     03424000
034250                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS03425000
034260                     SUBTRACT ASC-CARTON-COUNT                    03426000
034270                                (ASC-BLK-SUB ASC-ITEM-SUB)        03427000
034280                         FROM ASC-SELECTED-CARTON-COUNT           03428000
034290                     MOVE SPACE  TO ASC-SELECTED-SW               03429000
034300                                   (ASC-BLK-SUB ASC-ITEM-SUB)     03430000
034310                                    ASC-ACTION                    03431000
034320                                   (ASC-BLK-SUB ASC-ITEM-SUB)     03432000
034330                                                                  03433000
034340                  WHEN ASC-BEGIN   (ASC-BLK-SUB ASC-ITEM-SUB)     03434000
034350                       MOVE ZERO TO ASC-START-OF-SELECTED-RANGE   03435000
034360                       MOVE SPACE                                 03436000
034370                                 TO ASC-SELECTED-SW               03437000
034380                                   (ASC-BLK-SUB ASC-ITEM-SUB)     03438000
034390                                                                  03439000
034400                  WHEN ASC-END     (ASC-BLK-SUB ASC-ITEM-SUB)     03440000
034410                       MOVE ZERO TO ASC-END-OF-SELECTED-RANGE     03441000
034420                       MOVE SPACE                                 03442000
034430                                 TO ASC-SELECTED-SW               03443000
034440                                   (ASC-BLK-SUB ASC-ITEM-SUB)     03444000
034450             END-EVALUATE                                         03445000
034460                                                                  03446000
034470         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           03447000
034480              IF ASC-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)           03448000
034490                  SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS   03449000
034500                  SUBTRACT ASC-CARTON-COUNT                       03450000
034510                             (ASC-BLK-SUB ASC-ITEM-SUB)           03451000
034520                      FROM ASC-SELECTED-CARTON-COUNT              03452000
034530              END-IF                                              03453000
034540                                                                  03454000
034550              PERFORM 3310-EDIT-RANGE                             03455000
034560                                                                  03456000
034570         WHEN ASC-TEMP-END  (ASC-BLK-SUB ASC-ITEM-SUB)            03457000
034580              IF ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            03458000
034590                  SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS   03459000
034600                  SUBTRACT ASC-CARTON-COUNT                       03460000
034610                             (ASC-BLK-SUB ASC-ITEM-SUB)           03461000
034620                      FROM ASC-SELECTED-CARTON-COUNT              03462000
034630              END-IF                                              03463000
034640                                                                  03464000
034650              PERFORM 3310-EDIT-RANGE                             03465000
034660                                                                  03466000
034670         WHEN OTHER                                               03467000
034680              MOVE PC-TSYMSG-00005                                03468000
034690                                 TO DP020-MSG-NUMBER              03469000
034700              SET PS-ERROR                                        03470000
034710                  DP020-MSG-FATAL                                 03471000
034720                  DP030-SET-CURSOR-APPL-1                         03472000
034730                                 TO TRUE                          03473000
034740              MOVE -1            TO MR-SELECTL (PV-SUB)           03474000
034750              MOVE DP015-RED     TO MR-SELECTC (PV-SUB)           03475000
034760              MOVE DP015-REVERSE TO MR-SELECTH (PV-SUB)           03476000
034770              IF ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            03477000
034780                  SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    03478000
034790                  SUBTRACT ASC-CARTON-COUNT                       03479000
034800                             (ASC-BLK-SUB ASC-ITEM-SUB)           03480000
034810                      FROM ASC-SELECTED-CARTON-COUNT              03481000
034820                  MOVE SPACE     TO ASC-SELECTED-SW               03482000
034830                                   (ASC-BLK-SUB ASC-ITEM-SUB)     03483000
034840              END-IF                                              03484000
034850     END-EVALUATE.                                                03485000
034860                                                                  03486000
034870     IF ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)                     03487000
034880         IF ASC-PKSL-STAT-CDE (ASC-BLK-SUB ASC-ITEM-SUB) =        03488000
034890            'AC' OR 'IN'                                          03489000
034900             CONTINUE                                             03490000
034910         ELSE                                                     03491000
034920             MOVE PC-TSYMSG-00724                                 03492000
034930                                 TO DP020-MSG-NUMBER              03493000
034940             SET PS-ERROR                                         03494000
034950                 DP020-MSG-FATAL                                  03495000
034960                 DP030-SET-CURSOR-APPL-1                          03496000
034970                                 TO TRUE                          03497000
034980             MOVE -1             TO MR-SELECTL (PV-SUB)           03498000
034990             MOVE DP015-RED      TO MR-SELECTC (PV-SUB)           03499000
035000             MOVE DP015-REVERSE  TO MR-SELECTH (PV-SUB)           03500000
035010             SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS         03501000
035020             SUBTRACT ASC-CARTON-COUNT (ASC-BLK-SUB ASC-ITEM-SUB) 03502000
035030                      FROM ASC-SELECTED-CARTON-COUNT              03503000
035040             MOVE SPACE          TO MR-SELECTI (PV-SUB)           03504000
035050     END-IF.                                                      03505000
035060                                                                  03506000
035070     SUBTRACT +1 FROM PV-ITEM-IN-USE                              03507000
035080                      ASC-ITEM-SUB.                               03508000
035090     IF ASC-ITEM-SUB < 1                                          03509000
035100         SUBTRACT +1 FROM ASC-BLK-SUB                             03510000
035110         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB.                 03511000
035120                                                                  03512000
035130 3310-EDIT-RANGE.                                                 03513000
035140                                                                  03514000
035150     IF ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                 03515000
035160        IF ASC-START-OF-SELECTED-RANGE = ZERO                     03516000
035170            MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)  03517000
035180                   TO ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)  03518000
035190            MOVE PV-ITEM-IN-USE  TO ASC-START-OF-SELECTED-RANGE   03519000
035200        ELSE                                                      03520000
035210            IF ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE       03521000
035220                CONTINUE                                          03522000
035230            ELSE                                                  03523000
035240                MOVE PC-TSYMSG-00054                              03524000
035250                                 TO DP020-MSG-NUMBER              03525000
035260                SET DP020-MSG-FATAL                               03526000
035270                    PS-ERROR                                      03527000
035280                    DP030-SET-CURSOR-APPL-1                       03528000
035290                                 TO TRUE                          03529000
035300                MOVE -1          TO MR-SELECTL (PV-SUB)           03530000
035310                MOVE DP015-RED   TO MR-SELECTC (PV-SUB)           03531000
035320                MOVE DP015-UNDERLINE                              03532000
035330                                 TO MR-SELECTH (PV-SUB)           03533000
035340            END-IF                                                03534000
035350        END-IF                                                    03535000
035360     ELSE                                                         03536000
035370         IF ASC-END-OF-SELECTED-RANGE = ZERO                      03537000
035380             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 03538000
035390                    TO ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 03539000
035400             MOVE PV-ITEM-IN-USE TO ASC-END-OF-SELECTED-RANGE     03540000
035410         ELSE                                                     03541000
035420             IF ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE        03542000
035430                 CONTINUE                                         03543000
035440             ELSE                                                 03544000
035450                MOVE PC-TSYMSG-00055                              03545000
035460                                 TO DP020-MSG-NUMBER              03546000
035470                SET DP020-MSG-FATAL                               03547000
035480                    PS-ERROR                                      03548000
035490                    DP030-SET-CURSOR-APPL-1                       03549000
035500                                 TO TRUE                          03550000
035510                MOVE -1          TO MR-SELECTL (PV-SUB)           03551000
035520             END-IF                                               03552000
035530         END-IF                                                   03553000
035540     END-IF.                                                      03554000
035550                                                                  03555000
035560 3400-CHECK-RANGE-SEQUENCE.                                       03556000
035570                                                                  03557000
035580     IF ASC-START-OF-SELECTED-RANGE > ZERO AND                    03558000
035590        ASC-END-OF-SELECTED-RANGE   > ZERO AND                    03559000
035600        ASC-START-OF-SELECTED-RANGE > ASC-END-OF-SELECTED-RANGE   03560000
035610         MOVE PC-TSYMSG-00052    TO DP020-MSG-NUMBER              03561000
035620         SET PS-ERROR                                             03562000
035630             DP020-MSG-FATAL     TO TRUE                          03563000
035640                                                                  03564000
035650         PERFORM 3410-POSITION-AT-ERROR.                          03565000
035660                                                                  03566000
035670 3410-POSITION-AT-ERROR.                                          03567000
035680                                                                  03568000
035690     SET DP030-SET-CURSOR-APPL-1 TO TRUE.                         03569000
035700     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE -               03570000
035710                                                  PV-TOP-ITEM + 1.03571000
035720     IF PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                       03572000
035730         CONTINUE                                                 03573000
035740     ELSE                                                         03574000
035750         MOVE -1                 TO MR-SELECTL (PV-SUB)           03575000
035760         MOVE DP015-RED          TO MR-SELECTC (PV-SUB)           03576000
035770         MOVE DP015-REVERSE      TO MR-SELECTH (PV-SUB)           03577000
035780     END-IF.                                                      03578000
035790                                                                  03579000
035800     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE - PV-TOP-ITEM + 1.03580000
035810     IF PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                       03581000
035820         CONTINUE                                                 03582000
035830     ELSE                                                         03583000
035840         MOVE -1                 TO MR-SELECTL (PV-SUB)           03584000
035850         MOVE DP015-RED          TO MR-SELECTC (PV-SUB)           03585000
035860         MOVE DP015-REVERSE      TO MR-SELECTH (PV-SUB)           03586000
035870     END-IF.                                                      03587000
035880                                                                  03588000
035890 3500-MARK-RANGE-AS-SELECTED.                                     03589000
035900                                                                  03590000
035910     MOVE +1                     TO ASC-BLK-SUB.                  03591000
035920                                                                  03592000
035930     PERFORM 3510-MARK-SELECTED-INDS                              03593000
035940             VARYING ASC-ITEM-SUB  FROM 1 BY 1                    03594000
035950             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           03595000
035960                                                                  03596000
035970     ADD +1                      TO ASC-BLK-SUB.                  03597000
035980                                                                  03598000
035990     PERFORM 3510-MARK-SELECTED-INDS                              03599000
036000             VARYING ASC-ITEM-SUB  FROM 1 BY 1                    03600000
036010             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           03601000
036020                                                                  03602000
036030     MOVE ASC-LIST-ITEM-NUMBER (1 1)                              03603000
036040                                 TO PV-LIST-ITEM-NUMBER.          03604000
036050     COMPUTE PV-FIRST-BLOCK-IN-ARRAY = 1 +                        03605000
036060                 ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).03606000
036070     MOVE ASC-START-OF-SELECTED-RANGE                             03607000
036080                                 TO PV-START-OF-SELECTED-RANGE.   03608000
036090     COMPUTE PV-FIRST-BLOCK-IN-RANGE = 1 +                        03609000
036100             ((PV-START-OF-SELECTED-RANGE - 1) /                  03610000
036110                                              PC-ITEMS-PER-PANEL).03611000
036120     MOVE ASC-END-OF-SELECTED-RANGE                               03612000
036130                                 TO PV-END-OF-SELECTED-RANGE.     03613000
036140     COMPUTE PV-LAST-BLOCK-IN-RANGE = 1 +                         03614000
036150             ((PV-END-OF-SELECTED-RANGE - 1) /                    03615000
036160                                              PC-ITEMS-PER-PANEL).03616000
036170     COMPUTE PV-NEXT-BLOCK-IN-ARRAY = PV-FIRST-BLOCK-IN-ARRAY + 1.03617000
036180                                                                  03618000
036190     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    03619000
036200        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        03620000
036210         MOVE +1                 TO ASC-BLK-SUB                   03621000
036220                                                                  03622000
036230         PERFORM 5100-WRITE-TEMP-STORAGE                          03623000
036240                                                                  03624000
036250         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         03625000
036260                                       PV-FIRST-BLOCK-IN-ARRAY - 103626000
036270                                                                  03627000
036280         PERFORM                                                  03628000
036290           UNTIL PV-FIRST-BLOCK-IN-RANGE > PV-PREV-BLOCK-IN-ARRAY 03629000
036300                 MOVE PV-FIRST-BLOCK-IN-RANGE TO PV-BLOCK-NUMBER  03630000
036310                                                                  03631000
036320                 PERFORM 4410-READ-TEMP-STORAGE                   03632000
036330                                                                  03633000
036340                 PERFORM 3510-MARK-SELECTED-INDS                  03634000
036350                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        03635000
036360                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL03636000
036370                                                                  03637000
036380                 PERFORM 5100-WRITE-TEMP-STORAGE                  03638000
036390                                                                  03639000
036400                 ADD +1          TO PV-FIRST-BLOCK-IN-RANGE       03640000
036410         END-PERFORM                                              03641000
036420                                                                  03642000
036430         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         03643000
036440                  PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY03644000
036450         PERFORM                                                  03645000
036460           UNTIL PV-NEXT-BLOCK-IN-ARRAY > PV-LAST-BLOCK-IN-RANGE  03646000
036470                 MOVE PV-NEXT-BLOCK-IN-ARRAY                      03647000
036480                                 TO PV-BLOCK-NUMBER               03648000
036490                                                                  03649000
036500                 PERFORM 4410-READ-TEMP-STORAGE                   03650000
036510                                                                  03651000
036520                 PERFORM 3510-MARK-SELECTED-INDS                  03652000
036530                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        03653000
036540                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL03654000
036550                                                                  03655000
036560                 PERFORM 5100-WRITE-TEMP-STORAGE                  03656000
036570                                                                  03657000
036580                 ADD +1          TO PV-NEXT-BLOCK-IN-ARRAY        03658000
036590         END-PERFORM                                              03659000
036600                                                                  03660000
036610         MOVE PV-FIRST-BLOCK-IN-ARRAY                             03661000
036620                                 TO PV-BLOCK-NUMBER               03662000
036630                                                                  03663000
036640         PERFORM 4410-READ-TEMP-STORAGE                           03664000
036650                                                                  03665000
036660     END-IF.                                                      03666000
036670                                                                  03667000
036680     MOVE ZERO                   TO ASC-START-OF-SELECTED-RANGE   03668000
036690                                    ASC-END-OF-SELECTED-RANGE.    03669000
036700                                                                  03670000
036710 3510-MARK-SELECTED-INDS.                                         03671000
036720                                                                  03672000
036730     IF ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB) NOT <     03673000
036740                                       ASC-START-OF-SELECTED-RANGE03674000
036750        IF ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB) NOT >  03675000
036760                                         ASC-END-OF-SELECTED-RANGE03676000
036770           IF NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)           03677000
036780               SET ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)          03678000
036790                   ASC-BLOCK-MODIFIED (ASC-BLK-SUB)               03679000
036800                   ASC-TEMP-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)     03680000
036810                                 TO TRUE                          03681000
036820               ADD +1            TO ASC-NUMBER-OF-SELECTED-ITEMS  03682000
036830               ADD  ASC-CARTON-COUNT (ASC-BLK-SUB ASC-ITEM-SUB)   03683000
036840                                 TO ASC-SELECTED-CARTON-COUNT     03684000
036850           END-IF                                                 03685000
036860        END-IF                                                    03686000
036870     END-IF.                                                      03687000
036880                                                                  03688000
036890 4000-BUILD-INITIAL-PANEL.                                        03689000
036900                                                                  03690000
036910     MOVE '4000-BUILD-INITIAL-PANEL' TO PV-LAST-PARAGRAPH         03691000
036920     INITIALIZE ASC-BLOCK-ENTRIES (1)                             03692000
036930                ASC-BLOCK-ENTRIES (2).                            03693000
036940     MOVE ZERO                   TO ASC-CARTON-TOTAL              03694000
036950                                    ASC-UNIT-TOTAL.               03695000
036960     MOVE +1                     TO ASC-BLK-SUB.                  03696000
036970     SET ASC-MORE-PACK-SLIPS                                      03697000
036980         ASC-TRNSCRP-NOT-PENDING                                  03698000
036990         ASC-INACTIVATE-NOT-PENDING                               03699000
037000                                 TO TRUE.                         03700000
037010                                                                  03701000
037020     MOVE ZERO                   TO ASC-ITEM-SUB                  03702000
037030                                    ASC-NUMBER-OF-ITEMS-READ      03703000
037040                                    ASC-NUMBER-OF-SELECTED-ITEMS  03704000
037050                                    ASC-SELECTED-CARTON-COUNT     03705000
037060                                    ASC-HIGHEST-BLOCK-WRITTEN     03706000
037070                                    ASC-START-OF-SELECTED-RANGE   03707000
037080                                    ASC-END-OF-SELECTED-RANGE     03708000
037090                                    ASC-ITEM-AT-TOP-OF-PANEL.     03709000
037100                                                                  03710000
037110     SET PS-INITIAL-PANEL        TO TRUE                          03711000
037120     PERFORM 4010-FORMAT-KEYS.                                    03712000
037130     PERFORM 4020-GET-VENDOR-NAME.                                03713000
037140                                                                  03714000
037150     PERFORM 5090-CHECK-SPECIAL-INSTR.                            03715000
037160     IF PV-DB2-COUNT > ZERO                                       03716000
037170        MOVE 'SPECIAL INSTRUCTIONS EXIST'                         03717000
037180                                 TO ASC-SPEC-INSTR                03718000
037190     ELSE                                                         03719000
037200        MOVE SPACES              TO ASC-SPEC-INSTR                03720000
037210     END-IF.                                                      03721000
037220                                                                  03722000
037230     MOVE ASC-KEY-REC-SEQ-NBR    TO  PV-FIRST-REC-SEQ-NBR         03723000
037240                                     DK-REC-SEQ-NBR.              03724000
037250                                                                  03725000
037260     IF DK-REC-SEQ-NBR > ZERO                                     03726000
037270         PERFORM 7500-GET-PACK-BY-STR-IND                         03727000
037280         PERFORM 7510-CHECK-FOR-DC                                03728000
037290         PERFORM 5050-CHECK-FOR-VERIFIED                          03729000
037300         IF RECEIV-STATUS-CDE EQUAL 'VE'                          03730000
037310             SET ASC-READ-ONLY       TO  TRUE                     03731000
037320         ELSE                                                     03732000
037330             PERFORM 5075-COUNT-TRECITMS                          03733000
037340             IF PV-DB2-COUNT GREATER THAN ZERO                    03734000
037350                 SET ASC-READ-ONLY   TO  TRUE                     03735000
037360             ELSE                                                 03736000
037370                 SET ASC-UPDATES-ALLOWED TO  TRUE                 03737000
037380             END-IF                                               03738000
037390         END-IF                                                   03739000
037400     END-IF                                                       03740000
037410                                                                  03741000
037420     PERFORM 2350-CALL-AUTOVE-MODULE                              03742000
037430     IF RC040-AUTO-VE-YES                                         03743000
037440        SET ASC-AUTO-VE            TO TRUE                        03744000
037450     END-IF                                                       03745000
037460                                                                  03746000
037470     PERFORM 4030-OPEN-CURSOR.                                    03747000
037480                                                                  03748000
037490     PERFORM 4040-GET-PACK-SLIPS.                                 03749000
037500                                                                  03750000
037510     PERFORM 4050-CLOSE-CURSOR.                                   03751000
037520                                                                  03752000
037530     MOVE +1                     TO PV-TOP-ITEM.                  03753000
037540                                                                  03754000
037550     MOVE -1                     TO MR-SELECTL (1).               03755000
037560     SET DP030-SET-CURSOR-APPL-1 TO TRUE.                         03756000
037570                                                                  03757000
037580     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        03758000
037590                                                                  03759000
037600 4010-FORMAT-KEYS.                                                03760000
037610                                                                  03761000
037620     MOVE ASC-KEY-PO-NBR-N       TO DK-PO-NBR.                    03762000
037630                                                                  03763000
037640     IF ASC-KEY-OPER-UNT-ID > ZERO                                03764000
037650         MOVE ASC-KEY-OPER-UNT-ID                                 03765000
037660                                 TO DK-OPER-UNT-ID-B              03766000
037670                                    DK-OPER-UNT-ID-E              03767000
037680                                    DK-OPER-UNT-ID                03768000
037690         SET PS-SINGLE-OPER-UNT-ID TO TRUE                        03769000
037700     ELSE                                                         03770000
037710         SET PS-MULT-OPER-UNT-ID TO TRUE                          03771000
037720     END-IF.                                                      03772000
037730                                                                  03773000
037740     IF ASC-KEY-FCLTY-ID > ZERO                                   03774000
037750         MOVE ASC-KEY-FCLTY-ID   TO DK-FCLTY-ID-B                 03775000
037760                                    DK-FCLTY-ID-E                 03776000
037770                                    DK-FCLTY-ID                   03777000
037780     END-IF.                                                      03778000
037790                                                                  03779000
037800     IF ASC-KEY-AC-STAT > SPACES                                  03780000
037810         MOVE ASC-KEY-AC-STAT    TO DK-AC-STAT                    03781000
037820     END-IF.                                                      03782000
037830                                                                  03783000
037840     IF ASC-KEY-IN-STAT > SPACES                                  03784000
037850         MOVE ASC-KEY-IN-STAT    TO DK-IN-STAT                    03785000
037860     END-IF.                                                      03786000
037870                                                                  03787000
037880     IF ASC-KEY-IP-STAT > SPACES                                  03788000
037890         MOVE ASC-KEY-IP-STAT    TO DK-IP-STAT                    03789000
037900     END-IF.                                                      03790000
037910                                                                  03791000
037920     IF ASC-KEY-CM-STAT > SPACES                                  03792000
037930         MOVE ASC-KEY-CM-STAT    TO DK-CM-STAT                    03793000
037940     END-IF.                                                      03794000
037950                                                                  03795000
037960     IF ASC-KEY-VE-STAT > SPACES                                  03796000
037970         MOVE ASC-KEY-VE-STAT    TO DK-VE-STAT                    03797000
037980     END-IF.                                                      03798000
037990                                                                  03799000
038000     IF ASC-KEY-REC-SEQ-NBR > ZEROES                              03800000
038010         MOVE ASC-KEY-REC-SEQ-NBR                                 03801000
038020                                 TO DK-REC-SEQ-NBR-B              03802000
038030                                    DK-REC-SEQ-NBR-E              03803000
038040     END-IF.                                                      03804000
038050                                                                  03805000
038060     IF ASC-KEY-PKSL-NBR > SPACES                                 03806000
038070         MOVE ASC-KEY-PKSL-NBR   TO DK-PKSL-NBR-B                 03807000
038080                                    DK-PKSL-NBR-E                 03808000
038090     END-IF.                                                      03809000
038100                                                                  03810000
038110 4020-GET-VENDOR-NAME.                                            03811000
038120                                                                  03812000
038130         EXEC SQL                                                 03813000
038140              SELECT A.EDI_IND                                    03814000
038150                   , A.PKGNG_CDE                                  03815000
038160                   , B.ENT_NAME_DESC                              03816000
038170                   , B.ENT_ID                                     03817000
038180                INTO :PURCHS-EDI-IND                              03818000
038190                    ,:PURCHS-PKGNG-CDE                            03819000
038200                    ,:ENTNME-ENT-NAME-DESC                        03820000
038210                    ,:ENTNME-ENT-ID                               03821000
038220                FROM TPURCHS A,                                   03822000
038230                     TENTNME B                                    03823000
038240               WHERE A.VER_STATUS_CDE = 'A'                       03824000
038250                 AND A.PO_NBR         = :DK-PO-NBR                03825000
038260                 AND A.ENT_ID         = B.ENT_ID                  03826000
038270                 AND B.TYPE_CDE       = '01'                      03827000
038280         END-EXEC                                                 03828000
038290                                                                  03829000
038300         EVALUATE TRUE                                            03830000
038310             WHEN SQLCODE = ZERO                                  03831000
038320             WHEN SQLCODE = +100                                  03832000
038330                  CONTINUE                                        03833000
038340             WHEN SQLCODE = -904                                  03834000
038350             WHEN SQLCODE = -911                                  03835000
038360             WHEN SQLCODE = -913                                  03836000
038370                  PERFORM 9900-SOFT-ABORT                         03837000
038380                                                                  03838000
038390             WHEN SQLWARN0 NOT = SPACES                           03839000
038400             WHEN SQLCODE  NOT = ZERO                             03840000
038410                  MOVE '4020-GET-VENDOR-NAME'                     03841000
038420                                 TO DP013-PARAGRAPH               03842000
038430                  MOVE 'UNSUCCESSFUL SELECT OF VENDOR NAME'       03843000
038440                                 TO DP013-MESSAGE-TEXT (1)        03844000
038450                  MOVE ASC-KEY-PO-NBR                             03845000
038460                                 TO PV-MSG-KEY-PO                 03846000
038470                  MOVE ASC-KEY-REC-SEQ-NBR                        03847000
038480                                 TO PV-MSG-KEY-REC-SEQ-NBR-N      03848000
038490                  MOVE PV-MSG-KEYS                                03849000
038500                                 TO DP013-MESSAGE-TEXT (2)        03850000
038510                  MOVE SQLCA     TO DP013-SQLCA                   03851000
038520                  MOVE 'TENTNME' TO DP013-DB2-TABLE-NAME (1)      03852000
038530                  SET DP013-DB2-ABEND                             03853000
038540                      DP013-XCTL-DISPLAY-RESTART                  03854000
038550                                 TO TRUE                          03855000
038560                                                                  03856000
038570                  PERFORM DP013-0000-PROCESS-ABEND                03857000
038580         END-EVALUATE.                                            03858000
038590                                                                  03859000
038600     IF SQLCODE = ZERO                                            03860000
038610         MOVE ENTNME-ENT-NAME-DESC                                03861000
038620                                 TO ASC-KEY-VENDOR-NAME           03862000
038630         MOVE PURCHS-PKGNG-CDE   TO ASC-PACKAGE-TYPE-CDE          03863000
038640         MOVE ENTNME-ENT-ID           TO ASC-ENT-ID               03864000
038650     ELSE                                                         03865000
038660         IF SQLCODE = +100                                        03866000
038670             MOVE 'VENDOR NOT FOUND'                              03867000
038680                                 TO ASC-KEY-VENDOR-NAME           03868000
038690             MOVE 'X'            TO ASC-PACKAGE-TYPE-CDE          03869000
038700             MOVE ZERO                TO ASC-ENT-ID               03870000
038710         END-IF                                                   03871000
038720     END-IF.                                                      03872000
038730                                                                  03873000
038740 4030-OPEN-CURSOR.                                                03874000
038750                                                                  03875000
038760         IF ASC-CAME-FROM-EXCPT                                   03876000
038770             EXEC SQL                                             03877000
038780                  OPEN SHIPT-UNT-CSR                              03878000
038790             END-EXEC                                             03879000
038800         ELSE                                                     03880000
038810             IF PS-SINGLE-OPER-UNT-ID                             03881000
038820                 EXEC SQL                                         03882000
038830                      OPEN PKSLIP-SING-CURSOR                     03883000
038840                 END-EXEC                                         03884000
038850             ELSE                                                 03885000
038860                 EXEC SQL                                         03886000
038870                      OPEN PKSLIP-CURSOR                          03887000
038880                 END-EXEC                                         03888000
038890             END-IF                                               03889000
038900         END-IF                                                   03890000
038910                                                                  03891000
038920         EVALUATE TRUE                                            03892000
038930             WHEN SQLCODE = ZERO                                  03893000
038940                  CONTINUE                                        03894000
038950             WHEN SQLCODE = -904                                  03895000
038960             WHEN SQLCODE = -911                                  03896000
038970             WHEN SQLCODE = -913                                  03897000
038980                  PERFORM 9900-SOFT-ABORT                         03898000
038990                                                                  03899000
039000             WHEN SQLWARN0 NOT = SPACES                           03900000
039010             WHEN SQLCODE  NOT = ZERO                             03901000
039011                                                                  03901120
039012                 IF ASC-CAME-FROM-EXCPT                           03901220
039015                    MOVE SU046-SHIPT-UNT-ID TO PV-DISP-SSCC       03901520
039016                    MOVE SPACES TO PV-MSG-STRING-1                03901620
039017                    MOVE SPACES TO PV-MSG-STRING-2                03901720
039018                    MOVE SPACES TO PV-MSG-STRING-3                03901820
039019                    STRING '4030-OPEN '                           03901920
039020                           'CAME-FROM-EXCPT - SHIPT-UNT-CSR '     03902020
039021                           PV-DISP-SSCC   DELIMITED BY SIZE       03902120
039022                                     INTO PV-MSG-STRING-1         03902220
039023                 ELSE                                             03902320
039024                 IF PS-SINGLE-OPER-UNT-ID                         03902420
039025                    MOVE DK-PO-NBR          TO PV-DISP-PO         03902520
039026                    MOVE DK-OPER-UNT-ID-B   TO PV-DISP-OPER-B     03902621
039027                    MOVE DK-OPER-UNT-ID-00  TO PV-DISP-OPER-E     03902721
039028                    MOVE DK-FCLTY-ID-B      TO PV-DISP-FCLTY-B    03902821
039029                    MOVE DK-FCLTY-ID-E      TO PV-DISP-FCLTY-E    03902921
039030                    MOVE DK-REC-SEQ-NBR-B   TO PV-DISP-REC-SEQ-B  03903021
039031                    MOVE DK-REC-SEQ-NBR-E   TO PV-DISP-REC-SEQ-E  03903121
039032                    MOVE DK-PKSL-NBR-B  TO PV-DISP-PKSL-NBR-B     03903221
039033                    MOVE DK-PKSL-NBR-E  TO PV-DISP-PKSL-NBR-E     03903321
039034                    MOVE DK-BOL-NBR-B   TO PV-DISP-BOL-NBR-B      03903421
039035                    MOVE DK-BOL-NBR-E   TO PV-DISP-BOL-NBR-E      03903521
039036                    MOVE DK-PRO-NBR-B   TO PV-DISP-PRO-NBR-B      03903621
039037                    MOVE DK-PRO-NBR-E   TO PV-DISP-PRO-NBR-E      03903721
039038                    STRING '4030-OPEN '                           03903820
039039                           'SINGLE-OPER - PKSLIP-SING-CURSOR '    03903920
039040                           PV-DISP-PO     '-'                     03904020
039041                           PV-DISP-OPER-B '-'                     03904120
039042                           PV-DISP-OPER-E DELIMITED BY SIZE       03904220
039043                                     INTO PV-MSG-STRING-1         03904320
039044                    STRING PV-DISP-FCLTY-B     '-'                03904420
039045                           PV-DISP-FCLTY-E     '-'                03904520
039046                           PV-DISP-REC-SEQ-B   '-'                03904620
039047                           PV-DISP-REC-SEQ-E   '-'                03904720
039048                           PV-DISP-PKSL-NBR-B  '-'                03904820
039049                           PV-DISP-PKSL-NBR-E DELIMITED BY SIZE   03904920
039051                                     INTO PV-MSG-STRING-2         03905120
039052                    STRING PV-DISP-BOL-NBR-B   '-'                03905220
039053                           PV-DISP-BOL-NBR-E   '-'                03905320
039054                           PV-DISP-PRO-NBR-B   '-'                03905420
039055                           PV-DISP-PRO-NBR-E  DELIMITED BY SIZE   03905520
039058                                     INTO PV-MSG-STRING-3         03905820
039059                  ELSE                                            03905920
039061                      MOVE DK-PO-NBR         TO PV-DISP-PO        03906120
039062                      MOVE DK-OPER-UNT-ID-B  TO PV-DISP-OPER-B    03906220
039063                      MOVE DK-OPER-UNT-ID-E  TO PV-DISP-OPER-E    03906320
039064                      MOVE DK-FCLTY-ID-B     TO PV-DISP-FCLTY-B   03906420
039065                      MOVE DK-FCLTY-ID-E     TO PV-DISP-FCLTY-E   03906520
039066                      MOVE DK-REC-SEQ-NBR-B  TO PV-DISP-REC-SEQ-B 03906620
039067                      MOVE DK-REC-SEQ-NBR-E  TO PV-DISP-REC-SEQ-E 03906720
039068                      MOVE DK-PKSL-NBR-B   TO PV-DISP-PKSL-NBR-B  03906820
039069                      MOVE DK-PKSL-NBR-E   TO PV-DISP-PKSL-NBR-E  03906920
039070                      MOVE DK-BOL-NBR-B    TO PV-DISP-BOL-NBR-B   03907020
039071                      MOVE DK-BOL-NBR-E    TO PV-DISP-BOL-NBR-E   03907120
039072                      MOVE DK-PRO-NBR-B    TO PV-DISP-PRO-NBR-B   03907220
039073                      MOVE DK-PRO-NBR-E    TO PV-DISP-PRO-NBR-E   03907320
039074                    STRING '4030-OPEN '                           03907420
039075                           'OTHER - PKSLIP-CURSOR '               03907520
039076                           PV-DISP-PO     '-'                     03907620
039077                           PV-DISP-OPER-B '-'                     03907720
039078                           PV-DISP-OPER-E DELIMITED BY SIZE       03907820
039079                                     INTO PV-MSG-STRING-1         03907920
039080                    STRING PV-DISP-FCLTY-B     '-'                03908020
039081                           PV-DISP-FCLTY-E     '-'                03908120
039082                           PV-DISP-REC-SEQ-B   '-'                03908220
039083                           PV-DISP-REC-SEQ-E   '-'                03908320
039084                           PV-DISP-PKSL-NBR-B  '-'                03908420
039085                           PV-DISP-PKSL-NBR-E DELIMITED BY SIZE   03908520
039086                                     INTO PV-MSG-STRING-2         03908620
039087                    STRING PV-DISP-BOL-NBR-B   '-'                03908720
039088                           PV-DISP-BOL-NBR-E   '-'                03908820
039089                           PV-DISP-PRO-NBR-B   '-'                03908920
039090                           PV-DISP-PRO-NBR-E  DELIMITED BY SIZE   03909020
039091                                     INTO PV-MSG-STRING-3         03909120
039092                  END-IF                                          03909220
039093                  END-IF                                          03909320
039094                                                                  03909420
039095                                                                  03909520
039096                                                                  03909620
039097                  MOVE '4030-OPEN-CURSOR'                         03909720
039098                                 TO DP013-PARAGRAPH               03909820
039099***               MOVE 'UNSUCCESSFUL PACK SLIP CURSOR OPEN'       03909920
039100                  MOVE PV-MSG-STRING-1                            03910020
039101                                 TO DP013-MESSAGE-TEXT (1)        03910120
039102***               MOVE ASC-KEY-PO-NBR                             03910220
039103***                              TO PV-MSG-KEY-PO                 03910320
039104***               MOVE ASC-KEY-REC-SEQ-NBR                        03910420
039105***                              TO PV-MSG-KEY-REC-SEQ-NBR-N      03910520
039106***               MOVE PV-MSG-KEYS                                03910620
039107                  MOVE PV-MSG-STRING-2                            03910720
039110                                 TO DP013-MESSAGE-TEXT (2)        03911000
039111                  MOVE PV-MSG-STRING-3                            03911120
039112                                 TO DP013-MESSAGE-TEXT (3)        03911220
039120                  MOVE SQLCA TO DP013-SQLCA                       03912000
039130                  MOVE 'TPKSLIP' TO DP013-DB2-TABLE-NAME (1)      03913000
039140                  SET DP013-XCTL-DISPLAY-RESTART                  03914000
039150                      DP013-DB2-ABEND                             03915000
039160                                 TO TRUE                          03916000
039170                                                                  03917000
039180                  PERFORM DP013-0000-PROCESS-ABEND                03918000
039190         END-EVALUATE.                                            03919000
039200                                                                  03920000
039210 4040-GET-PACK-SLIPS.                                             03921000
039220                                                                  03922000
039230     INITIALIZE PV-HOLD-ASN-NBR                                   03923000
039240                PV-HOLD-OPER-UNT-ID                               03924000
039250                PV-DB2-COUNT                                      03925000
039260                                                                  03926000
039270     PERFORM VARYING PV-READ-COUNT  FROM 1 BY 1                   03927000
039280         UNTIL PV-READ-COUNT > PC-MAX-ITEMS OR                    03928000
039290               ASC-NO-MORE-PACK-SLIPS                             03929000
039300                                                                  03930000
039310         PERFORM 4042-FETCH-PACK-SLIP                             03931000
039320                                                                  03932000
039330         IF ASC-MORE-PACK-SLIPS                                   03933000
039340             PERFORM 4200-SUM-MATCHED-ITEMS                       03934000
039350             PERFORM 4300-SUM-UNMATCHED-ITEMS                     03935000
039360             PERFORM 4320-SUM-INPKSU-CARTONS                      03936000
039370             PERFORM 4330-COUNT-PBS-ERRORS                        03937000
039380             IF ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                 03938000
039390                 ADD +1          TO ASC-ITEM-SUB                  03939000
039400             ELSE                                                 03940000
039410                 ADD +1          TO ASC-BLK-SUB                   03941000
039420                 MOVE +1         TO ASC-ITEM-SUB                  03942000
039430                                                                  03943000
039440                 IF ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY          03944000
039450                     MOVE +1     TO ASC-BLK-SUB                   03945000
039460                     SET ASC-BLOCK-MODIFIED (1)                   03946000
039470                                 TO TRUE                          03947000
039480                                                                  03948000
039490                     PERFORM 5100-WRITE-TEMP-STORAGE              03949000
039500                                                                  03950000
039510                     MOVE ASC-BLOCK-ENTRIES                       03951000
039520                                          (PC-MAX-BLOCKS-IN-ARRAY)03952000
039530                                 TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB)03953000
039540                     ADD +1      TO ASC-BLK-SUB                   03954000
039550                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   03955000
039560                     SET ASC-BLOCK-NOT-MODIFIED (ASC-BLK-SUB)     03956000
039570                                 TO TRUE                          03957000
039580                 END-IF                                           03958000
039590             END-IF                                               03959000
039600             ADD +1              TO ASC-NUMBER-OF-ITEMS-READ      03960000
039610             MOVE ASC-NUMBER-OF-ITEMS-READ                        03961000
039620                                 TO ASC-LIST-ITEM-NUMBER          03962000
039630                                   (ASC-BLK-SUB ASC-ITEM-SUB)     03963000
039640             MOVE PKSLIP-PKSL-NBR                                 03964000
039650                                 TO ASC-PKSL-NBR                  03965000
039660                                   (ASC-BLK-SUB ASC-ITEM-SUB)     03966000
039670             MOVE PKSLIP-STR-DEST-NBR                             03967000
039680                                 TO ASC-STR-DEST-NBR-N            03968000
039690                                   (ASC-BLK-SUB ASC-ITEM-SUB)     03969000
039700             MOVE PKSLIP-REC-SEQ-NBR                              03970000
039710                                 TO ASC-REC-SEQ-NBR-N             03971000
039720                                   (ASC-BLK-SUB ASC-ITEM-SUB)     03972000
039730                                                                  03973000
039740             MOVE PKSLIP-OWNER-SCAC-ID                            03974000
039750                                 TO ASC-SCAC-ID                   03975000
039760                                   (ASC-BLK-SUB ASC-ITEM-SUB)     03976000
039770             MOVE PKSLIP-VEND-SHIP-DTE                            03977000
039780                                 TO ASC-VND-SHP-DTE               03978000
039790                                   (ASC-BLK-SUB ASC-ITEM-SUB)     03979000
039800                                                                  03980000
039810             MOVE PKSLIP-BOL-NBR TO ASC-BOL-NBR                   03981000
039820                                   (ASC-BLK-SUB ASC-ITEM-SUB)     03982000
039830             MOVE PKSLIP-PRO-NBR TO PV-PRO-NBR-R                  03983000
039840             MOVE ZEROES  TO PV-CHAR-COUNT                        03984000
039850             INSPECT PV-PRO-NBR-R TALLYING PV-CHAR-COUNT          03985000
039860              FOR CHARACTERS BEFORE INITIAL SPACE                 03986000
039870                                                                  03987000
039880             IF PV-CHAR-COUNT > 10                                03988000
039890                COMPUTE PV-PRO-BEGIN   =                          03989000
039900                          (PV-CHAR-COUNT - 9)                     03990000
039910                MOVE PV-PRO-NBR-R (PV-PRO-BEGIN:10)               03991000
039920                                        TO ASC-PRO-NBR            03992000
039930                                   (ASC-BLK-SUB ASC-ITEM-SUB)     03993000
039940             ELSE                                                 03994000
039950                MOVE PV-PRO-NBR-R       TO ASC-PRO-NBR            03995000
039960                                   (ASC-BLK-SUB ASC-ITEM-SUB)     03996000
039970             END-IF                                               03997000
039980                                                                  03998000
039990             MOVE PKSLIP-EXPTED-PKG-QTY                           03999000
040000                                 TO ASC-CARTON-COUNT              04000000
040010                                   (ASC-BLK-SUB ASC-ITEM-SUB)     04001000
040020             ADD  PKSLIP-EXPTED-PKG-QTY                           04002000
040030                                 TO ASC-CARTON-TOTAL              04003000
040040             MOVE PKSLIP-OPER-UNT-ID                              04004000
040050                                 TO ASC-OPER-UNT-ID               04005000
040060                                   (ASC-BLK-SUB ASC-ITEM-SUB)     04006000
040070             MOVE PKSLIP-PKSL-STAT-CDE                            04007000
040080                                 TO ASC-PKSL-STAT-CDE             04008000
040090                                   (ASC-BLK-SUB ASC-ITEM-SUB)     04009000
040100             MOVE PKSLIP-SEQ-NBR TO ASC-SEQ-NBR                   04010000
040110                                   (ASC-BLK-SUB ASC-ITEM-SUB)     04011000
040120             COMPUTE ASC-PKSL-ITM-QTY-N (ASC-BLK-SUB ASC-ITEM-SUB)04012000
040130                 = PV-MATCHED-ITEMS + PV-UNMATCHED-ITEMS          04013000
040140             ADD ASC-PKSL-ITM-QTY-N (ASC-BLK-SUB ASC-ITEM-SUB)    04014000
040150                                 TO ASC-UNIT-TOTAL                04015000
040160             IF PKSLIP-ASN-NBR = PV-HOLD-ASN-NBR                  04016000
040170               AND PKSLIP-OPER-UNT-ID = PV-HOLD-OPER-UNT-ID       04017000
040180                 CONTINUE                                         04018000
040190             ELSE                                                 04019000
040200                 PERFORM 4060-UPC-PROBLEM-CHK                     04020000
040210                 MOVE PKSLIP-ASN-NBR                              04021000
040220                                 TO PV-HOLD-ASN-NBR               04022000
040230                 MOVE PKSLIP-OPER-UNT-ID                          04023000
040240                                 TO PV-HOLD-OPER-UNT-ID           04024000
040250             END-IF                                               04025000
040260             IF PV-DB2-COUNT > ZERO                               04026000
040270                 SET ASC-UPC-PROBLEM                              04027000
040280                                   (ASC-BLK-SUB ASC-ITEM-SUB)     04028000
040290                                 TO TRUE                          04029000
040300             END-IF                                               04030000
040310             IF PV-PBS-ERROR-COUNT > 0                            04031000
040320                 SET ASC-PBS-ERRORS-FOUND                         04032000
040330                                   (ASC-BLK-SUB ASC-ITEM-SUB)     04033000
040340                                 TO TRUE                          04034000
040350             END-IF                                               04035000
040360                                                                  04036000
040370             MOVE PV-INPKSU-CRTN-CNT                              04037000
040380                                 TO ASC-INPKSU-COUNT              04038000
040390                                   (ASC-BLK-SUB ASC-ITEM-SUB)     04039000
040400         END-IF                                                   04040000
040410     END-PERFORM.                                                 04041000
040420                                                                  04042000
040430     IF ASC-NUMBER-OF-ITEMS-READ > ZERO                           04043000
040440         MOVE +1                 TO ASC-BLK-SUB                   04044000
040450                                                                  04045000
040460         PERFORM 5100-WRITE-TEMP-STORAGE                          04046000
040470                                                                  04047000
040480         ADD +1                  TO ASC-BLK-SUB                   04048000
040490                                                                  04049000
040500         PERFORM 5100-WRITE-TEMP-STORAGE                          04050000
040510                                                                  04051000
040520         MOVE +1                 TO ASC-BLK-SUB                   04052000
040530                                    PV-BLOCK-NUMBER               04053000
040540                                                                  04054000
040550         PERFORM 4410-READ-TEMP-STORAGE                           04055000
040560                                                                  04056000
040570         IF ASC-HIGHEST-BLOCK-WRITTEN > 1                         04057000
040580             MOVE +2             TO ASC-BLK-SUB                   04058000
040590                                    PV-BLOCK-NUMBER               04059000
040600                                                                  04060000
040610             PERFORM 4410-READ-TEMP-STORAGE                       04061000
040620         END-IF                                                   04062000
040630     END-IF.                                                      04063000
040640                                                                  04064000
040650 4042-FETCH-PACK-SLIP.                                            04065000
040660                                                                  04066000
040670     IF ASC-CAME-FROM-EXCPT                                       04067000
040680         EXEC SQL                                                 04068000
040690              FETCH  SHIPT-UNT-CSR                                04069000
040700               INTO :PKSLIP-OPER-UNT-ID,                          04070000
040710                    :PKSLIP-SHIPT-ID,                             04071000
040720                    :PKSLIP-PKSL-NBR,                             04072000
040730                    :PKSLIP-STR-DEST-NBR,                         04073000
040740                    :PKSLIP-REC-SEQ-NBR,                          04074000
040750                    :PKSLIP-BOL-NBR,                              04075000
040760                    :PKSLIP-PRO-NBR,                              04076000
040770                    :PKSLIP-PKSL-STAT-CDE,                        04077000
040780                    :PKSLIP-SEQ-NBR,                              04078000
040790                    :PKSLIP-CRE-TMST,                             04079000
040800                    :PKSLIP-EXPTED-PKG-QTY,                       04080000
040810                    :PKSLIP-OWNER-SCAC-ID,                        04081000
040820                    :PKSLIP-ASN-NBR,                              04082000
040830                    :PKSLIP-VEND-SHIP-DTE                         04083000
040840         END-EXEC                                                 04084000
040850     ELSE                                                         04085000
040860         IF PS-SINGLE-OPER-UNT-ID                                 04086000
040870             EXEC SQL                                             04087000
040880                  FETCH  PKSLIP-SING-CURSOR                       04088000
040890                   INTO :PKSLIP-OPER-UNT-ID,                      04089000
040900                        :PKSLIP-SHIPT-ID,                         04090000
040910                        :PKSLIP-PKSL-NBR,                         04091000
040920                        :PKSLIP-STR-DEST-NBR,                     04092000
040930                        :PKSLIP-REC-SEQ-NBR,                      04093000
040940                        :PKSLIP-BOL-NBR,                          04094000
040950                        :PKSLIP-PRO-NBR,                          04095000
040960                        :PKSLIP-PKSL-STAT-CDE,                    04096000
040970                        :PKSLIP-SEQ-NBR,                          04097000
040980                        :PKSLIP-CRE-TMST,                         04098000
040990                        :PKSLIP-EXPTED-PKG-QTY,                   04099000
041000                        :PKSLIP-OWNER-SCAC-ID,                    04100000
041010                        :PKSLIP-ASN-NBR,                          04101000
041020                        :PKSLIP-VEND-SHIP-DTE                     04102000
041030             END-EXEC                                             04103000
041040         ELSE                                                     04104000
041050             EXEC SQL                                             04105000
041060                  FETCH  PKSLIP-CURSOR                            04106000
041070                   INTO :PKSLIP-OPER-UNT-ID,                      04107000
041080                        :PKSLIP-SHIPT-ID,                         04108000
041090                        :PKSLIP-PKSL-NBR,                         04109000
041100                        :PKSLIP-STR-DEST-NBR,                     04110000
041110                        :PKSLIP-REC-SEQ-NBR,                      04111000
041120                        :PKSLIP-BOL-NBR,                          04112000
041130                        :PKSLIP-PRO-NBR,                          04113000
041140                        :PKSLIP-PKSL-STAT-CDE,                    04114000
041150                        :PKSLIP-SEQ-NBR,                          04115000
041160                        :PKSLIP-CRE-TMST,                         04116000
041170                        :PKSLIP-EXPTED-PKG-QTY,                   04117000
041180                        :PKSLIP-OWNER-SCAC-ID,                    04118000
041190                        :PKSLIP-ASN-NBR,                          04119000
041200                        :PKSLIP-VEND-SHIP-DTE                     04120000
041210             END-EXEC                                             04121000
041220         END-IF                                                   04122000
041230     END-IF.                                                      04123000
041240                                                                  04124000
041250     EVALUATE TRUE                                                04125000
041260         WHEN SQLCODE = ZERO                                      04126000
041270         WHEN SQLCODE = +100                                      04127000
041280              CONTINUE                                            04128000
041290         WHEN SQLCODE = -904                                      04129000
041300         WHEN SQLCODE = -911                                      04130000
041310         WHEN SQLCODE = -913                                      04131000
041320              PERFORM 9900-SOFT-ABORT                             04132000
041330                                                                  04133000
041340         WHEN SQLWARN0 NOT = SPACES                               04134000
041350         WHEN SQLCODE  NOT = ZERO                                 04135000
041360              MOVE '4042-FETCH-PACK-SLIP'                         04136000
041370                                 TO DP013-PARAGRAPH               04137000
041380              MOVE 'UNSUCCESSFUL FETCH PACK SLIP CURSOR'          04138000
041390                                 TO DP013-MESSAGE-TEXT (1)        04139000
041400              MOVE ASC-KEY-PO-NBR                                 04140000
041410                                 TO PV-MSG-KEY-PO                 04141000
041420              MOVE ASC-KEY-REC-SEQ-NBR                            04142000
041430                                 TO PV-MSG-KEY-REC-SEQ-NBR-N      04143000
041440              MOVE PV-MSG-KEYS   TO DP013-MESSAGE-TEXT (2)        04144000
041450              MOVE SQLCA         TO DP013-SQLCA                   04145000
041460              MOVE 'TPKSLIP'     TO DP013-DB2-TABLE-NAME (1)      04146000
041470              SET DP013-DB2-ABEND                                 04147000
041480                  DP013-XCTL-DISPLAY-RESTART                      04148000
041490                                 TO TRUE                          04149000
041500                                                                  04150000
041510              PERFORM DP013-0000-PROCESS-ABEND                    04151000
041520     END-EVALUATE.                                                04152000
041530                                                                  04153000
041540     IF SQLCODE = +100                                            04154000
041550         SET ASC-NO-MORE-PACK-SLIPS                               04155000
041560                                 TO TRUE                          04156000
041570     END-IF.                                                      04157000
041580                                                                  04158000
041590 4050-CLOSE-CURSOR.                                               04159000
041600                                                                  04160000
041610     IF ASC-CAME-FROM-EXCPT                                       04161000
041620         EXEC SQL                                                 04162000
041630              CLOSE SHIPT-UNT-CSR                                 04163000
041640         END-EXEC                                                 04164000
041650     ELSE                                                         04165000
041660         IF PS-SINGLE-OPER-UNT-ID                                 04166000
041670             EXEC SQL                                             04167000
041680                  CLOSE PKSLIP-SING-CURSOR                        04168000
041690             END-EXEC                                             04169000
041700         ELSE                                                     04170000
041710             EXEC SQL                                             04171000
041720                  CLOSE PKSLIP-CURSOR                             04172000
041730             END-EXEC                                             04173000
041740         END-IF                                                   04174000
041750     END-IF.                                                      04175000
041760                                                                  04176000
041770     EVALUATE TRUE                                                04177000
041780         WHEN SQLCODE = ZERO                                      04178000
041790              CONTINUE                                            04179000
041800         WHEN SQLCODE = -904                                      04180000
041810         WHEN SQLCODE = -911                                      04181000
041820         WHEN SQLCODE = -913                                      04182000
041830              PERFORM 9900-SOFT-ABORT                             04183000
041840                                                                  04184000
041850         WHEN SQLWARN0 NOT = SPACES                               04185000
041860         WHEN SQLCODE  NOT = ZERO                                 04186000
041870              MOVE '4050-CLOSE-CURSOR'                            04187000
041880                                 TO DP013-PARAGRAPH               04188000
041890              MOVE 'UNSUCCESSFUL PACK SLIP CURSOR CLOSE'          04189000
041900                                 TO DP013-MESSAGE-TEXT (1)        04190000
041910              MOVE ASC-KEY-PO-NBR                                 04191000
041920                                 TO PV-MSG-KEY-PO                 04192000
041930              MOVE ASC-KEY-REC-SEQ-NBR                            04193000
041940                                 TO PV-MSG-KEY-REC-SEQ-NBR-N      04194000
041950              MOVE PV-MSG-KEYS   TO DP013-MESSAGE-TEXT (2)        04195000
041960              MOVE SQLCA TO DP013-SQLCA                           04196000
041970              MOVE 'TPKSLIP '    TO DP013-DB2-TABLE-NAME (1)      04197000
041980              SET DP013-DB2-ABEND                                 04198000
041990                  DP013-XCTL-DISPLAY-RESTART                      04199000
042000                                 TO TRUE                          04200000
042010                                                                  04201000
042020              PERFORM DP013-0000-PROCESS-ABEND                    04202000
042030     END-EVALUATE.                                                04203000
042040                                                                  04204000
042050 4060-UPC-PROBLEM-CHK.                                            04205000
042060     MOVE ZERO           TO  PV-DB2-COUNT.                        04206000
042070     PERFORM 4062-GET-ASNHDR-ID                                   04207000
042080     IF SQLCODE = ZERO                                            04208000
042090         PERFORM 4064-CHK-ASN-TABLES                              04209000
042100     END-IF.                                                      04210000
042110                                                                  04211000
042120 4062-GET-ASNHDR-ID.                                              04212000
042130     EXEC SQL                                                     04213000
042140          SELECT B.ASNHDR_ID                                      04214000
042150            INTO :ASNHDR-ASNHDR-ID                                04215000
042160            FROM TEXTENT A                                        04216000
042170                ,TASNHDR B                                        04217000
042180           WHERE A.ENT_ID      = :ASC-ENT-ID                      04218000
042190             AND B.OPERCO_NBR  = '03'                             04219000
042200             AND B.EDI_VEND_ID = A.DUN_NBR                        04220000
042210             AND B.ASNHDR_NBR  = :PKSLIP-ASN-NBR                  04221000
042220           WITH UR                                                04222001
042230     END-EXEC                                                     04223000
042240                                                                  04224000
042250     EVALUATE TRUE                                                04225000
042260         WHEN SQLCODE = ZERO                                      04226000
042270         WHEN SQLCODE = +100                                      04227000
042280              CONTINUE                                            04228000
042290         WHEN SQLCODE = -904                                      04229000
042300         WHEN SQLCODE = -911                                      04230000
042310         WHEN SQLCODE = -913                                      04231000
042320              PERFORM 9900-SOFT-ABORT                             04232000
042330                                                                  04233000
042340         WHEN SQLWARN0 NOT = SPACES                               04234000
042350         WHEN SQLCODE  NOT = ZERO                                 04235000
042360              MOVE '4062-GET-ASN-HDR-ID'                          04236000
042370                                 TO DP013-PARAGRAPH               04237000
042380              MOVE 'UNSUCCESSFUL CHECK FOR UPC PROBLEM'           04238000
042390                                 TO DP013-MESSAGE-TEXT (1)        04239000
042400              MOVE ASC-KEY-PO-NBR                                 04240000
042410                                 TO PV-MSG-KEY-PO                 04241000
042420              MOVE ASC-KEY-REC-SEQ-NBR                            04242000
042430                                 TO PV-MSG-KEY-REC-SEQ-NBR-N      04243000
042440              MOVE PV-MSG-KEYS   TO DP013-MESSAGE-TEXT (2)        04244000
042450              MOVE SQLCA TO DP013-SQLCA                           04245000
042460              MOVE 'TASNHDR '    TO DP013-DB2-TABLE-NAME (1)      04246000
042470              MOVE 'TEXTENT '    TO DP013-DB2-TABLE-NAME (2)      04247000
042480              SET DP013-DB2-ABEND                                 04248000
042490                  DP013-XCTL-DISPLAY-RESTART                      04249000
042500                                 TO TRUE                          04250000
042510                                                                  04251000
042520              PERFORM DP013-0000-PROCESS-ABEND                    04252000
042530     END-EVALUATE.                                                04253000
042540/                                                                 04254000
042550 4064-CHK-ASN-TABLES.                                             04255000
042560     IF PKSLIP-STR-DEST-NBR > ZERO                                04256000
042570         MOVE PKSLIP-STR-DEST-NBR TO DK-ASN-OPER-NBR              04257000
042580     ELSE                                                         04258000
042590         MOVE PKSLIP-OPER-UNT-ID  TO DK-ASN-OPER-NBR              04259000
042600     END-IF                                                       04260000
042610                                                                  04261000
042620     EXEC SQL                                                     04262000
042630          SELECT 1                                                04263000
042640            INTO :PV-DB2-COUNT                                    04264000
042650            FROM SYSIBM.SYSDUMMY1 X                               04265000
042660           WHERE EXISTS (SELECT 1                                 04266000
042670              FROM TASNDTL B                                      04267000
042680             WHERE X.IBMREQD > ' '                                04268000
042690               AND B.ASNHDR_ID   = :ASNHDR-ASNHDR-ID              04269000
042700               AND B.PO_NBR      = :ASC-KEY-PO-NBR-A              04270000
042710               AND B.LOC_NBR     = :DK-ASN-OPER-NBR               04271000
042720               AND NOT EXISTS                                     04272000
042730                  (SELECT *                                       04273000
042740                     FROM TASDTPL D                               04274000
042750                    WHERE D.ASNHDR_ID = B.ASNHDR_ID               04275000
042760                      AND D.ASNDTL_NBR = B.ASNDTL_NBR))           04276000
042770     END-EXEC                                                     04277000
042780                                                                  04278000
042790     EVALUATE TRUE                                                04279000
042800         WHEN SQLCODE = ZERO                                      04280000
042810*        WHEN SQLCODE = +100    //* PRB0052549                    04281019
042820              CONTINUE                                            04282019
042821//* PRB0052549 START                                              04282119
042822         WHEN SQLCODE = +100                                      04282219
042823              MOVE ASC-KEY-PO-NBR-N    TO PV-PO-NBR-1             04282319
042824              IF PV-PO-NBR-1 = ASC-KEY-PO-NBR-N                   04282419
042825                 MOVE PV-PO-NBR-1      TO PV-PO-NBR-A             04282519
042826                 PERFORM 4064-CHK-ASN-TABLES-2                    04282619
042827              ELSE                                                04282719
042828                 CONTINUE                                         04282819
042829              END-IF                                              04282919
042831// END                                                            04283119
042832         WHEN SQLCODE = -904                                      04283200
042840         WHEN SQLCODE = -911                                      04284000
042850         WHEN SQLCODE = -913                                      04285000
042860              PERFORM 9900-SOFT-ABORT                             04286000
042870                                                                  04287000
042880         WHEN SQLWARN0 NOT = SPACES                               04288000
042890         WHEN SQLCODE  NOT = ZERO                                 04289000
042900              MOVE '4064-CHK-ASN-TABLES'                          04290000
042910                                 TO DP013-PARAGRAPH               04291000
042920              MOVE 'UNSUCCESSFUL CHECK FOR UPC PROBLEM'           04292000
042930                                 TO DP013-MESSAGE-TEXT (1)        04293000
042940              MOVE ASC-KEY-PO-NBR                                 04294000
042950                                 TO PV-MSG-KEY-PO                 04295000
042960              MOVE ASC-KEY-REC-SEQ-NBR                            04296000
042970                                 TO PV-MSG-KEY-REC-SEQ-NBR-N      04297000
042980              MOVE PV-MSG-KEYS   TO DP013-MESSAGE-TEXT (2)        04298000
042990              MOVE SQLCA TO DP013-SQLCA                           04299000
043000              MOVE 'TASNDTL '    TO DP013-DB2-TABLE-NAME (1)      04300000
043010              MOVE 'TASDTPL '    TO DP013-DB2-TABLE-NAME (2)      04301000
043020              SET DP013-DB2-ABEND                                 04302000
043030                  DP013-XCTL-DISPLAY-RESTART                      04303000
043040                                 TO TRUE                          04304000
043050                                                                  04305000
043060              PERFORM DP013-0000-PROCESS-ABEND                    04306000
043070     END-EVALUATE.                                                04307000
043080/                                                                 04308000
043081//* PRB0052549 START                                              04308119
043082 4064-CHK-ASN-TABLES-2.                                           04308219
043083     EXEC SQL                                                     04308319
043084          SELECT 1                                                04308419
043085            INTO :PV-DB2-COUNT                                    04308519
043086            FROM SYSIBM.SYSDUMMY1 X                               04308619
043087           WHERE EXISTS (SELECT 1                                 04308719
043088              FROM TASNDTL B                                      04308819
043089             WHERE X.IBMREQD > ' '                                04308919
043090               AND B.ASNHDR_ID   = :ASNHDR-ASNHDR-ID              04309019
043091               AND B.PO_NBR      = :PV-PO-NBR-A                   04309119
043092               AND B.LOC_NBR     = :DK-ASN-OPER-NBR               04309219
043093               AND NOT EXISTS                                     04309319
043094                  (SELECT *                                       04309419
043095                     FROM TASDTPL D                               04309519
043096                    WHERE D.ASNHDR_ID = B.ASNHDR_ID               04309619
043097                      AND D.ASNDTL_NBR = B.ASNDTL_NBR))           04309719
043098     END-EXEC                                                     04309819
043099                                                                  04309919
043100     EVALUATE TRUE                                                04310019
043101         WHEN SQLCODE = ZERO                                      04310119
043102         WHEN SQLCODE = +100                                      04310219
043103              CONTINUE                                            04310319
043111         WHEN SQLCODE = -904                                      04311119
043112         WHEN SQLCODE = -911                                      04311219
043113         WHEN SQLCODE = -913                                      04311319
043114              PERFORM 9900-SOFT-ABORT                             04311419
043115                                                                  04311519
043116         WHEN SQLWARN0 NOT = SPACES                               04311619
043117         WHEN SQLCODE  NOT = ZERO                                 04311719
043118              MOVE '4064-CHK-ASN-TABLES-2'                        04311819
043119                                 TO DP013-PARAGRAPH               04311919
043120              MOVE 'UNSUCCESSFUL CHECK FOR UPC PROBLEM'           04312019
043121                                 TO DP013-MESSAGE-TEXT (1)        04312119
043122              MOVE ASC-KEY-PO-NBR                                 04312219
043123                                 TO PV-MSG-KEY-PO                 04312319
043124              MOVE ASC-KEY-REC-SEQ-NBR                            04312419
043125                                 TO PV-MSG-KEY-REC-SEQ-NBR-N      04312519
043126              MOVE PV-MSG-KEYS   TO DP013-MESSAGE-TEXT (2)        04312619
043127              MOVE SQLCA TO DP013-SQLCA                           04312719
043128              MOVE 'TASNDTL '    TO DP013-DB2-TABLE-NAME (1)      04312819
043129              MOVE 'TASDTPL '    TO DP013-DB2-TABLE-NAME (2)      04312919
043130              SET DP013-DB2-ABEND                                 04313019
043131                  DP013-XCTL-DISPLAY-RESTART                      04313119
043132                                 TO TRUE                          04313219
043133                                                                  04313319
043134              PERFORM DP013-0000-PROCESS-ABEND                    04313419
043135     END-EVALUATE.                                                04313519
043136/                                                                 04313619
043137//* END                                                           04313719
043138******************************************************************04313800
043139* CHECK TSHUNLO FOR ACTIVE CARTONS CHECKED-IN                     04313900
043140******************************************************************04314000
043141 4100-ACTIVE-CARTONS-CHECKED-IN.                                  04314100
043142                                                                  04314200
043143     EXEC SQL                                                     04314300
043150          SELECT A.SHIPT_UNT_ID                                   04315000
043160            INTO :INPKSU-SHIPT-UNT-ID                             04316000
043170            FROM TINPKSU A                                        04317000
043180                ,TSHUNLO B                                        04318000
043190            WHERE A.PO_NBR        = :DK-PO-NBR                    04319000
043200              AND A.SEQ_NBR       = :DK-SEQ-NBR                   04320000
043210              AND A.SHIPT_UNT_ID  = B.SHIPT_UNT_ID                04321000
043220              AND B.ACTV_CDE      = 'A'                           04322000
043230              AND B.SCN_LOC_ID    = 'RECV'                        04323000
043240     END-EXEC                                                     04324000
043250                                                                  04325000
043260     EVALUATE TRUE                                                04326000
043270         WHEN SQLCODE = ZERO                                      04327000
043280         WHEN SQLCODE = -811                                      04328000
043290              SET PS-ACTIVE-CARTONS-YES   TO TRUE                 04329000
043300         WHEN SQLCODE = +100                                      04330000
043310              SET PS-ACTIVE-CARTONS-NO    TO TRUE                 04331000
043320         WHEN SQLCODE = -904                                      04332000
043330         WHEN SQLCODE = -911                                      04333000
043340         WHEN SQLCODE = -913                                      04334000
043350              PERFORM 9900-SOFT-ABORT                             04335000
043360                                                                  04336000
043370         WHEN SQLWARN0 NOT = SPACES                               04337000
043380         WHEN SQLCODE  NOT = ZERO                                 04338000
043390              MOVE '4100-ACTIVE-CARTONS-CHECKED-IN'               04339000
043400                                 TO DP013-PARAGRAPH               04340000
043410              MOVE 'UNSUCCESSFUL CHECK ACTIVE CARTONS '           04341000
043420                                 TO DP013-MESSAGE-TEXT (1)        04342000
043430              MOVE ASC-KEY-PO-NBR                                 04343000
043440                                 TO PV-MSG-KEY-PO                 04344000
043450              MOVE ASC-KEY-REC-SEQ-NBR                            04345000
043460                                 TO PV-MSG-KEY-REC-SEQ-NBR-N      04346000
043470              MOVE PV-MSG-KEYS   TO DP013-MESSAGE-TEXT (2)        04347000
043480              MOVE SQLCA TO DP013-SQLCA                           04348000
043490              MOVE 'TINPSKU '    TO DP013-DB2-TABLE-NAME (1)      04349000
043500              MOVE 'TSHUNLO '    TO DP013-DB2-TABLE-NAME (2)      04350000
043510              SET DP013-DB2-ABEND                                 04351000
043520                  DP013-XCTL-DISPLAY-RESTART                      04352000
043530                                 TO TRUE                          04353000
043540                                                                  04354000
043550              PERFORM DP013-0000-PROCESS-ABEND                    04355000
043560     END-EVALUATE.                                                04356000
043570/                                                                 04357000
043580******************************************************************04358000
043590*    SUM ALL PACK SLIP ITEM QUANTITIES FOR MATCHED ITEMS          04359000
043600******************************************************************04360000
043610                                                                  04361000
043620 4200-SUM-MATCHED-ITEMS.                                          04362000
043630                                                                  04363000
043640     MOVE ZERO           TO PV-MATCHED-ITEMS.                     04364000
043650                                                                  04365000
043660         EXEC SQL                                                 04366000
043670               SELECT SUM (PKSL_ITM_QTY)                          04367000
043680                 INTO :PV-MATCHED-ITEMS :PV-MATCHED-IND           04368000
043690                 FROM TPKITEM                                     04369000
043700                WHERE PO_NBR        = :DK-PO-NBR                  04370000
043710                  AND SEQ_NBR       = :PKSLIP-SEQ-NBR             04371000
043720                  AND VER_STAT_CDE  = 'A'                         04372000
043730         END-EXEC                                                 04373000
043740                                                                  04374000
043750         EVALUATE TRUE                                            04375000
043760             WHEN SQLCODE = ZERO                                  04376000
043770             WHEN SQLCODE = +100                                  04377000
043780                  CONTINUE                                        04378000
043790             WHEN SQLCODE = -904                                  04379000
043800             WHEN SQLCODE = -911                                  04380000
043810             WHEN SQLCODE = -913                                  04381000
043820                  PERFORM 9900-SOFT-ABORT                         04382000
043830                                                                  04383000
043840             WHEN SQLWARN0 NOT = SPACES                           04384000
043850             WHEN SQLCODE  NOT = ZERO                             04385000
043860                  MOVE '4200-SUM-MATCHED-ITEMS'                   04386000
043870                                 TO DP013-PARAGRAPH               04387000
043880                  MOVE 'UNSUCCESSFUL SELECT OF PACK SLIP ITEMS'   04388000
043890                                 TO DP013-MESSAGE-TEXT (1)        04389000
043900                  MOVE ASC-KEY-PO-NBR                             04390000
043910                                 TO PV-MSG-KEY-PO                 04391000
043920                  MOVE ASC-KEY-REC-SEQ-NBR                        04392000
043930                                 TO PV-MSG-KEY-REC-SEQ-NBR-N      04393000
043940                  MOVE PV-MSG-KEYS                                04394000
043950                                 TO DP013-MESSAGE-TEXT (2)        04395000
043960                  MOVE SQLCA     TO DP013-SQLCA                   04396000
043970                  MOVE 'TPKITEM' TO DP013-DB2-TABLE-NAME (1)      04397000
043980                  SET DP013-DB2-ABEND                             04398000
043990                      DP013-XCTL-DISPLAY-RESTART                  04399000
044000                                 TO TRUE                          04400000
044010                                                                  04401000
044020                  PERFORM DP013-0000-PROCESS-ABEND                04402000
044030         END-EVALUATE.                                            04403000
044040                                                                  04404000
044050                                                                  04405000
044060******************************************************************04406000
044070*    SUM ALL PACK SLIP ITEM QUANTITIES FOR UNMATCHED ITEMS        04407000
044080******************************************************************04408000
044090                                                                  04409000
044100 4300-SUM-UNMATCHED-ITEMS.                                        04410000
044110                                                                  04411000
044120     MOVE ZEROES                 TO PV-UNMATCHED-ITEMS.           04412000
044130                                                                  04413000
044140         EXEC SQL                                                 04414000
044150               SELECT SUM (PKSL_ITM_QTY)                          04415000
044160                 INTO :PV-UNMATCHED-ITEMS :PV-UNMATCHED-IND       04416000
044170                 FROM TUNPKSL                                     04417000
044180                WHERE PO_NBR        = :DK-PO-NBR                  04418000
044190                  AND SEQ_NBR       = :PKSLIP-SEQ-NBR             04419000
044200                  AND VER_STAT_CDE  = 'A'                         04420000
044210         END-EXEC                                                 04421000
044220                                                                  04422000
044230         EVALUATE TRUE                                            04423000
044240             WHEN SQLCODE = ZERO                                  04424000
044250             WHEN SQLCODE = +100                                  04425000
044260                  CONTINUE                                        04426000
044270             WHEN SQLCODE = -904                                  04427000
044280             WHEN SQLCODE = -911                                  04428000
044290             WHEN SQLCODE = -913                                  04429000
044300                  PERFORM 9900-SOFT-ABORT                         04430000
044310                                                                  04431000
044320             WHEN SQLWARN0 NOT = SPACES                           04432000
044330             WHEN SQLCODE  NOT = ZERO                             04433000
044340                  MOVE '4300-SUM-UNMATCHED-ITEMS'                 04434000
044350                                 TO DP013-PARAGRAPH               04435000
044360                  MOVE 'UNSUCCESSFUL SELECT OF PACK SLIP ITEMS'   04436000
044370                                 TO DP013-MESSAGE-TEXT (1)        04437000
044380                  MOVE SQLCA     TO DP013-SQLCA                   04438000
044390                  MOVE 'TUNPKSL' TO DP013-DB2-TABLE-NAME (1)      04439000
044400                  SET DP013-DB2-ABEND                             04440000
044410                      DP013-XCTL-DISPLAY-RESTART                  04441000
044420                                 TO TRUE                          04442000
044430                                                                  04443000
044440                  PERFORM DP013-0000-PROCESS-ABEND                04444000
044450         END-EVALUATE.                                            04445000
044460                                                                  04446000
044470 4320-SUM-INPKSU-CARTONS.                                         04447000
044480                                                                  04448000
044490         MOVE ZEROES                 TO PV-INPKSU-CRTN-CNT.       04449000
044500                                                                  04450000
044510         EXEC SQL                                                 04451000
044520             SELECT COUNT(*)                                      04452000
044530               INTO :PV-INPKSU-CRTN-CNT                           04453000
044540               FROM TINPKSU                                       04454000
044550              WHERE PO_NBR        = :DK-PO-NBR                    04455000
044560                AND SEQ_NBR       = :PKSLIP-SEQ-NBR               04456000
044570         END-EXEC                                                 04457000
044580                                                                  04458000
044590         EVALUATE TRUE                                            04459000
044600             WHEN SQLCODE = ZERO                                  04460000
044610             WHEN SQLCODE = +100                                  04461000
044620                  CONTINUE                                        04462000
044630             WHEN SQLCODE = -904                                  04463000
044640             WHEN SQLCODE = -911                                  04464000
044650             WHEN SQLCODE = -913                                  04465000
044660                  PERFORM 9900-SOFT-ABORT                         04466000
044670                                                                  04467000
044680             WHEN SQLWARN0 NOT = SPACES                           04468000
044690             WHEN SQLCODE  NOT = ZERO                             04469000
044700                  MOVE '4320-SUM-INPKSU-CARTONS '                 04470000
044710                                 TO DP013-PARAGRAPH               04471000
044720                  MOVE 'UNSUCCESSFUL SELECT OF INPKSU CARTONS '   04472000
044730                                 TO DP013-MESSAGE-TEXT (1)        04473000
044740                  MOVE SQLCA     TO DP013-SQLCA                   04474000
044750                  MOVE 'TINPKSU' TO DP013-DB2-TABLE-NAME (1)      04475000
044760                  SET DP013-DB2-ABEND                             04476000
044770                      DP013-XCTL-DISPLAY-RESTART                  04477000
044780                                 TO TRUE                          04478000
044790                                                                  04479000
044800                  PERFORM DP013-0000-PROCESS-ABEND                04480000
044810         END-EVALUATE.                                            04481000
044820                                                                  04482000
044830                                                                  04483000
044840 4330-COUNT-PBS-ERRORS.                                           04484000
044850                                                                  04485000
044860         MOVE ZEROES                 TO PV-PBS-ERROR-COUNT.       04486000
044870         MOVE ZEROES                 TO PV-PO-PBS-ERROR.          04487006
044880                                                                  04488006
044890         EXEC SQL                                                 04489006
044900             SELECT A.PO_NBR                                      04490006
044910               INTO :PV-PO-PBS-ERROR                              04491006
044920               FROM TINPKSU A                                     04492006
044930                  , TSHUNLO B                                     04493006
044940              WHERE A.PO_NBR        = :DK-PO-NBR                  04494006
044950                AND SEQ_NBR         = :PKSLIP-SEQ-NBR             04495006
044960                AND A.SHIPT_UNT_ID = B.SHIPT_UNT_ID               04496006
044970                AND B.SCN_LOC_ID                                  04497006
044980                       IN ('PBSA','PBSB','PBSC','PBSD','PBSE')    04498006
044990              FETCH FIRST 1 ROW ONLY                              04499006
045000         END-EXEC                                                 04500006
045010                                                                  04501006
045020         EVALUATE TRUE                                            04502006
045030             WHEN SQLCODE = ZERO                                  04503006
045040             WHEN SQLCODE = -811                                  04504006
045050                  MOVE  1  TO  PV-PBS-ERROR-COUNT                 04505006
045060             WHEN SQLCODE = +100                                  04506006
045070                  MOVE  0  TO  PV-PBS-ERROR-COUNT                 04507006
045080             WHEN SQLCODE = -904                                  04508006
045090             WHEN SQLCODE = -911                                  04509006
045100             WHEN SQLCODE = -913                                  04510006
045110                  PERFORM 9900-SOFT-ABORT                         04511006
045120                                                                  04512006
045130             WHEN SQLWARN0 NOT = SPACES                           04513006
045140             WHEN SQLCODE  NOT = ZERO                             04514006
045150                  MOVE '4330-COUNT-PBS-ERRORS  '                  04515006
045160                                 TO DP013-PARAGRAPH               04516006
045170                  MOVE 'UNSUCCESSFUL SELECT OF PBS ERROR CRTNS'   04517006
045180                                 TO DP013-MESSAGE-TEXT (1)        04518006
045190                  MOVE SQLCA     TO DP013-SQLCA                   04519006
045200                  MOVE 'TINPKSU' TO DP013-DB2-TABLE-NAME (1)      04520006
045210                  MOVE 'TSHUNLO' TO DP013-DB2-TABLE-NAME (2)      04521006
045220                  SET DP013-DB2-ABEND                             04522006
045230                      DP013-XCTL-DISPLAY-RESTART                  04523006
045240                                 TO TRUE                          04524006
045250                                                                  04525006
045260                  PERFORM DP013-0000-PROCESS-ABEND                04526006
045270         END-EVALUATE.                                            04527006
045280                                                                  04528006
045290 4400-MOVE-COMMAREA-TO-SCREEN.                                    04529006
045300                                                                  04530006
045310     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1)) AND         04531006
045320           (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1))) OR         04532006
045330           (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))            04533006
045340             MOVE +1             TO ASC-BLK-SUB                   04534006
045350                                                                  04535006
045360             PERFORM 5100-WRITE-TEMP-STORAGE                      04536006
045370                                                                  04537006
045380             ADD +1              TO ASC-BLK-SUB                   04538006
045390                                                                  04539006
045400             PERFORM 5100-WRITE-TEMP-STORAGE                      04540006
045410                                                                  04541006
045420             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             04542006
045430                 GIVING PV-BLOCK-NUMBER                           04543006
045440                 REMAINDER PV-REMAINDER                           04544006
045450             IF PV-REMAINDER > ZERO                               04545006
045460                 ADD +1          TO PV-BLOCK-NUMBER               04546006
045470             END-IF                                               04547006
045480             MOVE +1             TO ASC-BLK-SUB                   04548006
045490                                                                  04549006
045500             PERFORM 4410-READ-TEMP-STORAGE                       04550006
045510                                                                  04551006
045520             ADD +1              TO ASC-BLK-SUB                   04552006
045530                                    PV-BLOCK-NUMBER               04553006
045540                                                                  04554006
045550             PERFORM 4410-READ-TEMP-STORAGE                       04555006
045560                                                                  04556006
045570     END-IF.                                                      04557006
045580                                                                  04558006
045590     MOVE +1                     TO ASC-BLK-SUB.                  04559006
045600     COMPUTE ASC-ITEM-SUB =                                       04560006
045610         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              04561006
045620                       + PC-ITEMS-PER-PANEL).                     04562006
045630                                                                  04563006
045640     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         04564006
045650         ADD +1                  TO ASC-BLK-SUB                   04565006
045660         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            04566006
045670     END-IF.                                                      04567006
045680                                                                  04568006
045690     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           04569006
045700         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                04570006
045710                                                                  04571006
045720     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        04572006
045730                                                                  04573006
045740     PERFORM 4420-FORMAT-LIST-LINES                               04574006
045750         VARYING PV-SUB  FROM PC-ITEMS-PER-PANEL BY -1            04575006
045760         UNTIL   PV-SUB < +1.                                     04576006
045770                                                                  04577006
045780     COMPUTE ASC-ITEMS-DISPLAYED =                                04578006
045790                   ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).04579006
045800     MOVE PV-TOP-ITEM            TO ASC-ITEM-AT-TOP-OF-PANEL      04580006
045810                                    ASTRTITO.                     04581006
045820     MOVE ASC-ITEM-AT-BOT-OF-PANEL                                04582006
045830                                 TO AENDITO.                      04583006
045840     MOVE ASC-NUMBER-OF-ITEMS-READ                                04584006
045850                                 TO ATOTITO.                      04585006
045860     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            04586006
045870                                 TO ASELITO.                      04587006
045880     MOVE ASC-CARTON-TOTAL       TO ATCARTO.                      04588006
045890     MOVE ASC-UNIT-TOTAL         TO ATUNITO.                      04589006
045900                                                                  04590006
045910     MOVE ASC-KEY-PO-NBR-N       TO APOO.                         04591006
045920     MOVE ASC-KEY-VENDOR-NAME    TO AVENDO.                       04592006
045930                                                                  04593006
045940     MOVE ASC-SPEC-INSTR         TO ASPINSTO                      04594006
045950     MOVE SPACES                 TO APKGTYPO                      04595006
045960     EVALUATE TRUE                                                04596006
045970         WHEN ASC-PACKAGE-TYPE-CDE = 'M'                          04597006
045980             MOVE PC-MULTIPLE-SKU-PPK                             04598006
045990                                 TO APKGTYPO                      04599006
046000         WHEN ASC-PACKAGE-TYPE-CDE = 'S'                          04600006
046010             MOVE PC-SINGLE-SKU-PPK                               04601006
046020                                 TO APKGTYPO                      04602006
046030         WHEN ASC-PACKAGE-TYPE-CDE = 'I'                          04603006
046040             MOVE PC-INNER-PPK   TO APKGTYPO                      04604006
046050         WHEN ASC-PACKAGE-TYPE-CDE = 'B'                          04605006
046060             MOVE PC-BULK-PPK    TO APKGTYPO                      04606006
046070         WHEN ASC-PACKAGE-TYPE-CDE = 'C'                          04607006
046080             MOVE PC-CASEPACK    TO APKGTYPO                      04608006
046090         WHEN ASC-PACKAGE-TYPE-CDE = 'X'                          04609006
046100             MOVE PC-PKG-NOT-FOUND                                04610006
046110                                 TO APKGTYPO                      04611006
046120     END-EVALUATE.                                                04612006
046130     IF PS-DISPLAY-UPC-MSG                                        04613006
046140         MOVE PC-UPC-MSG         TO AUPCMSGO                      04614006
046150         MOVE DP015-REVERSE      TO AUPCMSGH                      04615006
046160     ELSE                                                         04616006
046170         MOVE SPACES             TO AUPCMSGO                      04617006
046180         MOVE DP015-HL-OFF       TO AUPCMSGH                      04618006
046190     END-IF                                                       04619006
046200                                                                  04620006
046210     IF DP020-MSG-NUMBER-X = SPACE                                04621006
046220        IF ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ    04622006
046230            MOVE PC-TSYMSG-00279 TO DP020-MSG-NUMBER              04623006
046240            SET DP020-MSG-INFORMATIONAL                           04624006
046250                                 TO TRUE                          04625006
046260        END-IF                                                    04626006
046270     END-IF.                                                      04627006
046280                                                                  04628006
046290 4410-READ-TEMP-STORAGE.                                          04629006
046300                                                                  04630006
046310     EXEC CICS READQ TS                                           04631006
046320               QUEUE (ASC-LIST-QUEUE-NAME)                        04632006
046330               INTO  (ASC-BLOCK-ENTRIES (ASC-BLK-SUB))            04633006
046340               ITEM  (PV-BLOCK-NUMBER)                            04634006
046350               RESP  (PV-CICS-RESP)                               04635006
046360     END-EXEC.                                                    04636006
046370                                                                  04637006
046380     IF ((PV-CICS-RESP = DFHRESP (NORMAL)) OR                     04638006
046390         (PV-CICS-RESP = DFHRESP (ITEMERR)))                      04639006
046400         CONTINUE                                                 04640006
046410     ELSE                                                         04641006
046420         SET DP013-CICS-ABEND                                     04642006
046430             DP013-NO-ROLLBACK   TO TRUE                          04643006
046440         MOVE '4410-READ-TEMP-STORAGE'                            04644006
046450                                 TO DP013-PARAGRAPH               04645006
046460         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE READ'   04646006
046470                                 TO DP013-MESSAGE-TEXT (1)        04647006
046480                                                                  04648006
046490         PERFORM DP013-0000-PROCESS-ABEND                         04649006
046500     END-IF.                                                      04650006
046510                                                                  04651006
046520     SET ASC-BLOCK-NOT-MODIFIED (ASC-BLK-SUB)                     04652006
046530                                 TO TRUE.                         04653006
046540                                                                  04654006
046550     IF PV-CICS-RESP = DFHRESP (ITEMERR)                          04655006
046560         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               04656006
046570     END-IF.                                                      04657006
046580                                                                  04658006
046590 4420-FORMAT-LIST-LINES.                                          04659006
046600                                                                  04660006
046610     IF ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ       04661006
046620         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                04662006
046630         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA       (PV-SUB)     04663006
046640         MOVE DP015-HL-OFF       TO MR-SELECTH       (PV-SUB)     04664006
046650                                    MR-PACK-SLIP-H   (PV-SUB)     04665006
046660         MOVE SPACE              TO MR-SELECTI       (PV-SUB)     04666006
046670                                    MR-STATUS        (PV-SUB)     04667006
046680                                    MR-RCVR-SEQ-NBR  (PV-SUB)     04668006
046690                                    MR-STR-DEST-NBR  (PV-SUB)     04669006
046700                                    MR-PRO-NBR       (PV-SUB)     04670006
046710                                    MR-BOL-NBR       (PV-SUB)     04671006
046720                                    MR-CARTONS       (PV-SUB)     04672006
046730                                    MR-OP            (PV-SUB)     04673006
046740                                    MR-UNITS         (PV-SUB)     04674006
046750                                    MR-PACK-SLIP     (PV-SUB)     04675006
046760                                    MR-INPKSU-CNT    (PV-SUB)     04676006
046770     ELSE                                                         04677006
046780         IF ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) >     04678006
046790                                                             SPACE04679006
046800             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 04680006
046810                                 TO MR-SELECTI (PV-SUB)           04681006
046820         ELSE                                                     04682006
046830             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      04683006
046840                                 TO MR-SELECTI (PV-SUB)           04684006
046850         END-IF                                                   04685006
046860                                                                  04686006
046870         IF DP030-SET-CURSOR-TRAILER                              04687006
046880            IF ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) >  04688006
046890                                                             SPACE04689006
046900               OR PV-SUB = 1                                      04690006
046910                SET DP030-SET-CURSOR-APPL-1                       04691006
046920                                 TO TRUE                          04692006
046930                MOVE -1          TO MR-SELECTL (PV-SUB)           04693006
046940            END-IF                                                04694006
046950         END-IF                                                   04695006
046960                                                                  04696006
046970             MOVE ASC-REC-SEQ-NBR    (ASC-BLK-SUB ASC-ITEM-SUB)   04697006
046980                                 TO MR-RCVR-SEQ-NBR    (PV-SUB)   04698006
046990             MOVE ASC-PKSL-STAT-CDE  (ASC-BLK-SUB ASC-ITEM-SUB)   04699006
047000                                 TO MR-STATUS          (PV-SUB)   04700006
047010             MOVE ASC-STR-DEST-NBR   (ASC-BLK-SUB ASC-ITEM-SUB)   04701006
047020                                 TO MR-STR-DEST-NBR    (PV-SUB)   04702006
047030             MOVE ASC-PRO-NBR        (ASC-BLK-SUB ASC-ITEM-SUB)   04703006
047040                                 TO MR-PRO-NBR         (PV-SUB)   04704006
047050             MOVE ASC-BOL-NBR        (ASC-BLK-SUB ASC-ITEM-SUB)   04705006
047060                                 TO MR-BOL-NBR         (PV-SUB)   04706006
047070             MOVE ASC-CARTON-COUNT   (ASC-BLK-SUB ASC-ITEM-SUB)   04707006
047080                                 TO MR-CARTONS-EDITED  (PV-SUB)   04708006
047090             MOVE ASC-OPER-UNT-ID    (ASC-BLK-SUB ASC-ITEM-SUB)   04709006
047100                                 TO MR-OP              (PV-SUB)   04710006
047110             MOVE ASC-PKSL-ITM-QTY-N (ASC-BLK-SUB ASC-ITEM-SUB)   04711006
047120                                 TO MR-UNITS-EDITED    (PV-SUB)   04712006
047130             MOVE ASC-PKSL-NBR       (ASC-BLK-SUB ASC-ITEM-SUB)   04713006
047140                                 TO MR-PACK-SLIP       (PV-SUB)   04714006
047150             MOVE ASC-INPKSU-COUNT   (ASC-BLK-SUB ASC-ITEM-SUB)   04715006
047160                                 TO MR-INPKSU-CNT-EDITED (PV-SUB) 04716006
047170         IF ASC-UPC-PROBLEM          (ASC-BLK-SUB ASC-ITEM-SUB)   04717006
047180             SET PS-DISPLAY-UPC-MSG                               04718006
047190                                 TO TRUE                          04719006
047200             MOVE DP015-YELLOW   TO MR-PACK-SLIP-C     (PV-SUB)   04720006
047210             MOVE DP015-REVERSE  TO MR-PACK-SLIP-H     (PV-SUB)   04721006
047220         ELSE                                                     04722006
047230             MOVE DP015-BLUE     TO MR-PACK-SLIP-C     (PV-SUB)   04723006
047240             MOVE DP015-HL-OFF   TO MR-PACK-SLIP-H     (PV-SUB)   04724006
047250         END-IF                                                   04725006
047260         IF ASC-PBS-ERRORS-FOUND     (ASC-BLK-SUB ASC-ITEM-SUB)   04726006
047270             MOVE DP015-RED      TO MR-STR-DEST-NBR-C  (PV-SUB)   04727006
047280*            MOVE DP015-REVERSE  TO MR-STR-DEST-NBR-H  (PV-SUB)   04728006
047290         ELSE                                                     04729006
047300             MOVE DP015-BLUE     TO MR-STR-DEST-NBR-C  (PV-SUB)   04730006
047310             MOVE DP015-HL-OFF   TO MR-STR-DEST-NBR-H  (PV-SUB)   04731006
047320         END-IF                                                   04732006
047330     END-IF.                                                      04733006
047340                                                                  04734006
047350     SUBTRACT +1 FROM ASC-ITEM-SUB.                               04735006
047360                                                                  04736006
047370     IF ASC-ITEM-SUB < +1                                         04737006
047380         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  04738006
047390         MOVE +1                 TO ASC-BLK-SUB.                  04739006
047400                                                                  04740006
047410 4430-CHECK-FOR-BEGIN-AND-END.                                    04741006
047420                                                                  04742006
047430     IF ASC-START-OF-SELECTED-RANGE > ZERO                        04743006
047440        IF ASC-END-OF-SELECTED-RANGE = ZERO                       04744006
047450            MOVE PC-TSYMSG-00051 TO DP020-MSG-NUMBER              04745006
047460            SET DP020-MSG-WARNING                                 04746006
047470                                 TO TRUE                          04747006
047480                                                                  04748006
047490            PERFORM 4431-POSITION-AT-WARNING                      04749006
047500                                                                  04750006
047510         END-IF                                                   04751006
047520     ELSE                                                         04752006
047530         IF ASC-END-OF-SELECTED-RANGE > ZERO                      04753006
047540             MOVE PC-TSYMSG-00053                                 04754006
047550                                 TO DP020-MSG-NUMBER              04755006
047560             SET DP020-MSG-WARNING                                04756006
047570                                 TO TRUE                          04757006
047580                                                                  04758006
047590             PERFORM 4431-POSITION-AT-WARNING                     04759006
047600                                                                  04760006
047610         END-IF                                                   04761006
047620     END-IF.                                                      04762006
047630                                                                  04763006
047640 4431-POSITION-AT-WARNING.                                        04764006
047650                                                                  04765006
047660     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE -               04766006
047670                                                  PV-TOP-ITEM + 1.04767006
047680     IF PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                       04768006
047690         CONTINUE                                                 04769006
047700     ELSE                                                         04770006
047710         SET DP030-SET-CURSOR-APPL-1                              04771006
047720                                 TO TRUE                          04772006
047730         MOVE -1                 TO MR-SELECTL (PV-SUB)           04773006
047740         MOVE DP015-YELLOW       TO MR-SELECTC (PV-SUB)           04774006
047750         MOVE DP015-REVERSE      TO MR-SELECTH (PV-SUB)           04775006
047760     END-IF.                                                      04776006
047770                                                                  04777006
047780     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE - PV-TOP-ITEM + 1.04778006
047790                                                                  04779006
047800     IF PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                       04780006
047810         CONTINUE                                                 04781006
047820     ELSE                                                         04782006
047830         SET DP030-SET-CURSOR-APPL-1                              04783006
047840                                 TO TRUE                          04784006
047850         MOVE -1                 TO MR-SELECTL (PV-SUB)           04785006
047860         MOVE DP015-YELLOW       TO MR-SELECTC (PV-SUB)           04786006
047870         MOVE DP015-REVERSE      TO MR-SELECTH (PV-SUB)           04787006
047880     END-IF.                                                      04788006
047890                                                                  04789006
047900/                                                                 04790006
047910 5000-PREPARE-SEL-QUEUE.                                          04791006
047920                                                                  04792006
047930     MOVE +1                     TO ASC-BLK-SUB.                  04793006
047940                                                                  04794006
047950     PERFORM 5100-WRITE-TEMP-STORAGE.                             04795006
047960                                                                  04796006
047970     ADD +1                      TO ASC-BLK-SUB.                  04797006
047980                                                                  04798006
047990     PERFORM 5100-WRITE-TEMP-STORAGE.                             04799006
048000                                                                  04800006
048010     MOVE ASC-SEL-QUEUE-NAME-OUT TO RC015-SEL-QUEUE-NAME.         04801006
048020                                                                  04802006
048030     PERFORM 6010-DELETE-SEL-QUEUE.                               04803006
048040                                                                  04804006
048050     SET RC013-IDX               TO 1.                            04805006
048060     MOVE ZERO                   TO RC015-NUMBER-OF-TS-ITEMS.     04806006
048070     INITIALIZE RC013-SELECTED-ITEM-ARRAY.                        04807006
048080                                                                  04808006
048090     EVALUATE TRUE                                                04809006
048100         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              04810006
048110*  ADD TO RECEIVER FUNCTION                                       04811006
048120             MOVE ASC-NUMBER-OF-SELECTED-ITEMS TO                 04812006
048130                 PV-NUMBER-OF-SELECTED-ITEM                       04813006
048140             MOVE ASC-KEY-PO-NBR-N                                04814006
048150                                 TO DK-PO-NBR                     04815006
048160             INITIALIZE PST-PKSL-STORE-TABLE                      04816006
048170             PERFORM 5300-SEARCH-FOR-SELECTION                    04817006
048180                 VARYING PV-ITEM  FROM 1 BY 1                     04818006
048190                 UNTIL   PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN      04819006
048200             IF PS-ERROR                                          04820006
048210                 SET DP020-MSG-WARNING                            04821006
048220                                 TO TRUE                          04822006
048230             ELSE                                                 04823006
048240                 PERFORM 5050-CHECK-FOR-VERIFIED                  04824006
048250                 IF  RECEIV-STATUS-CDE EQUAL 'VE'                 04825006
048260                     MOVE PC-TSYMSG-00734                         04826006
048270                                       TO  DP020-MSG-NUMBER       04827006
048280                     SET DP020-MSG-FATAL                          04828006
048290                         PS-ERROR      TO  TRUE                   04829006
048300* ADDED LOGIC TO STOP THEM FROM ADDING TO RECEIVER IF A           04830006
048310* CASEPACK SPLIT EXISTS - STEPH 08/10/99                          04831006
048320                 ELSE                                             04832006
048330                     PERFORM 5078-CHECK-FOR-TDISTHD               04833006
048340                     IF PV-DB2-COUNT GREATER THAN 0               04834006
048350                         MOVE ZEROES TO PV-DB2-COUNT              04835006
048360                         SET PS-ERROR                             04836006
048370                             DP020-MSG-FATAL TO TRUE              04837006
048380                         MOVE PC-TSYMSG-02066 TO                  04838006
048390                                 DP020-MSG-NUMBER                 04839006
048400* END - STEPH                                                     04840006
048410                      ELSE                                        04841006
048420                         PERFORM 5011-CONTINUE-FUNC-01            04842006
048421                                                                  04842154
048423                         MOVE '0Q' TO  RCT00017-DC-FUNC-CDE       04842354
048425                         PERFORM 5800-INSERT-PO-TRACK             04842554
048430                                                                  04843006
048440                     END-IF                                       04844006
048450                 END-IF                                           04845006
048460             END-IF                                               04846006
048470                                                                  04847006
048480         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              04848006
048490*  INACTIVATE PACKSLIPS                                           04849006
048500             MOVE ASC-NUMBER-OF-SELECTED-ITEMS TO                 04850006
048510                 PV-NUMBER-OF-SELECTED-ITEM                       04851006
048520             MOVE ASC-KEY-PO-NBR-N                                04852006
048530                                 TO DK-PO-NBR                     04853006
048540             PERFORM 5400-CHECK-ALL-SEL-ACTIVE                    04854006
048550                 VARYING PV-ITEM  FROM 1 BY 1                     04855006
048560                 UNTIL   PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN      04856006
048570                                                                  04857006
048580                                                                  04858006
048590                 IF PS-ERROR                                      04859006
048600*                       BYPASS ALL SELECTIONS IF ANY HAVE         04860006
048610*                       SMOOTHED CARTONS                          04861006
048620                     IF PV-TOT-SMOOTH-COUNT > ZERO                04862006
048630                         SET DP020-MSG-FATAL                      04863006
048640                             ASC-INACTIVATE-NOT-PENDING TO TRUE   04864006
048650                         MOVE PC-TSYMSG-02746 TO DP020-MSG-NUMBER 04865006
048660                     END-IF                                       04866006
048670                     IF  DP020-MSG-NUMBER EQUAL SPACES            04867006
048680                     AND DP020-SRC-AID NOT EQUAL DP016-PF20       04868006
048690                         SET DP020-MSG-WARNING                    04869006
048700                                 TO TRUE                          04870006
048710                         MOVE PC-TSYMSG-01874                     04871006
048720                                 TO DP020-MSG-NUMBER              04872006
048730                     END-IF                                       04873006
048740                     IF PV-BULK-STR-CNT > 0 AND                   04874006
048750                        PV-PACK-BY-STR-CNT > 0                    04875006
048760                         MOVE PC-TSYMSG-00816                     04876006
048770                                 TO DP020-MSG-NUMBER              04877006
048780                         SET PS-ERROR                             04878006
048790                                 TO TRUE                          04879006
048800                         SET DP020-MSG-WARNING                    04880006
048810                                 TO TRUE                          04881006
048820                     END-IF                                       04882006
048830                 ELSE                                             04883006
048840                     IF PV-BULK-STR-CNT > 0 AND                   04884006
048850                        PV-PACK-BY-STR-CNT > 0                    04885006
048860                         MOVE PC-TSYMSG-00816                     04886006
048870                                 TO DP020-MSG-NUMBER              04887006
048880                         SET PS-ERROR                             04888006
048890                                 TO TRUE                          04889006
048900                         SET DP020-MSG-WARNING                    04890006
048910                                 TO TRUE                          04891006
048920                     ELSE                                         04892006
048930                       PERFORM 2400-WMS-PROCESS                   04893006
048940                       IF PS-ASNS-TO-WMS-YES                      04894006
048950                           PERFORM 2700-SELECT-TVHTRIP            04895006
048960                       END-IF                                     04896006
048970                       IF PS-INACTIVATE-NO                        04897006
048980                            SET ASC-NO-TSQ-UPDATE                 04898006
048990                                    TO TRUE                       04899006
049000                            SET DP030-OVERRIDE-GO                 04900006
049010                              DP020-MSG-WARNING                   04901006
049020                                    TO TRUE                       04902006
049030                            MOVE PC-TSYMSG-03537                  04903006
049040                                   TO DP020-MSG-NUMBER            04904006
049050                       ELSE                                       04905006
049060                         PERFORM 5420-FIND-SELECTION-TO-INACT     04906006
049070                             VARYING PV-ITEM  FROM 1 BY 1         04907006
049080                             UNTIL   PV-ITEM >                    04908006
049090                                     ASC-HIGHEST-BLOCK-WRITTEN    04909006
049100                         IF  NOT PS-ERROR                         04910006
049110                             PERFORM 5050-CHECK-FOR-VERIFIED      04911006
049120                             IF  RECEIV-STATUS-CDE EQUAL 'CM'     04912006
049130                                 PERFORM 8200-AUDIT-RECEIV        04913006
049140                                 PERFORM 5070-UPDATE-TRECEIV      04914006
049150                             END-IF                               04915006
049160*  COMMENTED OUT 11/30       PERFORM 7995-DELETE-PO-TROUBLE       04916006
049170*  WHEN WE GET THE OK TO FIX THE TROUBLE WHOLE, THEN COMMENT OUT T04917006
049180*  PERFORM OF 7995 ABOVE                                          04918006
049190* JAK 06/2007 SET MSG DEPENDENT ON ASN TO WMS STATUS              04919006
049200***                          MOVE PC-TSYMSG-00059                 04920006
049210***                              TO DP020-MSG-NUMBER              04921006
049220                             IF PS-ASNS-TO-WMS-YES                04922006
049230                             AND PS-VALID-TRIP                    04923006
049240                                 MOVE PC-TSYMSG-03575             04924006
049250                                     TO DP020-MSG-NUMBER          04925006
049260                             ELSE                                 04926006
049270                                 MOVE PC-TSYMSG-00059             04927006
049280                                     TO DP020-MSG-NUMBER          04928006
049290                             END-IF                               04929006
049300                         END-IF                                   04930006
049310                       END-IF                                     04931006
049320                         PERFORM 7300-CREATE-RECITM               04932006
049321                                                                  04932154
049322                         MOVE '0P' TO  RCT00017-DC-FUNC-CDE       04932254
049324                         PERFORM 5800-INSERT-PO-TRACK             04932454
049325                                                                  04932554
049330                                                                  04933006
049340                         IF PS-ASNS-TO-WMS-YES                    04934006
049350                         AND PS-VALID-TRIP                        04935006
049360                            SET WS001-PKSLIP-INACTIVE TO TRUE     04936006
049370                            SET PS-LOAD-LNE-NBR-NO    TO TRUE     04937006
049380                            PERFORM 2800-CALL-WMS-MODULE          04938000
049390                         END-IF                                   04939000
049400                                                                  04940000
049410                         IF  NOT PS-ERROR                         04941000
049420                             PERFORM 2050-DELETE-LIST-QUEUE       04942000
049430                             PERFORM 4000-BUILD-INITIAL-PANEL     04943000
049440                         END-IF                                   04944000
049450                     END-IF                                       04945000
049460                 END-IF                                           04946000
049470                                                                  04947000
049480*                IF ASC-INACTIVATE-PENDING                        04948000
049490*                    CONTINUE                                     04949000
049500*                ELSE                                             04950000
049510*                    PERFORM 5015-SCREEN-CLEANUP                  04951000
049520*                END-IF                                           04952000
049530                                                                  04953000
049540*     TRANSCRIPTION FUNCTION                                      04954000
049550                                                                  04955000
049560         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              04956000
049570             MOVE ASC-NUMBER-OF-SELECTED-ITEMS TO                 04957000
049580                 PV-NUMBER-OF-SELECTED-ITEM                       04958000
049590             MOVE ASC-KEY-PO-NBR-N                                04959000
049600                                 TO DK-PO-NBR                     04960000
049610             INITIALIZE PST-PKSL-STORE-TABLE                      04961000
049620             PERFORM 5300-SEARCH-FOR-SELECTION                    04962000
049630                 VARYING PV-ITEM  FROM 1 BY 1                     04963000
049640                 UNTIL   PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN      04964000
049650                                                                  04965000
049660             IF ASC-AUTO-VE                                       04966000
049670                PERFORM 5084-CHECK-TROUBLE                        04967000
049680                IF PS-TROUBLE-FOUND                               04968000
049690                   MOVE PC-TSYMSG-03226  TO DP020-MSG-NUMBER      04969000
049700                   SET PS-ERROR                                   04970000
049710                       PS-ERROR-MSG      TO TRUE                  04971000
049720                   SET DP020-MSG-FATAL   TO TRUE                  04972000
049730                END-IF                                            04973000
049740             END-IF                                               04974000
049750                                                                  04975000
049760             IF PS-ERROR                                          04976000
049770                 SET DP020-MSG-WARNING                            04977000
049780                                 TO TRUE                          04978000
049790             ELSE                                                 04979000
049800* CAN'T COMBINE BULK AND PACK-BY-STORE PACKSLIPS                  04980000
049810                 IF PV-BULK-STR-CNT > 0 AND                       04981000
049820                    PV-PACK-BY-STR-CNT > 0                        04982000
049830                     MOVE PC-TSYMSG-00816                         04983000
049840                                 TO DP020-MSG-NUMBER              04984000
049850                     SET PS-ERROR                                 04985000
049860                                 TO TRUE                          04986000
049870                     SET DP020-MSG-WARNING                        04987000
049880                                 TO TRUE                          04988000
049890                 ELSE                                             04989000
049900                     PERFORM 5050-CHECK-FOR-VERIFIED              04990000
049910                     IF  RECEIV-STATUS-CDE EQUAL 'VE'             04991000
049920                         MOVE PC-TSYMSG-00734                     04992000
049930                                       TO  DP020-MSG-NUMBER       04993000
049940                         SET DP020-MSG-FATAL                      04994000
049950                             PS-ERROR  TO  TRUE                   04995000
049960                     ELSE                                         04996000
049970                         PERFORM 5013-CONTINUE-FUNC-03            04997000
049980                     END-IF                                       04998000
049990                 END-IF                                           04999000
050000             END-IF                                               05000000
050010                                                                  05001000
050020         WHEN DP020-FK-LOCAL-FUNC-04(DP020-SRC-AID)               05002000
050030* TRANSFER TO RCKCS266, PRE-RECEIVER ADD.                         05003000
050040         WHEN DP020-FK-LOCAL-FUNC-06(DP020-SRC-AID)               05004000
050050* TRANSFER TO RCKCS800, RECEIVER PACK LIST                        05005000
050060             MOVE ASC-NUMBER-OF-SELECTED-ITEMS TO                 05006000
050070                 PV-NUMBER-OF-SELECTED-ITEM                       05007000
050080             SET PS-MATCH        TO TRUE                          05008000
050090             INITIALIZE PV-SAVE-FIELDS                            05009000
050100             PERFORM 5200-FILL-SEL-QUEUE-RECORD                   05010000
050110                 VARYING PV-ITEM  FROM 1 BY 1                     05011000
050120                 UNTIL   PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN      05012000
050130                                                                  05013000
050140         WHEN OTHER                                               05014000
050150             SET PS-MATCH        TO TRUE                          05015000
050160             INITIALIZE PV-SAVE-FIELDS                            05016000
050170             PERFORM 5200-FILL-SEL-QUEUE-RECORD                   05017000
050180                 VARYING PV-ITEM  FROM 1 BY 1                     05018000
050190                 UNTIL   PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN      05019000
050200             SET ASC-UPDATE-TSQ  TO TRUE                          05020000
050210             IF PS-NO-MATCH                                       05021000
050220                 MOVE PC-TSYMSG-01047                             05022000
050230                                         TO  DP020-MSG-NUMBER     05023000
050240                 SET PS-ERROR            TO  TRUE                 05024000
050250                 SET DP020-MSG-FATAL     TO  TRUE                 05025000
050260                 SET PS-ERROR-MSG        TO  TRUE                 05026000
050270             END-IF                                               05027000
050280     END-EVALUATE.                                                05028000
050290                                                                  05029000
050300     IF RC013-IDX > 1                                             05030000
050310         PERFORM 5205-WRITE-SEL-QUEUE                             05031000
050320         ADD +1              TO RC015-NUMBER-OF-TS-ITEMS          05032000
050330     END-IF.                                                      05033000
050340/                                                                 05034000
050350 5011-CONTINUE-FUNC-01.                                           05035000
050360                                                                  05036000
050370     SET PS-FIRST-SELECTED TO TRUE.                               05037000
050380     PERFORM 5020-CHECK-FOR-DUPLICATES                            05038000
050390         VARYING PV-ITEM  FROM 1 BY 1                             05039000
050400         UNTIL   PV-ITEM >  ASC-HIGHEST-BLOCK-WRITTEN             05040000
050410         OR PS-DIFFERENT-PACKSLIPS                                05041000
050420         OR PS-DUPLICATE-STORE.                                   05042000
050430     IF PS-DIFFERENT-PACKSLIPS OR                                 05043000
050440        PS-DUPLICATE-STORE                                        05044000
050450         CONTINUE                                                 05045000
050460     ELSE                                                         05046000
050470         PERFORM 5500-CHECK-PKSLIP-ACTIVE                         05047000
050480         IF PV-COUNT-NOT-ACTIVE-PKSLIP = ZERO                     05048000
050490             PERFORM 5320-FIND-SELECTION-TO-UPDATE                05049000
050500                 VARYING PV-ITEM  FROM 1 BY 1                     05050000
050510                 UNTIL PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN        05051000
050520                                                                  05052000
050530             IF ASC-TRECEIV-PKGNG-CDE = 'M' OR 'I'                05053000
050540                 SET PWT-STAGE-IDX    TO 1                        05054000
050550                 MOVE PWT-STG-PREPK-ID (PWT-STAGE-IDX)            05055000
050560                                      TO PV-PREV-PO-PREPK-ID      05056000
050570                                         DK-PREPK-ID              05057000
050580                 PERFORM 7002-PROCESS-PREPACKS                    05058000
050590                         UNTIL PWT-STG-PREPK-ID (PWT-STAGE-IDX)   05059000
050600                                        = ZERO                    05060000
050610             END-IF                                               05061000
050620                                                                  05062000
050630             PERFORM 7300-CREATE-RECITM                           05063000
050640                                                                  05064000
050650             IF ASC-TRECEIV-PKGNG-CDE = 'M' OR 'I'                05065000
050660                            AND PS-BULK-SHIPMENT                  05066000
050670                 INITIALIZE TM500-FIELDS                          05067000
050680                 SET TM500-PACK-LEVEL                             05068000
050690                     TM500-CREATE-AUTO                            05069000
050700                     TM500-REDISTRO-NO                            05070000
050710                     TM500-CREATE-DC-BAD-PACK                     05071000
050720                     TM500-NO-DETAILS TO TRUE                     05072000
050730                                                                  05073000
050740                 PERFORM 7410-PREPACK-TROUBLE                     05074000
050750                       VARYING PWT-M-IDX FROM 1 BY 1              05075000
050760                       UNTIL PWT-PKSL-M-LNE-NBR (PWT-M-IDX)       05076000
050770                                      = ZERO                      05077000
050780                       OR PS-ERROR                                05078000
050790             END-IF                                               05079000
050800                                                                  05080000
050810                                                                  05081000
050820             IF PS-NO-ERROR                                       05082000
050830                 PERFORM 5330-UPDATE-SELECTED-PACKSLIPS           05083000
050840                     VARYING PV-ITEM  FROM 1 BY 1                 05084000
050850                     UNTIL   PV-ITEM >  ASC-HIGHEST-BLOCK-WRITTEN 05085000
050860                                                                  05086000
050870                 IF PS-NO-ERROR                                   05087000
050880* JAK 06/2007 - ADD WMS SPECIFIC MESSAGE                          05088000
050890****                 MOVE PC-TSYMSG-00059 TO DP020-MSG-NUMBER     05089000
050900                     IF PS-ASNS-TO-WMS-YES                        05090000
050910                     AND PS-VALID-TRIP                            05091000
050920                         MOVE PC-TSYMSG-03575 TO                  05092000
050930                                             DP020-MSG-NUMBER     05093000
050940                     ELSE                                         05094000
050950                         MOVE PC-TSYMSG-00059 TO                  05095000
050960                                             DP020-MSG-NUMBER     05096000
050970                     END-IF                                       05097000
050980                 END-IF                                           05098000
050990             END-IF                                               05099000
050991                                                                  05099155
050992*----------------------------------------------------------------*05099255
050993*  PERFORM CHECKS FOR MIXEDSKU PACKSLIPS - TROUBLE NEEDS TO BE   *05099355
050994*  CREATED                                                       *05099455
050995*  ADDED 6/29/2023 - DMH                                         *05099555
050996*----------------------------------------------------------------*05099655
050997             IF PS-NO-ERROR                                       05099755
050998                 PERFORM 2460-SELECT-TRECEIV                      05099857
050999                 PERFORM 5700-CHECK-MIXEDSKU-PKSLIP               05099955
051000             END-IF                                               05100055
051001*----------------------------------------------------------------*05100155
051002                                                                  05100255
051003                                                                  05100300
051010             PERFORM 2050-DELETE-LIST-QUEUE                       05101000
051020             PERFORM 4000-BUILD-INITIAL-PANEL                     05102000
051030         ELSE                                                     05103000
051040             IF DP020-SRC-AID NOT EQUAL DP016-PF20                05104000
051050             MOVE PC-TSYMSG-00723    TO DP020-MSG-NUMBER          05105000
051060             SET DP020-MSG-WARNING                                05106000
051070                 PS-ERROR            TO TRUE                      05107000
051080             END-IF                                               05108000
051090         END-IF                                                   05109000
051100                                                                  05110000
051110         PERFORM 5015-SCREEN-CLEANUP                              05111000
051120     END-IF.                                                      05112000
051130/                                                                 05113000
051140 5013-CONTINUE-FUNC-03.                                           05114000
051150                                                                  05115000
051160     SET PS-FIRST-SELECTED TO TRUE                                05116000
051170     PERFORM 5020-CHECK-FOR-DUPLICATES                            05117000
051180         VARYING PV-ITEM  FROM 1 BY 1                             05118000
051190         UNTIL   PV-ITEM >  ASC-HIGHEST-BLOCK-WRITTEN             05119000
051200         OR PS-DIFFERENT-PACKSLIPS                                05120000
051210         OR PS-DUPLICATE-STORE.                                   05121000
051220     IF PS-DIFFERENT-PACKSLIPS OR                                 05122000
051230        PS-DUPLICATE-STORE                                        05123000
051240         CONTINUE                                                 05124000
051250     ELSE                                                         05125000
051260         PERFORM 5510-CHECK-PKSLIP-INACTIVE                       05126000
051270         IF PV-COUNT-NOT-INACTIVE-PKSLIP = 0                      05127000
051280             INITIALIZE PWT-PGM-WORK-TABLES                       05128000
051290                        PWT-PACK-STAGING-TABLE                    05129000
051300                                                                  05130000
051310* RECDIS ROWS ARE WRITTEN HERE                                    05131000
051320             PERFORM 5320-FIND-SELECTION-TO-UPDATE                05132000
051330                     VARYING PV-ITEM  FROM 1 BY 1                 05133000
051340                     UNTIL   PV-ITEM >  ASC-HIGHEST-BLOCK-WRITTEN 05134000
051350                                                                  05135000
051360                 IF ASC-TRECEIV-PKGNG-CDE = 'M' OR 'I'            05136000
051370                                                                  05137000
051380                     SET PWT-STAGE-IDX                            05138000
051390                                      TO 1                        05139000
051400                     MOVE PWT-STG-PREPK-ID (PWT-STAGE-IDX)        05140000
051410                                      TO PV-PREV-PO-PREPK-ID      05141000
051420                                         DK-PREPK-ID              05142000
051430                     PERFORM 7002-PROCESS-PREPACKS                05143000
051440                         UNTIL PWT-STG-PREPK-ID (PWT-STAGE-IDX)   05144000
051450                                        = ZERO                    05145000
051460                 END-IF                                           05146000
051470                                                                  05147000
051480* RECITM ROWS GET WRITTEN HERE                                    05148000
051490             PERFORM 7300-CREATE-RECITM                           05149000
051500             IF ASC-TRECEIV-PKGNG-CDE = 'M' OR 'I'                05150000
051510                            AND PS-BULK-SHIPMENT                  05151000
051520                 INITIALIZE TM500-FIELDS                          05152000
051530                 SET TM500-PACK-LEVEL                             05153000
051540                     TM500-CREATE-AUTO                            05154000
051550                     TM500-REDISTRO-NO                            05155000
051560                     TM500-CREATE-DC-BAD-PACK                     05156000
051570                     TM500-NO-DETAILS TO TRUE                     05157000
051580                                                                  05158000
051590                 PERFORM 7410-PREPACK-TROUBLE                     05159000
051600                       VARYING PWT-M-IDX FROM 1 BY 1              05160000
051610                       UNTIL PWT-PKSL-M-LNE-NBR (PWT-M-IDX)       05161000
051620                                      = ZERO                      05162000
051630                       OR PS-ERROR                                05163000
051640             END-IF                                               05164000
051650                                                                  05165000
051660             IF PS-NO-ERROR                                       05166000
051670                 PERFORM 5330-UPDATE-SELECTED-PACKSLIPS           05167000
051680                     VARYING PV-ITEM  FROM 1 BY 1                 05168000
051690                     UNTIL   PV-ITEM >  ASC-HIGHEST-BLOCK-WRITTEN 05169000
051700                                                                  05170000
051710* IF THE RECEIVER IS FLAGGED AS 'PACK-BY-STORE' AND ITS           05171000
051720* OPER UNIT IS A DC, CHECK THE PO AGREEMENTS TABLE.  IF THE       05172000
051730* PO IS ALSO 'PACK-BY-STORE', THEN TAKE A SYNCPOINT AND LINK      05173000
051740* TO THE PACK-BY-STORE EDITING MODULE (TMKCS508).                 05174000
051750                                                                  05175000
051760                 IF ASC-PACK-BY-ST-IND = 'Y'                      05176000
051770                            AND ASC-STORE-TYPE-CODE = 'DC'        05177000
051780                     PERFORM 9902-SYNCPOINT                       05178000
051790                     PERFORM 5322-STORE-OVERAGES                  05179000
051800                 END-IF                                           05180000
051810             END-IF                                               05181000
051830                                                                  05183027
051831         PERFORM 2460-SELECT-TRECEIV                              05183100
051832                                                                  05183246
051833*----------------------------------------------------------------*05183346
051834*  PERFORM CHECKS FOR MIXEDSKU PACKSLIPS - TROUBLE NEEDS TO BE   *05183446
051835*  CREATED                                                       *05183546
051836*  ADDED 6/29/2023 - DMH                                         *05183646
051837*----------------------------------------------------------------*05183746
051838         PERFORM 5700-CHECK-MIXEDSKU-PKSLIP                       05183846
051839                                                                  05183946
051840*----------------------------------------------------------------*05184046
051841                                                                  05184146
051842         PERFORM 2450-CHECK-TKRPRPM                               05184200
051850         IF PS-ASNS-TO-WMS-YES                                    05185000
051860            PERFORM 2500-GET-SHIPMENT-INFO                        05186000
051870            PERFORM 2700-SELECT-TVHTRIP                           05187000
051880            IF PS-VALID-TRIP                                      05188000
051890* JAK 04/2007 - ADD CALL TO 2750 AND CHECK FOR TROUBLE            05189000
051900* JAK 06/2007 - REMOVE CHECK OF TRECDIS                           05190000
051910***             PERFORM 2750-SELECT-TRECDIS                       05191000
051920***             IF PS-DISTRO-TROUBLE-NO                           05192000
051930                    SET WS001-INSERT  TO TRUE                     05193000
051940                    SET PS-LOAD-LNE-NBR-NO    TO TRUE             05194000
051950                    PERFORM 2800-CALL-WMS-MODULE                  05195000
051960***             END-IF                                            05196000
051970            END-IF                                                05197000
051980         END-IF                                                   05198000
051990                                                                  05199000
052000                                                                  05200000
052010             PERFORM 2050-DELETE-LIST-QUEUE                       05201000
052020             PERFORM 4000-BUILD-INITIAL-PANEL                     05202000
052030             IF PS-NO-ERROR-MSG                                   05203000
052040                 IF ASC-TRECEIV-PKGNG-CDE = 'M' OR 'I'            05204000
052050                     SET DP020-MSG-INFORMATIONAL                  05205000
052060                                         TO  TRUE                 05206000
052070                     MOVE ASC-KEY-REC-SEQ-NBR                     05207000
052080                                         TO DK-REC-SEQ-NBR        05208000
052090                                                                  05209000
052100                     PERFORM 5013A-SETUP-MESSAGE-LINE             05210000
052110                                                                  05211000
052120                 ELSE                                             05212000
052130                     SET DP020-MSG-INFORMATIONAL                  05213000
052140                                      TO  TRUE                    05214000
052150                     MOVE PV-TROUBLE-COUNT                        05215000
052160                                      TO  DP020-MSG-TEXT          05216000
052170                     PERFORM 5080-CHECK-IF-IN-TROUBLE             05217000
052180                     IF PV-DB2-COUNT > ZERO                       05218000
052190*                                                                 05219053
052220                         IF PS-ASNS-TO-WMS-YES                    05222000
052230                         AND PS-VALID-TRIP                        05223000
052240                             MOVE PC-TSYMSG-03574                 05224000
052250                                      TO DP020-MSG-NUMBER         05225000
052260                         ELSE                                     05226000
052270                             MOVE PC-TSYMSG-01002                 05227000
052280                                      TO DP020-MSG-NUMBER         05228000
052290                         END-IF                                   05229000
052291                                                                  05229153
052292                         MOVE '0O' TO  RCT00017-DC-FUNC-CDE       05229253
052293                         PERFORM 5800-INSERT-PO-TRACK             05229353
052294                                                                  05229453
052300                     ELSE                                         05230000
052321                                                                  05232126
052322                         MOVE '0O' TO  RCT00017-DC-FUNC-CDE       05232230
052324                         PERFORM 5800-INSERT-PO-TRACK             05232435
052325                                                                  05232530
052330                         IF PS-ASNS-TO-WMS-YES                    05233000
052340                         AND PS-VALID-TRIP                        05234000
052350                             MOVE PC-TSYMSG-03572                 05235000
052360                                      TO DP020-MSG-NUMBER         05236000
052370                         ELSE                                     05237000
052380                             MOVE PC-TSYMSG-00790                 05238000
052390                                      TO DP020-MSG-NUMBER         05239000
052400                         END-IF                                   05240000
052410                     END-IF                                       05241000
052420                 END-IF                                           05242000
052430             END-IF                                               05243000
052440         ELSE                                                     05244000
052450             MOVE PC-TSYMSG-00807    TO  DP020-MSG-NUMBER         05245000
052460              SET PS-ERROR           TO  TRUE                     05246000
052470              SET DP020-MSG-WARNING  TO  TRUE                     05247000
052480         END-IF                                                   05248000
052490                                                                  05249000
052500         IF PS-NO-ERROR                                           05250000
052510             SET ASC-TRNSCRP-NOT-PENDING TO TRUE                  05251000
052520         END-IF                                                   05252000
052530         PERFORM 5015-SCREEN-CLEANUP                              05253000
052540     END-IF.                                                      05254000
052550                                                                  05255000
052560 5013A-SETUP-MESSAGE-LINE.                                        05256000
052570     MOVE TM500-REC-SEQ-NBR           TO DK-REC-SEQ-NBR           05257000
052580     PERFORM 5081-CHECK-FOR-PACK-TROUBLE                          05258000
052590     PERFORM 5082-CHECK-FOR-LINE-TROUBLE                          05259000
052600     PERFORM 5083-CHECK-FOR-PO-TROUBLE                            05260000
052610                                                                  05261000
052620     MOVE PV-PACK-TRBL-COUNT          TO PV-ZAP2                  05262000
052630     MOVE PV-LINE-TRBL-COUNT          TO PV-ZAP3                  05263000
052640                                                                  05264000
052650     INITIALIZE PV-PREPACK-TROUBLE-VARIABLE                       05265000
052660     MOVE 1                           TO PV-TRBL-POINTER          05266000
052670                                                                  05267000
052680     EVALUATE TRUE                                                05268000
052690         WHEN PV-LINE-TRBL-COUNT = ZERO AND                       05269000
052700              PV-PACK-TRBL-COUNT = ZERO AND                       05270000
052710              PV-PO-TRBL-COUNT   = ZERO                           05271000
052720* JAK 06/2007 - SET MSG DEPENDENT ON ASN TO WMS STATUS            05272000
052730***          MOVE PC-TSYMSG-02453     TO DP020-MSG-NUMBER         05273000
052740             IF PS-ASNS-TO-WMS-YES                                05274000
052750             AND PS-VALID-TRIP                                    05275000
052760                 MOVE PC-TSYMSG-03584 TO DP020-MSG-NUMBER         05276000
052770             ELSE                                                 05277000
052780                 MOVE PC-TSYMSG-02453 TO DP020-MSG-NUMBER         05278000
052790             END-IF                                               05279000
052800                                                                  05280000
052810         WHEN OTHER                                               05281000
052820             IF PV-PO-TRBL-COUNT > ZERO                           05282000
052830                 STRING 'PO'                                      05283000
052840                        DELIMITED BY SIZE                         05284000
052850                        INTO PV-PREPACK-TROUBLE-VARIABLE          05285000
052860                        WITH POINTER PV-TRBL-POINTER              05286000
052870             END-IF                                               05287000
052880                                                                  05288000
052890             IF PV-PACK-TRBL-COUNT > ZERO                         05289000
052900                 IF PV-PO-TRBL-COUNT   > ZERO                     05290000
052910                     STRING ', '                                  05291000
052920                            DELIMITED BY SIZE                     05292000
052930                            INTO PV-PREPACK-TROUBLE-VARIABLE      05293000
052940                            WITH POINTER PV-TRBL-POINTER          05294000
052950                 END-IF                                           05295000
052960             IF PV-ZAP2X (1:1) NOT = SPACE                        05296000
052970                 STRING PV-ZAP2X (1:1)                            05297000
052980                        DELIMITED BY SIZE                         05298000
052990                        INTO PV-PREPACK-TROUBLE-VARIABLE          05299000
053000                        WITH POINTER PV-TRBL-POINTER              05300000
053010             END-IF                                               05301000
053020             IF PV-ZAP2X (2:1) NOT = SPACE                        05302000
053030                 STRING PV-ZAP2X (2:1)                            05303000
053040                        DELIMITED BY SIZE                         05304000
053050                        INTO PV-PREPACK-TROUBLE-VARIABLE          05305000
053060                        WITH POINTER PV-TRBL-POINTER              05306000
053070             END-IF                                               05307000
053080                                                                  05308000
053090             STRING ' PACK'                                       05309000
053100                    DELIMITED BY SIZE                             05310000
053110                    INTO PV-PREPACK-TROUBLE-VARIABLE              05311000
053120                    WITH POINTER PV-TRBL-POINTER                  05312000
053130                                                                  05313000
053140         END-IF                                                   05314000
053150                                                                  05315000
053160         IF PV-LINE-TRBL-COUNT > ZERO                             05316000
053170             IF PV-PO-TRBL-COUNT > ZERO OR                        05317000
053180                PV-PACK-TRBL-COUNT > ZERO                         05318000
053190                 STRING ', '                                      05319000
053200                        DELIMITED BY SIZE                         05320000
053210                        INTO PV-PREPACK-TROUBLE-VARIABLE          05321000
053220                        WITH POINTER PV-TRBL-POINTER              05322000
053230             END-IF                                               05323000
053240             IF PV-ZAP3X (1:1) NOT = SPACE                        05324000
053250                 STRING PV-ZAP3X (1:1)                            05325000
053260                        DELIMITED BY SIZE                         05326000
053270                        INTO PV-PREPACK-TROUBLE-VARIABLE          05327000
053280                        WITH POINTER PV-TRBL-POINTER              05328000
053290             END-IF                                               05329000
053300             IF PV-ZAP3X (2:1) NOT = SPACE                        05330000
053310                 STRING PV-ZAP3X (2:1)                            05331000
053320                        DELIMITED BY SIZE                         05332000
053330                        INTO PV-PREPACK-TROUBLE-VARIABLE          05333000
053340                        WITH POINTER PV-TRBL-POINTER              05334000
053350             END-IF                                               05335000
053360             IF PV-ZAP3X (3:1) NOT = SPACE                        05336000
053370                 STRING PV-ZAP3X (3:1)                            05337000
053380                        DELIMITED BY SIZE                         05338000
053390                        INTO PV-PREPACK-TROUBLE-VARIABLE          05339000
053400                        WITH POINTER PV-TRBL-POINTER              05340000
053410             END-IF                                               05341000
053420                                                                  05342000
053430             STRING ' LINE'                                       05343000
053440                    DELIMITED BY SIZE                             05344000
053450                    INTO PV-PREPACK-TROUBLE-VARIABLE              05345000
053460                    WITH POINTER PV-TRBL-POINTER                  05346000
053470                                                                  05347000
053480         END-IF                                                   05348000
053490         MOVE PV-PREPACK-TROUBLE-VARIABLE                         05349000
053500                                      TO DP020-MSG-TEXT           05350000
053510* JAK 06/2007 - SET MSG DEPENDENT ON ASN TO WMS STATUS            05351000
053520***      MOVE PC-TSYMSG-02454         TO DP020-MSG-NUMBER         05352000
053530         IF PS-ASNS-TO-WMS-NO                                     05353000
053540         AND PS-VALID-TRIP                                        05354000
053550             MOVE PC-TSYMSG-03573         TO DP020-MSG-NUMBER     05355000
053560         ELSE                                                     05356000
053570             MOVE PC-TSYMSG-02454         TO DP020-MSG-NUMBER     05357000
053580         END-IF                                                   05358000
053590     END-EVALUATE.                                                05359000
053600                                                                  05360000
053741 5015-SCREEN-CLEANUP.                                             05374126
053742                                                                  05374200
053743     INITIALIZE ASC-BLOCK-ENTRIES (1)                             05374300
053744                ASC-BLOCK-ENTRIES (2).                            05374400
053745     MOVE +1                     TO  ASC-BLK-SUB                  05374500
053746                                     PV-TOP-ITEM.                 05374600
053747                                                                  05374700
053748     MOVE ZERO                   TO  ASC-ITEM-SUB                 05374800
053749                                     ASC-NUMBER-OF-SELECTED-ITEMS 05374900
053750                                     ASC-SELECTED-CARTON-COUNT    05375000
053751                                     ASC-START-OF-SELECTED-RANGE  05375100
053752                                     ASC-END-OF-SELECTED-RANGE    05375200
053753                                     ASC-ITEM-AT-TOP-OF-PANEL.    05375300
053754                                                                  05375400
053755     PERFORM 4410-READ-TEMP-STORAGE.                              05375500
053760     PERFORM 3200-RESET-ATTRIBUTES.                               05376000
053770     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        05377000
053780*IR123 TO HERE                                                    05378000
053790/                                                                 05379000
053800 5020-CHECK-FOR-DUPLICATES.                                       05380000
053810                                                                  05381000
053820     PERFORM 6112-READ-LIST-QUEUE.                                05382000
053830                                                                  05383000
053840     IF PV-CICS-RESP = DFHRESP (NORMAL)                           05384000
053850         PERFORM                                                  05385000
053860         VARYING LQW-IDX  FROM 1 BY 1                             05386000
053870         UNTIL   LQW-IDX > PC-ITEMS-PER-PANEL OR                  05387000
053880                 LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO            05388000
053890                                                                  05389000
053900             IF LQW-SELECT (LQW-IDX)                              05390000
053910                 IF DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)        05391000
053920                     IF PS-FIRST-SELECTED                         05392000
053930                         MOVE LQW-PKSL-NBR (LQW-IDX)              05393000
053940                                         TO PV-SAVE-PKSL-NBR      05394000
053950                         MOVE LQW-STR-DEST-NBR (LQW-IDX)          05395000
053960                                         TO PV-SAVE-STORE-NBR     05396000
053970                         SET PS-NOT-FIRST-SELECTED TO TRUE        05397000
053980                     ELSE                                         05398000
053990                         IF ASC-TRNSCRP-NOT-PENDING AND           05399000
054000                            LQW-PKSL-NBR (LQW-IDX) NOT =          05400000
054010                                            PV-SAVE-PKSL-NBR      05401000
054020                             SET PS-DIFFERENT-PACKSLIPS           05402000
054030                                 ASC-TRNSCRP-PENDING TO TRUE      05403000
054040                             MOVE PC-TSYMSG-00977                 05404000
054050                                   TO  DP020-MSG-NUMBER           05405000
054060                             SET DP020-MSG-INFORMATIONAL TO TRUE  05406000
054070                         END-IF                                   05407000
054080                         IF LQW-STR-DEST-NBR (LQW-IDX) =          05408000
054090                                            PV-SAVE-STORE-NBR     05409000
054100                         AND PV-SAVE-STORE-NBR NOT = 0            05410000
054110                             SET PS-DUPLICATE-STORE TO TRUE       05411000
054120                             MOVE PC-TSYMSG-00976                 05412000
054130                                   TO  DP020-MSG-NUMBER           05413000
054140                             SET PS-ERROR            TO  TRUE     05414000
054150                             SET DP020-MSG-WARNING   TO  TRUE     05415000
054160                             SET PS-ERROR-MSG        TO  TRUE     05416000
054170                         ELSE                                     05417000
054180                             MOVE LQW-STR-DEST-NBR (LQW-IDX)      05418000
054190                                         TO PV-SAVE-STORE-NBR     05419000
054200                         END-IF                                   05420000
054210                     END-IF                                       05421000
054220                 ELSE                                             05422000
054230                     IF DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)    05423000
054240                         IF LQW-STR-DEST-NBR (LQW-IDX) > 0        05424000
054250                             MOVE LQW-STR-DEST-NBR (LQW-IDX)      05425000
054260                                             TO DK-STR-DEST-NBR   05426000
054270                             PERFORM 5030-COUNT-PKSLIP            05427000
054280                             IF PV-COUNT-LINE-ACTIVE-PKSLIP > 0   05428000
054290                                 SET PS-DUPLICATE-STORE TO TRUE   05429000
054300                                 MOVE PC-TSYMSG-00976             05430000
054310                                       TO  DP020-MSG-NUMBER       05431000
054320                                 SET PS-ERROR            TO  TRUE 05432000
054330                                 SET DP020-MSG-WARNING   TO  TRUE 05433000
054340                                 SET PS-ERROR-MSG        TO  TRUE 05434000
054350                             END-IF                               05435000
054360                         END-IF                                   05436000
054370                         IF PS-FIRST-SELECTED                     05437000
054380                             MOVE LQW-STR-DEST-NBR (LQW-IDX)      05438000
054390                                             TO PV-SAVE-STORE-NBR 05439000
054400                             SET PS-NOT-FIRST-SELECTED TO TRUE    05440000
054410                         ELSE                                     05441000
054420                             IF LQW-STR-DEST-NBR (LQW-IDX) =      05442000
054430                                                PV-SAVE-STORE-NBR 05443000
054440                             AND PV-SAVE-STORE-NBR NOT = 0        05444000
054450                                 SET PS-DUPLICATE-STORE TO TRUE   05445000
054460                                 MOVE PC-TSYMSG-00976             05446000
054470                                       TO  DP020-MSG-NUMBER       05447000
054480                                 SET PS-ERROR            TO  TRUE 05448000
054490                                 SET DP020-MSG-WARNING   TO  TRUE 05449000
054500                                 SET PS-ERROR-MSG        TO  TRUE 05450000
054510                             ELSE                                 05451000
054520                                 MOVE LQW-STR-DEST-NBR (LQW-IDX)  05452000
054530                                             TO PV-SAVE-STORE-NBR 05453000
054540                             END-IF                               05454000
054550                         END-IF                                   05455000
054560                     END-IF                                       05456000
054570                 END-IF                                           05457000
054580             END-IF                                               05458000
054590         END-PERFORM                                              05459000
054600     END-IF.                                                      05460000
054610                                                                  05461000
054620     MOVE PV-ITEM                TO PV-SAVE-ITEM.                 05462000
054630     PERFORM 6111-WRITE-LIST-QUEUE.                               05463000
054640*-----------------------------------------------------------------05464000
054650 5030-COUNT-PKSLIP.                                               05465000
054660     INITIALIZE PV-COUNT-LINE-ACTIVE-PKSLIP.                      05466000
054670     MOVE ZEROES  TO  PV-PO-ACTIVE-PKSLIP.                        05467006
054680                                                                  05468006
054690         EXEC SQL                                                 05469006
054700             SELECT PO_NBR                                        05470006
054710              INTO  :PV-PO-ACTIVE-PKSLIP                          05471006
054720               FROM TPKSLIP                                       05472006
054730              WHERE PO_NBR          = :DK-PO-NBR                  05473006
054740                AND OPER_UNT_ID     = :DK-OPER-UNT-ID             05474006
054750                AND FCLTY_ID        = :DK-FCLTY-ID                05475006
054760                AND STR_DEST_NBR    = :DK-STR-DEST-NBR            05476006
054770                AND REC_SEQ_NBR     = :DK-REC-SEQ-NBR             05477006
054780                AND VER_STAT_CDE    = 'A'                         05478006
054790                AND PKSL_STAT_CDE   = 'AC'                        05479006
054800              FETCH FIRST 1 ROW ONLY                              05480006
054810         END-EXEC                                                 05481006
054820                                                                  05482006
054830         EVALUATE TRUE                                            05483006
054840             WHEN SQLCODE = ZERO                                  05484006
054850             WHEN SQLCODE = -811                                  05485006
054860                  MOVE  1  TO  PV-COUNT-LINE-ACTIVE-PKSLIP        05486006
054870                                                                  05487006
054880             WHEN SQLCODE = +100                                  05488006
054890                  MOVE  0  TO  PV-COUNT-LINE-ACTIVE-PKSLIP        05489006
054900                                                                  05490006
054910             WHEN SQLCODE = -904                                  05491006
054920             WHEN SQLCODE = -911                                  05492006
054930             WHEN SQLCODE = -913                                  05493006
054940                  PERFORM 9900-SOFT-ABORT                         05494006
054950                                                                  05495006
054960             WHEN SQLWARN0 NOT = SPACES                           05496006
054970             WHEN SQLCODE  NOT = ZERO                             05497006
054980                  MOVE '5030-COUNT-PKSLIP'                        05498006
054990                                 TO DP013-PARAGRAPH               05499006
055000                  MOVE 'UNSUCCESSFUL COUNT OF TPKSLIP'            05500006
055010                                 TO DP013-MESSAGE-TEXT (1)        05501006
055020                  MOVE ASC-KEY-PO-NBR                             05502006
055030                                 TO PV-MSG-KEY-PO                 05503006
055040                  MOVE ASC-KEY-REC-SEQ-NBR                        05504006
055050                                 TO PV-MSG-KEY-REC-SEQ-NBR-N      05505006
055060                  MOVE PV-MSG-KEYS                                05506006
055070                                 TO DP013-MESSAGE-TEXT (2)        05507006
055080                  MOVE SQLCA     TO DP013-SQLCA                   05508006
055090                  MOVE 'TPKSLIP' TO DP013-DB2-TABLE-NAME (1)      05509006
055100                  SET DP013-DB2-ABEND                             05510006
055110                      DP013-XCTL-DISPLAY-RESTART                  05511006
055120                                 TO TRUE                          05512006
055130                  PERFORM DP013-0000-PROCESS-ABEND                05513006
055140         END-EVALUATE.                                            05514006
055150                                                                  05515006
055160 5050-CHECK-FOR-VERIFIED.                                         05516006
055170                                                                  05517006
055180     MOVE '5050-CHECK-FOR-VERIFIED       '   TO PV-LAST-PARAGRAPH 05518006
055190     MOVE PV-FIRST-REC-SEQ-NBR   TO  DK-REC-SEQ-NBR.              05519006
055200     MOVE ASC-KEY-OPER-UNT-ID    TO  DK-OPER-UNT-ID.              05520006
055210     MOVE ASC-KEY-FCLTY-ID       TO  DK-FCLTY-ID.                 05521006
055220                                                                  05522006
055230         EXEC SQL                                                 05523006
055240             SELECT STATUS_CDE                                    05524006
055250                  , PKGNG_CDE                                     05525006
055260               INTO :RECEIV-STATUS-CDE                            05526006
055270                  , :RECEIV-PKGNG-CDE                             05527006
055280               FROM TRECEIV                                       05528006
055290              WHERE ORD_NBR        = :DK-PO-NBR                   05529006
055300                AND REC_SEQ_NBR    = :DK-REC-SEQ-NBR              05530006
055310                AND VER_STATUS_CDE = 'A'                          05531006
055320                AND OPER_UNT_ID    = :DK-OPER-UNT-ID              05532006
055330                AND FCLTY_ID       = :DK-FCLTY-ID                 05533006
055340         END-EXEC                                                 05534006
055350                                                                  05535006
055360         EVALUATE TRUE                                            05536006
055370             WHEN SQLCODE = ZERO                                  05537006
055380             WHEN SQLCODE = +100                                  05538006
055390                  CONTINUE                                        05539006
055400             WHEN SQLCODE = -904                                  05540006
055410             WHEN SQLCODE = -911                                  05541006
055420             WHEN SQLCODE = -913                                  05542006
055430                  PERFORM 9900-SOFT-ABORT                         05543006
055440                                                                  05544006
055450             WHEN SQLWARN0 NOT = SPACES                           05545006
055460             WHEN SQLCODE  NOT = ZERO                             05546006
055470                  MOVE '5050-CHECK-FOR-VERIFIED'                  05547006
055480                                 TO DP013-PARAGRAPH               05548006
055490                  MOVE 'UNSUCCESSFUL SELECT OF TRECEIV'           05549006
055500                                 TO DP013-MESSAGE-TEXT (1)        05550006
055510                  MOVE ASC-KEY-PO-NBR                             05551006
055520                                 TO PV-MSG-KEY-PO                 05552006
055530                  MOVE ASC-KEY-REC-SEQ-NBR                        05553006
055540                                 TO PV-MSG-KEY-REC-SEQ-NBR-N      05554006
055550                  MOVE PV-MSG-KEYS                                05555006
055560                                 TO DP013-MESSAGE-TEXT (2)        05556006
055570                  MOVE SQLCA     TO DP013-SQLCA                   05557006
055580                  MOVE 'TRECEIV' TO DP013-DB2-TABLE-NAME (1)      05558006
055590                  SET DP013-DB2-ABEND                             05559006
055600                      DP013-XCTL-DISPLAY-RESTART                  05560006
055610                                 TO TRUE                          05561006
055620                  PERFORM DP013-0000-PROCESS-ABEND                05562006
055630         END-EVALUATE.                                            05563006
055640/                                                                 05564006
055650 5051-GET-PKGNG-CDE.                                              05565006
055660                                                                  05566006
055670     MOVE '5051-GET-PKGNG-CDE            '   TO PV-LAST-PARAGRAPH 05567006
055680                                                                  05568006
055690     EXEC SQL                                                     05569006
055700         SELECT PKGNG_CDE                                         05570006
055710         INTO :RECEIV-PKGNG-CDE                                   05571006
055720         FROM TRECEIV                                             05572006
055730         WHERE ORD_NBR        = :DK-PO-NBR                        05573006
055740           AND REC_SEQ_NBR    = :DK-REC-SEQ-NBR                   05574006
055750           AND VER_STATUS_CDE = 'A'                               05575006
055760           AND OPER_UNT_ID    = :DK-OPER-UNT-ID                   05576006
055770           AND FCLTY_ID       = :DK-FCLTY-ID                      05577006
055780     END-EXEC                                                     05578006
055790                                                                  05579006
055800     EVALUATE TRUE                                                05580006
055810         WHEN SQLCODE = ZERO                                      05581006
055820         WHEN SQLCODE = +100                                      05582006
055830             MOVE RECEIV-PKGNG-CDE    TO ASC-TRECEIV-PKGNG-CDE    05583006
055840         WHEN SQLCODE = -904                                      05584006
055850         WHEN SQLCODE = -911                                      05585006
055860         WHEN SQLCODE = -913                                      05586006
055870             PERFORM 9900-SOFT-ABORT                              05587006
055880                                                                  05588006
055890         WHEN SQLWARN0 NOT = SPACES                               05589006
055900         WHEN SQLCODE  NOT = ZERO                                 05590006
055910             MOVE '5051-GET-PKGNG-CDE'                            05591006
055920                                      TO DP013-PARAGRAPH          05592006
055930             MOVE 'UNSUCCESSFUL SELECT OF TRECEIV'                05593006
055940                                      TO DP013-MESSAGE-TEXT (1)   05594006
055950             MOVE ASC-KEY-PO-NBR      TO PV-MSG-KEY-PO            05595006
055960             MOVE ASC-KEY-REC-SEQ-NBR TO PV-MSG-KEY-REC-SEQ-NBR-N 05596006
055970             MOVE PV-MSG-KEYS         TO DP013-MESSAGE-TEXT (2)   05597006
055980             MOVE SQLCA               TO DP013-SQLCA              05598006
055990             MOVE 'TRECEIV'           TO DP013-DB2-TABLE-NAME (1) 05599006
056000             SET DP013-DB2-ABEND                                  05600006
056010                  DP013-XCTL-DISPLAY-RESTART                      05601006
056020                                      TO TRUE                     05602006
056030             PERFORM DP013-0000-PROCESS-ABEND                     05603006
056040     END-EVALUATE.                                                05604006
056050/                                                                 05605006
056060 5070-UPDATE-TRECEIV.                                             05606006
056070                                                                  05607006
056080         EXEC SQL                                                 05608006
056090           UPDATE TRECEIV                                         05609006
056100              SET STATUS_CDE    = 'IP'                            05610006
056110            WHERE ORD_NBR        = :DK-PO-NBR                     05611006
056120              AND REC_SEQ_NBR    = :DK-REC-SEQ-NBR                05612006
056130              AND VER_STATUS_CDE = 'A'                            05613006
056140              AND OPER_UNT_ID    = :DK-OPER-UNT-ID                05614006
056150              AND FCLTY_ID       = :DK-FCLTY-ID                   05615006
056160         END-EXEC                                                 05616006
056170                                                                  05617006
056180         EVALUATE TRUE                                            05618006
056190             WHEN SQLCODE = ZERO                                  05619006
056200             WHEN SQLCODE = +100                                  05620006
056210                  CONTINUE                                        05621006
056220             WHEN SQLCODE = -904                                  05622006
056230             WHEN SQLCODE = -911                                  05623006
056240             WHEN SQLCODE = -913                                  05624006
056250                  PERFORM 9900-SOFT-ABORT                         05625006
056260                                                                  05626006
056270             WHEN SQLWARN0 NOT = SPACES                           05627006
056280             WHEN SQLCODE  NOT = ZERO                             05628006
056290                  MOVE '5620-SET-CURR-PKSLIP-TO-INACT'            05629006
056300                                 TO DP013-PARAGRAPH               05630006
056310                  MOVE 'UNSUCCESSFUL UPDATE OF TPKSLIP'           05631006
056320                                 TO DP013-MESSAGE-TEXT (1)        05632006
056330                  MOVE SQLCA     TO DP013-SQLCA                   05633006
056340                  MOVE 'TPKSLIP' TO DP013-DB2-TABLE-NAME (1)      05634006
056350                  SET DP013-DB2-ABEND                             05635006
056360                      DP013-XCTL-DISPLAY-RESTART                  05636006
056370                                 TO TRUE                          05637006
056380                  PERFORM DP013-0000-PROCESS-ABEND                05638006
056390         END-EVALUATE.                                            05639006
056400                                                                  05640006
056410 5075-COUNT-TRECITMS.                                             05641006
056420                                                                  05642006
056430     MOVE ZERO           TO  PV-DB2-COUNT.                        05643006
056440     MOVE ZERO           TO  PV-PO-ACTIVE-RECITM.                 05644006
056450                                                                  05645006
056460         EXEC SQL                                                 05646006
056470              SELECT  ORD_NBR                                     05647006
056480                INTO :PV-PO-ACTIVE-RECITM                         05648006
056490                FROM                                              05649006
056500                     TRECITM                                      05650006
056510               WHERE                                              05651006
056520                     ORD_NBR          =  :DK-PO-NBR               05652006
056530                AND  REC_SEQ_NBR      =  :DK-REC-SEQ-NBR          05653006
056540                AND  OPER_UNT_ID      =  :DK-OPER-UNT-ID          05654006
056550                AND  FCLTY_ID         =  :DK-FCLTY-ID             05655006
056560                AND  VER_STATUS_CDE   =  'A'                      05656006
056570                AND  STATUS_CDE       =  'VE'                     05657006
056580              FETCH FIRST 1 ROW ONLY                              05658006
056590         END-EXEC                                                 05659006
056600                                                                  05660006
056610         EVALUATE TRUE                                            05661006
056620             WHEN SQLCODE = ZERO                                  05662006
056630             WHEN SQLCODE = -811                                  05663006
056640                  MOVE  1  TO  PV-DB2-COUNT                       05664006
056650             WHEN SQLCODE = +100                                  05665006
056660                  MOVE  0  TO  PV-DB2-COUNT                       05666006
056670             WHEN SQLCODE = -904                                  05667006
056680             WHEN SQLCODE = -911                                  05668006
056690             WHEN SQLCODE = -913                                  05669006
056700                  PERFORM 9900-SOFT-ABORT                         05670006
056710                                                                  05671006
056720             WHEN SQLWARN0 NOT = SPACES                           05672006
056730             WHEN SQLCODE  NOT = ZERO                             05673006
056740                  MOVE '5075-COUNT-TRECITMS'                      05674006
056750                                 TO DP013-PARAGRAPH               05675006
056760                  MOVE 'UNSUCCESSFUL COUNT OF STATUS "VE"'        05676006
056770                                 TO DP013-MESSAGE-TEXT (1)        05677006
056780                  MOVE SQLCA     TO DP013-SQLCA                   05678006
056790                  MOVE 'TRECITM' TO DP013-DB2-TABLE-NAME (1)      05679006
056800                  SET DP013-DB2-ABEND                             05680006
056810                      DP013-XCTL-DISPLAY-RESTART                  05681006
056820                                 TO TRUE                          05682006
056830                                                                  05683006
056840                  PERFORM DP013-0000-PROCESS-ABEND                05684006
056850         END-EVALUATE.                                            05685006
056860/                                                                 05686006
056870 5076-CHECK-TRECITM.                                              05687006
056880                                                                  05688006
056890     MOVE ZERO           TO  PV-DB2-COUNT.                        05689006
056900     MOVE ZERO           TO  PV-PO-ACTIVE-RECITM.                 05690006
056910                                                                  05691006
056920         EXEC SQL                                                 05692006
056930              SELECT  ORD_NBR                                     05693006
056940                INTO :PV-PO-ACTIVE-RECITM                         05694006
056950                FROM                                              05695006
056960                     TRECITM                                      05696006
056970               WHERE                                              05697006
056980                     ORD_NBR          =  :DK-PO-NBR               05698006
056990                AND  REC_SEQ_NBR      =  :DK-REC-SEQ-NBR          05699006
057000                AND  OPER_UNT_ID      =  :DK-OPER-UNT-ID          05700006
057010                AND  FCLTY_ID         =  :DK-FCLTY-ID             05701006
057020                AND  VER_STATUS_CDE   =  'A'                      05702006
057030                AND (RCPT_DISTR_UPD_CDE = 'A'                     05703006
057040                OR   RCPT_DISTR_UPD_CDE = 'U')                    05704006
057050              FETCH FIRST 1 ROW ONLY                              05705006
057060         END-EXEC                                                 05706006
057070                                                                  05707006
057080         EVALUATE TRUE                                            05708006
057090             WHEN SQLCODE = ZERO                                  05709006
057100             WHEN SQLCODE = -811                                  05710006
057110                  MOVE  1  TO  PV-DB2-COUNT                       05711006
057120             WHEN SQLCODE = +100                                  05712006
057130                  MOVE  0  TO  PV-DB2-COUNT                       05713006
057140             WHEN SQLCODE = -904                                  05714006
057150             WHEN SQLCODE = -911                                  05715006
057160             WHEN SQLCODE = -913                                  05716006
057170                  PERFORM 9900-SOFT-ABORT                         05717006
057180                                                                  05718006
057190             WHEN SQLWARN0 NOT = SPACES                           05719006
057200             WHEN SQLCODE  NOT = ZERO                             05720006
057210                  MOVE '5076-CHECK-TRECITM'                       05721006
057220                                 TO DP013-PARAGRAPH               05722006
057230                  MOVE 'UNSUCCESSFUL COUNT OF STATUS "VE"'        05723006
057240                                 TO DP013-MESSAGE-TEXT (1)        05724006
057250                  MOVE SQLCA     TO DP013-SQLCA                   05725006
057260                  MOVE 'TRECITM' TO DP013-DB2-TABLE-NAME (1)      05726006
057270                  SET DP013-DB2-ABEND                             05727006
057280                      DP013-XCTL-DISPLAY-RESTART                  05728006
057290                                 TO TRUE                          05729006
057300                                                                  05730006
057310                  PERFORM DP013-0000-PROCESS-ABEND                05731006
057320         END-EVALUATE.                                            05732006
057330/                                                                 05733006
057340 5078-CHECK-FOR-TDISTHD.                                          05734006
057350                                                                  05735007
057360     MOVE ZERO           TO  PV-DB2-COUNT.                        05736007
057370                                                                  05737007
057380     IF  ASC-TRECEIV-PKGNG-CDE = 'M' OR 'I'                       05738007
057390         PERFORM 5078A-CHECK-FOR-TDISTHD                          05739010
057400         IF  PV-DB2-COUNT = 0                                     05740007
057410             PERFORM 5078B-CHECK-FOR-TDISTHD                      05741007
057420         END-IF                                                   05742007
057430     ELSE                                                         05743007
057440         PERFORM 5078C-CHECK-FOR-TDISTHD                          05744007
057450     END-IF.                                                      05745007
057460                                                                  05746007
057470                                                                  05747007
057480 5078A-CHECK-FOR-TDISTHD.                                         05748007
057490                                                                  05749007
057500     MOVE ZEROES  TO  PV-PO-CASEPK-DWNLD.                         05750007
057510                                                                  05751007
057520     EXEC SQL                                                     05752007
057530          SELECT  A.PO_NBR                                        05753007
057540            INTO :PV-PO-CASEPK-DWNLD                              05754007
057550            FROM                                                  05755007
057560                  TPKSLIP A                                       05756007
057570                 ,TPKITEM B                                       05757007
057580                 ,TPURITM C                                       05758007
057590           WHERE                                                  05759007
057600                  A.PO_NBR         =  :DK-PO-NBR                  05760007
057610             AND  A.REC_SEQ_NBR    =  :DK-REC-SEQ-NBR             05761007
057620             AND  A.VER_STAT_CDE   =  'A'                         05762007
057630             AND  A.PO_NBR         =  B.PO_NBR                    05763007
057640             AND  A.SEQ_NBR        =  B.SEQ_NBR                   05764007
057650             AND  B.PO_NBR         =  C.PO_NBR                    05765007
057660             AND  B.PKSL_LNE_NBR   =  C.APP_PO_LNE_NBR            05766007
057670             AND  C.VER_STATUS_CDE =  'A'                         05767007
057680             AND  EXISTS                                          05768007
057690             (SELECT E.PREPK_ID                                   05769007
057700                FROM                                              05770007
057710                     TRECITM E                                    05771007
057720                    ,TDISTHD F                                    05772007
057730               WHERE                                              05773007
057740                      E.ORD_NBR        =  A.PO_NBR                05774007
057750                 AND  E.REC_SEQ_NBR    =  A.REC_SEQ_NBR           05775007
057760                 AND  E.VER_STATUS_CDE =  'A'                     05776007
057770                 AND  E.PREPK_ID       =  C.PO_PREPK_ID           05777007
057780                 AND  F.ORD_NBR        =  E.ORD_NBR               05778007
057790                 AND  F.RCVR_SEQ_NBR   =  E.REC_SEQ_NBR           05779007
057800                 AND  F.ORD_LNE_NBR    =  E.ORD_LNE_NBR           05780007
057810                 AND ((F.TOT_CART_CNT > 0)                        05781007
057820                  OR  (F.TOT_CART_CNT      = 0          AND       05782007
057830                       NOT F.CRE_USR_ID    = ' '        AND       05783007
057840                       NOT F.CRE_USR_ID    = 'RCKUT129' AND       05784007
057850                       NOT F.PRCG_STAT_CDE = 'C'        AND       05785007
057860                       NOT F.SYS_CRE_CDE   = ' '))                05786007
057870             )                                                    05787007
057880           FETCH FIRST 1 ROW ONLY                                 05788007
057890     END-EXEC.                                                    05789007
057900                                                                  05790007
057910     EVALUATE TRUE                                                05791007
057920         WHEN SQLCODE = ZERO                                      05792007
057930         WHEN SQLCODE = -811                                      05793007
057940              MOVE  1  TO  PV-DB2-COUNT                           05794007
057950         WHEN SQLCODE = +100                                      05795007
057960              MOVE  0  TO  PV-DB2-COUNT                           05796007
057970         WHEN SQLCODE = -904                                      05797007
057980         WHEN SQLCODE = -911                                      05798007
057990         WHEN SQLCODE = -913                                      05799007
058000              PERFORM 9900-SOFT-ABORT                             05800007
058010                                                                  05801007
058020         WHEN SQLWARN0 NOT = SPACES                               05802007
058030         WHEN SQLCODE  NOT = ZERO                                 05803007
058040              MOVE '5078A-CHECK-FOR-TDISTHD'                      05804007
058050                             TO DP013-PARAGRAPH                   05805007
058060              MOVE 'UNSUCCESSFUL COUNT OF CASEPACK'               05806007
058070                             TO DP013-MESSAGE-TEXT (1)            05807007
058080              MOVE SQLCA     TO DP013-SQLCA                       05808007
058090              MOVE 'TDISTHD' TO DP013-DB2-TABLE-NAME (1)          05809007
058100              MOVE 'TRECITM' TO DP013-DB2-TABLE-NAME (2)          05810007
058110              MOVE 'TPKSLIP' TO DP013-DB2-TABLE-NAME (3)          05811007
058120              MOVE 'TPKITEM' TO DP013-DB2-TABLE-NAME (4)          05812007
058130              MOVE 'TPURITM' TO DP013-DB2-TABLE-NAME (5)          05813007
058140                  SET DP013-DB2-ABEND                             05814007
058150                      DP013-XCTL-DISPLAY-RESTART                  05815007
058160                             TO TRUE                              05816007
058170                  PERFORM DP013-0000-PROCESS-ABEND                05817007
058180         END-EVALUATE.                                            05818007
058190                                                                  05819007
058200                                                                  05820007
058210 5078B-CHECK-FOR-TDISTHD.                                         05821007
058220                                                                  05822007
058230     MOVE ZEROES  TO  PV-PO-CASEPK-DWNLD.                         05823007
058240                                                                  05824007
058250     EXEC SQL                                                     05825007
058260          SELECT  A.PO_NBR                                        05826007
058270            INTO :PV-PO-CASEPK-DWNLD                              05827009
058280            FROM                                                  05828007
058290                  TPKSLIP A,                                      05829007
058300                  TPKITEM B,                                      05830007
058310                  TDISTHD C                                       05831007
058320           WHERE                                                  05832007
058330                  A.PO_NBR         =  :DK-PO-NBR                  05833007
058340             AND  A.REC_SEQ_NBR    =  :DK-REC-SEQ-NBR             05834007
058350             AND  A.VER_STAT_CDE   =  'A'                         05835007
058360             AND  A.PO_NBR         =  B.PO_NBR                    05836007
058370             AND  A.SEQ_NBR        =  B.SEQ_NBR                   05837007
058380             AND  A.PO_NBR         =  C.ORD_NBR                   05838007
058390             AND  A.REC_SEQ_NBR    =  C.RCVR_SEQ_NBR              05839007
058400             AND  B.PKSL_LNE_NBR   =  C.ORD_LNE_NBR               05840007
058410             AND ((C.TOT_CART_CNT > 0)                            05841007
058420              OR  (C.TOT_CART_CNT = 0 AND                         05842007
058430                   NOT C.CRE_USR_ID = ' ' AND                     05843007
058440                   NOT C.CRE_USR_ID = 'RCKUT129' AND              05844007
058450                   NOT C.PRCG_STAT_CDE = 'C'     AND              05845007
058460                   NOT C.SYS_CRE_CDE = ' '))                      05846007
058470           FETCH FIRST 1 ROW ONLY                                 05847007
058480     END-EXEC.                                                    05848007
058490                                                                  05849007
058500     EVALUATE TRUE                                                05850007
058510         WHEN SQLCODE = ZERO                                      05851007
058520         WHEN SQLCODE = -811                                      05852007
058530              MOVE  1  TO  PV-DB2-COUNT                           05853007
058540         WHEN SQLCODE = +100                                      05854007
058550              MOVE  0  TO  PV-DB2-COUNT                           05855007
058560         WHEN SQLCODE = -904                                      05856007
058570         WHEN SQLCODE = -911                                      05857007
058580         WHEN SQLCODE = -913                                      05858007
058590              PERFORM 9900-SOFT-ABORT                             05859007
058600                                                                  05860007
058610         WHEN SQLWARN0 NOT = SPACES                               05861007
058620         WHEN SQLCODE  NOT = ZERO                                 05862007
058630              MOVE '5078B-CHECK-FOR-TDISTHD'                      05863007
058640                             TO DP013-PARAGRAPH                   05864007
058650              MOVE 'UNSUCCESSFUL COUNT OF CASEPACK'               05865007
058660                             TO DP013-MESSAGE-TEXT (1)            05866007
058670              MOVE SQLCA     TO DP013-SQLCA                       05867007
058680              MOVE 'TPKSLIP' TO DP013-DB2-TABLE-NAME (1)          05868007
058690              MOVE 'TPKITEM' TO DP013-DB2-TABLE-NAME (2)          05869007
058700              MOVE 'TDISTHD' TO DP013-DB2-TABLE-NAME (3)          05870007
058710              SET DP013-DB2-ABEND                                 05871007
058720                  DP013-XCTL-DISPLAY-RESTART                      05872007
058730                                 TO TRUE                          05873007
058740                  PERFORM DP013-0000-PROCESS-ABEND                05874007
058750     END-EVALUATE.                                                05875007
058760                                                                  05876007
058770                                                                  05877007
058780 5078C-CHECK-FOR-TDISTHD.                                         05878007
058790                                                                  05879007
058800     MOVE ZEROES  TO  PV-PO-CASEPK-DWNLD.                         05880007
058810                                                                  05881007
058820     EXEC SQL                                                     05882007
058830          SELECT  A.PO_NBR                                        05883007
058840            INTO :PV-PO-CASEPK-DWNLD                              05884007
058850            FROM                                                  05885007
058860                 TPKSLIP A,                                       05886007
058870                 TPKITEM B,                                       05887007
058880                 TDISTHD C                                        05888007
058890           WHERE                                                  05889007
058900                  A.PO_NBR         =  :DK-PO-NBR                  05890007
058910             AND  A.REC_SEQ_NBR    =  :DK-REC-SEQ-NBR             05891007
058920             AND  A.VER_STAT_CDE   =  'A'                         05892007
058930             AND  A.PO_NBR         =  B.PO_NBR                    05893007
058940             AND  A.SEQ_NBR        =  B.SEQ_NBR                   05894007
058950             AND  A.PO_NBR         =  C.ORD_NBR                   05895007
058960             AND  A.REC_SEQ_NBR    =  C.RCVR_SEQ_NBR              05896007
058970             AND  B.PKSL_LNE_NBR   =  C.ORD_LNE_NBR               05897007
058980             AND ((C.TOT_CART_CNT > 0)                            05898007
058990              OR  (C.TOT_CART_CNT = 0 AND                         05899007
059000                   NOT C.CRE_USR_ID = ' ' AND                     05900007
059010                   NOT C.CRE_USR_ID = 'RCKUT129' AND              05901007
059020                   NOT C.PRCG_STAT_CDE = 'C'     AND              05902007
059030                   NOT C.SYS_CRE_CDE = ' '))                      05903007
059040           FETCH FIRST 1 ROW ONLY                                 05904007
059050     END-EXEC.                                                    05905007
059060                                                                  05906007
059070     EVALUATE TRUE                                                05907007
059080         WHEN SQLCODE = ZERO                                      05908007
059090         WHEN SQLCODE = -811                                      05909007
059100              MOVE  1  TO  PV-DB2-COUNT                           05910007
059110         WHEN SQLCODE = +100                                      05911007
059120              MOVE  0  TO  PV-DB2-COUNT                           05912011
059130         WHEN SQLCODE = -904                                      05913007
059140         WHEN SQLCODE = -911                                      05914007
059150         WHEN SQLCODE = -913                                      05915007
059160              PERFORM 9900-SOFT-ABORT                             05916007
059170                                                                  05917007
059180         WHEN SQLWARN0 NOT = SPACES                               05918007
059190         WHEN SQLCODE  NOT = ZERO                                 05919007
059200              MOVE '5078C-CHECK-FOR-TDISTHD'                      05920007
059210                             TO DP013-PARAGRAPH                   05921007
059220              MOVE 'UNSUCCESSFUL COUNT OF CASEPACK'               05922007
059230                             TO DP013-MESSAGE-TEXT (1)            05923007
059240              MOVE SQLCA     TO DP013-SQLCA                       05924007
059250              MOVE 'TPKSLIP' TO DP013-DB2-TABLE-NAME (1)          05925007
059260              MOVE 'TPKITEM' TO DP013-DB2-TABLE-NAME (2)          05926007
059270              MOVE 'TDISTHD' TO DP013-DB2-TABLE-NAME (3)          05927007
059280              SET DP013-DB2-ABEND                                 05928007
059290                  DP013-XCTL-DISPLAY-RESTART                      05929007
059300                             TO TRUE                              05930007
059310              PERFORM DP013-0000-PROCESS-ABEND                    05931007
059320     END-EVALUATE.                                                05932007
059330                                                                  05933007
059340                                                                  05934007
059350                                                                  05935008
059360 5080-CHECK-IF-IN-TROUBLE.                                        05936007
059370                                                                  05937007
059380     MOVE ZERO           TO  PV-DB2-COUNT.                        05938007
059390     MOVE ZERO           TO  PV-PO-IN-TROUBLE.                    05939008
059400                                                                  05940008
059410     EXEC SQL                                                     05941008
059420          SELECT  A.PO_NBR                                        05942008
059430            INTO :PV-PO-IN-TROUBLE                                05943008
059440            FROM TTRBNTF A                                        05944008
059450           WHERE A.PO_NBR        = :DK-PO-NBR                     05945008
059460             AND A.REC_SEQ_NBR   = :DK-REC-SEQ-NBR                05946008
059470             AND A.PREPK_ID      = 0                              05947008
059480             AND A.PO_LNE_NBR    = 0                              05948008
059490             AND A.RESOLVED_IND IN ('N','I')                      05949008
059500           FETCH FIRST 1 ROW ONLY                                 05950008
059510     END-EXEC.                                                    05951008
059520                                                                  05952008
059530     EVALUATE TRUE                                                05953008
059540         WHEN SQLCODE = +0                                        05954008
059550         WHEN SQLCODE = -811                                      05955008
059560              MOVE 1  TO  PV-DB2-COUNT                            05956008
059570         WHEN SQLCODE = +100                                      05957008
059580              MOVE 0  TO  PV-DB2-COUNT                            05958008
059590         WHEN SQLCODE = -904                                      05959008
059600         WHEN SQLCODE = -911                                      05960008
059610         WHEN SQLCODE = -913                                      05961008
059620              PERFORM 9900-SOFT-ABORT                             05962008
059630                                                                  05963008
059640         WHEN SQLWARN0 NOT = SPACES                               05964008
059650         WHEN SQLCODE < +0                                        05965008
059660         WHEN SQLCODE > +0                                        05966008
059670              MOVE '5080-CHECK-IF-IN-TROUBLE'                     05967008
059680                              TO DP013-PARAGRAPH                  05968008
059690              MOVE 'UNSUCCESSFUL SELECT TROUBLE COUNT'            05969008
059700                              TO DP013-MESSAGE-TEXT (1)           05970008
059710              MOVE SQLCA      TO DP013-SQLCA                      05971008
059720              MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)         05972008
059730              SET DP013-DB2-ABEND                                 05973008
059740                  DP013-XCTL-DISPLAY-RESTART                      05974008
059750                              TO TRUE                             05975008
059760              PERFORM DP013-0000-PROCESS-ABEND                    05976008
059770     END-EVALUATE.                                                05977008
059780                                                                  05978008
059790 5081-CHECK-FOR-PACK-TROUBLE.                                     05979008
059800                                                                  05980008
059810     MOVE ZERO                        TO  PV-PACK-TRBL-COUNT.     05981008
059820     EXEC SQL                                                     05982008
059830         SELECT COUNT(DISTINCT A.PREPK_ID)                        05983008
059840                INTO :PV-PACK-TRBL-COUNT :PV-NULL-IND             05984008
059850                FROM TTRBNTF A                                    05985008
059860                ,    TTRBRSN B                                    05986008
059870         WHERE A.PO_NBR        = :DK-PO-NBR                       05987008
059880           AND A.REC_SEQ_NBR   = :DK-REC-SEQ-NBR                  05988008
059890            AND B.TRBL_RSN_CDE = A.TRBL_RSN_CDE                   05989008
059900            AND B.TRBL_LVL_IND = 'M'                              05990008
059910            AND A.RESOLVED_IND IN ('N','I')                       05991008
059920     END-EXEC                                                     05992008
059930                                                                  05993008
059940     EVALUATE TRUE                                                05994008
059950         WHEN SQLCODE = ZERO                                      05995008
059960         WHEN SQLCODE = +100                                      05996008
059970                  CONTINUE                                        05997008
059980         WHEN SQLCODE = -904                                      05998008
059990         WHEN SQLCODE = -911                                      05999008
060000         WHEN SQLCODE = -913                                      06000008
060010             PERFORM 9900-SOFT-ABORT                              06001008
060020                                                                  06002008
060030         WHEN SQLWARN0 NOT = SPACES                               06003008
060040         WHEN SQLCODE < ZERO                                      06004008
060050         WHEN SQLCODE > ZERO                                      06005008
060060             MOVE '5081-CHECK-FOR-PACK-TROUBLE'                   06006008
060070                                      TO DP013-PARAGRAPH          06007008
060080             MOVE 'UNSUCCESSFUL SELECT TROUBLE COUNT'             06008008
060090                                      TO DP013-MESSAGE-TEXT (1)   06009008
060100             MOVE SQLCA               TO DP013-SQLCA              06010008
060110             MOVE 'TTRBNTF '          TO DP013-DB2-TABLE-NAME (1) 06011008
060120             MOVE 'TTRBRSN '          TO DP013-DB2-TABLE-NAME (2) 06012008
060130             SET DP013-DB2-ABEND                                  06013008
060140                 DP013-XCTL-DISPLAY-RESTART                       06014008
060150                                      TO TRUE                     06015008
060160             PERFORM DP013-0000-PROCESS-ABEND                     06016008
060170     END-EVALUATE.                                                06017008
060180                                                                  06018008
060190 5082-CHECK-FOR-LINE-TROUBLE.                                     06019008
060200                                                                  06020008
060210     MOVE ZERO           TO  PV-LINE-TRBL-COUNT.                  06021008
060220                                                                  06022008
060230     EXEC SQL                                                     06023008
060240         SELECT COUNT(DISTINCT PO_LNE_NBR)                        06024008
060250          INTO :PV-LINE-TRBL-COUNT :PV-NULL-IND                   06025008
060260          FROM TTRBNTF A                                          06026008
060270          ,    TTRBRSN B                                          06027008
060280          WHERE A.PO_NBR        = :DK-PO-NBR                      06028008
060290          AND A.REC_SEQ_NBR   = :DK-REC-SEQ-NBR                   06029008
060300          AND B.TRBL_RSN_CDE = A.TRBL_RSN_CDE                     06030008
060310          AND B.TRBL_LVL_IND IN ('X', 'L', 'S')                   06031008
060320          AND A.RESOLVED_IND IN ('N','I')                         06032008
060330     END-EXEC                                                     06033008
060340                                                                  06034008
060350     EVALUATE TRUE                                                06035008
060360         WHEN SQLCODE = ZERO                                      06036008
060370         WHEN SQLCODE = +100                                      06037008
060380             CONTINUE                                             06038008
060390         WHEN SQLCODE = -904                                      06039008
060400         WHEN SQLCODE = -911                                      06040008
060410         WHEN SQLCODE = -913                                      06041008
060420             PERFORM 9900-SOFT-ABORT                              06042008
060430                                                                  06043008
060440         WHEN SQLWARN0 NOT = SPACES                               06044008
060450         WHEN SQLCODE < ZERO                                      06045008
060460         WHEN SQLCODE > ZERO                                      06046008
060470             MOVE '5082-CHECK-FOR-LINE-TROUBLE'                   06047008
060480                                      TO DP013-PARAGRAPH          06048008
060490             MOVE 'UNSUCCESSFUL SELECT TROUBLE COUNT'             06049008
060500                                      TO DP013-MESSAGE-TEXT (1)   06050008
060510             MOVE SQLCA               TO DP013-SQLCA              06051008
060520             MOVE 'TTRBNTF '          TO DP013-DB2-TABLE-NAME (1) 06052008
060530             MOVE 'TTRBRSN '          TO DP013-DB2-TABLE-NAME (2) 06053008
060540             SET DP013-DB2-ABEND                                  06054008
060550                 DP013-XCTL-DISPLAY-RESTART                       06055008
060560                                      TO TRUE                     06056008
060570             PERFORM DP013-0000-PROCESS-ABEND                     06057008
060580     END-EVALUATE.                                                06058008
060590                                                                  06059008
060600 5083-CHECK-FOR-PO-TROUBLE.                                       06060008
060610                                                                  06061008
060620     MOVE ZERO           TO  PV-PO-TRBL-COUNT.                    06062008
060630     MOVE ZERO           TO  PV-PO-IN-TROUBLE.                    06063008
060640                                                                  06064008
060650     EXEC SQL                                                     06065008
060660         SELECT A.PO_NBR                                          06066008
060670          INTO :PV-PO-IN-TROUBLE                                  06067008
060680          FROM TTRBNTF A                                          06068008
060690          ,    TTRBRSN B                                          06069008
060700          WHERE A.PO_NBR        = :DK-PO-NBR                      06070008
060710          AND A.REC_SEQ_NBR   = :DK-REC-SEQ-NBR                   06071008
060720          AND B.TRBL_RSN_CDE = A.TRBL_RSN_CDE                     06072008
060730          AND B.TRBL_LVL_IND = 'P'                                06073008
060740          AND A.RESOLVED_IND IN ('N','I')                         06074008
060750        FETCH FIRST 1 ROW ONLY                                    06075008
060760     END-EXEC                                                     06076008
060770                                                                  06077008
060780     EVALUATE TRUE                                                06078008
060790         WHEN SQLCODE = ZERO                                      06079008
060800         WHEN SQLCODE = -811                                      06080008
060810              MOVE 1  TO  PV-PO-TRBL-COUNT                        06081008
060820         WHEN SQLCODE = +100                                      06082008
060830              MOVE 0  TO  PV-PO-TRBL-COUNT                        06083008
060840         WHEN SQLCODE = -904                                      06084008
060850         WHEN SQLCODE = -911                                      06085008
060860         WHEN SQLCODE = -913                                      06086008
060870             PERFORM 9900-SOFT-ABORT                              06087008
060880                                                                  06088008
060890         WHEN SQLWARN0 NOT = SPACES                               06089008
060900         WHEN SQLCODE < ZERO                                      06090008
060910         WHEN SQLCODE > ZERO                                      06091008
060920             MOVE '5083-CHECK-FOR-PO-TROUBLE'                     06092008
060930                                      TO DP013-PARAGRAPH          06093008
060940             MOVE 'UNSUCCESSFUL SELECT TROUBLE COUNT'             06094008
060950                                      TO DP013-MESSAGE-TEXT (1)   06095008
060960             MOVE SQLCA               TO DP013-SQLCA              06096008
060970             MOVE 'TTRBNTF '          TO DP013-DB2-TABLE-NAME (1) 06097008
060980             MOVE 'TTRBRSN '          TO DP013-DB2-TABLE-NAME (2) 06098008
060990             SET DP013-DB2-ABEND                                  06099008
061000                 DP013-XCTL-DISPLAY-RESTART                       06100008
061010                                      TO TRUE                     06101008
061020             PERFORM DP013-0000-PROCESS-ABEND                     06102008
061030     END-EVALUATE.                                                06103008
061040                                                                  06104008
061050                                                                  06105008
061060*----------------------------------------------------------------*06106008
061070* CHECK IF PO/RECEIVER IS IN TROUBLE                             *06107008
061080*----------------------------------------------------------------*06108008
061090 5084-CHECK-TROUBLE.                                              06109008
061100     MOVE ZEROES                   TO PV-NEW-TROUBLE-COUNT.       06110008
061110     MOVE ZERO                     TO  PV-PO-IN-TROUBLE.          06111008
061120                                                                  06112008
061130     EXEC SQL                                                     06113008
061140         SELECT  A.PO_NBR                                         06114008
061150           INTO :PV-PO-IN-TROUBLE                                 06115008
061160           FROM TTRBNTF A                                         06116008
061170               ,TTRBRSN C                                         06117008
061180          WHERE A.PO_NBR        =  :DK-PO-NBR                     06118008
061190            AND A.REC_SEQ_NBR   =  :DK-REC-SEQ-NBR                06119008
061200            AND A.RESOLVED_IND  IN ('N','I','R')                  06120008
061210            AND A.TRBL_RSN_CDE = C.TRBL_RSN_CDE                   06121008
061220            AND C.NOTIF_IND    =  'T'                             06122008
061230            AND A.TRBL_RSN_CDE IN                                 06123008
061240                ( SELECT B.TRBL_RSN_CDE                           06124008
061250                    FROM TTRBRCN B                                06125008
061260                   WHERE B.RPT_PGM_NM    = 'RCKCS213' )           06126008
061270          FETCH FIRST 1 ROW ONLY                                  06127008
061280     END-EXEC                                                     06128008
061290                                                                  06129008
061300     EVALUATE TRUE                                                06130008
061310         WHEN SQLCODE = ZERO                                      06131008
061320         WHEN SQLCODE = -811                                      06132008
061330              MOVE  1  TO  PV-NEW-TROUBLE-COUNT                   06133008
061340              SET   PS-TROUBLE-FOUND TO TRUE                      06134008
061350         WHEN SQLCODE = +100                                      06135008
061360              MOVE  0  TO  PV-NEW-TROUBLE-COUNT                   06136008
061370              SET   PS-NO-TROUBLE-FOUND TO TRUE                   06137008
061380         WHEN SQLWARN0 NOT = SPACES                               06138008
061390         WHEN SQLCODE < ZERO                                      06139008
061400         WHEN SQLCODE > ZERO                                      06140008
061410             MOVE DK-PO-NBR      TO  PV-DISPLAY-PO                06141008
061420             MOVE DK-REC-SEQ-NBR TO  PV-DISPLAY-PO-RCVR           06142008
061430             MOVE '5084-CHECK-TROUBLE      '                      06143008
061440                             TO DP013-PARAGRAPH                   06144008
061450             MOVE 'RCKCS213 - CHECK FOR TROUBLE   '               06145008
061460                             TO DP013-MESSAGE-TEXT(1)             06146008
061470             STRING ' PO, RCVR   '       DELIMITED BY SIZE        06147008
061480                    PV-DISPLAY-PO        DELIMITED BY SIZE        06148008
061490                    ' '                  DELIMITED BY SIZE        06149008
061500                    PV-DISPLAY-PO-RCVR   DELIMITED BY SIZE        06150008
061510                    ' '                  DELIMITED BY SIZE        06151008
061520                             INTO DP013-MESSAGE-TEXT (2)          06152008
061530             MOVE SQLCA      TO DP013-SQLCA                       06153008
061540             MOVE 'TTRBNTF'  TO DP013-DB2-TABLE-NAME(1)           06154008
061550             SET DP013-DB2-ABEND                                  06155008
061560                             TO TRUE                              06156008
061570             SET DP013-ROLLBACK                                   06157008
061580                             TO TRUE                              06158008
061590             SET DP013-XCTL-DISPLAY-RESTART                       06159008
061600                             TO TRUE                              06160008
061610             PERFORM DP013-0000-PROCESS-ABEND                     06161008
061620                                                                  06162008
061630     END-EVALUATE.                                                06163008
061640                                                                  06164008
061650*----------------------------------------------------------------*06165008
061660*    CHECK AND SEE IF THERE ARE SPECIAL INSTRUCTIONS FOR THIS PO *06166008
061670*----------------------------------------------------------------*06167008
061680 5090-CHECK-SPECIAL-INSTR.                                        06168008
061690                                                                  06169008
061700     MOVE ZERO           TO  PV-DB2-COUNT.                        06170008
061710     MOVE ZERO           TO  PV-PO-SPEC-INSTR.                    06171008
061720                                                                  06172008
061730     EXEC SQL                                                     06173008
061740          SELECT  PO_NBR                                          06174008
061750            INTO :PV-PO-SPEC-INSTR                                06175008
061760            FROM TPOINST                                          06176008
061770            WHERE PO_NBR    = :DK-PO-NBR                          06177008
061780              AND RECIP_CDE = 'DC'                                06178008
061790            FETCH FIRST 1 ROW ONLY                                06179008
061800     END-EXEC                                                     06180008
061810                                                                  06181008
061820     EVALUATE TRUE                                                06182008
061830         WHEN SQLCODE = +0                                        06183008
061840         WHEN SQLCODE = -811                                      06184008
061850              MOVE  1  TO  PV-DB2-COUNT                           06185008
061860         WHEN SQLCODE = +100                                      06186008
061870              MOVE  0  TO  PV-DB2-COUNT                           06187008
061880         WHEN SQLCODE = -904                                      06188008
061890         WHEN SQLCODE = -913                                      06189008
061900             CONTINUE                                             06190008
061910                                                                  06191008
061920         WHEN SQLWARN0 NOT = SPACES                               06192008
061930         WHEN SQLCODE < +0                                        06193008
061940         WHEN SQLCODE > +0                                        06194008
061950             MOVE '5090-CHECK-SPECIAL-INSTR'                      06195008
061960                             TO DP013-PARAGRAPH                   06196008
061970             MOVE 'UNSUCCESSFUL SELECT PURCHASE INSTRUCTIONS'     06197008
061980                             TO DP013-MESSAGE-TEXT (1)            06198008
061990             MOVE SQLCA      TO DP013-SQLCA                       06199008
062000             MOVE 'TPOINST ' TO DP013-DB2-TABLE-NAME (1)          06200008
062010             SET DP013-DB2-ABEND                                  06201008
062020                 DP013-XCTL-DISPLAY-RESTART                       06202008
062030                             TO TRUE                              06203008
062040              PERFORM DP013-0000-PROCESS-ABEND                    06204008
062050     END-EVALUATE.                                                06205008
062060                                                                  06206008
062070 5100-WRITE-TEMP-STORAGE.                                         06207008
062080                                                                  06208008
062090     MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)                    06209008
062100                                 TO PV-LIST-ITEM-NUMBER.          06210008
062110     COMPUTE PV-BLOCK-NUMBER = 1 +                                06211008
062120                 ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).06212008
062130                                                                  06213008
062140     IF PV-BLOCK-NUMBER NOT > ASC-HIGHEST-BLOCK-WRITTEN           06214008
062150        IF ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                       06215008
062160                                                                  06216008
062170            PERFORM 5105-REWRITE-ASC-LISTQ                        06217008
062180                                                                  06218008
062190        END-IF                                                    06219008
062200     ELSE                                                         06220008
062210         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       06221008
062220                                     ASC-HIGHEST-BLOCK-WRITTEN + 106222008
062230         PERFORM 5110-WRITE-ASC-LISTQ                             06223008
062240                                                                  06224008
062250         ADD +1                  TO ASC-HIGHEST-BLOCK-WRITTEN     06225008
062260     END-IF.                                                      06226008
062270                                                                  06227008
062280     SET ASC-BLOCK-NOT-MODIFIED (ASC-BLK-SUB)                     06228008
062290                                 TO TRUE.                         06229008
062300                                                                  06230008
062310 5105-REWRITE-ASC-LISTQ.                                          06231008
062320                                                                  06232008
062330     EXEC CICS WRITEQ TS                                          06233008
062340               QUEUE   (ASC-LIST-QUEUE-NAME)                      06234008
062350               FROM    (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))           06235008
062360               ITEM    (PV-BLOCK-NUMBER)                          06236008
062370               REWRITE                                            06237008
062380               RESP    (PV-CICS-RESP)                             06238008
062390     END-EXEC.                                                    06239008
062400                                                                  06240008
062410     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       06241008
062420         SET DP013-CICS-ABEND                                     06242008
062430             DP013-NO-ROLLBACK   TO TRUE                          06243008
062440         MOVE '5105-REWRITE-ASC-LISTQ'                            06244008
062450                                 TO DP013-PARAGRAPH               06245008
062460         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE REWRITE'06246008
062470                                 TO DP013-MESSAGE-TEXT (1)        06247008
062480         PERFORM DP013-0000-PROCESS-ABEND                         06248008
062490     END-IF.                                                      06249008
062500                                                                  06250008
062510 5110-WRITE-ASC-LISTQ.                                            06251008
062520                                                                  06252008
062530     EXEC CICS WRITEQ TS                                          06253008
062540               QUEUE (ASC-LIST-QUEUE-NAME)                        06254008
062550               FROM  (ASC-BLOCK-ENTRIES (ASC-BLK-SUB))            06255008
062560               ITEM  (PV-BLOCK-NUMBER)                            06256008
062570               RESP  (PV-CICS-RESP)                               06257008
062580     END-EXEC.                                                    06258008
062590                                                                  06259008
062600     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      06260008
062610         SET DP013-CICS-ABEND                                     06261008
062620             DP013-NO-ROLLBACK   TO TRUE                          06262008
062630         MOVE '5110-WRITE-ASC-LISTQ'                              06263008
062640                                 TO DP013-PARAGRAPH               06264008
062650         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE WRITE'  06265008
062660                                 TO DP013-MESSAGE-TEXT (1)        06266008
062670         PERFORM DP013-0000-PROCESS-ABEND                         06267008
062680     END-IF.                                                      06268008
062690                                                                  06269008
062700 5200-FILL-SEL-QUEUE-RECORD.                                      06270008
062710                                                                  06271008
062720     PERFORM 6112-READ-LIST-QUEUE.                                06272008
062730                                                                  06273008
062740     IF PV-CICS-RESP = DFHRESP (NORMAL)                           06274008
062750         PERFORM                                                  06275008
062760         VARYING LQW-IDX  FROM 1 BY 1                             06276008
062770         UNTIL   LQW-IDX > PC-ITEMS-PER-PANEL OR                  06277008
062780                 LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO            06278008
062790                                                                  06279008
062800             IF LQW-SELECT (LQW-IDX)                              06280008
062810                 IF LQW-OPER-UNT-ID (LQW-IDX) =  0 AND            06281008
062820                   (DP020-SRC-AID EQUAL DP016-PF13 OR             06282008
062830                    DP020-SRC-AID EQUAL DP016-PF24)               06283008
062840*  PF13 AND PF24 ARE THE LOCAL-GO PFKEYS WHICH WILL NOT ALLOW     06284008
062850*  THE OPER-UNT-ID TO BE EQUAL TO ZERO.                           06285008
062860                     CONTINUE                                     06286008
062870                 ELSE                                             06287008
062880                     ADD 1 TO PV-NUMBER-OF-SELECTED-ITEM          06288008
062890                     MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)          06289008
062900                                 TO RC013-ITEM         (RC013-IDX)06290008
062910                     MOVE LQW-REC-SEQ-NBR      (LQW-IDX)          06291008
062920                                 TO RC013-REC-SEQ-NBR  (RC013-IDX)06292008
062930                                    PV-FIRST-REC-SEQ-NBR          06293008
062940                     MOVE ASC-KEY-PO-NBR-N                        06294008
062950                                      TO RC013-PO-NBR(RC013-IDX)  06295008
062960                     MOVE LQW-PKSL-STAT-CDE    (LQW-IDX)          06296008
062970                                 TO RC013-PKSL-STAT-CDE(RC013-IDX)06297008
062980                     MOVE LQW-STR-DEST-NBR     (LQW-IDX)          06298008
062990                                 TO RC013-STR-NBR      (RC013-IDX)06299008
063000                                                                  06300008
063010*                    GET THE REAL PRO-NBR NOT THE SHORTENED ONE   06301008
063020                     MOVE ASC-KEY-PO-NBR-N TO DK-PO-NBR           06302008
063030                     MOVE LQW-SEQ-NBR          (LQW-IDX)          06303008
063040                                      TO DK-SEQ-NBR               06304008
063050                     PERFORM 7520-GET-PKSLIP-PRO-NBR              06305008
063060                     MOVE PKSLIP-PRO-NBR                          06306008
063070                                 TO RC013-PRO-NBR      (RC013-IDX)06307008
063080*                    MOVE LQW-PRO-NBR          (LQW-IDX)          06308008
063090*                                TO RC013-PRO-NBR      (RC013-IDX)06309008
063100                                                                  06310008
063110                     IF DP020-FK-LOCAL-FUNC-04(DP020-SRC-AID)     06311008
063120                         ADD LQW-CARTON-COUNT(LQW-IDX)            06312008
063130                                 TO RC015-CARTON-CNT              06313008
063140                     END-IF                                       06314008
063150                                                                  06315008
063160                     MOVE LQW-BOL-NBR          (LQW-IDX)          06316008
063170                                 TO RC013-BOL-NBR      (RC013-IDX)06317008
063180                                                                  06318008
063190                                                                  06319008
063200                     MOVE LQW-SCAC-ID          (LQW-IDX)          06320008
063210                                 TO RC013-OWNER-SCAC-ID(RC013-IDX)06321008
063220                                                                  06322008
063230                     MOVE LQW-VND-SHP-DTE      (LQW-IDX)          06323008
063240                                 TO RC013-VND-SHP-DTE(RC013-IDX)  06324008
063250                                                                  06325008
063260                     MOVE LQW-OPER-UNT-ID      (LQW-IDX)          06326008
063270                                 TO RC013-OPER-UNT-ID  (RC013-IDX)06327008
063280                     MOVE ASC-KEY-FCLTY-ID                        06328008
063290                                 TO RC013-FCLTY-ID (RC013-IDX)    06329008
063300                     MOVE LQW-PKSL-NBR         (LQW-IDX)          06330008
063310                                 TO RC013-PKSL-NBR     (RC013-IDX)06331008
063320                     MOVE LQW-SEQ-NBR          (LQW-IDX)          06332008
063330                                 TO RC013-SEQ-NBR      (RC013-IDX)06333008
063340                     MOVE SPACE  TO RC013-ACTION-SW    (RC013-IDX)06334008
063350                                                                  06335008
063360                     IF DP020-SRC-AID EQUAL DP016-PF19            06336008
063370                          PERFORM 5250-CHECK-DUP-INFO             06337008
063380                     END-IF                                       06338008
063390                                                                  06339008
063400                     IF (DP020-SRC-AID NOT EQUAL DP016-PF15       06340008
063410                     AND DP020-SRC-AID NOT EQUAL DP016-PF17       06341008
063420                     AND DP020-SRC-AID NOT EQUAL DP016-PF20       06342008
063430                     AND DP020-SRC-AID NOT EQUAL DP016-PF22)      06343008
063440                         PERFORM 5075-COUNT-TRECITMS              06344008
063450                         IF  PV-DB2-COUNT GREATER THAN ZERO       06345008
063460                           SET PS-ERROR                           06346008
063470                               DP020-MSG-FATAL                    06347008
063480                                   TO TRUE                        06348008
063490                           MOVE PC-TSYMSG-00966                   06349008
063500                                       TO DP020-MSG-NUMBER        06350008
063510                           MOVE PC-ERR TO  LQW-ACTION(LQW-IDX)    06351008
063520                           MOVE PV-ITEM TO PV-SAVE-ITEM           06352008
063530                           PERFORM 6111-WRITE-LIST-QUEUE          06353008
063540                         END-IF                                   06354008
063550                     END-IF                                       06355008
063560                                                                  06356008
063570                   SET RC013-IDX UP BY 1                          06357008
063580                   IF RC013-IDX > RC013-MAX-ITEMS                 06358008
063590                                                                  06359008
063600                       PERFORM 5205-WRITE-SEL-QUEUE               06360008
063610                                                                  06361008
063620                       ADD +1      TO RC015-NUMBER-OF-TS-ITEMS    06362008
063630                       INITIALIZE RC013-SELECTED-ITEM-ARRAY       06363008
063640                       SET RC013-IDX                              06364008
063650                                   TO 1                           06365008
063660                   END-IF                                         06366008
063670                 END-IF                                           06367008
063680             END-IF                                               06368008
063690         END-PERFORM                                              06369008
063700     END-IF.                                                      06370008
063710                                                                  06371008
063720 5205-WRITE-SEL-QUEUE.                                            06372008
063730                                                                  06373008
063740     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            06374008
063750                                 TO RC013-SELECTED-ITEMS.         06375008
063760                                                                  06376008
063770     EXEC CICS WRITEQ TS                                          06377008
063780               QUEUE (ASC-SEL-QUEUE-NAME-OUT)                     06378008
063790               FROM  (RC013-DC-SELECT-RECORD)                     06379008
063800               ITEM  (PV-SEL-QUEUE-ITEM)                          06380008
063810               RESP  (PV-CICS-RESP)                               06381008
063820     END-EXEC.                                                    06382008
063830                                                                  06383008
063840     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       06384008
063850         SET DP013-CICS-ABEND                                     06385008
063860             DP013-NO-ROLLBACK   TO TRUE                          06386008
063870         MOVE '5205-WRITE-SEL-QUEUE'                              06387008
063880                                 TO DP013-PARAGRAPH               06388008
063890         MOVE 'UNSUCCESSFUL SEL ITEMS TEMP STORAGE QUEUE WRITE'   06389008
063900                                 TO DP013-MESSAGE-TEXT (1)        06390008
063910         PERFORM DP013-0000-PROCESS-ABEND                         06391008
063920     END-IF.                                                      06392008
063930                                                                  06393008
063940                                                                  06394008
063950 5250-CHECK-DUP-INFO.                                             06395008
063960                                                                  06396008
063970* CHECK CURRENT PRO NUMBER AGAINST THE SAVED THE PRO NUMBER       06397008
063980     IF PV-SAVE-PRO-NBR = SPACES                                  06398008
063990         MOVE LQW-PRO-NBR (LQW-IDX)    TO PV-SAVE-PRO-NBR         06399008
064000     END-IF.                                                      06400008
064010                                                                  06401008
064020     IF LQW-PRO-NBR (LQW-IDX) = PV-SAVE-PRO-NBR                   06402008
064030     OR LQW-PRO-NBR (LQW-IDX) = SPACES                            06403008
064040         CONTINUE                                                 06404008
064050     ELSE                                                         06405008
064060         SET PS-NO-MATCH       TO TRUE                            06406008
064070     END-IF.                                                      06407008
064080                                                                  06408008
064090                                                                  06409008
064100* CHECK CURRENT BOL NUMBER AGAINST THE SAVED THE BOL NUMBER       06410008
064110     IF PV-SAVE-BOL-NBR = SPACES                                  06411008
064120         MOVE LQW-BOL-NBR (LQW-IDX)      TO PV-SAVE-BOL-NBR       06412008
064130     END-IF.                                                      06413008
064140                                                                  06414008
064150     IF LQW-BOL-NBR (LQW-IDX) = PV-SAVE-BOL-NBR                   06415008
064160     OR LQW-BOL-NBR (LQW-IDX) = SPACES                            06416008
064170         CONTINUE                                                 06417008
064180     ELSE                                                         06418008
064190         SET PS-NO-MATCH       TO TRUE                            06419008
064200     END-IF.                                                      06420008
064210                                                                  06421008
064220                                                                  06422008
064230* CHECK CURRENT SCAC ID AGAINST THE SAVED SCAC ID                 06423008
064240     IF PV-SAVE-SCAC-ID = SPACES                                  06424008
064250         MOVE LQW-SCAC-ID (LQW-IDX)      TO PV-SAVE-SCAC-ID       06425008
064260     END-IF.                                                      06426008
064270                                                                  06427008
064280     IF LQW-SCAC-ID (LQW-IDX) = PV-SAVE-SCAC-ID                   06428008
064290     OR LQW-SCAC-ID (LQW-IDX) = SPACES                            06429008
064300         CONTINUE                                                 06430008
064310     ELSE                                                         06431008
064320         SET PS-NO-MATCH       TO TRUE                            06432008
064330     END-IF.                                                      06433008
064340                                                                  06434008
064350                                                                  06435008
064360* CHECK CURRENT VENDOR SHIP DATA AGAINST THE SAVED VENDOR SHIP DAT06436008
064370     IF PV-SAVE-VND-SHP-DTE = SPACES                              06437008
064380         MOVE LQW-VND-SHP-DTE  (LQW-IDX) TO PV-SAVE-VND-SHP-DTE   06438008
064390     END-IF.                                                      06439008
064400                                                                  06440008
064410     IF LQW-VND-SHP-DTE (LQW-IDX)  = PV-SAVE-VND-SHP-DTE          06441008
064420     OR LQW-VND-SHP-DTE (LQW-IDX)  = SPACES                       06442008
064430         CONTINUE                                                 06443008
064440     ELSE                                                         06444008
064450         SET PS-NO-MATCH       TO TRUE                            06445008
064460     END-IF.                                                      06446008
064470                                                                  06447008
064480                                                                  06448008
064490 5300-SEARCH-FOR-SELECTION.                                       06449008
064500                                                                  06450008
064510     PERFORM 6112-READ-LIST-QUEUE.                                06451008
064520                                                                  06452008
064530     IF PV-CICS-RESP = DFHRESP (NORMAL)                           06453008
064540         PERFORM                                                  06454008
064550               VARYING LQW-IDX  FROM 1 BY 1                       06455008
064560               UNTIL   LQW-IDX > PC-ITEMS-PER-PANEL OR            06456008
064570                       LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO      06457008
064580                                                                  06458008
064590         EVALUATE TRUE                                            06459008
064600         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              06460008
064610* ADD TO RECEIVER                                                 06461008
064620             IF LQW-SELECT (LQW-IDX)                              06462008
064630                 PERFORM 5310-CHECK-STATUS-FOR-INACTIVE           06463008
064640                 PERFORM 5311-OTHER-EDITS                         06464008
064650                 PERFORM 5051-GET-PKGNG-CDE                       06465008
064660                 ADD +1          TO RC015-NUMBER-OF-TS-ITEMS      06466008
064670             END-IF                                               06467008
064680         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              06468008
064690* TRANSCRIBE                                                      06469008
064700             IF LQW-SELECT (LQW-IDX)                              06470008
064710                 PERFORM 5310-CHECK-STATUS-FOR-INACTIVE           06471008
064720                 PERFORM 5311-OTHER-EDITS                         06472008
064730                 PERFORM 5051-GET-PKGNG-CDE                       06473008
064740                 ADD +1          TO RC015-NUMBER-OF-TS-ITEMS      06474008
064750             END-IF                                               06475008
064760         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              06476008
064770             IF LQW-SELECT (LQW-IDX)                              06477008
064780                 PERFORM 5310-CHECK-STATUS-FOR-INACTIVE           06478008
064790                 PERFORM 5312-DESELECT-ERROR                      06479008
064800                 ADD +1          TO RC015-NUMBER-OF-TS-ITEMS      06480008
064810             END-IF                                               06481008
064820         WHEN OTHER                                               06482008
064830             IF LQW-SELECT (LQW-IDX)                              06483008
064840                 PERFORM 5310-CHECK-STATUS-FOR-INACTIVE           06484008
064850                 PERFORM 5311-OTHER-EDITS                         06485008
064860                 ADD +1          TO RC015-NUMBER-OF-TS-ITEMS      06486008
064870             END-IF                                               06487008
064880         END-EVALUATE                                             06488008
064890         END-PERFORM                                              06489008
064900     END-IF.                                                      06490008
064910                                                                  06491008
064920 5310-CHECK-STATUS-FOR-INACTIVE.                                  06492008
064930                                                                  06493008
064940     IF LQW-PKSL-STAT-CDE (LQW-IDX) = 'IN'                        06494008
064950         CONTINUE                                                 06495008
064960     ELSE                                                         06496008
064970         MOVE PC-ERR             TO LQW-ACTION (LQW-IDX)          06497008
064980         IF PS-ERROR                                              06498008
064990         OR DP020-SRC-AID EQUAL DP016-PF20                        06499008
065000             CONTINUE                                             06500008
065010         ELSE                                                     06501008
065020             SET PS-ERROR        TO TRUE                          06502008
065030             MOVE PC-TSYMSG-00723                                 06503008
065040                                 TO DP020-MSG-NUMBER              06504008
065050         END-IF                                                   06505008
065060     END-IF.                                                      06506008
065070                                                                  06507008
065080 5311-OTHER-EDITS.                                                06508008
065090     MOVE '5311-OTHER-EDITS' TO PV-LAST-PARAGRAPH                 06509008
065100     IF ASC-CAME-FROM-PACK-SLIP                                   06510008
065110         IF LQW-REC-SEQ-NBR (LQW-IDX) = ZEROS                     06511008
065120             MOVE PC-ERR         TO LQW-ACTION (LQW-IDX)          06512008
065130             IF PS-ERROR                                          06513008
065140                 CONTINUE                                         06514008
065150             ELSE                                                 06515008
065160                 SET PS-ERROR    TO TRUE                          06516008
065170                 MOVE PC-TSYMSG-00737                             06517008
065180                                 TO DP020-MSG-NUMBER              06518008
065190             END-IF                                               06519008
065200         ELSE                                                     06520008
065210             MOVE LQW-REC-SEQ-NBR (LQW-IDX)                       06521008
065220                                 TO DK-REC-SEQ-NBR                06522008
065230             IF PV-FIRST-REC-SEQ-NBR = ZEROS                      06523008
065240                 MOVE LQW-REC-SEQ-NBR (LQW-IDX)                   06524008
065250                                 TO PV-FIRST-REC-SEQ-NBR          06525008
065260                                    DK-REC-SEQ-NBR                06526008
065270                 PERFORM 7500-GET-PACK-BY-STR-IND                 06527008
065280                 PERFORM 7510-CHECK-FOR-DC                        06528008
065290             ELSE                                                 06529008
065300                 IF PV-FIRST-REC-SEQ-NBR NOT =                    06530008
065310                    LQW-REC-SEQ-NBR (LQW-IDX)                     06531008
065320                     MOVE PC-ERR TO LQW-ACTION (LQW-IDX)          06532008
065330                     IF PS-ERROR                                  06533008
065340                         CONTINUE                                 06534008
065350                     ELSE                                         06535008
065360                         SET PS-ERROR                             06536008
065370                                 TO TRUE                          06537008
065380                         MOVE PC-TSYMSG-01525                     06538008
065390                                 TO DP020-MSG-NUMBER              06539008
065400                     END-IF                                       06540008
065410                 END-IF                                           06541008
065420             END-IF                                               06542008
065430         END-IF                                                   06543008
065440     ELSE                                                         06544008
065450         MOVE ASC-KEY-REC-SEQ-NBR                                 06545008
065460                                 TO LQW-REC-SEQ-NBR (LQW-IDX)     06546008
065470                                    PV-FIRST-REC-SEQ-NBR          06547008
065480                                    DK-REC-SEQ-NBR                06548008
065490     END-IF.                                                      06549008
065500                                                                  06550008
065510     IF LQW-STR-DEST-NBR (LQW-IDX) = 0                            06551008
065520         IF ASC-PACK-BY-ST-IND = 'Y'                              06552008
065530             MOVE PC-ERR         TO LQW-ACTION (LQW-IDX)          06553008
065540             IF PS-ERROR                                          06554008
065550                 CONTINUE                                         06555008
065560             ELSE                                                 06556008
065570                 SET PS-ERROR    TO TRUE                          06557008
065580                 MOVE PC-TSYMSG-00818                             06558008
065590                                 TO DP020-MSG-NUMBER              06559008
065600             END-IF                                               06560008
065610         END-IF                                                   06561008
065620     ELSE                                                         06562008
065630         IF ASC-PACK-BY-ST-IND = 'Y'                              06563008
065640             PERFORM 7385-COUNT-SMOOTHED-CTNS                     06564008
065650             IF PV-SMOOTH-COUNT > ZERO                            06565008
065660                 SET PS-ERROR                                     06566008
065670                     ASC-INACTIVATE-NOT-PENDING                   06567008
065680                     DP020-MSG-FATAL TO TRUE                      06568008
065690                 MOVE PC-TSYMSG-02745 TO                          06569008
065700                                  DP020-MSG-NUMBER                06570008
065710                 MOVE PC-ERR TO  LQW-ACTION(LQW-IDX)              06571008
065720                 MOVE PV-ITEM TO PV-SAVE-ITEM                     06572008
065730                 PERFORM 6111-WRITE-LIST-QUEUE                    06573008
065740             ELSE                                                 06574008
065750                 PERFORM 5315-CHECK-STORE                         06575008
065760                 IF (XL071-LOC-TYP-CDE  = 'DS'                    06576008
065770                                       OR 'DC'                    06577008
065780                                       OR 'CS'                    06578008
065790                                       OR 'RV')                   06579008
065800                   AND (PV-CURRENT-DATE NOT <                     06580008
065810                         XL071-ASGMT-EFF-BEG-DTE)                 06581008
065820                   AND (PV-CURRENT-DATE NOT >                     06582008
065830                         XL071-ASGMT-EFF-STP-DTE)                 06583008
065840                     PERFORM 5317-ADD-STORE                       06584008
065850                     IF PS-DUP-STORE                              06585008
065860                         SET PS-ERROR    TO TRUE                  06586008
065870                         MOVE PC-TSYMSG-00976                     06587008
065880                                     TO DP020-MSG-NUMBER          06588008
065890                     ELSE                                         06589008
065900                     IF PS-TABLE-FULL                             06590008
065910                         SET PS-ERROR    TO TRUE                  06591008
065920                         MOVE 'STORE'    TO  DP020-MSG-TEXT       06592008
065930                         MOVE PC-TSYMSG-01529                     06593008
065940                                         TO DP020-MSG-NUMBER      06594008
065950                     ELSE                                         06595008
065960                         CONTINUE                                 06596008
065970                     END-IF                                       06597008
065980             ELSE                                                 06598008
065990                 MOVE PC-ERR         TO LQW-ACTION (LQW-IDX)      06599008
066000                 IF PS-ERROR                                      06600008
066010                     CONTINUE                                     06601008
066020                 ELSE                                             06602008
066030                     SET PS-ERROR    TO TRUE                      06603008
066040                     MOVE PC-TSYMSG-01263                         06604008
066050                                     TO DP020-MSG-NUMBER          06605008
066060                 END-IF                                           06606008
066070             END-IF                                               06607008
066080         ELSE                                                     06608008
066090             MOVE PC-ERR         TO LQW-ACTION (LQW-IDX)          06609008
066100             IF PS-ERROR                                          06610008
066110                 CONTINUE                                         06611008
066120             ELSE                                                 06612008
066130                 SET PS-ERROR    TO TRUE                          06613008
066140                 MOVE PC-TSYMSG-00818                             06614008
066150                                 TO DP020-MSG-NUMBER              06615008
066160             END-IF                                               06616008
066170         END-IF                                                   06617008
066180     END-IF.                                                      06618008
066190                                                                  06619008
066200     IF LQW-STR-DEST-NBR (LQW-IDX) = 0                            06620008
066210         ADD 1                   TO PV-BULK-STR-CNT               06621008
066220         SET PS-BULK-SHIPMENT    TO TRUE                          06622008
066230     ELSE                                                         06623008
066240         ADD 1                   TO PV-PACK-BY-STR-CNT            06624008
066250         SET PS-PACKED-BY-STORE  TO TRUE                          06625008
066260     END-IF.                                                      06626008
066270                                                                  06627008
066280     IF LQW-OPER-UNT-ID (LQW-IDX) = 0                             06628008
066290         MOVE PC-ERR         TO LQW-ACTION (LQW-IDX)              06629008
066300         IF PS-ERROR                                              06630008
066310             CONTINUE                                             06631008
066320         ELSE                                                     06632008
066330             SET PS-ERROR    TO TRUE                              06633008
066340             MOVE PC-TSYMSG-00955                                 06634008
066350                             TO DP020-MSG-NUMBER                  06635008
066360         END-IF                                                   06636008
066370     END-IF.                                                      06637008
066380     MOVE LQW-SEQ-NBR(LQW-IDX)          TO DK-SEQ-NBR.            06638008
066390                                                                  06639008
066400                                                                  06640008
066410 5312-DESELECT-ERROR.                                             06641008
066420     IF LQW-ACTION (LQW-IDX) = PC-ERR                             06642008
066430         SET LQW-DESELECT (LQW-IDX)                               06643008
066440                                 TO TRUE                          06644008
066450         MOVE LQW-SELECTED-SW (LQW-IDX)                           06645008
066460                                 TO LQW-TEMP-SELECTED-SW (LQW-IDX)06646008
066470         MOVE PV-ITEM            TO PV-SAVE-ITEM                  06647008
066480         PERFORM 6111-WRITE-LIST-QUEUE                            06648008
066490     END-IF.                                                      06649008
066500                                                                  06650008
066510 5315-CHECK-STORE.                                                06651008
066520     INITIALIZE XL071-COMMAREA-REC.                               06652008
066530     MOVE LQW-STR-DEST-NBR (LQW-IDX)  TO XL071-LOCATION-NUMBER.   06653008
066540                                                                  06654008
066550     CALL XL071-LOCATION-MODULE  USING  DFHEIBLK                  06655008
066560                                        XL071-COMMAREA            06656008
066570                                        XL071-COMMAREA-REC.       06657008
066580                                                                  06658008
066590     EVALUATE TRUE                                                06659008
066600         WHEN XL071-NO-ERRORS                                     06660008
066610         WHEN XL071-LOC-NOT-FOUND                                 06661008
066620         WHEN XL071-DC-ASGMT-NOT-FND                              06662008
066630             CONTINUE                                             06663008
066640         WHEN XL071-SQLCODE-N = -904                              06664008
066650         WHEN XL071-SQLCODE-N = -911                              06665008
066660         WHEN XL071-SQLCODE-N = -913                              06666008
066670             PERFORM 9900-SOFT-ABORT                              06667008
066680         WHEN OTHER                                               06668008
066690              MOVE '5315-CHECK-STORE'                             06669008
066700                               TO DP013-PARAGRAPH                 06670008
066710              MOVE 'UNSUCCESSFUL SELECT STORE TABLE'              06671008
066720                               TO DP013-MESSAGE-TEXT (1)          06672008
066730              MOVE XL071-SQLCA TO DP013-SQLCA                     06673008
066740              MOVE 'XLT_LOC '  TO DP013-DB2-TABLE-NAME (1)        06674008
066750              MOVE 'XLT_DC_ASGMT_LOC'                             06675008
066760                               TO DP013-DB2-TABLE-NAME (2)        06676008
066770              SET DP013-DB2-ABEND                                 06677008
066780                  DP013-XCTL-DISPLAY-RESTART                      06678008
066790                              TO TRUE                             06679008
066800              PERFORM DP013-0000-PROCESS-ABEND                    06680008
066810     END-EVALUATE.                                                06681008
066820                                                                  06682008
066830 5317-ADD-STORE.                                                  06683008
066840     SET PS-INSERT-TO-TABLE TO TRUE                               06684008
066850     PERFORM VARYING PST-IDX FROM 1 BY 1                          06685008
066860         UNTIL PS-INSERT-STORE OR                                 06686008
066870               PS-DUP-STORE OR                                    06687008
066880               PS-TABLE-FULL                                      06688008
066890         IF PST-STORE-NBR (PST-IDX) = ZERO                        06689008
066900             MOVE XL071-LOCATION-NUMBER                           06690008
066910                                  TO PST-STORE-NBR (PST-IDX)      06691008
066920             SET PS-INSERT-STORE  TO TRUE                         06692008
066930         ELSE                                                     06693008
066940             IF PST-STORE-NBR (PST-IDX) =                         06694008
066950                                   XL071-LOCATION-NUMBER          06695008
066960                 SET PS-DUP-STORE TO TRUE                         06696008
066970             ELSE                                                 06697008
066980                 IF PST-STORE-NBR (PST-IDX) = 9999                06698008
066990                     SET PS-TABLE-FULL TO TRUE                    06699008
067000                 END-IF                                           06700008
067010             END-IF                                               06701008
067020         END-IF                                                   06702008
067030     END-PERFORM.                                                 06703008
067040/                                                                 06704008
067050 5320-FIND-SELECTION-TO-UPDATE.                                   06705008
067060                                                                  06706008
067070* PERFORMED BY FUNC-01 AND FUNC-03. ADD-TO-RCVR AND TRANSCRIPTION 06707008
067080                                                                  06708008
067090     SET PS-NO-ERROR-MSG         TO  TRUE.                        06709008
067100     PERFORM 6112-READ-LIST-QUEUE.                                06710008
067110                                                                  06711008
067120     IF PV-CICS-RESP = DFHRESP (NORMAL)                           06712008
067130         PERFORM                                                  06713008
067140         VARYING LQW-IDX  FROM 1 BY 1                             06714008
067150         UNTIL   LQW-IDX > PC-ITEMS-PER-PANEL OR                  06715008
067160                 LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO            06716008
067170                                                                  06717008
067180             IF LQW-SELECT (LQW-IDX)                              06718008
067190                                                                  06719008
067200*  (NEW RECDIS ROWS GET WRITTEN HERE)                             06720008
067210                 IF ASC-TRECEIV-PKGNG-CDE = 'M' OR 'I'            06721008
067220                                                                  06722008
067230* THIS IS ONLY PERFORMED BY FUNC-01 OR FUNC-03                    06723008
067240*                    AND                                          06724008
067250*                  ( DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)       06725008
067260*                    OR DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID) )  06726008
067270                                                                  06727008
067280                     MOVE LQW-SEQ-NBR (LQW-IDX) TO PKSLIP-SEQ-NBR 06728008
067290                     PERFORM 7001-STAGE-PREPACKS                  06729008
067300                 ELSE                                             06730008
067310                     MOVE LQW-SEQ-NBR (LQW-IDX) TO PKSLIP-SEQ-NBR 06731008
067320                     PERFORM 7000-SUM-RECEIPTS                    06732008
067330                     ADD +1          TO RC015-NUMBER-OF-TS-ITEMS  06733008
067340                 END-IF                                           06734008
067350             END-IF                                               06735008
067360         END-PERFORM                                              06736008
067370                                                                  06737008
067380     END-IF.                                                      06738008
067390                                                                  06739008
067400     MOVE PV-ITEM                TO PV-SAVE-ITEM.                 06740008
067410     PERFORM 6111-WRITE-LIST-QUEUE.                               06741008
067420                                                                  06742008
067430                                                                  06743008
067440 5322-STORE-OVERAGES.                                             06744008
067450                                                                  06745008
067460     INITIALIZE TM508-COMMAREA.                                   06746008
067470     MOVE DK-PO-NBR               TO TM508-PO-NBR                 06747008
067480     MOVE DK-REC-SEQ-NBR          TO TM508-REC-SEQ-NBR            06748008
067490     MOVE DK-OPER-UNT-ID          TO TM508-OPER-UNT-ID            06749008
067500     MOVE DK-FCLTY-ID             TO TM508-FCLTY-ID               06750008
067510                                                                  06751008
067520     EXEC CICS LINK                                               06752008
067530         PROGRAM  ('TMKCS508')                                    06753008
067540         COMMAREA (TM508-COMMAREA)                                06754008
067550         RESP     (PV-CICS-RESP)                                  06755008
067560     END-EXEC.                                                    06756008
067570                                                                  06757008
067580     IF PV-CICS-RESP = DFHRESP(NORMAL)                            06758008
067590         CONTINUE                                                 06759008
067600     ELSE                                                         06760008
067610         SET DP013-CICS-ABEND                                     06761008
067620             DP013-NO-ROLLBACK   TO TRUE                          06762008
067630         MOVE '5322-STORE-OVERAGES'                               06763008
067640                                 TO DP013-PARAGRAPH               06764008
067650         MOVE 'UNSUCCESSFUL LINK TO TMKCS508'                     06765008
067660                                 TO DP013-MESSAGE-TEXT (1)        06766008
067670         PERFORM DP013-0000-PROCESS-ABEND                         06767008
067680     END-IF.                                                      06768008
067690     MOVE ASC-KEY-PO-NBR       TO PV-MSG-KEY-PO                   06769008
067700     MOVE RECITM-ORD-LNE-NBR   TO PV-MSG-KEY-PO-LNE-NBR-N         06770008
067710     MOVE PKSLIP-REC-SEQ-NBR   TO PV-MSG-KEY-REC-SEQ-NBR-N        06771008
067720     MOVE DK-STR-DEST-NBR      TO PV-MSG-KEY-STR-NBR              06772008
067730     MOVE DP020-USERID         TO PV-MSG-USER-ID                  06773008
067740     MOVE ASC-KEY-OPER-UNT-ID  TO PV-MSG-OPER-ID                  06774008
067750                                                                  06775008
067760     EVALUATE TRUE                                                06776008
067770     WHEN TM508-RETURN-CODE = ZERO                                06777008
067780         IF TM508-TROUBLE-COUNT > ZERO                            06778008
067790             MOVE TM508-TROUBLE-COUNT TO PV-TROUBLE-COUNT         06779008
067800         END-IF                                                   06780008
067810     WHEN TM508-RETURN-CODE = 11                                  06781008
067820          INITIALIZE PV-CICS-MSG-AREA                             06782008
067830          STRING 'RCKCS213-'                                      06783008
067840                 '5322-STORE-OVERAGES'                            06784008
067850                               DELIMITED BY SIZE                  06785008
067860                               INTO PV-CICS-MSG-AREA              06786008
067870          PERFORM 9903-WRITE-CICS-LOG                             06787008
067880          INITIALIZE PV-CICS-MSG-AREA                             06788008
067890          STRING PV-MSG-KEYS                                      06789008
067900                 PV-MSG-KEYS-1                                    06790008
067910                               DELIMITED BY SIZE                  06791008
067920                               INTO PV-CICS-MSG-AREA              06792008
067930          PERFORM 9903-WRITE-CICS-LOG                             06793008
067940          MOVE PC-TSYMSG-03687        TO DP020-MSG-NUMBER         06794008
067950          SET PS-ERROR                                            06795008
067960              DP020-MSG-FATAL         TO TRUE                     06796008
067970          MOVE 'PROGRAM EXIT CALL'    TO DP013-MESSAGE-TEXT (1)   06797008
067980          PERFORM 0001-CALL-CICS-ARCH-API                         06798008
067990     WHEN TM508-RETURN-CODE = 12                                  06799008
068000          INITIALIZE PV-CICS-MSG-AREA                             06800008
068010          STRING 'RCKCS213-'                                      06801008
068020                 '5322-STORE-OVERAGES'                            06802008
068030                               DELIMITED BY SIZE                  06803008
068040                               INTO PV-CICS-MSG-AREA              06804008
068050          PERFORM 9903-WRITE-CICS-LOG                             06805008
068060          INITIALIZE PV-CICS-MSG-AREA                             06806008
068070          STRING PV-MSG-KEYS                                      06807008
068080                 PV-MSG-KEYS-1                                    06808008
068090                               DELIMITED BY SIZE                  06809008
068100                               INTO PV-CICS-MSG-AREA              06810008
068110          PERFORM 9903-WRITE-CICS-LOG                             06811008
068120          MOVE PC-TSYMSG-03688        TO DP020-MSG-NUMBER         06812008
068130          SET PS-ERROR                                            06813008
068140              DP020-MSG-FATAL         TO TRUE                     06814008
068150          MOVE 'PROGRAM EXIT CALL'    TO DP013-MESSAGE-TEXT (1)   06815008
068160          PERFORM 0001-CALL-CICS-ARCH-API                         06816008
068170     WHEN TM508-RETURN-CODE = 13                                  06817008
068180          INITIALIZE PV-CICS-MSG-AREA                             06818008
068190          STRING 'RCKCS213-'                                      06819008
068200                 '5322-STORE-OVERAGES'                            06820008
068210                               DELIMITED BY SIZE                  06821008
068220                               INTO PV-CICS-MSG-AREA              06822008
068230          PERFORM 9903-WRITE-CICS-LOG                             06823008
068240          INITIALIZE PV-CICS-MSG-AREA                             06824008
068250          STRING PV-MSG-KEYS                                      06825008
068260                 PV-MSG-KEYS-1                                    06826008
068270                               DELIMITED BY SIZE                  06827008
068280                               INTO PV-CICS-MSG-AREA              06828008
068290          PERFORM 9903-WRITE-CICS-LOG                             06829008
068300          MOVE PC-TSYMSG-00984        TO DP020-MSG-NUMBER         06830008
068310          SET PS-ERROR                                            06831008
068320              DP020-MSG-WARNING       TO TRUE                     06832008
068330          MOVE 'PROGRAM EXIT CALL'    TO DP013-MESSAGE-TEXT (1)   06833008
068340          PERFORM 0001-CALL-CICS-ARCH-API                         06834008
068350     WHEN OTHER                                                   06835008
068360         EVALUATE TRUE                                            06836008
068370         WHEN TM508-SOFT-ABORT                                    06837008
068380         WHEN TM508-CROAK                                         06838008
068390             IF TM508-MSG-NUMBER = 0                              06839008
068400                CONTINUE                                          06840008
068410             ELSE                                                 06841008
068420               PERFORM 2460-SELECT-TRECEIV                        06842008
068430               PERFORM 2450-CHECK-TKRPRPM                         06843008
068440               IF PS-ASNS-TO-WMS-YES                              06844008
068450                  PERFORM 2500-GET-SHIPMENT-INFO                  06845008
068460                  PERFORM 2700-SELECT-TVHTRIP                     06846008
068470                  IF PS-VALID-TRIP                                06847008
068480* JAK 04/2007 - ADD CALL TO 2750 AND CHECK FOR TROUBLE            06848008
068490* JAK 06/2007 - REMOVE CHECK OF TRECDIS                           06849008
068500***                  PERFORM 2750-SELECT-TRECDIS                  06850008
068510***                  IF PS-DISTRO-TROUBLE-NO                      06851008
068520                        SET WS001-INSERT  TO TRUE                 06852008
068530                        SET PS-LOAD-LNE-NBR-NO    TO TRUE         06853008
068540                        PERFORM 2800-CALL-WMS-MODULE              06854008
068550***                  END-IF                                       06855008
068560                  END-IF                                          06856008
068570               END-IF                                             06857008
068580             END-IF                                               06858008
068590             PERFORM 9900-SOFT-ABORT                              06859008
068600         WHEN OTHER                                               06860008
068610             MOVE TM508-SEVERITY-IND                              06861008
068620                                 TO DP020-MSG-SEVERITY-IND        06862008
068630             MOVE +1096          TO DP020-MSG-NUMBER              06863008
068640         END-EVALUATE                                             06864008
068650     END-EVALUATE.                                                06865008
068660                                                                  06866008
068670 5330-UPDATE-SELECTED-PACKSLIPS.                                  06867008
068680     MOVE '5330-UPDATE-SELECTED-PACKSLIPS'   TO PV-LAST-PARAGRAPH 06868008
068690     PERFORM 6112-READ-LIST-QUEUE.                                06869008
068700                                                                  06870008
068710     IF PV-CICS-RESP = DFHRESP (NORMAL)                           06871008
068720         PERFORM                                                  06872008
068730         VARYING LQW-IDX  FROM 1 BY 1                             06873008
068740         UNTIL   LQW-IDX > PC-ITEMS-PER-PANEL OR                  06874008
068750                 LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO            06875008
068760             IF LQW-SELECT (LQW-IDX)                              06876008
068770                 SET LQW-DESELECT (LQW-IDX)                       06877008
068780                                     TO TRUE                      06878008
068790                 MOVE LQW-SELECTED-SW (LQW-IDX)                   06879008
068800                                 TO LQW-TEMP-SELECTED-SW (LQW-IDX)06880008
068810                 MOVE LQW-SEQ-NBR (LQW-IDX)  TO PKSLIP-SEQ-NBR    06881008
068820                 PERFORM 5520-COUNT-PKITEM-RECS                   06882008
068830                 IF PV-COUNT-PKITEM > ZERO                        06883008
068840                     MOVE 'AC'       TO PV-NEW-STATUS             06884008
068850                     IF ASC-CAME-FROM-PACK-SLIP                   06885008
068860                         MOVE LQW-REC-SEQ-NBR (LQW-IDX)           06886008
068870                                     TO DK-REC-SEQ-NBR            06887008
068880                     ELSE                                         06888008
068890                         MOVE ASC-KEY-REC-SEQ-NBR                 06889008
068900                                     TO DK-REC-SEQ-NBR            06890008
068910                     END-IF                                       06891008
068920                                                                  06892008
068930                     PERFORM 5600-SET-PKSLIP-STATUS               06893008
068940                                                                  06894008
068950                 ELSE                                             06895008
068960                     MOVE PC-TSYMSG-00972    TO  DP020-MSG-NUMBER 06896008
068970                     SET PS-ERROR            TO  TRUE             06897008
068980                     SET DP020-MSG-WARNING   TO  TRUE             06898008
068990                     SET PS-ERROR-MSG        TO  TRUE             06899008
069000                 END-IF                                           06900008
069010             END-IF                                               06901008
069020         END-PERFORM                                              06902008
069030     END-IF.                                                      06903008
069040                                                                  06904008
069050     MOVE PV-ITEM                TO PV-SAVE-ITEM.                 06905008
069060     PERFORM 6111-WRITE-LIST-QUEUE.                               06906008
069070/                                                                 06907008
069080 5400-CHECK-ALL-SEL-ACTIVE.                                       06908008
069090                                                                  06909008
069100     PERFORM 6112-READ-LIST-QUEUE.                                06910008
069110                                                                  06911008
069120     IF PV-CICS-RESP = DFHRESP (NORMAL)                           06912008
069130         PERFORM                                                  06913008
069140         VARYING LQW-IDX  FROM 1 BY 1                             06914008
069150         UNTIL   LQW-IDX > PC-ITEMS-PER-PANEL OR                  06915008
069160                 LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO            06916008
069170                                                                  06917008
069180             IF LQW-SELECT (LQW-IDX) AND                          06918008
069190                    LQW-STR-DEST-NBR (LQW-IDX) > ZERO             06919008
069200                 PERFORM 7385-COUNT-SMOOTHED-CTNS                 06920008
069210                 IF PV-SMOOTH-COUNT > ZERO                        06921008
069220                     ADD PV-SMOOTH-COUNT TO PV-TOT-SMOOTH-COUNT   06922008
069230                     MOVE PC-ERR TO LQW-ACTION(LQW-IDX)           06923008
069240                 END-IF                                           06924008
069250             END-IF                                               06925008
069260                                                                  06926008
069270             IF LQW-SELECT (LQW-IDX)                              06927008
069280*             IF ASC-AUTO-VE                                      06928008
069290                PERFORM 7500-GET-PACK-BY-STR-IND                  06929008
069300                IF ASC-PACK-BY-ST-IND   = 'Y'                     06930008
069310                   MOVE LQW-SEQ-NBR(LQW-IDX) TO DK-SEQ-NBR        06931008
069320                   PERFORM 4100-ACTIVE-CARTONS-CHECKED-IN         06932008
069330                   IF PS-ACTIVE-CARTONS-YES                       06933008
069340                      MOVE PC-ERR TO LQW-ACTION(LQW-IDX)          06934008
069350                      MOVE PC-TSYMSG-03225  TO DP020-MSG-NUMBER   06935008
069360                      SET PS-ERROR                                06936008
069370                          PS-ERROR-MSG      TO TRUE               06937008
069380                      SET DP020-MSG-FATAL   TO TRUE               06938008
069390                   END-IF                                         06939008
069400                END-IF                                            06940008
069410*             END-IF                                              06941008
069420             END-IF                                               06942008
069430                                                                  06943008
069440         IF PS-NO-ERROR                                           06944008
069450*            THESE EDITS ARE AT THE RECEIVER LEVEL SO THEY ONLY   06945008
069460*            NEED TO BE DONE ONCE FOR EACH RECEIVER               06946008
069470             IF (LQW-SELECT (LQW-IDX)                             06947008
069480                 AND LQW-REC-SEQ-NBR (LQW-IDX) NOT =              06948008
069490                                    PV-FIRST-REC-SEQ-NBR)         06949008
069500             OR (LQW-SELECT (LQW-IDX)                             06950008
069510                 AND LQW-REC-SEQ-NBR (LQW-IDX) = 0)               06951008
069520                                                                  06952008
069530                 MOVE LQW-REC-SEQ-NBR      (LQW-IDX)              06953008
069540                                 TO PV-FIRST-REC-SEQ-NBR          06954008
069550                 PERFORM 5050-CHECK-FOR-VERIFIED                  06955008
069560                 PERFORM 5051-GET-PKGNG-CDE                       06956008
069570* IF INQUIRE, DO NOT PERFORM THESE VALIDATION PROCEDURES          06957008
069580                 IF DP020-SRC-AID EQUAL DP016-PF20                06958008
069590                     CONTINUE                                     06959008
069600                 ELSE                                             06960008
069610                     IF  RECEIV-STATUS-CDE EQUAL 'VE'             06961008
069620                         SET PS-ERROR                             06962008
069630                             DP020-MSG-FATAL                      06963008
069640                                     TO TRUE                      06964008
069650                         MOVE PC-TSYMSG-00966                     06965008
069660                                     TO DP020-MSG-NUMBER          06966008
069670                         MOVE PC-ERR TO  LQW-ACTION(LQW-IDX)      06967008
069680                         MOVE PV-ITEM TO PV-SAVE-ITEM             06968008
069690                         PERFORM 6111-WRITE-LIST-QUEUE            06969008
069700                     ELSE                                         06970008
069710                         PERFORM 5075-COUNT-TRECITMS              06971008
069720                         IF  PV-DB2-COUNT GREATER THAN ZERO       06972008
069730                             SET PS-ERROR                         06973008
069740                                 DP020-MSG-FATAL                  06974008
069750                                     TO TRUE                      06975008
069760                             MOVE PC-TSYMSG-00966                 06976008
069770                                         TO DP020-MSG-NUMBER      06977008
069780                             MOVE PC-ERR TO  LQW-ACTION(LQW-IDX)  06978008
069790                             MOVE PV-ITEM TO PV-SAVE-ITEM         06979008
069800                             PERFORM 6111-WRITE-LIST-QUEUE        06980008
069810                         ELSE                                     06981008
069820                             PERFORM 5076-CHECK-TRECITM           06982008
069830                             IF  PV-DB2-COUNT GREATER THAN ZERO   06983008
069840                                 SET PS-ERROR                     06984008
069850                                     DP020-MSG-FATAL              06985008
069860                                         TO TRUE                  06986008
069870                                 MOVE PC-TSYMSG-01256             06987008
069880                                             TO DP020-MSG-NUMBER  06988008
069890                                 MOVE PC-ERR TO                   06989008
069900                                               LQW-ACTION(LQW-IDX)06990008
069910                                 MOVE PV-ITEM TO PV-SAVE-ITEM     06991008
069920                                 PERFORM 6111-WRITE-LIST-QUEUE    06992008
069930                             ELSE                                 06993008
069940                                 PERFORM 5078-CHECK-FOR-TDISTHD   06994008
069950                                 IF PV-DB2-COUNT GREATER THAN 0   06995008
069960                                     SET PS-ERROR                 06996008
069970                                         DP020-MSG-FATAL TO TRUE  06997008
069980                                     MOVE PC-TSYMSG-01794 TO      06998008
069990                                             DP020-MSG-NUMBER     06999008
070000                                     MOVE PC-ERR TO               07000008
070010                                             LQW-ACTION(LQW-IDX)  07001008
070020                                     MOVE PV-ITEM TO PV-SAVE-ITEM 07002008
070030                                     PERFORM 6111-WRITE-LIST-QUEUE07003008
070040                                   END-IF                         07004008
070050                                                                  07005008
070060                                 END-IF                           07006008
070070                             END-IF                               07007008
070080                         END-IF                                   07008008
070090                                                                  07009008
070100                     PERFORM 5410-CHECK-STATUS-FOR-INACTIVE       07010008
070110                     ADD 1 TO RC015-NUMBER-OF-TS-ITEMS            07011008
070120                     IF PS-NO-ERROR                               07012008
070130                         IF ASC-INACTIVATE-NOT-PENDING            07013008
070140                                 SET PS-ERROR                     07014008
070150                                     DP020-MSG-WARNING            07015008
070160                                     ASC-INACTIVATE-PENDING       07016008
070170                                         TO TRUE                  07017008
070180                                 MOVE PC-TSYMSG-00004             07018008
070190                                             TO DP020-MSG-NUMBER  07019008
070200                         END-IF                                   07020008
070210                     END-IF                                       07021008
070220                    END-IF                                        07022008
070230                 END-IF                                           07023008
070240             END-IF                                               07024008
070250         END-PERFORM                                              07025008
070260     END-IF.                                                      07026008
070270                                                                  07027008
070280 5410-CHECK-STATUS-FOR-INACTIVE.                                  07028008
070290                                                                  07029008
070300     IF LQW-PKSL-STAT-CDE (LQW-IDX) = 'AC'                        07030008
070310         CONTINUE                                                 07031008
070320     ELSE                                                         07032008
070330         MOVE PC-ERR             TO LQW-ACTION (LQW-IDX)          07033008
070340         SET PS-ERROR            TO TRUE                          07034008
070350     END-IF.                                                      07035008
070360                                                                  07036008
070370     IF LQW-STR-DEST-NBR (LQW-IDX) = 0                            07037008
070380         ADD 1                   TO PV-BULK-STR-CNT               07038008
070390         SET PS-BULK-SHIPMENT    TO TRUE                          07039008
070400     ELSE                                                         07040008
070410         ADD 1                   TO PV-PACK-BY-STR-CNT            07041008
070420         SET PS-PACKED-BY-STORE  TO TRUE                          07042008
070430     END-IF.                                                      07043008
070440                                                                  07044008
070450 5420-FIND-SELECTION-TO-INACT.                                    07045008
070460                                                                  07046008
070470     MOVE '5420-FIND-SELECTION-TO-INACT  '   TO PV-LAST-PARAGRAPH 07047008
070480     PERFORM 6112-READ-LIST-QUEUE.                                07048008
070490                                                                  07049008
070500     SET ASC-INACTIVATE-NOT-PENDING   TO TRUE                     07050008
070510     IF PV-CICS-RESP = DFHRESP (NORMAL)                           07051008
070520         PERFORM                                                  07052008
070530         VARYING LQW-IDX  FROM 1 BY 1                             07053008
070540         UNTIL   LQW-IDX > PC-ITEMS-PER-PANEL OR                  07054008
070550                 LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO            07055008
070560                                                                  07056008
070570             IF LQW-SELECT (LQW-IDX)                              07057008
070580                 IF ASC-CAME-FROM-PACK-SLIP                       07058008
070590                     MOVE LQW-REC-SEQ-NBR (LQW-IDX)               07059008
070600                                 TO DK-REC-SEQ-NBR                07060008
070610                 ELSE                                             07061008
070620                     MOVE ASC-KEY-REC-SEQ-NBR                     07062008
070630                                 TO DK-REC-SEQ-NBR                07063008
070640                 END-IF                                           07064008
070650                 MOVE LQW-SEQ-NBR(LQW-IDX)                        07065008
070660                                 TO PKITEM-SEQ-NBR                07066008
070670                 MOVE ASC-KEY-PO-NBR-N                            07067008
070680                                 TO DK-PO-NBR                     07068008
070690                 MOVE ZERO       TO PV-DB2-COUNT                  07069008
070700                 MOVE 'IN'       TO PV-NEW-STATUS                 07070008
070710                 IF PS-NO-ERROR                                   07071008
070720                     PERFORM 5600-SET-PKSLIP-STATUS               07072008
070730                     PERFORM 7600-DECREMENT-RECITM                07073008
070740                 END-IF                                           07074008
070750                 ADD +1      TO RC015-NUMBER-OF-TS-ITEMS          07075008
070760                 SET LQW-DESELECT (LQW-IDX)                       07076008
070770                             TO TRUE                              07077008
070780                 MOVE LQW-SELECTED-SW (LQW-IDX)                   07078008
070790                             TO LQW-TEMP-SELECTED-SW(LQW-IDX)     07079008
070800             END-IF                                               07080008
070810         END-PERFORM                                              07081008
070820     END-IF.                                                      07082008
070830                                                                  07083008
070840     MOVE PV-ITEM                TO PV-SAVE-ITEM.                 07084008
070850     PERFORM 6111-WRITE-LIST-QUEUE.                               07085008
070860/                                                                 07086008
070870 5500-CHECK-PKSLIP-ACTIVE.                                        07087008
070880                                                                  07088008
070890     INITIALIZE PV-COUNT-NOT-ACTIVE-PKSLIP.                       07089008
070900     MOVE  ZEROES  TO  PV-PO-ACTIVE-PKSLIP.                       07090008
070910     MOVE PV-FIRST-REC-SEQ-NBR   TO PKSLIP-REC-SEQ-NBR.           07091008
070920                                                                  07092008
070930     EXEC SQL                                                     07093008
070940          SELECT  PO_NBR                                          07094008
070950            INTO :PV-PO-ACTIVE-PKSLIP                             07095008
070960            FROM TPKSLIP                                          07096008
070970           WHERE PO_NBR          = :DK-PO-NBR                     07097008
070980             AND REC_SEQ_NBR     = :PKSLIP-REC-SEQ-NBR            07098008
070990             AND VER_STAT_CDE    = 'A'                            07099008
071000             AND PKSL_STAT_CDE  IN ('CM', 'IP')                   07100008
071010           FETCH FIRST 1 ROW ONLY                                 07101008
071020     END-EXEC                                                     07102008
071030                                                                  07103008
071040     EVALUATE TRUE                                                07104008
071050         WHEN SQLCODE = ZERO                                      07105008
071060         WHEN SQLCODE = -811                                      07106008
071070              MOVE  1  TO  PV-COUNT-NOT-ACTIVE-PKSLIP             07107008
071080         WHEN SQLCODE = +100                                      07108008
071090              MOVE  0  TO  PV-COUNT-NOT-ACTIVE-PKSLIP             07109008
071100         WHEN SQLCODE = -904                                      07110008
071110         WHEN SQLCODE = -911                                      07111008
071120         WHEN SQLCODE = -913                                      07112008
071130              PERFORM 9900-SOFT-ABORT                             07113008
071140                                                                  07114008
071150         WHEN SQLWARN0 NOT = SPACES                               07115008
071160         WHEN SQLCODE  NOT = ZERO                                 07116008
071170              MOVE '5500-CHECK-PKSLIP-ACTIVE'                     07117008
071180                             TO DP013-PARAGRAPH                   07118008
071190              MOVE 'UNSUCCESSFUL COUNT OF TPKSLIP'                07119008
071200                             TO DP013-MESSAGE-TEXT (1)            07120008
071210              MOVE ASC-KEY-PO-NBR                                 07121008
071220                             TO PV-MSG-KEY-PO                     07122008
071230              MOVE ASC-KEY-REC-SEQ-NBR                            07123008
071240                             TO PV-MSG-KEY-REC-SEQ-NBR-N          07124008
071250              MOVE PV-MSG-KEYS                                    07125008
071260                             TO DP013-MESSAGE-TEXT (2)            07126008
071270              MOVE SQLCA     TO DP013-SQLCA                       07127008
071280              MOVE 'TPKSLIP' TO DP013-DB2-TABLE-NAME (1)          07128008
071290              SET DP013-DB2-ABEND                                 07129008
071300                  DP013-XCTL-DISPLAY-RESTART                      07130008
071310                             TO TRUE                              07131008
071320              PERFORM DP013-0000-PROCESS-ABEND                    07132008
071330     END-EVALUATE.                                                07133008
071340                                                                  07134008
071350 5510-CHECK-PKSLIP-INACTIVE.                                      07135008
071360                                                                  07136008
071370     INITIALIZE PV-COUNT-NOT-INACTIVE-PKSLIP.                     07137008
071380     MOVE  ZEROES  TO  PV-PO-INACTIVE-PKSLIP.                     07138008
071390     MOVE PV-FIRST-REC-SEQ-NBR   TO PKSLIP-REC-SEQ-NBR.           07139008
071400                                                                  07140008
071410     EXEC SQL                                                     07141008
071420          SELECT  PO_NBR                                          07142008
071430            INTO  :PV-PO-INACTIVE-PKSLIP                          07143008
071440            FROM TPKSLIP                                          07144008
071450           WHERE PO_NBR          = :DK-PO-NBR                     07145008
071460             AND REC_SEQ_NBR     = :PKSLIP-REC-SEQ-NBR            07146008
071470             AND VER_STAT_CDE    = 'A'                            07147008
071480             AND PKSL_STAT_CDE  ^= 'IN'                           07148008
071490           FETCH FIRST 1 ROW ONLY                                 07149008
071500     END-EXEC                                                     07150008
071510                                                                  07151008
071520     EVALUATE TRUE                                                07152008
071530         WHEN SQLCODE = ZERO                                      07153008
071540         WHEN SQLCODE = -811                                      07154008
071550              MOVE  1  TO  PV-COUNT-NOT-INACTIVE-PKSLIP           07155008
071560         WHEN SQLCODE = +100                                      07156008
071570              MOVE  0  TO  PV-COUNT-NOT-INACTIVE-PKSLIP           07157008
071580         WHEN SQLCODE = -904                                      07158008
071590         WHEN SQLCODE = -911                                      07159008
071600         WHEN SQLCODE = -913                                      07160008
071610              PERFORM 9900-SOFT-ABORT                             07161008
071620                                                                  07162008
071630         WHEN SQLWARN0 NOT = SPACES                               07163008
071640         WHEN SQLCODE  NOT = ZERO                                 07164008
071650              MOVE '5510-CHECK-PKSLIP-INACTIVE'                   07165008
071660                             TO DP013-PARAGRAPH                   07166008
071670              MOVE 'UNSUCCESSFUL COUNT OF TPKSLIP'                07167008
071680                             TO DP013-MESSAGE-TEXT (1)            07168008
071690              MOVE ASC-KEY-PO-NBR                                 07169008
071700                             TO PV-MSG-KEY-PO                     07170008
071710              MOVE ASC-KEY-REC-SEQ-NBR                            07171008
071720                             TO PV-MSG-KEY-REC-SEQ-NBR-N          07172008
071730              MOVE PV-MSG-KEYS                                    07173008
071740                             TO DP013-MESSAGE-TEXT (2)            07174008
071750              MOVE SQLCA     TO DP013-SQLCA                       07175008
071760              MOVE 'TPKSLIP' TO DP013-DB2-TABLE-NAME (1)          07176008
071770              SET DP013-DB2-ABEND                                 07177008
071780                  DP013-XCTL-DISPLAY-RESTART                      07178008
071790                             TO TRUE                              07179008
071800              PERFORM DP013-0000-PROCESS-ABEND                    07180008
071810     END-EVALUATE.                                                07181008
071820                                                                  07182008
071830 5520-COUNT-PKITEM-RECS.                                          07183008
071840                                                                  07184008
071850     MOVE ZEROES  TO  PV-PO-PKITEM                                07185008
071860     MOVE ZEROES  TO  PV-COUNT-PKITEM                             07186008
071870                                                                  07187008
071880     EXEC SQL                                                     07188008
071890          SELECT  PO_NBR                                          07189008
071900            INTO :PV-PO-PKITEM                                    07190008
071910            FROM TPKITEM                                          07191008
071920           WHERE PO_NBR          = :DK-PO-NBR                     07192008
071930             AND SEQ_NBR         = :PKSLIP-SEQ-NBR                07193008
071940             AND VER_STAT_CDE    = 'A'                            07194008
071950           FETCH FIRST 1 ROW ONLY                                 07195008
071960     END-EXEC                                                     07196008
071970                                                                  07197008
071980     EVALUATE TRUE                                                07198008
071990         WHEN SQLCODE = ZERO                                      07199008
072000         WHEN SQLCODE = -811                                      07200008
072010              MOVE  1  TO  PV-COUNT-PKITEM                        07201008
072020         WHEN SQLCODE = +100                                      07202008
072030              MOVE  0  TO  PV-COUNT-PKITEM                        07203008
072040         WHEN SQLCODE = -904                                      07204008
072050         WHEN SQLCODE = -911                                      07205008
072060         WHEN SQLCODE = -913                                      07206008
072070              PERFORM 9900-SOFT-ABORT                             07207008
072080                                                                  07208008
072090         WHEN SQLWARN0 NOT = SPACES                               07209008
072100         WHEN SQLCODE  NOT = ZERO                                 07210008
072110              MOVE '5520-COUNT-PKITEM-RECS'                       07211008
072120                             TO DP013-PARAGRAPH                   07212008
072130              MOVE 'UNSUCCESSFUL COUNT OF TPKSLIP'                07213008
072140                             TO DP013-MESSAGE-TEXT (1)            07214008
072150              MOVE ASC-KEY-PO-NBR                                 07215008
072160                             TO PV-MSG-KEY-PO                     07216008
072170              MOVE ASC-KEY-REC-SEQ-NBR                            07217008
072180                             TO PV-MSG-KEY-REC-SEQ-NBR-N          07218008
072190              MOVE PV-MSG-KEYS                                    07219008
072200                             TO DP013-MESSAGE-TEXT (2)            07220008
072210              MOVE SQLCA     TO DP013-SQLCA                       07221008
072220              MOVE 'TPKITEM' TO DP013-DB2-TABLE-NAME (1)          07222008
072230              SET DP013-DB2-ABEND                                 07223008
072240                  DP013-XCTL-DISPLAY-RESTART                      07224008
072250                             TO TRUE                              07225008
072260              PERFORM DP013-0000-PROCESS-ABEND                    07226008
072270     END-EVALUATE.                                                07227008
072280                                                                  07228008
072290 5600-SET-PKSLIP-STATUS.                                          07229008
072300                                                                  07230008
072310     PERFORM 5610-SELECT-PKSLIP.                                  07231008
072320     PERFORM 5620-SET-CURR-PKSLIP-TO-INACT.                       07232008
072330**GB 5/13/04 CREATE NEW ROW WITH NO RCVR WHEN INACTVNG PKSLIP     07233008
072340     IF PV-NEW-STATUS = 'IN'                                      07234008
072350        MOVE ZEROES                  TO PKSLIP-REC-SEQ-NBR        07235008
072360     ELSE                                                         07236008
072370        MOVE DK-REC-SEQ-NBR          TO PKSLIP-REC-SEQ-NBR        07237008
072380     END-IF                                                       07238008
072390                                                                  07239008
072400     IF PKSLIP-OPER-UNT-ID = ZERO AND                             07240008
072410         ASC-CAME-FROM-RCVG                                       07241008
072420         MOVE DK-OPER-UNT-ID          TO PKSLIP-OPER-UNT-ID       07242008
072430         MOVE DK-FCLTY-ID             TO PKSLIP-FCLTY-ID          07243008
072440     END-IF                                                       07244008
072450                                                                  07245008
072460     PERFORM 5630-INSERT-NEW-PKSLIP-STATUS                        07246008
072470                                                                  07247008
072480     MOVE 'UPD'                       TO LQW-ACTION (LQW-IDX).    07248008
072490                                                                  07249008
072496                                                                  07249654
072500 5610-SELECT-PKSLIP.                                              07250008
072510                                                                  07251008
072520     MOVE LQW-SEQ-NBR (LQW-IDX)  TO PKSLIP-SEQ-NBR                07252008
072530                                                                  07253008
072540         EXEC SQL                                                 07254008
072550             SELECT PO_NBR,                                       07255008
072560                    SEQ_NBR,                                      07256008
072570                    CRE_TMST,                                     07257008
072580                    VER_STAT_CDE,                                 07258008
072590                    OPER_UNT_ID,                                  07259008
072600                    FCLTY_ID,                                     07260008
072610                    PKSL_NBR,                                     07261008
072620                    STR_DEST_NBR,                                 07262008
072630                    REC_SEQ_NBR,                                  07263008
072640                    SHIPT_ID,                                     07264008
072650                    BOL_NBR,                                      07265008
072660                    PRO_NBR,                                      07266008
072670                    PKSL_STAT_CDE,                                07267008
072680                    PO_VER_NBR,                                   07268008
072690                    CRE_SRC_CDE,                                  07269008
072700                    EXPTED_PKG_QTY,                               07270008
072710                    OWNER_SCAC_ID,                                07271008
072720                    ASN_NBR,                                      07272008
072730                    VEND_SHIP_DTE,                                07273008
072740                    PKSL_PG_CNT,                                  07274008
072750                    CONTNR_ID,                                    07275008
072760                    ORIG_PKSL_SEQ_NBR                             07276008
072770              INTO  :PKSLIP-PO-NBR,                               07277008
072780                    :PKSLIP-SEQ-NBR,                              07278008
072790                    :PKSLIP-CRE-TMST,                             07279008
072800                    :PKSLIP-VER-STAT-CDE,                         07280008
072810                    :PKSLIP-OPER-UNT-ID,                          07281008
072820                    :PKSLIP-FCLTY-ID,                             07282008
072830                    :PKSLIP-PKSL-NBR,                             07283008
072840                    :PKSLIP-STR-DEST-NBR,                         07284008
072850                    :PKSLIP-REC-SEQ-NBR,                          07285008
072860                    :PKSLIP-SHIPT-ID,                             07286008
072870                    :PKSLIP-BOL-NBR,                              07287008
072880                    :PKSLIP-PRO-NBR,                              07288008
072890                    :PKSLIP-PKSL-STAT-CDE,                        07289008
072900                    :PKSLIP-PO-VER-NBR,                           07290008
072910                    :PKSLIP-CRE-SRC-CDE,                          07291008
072920                    :PKSLIP-EXPTED-PKG-QTY,                       07292008
072930                    :PKSLIP-OWNER-SCAC-ID,                        07293008
072940                    :PKSLIP-ASN-NBR,                              07294008
072950                    :PKSLIP-VEND-SHIP-DTE,                        07295008
072960                    :PKSLIP-PKSL-PG-CNT,                          07296008
072970                    :PKSLIP-CONTNR-ID,                            07297008
072980                    :PKSLIP-ORIG-PKSL-SEQ-NBR                     07298008
072990               FROM TPKSLIP                                       07299008
073000              WHERE PO_NBR       = :DK-PO-NBR                     07300008
073010                AND SEQ_NBR      = :PKSLIP-SEQ-NBR                07301008
073020                AND VER_STAT_CDE = 'A'                            07302008
073030         END-EXEC                                                 07303008
073040                                                                  07304008
073050         EVALUATE TRUE                                            07305008
073060             WHEN SQLCODE = ZERO                                  07306008
073070             WHEN SQLCODE = +100                                  07307008
073080                  CONTINUE                                        07308008
073090             WHEN SQLCODE = -904                                  07309008
073100             WHEN SQLCODE = -911                                  07310008
073110             WHEN SQLCODE = -913                                  07311008
073120                  PERFORM 9900-SOFT-ABORT                         07312008
073130                                                                  07313008
073140             WHEN SQLWARN0 NOT = SPACES                           07314008
073150             WHEN SQLCODE  NOT = ZERO                             07315008
073160                  MOVE '5610-SELECT-TPKSLIP'                      07316008
073170                                 TO DP013-PARAGRAPH               07317008
073180                  MOVE 'UNSUCCESSFUL SELECT OF TPKSLIP'           07318008
073190                                 TO DP013-MESSAGE-TEXT (1)        07319008
073200                  MOVE SQLCA     TO DP013-SQLCA                   07320008
073210                  MOVE 'TPKSLIP' TO DP013-DB2-TABLE-NAME (1)      07321008
073220                  SET DP013-DB2-ABEND                             07322008
073230                      DP013-XCTL-DISPLAY-RESTART                  07323008
073240                                 TO TRUE                          07324008
073250                  PERFORM DP013-0000-PROCESS-ABEND                07325008
073260         END-EVALUATE.                                            07326008
073270                                                                  07327008
073280 5620-SET-CURR-PKSLIP-TO-INACT.                                   07328008
073290                                                                  07329008
073300         EXEC SQL                                                 07330008
073310           UPDATE TPKSLIP                                         07331008
073320              SET VER_STAT_CDE  = 'I'                             07332008
073330            WHERE PO_NBR        = :PKSLIP-PO-NBR                  07333008
073340              AND SEQ_NBR       = :PKSLIP-SEQ-NBR                 07334008
073350              AND VER_STAT_CDE  = 'A'                             07335008
073360         END-EXEC                                                 07336008
073370                                                                  07337008
073380         EVALUATE TRUE                                            07338008
073390             WHEN SQLCODE = ZERO                                  07339008
073400             WHEN SQLCODE = +100                                  07340008
073410                  CONTINUE                                        07341008
073420             WHEN SQLCODE = -904                                  07342008
073430             WHEN SQLCODE = -911                                  07343008
073440             WHEN SQLCODE = -913                                  07344008
073450                  PERFORM 9900-SOFT-ABORT                         07345008
073460                                                                  07346008
073470             WHEN SQLWARN0 NOT = SPACES                           07347008
073480             WHEN SQLCODE  NOT = ZERO                             07348008
073490                  MOVE '5620-SET-CURR-PKSLIP-TO-INACT'            07349008
073500                                 TO DP013-PARAGRAPH               07350008
073510                  MOVE 'UNSUCCESSFUL UPDATE OF TPKSLIP'           07351008
073520                                 TO DP013-MESSAGE-TEXT (1)        07352008
073530                  MOVE SQLCA     TO DP013-SQLCA                   07353008
073540                  MOVE 'TPKSLIP' TO DP013-DB2-TABLE-NAME (1)      07354008
073550                  SET DP013-DB2-ABEND                             07355008
073560                      DP013-XCTL-DISPLAY-RESTART                  07356008
073570                                 TO TRUE                          07357008
073580                  PERFORM DP013-0000-PROCESS-ABEND                07358008
073590         END-EVALUATE.                                            07359008
073600                                                                  07360008
073610 5630-INSERT-NEW-PKSLIP-STATUS.                                   07361008
073620                                                                  07362008
073630         EXEC SQL                                                 07363008
073640             INSERT INTO TPKSLIP                                  07364008
073650                   (PO_NBR,                                       07365008
073660                    SEQ_NBR,                                      07366008
073670                    CRE_TMST,                                     07367008
073680                    VER_STAT_CDE,                                 07368008
073690                    OPER_UNT_ID,                                  07369008
073700                    FCLTY_ID,                                     07370008
073710                    PKSL_NBR,                                     07371008
073720                    STR_DEST_NBR,                                 07372008
073730                    REC_SEQ_NBR,                                  07373008
073740                    SHIPT_ID,                                     07374008
073750                    BOL_NBR,                                      07375008
073760                    PRO_NBR,                                      07376008
073770                    PKSL_STAT_CDE,                                07377008
073780                    CRE_UID,                                      07378008
073790                    PO_VER_NBR,                                   07379008
073800                    CRE_SRC_CDE,                                  07380008
073810                    EXPTED_PKG_QTY,                               07381008
073820                    OWNER_SCAC_ID,                                07382008
073830                    ASN_NBR,                                      07383008
073840                    VEND_SHIP_DTE,                                07384008
073850                    PKSL_PG_CNT,                                  07385008
073860                    CONTNR_ID,                                    07386008
073870                    ORIG_PKSL_SEQ_NBR)                            07387008
073880            VALUES (:DK-PO-NBR,                                   07388008
073890                    :PKSLIP-SEQ-NBR,                              07389008
073900                    CURRENT TIMESTAMP,                            07390008
073910                    'A',                                          07391008
073920                    :PKSLIP-OPER-UNT-ID,                          07392008
073930                    :PKSLIP-FCLTY-ID,                             07393008
073940                    :PKSLIP-PKSL-NBR,                             07394008
073950                    :PKSLIP-STR-DEST-NBR,                         07395008
073960                    :PKSLIP-REC-SEQ-NBR,                          07396008
073970                    :PKSLIP-SHIPT-ID,                             07397008
073980                    :PKSLIP-BOL-NBR,                              07398008
073990                    :PKSLIP-PRO-NBR,                              07399008
074000                    :PV-NEW-STATUS,                               07400008
074010                    :DP020-USERID,                                07401008
074020                    :PKSLIP-PO-VER-NBR,                           07402008
074030                    :PKSLIP-CRE-SRC-CDE,                          07403008
074040                    :PKSLIP-EXPTED-PKG-QTY,                       07404008
074050                    :PKSLIP-OWNER-SCAC-ID,                        07405008
074060                    :PKSLIP-ASN-NBR,                              07406008
074070                    :PKSLIP-VEND-SHIP-DTE,                        07407008
074080                    :PKSLIP-PKSL-PG-CNT,                          07408008
074090                    :PKSLIP-CONTNR-ID,                            07409008
074100                    :PKSLIP-ORIG-PKSL-SEQ-NBR)                    07410008
074110         END-EXEC                                                 07411008
074120                                                                  07412008
074130         EVALUATE TRUE                                            07413008
074140             WHEN SQLCODE = ZERO                                  07414008
074150             WHEN SQLCODE = +100                                  07415008
074160                  CONTINUE                                        07416008
074170             WHEN SQLCODE = -904                                  07417008
074180             WHEN SQLCODE = -911                                  07418008
074190             WHEN SQLCODE = -913                                  07419008
074200                  PERFORM 9900-SOFT-ABORT                         07420008
074210                                                                  07421008
074220             WHEN SQLWARN0 NOT = SPACES                           07422008
074230             WHEN SQLCODE  NOT = ZERO                             07423008
074240                  MOVE '5630-INSERT-NEW-PKSLIP-STATUS'            07424008
074250                                 TO DP013-PARAGRAPH               07425008
074260                  MOVE 'UNSUCCESSFUL INSERT OF TPKSLIP'           07426008
074270                                 TO DP013-MESSAGE-TEXT (1)        07427008
074280                  MOVE ASC-KEY-PO-NBR                             07428008
074290                                 TO PV-MSG-KEY-PO                 07429008
074300                  MOVE ASC-KEY-REC-SEQ-NBR                        07430008
074310                                 TO PV-MSG-KEY-REC-SEQ-NBR-N      07431008
074320                  MOVE PKSLIP-STR-DEST-NBR                        07432008
074330                                 TO PV-MSG-KEY-STR-NBR            07433008
074340                  MOVE PV-MSG-KEYS                                07434008
074350                                 TO DP013-MESSAGE-TEXT (2)        07435008
074360                  MOVE SQLCA     TO DP013-SQLCA                   07436008
074370                  MOVE 'TPKSLIP' TO DP013-DB2-TABLE-NAME (1)      07437008
074380                  SET DP013-DB2-ABEND                             07438008
074390                      DP013-XCTL-DISPLAY-RESTART                  07439008
074400                                 TO TRUE                          07440008
074410                  PERFORM DP013-0000-PROCESS-ABEND                07441008
074420         END-EVALUATE.                                            07442008
074421                                                                  07442127
074422                                                                  07442227
074423*----------------------------------------------------------------*07442327
074424*  CHECK IF TROUBLE NEEDS TO TO BE CREATED FOR RECEIVERS CREATED *07442427
074425*  WHERE A PACKSLIP ON THE RECEIVER HAS PRO NUMBER "MIXEDSKU"    *07442527
074426*  JOAN & DC'S REFER TO THIS A RED B SINCE THE BULK RECEIVERS    *07442627
074427*  ARE HIGHLIGHTED IN RED IF THEY HAVE "MIXEDSKU" PRO NBR        *07442727
074428*                                                                *07442827
074429*  - CHECK PARM IF THIS PROCESS IS BEING EXECUTED                *07442927
074430*    Y/N PARM ON TKRPRPM - PROTR1 - AT DC LEVEL                  *07443027
074431*    (PRO NUMBER TROUBLE CHECK)                                  *07443127
074432*    5710-CHECK-PROTR1                                           *07443229
074433*                                                                *07443329
074434*  - CHECK PARM IF THIS DC IS CHECKING AT PRO LEVEL              *07443429
074435*    Y/N PARM ON TKRPRPM - AUTRB3                                *07443529
074436*    THIS WILL MATCH SIMILAR LOGIC FROM RCKCS234                 *07443629
074437*    5720-CHECK-AUTRB3                                           *07443729
074438*                                                                *07443829
074440*  - CHECK IF ANY OF THE PACKSLIPS THAT ARE ATTACHED TO THE      *07444027
074441*    RECEIVER HAVE A MATCHING PRO NUMBER THAT IS SHOWN IN        *07444127
074442*    PARM AUTRBL03 - NOTE ONLY THE FIRST 8 CHARACTERS OF THE     *07444227
074443*    PRO NUMBER WILL BE CHECKED                                  *07444327
074444*    5730-CHECK-AUTRBL03                                         *07444429
074445*                                                                *07444527
074446*  - CHECK THE CONTROL FLOW PARM = CNTLFLOW TO SEE WHAT TROUBLE  *07444628
074447*    CODE SHOULD BE CREATED                                      *07444728
074448*    5740-CHECK-CNTLFLOW                                         *07444829
074449*                                                                *07444928
074450*  - CHECK IF RECEIVER ALREADY HAS TROUBLE FOR MIXEDSKU - 434    *07445028
074451*    IF RECEIVER ALREADY HAS THIS TROUBLE DO NOT CREATE AGAIN    *07445128
074452*    5750-CHECK-PRO-TRBL                                         *07445229
074453*                                                                *07445328
074454*  - CREATE NEW RECEIVER LEVEL TROUBLE                           *07445427
074455*    5760-CREATE-PRO-TRBL                                        *07445529
074456*----------------------------------------------------------------*07445627
074457 5700-CHECK-MIXEDSKU-PKSLIP.                                      07445727
074458                                                                  07445830
074472     SET PS-PRO-LEVEL-TRBL-CHECK  TO  TRUE.                       07447256
074473                                                                  07447356
074474     IF  PS-PRO-LEVEL-TRBL-CHECK                                  07447456
074475         PERFORM 5710-CHECK-PROTR1                                07447556
074476     END-IF.                                                      07447656
074477                                                                  07447756
074478     IF  PS-PRO-LEVEL-TRBL-CHECK                                  07447856
074479         PERFORM 5720-CHECK-AUTRB3                                07447956
074480     END-IF.                                                      07448056
074481                                                                  07448156
074482     IF  PS-PRO-LEVEL-TRBL-CHECK                                  07448256
074483         PERFORM 5730-CHECK-AUTRBL03                              07448356
074484     END-IF.                                                      07448456
074485                                                                  07448556
074486     IF  PS-PRO-LEVEL-TRBL-CHECK                                  07448656
074487         PERFORM 5740-CHECK-CNTLFLOW                              07448756
074488     END-IF.                                                      07448856
074489                                                                  07448956
074490     IF  PS-PRO-LEVEL-TRBL-CHECK                                  07449056
074491         PERFORM 5750-CHECK-DC-EFC                                07449156
074492     END-IF.                                                      07449256
074493                                                                  07449356
074494     IF  PS-PRO-LEVEL-TRBL-CHECK                                  07449456
074495         PERFORM 5760-CHECK-PRO-TRBL                              07449556
074496     END-IF.                                                      07449656
074497                                                                  07449756
074498     IF  PS-PRO-LEVEL-TRBL-CHECK                                  07449856
074499         PERFORM 5770-CREATE-PRO-TRBL                             07449956
074500     END-IF.                                                      07450056
074501                                                                  07450156
074502                                                                  07450256
074503*----------------------------------------------------------------*07450356
074504*  - CHECK PARM IF THIS PROCESS IS BEING EXECUTED                *07450456
074505*    Y/N PARM ON TKRPRPM - PROTR1 - AT DC LEVEL                  *07450556
074506*    (PRO NUMBER TROUBLE CHECK)                                  *07450656
074507*----------------------------------------------------------------*07450756
074508 5710-CHECK-PROTR1.                                               07450856
074509                                                                  07450956
074519     MOVE 'N'  TO PS-PROTR1-SW.                                   07451956
074520                                                                  07452056
074521     EXEC SQL                                                     07452156
074522          SELECT   FUNC_TXT                                       07452256
074523            INTO  :KRPRPM-FUNC-TXT                                07452356
074524            FROM                                                  07452456
074525                  TKRPRPM A                                       07452556
074526            WHERE                                                 07452656
074527                  LOC_ID            = :RECEIV-CURR-OPER-UNT-ID    07452756
074528              AND SYS_PRC_FUNC_CDE  = 'PROTR1'                    07452856
074529              AND FUNC_PRC_STAT_CDE = 'AC'                        07452956
074530              AND INTFC_SYS_CDE     = 'KHL'                       07453056
074531              AND FUNC_TXT          = 'Y'                         07453156
074532              AND FUNC_BEG_TMST    <= CURRENT TIMESTAMP           07453256
074533              AND FUNC_END_TMST    >= CURRENT TIMESTAMP           07453356
074534             WITH UR                                              07453456
074535     END-EXEC.                                                    07453556
074536                                                                  07453656
074537     EVALUATE TRUE                                                07453756
074538         WHEN SQLCODE = ZERO                                      07453856
074539              SET PS-PRO-LEVEL-TRBL-CHECK  TO  TRUE               07453956
074540                                                                  07454056
074541         WHEN SQLCODE = +100                                      07454156
074542              SET PS-PRO-LEVEL-TRBL-CHECK-NO  TO  TRUE            07454256
074543                                                                  07454356
074544         WHEN SQLWARN0 NOT = SPACES                               07454456
074545         WHEN SQLCODE  NOT = ZERO                                 07454556
074546              SET PS-PRO-LEVEL-TRBL-CHECK-NO  TO  TRUE            07454656
074547              MOVE 'PARM PROTR1 ' TO DP013-MESSAGE-TEXT (1)       07454756
074548              MOVE 'RCKCS213'          TO DP013-PROGRAM           07454856
074549              MOVE '5710-CHECK-PROTR1' TO DP013-PARAGRAPH         07454956
074550              MOVE 'TKRPRPM     ' TO DP013-DB2-TABLE-NAME (1)     07455056
074551              SET DP013-DB2-ABEND                                 07455156
074552                                 TO TRUE                          07455256
074553              SET DP013-XCTL-DISPLAY-RESTART                      07455356
074554                                 TO TRUE                          07455456
074555              PERFORM DP013-0000-PROCESS-ABEND                    07455556
074560     END-EVALUATE.                                                07456031
074593                                                                  07459329
074594                                                                  07459429
074595*----------------------------------------------------------------*07459529
074596*  - CHECK PARM IF THIS DC IS CHECKING AT PRO LEVEL              *07459629
074597*    Y/N PARM ON TKRPRPM - AUTRB3                                *07459729
074598*    THIS WILL MATCH SIMILAR LOGIC FROM RCKCS234                 *07459829
074599*----------------------------------------------------------------*07459929
074600 5720-CHECK-AUTRB3.                                               07460029
074601                                                                  07460144
074612     MOVE 'N'  TO PS-AUTRB3-SW.                                   07461231
074613                                                                  07461331
074614     EXEC SQL                                                     07461431
074615          SELECT   FUNC_TXT                                       07461531
074616            INTO  :KRPRPM-FUNC-TXT                                07461631
074617            FROM                                                  07461731
074618                  TKRPRPM A                                       07461831
074619            WHERE                                                 07461931
074620                  LOC_ID            = :RECEIV-CURR-OPER-UNT-ID    07462031
074621              AND SYS_PRC_FUNC_CDE  = 'AUTRB3'                    07462131
074622              AND FUNC_PRC_STAT_CDE = 'AC'                        07462231
074623              AND INTFC_SYS_CDE     = 'KHL'                       07462331
074624              AND FUNC_TXT          = 'Y'                         07462431
074625              AND FUNC_BEG_TMST    <= CURRENT TIMESTAMP           07462531
074626              AND FUNC_END_TMST    >= CURRENT TIMESTAMP           07462631
074627             WITH UR                                              07462731
074628     END-EXEC.                                                    07462831
074629                                                                  07462931
074630     EVALUATE TRUE                                                07463031
074631         WHEN SQLCODE = ZERO                                      07463131
074632              SET PS-PRO-LEVEL-TRBL-CHECK  TO  TRUE               07463231
074633                                                                  07463331
074634         WHEN SQLCODE = +100                                      07463431
074635              SET PS-PRO-LEVEL-TRBL-CHECK-NO  TO  TRUE            07463531
074636                                                                  07463631
074637         WHEN SQLWARN0 NOT = SPACES                               07463731
074638         WHEN SQLCODE  NOT = ZERO                                 07463831
074639              SET PS-PRO-LEVEL-TRBL-CHECK-NO  TO  TRUE            07463931
074640              MOVE 'PARM AUTRB3 ' TO DP013-MESSAGE-TEXT (1)       07464031
074641              MOVE 'RCKCS213'          TO DP013-PROGRAM           07464131
074642              MOVE '5720-CHECK-AUTRB3' TO DP013-PARAGRAPH         07464231
074643              MOVE 'TKRPRPM     ' TO DP013-DB2-TABLE-NAME (1)     07464331
074644              SET DP013-DB2-ABEND                                 07464431
074645                                 TO TRUE                          07464531
074646              SET DP013-XCTL-DISPLAY-RESTART                      07464631
074647                                 TO TRUE                          07464731
074648              PERFORM DP013-0000-PROCESS-ABEND                    07464831
074649     END-EVALUATE.                                                07464931
074650                                                                  07465029
074651                                                                  07465129
074652*----------------------------------------------------------------*07465229
074653*  - CHECK IF ANY OF THE PACKSLIPS THAT ARE ATTACHED TO THE      *07465329
074654*    RECEIVER HAVE A MATCHING PRO NUMBER THAT IS SHOWN IN        *07465429
074655*    PARM AUTRBL03 - NOTE ONLY THE FIRST 8 CHARACTERS OF THE     *07465529
074656*    PRO NUMBER WILL BE CHECKED                                  *07465629
074657*----------------------------------------------------------------*07465729
074658 5730-CHECK-AUTRBL03.                                             07465829
074659                                                                  07465944
074670     MOVE ZEROES  TO  PV-AUTRBL03-NBR.                            07467031
074671                                                                  07467131
074672     EXEC SQL                                                     07467231
074673          SELECT  D.ATTR_ELEM_NBR                                 07467331
074674            INTO :PV-AUTRBL03-NBR                                 07467431
074675            FROM                                                  07467531
074676                  WST_INTGRTN_TYP A                               07467631
074677                , WST_ATTR_DEFN B                                 07467731
074678                , WST_ATTR_ELEM C                                 07467831
074679                , WST_ATTR_ELEM D                                 07467931
074680                , WST_ATTR_ELEM E                                 07468031
074681                , WST_ATTR_ELEM F                                 07468131
074682                , WST_ATTR_ELEM G                                 07468231
074683                , TPKSLIP H                                       07468331
074684            WHERE                                                 07468431
074685                  A.INTGRTN_TYP_CDE   = 'AUTRBL03'                07468531
074686              AND A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE         07468631
074687              AND B.ATTR_DEFN_SEQ_NBR = 1                         07468731
074688              AND B.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE         07468831
074689              AND C.ATTR_DEFN_SEQ_NBR = 1                         07468931
074690              AND B.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE         07469031
074691              AND D.ATTR_DEFN_SEQ_NBR = 2                         07469131
074692              AND B.INTGRTN_TYP_CDE   = E.INTGRTN_TYP_CDE         07469231
074693              AND E.ATTR_DEFN_SEQ_NBR = 3                         07469331
074694              AND B.INTGRTN_TYP_CDE   = F.INTGRTN_TYP_CDE         07469431
074695              AND F.ATTR_DEFN_SEQ_NBR = 4                         07469531
074696              AND B.INTGRTN_TYP_CDE   = G.INTGRTN_TYP_CDE         07469631
074697              AND G.ATTR_DEFN_SEQ_NBR = 5                         07469731
074698              AND C.ATTR_ELEM_SEQ_NBR = D.ATTR_ELEM_SEQ_NBR       07469831
074699              AND C.ATTR_ELEM_SEQ_NBR = E.ATTR_ELEM_SEQ_NBR       07469931
074700              AND C.ATTR_ELEM_SEQ_NBR = F.ATTR_ELEM_SEQ_NBR       07470031
074701              AND C.ATTR_ELEM_SEQ_NBR = G.ATTR_ELEM_SEQ_NBR       07470131
074702              AND E.ATTR_ELEM_TMST   <= CURRENT TIMESTAMP         07470231
074703              AND F.ATTR_ELEM_TMST   >= CURRENT TIMESTAMP         07470331
074704              AND H.PO_NBR            = :RECEIV-ORD-NBR           07470431
074705              AND H.REC_SEQ_NBR       = :RECEIV-REC-SEQ-NBR       07470531
074706              AND H.VER_STAT_CDE      = 'A'                       07470631
074707              AND H.PKSL_STAT_CDE     = 'AC'                      07470731
074708              AND SUBSTR(CHAR(H.PRO_NBR),1,G.ATTR_ELEM_NBR)       07470831
074709                  = C.ATTR_ELEM_TXT                               07470938
074710             WITH UR                                              07471031
074711     END-EXEC.                                                    07471131
074712                                                                  07471231
074713     EVALUATE TRUE                                                07471331
074714         WHEN SQLCODE = ZERO                                      07471431
074715              SET PS-PRO-LEVEL-TRBL-CHECK  TO  TRUE               07471531
074716                                                                  07471631
074717         WHEN SQLCODE = +100                                      07471731
074718              SET PS-PRO-LEVEL-TRBL-CHECK-NO  TO  TRUE            07471831
074719                                                                  07471931
074720         WHEN SQLWARN0 NOT = SPACES                               07472031
074721         WHEN SQLCODE  NOT = ZERO                                 07472131
074722              SET PS-PRO-LEVEL-TRBL-CHECK-NO  TO  TRUE            07472231
074723              MOVE 'PARM AUTRBL03 ' TO DP013-MESSAGE-TEXT (1)     07472331
074724              MOVE 'RCKCS213'          TO DP013-PROGRAM           07472431
074725              MOVE '5730-CHECK-AUTRBL03' TO DP013-PARAGRAPH       07472531
074726              MOVE 'WST PARM    ' TO DP013-DB2-TABLE-NAME (1)     07472631
074727              SET DP013-DB2-ABEND                                 07472731
074728                                 TO TRUE                          07472831
074729              SET DP013-XCTL-DISPLAY-RESTART                      07472931
074730                                 TO TRUE                          07473031
074731              PERFORM DP013-0000-PROCESS-ABEND                    07473131
074732     END-EVALUATE.                                                07473231
074733                                                                  07473348
074747                                                                  07474748
074748*----------------------------------------------------------------*07474848
074749*  - CHECK THE CONTROL FLOW PARM = CNTLFLOW TO SEE WHAT TROUBLE  *07474948
074750*    CODE SHOULD BE CREATED                                      *07475048
074751*----------------------------------------------------------------*07475148
074752 5740-CHECK-CNTLFLOW.                                             07475248
074753                                                                  07475348
074763     MOVE ZEROES TO PV-CNTLFLOW-TRBRSN.                           07476348
074764     MOVE SPACES TO PS-CREATE-DC-EFC-LVL-SW.                      07476448
074765                                                                  07476548
074766     EXEC SQL                                                     07476648
074767          SELECT D.ATTR_ELEM_NBR                                  07476748
074768               , E.ATTR_ELEM_TXT                                  07476848
074769            INTO :PV-CNTLFLOW-TRBRSN                              07476948
074770               , :PS-CREATE-DC-EFC-LVL-SW                         07477048
074771            FROM                                                  07477148
074772                 WST_INTGRTN_TYP A                                07477248
074773               , WST_ATTR_DEFN B                                  07477348
074774               , WST_ATTR_ELEM C                                  07477448
074775               , WST_ATTR_ELEM D                                  07477548
074776               , WST_ATTR_ELEM E                                  07477648
074777            WHERE                                                 07477748
074778                  A.INTGRTN_TYP_CDE   =  'CNTLFLOW'               07477848
074779              AND A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE         07477948
074780              AND B.ATTR_DEFN_SEQ_NBR = 1                         07478048
074781              AND B.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE         07478148
074782              AND C.ATTR_DEFN_SEQ_NBR = 1                         07478248
074783              AND B.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE         07478348
074784              AND D.ATTR_DEFN_SEQ_NBR = 2                         07478448
074785              AND B.INTGRTN_TYP_CDE   = E.INTGRTN_TYP_CDE         07478548
074786              AND E.ATTR_DEFN_SEQ_NBR = 3                         07478648
074787              AND C.ATTR_ELEM_SEQ_NBR = D.ATTR_ELEM_SEQ_NBR       07478748
074788              AND C.ATTR_ELEM_SEQ_NBR = E.ATTR_ELEM_SEQ_NBR       07478848
074789              AND C.ATTR_ELEM_NBR     = :PV-AUTRBL03-NBR          07478948
074790             WITH UR                                              07479048
074791     END-EXEC.                                                    07479148
074792                                                                  07479248
074793     EVALUATE TRUE                                                07479348
074794         WHEN SQLCODE = ZERO                                      07479448
074795              SET PS-PRO-LEVEL-TRBL-CHECK  TO  TRUE               07479548
074796                                                                  07479648
074797         WHEN SQLCODE = +100                                      07479748
074798              SET PS-PRO-LEVEL-TRBL-CHECK-NO  TO  TRUE            07479848
074799                                                                  07479948
074800         WHEN SQLWARN0 NOT = SPACES                               07480048
074801         WHEN SQLCODE  NOT = ZERO                                 07480148
074802              SET PS-PRO-LEVEL-TRBL-CHECK-NO  TO  TRUE            07480248
074803              MOVE 'PARM CNTLFLOW' TO DP013-MESSAGE-TEXT (1)      07480348
074804              MOVE 'RCKCS213'          TO DP013-PROGRAM           07480448
074805              MOVE '5740-CHECK-CNTLFLOW' TO DP013-PARAGRAPH       07480548
074806              MOVE 'WST PARM    ' TO DP013-DB2-TABLE-NAME (1)     07480648
074807              SET DP013-DB2-ABEND                                 07480748
074808                                 TO TRUE                          07480848
074809              SET DP013-XCTL-DISPLAY-RESTART                      07480948
074810                                 TO TRUE                          07481048
074811              PERFORM DP013-0000-PROCESS-ABEND                    07481148
074812     END-EVALUATE.                                                07481248
074813                                                                  07481348
074814                                                                  07481448
074829                                                                  07482948
074830                                                                  07483048
074831*----------------------------------------------------------------*07483148
074832*  - CHECK IF RECEIVER ALREADY HAS TROUBLE FOR MIXEDSKU - 434    *07483248
074833*    IF RECEIVER ALREADY HAS THIS TROUBLE DO NOT CREATE AGAIN    *07483348
074834*----------------------------------------------------------------*07483448
074835 5750-CHECK-DC-EFC.                                               07483548
074836                                                                  07483648
074846     MOVE SPACES TO PS-DC-EFC-LOC-SW.                             07484648
074847                                                                  07484748
074848     EXEC SQL                                                     07484848
074849          SELECT   E_BUS_IND                                      07484948
074850            INTO  :PS-DC-EFC-LOC-SW                               07485048
074851            FROM                                                  07485148
074852                  XLT_LOC                                         07485248
074853            WHERE                                                 07485348
074854                  LOC_NBR           = :RECEIV-CURR-OPER-UNT-ID    07485448
074855              AND LOC_TYP_CDE       = 'DC'                        07485548
074856              AND OPN_DTE          <=  CURRENT DATE               07485648
074857              AND CLO_DTE          >=  CURRENT DATE               07485748
074858             WITH UR                                              07485848
074859     END-EXEC.                                                    07485948
074860                                                                  07486048
074861     EVALUATE TRUE                                                07486148
074862         WHEN SQLCODE = ZERO                                      07486248
074863              IF  PS-CREATE-BOTH                                  07486348
074864                  SET PS-PRO-LEVEL-TRBL-CHECK TO TRUE             07486448
074865              ELSE                                                07486548
074866                  IF  PS-CREATE-DC-ONLY  AND                      07486648
074867                      PS-DC-LOCATION                              07486748
074868                      SET PS-PRO-LEVEL-TRBL-CHECK TO TRUE         07486848
074869                  ELSE                                            07486948
074870                      IF  PS-CREATE-EFC-ONLY  AND                 07487048
074871                          PS-EFC-LOCATION                         07487148
074872                          SET PS-PRO-LEVEL-TRBL-CHECK TO TRUE     07487248
074873                      ELSE                                        07487348
074874                          SET PS-PRO-LEVEL-TRBL-CHECK-NO TO TRUE  07487448
074875                      END-IF                                      07487548
074876                  END-IF                                          07487648
074877              END-IF                                              07487748
074878                                                                  07487848
074879         WHEN SQLCODE = +100                                      07487948
074880              SET PS-PRO-LEVEL-TRBL-CHECK-NO  TO  TRUE            07488048
074881                                                                  07488148
074882         WHEN SQLWARN0 NOT = SPACES                               07488248
074883         WHEN SQLCODE  NOT = ZERO                                 07488348
074884              SET PS-PRO-LEVEL-TRBL-CHECK-NO  TO  TRUE            07488448
074885              MOVE 'CHECK DC-EFC' TO DP013-MESSAGE-TEXT (1)       07488548
074886              MOVE 'RCKCS213'          TO DP013-PROGRAM           07488648
074887              MOVE '5750-CHECK-DC-EFC' TO DP013-PARAGRAPH         07488748
074888              MOVE 'XLT_LOC     ' TO DP013-DB2-TABLE-NAME (1)     07488848
074889              SET DP013-DB2-ABEND                                 07488948
074890                                 TO TRUE                          07489048
074891              SET DP013-XCTL-DISPLAY-RESTART                      07489148
074892                                 TO TRUE                          07489248
074893              PERFORM DP013-0000-PROCESS-ABEND                    07489348
074894     END-EVALUATE.                                                07489448
074906                                                                  07490649
074907*----------------------------------------------------------------*07490749
074908*  - CHECK IF RECEIVER ALREADY HAS TROUBLE FOR MIXEDSKU - 434    *07490849
074909*    IF RECEIVER ALREADY HAS THIS TROUBLE DO NOT CREATE AGAIN    *07490949
074910*----------------------------------------------------------------*07491049
074911 5760-CHECK-PRO-TRBL.                                             07491149
074912                                                                  07491249
074922     MOVE ZEROES TO PV-HAS-PRO-TRBL-CNT.                          07492249
074923                                                                  07492349
074924     EXEC SQL                                                     07492449
074925          SELECT  COUNT(*)                                        07492549
074926            INTO  :PV-HAS-PRO-TRBL-CNT                            07492649
074927            FROM                                                  07492749
074928                  TTRBNTF                                         07492849
074929            WHERE                                                 07492949
074930                  OPER_UNT_ID       = :RECEIV-CURR-OPER-UNT-ID    07493049
074931              AND PO_NBR            = :RECEIV-ORD-NBR             07493149
074932              AND REC_SEQ_NBR       = :RECEIV-REC-SEQ-NBR         07493249
074933              AND TRBL_RSN_CDE      = :PV-CNTLFLOW-TRBRSN         07493349
074934***           AND RESOLVED_TMST    >=  CURRENT TMST               07493449
074935***           AND ACKNOWLG_TMST    >=  CURRENT TMST               07493549
074936            FETCH FIRST 1 ROW ONLY                                07493649
074937             WITH UR                                              07493749
074938     END-EXEC.                                                    07493849
074939                                                                  07493949
074940     EVALUATE TRUE                                                07494049
074941         WHEN SQLCODE = ZERO                                      07494149
074942              IF  PV-HAS-PRO-TRBL-CNT > 0                         07494249
074943                  SET PS-PRO-LEVEL-TRBL-CHECK-NO TO TRUE          07494349
074944              ELSE                                                07494449
074945                  IF  PV-HAS-PRO-TRBL-CNT = 0                     07494549
074946                     SET PS-PRO-LEVEL-TRBL-CHECK TO TRUE          07494649
074947                  END-IF                                          07494749
074948              END-IF                                              07494849
074949                                                                  07494949
074950         WHEN SQLCODE = +100                                      07495049
074951         WHEN SQLCODE = -305                                      07495149
074952              SET PS-PRO-LEVEL-TRBL-CHECK  TO  TRUE               07495249
074953                                                                  07495349
074954         WHEN SQLWARN0 NOT = SPACES                               07495449
074955         WHEN SQLCODE  NOT = ZERO                                 07495549
074956              SET PS-PRO-LEVEL-TRBL-CHECK-NO  TO  TRUE            07495649
074957              MOVE 'CHECK PRO TRBL' TO DP013-MESSAGE-TEXT (1)     07495749
074958              MOVE 'RCKCS213'            TO DP013-PROGRAM         07495849
074959              MOVE '5760-CHECK-PRO-TRBL' TO DP013-PARAGRAPH       07495949
074960              MOVE 'TTRBNTF     ' TO DP013-DB2-TABLE-NAME (1)     07496049
074961              SET DP013-DB2-ABEND                                 07496149
074962                                 TO TRUE                          07496249
074963              SET DP013-XCTL-DISPLAY-RESTART                      07496349
074964                                 TO TRUE                          07496449
074965              PERFORM DP013-0000-PROCESS-ABEND                    07496549
074966     END-EVALUATE.                                                07496649
074967                                                                  07496749
074968                                                                  07496849
074969*----------------------------------------------------------------*07496949
074970*  - CREATE NEW RECEIVER LEVEL TROUBLE                           *07497049
074971*----------------------------------------------------------------*07497149
074972 5770-CREATE-PRO-TRBL.                                            07497249
074973                                                                  07497349
074983     MOVE RECEIV-CURR-OPER-UNT-ID TO TM500-OPER-UNT-ID.           07498349
074984     MOVE RECEIV-ORD-NBR          TO TM500-PO-NBR.                07498449
074985     MOVE RECEIV-REC-SEQ-NBR      TO TM500-REC-SEQ-NBR.           07498549
074986     MOVE PV-CNTLFLOW-TRBRSN      TO TM500-TRBL-RSN-CDE.          07498649
074987     MOVE ZEROES                  TO TM500-PO-LNE-NBR.            07498751
074988     MOVE 'MIXED SKU CARTONS ON RECEIVER'                         07498851
074989                                  TO TM500-FREEFORM-TEXT.         07498951
074990     SET  TM500-PO-LEVEL                                          07499051
074991          TM500-ADD-DETAILS       TO TRUE.                        07499151
074992                                                                  07499251
074993     EXEC CICS                                                    07499351
074994         LINK PROGRAM  (PC-TMKCS521)                              07499451
074995              COMMAREA (TM500-FIELDS)                             07499551
074996              LENGTH   (PC-TROUBLE-RTN-LENGTH)                    07499651
074997     END-EXEC.                                                    07499751
074998                                                                  07499851
074999     EVALUATE TRUE                                                07499951
075000         WHEN TM500-CALL-SUCCESSFUL                               07500051
075001         WHEN TM500-TTRBNTF-UPDATE-NOT-FND                        07500151
075002              CONTINUE                                            07500251
075003                                                                  07500351
075004         WHEN OTHER                                               07500451
075005              MOVE TM500-OPER-UNT-ID  TO PV-DISP-OPER-B           07500551
075006              MOVE TM500-PO-NBR       TO PV-DISP-PO               07500651
075007              MOVE TM500-REC-SEQ-NBR  TO PV-DISP-RCVR             07500751
075008              MOVE TM500-TRBL-RSN-CDE TO PV-DISP-TRBL             07500851
075009              SET PS-PRO-LEVEL-TRBL-CHECK-NO  TO  TRUE            07500951
075010              MOVE 'CREATE MIXED SKU TRBL'                        07501051
075011                                         TO DP013-MESSAGE-TEXT (1)07501151
075012              MOVE SPACES                TO DP013-MESSAGE-TEXT (2)07501251
075013              STRING PV-DISP-OPER-B '-'                           07501351
075014                     PV-DISP-PO '-'                               07501451
075015                     PV-DISP-RCVR '   '                           07501551
075016                     PV-DISP-TRBL           DELIMITED BY SIZE     07501651
075017                                       INTO DP013-MESSAGE-TEXT (2)07501751
075018              MOVE 'RCKCS213'            TO DP013-PROGRAM         07501851
075019              MOVE '5770-CREATE-PRO-TRBL'                         07501951
075020                                         TO DP013-PARAGRAPH       07502051
075021              MOVE 'TTRBNTF     ' TO DP013-DB2-TABLE-NAME (1)     07502151
075022              SET DP013-DB2-ABEND                                 07502251
075023                                 TO TRUE                          07502351
075024              SET DP013-XCTL-DISPLAY-RESTART                      07502451
075025                                 TO TRUE                          07502551
075026              PERFORM DP013-0000-PROCESS-ABEND                    07502651
075027     END-EVALUATE.                                                07502751
075028                                                                  07502851
075029                                                                  07502951
075030*----------------------------------------------------------------*07503051
075031* INSERT INTO PO TRACKING TABLE WHEN THE RECEIVER HAS BEEN       *07503151
075032* TRANSCRIBED                                                    *07503251
075033*----------------------------------------------------------------*07503351
075034 5800-INSERT-PO-TRACK.                                            07503451
075035                                                                  07503551
075036     MOVE RECEIV-ORD-NBR           TO  RCT00017-PO-NBR.           07503651
075037     MOVE RECEIV-REC-SEQ-NBR       TO  RCT00017-RCVR-SEQ-NBR.     07503751
075038                                                                  07503852
075039     IF  RCT00017-PO-NBR        =  0 AND                          07503952
075040         RCT00017-RCVR-SEQ-NBR  =  0                              07504052
075041         MOVE DK-PO-NBR            TO  RCT00017-PO-NBR            07504152
075042         MOVE DK-REC-SEQ-NBR       TO  RCT00017-RCVR-SEQ-NBR      07504252
075043     END-IF.                                                      07504352
075044                                                                  07504452
075045     MOVE ASC-KEY-OPER-UNT-ID      TO  RCT00017-LOC-NBR.          07504551
075046     MOVE RECEIV-CURR-OPER-UNT-ID  TO  RCT00017-DEST-LOC-NBR.     07504651
075047     MOVE DP020-USERID             TO  RCT00017-CRE-BY-USR-ID.    07504751
075048     MOVE 'RCKCS213'               TO  RCT00017-CRE-BY-PGM-NM.    07504851
075049     MOVE 0                        TO  RCT00017-PO-LNE-NBR        07504951
075050                                       RCT00017-PREPK-ID          07505051
075051                                       RCT00017-QTY-TRKD-NBR      07505151
075052                                       RCT00017-PKSL-SEQ-NBR.     07505251
075053                                                                  07505351
075054         EXEC SQL                                                 07505451
075055              INSERT INTO RCT_PO_RCVR_TRKG                        07505551
075056                     ( PO_NBR                                     07505651
075057                      ,RCVR_SEQ_NBR                               07505751
075058                      ,CRE_BY_USR_ID                              07505851
075059                      ,CRE_TMST                                   07505951
075060                      ,DC_FUNC_CDE                                07506051
075061                      ,LOC_NBR                                    07506151
075062                      ,PO_LNE_NBR                                 07506251
075063                      ,PREPK_ID                                   07506351
075064                      ,CRE_BY_PGM_NM                              07506451
075065                      ,QTY_TRKD_NBR                               07506551
075066                      ,LAST_UPD_TMST                              07506651
075067                      ,PKSL_SEQ_NBR                               07506751
075068                      ,DEST_LOC_NBR                               07506851
075069                      )                                           07506951
075070             VALUES ( :RCT00017-PO-NBR                            07507051
075071                     ,:RCT00017-RCVR-SEQ-NBR                      07507151
075072                     ,:RCT00017-CRE-BY-USR-ID                     07507251
075073                     , CURRENT TIMESTAMP                          07507351
075074                     ,:RCT00017-DC-FUNC-CDE                       07507451
075075                     ,:RCT00017-LOC-NBR                           07507551
075076                     ,:RCT00017-PO-LNE-NBR                        07507651
075077                     ,:RCT00017-PREPK-ID                          07507751
075078                     ,:RCT00017-CRE-BY-PGM-NM                     07507851
075079                     ,:RCT00017-QTY-TRKD-NBR                      07507951
075080                     , CURRENT TIMESTAMP                          07508051
075081                     ,:RCT00017-PKSL-SEQ-NBR                      07508151
075082                     ,:RCT00017-DEST-LOC-NBR                      07508251
075083                     )                                            07508351
075084         END-EXEC                                                 07508451
075085                                                                  07508551
075086         EVALUATE TRUE                                            07508651
075087             WHEN SQLCODE = ZERO                                  07508751
075088                  CONTINUE                                        07508851
075089                                                                  07508951
075090             WHEN SQLCODE = -904                                  07509051
075091             WHEN SQLCODE = -911                                  07509151
075092             WHEN SQLCODE = -913                                  07509251
075093                  PERFORM 9900-SOFT-ABORT                         07509351
075094                                                                  07509451
075095             WHEN SQLWARN0 NOT = SPACES                           07509551
075096             WHEN SQLCODE  NOT = ZERO                             07509651
075097                  MOVE '5800-INSERT-PO-TRACK        '             07509751
075098                                 TO DP013-PARAGRAPH               07509851
075099                  MOVE 'UNSUCCESSFUL INSERT OF RCT00017'          07509951
075100                                 TO DP013-MESSAGE-TEXT (1)        07510051
075101                  MOVE ASC-KEY-PO-NBR                             07510151
075102                                 TO PV-MSG-KEY-PO                 07510251
075103                  MOVE ASC-KEY-REC-SEQ-NBR                        07510351
075104                                 TO PV-MSG-KEY-REC-SEQ-NBR-N      07510451
075105                  MOVE PKSLIP-STR-DEST-NBR                        07510551
075106                                 TO PV-MSG-KEY-STR-NBR            07510651
075107                  MOVE PV-MSG-KEYS                                07510751
075108                                 TO DP013-MESSAGE-TEXT (2)        07510851
075109                  MOVE SQLCA     TO DP013-SQLCA                   07510951
075110                  MOVE 'RCT00017' TO DP013-DB2-TABLE-NAME (1)     07511051
075111                  SET DP013-DB2-ABEND                             07511151
075112                      DP013-XCTL-DISPLAY-RESTART                  07511251
075113                                 TO TRUE                          07511351
075114                  PERFORM DP013-0000-PROCESS-ABEND                07511451
075115         END-EVALUATE.                                            07511551
075116                                                                  07511651
075117                                                                  07511751
075118 6000-REFRESH-PANEL-FROM-TEMP.                                    07511851
075119                                                                  07511951
075120     IF ASC-UPDATE-TSQ                                            07512051
075121         SET ASC-NO-TSQ-UPDATE   TO TRUE                          07512151
075122         MOVE ZERO               TO PV-SAVE-ITEM                  07512251
075123                                    PV-SEL-QUEUE-ITEM             07512351
075124         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        07512451
075125                                 TO PV-HOLD-SELECTED-ITEMS        07512551
075126         PERFORM 6100-UPDATE-TSQ                                  07512651
075127           UNTIL PV-ITEMS-PROCESSED > ASC-NUMBER-OF-SELECTED-ITEMS07512751
075128                                                                  07512851
075129         PERFORM 6010-DELETE-SEL-QUEUE                            07512951
075130                                                                  07513051
075131         INITIALIZE ASC-BLOCK-ENTRIES (1)                         07513151
075132                    ASC-BLOCK-ENTRIES (2)                         07513251
075133                                                                  07513351
075134         DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL                 07513451
075135                GIVING    PV-BLOCK-NUMBER                         07513551
075136                REMAINDER PV-REMAINDER                            07513651
075137                                                                  07513751
075138         IF PV-REMAINDER > ZERO                                   07513851
075139             ADD +1              TO PV-BLOCK-NUMBER               07513951
075140         END-IF                                                   07514051
075141                                                                  07514151
075142         MOVE +1                 TO ASC-BLK-SUB                   07514251
075143                                                                  07514351
075144         PERFORM 4410-READ-TEMP-STORAGE                           07514451
075145                                                                  07514551
075146         ADD +1                  TO ASC-BLK-SUB                   07514651
075147                            PV-BLOCK-NUMBER                       07514751
075148         PERFORM 4410-READ-TEMP-STORAGE                           07514851
075149                                                                  07514951
075150     END-IF.                                                      07515051
075151                                                                  07515151
075152 6010-DELETE-SEL-QUEUE.                                           07515251
075153                                                                  07515351
075154     EXEC CICS DELETEQ TS                                         07515451
075155               QUEUE (ASC-SEL-QUEUE-NAME-OUT)                     07515551
075156               RESP  (PV-CICS-RESP)                               07515651
075157     END-EXEC.                                                    07515751
075158                                                                  07515851
075159     IF ((PV-CICS-RESP = DFHRESP (NORMAL)) OR                     07515951
075160         (PV-CICS-RESP = DFHRESP (QIDERR)))                       07516051
075161         CONTINUE                                                 07516151
075162     ELSE                                                         07516251
075163         SET DP013-CICS-ABEND                                     07516351
075164             DP013-NO-ROLLBACK   TO TRUE                          07516451
075165         MOVE '6010-DELETE-SEL-QUEUE'                             07516551
075166                                 TO DP013-PARAGRAPH               07516651
075167         MOVE 'UNSUCCESSFUL SEL ITEMS TEMP STORAGE QUEUE DELETE'  07516751
075168                                 TO DP013-MESSAGE-TEXT (1)        07516851
075169         PERFORM DP013-0000-PROCESS-ABEND                         07516951
075170     END-IF.                                                      07517051
075171                                                                  07517151
075172 6100-UPDATE-TSQ.                                                 07517251
075173                                                                  07517351
075174     ADD 1                       TO PV-SEL-QUEUE-ITEM.            07517451
075175                                                                  07517551
075176     PERFORM 6105-READ-SEL-QUEUE.                                 07517651
075177     MOVE PV-SEL-QUEUE-ITEM      TO PV-SAVE-ITEM.                 07517751
075178                                                                  07517851
075179     PERFORM                                                      07517951
075180     VARYING RC013-IDX  FROM 1 BY 1                               07518051
075181     UNTIL   PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS OR       07518151
075182             RC013-IDX > RC013-MAX-ITEMS                          07518251
075183                                                                  07518351
075184         IF RC013-ACTION-SW (RC013-IDX) > SPACE                   07518451
075185            PERFORM 6110-PROCESS-ITEMS                            07518551
075186         END-IF                                                   07518651
075187                                                                  07518751
075188         ADD +1                  TO PV-ITEMS-PROCESSED            07518851
075189     END-PERFORM.                                                 07518951
075190                                                                  07519051
075191     PERFORM 6111-WRITE-LIST-QUEUE.                               07519151
075192                                                                  07519251
075193                                                                  07519351
075194 6105-READ-SEL-QUEUE.                                             07519408
075200                                                                  07520008
075210     EXEC CICS READQ TS                                           07521008
075220               QUEUE (ASC-SEL-QUEUE-NAME-OUT)                     07522008
075230               INTO  (RC013-DC-SELECT-RECORD)                     07523008
075240               ITEM  (PV-SEL-QUEUE-ITEM)                          07524008
075250               RESP  (PV-CICS-RESP)                               07525008
075260     END-EXEC.                                                    07526008
075270                                                                  07527008
075280     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       07528008
075290         SET DP013-CICS-ABEND                                     07529008
075300             DP013-NO-ROLLBACK   TO TRUE                          07530008
075310         MOVE '6105-READ-SEL-QUEUE'                               07531008
075320                                 TO DP013-PARAGRAPH               07532008
075330         MOVE 'UNSUCCESSFUL SEL ITEMS TEMP STORAGE QUEUE READ'    07533008
075340                                 TO DP013-MESSAGE-TEXT (1)        07534008
075350         MOVE ASC-SEL-TASK-NUMBER                                 07535008
075360                                 TO PV-DISPLAY-TASK               07536008
075370         STRING 'QUEUE ID: '                                      07537008
075380                ASC-SEL-TERM-ID                                   07538008
075390                ' '                                               07539008
075400                PV-DISPLAY-TASK                                   07540008
075410                ' '                                               07541008
075420                ASC-SEL-SEQ DELIMITED BY SIZE                     07542008
075430                               INTO DP013-MESSAGE-TEXT (2)        07543008
075440         PERFORM DP013-0000-PROCESS-ABEND                         07544008
075450     END-IF.                                                      07545008
075460                                                                  07546008
075470 6110-PROCESS-ITEMS.                                              07547008
075480                                                                  07548008
075490     COMPUTE PV-ITEM = 1 + ((RC013-ITEM (RC013-IDX) - 1)          07549008
075500                                            / PC-ITEMS-PER-PANEL).07550008
075510                                                                  07551008
075520     IF PV-ITEM NOT = PV-SAVE-ITEM                                07552008
075530        IF PV-SAVE-ITEM NOT = ZERO                                07553008
075540                                                                  07554008
075550            PERFORM 6111-WRITE-LIST-QUEUE                         07555008
075560                                                                  07556008
075570        END-IF                                                    07557008
075580        MOVE PV-ITEM             TO PV-SAVE-ITEM                  07558008
075590                                                                  07559008
075600        PERFORM 6112-READ-LIST-QUEUE                              07560008
075610                                                                  07561008
075620     END-IF.                                                      07562008
075630                                                                  07563008
075640     COMPUTE PV-SUB = (RC013-ITEM (RC013-IDX) -                   07564008
075650                                    LQW-LIST-ITEM-NUMBER (1)) + 1.07565008
075660     SET LQW-DESELECT (PV-SUB)   TO TRUE                          07566008
075670     MOVE LQW-SELECTED-SW (PV-SUB)                                07567008
075680                                 TO LQW-TEMP-SELECTED-SW (PV-SUB).07568008
075690                                                                  07569008
075700     EVALUATE TRUE                                                07570008
075710         WHEN RC013-INQ (RC013-IDX)                               07571008
075720              MOVE 'INQ'         TO LQW-ACTION (PV-SUB)           07572008
075730                                                                  07573008
075740         WHEN RC013-UPD (RC013-IDX)                               07574008
075750              MOVE 'UPD'         TO LQW-ACTION (PV-SUB)           07575008
075760                                                                  07576008
075770         WHEN RC013-DEL (RC013-IDX)                               07577008
075780              MOVE 'DEL'         TO LQW-ACTION (PV-SUB)           07578008
075790                                                                  07579008
075800         WHEN RC013-ERR (RC013-IDX)                               07580008
075810              MOVE PC-ERR        TO LQW-ACTION (PV-SUB)           07581008
075820     END-EVALUATE.                                                07582008
075830                                                                  07583008
075840     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                07584008
075850     SUBTRACT LQW-CARTON-COUNT (PV-SUB)  FROM                     07585008
075860                                   ASC-SELECTED-CARTON-COUNT.     07586008
075870                                                                  07587008
075880 6111-WRITE-LIST-QUEUE.                                           07588008
075890                                                                  07589008
075900     EXEC CICS WRITEQ TS                                          07590008
075910               QUEUE (ASC-LIST-QUEUE-NAME)                        07591008
075920               FROM  (LQW-LIST-QUEUE-WORK-AREA)                   07592008
075930               ITEM  (PV-SAVE-ITEM)                               07593008
075940               REWRITE                                            07594008
075950               RESP  (PV-CICS-RESP)                               07595008
075960     END-EXEC.                                                    07596008
075970                                                                  07597008
075980     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       07598008
075990         SET DP013-CICS-ABEND                                     07599008
076000             DP013-NO-ROLLBACK   TO TRUE                          07600008
076010         MOVE '6111-WRITE-LIST-QUEUE'                             07601008
076020                                 TO DP013-PARAGRAPH               07602008
076030         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE REWRITE'07603008
076040                                 TO DP013-MESSAGE-TEXT(1)         07604008
076050         PERFORM DP013-0000-PROCESS-ABEND                         07605008
076060     END-IF.                                                      07606008
076070                                                                  07607008
076080 6112-READ-LIST-QUEUE.                                            07608008
076090                                                                  07609008
076100     EXEC CICS READQ TS                                           07610008
076110               QUEUE (ASC-LIST-QUEUE-NAME)                        07611008
076120               INTO  (LQW-LIST-QUEUE-WORK-AREA)                   07612008
076130               ITEM  (PV-ITEM)                                    07613008
076140               RESP  (PV-CICS-RESP)                               07614008
076150     END-EXEC.                                                    07615008
076160                                                                  07616008
076170     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       07617008
076180         SET DP013-CICS-ABEND                                     07618008
076190             DP013-NO-ROLLBACK   TO TRUE                          07619008
076200         MOVE '6112-READ-LIST-QUEUE'                              07620008
076210                                 TO DP013-PARAGRAPH               07621008
076220         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE READ'   07622008
076230                                 TO DP013-MESSAGE-TEXT(1)         07623008
076240         PERFORM DP013-0000-PROCESS-ABEND                         07624008
076250     END-IF.                                                      07625008
076260                                                                  07626008
076270 7000-SUM-RECEIPTS.                                               07627008
076280                                                                  07628008
076290     PERFORM 7700-OPEN-PKSLIP-ITEM-CURSOR                         07629008
076300     PERFORM 7110-SUM-PKSLIP-ITEMS                                07630008
076310             UNTIL PS-END-OF-PKSLIP-ITEM-CSR                      07631008
076320     PERFORM 7720-CLOSE-PKSLIP-ITEM-CURSOR.                       07632008
076330                                                                  07633008
076340                                                                  07634008
076350     PERFORM 7200-OPEN-UNPKSL-ITEM-CURSOR                         07635008
076360     PERFORM 7210-SUM-UNPKSL-ITEMS                                07636008
076370             UNTIL PS-END-OF-UNPKSL-ITEM-CSR                      07637008
076380     PERFORM 7230-CLOSE-UNPKSL-ITEM-CURSOR.                       07638008
076390                                                                  07639008
076400 7001-STAGE-PREPACKS.                                             07640008
076410                                                                  07641008
076420     PERFORM 7730-OPEN-PRPK-PKSLIP-ITEM-CSR                       07642008
076430     PERFORM 7731-FETCH-PREPACK-ITEM-CSR                          07643008
076440     PERFORM VARYING PV-READ-COUNT FROM 1 BY 1                    07644008
076450                 UNTIL PV-READ-COUNT > PC-MAX-PKITEMS OR          07645008
076460                       PS-END-PRPK-PKSLIP-ITEM-CSR                07646008
076470                                                                  07647008
076480         SET PWT-STAGE-IDX            TO 1                        07648008
076490         SEARCH PWT-PACK-INFO                                     07649008
076500         WHEN PWT-STG-LNE-NBR (PWT-STAGE-IDX) = ZERO              07650008
076510             MOVE PURITM-PO-PREPK-ID  TO PWT-STG-PREPK-ID         07651008
076520                                         (PWT-STAGE-IDX)          07652008
076530                                                                  07653008
076540             MOVE PURITM-VER-NBR      TO PWT-STG-PURITM-VER-NBR   07654008
076550                                         (PWT-STAGE-IDX)          07655008
076560             MOVE PV-PKSL-LNE-NBR     TO PWT-STG-LNE-NBR          07656008
076570                                         (PWT-STAGE-IDX)          07657008
076580             MOVE PV-LINE-QTY         TO PWT-STG-PKSL-ITM-QTY     07658008
076590                                         (PWT-STAGE-IDX)          07659008
076600             MOVE PURITM-PREPK-RATO-QTY                           07660008
076610                                      TO PWT-STG-PREPK-RATO-QTY   07661008
076620                                         (PWT-STAGE-IDX)          07662008
076630                                                                  07663008
076640         WHEN PV-PKSL-LNE-NBR = PWT-STG-LNE-NBR (PWT-STAGE-IDX)   07664008
076650             ADD PV-LINE-QTY          TO PWT-STG-PKSL-ITM-QTY     07665008
076660                                         (PWT-STAGE-IDX)          07666008
076670         END-SEARCH                                               07667008
076680                                                                  07668008
076690         PERFORM 7731-FETCH-PREPACK-ITEM-CSR                      07669008
076700                                                                  07670008
076710     END-PERFORM.                                                 07671008
076720                                                                  07672008
076730     PERFORM 7732-CLOSE-PRPK-PKSLIP-ITM-CSR.                      07673008
076740                                                                  07674008
076750 7002-PROCESS-PREPACKS.                                           07675008
076760                                                                  07676008
076770     MOVE PWT-STG-PREPK-ID (PWT-STAGE-IDX)                        07677008
076780                                      TO PV-PREV-PO-PREPK-ID      07678008
076790                                         DK-PREPK-ID              07679008
076800                                                                  07680008
076810     INITIALIZE RC806-PRODUCT-PACK-VALIDATION                     07681008
076820     SET RC806-CALC-BEST-CASE         TO TRUE                     07682008
076830     PERFORM 7735-SELECT-TPOPRPK                                  07683008
076840                                                                  07684008
076850     IF POPRPK-OTPK-UNT-QTY = ZERO                                07685008
076860         MOVE 1                       TO RC806-INNER-PACK-QTY     07686008
076870     ELSE                                                         07687008
076880         COMPUTE RC806-INNER-PACK-QTY =                           07688008
076890                 POPRPK-OTPK-UNT-QTY / POPRPK-INPK-UNT-QTY        07689008
076900             ON SIZE ERROR                                        07690008
076910                 MOVE 1               TO RC806-INNER-PACK-QTY     07691008
076920         END-COMPUTE                                              07692008
076930     END-IF                                                       07693008
076940                                                                  07694008
076950         PERFORM 7115-SUM-PRPK-PKSLIP-ITEMS                       07695008
076960             UNTIL PWT-STG-PREPK-ID (PWT-STAGE-IDX) = ZERO        07696008
076970                                                                  07697008
076980             PERFORM 8300-VALIDATION-MODULE                       07698008
076990                                                                  07699008
077000         IF RC806-NO-ERRORS                                       07700008
077010             PERFORM 7116-FILL-MATCHED-ITEM-TABLE                 07701008
077020                 VARYING RC806-LINE-IDX                           07702008
077030                 FROM 1 BY 1                                      07703008
077040                 UNTIL RC806-PKSL-LNE-NBR(RC806-LINE-IDX) = ZERO  07704008
077050         END-IF.                                                  07705008
077060                                                                  07706008
077070 7110-SUM-PKSLIP-ITEMS.                                           07707008
077080                                                                  07708008
077090     PERFORM VARYING PV-READ-COUNT  FROM 1 BY 1                   07709008
077100         UNTIL PV-READ-COUNT > PC-MAX-PKITEMS OR                  07710008
077110               PS-END-OF-PKSLIP-ITEM-CSR                          07711008
077120                                                                  07712008
077130         PERFORM 7710-FETCH-PKSLIP-ITEMS                          07713008
077140                                                                  07714008
077150         IF PS-NOT-END-OF-PKSLIP-ITEM-CSR                         07715008
077160             MOVE PV-PKSL-LNE-NBR                                 07716008
077170               TO PWT-PKSL-M-LNE-NBR (PV-PKSL-LNE-NBR)            07717008
077180                                                                  07718008
077190             COMPUTE PWT-M-LINE-QTY (PV-PKSL-LNE-NBR) =           07719008
077200                     PWT-M-LINE-QTY (PV-PKSL-LNE-NBR) +           07720008
077210                     PV-LINE-QTY                                  07721008
077220                                                                  07722008
077230             IF LQW-STR-DEST-NBR (LQW-IDX) > ZERO                 07723008
077240                 MOVE PV-PKSL-LNE-NBR TO RECITM-ORD-LNE-NBR       07724008
077250                 MOVE LQW-STR-DEST-NBR (LQW-IDX)                  07725008
077260                                      TO RECDIS-STR-NBR           07726008
077270                 PERFORM 9410-PREPARE-TRECDIS                     07727008
077280                 PERFORM 9420-INSERT-TRECDIS                      07728008
077290             END-IF                                               07729008
077300         END-IF                                                   07730008
077310     END-PERFORM.                                                 07731008
077320                                                                  07732008
077330 7115-SUM-PRPK-PKSLIP-ITEMS.                                      07733008
077340                                                                  07734008
077350     IF PWT-STG-PREPK-ID (PWT-STAGE-IDX) = PV-PREV-PO-PREPK-ID    07735008
077360         AND PWT-STG-PREPK-ID (PWT-STAGE-IDX) > ZERO              07736008
077370                                                                  07737008
077380         IF PWT-STG-LNE-NBR (PWT-STAGE-IDX) > ZERO                07738008
077390             ADD 1                    TO RC806-NBR-OF-LINES       07739008
077400             MOVE PWT-STG-PREPK-RATO-QTY (PWT-STAGE-IDX)          07740008
077410                                      TO RC806-PO-RATIO           07741008
077420                                           (RC806-LINE-IDX)       07742008
077430                                         RC806-RC-RATIO           07743008
077440                                           (RC806-LINE-IDX)       07744008
077450                                                                  07745008
077460             MOVE PWT-STG-PKSL-ITM-QTY (PWT-STAGE-IDX)            07746008
077470                                      TO RC806-UNIT-QTY           07747008
077480                                           (RC806-LINE-IDX)       07748008
077490                                         RC806-RCVG-QTY           07749008
077500                                           (RC806-LINE-IDX)       07750008
077510                                                                  07751008
077520             MOVE PWT-STG-LNE-NBR (PWT-STAGE-IDX)                 07752008
077530                                      TO RC806-PKSL-LNE-NBR       07753008
077540                                           (RC806-LINE-IDX)       07754008
077550             SET RC806-LINE-IDX UP BY 1                           07755008
077560         END-IF                                                   07756008
077570                                                                  07757008
077580         SET PWT-STAGE-IDX UP BY 1                                07758008
077590                                                                  07759008
077600     ELSE                                                         07760008
077610                                                                  07761008
077620         IF PV-PREV-PO-PREPK-ID = 99                              07762008
077630             CONTINUE                                             07763008
077640         ELSE                                                     07764008
077650             PERFORM 8300-VALIDATION-MODULE                       07765008
077660         END-IF                                                   07766008
077670                                                                  07767008
077680         IF RC806-NO-ERRORS                                       07768008
077690                                                                  07769008
077700* WE WANT TO AVOID OVERLAYING ANY LINES THAT WERE ALREADY         07770008
077710* LOADED TO THE TABLE                                             07771008
077720                                                                  07772008
077730             PERFORM 7116-FILL-MATCHED-ITEM-TABLE                 07773008
077740                 VARYING RC806-LINE-IDX                           07774008
077750                 FROM 1 BY 1                                      07775008
077760                 UNTIL RC806-PKSL-LNE-NBR(RC806-LINE-IDX) = ZERO  07776008
077770                                                                  07777008
077780             SET RC806-LINE-IDX       TO 1                        07778008
077790             MOVE PWT-STG-PREPK-ID (PWT-STAGE-IDX)                07779008
077800                                      TO PV-PREV-PO-PREPK-ID      07780008
077810                                         DK-PREPK-ID              07781008
077820             INITIALIZE RC806-PRODUCT-PACK-VALIDATION             07782008
077830             SET RC806-CALC-BEST-CASE TO TRUE                     07783008
077840             PERFORM 7735-SELECT-TPOPRPK                          07784008
077850                                                                  07785008
077860         IF POPRPK-OTPK-UNT-QTY = ZERO                            07786008
077870             MOVE 1                   TO RC806-INNER-PACK-QTY     07787008
077880         ELSE                                                     07788008
077890             COMPUTE RC806-INNER-PACK-QTY =                       07789008
077900                 POPRPK-OTPK-UNT-QTY / POPRPK-INPK-UNT-QTY        07790008
077910             ON SIZE ERROR                                        07791008
077920                 MOVE 1               TO RC806-INNER-PACK-QTY     07792008
077930             END-COMPUTE                                          07793008
077940         END-IF                                                   07794008
077950                                                                  07795008
077960     END-IF.                                                      07796008
077970                                                                  07797008
077980 7116-FILL-MATCHED-ITEM-TABLE.                                    07798008
077990                                                                  07799008
078000     MOVE RC806-PKSL-LNE-NBR (RC806-LINE-IDX)                     07800008
078010                                      TO PWT-PKSL-M-LNE-NBR       07801008
078020                                         (PWT-M-IDX)              07802008
078030                                                                  07803008
078040     IF RC806-LINE-IDX = RC806-DRIVER-LNE-SUB                     07804008
078050         SET PWT-DRIVER-LINE-YES (PWT-M-IDX)                      07805008
078060                                      TO TRUE                     07806008
078070     ELSE                                                         07807008
078080         SET PWT-DRIVER-LINE-NO (PWT-M-IDX)                       07808008
078090                                      TO TRUE                     07809008
078100     END-IF                                                       07810008
078110                                                                  07811008
078120     MOVE RC806-RCVG-QTY (RC806-LINE-IDX)                         07812008
078130                                         TO PWT-M-LINE-QTY        07813008
078140                                         (PWT-M-IDX)              07814008
078150                                                                  07815008
078160     MOVE PV-PREV-PO-PREPK-ID         TO PWT-M-PREPK-ID           07816008
078170                                         (PWT-M-IDX)              07817008
078180                                                                  07818008
078190     MOVE RC806-PO-RATIO (RC806-LINE-IDX)                         07819008
078200                                      TO PWT-M-PREPK-RATIO-QTY    07820008
078210                                         (PWT-M-IDX)              07821008
078220                                                                  07822008
078230     MOVE RC806-BEST-CASE-UNITS (RC806-LINE-IDX)                  07823008
078240                                      TO PWT-M-PREPK-BEST-CASES   07824008
078250                                         (PWT-M-IDX)              07825008
078260                                                                  07826008
078270     MOVE RC806-ODD-UNITS (RC806-LINE-IDX)                        07827008
078280                                      TO PWT-M-PREPK-ODD-UNITS    07828008
078290                                         (PWT-M-IDX)              07829008
078300                                                                  07830008
078310     MOVE RC806-NBR-OF-PACKS          TO PWT-M-PREPK-NBR-OF-PACKS 07831008
078320                                         (PWT-M-IDX).             07832008
078330     SET PWT-M-IDX                    UP BY 1.                    07833008
078340/                                                                 07834008
078350 7200-OPEN-UNPKSL-ITEM-CURSOR.                                    07835008
078360                                                                  07836008
078370         EXEC SQL                                                 07837008
078380              OPEN UNPKSL-ITEM-CURSOR                             07838008
078390         END-EXEC                                                 07839008
078400                                                                  07840008
078410         EVALUATE TRUE                                            07841008
078420             WHEN SQLCODE = ZERO                                  07842008
078430                  SET PS-NOT-END-OF-UNPKSL-ITEM-CSR               07843008
078440                                 TO TRUE                          07844008
078450             WHEN SQLCODE = -904                                  07845008
078460             WHEN SQLCODE = -911                                  07846008
078470             WHEN SQLCODE = -913                                  07847008
078480                  PERFORM 9900-SOFT-ABORT                         07848008
078490                                                                  07849008
078500             WHEN SQLWARN0 NOT = SPACES                           07850008
078510             WHEN SQLCODE  NOT = ZERO                             07851008
078520                  MOVE '7200-OPEN-UNPKSL-ITEM-CURSOR'             07852008
078530                                 TO DP013-PARAGRAPH               07853008
078540                  MOVE 'UNSUCCESSFUL UNPKSL-ITEM CURSOR OPEN'     07854008
078550                                 TO DP013-MESSAGE-TEXT (1)        07855008
078560                  MOVE ASC-KEY-PO-NBR                             07856008
078570                                 TO PV-MSG-KEY-PO                 07857008
078580                  MOVE ASC-KEY-REC-SEQ-NBR                        07858008
078590                                 TO PV-MSG-KEY-REC-SEQ-NBR-N      07859008
078600                  MOVE PV-MSG-KEYS                                07860008
078610                                 TO DP013-MESSAGE-TEXT (2)        07861008
078620                  MOVE SQLCA     TO DP013-SQLCA                   07862008
078630                  MOVE 'TUNPKSL' TO DP013-DB2-TABLE-NAME (1)      07863008
078640                  SET DP013-XCTL-DISPLAY-RESTART                  07864008
078650                      DP013-DB2-ABEND                             07865008
078660                                 TO TRUE                          07866008
078670                                                                  07867008
078680                  PERFORM DP013-0000-PROCESS-ABEND                07868008
078690         END-EVALUATE.                                            07869008
078700                                                                  07870008
078710 7210-SUM-UNPKSL-ITEMS.                                           07871008
078720                                                                  07872008
078730     PERFORM VARYING PV-READ-COUNT  FROM 1 BY 1                   07873008
078740         UNTIL PV-READ-COUNT > PC-MAX-UNPKSLS OR                  07874008
078750               PS-END-OF-UNPKSL-ITEM-CSR                          07875008
078760                                                                  07876008
078770         PERFORM 7220-FETCH-UNPKSL-ITEMS                          07877008
078780         SET PWT-U-IDX           TO 1                             07878008
078790                                                                  07879008
078800         IF PS-NOT-END-OF-UNPKSL-ITEM-CSR                         07880008
078810             SEARCH PWT-UNMATCHED-TBL                             07881008
078820                    VARYING PWT-U-IDX                             07882008
078830                                                                  07883008
078840                 AT END                                           07884008
078850                     CONTINUE                                     07885008
078860                                                                  07886008
078870                 WHEN PWT-COLOR-DESC     (PWT-U-IDX) = SPACES  AND07887008
078880                      PWT-SIZE-DESC      (PWT-U-IDX) = SPACES  AND07888008
078890                      PWT-VEND-STYL-NAME (PWT-U-IDX) = SPACES     07889008
078900                     MOVE UNPKSL-COLOR-DESC                       07890008
078910                                 TO PWT-COLOR-DESC    (PWT-U-IDX) 07891008
078920                     MOVE UNPKSL-SIZE-DESC                        07892008
078930                                 TO PWT-SIZE-DESC     (PWT-U-IDX) 07893008
078940                     MOVE UNPKSL-VEND-STYL-NAME                   07894008
078950                                 TO PWT-VEND-STYL-NAME(PWT-U-IDX) 07895008
078960                     MOVE PV-LINE-QTY                             07896008
078970                                 TO PWT-U-LINE-QTY    (PWT-U-IDX) 07897008
078980                                                                  07898008
078990                 WHEN PWT-COLOR-DESC     (PWT-U-IDX) =            07899008
079000                                  UNPKSL-COLOR-DESC AND           07900008
079010                      PWT-SIZE-DESC      (PWT-U-IDX) =            07901008
079020                                  UNPKSL-SIZE-DESC  AND           07902008
079030                      PWT-VEND-STYL-NAME (PWT-U-IDX) =            07903008
079040                                  UNPKSL-VEND-STYL-NAME           07904008
079050                     COMPUTE PWT-U-LINE-QTY (PWT-U-IDX) =         07905008
079060                         PWT-U-LINE-QTY (PWT-U-IDX) +  PV-LINE-QTY07906008
079070             END-SEARCH                                           07907008
079080         END-IF                                                   07908008
079090     END-PERFORM.                                                 07909008
079100                                                                  07910008
079110 7220-FETCH-UNPKSL-ITEMS.                                         07911008
079120                                                                  07912008
079130     EXEC SQL                                                     07913008
079140          FETCH UNPKSL-ITEM-CURSOR                                07914008
079150           INTO :PV-LINE-QTY,                                     07915008
079160                :UNPKSL-COLOR-DESC,                               07916008
079170                :UNPKSL-SIZE-DESC,                                07917008
079180                :UNPKSL-VEND-STYL-NAME                            07918008
079190     END-EXEC.                                                    07919008
079200                                                                  07920008
079210     EVALUATE TRUE                                                07921008
079220         WHEN SQLCODE = ZERO                                      07922008
079230              CONTINUE                                            07923008
079240         WHEN SQLCODE = +100                                      07924008
079250              SET PS-END-OF-UNPKSL-ITEM-CSR                       07925008
079260                                 TO TRUE                          07926008
079270         WHEN SQLCODE = -904                                      07927008
079280         WHEN SQLCODE = -911                                      07928008
079290         WHEN SQLCODE = -913                                      07929008
079300              PERFORM 9900-SOFT-ABORT                             07930008
079310                                                                  07931008
079320         WHEN SQLWARN0 NOT = SPACES                               07932008
079330         WHEN SQLCODE  NOT = ZERO                                 07933008
079340              MOVE '7220-FETCH-UNPKSL-ITEMS'                      07934008
079350                                 TO DP013-PARAGRAPH               07935008
079360              MOVE 'UNSUCCESSFUL FETCH PACK SLIP LINE CURSOR'     07936008
079370                                 TO DP013-MESSAGE-TEXT (1)        07937008
079380              MOVE ASC-KEY-PO-NBR                                 07938008
079390                                 TO PV-MSG-KEY-PO                 07939008
079400              MOVE ASC-KEY-REC-SEQ-NBR                            07940008
079410                                 TO PV-MSG-KEY-REC-SEQ-NBR-N      07941008
079420              MOVE PV-MSG-KEYS   TO DP013-MESSAGE-TEXT (2)        07942008
079430              MOVE SQLCA         TO DP013-SQLCA                   07943008
079440              MOVE 'TUNPKSL'     TO DP013-DB2-TABLE-NAME (1)      07944008
079450              SET DP013-DB2-ABEND                                 07945008
079460                  DP013-XCTL-DISPLAY-RESTART                      07946008
079470                                 TO TRUE                          07947008
079480                                                                  07948008
079490              PERFORM DP013-0000-PROCESS-ABEND                    07949008
079500     END-EVALUATE.                                                07950008
079510                                                                  07951008
079520 7230-CLOSE-UNPKSL-ITEM-CURSOR.                                   07952008
079530                                                                  07953008
079540     EXEC SQL                                                     07954008
079550          CLOSE UNPKSL-ITEM-CURSOR                                07955008
079560     END-EXEC.                                                    07956008
079570                                                                  07957008
079580     EVALUATE TRUE                                                07958008
079590         WHEN SQLCODE = ZERO                                      07959008
079600              CONTINUE                                            07960008
079610         WHEN SQLCODE = -904                                      07961008
079620         WHEN SQLCODE = -911                                      07962008
079630         WHEN SQLCODE = -913                                      07963008
079640              PERFORM 9900-SOFT-ABORT                             07964008
079650                                                                  07965008
079660         WHEN SQLWARN0 NOT = SPACES                               07966008
079670         WHEN SQLCODE  NOT = ZERO                                 07967008
079680              MOVE '7230-CLOSE-UNPKSL-ITEM-CURSOR'                07968008
079690                                 TO DP013-PARAGRAPH               07969008
079700              MOVE 'UNSUCCESSFUL UNPKSL CURSOR CLOSE'             07970008
079710                                 TO DP013-MESSAGE-TEXT (1)        07971008
079720              MOVE ASC-KEY-PO-NBR                                 07972008
079730                                 TO PV-MSG-KEY-PO                 07973008
079740              MOVE ASC-KEY-REC-SEQ-NBR                            07974008
079750                                 TO PV-MSG-KEY-REC-SEQ-NBR-N      07975008
079760              MOVE PV-MSG-KEYS   TO DP013-MESSAGE-TEXT (2)        07976008
079770              MOVE SQLCA         TO DP013-SQLCA                   07977008
079780              MOVE 'TUNPKSL '    TO DP013-DB2-TABLE-NAME (1)      07978008
079790              SET DP013-DB2-ABEND                                 07979008
079800                  DP013-XCTL-DISPLAY-RESTART                      07980008
079810                                 TO TRUE                          07981008
079820                                                                  07982008
079830              PERFORM DP013-0000-PROCESS-ABEND                    07983008
079840     END-EVALUATE.                                                07984008
079850                                                                  07985008
079860 7300-CREATE-RECITM.                                              07986008
079870                                                                  07987008
079880     PERFORM 7350-GET-MAX-RECITM-LNE-NBR.                         07988008
079890     PERFORM 7310-CREATE-MATCHED-RECITM.                          07989008
079900                                                                  07990008
079910* IF NO UNMATCHED PACKSLIPS WERE LOADED TO THE WORK TABLE,        07991008
079920* SKIP THIS PROCESSING.                                           07992008
079930     IF PV-UNPKSL-COUNT > ZERO                                    07993008
079940         PERFORM 7320-CREATE-UNMATCHED-RECITM                     07994008
079950     END-IF.                                                      07995008
079960                                                                  07996008
079970 7310-CREATE-MATCHED-RECITM.                                      07997008
079980                                                                  07998008
079990* LINES ARE LOADED INTO THE PWT TABLE USING THE LINE NBR AS       07999008
080000*        THE SUBSCRIPT                                            08000008
080010                                                                  08001008
080020     PERFORM                                                      08002008
080030         VARYING PWT-M-IDX                                        08003008
080040         FROM 1 BY 1                                              08004008
080050         UNTIL PWT-M-IDX > PC-MAX-PKITEMS                         08005008
080060             IF PWT-PKSL-M-LNE-NBR(PWT-M-IDX) = ZERO              08006008
080070                 CONTINUE                                         08007008
080080             ELSE                                                 08008008
080090                 INITIALIZE DCLTRECITM                            08009008
080100                 INITIALIZE DCLTPURITM                            08010008
080110                 MOVE PWT-PKSL-M-LNE-NBR (PWT-M-IDX)              08011008
080120                                 TO RECITM-ORD-LNE-NBR            08012008
080130                                    PURITM-APP-PO-LNE-NBR         08013008
080140*  THIS COULD BE 01 02 OR 03                                      08014008
080150                 PERFORM 7800-SELECT-RECITM                       08015008
080160                                                                  08016008
080170                 COMPUTE PV-PKSL-ITM-QTY =                        08017008
080180                     PWT-M-LINE-QTY (PWT-M-IDX) +                 08018008
080190                     RECITM-PKSL-ITM-QTY                          08019008
080200                                                                  08020008
080210                 PERFORM 7330-SELECT-PURITM                       08021008
080220                                                                  08022008
080230                 IF PS-PURITM-FOUND                               08023008
080240                     INITIALIZE XL001-ITEM-COMMAREA               08024008
080250                                                                  08025008
080260                     IF (PURITM-SKU-SEQ-NBR NOT = PC-000 AND      08026008
080270                         PURITM-SKU-SEQ-NBR NOT = PC-999)         08027008
080280                             PERFORM 7355-CALL-CICS-API-ARCH      08028008
080290***GB 3/25/12                                                     08029008
080300                         MOVE PURITM-INNR-PK-QTY TO               08030008
080310                                RECITM-INNR-PACK-QTY              08031008
080320                         MOVE PURITM-OUTR-PK-QTY TO               08032008
080330                                  RECITM-CASE-PACK-QTY            08033008
080340***GB 3/25/12                                                     08034008
080350                     END-IF                                       08035008
080360                     MOVE ASC-KEY-PO-NBR-N                        08036008
080370                          TO DK-PO-NBR                            08037008
080380                     PERFORM 7360-SELECT-PRETICKET-TKT-TYPE       08038008
080390                     IF PS-PRETICKET                              08039008
080400                         PERFORM 7380-SELECT-TKT-FMT-ID           08040008
080410                     ELSE                                         08041008
080420                         MOVE XL001-TKT-TYP-DESC TO               08042008
080430                                            DK-TICKET-DESC        08043008
080440                         PERFORM 7380-SELECT-TKT-FMT-ID           08044008
080450                     END-IF                                       08045008
080460                 END-IF                                           08046008
080470                                                                  08047008
080480                 IF PS-RECITM-FOUND                               08048008
080490                     PERFORM 8000-AUDIT-RECITM                    08049008
080500                     MOVE PV-PKSL-ITM-QTY TO RECITM-PKSL-ITM-QTY  08050008
080510                     MOVE PURITM-VER-NBR  TO RECITM-PO-VER-NBR    08051008
080520                     MOVE PURITM-ITM-NBR  TO RECITM-ITM-NBR       08052008
080530                     MOVE PURITM-UNT-RTL-PR-AMT                   08053008
080540                                          TO RECITM-UNT-RTL-AMT   08054008
080550                     MOVE PURITM-UNT-COST-AMT                     08055008
080560                                          TO RECITM-UNT-COST-AMT  08056008
080570                     MOVE PURITM-GP-RTL-AMT                       08057008
080580                                          TO RECITM-GP-RTL-AMT    08058008
080590                     MOVE PURITM-GP-QTY   TO RECITM-GP-QTY        08059008
080600                                                                  08060008
080610                     IF ASC-TRECEIV-PKGNG-CDE = 'M' OR 'I'        08061008
080620                          PERFORM  7821-SETUP-RECITM-PREPACK      08062008
080630                     ELSE                                         08063008
080640                          INITIALIZE  RECITM-PREPK-ID             08064008
080650                                      RECITM-PREPK-DRV-LNE-CDE    08065008
080660                                      RECITM-PREPK-RATO-QTY       08066008
080670                                      RECITM-PREPK-ODD-UNT-QTY    08067008
080680                                      RECITM-PREPK-DRV-LNE-CDE    08068008
080690                     END-IF                                       08069008
080700                                                                  08070008
080710                     PERFORM 7815-UPDATE-RECITM-QTY               08071008
080720                     PERFORM 7620-SELECT-RECDIS                   08072008
080730                 ELSE                                             08073008
080740                     IF PS-IN-RECITM-FOUND                        08074008
080750                         PERFORM 8000-AUDIT-RECITM                08075008
080760                         MOVE PV-PKSL-ITM-QTY TO                  08076008
080770                                             RECITM-PKSL-ITM-QTY  08077008
080780                         MOVE PURITM-VER-NBR  TO RECITM-PO-VER-NBR08078008
080790                         MOVE PURITM-ITM-NBR  TO RECITM-ITM-NBR   08079008
080800                         MOVE PURITM-UNT-RTL-PR-AMT               08080008
080810                                              TO                  08081008
080820                                             RECITM-UNT-RTL-AMT   08082008
080830                         MOVE PURITM-UNT-COST-AMT                 08083008
080840                                              TO                  08084008
080850                                              RECITM-UNT-COST-AMT 08085008
080860                         MOVE PURITM-GP-RTL-AMT                   08086008
080870                                              TO RECITM-GP-RTL-AMT08087008
080880                         MOVE PURITM-GP-QTY   TO RECITM-GP-QTY    08088008
080890                                                                  08089008
080900                                                                  08090008
080910                         IF ASC-TRECEIV-PKGNG-CDE  = 'M' OR 'I'   08091008
080920                              PERFORM  7821-SETUP-RECITM-PREPACK  08092008
080930                         ELSE                                     08093008
080940                              INITIALIZE  RECITM-PREPK-ID         08094008
080950                                        RECITM-PREPK-DRV-LNE-CDE  08095008
080960                                        RECITM-PREPK-RATO-QTY     08096008
080970                                        RECITM-PREPK-ODD-UNT-QTY  08097008
080980                                        RECITM-PREPK-DRV-LNE-CDE  08098008
080990                         END-IF                                   08099008
081000                                                                  08100008
081010                         PERFORM 7805-SET-CURR-RECITM-TO-ACT      08101008
081020                         PERFORM 7620-SELECT-RECDIS               08102008
081030* 6/2007 - ADD CALL TO 7450-  FOR PBS RECEIVERS                   08103008
081040* 9/2007 - REMOVE CALL TO 7450-  FOR PBS RECEIVERS                08104008
081050*                        PERFORM 7450-CHECK-WMS                   08105008
081060                     ELSE                                         08106008
081070                         MOVE PV-PKSL-ITM-QTY                     08107008
081080                                         TO RECITM-PKSL-ITM-QTY   08108008
081090                         MOVE 'A'        TO RECITM-VER-STATUS-CDE 08109008
081100                         PERFORM 7820-SETUP-RECITM-FIELDS         08110008
081110                         PERFORM 7830-INSERT-RECITM               08111008
081120                     END-IF                                       08112008
081130                 END-IF                                           08113008
081140             IF  ASC-PACK-BY-ST-IND = 'Y'                         08114008
081150                 PERFORM 9310-FIND-OUT-PLAN                       08115008
081160*                IF PS-SPECIFIC-PLAN                              08116008
081170*                    PERFORM 9450-INACTIVATE-ALLPLN               08117008
081180*                END-IF                                           08118008
081190             END-IF                                               08119008
081200                 IF DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)        08120008
081210*  INACTIVATE PACKSLIPS                                           08121008
081220                     CONTINUE                                     08122008
081230                 ELSE                                             08123008
081240                     IF PS-BULK-SHIPMENT                          08124008
081250                         IF RECITM-ORD-LNE-NBR < 1000             08125008
081260                             PERFORM 7635-DELETE-RECDIS           08126008
081270                             SET PS-7635-DELETE TO TRUE           08127008
081280                             PERFORM 7640-DELETE-ODD-UNIT         08128008
081290* PREPACK TRANSCRIPTION IS PROCESSED DIFFERENTLY                  08129008
081300                             IF ASC-TRECEIV-PKGNG-CDE             08130008
081310                                                 = 'M' OR 'I'     08131008
081320                                 CONTINUE                         08132008
081330                             ELSE                                 08133008
081340                                 PERFORM 7400-CHECK-FOR-TROUBLE   08134008
081350* JAK 06/2007 - ADD CALL TO 7450-                                 08135008
081360* JAK 09/2007 - REMOVE CALL TO 7450-                              08136008
081370*                                PERFORM 7450-CHECK-WMS           08137008
081380                             END-IF                               08138008
081390                         END-IF                                   08139008
081400                     END-IF                                       08140008
081410                 END-IF                                           08141008
081420             END-IF                                               08142008
081430     END-PERFORM.                                                 08143008
081440                                                                  08144008
081450                                                                  08145008
081460***************************************************************** 08146008
081470*  UNMATCHED RECITMS WAS MEANT TO RECOGNIZE RECEIPT LINES THAT    08147008
081480*  COULDN'T BE MATCHED TO A PO LINE.  THE ORIGINAL DESIGN OF THE  08148008
081490*  SYSTEM WAS MEANT TO KEY PACKSLIPS AGAINST PO LINES, AND THOSE  08149008
081500*  PACKSLIP LINES THAT DIDN'T MATCH TO A PO WOULD BE ENTERED WITH 08150008
081510*  A LINE NUMBER STARTING IN THE 900 SERIES TO FLAG IT CANNOT BE  08151008
081520*  IDENTIFIED.  THEN ORDER CONTROL WOULD DO TRANSCRIPTION COMPLETE08152008
081530*  WHICH WOULD CREATE TROUBLE.  THE BUYERS WOULD HAVE TO TELL ORDE08153008
081540*  CONTROL WHAT PO LINE THEY SHOULD BE.  THEN THE LINE NUMBER WOUL08154008
081550*  BE CHANGED TO THE ACTUAL PO LINE NUMBER.  THIS WAS DONE TO     08155008
081560*  GET AWAY FROM THE PO BEING UPDATED TO MATCH THE RECEIPT.  TODAY08156008
081570*  IF THEY CAN'T FIND A PO LINE, THEY ADD THE LINE TO THE PO.     08157008
081580*  A PO SHOULD REAMIN AS WRITTEN SO WE HAVE SOMETHING TO COMPARE T08158008
081590*  RECEIVERS TO FOR COMPLIANCE.                                   08159008
081600***************************************************************** 08160008
081610 7320-CREATE-UNMATCHED-RECITM.                                    08161008
081620                                                                  08162008
081630     MOVE ZEROS                  TO PURITM-VER-NBR                08163008
081640                                    PURITM-ITM-NBR.               08164008
081650                                                                  08165008
081660     PERFORM                                                      08166008
081670         VARYING PWT-U-IDX                                        08167008
081680         FROM 1 BY 1                                              08168008
081690         UNTIL PWT-U-IDX > PC-MAX-UNPKSLS                         08169008
081700             IF PWT-COLOR-DESC     (PWT-U-IDX) > SPACES OR        08170008
081710                PWT-SIZE-DESC      (PWT-U-IDX) > SPACES OR        08171008
081720                PWT-VEND-STYL-NAME (PWT-U-IDX) > SPACES           08172008
081730                 INITIALIZE DCLTRECITM                            08173008
081740                 MOVE PV-NEXT-LINE-NBR                            08174008
081750                                 TO RECITM-ORD-LNE-NBR            08175008
081760                 ADD +1          TO PV-NEXT-LINE-NBR              08176008
081770                                                                  08177008
081780                 MOVE PWT-COLOR-DESC (PWT-U-IDX)                  08178008
081790                                 TO RECITM-COLOR-DESC             08179008
081800                 MOVE PWT-SIZE-DESC  (PWT-U-IDX)                  08180008
081810                                 TO RECITM-SIZE-DESC              08181008
081820                 MOVE PWT-VEND-STYL-NAME (PWT-U-IDX)              08182008
081830                                 TO RECITM-VEND-STYL-NAME         08183008
081840                                                                  08184008
081850                 PERFORM 7940-SELECT-UNMATCHED-RECITM             08185008
081860                 IF PS-RECITM-FOUND                               08186008
081870                                                                  08187008
081880                     IF ASC-TRECEIV-PKGNG-CDE = 'M' OR 'I'        08188008
081890                          PERFORM  7821-SETUP-RECITM-PREPACK      08189008
081900                     ELSE                                         08190008
081910                          INITIALIZE  RECITM-PREPK-ID             08191008
081920                                      RECITM-PREPK-DRV-LNE-CDE    08192008
081930                                      RECITM-PREPK-RATO-QTY       08193008
081940                                      RECITM-PREPK-ODD-UNT-QTY    08194008
081950                     END-IF                                       08195008
081960                                                                  08196008
081970                     COMPUTE RECITM-PKSL-ITM-QTY =                08197008
081980                             RECITM-PKSL-ITM-QTY +                08198008
081990                             PWT-U-LINE-QTY (PWT-U-IDX)           08199008
082000                     PERFORM 8000-AUDIT-RECITM                    08200008
082010                     PERFORM 7815-UPDATE-RECITM-QTY               08201008
082020                 ELSE                                             08202008
082030                     MOVE PWT-U-LINE-QTY (PWT-U-IDX)              08203008
082040                                 TO RECITM-PKSL-ITM-QTY           08204008
082050                     MOVE 'A'        TO RECITM-VER-STATUS-CDE     08205008
082060                     PERFORM 7820-SETUP-RECITM-FIELDS             08206008
082070                     PERFORM 7830-INSERT-RECITM                   08207008
082080                 END-IF                                           08208008
082090                 IF DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)        08209008
082100                     CONTINUE                                     08210008
082110                 ELSE                                             08211008
082120                     IF PS-BULK-SHIPMENT                          08212008
082130                         IF RECITM-ORD-LNE-NBR < 1000             08213008
082140                             PERFORM 7635-DELETE-RECDIS           08214008
082150                             SET PS-7635-DELETE TO TRUE           08215008
082160                             PERFORM 7640-DELETE-ODD-UNIT         08216008
082170                             PERFORM 7400-CHECK-FOR-TROUBLE       08217008
082180                         END-IF                                   08218008
082190                     END-IF                                       08219008
082200                 END-IF                                           08220008
082210             END-IF                                               08221008
082220     END-PERFORM.                                                 08222008
082230                                                                  08223008
082240 7330-SELECT-PURITM.                                              08224008
082250                                                                  08225008
082260         EXEC SQL                                                 08226008
082270             SELECT VER_NBR,                                      08227008
082280                    ITM_NBR,                                      08228008
082290                    PIC_ITM_IND,                                  08229008
082300                    PO_LNE_NBR,                                   08230008
082310                    VEND_STYL_NAME,                               08231008
082320                    SKU_SEQ_NBR,                                  08232008
082330                    UNT_RTL_PR_AMT,                               08233008
082340                    UNT_COST_AMT,                                 08234008
082350                    GP_RTL_AMT,                                   08235008
082360                    GP_QTY ,                                      08236008
082370                    INNR_PK_QTY,                                  08237008
082380                    OUTR_PK_QTY                                   08238008
082390              INTO  :PURITM-VER-NBR,                              08239008
082400                    :PURITM-ITM-NBR,                              08240008
082410                    :PURITM-PIC-ITM-IND,                          08241008
082420                    :PURITM-PO-LNE-NBR,                           08242008
082430                    :PURITM-VEND-STYL-NAME,                       08243008
082440                    :PURITM-SKU-SEQ-NBR,                          08244008
082450                    :PURITM-UNT-RTL-PR-AMT,                       08245008
082460                    :PURITM-UNT-COST-AMT,                         08246008
082470                    :PURITM-GP-RTL-AMT,                           08247008
082480                    :PURITM-GP-QTY,                               08248008
082490                    :PURITM-INNR-PK-QTY,                          08249008
082500                    :PURITM-OUTR-PK-QTY                           08250008
082510               FROM TPURITM                                       08251008
082520              WHERE PO_NBR         = :DK-PO-NBR                   08252008
082530                AND APP_PO_LNE_NBR = :PURITM-APP-PO-LNE-NBR       08253008
082540                AND VER_STATUS_CDE = 'A'                          08254008
082550         END-EXEC                                                 08255008
082560                                                                  08256008
082570         EVALUATE TRUE                                            08257008
082580             WHEN SQLCODE = ZERO                                  08258008
082590                  SET PS-PURITM-FOUND                             08259008
082600                                 TO TRUE                          08260008
082610             WHEN SQLCODE = +100                                  08261008
082620                  SET PS-PURITM-NOT-FOUND                         08262008
082630                                 TO TRUE                          08263008
082640             WHEN SQLCODE = -904                                  08264008
082650             WHEN SQLCODE = -911                                  08265008
082660             WHEN SQLCODE = -913                                  08266008
082670                  PERFORM 9900-SOFT-ABORT                         08267008
082680                                                                  08268008
082690             WHEN SQLWARN0 NOT = SPACES                           08269008
082700             WHEN SQLCODE  NOT = ZERO                             08270008
082710                  MOVE '7330-SELECT-PURITM'                       08271008
082720                                 TO DP013-PARAGRAPH               08272008
082730                  MOVE 'UNSUCCESSFUL SELECT OF TPURITM'           08273008
082740                                 TO DP013-MESSAGE-TEXT (1)        08274008
082750                  MOVE ASC-KEY-PO-NBR                             08275008
082760                                 TO PV-MSG-KEY-PO                 08276008
082770                  MOVE ASC-KEY-REC-SEQ-NBR                        08277008
082780                                 TO PV-MSG-KEY-REC-SEQ-NBR-N      08278008
082790                  MOVE PURITM-APP-PO-LNE-NBR                      08279008
082800                                 TO PV-MSG-KEY-PO-LNE-NBR-N       08280008
082810                  MOVE PV-MSG-KEYS                                08281008
082820                                 TO DP013-MESSAGE-TEXT (2)        08282008
082830                  MOVE SQLCA     TO DP013-SQLCA                   08283008
082840                  MOVE 'TPURITM' TO DP013-DB2-TABLE-NAME (1)      08284008
082850                  SET DP013-DB2-ABEND                             08285008
082860                      DP013-XCTL-DISPLAY-RESTART                  08286008
082870                                 TO TRUE                          08287008
082880                  PERFORM DP013-0000-PROCESS-ABEND                08288008
082890         END-EVALUATE.                                            08289008
082900                                                                  08290008
082910                                                                  08291008
082920*----------------------------------------------------------------*08292008
082930*    FIND THE ROW WITH THE HIGHEST LINE NUMBER                   *08293008
082940*----------------------------------------------------------------*08294008
082950                                                                  08295008
082960 7350-GET-MAX-RECITM-LNE-NBR.                                     08296008
082970                                                                  08297008
082980         EXEC SQL                                                 08298008
082990              SELECT MAX(ORD_LNE_NBR)                             08299008
083000                INTO :PV-NEXT-LINE-NBR :PV-LINE-NBR-IND           08300008
083010                FROM TRECITM                                      08301008
083020               WHERE ORD_NBR        = :PKSLIP-PO-NBR              08302008
083030                 AND REC_SEQ_NBR    = :PKSLIP-REC-SEQ-NBR         08303008
083040                 AND VER_STATUS_CDE = 'A'                         08304008
083050         END-EXEC                                                 08305008
083060                                                                  08306008
083070         EVALUATE TRUE                                            08307008
083080             WHEN SQLCODE = +0                                    08308008
083090                  IF PV-NEXT-LINE-NBR < PC-9000                   08309008
083100                      MOVE PC-9000 TO PV-NEXT-LINE-NBR            08310008
083110                  ELSE                                            08311008
083120                      COMPUTE PV-NEXT-LINE-NBR =                  08312008
083130                          PV-NEXT-LINE-NBR + 1                    08313008
083140                  END-IF                                          08314008
083150             WHEN SQLCODE = +100                                  08315008
083160                  MOVE PC-9000     TO PV-NEXT-LINE-NBR            08316008
083170             WHEN SQLCODE = -904                                  08317008
083180             WHEN SQLCODE = -911                                  08318008
083190             WHEN SQLCODE = -913                                  08319008
083200                  PERFORM 9900-SOFT-ABORT                         08320008
083210                                                                  08321008
083220             WHEN SQLWARN0 NOT = SPACES                           08322008
083230             WHEN SQLCODE < +0                                    08323008
083240             WHEN SQLCODE > +0                                    08324008
083250                  MOVE '7350-GET-MAX-RECITM-LNE-NBR'              08325008
083260                                   TO DP013-PARAGRAPH             08326008
083270                  MOVE 'UNSUCCESSFUL SELECT MAX LINE NBR'         08327008
083280                                   TO DP013-MESSAGE-TEXT (1)      08328008
083290                  MOVE ASC-KEY-PO-NBR                             08329008
083300                                 TO PV-MSG-KEY-PO                 08330008
083310                  MOVE ASC-KEY-REC-SEQ-NBR                        08331008
083320                                 TO PV-MSG-KEY-REC-SEQ-NBR-N      08332008
083330                  MOVE PV-MSG-KEYS                                08333008
083340                                   TO DP013-MESSAGE-TEXT (2)      08334008
083350                  MOVE SQLCA       TO DP013-SQLCA                 08335008
083360                  MOVE 'TRECITM '  TO DP013-DB2-TABLE-NAME (1)    08336008
083370                  SET DP013-DB2-ABEND                             08337008
083380                      DP013-XCTL-DISPLAY-RESTART                  08338008
083390                                   TO TRUE                        08339008
083400                  PERFORM DP013-0000-PROCESS-ABEND                08340008
083410         END-EVALUATE.                                            08341008
083420                                                                  08342008
083430*----------------------------------------------------------------*08343008
083440* CODE FOR LOGISTICS DOMAIN ITEM ACCESS MODULE                   *08344008
083450*----------------------------------------------------------------*08345008
083460                                                                  08346008
083470 7355-CALL-CICS-API-ARCH.                                         08347008
083480                                                                  08348008
083490            MOVE PURITM-ITM-NBR        TO XL001-KEY-ITM-NBR.      08349008
083500                                                                  08350008
083510            SET  XL001-BY-ITEM                                    08351008
083520                 XL001-SELECT-SKU                                 08352008
083530                 XL001-SELECT-VND-STYL TO TRUE.                   08353008
083540                                                                  08354008
083550            CALL XL001-VSM-PGM USING  DFHEIBLK                    08355008
083560                                      XL001-COMMAREA              08356008
083570                                      XL001-ITEM-COMMAREA.        08357008
083580         EVALUATE TRUE                                            08358008
083590                                                                  08359008
083600              WHEN XL001-SKU-SQLCODE = +0                         08360008
083610*GB 3/25/12       MOVE XL001-INNR-PACK-QTY                        08361008
083620*GB 3/25/12             TO RECITM-INNR-PACK-QTY                   08362008
083630                  PERFORM 7356-XLV-VND-STYL                       08363008
083640                                                                  08364008
083650              WHEN XL001-SKU-SQLCODE = +100                       08365008
083660                  MOVE SPACES TO DK-TICKET-DESC                   08366008
083670*GB 3/25/12       MOVE ZEROS  TO RECITM-INNR-PACK-QTY             08367008
083680                                                                  08368008
083690              WHEN XL001-SKU-SQLCODE = -904                       08369008
083700              WHEN XL001-SKU-SQLCODE = -911                       08370008
083710              WHEN XL001-SKU-SQLCODE = -913                       08371008
083720                  PERFORM 9900-SOFT-ABORT                         08372008
083730                                                                  08373008
083740              WHEN XL001-INVALID-ACCESS                           08374008
083750                  MOVE '7355-CALL-CICS-API-ARCH'                  08375008
083760                                  TO DP013-PARAGRAPH              08376008
083770                  MOVE 'ACCESS INFO FOR XLKUT001 INCORRECT'       08377008
083780                                  TO DP013-MESSAGE-TEXT (1)       08378008
083790                  MOVE ASC-KEY-PO-NBR                             08379008
083800                                  TO PV-MSG-KEY-PO                08380008
083810                  MOVE ASC-KEY-REC-SEQ-NBR                        08381008
083820                                  TO PV-MSG-KEY-REC-SEQ-NBR-N     08382008
083830                  MOVE PV-MSG-KEYS                                08383008
083840                                  TO DP013-MESSAGE-TEXT (2)       08384008
083850                  MOVE SQLCA      TO DP013-SQLCA                  08385008
083860                  MOVE 'XLV_SKU'  TO DP013-DB2-TABLE-NAME (1)     08386008
083870                  SET DP013-DB2-ABEND                             08387008
083880                      DP013-XCTL-DISPLAY-RESTART                  08388008
083890                                  TO TRUE                         08389008
083900                  PERFORM DP013-0000-PROCESS-ABEND                08390008
083910                                                                  08391008
083920              WHEN OTHER                                          08392008
083930                  MOVE '7355-CALL-CICS-API-ARCH'                  08393008
083940                                  TO DP013-PARAGRAPH              08394008
083950                  MOVE 'UNSUCCESSFUL SELECT ON XLV_SKU'           08395008
083960                                  TO DP013-MESSAGE-TEXT (1)       08396008
083970                  MOVE ASC-KEY-PO-NBR                             08397008
083980                                  TO PV-MSG-KEY-PO                08398008
083990                  MOVE ASC-KEY-REC-SEQ-NBR                        08399008
084000                                  TO PV-MSG-KEY-REC-SEQ-NBR-N     08400008
084010                  MOVE PV-MSG-KEYS                                08401008
084020                                  TO DP013-MESSAGE-TEXT (2)       08402008
084030                  MOVE XL001-SKU-SQLCODE                          08403008
084040                                  TO SQLCODE                      08404008
084050                  MOVE SQLCA      TO DP013-SQLCA                  08405008
084060                  MOVE 'XLV_SKU'  TO DP013-DB2-TABLE-NAME (1)     08406008
084070                  SET DP013-DB2-ABEND                             08407008
084080                      DP013-XCTL-DISPLAY-RESTART                  08408008
084090                                  TO TRUE                         08409008
084100                  PERFORM DP013-0000-PROCESS-ABEND                08410008
084110             END-EVALUATE.                                        08411008
084120                                                                  08412008
084130 7356-XLV-VND-STYL.                                               08413008
084140                                                                  08414008
084150         EVALUATE TRUE                                            08415008
084160                                                                  08416008
084170              WHEN XL001-VND-STYL-SQLCODE = +0                    08417008
084180                  CONTINUE                                        08418008
084190                                                                  08419008
084200              WHEN XL001-VND-STYL-SQLCODE = +100                  08420008
084210                  MOVE SPACES TO DK-TICKET-DESC                   08421008
084220                                                                  08422008
084230              WHEN XL001-VND-STYL-SQLCODE = -904                  08423008
084240              WHEN XL001-VND-STYL-SQLCODE = -911                  08424008
084250              WHEN XL001-VND-STYL-SQLCODE = -913                  08425008
084260                  PERFORM 9900-SOFT-ABORT                         08426008
084270                                                                  08427008
084280              WHEN XL001-INVALID-ACCESS                           08428008
084290                  MOVE '7356-XLV-VND-STYL'                        08429008
084300                                  TO DP013-PARAGRAPH              08430008
084310                  MOVE 'ACCESS INFO FOR XLKUT001 INCORRECT'       08431008
084320                                  TO DP013-MESSAGE-TEXT (1)       08432008
084330                  MOVE ASC-KEY-PO-NBR                             08433008
084340                                  TO PV-MSG-KEY-PO                08434008
084350                  MOVE ASC-KEY-REC-SEQ-NBR                        08435008
084360                                  TO PV-MSG-KEY-REC-SEQ-NBR-N     08436008
084370                  MOVE PV-MSG-KEYS                                08437008
084380                                  TO DP013-MESSAGE-TEXT (2)       08438008
084390                  MOVE SQLCA      TO DP013-SQLCA                  08439008
084400                  MOVE 'XLV_VND_STYL'                             08440008
084410                                  TO DP013-DB2-TABLE-NAME (1)     08441008
084420                  SET DP013-DB2-ABEND                             08442008
084430                      DP013-XCTL-DISPLAY-RESTART                  08443008
084440                                  TO TRUE                         08444008
084450                  PERFORM DP013-0000-PROCESS-ABEND                08445008
084460                                                                  08446008
084470              WHEN OTHER                                          08447008
084480                  MOVE '7356-XLV-VND-STYL'                        08448008
084490                                  TO DP013-PARAGRAPH              08449008
084500                  MOVE 'UNSUCCESSFUL SELECT ON XLV_VND_STYL'      08450008
084510                                  TO DP013-MESSAGE-TEXT (1)       08451008
084520                  MOVE ASC-KEY-PO-NBR                             08452008
084530                                  TO PV-MSG-KEY-PO                08453008
084540                  MOVE ASC-KEY-REC-SEQ-NBR                        08454008
084550                                  TO PV-MSG-KEY-REC-SEQ-NBR-N     08455008
084560                  MOVE PV-MSG-KEYS                                08456008
084570                                  TO DP013-MESSAGE-TEXT (2)       08457008
084580                  MOVE XL001-VND-STYL-SQLCODE                     08458008
084590                                  TO SQLCODE                      08459008
084600                  MOVE SQLCA      TO DP013-SQLCA                  08460008
084610                  MOVE 'XLV_VND_STYL'                             08461008
084620                                  TO DP013-DB2-TABLE-NAME (1)     08462008
084630                  SET DP013-DB2-ABEND                             08463008
084640                      DP013-XCTL-DISPLAY-RESTART                  08464008
084650                                  TO TRUE                         08465008
084660                  PERFORM DP013-0000-PROCESS-ABEND                08466008
084670             END-EVALUATE.                                        08467008
084680                                                                  08468008
084690*----------------------------------------------------------------*08469008
084700*7360-SELECT-PRETICKET-TKT-TYPE                                  *08470008
084710**                                                                08471008
084720*    GET THE TICKET TYPE FROM THE PRETICKET REQUEST              *08472008
084730*----------------------------------------------------------------*08473008
084740                                                                  08474008
084750 7360-SELECT-PRETICKET-TKT-TYPE.                                  08475008
084760                                                                  08476008
084770     EXEC SQL                                                     08477008
084780          SELECT                                                  08478008
084790                TKT_DESC                                          08479008
084800          INTO                                                    08480008
084810                :PTKLNE-TKT-DESC                                  08481008
084820          FROM                                                    08482008
084830                TPTKREQ  A                                        08483008
084840              , TPTKLNE  B                                        08484008
084850          WHERE                                                   08485008
084860              A.PO_NBR     = :DK-PO-NBR                           08486008
084870          AND A.PO_REQ_NBR = B.PO_REQ_NBR                         08487008
084880          AND B.PO_LNE_NBR = :RECITM-ORD-LNE-NBR                  08488008
084890     END-EXEC.                                                    08489008
084900                                                                  08490008
084910     EVALUATE TRUE                                                08491008
084920         WHEN SQLCODE = -811                                      08492008
084930              PERFORM 7382-OPEN-TKTFMT-CURSOR                     08493008
084940              PERFORM 7383-FETCH-TKTFMT-CURSOR                    08494008
084950              MOVE PTKLNE-TKT-DESC  TO   DK-TICKET-DESC           08495008
084960              SET PS-PRETICKET TO TRUE                            08496008
084970              PERFORM 7384-CLOSE-TKTFMT-CURSOR                    08497008
084980         WHEN SQLCODE = ZERO                                      08498008
084990              MOVE PTKLNE-TKT-DESC  TO   DK-TICKET-DESC           08499008
085000              SET PS-PRETICKET TO TRUE                            08500008
085010         WHEN SQLCODE = +100                                      08501008
085020              SET PS-NOT-PRETICKET TO TRUE                        08502008
085030         WHEN SQLCODE = -904                                      08503008
085040         WHEN SQLCODE = -911                                      08504008
085050         WHEN SQLCODE = -913                                      08505008
085060              PERFORM 9900-SOFT-ABORT                             08506008
085070         WHEN SQLWARN0 NOT = SPACE                                08507008
085080         WHEN SQLCODE NOT = ZERO                                  08508008
085090              MOVE '7360-SELECT-PRETICKET-TKT-TYPE'               08509008
085100                               TO DP013-PARAGRAPH                 08510008
085110              MOVE 'SELECT TICKET TYPE FROM REQUEST LINE TABLE'   08511008
085120                               TO DP013-MESSAGE-TEXT (1)          08512008
085130              MOVE SQLCA       TO DP013-SQLCA                     08513008
085140              SET DP013-DB2-ABEND                                 08514008
085150                               TO TRUE                            08515008
085160              PERFORM DP013-0000-PROCESS-ABEND                    08516008
085170     END-EVALUATE.                                                08517008
085180                                                                  08518008
085190*                                                                 08519008
085200 7380-SELECT-TKT-FMT-ID.                                          08520008
085210      EXEC SQL                                                    08521008
085220          SELECT DISTINCT TKT_FMT_ID                              08522008
085230                INTO :TKTFMT-TKT-FMT-ID                           08523008
085240              FROM TTKTFMT                                        08524008
085250           WHERE                                                  08525008
085260              TKT_FMT_DESC = :DK-TICKET-DESC                      08526008
085270     END-EXEC                                                     08527008
085280                                                                  08528008
085290     EVALUATE TRUE                                                08529008
085300           WHEN SQLCODE = +0                                      08530008
085310             MOVE TKTFMT-TKT-FMT-ID  TO                           08531008
085320                                     ASC-KEY-TKT-FMT-ID           08532008
085330           WHEN SQLCODE = +100                                    08533008
085340                  MOVE SPACES    TO  ASC-KEY-TKT-FMT-ID           08534008
085350             WHEN SQLCODE = -904                                  08535008
085360             WHEN SQLCODE = -911                                  08536008
085370             WHEN SQLCODE = -913                                  08537008
085380                  PERFORM 9900-SOFT-ABORT                         08538008
085390             WHEN SQLWARN0 NOT = SPACES                           08539008
085400             WHEN SQLCODE  NOT = ZERO                             08540008
085410                  MOVE '7380-SELECT-TKT-FMT-ID'                   08541008
085420                                 TO DP013-PARAGRAPH               08542008
085430                  MOVE 'UNSUCCESSFUL SELECT OF TTKTFMT'           08543008
085440                                 TO DP013-MESSAGE-TEXT (1)        08544008
085450                  MOVE DK-TICKET-DESC                             08545008
085460                                 TO DP013-MESSAGE-TEXT (2)        08546008
085470                  MOVE SQLCA     TO DP013-SQLCA                   08547008
085480                  MOVE 'TTKTFMT' TO DP013-DB2-TABLE-NAME (1)      08548008
085490                  SET DP013-DB2-ABEND                             08549008
085500                      DP013-XCTL-DISPLAY-RESTART                  08550008
085510                                 TO TRUE                          08551008
085520                  PERFORM DP013-0000-PROCESS-ABEND                08552008
085530         END-EVALUATE.                                            08553008
085540*----------------------------------------------------------------*08554008
085550* OPEN THE CURSOR                                                *08555008
085560*----------------------------------------------------------------*08556008
085570 7382-OPEN-TKTFMT-CURSOR.                                         08557008
085580                                                                  08558008
085590         EXEC SQL                                                 08559008
085600             OPEN TKTFMT-CURSOR                                   08560008
085610         END-EXEC                                                 08561008
085620                                                                  08562008
085630         EVALUATE TRUE                                            08563008
085640             WHEN SQLCODE = ZERO                                  08564008
085650                 CONTINUE                                         08565008
085660             WHEN SQLCODE = -904                                  08566008
085670             WHEN SQLCODE = -913                                  08567008
085680             WHEN SQLCODE = -911                                  08568008
085690                 PERFORM 9900-SOFT-ABORT                          08569008
085700             WHEN SQLWARN0 NOT = SPACES                           08570008
085710             WHEN SQLCODE < ZERO                                  08571008
085720             WHEN SQLCODE > ZERO                                  08572008
085730                 MOVE '7382-OPEN-TKTYPE-CURSOR'                   08573008
085740                                   TO DP013-PARAGRAPH             08574008
085750                 MOVE 'OPEN TKTFMT CURSOR'                        08575008
085760                                   TO DP013-MESSAGE-TEXT (1)      08576008
085770                 MOVE SQLCA        TO DP013-SQLCA                 08577008
085780                 MOVE 'TPTKREQ '   TO DP013-DB2-TABLE-NAME (1)    08578008
085790                 MOVE 'TPTKLNE '   TO DP013-DB2-TABLE-NAME (2)    08579008
085800                 SET DP013-DB2-ABEND                              08580008
085810                     DP013-XCTL-DISPLAY-RESTART TO TRUE           08581008
085820                 PERFORM DP013-0000-PROCESS-ABEND                 08582008
085830     END-EVALUATE.                                                08583008
085840*                                                                 08584008
085850 7383-FETCH-TKTFMT-CURSOR.                                        08585008
085860                                                                  08586008
085870     EXEC SQL                                                     08587008
085880          FETCH TKTFMT-CURSOR                                     08588008
085890          INTO  :PTKLNE-TKT-DESC                                  08589008
085900              , :PTKREQ-ACTL-PRT-DTE                              08590008
085910              , :PTKREQ-PRT-TM                                    08591008
085920     END-EXEC                                                     08592008
085930                                                                  08593008
085940     EVALUATE TRUE                                                08594008
085950         WHEN SQLCODE = ZERO                                      08595008
085960         WHEN SQLCODE = +100                                      08596008
085970              CONTINUE                                            08597008
085980         WHEN SQLWARN0 NOT = SPACE                                08598008
085990         WHEN SQLCODE NOT = ZERO                                  08599008
086000              MOVE '7383-FETCH-TKTFMT-CURSOR'                     08600008
086010                               TO DP013-PARAGRAPH                 08601008
086020              MOVE 'FETCH TKTFMT-CURSOR '                         08602008
086030                               TO DP013-MESSAGE-TEXT (1)          08603008
086040              MOVE SQLCA       TO DP013-SQLCA                     08604008
086050              SET DP013-DB2-ABEND                                 08605008
086060                               TO TRUE                            08606008
086070              PERFORM DP013-0000-PROCESS-ABEND                    08607008
086080     END-EVALUATE.                                                08608008
086090                                                                  08609008
086100*----------------------------------------------------------------*08610008
086110* CLOSE THE TKT-FMT-CURSOR.                                      *08611008
086120*----------------------------------------------------------------*08612008
086130                                                                  08613008
086140 7384-CLOSE-TKTFMT-CURSOR.                                        08614008
086150                                                                  08615008
086160     EXEC SQL                                                     08616008
086170         CLOSE TKTFMT-CURSOR                                      08617008
086180     END-EXEC                                                     08618008
086190*                                                                 08619008
086200     EVALUATE TRUE                                                08620008
086210         WHEN SQLCODE = ZERO                                      08621008
086220             CONTINUE                                             08622008
086230         WHEN SQLWARN0 NOT = SPACES                               08623008
086240         WHEN SQLCODE < ZERO                                      08624008
086250         WHEN SQLCODE > ZERO                                      08625008
086260             MOVE '7384-CLOSE-TKTFMT-CURSOR'                      08626008
086270                               TO DP013-PARAGRAPH                 08627008
086280             MOVE 'CLOSE PO_ITEM_CURSOR'                          08628008
086290                               TO DP013-MESSAGE-TEXT (1)          08629008
086300             MOVE SQLCA        TO DP013-SQLCA                     08630008
086310             MOVE 'TPTKREQ '   TO DP013-DB2-TABLE-NAME (1)        08631008
086320             MOVE 'TPTKLNE '   TO DP013-DB2-TABLE-NAME (2)        08632008
086330             SET DP013-DB2-ABEND                                  08633008
086340                 DP013-XCTL-DISPLAY-RESTART TO TRUE               08634008
086350             PERFORM DP013-0000-PROCESS-ABEND                     08635008
086360     END-EVALUATE.                                                08636008
086370                                                                  08637008
086380 7385-COUNT-SMOOTHED-CTNS.                                        08638008
086390                                                                  08639008
086400     MOVE LQW-STR-DEST-NBR (LQW-IDX)  TO DK-STR-DEST-NBR          08640008
086410     MOVE LQW-REC-SEQ-NBR (LQW-IDX)   TO DK-REC-SEQ-NBR           08641008
086420     MOVE ZERO                        TO PV-SMOOTH-COUNT          08642008
086430     MOVE ZERO                        TO PV-PO-SMOOTH-CRTNS       08643008
086440                                                                  08644008
086450     EXEC SQL                                                     08645008
086460         SELECT  UPC.TRN_NBR                                      08646008
086470           INTO :PV-PO-SMOOTH-CRTNS                               08647008
086480           FROM  SUT_OTBND_UPC UPC                                08648008
086490              ,  SUT_OTBND_CART UNT                               08649008
086500          WHERE  UPC.TRN_NBR              = :DK-PO-NBR            08650008
086510            AND  UPC.RCVR_SEQ_NBR         = :DK-REC-SEQ-NBR       08651008
086520            AND  UPC.SHIPT_UNT_ID         =  UNT.SHIPT_UNT_ID     08652008
086530            AND  UNT.DEST_LOC_NBR         =  :DK-STR-DEST-NBR     08653008
086540            AND  UNT.CART_SRC_CDE         =  'SMO'                08654008
086550            AND  UNT.ACTV_IND             =  'Y'                  08655008
086560          FETCH FIRST 1 ROW ONLY                                  08656008
086570     END-EXEC.                                                    08657008
086580                                                                  08658008
086590     EVALUATE TRUE                                                08659008
086600         WHEN SQLCODE = ZERO                                      08660008
086610         WHEN SQLCODE = -811                                      08661008
086620              MOVE  1  TO  PV-SMOOTH-COUNT                        08662008
086630         WHEN SQLCODE = +100                                      08663008
086640              MOVE  0  TO  PV-SMOOTH-COUNT                        08664008
086650         WHEN SQLCODE = -904                                      08665008
086660         WHEN SQLCODE = -913                                      08666008
086670         WHEN SQLCODE = -911                                      08667008
086680             PERFORM 9900-SOFT-ABORT                              08668008
086690         WHEN SQLWARN0 NOT = SPACES                               08669008
086700         WHEN SQLCODE < ZERO                                      08670008
086710         WHEN SQLCODE > ZERO                                      08671008
086720             MOVE '7385-COUNT-SMOOTHED-CTNS'                      08672008
086730                               TO DP013-PARAGRAPH                 08673008
086740             MOVE 'COUNT SMOOTHED CARTONS FOR PO/RCVR/STR'        08674008
086750                               TO DP013-MESSAGE-TEXT (1)          08675008
086760             MOVE SQLCA        TO DP013-SQLCA                     08676008
086770             MOVE 'SUT00028'   TO DP013-DB2-TABLE-NAME (1)        08677008
086780             MOVE 'SUT00024'   TO DP013-DB2-TABLE-NAME (2)        08678008
086790             SET DP013-DB2-ABEND                                  08679008
086800                 DP013-XCTL-DISPLAY-RESTART TO TRUE               08680008
086810             PERFORM DP013-0000-PROCESS-ABEND                     08681008
086820     END-EVALUATE.                                                08682008
086830                                                                  08683008
086840 7400-CHECK-FOR-TROUBLE.                                          08684008
086850                                                                  08685008
086860     INITIALIZE TM500-FIELDS.                                     08686008
086870                                                                  08687008
086880     SET  TM500-CREATE-AUTO        TO TRUE.                       08688008
086890     SET  TM500-LINE-LEVEL         TO TRUE.                       08689008
086900     SET  TM500-NO-DETAILS         TO TRUE.                       08690008
086910     MOVE DK-PO-NBR                TO TM500-PO-NBR.               08691008
086920     MOVE RECITM-ORD-LNE-NBR       TO TM500-PO-LNE-NBR.           08692008
086930     MOVE ASC-KEY-OPER-UNT-ID      TO TM500-OPER-UNT-ID.          08693008
086940     MOVE ASC-KEY-FCLTY-ID         TO TM500-FCLTY-ID.             08694008
086950     MOVE RECITM-REC-SEQ-NBR       TO TM500-REC-SEQ-NBR           08695008
086960                                      ASC-KEY-REC-SEQ-NBR         08696008
086970     MOVE RECITM-PKSL-ITM-QTY      TO TM500-UNITS-TO-ALLOC.       08697008
086980     MOVE PURITM-PIC-ITM-IND       TO TM500-AD-SW.                08698008
086990     MOVE PC-CURRENT-PROGRAM-NAME  TO TM500-NOTIF-UID.            08699008
087000                                                                  08700008
087010     EXEC CICS                                                    08701008
087020         LINK PROGRAM  (PC-TROUBLE-RTN)                           08702008
087030              COMMAREA (TM500-FIELDS)                             08703008
087040              LENGTH   (PC-TROUBLE-RTN-LENGTH)                    08704008
087050     END-EXEC.                                                    08705008
087060                                                                  08706008
087070     EVALUATE TRUE                                                08707008
087080         WHEN TM500-CALL-SUCCESSFUL                               08708008
087090         WHEN TM500-DUPLICATE-TROUBLE                             08709008
087100         WHEN TM500-TTRBNTF-UPDATE-NOT-FND                        08710008
087110         WHEN TM500-DIDNT-ALLOC-DUE-TO-TRBL                       08711008
087120             IF TM500-IN-TROUBLE                                  08712008
087130                 ADD 1                TO PV-TROUBLE-COUNT         08713008
087140             END-IF                                               08714008
087150                                                                  08715008
087160         WHEN TM500-SKU-NOT-FOUND-FOR-LINE                        08716008
087170             PERFORM 9900-SOFT-ABORT                              08717008
087180                                                                  08718008
087190         WHEN OTHER                                               08719008
087200              MOVE TM500-RETURN-MSG TO PV-RETURN-MSG              08720008
087210              IF PV-RETURN-MSG = '821 5035 XLT_LOC '              08721008
087220* * PROGRAM = RCKCS821, PARAGRAPH = 5035, TABLE ACTUALLY IS       08722008
087230* *                                        XLT_DC_LOC_ASGMT       08723008
087240                AND TM500-SQLCODE = '      100 '                  08724008
087250* * THE REASON FOR THE GOOFY CHECK FOR SQLCODE +100 IS THAT       08725008
087260* * THE DEFINITION FOR TM500-SQLCODE IS EDITED NUMERIC.           08726008
087270* * ESSENTIALLY PERFROM A 9900-SOFT-ABORT. WE DON'T WANT TO       08727008
087280* * PERFORM A HARD ABEND IF A STORE HAS NOT REACHED IT'S          08728008
087290* * EFFECTIVE BEGIN DATE.                                         08729008
087300                  PERFORM 9901-BACKOUT                            08730008
087310                  MOVE PC-TSYMSG-03599                            08731008
087320                                    TO DP020-MSG-NUMBER           08732008
087330                  PERFORM 2050-DELETE-LIST-QUEUE                  08733008
087340                  PERFORM 4000-BUILD-INITIAL-PANEL                08734008
087350                  SET PS-ERROR                                    08735008
087360                      DP020-MSG-FATAL TO TRUE                     08736008
087370                  MOVE 'PROGRAM EXIT CALL'                        08737008
087380                                     TO DP013-MESSAGE-TEXT (1)    08738008
087390                  PERFORM 0001-CALL-CICS-ARCH-API                 08739008
087400              ELSE                                                08740008
087410                  MOVE '7400-CHECK-FOR-TROUBLE'                   08741008
087420                                    TO DP013-PARAGRAPH            08742008
087430                  MOVE 'UNSUCCESSFUL CALL TO TROUBLE RTN'         08743008
087440                                    TO DP013-MESSAGE-TEXT (1)     08744008
087450                  MOVE TM500-RETURN-MSG                           08745008
087460                                    TO DP013-MESSAGE-TEXT (2)     08746008
087470                  MOVE TM500-SQLCA  TO DP013-SQLCA                08747008
087480                  SET DP013-DB2-ABEND                             08748008
087490                      DP013-XCTL-DISPLAY-RESTART                  08749008
087500                                    TO TRUE                       08750008
087510                  PERFORM DP013-0000-PROCESS-ABEND                08751008
087520              END-IF                                              08752008
087530     END-EVALUATE.                                                08753008
087540                                                                  08754008
087550 7410-PREPACK-TROUBLE.                                            08755008
087560                                                                  08756008
087570* CALL THE ROUTINE ONLY FOR THE DRIVER LINES.  RCKCS808 WILL      08757008
087580* USE THE DRIVER TO RETRIEVE THE REST OF THE LINES IN THE PACK    08758008
087590*                                                                 08759008
087600* THIS LOGIC IS ALSO USED BY INACTIVATION WHERE IT IS CALLED      08760008
087610* FOR EACH PACK BEING INACTIVATED.  THEREFORE THE DRIVER LINE     08761008
087620* ISN'T NEEDED                                                    08762008
087630*                                                                 08763008
087640     IF  ( DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID) AND             08764008
087650         PWT-DRIVER-LINE-YES (PWT-M-IDX) AND                      08765008
087660         PWT-PKSL-M-LNE-NBR (PWT-M-IDX) < 1000 )                  08766008
087670                                                                  08767008
087680        OR                                                        08768008
087690                                                                  08769008
087700       ( DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)                   08770008
087710            AND                                                   08771008
087720         (PWT-LINE-NBR (PWT-PACK-IDX) < 1000 ) )                  08772008
087730*           AND                                                   08773008
087740*        (PWT-PACK-ID (PWT-PACK-IDX) NOT = 99 ) )                 08774008
087750                                                                  08775008
087760        OR                                                        08776008
087770                                                                  08777008
087780       ( DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)                   08778008
087790            AND                                                   08779008
087800       ( PWT-PKSL-M-LNE-NBR (PWT-M-IDX) < 1000 )                  08780008
087810            AND                                                   08781008
087820        (PWT-DRIVER-LINE-YES (PWT-M-IDX)) )                       08782008
087830                                                                  08783008
087840                                                                  08784008
087850         MOVE DK-PO-NBR               TO TM500-PO-NBR             08785008
087860                                                                  08786008
087870         IF ( (DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID))  AND       08787008
087880               ( ASC-TRECEIV-PKGNG-CDE = 'M' OR 'I' ) )           08788008
087890             MOVE PWT-PACK-ID (PWT-PACK-IDX)                      08789008
087900                                      TO TM500-PREPK-ID           08790008
087910             MOVE PWT-LINE-NBR (PWT-PACK-IDX)                     08791008
087920                                      TO TM500-PO-LNE-NBR         08792008
087930         ELSE                                                     08793008
087940             MOVE PWT-PKSL-M-LNE-NBR (PWT-M-IDX)                  08794008
087950                                      TO TM500-PO-LNE-NBR         08795008
087960             MOVE PWT-M-PREPK-ID (PWT-M-IDX)                      08796008
087970                                      TO TM500-PREPK-ID           08797008
087980         END-IF                                                   08798008
087990                                                                  08799008
088000         MOVE ASC-KEY-OPER-UNT-ID     TO TM500-OPER-UNT-ID        08800008
088010         MOVE ASC-KEY-FCLTY-ID        TO TM500-FCLTY-ID           08801008
088020         MOVE RECITM-REC-SEQ-NBR      TO TM500-REC-SEQ-NBR        08802008
088030                                                                  08803008
088040* ALLOCATION QTY WILL BE RECALCULATED IN RCKCS808                 08804008
088050         MOVE PWT-M-PREPK-BEST-CASES (PWT-M-IDX)                  08805008
088060                                      TO TM500-UNITS-TO-ALLOC     08806008
088070                                                                  08807008
088080         MOVE ASC-TRECEIV-PKGNG-CDE   TO TM500-PKGNG-CDE          08808008
088090                                                                  08809008
088100         MOVE PC-CURRENT-PROGRAM-NAME TO TM500-NOTIF-UID          08810008
088110                                                                  08811008
088120         EXEC CICS                                                08812008
088130             LINK PROGRAM  (PC-TROUBLE-RTN)                       08813008
088140                  COMMAREA (TM500-FIELDS)                         08814008
088150         END-EXEC                                                 08815008
088160                                                                  08816008
088170         EVALUATE TRUE                                            08817008
088180         WHEN TM500-INVALID-PRORATION                             08818008
088190             MOVE PC-TSYMSG-02452     TO DP020-MSG-NUMBER         08819008
088200             SET PS-ERROR-MSG                                     08820008
088210                 DP020-MSG-WARNING    TO TRUE                     08821008
088220                                                                  08822008
088230         WHEN TM500-SKU-NOT-FOUND-FOR-LINE                        08823008
088240         WHEN TM500-PREPACK-DB2-TIMEOUT                           08824008
088250             PERFORM 9900-SOFT-ABORT                              08825008
088260             SET PS-ERROR             TO TRUE                     08826008
088270                                                                  08827008
088280         WHEN TM500-PREPACK-OTR-ERROR                             08828008
088290             MOVE PC-TSYMSG-01096     TO DP020-MSG-NUMBER         08829008
088300             SET PS-ERROR-MSG                                     08830008
088310                 DP020-MSG-FATAL      TO TRUE                     08831008
088320         WHEN TM500-PREPACK-ERROR-NBR > ZERO                      08832008
088330              MOVE TM500-RETURN-MSG TO PV-RETURN-MSG              08833008
088340              IF PV-RETURN-MSG = '821 5035 XLT_LOC '              08834008
088350* * PROGRAM = RCKCS821, PARAGRAPH = 5035, TABLE ACTUALLY IS       08835008
088360* *                                        XLT_DC_LOC_ASGMT       08836008
088370                AND TM500-SQLCODE = '      100 '                  08837008
088380* * THE REASON FOR THE GOOFY CHECK FOR SQLCODE +100 IS THAT       08838008
088390* * THE DEFINITION FOR TM500-SQLCODE IS EDITED NUMERIC.           08839008
088400* * ESSENTIALLY PERFROM A 9900-SOFT-ABORT. WE DON'T WANT TO       08840008
088410* * PERFORM A HARD ABEND IF A STORE HAS NOT REACHED IT'S          08841008
088420* * EFFECTIVE BEGIN DATE.                                         08842008
088430                  PERFORM 9901-BACKOUT                            08843008
088440                  MOVE PC-TSYMSG-03599                            08844008
088450                                      TO DP020-MSG-NUMBER         08845008
088460                  SET PS-ERROR                                    08846008
088470                      PS-ERROR-MSG                                08847008
088480                      DP020-MSG-FATAL TO TRUE                     08848008
088490              ELSE                                                08849008
088500                  PERFORM 9901-BACKOUT                            08850008
088510                  STRING TM500-PREPACK-PGM-NBR '-'                08851008
088520                    TM500-PREPACK-ERROR-NBR                       08852008
088530                    DELIMITED BY SIZE                             08853008
088540                                    INTO DP020-MSG-TEXT           08854008
088550                  MOVE PC-TSYMSG-02229 TO DP020-MSG-NUMBER        08855008
088560                  SET PS-ERROR                                    08856008
088570                      PS-ERROR-MSG                                08857008
088580                      DP020-MSG-FATAL  TO TRUE                    08858008
088590              END-IF                                              08859008
088600                                                                  08860008
088610         WHEN TM500-CALL-SUCCESSFUL                               08861008
088620         WHEN TM500-DUPLICATE-TROUBLE                             08862008
088630         WHEN TM500-TTRBNTF-UPDATE-NOT-FND                        08863008
088640         WHEN TM500-RECEIVER-NOT-PREPACK                          08864008
088650         WHEN TM500-DRIVER-LINE-MISSING                           08865008
088660         WHEN TM500-DIDNT-ALLOC-DUE-TO-TRBL                       08866008
088670                                                                  08867008
088680* CHECK TO DETERMINE IF THE INFORMATION NEEDS TO BE SENT TO       08868008
088690* WMS;  THIS IS ONLY DONE WHEN AN ADD TO RECEIVER IS REQUESTED    08869008
088700* JAK 09/2007 - REMOVE CALL TO 7450-                              08870008
088710*            PERFORM 7450-CHECK-WMS                               08871008
088720             CONTINUE                                             08872008
088730                                                                  08873008
088740         WHEN OTHER                                               08874008
088750             MOVE '7410-PREPACK-TROUBLE'                          08875008
088760                                      TO DP013-PARAGRAPH          08876008
088770             MOVE 'UNSUCCESSFUL CALL TO TROUBLE RTN'              08877008
088780                                      TO DP013-MESSAGE-TEXT (1)   08878008
088790             MOVE TM500-RETURN-MSG    TO DP013-MESSAGE-TEXT (2)   08879008
088800             MOVE TM500-SQLCA         TO DP013-SQLCA              08880008
088810             SET DP013-DB2-ABEND                                  08881008
088820                 DP013-XCTL-DISPLAY-RESTART                       08882008
088830                                      TO TRUE                     08883008
088840             PERFORM DP013-0000-PROCESS-ABEND                     08884008
088850         END-EVALUATE                                             08885008
088860     END-IF.                                                      08886008
088870                                                                  08887008
088880* JAK 06/2007 - ADD PARAGRAPH 7450-                               08888008
088890* JAK 09/2007 - REMOVE PARAGRAPH 7450-                            08889008
088900*7450-CHECK-WMS.                                                  08890008
088910* IF F23 (ADDTORCV - FUNC-01), OR F14 (TRSCPCM - FUNC-03)         08891008
088920*     CHECK TO SEE IF THIS DC IS DOWNLOADING TO WMS               08892008
088930*     IF IT IS, THEN CALL THE DOWNLOAD MODULE                     08893008
088940                                                                  08894008
088950*    IF DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)                    08895008
088960*        PERFORM 7620-SELECT-RECDIS                               08896008
088970*        IF PS-RECDIS-FOUND                                       08897008
088980*            PERFORM 2400-WMS-PROCESS                             08898008
088990*            IF PS-ASNS-TO-WMS-YES                                08899008
089000*                PERFORM 2700-SELECT-TVHTRIP                      08900008
089010*                IF PS-VALID-TRIP                                 08901008
089020*                    SET WS001-INSERT TO TRUE                     08902008
089030* JAK 09/2007 ADD SWITCH TO INDICATE THAT LINE NBR IS LOADED      08903008
089040*                    SET PS-LOAD-LNE-NBR-YES   TO TRUE            08904008
089050*                    PERFORM 2800-CALL-WMS-MODULE                 08905008
089060*                END-IF                                           08906008
089070*            END-IF                                               08907008
089080*        END-IF                                                   08908008
089090*    END-IF.                                                      08909008
089100                                                                  08910008
089110 7500-GET-PACK-BY-STR-IND.                                        08911008
089120                                                                  08912008
089130* RECEIV-PACK-BY-ST-IND IS A DEFAULT VALUE THAT ORIGINATES IN THE 08913008
089140* POAGMNT FOR THE ORDER.  THE DISTINCTION BETWEEN A BULK RECEIPT  08914008
089150* AND A PACK-BY-STORE RECEIPT IS REALLY BASED ON THE VALUE OF ANY 08915008
089160* A SELECTED PACKSLIP STORE.  IF THE STORE IS ZERO, THEN IT'S A   08916008
089170* BULK RECEIPT OTHERWISE IT'S PACK-BY-STORE.                      08917008
089180         EXEC SQL                                                 08918008
089190             SELECT PACK_BY_ST_IND                                08919008
089200                   ,PRE_TKT_IND                                   08920008
089210               INTO :RECEIV-PACK-BY-ST-IND                        08921008
089220                   ,:RECEIV-PRE-TKT-IND                           08922008
089230               FROM TRECEIV                                       08923008
089240              WHERE ORD_NBR        = :DK-PO-NBR                   08924008
089250                AND REC_SEQ_NBR    = :DK-REC-SEQ-NBR              08925008
089260                AND VER_STATUS_CDE = 'A'                          08926008
089270                AND OPER_UNT_ID    = :DK-OPER-UNT-ID              08927008
089280                AND FCLTY_ID       = :DK-FCLTY-ID                 08928008
089290         END-EXEC                                                 08929008
089300                                                                  08930008
089310         EVALUATE TRUE                                            08931008
089320             WHEN SQLCODE = ZERO                                  08932008
089330                 MOVE RECEIV-PACK-BY-ST-IND                       08933008
089340                                 TO ASC-PACK-BY-ST-IND            08934008
089350                 MOVE RECEIV-PRE-TKT-IND                          08935008
089360                                 TO ASC-KEY-PRE-TKT-IND           08936008
089370             WHEN SQLCODE = +100                                  08937008
089380                  MOVE SPACES    TO ASC-PACK-BY-ST-IND            08938008
089390                  MOVE SPACES    TO ASC-KEY-PRE-TKT-IND           08939008
089400                  SET PS-AGMT-NOT-PK-BY-STR TO TRUE               08940008
089410             WHEN SQLCODE = -904                                  08941008
089420             WHEN SQLCODE = -911                                  08942008
089430             WHEN SQLCODE = -913                                  08943008
089440                  PERFORM 9900-SOFT-ABORT                         08944008
089450                                                                  08945008
089460             WHEN SQLWARN0 NOT = SPACES                           08946008
089470             WHEN SQLCODE  NOT = ZERO                             08947008
089480                  MOVE '7500-GET-PACK-BY-STR-IND'                 08948008
089490                                 TO DP013-PARAGRAPH               08949008
089500                  MOVE 'UNSUCCESSFUL SELECT OF TRECEIV'           08950008
089510                                 TO DP013-MESSAGE-TEXT (1)        08951008
089520                  MOVE ASC-KEY-PO-NBR                             08952008
089530                                 TO PV-MSG-KEY-PO                 08953008
089540                  MOVE ASC-KEY-REC-SEQ-NBR                        08954008
089550                                 TO PV-MSG-KEY-REC-SEQ-NBR-N      08955008
089560                  MOVE PV-MSG-KEYS                                08956008
089570                                 TO DP013-MESSAGE-TEXT (2)        08957008
089580                  MOVE SQLCA     TO DP013-SQLCA                   08958008
089590                  MOVE 'TRECEIV' TO DP013-DB2-TABLE-NAME (1)      08959008
089600                  SET DP013-DB2-ABEND                             08960008
089610                      DP013-XCTL-DISPLAY-RESTART                  08961008
089620                                 TO TRUE                          08962008
089630                  PERFORM DP013-0000-PROCESS-ABEND                08963008
089640         END-EVALUATE.                                            08964008
089650/                                                                 08965008
089660 7510-CHECK-FOR-DC.                                               08966008
089670     INITIALIZE XL071-COMMAREA-REC.                               08967008
089680     MOVE DK-OPER-UNT-ID TO XL071-LOCATION-NUMBER.                08968008
089690                                                                  08969008
089700     CALL XL071-LOCATION-MODULE  USING  DFHEIBLK                  08970008
089710                                        XL071-COMMAREA            08971008
089720                                        XL071-COMMAREA-REC.       08972008
089730                                                                  08973008
089740     EVALUATE TRUE                                                08974008
089750         WHEN XL071-NO-ERRORS                                     08975008
089760         WHEN XL071-DC-ASGMT-NOT-FND                              08976008
089770             MOVE XL071-LOC-TYP-CDE TO ASC-STORE-TYPE-CODE        08977008
089780         WHEN XL071-LOC-NOT-FOUND                                 08978008
089790             MOVE SPACES            TO ASC-STORE-TYPE-CODE        08979008
089800         WHEN XL071-SQLCODE-N = -904                              08980008
089810         WHEN XL071-SQLCODE-N = -911                              08981008
089820         WHEN XL071-SQLCODE-N = -913                              08982008
089830                  PERFORM 9900-SOFT-ABORT                         08983008
089840         WHEN OTHER                                               08984008
089850              MOVE '7510-CHECK-FOR-DC'                            08985008
089860                                 TO DP013-PARAGRAPH               08986008
089870              MOVE 'SELECT OF XLT_LOC, XLT_DC_LOC_ASGMT'          08987008
089880                                 TO DP013-MESSAGE-TEXT (1)        08988008
089890              MOVE ASC-KEY-PO-NBR                                 08989008
089900                                 TO PV-MSG-KEY-PO                 08990008
089910              MOVE ASC-KEY-REC-SEQ-NBR                            08991008
089920                                 TO PV-MSG-KEY-REC-SEQ-NBR-N      08992008
089930              MOVE PV-MSG-KEYS                                    08993008
089940                                 TO DP013-MESSAGE-TEXT (2)        08994008
089950              MOVE SQLCA     TO DP013-SQLCA                       08995008
089960              MOVE 'XLT_LOC' TO DP013-DB2-TABLE-NAME (1)          08996008
089970              MOVE 'XLT_DC_LOC_ASGMT'                             08997008
089980                             TO DP013-DB2-TABLE-NAME (2)          08998008
089990              SET DP013-DB2-ABEND                                 08999008
090000                  DP013-XCTL-DISPLAY-RESTART                      09000008
090010                                 TO TRUE                          09001008
090020              PERFORM DP013-0000-PROCESS-ABEND                    09002008
090030     END-EVALUATE.                                                09003008
090040/                                                                 09004008
090050 7520-GET-PKSLIP-PRO-NBR.                                         09005008
090060                                                                  09006008
090070     EXEC SQL                                                     09007008
090080         SELECT A.PRO_NBR                                         09008008
090090         INTO  :PKSLIP-PRO-NBR                                    09009008
090100         FROM   TPKSLIP A                                         09010008
090110         WHERE A.PO_NBR       = :DK-PO-NBR                        09011008
090120         AND  A.SEQ_NBR       = :DK-SEQ-NBR                       09012008
090130         AND  A.VER_STAT_CDE  = 'A'                               09013008
090140     END-EXEC.                                                    09014008
090150                                                                  09015008
090160     EVALUATE TRUE                                                09016008
090170         WHEN SQLCODE = ZERO                                      09017008
090180         WHEN SQLCODE = +100                                      09018008
090190             CONTINUE                                             09019008
090200         WHEN SQLCODE = -904                                      09020008
090210         WHEN SQLCODE = -911                                      09021008
090220         WHEN SQLCODE = -913                                      09022008
090230             PERFORM 9900-SOFT-ABORT                              09023008
090240                                                                  09024008
090250         WHEN SQLWARN0 NOT = SPACES                               09025008
090260         WHEN SQLCODE  NOT = ZERO                                 09026008
090270             MOVE '7520-GET-PKSLIP-PRO-NBR'                       09027008
090280                                 TO DP013-PARAGRAPH               09028008
090290             MOVE 'UNSUCCESSFUL SELECT OF TPKSLIP'                09029008
090300                                 TO DP013-MESSAGE-TEXT (1)        09030008
090310*            MOVE ASC-KEY-PO-NBR                                  09031020
090320*                                TO PV-MSG-KEY-PO                 09032020
090330*            MOVE DK-REC-SEQ-NBR                                  09033020
090340*                                TO PV-MSG-KEY-REC-SEQ-NBR-N      09034020
090350*            MOVE RECITM-ORD-LNE-NBR                              09035020
090360*                                TO PV-MSG-KEY-PO-LNE-NBR-N       09036020
090370*            MOVE PV-MSG-KEYS                                     09037020
090380*                                TO DP013-MESSAGE-TEXT (2)        09038020
090381             MOVE SPACES TO PV-MSG-STRING-1                       09038120
090382             MOVE SPACES TO PV-MSG-STRING-2                       09038220
090383             MOVE SPACES TO PV-MSG-STRING-3                       09038320
090384             MOVE DK-PO-NBR         TO PV-DISP-PO                 09038420
090389             MOVE DK-REC-SEQ-NBR    TO PV-DISP-REC-SEQ-B          09038920
090391             MOVE DK-SEQ-NBR        TO PV-DISP-PKSL-NBR-B         09039120
090392                                                                  09039220
090393             STRING  PV-DISP-PO         '-'                       09039320
090394                     PV-DISP-REC-SEQ-B  '-'                       09039420
090395                     '  PACKSLIP SEQ:'                            09039520
090396                     PV-DISP-PKSL-NBR-B  DELIMITED BY SIZE        09039620
090397                                   INTO  PV-MSG-STRING-1          09039720
090398             MOVE PV-MSG-STRING-1  TO DP013-MESSAGE-TEXT (2)      09039820
090399                                                                  09039920
090400             MOVE SQLCA     TO DP013-SQLCA                        09040020
090401             MOVE 'TPKSLIP' TO DP013-DB2-TABLE-NAME (1)           09040108
090410             SET DP013-DB2-ABEND                                  09041008
090420                 DP013-XCTL-DISPLAY-RESTART                       09042008
090430                                 TO TRUE                          09043008
090440             PERFORM DP013-0000-PROCESS-ABEND                     09044008
090450         END-EVALUATE.                                            09045008
090460                                                                  09046008
090470                                                                  09047008
090480                                                                  09048008
090490                                                                  09049008
090500 7600-DECREMENT-RECITM.                                           09050008
090510                                                                  09051008
090520     SET PWT-PACK-IDX                 TO 1                        09052008
090530     MOVE ZERO                        TO PV-PREV-PO-PREPK-ID      09053008
090540     IF ASC-TRECEIV-PKGNG-CDE = 'M' OR 'I'                        09054008
090550         PERFORM 7730-OPEN-PRPK-PKSLIP-ITEM-CSR                   09055008
090560         PERFORM 7731-FETCH-PREPACK-ITEM-CSR                      09056008
090570         INITIALIZE PWT-PACK-ID-TABLE                             09057008
090580     ELSE                                                         09058008
090590         PERFORM 7700-OPEN-PKSLIP-ITEM-CURSOR                     09059008
090600         PERFORM 7710-FETCH-PKSLIP-ITEMS                          09060008
090610     END-IF                                                       09061008
090620                                                                  09062008
090630     PERFORM 7610-SUM-PKSLIP-ITEMS                                09063008
090640         UNTIL PS-END-OF-PKSLIP-ITEM-CSR      OR                  09064008
090650               PS-END-PRPK-PKSLIP-ITEM-CSR                        09065008
090660                                                                  09066008
090670     IF ASC-TRECEIV-PKGNG-CDE = 'M' OR 'I'                        09067008
090680         PERFORM 7732-CLOSE-PRPK-PKSLIP-ITM-CSR                   09068008
090690         PERFORM 7615-INACTIVATE-PACKS                            09069008
090700             VARYING PWT-PACK-IDX FROM 1 BY 1                     09070008
090710             UNTIL  PWT-PACK-ID(PWT-PACK-IDX) = ZERO              09071008
090720                OR PS-ERROR                                       09072008
090730                OR PWT-PACK-IDX > 9999                            09073008
090740     ELSE                                                         09074008
090750         PERFORM 7720-CLOSE-PKSLIP-ITEM-CURSOR                    09075008
090760     END-IF.                                                      09076008
090770                                                                  09077008
090780                                                                  09078008
090790                                                                  09079008
090800     PERFORM 7900-OPEN-UNPKSL-LINE-CURSOR.                        09080008
090810     PERFORM 7910-PROCESS-UNPKSL-LINES                            09081008
090820         UNTIL PS-END-OF-UNPKSL-LINE-CSR.                         09082008
090830     PERFORM 7930-CLOSE-UNPKSL-LINE-CURSOR.                       09083008
090840                                                                  09084008
090850                                                                  09085008
090860 7610-SUM-PKSLIP-ITEMS.                                           09086008
090870                                                                  09087008
090880*  FOR EVERY PKITEM FOUND FOR THE GIVEN PKSLIP, THE RECITM QTYS   09088008
090890*  MUST BE DECREASED BY THE AMOUNT FOUND ON THE PACKSLIP BEING    09089008
090900*  INACTIVATED.  IF A RECITM QTY IS REDUCED TO ZERO, THE RECITM   09090008
090910*  WILL BE INACTIVATED.  WORK ORDERS AND TROUBLE FOR THESE LINES  09091008
090920*  WILL ALSO BE INACTIVATED.                                      09092008
090930*  RECDIS ROWS ARE DELETED EITHER FOR ALL STORES                  09093008
090940*  OR FOR JUST ONE STORE DEPENDING ON THE TYPE OF RECEIPT.        09094008
090950                                                                  09095008
090960                                                                  09096008
090970         MOVE PV-PKSL-LNE-NBR    TO RECITM-ORD-LNE-NBR            09097008
090980                                    PURITM-APP-PO-LNE-NBR         09098008
090990                                                                  09099008
091000         PERFORM 7800-SELECT-RECITM                               09100008
091010                                                                  09101008
091020         IF PS-RECITM-FOUND                                       09102008
091030             IF  RECITM-STATUS-CDE EQUAL 'VE'                     09103008
091040                 CONTINUE                                         09104008
091050             ELSE                                                 09105008
091060                 IF ASC-TRECEIV-PKGNG-CDE = 'M' OR 'I'            09106008
091070                     PERFORM 7611-PREPACK                         09107008
091080                 ELSE                                             09108008
091090                     PERFORM 7612-NON-PREPACK                     09109008
091100                 END-IF                                           09110008
091110             END-IF                                               09111008
091120         END-IF                                                   09112008
091130                                                                  09113008
091140         PERFORM 7620-SELECT-RECDIS                               09114008
091150                                                                  09115008
091160*  IF THIS IS A PACK-BY-STORE RECEIPT, DELETE JUST THE RECDIS     09116008
091170*  FOR THE PACKSLIP STORE.  IF IT'S A BULK RECEIPT, THEN DELETE   09117008
091180*  ALL THE RECDIS ROWS FOR THE LINE REGARDLESS OF STORE.          09118008
091190         IF PS-RECDIS-FOUND                                       09119008
091200             IF PS-PACKED-BY-STORE                                09120008
091210                 MOVE PKSLIP-STR-DEST-NBR TO RECDIS-STR-NBR       09121008
091220                 PERFORM 7630-DELETE-RECDIS                       09122008
091230                 SET PS-7630-DELETE TO TRUE                       09123008
091240                 PERFORM 7640-DELETE-ODD-UNIT                     09124008
091250             ELSE                                                 09125008
091260                 SET PS-7635-DELETE TO TRUE                       09126008
091270                 PERFORM 7635-DELETE-RECDIS                       09127008
091280                 PERFORM 7640-DELETE-ODD-UNIT                     09128008
091290             END-IF                                               09129008
091300         END-IF                                                   09130008
091310                                                                  09131008
091320         IF ASC-TRECEIV-PKGNG-CDE = 'M' OR 'I'                    09132008
091330             PERFORM 7731-FETCH-PREPACK-ITEM-CSR                  09133008
091340         ELSE                                                     09134008
091350             PERFORM 7710-FETCH-PKSLIP-ITEMS                      09135008
091360         END-IF.                                                  09136008
091370                                                                  09137008
091380                                                                  09138008
091390 7611-PREPACK.                                                    09139008
091400     SUBTRACT PV-LINE-QTY FROM RECITM-PKSL-ITM-QTY                09140008
091410             GIVING PV-PKSL-ITM-QTY                               09141008
091420                                                                  09142008
091430     IF PV-PKSL-ITM-QTY = ZERO                                    09143008
091440         PERFORM 8000-AUDIT-RECITM                                09144008
091450         MOVE PV-PKSL-ITM-QTY         TO RECITM-PKSL-ITM-QTY      09145008
091460         PERFORM 7810-SET-CURR-RECITM-TO-INACT                    09146008
091470                                                                  09147008
091480         PERFORM 7950-INACTIVATE-TWRKORD                          09148008
091490         PERFORM 7960-INACTIVATE-TWKORIN                          09149008
091500*        PERFORM 7970-INACTIVATE-TWOSTAL                          09150023
091510         PERFORM 7990-DELETE-LINE-TROUBLE                         09151008
091520     ELSE                                                         09152008
091530         PERFORM 8000-AUDIT-RECITM                                09153008
091540         MOVE PV-PKSL-ITM-QTY         TO RECITM-PKSL-ITM-QTY      09154008
091550         PERFORM 7815-UPDATE-RECITM-QTY                           09155008
091560     END-IF.                                                      09156008
091570                                                                  09157008
091580* KEEP TRACK OF PACK-IDS HERE                                     09158008
091590     IF PURITM-PO-PREPK-ID NOT = PV-PREV-PO-PREPK-ID              09159008
091600         MOVE PURITM-PO-PREPK-ID      TO PWT-PACK-ID              09160008
091610                                         (PWT-PACK-IDX)           09161008
091620                                         PV-PREV-PO-PREPK-ID      09162008
091630         MOVE PV-PKSL-LNE-NBR         TO PWT-LINE-NBR             09163008
091640                                         (PWT-PACK-IDX)           09164008
091650         SET PWT-PACK-IDX UP BY 1                                 09165008
091660     END-IF.                                                      09166008
091670                                                                  09167008
091680                                                                  09168008
091690 7612-NON-PREPACK.                                                09169008
091700     SUBTRACT PV-LINE-QTY FROM RECITM-PKSL-ITM-QTY                09170008
091710             GIVING PV-PKSL-ITM-QTY                               09171008
091720                                                                  09172008
091730     IF PV-PKSL-ITM-QTY = ZERO                                    09173008
091740         PERFORM 8000-AUDIT-RECITM                                09174008
091750         MOVE PV-PKSL-ITM-QTY         TO RECITM-PKSL-ITM-QTY      09175008
091760         PERFORM 7810-SET-CURR-RECITM-TO-INACT                    09176008
091770                                                                  09177008
091780         PERFORM 7950-INACTIVATE-TWRKORD                          09178008
091790         PERFORM 7960-INACTIVATE-TWKORIN                          09179008
091800*        PERFORM 7970-INACTIVATE-TWOSTAL                          09180023
091810         PERFORM 7990-DELETE-LINE-TROUBLE                         09181008
091820     ELSE                                                         09182008
091830         PERFORM 8000-AUDIT-RECITM                                09183008
091840         MOVE PV-PKSL-ITM-QTY         TO RECITM-PKSL-ITM-QTY      09184008
091850         PERFORM 7815-UPDATE-RECITM-QTY                           09185008
091860     END-IF.                                                      09186008
091870                                                                  09187008
091880 7615-INACTIVATE-PACKS.                                           09188008
091890     IF PWT-PACK-ID (PWT-PACK-IDX) > ZERO                         09189008
091900         MOVE PWT-PACK-ID (PWT-PACK-IDX)                          09190008
091910                                      TO RECITM-PREPK-ID          09191008
091920         PERFORM 7616-COUNT-ACT-LINES-IN-PACK                     09192008
091930         IF PV-DB2-COUNT > ZERO                                   09193008
091940             INITIALIZE TM500-FIELDS                              09194008
091950             MOVE PWT-LINE-NBR (PWT-PACK-IDX)                     09195008
091960                                      TO TM500-PO-LNE-NBR         09196008
091970                                                                  09197008
091980                 SET TM500-PACK-LEVEL                             09198008
091990                     TM500-CREATE-AUTO                            09199008
092000                     TM500-REDISTRO-NO                            09200008
092010                     TM500-CREATE-DC-BAD-PACK                     09201008
092020                     TM500-NO-DETAILS TO TRUE                     09202008
092030                                                                  09203008
092040             PERFORM 7410-PREPACK-TROUBLE                         09204008
092050                                                                  09205008
092060         ELSE                                                     09206008
092070             PERFORM 7985-DELETE-PACK-TROUBLE                     09207008
092080         END-IF                                                   09208008
092090     END-IF.                                                      09209008
092100                                                                  09210008
092110 7616-COUNT-ACT-LINES-IN-PACK.                                    09211008
092120                                                                  09212008
092130     MOVE  ZEROES  TO  PV-PO-LINES-IN-PACK.                       09213008
092140     MOVE  ZEROES  TO  PV-DB2-COUNT.                              09214008
092150                                                                  09215008
092160     EXEC SQL                                                     09216008
092170         SELECT ORD_NBR                                           09217008
092180           INTO :PV-PO-LINES-IN-PACK                              09218008
092190           FROM TRECITM                                           09219008
092200          WHERE ORD_NBR        = :DK-PO-NBR                       09220008
092210            AND REC_SEQ_NBR    = :DK-REC-SEQ-NBR                  09221008
092220            AND OPER_UNT_ID    = :DK-OPER-UNT-ID                  09222008
092230            AND FCLTY_ID       = :DK-FCLTY-ID                     09223008
092240            AND PREPK_ID       = :RECITM-PREPK-ID                 09224008
092250            AND VER_STATUS_CDE = 'A'                              09225008
092260          FETCH FIRST 1 ROW ONLY                                  09226008
092270     END-EXEC                                                     09227008
092280                                                                  09228008
092290     EVALUATE TRUE                                                09229008
092300         WHEN SQLCODE = ZERO                                      09230008
092310         WHEN SQLCODE = -811                                      09231008
092320              MOVE  1  TO  PV-DB2-COUNT                           09232008
092330         WHEN SQLCODE = +100                                      09233008
092340         WHEN SQLCODE = -305                                      09234008
092350              MOVE  0  TO  PV-DB2-COUNT                           09235012
092360         WHEN SQLCODE = -904                                      09236008
092370         WHEN SQLCODE = -911                                      09237008
092380         WHEN SQLCODE = -913                                      09238008
092390             PERFORM 9900-SOFT-ABORT                              09239008
092400                                                                  09240008
092410         WHEN SQLWARN0 NOT = SPACES                               09241008
092420         WHEN SQLCODE  NOT = ZERO                                 09242008
092430             MOVE '7616-COUNT-ACTIVE-LINES-IN-PACK'               09243008
092440                                      TO DP013-PARAGRAPH          09244008
092450             MOVE 'UNSUCCESSFUL SELECT OF TRECITM'                09245008
092460                                      TO DP013-MESSAGE-TEXT (1)   09246008
092470             MOVE ASC-KEY-PO-NBR      TO PV-MSG-KEY-PO            09247008
092480             MOVE DK-REC-SEQ-NBR      TO PV-MSG-KEY-REC-SEQ-NBR-N 09248008
092490             MOVE RECITM-ORD-LNE-NBR  TO PV-MSG-KEY-PO-LNE-NBR-N  09249008
092500             MOVE PV-MSG-KEYS         TO DP013-MESSAGE-TEXT (2)   09250008
092510             MOVE SQLCA               TO DP013-SQLCA              09251008
092520             MOVE 'TRECITM'           TO DP013-DB2-TABLE-NAME (1) 09252008
092530             SET DP013-DB2-ABEND                                  09253008
092540                 DP013-XCTL-DISPLAY-RESTART                       09254008
092550                                      TO TRUE                     09255008
092560             PERFORM DP013-0000-PROCESS-ABEND                     09256008
092570     END-EVALUATE.                                                09257008
092580                                                                  09258008
092590/                                                                 09259008
092600 7620-SELECT-RECDIS.                                              09260008
092610                                                                  09261008
092620         EXEC SQL                                                 09262008
092630             SELECT ORD_NBR,                                      09263008
092640                    ORD_LNE_NBR,                                  09264008
092650                    REC_SEQ_NBR,                                  09265008
092660                    OPER_UNT_ID,                                  09266008
092670                    FCLTY_ID,                                     09267008
092680                    CRE_TMST,                                     09268008
092690                    CRE_UID,                                      09269008
092700                    VER_STATUS_CDE,                               09270008
092710                    EXPTED_ITM_QTY,                               09271008
092720                    VERIFY_ITM_QTY,                               09272008
092730                    AP_VERIFY_ITM_QTY,                            09273008
092740                    STR_NBR,                                      09274008
092750                    STR_FCLTY_ID,                                 09275008
092760                    PLAN_ITM_QTY,                                 09276008
092770                    AP_PRC_CDE,                                   09277008
092780                    AP_PRC_DTE                                    09278008
092790              INTO  :RECDIS-ORD-NBR,                              09279008
092800                    :RECDIS-ORD-LNE-NBR,                          09280008
092810                    :RECDIS-REC-SEQ-NBR,                          09281008
092820                    :RECDIS-OPER-UNT-ID,                          09282008
092830                    :RECDIS-FCLTY-ID,                             09283008
092840                    :RECDIS-CRE-TMST,                             09284008
092850                    :RECDIS-CRE-UID,                              09285008
092860                    :RECDIS-VER-STATUS-CDE,                       09286008
092870                    :RECDIS-EXPTED-ITM-QTY,                       09287008
092880                    :RECDIS-VERIFY-ITM-QTY,                       09288008
092890                    :RECDIS-AP-VERIFY-ITM-QTY,                    09289008
092900                    :RECDIS-STR-NBR,                              09290008
092910                    :RECDIS-STR-FCLTY-ID,                         09291008
092920                    :RECDIS-PLAN-ITM-QTY,                         09292008
092930                    :RECDIS-AP-PRC-CDE,                           09293008
092940                    :RECDIS-AP-PRC-DTE                            09294008
092950               FROM TRECDIS                                       09295008
092960              WHERE ORD_NBR        = :DK-PO-NBR                   09296008
092970                AND ORD_LNE_NBR    = :RECITM-ORD-LNE-NBR          09297008
092980                AND REC_SEQ_NBR    = :DK-REC-SEQ-NBR              09298008
092990                AND OPER_UNT_ID    = :DK-OPER-UNT-ID              09299008
093000                AND FCLTY_ID       = :DK-FCLTY-ID                 09300008
093010                AND VER_STATUS_CDE = 'A'                          09301008
093020         END-EXEC                                                 09302008
093030                                                                  09303008
093040         EVALUATE TRUE                                            09304008
093050             WHEN SQLCODE = ZERO                                  09305008
093060             WHEN SQLCODE = -811                                  09306008
093070                  SET PS-RECDIS-FOUND                             09307008
093080                                 TO TRUE                          09308008
093090             WHEN SQLCODE = +100                                  09309008
093100                  SET PS-RECDIS-NOT-FOUND                         09310008
093110                                 TO TRUE                          09311008
093120             WHEN SQLCODE = -904                                  09312008
093130             WHEN SQLCODE = -911                                  09313008
093140             WHEN SQLCODE = -913                                  09314008
093150                  PERFORM 9900-SOFT-ABORT                         09315008
093160                                                                  09316008
093170             WHEN SQLWARN0 NOT = SPACES                           09317008
093180             WHEN SQLCODE  NOT = ZERO                             09318008
093190                  MOVE '7620-SELECT-RECDIS'                       09319008
093200                                 TO DP013-PARAGRAPH               09320008
093210                  MOVE 'UNSUCCESSFUL SELECT OF TRECDIS'           09321008
093220                                 TO DP013-MESSAGE-TEXT (1)        09322008
093230                  MOVE ASC-KEY-PO-NBR                             09323008
093240                                 TO PV-MSG-KEY-PO                 09324008
093250                  MOVE ASC-KEY-REC-SEQ-NBR                        09325008
093260                                 TO PV-MSG-KEY-REC-SEQ-NBR-N      09326008
093270                  MOVE RECITM-ORD-LNE-NBR                         09327008
093280                                 TO PV-MSG-KEY-PO-LNE-NBR-N       09328008
093290                  MOVE PV-MSG-KEYS                                09329008
093300                                 TO DP013-MESSAGE-TEXT (2)        09330008
093310                  MOVE SQLCA     TO DP013-SQLCA                   09331008
093320                  MOVE 'TRECDIS' TO DP013-DB2-TABLE-NAME (1)      09332008
093330                  SET DP013-DB2-ABEND                             09333008
093340                      DP013-XCTL-DISPLAY-RESTART                  09334008
093350                                 TO TRUE                          09335008
093360                  PERFORM DP013-0000-PROCESS-ABEND                09336008
093370         END-EVALUATE.                                            09337008
093380                                                                  09338008
093390 7625-SELECT-STR-RECDIS.                                          09339008
093400                                                                  09340008
093410         EXEC SQL                                                 09341008
093420             SELECT ORD_NBR,                                      09342008
093430                    ORD_LNE_NBR,                                  09343008
093440                    REC_SEQ_NBR,                                  09344008
093450                    OPER_UNT_ID,                                  09345008
093460                    FCLTY_ID,                                     09346008
093470                    CRE_TMST,                                     09347008
093480                    CRE_UID,                                      09348008
093490                    VER_STATUS_CDE,                               09349008
093500                    EXPTED_ITM_QTY,                               09350008
093510                    VERIFY_ITM_QTY,                               09351008
093520                    AP_VERIFY_ITM_QTY,                            09352008
093530                    STR_NBR,                                      09353008
093540                    STR_FCLTY_ID,                                 09354008
093550                    PLAN_ITM_QTY,                                 09355008
093560                    AP_PRC_CDE,                                   09356008
093570                    AP_PRC_DTE                                    09357008
093580              INTO  :RECDIS-ORD-NBR,                              09358008
093590                    :RECDIS-ORD-LNE-NBR,                          09359008
093600                    :RECDIS-REC-SEQ-NBR,                          09360008
093610                    :RECDIS-OPER-UNT-ID,                          09361008
093620                    :RECDIS-FCLTY-ID,                             09362008
093630                    :RECDIS-CRE-TMST,                             09363008
093640                    :RECDIS-CRE-UID,                              09364008
093650                    :RECDIS-VER-STATUS-CDE,                       09365008
093660                    :RECDIS-EXPTED-ITM-QTY,                       09366008
093670                    :RECDIS-VERIFY-ITM-QTY,                       09367008
093680                    :RECDIS-AP-VERIFY-ITM-QTY,                    09368008
093690                    :RECDIS-STR-NBR,                              09369008
093700                    :RECDIS-STR-FCLTY-ID,                         09370008
093710                    :RECDIS-PLAN-ITM-QTY,                         09371008
093720                    :RECDIS-AP-PRC-CDE,                           09372008
093730                    :RECDIS-AP-PRC-DTE                            09373008
093740               FROM TRECDIS                                       09374008
093750              WHERE ORD_NBR        = :RECDIS-ORD-NBR              09375008
093760                AND ORD_LNE_NBR    = :RECDIS-ORD-LNE-NBR          09376008
093770                AND REC_SEQ_NBR    = :RECDIS-REC-SEQ-NBR          09377008
093780                AND OPER_UNT_ID    = :RECDIS-OPER-UNT-ID          09378008
093790                AND FCLTY_ID       = :RECDIS-FCLTY-ID             09379008
093800                AND STR_NBR        = :RECDIS-STR-NBR              09380008
093810                AND STR_FCLTY_ID   = 1                            09381008
093820         END-EXEC                                                 09382008
093830                                                                  09383008
093840         EVALUATE TRUE                                            09384008
093850             WHEN SQLCODE = ZERO                                  09385008
093860             WHEN SQLCODE = +100                                  09386008
093870                 CONTINUE                                         09387008
093880             WHEN SQLCODE = -904                                  09388008
093890             WHEN SQLCODE = -911                                  09389008
093900             WHEN SQLCODE = -913                                  09390008
093910                  PERFORM 9900-SOFT-ABORT                         09391008
093920                                                                  09392008
093930             WHEN SQLWARN0 NOT = SPACES                           09393008
093940             WHEN SQLCODE  NOT = ZERO                             09394008
093950                  MOVE '7625-SELECT-STR-RECDIS'                   09395008
093960                                 TO DP013-PARAGRAPH               09396008
093970                  MOVE 'UNSUCCESSFUL SELECT OF TRECDIS'           09397008
093980                                 TO DP013-MESSAGE-TEXT (1)        09398008
093990                  MOVE ASC-KEY-PO-NBR                             09399008
094000                                 TO PV-MSG-KEY-PO                 09400008
094010                  MOVE ASC-KEY-REC-SEQ-NBR                        09401008
094020                                 TO PV-MSG-KEY-REC-SEQ-NBR-N      09402008
094030                  MOVE RECITM-ORD-LNE-NBR                         09403008
094040                                 TO PV-MSG-KEY-PO-LNE-NBR-N       09404008
094050                  MOVE RECDIS-STR-NBR                             09405008
094060                                 TO PV-MSG-KEY-STR-NBR            09406008
094070                  MOVE PV-MSG-KEYS                                09407008
094080                                 TO DP013-MESSAGE-TEXT (2)        09408008
094090                  MOVE SQLCA     TO DP013-SQLCA                   09409008
094100                  MOVE 'TRECDIS' TO DP013-DB2-TABLE-NAME (1)      09410008
094110                  SET DP013-DB2-ABEND                             09411008
094120                      DP013-XCTL-DISPLAY-RESTART                  09412008
094130                                 TO TRUE                          09413008
094140                  PERFORM DP013-0000-PROCESS-ABEND                09414008
094150         END-EVALUATE.                                            09415008
094160                                                                  09416008
094170 7630-DELETE-RECDIS.                                              09417008
094180                                                                  09418008
094190     EXEC SQL                                                     09419008
094200          DELETE                                                  09420008
094210            FROM TRECDIS                                          09421008
094220            WHERE ORD_NBR        = :DK-PO-NBR                     09422008
094230              AND ORD_LNE_NBR    = :RECITM-ORD-LNE-NBR            09423008
094240              AND REC_SEQ_NBR    = :DK-REC-SEQ-NBR                09424008
094250              AND OPER_UNT_ID    = :DK-OPER-UNT-ID                09425008
094260              AND FCLTY_ID       = :DK-FCLTY-ID                   09426008
094270              AND STR_NBR        = :RECDIS-STR-NBR                09427008
094280              AND STR_FCLTY_ID   =  1                             09428008
094290              AND VER_STATUS_CDE = 'A'                            09429008
094300     END-EXEC.                                                    09430008
094310                                                                  09431008
094320     EVALUATE TRUE                                                09432008
094330         WHEN SQLCODE = ZERO                                      09433008
094340         WHEN SQLCODE = +100                                      09434008
094350              CONTINUE                                            09435008
094360         WHEN SQLCODE = -904                                      09436008
094370         WHEN SQLCODE = -911                                      09437008
094380         WHEN SQLCODE = -913                                      09438008
094390              PERFORM 9900-SOFT-ABORT                             09439008
094400                                                                  09440008
094410         WHEN SQLWARN0 NOT = SPACES                               09441008
094420         WHEN SQLCODE  NOT = ZERO                                 09442008
094430              MOVE '7630-DELETE-RECDIS'                           09443008
094440                             TO DP013-PARAGRAPH                   09444008
094450              MOVE 'UNSUCCESSFUL DELETE OF TRECDIS'               09445008
094460                             TO DP013-MESSAGE-TEXT (1)            09446008
094470              MOVE DK-PO-NBR                                      09447008
094480                             TO PV-MSG-KEY-PO                     09448008
094490              MOVE DK-REC-SEQ-NBR                                 09449008
094500                             TO PV-MSG-KEY-REC-SEQ-NBR-N          09450008
094510              MOVE RECDIS-ORD-LNE-NBR                             09451008
094520                             TO PV-MSG-KEY-PO-LNE-NBR-N           09452008
094530              MOVE PV-MSG-KEYS                                    09453008
094540                             TO DP013-MESSAGE-TEXT (2)            09454008
094550              MOVE SQLCA     TO DP013-SQLCA                       09455008
094560              MOVE 'TRECDIS' TO DP013-DB2-TABLE-NAME (1)          09456008
094570              SET DP013-DB2-ABEND                                 09457008
094580                  DP013-XCTL-DISPLAY-RESTART                      09458008
094590                             TO TRUE                              09459008
094600              PERFORM DP013-0000-PROCESS-ABEND                    09460008
094610     END-EVALUATE.                                                09461008
094620                                                                  09462008
094630                                                                  09463008
094640 7635-DELETE-RECDIS.                                              09464008
094650                                                                  09465008
094660     EXEC SQL                                                     09466008
094670          DELETE                                                  09467008
094680            FROM TRECDIS                                          09468008
094690            WHERE ORD_NBR        = :DK-PO-NBR                     09469008
094700              AND ORD_LNE_NBR    = :RECITM-ORD-LNE-NBR            09470008
094710              AND REC_SEQ_NBR    = :DK-REC-SEQ-NBR                09471008
094720              AND OPER_UNT_ID    = :DK-OPER-UNT-ID                09472008
094730              AND FCLTY_ID       = :DK-FCLTY-ID                   09473008
094740              AND VER_STATUS_CDE = 'A'                            09474008
094750     END-EXEC.                                                    09475008
094760                                                                  09476008
094770     EVALUATE TRUE                                                09477008
094780         WHEN SQLCODE = ZERO                                      09478008
094790         WHEN SQLCODE = +100                                      09479008
094800              CONTINUE                                            09480008
094810         WHEN SQLCODE = -904                                      09481008
094820         WHEN SQLCODE = -911                                      09482008
094830         WHEN SQLCODE = -913                                      09483008
094840              PERFORM 9900-SOFT-ABORT                             09484008
094850                                                                  09485008
094860         WHEN SQLWARN0 NOT = SPACES                               09486008
094870         WHEN SQLCODE  NOT = ZERO                                 09487008
094880              MOVE '7635-DELETE-RECDIS'                           09488008
094890                             TO DP013-PARAGRAPH                   09489008
094900              MOVE 'UNSUCCESSFUL DELETE OF TRECDIS'               09490008
094910                             TO DP013-MESSAGE-TEXT (1)            09491008
094920              MOVE DK-PO-NBR                                      09492008
094930                             TO PV-MSG-KEY-PO                     09493008
094940              MOVE DK-REC-SEQ-NBR                                 09494008
094950                             TO PV-MSG-KEY-REC-SEQ-NBR-N          09495008
094960              MOVE RECDIS-ORD-LNE-NBR                             09496008
094970                             TO PV-MSG-KEY-PO-LNE-NBR-N           09497008
094980              MOVE PV-MSG-KEYS                                    09498008
094990                             TO DP013-MESSAGE-TEXT (2)            09499008
095000              MOVE SQLCA     TO DP013-SQLCA                       09500008
095010              MOVE 'TRECDIS' TO DP013-DB2-TABLE-NAME (1)          09501008
095020              SET DP013-DB2-ABEND                                 09502008
095030                  DP013-XCTL-DISPLAY-RESTART                      09503008
095040                             TO TRUE                              09504008
095050              PERFORM DP013-0000-PROCESS-ABEND                    09505008
095060     END-EVALUATE.                                                09506008
095070                                                                  09507008
095080 7637-UPDATE-RECDIS.                                              09508008
095090                                                                  09509008
095100         EXEC SQL                                                 09510008
095110           UPDATE TRECDIS                                         09511008
095120              SET EXPTED_ITM_QTY = :PV-LINE-QTY                   09512008
095130                , VERIFY_ITM_QTY = :PV-LINE-QTY                   09513008
095140              WHERE ORD_NBR        = :RECDIS-ORD-NBR              09514008
095150                AND ORD_LNE_NBR    = :RECDIS-ORD-LNE-NBR          09515008
095160                AND REC_SEQ_NBR    = :RECDIS-REC-SEQ-NBR          09516008
095170                AND STR_NBR        = :RECDIS-STR-NBR              09517008
095180                AND OPER_UNT_ID    = :RECDIS-OPER-UNT-ID          09518008
095190                AND FCLTY_ID       = :RECDIS-FCLTY-ID             09519008
095200                AND STR_FCLTY_ID   = 1                            09520008
095210                                                                  09521008
095220         END-EXEC                                                 09522008
095230                                                                  09523008
095240         EVALUATE TRUE                                            09524008
095250             WHEN SQLCODE = ZERO                                  09525008
095260             WHEN SQLCODE = +100                                  09526008
095270                  CONTINUE                                        09527008
095280             WHEN SQLCODE = -904                                  09528008
095290             WHEN SQLCODE = -911                                  09529008
095300             WHEN SQLCODE = -913                                  09530008
095310                  PERFORM 9900-SOFT-ABORT                         09531008
095320                                                                  09532008
095330             WHEN SQLWARN0 NOT = SPACES                           09533008
095340             WHEN SQLCODE  NOT = ZERO                             09534008
095350                  MOVE '7637-UPDATE-RECDIS'                       09535008
095360                                 TO DP013-PARAGRAPH               09536008
095370                  MOVE 'UNSUCCESSFUL UPDATE OF TRECDIS'           09537008
095380                                 TO DP013-MESSAGE-TEXT (1)        09538008
095390                  MOVE ASC-KEY-PO-NBR                             09539008
095400                                 TO PV-MSG-KEY-PO                 09540008
095410                  MOVE DK-REC-SEQ-NBR                             09541008
095420                                 TO PV-MSG-KEY-REC-SEQ-NBR-N      09542008
095430                  MOVE RECDIS-ORD-LNE-NBR                         09543008
095440                                 TO PV-MSG-KEY-PO-LNE-NBR-N       09544008
095450                  MOVE RECDIS-STR-NBR                             09545008
095460                                 TO PV-MSG-KEY-STR-NBR            09546008
095470                  MOVE PV-MSG-KEYS                                09547008
095480                                 TO DP013-MESSAGE-TEXT (2)        09548008
095490                  MOVE SQLCA     TO DP013-SQLCA                   09549008
095500                  MOVE 'TRECDIS' TO DP013-DB2-TABLE-NAME (1)      09550008
095510                  SET DP013-DB2-ABEND                             09551008
095520                      DP013-XCTL-DISPLAY-RESTART                  09552008
095530                                 TO TRUE                          09553008
095540                  PERFORM DP013-0000-PROCESS-ABEND                09554008
095550         END-EVALUATE.                                            09555008
095560                                                                  09556008
095570*--------------------------------------------------------------*  09557008
095580*    PARAGRAPH IS CALLED FROM SEVERAL PLACES WHERE THE         *  09558008
095590*    TRECDIS ROWS ARE DELETED SO THE WHERE CONDITIONS VARY     *  09559008
095600*    ACCORDING TO HOW THE TRECDIS ROW IS QUALIFIED.            *  09560008
095610*                                                              *  09561008
095620*    NOTE: THE SWITCH IS NAMED TO MATCH THE PARAGRAPH          *  09562008
095630*          DELETING THE TRECDIS ROW.                           *  09563008
095640*                                                              *  09564008
095650*--------------------------------------------------------------*  09565008
095660                                                                  09566008
095670 7640-DELETE-ODD-UNIT.                                            09567008
095680                                                                  09568008
095690     EVALUATE TRUE                                                09569008
095700         WHEN PS-7630-DELETE                                      09570008
095710              EXEC SQL                                            09571008
095720                   DELETE                                         09572008
095730                     FROM RCT_VRFD_ODD_UNT                        09573008
095740                     WHERE PO_NBR         = :DK-PO-NBR            09574008
095750                       AND PO_LNE_NBR     = :RECITM-ORD-LNE-NBR   09575008
095760                       AND RCVR_SEQ_NBR   = :DK-REC-SEQ-NBR       09576008
095770                       AND STR_NBR        = :RECDIS-STR-NBR       09577008
095780              END-EXEC                                            09578008
095790                                                                  09579008
095800         WHEN PS-7635-DELETE                                      09580008
095810              EXEC SQL                                            09581008
095820                   DELETE                                         09582008
095830                     FROM RCT_VRFD_ODD_UNT                        09583008
095840                     WHERE PO_NBR         = :DK-PO-NBR            09584008
095850                       AND PO_LNE_NBR     = :RECITM-ORD-LNE-NBR   09585008
095860                       AND RCVR_SEQ_NBR   = :DK-REC-SEQ-NBR       09586008
095870              END-EXEC                                            09587008
095880                                                                  09588008
095890         WHEN PS-7814-DELETE                                      09589008
095900              EXEC SQL                                            09590008
095910                   DELETE                                         09591008
095920                     FROM RCT_VRFD_ODD_UNT                        09592008
095930                     WHERE PO_NBR         = :DK-PO-NBR            09593008
095940                       AND PO_LNE_NBR     = :RECITM-ORD-LNE-NBR   09594008
095950                       AND RCVR_SEQ_NBR   = :DK-REC-SEQ-NBR       09595008
095960              END-EXEC                                            09596008
095970                                                                  09597008
095980     END-EVALUATE.                                                09598008
095990                                                                  09599008
096000     EVALUATE TRUE                                                09600008
096010         WHEN SQLCODE = ZERO                                      09601008
096020         WHEN SQLCODE = +100                                      09602008
096030              CONTINUE                                            09603008
096040         WHEN SQLCODE = -904                                      09604008
096050         WHEN SQLCODE = -911                                      09605008
096060         WHEN SQLCODE = -913                                      09606008
096070              PERFORM 9900-SOFT-ABORT                             09607008
096080                                                                  09608008
096090         WHEN SQLWARN0 NOT = SPACES                               09609008
096100         WHEN SQLCODE  NOT = ZERO                                 09610008
096110              MOVE '7640-DELETE-ODD-UNIT'                         09611008
096120                             TO DP013-PARAGRAPH                   09612008
096130              MOVE 'UNSUCCESSFUL DELETE OF RCT_VRFD_ODD_UNT'      09613008
096140                             TO DP013-MESSAGE-TEXT (1)            09614008
096150              MOVE DK-PO-NBR                                      09615008
096160                             TO PV-MSG-KEY-PO                     09616008
096170              MOVE DK-REC-SEQ-NBR                                 09617008
096180                             TO PV-MSG-KEY-REC-SEQ-NBR-N          09618008
096190              MOVE RECDIS-ORD-LNE-NBR                             09619008
096200                             TO PV-MSG-KEY-PO-LNE-NBR-N           09620008
096210              MOVE PV-MSG-KEYS                                    09621008
096220                             TO DP013-MESSAGE-TEXT (2)            09622008
096230              MOVE SQLCA     TO DP013-SQLCA                       09623008
096240              MOVE 'RCT00009' TO DP013-DB2-TABLE-NAME (1)         09624008
096250              SET DP013-DB2-ABEND                                 09625008
096260                  DP013-XCTL-DISPLAY-RESTART                      09626008
096270                             TO TRUE                              09627008
096280              PERFORM DP013-0000-PROCESS-ABEND                    09628008
096290     END-EVALUATE.                                                09629008
096300                                                                  09630008
096310                                                                  09631008
096320 7700-OPEN-PKSLIP-ITEM-CURSOR.                                    09632008
096330                                                                  09633008
096340         EXEC SQL                                                 09634008
096350              OPEN PKSLIP-ITEM-CURSOR                             09635008
096360         END-EXEC                                                 09636008
096370                                                                  09637008
096380         EVALUATE TRUE                                            09638008
096390             WHEN SQLCODE = ZERO                                  09639008
096400                  SET PS-NOT-END-OF-PKSLIP-ITEM-CSR               09640008
096410                                 TO TRUE                          09641008
096420             WHEN SQLCODE = -904                                  09642008
096430             WHEN SQLCODE = -911                                  09643008
096440             WHEN SQLCODE = -913                                  09644008
096450                  PERFORM 9900-SOFT-ABORT                         09645008
096460                                                                  09646008
096470             WHEN SQLWARN0 NOT = SPACES                           09647008
096480             WHEN SQLCODE  NOT = ZERO                             09648008
096490                  MOVE '7700-OPEN-PKSLIP-ITEM-CURSOR'             09649008
096500                                 TO DP013-PARAGRAPH               09650008
096510                  MOVE 'UNSUCCESSFUL PCSLIP-LINE CURSOR OPEN'     09651008
096520                                 TO DP013-MESSAGE-TEXT (1)        09652008
096530                  MOVE ASC-KEY-PO-NBR                             09653008
096540                                 TO PV-MSG-KEY-PO                 09654008
096550                  MOVE ASC-KEY-REC-SEQ-NBR                        09655008
096560                                 TO PV-MSG-KEY-REC-SEQ-NBR-N      09656008
096570                  MOVE PV-MSG-KEYS                                09657008
096580                                 TO DP013-MESSAGE-TEXT (2)        09658008
096590                  MOVE SQLCA TO DP013-SQLCA                       09659008
096600                  MOVE 'TPKITEM' TO DP013-DB2-TABLE-NAME (1)      09660008
096610                  SET DP013-XCTL-DISPLAY-RESTART                  09661008
096620                      DP013-DB2-ABEND                             09662008
096630                                 TO TRUE                          09663008
096640                                                                  09664008
096650                  PERFORM DP013-0000-PROCESS-ABEND                09665008
096660         END-EVALUATE.                                            09666008
096670 7710-FETCH-PKSLIP-ITEMS.                                         09667008
096680                                                                  09668008
096690     EXEC SQL                                                     09669008
096700          FETCH PKSLIP-ITEM-CURSOR                                09670008
096710           INTO :PV-LINE-QTY,                                     09671008
096720                :PV-PKSL-LNE-NBR                                  09672008
096730     END-EXEC.                                                    09673008
096740                                                                  09674008
096750     EVALUATE TRUE                                                09675008
096760         WHEN SQLCODE = ZERO                                      09676008
096770              CONTINUE                                            09677008
096780         WHEN SQLCODE = +100                                      09678008
096790              SET PS-END-OF-PKSLIP-ITEM-CSR                       09679008
096800                                 TO TRUE                          09680008
096810         WHEN SQLCODE = -904                                      09681008
096820         WHEN SQLCODE = -911                                      09682008
096830         WHEN SQLCODE = -913                                      09683008
096840              PERFORM 9900-SOFT-ABORT                             09684008
096850                                                                  09685008
096860         WHEN SQLWARN0 NOT = SPACES                               09686008
096870         WHEN SQLCODE  NOT = ZERO                                 09687008
096880              MOVE '7710-FETCH-PKSLIP-ITEMS'                      09688008
096890                                 TO DP013-PARAGRAPH               09689008
096900              MOVE 'UNSUCCESSFUL FETCH PACK SLIP LINE CURSOR'     09690008
096910                                 TO DP013-MESSAGE-TEXT (1)        09691008
096920              MOVE ASC-KEY-PO-NBR                                 09692008
096930                                 TO PV-MSG-KEY-PO                 09693008
096940              MOVE ASC-KEY-REC-SEQ-NBR                            09694008
096950                                 TO PV-MSG-KEY-REC-SEQ-NBR-N      09695008
096960              MOVE PV-MSG-KEYS   TO DP013-MESSAGE-TEXT (2)        09696008
096970              MOVE SQLCA         TO DP013-SQLCA                   09697008
096980              MOVE 'TPKITEM'     TO DP013-DB2-TABLE-NAME (1)      09698008
096990              SET DP013-DB2-ABEND                                 09699008
097000                  DP013-XCTL-DISPLAY-RESTART                      09700008
097010                                 TO TRUE                          09701008
097020                                                                  09702008
097030              PERFORM DP013-0000-PROCESS-ABEND                    09703008
097040     END-EVALUATE.                                                09704008
097050                                                                  09705008
097060 7720-CLOSE-PKSLIP-ITEM-CURSOR.                                   09706008
097070                                                                  09707008
097080     EXEC SQL                                                     09708008
097090          CLOSE PKSLIP-ITEM-CURSOR                                09709008
097100     END-EXEC.                                                    09710008
097110                                                                  09711008
097120     EVALUATE TRUE                                                09712008
097130         WHEN SQLCODE = ZERO                                      09713008
097140              CONTINUE                                            09714008
097150         WHEN SQLCODE = -904                                      09715008
097160         WHEN SQLCODE = -911                                      09716008
097170         WHEN SQLCODE = -913                                      09717008
097180              PERFORM 9900-SOFT-ABORT                             09718008
097190                                                                  09719008
097200         WHEN SQLWARN0 NOT = SPACES                               09720008
097210         WHEN SQLCODE  NOT = ZERO                                 09721008
097220              MOVE '7720-CLOSE-PKSLIP-ITEM-CURSOR'                09722008
097230                                 TO DP013-PARAGRAPH               09723008
097240              MOVE 'UNSUCCESSFUL PACK SLIP LINE CURSOR CLOSE'     09724008
097250                                 TO DP013-MESSAGE-TEXT (1)        09725008
097260              MOVE ASC-KEY-PO-NBR                                 09726008
097270                                 TO PV-MSG-KEY-PO                 09727008
097280              MOVE ASC-KEY-REC-SEQ-NBR                            09728008
097290                                 TO PV-MSG-KEY-REC-SEQ-NBR-N      09729008
097300              MOVE PV-MSG-KEYS   TO DP013-MESSAGE-TEXT (2)        09730008
097310              MOVE SQLCA TO DP013-SQLCA                           09731008
097320              MOVE 'TPKITEM '    TO DP013-DB2-TABLE-NAME (1)      09732008
097330              SET DP013-DB2-ABEND                                 09733008
097340                  DP013-XCTL-DISPLAY-RESTART                      09734008
097350                                 TO TRUE                          09735008
097360                                                                  09736008
097370              PERFORM DP013-0000-PROCESS-ABEND                    09737008
097380     END-EVALUATE.                                                09738008
097390/                                                                 09739008
097400 7730-OPEN-PRPK-PKSLIP-ITEM-CSR.                                  09740008
097410                                                                  09741008
097420         EXEC SQL                                                 09742008
097430              OPEN PREPACK-ITEM-CSR                               09743008
097440         END-EXEC                                                 09744008
097450                                                                  09745008
097460         EVALUATE TRUE                                            09746008
097470             WHEN SQLCODE = ZERO                                  09747008
097480                  SET PS-START-PRPK-PKSLIP-ITEM-CSR               09748008
097490                                      TO TRUE                     09749008
097500             WHEN SQLCODE = -904                                  09750008
097510             WHEN SQLCODE = -911                                  09751008
097520             WHEN SQLCODE = -913                                  09752008
097530                  PERFORM 9900-SOFT-ABORT                         09753008
097540                                                                  09754008
097550             WHEN SQLWARN0 NOT = SPACES                           09755008
097560             WHEN SQLCODE  NOT = ZERO                             09756008
097570                  MOVE '7730-OPEN-PRPK-PKSLIP-ITEM-CSR'           09757008
097580                                 TO DP013-PARAGRAPH               09758008
097590                  MOVE 'UNSUCCESSFUL PCSLIP-LINE CURSOR OPEN'     09759008
097600                                 TO DP013-MESSAGE-TEXT (1)        09760008
097610                  MOVE ASC-KEY-PO-NBR                             09761008
097620                                 TO PV-MSG-KEY-PO                 09762008
097630                  MOVE ASC-KEY-REC-SEQ-NBR                        09763008
097640                                 TO PV-MSG-KEY-REC-SEQ-NBR-N      09764008
097650                  MOVE PV-MSG-KEYS                                09765008
097660                                 TO DP013-MESSAGE-TEXT (2)        09766008
097670                  MOVE SQLCA TO DP013-SQLCA                       09767008
097680                  MOVE 'TPKITEM' TO DP013-DB2-TABLE-NAME (1)      09768008
097690                  MOVE 'TPURITM' TO DP013-DB2-TABLE-NAME (2)      09769008
097700                  SET DP013-XCTL-DISPLAY-RESTART                  09770008
097710                      DP013-DB2-ABEND                             09771008
097720                                 TO TRUE                          09772008
097730                                                                  09773008
097740                  PERFORM DP013-0000-PROCESS-ABEND                09774008
097750         END-EVALUATE.                                            09775008
097760                                                                  09776008
097770 7731-FETCH-PREPACK-ITEM-CSR.                                     09777008
097780                                                                  09778008
097790     EXEC SQL                                                     09779008
097800         FETCH PREPACK-ITEM-CSR                                   09780008
097810         INTO                                                     09781008
097820          :PURITM-PO-PREPK-ID                                     09782008
097830       ,  :PURITM-VER-NBR                                         09783008
097840       ,  :PV-PKSL-LNE-NBR                                        09784008
097850       ,  :PURITM-PREPK-RATO-QTY                                  09785008
097860       ,  :PV-LINE-QTY                                            09786008
097870     END-EXEC.                                                    09787008
097880                                                                  09788008
097890     EVALUATE TRUE                                                09789008
097900         WHEN SQLCODE = ZERO                                      09790008
097910             IF PURITM-PO-PREPK-ID = 99                           09791008
097920                 MOVE 1               TO PURITM-PREPK-RATO-QTY    09792008
097930             END-IF                                               09793008
097940         WHEN SQLCODE = +100                                      09794008
097950             SET PS-END-PRPK-PKSLIP-ITEM-CSR                      09795008
097960                                 TO TRUE                          09796008
097970         WHEN SQLCODE = -904                                      09797008
097980         WHEN SQLCODE = -911                                      09798008
097990         WHEN SQLCODE = -913                                      09799008
098000              PERFORM 9900-SOFT-ABORT                             09800008
098010                                                                  09801008
098020         WHEN SQLWARN0 NOT = SPACES                               09802008
098030         WHEN SQLCODE  NOT = ZERO                                 09803008
098040              MOVE '7731-FETCH-PREPACK-ITEM-CSR'                  09804008
098050                                 TO DP013-PARAGRAPH               09805008
098060              MOVE 'UNSUCCESSFUL FETCH PACK SLIP LINE CURSOR'     09806008
098070                                 TO DP013-MESSAGE-TEXT (1)        09807008
098080              MOVE ASC-KEY-PO-NBR                                 09808008
098090                                 TO PV-MSG-KEY-PO                 09809008
098100              MOVE ASC-KEY-REC-SEQ-NBR                            09810008
098110                                 TO PV-MSG-KEY-REC-SEQ-NBR-N      09811008
098120              MOVE PV-MSG-KEYS   TO DP013-MESSAGE-TEXT (2)        09812008
098130              MOVE SQLCA         TO DP013-SQLCA                   09813008
098140              MOVE 'TPKITEM'     TO DP013-DB2-TABLE-NAME (1)      09814008
098150              MOVE 'TPURITM'     TO DP013-DB2-TABLE-NAME (2)      09815008
098160              SET DP013-DB2-ABEND                                 09816008
098170                  DP013-XCTL-DISPLAY-RESTART                      09817008
098180                                 TO TRUE                          09818008
098190                                                                  09819008
098200              PERFORM DP013-0000-PROCESS-ABEND                    09820008
098210     END-EVALUATE.                                                09821008
098220                                                                  09822008
098230 7732-CLOSE-PRPK-PKSLIP-ITM-CSR.                                  09823008
098240                                                                  09824008
098250         EXEC SQL                                                 09825008
098260             CLOSE PREPACK-ITEM-CSR                               09826008
098270         END-EXEC                                                 09827008
098280                                                                  09828008
098290         EVALUATE TRUE                                            09829008
098300             WHEN SQLCODE = ZERO                                  09830008
098310                 CONTINUE                                         09831008
098320             WHEN SQLCODE = -904                                  09832008
098330             WHEN SQLCODE = -911                                  09833008
098340             WHEN SQLCODE = -913                                  09834008
098350                  PERFORM 9900-SOFT-ABORT                         09835008
098360                                                                  09836008
098370             WHEN SQLWARN0 NOT = SPACES                           09837008
098380             WHEN SQLCODE  NOT = ZERO                             09838008
098390                  MOVE '7732-CLOSE-PRPK-PKSLIP-ITM-CSR'           09839008
098400                                 TO DP013-PARAGRAPH               09840008
098410                  MOVE 'UNSUCCESSFUL PCSLIP-LINE CURSOR OPEN'     09841008
098420                                 TO DP013-MESSAGE-TEXT (1)        09842008
098430                  MOVE ASC-KEY-PO-NBR                             09843008
098440                                 TO PV-MSG-KEY-PO                 09844008
098450                  MOVE ASC-KEY-REC-SEQ-NBR                        09845008
098460                                 TO PV-MSG-KEY-REC-SEQ-NBR-N      09846008
098470                  MOVE PV-MSG-KEYS                                09847008
098480                                 TO DP013-MESSAGE-TEXT (2)        09848008
098490                  MOVE SQLCA TO DP013-SQLCA                       09849008
098500                  MOVE 'TPKITEM' TO DP013-DB2-TABLE-NAME (1)      09850008
098510                  MOVE 'TPURITM' TO DP013-DB2-TABLE-NAME (2)      09851008
098520                  SET DP013-XCTL-DISPLAY-RESTART                  09852008
098530                      DP013-DB2-ABEND                             09853008
098540                                 TO TRUE                          09854008
098550                                                                  09855008
098560                  PERFORM DP013-0000-PROCESS-ABEND                09856008
098570         END-EVALUATE.                                            09857008
098580/                                                                 09858008
098590 7735-SELECT-TPOPRPK.                                             09859008
098600     INITIALIZE POPRPK-INPK-UNT-QTY                               09860008
098610                POPRPK-OTPK-UNT-QTY                               09861008
098620                                                                  09862008
098630     EXEC SQL                                                     09863008
098640         SELECT                                                   09864008
098650             INPK_UNT_QTY                                         09865008
098660         ,   OTPK_UNT_QTY                                         09866008
098670         INTO                                                     09867008
098680             :POPRPK-INPK-UNT-QTY                                 09868008
098690         ,   :POPRPK-OTPK-UNT-QTY                                 09869008
098700         FROM TPOPRPK                                             09870008
098710         WHERE PO_NBR              = :DK-PO-NBR                   09871008
098720             AND PO_PREPK_ID       = :DK-PREPK-ID                 09872008
098730     END-EXEC                                                     09873008
098740                                                                  09874008
098750     EVALUATE TRUE                                                09875008
098760         WHEN SQLCODE = ZERO                                      09876008
098770         WHEN SQLCODE = +100                                      09877008
098780             CONTINUE                                             09878008
098790         WHEN SQLCODE = -904                                      09879008
098800         WHEN SQLCODE = -911                                      09880008
098810         WHEN SQLCODE = -913                                      09881008
098820             PERFORM 9900-SOFT-ABORT                              09882008
098830                                                                  09883008
098840         WHEN SQLWARN0 NOT = SPACES                               09884008
098850         WHEN SQLCODE  NOT = ZERO                                 09885008
098860             MOVE '7735-SELECT-TPOPRPK'                           09886008
098870                                      TO DP013-PARAGRAPH          09887008
098880             MOVE 'UNSUCCESSFUL SELECT OF TPOPRPK'                09888008
098890                                      TO DP013-MESSAGE-TEXT (1)   09889008
098900             MOVE ASC-KEY-PO-NBR      TO PV-MSG-KEY-PO            09890008
098910             MOVE PV-MSG-KEYS         TO DP013-MESSAGE-TEXT (2)   09891008
098920             MOVE SQLCA               TO DP013-SQLCA              09892008
098930             MOVE 'TPOPRPK'           TO DP013-DB2-TABLE-NAME (1) 09893008
098940             SET DP013-DB2-ABEND                                  09894008
098950                      DP013-XCTL-DISPLAY-RESTART                  09895008
098960                                      TO TRUE                     09896008
098970             PERFORM DP013-0000-PROCESS-ABEND                     09897008
098980     END-EVALUATE.                                                09898008
098990                                                                  09899008
099000 7800-SELECT-RECITM.                                              09900008
099010     MOVE '7800-SELECT-RECITM'   TO PV-LAST-PARAGRAPH.            09901008
099020                                                                  09902008
099030     MOVE ASC-KEY-OPER-UNT-ID    TO DK-OPER-UNT-ID.               09903008
099040     MOVE ASC-KEY-FCLTY-ID       TO DK-FCLTY-ID.                  09904008
099050                                                                  09905008
099060         EXEC SQL                                                 09906008
099070             SELECT ORD_NBR,                                      09907008
099080                    ORD_LNE_NBR,                                  09908008
099090                    REC_SEQ_NBR,                                  09909008
099100                    OPER_UNT_ID,                                  09910008
099110                    FCLTY_ID,                                     09911008
099120                    CRE_TMST,                                     09912008
099130                    CRE_UID,                                      09913008
099140                    PO_VER_NBR,                                   09914008
099150                    ITM_NBR,                                      09915008
099160                    PRE_TKT_IND,                                  09916008
099170                    TKT_FMT_ID,                                   09917008
099180                    RTV_IND,                                      09918008
099190                    STATUS_CDE,                                   09919008
099200                    VER_STATUS_CDE,                               09920008
099210                    PKSL_ITM_QTY,                                 09921008
099220                    DTL_CK_ITM_QTY,                               09922008
099230                    INNR_PACK_QTY,                                09923008
099240                    CASE_PACK_QTY,                                09924008
099250                    RTV_QTY,                                      09925008
099260                    EXPTED_CART_CNT,                              09926008
099270                    ACTL_CART_CNT,                                09927008
099280                    MKING_APRON_TMST,                             09928008
099290                    UNT_COST_AMT,                                 09929008
099300                    COLOR_DESC,                                   09930008
099310                    SIZE_DESC,                                    09931008
099320                    VEND_STYL_NAME,                               09932008
099330                    VEND_DESC,                                    09933008
099340                    VERFYD_TMST,                                  09934008
099350                    PKSL_NBR,                                     09935008
099360                    REC_INV_LNE_NBR,                              09936008
099370                    DMG_ITM_QTY,                                  09937008
099380                    UPD_TMST,                                     09938008
099390                    UPD_UID,                                      09939008
099400                    UPD_PGM_ID,                                   09940008
099410                    RCPT_DISTR_UPD_CDE,                           09941008
099420                    VRFD_USR_ID,                                  09942008
099430                    LAST_TRSCP_TMST,                              09943008
099440                    LAST_TRSCP_USR_ID                             09944008
099450             ,    PREPK_ID                                        09945008
099460             ,    PREPK_RATO_QTY                                  09946008
099470             ,    PREPK_ODD_UNT_QTY                               09947008
099480             ,    PREPK_DRV_LNE_CDE                               09948008
099490              INTO  :RECITM-ORD-NBR,                              09949008
099500                    :RECITM-ORD-LNE-NBR,                          09950008
099510                    :RECITM-REC-SEQ-NBR,                          09951008
099520                    :RECITM-OPER-UNT-ID,                          09952008
099530                    :RECITM-FCLTY-ID,                             09953008
099540                    :RECITM-CRE-TMST,                             09954008
099550                    :RECITM-CRE-UID,                              09955008
099560                    :RECITM-PO-VER-NBR,                           09956008
099570                    :RECITM-ITM-NBR,                              09957008
099580                    :RECITM-PRE-TKT-IND,                          09958008
099590                    :RECITM-TKT-FMT-ID,                           09959008
099600                    :RECITM-RTV-IND,                              09960008
099610                    :RECITM-STATUS-CDE,                           09961008
099620                    :RECITM-VER-STATUS-CDE,                       09962008
099630                    :RECITM-PKSL-ITM-QTY,                         09963008
099640                    :RECITM-DTL-CK-ITM-QTY,                       09964008
099650                    :RECITM-INNR-PACK-QTY,                        09965008
099660                    :RECITM-CASE-PACK-QTY,                        09966008
099670                    :RECITM-RTV-QTY,                              09967008
099680                    :RECITM-EXPTED-CART-CNT,                      09968008
099690                    :RECITM-ACTL-CART-CNT,                        09969008
099700                    :RECITM-MKING-APRON-TMST,                     09970008
099710                    :RECITM-UNT-COST-AMT,                         09971008
099720                    :RECITM-COLOR-DESC,                           09972008
099730                    :RECITM-SIZE-DESC,                            09973008
099740                    :RECITM-VEND-STYL-NAME,                       09974008
099750                    :RECITM-VEND-DESC,                            09975008
099760                    :RECITM-VERFYD-TMST,                          09976008
099770                    :RECITM-PKSL-NBR,                             09977008
099780                    :RECITM-REC-INV-LNE-NBR,                      09978008
099790                    :RECITM-DMG-ITM-QTY,                          09979008
099800                    :RECITM-UPD-TMST,                             09980008
099810                    :RECITM-UPD-UID,                              09981008
099820                    :RECITM-UPD-PGM-ID,                           09982008
099830                    :RECITM-RCPT-DISTR-UPD-CDE,                   09983008
099840                    :RECITM-VRFD-USR-ID,                          09984008
099850                    :RECITM-LAST-TRSCP-TMST,                      09985008
099860                    :RECITM-LAST-TRSCP-USR-ID                     09986008
099870                  , :RECITM-PREPK-ID                              09987008
099880                  , :RECITM-PREPK-RATO-QTY                        09988008
099890                  , :RECITM-PREPK-ODD-UNT-QTY                     09989008
099900                  , :RECITM-PREPK-DRV-LNE-CDE                     09990008
099910               FROM TRECITM                                       09991008
099920              WHERE ORD_NBR        = :DK-PO-NBR                   09992008
099930                AND ORD_LNE_NBR    = :RECITM-ORD-LNE-NBR          09993008
099940                AND REC_SEQ_NBR    = :DK-REC-SEQ-NBR              09994008
099950                AND OPER_UNT_ID    = :DK-OPER-UNT-ID              09995008
099960                AND FCLTY_ID       = :DK-FCLTY-ID                 09996008
099970                AND (VER_STATUS_CDE = 'A'                         09997008
099980                OR   VER_STATUS_CDE = 'I')                        09998008
099990         END-EXEC                                                 09999008
100000                                                                  10000008
100010         EVALUATE TRUE                                            10001008
100020             WHEN SQLCODE = ZERO                                  10002008
100030                 IF RECITM-VER-STATUS-CDE = 'A'                   10003008
100040                      SET PS-RECITM-FOUND                         10004008
100050                                     TO TRUE                      10005008
100060                 ELSE                                             10006008
100070                      SET PS-IN-RECITM-FOUND                      10007008
100080                                     TO TRUE                      10008008
100090                 END-IF                                           10009008
100100             WHEN SQLCODE = +100                                  10010008
100110                  SET PS-RECITM-NOT-FOUND                         10011008
100120                                 TO TRUE                          10012008
100130             WHEN SQLCODE = -904                                  10013008
100140             WHEN SQLCODE = -911                                  10014008
100150             WHEN SQLCODE = -913                                  10015008
100160                  PERFORM 9900-SOFT-ABORT                         10016008
100170                                                                  10017008
100180             WHEN SQLWARN0 NOT = SPACES                           10018008
100190             WHEN SQLCODE  NOT = ZERO                             10019008
100200                  MOVE '7800-SELECT-RECITM'                       10020008
100210                                 TO DP013-PARAGRAPH               10021008
100220                  MOVE 'UNSUCCESSFUL SELECT OF TRECITM'           10022008
100230                                 TO DP013-MESSAGE-TEXT (1)        10023008
100240                  MOVE ASC-KEY-PO-NBR                             10024008
100250                                 TO PV-MSG-KEY-PO                 10025008
100260                  MOVE DK-REC-SEQ-NBR                             10026008
100270                                 TO PV-MSG-KEY-REC-SEQ-NBR-N      10027008
100280                  MOVE RECITM-ORD-LNE-NBR                         10028008
100290                                 TO PV-MSG-KEY-PO-LNE-NBR-N       10029008
100300                  MOVE PV-MSG-KEYS                                10030008
100310                                 TO DP013-MESSAGE-TEXT (2)        10031008
100320                  MOVE SQLCA     TO DP013-SQLCA                   10032008
100330                  MOVE 'TRECITM' TO DP013-DB2-TABLE-NAME (1)      10033008
100340                  SET DP013-DB2-ABEND                             10034008
100350                      DP013-XCTL-DISPLAY-RESTART                  10035008
100360                                 TO TRUE                          10036008
100370                  PERFORM DP013-0000-PROCESS-ABEND                10037008
100380         END-EVALUATE.                                            10038008
100390                                                                  10039008
100400 7805-SET-CURR-RECITM-TO-ACT.                                     10040008
100410                                                                  10041008
100420*TCR  AUTOVE                                                      10042008
100430         SET PS-ORIG-ASN-PKSLIP-NO   TO TRUE.                     10043008
100440         PERFORM 8400-CHECK-ASN.                                  10044008
100450         MOVE 0 TO PV-ORIG-PKSL-ITM-QTY.                          10045008
100460         IF PS-ORIG-ASN-PKSLIP-YES                                10046008
100470            MOVE RECITM-PKSL-ITM-QTY TO PV-ORIG-PKSL-ITM-QTY      10047008
100480         END-IF.                                                  10048008
100490*TCR  AUTOVE                                                      10049008
100500                                                                  10050008
100510         EXEC SQL                                                 10051008
100520           UPDATE TRECITM                                         10052008
100530              SET VER_STATUS_CDE    = 'A'                         10053008
100540                , PKSL_ITM_QTY      = :RECITM-PKSL-ITM-QTY        10054008
100550                , ORIG_PKSL_ITM_QTY = :PV-ORIG-PKSL-ITM-QTY       10055008
100560                , LAST_TRSCP_TMST   = CURRENT TIMESTAMP           10056008
100570                , LAST_TRSCP_USR_ID = :DP020-USERID               10057008
100580                , PO_VER_NBR        = :RECITM-PO-VER-NBR          10058008
100590                , ITM_NBR           = :RECITM-ITM-NBR             10059008
100600                , CASE_PACK_QTY     = :RECITM-CASE-PACK-QTY       10060008
100610                , PREPK_ID          = :RECITM-PREPK-ID            10061008
100620                , PREPK_RATO_QTY    = :RECITM-PREPK-RATO-QTY      10062008
100630                , PREPK_ODD_UNT_QTY = :RECITM-PREPK-ODD-UNT-QTY   10063008
100640                , PREPK_DRV_LNE_CDE = :RECITM-PREPK-DRV-LNE-CDE   10064008
100650                , UNT_RTL_AMT       = :RECITM-UNT-RTL-AMT         10065008
100660                , UNT_COST_AMT      = :RECITM-UNT-COST-AMT        10066008
100670                , GP_RTL_AMT        = :RECITM-GP-RTL-AMT          10067008
100680                , GP_QTY            = :RECITM-GP-QTY              10068008
100690            WHERE ORD_NBR           = :DK-PO-NBR                  10069008
100700              AND ORD_LNE_NBR       = :RECITM-ORD-LNE-NBR         10070008
100710              AND REC_SEQ_NBR       = :DK-REC-SEQ-NBR             10071008
100720              AND OPER_UNT_ID       = :DK-OPER-UNT-ID             10072008
100730              AND FCLTY_ID          = :DK-FCLTY-ID                10073008
100740              AND VER_STATUS_CDE    = 'I'                         10074008
100750         END-EXEC.                                                10075008
100760                                                                  10076008
100770         EVALUATE TRUE                                            10077008
100780             WHEN SQLCODE = ZERO                                  10078008
100790             WHEN SQLCODE = +100                                  10079008
100800                  CONTINUE                                        10080008
100810             WHEN SQLCODE = -904                                  10081008
100820             WHEN SQLCODE = -911                                  10082008
100830             WHEN SQLCODE = -913                                  10083008
100840                  PERFORM 9900-SOFT-ABORT                         10084008
100850                                                                  10085008
100860             WHEN SQLWARN0 NOT = SPACES                           10086008
100870             WHEN SQLCODE  NOT = ZERO                             10087008
100880                  MOVE '7805-SET-CURR-RECITM-TO-ACT'              10088008
100890                                 TO DP013-PARAGRAPH               10089008
100900                  MOVE 'UNSUCCESSFUL UPDATE OF TRECITM'           10090008
100910                                 TO DP013-MESSAGE-TEXT (1)        10091008
100920                  MOVE ASC-KEY-PO-NBR                             10092008
100930                                 TO PV-MSG-KEY-PO                 10093008
100940                  MOVE DK-REC-SEQ-NBR                             10094008
100950                                 TO PV-MSG-KEY-REC-SEQ-NBR-N      10095008
100960                  MOVE RECITM-ORD-LNE-NBR                         10096008
100970                                 TO PV-MSG-KEY-PO-LNE-NBR-N       10097008
100980                  MOVE PV-MSG-KEYS                                10098008
100990                                 TO DP013-MESSAGE-TEXT (2)        10099008
101000                  MOVE SQLCA     TO DP013-SQLCA                   10100008
101010                  MOVE 'TRECITM' TO DP013-DB2-TABLE-NAME (1)      10101008
101020                  SET DP013-DB2-ABEND                             10102008
101030                      DP013-XCTL-DISPLAY-RESTART                  10103008
101040                                 TO TRUE                          10104008
101050                  PERFORM DP013-0000-PROCESS-ABEND                10105008
101060         END-EVALUATE.                                            10106008
101070                                                                  10107008
101080 7810-SET-CURR-RECITM-TO-INACT.                                   10108008
101090                                                                  10109008
101100         EXEC SQL                                                 10110008
101110           UPDATE TRECITM                                         10111008
101120              SET VER_STATUS_CDE    = 'I'                         10112008
101130                , PKSL_ITM_QTY      = :RECITM-PKSL-ITM-QTY        10113008
101140                , DTL_CK_ITM_QTY    = 0                           10114008
101150                , CASE_PACK_QTY     = 0                           10115008
101160                , PREPK_ID          = 0                           10116008
101170                , PREPK_RATO_QTY    = 0                           10117008
101180                , PREPK_ODD_UNT_QTY = 0                           10118008
101190                , PREPK_DRV_LNE_CDE = ' '                         10119008
101200            WHERE ORD_NBR        = :DK-PO-NBR                     10120008
101210              AND ORD_LNE_NBR    = :RECITM-ORD-LNE-NBR            10121008
101220              AND REC_SEQ_NBR    = :DK-REC-SEQ-NBR                10122008
101230              AND OPER_UNT_ID    = :DK-OPER-UNT-ID                10123008
101240              AND FCLTY_ID       = :DK-FCLTY-ID                   10124008
101250              AND VER_STATUS_CDE = 'A'                            10125008
101260         END-EXEC                                                 10126008
101270                                                                  10127008
101280         EVALUATE TRUE                                            10128008
101290             WHEN SQLCODE = ZERO                                  10129008
101300             WHEN SQLCODE = +100                                  10130008
101310                                                                  10131008
101320                 PERFORM 7811-COUNT-TRECDIS-FOR-LINE              10132008
101330                 IF PV-RECDIS-COUNT > ZERO                        10133008
101340                     PERFORM 7812-OPEN-TRECDIS-CURSOR             10134008
101350                     PERFORM 7813-FETCH-TRECDIS                   10135008
101360                     PERFORM UNTIL PS-EOF-RECDIS-CSR              10136008
101370                         PERFORM 7814-DELETE-TRECDIS-CSR          10137008
101380                         SET PS-7814-DELETE TO TRUE               10138008
101390                         PERFORM 7640-DELETE-ODD-UNIT             10139008
101400                         PERFORM 7813-FETCH-TRECDIS               10140008
101410                     END-PERFORM                                  10141008
101420                 PERFORM 7812A-CLOSE-TRECDIS-CURSOR               10142008
101430                 END-IF                                           10143008
101440                                                                  10144008
101450             WHEN SQLCODE = -904                                  10145008
101460             WHEN SQLCODE = -911                                  10146008
101470             WHEN SQLCODE = -913                                  10147008
101480                  PERFORM 9900-SOFT-ABORT                         10148008
101490                                                                  10149008
101500             WHEN SQLWARN0 NOT = SPACES                           10150008
101510             WHEN SQLCODE  NOT = ZERO                             10151008
101520                  MOVE '7810-SET-CURR-RECITM-TO-INACT'            10152008
101530                                 TO DP013-PARAGRAPH               10153008
101540                  MOVE 'UNSUCCESSFUL UPDATE OF TRECITM'           10154008
101550                                 TO DP013-MESSAGE-TEXT (1)        10155008
101560                  MOVE ASC-KEY-PO-NBR                             10156008
101570                                 TO PV-MSG-KEY-PO                 10157008
101580                  MOVE DK-REC-SEQ-NBR                             10158008
101590                                 TO PV-MSG-KEY-REC-SEQ-NBR-N      10159008
101600                  MOVE RECITM-ORD-LNE-NBR                         10160008
101610                                 TO PV-MSG-KEY-PO-LNE-NBR-N       10161008
101620                  MOVE PV-MSG-KEYS                                10162008
101630                                 TO DP013-MESSAGE-TEXT (2)        10163008
101640                  MOVE SQLCA     TO DP013-SQLCA                   10164008
101650                  MOVE 'TRECITM' TO DP013-DB2-TABLE-NAME (1)      10165008
101660                  SET DP013-DB2-ABEND                             10166008
101670                      DP013-XCTL-DISPLAY-RESTART                  10167008
101680                                 TO TRUE                          10168008
101690                  PERFORM DP013-0000-PROCESS-ABEND                10169008
101700         END-EVALUATE.                                            10170008
101710                                                                  10171008
101720 7811-COUNT-TRECDIS-FOR-LINE.                                     10172008
101730     EXEC SQL                                                     10173008
101740         SELECT                                                   10174008
101750             COUNT (*)                                            10175008
101760         INTO :PV-RECDIS-COUNT                                    10176008
101770         FROM TRECDIS                                             10177008
101780            WHERE ORD_NBR        = :DK-PO-NBR                     10178008
101790              AND ORD_LNE_NBR    = :RECITM-ORD-LNE-NBR            10179008
101800              AND REC_SEQ_NBR    = :DK-REC-SEQ-NBR                10180008
101810              AND OPER_UNT_ID    = :DK-OPER-UNT-ID                10181008
101820              AND FCLTY_ID       = :DK-FCLTY-ID                   10182008
101830     END-EXEC.                                                    10183008
101840                                                                  10184008
101850     EVALUATE TRUE                                                10185008
101860         WHEN SQLCODE = ZERO                                      10186008
101870         WHEN SQLCODE = +100                                      10187008
101880              CONTINUE                                            10188008
101890         WHEN SQLCODE = -904                                      10189008
101900         WHEN SQLCODE = -911                                      10190008
101910         WHEN SQLCODE = -913                                      10191008
101920              PERFORM 9900-SOFT-ABORT                             10192008
101930                                                                  10193008
101940         WHEN SQLWARN0 NOT = SPACES                               10194008
101950         WHEN SQLCODE  NOT = ZERO                                 10195008
101960              MOVE '7811-COUNT-TRECDIS-FOR-LINE'                  10196008
101970                                 TO DP013-PARAGRAPH               10197008
101980              MOVE 'UNSUCCESSFUL FETCH TRECDIS CURSOR'            10198008
101990                                 TO DP013-MESSAGE-TEXT (1)        10199008
102000              MOVE ASC-KEY-PO-NBR                                 10200008
102010                                 TO PV-MSG-KEY-PO                 10201008
102020              MOVE ASC-KEY-REC-SEQ-NBR                            10202008
102030                                 TO PV-MSG-KEY-REC-SEQ-NBR-N      10203008
102040              MOVE PV-MSG-KEYS   TO DP013-MESSAGE-TEXT (2)        10204008
102050              MOVE SQLCA         TO DP013-SQLCA                   10205008
102060              MOVE 'TRECDIS'     TO DP013-DB2-TABLE-NAME (1)      10206008
102070              SET DP013-DB2-ABEND                                 10207008
102080                  DP013-XCTL-DISPLAY-RESTART                      10208008
102090                                 TO TRUE                          10209008
102100              PERFORM DP013-0000-PROCESS-ABEND                    10210008
102110     END-EVALUATE.                                                10211008
102120                                                                  10212008
102130                                                                  10213008
102140 7812-OPEN-TRECDIS-CURSOR.                                        10214008
102150     EXEC SQL                                                     10215008
102160         OPEN RECDIS-CSR                                          10216008
102170     END-EXEC.                                                    10217008
102180                                                                  10218008
102190     EVALUATE TRUE                                                10219008
102200         WHEN SQLCODE = ZERO                                      10220008
102210             SET PS-NOT-EOF-RECDIS-CSR                            10221008
102220                             TO TRUE                              10222008
102230         WHEN SQLCODE = -904                                      10223008
102240         WHEN SQLCODE = -911                                      10224008
102250         WHEN SQLCODE = -913                                      10225008
102260              PERFORM 9900-SOFT-ABORT                             10226008
102270                                                                  10227008
102280         WHEN SQLWARN0 NOT = SPACES                               10228008
102290         WHEN SQLCODE  NOT = ZERO                                 10229008
102300             MOVE '7812-OPEN-TRECDIS-CURSOR'                      10230008
102310                                 TO DP013-PARAGRAPH               10231008
102320             MOVE 'UNSUCCESSFUL RECDIS-CSR CURSOR OPEN'           10232008
102330                                 TO DP013-MESSAGE-TEXT (1)        10233008
102340             MOVE ASC-KEY-PO-NBR                                  10234008
102350                                 TO PV-MSG-KEY-PO                 10235008
102360             MOVE ASC-KEY-REC-SEQ-NBR                             10236008
102370                                 TO PV-MSG-KEY-REC-SEQ-NBR-N      10237008
102380             MOVE PV-MSG-KEYS                                     10238008
102390                                 TO DP013-MESSAGE-TEXT (2)        10239008
102400             MOVE SQLCA TO DP013-SQLCA                            10240008
102410             MOVE 'TRECDIS' TO DP013-DB2-TABLE-NAME (1)           10241008
102420             SET DP013-XCTL-DISPLAY-RESTART                       10242008
102430                 DP013-DB2-ABEND TO TRUE                          10243008
102440             PERFORM DP013-0000-PROCESS-ABEND                     10244008
102450         END-EVALUATE.                                            10245008
102460                                                                  10246008
102470 7812A-CLOSE-TRECDIS-CURSOR.                                      10247008
102480     EXEC SQL                                                     10248008
102490         CLOSE RECDIS-CSR                                         10249008
102500     END-EXEC.                                                    10250008
102510                                                                  10251008
102520     EVALUATE TRUE                                                10252008
102530         WHEN SQLCODE = ZERO                                      10253008
102540             CONTINUE                                             10254008
102550         WHEN SQLCODE = -904                                      10255008
102560         WHEN SQLCODE = -911                                      10256008
102570         WHEN SQLCODE = -913                                      10257008
102580              PERFORM 9900-SOFT-ABORT                             10258008
102590                                                                  10259008
102600         WHEN SQLWARN0 NOT = SPACES                               10260008
102610         WHEN SQLCODE  NOT = ZERO                                 10261008
102620             MOVE '7812A-CLOSE-TRECDIS-CURSOR'                    10262008
102630                                 TO DP013-PARAGRAPH               10263008
102640             MOVE 'UNSUCCESSFUL RECDIS-CSR CURSOR CLOSE'          10264008
102650                                 TO DP013-MESSAGE-TEXT (1)        10265008
102660             MOVE ASC-KEY-PO-NBR                                  10266008
102670                                 TO PV-MSG-KEY-PO                 10267008
102680             MOVE ASC-KEY-REC-SEQ-NBR                             10268008
102690                                 TO PV-MSG-KEY-REC-SEQ-NBR-N      10269008
102700             MOVE PV-MSG-KEYS                                     10270008
102710                                 TO DP013-MESSAGE-TEXT (2)        10271008
102720             MOVE SQLCA TO DP013-SQLCA                            10272008
102730             MOVE 'TRECDIS' TO DP013-DB2-TABLE-NAME (1)           10273008
102740             SET DP013-XCTL-DISPLAY-RESTART                       10274008
102750                 DP013-DB2-ABEND TO TRUE                          10275008
102760             PERFORM DP013-0000-PROCESS-ABEND                     10276008
102770         END-EVALUATE.                                            10277008
102780                                                                  10278008
102790 7813-FETCH-TRECDIS.                                              10279008
102800     EXEC SQL                                                     10280008
102810         FETCH RECDIS-CSR                                         10281008
102820     INTO                                                         10282008
102830         :RECDIS-STR-NBR                                          10283008
102840     END-EXEC.                                                    10284008
102850                                                                  10285008
102860     EVALUATE TRUE                                                10286008
102870         WHEN SQLCODE = ZERO                                      10287008
102880              CONTINUE                                            10288008
102890         WHEN SQLCODE = +100                                      10289008
102900             SET PS-EOF-RECDIS-CSR TO TRUE                        10290008
102910         WHEN SQLCODE = -904                                      10291008
102920         WHEN SQLCODE = -911                                      10292008
102930         WHEN SQLCODE = -913                                      10293008
102940              PERFORM 9900-SOFT-ABORT                             10294008
102950                                                                  10295008
102960         WHEN SQLWARN0 NOT = SPACES                               10296008
102970         WHEN SQLCODE  NOT = ZERO                                 10297008
102980              MOVE '7813-FETCH-TRECDIS'                           10298008
102990                                 TO DP013-PARAGRAPH               10299008
103000              MOVE 'UNSUCCESSFUL FETCH TRECDIS CURSOR'            10300008
103010                                 TO DP013-MESSAGE-TEXT (1)        10301008
103020              MOVE ASC-KEY-PO-NBR                                 10302008
103030                                 TO PV-MSG-KEY-PO                 10303008
103040              MOVE ASC-KEY-REC-SEQ-NBR                            10304008
103050                                 TO PV-MSG-KEY-REC-SEQ-NBR-N      10305008
103060              MOVE PV-MSG-KEYS   TO DP013-MESSAGE-TEXT (2)        10306008
103070              MOVE SQLCA         TO DP013-SQLCA                   10307008
103080              MOVE 'TRECDIS'     TO DP013-DB2-TABLE-NAME (1)      10308008
103090              SET DP013-DB2-ABEND                                 10309008
103100                  DP013-XCTL-DISPLAY-RESTART                      10310008
103110                                 TO TRUE                          10311008
103120              PERFORM DP013-0000-PROCESS-ABEND                    10312008
103130     END-EVALUATE.                                                10313008
103140                                                                  10314008
103150 7814-DELETE-TRECDIS-CSR.                                         10315008
103160     EXEC SQL                                                     10316008
103170         DELETE                                                   10317008
103180         FROM TRECDIS                                             10318008
103190         WHERE CURRENT OF RECDIS-CSR                              10319008
103200     END-EXEC.                                                    10320008
103210                                                                  10321008
103220     EVALUATE TRUE                                                10322008
103230         WHEN SQLCODE = ZERO                                      10323008
103240         WHEN SQLCODE = +100                                      10324008
103250              CONTINUE                                            10325008
103260         WHEN SQLCODE = -904                                      10326008
103270         WHEN SQLCODE = -911                                      10327008
103280         WHEN SQLCODE = -913                                      10328008
103290              PERFORM 9900-SOFT-ABORT                             10329008
103300                                                                  10330008
103310         WHEN SQLWARN0 NOT = SPACES                               10331008
103320         WHEN SQLCODE  NOT = ZERO                                 10332008
103330              MOVE '7814-DELETE-TRECDIS-CSR'                      10333008
103340                             TO DP013-PARAGRAPH                   10334008
103350              MOVE 'UNSUCCESSFUL DELETE OF TRECDIS'               10335008
103360                             TO DP013-MESSAGE-TEXT (1)            10336008
103370              MOVE DK-PO-NBR                                      10337008
103380                             TO PV-MSG-KEY-PO                     10338008
103390              MOVE DK-REC-SEQ-NBR                                 10339008
103400                             TO PV-MSG-KEY-REC-SEQ-NBR-N          10340008
103410              MOVE RECDIS-ORD-LNE-NBR                             10341008
103420                             TO PV-MSG-KEY-PO-LNE-NBR-N           10342008
103430              MOVE PV-MSG-KEYS                                    10343008
103440                             TO DP013-MESSAGE-TEXT (2)            10344008
103450              MOVE SQLCA     TO DP013-SQLCA                       10345008
103460              MOVE 'TRECDIS' TO DP013-DB2-TABLE-NAME (1)          10346008
103470              SET DP013-DB2-ABEND                                 10347008
103480                  DP013-XCTL-DISPLAY-RESTART                      10348008
103490                             TO TRUE                              10349008
103500              PERFORM DP013-0000-PROCESS-ABEND                    10350008
103510     END-EVALUATE.                                                10351008
103520                                                                  10352008
103530                                                                  10353008
103540 7815-UPDATE-RECITM-QTY.                                          10354008
103550                                                                  10355008
103560         EXEC SQL                                                 10356008
103570           UPDATE TRECITM                                         10357008
103580              SET PKSL_ITM_QTY   = :RECITM-PKSL-ITM-QTY,          10358008
103590                  PO_VER_NBR     = :RECITM-PO-VER-NBR,            10359008
103600                  ITM_NBR        = :RECITM-ITM-NBR                10360008
103610             ,    CASE_PACK_QTY     = :RECITM-CASE-PACK-QTY       10361008
103620             ,    PREPK_ID          = :RECITM-PREPK-ID            10362008
103630             ,    PREPK_RATO_QTY    = :RECITM-PREPK-RATO-QTY      10363008
103640             ,    PREPK_ODD_UNT_QTY = :RECITM-PREPK-ODD-UNT-QTY   10364008
103650             ,    PREPK_DRV_LNE_CDE = :RECITM-PREPK-DRV-LNE-CDE   10365008
103660            WHERE ORD_NBR        = :DK-PO-NBR                     10366008
103670              AND ORD_LNE_NBR    = :RECITM-ORD-LNE-NBR            10367008
103680              AND REC_SEQ_NBR    = :DK-REC-SEQ-NBR                10368008
103690              AND OPER_UNT_ID    = :DK-OPER-UNT-ID                10369008
103700              AND FCLTY_ID       = :DK-FCLTY-ID                   10370008
103710              AND VER_STATUS_CDE = 'A'                            10371008
103720         END-EXEC                                                 10372008
103730                                                                  10373008
103740         EVALUATE TRUE                                            10374008
103750             WHEN SQLCODE = ZERO                                  10375008
103760             WHEN SQLCODE = +100                                  10376008
103770                  CONTINUE                                        10377008
103780             WHEN SQLCODE = -904                                  10378008
103790             WHEN SQLCODE = -911                                  10379008
103800             WHEN SQLCODE = -913                                  10380008
103810                  PERFORM 9900-SOFT-ABORT                         10381008
103820                                                                  10382008
103830             WHEN SQLWARN0 NOT = SPACES                           10383008
103840             WHEN SQLCODE  NOT = ZERO                             10384008
103850                  MOVE '7815-UPDATE-RECITM-QTY'                   10385008
103860                                 TO DP013-PARAGRAPH               10386008
103870                  MOVE 'UNSUCCESSFUL UPDATE OF TRECITM'           10387008
103880                                 TO DP013-MESSAGE-TEXT (1)        10388008
103890                  MOVE ASC-KEY-PO-NBR                             10389008
103900                                 TO PV-MSG-KEY-PO                 10390008
103910                  MOVE DK-REC-SEQ-NBR                             10391008
103920                                 TO PV-MSG-KEY-REC-SEQ-NBR-N      10392008
103930                  MOVE RECITM-ORD-LNE-NBR                         10393008
103940                                 TO PV-MSG-KEY-PO-LNE-NBR-N       10394008
103950                  MOVE PV-MSG-KEYS                                10395008
103960                                 TO DP013-MESSAGE-TEXT (2)        10396008
103970                  MOVE SQLCA     TO DP013-SQLCA                   10397008
103980                  MOVE 'TRECITM' TO DP013-DB2-TABLE-NAME (1)      10398008
103990                  SET DP013-DB2-ABEND                             10399008
104000                      DP013-XCTL-DISPLAY-RESTART                  10400008
104010                                 TO TRUE                          10401008
104020                  PERFORM DP013-0000-PROCESS-ABEND                10402008
104030         END-EVALUATE.                                            10403008
104040                                                                  10404008
104050 7820-SETUP-RECITM-FIELDS.                                        10405008
104060                                                                  10406008
104070     MOVE DK-REC-SEQ-NBR         TO RECITM-REC-SEQ-NBR.           10407008
104080     MOVE DK-OPER-UNT-ID         TO RECITM-OPER-UNT-ID.           10408008
104090     MOVE DK-FCLTY-ID            TO RECITM-FCLTY-ID.              10409008
104100                                                                  10410008
104110     IF PS-BULK-SHIPMENT                                          10411008
104120         MOVE PKSLIP-PKSL-NBR    TO RECITM-PKSL-NBR               10412008
104130     END-IF.                                                      10413008
104140                                                                  10414008
104150     MOVE PURITM-VER-NBR         TO RECITM-PO-VER-NBR.            10415008
104160     MOVE PURITM-ITM-NBR         TO RECITM-ITM-NBR.               10416008
104170     MOVE PURITM-UNT-RTL-PR-AMT  TO RECITM-UNT-RTL-AMT            10417008
104180     MOVE PURITM-UNT-COST-AMT    TO RECITM-UNT-COST-AMT           10418008
104190     MOVE PURITM-GP-RTL-AMT      TO RECITM-GP-RTL-AMT             10419008
104200     MOVE PURITM-GP-QTY          TO RECITM-GP-QTY                 10420008
104210     MOVE ASC-KEY-PRE-TKT-IND    TO RECITM-PRE-TKT-IND.           10421008
104220     MOVE ASC-KEY-TKT-FMT-ID     TO RECITM-TKT-FMT-ID.            10422008
104230     MOVE 'IP'                   TO RECITM-STATUS-CDE.            10423008
104240     MOVE ASC-KEY-EXPTED-CART-CNT                                 10424008
104250                                 TO RECITM-EXPTED-CART-CNT.       10425008
104260     MOVE ZERO                   TO RECITM-ACTL-CART-CNT.         10426008
104270     MOVE PC-DEFAULT-TMST        TO RECITM-VERFYD-TMST            10427008
104280                                    RECITM-MKING-APRON-TMST.      10428008
104290     IF RECITM-UPD-TMST = SPACES                                  10429008
104300          MOVE PC-DEFAULT-TMST   TO RECITM-UPD-TMST               10430008
104310     END-IF.                                                      10431008
104320                                                                  10432008
104330     IF ASC-TRECEIV-PKGNG-CDE = 'M' OR 'I'                        10433008
104340         PERFORM  7821-SETUP-RECITM-PREPACK                       10434008
104350     ELSE                                                         10435008
104360         INITIALIZE                   RECITM-PREPK-ID             10436008
104370                                      RECITM-PREPK-DRV-LNE-CDE    10437008
104380                                      RECITM-PREPK-RATO-QTY       10438008
104390                                      RECITM-PREPK-ODD-UNT-QTY    10439008
104400     END-IF.                                                      10440008
104410                                                                  10441008
104420 7821-SETUP-RECITM-PREPACK.                                       10442008
104430                                                                  10443008
104440* CHECK EACH PREPACK GROUP FOR A DRIVER LINE THEN SEND IT OFF     10444008
104450* TO THE TROUBLE ROUTINES WHICH WILL CREATE THE RECDIS FOR        10445008
104460* ALL THE LINE IN THAT PACK.                                      10446008
104470*                                                                 10447008
104480                                                                  10448008
104490         MOVE PWT-M-PREPK-ID (PWT-M-IDX)                          10449008
104500                                      TO RECITM-PREPK-ID          10450008
104510                                                                  10451008
104520         IF PWT-DRIVER-LINE-YES (PWT-M-IDX)                       10452008
104530             MOVE 'A'                 TO RECITM-PREPK-DRV-LNE-CDE 10453008
104540         END-IF                                                   10454008
104550                                                                  10455008
104560         MOVE PWT-M-PREPK-RATIO-QTY (PWT-M-IDX)                   10456008
104570                                      TO RECITM-PREPK-RATO-QTY    10457008
104580         MOVE PWT-M-PREPK-ODD-UNITS (PWT-M-IDX)                   10458008
104590                                      TO RECITM-PREPK-ODD-UNT-QTY 10459008
104600                                                                  10460008
104610     IF POPRPK-INPK-UNT-QTY = ZERO OR                             10461008
104620             POPRPK-INPK-UNT-QTY > POPRPK-OTPK-UNT-QTY            10462008
104630         MOVE 1                       TO RECITM-CASE-PACK-QTY     10463008
104640     ELSE                                                         10464008
104650         DIVIDE POPRPK-OTPK-UNT-QTY BY POPRPK-INPK-UNT-QTY        10465008
104660                 GIVING RECITM-CASE-PACK-QTY                      10466008
104670     END-IF.                                                      10467008
104680/                                                                 10468008
104690                                                                  10469008
104700 7830-INSERT-RECITM.                                              10470008
104710                                                                  10471008
104720     IF RECITM-REC-SEQ-NBR = ZERO                                 10472008
104730         MOVE SPACES                  TO PV-CICS-MSG-AREA         10473008
104740         PERFORM 9903-WRITE-CICS-LOG                              10474008
104750         MOVE ALL '*'                 TO PV-CICS-MSG-AREA         10475008
104760         PERFORM 9903-WRITE-CICS-LOG                              10476008
104770                                                                  10477008
104780         EXEC SQL SET :PV-BOMB-TMST = CURRENT TIMESTAMP END-EXEC  10478008
104790                                                                  10479008
104800         STRING ' RCKCS213 IS WRITING AN INVALID ROW TO RECITM'   10480008
104810                 ' ' PV-BOMB-TMST DELIMITED BY SIZE               10481008
104820                                      INTO PV-CICS-MSG-AREA       10482008
104830                                                                  10483008
104840         PERFORM 9903-WRITE-CICS-LOG                              10484008
104850                                                                  10485008
104860         STRING ' MODIFYING PARA: ' PV-LAST-PARAGRAPH             10486008
104870                 DELIMITED BY SIZE    INTO PV-CICS-MSG-AREA       10487008
104880         PERFORM 9903-WRITE-CICS-LOG                              10488008
104890                                                                  10489008
104900         MOVE PV-FIRST-REC-SEQ-NBR    TO PV-DISPLAY-NUMBER        10490008
104910         STRING ' PV-FIRST-REC-SEQ-NBR: ' PV-DISPLAY-NUMBER       10491008
104920                 DELIMITED BY SIZE    INTO PV-CICS-MSG-AREA       10492008
104930         PERFORM 9903-WRITE-CICS-LOG                              10493008
104940                                                                  10494008
104950         MOVE ASC-KEY-REC-SEQ-NBR     TO PV-DISPLAY-NUMBER        10495008
104960         STRING ' ASC-KEY-REC-SEQ-NBR: ' PV-DISPLAY-NUMBER        10496008
104970                 DELIMITED BY SIZE    INTO PV-CICS-MSG-AREA       10497008
104980         PERFORM 9903-WRITE-CICS-LOG                              10498008
104990                                                                  10499008
105000         MOVE ASC-KEY-PO-NBR          TO PV-MSG-KEY-PO            10500008
105010         MOVE DK-REC-SEQ-NBR          TO PV-MSG-KEY-REC-SEQ-NBR-N 10501008
105020         MOVE RECITM-ORD-LNE-NBR      TO PV-MSG-KEY-PO-LNE-NBR-N  10502008
105030         MOVE PV-MSG-KEYS             TO PV-CICS-MSG-AREA         10503008
105040         PERFORM 9903-WRITE-CICS-LOG                              10504008
105050                                                                  10505008
105060         MOVE DP020-LOCATION-NBR      TO PV-LOCATION-NBR          10506008
105070         STRING ' USER= '              DP020-USERID               10507008
105080                ' LOCATION= '          PV-LOCATION-NBR            10508008
105090                ' NEXT APPL= '         DP020-NEXT-APPL-ACTIVITY   10509008
105100                 DELIMITED BY SIZE                                10510008
105110                                      INTO PV-CICS-MSG-AREA       10511008
105120         PERFORM 9903-WRITE-CICS-LOG                              10512008
105130         PERFORM 9903-WRITE-CICS-LOG                              10513008
105140                                                                  10514008
105150         STRING ' DP020-SRC-TRAN-ID= '  DP020-SRC-TRAN-ID         10515008
105160                ' DP020-SRC-MNEMONIC= ' DP020-SRC-MNEMONIC        10516008
105170                 DELIMITED BY SIZE                                10517008
105180                 INTO PV-CICS-MSG-AREA                            10518008
105190         PERFORM 9903-WRITE-CICS-LOG                              10519008
105200                                                                  10520008
105210         STRING ' DP020-SRC-AID= '      DP020-SRC-AID             10521008
105220                ' DP020-FK-ACTION= '    DP020-FK-ACTION           10522008
105230                                           (DP020-SRC-AID)        10523008
105240                ' DP020-FK-MNEMONIC= '    DP020-FK-MNEMONIC       10524008
105250                                           (DP020-SRC-AID)        10525008
105260                 DELIMITED BY SIZE                                10526008
105270                 INTO PV-CICS-MSG-AREA                            10527008
105280         PERFORM 9903-WRITE-CICS-LOG                              10528008
105290         PERFORM 9903-WRITE-CICS-LOG                              10529008
105300                                                                  10530008
105310         PERFORM VARYING PV-STACK-SUB FROM 1 BY 1                 10531008
105320             UNTIL PV-STACK-SUB > DP020-ENTRIES-IN-STACK          10532008
105330             STRING ' ' DP020-STACK-TRAN-ID (PV-STACK-SUB)        10533008
105340                    '  ' DP020-STACK-MNEMONIC (PV-STACK-SUB)      10534008
105350                    DELIMITED BY SIZE                             10535008
105360                                      INTO PV-CICS-MSG-AREA       10536008
105370             PERFORM 9903-WRITE-CICS-LOG                          10537008
105380         END-PERFORM                                              10538008
105390                                                                  10539008
105400         MOVE ALL '*'                 TO PV-CICS-MSG-AREA         10540008
105410         PERFORM 9903-WRITE-CICS-LOG                              10541008
105420         PERFORM 9903-WRITE-CICS-LOG                              10542008
105430     END-IF.                                                      10543008
105440                                                                  10544008
105450*TCR  AUTOVE                                                      10545008
105460         SET PS-ORIG-ASN-PKSLIP-NO   TO TRUE                      10546008
105470         PERFORM 8400-CHECK-ASN                                   10547008
105480         MOVE 0 TO PV-ORIG-PKSL-ITM-QTY                           10548008
105490         IF PS-ORIG-ASN-PKSLIP-YES                                10549008
105500            MOVE RECITM-PKSL-ITM-QTY TO PV-ORIG-PKSL-ITM-QTY      10550008
105510         END-IF                                                   10551008
105520*TCR  AUTOVE                                                      10552008
105530                                                                  10553008
105540         EXEC SQL                                                 10554008
105550             INSERT INTO TRECITM                                  10555008
105560                   (ORD_NBR,                                      10556008
105570                    ORD_LNE_NBR,                                  10557008
105580                    REC_SEQ_NBR,                                  10558008
105590                    OPER_UNT_ID,                                  10559008
105600                    FCLTY_ID,                                     10560008
105610                    CRE_TMST,                                     10561008
105620                    CRE_UID,                                      10562008
105630                    PO_VER_NBR,                                   10563008
105640                    ITM_NBR,                                      10564008
105650                    PRE_TKT_IND,                                  10565008
105660                    TKT_FMT_ID,                                   10566008
105670                    RTV_IND,                                      10567008
105680                    STATUS_CDE,                                   10568008
105690                    VER_STATUS_CDE,                               10569008
105700                    PKSL_ITM_QTY,                                 10570008
105710                    DTL_CK_ITM_QTY,                               10571008
105720                    INNR_PACK_QTY,                                10572008
105730                    CASE_PACK_QTY,                                10573008
105740                    RTV_QTY,                                      10574008
105750                    EXPTED_CART_CNT,                              10575008
105760                    ACTL_CART_CNT,                                10576008
105770                    MKING_APRON_TMST,                             10577008
105780                    UNT_COST_AMT,                                 10578008
105790                    COLOR_DESC,                                   10579008
105800                    SIZE_DESC,                                    10580008
105810                    VEND_STYL_NAME,                               10581008
105820                    VEND_DESC,                                    10582008
105830                    VERFYD_TMST,                                  10583008
105840                    PKSL_NBR,                                     10584008
105850                    REC_INV_LNE_NBR,                              10585008
105860                    DMG_ITM_QTY,                                  10586008
105870                    UPD_TMST,                                     10587008
105880                    UPD_UID,                                      10588008
105890                    UPD_PGM_ID,                                   10589008
105900                    RCPT_DISTR_UPD_CDE,                           10590008
105910                    LAST_TRSCP_TMST,                              10591008
105920                    LAST_TRSCP_USR_ID                             10592008
105930             ,      PREPK_ID                                      10593008
105940             ,      PREPK_RATO_QTY                                10594008
105950             ,      PREPK_ODD_UNT_QTY                             10595008
105960             ,      PREPK_DRV_LNE_CDE                             10596008
105970             ,      UNT_RTL_AMT                                   10597008
105980             ,      GP_RTL_AMT                                    10598008
105990             ,      GP_QTY                                        10599008
106000             ,      ORIG_PKSL_ITM_QTY                             10600008
106010                 )                                                10601008
106020            VALUES (:DK-PO-NBR,                                   10602008
106030                    :RECITM-ORD-LNE-NBR,                          10603008
106040                    :RECITM-REC-SEQ-NBR,                          10604008
106050                    :RECITM-OPER-UNT-ID,                          10605008
106060                    :RECITM-FCLTY-ID,                             10606008
106070                     CURRENT TIMESTAMP,                           10607008
106080                    :DP020-USERID,                                10608008
106090                    :RECITM-PO-VER-NBR,                           10609008
106100                    :RECITM-ITM-NBR,                              10610008
106110                    :RECITM-PRE-TKT-IND,                          10611008
106120                    :RECITM-TKT-FMT-ID,                           10612008
106130                    :RECITM-RTV-IND,                              10613008
106140                    :RECITM-STATUS-CDE,                           10614008
106150                    :RECITM-VER-STATUS-CDE,                       10615008
106160                    :RECITM-PKSL-ITM-QTY,                         10616008
106170                    :RECITM-DTL-CK-ITM-QTY,                       10617008
106180                    :RECITM-INNR-PACK-QTY,                        10618008
106190                    :RECITM-CASE-PACK-QTY,                        10619008
106200                    :RECITM-RTV-QTY,                              10620008
106210                    :RECITM-EXPTED-CART-CNT,                      10621008
106220                    :RECITM-ACTL-CART-CNT,                        10622008
106230                    :RECITM-MKING-APRON-TMST,                     10623008
106240                    :RECITM-UNT-COST-AMT,                         10624008
106250                    :RECITM-COLOR-DESC,                           10625008
106260                    :RECITM-SIZE-DESC,                            10626008
106270                    :RECITM-VEND-STYL-NAME,                       10627008
106280                    :RECITM-VEND-DESC,                            10628008
106290                    :RECITM-VERFYD-TMST,                          10629008
106300                    :RECITM-PKSL-NBR,                             10630008
106310                    :RECITM-REC-INV-LNE-NBR,                      10631008
106320                    :RECITM-DMG-ITM-QTY,                          10632008
106330                    :RECITM-UPD-TMST,                             10633008
106340                    :RECITM-UPD-UID,                              10634008
106350                    :RECITM-UPD-PGM-ID,                           10635008
106360                    :RECITM-RCPT-DISTR-UPD-CDE,                   10636008
106370                     CURRENT TIMESTAMP,                           10637008
106380                    :DP020-USERID                                 10638008
106390             ,      :RECITM-PREPK-ID                              10639008
106400             ,      :RECITM-PREPK-RATO-QTY                        10640008
106410             ,      :RECITM-PREPK-ODD-UNT-QTY                     10641008
106420             ,      :RECITM-PREPK-DRV-LNE-CDE                     10642008
106430             ,      :RECITM-UNT-RTL-AMT                           10643008
106440             ,      :RECITM-GP-RTL-AMT                            10644008
106450             ,      :RECITM-GP-QTY                                10645008
106460             ,      :PV-ORIG-PKSL-ITM-QTY                         10646008
106470                 )                                                10647008
106480         END-EXEC                                                 10648008
106490                                                                  10649008
106500         EVALUATE TRUE                                            10650008
106510             WHEN SQLCODE = ZERO                                  10651008
106520                  CONTINUE                                        10652008
106530             WHEN SQLCODE = -904                                  10653008
106540             WHEN SQLCODE = -911                                  10654008
106550             WHEN SQLCODE = -913                                  10655008
106560                  PERFORM 9900-SOFT-ABORT                         10656008
106570                                                                  10657008
106580             WHEN SQLWARN0 NOT = SPACES                           10658008
106590             WHEN SQLCODE  NOT = ZERO                             10659008
106600                  MOVE '7830-INSERT-RECITM'                       10660008
106610                                 TO DP013-PARAGRAPH               10661008
106620                  MOVE 'UNSUCCESSFUL INSERT OF TRECITM'           10662008
106630                                 TO DP013-MESSAGE-TEXT (1)        10663008
106640                  MOVE ASC-KEY-PO-NBR                             10664008
106650                                 TO PV-MSG-KEY-PO                 10665008
106660                  MOVE ASC-KEY-REC-SEQ-NBR                        10666008
106670                                 TO PV-MSG-KEY-REC-SEQ-NBR-N      10667008
106680                  MOVE RECITM-ORD-LNE-NBR                         10668008
106690                                 TO PV-MSG-KEY-PO-LNE-NBR-N       10669008
106700                  MOVE PV-MSG-KEYS                                10670008
106710                                 TO DP013-MESSAGE-TEXT (2)        10671008
106720                  MOVE SQLCA     TO DP013-SQLCA                   10672008
106730                  MOVE 'TRECITM' TO DP013-DB2-TABLE-NAME (1)      10673008
106740                  SET DP013-DB2-ABEND                             10674008
106750                      DP013-XCTL-DISPLAY-RESTART                  10675008
106760                                 TO TRUE                          10676008
106770                  PERFORM DP013-0000-PROCESS-ABEND                10677008
106780         END-EVALUATE.                                            10678008
106790                                                                  10679008
106800 7900-OPEN-UNPKSL-LINE-CURSOR.                                    10680008
106810                                                                  10681008
106820         EXEC SQL                                                 10682008
106830              OPEN UNPKSL-LINE-CURSOR                             10683008
106840         END-EXEC                                                 10684008
106850                                                                  10685008
106860         EVALUATE TRUE                                            10686008
106870             WHEN SQLCODE = ZERO                                  10687008
106880                  SET PS-NOT-END-OF-UNPKSL-LINE-CSR               10688008
106890                                 TO TRUE                          10689008
106900                  MOVE ZERO      TO PV-UNPKSL-COUNT               10690008
106910             WHEN SQLCODE = -904                                  10691008
106920             WHEN SQLCODE = -911                                  10692008
106930             WHEN SQLCODE = -913                                  10693008
106940                  PERFORM 9900-SOFT-ABORT                         10694008
106950                                                                  10695008
106960             WHEN SQLWARN0 NOT = SPACES                           10696008
106970             WHEN SQLCODE  NOT = ZERO                             10697008
106980                  MOVE '7900-OPEN-UNPKSL-LINE-CURSOR'             10698008
106990                                 TO DP013-PARAGRAPH               10699008
107000                  MOVE 'UNSUCCESSFUL UNPKSL-LINE CURSOR OPEN'     10700008
107010                                 TO DP013-MESSAGE-TEXT (1)        10701008
107020                  MOVE ASC-KEY-PO-NBR                             10702008
107030                                 TO PV-MSG-KEY-PO                 10703008
107040                  MOVE ASC-KEY-REC-SEQ-NBR                        10704008
107050                                 TO PV-MSG-KEY-REC-SEQ-NBR-N      10705008
107060                  MOVE PV-MSG-KEYS                                10706008
107070                                 TO DP013-MESSAGE-TEXT (2)        10707008
107080                  MOVE SQLCA TO DP013-SQLCA                       10708008
107090                  MOVE 'TUNPKSL' TO DP013-DB2-TABLE-NAME (1)      10709008
107100                  SET DP013-XCTL-DISPLAY-RESTART                  10710008
107110                      DP013-DB2-ABEND                             10711008
107120                                 TO TRUE                          10712008
107130                                                                  10713008
107140                  PERFORM DP013-0000-PROCESS-ABEND                10714008
107150         END-EVALUATE.                                            10715008
107160                                                                  10716008
107170 7910-PROCESS-UNPKSL-LINES.                                       10717008
107180                                                                  10718008
107190     PERFORM VARYING PV-READ-COUNT  FROM 1 BY 1                   10719008
107200         UNTIL PV-READ-COUNT > PC-MAX-UNPKSLS OR                  10720008
107210               PS-END-OF-UNPKSL-LINE-CSR                          10721008
107220                                                                  10722008
107230         PERFORM 7920-FETCH-UNPKSL-LINES                          10723008
107240         SET PWT-U-IDX           TO 1                             10724008
107250                                                                  10725008
107260         IF PS-NOT-END-OF-UNPKSL-LINE-CSR                         10726008
107270             SEARCH PWT-UNMATCHED-TBL                             10727008
107280                    VARYING PWT-U-IDX                             10728008
107290                                                                  10729008
107300                 AT END                                           10730008
107310                     CONTINUE                                     10731008
107320                                                                  10732008
107330                 WHEN PWT-COLOR-DESC     (PWT-U-IDX) = SPACES  AND10733008
107340                      PWT-SIZE-DESC      (PWT-U-IDX) = SPACES  AND10734008
107350                      PWT-VEND-STYL-NAME (PWT-U-IDX) = SPACES     10735008
107360                     MOVE UNPKSL-COLOR-DESC                       10736008
107370                                 TO PWT-COLOR-DESC    (PWT-U-IDX) 10737008
107380                     MOVE UNPKSL-SIZE-DESC                        10738008
107390                                 TO PWT-SIZE-DESC     (PWT-U-IDX) 10739008
107400                     MOVE UNPKSL-VEND-STYL-NAME                   10740008
107410                                 TO PWT-VEND-STYL-NAME(PWT-U-IDX) 10741008
107420                     MOVE PV-LINE-QTY                             10742008
107430                                 TO PWT-U-LINE-QTY    (PWT-U-IDX) 10743008
107440                                                                  10744008
107450                 WHEN PWT-COLOR-DESC     (PWT-U-IDX) =            10745008
107460                                  UNPKSL-COLOR-DESC AND           10746008
107470                      PWT-SIZE-DESC      (PWT-U-IDX) =            10747008
107480                                  UNPKSL-SIZE-DESC  AND           10748008
107490                      PWT-VEND-STYL-NAME (PWT-U-IDX) =            10749008
107500                                  UNPKSL-VEND-STYL-NAME           10750008
107510                     COMPUTE PWT-U-LINE-QTY (PWT-U-IDX) =         10751008
107520                         PWT-U-LINE-QTY (PWT-U-IDX) +  PV-LINE-QTY10752008
107530             END-SEARCH                                           10753008
107540         END-IF                                                   10754008
107550     END-PERFORM.                                                 10755008
107560                                                                  10756008
107570     IF PS-NOT-END-OF-UNPKSL-LINE-CSR                             10757008
107580     PERFORM VARYING PWT-U-IDX                                    10758008
107590         FROM 1 BY 1                                              10759008
107600         UNTIL PWT-U-IDX > PC-MAX-UNPKSLS                         10760008
107610             IF PWT-COLOR-DESC     (PWT-U-IDX) > SPACES OR        10761008
107620                PWT-SIZE-DESC      (PWT-U-IDX) > SPACES OR        10762008
107630                PWT-VEND-STYL-NAME (PWT-U-IDX) > SPACES           10763008
107640                                                                  10764008
107650                 MOVE PWT-COLOR-DESC     (PWT-U-IDX)              10765008
107660                                 TO RECITM-COLOR-DESC             10766008
107670                 MOVE PWT-SIZE-DESC      (PWT-U-IDX)              10767008
107680                                 TO RECITM-SIZE-DESC              10768008
107690                 MOVE PWT-VEND-STYL-NAME (PWT-U-IDX)              10769008
107700                                 TO RECITM-VEND-STYL-NAME         10770008
107710                                                                  10771008
107720                 PERFORM 7940-SELECT-UNMATCHED-RECITM             10772008
107730                 IF PS-RECITM-FOUND                               10773008
107740                     IF (RECITM-STATUS-CDE EQUAL 'CM'             10774008
107750                     OR  RECITM-STATUS-CDE EQUAL 'VE')            10775008
107760                         CONTINUE                                 10776008
107770                     ELSE                                         10777008
107780                         COMPUTE PV-PKSL-ITM-QTY =                10778008
107790                             RECITM-PKSL-ITM-QTY -                10779008
107800                             PWT-U-LINE-QTY (PWT-U-IDX)           10780008
107810                         MOVE PV-PKSL-ITM-QTY                     10781008
107820                                 TO RECITM-PKSL-ITM-QTY           10782008
107830                         IF PV-PKSL-ITM-QTY = ZERO                10783008
107840                             PERFORM 8000-AUDIT-RECITM            10784008
107850                             PERFORM 7810-SET-CURR-RECITM-TO-INACT10785008
107860*                                                                 10786008
107870*        SINCE WE ARE INACTIVATING THE RECITM ROW, WE MUST ALSO   10787008
107880*        INACTIVATE THE WORK ORDER ROWS.                          10788008
107890*                                                                 10789008
107900                             PERFORM 7950-INACTIVATE-TWRKORD      10790008
107910                             PERFORM 7960-INACTIVATE-TWKORIN      10791008
107920*                            PERFORM 7970-INACTIVATE-TWOSTAL      10792023
107930                         ELSE                                     10793008
107940                                                                  10794008
107950                         IF ASC-TRECEIV-PKGNG-CDE                 10795008
107960                                                = 'M' OR 'I'      10796008
107970                              PERFORM  7821-SETUP-RECITM-PREPACK  10797008
107980                         ELSE                                     10798008
107990                             INITIALIZE  RECITM-PREPK-ID          10799008
108000                                         RECITM-PREPK-DRV-LNE-CDE 10800008
108010                                         RECITM-PREPK-RATO-QTY    10801008
108020                                         RECITM-PREPK-ODD-UNT-QTY 10802008
108030                         END-IF                                   10803008
108040                                                                  10804008
108050                             PERFORM 8000-AUDIT-RECITM            10805008
108060                             PERFORM 7815-UPDATE-RECITM-QTY       10806008
108070                         END-IF                                   10807008
108080                     END-IF                                       10808008
108090                 END-IF                                           10809008
108100             END-IF                                               10810008
108110     END-PERFORM                                                  10811008
108120     END-IF.                                                      10812008
108130                                                                  10813008
108140 7920-FETCH-UNPKSL-LINES.                                         10814008
108150                                                                  10815008
108160     EXEC SQL                                                     10816008
108170          FETCH UNPKSL-LINE-CURSOR                                10817008
108180           INTO :UNPKSL-PKSL-ITM-QTY,                             10818008
108190                :UNPKSL-PKSL-LNE-NBR                              10819008
108200     END-EXEC.                                                    10820008
108210                                                                  10821008
108220     EVALUATE TRUE                                                10822008
108230         WHEN SQLCODE = ZERO                                      10823008
108240             ADD 1               TO PV-UNPKSL-COUNT               10824008
108250         WHEN SQLCODE = +100                                      10825008
108260              SET PS-END-OF-UNPKSL-LINE-CSR                       10826008
108270                                 TO TRUE                          10827008
108280         WHEN SQLCODE = -904                                      10828008
108290         WHEN SQLCODE = -911                                      10829008
108300         WHEN SQLCODE = -913                                      10830008
108310              PERFORM 9900-SOFT-ABORT                             10831008
108320                                                                  10832008
108330         WHEN SQLWARN0 NOT = SPACES                               10833008
108340         WHEN SQLCODE  NOT = ZERO                                 10834008
108350              MOVE '7920-FETCH-UNPKSL-LINES'                      10835008
108360                                 TO DP013-PARAGRAPH               10836008
108370              MOVE 'UNSUCCESSFUL FETCH PACK SLIP LINE CURSOR'     10837008
108380                                 TO DP013-MESSAGE-TEXT (1)        10838008
108390              MOVE ASC-KEY-PO-NBR                                 10839008
108400                                 TO PV-MSG-KEY-PO                 10840008
108410              MOVE ASC-KEY-REC-SEQ-NBR                            10841008
108420                                 TO PV-MSG-KEY-REC-SEQ-NBR-N      10842008
108430              MOVE PV-MSG-KEYS   TO DP013-MESSAGE-TEXT (2)        10843008
108440              MOVE SQLCA         TO DP013-SQLCA                   10844008
108450              MOVE 'TUNPKSL'     TO DP013-DB2-TABLE-NAME (1)      10845008
108460              SET DP013-DB2-ABEND                                 10846008
108470                  DP013-XCTL-DISPLAY-RESTART                      10847008
108480                                 TO TRUE                          10848008
108490                                                                  10849008
108500              PERFORM DP013-0000-PROCESS-ABEND                    10850008
108510     END-EVALUATE.                                                10851008
108520                                                                  10852008
108530 7930-CLOSE-UNPKSL-LINE-CURSOR.                                   10853008
108540                                                                  10854008
108550     EXEC SQL                                                     10855008
108560          CLOSE UNPKSL-LINE-CURSOR                                10856008
108570     END-EXEC.                                                    10857008
108580                                                                  10858008
108590     EVALUATE TRUE                                                10859008
108600         WHEN SQLCODE = ZERO                                      10860008
108610              CONTINUE                                            10861008
108620         WHEN SQLCODE = -904                                      10862008
108630         WHEN SQLCODE = -911                                      10863008
108640         WHEN SQLCODE = -913                                      10864008
108650              PERFORM 9900-SOFT-ABORT                             10865008
108660                                                                  10866008
108670         WHEN SQLWARN0 NOT = SPACES                               10867008
108680         WHEN SQLCODE  NOT = ZERO                                 10868008
108690              MOVE '7930-CLOSE-UNPKSL-LINE-CURSOR'                10869008
108700                                 TO DP013-PARAGRAPH               10870008
108710              MOVE 'UNSUCCESSFUL UNPKSL CURSOR CLOSE'             10871008
108720                                 TO DP013-MESSAGE-TEXT (1)        10872008
108730              MOVE ASC-KEY-PO-NBR                                 10873008
108740                                 TO PV-MSG-KEY-PO                 10874008
108750              MOVE ASC-KEY-REC-SEQ-NBR                            10875008
108760                                 TO PV-MSG-KEY-REC-SEQ-NBR-N      10876008
108770              MOVE PV-MSG-KEYS   TO DP013-MESSAGE-TEXT (2)        10877008
108780              MOVE SQLCA TO DP013-SQLCA                           10878008
108790              MOVE 'TUNPKSL '    TO DP013-DB2-TABLE-NAME (1)      10879008
108800              SET DP013-DB2-ABEND                                 10880008
108810                  DP013-XCTL-DISPLAY-RESTART                      10881008
108820                                 TO TRUE                          10882008
108830                                                                  10883008
108840              PERFORM DP013-0000-PROCESS-ABEND                    10884008
108850     END-EVALUATE.                                                10885008
108860                                                                  10886008
108870 7940-SELECT-UNMATCHED-RECITM.                                    10887008
108880                                                                  10888008
108890     MOVE '7940-SELECT-UNMATCHED-RECITM'                          10889008
108900                                 TO PV-LAST-PARAGRAPH.            10890008
108910     MOVE ASC-KEY-OPER-UNT-ID    TO DK-OPER-UNT-ID.               10891008
108920     MOVE ASC-KEY-FCLTY-ID       TO DK-FCLTY-ID.                  10892008
108930                                                                  10893008
108940         EXEC SQL                                                 10894008
108950             SELECT ORD_NBR,                                      10895008
108960                    ORD_LNE_NBR,                                  10896008
108970                    REC_SEQ_NBR,                                  10897008
108980                    OPER_UNT_ID,                                  10898008
108990                    FCLTY_ID,                                     10899008
109000                    CRE_TMST,                                     10900008
109010                    CRE_UID,                                      10901008
109020                    PO_VER_NBR,                                   10902008
109030                    ITM_NBR,                                      10903008
109040                    PRE_TKT_IND,                                  10904008
109050                    TKT_FMT_ID,                                   10905008
109060                    RTV_IND,                                      10906008
109070                    STATUS_CDE,                                   10907008
109080                    VER_STATUS_CDE,                               10908008
109090                    PKSL_ITM_QTY,                                 10909008
109100                    DTL_CK_ITM_QTY,                               10910008
109110                    INNR_PACK_QTY,                                10911008
109120                    CASE_PACK_QTY,                                10912008
109130                    RTV_QTY,                                      10913008
109140                    EXPTED_CART_CNT,                              10914008
109150                    ACTL_CART_CNT,                                10915008
109160                    MKING_APRON_TMST,                             10916008
109170                    UNT_COST_AMT,                                 10917008
109180                    COLOR_DESC,                                   10918008
109190                    SIZE_DESC,                                    10919008
109200                    VEND_STYL_NAME,                               10920008
109210                    VEND_DESC,                                    10921008
109220                    VERFYD_TMST,                                  10922008
109230                    PKSL_NBR,                                     10923008
109240                    REC_INV_LNE_NBR,                              10924008
109250                    DMG_ITM_QTY,                                  10925008
109260                    UPD_TMST,                                     10926008
109270                    UPD_UID,                                      10927008
109280                    UPD_PGM_ID,                                   10928008
109290                    RCPT_DISTR_UPD_CDE,                           10929008
109300                    LAST_TRSCP_TMST,                              10930008
109310                    LAST_TRSCP_USR_ID                             10931008
109320              INTO  :RECITM-ORD-NBR,                              10932008
109330                    :RECITM-ORD-LNE-NBR,                          10933008
109340                    :RECITM-REC-SEQ-NBR,                          10934008
109350                    :RECITM-OPER-UNT-ID,                          10935008
109360                    :RECITM-FCLTY-ID,                             10936008
109370                    :RECITM-CRE-TMST,                             10937008
109380                    :RECITM-CRE-UID,                              10938008
109390                    :RECITM-PO-VER-NBR,                           10939008
109400                    :RECITM-ITM-NBR,                              10940008
109410                    :RECITM-PRE-TKT-IND,                          10941008
109420                    :RECITM-TKT-FMT-ID,                           10942008
109430                    :RECITM-RTV-IND,                              10943008
109440                    :RECITM-STATUS-CDE,                           10944008
109450                    :RECITM-VER-STATUS-CDE,                       10945008
109460                    :RECITM-PKSL-ITM-QTY,                         10946008
109470                    :RECITM-DTL-CK-ITM-QTY,                       10947008
109480                    :RECITM-INNR-PACK-QTY,                        10948008
109490                    :RECITM-CASE-PACK-QTY,                        10949008
109500                    :RECITM-RTV-QTY,                              10950008
109510                    :RECITM-EXPTED-CART-CNT,                      10951008
109520                    :RECITM-ACTL-CART-CNT,                        10952008
109530                    :RECITM-MKING-APRON-TMST,                     10953008
109540                    :RECITM-UNT-COST-AMT,                         10954008
109550                    :RECITM-COLOR-DESC,                           10955008
109560                    :RECITM-SIZE-DESC,                            10956008
109570                    :RECITM-VEND-STYL-NAME,                       10957008
109580                    :RECITM-VEND-DESC,                            10958008
109590                    :RECITM-VERFYD-TMST,                          10959008
109600                    :RECITM-PKSL-NBR,                             10960008
109610                    :RECITM-REC-INV-LNE-NBR,                      10961008
109620                    :RECITM-DMG-ITM-QTY,                          10962008
109630                    :RECITM-UPD-TMST,                             10963008
109640                    :RECITM-UPD-UID,                              10964008
109650                    :RECITM-UPD-PGM-ID,                           10965008
109660                    :RECITM-RCPT-DISTR-UPD-CDE,                   10966008
109670                    :RECITM-LAST-TRSCP-TMST,                      10967008
109680                    :RECITM-LAST-TRSCP-USR-ID                     10968008
109690               FROM TRECITM                                       10969008
109700              WHERE ORD_NBR        = :DK-PO-NBR                   10970008
109710                AND REC_SEQ_NBR    = :DK-REC-SEQ-NBR              10971008
109720                AND OPER_UNT_ID    = :DK-OPER-UNT-ID              10972008
109730                AND FCLTY_ID       = :DK-FCLTY-ID                 10973008
109740                AND VER_STATUS_CDE = 'A'                          10974008
109750                AND COLOR_DESC     = :RECITM-COLOR-DESC           10975008
109760                AND SIZE_DESC      = :RECITM-SIZE-DESC            10976008
109770                AND VEND_STYL_NAME = :RECITM-VEND-STYL-NAME       10977008
109780         END-EXEC                                                 10978008
109790                                                                  10979008
109800         EVALUATE TRUE                                            10980008
109810             WHEN SQLCODE = ZERO                                  10981008
109820                  SET PS-RECITM-FOUND                             10982008
109830                                 TO TRUE                          10983008
109840             WHEN SQLCODE = +100                                  10984008
109850                  SET PS-RECITM-NOT-FOUND                         10985008
109860                                 TO TRUE                          10986008
109870             WHEN SQLCODE = -904                                  10987008
109880             WHEN SQLCODE = -911                                  10988008
109890             WHEN SQLCODE = -913                                  10989008
109900                  PERFORM 9900-SOFT-ABORT                         10990008
109910                                                                  10991008
109920             WHEN SQLWARN0 NOT = SPACES                           10992008
109930             WHEN SQLCODE  NOT = ZERO                             10993008
109940                  MOVE '7940-SELECT-UNMATCHED-RECITM'             10994008
109950                                 TO DP013-PARAGRAPH               10995008
109960                  MOVE 'UNSUCCESSFUL SELECT OF TRECITM'           10996008
109970                                 TO DP013-MESSAGE-TEXT (1)        10997008
109980                  MOVE ASC-KEY-PO-NBR                             10998008
109990                                 TO PV-MSG-KEY-PO                 10999008
110000                  MOVE ASC-KEY-REC-SEQ-NBR                        11000008
110010                                 TO PV-MSG-KEY-REC-SEQ-NBR-N      11001008
110020                  MOVE PV-MSG-KEYS                                11002008
110030                                 TO DP013-MESSAGE-TEXT (2)        11003008
110040                  MOVE SQLCA     TO DP013-SQLCA                   11004008
110050                  MOVE 'TRECITM' TO DP013-DB2-TABLE-NAME (1)      11005008
110060                  SET DP013-DB2-ABEND                             11006008
110070                      DP013-XCTL-DISPLAY-RESTART                  11007008
110080                                 TO TRUE                          11008008
110090                  PERFORM DP013-0000-PROCESS-ABEND                11009008
110100         END-EVALUATE.                                            11010008
110110/                                                                 11011008
110120*IR-124:  ADDED 7950 THROUGH 7960 TO INACTIVATE WORK ORDER ROWS.  11012008
110130                                                                  11013008
110140 7950-INACTIVATE-TWRKORD.                                         11014008
110150                                                                  11015008
110160     EXEC SQL                                                     11016008
110170          UPDATE                                                  11017008
110180                TWRKORD                                           11018008
110190          SET   VER_STATUS_CDE     =  'I'                         11019008
110200              , CRE_UID_ID         =  :PC-CURRENT-PROGRAM-NAME    11020008
110210          WHERE                                                   11021008
110220                ORD_NBR            =  :DK-PO-NBR                  11022008
110230                AND ORD_LNE_NBR    =  :RECITM-ORD-LNE-NBR         11023008
110240                AND RCVR_SEQ_NBR   =  :DK-REC-SEQ-NBR             11024008
110250                AND OPER_UNT_ID    =  :DK-OPER-UNT-ID             11025008
110260                AND FCLTY_ID       =  :DK-FCLTY-ID                11026008
110270                AND VER_STATUS_CDE =  'A'                         11027008
110280     END-EXEC.                                                    11028008
110290                                                                  11029008
110300     EVALUATE TRUE                                                11030008
110310         WHEN SQLCODE = ZERO                                      11031008
110320         WHEN SQLCODE = +100                                      11032008
110330              CONTINUE                                            11033008
110340         WHEN SQLCODE = -904                                      11034008
110350         WHEN SQLCODE = -911                                      11035008
110360         WHEN SQLCODE = -913                                      11036008
110370              PERFORM 9900-SOFT-ABORT                             11037008
110380                                                                  11038008
110390         WHEN OTHER                                               11039008
110400              MOVE '7950-INACTIVATE-TWRKORD'                      11040008
110410                                 TO DP013-PARAGRAPH               11041008
110420              MOVE 'UNSUCCESSFUL UPDATE OF TWRKORD'               11042008
110430                                 TO DP013-MESSAGE-TEXT (1)        11043008
110440              MOVE ASC-KEY-PO-NBR                                 11044008
110450                                 TO PV-MSG-KEY-PO                 11045008
110460              MOVE ASC-KEY-REC-SEQ-NBR                            11046008
110470                                 TO PV-MSG-KEY-REC-SEQ-NBR-N      11047008
110480              MOVE RECITM-ORD-LNE-NBR                             11048008
110490                                 TO PV-MSG-KEY-PO-LNE-NBR-N       11049008
110500              MOVE PV-MSG-KEYS                                    11050008
110510                                 TO DP013-MESSAGE-TEXT (2)        11051008
110520              MOVE SQLCA         TO DP013-SQLCA                   11052008
110530              MOVE 'TWRKORD'     TO DP013-DB2-TABLE-NAME (1)      11053008
110540              SET DP013-DB2-ABEND                                 11054008
110550                  DP013-XCTL-DISPLAY-RESTART                      11055008
110560                                 TO TRUE                          11056008
110570              PERFORM DP013-0000-PROCESS-ABEND                    11057008
110580     END-EVALUATE.                                                11058008
110590                                                                  11059008
110600 7960-INACTIVATE-TWKORIN.                                         11060008
110610                                                                  11061008
110620     EXEC SQL                                                     11062008
110630          UPDATE                                                  11063008
110640                TWKORIN                                           11064008
110650          SET   VER_STATUS_CDE     =  'I'                         11065008
110660              , CRE_UID_ID         =  :PC-CURRENT-PROGRAM-NAME    11066008
110670          WHERE                                                   11067008
110680                ORD_NBR            =  :DK-PO-NBR                  11068008
110690                AND ORD_LNE_NBR    =  :RECITM-ORD-LNE-NBR         11069008
110700                AND RCVR_SEQ_NBR   =  :DK-REC-SEQ-NBR             11070008
110710                AND OPER_UNT_ID    =  :DK-OPER-UNT-ID             11071008
110720                AND FCLTY_ID       =  :DK-FCLTY-ID                11072008
110730                AND VER_STATUS_CDE =  'A'                         11073008
110740     END-EXEC.                                                    11074008
110750                                                                  11075008
110760     EVALUATE TRUE                                                11076008
110770         WHEN SQLCODE = ZERO                                      11077008
110780         WHEN SQLCODE = +100                                      11078008
110790                  CONTINUE                                        11079008
110800         WHEN SQLCODE = -904                                      11080008
110810         WHEN SQLCODE = -911                                      11081008
110820         WHEN SQLCODE = -913                                      11082008
110830              PERFORM 9900-SOFT-ABORT                             11083008
110840                                                                  11084008
110850         WHEN OTHER                                               11085008
110860              MOVE '7960-INACTIVATE-TWKORIN'                      11086008
110870                                 TO DP013-PARAGRAPH               11087008
110880              MOVE 'UNSUCCESSFUL UPDATE OF TWKORIN'               11088008
110890                                 TO DP013-MESSAGE-TEXT (1)        11089008
110900              MOVE ASC-KEY-PO-NBR                                 11090008
110910                                 TO PV-MSG-KEY-PO                 11091008
110920              MOVE ASC-KEY-REC-SEQ-NBR                            11092008
110930                                 TO PV-MSG-KEY-REC-SEQ-NBR-N      11093008
110940              MOVE RECITM-ORD-LNE-NBR                             11094008
110950                                 TO PV-MSG-KEY-PO-LNE-NBR-N       11095008
110960              MOVE PV-MSG-KEYS                                    11096008
110970                                 TO DP013-MESSAGE-TEXT (2)        11097008
110980              MOVE SQLCA         TO DP013-SQLCA                   11098008
110990              MOVE 'TWKORIN'     TO DP013-DB2-TABLE-NAME (1)      11099008
111000              SET DP013-DB2-ABEND                                 11100008
111010                  DP013-XCTL-DISPLAY-RESTART                      11101008
111020                                 TO TRUE                          11102008
111030              PERFORM DP013-0000-PROCESS-ABEND                    11103008
111040     END-EVALUATE.                                                11104008
111050                                                                  11105008
111060*7970-INACTIVATE-TWOSTAL.                                         11106023
111070*                                                                 11107023
111080*    EXEC SQL                                                     11108023
111090*         UPDATE                                                  11109023
111100*               TWOSTAL                                           11110023
111110*         SET   VER_STATUS_CDE     =  'I'                         11111023
111120*             , CRE_UID_ID         =  :PC-CURRENT-PROGRAM-NAME    11112023
111130*         WHERE                                                   11113023
111140*               ORD_NBR            =  :DK-PO-NBR                  11114023
111150*               AND ORD_LNE_NBR    =  :RECITM-ORD-LNE-NBR         11115023
111160*               AND RCVR_SEQ_NBR   =  :DK-REC-SEQ-NBR             11116023
111170*               AND OPER_UNT_ID    =  :DK-OPER-UNT-ID             11117023
111180*               AND FCLTY_ID       =  :DK-FCLTY-ID                11118023
111190*               AND VER_STATUS_CDE =  'A'                         11119023
111200*    END-EXEC.                                                    11120023
111210*                                                                 11121023
111220*    EVALUATE TRUE                                                11122023
111230*        WHEN SQLCODE = ZERO                                      11123023
111240*        WHEN SQLCODE = +100                                      11124023
111250*             CONTINUE                                            11125023
111260*        WHEN SQLCODE = -904                                      11126023
111270*        WHEN SQLCODE = -911                                      11127023
111280*        WHEN SQLCODE = -913                                      11128023
111290*             PERFORM 9900-SOFT-ABORT                             11129023
111300*                                                                 11130023
111310*        WHEN OTHER                                               11131023
111320*             MOVE '7970-INACTIVATE-TWKORIN'                      11132023
111330*                                TO DP013-PARAGRAPH               11133023
111340*             MOVE 'UNSUCCESSFUL UPDATE OF TWOSTAL'               11134023
111350*                                TO DP013-MESSAGE-TEXT (1)        11135023
111360*             MOVE ASC-KEY-PO-NBR                                 11136023
111370*                                TO PV-MSG-KEY-PO                 11137023
111380*             MOVE ASC-KEY-REC-SEQ-NBR                            11138023
111390*                                TO PV-MSG-KEY-REC-SEQ-NBR-N      11139023
111400*             MOVE RECITM-ORD-LNE-NBR                             11140023
111410*                                TO PV-MSG-KEY-PO-LNE-NBR-N       11141023
111420*             MOVE PV-MSG-KEYS                                    11142023
111430*                                TO DP013-MESSAGE-TEXT (2)        11143023
111440*             MOVE SQLCA         TO DP013-SQLCA                   11144023
111450*             MOVE 'TWOSTAL'     TO DP013-DB2-TABLE-NAME (1)      11145023
111460*             SET DP013-DB2-ABEND                                 11146023
111470*                 DP013-XCTL-DISPLAY-RESTART                      11147023
111480*                                TO TRUE                          11148023
111490*             PERFORM DP013-0000-PROCESS-ABEND                    11149023
111500*    END-EVALUATE.                                                11150023
111510*                                                                 11151023
111520*----------------------------------------------------------------*11152008
111530*    BY DELETING THE NOTIFICATION ROWS, R.I. WITH DELETE CASCADE *11153008
111540*    DELETES ALL TROUBLE DETAIL ROWS AS WELL.                    *11154008
111550*----------------------------------------------------------------*11155008
111560                                                                  11156008
111570 7985-DELETE-PACK-TROUBLE.                                        11157008
111580                                                                  11158008
111590     EXEC SQL                                                     11159008
111600          DELETE                                                  11160008
111610            FROM TTRBNTF                                          11161008
111620           WHERE PO_NBR       = :DK-PO-NBR                        11162008
111630             AND PO_LNE_NBR   = 0                                 11163008
111640             AND REC_SEQ_NBR  = :DK-REC-SEQ-NBR                   11164008
111650             AND PREPK_ID     = :RECITM-PREPK-ID                  11165008
111660     END-EXEC                                                     11166008
111670                                                                  11167008
111680     EVALUATE TRUE                                                11168008
111690         WHEN SQLCODE = +0                                        11169008
111700         WHEN SQLCODE = +100                                      11170008
111710              CONTINUE                                            11171008
111720                                                                  11172008
111730         WHEN SQLCODE = -904                                      11173008
111740         WHEN SQLCODE = -911                                      11174008
111750         WHEN SQLCODE = -913                                      11175008
111760              PERFORM 9900-SOFT-ABORT                             11176008
111770                                                                  11177008
111780         WHEN SQLWARN0 NOT = SPACES                               11178008
111790         WHEN SQLCODE < +0                                        11179008
111800         WHEN SQLCODE > +0                                        11180008
111810              MOVE '7985-DELETE-PACK-TROUBLE'                     11181008
111820                               TO DP013-PARAGRAPH                 11182008
111830              MOVE 'UNSUCCESSFUL DELETE ON TTRBNTF'               11183008
111840                               TO DP013-MESSAGE-TEXT (1)          11184008
111850              MOVE SQLCA       TO DP013-SQLCA                     11185008
111860              MOVE 'TTRBNTF '  TO DP013-DB2-TABLE-NAME (1)        11186008
111870              SET DP013-DB2-ABEND                                 11187008
111880                  DP013-XCTL-DISPLAY-RESTART                      11188008
111890                               TO TRUE                            11189008
111900              PERFORM DP013-0000-PROCESS-ABEND                    11190008
111910     END-EVALUATE.                                                11191008
111920/                                                                 11192008
111930*----------------------------------------------------------------*11193008
111940*    BY DELETING THE NOTIFICATION ROWS, R.I. WITH DELETE CASCADE *11194008
111950*    DELETES ALL TROUBLE DETAIL ROWS AS WELL.                    *11195008
111960*----------------------------------------------------------------*11196008
111970                                                                  11197008
111980 7990-DELETE-LINE-TROUBLE.                                        11198008
111990                                                                  11199008
112000     EXEC SQL                                                     11200008
112010          DELETE                                                  11201008
112020            FROM TTRBNTF                                          11202008
112030           WHERE PO_NBR       = :DK-PO-NBR                        11203008
112040             AND REC_SEQ_NBR  = :DK-REC-SEQ-NBR                   11204008
112050             AND PO_LNE_NBR   = :RECITM-ORD-LNE-NBR               11205008
112060     END-EXEC                                                     11206008
112070                                                                  11207008
112080     EVALUATE TRUE                                                11208008
112090         WHEN SQLCODE = +0                                        11209008
112100         WHEN SQLCODE = +100                                      11210008
112110              CONTINUE                                            11211008
112120                                                                  11212008
112130         WHEN SQLCODE = -904                                      11213008
112140         WHEN SQLCODE = -911                                      11214008
112150         WHEN SQLCODE = -913                                      11215008
112160              PERFORM 9900-SOFT-ABORT                             11216008
112170                                                                  11217008
112180         WHEN SQLWARN0 NOT = SPACES                               11218008
112190         WHEN SQLCODE < +0                                        11219008
112200         WHEN SQLCODE > +0                                        11220008
112210              MOVE '7990-DELETE-TROUBLE'                          11221008
112220                               TO DP013-PARAGRAPH                 11222008
112230              MOVE 'UNSUCCESSFUL DELETE ON TTRBNTF'               11223008
112240                               TO DP013-MESSAGE-TEXT (1)          11224008
112250              MOVE SQLCA       TO DP013-SQLCA                     11225008
112260              MOVE 'TTRBNTF '  TO DP013-DB2-TABLE-NAME (1)        11226008
112270              SET DP013-DB2-ABEND                                 11227008
112280                  DP013-XCTL-DISPLAY-RESTART                      11228008
112290                               TO TRUE                            11229008
112300              PERFORM DP013-0000-PROCESS-ABEND                    11230008
112310     END-EVALUATE.                                                11231008
112320/                                                                 11232008
112330*----------------------------------------------------------------*11233008
112340*    BY DELETING THE NOTIFICATION ROWS, R.I. WITH DELETE CASCADE *11234008
112350*    DELETES ALL TROUBLE DETAIL ROWS AS WELL.                    *11235008
112360*----------------------------------------------------------------*11236008
112370 7995-DELETE-PO-TROUBLE.                                          11237008
112380                                                                  11238008
112390     EXEC SQL                                                     11239008
112400          DELETE                                                  11240008
112410            FROM TTRBNTF                                          11241008
112420           WHERE PO_NBR       = :DK-PO-NBR                        11242008
112430             AND PO_LNE_NBR   = 0                                 11243008
112440             AND PREPK_ID     = 0                                 11244008
112450             AND REC_SEQ_NBR  = :DK-REC-SEQ-NBR                   11245008
112460     END-EXEC.                                                    11246008
112470                                                                  11247008
112480     EVALUATE TRUE                                                11248008
112490         WHEN SQLCODE = +0                                        11249008
112500         WHEN SQLCODE = +100                                      11250008
112510              CONTINUE                                            11251008
112520                                                                  11252008
112530         WHEN SQLCODE = -904                                      11253008
112540         WHEN SQLCODE = -911                                      11254008
112550         WHEN SQLCODE = -913                                      11255008
112560              PERFORM 9900-SOFT-ABORT                             11256008
112570                                                                  11257008
112580         WHEN SQLWARN0 NOT = SPACES                               11258008
112590         WHEN SQLCODE < +0                                        11259008
112600         WHEN SQLCODE > +0                                        11260008
112610              MOVE '7995-DELETE-PO-TROUBLE'                       11261008
112620                               TO DP013-PARAGRAPH                 11262008
112630              MOVE 'UNSUCCESSFUL DELETE ON TTRBNTF'               11263008
112640                               TO DP013-MESSAGE-TEXT (1)          11264008
112650              MOVE SQLCA       TO DP013-SQLCA                     11265008
112660              MOVE 'TTRBNTF '  TO DP013-DB2-TABLE-NAME (1)        11266008
112670              SET DP013-DB2-ABEND                                 11267008
112680                  DP013-XCTL-DISPLAY-RESTART                      11268008
112690                               TO TRUE                            11269008
112700              PERFORM DP013-0000-PROCESS-ABEND                    11270008
112710     END-EVALUATE.                                                11271008
112720                                                                  11272008
112730 8000-AUDIT-RECITM.                                               11273008
112740                                                                  11274008
112750     MOVE 'I'              TO RC031-TABLE-TO-AUDIT.               11275008
112760     MOVE 'B'              TO RC031-AUD-TYP-CDE.                  11276008
112770     MOVE 'U'              TO RC031-AUD-FUNC-CDE.                 11277008
112780     MOVE DK-PO-NBR        TO RC031-PO-NBR.                       11278008
112790     MOVE RECITM-ORD-LNE-NBR                                      11279008
112800                           TO RC031-PO-LNE-NBR.                   11280008
112810     MOVE DK-REC-SEQ-NBR   TO RC031-REC-SEQ-NBR.                  11281008
112820     MOVE DK-OPER-UNT-ID   TO RC031-OPER-UNT-ID.                  11282008
112830     MOVE DK-FCLTY-ID      TO RC031-FCLTY-ID.                     11283008
112840     MOVE PC-CURRENT-PROGRAM-NAME                                 11284008
112850                           TO RC031-UPD-PGM-ID.                   11285008
112860     EXEC CICS                                                    11286008
112870         LINK PROGRAM  (PC-AUDIT-RTN)                             11287008
112880              COMMAREA (RC031-FIELDS)                             11288008
112890              LENGTH   (PC-AUDIT-RTN-LENGTH)                      11289008
112900     END-EXEC.                                                    11290008
112910     EVALUATE TRUE                                                11291008
112920         WHEN RC031-CALL-SUCCESSFUL                               11292008
112930             CONTINUE                                             11293008
112940                                                                  11294008
112950         WHEN OTHER                                               11295008
112960              MOVE '8000-AUDIT-RECITM'                            11296008
112970                                    TO DP013-PARAGRAPH            11297008
112980              MOVE 'UNSUCCESSFUL CALL TO AUDIT RTN'               11298008
112990                                TO DP013-MESSAGE-TEXT (1)         11299008
113000              MOVE RC031-RETURN-DESC                              11300008
113010                                TO DP013-MESSAGE-TEXT (2)         11301008
113020              MOVE RC031-SQLCA      TO DP013-SQLCA                11302008
113030              SET DP013-DB2-ABEND                                 11303008
113040                  DP013-XCTL-DISPLAY-RESTART                      11304008
113050                                    TO TRUE                       11305008
113060              PERFORM DP013-0000-PROCESS-ABEND                    11306008
113070     END-EVALUATE.                                                11307008
113080                                                                  11308008
113090 8100-AUDIT-RECDIS.                                               11309008
113100                                                                  11310008
113110     EXEC SQL                                                     11311008
113120         SET :PV-DB2-TIMESTAMP = CURRENT TIMESTAMP                11312008
113130     END-EXEC.                                                    11313008
113140                                                                  11314008
113150     MOVE 'D'              TO RC031-TABLE-TO-AUDIT.               11315008
113160     MOVE 'B'              TO RC031-AUD-TYP-CDE.                  11316008
113170     MOVE 'U'              TO RC031-AUD-FUNC-CDE.                 11317008
113180     MOVE DK-PO-NBR        TO RC031-PO-NBR.                       11318008
113190     MOVE RECDIS-ORD-LNE-NBR                                      11319008
113200                           TO RC031-PO-LNE-NBR.                   11320008
113210     MOVE DK-REC-SEQ-NBR   TO RC031-REC-SEQ-NBR.                  11321008
113220     MOVE DK-OPER-UNT-ID   TO RC031-OPER-UNT-ID.                  11322008
113230     MOVE DK-FCLTY-ID      TO RC031-FCLTY-ID.                     11323008
113240     MOVE RECDIS-STR-NBR   TO RC031-STR-NBR.                      11324008
113250     MOVE PC-CURRENT-PROGRAM-NAME                                 11325008
113260                           TO RC031-UPD-PGM-ID.                   11326008
113270     MOVE DP020-USERID     TO RC031-UPD-UID.                      11327008
113280     MOVE PV-DB2-TIMESTAMP TO RC031-UPD-TMST.                     11328008
113290     EXEC CICS                                                    11329008
113300         LINK PROGRAM  (PC-AUDIT-RTN)                             11330008
113310              COMMAREA (RC031-FIELDS)                             11331008
113320              LENGTH   (PC-AUDIT-RTN-LENGTH)                      11332008
113330     END-EXEC.                                                    11333008
113340     EVALUATE TRUE                                                11334008
113350         WHEN RC031-CALL-SUCCESSFUL                               11335008
113360             CONTINUE                                             11336008
113370                                                                  11337008
113380         WHEN OTHER                                               11338008
113390              MOVE '8100-AUDIT-RECDIS'                            11339008
113400                                    TO DP013-PARAGRAPH            11340008
113410              MOVE 'UNSUCCESSFUL CALL TO AUDIT RTN'               11341008
113420                                TO DP013-MESSAGE-TEXT (1)         11342008
113430              MOVE RC031-RETURN-DESC                              11343008
113440                                TO DP013-MESSAGE-TEXT (2)         11344008
113450              MOVE RC031-SQLCA      TO DP013-SQLCA                11345008
113460              SET DP013-DB2-ABEND                                 11346008
113470                  DP013-XCTL-DISPLAY-RESTART                      11347008
113480                                    TO TRUE                       11348008
113490              PERFORM DP013-0000-PROCESS-ABEND                    11349008
113500     END-EVALUATE.                                                11350008
113510                                                                  11351008
113520 8200-AUDIT-RECEIV.                                               11352008
113530     MOVE 'V'              TO RC031-TABLE-TO-AUDIT.               11353008
113540     MOVE 'B'              TO RC031-AUD-TYP-CDE.                  11354008
113550     MOVE 'U'              TO RC031-AUD-FUNC-CDE.                 11355008
113560     MOVE DK-PO-NBR        TO RC031-PO-NBR.                       11356008
113570     MOVE DK-REC-SEQ-NBR   TO RC031-REC-SEQ-NBR.                  11357008
113580     MOVE DK-OPER-UNT-ID   TO RC031-OPER-UNT-ID.                  11358008
113590     MOVE DK-FCLTY-ID      TO RC031-FCLTY-ID.                     11359008
113600     EXEC CICS                                                    11360008
113610         LINK PROGRAM  (PC-AUDIT-RTN)                             11361008
113620              COMMAREA (RC031-FIELDS)                             11362008
113630              LENGTH   (PC-AUDIT-RTN-LENGTH)                      11363008
113640     END-EXEC.                                                    11364008
113650     EVALUATE TRUE                                                11365008
113660         WHEN RC031-CALL-SUCCESSFUL                               11366008
113670             CONTINUE                                             11367008
113680                                                                  11368008
113690         WHEN OTHER                                               11369008
113700            MOVE '8200-AUDIT-RECEIV'                              11370008
113710                            TO DP013-PARAGRAPH                    11371008
113720            MOVE 'UNSUCCESSFUL CALL TO AUDIT RTN'                 11372008
113730                        TO DP013-MESSAGE-TEXT (1)                 11373008
113740            MOVE RC031-RETURN-DESC                                11374008
113750                        TO DP013-MESSAGE-TEXT (2)                 11375008
113760            MOVE RC031-SQLCA      TO DP013-SQLCA                  11376008
113770            SET DP013-DB2-ABEND                                   11377008
113780                DP013-XCTL-DISPLAY-RESTART                        11378008
113790                                  TO TRUE                         11379008
113800            PERFORM DP013-0000-PROCESS-ABEND                      11380008
113810     END-EVALUATE.                                                11381008
113820                                                                  11382008
113830 8300-VALIDATION-MODULE.                                          11383008
113840                                                                  11384008
113850     EXEC CICS LINK                                               11385008
113860         PROGRAM  (PC-RCKCS806)                                   11386008
113870         COMMAREA (RC806-PRODUCT-PACK-VALIDATION)                 11387008
113880         RESP     (PV-CICS-RESP)                                  11388008
113890     END-EXEC.                                                    11389008
113900                                                                  11390008
113910     IF PV-CICS-RESP = DFHRESP(NORMAL)                            11391008
113920         CONTINUE                                                 11392008
113930     ELSE                                                         11393008
113940         SET DP013-CICS-ABEND                                     11394008
113950             DP013-NO-ROLLBACK   TO TRUE                          11395008
113960         MOVE '8300-VALIDATION-MODULE'                            11396008
113970                                 TO DP013-PARAGRAPH               11397008
113980         MOVE 'ATTEMPTING TO LINK TO PROGRAM RCKCS806'            11398008
113990                                 TO DP013-MESSAGE-TEXT (1)        11399008
114000         PERFORM DP013-0000-PROCESS-ABEND                         11400008
114010     END-IF.                                                      11401008
114020                                                                  11402008
114030******************************************************************11403008
114040**  CHECK TO SEE IF ASN IS ORIGINAL (CRE_UID = RCKUP006)        **11404008
114050******************************************************************11405008
114060 8400-CHECK-ASN.                                                  11406008
114070                                                                  11407008
114080*        MOVE ASC-SEQ-NBR(ASC-BLK-SUB ASC-ITEM-SUB)               11408008
114090*                                       TO DK-SEQ-NBR.            11409008
114100                                                                  11410008
114110         EXEC SQL                                                 11411008
114120           SELECT A.CRE_UID                                       11412008
114130           INTO  :PKSLIP-CRE-UID                                  11413008
114140           FROM   TPKSLIP A                                       11414008
114150           WHERE  A.PO_NBR       = :DK-PO-NBR                     11415008
114160             AND  A.SEQ_NBR      = :DK-SEQ-NBR                    11416008
114170             AND  A.CRE_TMST =                                    11417008
114180                 (SELECT MIN(B.CRE_TMST)                          11418008
114190                   FROM  TPKSLIP B                                11419008
114200                   WHERE A.PO_NBR = B.PO_NBR                      11420008
114210                   AND   A.SEQ_NBR = B.SEQ_NBR)                   11421008
114220         END-EXEC.                                                11422008
114230                                                                  11423008
114240         EVALUATE TRUE                                            11424008
114250             WHEN SQLCODE = ZERO                                  11425008
114260                  IF PKSLIP-CRE-UID = PC-RCKUP006                 11426008
114270                     SET PS-ORIG-ASN-PKSLIP-YES  TO TRUE          11427008
114280                  END-IF                                          11428008
114290             WHEN SQLCODE = +100                                  11429008
114300                  CONTINUE                                        11430008
114310             WHEN SQLCODE = -904                                  11431008
114320             WHEN SQLCODE = -911                                  11432008
114330             WHEN SQLCODE = -913                                  11433008
114340                  PERFORM 9900-SOFT-ABORT                         11434008
114350                                                                  11435008
114360             WHEN SQLWARN0 NOT = SPACES                           11436008
114370             WHEN SQLCODE  NOT = ZERO                             11437008
114380                  MOVE '8400-CHECK-ASN'                           11438008
114390                                 TO DP013-PARAGRAPH               11439008
114400                  MOVE 'UNSUCCESSFUL SELECT OF TPKSLIP'           11440008
114410                                 TO DP013-MESSAGE-TEXT (1)        11441008
114420*                 MOVE ASC-KEY-PO-NBR                             11442020
114430*                                TO PV-MSG-KEY-PO                 11443020
114440*                 MOVE DK-REC-SEQ-NBR                             11444020
114450*                                TO PV-MSG-KEY-REC-SEQ-NBR-N      11445020
114460*                 MOVE RECITM-ORD-LNE-NBR                         11446020
114470*                                TO PV-MSG-KEY-PO-LNE-NBR-N       11447020
114480*                 MOVE PV-MSG-KEYS                                11448020
114490*                                TO DP013-MESSAGE-TEXT (2)        11449020
114491                                                                  11449120
114492             MOVE SPACES TO PV-MSG-STRING-1                       11449220
114493             MOVE SPACES TO PV-MSG-STRING-2                       11449320
114494             MOVE SPACES TO PV-MSG-STRING-3                       11449420
114495             MOVE DK-PO-NBR         TO PV-DISP-PO                 11449520
114496             MOVE DK-REC-SEQ-NBR    TO PV-DISP-REC-SEQ-B          11449620
114497             MOVE DK-SEQ-NBR        TO PV-DISP-PKSL-NBR-B         11449720
114498                                                                  11449820
114499             STRING  PV-DISP-PO         '-'                       11449920
114500                     PV-DISP-REC-SEQ-B  '-'                       11450020
114501                     '  PACKSLIP SEQ:'                            11450120
114502                     PV-DISP-PKSL-NBR-B  DELIMITED BY SIZE        11450220
114503                                   INTO  PV-MSG-STRING-1          11450320
114504             MOVE PV-MSG-STRING-1  TO DP013-MESSAGE-TEXT (2)      11450420
114505                                                                  11450520
114506                  MOVE SQLCA     TO DP013-SQLCA                   11450608
114510                  MOVE 'TPKSLIP' TO DP013-DB2-TABLE-NAME (1)      11451008
114520                  SET DP013-DB2-ABEND                             11452008
114530                      DP013-XCTL-DISPLAY-RESTART                  11453008
114540                                 TO TRUE                          11454008
114550                  PERFORM DP013-0000-PROCESS-ABEND                11455008
114560         END-EVALUATE.                                            11456008
114570                                                                  11457008
114580******************************************************************11458008
114590* READ AN ITEM FROM THE INPUT SELECTED ITEMS TEMP STORAGE QUEUE. *11459008
114600******************************************************************11460008
114610 9100-READ-SEL-QUEUE.                                             11461008
114620                                                                  11462008
114630     EVALUATE DP020-INT-APPL-FORMAT-IND                           11463008
114640     WHEN PC-INTER-APPL-SHPPO-LST                                 11464008
114650         EXEC CICS                                                11465008
114660             READQ TS                                             11466008
114670                 QUEUE (ASC-SEL-QUEUE-NAME-IN)                    11467008
114680                 INTO  (TR018-SHIPMENT-SELECT-RECORD)             11468008
114690                 ITEM  (ASC-SEL-ITEM)                             11469008
114700                 RESP  (PV-CICS-RESP)                             11470008
114710         END-EXEC                                                 11471008
114720     WHEN PC-INTER-APPL-TRPPO-LST                                 11472008
114730         EXEC CICS                                                11473008
114740             READQ TS                                             11474008
114750                 QUEUE (ASC-SEL-QUEUE-NAME-IN)                    11475008
114760                 INTO  (DS002-PRINT-SELECT-RECORD)                11476008
114770                 ITEM  (ASC-SEL-ITEM)                             11477008
114780                 RESP  (PV-CICS-RESP)                             11478008
114790         END-EXEC                                                 11479008
114800     WHEN OTHER                                                   11480008
114810         EXEC CICS                                                11481008
114820             READQ TS                                             11482008
114830                 QUEUE (ASC-SEL-QUEUE-NAME-IN)                    11483008
114840                 INTO  (RC013-DC-SELECT-RECORD)                   11484008
114850                 ITEM  (ASC-SEL-ITEM)                             11485008
114860                 RESP  (PV-CICS-RESP)                             11486008
114870         END-EXEC                                                 11487008
114880     END-EVALUATE.                                                11488008
114890                                                                  11489008
114900     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        11490008
114910         CONTINUE                                                 11491008
114920     ELSE                                                         11492008
114930         SET DP013-LOGIC-ABEND                                    11493008
114940             DP013-NO-ROLLBACK     TO TRUE                        11494008
114950         MOVE '9100-READ-SEL-QUEUE'                               11495008
114960                                   TO DP013-PARAGRAPH             11496008
114970         MOVE 'ATTEMPTING TO READ TO LIST SELECTIONS TS QUEUE'    11497008
114980                                   TO DP013-MESSAGE-TEXT (1)      11498008
114990         MOVE ASC-KEY-PO-NBR     TO PV-MSG-KEY-PO                 11499008
115000         MOVE ASC-KEY-REC-SEQ-NBR                                 11500008
115010                                 TO PV-MSG-KEY-REC-SEQ-NBR-N      11501008
115020         MOVE PV-MSG-KEYS        TO DP013-MESSAGE-TEXT (2)        11502008
115030         PERFORM DP013-0000-PROCESS-ABEND                         11503008
115040     END-IF.                                                      11504008
115050/                                                                 11505008
115060******************************************************************11506008
115070* UPDATE AN ITEM IN THE INPUT SELECTED ITEMS TEMP STORAGE QUEUE. *11507008
115080******************************************************************11508008
115090 9200-REWRITE-LIST-QUEUE.                                         11509008
115100                                                                  11510008
115110     EVALUATE DP020-INT-APPL-FORMAT-IND                           11511008
115120     WHEN PC-INTER-APPL-TRPPO-LST                                 11512008
115130         EXEC CICS                                                11513008
115140              WRITEQ TS                                           11514008
115150                  QUEUE   (ASC-SEL-QUEUE-NAME-IN)                 11515008
115160                  FROM    (DS002-PRINT-SELECT-RECORD)             11516008
115170                  ITEM    (ASC-SEL-ITEM)                          11517008
115180                  RESP    (PV-CICS-RESP)                          11518008
115190                  REWRITE                                         11519008
115200         END-EXEC                                                 11520008
115210     WHEN OTHER                                                   11521008
115220         EXEC CICS                                                11522008
115230              WRITEQ TS                                           11523008
115240                  QUEUE   (ASC-SEL-QUEUE-NAME-IN)                 11524008
115250                  FROM    (RC013-DC-SELECT-RECORD)                11525008
115260                  ITEM    (ASC-SEL-ITEM)                          11526008
115270                  RESP    (PV-CICS-RESP)                          11527008
115280                  REWRITE                                         11528008
115290         END-EXEC                                                 11529008
115300     END-EVALUATE.                                                11530008
115310                                                                  11531008
115320     IF PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                    11532008
115330         SET DP013-CICS-ABEND                                     11533008
115340             DP013-NO-ROLLBACK     TO TRUE                        11534008
115350         MOVE '9200-REWRITE-LIST-QUEUE'                           11535008
115360                                   TO DP013-PARAGRAPH             11536008
115370         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   11537008
115380                                   TO DP013-MESSAGE-TEXT (1)      11538008
115390         MOVE ASC-KEY-PO-NBR     TO PV-MSG-KEY-PO                 11539008
115400         MOVE ASC-KEY-REC-SEQ-NBR                                 11540008
115410                                 TO PV-MSG-KEY-REC-SEQ-NBR-N      11541008
115420         MOVE PV-MSG-KEYS        TO DP013-MESSAGE-TEXT (2)        11542008
115430         PERFORM DP013-0000-PROCESS-ABEND                         11543008
115440     END-IF.                                                      11544008
115450/                                                                 11545008
115460******************************************************************11546008
115470*    THIS PARAGRAPH CALLS THE FOLLOWING PARAGRAPH:                11547008
115480*    - 9321 INQUIRES IN TABLE TALLPLN FOR CURR-SPLIT-QTY          11548008
115490*    - 9322 INQUIRES IN TABLE TMESTDS FOR STR-PLAN-QTY            11549008
115500*    IT THEN DETERMINES WHETHER THE RECEIPT SHOULD EITHER         11550008
115510*    BE A MASTER OR SPECIFIC PLAN.                                11551008
115520******************************************************************11552008
115530 9310-FIND-OUT-PLAN.                                              11553008
115540                                                                  11554008
115550     SET PS-NOT-DONE   TO  TRUE.                                  11555008
115560                                                                  11556008
115570     SET PS-MASTER-PLAN TO TRUE.                                  11557008
115580                                                                  11558008
115590     MOVE RECITM-ORD-LNE-NBR TO PURITM-APP-PO-LNE-NBR.            11559008
115600                                                                  11560008
115610     PERFORM 7330-SELECT-PURITM.                                  11561008
115620                                                                  11562008
115630     IF PS-PURITM-NOT-FOUND                                       11563008
115640         SET PS-DONE TO TRUE                                      11564008
115650     END-IF.                                                      11565008
115660                                                                  11566008
115670     IF PS-NOT-DONE                                               11567008
115680         PERFORM 9311-GET-TALLPLN-RECORD                          11568008
115690     END-IF.                                                      11569008
115700                                                                  11570008
115710     IF PS-NOT-DONE                                               11571008
115720         PERFORM 9312-GET-TMESTDS-RECORD                          11572008
115730     END-IF.                                                      11573008
115740                                                                  11574008
115750     IF PS-NOT-DONE                                               11575008
115760         IF ALLPLN-CURR-SPLIT-QTY = PV-SUM-STR-PLAN-QTY           11576008
115770             SET PS-MASTER-PLAN   TO TRUE                         11577008
115780         ELSE                                                     11578008
115790             SET PS-SPECIFIC-PLAN TO TRUE                         11579008
115800         END-IF                                                   11580008
115810     END-IF.                                                      11581008
115820                                                                  11582008
115830******************************************************************11583008
115840*    THIS PARAGRAPH RETRIEVES THE PLAN NUMBER AND THE             11584008
115850*    CURR-SPLIT-QTY FROM TABLE TALLPLN.                           11585008
115860******************************************************************11586008
115870 9311-GET-TALLPLN-RECORD.                                         11587008
115880                                                                  11588008
115890         EXEC SQL                                                 11589008
115900              SELECT PLAN_NBR                                     11590008
115910                   , CURR_SPLIT_QTY                               11591008
115920                INTO :ALLPLN-PLAN-NBR                             11592008
115930                   , :ALLPLN-CURR-SPLIT-QTY                       11593008
115940                FROM TALLPLN                                      11594008
115950               WHERE PO_NBR      = :DK-PO-NBR                     11595008
115960                 AND PO_LNE_NBR  = :PURITM-PO-LNE-NBR             11596008
115970                 AND DEST_NBR    = :DK-OPER-UNT-ID                11597008
115980                 AND STATUS_CDE  = 'AC'                           11598008
115990         END-EXEC                                                 11599008
116000                                                                  11600008
116010         EVALUATE TRUE                                            11601008
116020             WHEN SQLCODE = +0                                    11602008
116030                  CONTINUE                                        11603008
116040             WHEN SQLCODE = +100                                  11604008
116050                  SET PS-DONE      TO TRUE                        11605008
116060             WHEN SQLCODE = -904                                  11606008
116070             WHEN SQLCODE = -911                                  11607008
116080             WHEN SQLCODE = -913                                  11608008
116090                  PERFORM 9900-SOFT-ABORT                         11609008
116100                                                                  11610008
116110             WHEN OTHER                                           11611008
116120                 MOVE '9311-GET-TALLPLN-RECORD'                   11612008
116130                                   TO DP013-PARAGRAPH             11613008
116140                 MOVE 'SELECT TALLPLN ROW'                        11614008
116150                                   TO DP013-MESSAGE-TEXT (1)      11615008
116160                 MOVE SQLCA        TO DP013-SQLCA                 11616008
116170                 MOVE 'TALLPLN'    TO DP013-DB2-TABLE-NAME (1)    11617008
116180                 MOVE ASC-KEY-PO-NBR                              11618008
116190                                   TO PV-MSG-KEY-PO               11619008
116200                 MOVE ASC-KEY-REC-SEQ-NBR                         11620008
116210                                   TO PV-MSG-KEY-REC-SEQ-NBR-N    11621008
116220                 MOVE PURITM-PO-LNE-NBR                           11622008
116230                                   TO PV-MSG-KEY-PO-LNE-NBR-N     11623008
116240                 MOVE PV-MSG-KEYS  TO DP013-MESSAGE-TEXT (2)      11624008
116250                 SET DP013-DB2-ABEND                              11625008
116260                                   TO TRUE                        11626008
116270                 SET DP013-XCTL-DISPLAY-RESTART                   11627008
116280                                   TO TRUE                        11628008
116290                 PERFORM DP013-0000-PROCESS-ABEND                 11629008
116300         END-EVALUATE.                                            11630008
116310                                                                  11631008
116320******************************************************************11632008
116330*    THIS PARAGRAPH RETRIEVES THE SUM OF ALL THE STORE PLAN       11633008
116340*    QTY FROM TABLE TMESTDS.                                      11634008
116350******************************************************************11635008
116360                                                                  11636008
116370 9312-GET-TMESTDS-RECORD.                                         11637008
116380                                                                  11638008
116390     MOVE ZERO                     TO PV-SUM-STR-PLAN-QTY.        11639008
116400                                                                  11640008
116410         EXEC SQL                                                 11641008
116420              SELECT SUM(STR_DISTRO_QTY)                          11642008
116430                INTO :PV-SUM-STR-PLAN-QTY :PV-STR-PLAN-IND        11643008
116440                FROM TMESTDS                                      11644008
116450               WHERE PO_NBR     = :DK-PO-NBR                      11645008
116460                 AND PO_LNE_NBR = :PURITM-PO-LNE-NBR              11646008
116470                 AND PLAN_NBR   = :ALLPLN-PLAN-NBR                11647008
116480         END-EXEC                                                 11648008
116490                                                                  11649008
116500         EVALUATE TRUE                                            11650008
116510             WHEN SQLCODE = +0                                    11651008
116520                  IF PV-SUM-STR-PLAN-QTY < 0                      11652008
116530                      MOVE 0 TO PV-SUM-STR-PLAN-QTY               11653008
116540                  END-IF                                          11654008
116550             WHEN SQLCODE = +100                                  11655008
116560                  CONTINUE                                        11656008
116570             WHEN SQLCODE = -904                                  11657008
116580             WHEN SQLCODE = -911                                  11658008
116590             WHEN SQLCODE = -913                                  11659008
116600                  PERFORM 9900-SOFT-ABORT                         11660008
116610                                                                  11661008
116620             WHEN SQLWARN0 NOT = SPACES                           11662008
116630             WHEN SQLCODE < +0                                    11663008
116640             WHEN SQLCODE > +0                                    11664008
116650                 MOVE '9312-GET-TMESTDS-RECORD'                   11665008
116660                                   TO DP013-PARAGRAPH             11666008
116670                 MOVE 'SELECT TMESTDS ROW'                        11667008
116680                                   TO DP013-MESSAGE-TEXT (1)      11668008
116690                 MOVE ASC-KEY-PO-NBR                              11669008
116700                                   TO PV-MSG-KEY-PO               11670008
116710                 MOVE ASC-KEY-REC-SEQ-NBR                         11671008
116720                                   TO PV-MSG-KEY-REC-SEQ-NBR-N    11672008
116730                 MOVE PURITM-PO-LNE-NBR                           11673008
116740                                   TO PV-MSG-KEY-PO-LNE-NBR-N     11674008
116750                 MOVE PV-MSG-KEYS  TO DP013-MESSAGE-TEXT (3)      11675008
116760                 MOVE SQLCA        TO DP013-SQLCA                 11676008
116770                 MOVE 'TMESTDS'    TO DP013-DB2-TABLE-NAME (1)    11677008
116780                 SET DP013-DB2-ABEND                              11678008
116790                                   TO TRUE                        11679008
116800                 SET DP013-XCTL-DISPLAY-RESTART                   11680008
116810                                   TO TRUE                        11681008
116820                 PERFORM DP013-0000-PROCESS-ABEND                 11682008
116830         END-EVALUATE.                                            11683008
116840                                                                  11684008
116850 9410-PREPARE-TRECDIS.                                            11685008
116860                                                                  11686008
116870     INITIALIZE DCLTRECDIS.                                       11687008
116880                                                                  11688008
116890     MOVE DK-PO-NBR          TO RECDIS-ORD-NBR.                   11689008
116900     MOVE PV-PKSL-LNE-NBR    TO RECDIS-ORD-LNE-NBR.               11690008
116910     MOVE DK-REC-SEQ-NBR     TO RECDIS-REC-SEQ-NBR.               11691008
116920     MOVE DK-OPER-UNT-ID     TO RECDIS-OPER-UNT-ID.               11692008
116930     MOVE PC-CURRENT-PROGRAM-NAME                                 11693008
116940                             TO RECDIS-CRE-UID.                   11694008
116950     MOVE 'A'                TO RECDIS-VER-STATUS-CDE.            11695008
116960     MOVE PV-LINE-QTY        TO RECDIS-EXPTED-ITM-QTY             11696008
116970                                RECDIS-VERIFY-ITM-QTY.            11697008
116980     MOVE LQW-STR-DEST-NBR   (LQW-IDX)                            11698008
116990                             TO RECDIS-STR-NBR.                   11699008
117000     MOVE 1                  TO RECDIS-FCLTY-ID.                  11700008
117010     MOVE 1                  TO RECDIS-STR-FCLTY-ID.              11701008
117020                                                                  11702008
117030     MOVE PC-DEFAULT-DATE    TO RECDIS-AP-PRC-DTE.                11703008
117040                                                                  11704008
117050                                                                  11705008
117060 9420-INSERT-TRECDIS.                                             11706008
117070                                                                  11707008
117080         EXEC SQL                                                 11708008
117090              INSERT INTO TRECDIS                                 11709008
117100                     (ORD_NBR                                     11710008
117110                   ,  ORD_LNE_NBR                                 11711008
117120                   ,  REC_SEQ_NBR                                 11712008
117130                   ,  OPER_UNT_ID                                 11713008
117140                   ,  FCLTY_ID                                    11714008
117150                   ,  CRE_TMST                                    11715008
117160                   ,  CRE_UID                                     11716008
117170                   ,  VER_STATUS_CDE                              11717008
117180                   ,  EXPTED_ITM_QTY                              11718008
117190                   ,  VERIFY_ITM_QTY                              11719008
117200                   ,  AP_VERIFY_ITM_QTY                           11720008
117210                   ,  STR_NBR                                     11721008
117220                   ,  STR_FCLTY_ID                                11722008
117230                   ,  PLAN_ITM_QTY                                11723008
117240                   ,  AP_PRC_CDE                                  11724008
117250                   ,  AP_PRC_DTE)                                 11725008
117260              VALUES (:RECDIS-ORD-NBR                             11726008
117270                   ,  :RECDIS-ORD-LNE-NBR                         11727008
117280                   ,  :RECDIS-REC-SEQ-NBR                         11728008
117290                   ,  :RECDIS-OPER-UNT-ID                         11729008
117300                   ,  :RECDIS-FCLTY-ID                            11730008
117310                   ,  CURRENT TIMESTAMP                           11731008
117320                   ,  :RECDIS-CRE-UID                             11732008
117330                   ,  :RECDIS-VER-STATUS-CDE                      11733008
117340                   ,  :RECDIS-EXPTED-ITM-QTY                      11734008
117350                   ,  :RECDIS-VERIFY-ITM-QTY                      11735008
117360                   ,  :RECDIS-AP-VERIFY-ITM-QTY                   11736008
117370                   ,  :RECDIS-STR-NBR                             11737008
117380                   ,  :RECDIS-STR-FCLTY-ID                        11738008
117390                   ,  :RECDIS-PLAN-ITM-QTY                        11739008
117400                   ,  :RECDIS-AP-PRC-CDE                          11740008
117410                   ,  :RECDIS-AP-PRC-DTE)                         11741008
117420         END-EXEC                                                 11742008
117430                                                                  11743008
117440         EVALUATE TRUE                                            11744008
117450             WHEN SQLCODE = +0                                    11745008
117460                  CONTINUE                                        11746008
117470             WHEN SQLCODE = -904                                  11747008
117480             WHEN SQLCODE = -911                                  11748008
117490             WHEN SQLCODE = -913                                  11749008
117500                  PERFORM 9900-SOFT-ABORT                         11750008
117510             WHEN SQLCODE = -803                                  11751008
117520                 PERFORM 7625-SELECT-STR-RECDIS                   11752008
117530                 PERFORM 8100-AUDIT-RECDIS                        11753008
117540                 PERFORM 7637-UPDATE-RECDIS                       11754008
117550                                                                  11755008
117560             WHEN OTHER                                           11756008
117570                 MOVE '9420-INSERT-TRECDIS'                       11757008
117580                                   TO DP013-PARAGRAPH             11758008
117590                 MOVE 'DB2 ERROR INSERTING A PACK BY STR RECDIS'  11759008
117600                                   TO DP013-MESSAGE-TEXT (1)      11760008
117610                 MOVE ASC-KEY-PO-NBR                              11761008
117620                                   TO PV-MSG-KEY-PO               11762008
117630                 MOVE ASC-KEY-REC-SEQ-NBR                         11763008
117640                                   TO PV-MSG-KEY-REC-SEQ-NBR-N    11764008
117650                 MOVE RECDIS-ORD-LNE-NBR                          11765008
117660                                   TO PV-MSG-KEY-PO-LNE-NBR-N     11766008
117670                 MOVE RECDIS-STR-NBR                              11767008
117680                                   TO PV-MSG-KEY-STR-NBR          11768008
117690                 MOVE PV-MSG-KEYS  TO DP013-MESSAGE-TEXT (3)      11769008
117700                 MOVE SQLCA        TO DP013-SQLCA                 11770008
117710                 MOVE 'TRECDIS'    TO DP013-DB2-TABLE-NAME (1)    11771008
117720                 SET DP013-DB2-ABEND                              11772008
117730                                   TO TRUE                        11773008
117740                 SET DP013-XCTL-DISPLAY-RESTART                   11774008
117750                                   TO TRUE                        11775008
117760                 PERFORM DP013-0000-PROCESS-ABEND                 11776008
117770             END-EVALUATE.                                        11777008
117780                                                                  11778008
117790*9450-INACTIVATE-ALLPLN.                                          11779008
117800                                                                  11780008
117810*        EXEC SQL                                                 11781008
117820*             UPDATE TALLPLN                                      11782008
117830*                SET STATUS_CDE = 'IN'                            11783008
117840*              WHERE PO_NBR     = :DK-PO-NBR                      11784008
117850*                AND PO_LNE_NBR = :PURITM-PO-LNE-NBR              11785008
117860*                AND DEST_NBR   = :DK-OPER-UNT-ID                 11786008
117870*                AND STATUS_CDE = 'AC'                            11787008
117880*        END-EXEC                                                 11788008
117890                                                                  11789008
117900*        EVALUATE TRUE                                            11790008
117910*            WHEN SQLCODE = +0                                    11791008
117920*            WHEN SQLCODE = +100                                  11792008
117930*                 CONTINUE                                        11793008
117940*            WHEN SQLCODE = -904                                  11794008
117950*            WHEN SQLCODE = -911                                  11795008
117960*            WHEN SQLCODE = -913                                  11796008
117970*                 PERFORM 9900-SOFT-ABORT                         11797008
117980                                                                  11798008
117990*            WHEN OTHER                                           11799008
118000*                MOVE '9450-INACTIVATE-ALLPLN'                    11800008
118010*                                  TO DP013-PARAGRAPH             11801008
118020*                MOVE 'DB2 ERROR UPDATING THE TALLPLN'            11802008
118030*                                  TO DP013-MESSAGE-TEXT (1)      11803008
118040*                MOVE ASC-KEY-PO-NBR                              11804008
118050*                                  TO PV-MSG-KEY-PO               11805008
118060*                MOVE ASC-KEY-REC-SEQ-NBR                         11806008
118070*                                  TO PV-MSG-KEY-REC-SEQ-NBR-N    11807008
118080*                MOVE PURITM-PO-LNE-NBR                           11808008
118090*                                  TO PV-MSG-KEY-PO-LNE-NBR-N     11809008
118100*                MOVE PV-MSG-KEYS  TO DP013-MESSAGE-TEXT (3)      11810008
118110*                MOVE SQLCA        TO DP013-SQLCA                 11811008
118120*                MOVE 'TALLPLN'    TO DP013-DB2-TABLE-NAME (1)    11812008
118130*                SET DP013-DB2-ABEND                              11813008
118140*                                  TO TRUE                        11814008
118150*                SET DP013-XCTL-DISPLAY-RESTART                   11815008
118160*                                  TO TRUE                        11816008
118170*                PERFORM DP013-0000-PROCESS-ABEND                 11817008
118180*        END-EVALUATE.                                            11818008
118190                                                                  11819008
118200******************************************************************11820008
118210*    THE DB2 RESOURCE IS NOT AVAILABLE, SET THE ERROR MESSAGE    *11821008
118220*    AND THE ERROR SWITCHES.                                     *11822008
118230******************************************************************11823008
118240 9900-SOFT-ABORT.                                                 11824008
118250                                                                  11825008
118260* TMKCS508 WILL WRITE TROUBLE ROWS AS PART OF ITS                 11826008
118270* ERROR HANDLING.  WE MUST KEEP THESE TROUBLE ROWS.               11827008
118280     EVALUATE TRUE                                                11828008
118290         WHEN TM500-SKU-NOT-FOUND-FOR-LINE                        11829008
118300         WHEN TM500-PREPACK-ERROR                                 11830008
118310         WHEN TM508-MSG-NUMBER = ZERO                             11831008
118320             PERFORM 9901-BACKOUT                                 11832008
118330         WHEN OTHER                                               11833008
118340             PERFORM 9902-SYNCPOINT                               11834008
118350     END-EVALUATE.                                                11835008
118360                                                                  11836008
118370* IF THE LOCKOUT OCCURED WHILE BUILDING THE INITIAL PANEL,        11837008
118380* WE CAN ONLY QUIT THE PROGRAM IMMEDIATELY OTHERWISE WE MIGHT     11838008
118390* LOOP FOREVER.  WE SHOULD REBUILD THE PANEL BEFORE               11839008
118400* RETURNING TO THE ARCHITECTURE.                                  11840008
118410     IF PS-INITIAL-PANEL                                          11841008
118420         CONTINUE                                                 11842008
118430     ELSE                                                         11843008
118440         PERFORM 2050-DELETE-LIST-QUEUE                           11844008
118450         PERFORM 4000-BUILD-INITIAL-PANEL                         11845008
118460     END-IF.                                                      11846008
118470                                                                  11847008
118480     EVALUATE TRUE                                                11848008
118490         WHEN TM500-PREPACK-DB2-TIMEOUT                           11849008
118500             MOVE PC-TSYMSG-00551     TO DP020-MSG-NUMBER         11850008
118510         WHEN TM500-SKU-NOT-FOUND-FOR-LINE                        11851008
118520             MOVE PC-TSYMSG-01843     TO DP020-MSG-NUMBER         11852008
118530             MOVE TM500-PO-LNE-NBR    TO PV-ZAP-NUMBER            11853008
118540             MOVE PV-ZAP-NUMBER       TO DP020-MSG-TEXT           11854008
118550         WHEN TM508-MSG-NUMBER = ZERO                             11855008
118560             MOVE PC-TSYMSG-00551 TO DP020-MSG-NUMBER             11856008
118570         WHEN OTHER                                               11857008
118580             MOVE TM508-MSG-NUMBER TO DP020-MSG-NUMBER            11858008
118590     END-EVALUATE                                                 11859008
118600                                                                  11860008
118610     SET PS-ERROR         TO TRUE                                 11861008
118620     SET DP020-MSG-FATAL  TO TRUE                                 11862008
118630     MOVE 'PROGRAM EXIT CALL' TO DP013-MESSAGE-TEXT (1)           11863008
118640     PERFORM 0001-CALL-CICS-ARCH-API.                             11864008
118650                                                                  11865008
118660 9901-BACKOUT.                                                    11866008
118670     EXEC CICS SYNCPOINT                                          11867008
118680          ROLLBACK                                                11868008
118690     END-EXEC.                                                    11869008
118700                                                                  11870008
118710 9902-SYNCPOINT.                                                  11871008
118720     EXEC CICS SYNCPOINT                                          11872008
118730     END-EXEC.                                                    11873008
118740                                                                  11874008
118750 9903-WRITE-CICS-LOG.                                             11875008
118760                                                                  11876008
118770     EXEC CICS                                                    11877008
118780         WRITEQ TD                                                11878008
118790             QUEUE  ('CSSL')                                      11879008
118800             FROM   (PV-CICS-MSG-AREA)                            11880008
118810             RESP   (PV-CICS-RESP)                                11881008
118820     END-EXEC.                                                    11882008
118830     MOVE SPACES                  TO PV-CICS-MSG-AREA.            11883008
118840/                                                                 11884008
118850******************************************************************11885008
118860*    ABEND PROCESSING                                             11886008
118870******************************************************************11887008
118880     COPY DPPD013.                                                11888008
