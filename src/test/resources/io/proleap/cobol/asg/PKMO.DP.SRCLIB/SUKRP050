000100***************************************************************** 00010001
000200 IDENTIFICATION DIVISION.                                         00020001
000300***************************************************************** 00030001
000400*                                                                 00040001
000500 PROGRAM-ID.             SUKRP050.                                00050019
000600 AUTHOR.                 PAUL JORGENSEN.                          00060019
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070019
000800 DATE-WRITTEN.           MAY 2006.                                00080019
000900 DATE-COMPILED.                                                   00090001
001000*                                                                 00100001
001100***************************************************************** 00110001
001200*  THIS PROGRAM WILL BE USED TO CREATE A REPORT LISTING ALL OF THE00120001
001300*  UNKNOWN/EMPTY CARTONS THAT PREVIOUSLY WERE LOADED ONTO TRAILERS00130020
001300*  AND HAVE FINALLY MANIFESTED                                    00131020
001400***************************************************************** 00140001
001500 ENVIRONMENT DIVISION.                                            00150001
001600***************************************************************** 00160001
001700 CONFIGURATION SECTION.                                           00170001
001800 SOURCE-COMPUTER.                        IBM-3090.                00180001
001900 OBJECT-COMPUTER.                        IBM-3090.                00190001
002000 INPUT-OUTPUT SECTION.                                            00200001
002100 FILE-CONTROL.                                                    00210001
002200                                                                  00220001
002300     SELECT SML-EMPTY-UNKNOWN-FILE                                00230042
002400         ASSIGN TO INP01.                                         00240001
002500                                                                  00250001
002300     SELECT STILL-EMPTY-UNKNOWN-FILE                              00251042
002400         ASSIGN TO OUT01.                                         00252099
002500                                                                  00253042
002600     SELECT REPORT-FILE-1                                         00260001
002700         ASSIGN TO RPT01.                                         00270001
002800                                                                  00280001
002900***************************************************************** 00290001
003000 DATA DIVISION.                                                   00300001
003100***************************************************************** 00310001
003200 FILE SECTION.                                                    00320001
003300                                                                  00330001
003400 FD  SML-EMPTY-UNKNOWN-FILE                                       00340099
003500     RECORDING MODE IS F                                          00350001
003600     LABEL RECORDS ARE STANDARD                                   00360001
003700     BLOCK CONTAINS 0 RECORDS.                                    00370001
003800 01  SML-EMPTY-UNKNOWN-RECORD         PIC X(150).                 00380099
003300                                                                  00381099
003400 FD  STILL-EMPTY-UNKNOWN-FILE                                     00382099
003500     RECORDING MODE IS F                                          00383099
003600     LABEL RECORDS ARE STANDARD                                   00384099
003700     BLOCK CONTAINS 0 RECORDS.                                    00385099
003800 01  STILL-EMPTY-UNKNOWN-RECORD       PIC X(150).                 00386099
003900                                                                  00390001
004000 FD  REPORT-FILE-1                                                00400001
004100     RECORDING MODE IS F                                          00410001
004200     BLOCK CONTAINS 0 RECORDS.                                    00420001
004300 01  REPORT-RECORD-1                  PIC X(132).                 00430001
004400                                                                  00440001
004500/                                                                 00450001
004600***************************************************************** 00460001
004700 WORKING-STORAGE SECTION.                                         00470001
004800***************************************************************** 00480001
004900                                                                  00490001
005000 01  PS-SWITCHES.                                                 00500001
005100     05  PS-END-OF-CURSOR-SW          PIC X(01) VALUE 'N'.        00510050
005200         88  PS-END-OF-CURSOR-YES               VALUE 'Y'.        00520050
005300         88  PS-END-OF-CURSOR-NO                VALUE 'N'.        00530050
005400     05  PS-END-OF-INPUT-FILE-SW      PIC X(01) VALUE 'N'.        00540001
005500         88  PS-END-OF-INPUT                    VALUE 'Y'.        00550001
005600         88  PS-NOT-END-OF-INPUT                VALUE 'N'.        00560001
005700     05  PS-PAGE-SW                   PIC X(01) VALUE 'N'.        00570001
005800         88  PS-NEW-PAGE                        VALUE 'Y'.        00580001
005900         88  PS-SAME-PAGE                       VALUE 'N'.        00590001
004900     05  PS-CARTON-UNITS-MNFSTED-SW   PIC X(01) VALUE ' '.        00591099
005000         88  PS-CARTON-UNITS-MNFSTED-YES      VALUE 'Y'.          00593041
005100         88  PS-CARTON-UNITS-MNFSTED-NO       VALUE 'N'.          00594041
006300                                                                  00630001
006400 01  DK-DB2-KEYS.                                                 00640001
006500     05  DK-RUN-DATE                  PIC X(10).                  00650001
006600     05  DK-WEEK-END-DATE             PIC X(10).                  00660001
006700     05  DK-OPER-ID                   PIC S9(4) COMP.             00670001
006800     05  DK-DB2-TMST-1                PIC X(26).                  00680001
006900     05  DK-DB2-TMST-2                PIC X(26).                  00690001
007000                                                                  00700001
007100 01  DN-NULL-INDICATORS.                                          00710001
007200     05  DN-LOC-NULL                  PIC S9(04) COMP VALUE ZERO. 00720001
007300     05  DN-CART-NULL                 PIC S9(04) COMP VALUE ZERO. 00730001
007400     05  DN-DOOR-NULL                 PIC S9(04) COMP VALUE ZERO. 00740001
007500                                                                  00750001
007600 01  PV-DATE-RECORD.                                              00760001
007700     05  PV-FROM-DATE                 PIC X(10) VALUE SPACES.     00770001
007800     05  FILLER                       PIC X(01) VALUE SPACES.     00780001
007900     05  PV-TO-DATE                   PIC X(10) VALUE SPACES.     00790001
008000                                                                  00800001
007600 01  PV-PURGE-COMPARE-DATES.                                      00801099
007700     05  PV-CURRENT-DATE              PIC X(10) VALUE SPACES.     00802099
007900     05  PV-PURGE-DATE                PIC X(10) VALUE SPACES.     00804099
008100 01  SD-SYSTEM-DATE.                                              00810001
008200     05  SD-SYSTEM-DATE-YY          PIC  9(02)   VALUE ZERO.      00820001
008300     05  SD-SYSTEM-DATE-MM          PIC  9(02)   VALUE ZERO.      00830001
008400     05  SD-SYSTEM-DATE-DD          PIC  9(02)   VALUE ZERO.      00840001
008500                                                                  00850001
008600 01  ST-SYSTEM-TIME.                                              00860001
008700     05  ST-SYSTEM-HOUR             PIC  9(02)   VALUE ZERO.      00870001
008800     05  ST-SYSTEM-MINUTE           PIC  9(02)   VALUE ZERO.      00880001
008900     05  FILLER                     PIC  9(04)   VALUE ZERO.      00890001
009000                                                                  00900001
009100 01  PV-VARIABLES.                                                00910001
009200     05  PV-SCAN-OFF-TMST             PIC X(26).                  00920001
009300     05  PV-READ-COUNT                PIC S9(7) COMP-3            00930001
009400                                                VALUE ZERO.       00940001
009700     05  PV-FETCH-COUNT               PIC S9(7) COMP-3            00970052
009800                                                VALUE ZERO.       00980001
009900     05  PV-WRITE-COUNT               PIC S9(7) COMP-3            00990001
010000                                                VALUE ZERO.       01000001
009900     05  PV-PURGE-CARTON-COUNT        PIC S9(9) COMP-3            01001099
010000                                                VALUE ZERO.       01002099
009900     05  PV-INPUT-PROCESSED-COUNT     PIC S9(9) COMP-3            01003099
010000                                                VALUE ZERO.       01004099
010100     05  PV-PAGE-COUNT                PIC S9(3) COMP-3            01010001
010200                                                VALUE ZERO.       01020001
010300     05  PV-LINE-COUNT                PIC S9(04) VALUE ZERO       01030001
010400                                                 COMP SYNC.       01040001
010500     05  PV-TRANS-QTY                 PIC S9(07) VALUE ZERO       01050001
010600                                                 COMP SYNC.       01060001
010700     05  PV-DC-TRANS-QTY              PIC S9(07) VALUE ZERO       01070001
010800                                                 COMP SYNC.       01080001
007700     05  PV-UNT-QTY-SUM               PIC S9(09) VALUE ZERO       01090052
007800                                                  COMP.           01100052
012800***************************************************************   01280001
012900     05  PV-DISPLAY-COUNT             PIC ZZZ,ZZZ,ZZ9.            01290001
015100     05  PV-DISP-SHIPT-UNT-ID         PIC 9(20).                  01291053
013400     05  PV-PREV-DC                   PIC S9(04) COMP VALUE ZERO. 01291199
015100     05  PV-PREV-SHIPT-UNT-ID         PIC S9(18)V COMP-3          01292099
                                                            VALUE ZERO. 01293099
013600     05  PV-PREV-PO-NBR               PIC S9(09) COMP.            01360001
013800     05  PV-PREV-RCVR-NBR             PIC S9(04) COMP.            01380037
014700                                                                  01470001
014800     05  PV-DB2-FUNCTION              PIC X(30) VALUE SPACES.     01480001
014900     05  PV-DB2-TABLE-NAME            PIC X(30) VALUE SPACES.     01490001
015000     05  PV-PARAGRAPH                 PIC X(30) VALUE SPACES.     01500001
015100     05  PV-DISPLAY-HOST-VAR          PIC X(18) VALUE SPACES.     01510001
015200     05  PV-DISP-NUMBER               PIC Z,ZZZ,ZZ9.              01520001
015300     05  PV-DISP-LOC                  PIC  9(4).                  01530099
015400                                                                  01540001
015500     05  PV-RUN-DATE                  PIC X(10) VALUE SPACES.     01550001
015600     05  PV-SAVE-START-DATE           PIC X(10) VALUE SPACES.     01560001
015700     05  PV-ERROR-MESSAGE-1           PIC X(60)  VALUE SPACES.    01570001
015800     05  PV-ERROR-MESSAGE-2           PIC X(60)  VALUE SPACES.    01580001
017300                                                                  01730001
017400******************************************************************01740001
017500 01  PV-DATE-FIELDS.                                              01740132
018900     05  PV-DIVERT-DATE               PIC  X(10).                 01741031
           05  FILLER REDEFINES PV-DIVERT-DATE.                         01742031
019100         10 FILLER                    PIC  X(02).                 01743031
019000         10 PV-DIVERT-DATE-YY         PIC  X(02).                 01744031
019300         10 FILLER                    PIC  X(01).                 01745031
019200         10 PV-DIVERT-DATE-MM         PIC  X(02).                 01746031
019300         10 FILLER                    PIC  X(01).                 01747031
019400         10 PV-DIVERT-DATE-DD         PIC  X(02).                 01748031
018900     05  PV-DIVERT-TIME               PIC  X(08).                 01749031
           05  FILLER REDEFINES PV-DIVERT-TIME.                         01749131
019000         10 PV-DIVERT-TIME-HH         PIC  X(02).                 01749231
019100         10 FILLER                    PIC  X(01).                 01749331
019200         10 PV-DIVERT-TIME-MM         PIC  X(02).                 01749431
019300         10 FILLER                    PIC  X(01).                 01749531
019400         10 PV-DIVERT-TIME-SS         PIC  X(02).                 01749631
018900     05  PV-CREATE-DATE               PIC  X(10).                 01749731
           05  FILLER REDEFINES PV-CREATE-DATE.                         01749831
019100         10 FILLER                    PIC  X(02).                 01749931
019000         10 PV-CREATE-DATE-YY         PIC  X(02).                 01750031
019300         10 FILLER                    PIC  X(01).                 01750131
019200         10 PV-CREATE-DATE-MM         PIC  X(02).                 01750231
019300         10 FILLER                    PIC  X(01).                 01750331
019400         10 PV-CREATE-DATE-DD         PIC  X(02).                 01750431
018900     05  PV-CREATE-TIME               PIC  X(08).                 01750531
           05  FILLER REDEFINES PV-CREATE-TIME.                         01750631
019000         10 PV-CREATE-TIME-HH         PIC  X(02).                 01750731
019100         10 FILLER                    PIC  X(01).                 01750831
019200         10 PV-CREATE-TIME-MM         PIC  X(02).                 01750931
019300         10 FILLER                    PIC  X(01).                 01751031
019400         10 PV-CREATE-TIME-SS         PIC  X(02).                 01751131
018900     05  PV-MANIFEST-DATE             PIC  X(10).                 01751257
           05  FILLER REDEFINES PV-MANIFEST-DATE.                       01751357
019100         10 FILLER                    PIC  X(02).                 01751457
019000         10 PV-MANIFEST-DATE-YY       PIC  X(02).                 01751557
019300         10 FILLER                    PIC  X(01).                 01751657
019200         10 PV-MANIFEST-DATE-MM       PIC  X(02).                 01751757
019300         10 FILLER                    PIC  X(01).                 01751857
019400         10 PV-MANIFEST-DATE-DD       PIC  X(02).                 01751957
018900     05  PV-MANIFEST-TIME             PIC  X(08).                 01752057
           05  FILLER REDEFINES PV-MANIFEST-TIME.                       01752157
019000         10 PV-MANIFEST-TIME-HH       PIC  X(02).                 01752257
019100         10 FILLER                    PIC  X(01).                 01752357
019200         10 PV-MANIFEST-TIME-MM       PIC  X(02).                 01752457
019300         10 FILLER                    PIC  X(01).                 01752557
019400         10 PV-MANIFEST-TIME-SS       PIC  X(02).                 01752657
018900     05  PV-UPLOAD-TMST               PIC  X(26).                 01752799
           05  FILLER REDEFINES PV-UPLOAD-TMST.                         01752899
019100         10 FILLER                    PIC  X(05).                 01752999
019000         10 PV-UPLOAD-DATE-MM         PIC  X(02).                 01753099
019300         10 FILLER                    PIC  X(01).                 01753199
019200         10 PV-UPLOAD-DATE-DD         PIC  X(02).                 01753299
019300         10 FILLER                    PIC  X(01).                 01753399
019000         10 PV-UPLOAD-TIME-HH         PIC  X(02).                 01753799
019100         10 FILLER                    PIC  X(01).                 01753899
019200         10 PV-UPLOAD-TIME-MM         PIC  X(02).                 01753999
019300         10 FILLER                    PIC  X(10).                 01754099
           05  PV-FORMAT-DATE-TIME.                                     01754257
027700         10  PV-FORMAT-DATE-MM        PIC X(02).                  01754357
027800         10  FILLER                   PIC X(01) VALUE '/'.        01754457
027700         10  PV-FORMAT-DATE-DD        PIC X(02).                  01754557
027800         10  FILLER                   PIC X(01) VALUE SPACE.      01754657
027700         10  PV-FORMAT-TIME-HH        PIC X(02).                  01754757
027800         10  FILLER                   PIC X(01) VALUE ':'.        01754857
027700         10  PV-FORMAT-TIME-MM        PIC X(02).                  01755057
019500                                                                  01950001
019600     05  PV-DB2-TMST-1.                                           01960001
019700         10  PV-DB2-DATE-1            PIC X(10) VALUE SPACES.     01970057
019800         10  FILLER                   PIC X(16) VALUE             01980057
019900                              '-00.00.00.000000'.                 01990001
020000     05  PV-DB2-TMST-2.                                           02000001
020100         10  PV-DB2-DATE-2            PIC X(10) VALUE SPACES.     02010057
020200         10  FILLER                   PIC X(16) VALUE             02020057
020300                              '-23.59.59.999999'.                 02030001
020400                                                                  02040001
020600 01  PV-ABEND-FIELDS.                                             02060001
020700     05  PV-ABEND-CODE                PIC S9(04) VALUE +0         02070001
020800                                                 COMP SYNC.       02080001
020900     05  PV-ABEND-PROGRAM             PIC  X(08) VALUE 'SUKRP050'.02090019
021000     05  PV-ABEND-PARAGRAPH           PIC  X(50) VALUE SPACES.    02100001
021100     05  PV-ABEND-OPERATION           PIC  X(51) VALUE SPACES.    02110001
021500     05  PV-DB2-OPERATION-MESSAGE-1   PIC  X(79) VALUE SPACES.    02150001
021600     05  PV-DB2-OPERATION-MESSAGE-2   PIC  X(79) VALUE SPACES.    02160001
021700     05  PV-DB2-OPERATION-MESSAGE-3   PIC  X(79) VALUE SPACES.    02170001
021800     05  PV-DB2-OPERATION-ATTEMPTED   PIC  X(30)  VALUE SPACE.    02180001
021900/                                                                 02190001
022000 01  PC-CONSTANTS.                                                02200001
022100     05  PC-SUKRP050                  PIC X(08) VALUE 'SUKRP050'. 02210019
022200     05  PC-CURRENT-PROGRAM-NAME      PIC X(08) VALUE 'SUKRP050'. 02220019
031300     05  PC-CRTN-STATUS-PGM           PIC X(08) VALUE 'PCKUT713'. 02221046
022300     05  PC-END-OF-PAGE               PIC S9(3) COMP-3 VALUE +60. 02230001
022400     05  PC-MAX-LINE-COUNT            PIC S9(3) VALUE +60         02240001
022500                                                COMP-3.           02250001
022600/                                                                 02260001
022700******************************************************************02270001
022800*  WORK FIELDS FOR PRINTING A 132 CHARACTER REPORT.               02280001
022900******************************************************************02290001
023000     COPY DPWS132O.                                               02300001
023100*                                                                 02310001
023200 01  HL-HEADING-LINE-1.                                           02320001
023300     05  FILLER                      PIC  X(41).                  02330001
023400     05  FILLER                      PIC  X(51)  VALUE            02340099
023500      'DAILY - EMPTY/UNKNOWN CARTONS WITH MANIFESTED UNITS'.      02350099
023600                                                                  02360001
023700 01  HL-HEADING-LINE-2.                                           02370001
023800     05  FILLER                      PIC  X(16)  VALUE            02380001
023900            '  DC LOCATION:  '.                                   02390001
024000     05  HL2-LOCATION.                                            02400001
024100         10  HL2-OPER-ID             PIC  X(04) VALUE SPACES.     02410001
024200         10  FILLER                  PIC  X(01) VALUE SPACES.     02420001
024300         10  FILLER                  PIC  X(01) VALUE '-'.        02430001
024400         10  FILLER                  PIC  X(01) VALUE SPACES.     02440001
024500         10  HL2-LOC-DESC            PIC  X(25) VALUE SPACES.     02450001
024600                                                                  02460001
024700 01  HL-HEADING-LINE-3.                                           02470001
024800     05  FILLER                      PIC  X(42)  VALUE            02480099
024900      '                      --UPLOAD--- --DIVERT'.               02490099
025000     05  FILLER                      PIC  X(56)  VALUE            02500025
025100      '---  OUTBOUND  --MANIFEST-  CRE  CREATE    ---CREATE--  '. 02510099
025200     05  FILLER                      PIC  X(34)  VALUE            02520099
025300      ' PURCHASE RCVR LINE               '.                       02530099
025400                                                                  02540001
025500 01  HL-HEADING-LINE-4.                                           02550001
024800     05  FILLER                      PIC  X(42)  VALUE            02560099
024900      ' SML NUMBER            DATE  TIME  DATE  T'.               02570099
025000     05  FILLER                      PIC  X(56)  VALUE            02580099
025100      'IME    TRIP     DATE  TIME  SRC  USER ID    DATE  TIME  '. 02590099
025200     05  FILLER                      PIC  X(34)  VALUE            02600099
025300      '   ORDER   NBR  NBR   SKU    UNITS'.                       02610099
026200                                                                  02620001
026300 01  DL-DETAIL-LINE-1.                                            02630001
026400     05  FILLER                       PIC X(01) VALUE SPACES.     02640001
026900     05  DL1-SHIPT-UNT-ID             PIC 9(20).                  02641030
026800     05  FILLER                       PIC X(01) VALUE SPACES.     02642099
027700     05  DL1-UPLOAD-DATE-TIME         PIC X(11).                  02643099
026800     05  FILLER                       PIC X(01) VALUE SPACES.     02644099
027700     05  DL1-DIVERT-DATE-TIME         PIC X(11).                  02645099
029400     05  FILLER                       PIC X(01) VALUE SPACES.     02649399
027100     05  DL1-OUTBOUND-TRIP-ID         PIC Z(09).                  02649499
027100     05  DL1-OUTBOUND-TRIP-ID-X REDEFINES DL1-OUTBOUND-TRIP-ID    02649599
027100                                      PIC X(09).                  02649669
027200     05  FILLER                       PIC X(02) VALUE SPACES.     02649769
027700     05  DL1-MANIFEST-DATE-TIME       PIC X(11).                  02649899
029400     05  FILLER                       PIC X(02) VALUE SPACES.     02650769
027300     05  DL1-SRC-CDE                  PIC X(03).                  02650881
027400     05  FILLER                       PIC X(02) VALUE SPACES.     02650969
027500     05  DL1-CREATE-USER-ID           PIC X(08).                  02651069
027600     05  FILLER                       PIC X(02) VALUE SPACES.     02651169
027700     05  DL1-CREATE-DATE-TIME         PIC X(11).                  02651299
027600     05  FILLER                       PIC X(02) VALUE SPACES.     02652169
026500     05  DL1-PO-NBR                   PIC Z(09).                  02653069
026600     05  FILLER                       PIC X(01) VALUE SPACES.     02660001
026700     05  DL1-RCVR-NBR                 PIC Z(04).                  02670037
027000     05  FILLER                       PIC X(01) VALUE SPACES.     02700001
028500     05  DL1-LINE-NBR                 PIC ZZZZ.                   02850001
028600     05  FILLER                       PIC X(01) VALUE SPACES.     02860035
029100     05  DL1-SKU                      PIC Z(08).                  02910001
029200     05  FILLER                       PIC X(01) VALUE SPACES.     02920035
029300     05  DL1-UNIT-COUNT               PIC ZZZZ.                   02930001
029400     05  FILLER                       PIC X(02) VALUE SPACES.     02940001
029500                                                                  02950001
029600 01  DL-DETAIL-LINE-2.                                            02960001
029700     05  FILLER                       PIC X(98) VALUE SPACES.     02970099
026500     05  DL2-PO-NBR                   PIC Z(09).                  02980035
026500     05  DL2-PO-NBR-X REDEFINES DL2-PO-NBR                        02981037
026500                                      PIC X(09).                  02982037
026600     05  FILLER                       PIC X(01) VALUE SPACES.     02990035
026700     05  DL2-RCVR-NBR                 PIC Z(04).                  03000037
026500     05  DL2-RCVR-NBR-X REDEFINES DL2-RCVR-NBR                    03001099
026500                                      PIC X(04).                  03002037
027000     05  FILLER                       PIC X(01) VALUE SPACES.     03010035
028500     05  DL2-LINE-NBR                 PIC ZZZZ.                   03020035
028600     05  FILLER                       PIC X(01) VALUE SPACES.     03030035
029100     05  DL2-SKU                      PIC Z(08).                  03040035
029200     05  FILLER                       PIC X(01) VALUE SPACES.     03050035
029300     05  DL2-UNIT-COUNT               PIC ZZZZ.                   03060035
030700     05  FILLER                       PIC X(02) VALUE SPACES.     03070036
030800                                                                  03080001
031400 01  DL-NO-MANIFESTED-UNITS-LINE.                                 03081099
031500     05  FILLER                       PIC X(34)  VALUE SPACES.    03082099
031600     05  FILLER                       PIC X(52)  VALUE            03083099
031700      '***** NO CARTON UNITS MANIFESTED FOR REPORTING *****'.     03084099
                                                                        03084199
031800     05  FILLER                       PIC X(49)  VALUE SPACES.    03085099
030900 01  ER-END-OF-REPORT-LINE.                                       03090001
031000     05  FILLER                       PIC X(19)  VALUE            03100001
031100         '** END OF REPORT **'.                                   03110001
031200     05  FILLER                       PIC X(113)  VALUE SPACES.   03120001
031300                                                                  03130001
031400 01  EP-EMPTY-REPORT-LINE.                                        03140001
031500     05  FILLER                       PIC X(34)  VALUE SPACES.    03150001
031600     05  FILLER                       PIC X(52)  VALUE            03160001
031700      '*************** EMPTY INPUT FILE *******************'.     03170001
031800     05  FILLER                       PIC X(49)  VALUE SPACES.    03180001
031900                                                                  03190001
032000 01  DL-BLANK-LINE                    PIC X(132) VALUE SPACES.    03200001
032100                                                                  03210001
032200 01  EL1-ERROR-LINE-1P.                                           03220001
032300     05  FILLER                      PIC  X(02)     VALUE SPACES. 03230001
032400     05  FILLER                      PIC  X(48)     VALUE         03240001
032500         'A PROBLEM WAS ENCOUNTERED DURING THE PROCESS OF '.      03250001
032600     05  FILLER                      PIC  X(49)     VALUE         03260001
032700         'CREATING YOUR REPORT.   THIS REPORT COULD NOT BE '.     03270001
032800     05  FILLER                      PIC  X(33)     VALUE         03280001
032900         'COMPLETED.                       '.                     03290001
033000                                                                  03300001
033100 01  EL2-ERROR-LINE-2F.                                           03310001
033200     05  FILLER                      PIC  X(02)     VALUE SPACES. 03320001
033300     05  FILLER                      PIC  X(36)     VALUE         03330001
033400         'NONE OF YOUR REPORTS WERE CREATED.  '.                  03340001
033500     05  FILLER                      PIC  X(36)     VALUE         03350001
033600         'PLEASE RE-SUBMIT YOUR REQUEST AGAIN.'.                  03360001
033700     05  FILLER                      PIC  X(58)     VALUE SPACES. 03370001
033800                                                                  03380001
033900 01  EL3-ERROR-LINE-3.                                            03390001
034000     05  FILLER                      PIC  X(02)     VALUE SPACES. 03400001
034100     05  FILLER                      PIC  X(50)     VALUE         03410001
034200         'YOUR REQUEST WAS AS FOLLOWS:                      '.    03420001
034300     05  FILLER                      PIC  X(81)     VALUE SPACES. 03430001
034400                                                                  03440001
034500 01  EL4-ERROR-LINE-4.                                            03450001
034600     05  FILLER                      PIC  X(02)     VALUE SPACES. 03460001
034700     05  FILLER                      PIC  X(18)     VALUE         03470001
034800         'REQUESTOR       : '.                                    03480001
034900     05  EL4-REQUESTOR-ID            PIC  X(10)     VALUE SPACES. 03490001
035000     05  FILLER                      PIC  X(07)     VALUE SPACES. 03500001
035100     05  FILLER                      PIC  X(21)     VALUE         03510001
035200         'PRINTER DESTINATION: '.                                 03520001
035300     05  EL4-PRINTER-ID              PIC  X(10)     VALUE SPACES. 03530001
035400     05  FILLER                      PIC  X(65)     VALUE SPACES. 03540001
035500                                                                  03550001
035600 01  EL5-ERROR-LINE-5B.                                           03560001
035700     05  FILLER                      PIC  X(02)     VALUE SPACES. 03570001
035800     05  FILLER                      PIC  X(18)     VALUE         03580001
035900         'START DATE RANGE: '.                                    03590001
036000     05  EL5-START-DATE-RANGE        PIC  X(10).                  03600001
036100     05  FILLER                      PIC  X(07)     VALUE SPACES. 03610001
036200     05  FILLER                      PIC  X(21)     VALUE         03620001
036300         'END DATE RANGE     : '.                                 03630001
036400     05  EL5-END-DATE-RANGE          PIC  X(10).                  03640001
036500     05  FILLER                      PIC  X(20)     VALUE SPACES. 03650001
036600/                                                                 03660001
036700******************************************************************03670001
036800*  RECORD LAYOUT FOR INPUT FILE                                   03680001
036900******************************************************************03690001
037000     COPY SURD067.                                                03700099
037100/                                                                 03710001
011200*COPYBOOK FOR CARTON STATUS MODULE - PCKUT713                     03712099
011300     COPY PCWS046.                                                03713099
037300*                                                                 03730001
037200*  LOGISTICS DOMAIN LOCATION MODULE                               03731099
037400     COPY XLWS071.                                                03740001
037500******************************************************************03750001
037600*  COPYBOOK USED BY MBS SYSTEM                                    03760001
037700******************************************************************03770001
037800     COPY DPWS003.                                                03780001
037900*                                                                 03790001
038000******************************************************************03800001
038100*  WORKING STORAGE AREA FOR NAME REFORMAT DPPD024                 03810001
038200******************************************************************03820001
038300     COPY DPWS024.                                                03830001
038400/                                                                 03840001
038500******************************************************************03850001
038600*  DB2 FORMATTED MESSAGE AREA                                     03860001
038700******************************************************************03870001
038800     COPY DPWS004.                                                03880001
038900/                                                                 03890001
039000******************************************************************03900001
039100* CORPORATE DATE ROUTINES                                         03910001
039200******************************************************************03920001
039300     COPY DPWS500.                                                03930001
039400/                                                                 03940001
016000*DB2 AREA FOR SUT_OTBND_CART TABLE                                03941039
016100     EXEC SQL                                                     03942039
016200          INCLUDE SUT00024                                        03943039
016300     END-EXEC.                                                    03944039
013400                                                                  03945039
013500*DB2 AREA FOR SUT_OTBND_LOC TABLE                                 03946058
013600     EXEC SQL                                                     03947039
013700          INCLUDE SUT00027                                        03948058
013800     END-EXEC.                                                    03949039
013400                                                                  03949258
013500*DB2 AREA FOR SUT_OTBND_UPC TABLE                                 03949358
013600     EXEC SQL                                                     03949458
013700          INCLUDE SUT00028                                        03949558
013800     END-EXEC.                                                    03949658
012100                                                                  03949739
014000*DB2 AREA FOR XLT_UPC TABLE                                       03949851
014100     EXEC SQL                                                     03949951
014200          INCLUDE XLT00006                                        03950051
014300     END-EXEC.                                                    03950151
014400                                                                  03950251
014500*DB2 AREA FOR XLT_SKU TABLE                                       03950351
014600     EXEC SQL                                                     03950451
014700          INCLUDE XLT00003                                        03950551
014800     END-EXEC.                                                    03950651
014900                                                                  03950751
014500*DB2 AREA FOR PARM TABLE                                          03950899
014600     EXEC SQL                                                     03950999
014700          INCLUDE TKRPRPM                                         03951099
014800     END-EXEC.                                                    03951199
014900                                                                  03951299
017300                                                                  03951343
017400     EXEC SQL                                                     03951443
017500         DECLARE CARTON_CONTENT_CSR CURSOR                        03951543
017600             FOR SELECT                                           03951643
017700                 A.TRN_NBR                                        03951743
017800               , A.RCVR_SEQ_NBR                                   03951843
017900               , A.TRN_LNE_NBR                                    03951943
018000               , C.SKU_NBR                                        03952043
018100               , SUM(A.SHPD_UNT_QTY)                              03952143
018400             FROM SUT_OTBND_UPC  A                                03952243
018500                , XLT_UPC B                                       03952343
018600                , XLT_SKU C                                       03952443
018800             WHERE A.SHIPT_UNT_ID = :SU067-SHIPT-UNT-ID           03952543
018900               AND A.UPC_NBR      = B.UPC_NBR                     03952643
019000               AND B.INTR_UPC_ID  = C.INTR_UPC_ID                 03952743
019200             GROUP BY                                             03952843
019300                      A.TRN_NBR                                   03952943
019400                    , A.RCVR_SEQ_NBR                              03953043
019500                    , A.TRN_LNE_NBR                               03953143
019600                    , C.SKU_NBR                                   03953243
019900     END-EXEC.                                                    03953343
020000                                                                  03953443
039500******************************************************************03954001
039600*   DB2 SQL COMMUNICATION AREA                                    03960001
039700******************************************************************03970001
039800     EXEC SQL                                                     03980001
039900         INCLUDE SQLCA                                            03990001
040000     END-EXEC.                                                    04000001
040100*                                                                 04010001
040200     COPY SQLCA2.                                                 04020001
040300*                                                                 04030001
041300******************************************************************04130001
041400 PROCEDURE DIVISION.                                              04140001
041500******************************************************************04150001
041600 0000-MAINLINE.                                                   04160001
041700                                                                  04170001
041800     OPEN INPUT  SML-EMPTY-UNKNOWN-FILE                           04180042
041800          OUTPUT STILL-EMPTY-UNKNOWN-FILE                         04181042
041900                 REPORT-FILE-1.                                   04190042
042000                                                                  04200001
042100     PERFORM 7000-READ-EXTRACT.                                   04210038
042200     PERFORM 1000-INITIALIZE.                                     04220001
042300     IF PS-END-OF-INPUT                                           04230001
042400         PERFORM 1300-NO-DETAIL-LINE                              04240001
042500     ELSE                                                         04250001
066400*        PERFORM 5000-SELECT-OPER-DESC                            04261099
042700*        PERFORM 8000-WRITE-MAIN-HEADINGS                         04270099
042800         PERFORM 2000-PROCESS-INPUT                               04280043
042900             UNTIL PS-END-OF-INPUT                                04290001
               IF PV-READ-COUNT = PV-WRITE-COUNT                        04300099
042700             PERFORM 8000-WRITE-MAIN-HEADINGS                     04300199
049100             WRITE REPORT-RECORD-1                                04300299
049200               FROM DL-NO-MANIFESTED-UNITS-LINE                   04300399
049300                 AFTER ADVANCING 3 LINES                          04300499
               END-IF                                                   04301099
043100     END-IF.                                                      04310001
043200                                                                  04320001
043300     PERFORM 9000-EOJ.                                            04330001
043400                                                                  04340001
043500     GOBACK.                                                      04350001
043600                                                                  04360001
043700******************************************************************04370001
043800 1000-INITIALIZE.                                                 04380001
043900******************************************************************04390001
044000*                                                                 04400001
044100* LOAD SYSTEM DATE INTO HEADINGS                                  04410001
044200     ACCEPT SD-SYSTEM-DATE FROM DATE.                             04420001
044300     ACCEPT ST-SYSTEM-TIME FROM TIME.                             04430001
044400                                                                  04440001
044500     MOVE SD-SYSTEM-DATE-YY      TO DP132O-RUN-YEAR.              04450001
044600     MOVE SD-SYSTEM-DATE-MM      TO DP132O-RUN-MONTH.             04460001
044700     MOVE SD-SYSTEM-DATE-DD      TO DP132O-RUN-DAY.               04470001
044800     MOVE ST-SYSTEM-HOUR         TO DP132O-RUN-HOUR.              04480001
044900     MOVE ST-SYSTEM-MINUTE       TO DP132O-RUN-MINUTE.            04490001
045000                                                                  04500001
045100     MOVE PC-CURRENT-PROGRAM-NAME                                 04510001
045200                                 TO DP132O-PROGRAM-NAME.          04520001
045300     MOVE 1                      TO DP132O-REPORT-NUMBER          04530001
045400                                    DP132O-PAGE-NUMBER.           04540001
045500                                                                  04550001
040600     EXEC SQL                                                     04550199
             SELECT CURRENT DATE                                        04550299
                  , CURRENT DATE - FUNC_QTY MONTHS                      04550399
             INTO  :PV-CURRENT-DATE                                     04550499
                  ,:PV-PURGE-DATE                                       04550599
             FROM TKRPRPM                                               04550699
             WHERE LOC_ID             =  90                             04550799
               AND INTFC_SYS_CDE      = 'KHL'                           04550899
               AND SYS_PRC_FUNC_CDE   = 'EMPTPG'                        04550999
               AND FUNC_PRC_STAT_CDE  = 'AC'                            04551099
               AND FUNC_BEG_TMST     <=  CURRENT TIMESTAMP              04551199
               AND FUNC_END_TMST     >=  CURRENT TIMESTAMP              04551299
             WITH UR                                                    04551399
           END-EXEC.                                                    04551499
                                                                        04551599
112800     EVALUATE TRUE                                                04551699
112900         WHEN SQLCODE = ZERO                                      04551799
                    DISPLAY '** SUKRP050 CURRENT DATE: ' PV-CURRENT-DATE04551899
                    DISPLAY '** SUKRP050 PURGE DATE..: ' PV-PURGE-DATE  04551999
113100         WHEN OTHER                                               04552099
                    DISPLAY 'SYS_PRC_FUNC_CDE = EMPTPG'                 04552199
113200              MOVE '1000-INITIALIZE' TO PV-PARAGRAPH              04552299
213123              MOVE 'SELECT TKRPRPM'  TO PV-DB2-FUNCTION           04552399
213125              PERFORM 9200-SQL-ABEND                              04552499
513600     END-EVALUATE.                                                04552599
                                                                        04552699
042600*    MOVE SU067-LOC-NBR          TO PV-PREV-DC.                   04553099
046000*                                                                 04600001
048300*                                                                 04830001
048400******************************************************************04840001
048500*  PRINT A 'NO INPUT' REPORT LINE.                                04850001
048600******************************************************************04860001
048700 1300-NO-DETAIL-LINE.                                             04870001
048800*                                                                 04880001
048900     PERFORM 8000-WRITE-MAIN-HEADINGS.                            04890001
049000                                                                  04900001
049100     WRITE REPORT-RECORD-1                                        04910001
049200       FROM EP-EMPTY-REPORT-LINE                                  04920001
049300         AFTER ADVANCING 3 LINES.                                 04930001
053400/                                                                 05340001
054800******************************************************************05480001
054900 2000-PROCESS-INPUT.                                              05490043
055000******************************************************************05500001
055100*                                                                 05510001
026200     PERFORM 2100-CHECK-MNFSTED-UNITS.                            05510642
041900     IF PS-CARTON-UNITS-MNFSTED-NO                                05511042
               IF SU067-DIVERT-DATE < PV-PURGE-DATE                     05512099
                   ADD +1 TO PV-PURGE-CARTON-COUNT                      05512199
               ELSE                                                     05512299
070700             WRITE STILL-EMPTY-UNKNOWN-RECORD                     05513099
070800                 FROM SU067-EXTRACT-RECORD                        05514099
                   ADD +1 TO PV-WRITE-COUNT                             05515099
               END-IF                                                   05515199
           ELSE                                                         05516043
               ADD +1 TO PV-INPUT-PROCESSED-COUNT                       05516199
               PERFORM 3110-OPEN-CARTON-CONTENT-CSR                     05516256
               SET PS-END-OF-CURSOR-NO    TO TRUE                       05516356
               PERFORM 3120-FETCH-CARTON-CONTENT-CSR                    05516456
               IF PS-END-OF-CURSOR-NO                                   05516556
                   PERFORM 3000-CONTINUE-PROCESS-INPUT                  05517056
               END-IF                                                   05517156
               PERFORM 3130-CLOSE-CARTON-CONTENT-CSR                    05517256
           END-IF.                                                      05518043
058200     PERFORM 7000-READ-EXTRACT.                                   05518256
                                                                        05519043
058300*                                                                 05830001
040300******************************************************************05831038
026200 2100-CHECK-MNFSTED-UNITS.                                        05832038
040500******************************************************************05833038
           MOVE ZERO TO SUT00028-SHPD-UNT-QTY                           05834038
040600     EXEC SQL                                                     05835038
040700         SELECT SUM(A.SHPD_UNT_QTY)                               05836039
                    , B.CART_SRC_CDE                                    05836139
                    , B.CRE_DTE                                         05836239
                    , B.CRE_TM                                          05836339
                    , B.CRE_USR_ID                                      05836439
                    , B.OTBND_TRIP_ID                                   05836539
040800           INTO :SUT00028-SHPD-UNT-QTY                            05837038
040800              , :SUT00024-CART-SRC-CDE                            05837156
040800              , :PV-CREATE-DATE                                   05837266
040800              , :PV-CREATE-TIME                                   05837366
040800              , :SUT00024-CRE-USR-ID                              05837456
040800              , :SUT00024-OTBND-TRIP-ID                           05837556
                 FROM SUT_OTBND_UPC A                                   05838040
                    , SUT_OTBND_CART B                                  05838140
                WHERE A.SHIPT_UNT_ID = :SU067-SHIPT-UNT-ID              05839040
                  AND A.SHIPT_UNT_ID = B.SHIPT_UNT_ID                   05839141
                GROUP BY                                                05839299
                      B.CART_SRC_CDE                                    05839399
                    , B.CRE_DTE                                         05839499
                    , B.CRE_TM                                          05839599
                    , B.CRE_USR_ID                                      05839699
                    , B.OTBND_TRIP_ID                                   05839799
041500     END-EXEC.                                                    05839838
041600                                                                  05839938
041700     EVALUATE TRUE                                                05840038
041800         WHEN SQLCODE = ZERO                                      05840138
                   IF SUT00028-SHPD-UNT-QTY > ZERO                      05840238
041900                 SET PS-CARTON-UNITS-MNFSTED-YES    TO TRUE       05840338
                   ELSE                                                 05840438
041900                 SET PS-CARTON-UNITS-MNFSTED-NO     TO TRUE       05840538
                   END-IF                                               05840638
042100         WHEN SQLCODE = +100                                      05840738
042100         WHEN SQLCODE = -305                                      05840838
041900             SET PS-CARTON-UNITS-MNFSTED-NO         TO TRUE       05840938
042300         WHEN SQLWARN0 NOT = SPACES                               05841038
042400         WHEN SQLCODE < +0                                        05841138
042500         WHEN SQLCODE > ZERO                                      05841238
042600             MOVE '2100-CHECK-MNFSTED-UNITS'                      05841338
042700                                 TO PV-PARAGRAPH                  05841449
042900             MOVE 'SELECT'       TO PV-DB2-FUNCTION               05841549
043000             MOVE 'SUT_OTBND_UPC,SUT_OTBND_CART'                  05841649
043000                                 TO PV-DB2-TABLE-NAME             05841749
043100             MOVE SU067-SHIPT-UNT-ID TO PV-DISP-SHIPT-UNT-ID      05841899
043200             STRING 'SHIPT-UNT-QTY: '  DELIMITED BY SIZE          05841949
043300               PV-DISP-SHIPT-UNT-ID    DELIMITED BY SIZE          05842099
043400                               INTO PV-DB2-OPERATION-MESSAGE-1    05842199
044500             PERFORM 9200-SQL-ABEND                               05842249
044600     END-EVALUATE.                                                05842349
                                                                        05842449
       3000-CONTINUE-PROCESS-INPUT.                                     05842549
055100*                                                                 05842649
055200     IF SU067-LOC-NBR NOT = PV-PREV-DC                            05842756
066400         PERFORM 5000-SELECT-OPER-DESC                            05842856
066900         MOVE ZERO          TO PV-PAGE-COUNT                      05842999
056800         PERFORM 8000-WRITE-MAIN-HEADINGS                         05843056
055200         MOVE SU067-LOC-NBR TO PV-PREV-DC                         05843156
           END-IF                                                       05843256
           IF SUT00024-CART-SRC-CDE = 'P2L' OR 'JWL'                    05843357
               PERFORM 3140-MANIFEST-DTE-TM                             05843459
           ELSE                                                         05843567
               MOVE PV-CREATE-DATE TO PV-MANIFEST-DATE                  05843667
               MOVE PV-CREATE-TIME TO PV-MANIFEST-TIME                  05843767
           END-IF.                                                      05843857
           IF SUT00024-CART-SRC-CDE = 'P2L'                             05843999
               PERFORM 3150-UPLOAD-TMST                                 05844099
           ELSE                                                         05844199
               MOVE SPACES         TO PV-UPLOAD-TMST                    05844299
           END-IF.                                                      05844499
           IF SUT00024-OTBND-TRIP-ID = ZERO                             05844568
235500         PERFORM 6000-CALL-CRTN-STATUS-PGM                        05844668
               IF PC046-OTBD-TRIP-ID NUMERIC                            05844768
                 AND PC046-OTBD-TRIP-ID > ZERO                          05844868
                   MOVE PC046-OTBD-TRIP-ID                              05844968
                                        TO DL1-OUTBOUND-TRIP-ID         05845068
               ELSE                                                     05845168
                   MOVE SPACES          TO DL1-OUTBOUND-TRIP-ID-X       05845268
               END-IF                                                   05845368
           ELSE                                                         05845468
               MOVE SUT00024-OTBND-TRIP-ID                              05845568
                                        TO DL1-OUTBOUND-TRIP-ID         05845668
           END-IF                                                       05845768
           MOVE SU067-DIVERT-DATE       TO PV-DIVERT-DATE               05845870
           MOVE SU067-DIVERT-TIME       TO PV-DIVERT-TIME               05845970
           IF PV-UPLOAD-TMST > SPACES                                   05846099
               MOVE PV-UPLOAD-DATE-MM   TO PV-FORMAT-DATE-MM            05846199
               MOVE PV-UPLOAD-DATE-DD   TO PV-FORMAT-DATE-DD            05846299
               MOVE PV-UPLOAD-TIME-HH   TO PV-FORMAT-TIME-HH            05846399
               MOVE PV-UPLOAD-TIME-MM   TO PV-FORMAT-TIME-MM            05846499
               MOVE PV-FORMAT-DATE-TIME TO DL1-UPLOAD-DATE-TIME         05846599
           ELSE                                                         05846673
               MOVE SPACES              TO DL1-UPLOAD-DATE-TIME         05846799
           END-IF                                                       05846873
           IF PV-DIVERT-DATE > SPACES                                   05846999
               MOVE PV-DIVERT-DATE-MM   TO PV-FORMAT-DATE-MM            05847099
               MOVE PV-DIVERT-DATE-DD   TO PV-FORMAT-DATE-DD            05847199
               MOVE PV-DIVERT-TIME-HH   TO PV-FORMAT-TIME-HH            05847299
               MOVE PV-DIVERT-TIME-MM   TO PV-FORMAT-TIME-MM            05847399
               MOVE PV-FORMAT-DATE-TIME TO DL1-DIVERT-DATE-TIME         05847499
           ELSE                                                         05847599
               MOVE SPACES              TO DL1-DIVERT-DATE-TIME         05847699
           END-IF                                                       05847799
           IF PV-CREATE-DATE > SPACES                                   05847878
               MOVE PV-CREATE-DATE-MM   TO PV-FORMAT-DATE-MM            05847978
               MOVE PV-CREATE-DATE-DD   TO PV-FORMAT-DATE-DD            05848078
               MOVE PV-CREATE-TIME-HH   TO PV-FORMAT-TIME-HH            05848178
               MOVE PV-CREATE-TIME-MM   TO PV-FORMAT-TIME-MM            05848278
               MOVE PV-FORMAT-DATE-TIME TO DL1-CREATE-DATE-TIME         05848379
           ELSE                                                         05848478
               MOVE SPACES              TO DL1-CREATE-DATE-TIME         05848579
           END-IF                                                       05848678
           IF PV-MANIFEST-DATE > SPACES                                 05848779
               MOVE PV-MANIFEST-DATE-MM TO PV-FORMAT-DATE-MM            05848879
               MOVE PV-MANIFEST-DATE-DD TO PV-FORMAT-DATE-DD            05848979
               MOVE PV-MANIFEST-TIME-HH TO PV-FORMAT-TIME-HH            05849079
               MOVE PV-MANIFEST-TIME-MM TO PV-FORMAT-TIME-MM            05849179
               MOVE PV-FORMAT-DATE-TIME TO DL1-MANIFEST-DATE-TIME       05849279
           ELSE                                                         05849379
               MOVE SPACES              TO DL1-MANIFEST-DATE-TIME       05849479
           END-IF                                                       05849579
026900     MOVE SU067-SHIPT-UNT-ID      TO DL1-SHIPT-UNT-ID             05849674
040800     MOVE SUT00024-CRE-USR-ID     TO DL1-CREATE-USER-ID           05849780
040800     MOVE SUT00024-CART-SRC-CDE   TO DL1-SRC-CDE                  05849881
                                                                        05849983
           PERFORM 3100-PROCESS-CARTON-CONTENT                          05850083
               UNTIL PS-END-OF-CURSOR-YES.                              05850199
                                                                        05850283
       3100-PROCESS-CARTON-CONTENT.                                     05850383
040800     MOVE SUT00028-TRN-NBR        TO DL1-PO-NBR                   05850493
040800     MOVE SUT00028-RCVR-SEQ-NBR   TO DL1-RCVR-NBR                 05850599
040800     IF SUT00028-TRN-NBR         = PV-PREV-PO-NBR                 05850699
040800       AND SUT00028-RCVR-SEQ-NBR = PV-PREV-RCVR-NBR               05850799
               MOVE SPACES              TO DL2-PO-NBR-X                 05850899
                                           DL2-RCVR-NBR-X               05850999
           ELSE                                                         05851099
040800         MOVE SUT00028-TRN-NBR    TO DL2-PO-NBR                   05851199
                                           PV-PREV-PO-NBR               05851299
040800         MOVE SUT00028-RCVR-SEQ-NBR                               05851399
                                        TO DL2-RCVR-NBR                 05851499
                                           PV-PREV-RCVR-NBR             05851599
           END-IF                                                       05851699
040800     MOVE SUT00028-TRN-LNE-NBR    TO DL1-LINE-NBR                 05851799
040800                                     DL2-LINE-NBR                 05851899
           MOVE XLT00003-SKU-NBR        TO DL1-SKU                      05851999
                                           DL2-SKU                      05852099
           MOVE PV-UNT-QTY-SUM          TO DL1-UNIT-COUNT               05852199
                                           DL2-UNIT-COUNT               05852299
060500*CHECK FOR OVERFLOW.                                              05852399
060700     IF PV-LINE-COUNT > PC-MAX-LINE-COUNT                         05852499
060900         PERFORM 8000-WRITE-MAIN-HEADINGS                         05852599
061000     END-IF.                                                      05852699
061400     IF PS-SAME-PAGE AND                                          05852799
061900        SU067-SHIPT-UNT-ID = PV-PREV-SHIPT-UNT-ID                 05852899
062500         WRITE REPORT-RECORD-1                                    05852999
062600           FROM DL-DETAIL-LINE-2                                  05853099
062700             AFTER ADVANCING 1 LINES                              05853199
062800         ADD 1                   TO PV-LINE-COUNT                 05853299
062900     ELSE                                                         05853399
061400         IF PS-SAME-PAGE                                          05853499
064500             WRITE REPORT-RECORD-1                                05853599
064600               FROM DL-BLANK-LINE                                 05853699
064700                 AFTER ADVANCING 1 LINE                           05853799
065200             ADD 1                   TO PV-LINE-COUNT             05853899
               END-IF                                                   05853999
064900         WRITE REPORT-RECORD-1                                    05854099
065000           FROM DL-DETAIL-LINE-1                                  05854199
065100             AFTER ADVANCING 1 LINES                              05854299
065200         ADD 1                   TO PV-LINE-COUNT                 05854399
056000         MOVE SU067-SHIPT-UNT-ID TO PV-PREV-SHIPT-UNT-ID          05854499
065300     END-IF.                                                      05854599
061300     IF PS-NEW-PAGE                                               05854699
061400         SET PS-SAME-PAGE        TO TRUE                          05854799
061500     END-IF.                                                      05854899
                                                                        05855099
           PERFORM 3120-FETCH-CARTON-CONTENT-CSR.                       05860099
  5400                                                                  06540099
038100******************************************************************06540145
038200 3110-OPEN-CARTON-CONTENT-CSR.                                    06540245
038300******************************************************************06540345
038400                                                                  06540445
038500     EXEC SQL                                                     06540545
038600         OPEN CARTON_CONTENT_CSR                                  06540645
038700     END-EXEC.                                                    06540745
038800                                                                  06540845
038900     EVALUATE TRUE                                                06540945
039000         WHEN SQLCODE = ZERO                                      06541045
039100             CONTINUE                                             06541145
039200         WHEN SQLWARN0 NOT = SPACES                               06541245
039300         WHEN SQLCODE < +0                                        06541345
039400         WHEN SQLCODE > ZERO                                      06541445
039500             MOVE '3110-OPEN-CARTON-CONTENT-CSR'                  06541548
039600                                TO PV-PARAGRAPH                   06541645
039700             MOVE 'OPEN CARTON_CONTENT_CSR'                       06541748
039800                                TO PV-DB2-OPERATION-MESSAGE-1     06541845
039900             PERFORM 9200-SQL-ABEND                               06541945
040000     END-EVALUATE.                                                06542045
040100                                                                  06542145
040300******************************************************************06542250
040400 3120-FETCH-CARTON-CONTENT-CSR.                                   06542350
040500******************************************************************06542450
040600     EXEC SQL                                                     06542550
040700         FETCH CARTON_CONTENT_CSR                                 06542652
040800         INTO  :SUT00028-TRN-NBR                                  06542750
040900              ,:SUT00028-RCVR-SEQ-NBR                             06542850
041000              ,:SUT00028-TRN-LNE-NBR                              06542950
041100              ,:XLT00003-SKU-NBR                                  06543050
041200              ,:PV-UNT-QTY-SUM                                    06543150
041500     END-EXEC.                                                    06543250
041600                                                                  06543350
041700     EVALUATE TRUE                                                06543450
041800         WHEN SQLCODE = ZERO                                      06543550
041900             ADD 1   TO PV-FETCH-COUNT                            06543699
042100         WHEN SQLCODE = +100                                      06543750
042200             SET PS-END-OF-CURSOR-YES                             06543899
042200                                   TO TRUE                        06543999
042300           WHEN SQLWARN0 NOT = SPACES                             06544099
042400         WHEN SQLCODE < +0                                        06544199
042500         WHEN SQLCODE > ZERO                                      06544299
042600             MOVE '3120-FETCH-OTBND-UPC-CSR'                      06544399
042700                                   TO PV-PARAGRAPH                06544499
042900             MOVE 'FETCH'          TO PV-DB2-FUNCTION             06544599
043000             MOVE 'SUT_OTBND_UPC'  TO PV-DB2-TABLE-NAME           06544699
043100             MOVE SU067-SHIPT-UNT-ID                              06544799
                                         TO PV-DISP-SHIPT-UNT-ID        06544899
043200             STRING 'SHIPT-UNT-ID: ' DELIMITED BY SIZE            06544999
043300                    PV-DISP-SHIPT-UNT-ID DELIMITED BY SIZE        06545099
043400                           INTO PV-DB2-OPERATION-MESSAGE-1        06546099
044500             PERFORM 9200-SQL-ABEND                               06546150
044600     END-EVALUATE.                                                06546250
044900******************************************************************06546359
045000 3130-CLOSE-CARTON-CONTENT-CSR.                                   06546460
045100******************************************************************06546559
045200     EXEC SQL                                                     06546659
045300         CLOSE CARTON_CONTENT_CSR                                 06546760
045400     END-EXEC.                                                    06546859
045500                                                                  06546959
045600     EVALUATE TRUE                                                06547059
045700         WHEN SQLCODE = ZERO                                      06547159
045800             CONTINUE                                             06547259
045900                                                                  06547359
046000         WHEN SQLWARN0 NOT = SPACES                               06547459
046100         WHEN SQLCODE < +0                                        06547559
046200         WHEN SQLCODE > ZERO                                      06547659
046300             MOVE '3130-CLOSE-CARTON-CONTENT-CSR'                 06547761
046400                                 TO PV-PARAGRAPH                  06547859
046500             MOVE 'CLOSE CARTON_CONTENT_CSR'                      06547961
046600                                 TO PV-DB2-FUNCTION               06548061
046700             PERFORM 9200-SQL-ABEND                               06548159
046800     END-EVALUATE.                                                06548259
                                                                        06548354
       3140-MANIFEST-DTE-TM.                                            06548459
040600     EXEC SQL                                                     06548558
040700         SELECT DATE(CRE_TMST)                                    06548662
040700              , TIME(CRE_TMST)                                    06548762
040800           INTO :PV-MANIFEST-DATE                                 06548863
040800              , :PV-MANIFEST-TIME                                 06548963
                 FROM SUT_OTBND_LOC                                     06549063
                WHERE SHIPT_UNT_ID = :SU067-SHIPT-UNT-ID                06549163
                  AND SCN_CDE     IN ('LTP','DNP')                      06549263
                  AND ACTV_CDE     = 'A'                                06549399
041500     END-EXEC.                                                    06549463
041600                                                                  06549563
041700     EVALUATE TRUE                                                06549663
041800         WHEN SQLCODE = ZERO                                      06549763
                   CONTINUE                                             06549864
042100         WHEN SQLCODE = +100                                      06550263
042100         WHEN SQLCODE = -305                                      06550363
041900             MOVE SPACES TO PV-MANIFEST-DATE                      06550464
041900                            PV-MANIFEST-TIME                      06550564
042300         WHEN SQLWARN0 NOT = SPACES                               06550664
042400         WHEN SQLCODE < +0                                        06550764
042500         WHEN SQLCODE > ZERO                                      06550864
042600             MOVE '3140-MANIFEST-DTE-TM'                          06550965
042700                                 TO PV-PARAGRAPH                  06551064
042900             MOVE 'SELECT'       TO PV-DB2-FUNCTION               06551164
043000             MOVE 'SUT_OTBND_LOC'                                 06551265
043000                                 TO PV-DB2-TABLE-NAME             06551364
043100             MOVE SU067-SHIPT-UNT-ID TO PV-DISP-SHIPT-UNT-ID      06551499
043200             STRING 'SHIPT-UNT-ID: '  DELIMITED BY SIZE           06551599
043300                PV-DISP-SHIPT-UNT-ID  DELIMITED BY SIZE           06551699
043400                               INTO PV-DB2-OPERATION-MESSAGE-1    06551799
044500             PERFORM 9200-SQL-ABEND                               06551864
044600     END-EVALUATE.                                                06551964
061100                                                                  06553164
       3150-UPLOAD-TMST.                                                06553299
040600     EXEC SQL                                                     06553399
040700         SELECT MIN(CRE_TMST)                                     06553499
040800           INTO :PV-UPLOAD-TMST                                   06553699
                 FROM SUT_OTBND_LOC                                     06553899
                WHERE SHIPT_UNT_ID = :SU067-SHIPT-UNT-ID                06553999
                  AND SCN_CDE     IN ('LTP','DNP')                      06554099
041500     END-EXEC.                                                    06556099
041600                                                                  06557099
041700     EVALUATE TRUE                                                06558099
041800         WHEN SQLCODE = ZERO                                      06559099
                   CONTINUE                                             06560099
042100         WHEN SQLCODE = +100                                      06561099
042100         WHEN SQLCODE = -305                                      06562099
041900             MOVE SPACES TO PV-UPLOAD-TMST                        06563099
042300         WHEN SQLWARN0 NOT = SPACES                               06563299
042400         WHEN SQLCODE < +0                                        06563399
042500         WHEN SQLCODE > ZERO                                      06563499
042600             MOVE '3150-UPLOAD-TMST'                              06563599
042700                                 TO PV-PARAGRAPH                  06563699
042900             MOVE 'SELECT'       TO PV-DB2-FUNCTION               06563799
043000             MOVE 'SUT_OTBND_LOC'                                 06563899
043000                                 TO PV-DB2-TABLE-NAME             06563999
043100             MOVE SU067-SHIPT-UNT-ID TO PV-DISP-SHIPT-UNT-ID      06564099
043200             STRING 'SHIPT-UNT-ID: '  DELIMITED BY SIZE           06564199
043300                PV-DISP-SHIPT-UNT-ID  DELIMITED BY SIZE           06564299
043400                               INTO PV-DB2-OPERATION-MESSAGE-1    06564399
044500             PERFORM 9200-SQL-ABEND                               06564499
044600     END-EVALUATE.                                                06564599
                                                                        06564699
046100***************************************************************** 06564764
046200 5000-SELECT-OPER-DESC.                                           06564864
046300***************************************************************** 06564964
046400*                                                                 06565064
046500     INITIALIZE XL071-COMMAREA-REC.                               06565164
046600     MOVE SU067-LOC-NBR         TO XL071-LOCATION-NUMBER          06565264
                                         PV-DISP-LOC                    06565364
                                         HL2-OPER-ID                    06565464
046700                                                                  06565564
046800     CALL XL071-LOCATION-MODULE USING XL071-COMMAREA-REC.         06565664
046900                                                                  06565764
047000     EVALUATE TRUE                                                06565864
047100     WHEN XL071-NO-ERRORS                                         06565964
047200         MOVE XL071-LOC-NM          TO HL2-LOC-DESC               06566064
047300     WHEN XL071-LOC-NOT-FOUND                                     06566164
047400     WHEN XL071-DC-ASGMT-NOT-FND                                  06566264
047500         MOVE 'UNKNOWN'             TO HL2-LOC-DESC               06566364
047600     WHEN XL071-BAD-DB2-RETURN                                    06566464
047700         MOVE '5000-SELECT-OPER-DESC' TO PV-PARAGRAPH             06566564
047700         DISPLAY '5000-SELECT-OPER-DESC'                          06566664
047800         DISPLAY 'CALL LOCATION MOD '                             06566764
073700         DISPLAY '** LOCATION     = ' PV-DISP-LOC                 06566864
047900         DISPLAY 'XLT00010'                                       06566964
048000         MOVE XL071-SQLCA             TO SQLCA                    06567064
048100         PERFORM 9200-SQL-ABEND                                   06567164
048200     END-EVALUATE.                                                06567264
065500                                                                  06567364
235500 6000-CALL-CRTN-STATUS-PGM.                                       06567464
235600                                                                  06567564
235700     INITIALIZE PC046-COMMAREA-REC.                               06567664
235800     MOVE  SU067-SHIPT-UNT-ID    TO  PC046-CARTON-ID.             06567764
235900                                                                  06567864
236000     CALL PC-CRTN-STATUS-PGM                                      06567964
236100        USING PC046-COMMAREA-REC.                                 06568064
065500                                                                  06568164
027700     IF  PC046-SUCCESSFUL                                         06568264
027800         CONTINUE                                                 06568364
027900     ELSE                                                         06568464
028800         DISPLAY '** ABEND - PROGRAM ' PC-CURRENT-PROGRAM-NAME    06568564
029000         DISPLAY '** BAD CALL TO CRTN STATUS PGM PCKUT713'        06568664
027600         DISPLAY 'PC046-CRA-RET-CDE = ' PC046-CRA-RET-CDE         06568764
029100         DISPLAY PC046-CRA-RET-MSG                                06568864
029200         MOVE +4019 TO PV-ABEND-CODE                              06568964
029300         CALL 'ILBOABN0' USING PV-ABEND-CODE                      06569064
030100     END-IF.                                                      06569164
058400******************************************************************06569264
058500*  READ NEXT INPUT FILE RECORD.                                   06569364
058600******************************************************************06569464
058700 7000-READ-EXTRACT.                                               06569564
058800                                                                  06569664
058900     READ SML-EMPTY-UNKNOWN-FILE INTO SU067-EXTRACT-RECORD        06569799
059000        AT END                                                    06569864
059100           SET PS-END-OF-INPUT TO TRUE                            06569964
059200        NOT AT END                                                06570064
059300           ADD +1                   TO PV-READ-COUNT              06570164
059800     END-READ.                                                    06570264
059900*                                                                 06570345
065700******************************************************************06571001
065800 8000-WRITE-MAIN-HEADINGS.                                        06580001
065900******************************************************************06590001
066000*                                                                 06600001
060800     SET PS-NEW-PAGE TO TRUE                                      06601012
066800                                                                  06680001
066900     ADD 1                         TO PV-PAGE-COUNT.              06690001
067000     MOVE PV-PAGE-COUNT            TO DP132O-PAGE-NUMBER.         06700001
067100     MOVE ZERO                     TO PV-LINE-COUNT.              06710001
067200                                                                  06720001
067300     WRITE REPORT-RECORD-1 FROM                                   06730001
067400         DP132O-STANDRD-HEADER-132-COLS                           06740001
067500         AFTER ADVANCING PAGE.                                    06750001
067600                                                                  06760001
067700     WRITE REPORT-RECORD-1 FROM DL-BLANK-LINE                     06770001
067800         AFTER ADVANCING 1 LINE                                   06780001
067900                                                                  06790001
068000     WRITE REPORT-RECORD-1 FROM HL-HEADING-LINE-1                 06800001
068100        AFTER ADVANCING 1 LINES.                                  06810001
068200                                                                  06820001
068300     WRITE REPORT-RECORD-1 FROM DL-BLANK-LINE                     06830001
068400         AFTER ADVANCING 1 LINE                                   06840001
068500                                                                  06850001
068600     WRITE REPORT-RECORD-1 FROM HL-HEADING-LINE-2                 06860001
068700        AFTER ADVANCING 1 LINES.                                  06870001
068800                                                                  06880001
068900     WRITE REPORT-RECORD-1 FROM DL-BLANK-LINE                     06890001
069000         AFTER ADVANCING 1 LINE                                   06900001
069100                                                                  06910001
069200     WRITE REPORT-RECORD-1 FROM HL-HEADING-LINE-3                 06920001
069300        AFTER ADVANCING 1 LINES.                                  06930001
069400                                                                  06940001
069500     WRITE REPORT-RECORD-1 FROM HL-HEADING-LINE-4                 06950001
069600        AFTER ADVANCING 1 LINES.                                  06960001
069700                                                                  06970001
069800     WRITE REPORT-RECORD-1 FROM DL-BLANK-LINE                     06980001
069900         AFTER ADVANCING 1 LINE                                   06990001
070000                                                                  07000001
070100     ADD 8                            TO PV-LINE-COUNT.           07010001
070200*                                                                 07020001
070300******************************************************************07030001
070400 9000-EOJ.                                                        07040001
070500******************************************************************07050001
070600*                                                                 07060001
070700     WRITE REPORT-RECORD-1 FROM ER-END-OF-REPORT-LINE             07070001
070800        AFTER ADVANCING 2 LINES                                   07080001
070900                                                                  07090001
071000*CLOSE FILES.                                                     07100001
041800     CLOSE SML-EMPTY-UNKNOWN-FILE                                 07101099
041800           STILL-EMPTY-UNKNOWN-FILE                               07102099
071300           REPORT-FILE-1.                                         07130003
071400                                                                  07140001
071500     MOVE PV-READ-COUNT         TO PV-DISPLAY-COUNT.              07150099
071600     DISPLAY '** SUKRP050 TOTAL INPUT RECORDS READ....: '         07160099
071600                                                 PV-DISPLAY-COUNT.07160199
           MOVE PV-WRITE-COUNT        TO PV-DISPLAY-COUNT               07161099
           DISPLAY '** SUKRP050 TOTAL OUTPUT RECORDS WRITTEN: '         07162099
                                                       PV-DISPLAY-COUNT.07163099
           MOVE PV-PURGE-CARTON-COUNT TO PV-DISPLAY-COUNT               07164099
           DISPLAY '** SUKRP050 TOTAL OLD RECORDS BYPASSED..: '         07165099
                                                       PV-DISPLAY-COUNT.07166099
           MOVE PV-INPUT-PROCESSED-COUNT TO PV-DISPLAY-COUNT            07167099
           DISPLAY '** SUKRP050 TOTAL INPUT PROCESSED.......: '         07168099
                                                       PV-DISPLAY-COUNT.07169099
071700                                                                  07170001
072100/                                                                 07210001
072200******************************************************************07220001
072300 9200-SQL-ABEND.                                                  07230001
072500                                                                  07250001
072600     MOVE SQLCODE                     TO SQLCODE2.                07260001
072700     MOVE SQLERRD(3)                  TO SQLERRD3.                07270001
072800                                                                  07280001
072900     DISPLAY '** ABEND **         ** = SQLERROR'.                 07290001
073000     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        07300001
073100     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH.                   07310001
073200     DISPLAY '** TABLE NAME * = ' PV-DB2-TABLE-NAME.              07320001
073300     DISPLAY '** OPERATION ** = ' PV-DB2-FUNCTION.                07330001
073400     DISPLAY '*** MESSAGE     = ' PV-DB2-OPERATION-MESSAGE-1.     07340001
073500     DISPLAY '***             = ' PV-DB2-OPERATION-MESSAGE-2.     07350001
073600     DISPLAY '***             = ' PV-DB2-OPERATION-MESSAGE-3.     07360001
073700     DISPLAY '** HOST VARIABLE= ' PV-DISPLAY-HOST-VAR             07370001
073800                                                                  07380001
073900     DISPLAY '** SQLCODE          ** = ' SQLCODE2.                07390001
074000     DISPLAY '** ROWS PROCESSED   ** = ' SQLERRD3.                07400001
074100     DISPLAY '** SQLERRM          ** = ' SQLERRM.                 07410001
074200     DISPLAY '** SQLERRMC         ** = ' SQLERRMC.                07420001
074300                                                                  07430001
074500     MOVE +4013                       TO PV-ABEND-CODE.           07450001
074600     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         07460001
074700                                                                  07470001
074800******************************************************************07480001
074900 9300-SQL-WARNING.                                                07490001
075000******************************************************************07500001
075100                                                                  07510001
075200     DISPLAY '9300-SQL-WARNING'.                                  07520001
075300     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        07530001
075400     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH.                   07540001
075500     DISPLAY '** OPERATION ** = ' PV-DB2-FUNCTION.                07550001
075600                                                                  07560001
075700     MOVE SQLCODE                     TO SQLCODE2.                07570001
075800     MOVE SQLERRD(3)                  TO SQLERRD3.                07580001
075900     DISPLAY '** ABEND **       ** = SQLWARNING'.                 07590001
076000     DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  07600001
076100     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  07610001
076200     DISPLAY '** SQLWARN0       ** = ' SQLWARN0.                  07620001
076300     DISPLAY '** SQLWARN1       ** = ' SQLWARN1.                  07630001
076400     DISPLAY '** SQLWARN2       ** = ' SQLWARN2.                  07640001
076500     DISPLAY '** SQLWARN3       ** = ' SQLWARN3.                  07650001
076600     DISPLAY '** SQLWARN4       ** = ' SQLWARN4.                  07660001
076700     DISPLAY '** SQLWARN5       ** = ' SQLWARN5.                  07670001
076800     DISPLAY '** SQLWARN6       ** = ' SQLWARN6.                  07680001
076900     DISPLAY '** SQLWARN7       ** = ' SQLWARN7.                  07690001
077000                                                                  07700001
077100     MOVE +4013                       TO PV-ABEND-CODE.           07710001
077200     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         07720001
077300*                                                                 07730001
