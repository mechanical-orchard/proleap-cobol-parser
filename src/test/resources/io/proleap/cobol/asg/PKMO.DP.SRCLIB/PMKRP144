       IDENTIFICATION DIVISION.                                         00010000
       PROGRAM-ID.             PMKRP144.                                00020000
       AUTHOR.                 DAVID FELLENZ.                           00030000
       INSTALLATION.           KOHLS DEPARTMENT STORES.                 00040000
       DATE-WRITTEN.           JUNE 2007.                               00050000
       DATE-COMPILED.                                                   00060000
      ***************************************************************** 00070000
      *  PMKRP144 -- FULL DAY RULE PRICING EXCEPTION REPORT (WR32910)   00080000
      *    **** NON-MAIN VS. NON-MAIN ****                              00090000
      *    THIS REPORT READS PMT_SKU_LVL_PRICG_BY_LOC ORACLE TABLE      00100000
      *    COMPARING PRICING IN NON-MAIN PROMOTION'S THAT FALL ON THE   00110000
      *    SAME DAY THAT ARE PRICED EQUAL TO OR LOWER THAN.             00120000
      *    REPORT BREAKS ON CHANGE OF GMM, DMM, BUYER, AND DEPT.        00130000
      ***************************************************************** 00140000
      *----------------------------------------------------------       00150000
      * HISTORY LOG:                                                    00160000
      *----------------------------------------------------------       00170000
      *                                                                 00180000
      * DATE:        07/22/2010                                         00190000
      * WR/IR#:      WR37986                                            00200000
      * PROGRAMMER:  PATTY JAEGER                                       00210000
      * DESCRIPTION: CHANGES MADE TO EXCLUDE WEB STORE DATA FROM        00220000
      *              THE REPORT                                         00230000
      *                                                                 00240004
      * DATE:        04/20/2012                                         00250004
PM3403* WR/IR#:      PMO 03403                                          00260004
      * PROGRAMMER:  SCOTT JACKSON                                      00270004
      * DESCRIPTION: CHANGES MADE TO HANDLE LARGE UNIT RETAIL > 9999.99 00280004
      *                                                                 00281008
      * DATE:        07/30/2018                                         00283008
      * WR/IR#:      CHG0204126                                         00284008
      * PROGRAMMER:  COGNIZANT                                          00285008
      * DESCRIPTION: ORACLE LOGON STANDARDS PROGRAM CHANGE              00286008
      *----------------------------------------------------------       00290000
       ENVIRONMENT DIVISION.                                            00300000
       CONFIGURATION SECTION.                                           00310000
       SOURCE-COMPUTER. IBM-3090.                                       00320000
       OBJECT-COMPUTER. IBM-3090.                                       00330000
                                                                        00340000
       INPUT-OUTPUT SECTION.                                            00350000
       FILE-CONTROL.                                                    00360000
                                                                        00370000
           SELECT CC-PROMO-FILE                                         00380000
              ASSIGN                     TO INP01.                      00390000
                                                                        00400000
           SELECT ORACLE-LOGON-FILE                                     00421006
               ASSIGN                    TO ORALOGON.                   00422006
                                                                        00430000
W37986     SELECT SMPL-STR-INFILE                                       00440000
W37986        ASSIGN                     TO INP03.                      00450000
W37986                                                                  00460000
           SELECT PR-CONFLICT-RPT                                       00470000
               ASSIGN                    TO RPT01.                      00480000
                                                                        00480105
                                                                        00490000
       DATA DIVISION.                                                   00500000
                                                                        00510000
       FILE SECTION.                                                    00520000
                                                                        00530000
       FD  CC-PROMO-FILE                                                00540000
           RECORDING MODE F                                             00550000
           BLOCK CONTAINS 0 RECORDS                                     00560000
           LABEL RECORDS ARE OMITTED                                    00570000
           DATA RECORD IS CC-PROMO-REC.                                 00580000
       01  CC-PROMO-REC                    PIC X(80).                   00590000
                                                                        00600000
       FD  ORACLE-LOGON-FILE                                            00610006
           RECORDING MODE IS F                                          00620006
           LABEL RECORDS ARE STANDARD                                   00630006
           BLOCK CONTAINS 0 RECORDS                                     00640006
           RECORD CONTAINS 80 CHARACTERS                                00650006
           DATA RECORDS IS OL-ORACLE-LOGON-RECORD.                      00651006
       01  OL-ORACLE-LOGON-RECORD      PIC X(80).                       00652006
                                                                        00660000
W37986 FD  SMPL-STR-INFILE                                              00670000
W37986     RECORDING MODE F                                             00680000
W37986     BLOCK CONTAINS 0 RECORDS                                     00690000
W37986     LABEL RECORDS ARE OMITTED                                    00700000
W37986     DATA RECORD IS SMPL-STR-INFILE-REC.                          00710000
W37986 01  SMPL-STR-INFILE-REC           PIC X(80).                     00720000
W37986                                                                  00730000
       FD  PR-CONFLICT-RPT                                              00740000
           RECORDING MODE F                                             00750000
           BLOCK CONTAINS 0 RECORDS                                     00760000
           LABEL RECORDS ARE OMITTED.                                   00770000
       01  PR-CONFLICT-LINE              PIC X(175).                    00780000
                                                                        00790000
                                                                        00798005
       WORKING-STORAGE SECTION.                                         00800000
                                                                        00810000
       01  ABEND-CODE                    PIC S9(04) COMP VALUE +0.      00820000
           88  ABEND-4001-WRITE-ERROR               VALUE +4001.        00830000
           88  ABEND-4002-READ-ERROR                VALUE +4002.        00840000
           88  ABEND-4003-CTRL-CARD-ERROR           VALUE +4003.        00850000
           88  ABEND-4004-TABLE-ERROR               VALUE +4004.        00860000
           88  ABEND-4005-OPEN-ERROR                VALUE +4005.        00870000
           88  ABEND-4006-CLOSE-ERROR               VALUE +4006.        00880000
           88  ABEND-4007-SEQUENCE-ERROR            VALUE +4007.        00890000
           88  ABEND-4008-DATA-ERROR                VALUE +4008.        00900000
           88  ABEND-4009-KEY-DATA-ERROR            VALUE +4009.        00910000
           88  ABEND-4013-SQL-ERROR                 VALUE +4013.        00920000
           88  ABEND-4014-ORACLE-LOGON-ERROR        VALUE +4014.        00930000
           88  ABEND-4019-DATE-ROUTINE-ERROR        VALUE +4019.        00940000
           88  ABEND-4444-FORCED-ABEND              VALUE +4444.        00950000
                                                                        00960000
       01  CD-CPU-DATE.                                                 00970000
           05  CD-CPU-YR                  PIC 9(02) VALUE ZERO.         00980000
           05  CD-CPU-MO                  PIC 9(02) VALUE ZERO.         00990000
           05  CD-CPU-DY                  PIC 9(02) VALUE ZERO.         01000000
                                                                        01010000
       01  CD-CPU-DATE-GREG.                                            01020000
           05  CD-CPU-MM                  PIC 9(02) VALUE ZERO.         01030000
           05  CD-CPU-DD                  PIC 9(02) VALUE ZERO.         01040000
           05  CD-CPU-YY                  PIC 9(02) VALUE ZERO.         01050000
                                                                        01060000
       01  CT-CPU-TIME.                                                 01070000
           05  CT-CPU-HR                  PIC 9(02) VALUE ZERO.         01080000
           05  CT-CPU-MIN                 PIC 9(02) VALUE ZERO.         01090000
           05  CT-CPU-SEC                 PIC 9(02) VALUE ZERO.         01100000
           05  CT-CPU-HSEC                PIC 9(02) VALUE ZERO.         01110000
                                                                        01120000
       01  LEGAL-LINE.                                                  01130000
           05  FILLER                       PIC X(44)      VALUE SPACES.01140000
           05  FILLER                       PIC X(43)      VALUE        01150000
               '** PRIVILEGED AND CONFIDENTIAL, ATTORNEY-CL'.           01160000
           05  FILLER                       PIC X(43)      VALUE        01170000
               'IENT PRIVILEGE AND ATTORNEY WORK PRODUCT **'.           01180000
           05  FILLER                       PIC X(45)      VALUE SPACES.01190000
                                                                        01200000
       01  END-OF-REPORT-LINE.                                          01210000
           05  FILLER                     PIC X(77) VALUE SPACES.       01220000
           05  FILLER                     PIC X(20) VALUE               01230000
               ' ** END OF REPORT **'.                                  01240000
           05  FILLER                     PIC X(78) VALUE SPACES.       01250000
                                                                        01260000
       01  NOTHING-TO-REPORT-LINE.                                      01270000
           05  FILLER                     PIC X(79) VALUE SPACES.       01280000
           05  FILLER                     PIC X(24) VALUE               01290000
               ' ** NOTHING TO REPORT **'.                              01300000
           05  FILLER                     PIC X(80) VALUE SPACES.       01310000
                                                                        01320000
       01  HEADER-01.                                                   01330000
           05  FILLER                     PIC X(54) VALUE SPACES.       01340000
           05  HDR-01-TITLE               PIC X(42) VALUE SPACES.       01350000
           05  FILLER                     PIC X(79) VALUE SPACES.       01360000
                                                                        01370000
       01  HEADER-02.                                                   01380000
           05  FILLER                     PIC X(54) VALUE SPACES.       01390000
           05  HDR-02-TITLE-1             PIC X(09) VALUE SPACES.       01400000
           05  FILLER                     PIC X(01) VALUE SPACES.       01410000
           05  HDR-02-TITLE-2             PIC X(15) VALUE SPACES.       01420000
           05  FILLER                     PIC X(02) VALUE SPACES.       01430000
           05  HDR-02-TITLE-3             PIC X(25) VALUE SPACES.       01440000
           05  FILLER                     PIC X(38) VALUE SPACES.       01450000
                                                                        01460000
       01  HEADER-03.                                                   01470000
           05  FILLER                     PIC  X(58) VALUE SPACES.      01480000
           05  HDR-03-TITLE               PIC X(105) VALUE SPACES.      01490000
           05  FILLER                     PIC  X(12) VALUE SPACES.      01500000
                                                                        01510000
       01  HEADER-04.                                                   01520000
           05  FILLER                     PIC  X(63) VALUE SPACES.      01530000
           05  HDR-04-TITLE               PIC  X(30) VALUE SPACES.      01540000
           05  FILLER                     PIC  X(82) VALUE SPACES.      01550000
                                                                        01560000
       01  HEADER-GMM.                                                  01570000
           05  FILLER                     PIC X(07) VALUE               01580000
               'GMM:   '.                                               01590000
           05  FILLER                     PIC X(01) VALUE SPACES.       01600000
           05  HDR-GMM-NBR                PIC X(04).                    01610000
           05  FILLER                     PIC X(01) VALUE SPACES.       01620000
           05  HDR-GMM-NAME               PIC X(36).                    01630000
           05  FILLER                     PIC X(127) VALUE SPACES.      01640000
                                                                        01650000
       01  HEADER-DMM.                                                  01660000
           05  FILLER                     PIC X(07) VALUE               01670000
               'DMM:   '.                                               01680000
           05  FILLER                     PIC X(01) VALUE SPACES.       01690000
           05  HDR-DMM-NBR                PIC X(04).                    01700000
           05  FILLER                     PIC X(01) VALUE SPACES.       01710000
           05  HDR-DMM-NAME               PIC X(36).                    01720000
           05  FILLER                     PIC X(127) VALUE SPACES.      01730000
                                                                        01740000
       01  HEADER-BUYER.                                                01750000
           05  FILLER                     PIC X(08) VALUE               01760000
               'BUYER:  '.                                              01770000
           05  HDR-BYR-NBR              PIC X(04).                      01780000
           05  FILLER                     PIC X(01) VALUE SPACES.       01790000
           05  HDR-BYR-NAME             PIC X(36).                      01800000
           05  FILLER                     PIC X(126) VALUE SPACES.      01810000
                                                                        01820000
       01  HEADER-DEPT.                                                 01830000
           05  FILLER                     PIC X(08) VALUE               01840000
               'DEPT:   '.                                              01850000
           05  HDR-DEPT-NBR               PIC X(04).                    01860000
           05  FILLER                     PIC X(01) VALUE SPACES.       01870000
           05  HDR-DEPT-NAME              PIC X(36).                    01880000
           05  FILLER                     PIC X(126) VALUE SPACES.      01890000
                                                                        01900000
       01  HEADER-PRE-05.                                               01910000
           05  FILLER                     PIC X(77) VALUE SPACES.       01920000
           05  FILLER                     PIC X(08) VALUE               01930000
               'BEGIN'.                                                 01940000
           05  FILLER                     PIC X(01) VALUE SPACES.       01950000
           05  FILLER                     PIC X(08) VALUE               01960000
               'END'.                                                   01970000
           05  FILLER                     PIC X(48) VALUE SPACES.       01980000
           05  FILLER                     PIC X(08) VALUE               01990000
               '  RETAIL'.                                              02000000
           05  FILLER                     PIC X(01) VALUE SPACES.       02010000
           05  FILLER                     PIC X(09) VALUE               02020000
               '    PROMO'.                                             02030000
           05  FILLER                     PIC X(04) VALUE SPACES.       02040000
           05  FILLER                     PIC X(09) VALUE               02050000
               '    PRICE'.                                             02060000
                                                                        02070000
       01  HEADER-05.                                                   02080000
           05  FILLER                     PIC X(04) VALUE               02090000
               'DPT'.                                                   02100000
           05  FILLER                     PIC X(01) VALUE SPACES.       02110000
           05  FILLER                     PIC X(04) VALUE               02120000
               'SCL'.                                                   02130000
           05  FILLER                     PIC X(01) VALUE SPACES.       02140000
           05  FILLER                     PIC X(08) VALUE               02150000
               'SKU NBR'.                                               02160000
           05  FILLER                     PIC X(01) VALUE SPACES.       02170000
           05  FILLER                     PIC X(20) VALUE               02180000
               'SKU DESC'.                                              02190000
           05  FILLER                     PIC X(02) VALUE SPACES.       02200000
           05  FILLER                     PIC X(19) VALUE               02210000
               'STYLE NBR'.                                             02220000
           05  FILLER                     PIC X(01) VALUE SPACES.       02230000
           05  FILLER                     PIC X(15) VALUE               02240000
               'PROMOTION'.                                             02250000
           05  FILLER                     PIC X(01) VALUE SPACES.       02260000
           05  FILLER                     PIC X(08) VALUE               02270000
               'DATE'.                                                  02280000
           05  FILLER                     PIC X(01) VALUE SPACES.       02290000
           05  FILLER                     PIC X(08) VALUE               02300000
               'DATE  '.                                                02310000
           05  FILLER                     PIC X(01) VALUE SPACES.       02320000
           05  FILLER                     PIC X(31) VALUE               02330000
               'PROMO ITEM DESCRIPTION'.                                02340000
           05  FILLER                     PIC X(01) VALUE SPACES.       02350000
           05  FILLER                     PIC X(03) VALUE               02360000
               'A/U'.                                                   02370000
           05  FILLER                     PIC X(01) VALUE SPACES.       02380000
           05  FILLER                     PIC X(10) VALUE               02390000
               'SIGN NBR'.                                              02400000
           05  FILLER                     PIC X(01) VALUE SPACES.       02410000
           05  FILLER                     PIC X(08) VALUE               02420000
               '   PRICE'.                                              02430000
           05  FILLER                     PIC X(01) VALUE SPACES.       02440000
           05  FILLER                     PIC X(09) VALUE               02450000
               '    PRICE'.                                             02460000
           05  FILLER                     PIC X(01) VALUE SPACES.       02470000
           05  FILLER                     PIC X(02) VALUE               02480000
               'TP'.                                                    02490000
           05  FILLER                     PIC X(01) VALUE SPACES.       02500000
           05  FILLER                     PIC X(09) VALUE               02510000
               'VIOLATION'.                                             02520000
                                                                        02530000
       01  BLANK-PAGE-NOTE.                                             02540000
           05  FILLER                     PIC X(64) VALUE SPACES.       02550000
           05  FILLER                     PIC X(46) VALUE               02560000
               '***** THIS PAGE INTENTIONALLY LEFT BLANK *****'.        02570000
           05  FILLER                     PIC X(65) VALUE SPACES.       02580000
                                                                        02590000
       01  DETAIL-01.                                                   02600000
           05  DTL-01-DEPT-NBR            PIC X(04).                    02610000
           05  FILLER                     PIC X(01) VALUE SPACES.       02620000
           05  DTL-01-SUB-CL-NBR          PIC X(04).                    02630000
           05  FILLER                     PIC X(01) VALUE SPACES.       02640000
           05  DTL-01-SKU-NBR             PIC X(08).                    02650000
           05  FILLER                     PIC X(01) VALUE SPACES.       02660000
           05  DTL-01-SKU-DESC            PIC X(20).                    02670000
           05  FILLER                     PIC X(02) VALUE SPACES.       02680000
           05  DTL-01-STYLE-NBR           PIC X(19).                    02690000
           05  FILLER                     PIC X(01) VALUE SPACES.       02700000
           05  DTL-01-PROMO-NAME-1        PIC X(15).                    02710000
           05  FILLER                     PIC X(01) VALUE SPACES.       02720000
           05  DTL-01-PROMO-BEG-DTE-1.                                  02730000
               10 DTL-01-PM-BEG-DTE-MM    PIC X(02) VALUE SPACES.       02740000
               10 DTL-01-PM-BEG-DTE-D1    PIC X(01) VALUE '/'.          02750000
               10 DTL-01-PM-BEG-DTE-DD    PIC X(02) VALUE SPACES.       02760000
               10 DTL-01-PM-BEG-DTE-D2    PIC X(01) VALUE '/'.          02770000
               10 DTL-01-PM-BEG-DTE-YY    PIC X(02) VALUE SPACES.       02780000
           05  FILLER                     PIC X(01) VALUE SPACES.       02790000
           05  DTL-01-PROMO-END-DTE-1.                                  02800000
               10 DTL-01-PM-END-DTE-MM    PIC X(02) VALUE SPACES.       02810000
               10 DTL-01-PM-END-DTE-D1    PIC X(01) VALUE '/'.          02820000
               10 DTL-01-PM-END-DTE-DD    PIC X(02) VALUE SPACES.       02830000
               10 DTL-01-PM-END-DTE-D2    PIC X(01) VALUE '/'.          02840000
               10 DTL-01-PM-END-DTE-YY    PIC X(02) VALUE SPACES.       02850000
           05  FILLER                     PIC X(01) VALUE SPACES.       02860000
           05  DTL-01-PROMO-ITM-DESC-1    PIC X(31).                    02870000
           05  FILLER                     PIC X(02) VALUE SPACES.       02880000
           05  DTL-01-ADV-IND-1           PIC X(01).                    02890000
PM3403*    05  FILLER                     PIC X(02) VALUE SPACES.       02900004
PM3403     05  FILLER                     PIC X(01) VALUE SPACES.       02910004
           05  DTL-01-SIGN-NBR            PIC X(10).                    02920000
           05  FILLER                     PIC X(01) VALUE SPACES.       02930000
PM3403*    05  DTL-01-RETAIL-PRICE-1      PIC Z,ZZZ.99.                 02940004
PM3403     05  DTL-01-RETAIL-PRICE-1      PIC ZZ,ZZZ.99.                02950004
           05  FILLER                     PIC X(01) VALUE SPACES.       02960000
           05  DTL-01-PROMO-PRICE-1       PIC ZZ,ZZZ.ZZ.                02970000
           05  FILLER                     PIC X(02) VALUE SPACES.       02980000
           05  DTL-01-TIER-PRICE-IND      PIC X(01) VALUE SPACES.       02990000
           05  FILLER                     PIC X(10) VALUE SPACES.       03000000
                                                                        03010000
       01  DETAIL-SGN.                                                  03020000
           05  FILLER                     PIC X(107) VALUE SPACES.      03030000
           05  DTL-NEXT-SGN-NBR           PIC X(07).                    03040000
           05  FILLER                     PIC X(67) VALUE SPACES.       03050000
                                                                        03060000
       01  DETAIL-PRINT-01                PIC X(175) VALUE SPACES.      03070000
                                                                        03080000
       01  DETAIL-02.                                                   03090000
           05  FILLER                     PIC X(61) VALUE SPACES.       03100000
           05  DTL-02-PROMO-NAME-2        PIC X(15).                    03110000
           05  FILLER                     PIC X(01) VALUE SPACES.       03120000
           05  DTL-02-PROMO-BEG-DTE-2.                                  03130000
               10 DTL-02-PM-BEG-DTE-MM    PIC X(02) VALUE SPACES.       03140000
               10 DTL-02-PM-BEG-DTE-D1    PIC X(01) VALUE '/'.          03150000
               10 DTL-02-PM-BEG-DTE-DD    PIC X(02) VALUE SPACES.       03160000
               10 DTL-02-PM-BEG-DTE-D2    PIC X(01) VALUE '/'.          03170000
               10 DTL-02-PM-BEG-DTE-YY    PIC X(02) VALUE SPACES.       03180000
           05  FILLER                     PIC X(01) VALUE SPACES.       03190000
           05  DTL-02-PROMO-END-DTE-2.                                  03200000
               10 DTL-02-PM-END-DTE-MM    PIC X(02) VALUE SPACES.       03210000
               10 DTL-02-PM-END-DTE-D1    PIC X(01) VALUE '/'.          03220000
               10 DTL-02-PM-END-DTE-DD    PIC X(02) VALUE SPACES.       03230000
               10 DTL-02-PM-END-DTE-D2    PIC X(01) VALUE '/'.          03240000
               10 DTL-02-PM-END-DTE-YY    PIC X(02) VALUE SPACES.       03250000
           05  FILLER                     PIC X(01) VALUE SPACES.       03260000
           05  DTL-02-PROMO-ITM-DESC-2    PIC X(31).                    03270000
           05  FILLER                     PIC X(02) VALUE SPACES.       03280000
           05  DTL-02-ADV-IND-2           PIC X(01).                    03290000
PM3403*    05  FILLER                     PIC X(02) VALUE SPACES.       03300004
PM3403     05  FILLER                     PIC X(01) VALUE SPACES.       03310004
           05  DTL-02-SIGN-NBR            PIC X(10).                    03320000
           05  FILLER                     PIC X(01) VALUE SPACES.       03330000
PM3403*    05  DTL-02-RETAIL-PRICE-2      PIC Z,ZZZ.99.                 03340004
PM3403     05  DTL-02-RETAIL-PRICE-2      PIC ZZ,ZZZ.99.                03350004
           05  FILLER                     PIC X(01) VALUE SPACES.       03360000
           05  DTL-02-PROMO-PRICE-2       PIC ZZ,ZZZ.99.                03370000
           05  FILLER                     PIC X(02) VALUE SPACES.       03380000
           05  DTL-02-TIER-PRICE-IND      PIC X(01) VALUE SPACES.       03390000
           05  FILLER                     PIC X(01) VALUE SPACES.       03400000
           05  DTL-02-WINNER-IND          PIC X(02).                    03410000
           05  FILLER                     PIC X(01) VALUE SPACES.       03420000
           05  DTL-02-WINNER-REASON       PIC X(06).                    03430000
                                                                        03440000
       01  DETAIL-PRINT-02                PIC X(175) VALUE SPACES.      03450000
                                                                        03460000
       01  PC-PROGRAM-CONSTANTS.                                        03470000
           05  PC-AUTO-LOGON              PIC  X(01) VALUE '/'.         03471005
           05  PC-MAX-LINES               PIC S9(04) COMP VALUE +59.    03480000
           05  PC-PROGRAM-NAME            PIC  X(08) VALUE 'PMKRP144'.  03490005
           05  PC-RDS-REPORT-NAME         PIC  X(02) VALUE SPACES.      03500000
           05  PC-ONE                     PIC  9(02)  VALUE 01.         03510000
DAFDAF     05  PC-HDR1-TITLE1             PIC  X(42) VALUE              03520000
DAFDAF         ' FULL DAY SALE PRICING EXCEPTION REPORT '.              03530000
           05  PC-PMKUT117-PGM            PIC  X(08) VALUE 'PMKUT117'.  03540000
           05  PC-HDR1-TITLE4-01          PIC  X(30) VALUE              03550000
               '  POST INITIAL DUE DATE       '.                        03560000
           05  PC-HDR1-TITLE4-02          PIC  X(30) VALUE              03570000
               '  PRE CORRECTIONS             '.                        03580000
           05  PC-HDR1-TITLE4-03          PIC  X(30) VALUE              03590000
               '  POST CORRECTIONS            '.                        03600000
                                                                        03610000
      ***************************************************************** 03620000
      * PS PROGRAM SWITCHES                                             03630000
      ***************************************************************** 03640000
       01  PS-PROGRAM-SWITCHES.                                         03650000
006510     05  PS-END-OF-LOGON-FILE-SW      PIC X(01) VALUE 'N'.        03651005
006530         88  PS-END-OF-LOGON-FILE               VALUE 'Y'.        03652005
           05  PS-ORA-SRC-CTL-DONE-SW       PIC X(01) VALUE 'N'.        03653005
               88  PS-ORA-SRC-EMPTY                   VALUE 'Y'.        03654005
           05  PS-SAME-SKU-SW               PIC X(01) VALUE 'N'.        03660000
               88  PS-SAME-SKU                        VALUE 'Y'.        03670000
               88  PS-NOT-SAME-SKU                    VALUE 'N'.        03680000
           05  PS-CONTROL-CARD-SW           PIC X(01) VALUE 'N'.        03690000
               88  PS-CONTROL-CARD-EOF                VALUE 'Y'.        03700000
               88  PS-CONTROL-CARD-NOT-EOF            VALUE 'N'.        03710000
           05  PS-PROMO-FILE-SW             PIC X(01) VALUE 'N'.        03720000
               88  PS-PROMO-EOF                       VALUE 'Y'.        03730000
               88  PS-PROMO-NOT-EOF                   VALUE 'N'.        03740000
           05  PS-FIRST-TIME-IN-SW          PIC X(01) VALUE 'N'.        03750000
               88  PS-NOT-FIRST-TIME-IN               VALUE 'Y'.        03760000
               88  PS-FIRST-TIME-IN                   VALUE 'N'.        03770000
           05  PS-RUN-REPORT-SW             PIC X(01) VALUE 'N'.        03780000
               88  PS-RUN-REPORT                      VALUE 'Y'.        03790000
               88  PS-NOT-RUN-REPORT                  VALUE 'N'.        03800000
           05  PS-PROMO-AVAIL-SW            PIC X(01) VALUE 'N'.        03810000
               88  PS-NO-PROMO                        VALUE 'Y'.        03820000
               88  PS-PROMO-AVAIL                     VALUE 'N'.        03830000
           05  PS-SKIP-RECORD-SW            PIC X(01) VALUE 'N'.        03840000
               88  PS-SKIP-RECORD                     VALUE 'Y'.        03850000
               88  PS-NOT-SKIP-RECORD                 VALUE 'N'.        03860000
           05  PS-END-OF-PRCON-SR-SW        PIC X(01) VALUE 'N'.        03870000
               88  PS-END-OF-PRCON-CSR                VALUE 'Y'.        03880000
               88  PS-NOT-END-OF-PRCON-CSR            VALUE 'N'.        03890000
W37986     05  PS-CONTROL-CARD-STR-SW       PIC X(01) VALUE 'N'.        03900000
W37986         88  PS-END-OF-CC-FILE-STR              VALUE 'Y'.        03910000
W37986         88  PS-NOT-END-OF-CC-FILE-STR          VALUE 'N'.        03920000
                                                                        03921005
       01  CC-ORACLE-CONNECTION.                                        03922005
           05  CC-ORACLE-USERID             PIC X(40).                  03923005
               88 CC-AUTO-LOGON                         VALUE '/'.      03924005
           05  CC-ORACLE-PASSWORD           PIC X(40).                  03925005
                                                                        03930000
       01  PV-PROGRAM-VARIABLES.                                        03940000
           05  PV-ORACLE-USERID-LEN       PIC S9(4) VALUE ZEROS         03941005
                                                    COMP SYNC.          03942005
           05  PV-ORACLE-PASSWORD-LEN     PIC S9(4) VALUE ZEROS         03943005
                                                    COMP SYNC.          03944005
           05 PV-PARAGRAPH-NAME           PIC X(30) VALUE SPACES.       03950000
           05 PV-TABLE-NAME               PIC X(30) VALUE SPACES.       03960000
           05 PV-OPERATION-MSG-1          PIC X(40) VALUE SPACES.       03970000
           05 PV-OPERATION-MSG-2          PIC X(40) VALUE SPACES.       03980000
           05 PV-CPU-TIME                 PIC 9(08) VALUE ZERO.         03990000
           05 PV-PAGE-CNT                 PIC 9(05) VALUE ZERO.         04000000
           05 PV-ADVANCE-LINES            PIC S9(04) COMP VALUE +1.     04010000
           05 PV-ADVANCE-CNT              PIC S9(04) COMP VALUE +0.     04020000
           05 PV-LINE-CNT                 PIC S9(04) COMP VALUE +0.     04030000
W37986     05 PV-SKU-CNT                  PIC S9(08) COMP VALUE +0.     04040003
           05 PV-FULL-DAY-INDEX           PIC S9(04)  VALUE +0          04050000
                                                        COMP SYNC.      04060000
           05 PV-PART-DAY-INDEX           PIC S9(04)  VALUE +0          04070000
                                                        COMP SYNC.      04080000
           05 PV-PAGE-DIV                 PIC S9(05) VALUE +0.          04090000
           05 PV-PAGE-REM                 PIC S9(03) VALUE +0.          04100000
           05 PV-UPC-ID                   PIC S9(9) COMP VALUE ZEROS.   04110000
           05 PV-PROMO-NBR                PIC S9(3)V COMP-3.            04120000
           05 PV-SGN-NBR                  PIC 9(07) COMP VALUE ZEROS.   04130000
           05 PV-SIGN-COUNT               PIC S9(9) VALUE ZERO COMP-3.  04140000
           05 PV-AD-EVNT-NM               PIC X(25) VALUE SPACES.       04150000
           05 PV-AD-EVNT-NBR-TXT          PIC X(15) VALUE SPACES.       04160000
           05 PV-AD-EVNT-NBR-TXT-SV       PIC X(15) VALUE SPACES.       04170000
           05 PV-MDSE-SELN-LNE-ID         PIC S9(10) COMP-3 VALUE +0.   04180000
           05 PV-MDSE-SELN-LNE-ID-S       PIC S9(10) COMP-3 VALUE +0.   04190000
           05 PV-REPORT-TYPE              PIC X(02) VALUE SPACES.       04200000
           05 PV-FULL-DAY-PROMO-ID        PIC S9(10) COMP-3 VALUE +0.   04210000
           05 PV-FULL-DAY-PROMO-NM        PIC X(25) VALUE SPACES.       04220000
           05 PV-PART-DAY-PROMO-ID        PIC S9(10) COMP-3 VALUE +0.   04230000
           05 PV-PART-DAY-PROMO-ID-SAVED  PIC S9(10) COMP-3 VALUE +0.   04240000
           05 PV-PART-DAY-PROMO-NM        PIC X(25) VALUE SPACES.       04250000
           05 PV-FULL-DAY-PROMO-STRT-TMST PIC X(19) VALUE SPACES.       04260000
           05 PV-FD-STRT-TMST-RDF REDEFINES PV-FULL-DAY-PROMO-STRT-TMST.04270000
              10 PV-FD-STRT-TMST-DATE.                                  04280000
                15 PV-FD-STRT-DTE-CC      PIC X(02).                    04290000
                15 PV-FD-STRT-DTE-YY      PIC X(02).                    04300000
                15 FILLER                 PIC X(01).                    04310000
                15 PV-FD-STRT-DTE-MM      PIC X(02).                    04320000
                15 FILLER                 PIC X(01).                    04330000
                15 PV-FD-STRT-DTE-DD      PIC X(02).                    04340000
              10 PV-FD-STRT-TMST-HYPHEN   PIC X(01).                    04350000
              10 PV-FD-STRT-DAY-TMST-TIME PIC X(08).                    04360000
           05 PV-FULL-DAY-PROMO-END-TMST  PIC X(19) VALUE SPACES.       04370000
           05 PV-FD-END-TMST-RDF REDEFINES PV-FULL-DAY-PROMO-END-TMST.  04380000
              10 PV-FD-END-TMST-DATE.                                   04390000
                15 PV-FD-END-DTE-CC       PIC X(02).                    04400000
                15 PV-FD-END-DTE-YY       PIC X(02).                    04410000
                15 FILLER                 PIC X(01).                    04420000
                15 PV-FD-END-DTE-MM       PIC X(02).                    04430000
                15 FILLER                 PIC X(01).                    04440000
                15 PV-FD-END-DTE-DD       PIC X(02).                    04450000
              10 PV-FD-END-TMST-HYPHEN    PIC X(01).                    04460000
              10 PV-FD-END-DAY-TMST-TIME  PIC X(08).                    04470000
           05 PV-PART-DAY-PROMO-STRT-TMST PIC X(19) VALUE SPACES.       04480000
           05 PV-PD-STRT-TMST-RDF REDEFINES PV-PART-DAY-PROMO-STRT-TMST.04490000
              10 PV-PD-STRT-TMST-DATE.                                  04500000
                15 PV-PD-STRT-DTE-CC      PIC X(02).                    04510000
                15 PV-PD-STRT-DTE-YY      PIC X(02).                    04520000
                15 FILLER                 PIC X(01).                    04530000
                15 PV-PD-STRT-DTE-MM      PIC X(02).                    04540000
                15 FILLER                 PIC X(01).                    04550000
                15 PV-PD-STRT-DTE-DD      PIC X(02).                    04560000
              10 PV-PD-STRT-TMST-HYPHEN   PIC X(01).                    04570000
              10 PV-PD-STRT-DAY-TMST-TIME PIC X(08).                    04580000
           05 PV-PART-DAY-PROMO-END-TMST  PIC X(19) VALUE SPACES.       04590000
           05 PV-PD-END-TMST-RDF REDEFINES PV-PART-DAY-PROMO-END-TMST.  04600000
              10 PV-PD-END-TMST-DATE.                                   04610000
                15 PV-PD-END-DTE-CC       PIC X(02).                    04620000
                15 PV-PD-END-DTE-YY       PIC X(02).                    04630000
                15 FILLER                 PIC X(01).                    04640000
                15 PV-PD-END-DTE-MM       PIC X(02).                    04650000
                15 FILLER                 PIC X(01).                    04660000
                15 PV-PD-END-DTE-DD       PIC X(02).                    04670000
              10 PV-PD-END-TMST-HYPHEN    PIC X(01).                    04680000
              10 PV-PD-END-DAY-TMST-TIME  PIC X(08).                    04690000
           05 PV-FULL-DAY-PROMO-ITM-ID    PIC S9(10) COMP-3 VALUE +0.   04700000
           05 PV-PART-DAY-PROMO-ITM-ID    PIC S9(10) COMP-3 VALUE +0.   04710000
           05 PV-FULL-DAY-PROMO-ITM-DESC  PIC X(31) VALUE SPACES.       04720000
           05 PV-PART-DAY-PROMO-ITM-DESC  PIC X(31) VALUE SPACES.       04730000
           05 PV-FULL-DAY-ADV-IND         PIC X(01) VALUE SPACES.       04740000
           05 PV-PART-DAY-ADV-IND         PIC X(01) VALUE SPACES.       04750000
           05 PV-FULL-DAY-PRCH-TYP-CDE    PIC X(01)  VALUE SPACES.      04760000
           05 PV-PART-DAY-PRCH-TYP-CDE    PIC X(01)  VALUE SPACES.      04770000
           05 PV-DEPT-NBR                 PIC S9(04) COMP-3 VALUE +0.   04780000
           05 PV-DEPT-NBR-SAVED           PIC S9(04) COMP-3 VALUE +0.   04790000
           05 PV-SUB-CL-NBR               PIC S9(04) COMP-3 VALUE +0.   04800000
           05 PV-SKU-NBR                  PIC S9(08) COMP-3 VALUE +0.   04810000
           05 PV-SKU-NBR-SAVED            PIC S9(08) COMP-3 VALUE +0.   04820000
           05 PV-STYLE-NBR                PIC  X(15) VALUE SPACES.      04830000
           05 PV-FULL-DAY-RETAIL-AMT    PIC S9(10)V9(3) COMP-3 VALUE +0.04840000
           05 PV-PART-DAY-RETAIL-AMT    PIC S9(10)V9(3) COMP-3 VALUE +0.04850000
           05 PV-PART-DAY-RETAIL-AMT-S  PIC S9(10)V9(3) COMP-3 VALUE +0.04860000
           05 PV-FULL-DAY-PRIC-PT-AMT   PIC S9(10)V9(3) COMP-3 VALUE +0.04870000
           05 PV-PART-DAY-PRIC-PT-AMT   PIC S9(10)V9(3) COMP-3 VALUE +0.04880000
           05 PV-PART-DAY-PRIC-PT-AMT-S PIC S9(10)V9(3) COMP-3 VALUE +0.04890000
           05 PV-FULL-DAY-PROMO-GP-QTY    PIC S9(05) COMP-3 VALUE +0.   04900000
           05 PV-PART-DAY-PROMO-GP-QTY PIC S9(05) COMP-3 VALUE +0.      04910000
           05 PV-FULL-DAY-PROMO-GP-AMT  PIC S9(09)V9(2) COMP-3 VALUE +0.04920000
           05 PV-PART-DAY-PROMO-GP-AMT  PIC S9(09)V9(2) COMP-3 VALUE +0.04930000
           05 PV-FULL-DAY-PRICG-TYP-CDE   PIC X(03) VALUE SPACES.       04940000
           05 PV-PART-DAY-PRICG-TYP-CDE PIC X(03) VALUE SPACES.         04950000
           05 PV-THRS-QTY                 PIC S9(05) COMP-3 VALUE +0.   04960000
           05 PV-LOC-NBR                  PIC S9(05) COMP-3 VALUE +0.   04970000
           05 PV-DEPT-NM                  PIC X(20) VALUE SPACES.       04980000
           05 PV-GMA-NBR                  PIC S9(4) COMP-3 VALUE +0.    04990000
           05 PV-GMA-NBR-SAVED            PIC S9(4) COMP-3 VALUE +0.    05000000
           05 PV-DMA-NBR                  PIC S9(4) COMP-3 VALUE +0.    05010000
           05 PV-DMA-NBR-SAVED            PIC S9(4) COMP-3 VALUE +0.    05020000
           05 PV-BYR-NBR                  PIC S9(4) COMP-3 VALUE +0.    05030000
           05 PV-BYR-NBR-SAVED            PIC S9(4) COMP-3 VALUE +0.    05040000
           05 PV-GMM-FRST-NM              PIC X(20).                    05050000
           05 PV-GMM-LAST-NM              PIC X(30).                    05060000
           05 PV-DMM-FRST-NM              PIC X(20).                    05070000
           05 PV-DMM-LAST-NM              PIC X(30).                    05080000
           05 PV-BYR-FRST-NM              PIC X(20).                    05090000
           05 PV-BYR-LAST-NM              PIC X(30).                    05100000
           05 PV-TEMP-VALUE               PIC X(01)  VALUE SPACES.      05110000
W37986     05 PV-CNT-STRS                 PIC 9(02)  VALUE ZEROES.      05120000
W37986     05 PV-HOST-STRS.                                             05130000
W37986        10  PV-HOST-STR-1           PIC S9(04) VALUE +0 COMP-3.   05140000
W37986        10  PV-HOST-STR-2           PIC S9(04) VALUE +0 COMP-3.   05150000
W37986        10  PV-HOST-STR-3           PIC S9(04) VALUE +0 COMP-3.   05160000
W37986        10  PV-HOST-STR-4           PIC S9(04) VALUE +0 COMP-3.   05170000
W37986        10  PV-HOST-STR-5           PIC S9(04) VALUE +0 COMP-3.   05180000
W37986        10  PV-HOST-STR-6           PIC S9(04) VALUE +0 COMP-3.   05190000
W37986        10  PV-HOST-STR-7           PIC S9(04) VALUE +0 COMP-3.   05200000
W37986        10  PV-HOST-STR-8           PIC S9(04) VALUE +0 COMP-3.   05210000
W37986        10  PV-HOST-STR-9           PIC S9(04) VALUE +0 COMP-3.   05220000
W37986        10  PV-HOST-STR-10          PIC S9(04) VALUE +0 COMP-3.   05230000
W37986        10  PV-HOST-STR-11          PIC S9(04) VALUE +0 COMP-3.   05240000
W37986        10  PV-HOST-STR-12          PIC S9(04) VALUE +0 COMP-3.   05250000
W37986        10  PV-HOST-STR-13          PIC S9(04) VALUE +0 COMP-3.   05260000
W37986        10  PV-HOST-STR-14          PIC S9(04) VALUE +0 COMP-3.   05270000
W37986        10  PV-HOST-STR-15          PIC S9(04) VALUE +0 COMP-3.   05280000
                                                                        05290000
                                                                        05300000
      ***************************************************************** 05310000
      *  STANDARD HEADER LINE - KOHLS 175 COL                           05320000
      ***************************************************************** 05330000
           COPY DPWS150O.                                               05340000
                                                                        05350000
      ***************************************************************** 05360000
      *    THE LAYOUT FOR THE GET SIGN NUMBER AND SKU DESCRIPTION     * 05370000
      *    PROGRAM PMKUT117 PARAMETER LIST.                           * 05380000
      ***************************************************************** 05390000
           COPY PMRD117.                                                05400000
                                                                        05410000
      ***************************************************************** 05420000
      *    THE LAYOUT FOR INPUT CONTROL CARD:                         * 05430000
      *    RUN DATE, REPORT TYPE, EB PROMO ID, FULL DAY PROMO ID      * 05440000
      ***************************************************************** 05450000
           COPY PMRD121.                                                05460000
                                                                        05470000
W37986***************************************************************** 05480000
W37986*    THE LAYOUT FOR INPUT FILE - SMPL-STR-INFILE                * 05490000
W37986***************************************************************** 05500000
W37986 01  CC-SMPL-STR-INFILE-REC.                                      05510000
W37986     05  CC-STR-NBR                     PIC 9(04) VALUE 0.        05520000
W37986     05  FILLER                         PIC X(76) VALUE SPACES.   05530000
W37986                                                                  05540000
      ***************************************************************** 05550000
      *                      O  R  A  C  L  E                           05560000
      *----------------------------------------------------------------*05570000
      *    ORACLE DECLARE SECTION                                       05580000
      *----------------------------------------------------------------*05590000
      *    COPY PMWS800.                                                05600005
                                                                        05610000
           EXEC SQL BEGIN DECLARE SECTION END-EXEC.                     05620000
                                                                        05630000
      *---------------------------------------------------------------* 05640000
      * ORACLE LOGON WORKING STORAGE COPYBOOK                           05650000
      *---------------------------------------------------------------* 05660000
       01      PC-ENT01-TYPE-CDE          PIC X(02)      VALUE '01'.    05670000
       01      PV-ORACLE-ID               PIC X(1)       VALUE '/'.     05680000
                                                                        05690000
       01      USERNAME                   PIC X(10)      VARYING.       05700000
       01      PASSWD                     PIC X(10)      VARYING.       05710000
                                                                        05720000
       01      ORACLE-RETURN              PIC X(200)     VALUE SPACES.  05730000
                                                                        05740000
           EXEC SQL END DECLARE SECTION END-EXEC.                       05750000
           EXEC SQL INCLUDE SQLCACOB    END-EXEC.                       05760000
                                                                        05770000
       PROCEDURE DIVISION.                                              05780000
      ***************************************************************** 05790000
      * MAINLINE ROUTINE                                                05800000
      ***************************************************************** 05810000
       A100-MAINLINE.                                                   05820000
                                                                        05830000
           PERFORM B100-INITIALIZE.                                     05840000
                                                                        05850000
      *    PERFORM PM800-A000-ORACLE-SETUP.                             05860005
           PERFORM B110-ORACLE-SETUP.                                   05861005
                                                                        05870000
           PERFORM B210-READ-PROMO-FILE                                 05880000
             UNTIL PS-PROMO-EOF.                                        05890000
                                                                        05900000
           PERFORM B900-CLOSE-FILES.                                    05910000
W37986     GOBACK.                                                      05920002
                                                                        05930000
      ***************************************************************** 05940000
      * INITIALIZE ROUTINE                                              05950000
      ***************************************************************** 05960000
       B100-INITIALIZE.                                                 05970000
                                                                        05980000
           OPEN INPUT  CC-PROMO-FILE                                    05990000
W37986                 SMPL-STR-INFILE                                  06010000
                OUTPUT PR-CONFLICT-RPT.                                 06020000
                                                                        06030000
           MOVE ZEROES                   TO PV-GMA-NBR-SAVED.           06040000
                                                                        06050000
DAFDAF*    PERFORM PM700-A000-ORACLE-SETUP.                             06060000
                                                                        06070000
      * SETS THE CURRENT DATE AND TIME ON THE TITLE OF THE REPORT.      06080000
           ACCEPT CD-CPU-DATE FROM DATE.                                06090000
           MOVE CD-CPU-YR                TO CD-CPU-YY.                  06100000
           MOVE CD-CPU-MO                TO CD-CPU-MM                   06110000
           MOVE CD-CPU-DY                TO CD-CPU-DD.                  06120000
                                                                        06130000
           ACCEPT CT-CPU-TIME FROM TIME.                                06140000
           MOVE CT-CPU-HR                TO DP150O-RUN-HOUR.            06150000
           MOVE CT-CPU-MIN               TO DP150O-RUN-MINUTE.          06160000
           MOVE CD-CPU-MO                TO DP150O-RUN-MONTH.           06170000
           MOVE CD-CPU-DY                TO DP150O-RUN-DAY.             06180000
           MOVE CD-CPU-YR                TO DP150O-RUN-YEAR.            06190000
           MOVE PC-PROGRAM-NAME          TO DP150O-PROGRAM-NAME.        06200005
           MOVE PC-RDS-REPORT-NAME       TO DP150O-REPORT-NUMBER.       06210000
                                                                        06220000
      ***************************************************************** 06221005
      * B110-READ-RUN-DATE-FILE.                                      * 06222005
      * ==> PROCESSES:                                                * 06223005
      *   - READ ORCALE CONTROL CARD                                  * 06224005
      * ==> PERFORMED FROM:  A100-MAINLINE                            * 06225005
      ***************************************************************** 06226005
       B110-ORACLE-SETUP.                                               06227005
                                                                        06228005
           OPEN INPUT ORACLE-LOGON-FILE.                                06229005
                                                                        06229105
           PERFORM B120-READ-ORACLE-LOGON.                              06229205
                                                                        06229305
           CLOSE ORACLE-LOGON-FILE.                                     06229405
                                                                        06229505
           IF ((PS-END-OF-LOGON-FILE)                                   06229605
                   OR (CC-ORACLE-CONNECTION = SPACES))                  06229705
               DISPLAY '** ABEND **'                                    06229805
               DISPLAY PC-PROGRAM-NAME ' - ORACLE LOGON CONTROL CARD '  06229905
                         'NOT PROVIDED'                                 06230005
               SET PS-ORA-SRC-EMPTY TO TRUE                             06230105
               CALL 'ILBOABN0' USING ABEND-CODE                         06230205
           END-IF.                                                      06230305
                                                                        06230405
           IF CC-AUTO-LOGON                                             06230505
               DISPLAY PC-PROGRAM-NAME ' - AUTO LOGON TO ORACLE'        06230605
               EXEC SQL                                                 06230705
                    CONNECT :USERNAME                                   06230805
               END-EXEC                                                 06230905
           ELSE                                                         06231005
               INITIALIZE PV-ORACLE-USERID-LEN                          06231105
                          PV-ORACLE-PASSWORD-LEN                        06231205
               INSPECT CC-ORACLE-USERID                                 06231305
                   TALLYING PV-ORACLE-USERID-LEN                        06231405
                FOR CHARACTERS BEFORE INITIAL SPACE                     06231505
            INSPECT CC-ORACLE-PASSWORD                                  06231605
                TALLYING PV-ORACLE-PASSWORD-LEN                         06231705
                FOR CHARACTERS BEFORE INITIAL SPACE                     06231805
            MOVE CC-ORACLE-USERID (1:PV-ORACLE-USERID-LEN) TO           06231905
                      USERNAME-ARR                                      06232005
            MOVE PV-ORACLE-USERID-LEN TO USERNAME-LEN                   06232105
            MOVE CC-ORACLE-PASSWORD (1:PV-ORACLE-PASSWORD-LEN) TO       06232205
                      PASSWD-ARR                                        06232305
            MOVE PV-ORACLE-PASSWORD-LEN TO PASSWD-LEN                   06232405
            DISPLAY PC-PROGRAM-NAME ' - LOGON TO ORACLE AS USER '       06232505
                      USERNAME-ARR                                      06232605
            EXEC SQL                                                    06232705
              CONNECT :USERNAME IDENTIFIED BY :PASSWD                   06232805
            END-EXEC                                                    06232905
            INITIALIZE CC-ORACLE-PASSWORD                               06233005
                       PASSWD                                           06233105
            END-IF.                                                     06233205
                                                                        06233305
020500     IF (SQLCODE NOT = 0)                                         06233405
020900         DISPLAY PV-PARAGRAPH-NAME                                06233505
020910         DISPLAY PC-PROGRAM-NAME ' - ERROR LOGGING ON TO ORACLE'  06233605
021000*        PERFORM 9900-ORACLE-ABEND                                06233705
               PERFORM Z100-ABEND                                       06233805
021200     END-IF.                                                      06233905
                                                                        06234005
      ***************************************************************** 06234105
      *  B120-READ-ORACLE-LOGON.                                      * 06234205
      * ==> PROCESSES:                                                * 06234305
      *   - READ ORCALE CONTROL CARD                                  * 06234405
      * ==> PERFORMED FROM:  B110-ORACLE-SETUP                        * 06234505
      ***************************************************************** 06234605
       B120-READ-ORACLE-LOGON.                                          06234705
                                                                        06234805
034510     READ ORACLE-LOGON-FILE                                       06234905
034520         INTO CC-ORACLE-CONNECTION                                06235005
034530         AT END                                                   06235105
034540             SET PS-END-OF-LOGON-FILE TO TRUE                     06235205
034550     END-READ.                                                    06235305
                                                                        06235405
      ****************************************************************  06236000
      * B210-READ-PROMO-FILE.                                           06240000
      *     READ IN THE PROMO FILE AND LOAD TO TABLE.                   06250000
      ****************************************************************  06260000
       B210-READ-PROMO-FILE.                                            06270000
                                                                        06280000
           READ CC-PROMO-FILE INTO PM121-PROMO                          06290000
              AT END                                                    06300000
                 SET PS-PROMO-EOF TO TRUE                               06310000
           END-READ.                                                    06320000
                                                                        06330000
           IF PS-PROMO-NOT-EOF                                          06340000
W37986         IF PS-FIRST-TIME-IN                                      06350000
W37986             SET PS-NOT-FIRST-TIME-IN TO TRUE                     06360000
W37986                                                                  06370000
W37986             PERFORM UNTIL PS-END-OF-CC-FILE-STR                  06380000
W37986                PERFORM B240-READ-SMPL-STR-FILE                   06390000
W37986             END-PERFORM                                          06400000
W37986                                                                  06410000
W37986         END-IF                                                   06420000
               SET PS-RUN-REPORT     TO TRUE                            06430000
               MOVE PM121-PART-DAY-PROMO-ID TO                          06440000
                    PV-PART-DAY-PROMO-ID                                06450000
               MOVE PM121-FULL-DAY-PROMO-ID TO                          06460000
                    PV-FULL-DAY-PROMO-ID                                06470000
               MOVE PM121-REPORT-TYPE TO                                06480000
                    PV-REPORT-TYPE                                      06490000
                    PC-RDS-REPORT-NAME                                  06500000
               DISPLAY '****************************'                   06510000
               DISPLAY 'PM121-PART-DAY-PROMO-ID = '                     06520000
                        PM121-PART-DAY-PROMO-ID                         06530000
               DISPLAY 'PM121-FULL-DAY-PROMO-ID = '                     06540000
                        PM121-FULL-DAY-PROMO-ID                         06550000
               DISPLAY 'PM121-REPORT-TYPE       = '                     06560000
                        PM121-REPORT-TYPE                               06570000
               DISPLAY '****************************'                   06580000
                                                                        06590000
               PERFORM B250-SELECT-PROMO-INFO                           06600000
               PERFORM B220-PROCESS-REPORT                              06610000
           END-IF.                                                      06620000
                                                                        06630000
      ****************************************************************  06640000
      * B220-PROCESS-REPORT.                                            06650000
      *     PROCESS THE REPORT.                                         06660000
      ****************************************************************  06670000
       B220-PROCESS-REPORT.                                             06680000
                                                                        06690000
           IF PS-PROMO-AVAIL                                            06700000
              PERFORM C100-DECLARE-PR-CONFLICT-CSR                      06710000
              PERFORM C200-OPEN-PR-CONFLICT-CSR                         06720000
              PERFORM C300-FETCH-PR-CONFLICT-CSR                        06730000
                                                                        06740000
              IF NOT PS-END-OF-PRCON-CSR                                06750000
                 PERFORM C400-PROCESS-PR-CONFLICT-CSR                   06760000
                        UNTIL PS-END-OF-PRCON-CSR                       06770000
              END-IF                                                    06780000
                                                                        06790000
              PERFORM C500-CLOSE-PR-CONFLICT-CSR                        06800000
           ELSE                                                         06810000
              PERFORM H100-WRITE-PAGE-HEADER                            06820000
              PERFORM W300-WRITE-LEGAL-LINE                             06830000
              PERFORM W400-WRITE-END-OF-RPT-LINE                        06840000
           END-IF.                                                      06850000
                                                                        06860000
W37986****************************************************************  06870000
W37986* B240-READ-SMPL-STR-FILE.                                        06880000
W37986*     READ IN SAMPLE STORE INFO FROM SMPL-STR-INFILE              06890000
W37986****************************************************************  06900000
W37986 B240-READ-SMPL-STR-FILE.                                         06910000
W37986                                                                  06920000
W37986     READ SMPL-STR-INFILE INTO CC-SMPL-STR-INFILE-REC             06930000
W37986       AT END                                                     06940000
W37986          SET PS-END-OF-CC-FILE-STR        TO TRUE                06950000
W37986     END-READ.                                                    06960000
W37986                                                                  06970000
W37986     ADD 1                                 TO PV-CNT-STRS.        06980000
W37986     IF  PS-END-OF-CC-FILE-STR                                    06990000
W37986     AND PV-CNT-STRS = 1                                          07000000
W37986         MOVE 'B240-READ-SMPL-STR-FILE'    TO PV-PARAGRAPH-NAME   07010000
W37986         MOVE 'CONTROL CARD IS EMPTY'      TO PV-OPERATION-MSG-1  07020000
W37986         SET ABEND-4003-CTRL-CARD-ERROR    TO TRUE                07030000
W37986         PERFORM Z200-ABEND                                       07040000
W37986     END-IF                                                       07050000
W37986                                                                  07060000
W37986     IF PS-END-OF-CC-FILE-STR                                     07070000
W37986        CONTINUE                                                  07080000
W37986     ELSE                                                         07090000
W37986        EVALUATE TRUE                                             07100000
W37986          WHEN PV-CNT-STRS = 1                                    07110000
W37986               MOVE CC-STR-NBR             TO PV-HOST-STR-1       07120000
W37986          WHEN PV-CNT-STRS = 2                                    07130000
W37986               MOVE CC-STR-NBR             TO PV-HOST-STR-2       07140000
W37986          WHEN PV-CNT-STRS = 3                                    07150000
W37986               MOVE CC-STR-NBR             TO PV-HOST-STR-3       07160000
W37986          WHEN PV-CNT-STRS = 4                                    07170000
W37986               MOVE CC-STR-NBR             TO PV-HOST-STR-4       07180000
W37986          WHEN PV-CNT-STRS = 5                                    07190000
W37986               MOVE CC-STR-NBR             TO PV-HOST-STR-5       07200000
W37986          WHEN PV-CNT-STRS = 6                                    07210000
W37986               MOVE CC-STR-NBR             TO PV-HOST-STR-6       07220000
W37986          WHEN PV-CNT-STRS = 7                                    07230000
W37986               MOVE CC-STR-NBR             TO PV-HOST-STR-7       07240000
W37986          WHEN PV-CNT-STRS = 8                                    07250000
W37986               MOVE CC-STR-NBR             TO PV-HOST-STR-8       07260000
W37986          WHEN PV-CNT-STRS = 9                                    07270000
W37986               MOVE CC-STR-NBR             TO PV-HOST-STR-9       07280000
W37986          WHEN PV-CNT-STRS = 10                                   07290000
W37986               MOVE CC-STR-NBR             TO PV-HOST-STR-10      07300000
W37986          WHEN PV-CNT-STRS = 11                                   07310000
W37986               MOVE CC-STR-NBR             TO PV-HOST-STR-11      07320000
W37986          WHEN PV-CNT-STRS = 12                                   07330000
W37986               MOVE CC-STR-NBR             TO PV-HOST-STR-12      07340000
W37986          WHEN PV-CNT-STRS = 13                                   07350000
W37986               MOVE CC-STR-NBR             TO PV-HOST-STR-13      07360000
W37986          WHEN PV-CNT-STRS = 14                                   07370000
W37986               MOVE CC-STR-NBR             TO PV-HOST-STR-14      07380000
W37986          WHEN PV-CNT-STRS = 15                                   07390000
W37986               MOVE CC-STR-NBR             TO PV-HOST-STR-15      07400000
W37986        END-EVALUATE                                              07410000
W37986     END-IF.                                                      07420000
      ****************************************************************  07430000
      * B250-SELECT-PROMO-INFO.                                         07440000
      *     CHECK TO SEE THAT A NON-MAIN PROMOTION EXISTS ON THE        07450000
      *     PMT_SKU_LVL_PRICG_BY_LOC TABLE WITH A RUNDATE = TO          07460000
      *     THE CONTROL DATE PASSED INTO THE PROGRAM - THAT WAY         07470000
      *     WE KNOW WE HAVE AT LEAST ONE PROMOTION TO REPORT ON         07480000
      ****************************************************************  07490000
       B250-SELECT-PROMO-INFO.                                          07500000
                                                                        07510000
           EXEC SQL                                                     07520000
               SELECT  B.AD_EVNT_NM                                     07530000
                      ,B.AD_EVNT_NBR_TXT                                07540000
                      ,B.PROMO_NM                                       07550000
                      ,B.PROMO_DFLT_STRT_TMST                           07560000
                 INTO  :PV-AD-EVNT-NM                                   07570000
                      ,:PV-AD-EVNT-NBR-TXT                              07580000
                      ,:PV-PART-DAY-PROMO-NM                            07590000
                      ,:PV-PART-DAY-PROMO-STRT-TMST                     07600000
                 FROM  PMT_SKU_LVL_PRICG_BY_LOC A,                      07610000
                       PMV_PROMO_DIM B                                  07620000
                WHERE  A.PROMO_ID            = B.PROMO_ID               07630000
                  AND  A.AD_EVNT_ID          = B.AD_EVNT_ID             07640000
                  AND  B.PROMO_STAT_CDE      = 'S'                      07650000
                  AND  B.PROMO_ID            = :PV-PART-DAY-PROMO-ID    07660000
W37986            AND  A.LOC_NBR                                        07670000
W37986              NOT IN ( SELECT LOC_NBR                             07680000
W37986                         FROM XKT_LOC                             07690000
W37986                        WHERE E_BUS_IND = 'Y'                     07700000
W37986                          AND LOC_NBR IN ( :PV-HOST-STR-1         07710000
W37986                                          ,:PV-HOST-STR-2         07720000
W37986                                          ,:PV-HOST-STR-3         07730000
W37986                                          ,:PV-HOST-STR-4         07740000
W37986                                          ,:PV-HOST-STR-5         07750000
W37986                                          ,:PV-HOST-STR-6         07760000
W37986                                          ,:PV-HOST-STR-7         07770000
W37986                                          ,:PV-HOST-STR-8         07780000
W37986                                          ,:PV-HOST-STR-9         07790000
W37986                                          ,:PV-HOST-STR-10        07800000
W37986                                          ,:PV-HOST-STR-11        07810000
W37986                                          ,:PV-HOST-STR-12        07820000
W37986                                          ,:PV-HOST-STR-13        07830000
W37986                                          ,:PV-HOST-STR-14        07840000
W37986                                          ,:PV-HOST-STR-15        07850000
W37986                                          )                       07860000
W37986                      )                                           07870000
           END-EXEC.                                                    07880000
                                                                        07890000
           EVALUATE TRUE                                                07900000
             WHEN SQLCODE = ZEROES                                      07910000
             WHEN SQLCODE = 2112                                        07920000
             WHEN SQLCODE = -2112                                       07930000
                  SET PS-PROMO-AVAIL TO TRUE                            07940000
                  PERFORM B260-SELECT-FULL-DAY-PROMO                    07950000
             WHEN SQLCODE = 1403                                        07960000
                  SET PS-NO-PROMO TO TRUE                               07970000
                  DISPLAY 'NO PART-DAY PROMO WITH PROMO-ID:'            07980000
                  DISPLAY 'PV-PART-DAY-PROMO-ID = ' PV-PART-DAY-PROMO-ID07990000
                  DISPLAY '*** NOTHING TO REPORT ***'                   08000000
             WHEN OTHER                                                 08010000
                  SET ABEND-4013-SQL-ERROR TO TRUE                      08020000
                  MOVE 'PMT_SKU_LVL_PRICG_BY_LOC' TO PV-TABLE-NAME      08030000
                  MOVE 'B250-SELECT-PROMO-INFO'                         08040000
                                             TO PV-PARAGRAPH-NAME       08050000
                  MOVE 'ERROR ON SELECT PROMO INFO'                     08060000
                                             TO PV-OPERATION-MSG-1      08070000
                  PERFORM Z100-ABEND                                    08080000
           END-EVALUATE.                                                08090000
                                                                        08100000
      ****************************************************************  08110000
      * B260-SELECT-FULL-DAY-PROMO.                                     08120000
      *     SELECT FULL-DAY PROMO NAME FOR DISPLAY ON REPORTS           08130000
      *     IN CASE THERE ARE NO EXCEPTIONS TO REPORT.                  08140000
      ****************************************************************  08150000
       B260-SELECT-FULL-DAY-PROMO.                                      08160000
                                                                        08170000
           EXEC SQL                                                     08180000
               SELECT  A.PROMO_NM                                       08190000
                 INTO  :PV-FULL-DAY-PROMO-NM                            08200000
                 FROM  PMV_PROMO_DIM A                                  08210000
                WHERE  A.PROMO_ID        = :PV-FULL-DAY-PROMO-ID        08220000
                  AND  A.PROMO_STAT_CDE  = 'S'                          08230000
                                                                        08240000
           END-EXEC.                                                    08250000
                                                                        08260000
           EVALUATE TRUE                                                08270000
             WHEN SQLCODE = ZEROES                                      08280000
             WHEN SQLCODE = 2112                                        08290000
             WHEN SQLCODE = -2112                                       08300000
                  CONTINUE                                              08310000
             WHEN OTHER                                                 08320000
                  SET ABEND-4013-SQL-ERROR TO TRUE                      08330000
                  MOVE 'PMV_PROMO_DIM' TO PV-TABLE-NAME                 08340000
                  MOVE 'B260-SELECT-FULL-DAY-PROMO'                     08350000
                                             TO PV-PARAGRAPH-NAME       08360000
                  MOVE 'ERROR ON SELECT PROMO INFO'                     08370000
                                             TO PV-OPERATION-MSG-1      08380000
                  PERFORM Z100-ABEND                                    08390000
           END-EVALUATE.                                                08400000
                                                                        08410000
      ***************************************************************** 08420000
      *    CLOSE FILES                                                  08430000
      ***************************************************************** 08440000
       B900-CLOSE-FILES.                                                08450000
                                                                        08460000
           CLOSE  CC-PROMO-FILE                                         08470000
W37986            SMPL-STR-INFILE                                       08490000
                  PR-CONFLICT-RPT.                                      08500000
                                                                        08510000
      ***********************************************************       08520000
      * C100-DECLARE-PR-CONFLICT-CSR.                                   08530000
      ***********************************************************       08540000
       C100-DECLARE-PR-CONFLICT-CSR.                                    08550000
                                                                        08560000
           EXEC SQL                                                     08570000
                DECLARE CONFLICTCSR CURSOR FOR                          08580000
                SELECT /*+ FIRST_ROWS */                                08590000
                      C.AD_EVNT_NBR_TXT,                                08600000
                      C.AD_EVNT_NM,                                     08610000
                      A.PROMO_ID,                                       08620000
                      C.PROMO_NM,                                       08630000
                      A2.PROMO_ID,                                      08640000
                      C2.PROMO_NM,                                      08650000
                      A2.MDSE_SELN_LNE_ID,                              08660000
                      A.PROMO_STRT_TMST,                                08670000
                      A2.PROMO_STRT_TMST,                               08680000
                      A.PROMO_END_TMST,                                 08690000
                      A2.PROMO_END_TMST,                                08700000
                      A.PROMO_ITM_ID,                                   08710000
                      A2.PROMO_ITM_ID,                                  08720000
                      A.DEPT_NBR,                                       08730000
                      A.SUB_CL_NBR,                                     08740000
                      A.SKU_NBR,                                        08750000
                      A.VS_NBR,                                         08760000
                      A.UNT_RTL_AMT,                                    08770000
                      A2.UNT_RTL_AMT,                                   08780000
                      A.PROMO_PRIC_PT_AMT,                              08790000
                      A2.PROMO_PRIC_PT_AMT,                             08800000
                      A.PROMO_GP_QTY,                                   08810000
                      A2.PROMO_GP_QTY,                                  08820000
                      A.PROMO_GP_AMT,                                   08830000
                      A2.PROMO_GP_AMT,                                  08840000
                      A.PROMO_PRICG_TYP_CDE,                            08850000
                      A2.PROMO_PRICG_TYP_CDE,                           08860000
                      A.LOC_NBR,                                        08870000
                      B.PROMO_ITM_DESC,                                 08880000
                      B2.PROMO_ITM_DESC,                                08890000
                      B.ADV_IND,                                        08900000
                      B2.ADV_IND,                                       08910000
                      D.DEPT_NM,                                        08920000
                      D.GMA_NBR,                                        08930000
                      D.DMA_NBR,                                        08940000
                      D.BYR_NBR,                                        08950000
                      D.GMM_FRST_NM,                                    08960000
                      D.GMM_LAST_NM,                                    08970000
                      D.DMM_FRST_NM,                                    08980000
                      D.DMM_LAST_NM,                                    08990000
                      D.BYR_FRST_NM,                                    09000000
                      D.BYR_LAST_NM,                                    09010000
                      B.PRCH_TYP_CDE,                                   09020000
                      B2.PRCH_TYP_CDE                                   09030000
                 FROM PMT_SKU_LVL_PRICG_BY_LOC A,                       09040000
                      PMT_SKU_LVL_PRICG_BY_LOC A2,                      09050000
                      PMT_PROMO_ITM B,                                  09060000
                      PMT_PROMO_ITM B2,                                 09070000
                      PMV_PROMO_DIM C,                                  09080000
                      PMV_PROMO_DIM C2,                                 09090000
                      PMV_PRSN_MDSE_HIER D                              09100000
                WHERE C.PROMO_ID          = :PV-FULL-DAY-PROMO-ID       09110000
                  AND C.PROMO_STAT_CDE    = 'S'                         09120000
                  AND A2.PROMO_ID         = :PV-PART-DAY-PROMO-ID       09130000
                  AND A.AD_EVNT_ID        = A2.AD_EVNT_ID               09140000
                  AND A.SKU_NBR           = A2.SKU_NBR                  09150000
                  AND A.LOC_NBR           = A2.LOC_NBR                  09160000
W37986            AND A.LOC_NBR                                         09170000
W37986              NOT IN ( SELECT LOC_NBR                             09180000
W37986                         FROM XKT_LOC                             09190000
W37986                        WHERE E_BUS_IND = 'Y'                     09200000
W37986                          AND LOC_NBR IN ( :PV-HOST-STR-1         09210000
W37986                                          ,:PV-HOST-STR-2         09220000
W37986                                          ,:PV-HOST-STR-3         09230000
W37986                                          ,:PV-HOST-STR-4         09240000
W37986                                          ,:PV-HOST-STR-5         09250000
W37986                                          ,:PV-HOST-STR-6         09260000
W37986                                          ,:PV-HOST-STR-7         09270000
W37986                                          ,:PV-HOST-STR-8         09280000
W37986                                          ,:PV-HOST-STR-9         09290000
W37986                                          ,:PV-HOST-STR-10        09300000
W37986                                          ,:PV-HOST-STR-11        09310000
W37986                                          ,:PV-HOST-STR-12        09320000
W37986                                          ,:PV-HOST-STR-13        09330000
W37986                                          ,:PV-HOST-STR-14        09340000
W37986                                          ,:PV-HOST-STR-15        09350000
W37986                                          )                       09360000
W37986                      )                                           09370000
                  AND A.DEPT_NBR          = A2.DEPT_NBR                 09380000
                  AND A.PROMO_ID          <> A2.PROMO_ID                09390000
                  AND A.PROMO_ID          = C.PROMO_ID                  09400000
                  AND A2.PROMO_ID         = C2.PROMO_ID                 09410000
                  AND A.AD_EVNT_ID        = C.AD_EVNT_ID                09420000
                  AND A.PROMO_ITM_ID      = B.PROMO_ITM_ID              09430000
                  AND A2.PROMO_ITM_ID     = B2.PROMO_ITM_ID             09440000
                  AND A.PROMO_PRIC_PT_AMT > 0.01                        09450000
                  AND A2.PROMO_PRIC_PT_AMT  > 0.01                      09460000
                  AND A2.PROMO_PRIC_PT_AMT  >= A.PROMO_PRIC_PT_AMT      09470000
                  AND A.DEPT_NBR            = D.DEPT_NBR                09480000
                  AND A2.DEPT_NBR           = D.DEPT_NBR                09490000
                  AND A2.FRST_RCVD_DTE IS NOT NULL                      09500000
                  AND ((A2.OH_UNT_QTY       > 0)                        09510000
                   OR (A2.OH_UNT_QTY       <= 0                         09520000
                  AND A2.ONORD_UNT_QTY_IND = 'Y'                        09530000
                  AND A2.DONT_SHIP_BEF_DTE < A2.PROMO_END_TMST))        09540000
                  AND A.PROMO_PRICG_TYP_CDE                             09550000
                      NOT IN ('GBL', 'GBD', 'GBP', 'GAO')               09560000
                  AND A2.PROMO_PRICG_TYP_CDE                            09570000
                      NOT IN ('GBL', 'GBD', 'GBP', 'GAO')               09580000
                  AND C2.REG_PROMO_TYP_CDE  = 'A'                       09590000
                ORDER BY C.AD_EVNT_NBR_TXT,                             09600000
                         A2.PROMO_ID,                                   09610000
                         D.GMA_NBR,                                     09620000
                         D.DMA_NBR,                                     09630000
                         D.BYR_NBR,                                     09640000
                         A.DEPT_NBR,                                    09650000
                         A.SKU_NBR,                                     09660000
                         A2.MDSE_SELN_LNE_ID                            09670000
           END-EXEC.                                                    09680000
                                                                        09690000
      ***********************************************************       09700000
      * C200-OPEN-PR-CONFLICT-CSR.                                      09710000
      ***********************************************************       09720000
       C200-OPEN-PR-CONFLICT-CSR.                                       09730000
           ACCEPT PV-CPU-TIME FROM TIME.                                09740000
           DISPLAY ' '.                                                 09750000
           DISPLAY 'START PR CONF CSR OPEN: ' PV-CPU-TIME.              09760000
           SET PS-NOT-END-OF-PRCON-CSR TO TRUE.                         09770000
                                                                        09780000
           EXEC SQL                                                     09790000
               OPEN CONFLICTCSR                                         09800000
           END-EXEC.                                                    09810000
                                                                        09820000
           EVALUATE TRUE                                                09830000
               WHEN SQLCODE = ZERO                                      09840000
               WHEN SQLCODE = 1403                                      09850000
                   CONTINUE                                             09860000
               WHEN SQLCODE = 8103                                      09870000
                   DISPLAY '*** NO PR-EXCPTN TO REPORT ***'             09880000
                   PERFORM W300-WRITE-LEGAL-LINE                        09890000
                   PERFORM W400-WRITE-END-OF-RPT-LINE                   09900000
                   SET PS-END-OF-PRCON-CSR TO TRUE                      09910000
               WHEN OTHER                                               09920000
                   MOVE 'C200-OPEN-PR-CONFLICT-CSR'                     09930000
                                                 TO PV-PARAGRAPH-NAME   09940000
                   DISPLAY PV-PARAGRAPH-NAME                            09950000
                   PERFORM Z100-ABEND                                   09960000
           END-EVALUATE.                                                09970000
                                                                        09980000
      ***********************************************************       09990000
      * C300-FETCH-PR-CONFLICT-CSR.                                     10000000
      ***********************************************************       10010000
       C300-FETCH-PR-CONFLICT-CSR.                                      10020000
                                                                        10030000
           EXEC SQL                                                     10040000
               FETCH CONFLICTCSR                                        10050000
                 INTO :PV-AD-EVNT-NBR-TXT                               10060000
                     ,:PV-AD-EVNT-NM                                    10070000
                     ,:PV-FULL-DAY-PROMO-ID                             10080000
                     ,:PV-FULL-DAY-PROMO-NM                             10090000
                     ,:PV-PART-DAY-PROMO-ID                             10100000
                     ,:PV-PART-DAY-PROMO-NM                             10110000
                     ,:PV-MDSE-SELN-LNE-ID                              10120000
                     ,:PV-FULL-DAY-PROMO-STRT-TMST                      10130000
                     ,:PV-PART-DAY-PROMO-STRT-TMST                      10140000
                     ,:PV-FULL-DAY-PROMO-END-TMST                       10150000
                     ,:PV-PART-DAY-PROMO-END-TMST                       10160000
                     ,:PV-FULL-DAY-PROMO-ITM-ID                         10170000
                     ,:PV-PART-DAY-PROMO-ITM-ID                         10180000
                     ,:PV-DEPT-NBR                                      10190000
                     ,:PV-SUB-CL-NBR                                    10200000
                     ,:PV-SKU-NBR                                       10210000
                     ,:PV-STYLE-NBR                                     10220000
                     ,:PV-FULL-DAY-RETAIL-AMT                           10230000
                     ,:PV-PART-DAY-RETAIL-AMT                           10240000
                     ,:PV-FULL-DAY-PRIC-PT-AMT                          10250000
                     ,:PV-PART-DAY-PRIC-PT-AMT                          10260000
                     ,:PV-FULL-DAY-PROMO-GP-QTY                         10270000
                     ,:PV-PART-DAY-PROMO-GP-QTY                         10280000
                     ,:PV-FULL-DAY-PROMO-GP-AMT                         10290000
                     ,:PV-PART-DAY-PROMO-GP-AMT                         10300000
                     ,:PV-FULL-DAY-PRICG-TYP-CDE                        10310000
                     ,:PV-PART-DAY-PRICG-TYP-CDE                        10320000
                     ,:PV-LOC-NBR                                       10330000
                     ,:PV-FULL-DAY-PROMO-ITM-DESC                       10340000
                     ,:PV-PART-DAY-PROMO-ITM-DESC                       10350000
                     ,:PV-FULL-DAY-ADV-IND                              10360000
                     ,:PV-PART-DAY-ADV-IND                              10370000
                     ,:PV-DEPT-NM                                       10380000
                     ,:PV-GMA-NBR                                       10390000
                     ,:PV-DMA-NBR                                       10400000
                     ,:PV-BYR-NBR                                       10410000
                     ,:PV-GMM-FRST-NM                                   10420000
                     ,:PV-GMM-LAST-NM                                   10430000
                     ,:PV-DMM-FRST-NM                                   10440000
                     ,:PV-DMM-LAST-NM                                   10450000
                     ,:PV-BYR-FRST-NM                                   10460000
                     ,:PV-BYR-LAST-NM                                   10470000
                     ,:PV-FULL-DAY-PRCH-TYP-CDE                         10480000
                     ,:PV-PART-DAY-PRCH-TYP-CDE                         10490000
           END-EXEC.                                                    10500000
                                                                        10510000
           EVALUATE TRUE                                                10520000
               WHEN SQLCODE = ZERO                                      10530000
               WHEN SQLCODE = -1405                                     10540000
                  CONTINUE                                              10550000
                                                                        10560000
               WHEN SQLCODE = 1403                                      10570000
                                                                        10580000
                   IF PV-SKU-CNT > 0                                    10590000
                     PERFORM W300-WRITE-LEGAL-LINE                      10600000
                     PERFORM W400-WRITE-END-OF-RPT-LINE                 10610000
                     DISPLAY '*** END OF PRICING CONFLICTS TO RPT ***'  10620000
                   ELSE                                                 10630000
                     PERFORM H100-WRITE-PAGE-HEADER                     10640000
                     PERFORM W300-WRITE-LEGAL-LINE                      10650000
                     PERFORM W401-WRITE-NOTHING-TO-RPT-LINE             10660000
                     DISPLAY '***  NOTHING TO REPORT  ***'              10670000
                     DISPLAY '***  PROMO ID EXISTS ON  TABLE ***'       10680000
                     DISPLAY '***  BUT NO PRICING CONFLICTS  ***'       10690000
                   END-IF                                               10700000
                                                                        10710000
                   SET PS-END-OF-PRCON-CSR TO TRUE                      10720000
                                                                        10730000
               WHEN OTHER                                               10740000
                   MOVE 'C300-FETCH-PR-CONFLICT-CSR'                    10750000
                                           TO PV-PARAGRAPH-NAME         10760000
                   DISPLAY PV-PARAGRAPH-NAME                            10770000
                   PERFORM Z100-ABEND                                   10780000
           END-EVALUATE.                                                10790000
                                                                        10800000
      ***********************************************************       10810000
      * C400-PROCESS-PR-CONFLICT-CSR.                                   10820000
      ***********************************************************       10830000
       C400-PROCESS-PR-CONFLICT-CSR.                                    10840000
                                                                        10850000
           IF (PV-FULL-DAY-PRIC-PT-AMT = PV-PART-DAY-PRIC-PT-AMT        10860000
              AND PV-PART-DAY-PRCH-TYP-CDE = 'T')                       10870000
              PERFORM D150-CHECK-TIER                                   10880000
           END-IF.                                                      10890000
                                                                        10900000
           IF PS-NOT-SKIP-RECORD                                        10910000
              PERFORM D100-PROCESS-BREAKS                               10920000
           END-IF.                                                      10930000
                                                                        10940000
           IF PS-NOT-SKIP-RECORD                                        10950000
              PERFORM D200-PROCESS-DETAIL                               10960000
           END-IF.                                                      10970000
                                                                        10980000
           SET PS-NOT-SKIP-RECORD TO TRUE.                              10990000
           PERFORM C300-FETCH-PR-CONFLICT-CSR.                          11000000
                                                                        11010000
      ***********************************************************       11020000
      * C500-CLOSE-PR-CONFLICT-CSR.                                     11030000
      ***********************************************************       11040000
       C500-CLOSE-PR-CONFLICT-CSR.                                      11050000
                                                                        11060000
           EXEC SQL                                                     11070000
               CLOSE CONFLICTCSR                                        11080000
           END-EXEC.                                                    11090000
                                                                        11100000
           EVALUATE TRUE                                                11110000
               WHEN SQLCODE = ZERO                                      11120000
               WHEN SQLCODE = 1403                                      11130000
                   CONTINUE                                             11140000
               WHEN OTHER                                               11150000
                   MOVE 'C500-CLOSE-PR-CONFLICT-CSR'                    11160000
                                                TO PV-PARAGRAPH-NAME    11170000
                   DISPLAY PV-PARAGRAPH-NAME                            11180000
                   PERFORM Z100-ABEND                                   11190000
           END-EVALUATE.                                                11200000
                                                                        11210000
      ***************************************************************** 11220000
      * PROCESS BREAKS                                                  11230000
      * CHECK TO SEE IF PROCESSING NEW ADEVENT, NEW PROMOTION, NEW      11240000
      * GMM, NEW DMM, NEW BUYER OR NEW DEPT - WRITE OUT NEW PAGE        11250000
      * HEADER IF ANY OF THESE ARE THE CASE.                            11260000
      *                                                                 11270000
      * IF NOT ON ANY OF THOSE NEW ITEMS - NEED TO SEE IF WE ARE        11280000
      * PROCESSING A RECORD FOR THE SAME SKU WITH THE SAME              11290000
      * NON MAIN MDSE SELN LINE ID AND SAME NON MAIN PRICE POINT -      11300000
      * IF THIS IS THE CASE WE WANT TO SKIP OVER THIS RECORD TO         11310000
      * ELIMINATE DUPLICATING THE INFORMATION FOR ALL LOCATIONS         11320000
      * THAT ARE SETUP FOR THIS SKU/MDSE SELN LINE ID /PRICE.           11330000
      ***************************************************************** 11340000
       D100-PROCESS-BREAKS.                                             11350000
                                                                        11360000
           IF (PV-AD-EVNT-NBR-TXT NOT = PV-AD-EVNT-NBR-TXT-SV) OR       11370000
              (PV-PART-DAY-PROMO-ID NOT = PV-PART-DAY-PROMO-ID-SAVED) OR11380000
              (PV-GMA-NBR     NOT = PV-GMA-NBR-SAVED) OR                11390000
              (PV-DMA-NBR     NOT = PV-DMA-NBR-SAVED) OR                11400000
              (PV-BYR-NBR     NOT = PV-BYR-NBR-SAVED) OR                11410000
              (PV-DEPT-NBR    NOT = PV-DEPT-NBR-SAVED)                  11420000
                                                                        11430000
               IF PV-GMA-NBR-SAVED NOT = ZEROES                         11440000
                   PERFORM H010-WRITE-BLANK-PAGE-IF-NEED                11450000
               END-IF                                                   11460000
                                                                        11470000
              PERFORM H100-WRITE-PAGE-HEADER                            11480000
                                                                        11490000
           ELSE                                                         11500000
               IF (PV-SKU-NBR = PV-SKU-NBR-SAVED) AND                   11510000
                  (PV-SKU-NBR-SAVED NOT = 0) AND                        11520000
                  (PV-MDSE-SELN-LNE-ID = PV-MDSE-SELN-LNE-ID-S) AND     11530000
                  (PV-PART-DAY-PRIC-PT-AMT = PV-PART-DAY-PRIC-PT-AMT-S) 11540000
                  SET PS-SKIP-RECORD TO TRUE                            11550000
      *        ELSE                                                     11560000
      *           IF (PV-PART-DAY-PROMO-ITM-ID = 36471     OR           11570000
      *               PV-PART-DAY-PROMO-ITM-ID = 17793)                 11580000
      *           SET PS-SKIP-RECORD TO TRUE                            11590000
      *        END-IF                                                   11600000
                                                                        11610000
           END-IF.                                                      11620000
                                                                        11630000
                                                                        11640000
           MOVE PV-AD-EVNT-NBR-TXT      TO PV-AD-EVNT-NBR-TXT-SV.       11650000
           MOVE PV-PART-DAY-PROMO-ID    TO PV-PART-DAY-PROMO-ID-SAVED.  11660000
           MOVE PV-GMA-NBR              TO PV-GMA-NBR-SAVED.            11670000
           MOVE PV-DMA-NBR              TO PV-DMA-NBR-SAVED.            11680000
           MOVE PV-BYR-NBR              TO PV-BYR-NBR-SAVED.            11690000
           MOVE PV-DEPT-NBR             TO PV-DEPT-NBR-SAVED.           11700000
           MOVE PV-SKU-NBR              TO PV-SKU-NBR-SAVED.            11710000
           MOVE PV-MDSE-SELN-LNE-ID     TO PV-MDSE-SELN-LNE-ID-S.       11720000
           MOVE PV-PART-DAY-PRIC-PT-AMT TO    PV-PART-DAY-PRIC-PT-AMT-S.11730000
                                                                        11740000
           ADD +1 TO PV-SKU-CNT.                                        11750000
                                                                        11760000
      ***************************************************************** 11770000
      * D150 PARAGRAPH CALLED WHERE FULL DAY PRICE AND PART DAY PRICE   11780000
      * ARE EQUAL AND THE PART DAY HAS TIER PRICING.  NEED TO CHECK     11790000
      * IF THE QTY 1 - IF IT IS - SKIP OVER RECORD - DON'T NEED ON RPT  11800000
      ***************************************************************** 11810000
       D150-CHECK-TIER.                                                 11820000
                                                                        11830000
           EXEC SQL                                                     11840000
               SELECT  C.THRS_QTY                                       11850000
                 INTO  :PV-THRS-QTY                                     11860000
                 FROM  PMT_TIER_PRICG A,                                11870000
                       PMT_TIER_PRICG_GP B,                             11880000
                       PMT_TIER_PRICG_GP_TIER C                         11890000
                WHERE  A.PROMO_ITM_ID      = :PV-PART-DAY-PROMO-ITM-ID  11900000
                  AND  A.TIER_PRICG_ID     = B.TIER_PRICG_ID            11910000
                  AND  B.TIER_PRICG_GP_ID  = C.TIER_PRICG_GP_ID         11920000
                  AND  C.THRS_QTY          = 1                          11930000
                  AND  A.STAT_CDE          = 'S'                        11940000
                  AND  B.STAT_CDE          = 'S'                        11950000
                  AND  C.STAT_CDE          = 'S'                        11960000
           END-EXEC.                                                    11970000
                                                                        11980000
           EVALUATE TRUE                                                11990000
             WHEN SQLCODE = ZEROES                                      12000000
             WHEN SQLCODE = 2112                                        12010000
             WHEN SQLCODE = -2112                                       12020000
                  SET PS-SKIP-RECORD TO TRUE                            12030000
             WHEN SQLCODE = 1403                                        12040000
                  DISPLAY 'QTY NOT EQUAL 1'                             12050000
             WHEN OTHER                                                 12060000
                  SET ABEND-4013-SQL-ERROR TO TRUE                      12070000
                  MOVE 'PMT_TIER_PRICG'      TO PV-TABLE-NAME           12080000
                  MOVE 'D300-GET-QTY'        TO PV-PARAGRAPH-NAME       12090000
                  MOVE 'ERROR ON SELECT THRS QTY'                       12100000
                                             TO PV-OPERATION-MSG-1      12110000
                  PERFORM Z100-ABEND                                    12120000
           END-EVALUATE.                                                12130000
      ***************************************************************** 12140000
      * PROCESS DETAIL                                                  12150000
      ***************************************************************** 12160000
       D200-PROCESS-DETAIL.                                             12170000
                                                                        12180000
           IF PV-PART-DAY-PRIC-PT-AMT > PV-FULL-DAY-PRIC-PT-AMT         12190000
               MOVE 'HIGHER'           TO DTL-02-WINNER-REASON          12200000
           ELSE                                                         12210000
               IF PV-PART-DAY-PRIC-PT-AMT = PV-FULL-DAY-PRIC-PT-AMT     12220000
                   MOVE 'EQUAL '       TO DTL-02-WINNER-REASON          12230000
               ELSE                                                     12240000
                   MOVE 'LOWER '       TO DTL-02-WINNER-REASON          12250000
               END-IF                                                   12260000
           END-IF.                                                      12270000
                                                                        12280000
           MOVE '**' TO DTL-02-WINNER-IND.                              12290000
           PERFORM D400-POPULATE-DETAIL1.                               12300000
           PERFORM D500-POPULATE-DETAIL2.                               12310000
           PERFORM D350-GET-SIGN-AND-DESC.                              12320000
                                                                        12330000
      *IF NOT THE SAME SKU, WRITE A BLANK DIVIDER LINE FIRST            12340000
           IF (PV-SKU-NBR NOT = PV-SKU-NBR-SAVED)                       12350000
               MOVE 'N'                  TO PS-SAME-SKU-SW              12360000
           ELSE                                                         12370000
               MOVE 'Y'                  TO PS-SAME-SKU-SW              12380000
           END-IF.                                                      12390000
                                                                        12400000
                                                                        12410000
           IF PS-NOT-SAME-SKU THEN                                      12420000
               PERFORM W700-WRITE-BLANK-LINE                            12430000
           END-IF.                                                      12440000
                                                                        12450000
           IF PM117-MAIN-INDEX GREATER ZERO                             12460000
             MOVE PC-ONE TO PV-FULL-DAY-INDEX                           12470000
             PERFORM D355-FILL-IN-MAIN-SIGN-NBR                         12480000
                  UNTIL PV-FULL-DAY-INDEX > PM117-MAIN-INDEX            12490000
           ELSE                                                         12500000
             MOVE DETAIL-01            TO DETAIL-PRINT-01               12510000
             PERFORM W200-WRITE-RPT-DETAIL-LINE1                        12520000
           END-IF.                                                      12530000
                                                                        12540000
           IF PM117-NON-MAIN-INDEX GREATER ZERO                         12550000
             MOVE PC-ONE TO PV-PART-DAY-INDEX                           12560000
             PERFORM D356-FILL-IN-NON-MAIN-SIGN-NBR                     12570000
                  UNTIL PV-PART-DAY-INDEX > PM117-NON-MAIN-INDEX        12580000
           ELSE                                                         12590000
             MOVE DETAIL-02                TO DETAIL-PRINT-02           12600000
             PERFORM W250-WRITE-RPT-DETAIL-LINE2                        12610000
           END-IF.                                                      12620000
                                                                        12630000
      ***************************************************************** 12640000
      * GET SKU DESC AND SIGN NUMBERS USING PMKUT117 DB2 SUBROUTINE     12650000
      ***************************************************************** 12660000
       D350-GET-SIGN-AND-DESC.                                          12670000
                                                                        12680000
           INITIALIZE PM117-PARAMETERS.                                 12690000
           MOVE PV-SKU-NBR            TO PM117-SKU-NBR.                 12700000
           MOVE  SPACES               TO PM117-SKU-DESC.                12710000
           MOVE  ZEROES               TO PM117-UPC-ID.                  12720000
                                                                        12730000
           SET PM117-GET-DESC TO TRUE.                                  12740000
           CALL PC-PMKUT117-PGM USING PM117-PARAMETERS.                 12750000
                                                                        12760000
           IF PM117-UNSUCCESSFUL-CALL                                   12770000
              DISPLAY 'SKU NBR = ' PM117-SKU-NBR                        12780000
              DISPLAY 'UPC ID  = ' PM117-UPC-ID                         12790000
              MOVE PM117-ERROR-MESSAGE      TO PV-OPERATION-MSG-1       12800000
              MOVE PM117-SQLCODE            TO SQLCODE                  12810000
              MOVE 'TSIESGN XST_SKU'        TO PV-TABLE-NAME            12820000
              MOVE 'D350-GET-SIGN-AND-DESC' TO PV-PARAGRAPH-NAME        12830000
              PERFORM Z100-ABEND                                        12840000
           ELSE                                                         12850000
              MOVE PM117-SKU-DESC           TO DTL-01-SKU-DESC          12860000
           END-IF.                                                      12870000
                                                                        12880000
           IF PM117-UPC-ID NOT EQUAL 0                                  12890000
            SET PM117-GET-SIGNS TO TRUE                                 12900000
            MOVE PV-FULL-DAY-PROMO-ID TO PM117-MAIN-PROMO-ID            12910000
            MOVE PV-PART-DAY-PROMO-ID TO PM117-NON-MAIN-PROMO-ID        12920000
            INITIALIZE PM117-MAIN-SIGN-TABLE-PARMS                      12930000
            INITIALIZE PM117-NMAIN-SIGN-TABLE-PARMS                     12940000
            CALL PC-PMKUT117-PGM USING PM117-PARAMETERS                 12950000
                                                                        12960000
            IF PM117-UNSUCCESSFUL-CALL                                  12970000
               DISPLAY 'MAIN PROMO ID = ' PM117-MAIN-PROMO-ID           12980000
               DISPLAY 'NONMAIN PROMO ID = ' PM117-NON-MAIN-PROMO-ID    12990000
               MOVE PM117-ERROR-MESSAGE      TO PV-OPERATION-MSG-1      13000000
               MOVE PM117-SQLCODE            TO SQLCODE                 13010000
               MOVE 'TSIESGN XST_SKU'        TO PV-TABLE-NAME           13020000
               MOVE 'D350-GET-SIGN-AND-DESC' TO PV-PARAGRAPH-NAME       13030000
               PERFORM Z100-ABEND                                       13040000
            END-IF                                                      13050000
           END-IF.                                                      13060000
      ***************************************************************** 13070000
      * FILLS IN SIGN NUMBER FROM ARRAY PASSED BACK FROM SUBROUTINE     13080000
      * SIKELLY FOR DETAIL-1                                            13090000
      ***************************************************************** 13100000
       D355-FILL-IN-MAIN-SIGN-NBR.                                      13110000
                                                                        13120000
           MOVE PM117-MAIN-SIGN-NBR(PV-FULL-DAY-INDEX)                  13130000
                                     TO DTL-01-SIGN-NBR.                13140000
           MOVE DETAIL-01            TO DETAIL-PRINT-01.                13150000
           PERFORM W200-WRITE-RPT-DETAIL-LINE1.                         13160000
           ADD PC-ONE TO PV-FULL-DAY-INDEX.                             13170000
                                                                        13180000
      ***************************************************************** 13190000
      * FILLS IN SIGN NUMBER FROM ARRAY PASSED BACK FROM SUBROUTINE     13200000
      * SIKELLY FOR DETAIL-2 - NON MAIN                                 13210000
      ***************************************************************** 13220000
       D356-FILL-IN-NON-MAIN-SIGN-NBR.                                  13230000
           MOVE PM117-NON-MAIN-SIGN-NBR(PV-PART-DAY-INDEX)              13240000
                                         TO DTL-02-SIGN-NBR.            13250000
           MOVE DETAIL-02                TO DETAIL-PRINT-02.            13260000
           PERFORM W250-WRITE-RPT-DETAIL-LINE2.                         13270000
           ADD PC-ONE TO PV-PART-DAY-INDEX.                             13280000
                                                                        13290000
      ***************************************************************** 13300000
      * POPULATES THE FIRST DETAIL LINE (MAIN PROMO)                    13310000
      ***************************************************************** 13320000
       D400-POPULATE-DETAIL1.                                           13330000
                                                                        13340000
           MOVE PV-DEPT-NBR              TO DTL-01-DEPT-NBR.            13350000
           MOVE PV-SUB-CL-NBR            TO DTL-01-SUB-CL-NBR.          13360000
           MOVE PV-SKU-NBR               TO DTL-01-SKU-NBR.             13370000
           MOVE PV-STYLE-NBR             TO DTL-01-STYLE-NBR.           13380000
                                                                        13390000
           MOVE PV-FULL-DAY-PROMO-NM     TO DTL-01-PROMO-NAME-1.        13400000
           MOVE PV-FD-STRT-DTE-MM        TO DTL-01-PM-BEG-DTE-MM.       13410000
           MOVE '/'                      TO DTL-01-PM-BEG-DTE-D1.       13420000
           MOVE PV-FD-STRT-DTE-DD        TO DTL-01-PM-BEG-DTE-DD.       13430000
           MOVE '/'                      TO DTL-01-PM-BEG-DTE-D2.       13440000
           MOVE PV-FD-STRT-DTE-YY        TO DTL-01-PM-BEG-DTE-YY.       13450000
           MOVE PV-FD-END-DTE-MM         TO DTL-01-PM-END-DTE-MM.       13460000
           MOVE '/'                      TO DTL-01-PM-END-DTE-D1.       13470000
           MOVE PV-FD-END-DTE-DD         TO DTL-01-PM-END-DTE-DD.       13480000
           MOVE '/'                      TO DTL-01-PM-END-DTE-D2.       13490000
           MOVE PV-FD-END-DTE-YY         TO DTL-01-PM-END-DTE-YY.       13500000
           MOVE PV-FULL-DAY-PROMO-ITM-DESC TO DTL-01-PROMO-ITM-DESC-1.  13510000
           IF PV-FULL-DAY-ADV-IND = 'Y'                                 13520000
               MOVE 'A' TO DTL-01-ADV-IND-1                             13530000
           ELSE                                                         13540000
               MOVE 'U' TO DTL-01-ADV-IND-1                             13550000
           END-IF.                                                      13560000
                                                                        13570000
           MOVE PV-FULL-DAY-RETAIL-AMT   TO DTL-01-RETAIL-PRICE-1.      13580000
           MOVE PV-FULL-DAY-PRIC-PT-AMT  TO DTL-01-PROMO-PRICE-1.       13590000
                                                                        13600000
           MOVE ZEROES TO DTL-01-SIGN-NBR.                              13610000
                                                                        13620000
           IF PV-FULL-DAY-PRCH-TYP-CDE = 'T'                            13630000
             MOVE 'Y' TO DTL-01-TIER-PRICE-IND                          13640000
           ELSE                                                         13650000
             MOVE 'N' TO DTL-01-TIER-PRICE-IND                          13660000
           END-IF.                                                      13670000
                                                                        13680000
      ***************************************************************** 13690000
      * POPULATES THE SECOND DETAIL LINE (ALL OTHER PROMOS)             13700000
      ***************************************************************** 13710000
       D500-POPULATE-DETAIL2.                                           13720000
                                                                        13730000
           MOVE PV-PART-DAY-PROMO-NM        TO DTL-02-PROMO-NAME-2.     13740000
           MOVE PV-PD-STRT-DTE-MM        TO DTL-02-PM-BEG-DTE-MM.       13750000
           MOVE '/'                      TO DTL-02-PM-BEG-DTE-D1.       13760000
           MOVE PV-PD-STRT-DTE-DD        TO DTL-02-PM-BEG-DTE-DD.       13770000
           MOVE '/'                      TO DTL-02-PM-BEG-DTE-D2.       13780000
           MOVE PV-PD-STRT-DTE-YY        TO DTL-02-PM-BEG-DTE-YY.       13790000
           MOVE PV-PD-END-DTE-MM         TO DTL-02-PM-END-DTE-MM.       13800000
           MOVE '/'                      TO DTL-02-PM-END-DTE-D1.       13810000
           MOVE PV-PD-END-DTE-DD         TO DTL-02-PM-END-DTE-DD.       13820000
           MOVE '/'                      TO DTL-02-PM-END-DTE-D2.       13830000
           MOVE PV-PD-END-DTE-YY         TO DTL-02-PM-END-DTE-YY.       13840000
           MOVE PV-PART-DAY-PROMO-ITM-DESC  TO DTL-02-PROMO-ITM-DESC-2. 13850000
           IF PV-PART-DAY-ADV-IND = 'Y'                                 13860000
               MOVE 'A' TO DTL-02-ADV-IND-2                             13870000
           ELSE                                                         13880000
               MOVE 'U' TO DTL-02-ADV-IND-2                             13890000
           END-IF.                                                      13900000
                                                                        13910000
           MOVE PV-PART-DAY-RETAIL-AMT  TO DTL-02-RETAIL-PRICE-2.       13920000
           MOVE PV-PART-DAY-PRIC-PT-AMT TO DTL-02-PROMO-PRICE-2.        13930000
                                                                        13940000
           MOVE ZEROES TO DTL-02-SIGN-NBR.                              13950000
                                                                        13960000
           IF PV-PART-DAY-PRCH-TYP-CDE = 'T'                            13970000
             MOVE 'Y' TO DTL-02-TIER-PRICE-IND                          13980000
           ELSE                                                         13990000
             MOVE 'N' TO DTL-02-TIER-PRICE-IND                          14000000
           END-IF.                                                      14010000
                                                                        14020000
      ***************************************************************** 14030000
      *   WRITES A BLANK PAGE SO NEW BUYER STARTS ON NEW SHEET.         14040000
      ***************************************************************** 14050000
       H010-WRITE-BLANK-PAGE-IF-NEED.                                   14060000
                                                                        14070000
           DIVIDE PV-PAGE-CNT BY 2                                      14080000
               GIVING PV-PAGE-DIV                                       14090000
               REMAINDER PV-PAGE-REM.                                   14100000
                                                                        14110000
           IF PV-PAGE-REM > 0                                           14120000
                PERFORM H030-WRITE-ONE-BLANK-PAGE                       14130000
           END-IF.                                                      14140000
                                                                        14150000
      ***************************************************************** 14160000
      *   WRITES THE HEADER LINES TO THE REPORT.                        14170000
      ***************************************************************** 14180000
       H030-WRITE-ONE-BLANK-PAGE.                                       14190000
                                                                        14200000
           IF  PV-PAGE-CNT >= 1                                         14210000
              PERFORM W300-WRITE-LEGAL-LINE                             14220000
           END-IF.                                                      14230000
                                                                        14240000
           ADD 1                         TO PV-PAGE-CNT.                14250000
           MOVE PV-PAGE-CNT              TO DP150O-PAGE-NUMBER.         14260000
                                                                        14270000
           MOVE PC-RDS-REPORT-NAME       TO DP150O-REPORT-NUMBER.       14280000
           MOVE DP150O-STANDRD-HEADER-150-COLS TO PR-CONFLICT-LINE.     14290000
           PERFORM W100-WRITE-RPT-NEW-PAGE.                             14300000
                                                                        14310000
           MOVE HEADER-01                TO PR-CONFLICT-LINE.           14320000
           MOVE 2                        TO PV-ADVANCE-LINES.           14330000
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          14340000
                                                                        14350000
           MOVE HEADER-02                TO PR-CONFLICT-LINE.           14360000
           MOVE 2                        TO PV-ADVANCE-LINES.           14370000
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          14380000
                                                                        14390000
           MOVE HEADER-03                TO PR-CONFLICT-LINE.           14400000
           MOVE 2                        TO PV-ADVANCE-LINES.           14410000
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          14420000
                                                                        14430000
           PERFORM W700-WRITE-BLANK-LINE.                               14440000
                                                                        14450000
           MOVE HEADER-GMM               TO PR-CONFLICT-LINE.           14460000
           MOVE 1                        TO PV-ADVANCE-LINES.           14470000
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          14480000
                                                                        14490000
           MOVE HEADER-DMM               TO PR-CONFLICT-LINE.           14500000
           MOVE 1                        TO PV-ADVANCE-LINES.           14510000
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          14520000
                                                                        14530000
           MOVE HEADER-BUYER             TO PR-CONFLICT-LINE.           14540000
           MOVE 1                        TO PV-ADVANCE-LINES.           14550000
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          14560000
                                                                        14570000
           MOVE HEADER-DEPT              TO PR-CONFLICT-LINE.           14580000
           MOVE 1                        TO PV-ADVANCE-LINES.           14590000
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          14600000
                                                                        14610000
           MOVE BLANK-PAGE-NOTE          TO PR-CONFLICT-LINE.           14620000
           MOVE 10                       TO PV-ADVANCE-LINES.           14630000
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          14640000
                                                                        14650000
      ***************************************************************** 14660000
      *   WRITES THE HEADER LINES TO THE REPORT.                        14670000
      ***************************************************************** 14680000
       H100-WRITE-PAGE-HEADER.                                          14690000
                                                                        14700000
           IF  PV-PAGE-CNT >= 1                                         14710000
              PERFORM W300-WRITE-LEGAL-LINE                             14720000
           END-IF.                                                      14730000
                                                                        14740000
           ADD 1                         TO PV-PAGE-CNT.                14750000
           MOVE PV-PAGE-CNT              TO DP150O-PAGE-NUMBER.         14760000
                                                                        14770000
           MOVE PC-RDS-REPORT-NAME       TO DP150O-REPORT-NUMBER.       14780000
           MOVE DP150O-STANDRD-HEADER-150-COLS TO PR-CONFLICT-LINE.     14790000
           PERFORM W100-WRITE-RPT-NEW-PAGE.                             14800000
                                                                        14810000
           MOVE PC-HDR1-TITLE1           TO HDR-01-TITLE.               14820000
           MOVE HEADER-01                TO PR-CONFLICT-LINE.           14830000
           MOVE 2                        TO PV-ADVANCE-LINES.           14840000
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          14850000
                                                                        14860000
           MOVE  'AD EVENT '             TO HDR-02-TITLE-1.             14870000
           MOVE   PV-AD-EVNT-NBR-TXT     TO HDR-02-TITLE-2.             14880000
           MOVE   PV-AD-EVNT-NM          TO HDR-02-TITLE-3.             14890000
           MOVE HEADER-02                TO PR-CONFLICT-LINE.           14900000
           MOVE 2                        TO PV-ADVANCE-LINES.           14910000
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          14920000
                                                                        14930000
           MOVE SPACES TO HDR-03-TITLE.                                 14940000
           STRING PV-FULL-DAY-PROMO-NM DELIMITED BY '  '                14950000
                  ' VS. '                  DELIMITED BY SIZE            14960000
                  PV-PART-DAY-PROMO-NM     DELIMITED BY '  '            14970000
           INTO HDR-03-TITLE.                                           14980000
           MOVE HEADER-03                TO PR-CONFLICT-LINE.           14990000
           MOVE 2                        TO PV-ADVANCE-LINES.           15000000
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          15010000
                                                                        15020000
           MOVE SPACES TO HDR-04-TITLE.                                 15030000
           IF PV-REPORT-TYPE = '01'                                     15040000
              MOVE PC-HDR1-TITLE4-01 TO HDR-04-TITLE                    15050000
           END-IF.                                                      15060000
                                                                        15070000
           IF PV-REPORT-TYPE = '02'                                     15080000
              MOVE PC-HDR1-TITLE4-02 TO HDR-04-TITLE                    15090000
           END-IF.                                                      15100000
                                                                        15110000
           IF PV-REPORT-TYPE = '03'                                     15120000
              MOVE PC-HDR1-TITLE4-03 TO HDR-04-TITLE                    15130000
           END-IF.                                                      15140000
                                                                        15150000
           MOVE HEADER-04                TO PR-CONFLICT-LINE.           15160000
           MOVE 2                        TO PV-ADVANCE-LINES.           15170000
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          15180000
                                                                        15190000
           PERFORM W700-WRITE-BLANK-LINE.                               15200000
                                                                        15210000
           MOVE PV-GMA-NBR               TO HDR-GMM-NBR.                15220000
           MOVE SPACES                   TO HDR-GMM-NAME.               15230000
           STRING PV-GMM-FRST-NM DELIMITED BY SPACE                     15240000
                  ' '            DELIMITED BY SIZE                      15250000
                  PV-GMM-LAST-NM DELIMITED BY SPACE                     15260000
                                       INTO HDR-GMM-NAME.               15270000
           MOVE HEADER-GMM               TO PR-CONFLICT-LINE.           15280000
           MOVE 1                        TO PV-ADVANCE-LINES.           15290000
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          15300000
                                                                        15310000
           MOVE PV-DMA-NBR               TO HDR-DMM-NBR.                15320000
           MOVE SPACES                   TO HDR-DMM-NAME.               15330000
           STRING PV-DMM-FRST-NM DELIMITED BY SPACE                     15340000
                  ' '            DELIMITED BY SIZE                      15350000
                  PV-DMM-LAST-NM DELIMITED BY SPACE                     15360000
                                       INTO HDR-DMM-NAME.               15370000
           MOVE HEADER-DMM               TO PR-CONFLICT-LINE.           15380000
           MOVE 1                        TO PV-ADVANCE-LINES.           15390000
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          15400000
                                                                        15410000
           MOVE PV-BYR-NBR               TO HDR-BYR-NBR.                15420000
           MOVE SPACES                   TO HDR-BYR-NAME.               15430000
           STRING PV-BYR-FRST-NM DELIMITED BY SPACE                     15440000
                  ' '            DELIMITED BY SIZE                      15450000
                  PV-BYR-LAST-NM DELIMITED BY SPACE                     15460000
                                       INTO HDR-BYR-NAME.               15470000
           MOVE HEADER-BUYER             TO PR-CONFLICT-LINE.           15480000
           MOVE 1                        TO PV-ADVANCE-LINES.           15490000
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          15500000
                                                                        15510000
           MOVE PV-DEPT-NBR              TO HDR-DEPT-NBR.               15520000
           MOVE PV-DEPT-NM               TO HDR-DEPT-NAME.              15530000
           MOVE HEADER-DEPT              TO PR-CONFLICT-LINE.           15540000
           MOVE 1                        TO PV-ADVANCE-LINES.           15550000
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          15560000
                                                                        15570000
           PERFORM W700-WRITE-BLANK-LINE.                               15580000
                                                                        15590000
           MOVE HEADER-PRE-05            TO PR-CONFLICT-LINE.           15600000
           MOVE 1                        TO PV-ADVANCE-LINES.           15610000
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          15620000
                                                                        15630000
           MOVE HEADER-05                TO PR-CONFLICT-LINE.           15640000
           MOVE 1                        TO PV-ADVANCE-LINES.           15650000
           PERFORM W150-WRITE-RPT-HEADER-LINE.                          15660000
                                                                        15670000
           PERFORM W700-WRITE-BLANK-LINE.                               15680000
                                                                        15690000
      ***************************************************************** 15700000
      *     WRITE NEW PAGE                                              15710000
      ***************************************************************** 15720000
       W100-WRITE-RPT-NEW-PAGE.                                         15730000
                                                                        15740000
           WRITE PR-CONFLICT-LINE AFTER ADVANCING PAGE.                 15750000
           MOVE 1                        TO PV-LINE-CNT.                15760000
                                                                        15770000
      ***************************************************************** 15780000
      *     WRITE HEADER LINE                                           15790000
      ***************************************************************** 15800000
       W150-WRITE-RPT-HEADER-LINE.                                      15810000
                                                                        15820000
           WRITE PR-CONFLICT-LINE AFTER ADVANCING                       15830000
                                       PV-ADVANCE-LINES.                15840000
           ADD PV-ADVANCE-LINES          TO PV-LINE-CNT.                15850000
                                                                        15860000
      ***************************************************************** 15870000
      *     WRITE DETAIL LINE1                                          15880000
      ***************************************************************** 15890000
       W200-WRITE-RPT-DETAIL-LINE1.                                     15900000
                                                                        15910000
           IF PV-LINE-CNT >=  PC-MAX-LINES                              15920000
               PERFORM H100-WRITE-PAGE-HEADER                           15930000
           END-IF.                                                      15940000
                                                                        15950000
           MOVE 1                        TO PV-ADVANCE-LINES.           15960000
           MOVE DETAIL-PRINT-01          TO PR-CONFLICT-LINE.           15970000
           WRITE PR-CONFLICT-LINE AFTER ADVANCING                       15980000
                                            PV-ADVANCE-LINES.           15990000
           ADD PV-ADVANCE-LINES          TO PV-LINE-CNT.                16000000
                                                                        16010000
           MOVE SPACES                   TO DETAIL-01.                  16020000
                                                                        16030000
      ***************************************************************** 16040000
      *     WRITE DETAIL LINE2                                          16050000
      ***************************************************************** 16060000
       W250-WRITE-RPT-DETAIL-LINE2.                                     16070000
                                                                        16080000
           IF PV-LINE-CNT >=  PC-MAX-LINES                              16090000
               PERFORM H100-WRITE-PAGE-HEADER                           16100000
           END-IF.                                                      16110000
                                                                        16120000
           MOVE 1                        TO PV-ADVANCE-LINES.           16130000
           MOVE DETAIL-PRINT-02          TO PR-CONFLICT-LINE.           16140000
           WRITE PR-CONFLICT-LINE AFTER ADVANCING PV-ADVANCE-LINES.     16150000
           ADD PV-ADVANCE-LINES          TO PV-LINE-CNT.                16160000
                                                                        16170000
           MOVE SPACES                   TO DETAIL-02.                  16180000
                                                                        16190000
      ******************************************************************16200000
      *     WRITE LEGAL LINE VERBAGE PER KOHL'S LEGAL DEPT.            *16210000
      ******************************************************************16220000
       W300-WRITE-LEGAL-LINE.                                           16230000
                                                                        16240000
           SUBTRACT PV-LINE-CNT FROM PC-MAX-LINES                       16250000
             GIVING PV-ADVANCE-CNT.                                     16260000
                                                                        16270000
           IF PV-ADVANCE-CNT < 1 THEN                                   16280000
               MOVE 2                  TO PV-ADVANCE-CNT                16290000
           ELSE                                                         16300000
               ADD 2                   TO PV-ADVANCE-CNT                16310000
           END-IF.                                                      16320000
                                                                        16330000
           MOVE LEGAL-LINE             TO PR-CONFLICT-LINE.             16340000
           WRITE PR-CONFLICT-LINE AFTER ADVANCING PV-ADVANCE-CNT.       16350000
           ADD PV-ADVANCE-CNT          TO PV-LINE-CNT.                  16360000
                                                                        16370000
      ***************************************************************** 16380000
      *     WRITE END OF REPORT LINE                                    16390000
      ***************************************************************** 16400000
       W400-WRITE-END-OF-RPT-LINE.                                      16410000
                                                                        16420000
           SUBTRACT PV-LINE-CNT FROM PC-MAX-LINES                       16430000
             GIVING PV-ADVANCE-CNT.                                     16440000
           MOVE PV-ADVANCE-CNT           TO PV-ADVANCE-LINES.           16450000
                                                                        16460000
           MOVE END-OF-REPORT-LINE       TO PR-CONFLICT-LINE.           16470000
           WRITE PR-CONFLICT-LINE AFTER ADVANCING                       16480000
                                        PV-ADVANCE-LINES.               16490000
           ADD PV-ADVANCE-LINES          TO PV-LINE-CNT.                16500000
                                                                        16510000
      ***************************************************************** 16520000
      *     WRITE NOTHING TO REPORT LINE                                16530000
      ***************************************************************** 16540000
       W401-WRITE-NOTHING-TO-RPT-LINE.                                  16550000
                                                                        16560000
           SUBTRACT PV-LINE-CNT FROM PC-MAX-LINES                       16570000
             GIVING PV-ADVANCE-CNT.                                     16580000
           MOVE PV-ADVANCE-CNT           TO PV-ADVANCE-LINES.           16590000
                                                                        16600000
           MOVE NOTHING-TO-REPORT-LINE   TO PR-CONFLICT-LINE.           16610000
           WRITE PR-CONFLICT-LINE AFTER ADVANCING                       16620000
                                        PV-ADVANCE-LINES.               16630000
                                                                        16640000
           ADD PV-ADVANCE-LINES          TO PV-LINE-CNT.                16650000
                                                                        16660000
      ***************************************************************** 16670000
      *     WRITE BLANK LINE                                            16680000
      ***************************************************************** 16690000
       W700-WRITE-BLANK-LINE.                                           16700000
                                                                        16710000
           MOVE SPACES                   TO PR-CONFLICT-LINE.           16720000
           WRITE PR-CONFLICT-LINE AFTER ADVANCING 1.                    16730000
           ADD 1                         TO PV-LINE-CNT.                16740000
                                                                        16750000
      *--------------------------------------------------------------   16760000
      * THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION THAT      16770000
      * LOGS ON TO ORACLE.                                              16780000
      *---------------------------------------------------------------  16790000
DAFDAF*    COPY PMPD800.                                                16800005
                                                                        16810000
      ***************************************************************** 16820000
      * Z100-ABEND.                                                   * 16830000
      *  - PERFORM AN ABEND THAT OCCURED RELATED TO ORACLE            * 16840000
      ***************************************************************** 16850000
       Z100-ABEND.                                                      16860000
                                                                        16870000
           DISPLAY '                       '.                           16880000
           DISPLAY '** ABEND **       ** = SQLERROR'.                   16890000
           DISPLAY '** PROGRAM        ** = ' PC-PROGRAM-NAME.           16900005
           DISPLAY '** SQLCODE        ** = ' SQLCODE.                   16910000
           DISPLAY '** ABEND CODE     ** = ' ABEND-CODE.                16920000
           DISPLAY '** SQLERRM        ** = ' SQLERRM.                   16930000
           DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                  16940000
           DISPLAY '** SQLERRD(5)     ** = ' SQLERRD(5).                16950000
           DISPLAY '** PARAGRAPH      ** = ' PV-PARAGRAPH-NAME.         16960000
           DISPLAY '** TABLE          ** = ' PV-TABLE-NAME.             16970000
           DISPLAY '** OPERATION      ** = ' PV-OPERATION-MSG-1.        16980000
           DISPLAY '                       '.                           16990000
                                                                        17000000
                                                                        17010000
           CALL 'ILBOABN0' USING ABEND-CODE.                            17020000
                                                                        17030000
W37986************************************************************      17040000
W37986* Z200-ABEND.                                                     17050000
W37986*     PERFORMS A NON-SQL-ABEND.                                   17060000
W37986************************************************************      17070000
W37986 Z200-ABEND.                                                      17080000
W37986                                                                  17090000
W37986     DISPLAY '** ABEND           **'.                             17100000
W37986     DISPLAY '** PROGRAM         ** = ' PC-PROGRAM-NAME.          17110005
W37986     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        17120000
W37986     DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG-1.       17130000
W37986     DISPLAY '**                 ** = ' PV-OPERATION-MSG-2.       17140000
W37986                                                                  17150000
W37986     CALL 'ILBOABN0' USING ABEND-CODE.                            17160000
W37986                                                                  17170000
