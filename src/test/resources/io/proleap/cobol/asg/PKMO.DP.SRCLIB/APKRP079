000100 IDENTIFICATION DIVISION.                                         00010099
000200 PROGRAM-ID.    APKRP079.                                         00020099
000300 AUTHOR.        COGNIZANT.                                        00030099
000400 DATE-WRITTEN.  MARCH 2019.                                       00040099
000500 DATE-COMPILED.                                                   00050099
000600******************************************************************00060099
000700* AP MEMORANDUM STATEMENTS                                       *00070099
000800*----------------------------------------------------------------*00080099
000900* COBOL II WITH SQL                                              *00090099
001000*----------------------------------------------------------------*00100099
001100* CREATES A FILE FOR AFP TO CREATE THE AP RECEIVEABLE STATEMENTS *00110099
001200*----------------------------------------------------------------*00120099
001300* INPUT:                                                         *00130099
001400*  1. PAYMENT EXTARCT FILE                  (APRD083)            *00140099
001500*                                                                *00150099
001600* DB2 TABLES:                                                    *00160099
001700*  2. DB2 AP MEMORANDUM TABLE               (APT_AP_MEMO)        *00170099
001800*  3. BUSINESS LOCATION TABLE               (TBUSLOC)            *00180099
001900*  4. EXTERNAL ENTITY ID TABLE              (TEXTENT)            *00190099
002000*  5. EXTERNAL ENTERPRISE NAME              (TENTNME)            *00200099
002100*  6. AP TRAN CODE TABLE                    (TTRNCDE)            *00210099
002200*                                                                *00220099
002300* OUTPUT:                                                        *00230099
002400*  1. STATEMENTS FILE                                            *00240099
002500*  2. MEMO UPDATE FILE                      (APRD188)            *00250099
002600*  3. AP REMITTANCE FILE                    (APRD002)            *00260099
002700*----------------------------------------------------------------*00270099
002800* CHANGES:                                                       *00280099
002900*                                                                *00290099
003000* 03/12/19  NEW PROGRAM AS PART OF PEOPLESOFT ERP MIGRATION.     *00300099
003100*           USES THE NELWY CREATED DB2 TABLE APT_AP_MEMO INSTEAD *00310099
003200*           OF PEOPLESOFT ORACLE TABLES.                         *00320099
003300*           CHANGED BY : COGNIZANT         WR#: CHG0220043       *00330099
003310*                                                                *00331099
003320* DATE  08/06/2019                                               *00332099
003330*     CHANGE MADE:                                               *00333099
003340*     MODIFIED THE STARTING VALUE OF THE PS-CURSOR-SW TO INDICATE*00334099
003350*     THE CURSOR IS NOT OPEN.  WHEN THE INPUT FILE IS EMPTY, EOJ *00335099
003360*     PARAGRAPH WAS TRYING TO CLOSE THE CURSOR WHEN IT HAD NEVER *00336099
003370*     BEEN OPENED, CAUSING PROGRAM ABEND.                        *00337099
003380*     MADE BY: NANCY EILBES            WR/IR #: CHG0228848       *00338099
003400******************************************************************00340099
003500                                                                  00350099
003600 ENVIRONMENT DIVISION.                                            00360099
003700 CONFIGURATION SECTION.                                           00370099
003800 SOURCE-COMPUTER.        IBM-370.                                 00380099
003900 OBJECT-COMPUTER.        IBM-370.                                 00390099
004000                                                                  00400099
004100 SPECIAL-NAMES.                                                   00410099
004200     C01 IS TOP-OF-PAGE.                                          00420099
004300                                                                  00430099
004400 INPUT-OUTPUT SECTION.                                            00440099
004500                                                                  00450099
004600 FILE-CONTROL.                                                    00460099
004700     SELECT PYMT-EXT-FILE        ASSIGN TO INP01.                 00470099
004800     SELECT STATEMENTS           ASSIGN TO RPT01.                 00480099
004900     SELECT MEMO-UPDATE-FILE     ASSIGN TO OUT01.                 00490099
005000     SELECT AP-REMITTANCE-FILE   ASSIGN TO OUT02.                 00500099
005100                                                                  00510099
005200 DATA DIVISION.                                                   00520099
005300 FILE SECTION.                                                    00530099
005400                                                                  00540099
005500 FD  PYMT-EXT-FILE                                                00550099
005600     RECORDING MODE IS F                                          00560099
005700     LABEL RECORDS ARE STANDARD                                   00570099
005800     BLOCK CONTAINS 0 RECORDS                                     00580099
005900     RECORD CONTAINS 222 CHARACTERS                               00590099
006000     DATA RECORD IS PYMT-EXT-REC.                                 00600099
006100 01  PYMT-EXT-REC                   PIC X(222).                   00610099
006200                                                                  00620099
006300 FD  STATEMENTS                                                   00630099
006400     RECORDING MODE IS F                                          00640099
006500     LABEL RECORDS ARE STANDARD                                   00650099
006600     BLOCK CONTAINS 0 RECORDS                                     00660099
006700     RECORD CONTAINS 141 CHARACTERS                               00670099
006800     DATA RECORD IS STATEMENT-REPORT.                             00680099
006900 01  STATEMENT-REPORT                   PIC X(141).               00690099
007000                                                                  00700099
007100 FD  MEMO-UPDATE-FILE                                             00710099
007200     RECORDING MODE IS F                                          00720099
007300     LABEL RECORDS ARE STANDARD                                   00730099
007400     BLOCK CONTAINS 0 RECORDS                                     00740099
007500     RECORD CONTAINS 26 CHARACTERS                                00750099
007600     DATA RECORD IS MEMO-UPDATE-REC.                              00760099
007700 01  MEMO-UPDATE-REC                    PIC X(26).                00770099
007800                                                                  00780099
007900 FD  AP-REMITTANCE-FILE                                           00790099
008000     RECORDING MODE IS F                                          00800099
008100     LABEL RECORDS ARE STANDARD                                   00810099
008200     BLOCK CONTAINS 0 RECORDS                                     00820099
008300     RECORD CONTAINS 385 CHARACTERS                               00830099
008400     DATA RECORD IS AP-REMITTANCE-RECORD.                         00840099
008500 01  AP-REMITTANCE-RECORD           PIC X(385).                   00850099
008600                                                                  00860099
008700 WORKING-STORAGE SECTION.                                         00870099
008800                                                                  00880099
008900 77  MAX-TAPE-REM                       PIC 9(4)   VALUE 1000.    00890099
009000 77  LINE-CTR                           PIC 9(4)   VALUE 0.       00900099
009100 77  PAGE-CTR                           PIC 9(5)   VALUE 1.       00910099
009200 77  REMIT-CTR                          PIC 9(3)   VALUE 1.       00920099
009300 77  UPDATE-CTR                         PIC 9(5)   VALUE 0.       00930099
009400                                                                  00940099
009500 01  PROGRAM-CONSTANTS.                                           00950099
009600     05  PAGE-ONE                       PIC 9(01) VALUE 1.        00960099
009700     05  PC-SCF-GROUP1                  PIC X(06) VALUE 'GROUP1'. 00970099
009800     05  PC-SCF-TRD-IND                 PIC X(01) VALUE 'N'.      00980099
009900     05  PC-SCF-TRD-DTE              PIC X(10) VALUE '9999-12-31'.00990099
010000                                                                  01000099
010100 01  PROGRAM-SWITCHES.                                            01010099
010200     05  PS-NEW-PYMNT-ID-REF-SW         PIC X  VALUE 'N'.         01020099
010300         88  SAME-PYMNT-ID-REF                 VALUE 'N'.         01030099
010400         88  NEW-PYMNT-ID-REF                  VALUE 'Y'.         01040099
010500     05  PS-MEMO-END-OF-CSR             PIC X  VALUE 'N'.         01050099
010600         88  MEMO-NOT-END-OF-CSR               VALUE 'N'.         01060099
010700         88  MEMO-END-OF-CSR                   VALUE 'Y'.         01070099
010800     05  PS-CURSOR-SW                   PIC X  VALUE 'N'.         01080099
010900         88  CSR-OPEN                          VALUE 'Y'.         01090099
011000         88  CSR-CLOSED                        VALUE 'N'.         01100099
011100     05  PS-USING-TABLE2-SW             PIC X  VALUE 'N'.         01110099
011200         88  USING-TABLE2                      VALUE 'Y'.         01120099
011300         88  NOT-USING-TABLE2                  VALUE 'N'.         01130099
011400     05  PS-INPUT-NOT-EOF               PIC X  VALUE 'N'.         01140099
011500         88  INPUT-EOF                         VALUE 'Y'.         01150099
011600     05  PS-TO-IGNORE-OUT02             PIC X  VALUE 'N'.         01160099
011700         88  IGNORE-OUT02                      VALUE 'Y'.         01170099
011800         88  IGNORE-OUT02-NO                   VALUE 'N'.         01180099
011900     05  PS-TO-IGNORE-RPT01             PIC X  VALUE 'N'.         01190099
012000         88  IGNORE-RPT01                      VALUE 'Y'.         01200099
012100         88  IGNORE-RPT01-NO                   VALUE 'N'.         01210099
012200                                                                  01220099
012300                                                                  01230099
012400 01  PROGRAM-VARIABLES.                                           01240099
012500     05  VENDOR-BEING-PROCESSED         PIC X(10)   VALUE SPACES. 01250099
012600     05  PV-SUM-GROSS-AMT               PIC S9(13)V99   VALUE +0  01260099
012700                                            USAGE COMP-3.         01270099
012800     05  PV-SUM-DSCNT-AMT               PIC S9(13)V99   VALUE +0  01280099
012900                                            USAGE COMP-3.         01290099
013000     05  PV-SUM-FREIGHT-AMT             PIC S9(13)V99   VALUE +0  01300099
013100                                            USAGE COMP-3.         01310099
013200     05  PV-TOTAL-TOTCOST               PIC S9(13)V99   VALUE +0. 01320099
013300     05  PV-GROSS-AMT                   PIC S9(13)V99   VALUE +0. 01330099
013400     05  PV-DSCNT-AMT                   PIC S9(08)V99   VALUE +0. 01340099
013500     05  PV-FREIGHT-AMT                 PIC S9(08)V99   VALUE +0. 01350099
013600     05  PV-NET-AMT                     PIC S9(13)V99   VALUE +0. 01360099
013700     05  PV-TEMP-GRO-AMT                PIC S9(13)V99   VALUE +0. 01370099
013800     05  PV-VENDOR-ID                   PIC X(10)    VALUE SPACE. 01380099
013900     05  PV-PO-NBR                      PIC S9(18)V  USAGE COMP-3.01390099
014000     05  PV-INVOICE-ID                  PIC X(16)    VALUE SPACE. 01400099
014100     05  PV-DEPT-ID                     PIC X(10)    VALUE SPACE. 01410099
014200     05  PV-CHECK-RUN-DATE              PIC X(10)    VALUE SPACE. 01420099
014300     05  PV-ORIGIN                      PIC X(03)    VALUE SPACE. 01430099
014400     05  FILLER REDEFINES PV-ORIGIN.                              01440099
014500         10  FILLER                     PIC X(01).                01450099
014600         10  PV-TRAN-CODE               PIC X(02).                01460099
014700     05  PV-MAX-SEQ-NUM                 PIC S9(09) COMP.          01470099
014800     05  PV-COUNT-DETAIL-CSR            PIC 9(09)       VALUE 0.  01480099
014900     05  PV-COUNT-MEMO-CSR              PIC 9(09)       VALUE 0.  01490099
015000     05  PV-IN-COUNT                    PIC 9(09)       VALUE 0.  01500099
015100     05  PV-COUNT-AP-REMIT              PIC S9(09) COMP VALUE 0.  01510099
015200     05  PV-STATEMENTS-OUT              PIC 9(09)       VALUE 0.  01520099
015300     05  PV-UPDATES-OUT                 PIC 9(09)       VALUE 0.  01530099
015400     05  PV-TOTAL-ROWS                  PIC S9(07) COMP VALUE 0.  01540099
015500     05  PV-TOTAL-PAGES                 PIC 9(05)       VALUE 0.  01550099
015600     05  PV-PAGES                       PIC 9(09)       VALUE 0.  01560099
015700     05  PV-PAGES-REMAINDER             PIC 9(05)       VALUE 0.  01570099
015800     05  PV-STMT-DTE                    PIC X(10).                01580099
015900     05  FILLER REDEFINES PV-STMT-DTE.                            01590099
016000         10 PV-STMT-DTE-MONTH           PIC X(02).                01600099
016100         10 PV-STMT-DTE-DASH1           PIC X(01).                01610099
016200         10 PV-STMT-DTE-DAY             PIC X(02).                01620099
016300         10 PV-STMT-DTE-DASH2           PIC X(01).                01630099
016400         10 PV-STMT-DTE-CENTURY         PIC X(02).                01640099
016500         10 PV-STMT-DTE-YEAR            PIC X(02).                01650099
016600     05  PV-SYSTEM-DATE                 PIC X(08)  VALUE ZERO.    01660099
016700     05  FILLER REDEFINES PV-SYSTEM-DATE.                         01670099
016800         10  PV-SYSTEM-CENTURY          PIC X(02).                01680099
016900         10  PV-SYSTEM-YEAR             PIC X(02).                01690099
017000         10  PV-SYSTEM-MONTH            PIC X(02).                01700099
017100         10  PV-SYSTEM-DAY              PIC X(02).                01710099
017200     05  ASOFTODAY                      PIC X(10).                01720099
017300     05  ASOFTODAY-RED REDEFINES ASOFTODAY.                       01730099
017400         10  ASOFTODAY-CENTURY          PIC X(02).                01740099
017500         10  ASOFTODAY-YEAR             PIC X(02).                01750099
017600         10  ASOFTODAY-DASH1            PIC X(01).                01760099
017700         10  ASOFTODAY-MONTH            PIC X(02).                01770099
017800         10  ASOFTODAY-DASH2            PIC X(01).                01780099
017900         10  ASOFTODAY-DAY              PIC X(02).                01790099
018000     05  BLANK-INDX                     PIC 9(04).                01800099
018100     05  LINE-INDX                      PIC 9(04).                01810099
018200     05  PAGE-INDX                      PIC 9(05).                01820099
018300     05  CL-INDX                        PIC 9(04).                01830099
018400     05  CV-INDX                        PIC 9(04).                01840099
018500     05  WORK-COMMENT-LINE-ALL          PIC X(312) VALUE SPACES.  01850099
018600     05  WORK-COMMENT-LINE-74           PIC X(74)  VALUE SPACES.  01860099
018700     05  FILLER REDEFINES WORK-COMMENT-LINE-74.                   01870099
018800         10 WORK-COMMENT-LINE-73        PIC X(73).                01880099
018900         10 FILLER                      PIC X(01).                01890099
019000     05  PV-PROGRAM-NAME                PIC X(08)  VALUE          01900099
019100                                                     'APKRP079'.  01910099
019200     05  PV-PYMNT-ID-REF                PIC X(20)  VALUE SPACES.  01920099
019300     05  PV-DEPTID                      PIC X(10)  VALUE SPACES.  01930099
019400     05  PV-ORACLE-USERID-LEN           PIC S9(04) VALUE ZEROS.   01940099
019500     05  PV-ORACLE-PASSWORD-LEN         PIC S9(04) VALUE ZEROS.   01950099
019600                                                                  01960099
019700 01  HOLD-FIELDS.                                                 01970099
019800     05  HOLD-PO-NBR                    PIC S9(09) COMP VALUE 0.  01980099
019900     05  HOLD-INDEX                     PIC  9(06) VALUE 0.       01990099
020000     05  HOLD-INDEX2                    PIC  9(06) VALUE 0.       02000099
020100     05  HOLD-INVOICE-NBR               PIC  X(16) VALUE SPACES.  02010099
020200     05  HOLD-SETID                     PIC  X(05) VALUE SPACES.  02020099
020300     05  HOLD-VOUCHER-ID                PIC  X(08) VALUE SPACES.  02030099
020400     05  HOLD-ORIGIN                    PIC  X(03) VALUE SPACES.  02040099
020500     05  HOLD-PYMNT-ID-REF              PIC  X(10) VALUE SPACES.  02050099
020600                                                                  02060099
020700*--------------------------------------------------------------*  02070099
020800*  ABEND DATA AREAS                                            *  02080099
020900*--------------------------------------------------------------*  02090099
021000 01  ABEND-CODE                         PIC S9(04) VALUE ZEROS    02100099
021100                                                   COMP SYNC.     02110099
021200     88  AC-BAD-WRITE                   VALUE  +4001.             02120099
021300     88  AC-CONTROL-CARD-ERROR          VALUE  +4003.             02130099
021400     88  AC-OPEN-ERROR                  VALUE  +4005.             02140099
021500     88  AC-CLOSE-ERROR                 VALUE  +4006.             02150099
021600     88  AC-BAD-DATA                    VALUE  +4008.             02160099
021700     88  AC-ORA-ERROR                   VALUE  +4013.             02170099
021800     88  AC-UNSUCCESSFUL-SELECT         VALUE  +4015.             02180099
021900     88  AC-MAX-RETRIES-EXCEEDED        VALUE  +4016.             02190099
022000     88  AC-DATE-ERROR                  VALUE  +4019.             02200099
022100                                                                  02210099
022200 01  ABEND-AREAS.                                                 02220099
022300     05  AA-ABEND-LIT                   PIC  X(40)  VALUE         02230099
022400             '*****       ABEND'.                                 02240099
022500     05  AA-PROGRAM-LIT                 PIC  X(40)  VALUE         02250099
022600             '*****   PROGRAM: APKRP079'.                         02260099
022700     05  AA-PARAGRAPH-LIT.                                        02270099
022800         10  FILLER                     PIC  X(17)  VALUE         02280099
022900             '***** PARAGRAPH: '.                                 02290099
023000         10  AA-PARAGRAPH-NAME          PIC  X(35)  VALUE SPACES. 02300099
023100     05  AA-MESSAGE-LINE.                                         02310099
023200         10  FILLER                     PIC  X(06)  VALUE         02320099
023300             '*****'.                                             02330099
023400         10  AA-MESSAGE                 PIC  X(127) VALUE SPACES. 02340099
023500     05  AA-DB2-ERROR-LIT        PIC  X(40)  VALUE                02350099
023600             '*****    DB2 ERROR'.                                02360099
023700     05  AA-DB2-OPERATION-LIT.                                    02370099
023800         10  FILLER              PIC  X(17)  VALUE                02380099
023900             '***** OPERATION: '.                                 02390099
024000         10  AA-DB2-OPERATION.                                    02400099
024100             15  AA-DB2-OP-1     PIC  X(25)  VALUE SPACES.        02410099
024200             15  AA-DB2-OP-2     PIC  X(25)  VALUE SPACES.        02420099
024300     05  AA-DB2-TABLE-1          PIC  X(08)  VALUE SPACES.        02430099
024400     05  AA-DB2-TABLE-2          PIC  X(08)  VALUE SPACES.        02440099
024500     05  AA-DB2-TABLE-3          PIC  X(08)  VALUE SPACES.        02450099
024600                                                                  02460099
024700*--------------------------------------------------------------*  02470099
024800* INTERNAL TABLES                                              *  02480099
024900*--------------------------------------------------------------*  02490099
025000 01  TABLE-INDEXES.                                               02500099
025100     05  TBL-INDX                       PIC 9(07)   VALUE 0.      02510099
025200     05  TBL-INDX2                      PIC 9(07)   VALUE 0.      02520099
025300** IF CHANGING THE MAX-INDX, MAKE SURE YOU CHANGE THE OCCURS      02530099
025400** CLAUSE ON THE TABLE TO BE THE SAME.                            02540099
025500     05  MAX-INDX                       PIC 9(07)   VALUE 90000.  02550099
025600     05  MAX-INDX2                      PIC 9(07)   VALUE 90000.  02560099
025700                                                                  02570099
025800 01  STATEMENT-OUTPUT-TABLE.                                      02580099
025900     05  STATEMENT-TABLE OCCURS 90000 TIMES.                      02590099
026000         10  TABLE-SEGMENT              PIC  X(1)   VALUE 'R'.    02600099
026100             88 REMIT-SEGMENT                       VALUE 'R'.    02610099
026200             88 COMMENT-SEGMENT                     VALUE 'C'.    02620099
026300             88 TOTAL-SEGMENT                       VALUE 'T'.    02630099
026400         10  TABLE-REMITTANCE.                                    02640099
026500             15  TABLE-SKU-UPC-NBR      PIC  X(15)  VALUE SPACES. 02650099
026600             15  TABLE-LOC-NBR          PIC  X(04)  VALUE SPACES. 02660099
026700             15  TABLE-PO-NBR           PIC  9(09)      VALUE  0. 02670099
026800             15  TABLE-INVC-NBR         PIC  X(16)  VALUE SPACES. 02680099
026900             15  TABLE-VS-NBR           PIC  X(10)  VALUE SPACES. 02690099
027000             15  TABLE-INVC-UNITS       PIC  9(09)      VALUE  0. 02700099
027100             15  TABLE-RCVD-UNITS       PIC  9(09)      VALUE  0. 02710099
027200             15  TABLE-INVCCOST         PIC S9(13)V99   VALUE +0. 02720099
027300             15  TABLE-ORDRCOST         PIC S9(13)V99   VALUE +0. 02730099
027400             15  TABLE-TOTCOST          PIC S9(13)V99   VALUE +0. 02740099
027500             15  TABLE-REASON           PIC  X(18)  VALUE SPACES. 02750099
027600         10  FILLER REDEFINES TABLE-REMITTANCE.                   02760099
027700             15  TABLE-COMMENT          PIC X(100).               02770099
027800             15  TABLE-FILLER           PIC X(35).                02780099
027900         10  FILLER2 REDEFINES TABLE-REMITTANCE.                  02790099
028000             15  TABLE-TOTAL-TOTCOST    PIC S9(13)V99.            02800099
028100             15  TABLE-TOTAL-REASON     PIC X(18).                02810099
028200             15  FILLER                 PIC X(102).               02820099
028300         10  TABLE-VENDOR-NBR           PIC X(09)  VALUE SPACES.  02830099
028400                                                                  02840099
028500 01  STATEMENT-OUTPUT-TABLE-2.                                    02850099
028600     05  STATEMENT-TABLE2 OCCURS 90000 TIMES.                     02860099
028700         10  TABLE2-SEGMENT             PIC  X(1)   VALUE 'R'.    02870099
028800             88 REMIT-SEGMENT-2                     VALUE 'R'.    02880099
028900             88 COMMENT-SEGMENT-2                   VALUE 'C'.    02890099
029000             88 TOTAL-SEGMENT-2                     VALUE 'T'.    02900099
029100         10  TABLE2-REMITTANCE.                                   02910099
029200             15  TABLE2-SKU-UPC-NBR     PIC  X(15)  VALUE SPACES. 02920099
029300             15  TABLE2-LOC-NBR         PIC  X(04)  VALUE SPACES. 02930099
029400             15  TABLE2-PO-NBR          PIC  9(09)      VALUE  0. 02940099
029500             15  TABLE2-INVC-NBR        PIC  X(16)  VALUE SPACES. 02950099
029600             15  TABLE2-VS-NBR          PIC  X(10)  VALUE SPACES. 02960099
029700             15  TABLE2-INVC-UNITS      PIC  9(09)      VALUE  0. 02970099
029800             15  TABLE2-RCVD-UNITS      PIC  9(09)      VALUE  0. 02980099
029900             15  TABLE2-INVCCOST        PIC S9(13)V99   VALUE +0. 02990099
030000             15  TABLE2-ORDRCOST        PIC S9(13)V99   VALUE +0. 03000099
030100             15  TABLE2-TOTCOST         PIC S9(13)V99   VALUE +0. 03010099
030200             15  TABLE2-REASON          PIC  X(18)  VALUE SPACES. 03020099
030300         10  FILLER REDEFINES TABLE2-REMITTANCE.                  03030099
030400             15  TABLE2-COMMENT         PIC X(100).               03040099
030500             15  TABLE2-FILLER          PIC X(35).                03050099
030600         10  FILLER2 REDEFINES TABLE2-REMITTANCE.                 03060099
030700             15  TABLE2-TOTAL-TOTCOST   PIC S9(13)V99.            03070099
030800             15  TABLE2-TOTAL-REASON    PIC X(18).                03080099
030900             15  FILLER                 PIC X(102).               03090099
031000         10  TABLE2-VENDOR-NBR          PIC X(09)  VALUE SPACES.  03100099
031100                                                                  03110099
031200*--------------------------------------------------------------*  03120099
031300* MEMORANDUM REPORT LAYOUT                                     *  03130099
031400*--------------------------------------------------------------*  03140099
031500 01  STATEMENT-LAYOUT.                                            03150099
031600     05  BLANK-REMIT-VENDOR-LINE.                                 03160099
031700         10  FILLER                     PIC X(132) VALUE SPACES.  03170099
031800         10  BLANK-REMIT-VENDOR-NBR     PIC X(09)  VALUE SPACES.  03180099
031900                                                                  03190099
032000     05  PAGE-TO-LINE.                                            03200099
032100         10  FILLER                     PIC X(113) VALUE SPACES.  03210099
032200         10  FILLER                     PIC X(05)  VALUE 'PAGE '. 03220099
032300         10  PAGE-TO-BEGIN-NBR          PIC ZZZZ9.                03230099
032400         10  FILLER                     PIC X(04)  VALUE ' OF '.  03240099
032500         10  PAGE-TO-END-NBR            PIC ZZZZ9.                03250099
032600         10  PAGE-TO-VENDOR-NBR         PIC X(09)  VALUE SPACES.  03260099
032700                                                                  03270099
032800     05  HEADER-LINE1.                                            03280099
032900         10  FILLER                     PIC X(58)  VALUE SPACES.  03290099
033000         10  HEADER-LINE1-CHECK-DATE    PIC X(10)  VALUE SPACES.  03300099
033100         10  FILLER                     PIC X(10)  VALUE SPACES.  03310099
033200         10  HEADER-LINE1-NAME          PIC X(40)  VALUE SPACES.  03320099
033300         10  FILLER                     PIC X(04)  VALUE SPACES.  03330099
033400         10  HEADER-LINE1-VENDOR-NBR    PIC X(10)  VALUE SPACES.  03340099
033500         10  HEADER-LINE1-VENDOR-NBR2   PIC X(09)  VALUE SPACES.  03350099
033600                                                                  03360099
033700     05  HEADER-LINE1A.                                           03370099
033800         10  FILLER                     PIC X(78)  VALUE SPACES.  03380099
033900         10  HEADER-LINE1A-NAME         PIC X(40)  VALUE SPACES.  03390099
034000         10  FILLER                     PIC X(14)  VALUE SPACES.  03400099
034100         10  HEADER-LINE1A-VENDOR-NBR   PIC X(09)  VALUE SPACES.  03410099
034200                                                                  03420099
034300     05  HEADER-LINE2.                                            03430099
034400         10  FILLER                     PIC X(78)  VALUE SPACES.  03440099
034500         10  HEADER-LINE2-ADDRESS       PIC X(35)  VALUE SPACES.  03450099
034600         10  FILLER                     PIC X(19)  VALUE SPACES.  03460099
034700         10  HEADER-LINE2-VENDOR-NBR    PIC X(09)  VALUE SPACES.  03470099
034800                                                                  03480099
034900     05  HEADER-LINE3.                                            03490099
035000         10  FILLER                     PIC X(78)  VALUE SPACES.  03500099
035100         10  HEADER-LINE3-CITY-ST-ZIP   PIC X(52)  VALUE SPACES.  03510099
035200         10  FILLER                     PIC X(02)  VALUE SPACES.  03520099
035300         10  HEADER-LINE3-VENDOR-NBR    PIC X(09)  VALUE SPACES.  03530099
035400                                                                  03540099
035500     05  HEADER-LINE4.                                            03550099
035600         10  FILLER                     PIC X(58)  VALUE SPACES.  03560099
035700         10  HEADER-LINE4-CHECK-NBR     PIC X(10)  VALUE SPACES.  03570099
035800         10  FILLER                     PIC X(64)  VALUE SPACES.  03580099
035900         10  HEADER-LINE4-VENDOR-NBR    PIC X(09)  VALUE SPACES.  03590099
036000                                                                  03600099
036100     05  COMMENT-LINE.                                            03610099
036200         10  FILLER                     PIC X(01)  VALUE SPACES.  03620099
036300         10  COMMENT-LINE-DESCR         PIC X(100) VALUE SPACES.  03630099
036400         10  FILLER                     PIC X(31)  VALUE SPACES.  03640099
036500         10  COMMENT-LINE-VENDOR-NBR    PIC X(09)  VALUE SPACES.  03650099
036600                                                                  03660099
036700     05  DETAIL-LINE.                                             03670099
036800         10  FILLER                     PIC X(01)  VALUE SPACES.  03680099
036900         10  DETAIL-LINE-SKU-UPC-NBR    PIC X(15).                03690099
037000         10  FILLER                     PIC X(01)  VALUE SPACES.  03700099
037100         10  DETAIL-LINE-LOC-NBR        PIC X(04).                03710099
037200         10  FILLER                     PIC X(01)  VALUE SPACES.  03720099
037300         10  DETAIL-LINE-PO-NBR         PIC ZZZZZZZZ9.            03730099
037400         10  FILLER                     PIC X(01)  VALUE SPACES.  03740099
037500         10  DETAIL-LINE-INVC-NBR       PIC X(16)  VALUE SPACES.  03750099
037600         10  FILLER                     PIC X(01)  VALUE SPACES.  03760099
037700         10  DETAIL-LINE-VS-NBR         PIC X(08)  VALUE SPACES.  03770099
037800         10  FILLER                     PIC X(02)  VALUE SPACES.  03780099
037900         10  DETAIL-LINE-INVC-UNITS     PIC ZZZZZZZZ9.            03790099
038000         10  FILLER                     PIC X(02)  VALUE SPACES.  03800099
038100         10  DETAIL-LINE-RCVD-UNITS     PIC ZZZZZZZZ9.            03810099
038200         10  DETAIL-LINE-INVCCOST-ALPHA PIC X(11)  VALUE SPACES.  03820099
038300         10  DETAIL-LINE-INVCCOST-EDIT REDEFINES                  03830099
038400                              DETAIL-LINE-INVCCOST-ALPHA.         03840099
038500             15 DETAIL-LINE-INVCCOST    PIC ---,--9.99.           03850099
038600             15 DETAIL-LINE-INVCCOST-RP PIC X.                    03860099
038700         10  FILLER                     PIC X(01)  VALUE SPACES.  03870099
038800         10  DETAIL-LINE-ORDRCOST-ALPHA PIC X(13)  VALUE SPACES.  03880099
038900         10  DETAIL-LINE-ORDRCOST-EDIT REDEFINES                  03890099
039000                              DETAIL-LINE-ORDRCOST-ALPHA.         03900099
039100             15 DETAIL-LINE-ORDRCOST    PIC -----,--9.99          03910099
039200                                        BLANK WHEN ZERO.          03920099
039300             15 DETAIL-LINE-ORDRCOST-RP PIC X.                    03930099
039400         10  FILLER                     PIC X(28)  VALUE SPACES.  03940099
039500         10  DETAIL-LINE-VENDOR-NBR     PIC X(09)  VALUE SPACES.  03950099
039600                                                                  03960099
039700     05  TOTAL-LINE.                                              03970099
039800         10  FILLER                     PIC X(104) VALUE SPACES.  03980099
039900         10  TOTAL-LINE-TOTCOST-ALPHA   PIC X(13)  VALUE SPACES.  03990099
040000         10  TOTAL-LINE-TOTCOST-EDIT   REDEFINES                  04000099
040100                              TOTAL-LINE-TOTCOST-ALPHA.           04010099
040200             15 TOTAL-LINE-TOTCOST      PIC -----,--9.99.         04020099
040300             15 TOTAL-LINE-TOTCOST-RP   PIC X.                    04030099
040400         10  TOTAL-LINE-REASON          PIC X(15)  VALUE SPACES.  04040099
040500         10  TOTAL-LINE-VENDOR-NBR      PIC X(09)  VALUE SPACES.  04050099
040600                                                                  04060099
040700*--------------------------------------------------------------*  04070099
040800* LAYOUT FOR PAYMENT EXTRACT FILE                              *  04080099
040900*--------------------------------------------------------------*  04090099
041000     COPY APRD083.                                                04100099
041100                                                                  04110099
041200*--------------------------------------------------------------*  04120099
041300* LAYOUT FOR THE AP REMITTANCE INFORMATION EXTRACT             *  04130099
041400*--------------------------------------------------------------*  04140099
041500     COPY APRD002.                                                04150099
041600                                                                  04160099
041700*--------------------------------------------------------------*  04170099
041800* COPYBOOK FOR THE MEMO UPDATE FILE                            *  04180099
041900*--------------------------------------------------------------*  04190099
042000     COPY APRD188.                                                04200099
042100                                                                  04210099
042200*--------------------------------------------------------------*  04220099
042300* SQLCA FORMATTED MESSAGE AREA                                 *  04230099
042400*--------------------------------------------------------------*  04240099
042500     COPY DPWS004.                                                04250099
042600                                                                  04260099
042700*--------------------------------------------------------------*  04270099
042800*  COMMUNICATIONS AREA2 FOR DB2                                *  04280099
042900*--------------------------------------------------------------*  04290099
043000                                                                  04300099
043100     COPY SQLCA2.                                                 04310099
043200                                                                  04320099
043300     EXEC SQL                                                     04330099
043400          INCLUDE SQLCA                                           04340099
043500     END-EXEC.                                                    04350099
043600                                                                  04360099
043700*--------------------------------------------------------------*  04370099
043800* TBUSLOC                                                      *  04380099
043900*--------------------------------------------------------------*  04390099
044000     EXEC SQL                                                     04400099
044100          INCLUDE TBUSLOC                                         04410099
044200     END-EXEC.                                                    04420099
044300                                                                  04430099
044400*--------------------------------------------------------------*  04440099
044500* TENTNME                                                      *  04450099
044600*--------------------------------------------------------------*  04460099
044700     EXEC SQL                                                     04470099
044800          INCLUDE TENTNME                                         04480099
044900     END-EXEC.                                                    04490099
045000                                                                  04500099
045100*--------------------------------------------------------------*  04510099
045200* TEXTENT                                                      *  04520099
045300*--------------------------------------------------------------*  04530099
045400     EXEC SQL                                                     04540099
045500          INCLUDE TEXTENT                                         04550099
045600     END-EXEC.                                                    04560099
045700                                                                  04570099
045800*--------------------------------------------------------------*  04580099
045900* AP TRAN CODE                                                 *  04590099
046000*--------------------------------------------------------------*  04600099
046100     EXEC SQL                                                     04610099
046200          INCLUDE TTRNCDE                                         04620099
046300     END-EXEC.                                                    04630099
046400                                                                  04640099
046500*--------------------------------------------------------------*  04650099
046600* DB2 AP MEMORANDUM TABLE (APT_AP_MEMO)                        *  04660099
046700*--------------------------------------------------------------*  04670099
046800     EXEC SQL                                                     04680099
046900          INCLUDE APT00001                                        04690099
047000     END-EXEC.                                                    04700099
047100                                                                  04710099
047200*--------------------------------------------------------------*  04720099
047300* MEMO_CSR                                                     *  04730099
047400*--------------------------------------------------------------*  04740099
047500     EXEC SQL                                                     04750099
047600          DECLARE MEMO_CSR CURSOR FOR                             04760099
047700          SELECT                                                  04770099
047800              A.VENDOR_ID                                         04780099
047900             ,A.INVOICE_ID                                        04790099
048000             ,A.KC_SKU_NBR                                        04800099
048100             ,A.DEPTID                                            04810099
048200             ,A.KC_PO_NBR                                         04820099
048300             ,A.KC_VS_NBR                                         04830099
048400             ,A.KC_INVC_QTY                                       04840099
048500             ,A.KC_RCVD_QTY                                       04850099
048600             ,A.KC_INVC_COST_AMT                                  04860099
048700             ,A.KC_ORD_COST_AMT                                   04870099
048800             ,A.KC_TOT_COST_AMT                                   04880099
048900             ,A.ORIGIN                                            04890099
049000             ,A.KC_CRE_DTE                                        04900099
049100             ,A.KC_AP_MEMO_TMST                                   04910099
049200             ,A.UPC_ID                                            04920099
049300          FROM APT_AP_MEMO A                                      04930099
049400         WHERE A.VENDOR_ID  = :PV-VENDOR-ID                       04940099
049500           AND A.INVOICE_ID = :PV-INVOICE-ID                      04950099
049600           AND A.KC_PO_NBR  = :PV-PO-NBR                          04960099
049700         ORDER BY                                                 04970099
049800               A.VENDOR_ID                                        04980099
049900              ,A.INVOICE_ID                                       04990099
050000              ,A.KC_PO_NBR                                        05000099
050100     END-EXEC.                                                    05010099
050200                                                                  05020099
050300*--------------------------------------------------------------*  05030099
050400 PROCEDURE DIVISION.                                              05040099
050500*--------------------------------------------------------------*  05050099
050600 A100-MAINLINE-ROUTINE.                                           05060099
050700                                                                  05070099
050800     PERFORM B100-INITIALIZATION.                                 05080099
050900     PERFORM B200-CREATE-STATEMENTS                               05090099
051000       UNTIL INPUT-EOF.                                           05100099
051100     PERFORM B400-TERMINATION.                                    05110099
051200     GOBACK.                                                      05120099
051300                                                                  05130099
051400*--------------------------------------------------------------*  05140099
051500* INITIALIZATION PROCESSING.                                   *  05150099
051600*--------------------------------------------------------------*  05160099
051700 B100-INITIALIZATION.                                             05170099
051800                                                                  05180099
051900     DISPLAY ' '.                                                 05190099
052000     DISPLAY '**--------------- APKRP079 --------------------**'. 05200099
052100     DISPLAY ' '.                                                 05210099
052200                                                                  05220099
052300     OPEN INPUT  PYMT-EXT-FILE                                    05230099
052400          OUTPUT STATEMENTS                                       05240099
052500                 MEMO-UPDATE-FILE                                 05250099
052600                 AP-REMITTANCE-FILE.                              05260099
052700                                                                  05270099
052800     INITIALIZE AP083-RECORD.                                     05280099
052900                                                                  05290099
053000     SET  NEW-PYMNT-ID-REF            TO TRUE.                    05300099
053100                                                                  05310099
053200     PERFORM R100-READ-INPUT-FILE.                                05320099
053300                                                                  05330099
053400*--------------------------------------------------------------*  05340099
053500* PERFORMS MAIN LOGIC FOR MEMORANDUM PROCESSING                *  05350099
053600*--------------------------------------------------------------*  05360099
053700 B200-CREATE-STATEMENTS.                                          05370099
053800                                                                  05380099
053900     SET MEMO-NOT-END-OF-CSR          TO TRUE.                    05390099
054000     SET IGNORE-RPT01-NO              TO TRUE.                    05400099
054100     SET IGNORE-OUT02-NO              TO TRUE.                    05410099
054200                                                                  05420099
054300     MOVE AP083-PO-NBR                TO HOLD-PO-NBR              05430099
054400                                         PV-PO-NBR.               05440099
054500     MOVE AP083-INVC-SRC              TO HOLD-ORIGIN.             05450099
054600     MOVE AP083-DOC-NBR               TO HOLD-INVOICE-NBR         05460099
054700                                         PV-INVOICE-ID.           05470099
054800                                                                  05480099
054900     IF AP083-REMIT-VENDOR = AP083-VND-NBR                        05490099
055000        MOVE AP083-REMIT-VENDOR       TO PV-VENDOR-ID             05500099
055100                                         VENDOR-BEING-PROCESSED   05510099
055200     ELSE                                                         05520099
055300        MOVE AP083-VND-NBR            TO PV-VENDOR-ID             05530099
055400                                         VENDOR-BEING-PROCESSED   05540099
055500     END-IF.                                                      05550099
055600                                                                  05560099
055700     IF AP083-PYMT-METHOD = 'CHECK'                               05570099
055800        IF AP083-PAY-GROUP = 'ZB'                                 05580099
055810           SET IGNORE-RPT01           TO TRUE                     05581099
056200        END-IF                                                    05620099
056220     ELSE                                                         05622099
056230        SET IGNORE-RPT01           TO TRUE                        05623099
056300     END-IF.                                                      05630099
056400                                                                  05640099
056500     IF AP083-PAY-GROUP = 'ZB'                                    05650099
056600        SET IGNORE-OUT02              TO TRUE                     05660099
056700     END-IF.                                                      05670099
056800                                                                  05680099
056900     PERFORM Y100-OPEN-MEMO-CSR                                   05690099
057000     PERFORM S100-FETCH-MEMO-CSR                                  05700099
057100     PERFORM S200-SELECT-ENT-ID                                   05710099
057200     PERFORM S300-ADDRESS-ATTN-TO-TXT                             05720099
057300                                                                  05730099
057400     IF NEW-PYMNT-ID-REF                                          05740099
057500        MOVE 1 TO PAGE-CTR                                        05750099
057600        MOVE 0 TO LINE-CTR                                        05760099
057700        MOVE 0 TO REMIT-CTR                                       05770099
057800                                                                  05780099
057900** INITIALIZE THE REMITTANCE INTERNAL TABLE                       05790099
058000        PERFORM VARYING TBL-INDX FROM 1 BY 1                      05800099
058100          UNTIL TBL-INDX = MAX-INDX                               05810099
058200          INITIALIZE TABLE-REMITTANCE (TBL-INDX)                  05820099
058300        END-PERFORM                                               05830099
058400                                                                  05840099
058500        PERFORM VARYING TBL-INDX2 FROM 1 BY 1                     05850099
058600          UNTIL TBL-INDX2 = MAX-INDX2                             05860099
058700          INITIALIZE TABLE2-REMITTANCE (TBL-INDX2)                05870099
058800        END-PERFORM                                               05880099
058900                                                                  05890099
059000** INITIALIZE THE AP REMITTANCE RECORD                            05900099
059100        INITIALIZE AP002-REMIT-EXTRACT-RECORD                     05910099
059200                                                                  05920099
059300** PROCESS THE NON-REMITTANCE INTERNAL TABLE INFO                 05930099
059400        SET SAME-PYMNT-ID-REF TO TRUE                             05940099
059500        SET NOT-USING-TABLE2 TO TRUE                              05950099
059600        MOVE 0 TO TBL-INDX                                        05960099
059700                  TBL-INDX2                                       05970099
059800        PERFORM C100-FILL-STATEMENT-FIELDS                        05980099
059900     END-IF.                                                      05990099
060000                                                                  06000099
060100** FILLS THE REMITTANCE INTERNAL TABLE                            06010099
060200     PERFORM UNTIL MEMO-END-OF-CSR                                06020099
060300        IF NOT IGNORE-OUT02                                       06030099
060400           INITIALIZE AP002-MEMO-INFORMATION                      06040099
060500           PERFORM C200-PROCESS-REMITTANCE                        06050099
060600           PERFORM W800-WRITE-AP-REMITTANCE                       06060099
060700        END-IF                                                    06070099
060800                                                                  06080099
060900        PERFORM S100-FETCH-MEMO-CSR                               06090099
061000     END-PERFORM.                                                 06100099
061100     PERFORM C400-CHECK-FOR-COMMENT.                              06110099
061200     PERFORM C500-CHECK-FOR-LAST-COMMENT.                         06120099
061300     PERFORM C300-PROCESS-TOTAL-LINE.                             06130099
061400     PERFORM Y200-CLOSE-MEMO-CSR.                                 06140099
061500                                                                  06150099
061600     MOVE AP083-PAYMENT-ID-REF        TO PV-PYMNT-ID-REF.         06160099
061700     MOVE PV-PYMNT-ID-REF(1:10)       TO HOLD-PYMNT-ID-REF.       06170099
061800                                                                  06180099
061900     PERFORM R100-READ-INPUT-FILE.                                06190099
062000                                                                  06200099
062100     MOVE AP083-PAYMENT-ID-REF        TO PV-PYMNT-ID-REF.         06210099
062200     IF PV-PYMNT-ID-REF(1:10) = HOLD-PYMNT-ID-REF                 06220099
062300        SET SAME-PYMNT-ID-REF   TO TRUE                           06230099
062400     ELSE                                                         06240099
062500        SET NEW-PYMNT-ID-REF    TO TRUE                           06250099
062600     END-IF.                                                      06260099
062700                                                                  06270099
062800     IF NEW-PYMNT-ID-REF OR INPUT-EOF                             06280099
062900     IF NOT IGNORE-RPT01                                          06290099
063000** CALCULATE THE NUMBER OF PAGES NEEDED FOR THE VENDOR            06300099
063100        PERFORM D300-CALCULATE-PAGES                              06310099
063200** MOVE OUT THE TOP OF THE MEMORANDUM INFO                        06320099
063300        PERFORM W100-WRITE-HEADER-LINE                            06330099
063400                                                                  06340099
063500        MOVE TBL-INDX TO HOLD-INDEX                               06350099
063600        MOVE TBL-INDX2 TO HOLD-INDEX2                             06360099
063700        IF USING-TABLE2                                           06370099
063800            SET NOT-USING-TABLE2 TO TRUE                          06380099
063900** THIS NEEDS TO BE SET TO 'N' TEMPORARILY SO THAT TABLE ONE CAN  06390099
064000** BE PROCESSED. IT'S RESET BELOW SO TABLE 2 GETS PROCESSED.      06400099
064100        END-IF                                                    06410099
064200                                                                  06420099
064300        MOVE 1 TO TBL-INDX                                        06430099
064400** PROCESSES THE INVOICES FROM THE REMITTANCE INTERNAL TABLE      06440099
064500        PERFORM VARYING TBL-INDX FROM 1 BY 1                      06450099
064600                  UNTIL TBL-INDX > HOLD-INDEX                     06460099
064700            PERFORM C700-PROCESS-AP-MEMORANDUMS                   06470099
064800        END-PERFORM                                               06480099
064900                                                                  06490099
065000        IF HOLD-INDEX2 > 0                                        06500099
065100            SET USING-TABLE2 TO TRUE                              06510099
065200            MOVE 1 TO TBL-INDX2                                   06520099
065300** PROCESSES THE INVOICES FROM THE REMITTANCE INTERNAL TABLE      06530099
065400            PERFORM VARYING TBL-INDX2 FROM 1 BY 1                 06540099
065500              UNTIL TBL-INDX2 > HOLD-INDEX2                       06550099
065600                 PERFORM C700-PROCESS-AP-MEMORANDUMS              06560099
065700            END-PERFORM                                           06570099
065800        END-IF                                                    06580099
065900                                                                  06590099
066000** WRITING BLANK LINES, TO LINE UP STATEMENT/REMIT INFO LINE      06600099
066100        IF (PAGE-CTR = PAGE-ONE) AND                              06610099
066200           (REMIT-CTR <= 51)                                      06620099
066300           PERFORM VARYING BLANK-INDX FROM 1 BY 1                 06630099
066400                   UNTIL REMIT-CTR = 51                           06640099
066500              PERFORM W700-WRITE-BLANK-LINE                       06650099
066600              ADD 1 TO REMIT-CTR                                  06660099
066700           END-PERFORM                                            06670099
066800           PERFORM W700-WRITE-BLANK-LINE                          06680099
066900        ELSE                                                      06690099
067000           IF (PAGE-CTR > PAGE-ONE) AND                           06700099
067100              (REMIT-CTR <= 51)                                   06710099
067200              PERFORM VARYING BLANK-INDX FROM 1 BY 1              06720099
067300                      UNTIL REMIT-CTR = 51                        06730099
067400                 PERFORM W700-WRITE-BLANK-LINE                    06740099
067500                 ADD 1 TO REMIT-CTR                               06750099
067600              END-PERFORM                                         06760099
067700           PERFORM W700-WRITE-BLANK-LINE                          06770099
067800           END-IF                                                 06780099
067900        END-IF                                                    06790099
068000     END-IF                                                       06800099
068100     END-IF.                                                      06810099
068200                                                                  06820099
068300                                                                  06830099
068400*--------------------------------------------------------------*  06840099
068500* END OF PROGRAM PROCESSING                                    *  06850099
068600*--------------------------------------------------------------*  06860099
068700 B400-TERMINATION.                                                06870099
068800                                                                  06880099
068900     DISPLAY '******************************************'.        06890099
069000     DISPLAY '**       APKRP079 RECORD COUNTS         **'.        06900099
069100     DISPLAY '******************************************'.        06910099
069200     DISPLAY 'PAYMENT EXTRACT FILE COUNT ' PV-IN-COUNT.           06920099
069300     DISPLAY 'STATEMENT VENDOR COUNT     ' PV-COUNT-MEMO-CSR.     06930099
069400     DISPLAY 'STATEMENT WRITTEN OUT      ' PV-STATEMENTS-OUT.     06940099
069500     DISPLAY 'MEMO UPDATES WRITTEN OUT   ' PV-UPDATES-OUT.        06950099
069600     DISPLAY 'AP REMITTANCE RECORDS      ' PV-COUNT-AP-REMIT.     06960099
069700     DISPLAY '******************************************'.        06970099
069800     DISPLAY '******************************************'.        06980099
069900                                                                  06990099
070000     IF NOT CSR-CLOSED                                            07000099
070100        PERFORM Y200-CLOSE-MEMO-CSR                               07010099
070200     END-IF.                                                      07020099
070300                                                                  07030099
070400     CLOSE PYMT-EXT-FILE                                          07040099
070500           STATEMENTS                                             07050099
070600           MEMO-UPDATE-FILE                                       07060099
070700           AP-REMITTANCE-FILE.                                    07070099
070800                                                                  07080099
070900*--------------------------------------------------------------*  07090099
071000* FILLS THE MEMORANDUM FIELDS THAT ARE NOT PART OF THE         *  07100099
071100* THE REMITTANCE DETAIL.                                       *  07110099
071200*--------------------------------------------------------------*  07120099
071300 C100-FILL-STATEMENT-FIELDS.                                      07130099
071400                                                                  07140099
071500                                                                  07150099
071600**   FORMAT THE STATEMENT DATE                                    07160099
071700     MOVE AP083-PYMT-DTE               TO ASOFTODAY.              07170099
071800     MOVE ASOFTODAY-MONTH              TO PV-STMT-DTE-MONTH.      07180099
071900     MOVE ASOFTODAY-DAY                TO PV-STMT-DTE-DAY.        07190099
072000     MOVE ASOFTODAY-CENTURY            TO PV-STMT-DTE-CENTURY.    07200099
072100     MOVE ASOFTODAY-YEAR               TO PV-STMT-DTE-YEAR.       07210099
072200     MOVE '/'                          TO PV-STMT-DTE-DASH1       07220099
072300                                          PV-STMT-DTE-DASH2.      07230099
072400     MOVE PV-STMT-DTE                  TO HEADER-LINE1-CHECK-DATE.07240099
072500                                                                  07250099
072600     MOVE ENTNME-ENT-NAME-DESC         TO HEADER-LINE1-NAME.      07260099
072700     MOVE PV-VENDOR-ID                 TO HEADER-LINE1-VENDOR-NBR 07270099
072800     MOVE BUSLOC-ATTENTION-TO-TXT      TO HEADER-LINE1A-NAME.     07280099
072900     MOVE BUSLOC-ADDRESS-LINE1-DESC    TO HEADER-LINE2-ADDRESS.   07290099
073000                                                                  07300099
073100**   STRING CITY, STATE, ZIP LINE                                 07310099
073200     MOVE SPACES TO HEADER-LINE3-CITY-ST-ZIP.                     07320099
073300     IF BUSLOC-CITY-NAME = SPACES                                 07330099
073400        CONTINUE                                                  07340099
073500     ELSE                                                         07350099
073600        STRING BUSLOC-CITY-NAME    DELIMITED BY '  '              07360099
073700               ', '                DELIMITED BY SIZE              07370099
073800               BUSLOC-STATE-CDE    DELIMITED BY '  '              07380099
073900               '  '                DELIMITED BY SIZE              07390099
074000               BUSLOC-ZIP-CDE      DELIMITED BY '  '              07400099
074100          INTO HEADER-LINE3-CITY-ST-ZIP                           07410099
074200        END-STRING                                                07420099
074300     END-IF.                                                      07430099
074400                                                                  07440099
074500     MOVE AP083-PAYMENT-ID-REF     TO PV-PYMNT-ID-REF             07450099
074600     MOVE PV-PYMNT-ID-REF(1:10)    TO HEADER-LINE4-CHECK-NBR.     07460099
074700                                                                  07470099
074800**   FILL AP REMITTANCE FIELDS                                    07480099
074900     SET  MEMO-LINE-RECORD TO TRUE                                07490099
CHG587     MOVE AP083-REMIT-VENDOR           TO AP002-REMIT-VENDOR.     07500099
075100     MOVE AP083-PAYMENT-ID-REF         TO PV-PYMNT-ID-REF.        07510099
075200     MOVE PV-PYMNT-ID-REF(1:10)        TO AP002-PAYMENT-ID-REF.   07520099
075300     MOVE SPACES                       TO AP002-PAY-CYCLE.        07530099
075400     MOVE ZEROES                       TO AP002-PAY-CYCLE-SEQ-NBR.07540099
075500     MOVE AP083-PYMT-DTE               TO AP002-PYMT-DTE.         07550099
075600     MOVE AP083-PYMNT-AMT              TO AP002-PYMNT-AMT.        07560099
075700     MOVE APT00001-VENDOR-ID           TO AP002-VCHR-VENDOR-ID.   07570099
075800                                                                  07580099
075900**   ADD VENDOR NUMBER TO END OF EACH LINE.                       07590099
076000     MOVE VENDOR-BEING-PROCESSED     TO HEADER-LINE1-VENDOR-NBR2. 07600099
076100     MOVE VENDOR-BEING-PROCESSED     TO HEADER-LINE1A-VENDOR-NBR. 07610099
076200     MOVE VENDOR-BEING-PROCESSED     TO HEADER-LINE2-VENDOR-NBR.  07620099
076300     MOVE VENDOR-BEING-PROCESSED     TO HEADER-LINE3-VENDOR-NBR.  07630099
076400     MOVE VENDOR-BEING-PROCESSED     TO HEADER-LINE4-VENDOR-NBR.  07640099
076500     MOVE VENDOR-BEING-PROCESSED     TO COMMENT-LINE-VENDOR-NBR.  07650099
076600     MOVE VENDOR-BEING-PROCESSED     TO DETAIL-LINE-VENDOR-NBR.   07660099
076700     MOVE VENDOR-BEING-PROCESSED     TO BLANK-REMIT-VENDOR-NBR.   07670099
076800     MOVE VENDOR-BEING-PROCESSED     TO TOTAL-LINE-VENDOR-NBR.    07680099
076900     MOVE VENDOR-BEING-PROCESSED     TO PAGE-TO-VENDOR-NBR.       07690099
077000                                                                  07700099
077100*--------------------------------------------------------------*  07710099
077200* POPULATES THE REMITTANCE INTERNAL TABLES                     *  07720099
077300*--------------------------------------------------------------*  07730099
077400 C200-PROCESS-REMITTANCE.                                         07740099
077500                                                                  07750099
077600     IF USING-TABLE2                                              07760099
077700        PERFORM C200-PROCESS-REMITTANCE-2                         07770099
077800     ELSE                                                         07780099
077900        PERFORM C200-PROCESS-REMITTANCE-1                         07790099
078000     END-IF.                                                      07800099
078100                                                                  07810099
078200**   FILL AP REMITTANCE FIELDS                                    07820099
078300     MOVE AP083-PO-NBR                TO AP002-PO-NBR.            07830099
078400     MOVE APT00001-INVOICE-ID         TO AP002-INVOICE-ID.        07840099
078500     MOVE AP083-INVC-SRC              TO AP002-ORIGIN.            07850099
078600     IF APT00001-KC-SKU-NBR > SPACE                               07860099
078700        MOVE APT00001-KC-SKU-NBR      TO AP002-MEMO-SKU-UPC-NBR   07870099
078800     ELSE                                                         07880099
078900        IF APT00001-UPC-ID    > SPACE                             07890099
079000           MOVE APT00001-UPC-ID       TO AP002-MEMO-SKU-UPC-NBR   07900099
079100        END-IF                                                    07910099
079200     END-IF.                                                      07920099
079300     MOVE APT00001-KC-INVC-QTY        TO AP002-MEMO-INV-QTY.      07930099
079400     MOVE APT00001-KC-RCVD-QTY        TO AP002-MEMO-RCV-QTY.      07940099
079500     MOVE APT00001-KC-INVC-COST-AMT   TO AP002-MEMO-INVC-COST-AMT.07950099
079600     MOVE APT00001-KC-ORD-COST-AMT    TO AP002-MEMO-ORD-COST-AMT. 07960099
079700     IF PV-TRAN-CODE = '0B'                                       07970099
079800        MOVE APT00001-DEPTID          TO AP002-MEMO-VEND-STYL-NBR 07980099
079900     ELSE                                                         07990099
080000        MOVE APT00001-KC-VS-NBR       TO AP002-MEMO-VEND-STYL-NBR 08000099
080100     END-IF.                                                      08010099
080200                                                                  08020099
080300**   FILL TRADE FIELDS                                            08030099
080400     MOVE SPACES                     TO AP002-SCF-TRD-IND.        08040099
080500     MOVE SPACES                     TO AP002-SCF-TRD-DTE.        08050099
080600                                                                  08060099
080700*-------------------------------*                                 08070099
080800 C200-PROCESS-REMITTANCE-1.                                       08080099
080900*-------------------------------*                                 08090099
081000                                                                  08100099
081100     ADD 1 TO TBL-INDX.                                           08110099
081200                                                                  08120099
081300     SET REMIT-SEGMENT (TBL-INDX) TO TRUE.                        08130099
081400                                                                  08140099
081500     MOVE AP083-INVC-SRC     TO PV-ORIGIN.                        08150099
081600     PERFORM S400-SELECT-REASON-CODE.                             08160099
081700                                                                  08170099
081800**   REMITTANCE LINES                                             08180099
081900     IF APT00001-KC-SKU-NBR    > SPACE                            08190099
082000        MOVE APT00001-KC-SKU-NBR  TO TABLE-SKU-UPC-NBR(TBL-INDX)  08200099
082100     ELSE                                                         08210099
082200        IF APT00001-UPC-ID     > SPACE                            08220099
082300          MOVE APT00001-UPC-ID    TO TABLE-SKU-UPC-NBR(TBL-INDX)  08230099
082400        END-IF                                                    08240099
082500     END-IF.                                                      08250099
082600     MOVE APT00001-DEPTID         TO PV-DEPTID                    08260099
082700     MOVE PV-DEPTID(2:4)          TO TABLE-LOC-NBR    (TBL-INDX). 08270099
082800     MOVE AP083-PO-NBR            TO TABLE-PO-NBR     (TBL-INDX). 08280099
082900     MOVE APT00001-INVOICE-ID     TO TABLE-INVC-NBR   (TBL-INDX). 08290099
083000     MOVE APT00001-KC-VS-NBR      TO TABLE-VS-NBR     (TBL-INDX). 08300099
083100     MOVE APT00001-KC-INVC-QTY    TO TABLE-INVC-UNITS (TBL-INDX). 08310099
083200     MOVE APT00001-KC-RCVD-QTY    TO TABLE-RCVD-UNITS (TBL-INDX). 08320099
083300     MOVE APT00001-KC-INVC-COST-AMT                               08330099
083400                                  TO TABLE-INVCCOST   (TBL-INDX). 08340099
083500     IF PV-TRAN-CODE = '12'                                       08350099
083600        MOVE ZEROES               TO TABLE-ORDRCOST (TBL-INDX)    08360099
083700     ELSE                                                         08370099
083800        MOVE APT00001-KC-ORD-COST-AMT                             08380099
083900                                  TO TABLE-ORDRCOST (TBL-INDX)    08390099
084000     END-IF.                                                      08400099
084100     MOVE APT00001-KC-TOT-COST-AMT                                08410099
084200                                  TO TABLE-TOTCOST    (TBL-INDX). 08420099
084300     MOVE TRNCDE-TRN-SHRT-DESC                                    08430099
084400                                  TO TABLE-REASON     (TBL-INDX). 08440099
084500     MOVE VENDOR-BEING-PROCESSED  TO TABLE-VENDOR-NBR (TBL-INDX). 08450099
084600                                                                  08460099
084700     COMPUTE PV-TOTAL-TOTCOST = PV-TOTAL-TOTCOST +                08470099
084800                                APT00001-KC-TOT-COST-AMT.         08480099
084900                                                                  08490099
085000** PROGRAM WILL ABEND IF THE REMITTANCE TABLE IS FULL.            08500099
085100     IF TBL-INDX = MAX-INDX                                       08510099
085200        DISPLAY 'SWITCHING TO TABLE 2 IN C200'                    08520099
085300        SET USING-TABLE2 TO TRUE                                  08530099
085400     END-IF.                                                      08540099
085500                                                                  08550099
085600*-----------------------------*                                   08560099
085700 C200-PROCESS-REMITTANCE-2.                                       08570099
085800*-----------------------------*                                   08580099
085900                                                                  08590099
086000     ADD 1 TO TBL-INDX2.                                          08600099
086100                                                                  08610099
086200     SET REMIT-SEGMENT-2 (TBL-INDX2) TO TRUE.                     08620099
086300                                                                  08630099
086400     MOVE AP083-INVC-SRC     TO PV-ORIGIN.                        08640099
086500     PERFORM S400-SELECT-REASON-CODE.                             08650099
086600                                                                  08660099
086700**   REMITTANCE LINES                                             08670099
086800     IF APT00001-KC-SKU-NBR    > SPACE                            08680099
086900        MOVE APT00001-KC-SKU-NBR                                  08690099
087000                            TO TABLE2-SKU-UPC-NBR(TBL-INDX2)      08700099
087100     ELSE                                                         08710099
087200        IF APT00001-UPC-ID    > SPACE                             08720099
087300          MOVE APT00001-UPC-ID                                    08730099
087400                            TO TABLE2-SKU-UPC-NBR(TBL-INDX2)      08740099
087500        END-IF                                                    08750099
087600     END-IF.                                                      08760099
087700     MOVE APT00001-DEPTID         TO PV-DEPTID.                   08770099
087800     MOVE PV-DEPTID(2:4)          TO TABLE2-LOC-NBR   (TBL-INDX2).08780099
087900     MOVE AP083-PO-NBR            TO TABLE2-PO-NBR    (TBL-INDX2).08790099
088000     MOVE APT00001-INVOICE-ID     TO TABLE2-INVC-NBR  (TBL-INDX2).08800099
088100     MOVE APT00001-KC-VS-NBR      TO TABLE2-VS-NBR    (TBL-INDX2).08810099
088200     MOVE APT00001-KC-INVC-QTY    TO                              08820099
088300                                    TABLE2-INVC-UNITS (TBL-INDX2).08830099
088400     MOVE APT00001-KC-RCVD-QTY    TO                              08840099
088500                                    TABLE2-RCVD-UNITS (TBL-INDX2).08850099
088600     MOVE APT00001-KC-INVC-COST-AMT                               08860099
088700                                  TO TABLE2-INVCCOST  (TBL-INDX2).08870099
088800     IF PV-TRAN-CODE = '12'                                       08880099
088900        MOVE ZEROES                TO TABLE2-ORDRCOST (TBL-INDX2) 08890099
089000     ELSE                                                         08900099
089100        MOVE APT00001-KC-ORD-COST-AMT                             08910099
089200                                   TO TABLE2-ORDRCOST (TBL-INDX2) 08920099
089300     END-IF.                                                      08930099
089400     MOVE APT00001-KC-TOT-COST-AMT                                08940099
089500                                 TO TABLE2-TOTCOST   (TBL-INDX2). 08950099
089600     MOVE TRNCDE-TRN-SHRT-DESC                                    08960099
089700                                 TO TABLE2-REASON    (TBL-INDX2). 08970099
089800     MOVE VENDOR-BEING-PROCESSED TO TABLE2-VENDOR-NBR (TBL-INDX2).08980099
089900                                                                  08990099
090000     COMPUTE PV-TOTAL-TOTCOST = PV-TOTAL-TOTCOST +                09000099
090100                                APT00001-KC-TOT-COST-AMT.         09010099
090200                                                                  09020099
090300** PROGRAM WILL ABEND IF THE REMITTANCE TABLE IS FULL.            09030099
090400     IF TBL-INDX2 > MAX-INDX2                                     09040099
090500        DISPLAY 'VENDOR BEING PROCESSED = ' VENDOR-BEING-PROCESSED09050099
090600        DISPLAY 'CHECK BEING PROCESSED = '                        09060099
090700                                         AP083-PAYMENT-ID-REF     09070099
090800        MOVE 'C200-PROCESS-REMITTANCE-2'  TO AA-PARAGRAPH-NAME    09080099
090900        MOVE 'REMITTANCE INTERNAL TABLE FULL, INCREASE TABLE SIZE'09090099
091000                                        TO AA-MESSAGE             09100099
091100        PERFORM Z999-DB2-ABEND                                    09110099
091200     END-IF.                                                      09120099
091300                                                                  09130099
091400*--------------------------------------------------------------*  09140099
091500* FORMATS THE TOTAL CHARGED COST SUB-TOTAL LINE                *  09150099
091600*--------------------------------------------------------------*  09160099
091700 C300-PROCESS-TOTAL-LINE.                                         09170099
091800                                                                  09180099
091900     IF USING-TABLE2                                              09190099
092000        PERFORM C300-PROCESS-TOTAL-LINE-2                         09200099
092100     ELSE                                                         09210099
092200        PERFORM C300-PROCESS-TOTAL-LINE-1                         09220099
092300     END-IF.                                                      09230099
092400                                                                  09240099
092500*-----------------------------*                                   09250099
092600 C300-PROCESS-TOTAL-LINE-1.                                       09260099
092700*-----------------------------*                                   09270099
092800                                                                  09280099
092900     ADD 1 TO TBL-INDX.                                           09290099
093000                                                                  09300099
093100     SET TOTAL-SEGMENT (TBL-INDX) TO TRUE.                        09310099
093200                                                                  09320099
093300     MOVE HOLD-ORIGIN             TO PV-ORIGIN.                   09330099
093400     PERFORM S400-SELECT-REASON-CODE.                             09340099
093500                                                                  09350099
093600**   REMITTANCE LINES                                             09360099
093700     MOVE PV-TOTAL-TOTCOST     TO TABLE-TOTAL-TOTCOST (TBL-INDX). 09370099
093800     MOVE TRNCDE-TRN-SHRT-DESC                                    09380099
093900                               TO TABLE-TOTAL-REASON  (TBL-INDX). 09390099
094000                                                                  09400099
094100     MOVE ZEROES                TO PV-TOTAL-TOTCOST.              09410099
094200     MOVE AP083-PO-NBR          TO HOLD-PO-NBR.                   09420099
094300     MOVE AP083-INVC-SRC        TO HOLD-ORIGIN.                   09430099
094400                                                                  09440099
094500** PROGRAM WILL ABEND IF THE REMITTANCE TABLE IS FULL.            09450099
094600     IF TBL-INDX > MAX-INDX                                       09460099
094700        DISPLAY 'SWITCHING TO TABLE 2 IN C300'                    09470099
094800        SET USING-TABLE2 TO TRUE                                  09480099
094900     END-IF.                                                      09490099
095000                                                                  09500099
095100*-----------------------------*                                   09510099
095200 C300-PROCESS-TOTAL-LINE-2.                                       09520099
095300*-----------------------------*                                   09530099
095400                                                                  09540099
095500     ADD 1 TO TBL-INDX2.                                          09550099
095600                                                                  09560099
095700     SET TOTAL-SEGMENT-2 (TBL-INDX2) TO TRUE.                     09570099
095800                                                                  09580099
095900     MOVE HOLD-ORIGIN             TO PV-ORIGIN.                   09590099
096000     PERFORM S400-SELECT-REASON-CODE.                             09600099
096100                                                                  09610099
096200**   REMITTANCE LINES                                             09620099
096300     MOVE PV-TOTAL-TOTCOST    TO TABLE2-TOTAL-TOTCOST (TBL-INDX2).09630099
096400     MOVE TRNCDE-TRN-SHRT-DESC                                    09640099
096500                              TO TABLE2-TOTAL-REASON (TBL-INDX2). 09650099
096600                                                                  09660099
096700     MOVE ZEROES                TO PV-TOTAL-TOTCOST.              09670099
096800     MOVE AP083-PO-NBR          TO HOLD-PO-NBR.                   09680099
096900     MOVE AP083-INVC-SRC        TO HOLD-ORIGIN.                   09690099
097000                                                                  09700099
097100** PROGRAM WILL ABEND IF THE REMITTANCE TABLE IS FULL.            09710099
097200     IF TBL-INDX2 > MAX-INDX2                                     09720099
097300        MOVE 'C300-PROCESS-TOTAL-LINE-2'                          09730099
097400                                        TO AA-PARAGRAPH-NAME      09740099
097500        MOVE 'REMITTANCE INTERNAL TABLE FULL, INCREASE TABLE SIZE'09750099
097600                                        TO AA-MESSAGE             09760099
097700        PERFORM Z999-DB2-ABEND                                    09770099
097800     END-IF.                                                      09780099
097900                                                                  09790099
098000*--------------------------------------------------------------*  09800099
098100* CHECKS IF A COMMENT SHOULD BE PROCESSED                      *  09810099
098200*--------------------------------------------------------------*  09820099
098300 C400-CHECK-FOR-COMMENT.                                          09830099
098400                                                                  09840099
098500     IF (APT00001-INVOICE-ID = HOLD-INVOICE-NBR) OR               09850099
098600        (MEMO-END-OF-CSR)                                         09860099
098700        CONTINUE                                                  09870099
098800     ELSE                                                         09880099
098900        IF AP083-INVC-DESCR  = ALL SPACES                         09890099
099000           CONTINUE                                               09900099
099100        ELSE                                                      09910099
099200           PERFORM C600-PROCESS-MEMO-COMMENTS                     09920099
099300        END-IF                                                    09930099
099400     END-IF.                                                      09940099
099500                                                                  09950099
099600*--------------------------------------------------------------*  09960099
099700* CHECKS IF THERE IS A FINAL COMMENT TO BE PROCESSED           *  09970099
099800*--------------------------------------------------------------*  09980099
099900 C500-CHECK-FOR-LAST-COMMENT.                                     09990099
100000                                                                  10000099
100100     IF MEMO-END-OF-CSR AND                                       10010099
100200        AP083-INVC-DESCR  = ALL SPACES                            10020099
100300        CONTINUE                                                  10030099
100400     ELSE                                                         10040099
100500        PERFORM C600-PROCESS-MEMO-COMMENTS                        10050099
100600     END-IF.                                                      10060099
100700                                                                  10070099
100800*--------------------------------------------------------------*  10080099
100900* ADDS THE COMMENTS TO THE REMITTANCE INTERNAL TABLE           *  10090099
101000*--------------------------------------------------------------*  10100099
101100 C600-PROCESS-MEMO-COMMENTS.                                      10110099
101200                                                                  10120099
101300     MOVE SPACES TO WORK-COMMENT-LINE-ALL                         10130099
101400                    WORK-COMMENT-LINE-74                          10140099
101500                    WORK-COMMENT-LINE-73.                         10150099
101600                                                                  10160099
101700     IF  USING-TABLE2                                             10170099
101800         ADD 1 TO TBL-INDX2                                       10180099
101900         MOVE SPACES TO TABLE2-COMMENT (TBL-INDX2)                10190099
102000         PERFORM C610-PROCESS-COMMENT2                            10200099
102100     ELSE                                                         10210099
102200         ADD 1 TO TBL-INDX                                        10220099
102300         MOVE SPACES TO TABLE-COMMENT (TBL-INDX)                  10230099
102400         PERFORM C610-PROCESS-COMMENT1                            10240099
102500     END-IF.                                                      10250099
102600                                                                  10260099
102700*---------------------------*                                     10270099
102800 C610-PROCESS-COMMENT1.                                           10280099
102900*---------------------------*                                     10290099
103000                                                                  10300099
103100     MOVE AP083-INVC-DESCR   TO WORK-COMMENT-LINE-ALL.            10310099
103200*  FILLING STATEMENT COMMENT 1                                    10320099
103300     SET COMMENT-SEGMENT (TBL-INDX) TO TRUE.                      10330099
103400     MOVE WORK-COMMENT-LINE-ALL(1:74) TO WORK-COMMENT-LINE-74.    10340099
103500     IF WORK-COMMENT-LINE-74(74:1) = SPACE                        10350099
103600         MOVE 75 TO CL-INDX                                       10360099
103700         MOVE WORK-COMMENT-LINE-73 TO TABLE-COMMENT (TBL-INDX)    10370099
103800         MOVE SPACES TO WORK-COMMENT-LINE-74                      10380099
103900     ELSE                                                         10390099
104000         PERFORM VARYING CV-INDX FROM 73 BY -1 UNTIL CV-INDX = 1  10400099
104100                      OR WORK-COMMENT-LINE-74(CV-INDX:1) = SPACE  10410099
104200                      OR WORK-COMMENT-LINE-74(CV-INDX:1) = ','    10420099
104300                      OR WORK-COMMENT-LINE-74(CV-INDX:1) = '-'    10430099
104400                      OR WORK-COMMENT-LINE-74(CV-INDX:1) = ';'    10440099
104500         END-PERFORM                                              10450099
104600         MOVE CV-INDX TO CL-INDX                                  10460099
104700         MOVE WORK-COMMENT-LINE-74(1:CV-INDX)                     10470099
104800                                  TO TABLE-COMMENT (TBL-INDX)     10480099
104900         MOVE SPACES TO WORK-COMMENT-LINE-74                      10490099
105000     END-IF.                                                      10500099
105100*  PROGRAM WILL ABEND IF THE REMITTANCE TABLE IS FULL.            10510099
105200     IF TABLE-COMMENT (TBL-INDX) NOT = ALL SPACES                 10520099
105300         ADD 1 TO TBL-INDX                                        10530099
105400         IF TBL-INDX = MAX-INDX                                   10540099
105500            DISPLAY 'SWITCHING TO TABLE 2 IN C610'                10550099
105600            SET USING-TABLE2 TO TRUE                              10560099
105700         END-IF                                                   10570099
105800     END-IF.                                                      10580099
105900     IF WORK-COMMENT-LINE-ALL(CL-INDX:1) = SPACE                  10590099
106000        ADD 1 TO CL-INDX                                          10600099
106100     END-IF.                                                      10610099
106200                                                                  10620099
106300     IF  USING-TABLE2                                             10630099
106400         PERFORM C620-PROCESS-COMMENT2                            10640099
106500     ELSE                                                         10650099
106600         PERFORM C620-PROCESS-COMMENT1                            10660099
106700     END-IF.                                                      10670099
106800                                                                  10680099
106900*--------------------------*                                      10690099
107000 C610-PROCESS-COMMENT2.                                           10700099
107100*--------------------------*                                      10710099
107200                                                                  10720099
107300     MOVE AP083-INVC-DESCR      TO WORK-COMMENT-LINE-ALL.         10730099
107400*  FILLING STATEMENT COMMENT 1                                    10740099
107500     SET COMMENT-SEGMENT-2 (TBL-INDX2) TO TRUE.                   10750099
107600     MOVE WORK-COMMENT-LINE-ALL(1:74) TO WORK-COMMENT-LINE-74.    10760099
107700     IF WORK-COMMENT-LINE-74(74:1) = SPACE                        10770099
107800         MOVE 75 TO CL-INDX                                       10780099
107900         MOVE WORK-COMMENT-LINE-73 TO TABLE2-COMMENT (TBL-INDX2)  10790099
108000         MOVE SPACES TO WORK-COMMENT-LINE-74                      10800099
108100     ELSE                                                         10810099
108200         PERFORM VARYING CV-INDX FROM 73 BY -1 UNTIL CV-INDX = 1  10820099
108300                      OR WORK-COMMENT-LINE-74(CV-INDX:1) = SPACE  10830099
108400                      OR WORK-COMMENT-LINE-74(CV-INDX:1) = ','    10840099
108500                      OR WORK-COMMENT-LINE-74(CV-INDX:1) = '-'    10850099
108600                      OR WORK-COMMENT-LINE-74(CV-INDX:1) = ';'    10860099
108700         END-PERFORM                                              10870099
108800         MOVE CV-INDX TO CL-INDX                                  10880099
108900         MOVE WORK-COMMENT-LINE-74(1:CV-INDX)                     10890099
109000                                  TO TABLE2-COMMENT (TBL-INDX2)   10900099
109100         MOVE SPACES TO WORK-COMMENT-LINE-74                      10910099
109200     END-IF.                                                      10920099
109300*  PROGRAM WILL ABEND IF THE REMITTANCE TABLE IS FULL.            10930099
109400     IF TABLE2-COMMENT (TBL-INDX) NOT = ALL SPACES                10940099
109500         ADD 1 TO TBL-INDX2                                       10950099
109600         IF TBL-INDX2 > MAX-INDX2                                 10960099
109700            MOVE 'C610-PROCESS-COMMENT2'    TO AA-PARAGRAPH-NAME  10970099
109800            MOVE 'REMITTANCE INTERNAL TABLE FULL, INCREASE TABLE' 10980099
109900                                            TO AA-MESSAGE         10990099
110000            PERFORM Z999-DB2-ABEND                                11000099
110100         END-IF                                                   11010099
110200     END-IF.                                                      11020099
110300     IF WORK-COMMENT-LINE-ALL(CL-INDX:1) = SPACE                  11030099
110400        ADD 1 TO CL-INDX                                          11040099
110500     END-IF.                                                      11050099
110600                                                                  11060099
110700     PERFORM C620-PROCESS-COMMENT2.                               11070099
110800                                                                  11080099
110900*---------------------------*                                     11090099
111000 C620-PROCESS-COMMENT1.                                           11100099
111100*---------------------------*                                     11110099
111200                                                                  11120099
111300*  FILLING STATEMENT COMMENT 2                                    11130099
111400     SET COMMENT-SEGMENT (TBL-INDX) TO TRUE.                      11140099
111500     MOVE WORK-COMMENT-LINE-ALL(CL-INDX:74)                       11150099
111600                     TO WORK-COMMENT-LINE-74                      11160099
111700     IF WORK-COMMENT-LINE-74(74:1) = SPACE                        11170099
111800         ADD 74 TO CL-INDX                                        11180099
111900         MOVE WORK-COMMENT-LINE-73 TO TABLE-COMMENT (TBL-INDX)    11190099
112000         MOVE SPACES TO WORK-COMMENT-LINE-74                      11200099
112100     ELSE                                                         11210099
112200         PERFORM VARYING CV-INDX FROM 73 BY -1 UNTIL CV-INDX = 1  11220099
112300                      OR WORK-COMMENT-LINE-74(CV-INDX:1) = SPACE  11230099
112400                      OR WORK-COMMENT-LINE-74(CV-INDX:1) = ','    11240099
112500                      OR WORK-COMMENT-LINE-74(CV-INDX:1) = '-'    11250099
112600                      OR WORK-COMMENT-LINE-74(CV-INDX:1) = ';'    11260099
112700         END-PERFORM                                              11270099
112800         ADD CV-INDX TO CL-INDX                                   11280099
112900         MOVE WORK-COMMENT-LINE-74(1:CV-INDX)                     11290099
113000                                  TO TABLE-COMMENT (TBL-INDX)     11300099
113100         MOVE SPACES TO WORK-COMMENT-LINE-74                      11310099
113200     END-IF.                                                      11320099
113300*  PROGRAM WILL ABEND IF THE REMITTANCE TABLE IS FULL.            11330099
113400     IF TABLE-COMMENT (TBL-INDX) NOT = ALL SPACES                 11340099
113500         ADD 1 TO TBL-INDX                                        11350099
113600         IF TBL-INDX = MAX-INDX                                   11360099
113700            DISPLAY 'SWITCHING TO TABLE 2 IN C620'                11370099
113800            SET USING-TABLE2 TO TRUE                              11380099
113900         END-IF                                                   11390099
114000     END-IF.                                                      11400099
114100     IF WORK-COMMENT-LINE-ALL(CL-INDX:1) = SPACE                  11410099
114200        ADD 1 TO CL-INDX                                          11420099
114300     END-IF.                                                      11430099
114400                                                                  11440099
114500     IF  USING-TABLE2                                             11450099
114600         PERFORM C630-PROCESS-COMMENT2                            11460099
114700     ELSE                                                         11470099
114800         PERFORM C630-PROCESS-COMMENT1                            11480099
114900     END-IF.                                                      11490099
115000                                                                  11500099
115100*--------------------------*                                      11510099
115200 C620-PROCESS-COMMENT2.                                           11520099
115300*--------------------------*                                      11530099
115400                                                                  11540099
115500*  FILLING STATEMENT COMMENT 2                                    11550099
115600     SET COMMENT-SEGMENT-2 (TBL-INDX2) TO TRUE.                   11560099
115700     MOVE WORK-COMMENT-LINE-ALL(CL-INDX:74)                       11570099
115800                     TO WORK-COMMENT-LINE-74                      11580099
115900     IF WORK-COMMENT-LINE-74(74:1) = SPACE                        11590099
116000         ADD 74 TO CL-INDX                                        11600099
116100         MOVE WORK-COMMENT-LINE-73 TO TABLE2-COMMENT (TBL-INDX2)  11610099
116200         MOVE SPACES TO WORK-COMMENT-LINE-74                      11620099
116300     ELSE                                                         11630099
116400         PERFORM VARYING CV-INDX FROM 73 BY -1 UNTIL CV-INDX = 1  11640099
116500                      OR WORK-COMMENT-LINE-74(CV-INDX:1) = SPACE  11650099
116600                      OR WORK-COMMENT-LINE-74(CV-INDX:1) = ','    11660099
116700                      OR WORK-COMMENT-LINE-74(CV-INDX:1) = '-'    11670099
116800                      OR WORK-COMMENT-LINE-74(CV-INDX:1) = ';'    11680099
116900         END-PERFORM                                              11690099
117000         ADD CV-INDX TO CL-INDX                                   11700099
117100         MOVE WORK-COMMENT-LINE-74(1:CV-INDX)                     11710099
117200                                  TO TABLE2-COMMENT (TBL-INDX2)   11720099
117300         MOVE SPACES TO WORK-COMMENT-LINE-74                      11730099
117400     END-IF.                                                      11740099
117500*  PROGRAM WILL ABEND IF THE REMITTANCE TABLE IS FULL.            11750099
117600     IF TABLE2-COMMENT (TBL-INDX) NOT = ALL SPACES                11760099
117700         ADD 1 TO TBL-INDX2                                       11770099
117800         IF TBL-INDX2 > MAX-INDX2                                 11780099
117900            MOVE 'C600-PROCESS-MEMO-COMMENTS'                     11790099
118000                                            TO AA-PARAGRAPH-NAME  11800099
118100            MOVE 'REMITTANCE INTERNAL TABLE FULL, INCREASE TABLE' 11810099
118200                                            TO AA-MESSAGE         11820099
118300            PERFORM Z999-DB2-ABEND                                11830099
118400         END-IF                                                   11840099
118500     END-IF.                                                      11850099
118600     IF WORK-COMMENT-LINE-ALL(CL-INDX:1) = SPACE                  11860099
118700        ADD 1 TO CL-INDX                                          11870099
118800     END-IF.                                                      11880099
118900                                                                  11890099
119000     PERFORM C630-PROCESS-COMMENT2.                               11900099
119100                                                                  11910099
119200*----------------------------*                                    11920099
119300 C630-PROCESS-COMMENT1.                                           11930099
119400*----------------------------*                                    11940099
119500                                                                  11950099
119600*  FILLING STATEMENT COMMENT 3                                    11960099
119700     SET COMMENT-SEGMENT (TBL-INDX) TO TRUE.                      11970099
119800     MOVE WORK-COMMENT-LINE-ALL(CL-INDX:74)                       11980099
119900                     TO WORK-COMMENT-LINE-74                      11990099
120000     IF WORK-COMMENT-LINE-74(74:1) = SPACE                        12000099
120100         ADD 74 TO CL-INDX                                        12010099
120200         MOVE WORK-COMMENT-LINE-73 TO TABLE-COMMENT (TBL-INDX)    12020099
120300         MOVE SPACES TO WORK-COMMENT-LINE-74                      12030099
120400     ELSE                                                         12040099
120500         PERFORM VARYING CV-INDX FROM 73 BY -1 UNTIL CV-INDX = 1  12050099
120600                      OR WORK-COMMENT-LINE-74(CV-INDX:1) = SPACE  12060099
120700                      OR WORK-COMMENT-LINE-74(CV-INDX:1) = ','    12070099
120800                      OR WORK-COMMENT-LINE-74(CV-INDX:1) = '-'    12080099
120900                      OR WORK-COMMENT-LINE-74(CV-INDX:1) = ';'    12090099
121000         END-PERFORM                                              12100099
121100         ADD CV-INDX TO CL-INDX                                   12110099
121200         MOVE WORK-COMMENT-LINE-74(1:CV-INDX)                     12120099
121300                                  TO TABLE-COMMENT (TBL-INDX)     12130099
121400         MOVE SPACES TO WORK-COMMENT-LINE-74                      12140099
121500     END-IF.                                                      12150099
121600*  PROGRAM WILL ABEND IF THE REMITTANCE TABLE IS FULL.            12160099
121700     IF TABLE-COMMENT (TBL-INDX) NOT = ALL SPACES                 12170099
121800         ADD 1 TO TBL-INDX                                        12180099
121900         IF TBL-INDX = MAX-INDX                                   12190099
122000            DISPLAY 'SWITCHING TO TABLE 2 IN C630'                12200099
122100            SET USING-TABLE2 TO TRUE                              12210099
122200         END-IF                                                   12220099
122300     END-IF.                                                      12230099
122400     IF WORK-COMMENT-LINE-ALL(CL-INDX:1) = SPACE                  12240099
122500        ADD 1 TO CL-INDX                                          12250099
122600     END-IF.                                                      12260099
122700                                                                  12270099
122800     IF USING-TABLE2                                              12280099
122900        PERFORM C640-PROCESS-COMMENT2                             12290099
123000     ELSE                                                         12300099
123100        PERFORM C640-PROCESS-COMMENT1                             12310099
123200     END-IF.                                                      12320099
123300                                                                  12330099
123400*---------------------------*                                     12340099
123500 C630-PROCESS-COMMENT2.                                           12350099
123600*---------------------------*                                     12360099
123700                                                                  12370099
123800*  FILLING STATEMENT COMMENT 3                                    12380099
123900     SET COMMENT-SEGMENT-2 (TBL-INDX2) TO TRUE.                   12390099
124000     MOVE WORK-COMMENT-LINE-ALL(CL-INDX:74)                       12400099
124100                     TO WORK-COMMENT-LINE-74                      12410099
124200     IF WORK-COMMENT-LINE-74(74:1) = SPACE                        12420099
124300         ADD 74 TO CL-INDX                                        12430099
124400         MOVE WORK-COMMENT-LINE-73 TO TABLE2-COMMENT (TBL-INDX2)  12440099
124500         MOVE SPACES TO WORK-COMMENT-LINE-74                      12450099
124600     ELSE                                                         12460099
124700         PERFORM VARYING CV-INDX FROM 73 BY -1 UNTIL CV-INDX = 1  12470099
124800                      OR WORK-COMMENT-LINE-74(CV-INDX:1) = SPACE  12480099
124900                      OR WORK-COMMENT-LINE-74(CV-INDX:1) = ','    12490099
125000                      OR WORK-COMMENT-LINE-74(CV-INDX:1) = '-'    12500099
125100                      OR WORK-COMMENT-LINE-74(CV-INDX:1) = ';'    12510099
125200         END-PERFORM                                              12520099
125300         ADD CV-INDX TO CL-INDX                                   12530099
125400         MOVE WORK-COMMENT-LINE-74(1:CV-INDX)                     12540099
125500                                  TO TABLE2-COMMENT (TBL-INDX2)   12550099
125600         MOVE SPACES TO WORK-COMMENT-LINE-74                      12560099
125700     END-IF.                                                      12570099
125800*  PROGRAM WILL ABEND IF THE REMITTANCE TABLE IS FULL.            12580099
125900     IF TABLE2-COMMENT (TBL-INDX2) NOT = ALL SPACES               12590099
126000         ADD 1 TO TBL-INDX2                                       12600099
126100         IF TBL-INDX2 > MAX-INDX2                                 12610099
126200            MOVE 'C630-PROCESS-COMMENT2'                          12620099
126300                                            TO AA-PARAGRAPH-NAME  12630099
126400            MOVE 'REMITTANCE INTERNAL TABLE FULL, INCREASE TABLE' 12640099
126500                                            TO AA-MESSAGE         12650099
126600            PERFORM Z999-DB2-ABEND                                12660099
126700         END-IF                                                   12670099
126800     END-IF.                                                      12680099
126900     IF WORK-COMMENT-LINE-ALL(CL-INDX:1) = SPACE                  12690099
127000        ADD 1 TO CL-INDX                                          12700099
127100     END-IF.                                                      12710099
127200                                                                  12720099
127300     PERFORM C640-PROCESS-COMMENT2.                               12730099
127400                                                                  12740099
127500*--------------------------*                                      12750099
127600 C640-PROCESS-COMMENT1.                                           12760099
127700*--------------------------*                                      12770099
127800                                                                  12780099
127900*  FILLING STATEMENT COMMENT 4                                    12790099
128000     SET COMMENT-SEGMENT (TBL-INDX) TO TRUE.                      12800099
128100     MOVE WORK-COMMENT-LINE-ALL(CL-INDX:74)                       12810099
128200                     TO WORK-COMMENT-LINE-74                      12820099
128300     IF WORK-COMMENT-LINE-74(74:1) = SPACE                        12830099
128400         ADD 74 TO CL-INDX                                        12840099
128500         MOVE WORK-COMMENT-LINE-73 TO TABLE-COMMENT (TBL-INDX)    12850099
128600         MOVE SPACES TO WORK-COMMENT-LINE-74                      12860099
128700     ELSE                                                         12870099
128800         PERFORM VARYING CV-INDX FROM 73 BY -1 UNTIL CV-INDX = 1  12880099
128900                      OR WORK-COMMENT-LINE-74(CV-INDX:1) = SPACE  12890099
129000                      OR WORK-COMMENT-LINE-74(CV-INDX:1) = ','    12900099
129100                      OR WORK-COMMENT-LINE-74(CV-INDX:1) = '-'    12910099
129200                      OR WORK-COMMENT-LINE-74(CV-INDX:1) = ';'    12920099
129300         END-PERFORM                                              12930099
129400         ADD CV-INDX TO CL-INDX                                   12940099
129500         MOVE WORK-COMMENT-LINE-74(1:CV-INDX)                     12950099
129600                                  TO TABLE-COMMENT (TBL-INDX)     12960099
129700         MOVE SPACES TO WORK-COMMENT-LINE-74                      12970099
129800     END-IF.                                                      12980099
129900*  PROGRAM WILL ABEND IF THE REMITTANCE TABLE IS FULL.            12990099
130000     IF TABLE-COMMENT (TBL-INDX) NOT = ALL SPACES                 13000099
130100         ADD 1 TO TBL-INDX                                        13010099
130200         IF TBL-INDX = MAX-INDX                                   13020099
130300            DISPLAY 'SWITCHING TO TABLE 2 IN C640'                13030099
130400            SET USING-TABLE2 TO TRUE                              13040099
130500         END-IF                                                   13050099
130600     END-IF.                                                      13060099
130700*  SUBTRACTING ONE FROM THE TABLE INDEX SO THAT THERE IS NOT A    13070099
130800*  SPACE BETWEEN THE COMMENTS AND NEXT DOCUMENT.                  13080099
130900     IF  USING-TABLE2                                             13090099
131000         CONTINUE                                                 13100099
131100     ELSE                                                         13110099
131200         SUBTRACT 1 FROM TBL-INDX                                 13120099
131300         MOVE SPACES TO AP083-INVC-DESCR                          13130099
131400     END-IF.                                                      13140099
131500                                                                  13150099
131600*---------------------------*                                     13160099
131700 C640-PROCESS-COMMENT2.                                           13170099
131800*---------------------------*                                     13180099
131900                                                                  13190099
132000*  FILLING STATEMENT COMMENT 4                                    13200099
132100     SET COMMENT-SEGMENT-2 (TBL-INDX2) TO TRUE.                   13210099
132200     MOVE WORK-COMMENT-LINE-ALL(CL-INDX:74)                       13220099
132300                     TO WORK-COMMENT-LINE-74                      13230099
132400     IF WORK-COMMENT-LINE-74(74:1) = SPACE                        13240099
132500         ADD 74 TO CL-INDX                                        13250099
132600         MOVE WORK-COMMENT-LINE-73 TO TABLE2-COMMENT (TBL-INDX2)  13260099
132700         MOVE SPACES TO WORK-COMMENT-LINE-74                      13270099
132800     ELSE                                                         13280099
132900         PERFORM VARYING CV-INDX FROM 73 BY -1 UNTIL CV-INDX = 1  13290099
133000                      OR WORK-COMMENT-LINE-74(CV-INDX:1) = SPACE  13300099
133100                      OR WORK-COMMENT-LINE-74(CV-INDX:1) = ','    13310099
133200                      OR WORK-COMMENT-LINE-74(CV-INDX:1) = '-'    13320099
133300                      OR WORK-COMMENT-LINE-74(CV-INDX:1) = ';'    13330099
133400         END-PERFORM                                              13340099
133500         ADD CV-INDX TO CL-INDX                                   13350099
133600         MOVE WORK-COMMENT-LINE-74(1:CV-INDX)                     13360099
133700                                  TO TABLE2-COMMENT (TBL-INDX2)   13370099
133800         MOVE SPACES TO WORK-COMMENT-LINE-74                      13380099
133900     END-IF.                                                      13390099
134000*  PROGRAM WILL ABEND IF THE REMITTANCE TABLE IS FULL.            13400099
134100     IF TABLE2-COMMENT (TBL-INDX2) NOT = ALL SPACES               13410099
134200         ADD 1 TO TBL-INDX2                                       13420099
134300         IF TBL-INDX2 > MAX-INDX2                                 13430099
134400            MOVE 'C640-PROCESS-COMMENT2'                          13440099
134500                                            TO AA-PARAGRAPH-NAME  13450099
134600            MOVE 'REMITTANCE INTERNAL TABLE FULL, INCREASE TABLE' 13460099
134700                                            TO AA-MESSAGE         13470099
134800            PERFORM Z999-DB2-ABEND                                13480099
134900         END-IF                                                   13490099
135000     END-IF.                                                      13500099
135100*  SUBTRACTING ONE FROM THE TABLE INDEX SO THAT THERE IS NOT A    13510099
135200*  SPACE BETWEEN THE COMMENTS AND NEXT DOCUMENT.                  13520099
135300     SUBTRACT 1 FROM TBL-INDX2.                                   13530099
135400     MOVE SPACES TO AP083-INVC-DESCR.                             13540099
135500                                                                  13550099
135600*--------------------------------------------------------------*  13560099
135700* CREATES THE AP MEMORANDUM USING THE REMITTANCE INTERNAL TABLE*  13570099
135800*--------------------------------------------------------------*  13580099
135900 C700-PROCESS-AP-MEMORANDUMS.                                     13590099
136000                                                                  13600099
136100     IF (PAGE-CTR = PAGE-ONE) AND (REMIT-CTR = 51)                13610099
136200        ADD 1 TO PAGE-CTR                                         13620099
136300        MOVE 0 TO LINE-CTR                                        13630099
136400        MOVE 0 TO REMIT-CTR                                       13640099
136500        PERFORM W100-WRITE-HEADER-LINE                            13650099
136600     ELSE                                                         13660099
136700        IF (PAGE-CTR > PAGE-ONE) AND (REMIT-CTR = 51)             13670099
136800           ADD 1 TO PAGE-CTR                                      13680099
136900           MOVE 0 TO LINE-CTR                                     13690099
137000           MOVE 0 TO REMIT-CTR                                    13700099
137100           PERFORM W100-WRITE-HEADER-LINE                         13710099
137200        END-IF                                                    13720099
137300     END-IF.                                                      13730099
137400                                                                  13740099
137500     IF  USING-TABLE2                                             13750099
137600         IF REMIT-SEGMENT-2 (TBL-INDX2)                           13760099
137700            PERFORM F100-FORMAT-DETAIL-DATA-2                     13770099
137800            PERFORM F200-FORMAT-DETAIL-AMOUNTS-2                  13780099
137900            PERFORM W200-WRITE-REMITTANCE-LINE                    13790099
138000         END-IF                                                   13800099
138100                                                                  13810099
138200         IF COMMENT-SEGMENT-2 (TBL-INDX2)                         13820099
138300            MOVE TABLE2-COMMENT (TBL-INDX2) TO COMMENT-LINE-DESCR 13830099
138400            PERFORM W500-WRITE-COMMENT-LINE                       13840099
138500         END-IF                                                   13850099
138600                                                                  13860099
138700         IF TOTAL-SEGMENT-2 (TBL-INDX2)                           13870099
138800            PERFORM F300-FORMAT-TOTAL-LINE-2                      13880099
138900            PERFORM W300-WRITE-TOTAL-CHARGED-LINE                 13890099
139000         END-IF                                                   13900099
139100     ELSE                                                         13910099
139200         IF REMIT-SEGMENT (TBL-INDX)                              13920099
139300            PERFORM F100-FORMAT-DETAIL-DATA                       13930099
139400            PERFORM F200-FORMAT-DETAIL-AMOUNTS                    13940099
139500            PERFORM W200-WRITE-REMITTANCE-LINE                    13950099
139600         END-IF                                                   13960099
139700                                                                  13970099
139800         IF COMMENT-SEGMENT (TBL-INDX)                            13980099
139900            MOVE TABLE-COMMENT (TBL-INDX) TO COMMENT-LINE-DESCR   13990099
140000            PERFORM W500-WRITE-COMMENT-LINE                       14000099
140100         END-IF                                                   14010099
140200                                                                  14020099
140300         IF TOTAL-SEGMENT (TBL-INDX)                              14030099
140400            PERFORM F300-FORMAT-TOTAL-LINE                        14040099
140500            PERFORM W300-WRITE-TOTAL-CHARGED-LINE                 14050099
140600         END-IF                                                   14060099
140700     END-IF.                                                      14070099
140800                                                                  14080099
140900*--------------------------------------------------------------*  14090099
141000* CALCULATES THE NUMBER OF PAGES FOR EACH MEMO REMITTANCE      *  14100099
141100*--------------------------------------------------------------*  14110099
141200 D300-CALCULATE-PAGES.                                            14120099
141300                                                                  14130099
141400     MOVE ZERO TO PV-TOTAL-PAGES.                                 14140099
141500     MOVE TBL-INDX TO PV-TOTAL-ROWS.                              14150099
141600     ADD  TBL-INDX2 TO PV-TOTAL-ROWS.                             14160099
141700     IF PV-TOTAL-ROWS > 51                                        14170099
141800        COMPUTE PV-PAGES = (PV-TOTAL-ROWS - 51)                   14180099
141900        DIVIDE PV-PAGES BY 51 GIVING PV-TOTAL-PAGES               14190099
142000                              REMAINDER PV-PAGES-REMAINDER        14200099
142100        IF PV-PAGES-REMAINDER > 0                                 14210099
142200           ADD 1 TO PV-TOTAL-PAGES                                14220099
142300        END-IF                                                    14230099
142400     END-IF.                                                      14240099
142500     ADD 1 TO PV-TOTAL-PAGES.                                     14250099
142600                                                                  14260099
142700*--------------------------------------------------------------*  14270099
142800* FORMATS THE NON-AMOUNT DETAIL INFORMATION FROM THE           *  14280099
142900* REMITTANCE TABLE.                                            *  14290099
143000*--------------------------------------------------------------*  14300099
143100 F100-FORMAT-DETAIL-DATA.                                         14310099
143200                                                                  14320099
143300     MOVE TABLE-SKU-UPC-NBR(TBL-INDX) TO DETAIL-LINE-SKU-UPC-NBR. 14330099
143400     MOVE TABLE-LOC-NBR (TBL-INDX)    TO DETAIL-LINE-LOC-NBR.     14340099
143500     MOVE TABLE-PO-NBR (TBL-INDX)     TO DETAIL-LINE-PO-NBR.      14350099
143600     MOVE TABLE-INVC-NBR (TBL-INDX)   TO DETAIL-LINE-INVC-NBR.    14360099
143700     MOVE TABLE-VS-NBR (TBL-INDX)     TO DETAIL-LINE-VS-NBR.      14370099
143800     MOVE TABLE-INVC-UNITS (TBL-INDX) TO DETAIL-LINE-INVC-UNITS.  14380099
143900     MOVE TABLE-RCVD-UNITS (TBL-INDX) TO DETAIL-LINE-RCVD-UNITS.  14390099
144000                                                                  14400099
144100*---------------------------*                                     14410099
144200 F100-FORMAT-DETAIL-DATA-2.                                       14420099
144300*---------------------------*                                     14430099
144400                                                                  14440099
144500     MOVE TABLE2-SKU-UPC-NBR(TBL-INDX2)                           14450099
144600                                       TO DETAIL-LINE-SKU-UPC-NBR.14460099
144700     MOVE TABLE2-LOC-NBR (TBL-INDX2)    TO DETAIL-LINE-LOC-NBR.   14470099
144800     MOVE TABLE2-PO-NBR (TBL-INDX2)     TO DETAIL-LINE-PO-NBR.    14480099
144900     MOVE TABLE2-INVC-NBR (TBL-INDX2)   TO DETAIL-LINE-INVC-NBR.  14490099
145000     MOVE TABLE2-VS-NBR (TBL-INDX2)     TO DETAIL-LINE-VS-NBR.    14500099
145100     MOVE TABLE2-INVC-UNITS (TBL-INDX2) TO DETAIL-LINE-INVC-UNITS.14510099
145200     MOVE TABLE2-RCVD-UNITS (TBL-INDX2) TO DETAIL-LINE-RCVD-UNITS.14520099
145300                                                                  14530099
145400*--------------------------------------------------------------*  14540099
145500* FORMATS THE DETAIL AMOUNTS TO HAVE PARENTHESIS OR NOT        *  14550099
145600* DEPENDING IF THEY ARE NEGATIVE OR NOT RESPECTIVELY           *  14560099
145700*--------------------------------------------------------------*  14570099
145800 F200-FORMAT-DETAIL-AMOUNTS.                                      14580099
145900                                                                  14590099
146000*    COMPUTE VARIANCES AND ACCUMULATE FOR THE LANDED COST TOTAL   14600099
146100     IF TABLE-INVCCOST (TBL-INDX) = ZEROES                        14610099
146200        MOVE ZEROES             TO DETAIL-LINE-INVCCOST           14620099
146300        MOVE ' '                TO DETAIL-LINE-INVCCOST-RP        14630099
146400     ELSE                                                         14640099
146500        MOVE TABLE-INVCCOST (TBL-INDX) TO  DETAIL-LINE-INVCCOST   14650099
146600        IF TABLE-INVCCOST (TBL-INDX) < ZERO                       14660099
146700           INSPECT DETAIL-LINE-INVCCOST REPLACING ALL '-' BY '('  14670099
146800           MOVE ')'            TO DETAIL-LINE-INVCCOST-RP         14680099
146900        ELSE                                                      14690099
147000           MOVE ' '            TO DETAIL-LINE-INVCCOST-RP         14700099
147100        END-IF                                                    14710099
147200     END-IF.                                                      14720099
147300                                                                  14730099
147400     IF TABLE-ORDRCOST (TBL-INDX) = ZEROES                        14740099
147500        MOVE ZEROES             TO DETAIL-LINE-ORDRCOST           14750099
147600        MOVE ' '                TO DETAIL-LINE-ORDRCOST-RP        14760099
147700     ELSE                                                         14770099
147800        MOVE TABLE-ORDRCOST (TBL-INDX) TO  DETAIL-LINE-ORDRCOST   14780099
147900        IF TABLE-ORDRCOST (TBL-INDX) < ZERO                       14790099
148000           INSPECT DETAIL-LINE-ORDRCOST REPLACING ALL '-' BY '('  14800099
148100           MOVE ')'            TO DETAIL-LINE-ORDRCOST-RP         14810099
148200        ELSE                                                      14820099
148300           MOVE ' '            TO DETAIL-LINE-ORDRCOST-RP         14830099
148400        END-IF                                                    14840099
148500     END-IF.                                                      14850099
148600                                                                  14860099
148700*-------------------------------*                                 14870099
148800 F200-FORMAT-DETAIL-AMOUNTS-2.                                    14880099
148900*-------------------------------*                                 14890099
149000                                                                  14900099
149100*    COMPUTE VARIANCES AND ACCUMULATE FOR THE LANDED COST TOTAL   14910099
149200     IF TABLE2-INVCCOST (TBL-INDX2) = ZEROES                      14920099
149300         MOVE ZEROES             TO DETAIL-LINE-INVCCOST          14930099
149400         MOVE ' '                TO DETAIL-LINE-INVCCOST-RP       14940099
149500     ELSE                                                         14950099
149600         MOVE TABLE2-INVCCOST (TBL-INDX2) TO  DETAIL-LINE-INVCCOST14960099
149700         IF TABLE2-INVCCOST (TBL-INDX2) < ZERO                    14970099
149800             INSPECT DETAIL-LINE-INVCCOST                         14980099
149900               REPLACING ALL '-' BY '('                           14990099
150000             MOVE ')'            TO DETAIL-LINE-INVCCOST-RP       15000099
150100         ELSE                                                     15010099
150200             MOVE ' '            TO DETAIL-LINE-INVCCOST-RP       15020099
150300         END-IF                                                   15030099
150400     END-IF.                                                      15040099
150500                                                                  15050099
150600     IF TABLE2-ORDRCOST (TBL-INDX2) = ZEROES                      15060099
150700         MOVE ZEROES             TO DETAIL-LINE-ORDRCOST          15070099
150800         MOVE ' '                TO DETAIL-LINE-ORDRCOST-RP       15080099
150900     ELSE                                                         15090099
151000         MOVE TABLE2-ORDRCOST (TBL-INDX2) TO  DETAIL-LINE-ORDRCOST15100099
151100         IF TABLE2-ORDRCOST (TBL-INDX2) < ZERO                    15110099
151200             INSPECT DETAIL-LINE-ORDRCOST                         15120099
151300               REPLACING ALL '-' BY '('                           15130099
151400             MOVE ')'            TO DETAIL-LINE-ORDRCOST-RP       15140099
151500         ELSE                                                     15150099
151600             MOVE ' '            TO DETAIL-LINE-ORDRCOST-RP       15160099
151700         END-IF                                                   15170099
151800     END-IF.                                                      15180099
151900                                                                  15190099
152000*--------------------------------------------------------------*  15200099
152100* FORMATS THE SUB-TOTAL AMOUNTS TO HAVE PARENTHESIS OR NOT     *  15210099
152200* DEPENDING IF THEY ARE NEGATIVE OR NOT RESPECTIVELY           *  15220099
152300*--------------------------------------------------------------*  15230099
152400 F300-FORMAT-TOTAL-LINE.                                          15240099
152500                                                                  15250099
152600     IF TABLE-TOTAL-TOTCOST (TBL-INDX) = ZEROES                   15260099
152700        MOVE ZEROES             TO TOTAL-LINE-TOTCOST             15270099
152800        MOVE ' '                TO TOTAL-LINE-TOTCOST-RP          15280099
152900     ELSE                                                         15290099
153000        MOVE TABLE-TOTAL-TOTCOST (TBL-INDX) TO TOTAL-LINE-TOTCOST 15300099
153100        IF TABLE-TOTAL-TOTCOST (TBL-INDX) < ZERO                  15310099
153200            INSPECT TOTAL-LINE-TOTCOST                            15320099
153300              REPLACING ALL '-' BY '('                            15330099
153400            MOVE ')'            TO TOTAL-LINE-TOTCOST-RP          15340099
153500        ELSE                                                      15350099
153600            MOVE ' '            TO TOTAL-LINE-TOTCOST-RP          15360099
153700        END-IF                                                    15370099
153800     END-IF.                                                      15380099
153900                                                                  15390099
154000     MOVE TABLE-TOTAL-REASON (TBL-INDX) TO TOTAL-LINE-REASON.     15400099
154100                                                                  15410099
154200*-----------------------------*                                   15420099
154300 F300-FORMAT-TOTAL-LINE-2.                                        15430099
154400*-----------------------------*                                   15440099
154500                                                                  15450099
154600     IF TABLE2-TOTAL-TOTCOST (TBL-INDX2) = ZEROES                 15460099
154700        MOVE ZEROES             TO TOTAL-LINE-TOTCOST             15470099
154800        MOVE ' '                TO TOTAL-LINE-TOTCOST-RP          15480099
154900     ELSE                                                         15490099
155000        MOVE TABLE2-TOTAL-TOTCOST (TBL-INDX2)                     15500099
155100                                TO TOTAL-LINE-TOTCOST             15510099
155200        IF TABLE2-TOTAL-TOTCOST (TBL-INDX2) < ZERO                15520099
155300            INSPECT TOTAL-LINE-TOTCOST                            15530099
155400              REPLACING ALL '-' BY '('                            15540099
155500            MOVE ')'            TO TOTAL-LINE-TOTCOST-RP          15550099
155600        ELSE                                                      15560099
155700            MOVE ' '            TO TOTAL-LINE-TOTCOST-RP          15570099
155800        END-IF                                                    15580099
155900     END-IF.                                                      15590099
156000                                                                  15600099
156100     MOVE TABLE2-TOTAL-REASON (TBL-INDX2) TO TOTAL-LINE-REASON.   15610099
156200                                                                  15620099
156300*--------------------------------------------------------------*  15630099
156400* MOVES THE INFO NEEDED TO CREATE THE MEMO UPDATE RECORD       *  15640099
156500*--------------------------------------------------------------*  15650099
156600 F400-FORMAT-UPDATE-RECORD.                                       15660099
156700                                                                  15670099
156800     MOVE APT00001-VENDOR-ID     TO MEMO-VENDOR-ID.               15680099
156900     MOVE APT00001-INVOICE-ID    TO MEMO-INVOICE-ID.              15690099
157000     PERFORM W400-WRITE-UPDATE-RECORD.                            15700099
157100                                                                  15710099
157200*--------------------------------------------------------------*  15720099
157300*  READ THE INPUT FILE.                                       *   15730099
157400*--------------------------------------------------------------*  15740099
157500 R100-READ-INPUT-FILE.                                            15750099
157600                                                                  15760099
157700     READ PYMT-EXT-FILE  INTO AP083-RECORD                        15770099
157800         AT END SET INPUT-EOF TO TRUE.                            15780099
157900                                                                  15790099
158000     IF NOT INPUT-EOF                                             15800099
158100        ADD +1                TO PV-IN-COUNT                      15810099
158200     END-IF.                                                      15820099
158300                                                                  15830099
158400*--------------------------------------------------------------*  15840099
158500* RETRIEVES THE DETAIL FROM WHICH THE MEMORANDUMS WILL BE      *  15850099
158600* CREATED                                                      *  15860099
158700*--------------------------------------------------------------*  15870099
158800 S100-FETCH-MEMO-CSR.                                             15880099
158900                                                                  15890099
159000     EXEC SQL                                                     15900099
159100         FETCH MEMO_CSR                                           15910099
159200          INTO :APT00001-VENDOR-ID                                15920099
159300             , :APT00001-INVOICE-ID                               15930099
159400             , :APT00001-KC-SKU-NBR                               15940099
159500             , :APT00001-DEPTID                                   15950099
159600             , :APT00001-KC-PO-NBR                                15960099
159700             , :APT00001-KC-VS-NBR                                15970099
159800             , :APT00001-KC-INVC-QTY                              15980099
159900             , :APT00001-KC-RCVD-QTY                              15990099
160000             , :APT00001-KC-INVC-COST-AMT                         16000099
160100             , :APT00001-KC-ORD-COST-AMT                          16010099
160200             , :APT00001-KC-TOT-COST-AMT                          16020099
160300             , :APT00001-ORIGIN                                   16030099
160400             , :APT00001-KC-CRE-DTE                               16040099
160500             , :APT00001-KC-AP-MEMO-TMST                          16050099
160600             , :APT00001-UPC-ID                                   16060099
160700     END-EXEC.                                                    16070099
160800                                                                  16080099
160900     EVALUATE TRUE                                                16090099
161000        WHEN SQLCODE = ZERO                                       16100099
161100          ADD 1 TO PV-COUNT-MEMO-CSR                              16110099
161200          PERFORM F400-FORMAT-UPDATE-RECORD                       16120099
161300        WHEN SQLCODE = 100                                        16130099
161400            SET MEMO-END-OF-CSR TO TRUE                           16140099
161500        WHEN OTHER                                                16150099
161600          DISPLAY 'VENDOR ID  ' PV-VENDOR-ID                      16160099
161700          DISPLAY 'PO NUMBER  ' PV-PO-NBR                         16170099
161800          DISPLAY 'INVOICE ID ' PV-INVOICE-ID                     16180099
161900          MOVE 'S100-FETCH-MEMO-CSR'       TO AA-PARAGRAPH-NAME   16190099
162000          MOVE 'UNSUCCESSFUL FETCH'        TO AA-DB2-OPERATION    16200099
162100          MOVE 'APT_AP_MEMO'               TO AA-DB2-TABLE-1      16210099
162200          MOVE SPACES                      TO AA-DB2-TABLE-2      16220099
162300          MOVE SPACES                      TO AA-DB2-TABLE-3      16230099
162400          PERFORM Z999-DB2-ABEND                                  16240099
162500     END-EVALUATE.                                                16250099
162600*--------------------------------------------------------------*  16260099
162700* SELECTS THE ENT ID FOR THE VENDOR NUMBER BEIGN PROCESSED     *  16270099
162800*--------------------------------------------------------------*  16280099
162900 S200-SELECT-ENT-ID.                                              16290099
163000                                                                  16300099
163100     EXEC SQL                                                     16310099
163200         SELECT  A.ENT_ID                                         16320099
163300               , B.ENT_NAME_DESC                                  16330099
163400           INTO :EXTENT-ENT-ID                                    16340099
163500               ,:ENTNME-ENT-NAME-DESC                             16350099
163600           FROM  TEXTENT A                                        16360099
163700              ,  TENTNME B                                        16370099
163800          WHERE  DUN_NBR     = :PV-VENDOR-ID                      16380099
163900            AND  A.ENT_ID    = B.ENT_ID                           16390099
164000            AND  B.TYPE_CDE  = '01'                               16400099
164100     END-EXEC.                                                    16410099
164200                                                                  16420099
164300     EVALUATE TRUE                                                16430099
164400        WHEN SQLCODE = ZERO                                       16440099
164500          CONTINUE                                                16450099
164600        WHEN OTHER                                                16460099
164700          DISPLAY 'VENDOR ID  ' PV-VENDOR-ID                      16470099
164800          MOVE 'S200-SELECT-ENT-ID'   TO AA-PARAGRAPH-NAME        16480099
164900          MOVE 'UNSUCCESSFUL SELECT'  TO AA-DB2-OPERATION         16490099
165000          MOVE 'TEXTENT'              TO AA-DB2-TABLE-1           16500099
165100          MOVE 'TENTNME'              TO AA-DB2-TABLE-2           16510099
165200          MOVE SPACES                 TO AA-DB2-TABLE-3           16520099
165300          PERFORM Z999-DB2-ABEND                                  16530099
165400     END-EVALUATE.                                                16540099
165500                                                                  16550099
165600*--------------------------------------------------------------*  16560099
165700* SELECTS ADDRESS, ATTENTION TO TEXT FOR THE VENDOR NUMBER     *  16570099
165800* BEING PROCESSED                                              *  16580099
165900*--------------------------------------------------------------*  16590099
166000 S300-ADDRESS-ATTN-TO-TXT.                                        16600099
166100                                                                  16610099
166200     EXEC SQL                                                     16620099
166300         SELECT ADDRESS_LINE1_DESC                                16630099
166400               ,ADDRESS_LINE2_DESC                                16640099
166500               ,CITY_NAME                                         16650099
166600               ,STATE_CDE                                         16660099
166700               ,ZIP_CDE                                           16670099
166800               ,ATTENTION_TO_TXT                                  16680099
166900           INTO :BUSLOC-ADDRESS-LINE1-DESC                        16690099
167000               ,:BUSLOC-ADDRESS-LINE2-DESC                        16700099
167100               ,:BUSLOC-CITY-NAME                                 16710099
167200               ,:BUSLOC-STATE-CDE                                 16720099
167300               ,:BUSLOC-ZIP-CDE                                   16730099
167400               ,:BUSLOC-ATTENTION-TO-TXT                          16740099
167500           FROM TBUSLOC                                           16750099
167600          WHERE ENT_ID          = :EXTENT-ENT-ID                  16760099
167700            AND FUNCTION_ID     = 9                               16770099
167800            AND SEQ_NBR         = (SELECT MAX(SEQ_NBR)            16780099
167900                                    FROM TBUSLOC                  16790099
168000                                   WHERE ENT_ID =  :EXTENT-ENT-ID 16800099
168100                                     AND FUNCTION_ID = 9)         16810099
168200     END-EXEC.                                                    16820099
168300                                                                  16830099
168400     EVALUATE TRUE                                                16840099
168500         WHEN SQLCODE = ZERO                                      16850099
168600           CONTINUE                                               16860099
168700         WHEN OTHER                                               16870099
168800           DISPLAY 'ENT_ID'   EXTENT-ENT-ID                       16880099
168900           MOVE 'S300-ADDRESS-ATTN-TO-TXT'                        16890099
169000                                       TO AA-PARAGRAPH-NAME       16900099
169100           MOVE 'UNSUCCESSFUL SELECT'  TO AA-DB2-OPERATION        16910099
169200           MOVE 'TEXTENT'              TO AA-DB2-TABLE-1          16920099
169300           MOVE 'TENTNME'              TO AA-DB2-TABLE-2          16930099
169400           MOVE SPACES                 TO AA-DB2-TABLE-3          16940099
169500           PERFORM Z999-DB2-ABEND                                 16950099
169600     END-EVALUATE.                                                16960099
169700                                                                  16970099
169800*--------------------------------------------------------------*  16980099
169900* SELECTS THE DESCRIPTION FOR THE TRAN CODE BEING PROCESSED    *  16990099
170000*--------------------------------------------------------------*  17000099
170100 S400-SELECT-REASON-CODE.                                         17010099
170200                                                                  17020099
170300     EXEC SQL                                                     17030099
170400         SELECT TRN_SHRT_DESC                                     17040099
170500           INTO :TRNCDE-TRN-SHRT-DESC                             17050099
170600           FROM TTRNCDE                                           17060099
170700          WHERE AP_TRN_CDE =  :PV-TRAN-CODE                       17070099
170800     END-EXEC.                                                    17080099
170900                                                                  17090099
171000     EVALUATE TRUE                                                17100099
171100         WHEN SQLCODE = ZERO                                      17110099
171200           CONTINUE                                               17120099
171300         WHEN OTHER                                               17130099
171400           DISPLAY 'AP_TRN_CDE ' PV-TRAN-CODE                     17140099
171500           MOVE 'S400-SELECT-REASON-CODE'                         17150099
171600                                       TO AA-PARAGRAPH-NAME       17160099
171700           MOVE 'UNSUCCESSFUL SELECT'  TO AA-DB2-OPERATION        17170099
171800           MOVE 'TTRNCDE'              TO AA-DB2-TABLE-1          17180099
171900           MOVE SPACES                 TO AA-DB2-TABLE-2          17190099
172000           MOVE SPACES                 TO AA-DB2-TABLE-3          17200099
172100           PERFORM Z999-DB2-ABEND.                                17210099
172200                                                                  17220099
172300*--------------------------------------------------------------*  17230099
172400* WRITES THE HEADER LINES FOR THE MEMORANDUM                   *  17240099
172500*--------------------------------------------------------------*  17250099
172600 W100-WRITE-HEADER-LINE.                                          17260099
172700                                                                  17270099
172800     MOVE PAGE-CTR               TO PAGE-TO-BEGIN-NBR.            17280099
172900     MOVE PV-TOTAL-PAGES         TO PAGE-TO-END-NBR.              17290099
173000                                                                  17300099
173100     IF PAGE-CTR > PAGE-ONE                                       17310099
173200        WRITE STATEMENT-REPORT FROM BLANK-REMIT-VENDOR-LINE       17320099
173300        ADD 1 TO LINE-CTR                                         17330099
173400     END-IF.                                                      17340099
173500     WRITE STATEMENT-REPORT FROM BLANK-REMIT-VENDOR-LINE.         17350099
173600     WRITE STATEMENT-REPORT FROM PAGE-TO-LINE.                    17360099
173700     WRITE STATEMENT-REPORT FROM BLANK-REMIT-VENDOR-LINE.         17370099
173800     WRITE STATEMENT-REPORT FROM BLANK-REMIT-VENDOR-LINE.         17380099
173900     WRITE STATEMENT-REPORT FROM BLANK-REMIT-VENDOR-LINE.         17390099
174000     WRITE STATEMENT-REPORT FROM BLANK-REMIT-VENDOR-LINE.         17400099
174100                                                                  17410099
174200     IF HEADER-LINE1A-NAME = SPACES                               17420099
174300        WRITE STATEMENT-REPORT FROM HEADER-LINE1                  17430099
174400        WRITE STATEMENT-REPORT FROM HEADER-LINE2                  17440099
174500        WRITE STATEMENT-REPORT FROM HEADER-LINE3                  17450099
174600        WRITE STATEMENT-REPORT FROM BLANK-REMIT-VENDOR-LINE       17460099
174700     ELSE                                                         17470099
174800        WRITE STATEMENT-REPORT FROM HEADER-LINE1                  17480099
174900        WRITE STATEMENT-REPORT FROM HEADER-LINE1A                 17490099
175000        WRITE STATEMENT-REPORT FROM HEADER-LINE2                  17500099
175100        WRITE STATEMENT-REPORT FROM HEADER-LINE3                  17510099
175200     END-IF.                                                      17520099
175300                                                                  17530099
175400     WRITE STATEMENT-REPORT FROM BLANK-REMIT-VENDOR-LINE.         17540099
175500     WRITE STATEMENT-REPORT FROM BLANK-REMIT-VENDOR-LINE.         17550099
175600     WRITE STATEMENT-REPORT FROM HEADER-LINE4.                    17560099
175700     WRITE STATEMENT-REPORT FROM BLANK-REMIT-VENDOR-LINE.         17570099
175800     WRITE STATEMENT-REPORT FROM BLANK-REMIT-VENDOR-LINE.         17580099
175900     WRITE STATEMENT-REPORT FROM BLANK-REMIT-VENDOR-LINE.         17590099
176000     WRITE STATEMENT-REPORT FROM BLANK-REMIT-VENDOR-LINE.         17600099
176100     WRITE STATEMENT-REPORT FROM BLANK-REMIT-VENDOR-LINE.         17610099
176200     WRITE STATEMENT-REPORT FROM BLANK-REMIT-VENDOR-LINE.         17620099
176300     WRITE STATEMENT-REPORT FROM BLANK-REMIT-VENDOR-LINE.         17630099
176400     WRITE STATEMENT-REPORT FROM BLANK-REMIT-VENDOR-LINE.         17640099
176500                                                                  17650099
176600     ADD 21 TO LINE-CTR.                                          17660099
176700     ADD  1 TO PV-STATEMENTS-OUT.                                 17670099
176800                                                                  17680099
176900*--------------------------------------------------------------*  17690099
177000* WRITES THE REMITTANCE LINES                                  *  17700099
177100*--------------------------------------------------------------*  17710099
177200 W200-WRITE-REMITTANCE-LINE.                                      17720099
177300                                                                  17730099
177400     WRITE STATEMENT-REPORT FROM DETAIL-LINE.                     17740099
177500     ADD 1 TO LINE-CTR.                                           17750099
177600     ADD 1 TO REMIT-CTR.                                          17760099
177700                                                                  17770099
177800*--------------------------------------------------------------*  17780099
177900* WRITES THE TOTAL CHARGED LINE                                *  17790099
178000*--------------------------------------------------------------*  17800099
178100 W300-WRITE-TOTAL-CHARGED-LINE.                                   17810099
178200                                                                  17820099
178300     WRITE STATEMENT-REPORT FROM TOTAL-LINE.                      17830099
178400     ADD 1 TO LINE-CTR.                                           17840099
178500     ADD 1 TO REMIT-CTR.                                          17850099
178600                                                                  17860099
178700*--------------------------------------------------------------*  17870099
178800* WRITES THE MEMO UPDATE RECORD                                *  17880099
178900*--------------------------------------------------------------*  17890099
179000 W400-WRITE-UPDATE-RECORD.                                        17900099
179100                                                                  17910099
179200     WRITE MEMO-UPDATE-REC FROM MEMO-RECORD.                      17920099
179300     ADD 1 TO PV-UPDATES-OUT.                                     17930099
179400                                                                  17940099
179500*--------------------------------------------------------------*  17950099
179600* WRITES THE COMMENT LINE                                      *  17960099
179700*--------------------------------------------------------------*  17970099
179800 W500-WRITE-COMMENT-LINE.                                         17980099
179900                                                                  17990099
180000     WRITE STATEMENT-REPORT FROM COMMENT-LINE.                    18000099
180100     ADD 1 TO LINE-CTR.                                           18010099
180200     ADD 1 TO REMIT-CTR.                                          18020099
180300                                                                  18030099
180400*--------------------------------------------------------------*  18040099
180500* WRITES A BLANK LINE FOR SPACING                              *  18050099
180600*--------------------------------------------------------------*  18060099
180700 W700-WRITE-BLANK-LINE.                                           18070099
180800                                                                  18080099
180900     WRITE STATEMENT-REPORT FROM BLANK-REMIT-VENDOR-LINE.         18090099
181000     ADD 1 TO LINE-CTR.                                           18100099
181100                                                                  18110099
181200*--------------------------------------------------------------*  18120099
181300* WRITES THE AP REMITTANCE FILE                                *  18130099
181400*--------------------------------------------------------------*  18140099
181500 W800-WRITE-AP-REMITTANCE.                                        18150099
181600                                                                  18160099
181700     WRITE AP-REMITTANCE-RECORD FROM AP002-REMIT-EXTRACT-RECORD.  18170099
181800     ADD 1 TO PV-COUNT-AP-REMIT.                                  18180099
181900                                                                  18190099
182000*--------------------------------------------------------------*  18200099
182100* OPEN THE MEMO_CSR                                            *  18210099
182200*--------------------------------------------------------------*  18220099
182300 Y100-OPEN-MEMO-CSR.                                              18230099
182400                                                                  18240099
182500     EXEC SQL                                                     18250099
182600         OPEN MEMO_CSR                                            18260099
182700     END-EXEC.                                                    18270099
182800                                                                  18280099
182900     EVALUATE TRUE                                                18290099
183000        WHEN SQLCODE = ZERO                                       18300099
183100          SET CSR-OPEN  TO TRUE                                   18310099
183200        WHEN OTHER                                                18320099
183300          MOVE 'Y100-OPEN-MEMO-CSR'      TO AA-PARAGRAPH-NAME     18330099
183400          MOVE 'UNSUCCESSFUL OPEN'       TO AA-DB2-OPERATION      18340099
183500          MOVE 'APT_AP_MEMO'             TO AA-DB2-TABLE-1        18350099
183600          MOVE SPACES                    TO AA-DB2-TABLE-2        18360099
183700          MOVE SPACES                    TO AA-DB2-TABLE-3        18370099
183800          PERFORM Z999-DB2-ABEND                                  18380099
183900     END-EVALUATE.                                                18390099
184000                                                                  18400099
184100*--------------------------------------------------------------*  18410099
184200* CLOSE THE MEMO_CSR                                           *  18420099
184300*--------------------------------------------------------------*  18430099
184400 Y200-CLOSE-MEMO-CSR.                                             18440099
184500                                                                  18450099
184600     EXEC SQL                                                     18460099
184700         CLOSE MEMO_CSR                                           18470099
184800     END-EXEC.                                                    18480099
184900                                                                  18490099
185000     EVALUATE TRUE                                                18500099
185100        WHEN SQLCODE = ZERO                                       18510099
185200          SET CSR-CLOSED TO TRUE                                  18520099
185300        WHEN OTHER                                                18530099
185400          MOVE 'Y200-CLOSE-MEMO-CSR'     TO AA-PARAGRAPH-NAME     18540099
185500          MOVE 'UNSUCCESSFUL CLOSE'      TO AA-DB2-OPERATION      18550099
185600          MOVE 'APT_AP_MEMO'             TO AA-DB2-TABLE-1        18560099
185700          MOVE SPACES                    TO AA-DB2-TABLE-2        18570099
185800          MOVE SPACES                    TO AA-DB2-TABLE-3        18580099
185900          PERFORM Z999-DB2-ABEND                                  18590099
186000     END-EVALUATE.                                                18600099
186100                                                                  18610099
186200*--------------------------------------------------------------*  18620099
186300* ABEND ROUTINE                                                *  18630099
186400*--------------------------------------------------------------*  18640099
186500 Z999-DB2-ABEND.                                                  18650099
186600                                                                  18660099
186700     CLOSE PYMT-EXT-FILE                                          18670099
186800           STATEMENTS                                             18680099
186900           MEMO-UPDATE-FILE.                                      18690099
187000                                                                  18700099
187100     DISPLAY AA-ABEND-LIT.                                        18710099
187200     DISPLAY AA-PROGRAM-LIT.                                      18720099
187300     DISPLAY AA-PARAGRAPH-LIT.                                    18730099
187400     DISPLAY AA-MESSAGE-LINE.                                     18740099
187500     DISPLAY AA-DB2-ERROR-LIT.                                    18750099
187600     DISPLAY AA-DB2-OPERATION-LIT.                                18760099
187700     DISPLAY AA-DB2-TABLE-1.                                      18770099
187800     DISPLAY AA-DB2-TABLE-2.                                      18780099
187900     DISPLAY AA-DB2-TABLE-3.                                      18790099
188000                                                                  18800099
188100     CALL 'ILBOABN0' USING ABEND-CODE.                            18810099
188200                                                                  18820099
