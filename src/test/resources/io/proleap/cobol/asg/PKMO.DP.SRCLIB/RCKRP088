000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.             RCKRP088.                                00020001
000300 AUTHOR.                 DENISE HAHN.                             00030000
000400 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00040000
000500 DATE-WRITTEN.           MARCH, 2017.                             00050002
000600 DATE-COMPILED.                                                   00060000
000700                                                                  00070000
000800***************************************************************** 00080002
001600*                                                               * 00160002
001700*  CR RECEIVERS FROM PACK-TO-LIGHT FAILED STORE ADJUSTMENTS     * 00170002
001800*  DC-PO-LINE SEQUENCE                                          * 00180002
001810*                                                               * 00181002
001900*  INPUT FILE IS CREATED BY RCKUP066 - RCRD098 - LRECL 200      * 00190002
002100*                                                               * 00210002
002200***************************************************************** 00220002
002300 ENVIRONMENT DIVISION.                                            00230002
002400 CONFIGURATION SECTION.                                           00240002
002500                                                                  00250002
002600 SOURCE-COMPUTER.        IBM-3090.                                00260002
002700 OBJECT-COMPUTER.        IBM-3090.                                00270002
002800                                                                  00280002
002900***************************************************************** 00290002
003000 INPUT-OUTPUT SECTION.                                            00300002
003100                                                                  00310002
003200 FILE-CONTROL.                                                    00320002
003300                                                                  00330002
003700     SELECT INPUT-FILE                                            00370007
003800         ASSIGN TO INP01.                                         00380009
003900                                                                  00390007
004000     SELECT REPORT-FILE                                           00400002
004100         ASSIGN TO RPT01.                                         00410002
004500                                                                  00450002
004600***************************************************************** 00460002
004700 DATA DIVISION.                                                   00470002
004800***************************************************************** 00480002
004900 FILE SECTION.                                                    00490002
005000                                                                  00500002
005100 FD  INPUT-FILE                                                   00510002
005200     RECORDING MODE IS F                                          00520002
005300     LABEL RECORDS ARE STANDARD                                   00530002
005400     BLOCK CONTAINS 0 RECORDS.                                    00540002
005500 01  INPUT-RECORD                    PIC  X(200).                 00550002
005600                                                                  00560002
006300 FD  REPORT-FILE                                                  00630002
006400     RECORDING MODE IS F                                          00640002
006500     BLOCK CONTAINS 0  RECORDS.                                   00650002
006600 01  REPORT-RECORD                   PIC X(132).                  00660002
007200                                                                  00720002
007300***************************************************************** 00730002
007400 WORKING-STORAGE SECTION.                                         00740002
007500                                                                  00750002
007600 01  PROGRAM-SWITCHES.                                            00760002
007700     05  PS-END-OF-INPUT-FILE-SW     PIC X(01) VALUE 'N'.         00770002
007800         88  PS-END-OF-INPUT                   VALUE 'Y'.         00780002
007900         88  PS-NOT-END-OF-INPUT               VALUE 'N'.         00790002
008300                                                                  00830008
008400 01  PC-PROGRAM-CONSTANTS.                                        00840008
008410     05  PC-RCKRP088                 PIC X(08) VALUE              00841008
008420                                               'RCKRP088'.        00842008
008900     05  PC-REPORT-NBR               PIC X(02) VALUE '-1'.        00890008
009000     05  PC-MAX-LINE-COUNT           PIC S9(3) VALUE +60          00900008
009100                                               COMP-3.            00910008
009400     05  PC-SLASH                    PIC X(01) VALUE '/'.         00940008
009500     05  PC-DASH                     PIC X(01) VALUE '-'.         00950008
009600                                                                  00960002
010800 01  SD-DATE-TIME.                                                01080002
010900     05  SD-SYSTEM-DATE.                                          01090002
011000         10  SD-SYSTEM-DATE-YY       PIC 9(02) VALUE ZERO.        01100002
011100         10  SD-SYSTEM-DATE-MM       PIC 9(02) VALUE ZERO.        01110002
011200         10  SD-SYSTEM-DATE-DD       PIC 9(02) VALUE ZERO.        01120002
011300     05  SD-SYSTEM-TIME.                                          01130002
011400         10  SD-SYSTEM-TIME-HH       PIC 9(02) VALUE ZERO.        01140002
011500         10  SD-SYSTEM-TIME-MM       PIC 9(02) VALUE ZERO.        01150002
011600         10  SD-SYSTEM-TIME-SS       PIC 9(02) VALUE ZERO.        01160002
011700         10  FILLER                  PIC 9(02) VALUE ZERO.        01170002
011800*                                                                 01180002
011900 01  PV-PROGRAM-VARIABLES.                                        01190002
011910     05  PV-PREV-OPER                PIC  9(05).                  01191008
011920     05  PV-PREV-PO                  PIC  9(09).                  01192008
011930     05  PV-PREV-RCVR                PIC  9(04).                  01193008
011931     05  PV-SQLCODE                  PIC 9(09) VALUE ZERO.        01193108
011932     05  PV-PAGE-COUNT               PIC S9(4) VALUE ZERO         01193208
011933                                               COMP-3.            01193308
011934     05  PV-READ-COUNT                PIC S9(7) COMP-3            01193408
011935                                                VALUE ZERO.       01193508
011936     05  PV-WRITE-COUNT               PIC S9(7) COMP-3            01193608
011937                                                VALUE ZERO.       01193708
011938     05  PV-LINE-COUNT               PIC S9(3) VALUE ZERO         01193808
011939                                               COMP-3.            01193908
011940     05  PV-LINES-ON-PAGE            PIC  9(3) VALUE 60.          01194008
011941                                                                  01194109
011942     05  PV-RPT-DATE.                                             01194209
011944         10  PV-RPT-DATE-MM          PIC 9(02) VALUE ZERO.        01194409
011945         10  FILLER                  PIC X(01) VALUE '-'.         01194509
011946         10  PV-RPT-DATE-DD          PIC 9(02) VALUE ZERO.        01194609
011947         10  FILLER                  PIC X(01) VALUE '-'.         01194709
011948         10  PV-RPT-DATE-YY          PIC 9(02) VALUE ZERO.        01194809
011950                                                                  01195008
020100 01  PV-ABEND-FIELDS.                                             02010008
020200     05  PV-DB2-FUNCTION              PIC X(30) VALUE SPACES.     02020008
020300     05  PV-DB2-TABLE-NAME            PIC X(30) VALUE SPACES.     02030008
020400     05  PV-ABEND-CODE               PIC S9(4) VALUE +0           02040008
020500                                               COMP SYNC.         02050008
020600     05  PV-ABEND-PROGRAM            PIC X(08) VALUE 'RCKRP088'.  02060008
020700     05  PV-ABEND-PARAGRAPH          PIC X(50) VALUE SPACES.      02070008
020800     05  PV-ABEND-OPERATION          PIC X(50) VALUE SPACES.      02080008
020900     05  PV-ABEND-STRUCTURE-1        PIC X(08) VALUE SPACES.      02090008
022300                                                                  02230008
022400     05  PV-DISPLAY-READ-COUNT       PIC ZZZ,ZZZ,ZZ9.             02240008
022500     05  PV-DISPLAY-WRITE-COUNT      PIC ZZZ,ZZZ,ZZ9.             02250008
022510     05  PV-DISP-SQL                 PIC  -999.                   02251008
022520     05  PV-DISP-OPER                PIC  9999.                   02252008
023800                                                                  02380003
024300******************************************************************02430002
024400* RECORD LAYOUT FOR THE INPUT FILE.                               02440002
024500******************************************************************02450002
024600     COPY RCRD098.                                                02460003
024700                                                                  02470002
025300******************************************************************02530002
025400*  WORK FIELDS FOR PRINTING A 132 CHARACTER REPORT.               02540002
025500******************************************************************02550002
025600     COPY DPWS132O.                                               02560002
025700                                                                  02570002
025800 01  WS-BATCH-PROC-DATE.                                          02580002
025900     05  WS-BATCH-PROC-CC            PIC X(02) VALUE SPACES.      02590002
026000     05  WS-BATCH-PROC-YY            PIC X(02) VALUE SPACES.      02600002
026100     05  FILLER                      PIC X(01) VALUE SPACES.      02610002
026200     05  WS-BATCH-PROC-MM            PIC X(02) VALUE SPACES.      02620002
026300     05  FILLER                      PIC X(01) VALUE SPACES.      02630002
026400     05  WS-BATCH-PROC-DD            PIC X(02) VALUE SPACES.      02640002
026500*                                                                 02650002
026600 01  HEADING-LINES.                                               02660002
026700     05  HEADING-LINE1.                                           02670002
026800         10  FILLER                  PIC X(38) VALUE SPACES.      02680003
026900         10  FILLER                  PIC X(40) VALUE              02690003
027000         'PTL-CR RECEIVERS FROM FAILED POST VERIFY'.              02700003
027010         10  FILLER                  PIC X(18) VALUE              02701003
027020         ' ADJUSTMENTS BY DC'.                                    02702003
027300         10  FILLER                  PIC X(36) VALUE SPACES.      02730003
027400                                                                  02740002
027500     05  HEADING-LINE1A.                                          02750002
027600         10  FILLER                  PIC X(53) VALUE SPACES.      02760003
027700         10  FILLER                  PIC X(16) VALUE              02770003
027800         'PROCESS DATE OF '.                                      02780006
027900         10  HD1-PROCESS-DATE        PIC X(10) VALUE SPACES.      02790003
028200         10  FILLER                  PIC X(53) VALUE SPACES.      02820003
028300                                                                  02830002
028400     05  HEADING-LINE2.                                           02840002
028500         10  HD2-OPER-UNT-ID         PIC 9(04) VALUE ZEROES.      02850002
028600         10  FILLER                  PIC X(01) VALUE SPACES.      02860002
028700         10  HD2-DC-NAME             PIC X(40) VALUE SPACES.      02870002
028800         10  FILLER                  PIC X(87) VALUE SPACES.      02880002
028900                                                                  02890002
029000     05  HEADING-LINE3.                                           02900002
029100         10  FILLER            PIC X(16) VALUE SPACES.            02910003
029200         10  FILLER            PIC X(03) VALUE 'NEW'.             02920003
029300         10  FILLER            PIC X(11) VALUE SPACES.            02930010
029500         10  FILLER            PIC X(04) VALUE 'ORIG'.            02950003
029600         10  FILLER            PIC X(66) VALUE SPACES.            02960011
029700         10  FILLER            PIC X(06) VALUE 'VERIFY'.          02970003
029800         10  FILLER            PIC X(05) VALUE SPACES.            02980011
029900         10  FILLER            PIC X(03) VALUE 'ERR'.             02990003
030000         10  FILLER            PIC X(03) VALUE SPACES.            03000003
030100         10  FILLER            PIC X(10) VALUE 'ADJUSTMENT'.      03010003
030400         10  FILLER            PIC X(05) VALUE SPACES.            03040003
030500                                                                  03050002
030510     05  HEADING-LINE4.                                           03051003
030520         10  FILLER            PIC X(04) VALUE 'OPER'.            03052003
030521         10  FILLER            PIC X(06) VALUE SPACES.            03052103
030522         10  FILLER            PIC X(02) VALUE 'PO'.              03052203
030530         10  FILLER            PIC X(03) VALUE SPACES.            03053003
030540         10  FILLER            PIC X(09) VALUE 'RCVR LINE'.       03054003
030550         10  FILLER            PIC X(02) VALUE SPACES.            03055003
030560         10  FILLER            PIC X(09) VALUE 'STR RCVR '.       03056003
030570         10  FILLER            PIC X(11) VALUE 'VENDOR NAME'.     03057003
030580         10  FILLER            PIC X(15) VALUE SPACES.            03058010
030590         10  FILLER            PIC X(05) VALUE 'DEPT'.            03059003
030591         10  FILLER            PIC X(09) VALUE 'DEPT NAME'.       03059103
030592         10  FILLER            PIC X(12) VALUE SPACES.            03059210
030593         10  FILLER            PIC X(07) VALUE 'SKU NBR'.         03059303
030594         10  FILLER            PIC X(05) VALUE SPACES.            03059403
030595         10  FILLER            PIC X(08) VALUE 'QUANTITY'.        03059503
030596         10  FILLER            PIC X(04) VALUE SPACES.            03059611
030597         10  FILLER            PIC X(03) VALUE 'NBR'.             03059711
030598         10  FILLER            PIC X(03) VALUE SPACES.            03059811
030599         10  FILLER            PIC X(09) VALUE 'ERR DESCR'.       03059903
030600         10  FILLER            PIC X(08) VALUE SPACES.            03060003
034300                                                                  03430002
034400                                                                  03440002
034500 01  DETAIL-LINES.                                                03450002
034600     05  DETAIL-LINE1.                                            03460002
034700         10  DL1-DC-NBR               PIC  Z(04) VALUE ZEROES.    03470002
034800         10  FILLER                   PIC  X(01) VALUE SPACES.    03480002
034900         10  DL1-PO                   PIC  Z(09) VALUE ZEROES.    03490003
035000         10  FILLER                   PIC  X(01) VALUE SPACES.    03500002
035100         10  DL1-NEW-RCVR             PIC  Z(04) VALUE ZEROES.    03510003
035200         10  FILLER                   PIC  X(01) VALUE SPACES.    03520002
035300         10  DL1-LINE                 PIC  Z(04) VALUE ZEROES.    03530003
035400         10  FILLER                   PIC  X(01) VALUE SPACES.    03540002
035500         10  DL1-STR                  PIC  Z(04) VALUE ZEROES.    03550003
035600         10  FILLER                   PIC  X(01) VALUE SPACES.    03560003
035700         10  DL1-ORIG-RCVR            PIC  Z(04) VALUE ZEROES.    03570003
035800         10  FILLER                   PIC  X(01) VALUE SPACES.    03580003
035900         10  DL1-VENDOR-NAME          PIC  X(25) VALUE SPACES.    03590003
036000         10  FILLER                   PIC  X(01) VALUE SPACES.    03600003
036010         10  DL1-DEPT                 PIC  9(04) VALUE ZEROES.    03601003
036020         10  FILLER                   PIC  X(01) VALUE SPACES.    03602003
036030         10  DL1-DEPT-NAME            PIC  X(20) VALUE SPACES.    03603010
036040         10  FILLER                   PIC  X(01) VALUE SPACES.    03604003
036050         10  DL1-SKU                  PIC  9(08) VALUE ZEROES.    03605010
036060         10  FILLER                   PIC  X(01) VALUE SPACES.    03606003
036070         10  DL1-VERIFY-QTY           PIC  ZZZ,ZZZ,ZZZ.           03607008
036080         10  FILLER                   PIC  X(03) VALUE SPACES.    03608011
036090         10  DL1-ADJ-ERR-CDE          PIC  X(04) VALUE SPACES.    03609003
036091         10  FILLER                   PIC  X(03) VALUE SPACES.    03609111
036092         10  DL1-ADJ-ERR-DESCR        PIC  X(10) VALUE SPACES.    03609203
036093         10  FILLER                   PIC  X(06) VALUE SPACES.    03609303
036100                                                                  03610003
044300                                                                  04430002
044400 01  MISCELLANEOUS-LINES.                                         04440002
044500     05  BLANK-LINE.                                              04450002
044600         10  FILLER                  PIC X(150) VALUE SPACES.     04460002
044700                                                                  04470002
044800     05  END-OF-REPORT-LINE.                                      04480002
044900         10  FILLER                  PIC X(44) VALUE SPACES.      04490002
045000         10  FILLER                  PIC X(45) VALUE              04500002
045100             '*******   E N D   O F   R E P O R T   *******'.     04510002
045200         10  FILLER                  PIC X(43) VALUE SPACES.      04520002
045300         10  FILLER                  PIC X(18) VALUE SPACES.      04530002
045400                                                                  04540002
045500     05  NO-DATA-TO-REPORT-LINE.                                  04550002
045600         10  FILLER                  PIC X(40) VALUE SPACES.      04560002
045700         10  FILLER                  PIC  X(52)    VALUE          04570002
045800         '*******  N O   D A T A   T O   R E P O R T   *******'.  04580002
045900         10  FILLER                  PIC  X(40)    VALUE SPACES.  04590002
046000         10  FILLER                  PIC X(18) VALUE SPACES.      04600002
046100                                                                  04610002
046200                                                                  04620002
046300******************************************************************04630002
046400*  USED FOR DB2 ERROR MESSAGE BUILDING                            04640002
046500******************************************************************04650002
046600     COPY DPWS004.                                                04660002
046700                                                                  04670002
046800******************************************************************04680002
046900*   DB2 SQL COMMUNICATION AREA                                    04690002
047000******************************************************************04700002
047100     EXEC SQL                                                     04710002
047200          INCLUDE SQLCA                                           04720002
047300     END-EXEC.                                                    04730002
047400                                                                  04740002
047500*---------------------------------------------------------------* 04750002
047600*  DCLGEN FOR THE LOGISTICS LOCATION TABLE                        04760002
047700*  XLT_LOC                                                        04770002
047800*---------------------------------------------------------------* 04780002
047900     EXEC SQL                                                     04790002
048000          INCLUDE XLT00010                                        04800002
048100     END-EXEC.                                                    04810002
048200                                                                  04820002
048300*---------------------------------------------------------------* 04830002
048400*  TPURCHS                                                        04840006
048500*---------------------------------------------------------------* 04850002
048600     EXEC SQL                                                     04860002
048700          INCLUDE TPURCHS                                         04870006
048800     END-EXEC.                                                    04880002
048900                                                                  04890002
050380*---------------------------------------------------------------* 05038003
050390*  XLT_DEPT                                                       05039003
050391*---------------------------------------------------------------* 05039103
050392     EXEC SQL                                                     05039203
050393          INCLUDE XLT00002                                        05039303
050394     END-EXEC.                                                    05039403
050395                                                                  05039503
050403*---------------------------------------------------------------* 05040303
050404*  TENTNME                                                        05040403
050405*---------------------------------------------------------------* 05040503
050406     EXEC SQL                                                     05040603
050407          INCLUDE TENTNME                                         05040703
050408     END-EXEC.                                                    05040803
050409                                                                  05040903
050410******************************************************************05041002
050500 PROCEDURE DIVISION.                                              05050002
050600     DISPLAY '**** START OF RCKRP088 ****'.                       05060002
050700                                                                  05070002
050800*OPEN FILES.                                                      05080002
050900     OPEN INPUT  INPUT-FILE                                       05090002
051100          OUTPUT REPORT-FILE.                                     05110008
051300                                                                  05130002
051400     PERFORM 1000-INITIALIZATION.                                 05140002
051500                                                                  05150002
051600     SET  PS-NOT-END-OF-INPUT   TO  TRUE.                         05160002
051700                                                                  05170002
051800     PERFORM 7000-READ-EXTRACT-FILE.                              05180002
051900                                                                  05190002
052100     MOVE RC098-ORIG-OPER-UNIT  TO  PV-PREV-OPER.                 05210004
052200     MOVE RC098-ORIG-PO-NBR     TO  PV-PREV-PO.                   05220004
052210     MOVE RC098-ORIG-PO-RCVR    TO  PV-PREV-RCVR.                 05221004
052300                                                                  05230002
052400     IF PS-END-OF-INPUT                                           05240002
052500        ADD +1                  TO PV-PAGE-COUNT                  05250002
052600        MOVE PV-PAGE-COUNT      TO DP132O-PAGE-NUMBER             05260002
052700        WRITE REPORT-RECORD                                       05270002
052800          FROM DP132O-STANDRD-HEADER-132-COLS                     05280002
052900            AFTER ADVANCING PAGE                                  05290002
053000        WRITE REPORT-RECORD                                       05300002
053100          FROM HEADING-LINE1                                      05310002
053200            AFTER ADVANCING 1 LINES                               05320002
053300        WRITE REPORT-RECORD                                       05330002
053400          FROM HEADING-LINE1A                                     05340002
053500            AFTER ADVANCING 1 LINES                               05350002
053600        WRITE REPORT-RECORD                                       05360002
053700          FROM HEADING-LINE2                                      05370002
053800            AFTER ADVANCING 1 LINE                                05380002
053900        WRITE REPORT-RECORD                                       05390002
054000          FROM NO-DATA-TO-REPORT-LINE                             05400002
054100            AFTER ADVANCING 2 LINES                               05410002
054200     ELSE                                                         05420002
054210         MOVE RC098-ORIG-OPER-UNIT  TO  PV-PREV-OPER              05421008
054400         PERFORM 8500-GET-LOCATION-NAME                           05440002
054600         PERFORM 1500-PRINT-HEADINGS                              05460002
054610         PERFORM 3000-GET-VENDOR-INFO                             05461010
054620         PERFORM 3010-GET-DEPT-INFO                               05462010
054700         PERFORM 2000-PROCESS-INPUT                               05470002
054800           UNTIL PS-END-OF-INPUT                                  05480002
055500     END-IF.                                                      05550002
055600                                                                  05560002
055700*FINISH REPORT.                                                   05570002
055800                                                                  05580002
055900     WRITE REPORT-RECORD                                          05590002
056000       FROM END-OF-REPORT-LINE                                    05600002
056100         AFTER ADVANCING 3 LINES.                                 05610002
056200                                                                  05620002
056300*CLOSE FILES.                                                     05630002
056400     CLOSE INPUT-FILE                                             05640002
056600           REPORT-FILE.                                           05660004
056800                                                                  05680002
056900     MOVE PV-READ-COUNT TO PV-DISPLAY-READ-COUNT.                 05690002
057000     DISPLAY 'TOTAL INPUT READ ' PV-DISPLAY-READ-COUNT.           05700002
057100                                                                  05710002
057200     MOVE PV-WRITE-COUNT TO PV-DISPLAY-WRITE-COUNT.               05720002
057300     DISPLAY 'TOTAL RECS WRITTEN ' PV-DISPLAY-WRITE-COUNT.        05730002
057400                                                                  05740002
057500     GOBACK.                                                      05750002
057600*                                                                 05760004
057700******************************************************************05770002
057800*  PERFORM THE INITIAL PROCESSING FOR THE PROGRAM.               *05780002
057900******************************************************************05790002
058000 1000-INITIALIZATION.                                             05800004
058100     ACCEPT SD-SYSTEM-DATE                                        05810004
058200       FROM DATE.                                                 05820004
058300                                                                  05830004
058400     ACCEPT SD-SYSTEM-TIME                                        05840004
058500       FROM TIME.                                                 05850004
058600                                                                  05860004
058700     MOVE SD-SYSTEM-DATE-MM  TO DP132O-RUN-MONTH.                 05870004
058800     MOVE SD-SYSTEM-DATE-DD  TO DP132O-RUN-DAY.                   05880004
058900     MOVE SD-SYSTEM-DATE-YY  TO DP132O-RUN-YEAR.                  05890004
059000     MOVE SD-SYSTEM-TIME-HH  TO DP132O-RUN-HOUR.                  05900004
059100     MOVE SD-SYSTEM-TIME-MM  TO DP132O-RUN-MINUTE.                05910004
059101                                                                  05910109
059102     MOVE SD-SYSTEM-DATE-MM  TO PV-RPT-DATE-MM.                   05910209
059103     MOVE SD-SYSTEM-DATE-DD  TO PV-RPT-DATE-DD.                   05910309
059104     MOVE SD-SYSTEM-DATE-YY  TO PV-RPT-DATE-YY.                   05910409
059200                                                                  05920004
059300     MOVE PC-RCKRP088             TO DP132O-PROGRAM-NAME.         05930004
059400     MOVE PC-REPORT-NBR           TO DP132O-REPORT-NUMBER.        05940004
059500     MOVE +0                      TO PV-PAGE-COUNT.               05950004
059600                                                                  05960004
060300                                                                  06030004
060400******************************************************************06040002
060500**  WRITES REPORT HEADER LINES FOR FIRST PAGE AND ANY SUBSEQUENT  06050002
060600**  PAGES (AS NEEDED).                                            06060002
060700******************************************************************06070002
060800 1500-PRINT-HEADINGS.                                             06080004
060900     ADD +1                  TO PV-PAGE-COUNT.                    06090004
061000     MOVE PV-PAGE-COUNT      TO DP132O-PAGE-NUMBER.               06100004
061100                                                                  06110004
061200     MOVE PV-RPT-DATE        TO  HD1-PROCESS-DATE.                06120009
061400                                                                  06140004
061500     WRITE REPORT-RECORD                                          06150004
061600       FROM DP132O-STANDRD-HEADER-132-COLS                        06160004
061700         AFTER ADVANCING PAGE.                                    06170004
061800                                                                  06180004
061900     WRITE REPORT-RECORD                                          06190004
062000       FROM HEADING-LINE1                                         06200004
062100         AFTER ADVANCING 1 LINES.                                 06210004
062200                                                                  06220004
062300     WRITE REPORT-RECORD                                          06230004
062400       FROM HEADING-LINE1A                                        06240004
062500         AFTER ADVANCING 1 LINES.                                 06250004
062600                                                                  06260004
062700     WRITE REPORT-RECORD                                          06270004
062800       FROM HEADING-LINE2                                         06280004
062900         AFTER ADVANCING 1 LINE.                                  06290004
063000                                                                  06300004
063100     WRITE REPORT-RECORD                                          06310004
063200       FROM HEADING-LINE3                                         06320004
063300         AFTER ADVANCING 2 LINES.                                 06330004
063400                                                                  06340004
063500     WRITE REPORT-RECORD                                          06350004
063600       FROM HEADING-LINE4                                         06360004
063700         AFTER ADVANCING 1 LINES.                                 06370004
063800                                                                  06380004
063900     WRITE REPORT-RECORD                                          06390004
064000       FROM BLANK-LINE                                            06400004
064100         AFTER ADVANCING 1 LINE.                                  06410004
064200                                                                  06420004
064300     MOVE +05                TO PV-LINE-COUNT.                    06430004
064400                                                                  06440004
064500                                                                  06450004
064600******************************************************************06460002
064700**  READ INPUT-FILE, WHEN DC CHANGES, DO A PAGE BREAK             06470002
064800******************************************************************06480002
064900 2000-PROCESS-INPUT.                                              06490005
064910     IF  RC098-ORIG-OPER-UNIT  =  PV-PREV-OPER  AND               06491005
064920         RC098-ORIG-PO-NBR     =  PV-PREV-PO                      06492008
065100         CONTINUE                                                 06510005
065200     ELSE                                                         06520005
065210         PERFORM 6000-PRINT-BLANK-LINE                            06521008
065220         IF  PV-LINE-COUNT  > PV-LINES-ON-PAGE                    06522006
065230             PERFORM 1500-PRINT-HEADINGS                          06523006
065240         END-IF                                                   06524006
066200     END-IF.                                                      06620005
066300                                                                  06630005
066310     IF  RC098-ORIG-OPER-UNIT  =  PV-PREV-OPER                    06631008
066500         CONTINUE                                                 06650005
066600     ELSE                                                         06660005
066700         MOVE RC098-ORIG-OPER-UNIT  TO  PV-PREV-OPER              06670005
067100         PERFORM 8500-GET-LOCATION-NAME                           06710005
067200         PERFORM 1500-PRINT-HEADINGS                              06720005
067300     END-IF.                                                      06730006
067400                                                                  06740005
067500     IF  RC098-ORIG-PO-NBR  =  PV-PREV-PO                         06750008
067600         CONTINUE                                                 06760008
067700     ELSE                                                         06770008
068200         PERFORM 3000-GET-VENDOR-INFO                             06820006
068210         PERFORM 3010-GET-DEPT-INFO                               06821006
068211     END-IF.                                                      06821106
068212                                                                  06821206
068213     MOVE RC098-ORIG-PO-NBR     TO  PV-PREV-PO.                   06821306
068214     MOVE RC098-ORIG-PO-RCVR    TO  PV-PREV-RCVR.                 06821406
068220                                                                  06822005
068300     PERFORM 5000-WRITE-RPT-DTL.                                  06830005
068800                                                                  06880005
068900     PERFORM 7000-READ-EXTRACT-FILE.                              06890005
069000                                                                  06900005
069100                                                                  06910005
069200****************************************************************  06920002
069300* GET VENDOR NAME                                              *  06930005
069400****************************************************************  06940002
069500 3000-GET-VENDOR-INFO.                                            06950005
069600                                                                  06960005
069700     MOVE  RC098-ORIG-PO-NBR  TO PURCHS-PO-NBR.                   06970005
069800                                                                  06980005
069900     EXEC SQL                                                     06990005
070100          SELECT                                                  07010005
070300                 A.DEPT_NBR                                       07030005
070400               , B.ENT_NAME_DESC                                  07040005
070500            INTO                                                  07050005
070700                 :PURCHS-DEPT-NBR                                 07070005
070800               , :ENTNME-ENT-NAME-DESC                            07080005
070810            FROM TPURCHS A,                                       07081005
070820                 TENTNME B                                        07082005
070830           WHERE A.VER_STATUS_CDE = 'A'                           07083005
070840             AND A.PO_NBR         = :PURCHS-PO-NBR                07084005
070850             AND A.ENT_ID         = B.ENT_ID                      07085005
070860             AND B.TYPE_CDE       = '01'                          07086005
070870            WITH UR                                               07087006
070900     END-EXEC.                                                    07090005
071000                                                                  07100005
071100     EVALUATE TRUE                                                07110005
071200         WHEN SQLCODE = +0                                        07120005
071300              CONTINUE                                            07130005
071310         WHEN SQLCODE = +100                                      07131005
071320              MOVE 'UNKNOWN'  TO  ENTNME-ENT-NAME-DESC            07132005
071400         WHEN OTHER                                               07140005
071600             MOVE SQLCODE                 TO  PV-DISP-SQL         07160005
071700             DISPLAY 'RCKRP088: 3000-'                            07170005
071800                     ' SQL:'  PV-DISP-SQL                         07180005
071900                     ' RCVR:' RC098-ORIG-OPER-UNIT                07190005
071910                     '-'      RC098-ORIG-PO-NBR                   07191005
071920                     '-'      RC098-ORIG-PO-RCVR                  07192005
071930                     '-'      RC098-ORIG-PO-LNE-NBR               07193005
071940                     '-'      RC098-ORIG-STR-NBR                  07194005
072000                                                                  07200005
072100             MOVE '3000-GET-VENDOR-INFO  '                        07210005
072200                           TO PV-ABEND-PARAGRAPH                  07220005
072300             MOVE 'GET VENDOR NAME'   TO PV-DB2-FUNCTION          07230005
072400             MOVE 'TENTNME '          TO PV-DB2-TABLE-NAME        07240005
072500             PERFORM 9900-DB2-ABEND                               07250005
072600     END-EVALUATE.                                                07260005
072700                                                                  07270005
072800                                                                  07280005
072900****************************************************************  07290002
073000* GET DEPT NAME                                                *  07300006
073100****************************************************************  07310002
073200 3010-GET-DEPT-INFO.                                              07320008
073300                                                                  07330006
073310     MOVE  PURCHS-DEPT-NBR  TO  XLT00002-DEPT-NBR                 07331006
073320                                                                  07332006
073330     EXEC SQL                                                     07333006
073340          SELECT                                                  07334006
073350                 DEPT_NM                                          07335006
073370            INTO                                                  07337006
073380                 :XLT00002-DEPT-NM                                07338006
073391            FROM XLT_DEPT                                         07339106
073393           WHERE DEPT_NBR         = :XLT00002-DEPT-NBR            07339306
073394            WITH UR                                               07339406
073397     END-EXEC.                                                    07339706
073398                                                                  07339806
074300     EVALUATE TRUE                                                07430006
074400         WHEN SQLCODE = +0                                        07440006
074500              CONTINUE                                            07450006
074600         WHEN SQLCODE = +100                                      07460006
074700              MOVE 'UNKNOWN'  TO  XLT00002-DEPT-NM                07470008
074800         WHEN OTHER                                               07480006
074810             MOVE SQLCODE                 TO  PV-DISP-SQL         07481006
074820             DISPLAY 'RCKRP088: 3010-'                            07482006
074830                     ' SQL:'  PV-DISP-SQL                         07483006
074840                     ' RCVR:' RC098-ORIG-OPER-UNIT                07484006
074850                     '-'      RC098-ORIG-PO-NBR                   07485006
074860                     '-'      RC098-ORIG-PO-RCVR                  07486006
074870                     '-'      RC098-ORIG-PO-LNE-NBR               07487006
074880                     '-'      RC098-ORIG-STR-NBR                  07488006
074890                                                                  07489006
074891             MOVE '3010-GET-DEPT-INFO    '                        07489106
074892                           TO PV-ABEND-PARAGRAPH                  07489206
074893             MOVE 'GET DEPT NAME'     TO PV-DB2-FUNCTION          07489306
074894             MOVE 'XLT_DEPT'          TO PV-DB2-TABLE-NAME        07489406
074895             PERFORM 9900-DB2-ABEND                               07489506
076000     END-EVALUATE.                                                07600006
076100                                                                  07610006
076200                                                                  07620006
089500****************************************************************  08950002
089600* MOVE THE DETAILS TO REPORT LINE.                             *  08960002
089700****************************************************************  08970002
089800 5000-WRITE-RPT-DTL.                                              08980005
089900                                                                  08990005
090010     MOVE RC098-ORIG-OPER-UNIT      TO DL1-DC-NBR                 09001005
090100     MOVE RC098-ORIG-PO-NBR         TO DL1-PO                     09010005
090200     MOVE RC098-NEW-PO-RCVR         TO DL1-NEW-RCVR               09020005
090300     MOVE RC098-ORIG-PO-LNE-NBR     TO DL1-LINE                   09030005
090400     MOVE RC098-ORIG-STR-NBR        TO DL1-STR                    09040005
090500     MOVE RC098-ORIG-PO-RCVR        TO DL1-ORIG-RCVR              09050005
090600     MOVE ENTNME-ENT-NAME-DESC      TO DL1-VENDOR-NAME            09060005
090800     MOVE XLT00002-DEPT-NBR         TO DL1-DEPT                   09080006
090900     MOVE XLT00002-DEPT-NM          TO DL1-DEPT-NAME              09090006
091100     MOVE RC098-SKU-NBR             TO DL1-SKU                    09110005
091200     MOVE RC098-TO-VERIFY-QTY       TO DL1-VERIFY-QTY             09120005
091400     MOVE RC098-FINCL-ADJ-ERR-CDE   TO DL1-ADJ-ERR-CDE            09140005
091500     MOVE RC098-ADJ-ERR-DESC        TO DL1-ADJ-ERR-DESCR          09150005
091600                                                                  09160005
094600     WRITE REPORT-RECORD                                          09460006
094700      FROM DETAIL-LINE1                                           09470006
094800     AFTER ADVANCING 1 LINES.                                     09480006
094900                                                                  09490006
095000     ADD  1                  TO PV-LINE-COUNT.                    09500006
095100     IF  PV-LINE-COUNT  > PV-LINES-ON-PAGE                        09510006
095200         PERFORM 1500-PRINT-HEADINGS                              09520006
095300     END-IF.                                                      09530006
095400                                                                  09540006
095500                                                                  09550006
114200****************************************************************  11420002
114300* PRINTS A BLANK LINE                                          *  11430002
114400****************************************************************  11440002
114500 6000-PRINT-BLANK-LINE.                                           11450005
114600                                                                  11460005
114700        WRITE REPORT-RECORD                                       11470005
114800          FROM BLANK-LINE                                         11480005
114900            AFTER ADVANCING 1 LINE                                11490005
115000                                                                  11500005
115100     ADD +1 TO PV-LINE-COUNT.                                     11510005
115200                                                                  11520005
115300******************************************************************11530002
115400*  READ A FROM THE INPUT FILE                                    *11540008
115500******************************************************************11550002
115600 7000-READ-EXTRACT-FILE.                                          11560008
115700     READ INPUT-FILE                                              11570008
115800          INTO RC098-ITEM-REC                                     11580008
115900         AT END                                                   11590008
116000             SET PS-END-OF-INPUT TO TRUE                          11600008
116100         NOT AT END                                               11610008
116200             ADD +1 TO PV-READ-COUNT                              11620008
116300     END-READ.                                                    11630008
116400                                                                  11640008
118500******************************************************************11850008
118600*                                                                *11860008
119500******************************************************************11950002
119600 8500-GET-LOCATION-NAME.                                          11960008
119800                                                                  11980008
119900     MOVE PV-PREV-OPER         TO  XLT00010-LOC-NBR               11990008
120000                                   PV-DISP-OPER.                  12000008
120100                                                                  12010008
120200     EXEC SQL                                                     12020008
120300         SELECT   LOC_NM                                          12030008
120400           INTO  :XLT00010-LOC-NM                                 12040008
120500           FROM   XLT_LOC                                         12050008
120600          WHERE   LOC_NBR  =  :XLT00010-LOC-NBR                   12060008
120700     END-EXEC.                                                    12070008
120800                                                                  12080008
120900     EVALUATE TRUE                                                12090008
121000         WHEN SQLCODE = +0                                        12100008
121100              MOVE PV-PREV-OPER        TO HD2-OPER-UNT-ID         12110008
121200              MOVE XLT00010-LOC-NM     TO HD2-DC-NAME             12120008
121300         WHEN OTHER                                               12130008
121400              CONTINUE                                            12140008
121500     END-EVALUATE.                                                12150008
121600                                                                  12160008
121700                                                                  12170008
123600******************************************************************12360002
123700*  ABEND ROUTINE                                                 *12370002
123800******************************************************************12380002
123900 9900-DB2-ABEND.                                                  12390008
124000                                                                  12400008
124100     MOVE SQLCODE TO PV-SQLCODE.                                  12410008
124200     DISPLAY '*** DB2 ERROR '.                                    12420008
124300     DISPLAY '*** SQLCODE   = ' PV-SQLCODE.                       12430008
124400     DISPLAY '*** PROGRAM   = ' PV-ABEND-PROGRAM.                 12440008
124500     DISPLAY '*** PARAGRAPH = ' PV-ABEND-PARAGRAPH.               12450008
124600     DISPLAY '*** OPERATION = ' PV-ABEND-OPERATION.               12460008
124700     DISPLAY '*** FUNCTION  = ' PV-DB2-FUNCTION.                  12470008
124800     DISPLAY '*** TABLE 1   = ' PV-DB2-TABLE-NAME.                12480008
124900                                                                  12490008
125000     COPY DPPD004.                                                12500008
125100                                                                  12510008
125200     MOVE +4013 TO PV-ABEND-CODE.                                 12520008
125300     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         12530008
125400                                                                  12540008
125500 9998-ABEND.                                                      12550008
125600                                                                  12560008
125700     DISPLAY '***************'.                                   12570008
125800     DISPLAY '** ABEND     **'.                                   12580008
125900     DISPLAY '** PROGRAM   ** = ' PV-ABEND-PROGRAM.               12590008
126000     DISPLAY '** PARAGRAPH ** = ' PV-ABEND-PARAGRAPH.             12600008
126100     DISPLAY '***************'.                                   12610008
126200                                                                  12620008
126300     MOVE +4008                  TO PV-ABEND-CODE.                12630008
126400     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         12640008
126500                                                                  12650008
126600 9999-ABEND.                                                      12660008
126700                                                                  12670008
126800     DISPLAY '***************'.                                   12680008
126900     DISPLAY '** ABEND     **'.                                   12690008
127000     DISPLAY '** PROGRAM   ** = ' PV-ABEND-PROGRAM.               12700008
127100     DISPLAY '** PARAGRAPH ** = ' PV-ABEND-PARAGRAPH.             12710008
127200     DISPLAY '***************'.                                   12720008
127300                                                                  12730008
127400     MOVE +4008                  TO PV-ABEND-CODE.                12740008
127500     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         12750008
127600                                                                  12760008
127700******************************************************************12770002
127800*                 E N D   O F   P R O G R A M                    *12780002
127900******************************************************************12790002
