000100*-----------------------*                                         00010051
000200 IDENTIFICATION DIVISION.                                         00020051
000300*-----------------------*                                         00030051
000400 PROGRAM-ID.    CEKCS600.                                         00040051
000500 AUTHOR.        DENISE HAHN.                                      00050051
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060051
000700 DATE-WRITTEN.  11-24-99.                                         00070051
000800 DATE-COMPILED.                                                   00080051
000900*----------------------------------------------------------------*00090051
001000*    S600 - CENTRAL STOCK INTERFACE - CRITERIA SPECIFICATION     *00100051
001100*                                                                *00110051
001200*----------------------------------------------------------------*00120051
001210* 04/28/2010 - DJK - CHANGES MADE FOR EFC2 WR 38216              *00130051
001220* 06/30/2010 - CLT - IMPORT REPLEN WR#38786 CHRISTINE TWIEHAUS *  00140051
001230*----------------------------------------------------------------*00150051
263455* CHANGED 10/29/2021    BY JIM HUNTER      WR: CHG0263455         00160052
263455* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00170052
263455* MAKING THE CALL DYNAMIC VS STATIC.                              00180052
263455*----------------------------------------------------------------*00190052
CICS  * CHANGED 10/19/2022    BY JIM HUNTER      WR: CHG0276924         00191054
CICS  * ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL        00195053
CICS  * DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.       00196053
CICS  *-----------------------------------------------------------------00197053
001240                                                                  00200051
001250                                                                  00210051
001260                                                                  00220051
001270 ENVIRONMENT DIVISION.                                            00230051
001280                                                                  00240051
001290                                                                  00250051
001300 DATA DIVISION.                                                   00260051
001400                                                                  00270051
001500                                                                  00280051
001600 WORKING-STORAGE SECTION.                                         00290051
001700                                                                  00300051
001800                                                                  00310051
001900*----------------------------------------------------------------*00320051
002000*   PROGRAM CONSTANTS                                            *00330051
002100*----------------------------------------------------------------*00340051
002200 01  PC-PROGRAM-CONSTANTS.                                        00350051
002300     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE 'CE600A  '.  00360051
002400     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE 'CEKM600 '.  00370051
002500     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE 'CEKCS600'.  00380051
002600     05  PC-PRINT-PROGRAM          PIC  X(08)  VALUE 'CEKCS609'.  00390051
002700     05  PC-CONFIRM-MODULE         PIC  X(08)  VALUE 'CEKCS610'.  00400051
002800     05  PC-OP-CO-NBR              PIC  X(02)  VALUE '03'.        00410051
002900     05  PC-000                    PIC  X(03)  VALUE '000'.       00420051
003000     05  PC-RDM                    PIC  X(03)  VALUE 'RDM'.       00430051
003100     05  PC-AC                     PIC  X(02)  VALUE 'AC'.        00440051
003200     05  PC-Y                      PIC  X(25)  VALUE              00450051
003300                                     'Y                        '. 00460051
003400     05  PC-FCLTY-ID-0001          PIC  9(04)  VALUE  0001.       00470051
003500     05  PC-CORPORATE-OFFICE       PIC S9(04)  VALUE 090.         00480051
003600     05  PC-MENO-FALLS-DC          PIC  9(04)  VALUE  0085.       00490051
003700     05  PC-01                     PIC  X(02)  VALUE '01'.        00500051
003800     05  PC-CS                     PIC  X(02)  VALUE 'CS'.        00510051
003900     05  PC-DS                     PIC  X(02)  VALUE 'DS'.        00520051
004000     05  PC-REPORT-PGM-1           PIC  X(08)  VALUE 'CEKCS609'.  00530051
004100     05  PC-PRTR-VALIDATION-PGM    PIC  X(08)  VALUE 'DPKCS060'.  00540051
004200     05  PC-CALENDAR-MODULE        PIC  X(08)  VALUE 'DPKUT500'.  00550051
004300     05  PC-ALL                    PIC  X(04)  VALUE 'ALL '.      00560051
004400     05  PC-DFLT-FROM-MONTH        PIC  9(02)  VALUE 01.          00570051
004500     05  PC-DFLT-FROM-DAY          PIC  9(02)  VALUE 01.          00580051
004600*    05  PC-DFLT-FROM-YEAR         PIC  9(04)  VALUE 1999.        00590051
004700     05  PC-DFLT-TO-MONTH          PIC  9(02)  VALUE 12.          00600051
004800     05  PC-DFLT-TO-DAY            PIC  9(02)  VALUE 31.          00610051
004900     05  PC-DFLT-TO-YEAR           PIC  9(04)  VALUE 2099.        00620051
005000     05  PC-A                      PIC  X(01)  VALUE 'A'.         00630051
005100     05  PC-P                      PIC  X(01)  VALUE 'P'.         00640051
005200     05  PC-Z                      PIC  X(01)  VALUE 'Z'.         00650051
005300                                                                  00660051
005400     05  PC-DESC-CANCELLED         PIC  X(10)  VALUE 'CANCELLED '.00670051
005500     05  PC-DESC-DISTRIBUTED       PIC  X(10)  VALUE 'DISTRIBUTD'.00680051
005600     05  PC-DESC-IN-PROCESS        PIC  X(10)  VALUE 'IN PROCESS'.00690051
005700     05  PC-DESC-NEW               PIC  X(10)  VALUE 'NEW       '.00700051
005800     05  PC-DESC-POSTED            PIC  X(10)  VALUE 'POSTED    '.00710051
005900     05  PC-OPERCO-NBR             PIC  X(02)  VALUE '03'.        00720051
006000     05  PC-DPT                    PIC  X(03)  VALUE 'DPT'.       00730051
006100                                                                  00740051
006200                                                                  00750051
006300*-----------------------------------------------------------------00760051
006400*  DB2 KEYS                                                       00770051
006500*-----------------------------------------------------------------00780051
006600 01  DK-DB2-KEYS.                                                 00790051
006700                                                                  00800051
006800     05  DK-CURR-OPER-UNT-ID            PIC S9(04)  COMP VALUE +0.00810051
006900     05  DK-CURR-FCLTY-ID               PIC S9(04)  COMP VALUE +0.00820051
007000     05  DK-OPER-UNT-ID                 PIC S9(04)  COMP VALUE +0.00830051
007100     05  DK-OPER-UNT-ID-DISPLAY.                                  00840051
007200         10  FILLER                     PIC  X(01)  VALUE SPACES. 00850051
007300         10  DK-OPER-UNT-ID-3           PIC  X(03)  VALUE SPACES. 00860051
007400     05  DK-PULL-NUMBER                 PIC S9(09)  COMP VALUE +0.00870051
007500     05  DK-LINE-NUMBER                 PIC S9(04)  COMP VALUE +0.00880051
007600* CLT 07/01/2010 START WR#38786                                   00890051
007700     05  DK-DEPT-NUMBER                 PIC  X(03)  VALUE SPACES. 00900051
007800     05  DK-DEPT-NUMBER-PACKED          PIC  S9(4)V COMP-3.       00910051
007900     05  DK-MAJ-CLASS                   PIC  X(02)  VALUE SPACES. 00920051
008000     05  DK-MAJ-CLASS-PACKED            PIC  S9(4)V COMP-3.       00930051
008100     05  DK-SUB-CLASS                   PIC  X(02)  VALUE SPACES. 00940051
008200     05  DK-SUB-CLASS-PACKED            PIC  S9(4)V COMP-3.       00950051
008210* CLT 07/01/2010 END                                              00960051
008220     05  DK-REF-NUMBER                  PIC  X(15)  VALUE SPACES. 00970051
008230     05  DK-STORE-NUMBER                PIC  X(04)  VALUE SPACES. 00980051
008240     05  DK-STORE-NUMBER-R REDEFINES DK-STORE-NUMBER.             00990051
008250         10  FILLER                     PIC  X(01).               01000051
008260         10  DK-STORE-NUMBER-3POS       PIC  X(03).               01010051
008270     05  DK-DUMMY-FIELD              PIC  S9(1)V VALUE ZEROES     01020051
008280                                                 COMP-3.          01030051
008290                                                                  01040051
008300                                                                  01050051
008400*----------------------------------------------------------------*01060051
008500*  SYSTEM MESSAGES                                               *01070051
008600*----------------------------------------------------------------*01080051
008700*   00005 = INVALID VALUE                                         01090051
008800*   00007 = REQUIRED ENTRY                                        01100051
008900*   00008 = MUST BE NUMERIC                                       01110051
009000*   00009 = INVALID DATE                                          01120051
009100*   00032 = DEPARTMENT DOES NOT EXIST                             01130051
009200*   00045 = INVALID FUNCTION KEY                                  01140051
009300*   00746 = INVALID PRINTER DESTINATION                           01150051
009400*   01563 = PRINTER ID MUST BE ENTERED FOR THIS SELECTION         01160051
009500*   02214 = PULL NUMBER NOT FOUND                                 01170051
009600*   02215 = REFERENCE NUMBER NOT FOUND                            01180051
009700*   02216 = PULL NUMBER/REFERENCE NUMBER NOT FOUND                01190051
009800*   02217 = MULT PULL #'S FOR REQUESTED REFERENCE NUMBER          01200051
009900*   02219 = INVALID CENTRAL STOCK LOCATION                        01210051
010000*   02220 = PULL NUMBER OR REFERENCE NUMBER REQUIRED FOR SELECTION01220051
010100*   02221 = CREATE FROM DATE MUST BE BEFORE CREATE TO DATE        01230051
010200*   02224 = CANNOT CONFIRM/UNCONFIRM DISTRO-PULL POSTED           01240051
010300*   02225 = CANNOT CONFIRM/UNCONFIRM DISTRO-PULL CANCELLED        01250051
010400*   02226 = CANNOT PRINT PULL - PULL STATUS IS CANCELLED          01260051
010500*   02227 = APPLICATION UNAVAILABLE AT THIS TIME                  01270051
010600*   02234 = PRINT REQUEST HAS BEEN COMPLETED FOR SELECTED LIME(S)*01280051
010700*   02235 = PRINT REQUEST HAS BEEN COMPLETED                      01290051
010800*   02238 = PRINT PROBLEM, TRY AGAIN - LINES UP TO THIS POINT    *01300051
010900*   02254 - CANCEL  PULL - PRESS F2 TO CONFIRM                    01310051
011000*   02255 - UNCANCEL PULL - PRESS F2 TO CONFIRM                   01320051
011100*   02256 - CANCEL LINE ITEM - PRESS F2 TO CONFIRM                01330051
011200*   02257 - UNCANCEL LINE ITEM - PRESS F2 TO CONFIRM              01340051
011300*   02258 - HAVE STORE UNITS BEEN ADJUSTED?  F2 TO CONFIRM PULL DI01350051
011400*   02259 - UNCONFIRM PULL DISTRIBUTION - PRESS F2 TO CONFIRM     01360051
011500*   02260 - HAVE STORE UNITS BEEN ADJUSTED?  F2 TO CONFIRM LINE IT01370051
011600*   02261 - UNCONFIRM LINE ITEM DISTRIBUTION - PRESS F2 TO CONFIRM01380051
011700*   02262 - CONFIRM PULL - PRESS F2 TO CONFIRM                    01390051
011800*   02263 - UNCONFIRM PULL - PRESS F2 TO CONFIRM                  01400051
011900*   02264 - CONFIRM LINE ITEM - PRESS F2 TO CONFIRM               01410051
012000*   02265 - UNCONFIRM LINE ITEM - PRESS F2 TO CONFIRM             01420051
012100*   02266 - ALL SELECTED ITEMS MUST HAVE THE SAME STATUS          01430051
012200*   02267 - CANNOT CANCEL/UNCANCEL - PULL ALREADY POSTED/DISTRIBTD01440051
012300*   02268 - CANNOT CNCL/UNCNCL-LINE(S) POSTED,DISTRBTD, WORKED RDM01450051
012400*   02269 - (UN)CANCEL PULL REQUEST FAILED                        01460051
012500*   02270 - (UN)CONFIRM PULL DISTRIBUTION REQUEST FAILED          01470051
012600*   02271 - (UN)CONFIRM PULL REQUEST FAILED                       01480051
012700*   02272 - CANNOT CONFIRM DISTRIBUTION - PULL STATUS IS DISTRIBTD01490051
012800*   02273 - CANNOT UNCONFIRM DISTRIBUTION - PULL STATUS NOT DISTRB01500051
012900*   02274 - (UN)CANCEL PULL REQUEST SUCCESSFUL                    01510051
013000*   02275 - (UN)CONFIRM PULL DISTRIBUTION REQUEST SUCCESSFUL      01520051
013100*   02276 - (UN)CONFIRM PULL REQUEST SUCCESSFUL                   01530051
013200*   02287 - CONFIRM DISTRIBUTION FAILED - NO LINE(S) FOR PULL     01540051
013300*   02288 - CONFIRM DISTRIBUTION FAILED - LINE(S) MISSING DISTRB  01550051
013400*   02300 - PRINT REQUEST FAILED - PULL STATUS IS CANCELLED       01560051
013500*   02306 - YOU DO NOT HAVE AUTHORITY TO PRINT                    01570051
013600*   02307 - YOU DO NOT HAVE AUTHORITY TO CANCEL/UNCANCEL          01580051
013700*   02308 - YOU DO NOT HAVE AUTHORITY TO CONFIRM/UNCONFIRM DISTRIB01590051
013800*   02317 - CANNOT CONFIRM/UNCONFIRM DISTRO - PULL STATUS NEW     01600051
013900*   02322 - MULTIPLE LINE ITEMS EXIST - F2 TO CONFIRM PULL DISTRIB01610051
014000*   02323 - PRINT REQUEST FAILED - PULL STATUS IS POSTED OR DISTRI01620051
014100*   02354 - CANNOT CONFIRM DISTRIBUTION - NOT ALL LINES ARE IN PRO01630051
014200*   02327 - YOU DO NOT HAVE AUTHORITY TO CREATE NEW PULL REQUESTS 01640051
014300*   02495 - F KEY FUNCTION CANNOT BE USED-PULL REQUEST MAINTAINED 01650051
014400*   02516 - DC REQUESTING ACCESS NOT CURRENTLY USING THE RDM APPL 01660051
014500*   02677 - COMMUNICATION ERROR - CANNOT ACCESS WEB INVENTORY     01670051
014600*   02879 - CANNOT UN-CANCEL PULL - MUST USE THE LINE LIST SCREEN 01680051
014700*           TO UN-CANCEL                                          01690051
014800*   02880 - NO AUTHORITY TO CANCEL PULL SENT TO RDM - CENTRAL STK 01700051
014900*           SITE MUST CANCEL                                      01710051
015000*                                                                 01720051
015100*----------------------------------------------------------------*01730051
015200 01  PC-TSYMSG-NUMBERS.                                           01740051
015300     05  PC-TSYMSG-00001       PIC  9(05)  VALUE  00001.          01750051
015400     05  PC-TSYMSG-00005       PIC  9(05)  VALUE  00005.          01760051
015500     05  PC-TSYMSG-00007       PIC  9(05)  VALUE  00007.          01770051
015600     05  PC-TSYMSG-00008       PIC  9(05)  VALUE  00008.          01780051
015700     05  PC-TSYMSG-00009       PIC  9(05)  VALUE  00009.          01790051
015800     05  PC-TSYMSG-00032       PIC  9(05)  VALUE  00032.          01800051
015900     05  PC-TSYMSG-00045       PIC  9(05)  VALUE  00045.          01810051
016000     05  PC-TSYMSG-00746       PIC  9(05)  VALUE  00746.          01820051
016100     05  PC-TSYMSG-01563       PIC  9(05)  VALUE  01563.          01830051
016200     05  PC-TSYMSG-02214       PIC  9(05)  VALUE  02214.          01840051
016300     05  PC-TSYMSG-02215       PIC  9(05)  VALUE  02215.          01850051
016400     05  PC-TSYMSG-02216       PIC  9(05)  VALUE  02216.          01860051
016500     05  PC-TSYMSG-02217       PIC  9(05)  VALUE  02217.          01870051
016600     05  PC-TSYMSG-02219       PIC  9(05)  VALUE  02219.          01880051
016700     05  PC-TSYMSG-02220       PIC  9(05)  VALUE  02220.          01890051
016800     05  PC-TSYMSG-02221       PIC  9(05)  VALUE  02221.          01900051
016900     05  PC-TSYMSG-02224       PIC  9(05)  VALUE  02224.          01910051
017000     05  PC-TSYMSG-02225       PIC  9(05)  VALUE  02225.          01920051
017100     05  PC-TSYMSG-02226       PIC  9(05)  VALUE  02226.          01930051
017200     05  PC-TSYMSG-02227       PIC  9(05)  VALUE  02227.          01940051
017300     05  PC-TSYMSG-02234       PIC  9(05)  VALUE  02234.          01950051
017400     05  PC-TSYMSG-02235       PIC  9(05)  VALUE  02235.          01960051
017500     05  PC-TSYMSG-02238       PIC  9(05)  VALUE  02238.          01970051
017600     05  PC-TSYMSG-02254       PIC  9(05)  VALUE  02254.          01980051
017700     05  PC-TSYMSG-02255       PIC  9(05)  VALUE  02255.          01990051
017800     05  PC-TSYMSG-02256       PIC  9(05)  VALUE  02256.          02000051
017900     05  PC-TSYMSG-02257       PIC  9(05)  VALUE  02257.          02010051
018000     05  PC-TSYMSG-02258       PIC  9(05)  VALUE  02258.          02020051
018100     05  PC-TSYMSG-02259       PIC  9(05)  VALUE  02259.          02030051
018200     05  PC-TSYMSG-02260       PIC  9(05)  VALUE  02260.          02040051
018300     05  PC-TSYMSG-02261       PIC  9(05)  VALUE  02261.          02050051
018400     05  PC-TSYMSG-02262       PIC  9(05)  VALUE  02262.          02060051
018500     05  PC-TSYMSG-02263       PIC  9(05)  VALUE  02263.          02070051
018600     05  PC-TSYMSG-02264       PIC  9(05)  VALUE  02264.          02080051
018700     05  PC-TSYMSG-02265       PIC  9(05)  VALUE  02265.          02090051
018800     05  PC-TSYMSG-02266       PIC  9(05)  VALUE  02266.          02100051
018900     05  PC-TSYMSG-02267       PIC  9(05)  VALUE  02267.          02110051
019000     05  PC-TSYMSG-02268       PIC  9(05)  VALUE  02268.          02120051
019100     05  PC-TSYMSG-02269       PIC  9(05)  VALUE  02269.          02130051
019200     05  PC-TSYMSG-02270       PIC  9(05)  VALUE  02270.          02140051
019300     05  PC-TSYMSG-02271       PIC  9(05)  VALUE  02271.          02150051
019400     05  PC-TSYMSG-02272       PIC  9(05)  VALUE  02272.          02160051
019500     05  PC-TSYMSG-02273       PIC  9(05)  VALUE  02273.          02170051
019600     05  PC-TSYMSG-02274       PIC  9(05)  VALUE  02274.          02180051
019700     05  PC-TSYMSG-02275       PIC  9(05)  VALUE  02275.          02190051
019800     05  PC-TSYMSG-02276       PIC  9(05)  VALUE  02276.          02200051
019900     05  PC-TSYMSG-02287       PIC  9(05)  VALUE  02287.          02210051
020000     05  PC-TSYMSG-02288       PIC  9(05)  VALUE  02288.          02220051
020100     05  PC-TSYMSG-02300       PIC  9(05)  VALUE  02300.          02230051
020200     05  PC-TSYMSG-02306       PIC  9(05)  VALUE  02306.          02240051
020300     05  PC-TSYMSG-02307       PIC  9(05)  VALUE  02307.          02250051
020400     05  PC-TSYMSG-02308       PIC  9(05)  VALUE  02308.          02260051
020500     05  PC-TSYMSG-02317       PIC  9(05)  VALUE  02317.          02270051
020600     05  PC-TSYMSG-02322       PIC  9(05)  VALUE  02322.          02280051
020700     05  PC-TSYMSG-02323       PIC  9(05)  VALUE  02323.          02290051
020800     05  PC-TSYMSG-02327       PIC  9(05)  VALUE  02327.          02300051
020900     05  PC-TSYMSG-02354       PIC  9(05)  VALUE  02354.          02310051
021000     05  PC-TSYMSG-02495       PIC  9(05)  VALUE  02495.          02320051
021100     05  PC-TSYMSG-02516       PIC  9(05)  VALUE  02516.          02330051
021200     05  PC-TSYMSG-02677       PIC  9(05)  VALUE  02677.          02340051
021300     05  PC-TSYMSG-02879       PIC  9(05)  VALUE  02879.          02350051
021400     05  PC-TSYMSG-02880       PIC  9(05)  VALUE  02880.          02360051
021500                                                                  02370051
021600                                                                  02380051
021700*----------------------------------------------------------------*02390051
021800*   PROGRAM MESSAGES                                             *02400051
021900*----------------------------------------------------------------*02410051
022000 01  PM-PROGRAM-MESSAGES.                                         02420051
022100     05  PM-ABEND-INFO-A.                                         02430051
022200         10  FILLER                PIC X(15)   VALUE              02440051
022300                                   'DP020-SRC-AID: '.             02450051
022400         10  PM-A-SRC-AID          PIC X(02)   VALUE  SPACE.      02460051
022500         10  FILLER                PIC X(19)   VALUE              02470051
022600                                   '. DP020-FK-ACTION: '.         02480051
022700         10  PM-A-FK-ACTION        PIC X(01)   VALUE  SPACE.      02490051
022800         10  FILLER                PIC X(22)   VALUE              02500051
022900                                   '. DP020-FK-DISPN-IND: '.      02510051
023000         10  PM-A-FK-DISPN         PIC X(01)   VALUE  SPACE.      02520051
023100         10  FILLER                PIC X(01)   VALUE '.'.         02530051
023200         10  FILLER                PIC X(19)   VALUE SPACE.       02540051
023300                                                                  02550051
023400                                                                  02560051
023500*----------------------------------------------------------------*02570051
023600*   SWITCHES                                                     *02580051
023700*----------------------------------------------------------------*02590051
023800 01  PS-PROGRAM-SWITCHES.                                         02600051
023900                                                                  02610051
024000     05  PS-ERROR-SW               PIC  X(01)  VALUE  'N'.        02620051
024100         88  PS-ERROR                          VALUE  'Y'.        02630051
024200         88  PS-NO-ERROR                       VALUE  'N'.        02640051
024300                                                                  02650051
024400     05  PS-CONFIRM-PROCESSING-IND PIC  X(01)  VALUE  'N'.        02660051
024500         88  PS-CONFIRM-PROCESSING             VALUE  'Y'.        02670051
024600         88  PS-NOT-CONFIRM-PROCESSING         VALUE  'N'.        02680051
024700     05  PS-EOF-CNFM-LNE-CSR-SW    PIC  X(01)  VALUE  'N'.        02690051
024800         88  PS-EOF-CNFM-LNE-CSR               VALUE  'Y'.        02700051
024900         88  PS-NOT-EOF-CNFM-LNE-CSR           VALUE  'N'.        02710051
025000     05  PS-EOF-PULL-REF-NBR-CSR-SW PIC X(01)  VALUE  'N'.        02720051
025100         88  PS-EOF-PULL-REF-NBR-CSR           VALUE  'Y'.        02730051
025200         88  PS-NOT-EOF-PULL-REF-NBR-CSR       VALUE  'N'.        02740051
025300     05  PS-ACCESS-SW                   PIC  X(01)  VALUE  'N'.   02750051
025400         88  PS-ACCESS-ALLOWED                      VALUE  'Y'.   02760051
025500         88  PS-ACCESS-NOT-ALLOWED                  VALUE  'N'.   02770051
025600     05  PS-VALID-RDM-FACILITY-SW       PIC  X(01)  VALUE  'N'.   02780051
025700         88  PS-VALID-RDM-FACILITY                  VALUE  'Y'.   02790051
025800         88  PS-VALID-RDM-FACILITY-NO               VALUE  'N'.   02800051
025900                                                                  02810051
026000                                                                  02820051
026100                                                                  02830051
026200*----------------------------------------------------------------*02840051
026300*   PROGRAM VARIABLES                                            *02850051
026400*----------------------------------------------------------------*02860051
026500 01  PV-PROGRAM-VARIABLES.                                        02870051
026600                                                                  02880051
026700     05  PV-CURR-OPER-UNT-ID            PIC  9(04) VALUE 0.       02890051
026800     05  PV-CURR-FCLTY-ID               PIC  9(04) VALUE 0.       02900051
026900     05  PV-4-DIGIT-STORE          PIC  Z(04)  VALUE  ZEROES.     02910051
027000     05  PV-COMMAREA-LENGTH        PIC S9(04)  VALUE +0.          02920051
027100     05  PV-CS-LOCATION            PIC S9(04)  VALUE ZEROES.      02930051
027200     05  PV-CS-NAME                PIC  X(25)  VALUE SPACES.      02940051
027300     05  PV-DC1-NBR-X              PIC  X(03)  VALUE SPACES.      02950051
027400     05  PV-DC1-NBR          REDEFINES                            02960051
027401         PV-DC1-NBR-X              PIC  9(03).                    02970051
027402     05  PV-DC-NBR                 PIC S9(04)  COMP VALUE 0.      02980051
027403     05  PV-CS-LOC-SIGNED          PIC S9(04)  COMP VALUE 0.      02990051
027404     05  PV-DISPLAY-PULL-NBR       PIC  9(09)  VALUE ZEROES.      03000051
027405     05  PV-DISPLAY-SQLCODE        PIC -9(09)  VALUE ZEROES.      03010051
027406     05  PV-REF-NBR-COUNT          PIC S9(09)  COMP.              03020051
027407     05  PV-CEPLDS-COUNT           PIC S9(09)  VALUE ZEROES       03030051
027408                                               COMP.              03040051
027409     05  PV-TCEPLMF-COUNT          PIC S9(09)  VALUE ZEROES       03050051
027410                                               COMP.              03060051
027420     05  PV-TCEPLAU-COUNT          PIC S9(09)  VALUE ZEROES       03070051
027430                                               COMP.              03080051
027440     05  PV-LINES-NEW              PIC S9(09)  VALUE ZEROES       03090051
027450                                               COMP.              03100051
027460     05  PV-LINES-POSTED-DISTRB    PIC S9(09)  COMP.              03110051
027470     05  PV-CICS-RESPONSE          PIC S9(08)  VALUE ZEROES       03120051
027480                                   COMP SYNC.                     03130051
027490     05  PV-CURRENT-DATE           PIC  X(10)  VALUE SPACES.      03140051
027500     05  PV-CURRENT-DATE-R REDEFINES PV-CURRENT-DATE.             03150051
027600         10  PV-CURR-YY            PIC  9(04).                    03160051
027700         10  FILLER                PIC  X(01).                    03170051
027800         10  PV-CURR-MM            PIC  9(02).                    03180051
027900         10  FILLER                PIC  X(01).                    03190051
028000         10  PV-CURR-DD            PIC  9(02).                    03200051
028100                                                                  03210051
028200* CLT 06/30/2010 START WR#38786                                   03220051
028210                                                                  03230051
028300     05  PV-DAYS                   PIC S9(05)   VALUE +14.        03240051
028301                                                                  03250051
028310     05  PV-LESS2WK-DATE           PIC  X(10)  VALUE SPACES.      03260051
028400     05  PV-LESS2WK-DATE-R REDEFINES PV-LESS2WK-DATE.             03270051
028500         10  PV-LESS-YY            PIC  9(04).                    03280051
028600         10  FILLER                PIC  X(01).                    03290051
028700         10  PV-LESS-MM            PIC  9(02).                    03300051
028800         10  FILLER                PIC  X(01).                    03310051
028900         10  PV-LESS-DD            PIC  9(02).                    03320051
028910* CLT 06/30/2010 END                                              03330051
028920                                                                  03340051
028930     05  PV-FROM-DATE-HOLD.                                       03350051
028940         10  PV-FROM-YY            PIC  9(04)  VALUE ZEROES.      03360051
028950         10  PV-FROM-MM            PIC  9(02)  VALUE ZEROES.      03370051
028960         10  PV-FROM-DD            PIC  9(02)  VALUE ZEROES.      03380051
028970                                                                  03390051
028980     05  PV-TO-DATE-HOLD.                                         03400051
028990         10  PV-TO-YY              PIC  9(04)  VALUE ZEROES.      03410051
029000         10  PV-TO-MM              PIC  9(02)  VALUE ZEROES.      03420051
029100         10  PV-TO-DD              PIC  9(02)  VALUE ZEROES.      03430051
029200                                                                  03440051
029300     05  PV-TYPE-1                       PIC X(02)  VALUE SPACES. 03450051
029400         88   PV-TYPE-1-ADAM                        VALUE 'MA'.   03460051
029500         88   PV-TYPE-1-INFOREM                     VALUE 'MR'.   03470051
029600         88   PV-TYPE-1-MANUAL                      VALUE 'UC'.   03480051
029700**DJK - 05/04/10 - ADDED NEW FLAG FOR EFC2                        03490051
029800         88   PV-TYPE-1-XFER                        VALUE 'XF'.   03500051
029900     05  PV-TYPE-2                       PIC X(02)  VALUE SPACES. 03510051
030000         88   PV-TYPE-2-ADAM                        VALUE 'MA'.   03520051
030100         88   PV-TYPE-2-INFOREM                     VALUE 'MR'.   03530051
030200         88   PV-TYPE-2-MANUAL                      VALUE 'UC'.   03540051
030300**DJK - 05/04/10 - ADDED NEW FLAG FOR EFC2                        03550051
030400         88   PV-TYPE-2-XFER                        VALUE 'XF'.   03560051
030500     05  PV-TYPE-3                       PIC X(02)  VALUE SPACES. 03570051
030600         88   PV-TYPE-3-ADAM                        VALUE 'MA'.   03580051
030700         88   PV-TYPE-3-INFOREM                     VALUE 'MR'.   03590051
030800         88   PV-TYPE-3-MANUAL                      VALUE 'UC'.   03600051
030900**DJK - 05/04/10 - ADDED NEW FLAG FOR EFC2                        03610051
031000         88   PV-TYPE-3-XFER                        VALUE 'XF'.   03620051
031100     05  PV-TYPE-4                       PIC X(02)  VALUE SPACES. 03630051
031110         88   PV-TYPE-4-ADAM                        VALUE 'MA'.   03640051
031120         88   PV-TYPE-4-INFOREM                     VALUE 'MR'.   03650051
031130         88   PV-TYPE-4-MANUAL                      VALUE 'UC'.   03660051
031140**DJK - 05/04/10 - ADDED NEW FLAG FOR EFC2                        03670051
031150         88   PV-TYPE-4-XFER                        VALUE 'XF'.   03680051
031160                                                                  03690051
031170     05  PV-STATUS-1                     PIC X(02)  VALUE SPACES. 03700051
031180         88   PV-STATUS-1-NEW                       VALUE 'NW'.   03710051
031190         88   PV-STATUS-1-CANCELLED                 VALUE 'CA'.   03720051
031200         88   PV-STATUS-1-INPROCESS                 VALUE 'IP'.   03730051
031300         88   PV-STATUS-1-DISTRIBTD                 VALUE 'DS'.   03740051
031400         88   PV-STATUS-1-POSTED                    VALUE 'PD'.   03750051
031500     05  PV-STATUS-2                     PIC X(02)  VALUE SPACES. 03760051
031600         88   PV-STATUS-2-NEW                       VALUE 'NW'.   03770051
031700         88   PV-STATUS-2-CANCELLED                 VALUE 'CA'.   03780051
031800         88   PV-STATUS-2-INPROCESS                 VALUE 'IP'.   03790051
031900         88   PV-STATUS-2-DISTRIBTD                 VALUE 'DS'.   03800051
032000         88   PV-STATUS-2-POSTED                    VALUE 'PD'.   03810051
032100     05  PV-STATUS-3                     PIC X(02)  VALUE SPACES. 03820051
032200         88   PV-STATUS-3-NEW                       VALUE 'NW'.   03830051
032300         88   PV-STATUS-3-CANCELLED                 VALUE 'CA'.   03840051
032400         88   PV-STATUS-3-INPROCESS                 VALUE 'IP'.   03850051
032500         88   PV-STATUS-3-DISTRIBTD                 VALUE 'DS'.   03860051
032600         88   PV-STATUS-3-POSTED                    VALUE 'PD'.   03870051
032700     05  PV-STATUS-4                     PIC X(02)  VALUE SPACES. 03880051
032800         88   PV-STATUS-4-NEW                       VALUE 'NW'.   03890051
032900         88   PV-STATUS-4-CANCELLED                 VALUE 'CA'.   03900051
033000         88   PV-STATUS-4-INPROCESS                 VALUE 'IP'.   03910051
033100         88   PV-STATUS-4-DISTRIBTD                 VALUE 'DS'.   03920051
033200         88   PV-STATUS-4-POSTED                    VALUE 'PD'.   03930051
033300     05  PV-STATUS-5                     PIC X(02)  VALUE SPACES. 03940051
033400         88   PV-STATUS-5-NEW                       VALUE 'NW'.   03950051
033500         88   PV-STATUS-5-CANCELLED                 VALUE 'CA'.   03960051
033600         88   PV-STATUS-5-INPROCESS                 VALUE 'IP'.   03970051
033700         88   PV-STATUS-5-DISTRIBTD                 VALUE 'DS'.   03980051
033800         88   PV-STATUS-5-POSTED                    VALUE 'PD'.   03990051
033900     05  PV-IN-PROCESS-CNT               PIC 9(05)  VALUE ZEROES. 04000051
034000                                                                  04010051
034100                                                                  04020051
034200*---------------------------------------------------------------* 04030051
034300* COMMUNICATION AREA FOR PRINT MODULE (CEKCS609)                * 04040051
034400*---------------------------------------------------------------* 04050051
034500     COPY CEWS004.                                                04060051
034600                                                                  04070051
034700     COPY XLWS071.                                                04080051
034800                                                                  04090051
034900                                                                  04100051
035000*----------------------------------------------------------------*04110051
035100*    MAP LAYOUT                                                  *04120051
035200*----------------------------------------------------------------*04130051
035300     COPY CEKM600.                                                04140051
035400                                                                  04150051
035500                                                                  04160051
035600*----------------------------------------------------------------*04170051
035700**  SECURITY SUBROUTINE PARAMETERS                                04180051
035800*----------------------------------------------------------------*04190051
035900     COPY DPWS008.                                                04200051
036000                                                                  04210051
036100                                                                  04220051
036200*----------------------------------------------------------------*04230051
036300*    CALENDAR ROUTINE                                            *04240051
036400*----------------------------------------------------------------*04250051
036500     COPY DPWS500.                                                04260051
036600                                                                  04270051
036700                                                                  04280051
036800*----------------------------------------------------------------*04290051
036900*  SENDING/RECEIVING AREA FOR THE                                *04300051
037000*  PRINTER VALIDATION ROUTING (DPKCS060)                         *04310051
037100*----------------------------------------------------------------*04320051
037200     COPY DPWS072.                                                04330051
037300                                                                  04340051
037400                                                                  04350051
037500*---------------------------------------------------------------* 04360051
037600*  SENDING/RECEIVING AREA FOR THE CONFIRMATION ROUTINE          * 04370051
037700*  (CEKCS610)                                                   * 04380051
037800*---------------------------------------------------------------* 04390051
037900     COPY CEWS005.                                                04400051
038000                                                                  04410051
038100                                                                  04420051
038200*----------------------------------------------------------------*04430051
038300*    ATTRIBUTE SETTINGS COPYBOOK.                                *04440051
038400*----------------------------------------------------------------*04450051
038500     COPY DPWS015.                                                04460051
038600                                                                  04470051
038700                                                                  04480051
038800*----------------------------------------------------------------*04490051
038900*    FUNCTION KEYS COPYBOOK                                      *04500051
039000*----------------------------------------------------------------*04510051
039100     COPY DPWS016.                                                04520051
039200                                                                  04530051
039300                                                                  04540051
039400*----------------------------------------------------------------*04550051
039500*    ABEND PROCESSING COPYBOOK.                                  *04560051
039600*----------------------------------------------------------------*04570051
039700     COPY DPWS013.                                                04580051
039800                                                                  04590051
039900                                                                  04600051
040000*----------------------------------------------------------------*04610051
040100*  THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT     *04620051
040200*  SUB-ROUTINE (DPKUT100).                                       *04630051
040300*----------------------------------------------------------------*04640051
040400     COPY DPWS010I.                                               04650051
040500                                                                  04660051
040600                                                                  04670051
040700*----------------------------------------------------------------*04680051
040800*  THE CALLING PARAMETER LIST (DPWS030) FOR THE CICS             *04690051
040900*  ARCHITECTURE API (BLACK BOX) SUB-ROUTINE.                     *04700051
041000*----------------------------------------------------------------*04710051
041100     COPY DPWS030.                                                04720051
CICS       COPY DPWS930.                                                04721053
041200                                                                  04730051
041300                                                                  04740051
041400*----------------------------------------------------------------*04750051
041500*    STANDARD COMMAREA.                                          *04760051
041600*----------------------------------------------------------------*04770051
041700     COPY DPWS020.                                                04780051
041800     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                04790051
041900                                                                  04800051
042000*----------------------------------------------------------------*04810051
042100*    INTER-APPLICATION COMMAREA.                                 *04820051
042200*----------------------------------------------------------------*04830051
042300                                                                  04840051
042400         10  INTER-APPL-COMM-AREA PIC X(200).                     04850051
042500     COPY CEWS001.                                                04860051
042600                                                                  04870051
042700                                                                  04880051
042800*----------------------------------------------------------------*04890051
042900*    SPECIFIC COMMMAREA FOR CEKCS600.                            *04900051
043000*----------------------------------------------------------------*04910051
043100         10  ASC-SPECIFIC-COMMAREA.                               04920051
043200             15  ASC-CURR-OPER-UNT-ID        PIC  X(04).          04930051
043300             15  ASC-CURR-OPER-UNT-ID-N REDEFINES                 04940051
043400                     ASC-CURR-OPER-UNT-ID    PIC  9(04).          04950051
043500             15  ASC-CURR-FCLTY-ID           PIC  X(04).          04960051
043600             15  ASC-CURR-FCLTY-ID-N REDEFINES                    04970051
043700                     ASC-CURR-FCLTY-ID       PIC  9(04).          04980051
043800             15  ASC-CS-LOCATION             PIC  X(04).          04990051
043900             15  ASC-CS-LOCATION-R REDEFINES ASC-CS-LOCATION.     05000051
044000                 20  ASC-CS-LOCATION-N       PIC  9(04).          05010051
044100             15  ASC-CS-LOCATION-DESC        PIC  X(25).          05020051
044200             15  ASC-CS-PRINTER-ID           PIC  X(08).          05030051
044300             15  ASC-PULL-NBR                PIC  X(09).          05040051
044400             15  ASC-PULL-NBR-R REDEFINES ASC-PULL-NBR.           05050051
044500                 20  ASC-PULL-NBR-N          PIC  9(09).          05060051
044600             15  ASC-REF-NBR                 PIC  X(15).          05070051
044700             15  ASC-PULL-SELECT-STATUS      PIC  X(01).          05080051
044800                 88  ASC-SELECT-VALID        VALUE 'A' 'C' 'D'    05090051
044900                                                   'I' 'N' 'P'    05100051
045000                                                   'Z' ' '.       05110051
045100                 88  ASC-PULL-STATUS-ENTERED VALUE 'A' 'C' 'D'    05120051
045200                                                   'I' 'N' 'P'    05130051
045300                                                   'Z'.           05140051
045400                 88  ASC-SELECT-ALL               VALUE 'A'.      05150051
045500                 88  ASC-SELECT-CNCLD             VALUE 'C'.      05160051
045600                 88  ASC-SELECT-DSTRB             VALUE 'D'.      05170051
045700                 88  ASC-SELECT-INPROC            VALUE 'I'.      05180051
045800                 88  ASC-SELECT-NEW               VALUE 'N'.      05190051
045900                 88  ASC-SELECT-POSTD             VALUE 'P'.      05200051
046000                 88  ASC-SELECT-NEW-INPROC        VALUE 'Z'.      05210051
046100             15  ASC-PULL-SELECT-TYPE        PIC  X(01).          05220051
046200**DJK - 05/04/10 - ADDED NEW FLAG FOR EFC2                        05230051
046300                 88  ASC-SELECT-SRC-VALID    VALUE 'A' 'D' 'I'    05240051
046400                                                   'M' ' ' 'X'.   05250051
046500**DJK - 05/04/10 - ADDED NEW FLAG FOR EFC2                        05260051
046600                 88  ASC-PULL-SOURCE-ENTERED VALUE 'A' 'D' 'I'    05270051
046700                                                   'M' 'X'.       05280051
046800                 88  ASC-SELECT-SRC-ALL           VALUE 'A'.      05290051
046900                 88  ASC-SELECT-SRC-ADAM          VALUE 'D'.      05300051
047000                 88  ASC-SELECT-SRC-INFOREM       VALUE 'I'.      05310051
047100                 88  ASC-SELECT-SRC-MANUAL        VALUE 'M'.      05320051
047200**DJK - 05/04/10 - ADDED NEW FLAG FOR EFC2                        05330051
047300                 88  ASC-SELECT-SRC-XFER          VALUE 'X'.      05340051
047400             15  ASC-PULL-SELECT-DATE-FROM.                       05350051
047500                 20  ASC-FROM-MM             PIC  9(02).          05360051
047600                 20  ASC-FROM-DD             PIC  9(02).          05370051
047700                 20  ASC-FROM-YY             PIC  9(04).          05380051
047800             15  ASC-PULL-SELECT-DATE-TO.                         05390051
047900                 20  ASC-TO-MM               PIC  9(02).          05400051
048000                 20  ASC-TO-DD               PIC  9(02).          05410051
048100                 20  ASC-TO-YY               PIC  9(04).          05420051
048200             15  ASC-SELECT-LIST-SEQUENCE    PIC  X(01).          05430051
048300                 88  ASC-LIST-SEQ-VALID      VALUE 'P' 'D' ' '.   05440051
048400                 88  ASC-LIST-SEQ-ENTERED    VALUE 'P' 'D'.       05450051
048500                 88  ASC-LIST-SEQ-PL-NBR          VALUE 'P'.      05460051
048600                 88  ASC-LIST-SEQ-CR-DTE          VALUE 'D'.      05470051
048700             15  ASC-CURR-PULL-STATUS        PIC  X(02).          05480051
048800                 88  ASC-PULL-CANCELLED           VALUE 'CA'.     05490051
048900                 88  ASC-PULL-DISTRIBUTED         VALUE 'DS'.     05500051
049000                 88  ASC-PULL-IN-PROCESS          VALUE 'IP'.     05510051
049100                 88  ASC-PULL-NEW                 VALUE 'NW'.     05520051
049200                 88  ASC-PULL-POSTED              VALUE 'PD'.     05530051
049300             15  ASC-CURR-PULL-TYPE          PIC  X(02).          05540051
049400                 88  ASC-PULL-SRC-ADAM            VALUE 'MA'.     05550051
049500                 88  ASC-PULL-SRC-INFOREM         VALUE 'MR'.     05560051
049600                 88  ASC-PULL-SRC-MANUAL          VALUE 'UC'.     05570051
049610                 88  ASC-PULL-SRC-MANUAL          VALUE 'XF'.     05580051
049620             15  ASC-CONFIRM-TYPE-IND        PIC  X(01).          05590051
049630                 88  ASC-CONFIRM-TYPE-NONE              VALUE 'N'.05600051
049640                 88  ASC-CONFIRM-CNCL-PULL              VALUE 'A'.05610051
049650                 88  ASC-CONFIRM-UNCNCL-PULL            VALUE 'B'.05620051
049660                 88  ASC-CONFIRM-CONF-DIST              VALUE 'C'.05630051
049670                 88  ASC-CONFIRM-UNCONF-DIST            VALUE 'D'.05640051
049680                 88  ASC-CONFIRM-CONF-PULL              VALUE 'E'.05650051
049690                 88  ASC-CONFIRM-UNCONF-PULL            VALUE 'F'.05660051
049700             15  ASC-DEPT-NBR                PIC  X(03).          05670051
049800             15  ASC-DEPT-NBR-R REDEFINES ASC-DEPT-NBR.           05680051
049900                 20  ASC-DEPT-NBR-N          PIC  9(03).          05690051
050000* CLT 07/01/2010 START WR#38786                                   05700051
050100             15  ASC-MAJ-CLASS               PIC  X(02).          05710051
050110             15  ASC-MAJ-CLASS-R REDEFINES ASC-MAJ-CLASS.         05720051
050120                 20  ASC-MAJ-CLASS-N         PIC  9(02).          05730051
050200             15  ASC-SUB-CLASS               PIC  X(02).          05740051
050210             15  ASC-SUB-CLASS-R REDEFINES ASC-SUB-CLASS.         05750051
050220                 20  ASC-SUB-CLASS-N         PIC  9(02).          05760051
050300* CLT 07/01/2010 END                                              05770051
050400             15  ASC-DEPT-DESC               PIC  X(25).          05780051
050500                                                                  05790051
050600                                                                  05800051
050700             15  FILLER                      PIC  X(96).          05810051
050800         10  ASC-HOLD-INTER-APPL             PIC  X(200).         05820051
050900                                                                  05830051
051000                                                                  05840051
051100*-----------------------------------------------------------------05850051
051200*  SQL AND COBOL DECLARATIONS FOR THE KOHLS/RETEK PARMS (TKRPRPM) 05860051
051300*-----------------------------------------------------------------05870051
051400     EXEC SQL                                                     05880051
051500          INCLUDE TKRPRPM                                         05890051
051600     END-EXEC.                                                    05900051
051700                                                                  05910051
051800                                                                  05920051
051900*-----------------------------------------------------------------05930051
052000*  SQL AND COBOL DECLARATIONS FOR MERCHANDISE AREA TABLE (TMDSEAR)05940051
052100*-----------------------------------------------------------------05950051
052200     EXEC SQL                                                     05960051
052300          INCLUDE TMDSEAR                                         05970051
052400     END-EXEC.                                                    05980051
052500                                                                  05990051
052600*-----------------------------------------------------------------06000051
052700*  SQL AND COBOL DECLARATION FOR COMPANY CONTROL TABLE (TCOCNTL)  06010051
052800*-----------------------------------------------------------------06020051
052900     EXEC SQL                                                     06030051
053000         INCLUDE TCOCNTL                                          06040051
053100     END-EXEC.                                                    06050051
053200                                                                  06060051
053300*-----------------------------------------------------------------06070051
053400*  CENTRAL STOCK - PULL REQUEST TABLE (TCEPLRQ)                   06080051
053500*-----------------------------------------------------------------06090051
053600     EXEC SQL                                                     06100051
053700          INCLUDE TCEPLRQ                                         06110051
053800     END-EXEC.                                                    06120051
053900                                                                  06130051
054000                                                                  06140051
054100*-----------------------------------------------------------------06150051
054200*  CENTRAL STOCK - PULL STATUS TABLE (TCEPLST)                    06160051
054300*-----------------------------------------------------------------06170051
054400     EXEC SQL                                                     06180051
054500          INCLUDE TCEPLST                                         06190051
054600     END-EXEC.                                                    06200051
054700                                                                  06210051
054800                                                                  06220051
054900*-----------------------------------------------------------------06230051
055000*  CENTRAL STOCK - PULL LINE ITEM TABLE (TCEPLIT)                 06240051
055100*-----------------------------------------------------------------06250051
055200     EXEC SQL                                                     06260051
055300          INCLUDE TCEPLIT                                         06270051
055400     END-EXEC.                                                    06280051
055500                                                                  06290051
055600                                                                  06300051
055700*-----------------------------------------------------------------06310051
055800*  CENTRAL STOCK - PULL DISTRIBUTION TABLE (TCEPLDS)              06320051
055900*-----------------------------------------------------------------06330051
056000     EXEC SQL                                                     06340051
056100          INCLUDE TCEPLDS                                         06350051
056200     END-EXEC.                                                    06360051
056300                                                                  06370051
056400*---------------------------------------------------------------* 06380051
056500*    TCEPLMF - CENTRAL STOCK PULL MANIFESTED UNITS                06390051
056600*---------------------------------------------------------------* 06400051
056700     EXEC SQL                                                     06410051
056800          INCLUDE TCEPLMF                                         06420051
056900     END-EXEC.                                                    06430051
057000                                                                  06440051
057100*---------------------------------------------------------------* 06450051
057200*    TCEPLAU - CENTRAL STOCK PULL ADJUSTED UNITS                  06460051
057300*---------------------------------------------------------------* 06470051
057400     EXEC SQL                                                     06480051
057500          INCLUDE TCEPLAU                                         06490051
057600     END-EXEC.                                                    06500051
057700                                                                  06510051
057800**************************************************************--* 06520051
057900*   DB2 DCLGEN FOR XLT_DEPT TABLE (DOMAIN DEPARTMENT TABLE)       06530051
058000**************************************************************--* 06540051
058100     EXEC SQL                                                     06550051
058110          INCLUDE XLT00002                                        06560051
058120     END-EXEC.                                                    06570051
058130                                                                  06580051
058140**************************************************************--* 06590051
058150*   DB2 DCLGEN FOR XLV_VND_STYL   (DOMAIN DEPARTMENT TABLE)       06600051
058160**************************************************************--* 06610051
058170     EXEC SQL                                                     06620051
058180          INCLUDE XLV00001                                        06630051
058190     END-EXEC.                                                    06640051
058191                                                                  06650051
058192*---------------------------------------------------------------* 06660051
058193*    LINE ITEM CURSOR                                           * 06670051
058194*---------------------------------------------------------------* 06680051
058195                                                                  06690051
058196     EXEC SQL                                                     06700051
058197          DECLARE CNFM-LINE-ITEM-CSR CURSOR FOR                   06710051
058198              SELECT  PL_LNE_NBR                                  06720051
058199                FROM  TCEPLIT                                     06730051
058200               WHERE  CNSTK_REQ_PL_NBR = :DK-PULL-NUMBER          06740051
058300                 AND  STAT_CDE        IN ('IP')                   06750051
058400            ORDER BY  PL_LNE_NBR                                  06760051
058500     END-EXEC.                                                    06770051
058600                                                                  06780051
058700*---------------------------------------------------------------* 06790051
058800*    REFERENCE NUMBER CURSOR                                    * 06800051
058900*---------------------------------------------------------------* 06810051
059000                                                                  06820051
059100     EXEC SQL                                                     06830051
059200          DECLARE PULL-REF-NBR-CSR CURSOR FOR                     06840051
059300              SELECT  CNSTK_REQ_PL_NBR                            06850051
059400                     ,CNSTK_LOC_ID                                06860051
059500                     ,SRC_REF_NBR                                 06870051
059600                     ,SRC_TYP_CDE                                 06880051
059700                     ,STAT_CDE                                    06890051
059800                FROM  TCEPLRQ                                     06900051
059900               WHERE  SRC_REF_NBR      =  :DK-REF-NUMBER          06910051
060000                 AND  CNSTK_REQ_PL_NBR >  :DK-PULL-NUMBER         06920051
060100                 AND  SRC_TYP_CDE     IN (:PV-TYPE-1,             06930051
060200                                          :PV-TYPE-2,             06940051
060300                                          :PV-TYPE-3,             06950051
060400                                          :PV-TYPE-4)             06960051
060500                 AND  STAT_CDE        IN (:PV-STATUS-1,           06970051
060600                                          :PV-STATUS-2,           06980051
060700                                          :PV-STATUS-3,           06990051
060800                                          :PV-STATUS-4,           07000051
060900                                          :PV-STATUS-5)           07010051
061000            ORDER BY  CNSTK_REQ_PL_NBR                            07020051
061100     END-EXEC.                                                    07030051
061200                                                                  07040051
061300                                                                  07050051
061400*-----------------------------------------------------------------07060051
061500*  STANDARD LAYOUT FOR THE SQL COMMUNICATIONS AREA                07070051
061600*-----------------------------------------------------------------07080051
061700     EXEC SQL                                                     07090051
061800          INCLUDE SQLCA                                           07100051
061900     END-EXEC.                                                    07110051
062000                                                                  07120051
062100                                                                  07130051
062200*-----------------------------------------------------------------07140051
062300*                                                                 07150051
062400*-----------------------------------------------------------------07160051
062500                                                                  07170051
062600                                                                  07180051
062700 LINKAGE SECTION.                                                 07190051
062800                                                                  07200051
062900                                                                  07210051
063000 01  DFHCOMMAREA.                                                 07220051
063100     05  FILLER                         OCCURS  1 TO 4072 TIMES   07230051
063200                                        DEPENDING ON EIBCALEN.    07240051
063300         10  FILLER                     PIC X.                    07250051
063400                                                                  07260051
063500                                                                  07270051
063600 PROCEDURE DIVISION.                                              07280051
063700*----------------------------------------------------------------*07290051
063800*  THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM.   *07300051
063900*  THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API    *07310051
064000*  MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.              *07320051
064100*                                                                *07330051
064200*  THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE    *07340051
064300*  LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.         *07350051
064400*----------------------------------------------------------------*07360051
064500 0000-MAIN-MODULE.                                                07370051
064600     INITIALIZE DP030-CICS-API-FIELDS.                            07380051
064700     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       07390051
064800     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          07400051
064900     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         07410051
065000     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       07420051
065100     MOVE LENGTH OF CE600AI        TO DP030-MAP-LENGTH (1).       07430051
065200     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     07440051
065300     PERFORM 0001-CALL-CICS-ARCH-API.                             07450051
065400                                                                  07460051
065500     PERFORM 1000-CONTROL-PROCESSING                              07470051
065600                                                                  07480051
065700     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     07490051
065800     PERFORM 0001-CALL-CICS-ARCH-API.                             07500051
065900                                                                  07510051
066000                                                                  07520051
066100 0001-CALL-CICS-ARCH-API.                                         07530051
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      07531053
066300                                    DFHCOMMAREA                   07550053
066400                                    DP030-CICS-API-FIELDS         07560053
066500                                    DP020-STANDARD-COMMAREA       07570053
066600                                    CE600AI.                      07580053
066700                                                                  07590051
066800     IF  DP030-RC-CALL-SUCCESSFUL                                 07600051
066900         CONTINUE                                                 07610051
067000     ELSE                                                         07620051
067100         SET DP013-NO-ROLLBACK                                    07630051
067200             DP013-XCTL-DISPLAY-RESTART                           07640051
067300             DP013-CICS-ABEND      TO TRUE                        07650051
067400         MOVE 'BEFORE 0000-MAIN-MODULE'                           07660051
067500                                   TO DP013-PARAGRAPH             07670051
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O07671053
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      07672053
067800         MOVE  SPACES              TO DP013-MESSAGE-TEXT (3)      07700051
067900         STRING  'RETURN CODE - '     DELIMITED BY SIZE           07710051
068000                  DP030-RETURN-CODE   DELIMITED BY SIZE           07720051
068100                                 INTO DP013-MESSAGE-TEXT (3)      07730051
068200         PERFORM DP013-0000-PROCESS-ABEND                         07740051
068300     END-IF.                                                      07750051
068400                                                                  07760051
068500                                                                  07770051
068600*----------------------------------------------------------------*07780051
068700*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *07790051
068800*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *07800051
068900*----------------------------------------------------------------*07810051
069000 1000-CONTROL-PROCESSING.                                         07820051
069100                                                                  07830051
069200     EVALUATE TRUE                                                07840051
069300         WHEN DP020-NEXT-ACT-INITIAL                              07850051
069400             MOVE INTER-APPL-COMM-AREA  TO ASC-HOLD-INTER-APPL    07860051
069500         WHEN OTHER                                               07870051
069600             MOVE ASC-HOLD-INTER-APPL   TO INTER-APPL-COMM-AREA   07880051
069700         END-EVALUATE.                                            07890051
069800                                                                  07900051
069900     EVALUATE TRUE                                                07910051
070000         WHEN DP020-NEXT-ACT-INITIAL                              07920051
070100             INITIALIZE ASC-SPECIFIC-COMMAREA                     07930051
070200             PERFORM 3200-RESET-ATTRIBUTES                        07940051
070300             PERFORM 7000-BUILD-INITIAL-PANEL                     07950051
070400             SET  ASC-CONFIRM-TYPE-NONE TO TRUE                   07960051
070500*            PERFORM 3200-RESET-ATTRIBUTES                        07970051
070600                                                                  07980051
070700         WHEN DP020-NEXT-ACT-READ-MAP                             07990051
070800             PERFORM 2000-FKEY-PROCESSING                         08000051
070900                                                                  08010051
071000         WHEN DP020-NEXT-ACT-RETURN                               08020051
071100             MOVE DP020-LOCATION-NBR  TO DK-CURR-OPER-UNT-ID      08030051
071200             MOVE PC-FCLTY-ID-0001    TO DK-CURR-FCLTY-ID         08040051
071310             PERFORM 7005-GET-DFLT-CS-LOC-ID                      08050051
071320             PERFORM 7010-GET-CURRENT-DATE                        08060051
071400                                                                  08070051
071500             INITIALIZE XL071-COMMAREA-REC                        08080051
071600             MOVE ASC-CURR-OPER-UNT-ID-N TO XL071-LOCATION-NUMBER 08090051
071700             PERFORM 3500-GET-STORE-INFORMATION                   08100051
071800                                                                  08110051
071900             MOVE XL071-LOCATION-NUMBER    TO MLOCIDO             08120051
072000             MOVE XL071-LOC-NM             TO MLOCDESO            08130051
072100                                                                  08140051
072200             MOVE COCNTL-DFLT-CNSTK-PRTR-ID TO  MPRTIDO           08150051
072300             MOVE PV-CURR-MM                TO  MTOMMO            08160051
072400             MOVE PV-CURR-DD                TO  MTODDO            08170051
072500             MOVE PV-CURR-YY                TO  MTOYYO            08180051
072600                                                                  08190051
072700* CLT 06/30/2010 START WR#38786                                   08200051
072800             MOVE PV-LESS-MM                TO  MFROMMMO          08210051
072900             MOVE PV-LESS-DD                TO  MFROMDDO          08220051
073000             MOVE PV-LESS-YY                TO  MFROMYYO          08230051
073100* CLT 06/30/2010 END                                              08240051
073200                                                                  08250051
073300             PERFORM 8000-MOVE-COMMAREA-TO-SCREEN                 08260051
073400             MOVE -1                   TO MPULLNOL                08270051
073500             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  08280051
073600             PERFORM 3200-RESET-ATTRIBUTES                        08290051
073700                                                                  08300051
073800         WHEN OTHER                                               08310051
073900             SET DP013-LOGIC-ABEND                                08320051
074000                 DP013-NO-ROLLBACK TO TRUE                        08330051
074100             MOVE 'CEKCS600 - 1000-CONTROL-PROCESSING'            08340051
074200                                   TO  DP013-PARAGRAPH            08350051
074300             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   08360051
074400                                   TO  DP013-MESSAGE-TEXT(1)      08370051
074500             MOVE DP020-NEXT-APPL-ACTIVITY                        08380051
074600                                   TO DP013-MESSAGE-TEXT(2)       08390051
074700             PERFORM DP013-0000-PROCESS-ABEND                     08400051
074800     END-EVALUATE.                                                08410051
074900                                                                  08420051
075000                                                                  08430051
075100*----------------------------------------------------------------*08440051
075200* FURTHER DETERMINE PROCESSING PATH BASED ON FUNCTION KEY ACTIONS*08450051
075300* SPECIFIC FUNCTION KEYS LISTED HERE ARE ACTED UPON REGARDLESS OF*08460051
075400* EDITS.                                                         *08470051
075500*----------------------------------------------------------------*08480051
075600 2000-FKEY-PROCESSING.                                            08490051
075700                                                                  08500051
075800     EVALUATE TRUE                                                08510051
075900                                                                  08520051
076000         WHEN DP020-SRC-AID = DP016-CLEAR                         08530051
076100             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   08540051
076200             PERFORM 8000-MOVE-COMMAREA-TO-SCREEN                 08550051
076300             MOVE -1                   TO MPULLNOL                08560051
076400                                                                  08570051
076500         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     08580051
076600             INITIALIZE ASC-SPECIFIC-COMMAREA                     08590051
076700             PERFORM 7000-BUILD-INITIAL-PANEL                     08600051
076800             SET  ASC-CONFIRM-TYPE-NONE TO TRUE                   08610051
076900             PERFORM 3200-RESET-ATTRIBUTES                        08620051
077000             MOVE -1                   TO MPULLNOL                08630051
077100                                                                  08640051
077200         WHEN OTHER                                               08650051
077300             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 08660051
077400             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   08670051
077500                                                                  08680051
077600             IF  PS-NO-ERROR                                      08690051
077700                 SET DP030-CONTINUE-GO TO TRUE                    08700051
077800                 PERFORM 2100-CHECK-FUNCTION-KEY                  08710051
077900             ELSE                                                 08720051
078000                 SET DP030-OVERRIDE-GO TO TRUE                    08730051
078100             END-IF                                               08740051
078200     END-EVALUATE.                                                08750051
078300                                                                  08760051
078400                                                                  08770051
078500*----------------------------------------------------------------*08780051
078600*  ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED      *08790051
078700*  FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED  *08800051
078800*  FROM THE CICS ARCHITECTURE API.                               *08810051
078900*----------------------------------------------------------------*08820051
079000 2100-CHECK-FUNCTION-KEY.                                         08830051
079100     EVALUATE TRUE                                                08840051
079200                                                                  08850051
079300         WHEN DP020-FK-LOCAL-GOTO (DP020-SRC-AID)                 08860051
079400         WHEN DP020-FK-DISPN-GO (DP020-SRC-AID)                   08870051
079500              PERFORM 2110-PREPARE-INTER-APPL-COMM                08880051
079600*                                                                 08890051
079700* ENTER                                                           08900051
079800*                                                                 08910051
079900         WHEN DP020-SRC-AID = DP016-ENTER                         08920051
080000              PERFORM 8000-MOVE-COMMAREA-TO-SCREEN                08930051
080100              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 08940051
080200              MOVE -1                   TO MPULLNOL               08950051
080300*                                                                 08960051
080400* F2  - CONFIRM                                                   08970051
080500*                                                                 08980051
080600         WHEN DP020-FK-CONFIRM (DP020-SRC-AID)                    08990051
080700              INITIALIZE  CE005-INTER-APPL-COMMAREA               09000051
080800              EVALUATE TRUE                                       09010051
080900                  WHEN ASC-CONFIRM-CNCL-PULL                      09020051
081000                       SET  CE005-CNCL-PULL  TO  TRUE             09030051
081100                       PERFORM 5000-LINK-CONFIRM-MODULE           09040051
081200                                                                  09050051
081300                  WHEN ASC-CONFIRM-UNCNCL-PULL                    09060051
081400                       SET  CE005-UNCNCL-PULL  TO  TRUE           09070051
081500                       PERFORM 5000-LINK-CONFIRM-MODULE           09080051
081600                                                                  09090051
081700                  WHEN ASC-CONFIRM-CONF-DIST                      09100051
081800                       SET  CE005-CNFM-DIST-PULL  TO  TRUE        09110051
081900                       PERFORM 5000-LINK-CONFIRM-MODULE           09120051
082000                                                                  09130051
082100                  WHEN ASC-CONFIRM-UNCONF-DIST                    09140051
082200                       SET  CE005-UNCNFM-DIST-PULL  TO  TRUE      09150051
082300                       PERFORM 5000-LINK-CONFIRM-MODULE           09160051
082400                                                                  09170051
082500                  WHEN ASC-CONFIRM-CONF-PULL                      09180051
082600                       SET  CE005-CNFM-PULL  TO  TRUE             09190051
082700                       PERFORM 5000-LINK-CONFIRM-MODULE           09200051
082800                                                                  09210051
082900                  WHEN ASC-CONFIRM-UNCONF-PULL                    09220051
083000                       SET  CE005-UNCNFM-PULL  TO  TRUE           09230051
083100                       PERFORM 5000-LINK-CONFIRM-MODULE           09240051
083200                                                                  09250051
083300                  WHEN OTHER                                      09260051
083400                       PERFORM 8000-MOVE-COMMAREA-TO-SCREEN       09270051
083500                       SET  PS-ERROR                              09280051
083600                            DP020-MSG-FATAL  TO TRUE              09290051
083700                       MOVE PC-TSYMSG-00045  TO DP020-MSG-NUMBER  09300051
083800                                                                  09310051
083900                  END-EVALUATE                                    09320051
084000             SET  ASC-CONFIRM-TYPE-NONE  TO  TRUE                 09330051
084100                                                                  09340051
084200*                                                                 09350051
084300* F23 - PRINT PULL      (LOCAL-FUNC-07)                           09360051
084400*                                                                 09370051
084500         WHEN DP020-FK-LOCAL-FUNC-07 (DP020-SRC-AID)              09380051
084600             MOVE 'CECSPPRT' TO DP008-FUNCTION-NAME               09390051
084700             IF ASC-CS-LOCATION = PC-ALL                          09400051
084800                 SET PS-ERROR                                     09410051
084900                     DP020-MSG-FATAL         TO TRUE              09420051
085000                 MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER  09430051
085100                 MOVE DP015-UNP-ALP-BRT-OFF  TO MLOCIDA           09440051
085200                 MOVE DP015-RED              TO MLOCIDC           09450051
085300                 MOVE DP015-REVERSE          TO MLOCIDH           09460051
085400                 MOVE -1                     TO MLOCIDL           09470051
085500                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              09480051
085600             END-IF                                               09490051
085700             IF  PS-NO-ERROR                                      09500051
085800                 PERFORM 2105-RACF-ACCESS                         09510051
085900                 IF  PS-ACCESS-NOT-ALLOWED                        09520051
086000                     SET  PS-ERROR                                09530051
086100                          DP020-MSG-FATAL TO TRUE                 09540051
086200                     MOVE PC-TSYMSG-02306 TO DP020-MSG-NUMBER     09550051
086300                     MOVE -1              TO MPULLNOL             09560051
086400                     SET  DP030-SET-CURSOR-APPL-1 TO TRUE         09570051
086500                 END-IF                                           09580051
086600             END-IF                                               09590051
086700                                                                  09600051
086800             IF  PS-NO-ERROR                                      09610051
086900                 IF  ASC-PULL-NBR-N  >  ZEROES                    09620051
087000                     PERFORM 4600-PROCESS-PRINT-FUNCTION          09630051
087100                 ELSE                                             09640051
087200                     PERFORM 4700-PROCESS-PRINT-FUNCTION          09650051
087300                 END-IF                                           09660051
087400             END-IF                                               09670051
087500             IF  PS-NO-ERROR                                      09680051
087600                 SET DP020-MSG-INFORMATIONAL  TO  TRUE            09690051
087700                 MOVE PC-TSYMSG-02235 TO DP020-MSG-NUMBER         09700051
087800             END-IF                                               09710051
087900*                                                                 09720051
088000* OTHER                                                           09730051
088100*                                                                 09740051
088200         WHEN OTHER                                               09750051
088300              SET DP013-NO-ROLLBACK                               09760051
088400                  DP013-XCTL-DISPLAY-RESTART                      09770051
088500                  DP013-CICS-ABEND  TO TRUE                       09780051
088600              MOVE '2100-CHECK-FUNCTION-KEY'                      09790051
088700                                    TO DP013-PARAGRAPH            09800051
088800              MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'     09810051
088900                                   TO DP013-MESSAGE-TEXT (1)      09820051
089000             MOVE 'OR CODE MISSING FROM THIS PROGRAM TO PROCESS:' 09830051
089100                                   TO DP013-MESSAGE-TEXT (2)      09840051
089200             MOVE DP020-SRC-AID    TO PM-A-SRC-AID                09850051
089300             MOVE DP020-FK-ACTION (DP020-SRC-AID)                 09860051
089400                                   TO PM-A-FK-ACTION              09870051
089500             MOVE DP020-FK-DISPN-IND (DP020-SRC-AID)              09880051
089600                                   TO PM-A-FK-DISPN               09890051
089700             MOVE PM-ABEND-INFO-A  TO DP013-MESSAGE-TEXT (3)      09900051
089800             MOVE 'REVIEW PFKEYS SETUP FOR THIS MNEMONIC.'        09910051
089900                                   TO DP013-MESSAGE-TEXT (4)      09920051
090000             PERFORM DP013-0000-PROCESS-ABEND                     09930051
090100     END-EVALUATE.                                                09940051
090200                                                                  09950051
090300                                                                  09960051
090400*----------------------------------------------------------------*09970051
090500* CHECK TO SEE IF USER HAS RACF AUTHORIZATION                     09980051
090600*----------------------------------------------------------------*09990051
090700 2105-RACF-ACCESS.                                                10000051
090800                                                                  10010051
090900      SET DP008-RSRC-TYPE-FUNC           TO TRUE                  10020051
091000      SET DP008-ACCESS-TYPE-USE          TO TRUE                  10030051
091100                                                                  10040051
091200      EXEC CICS                                                   10050051
091300         LINK PROGRAM (DP008-SECURITY-SUBROUTINE)                 10060051
091400              COMMAREA (DP008-SECURITY-COMMAREA)                  10070051
091500              LENGTH (DP008-SECURITY-COMMAREA-LENGTH)             10080051
091600      END-EXEC                                                    10090051
091700                                                                  10100051
091800      IF DP008-CALL-SUCCESSFUL                                    10110051
091900         IF DP008-ACCESS-ALLOWED                                  10120051
092000             SET PS-ACCESS-ALLOWED TO TRUE                        10130051
092100         ELSE                                                     10140051
092200             SET PS-ACCESS-NOT-ALLOWED TO TRUE                    10150051
092300         END-IF                                                   10160051
092400     ELSE                                                         10170051
092500         MOVE '2105-RACF-ACCESS'                                  10180051
092600                               TO DP013-PARAGRAPH                 10190051
092700          MOVE 'UNABLE TO ACCESS CICS'                            10200051
092800                               TO DP013-MESSAGE-TEXT (1)          10210051
092900          MOVE SQLCA                 TO DP013-SQLCA               10220051
093000          SET DP013-DB2-ABEND                                     10230051
093100              DP013-XCTL-DISPLAY-RESTART                          10240051
093200                               TO TRUE                            10250051
093300          PERFORM DP013-0000-PROCESS-ABEND                        10260051
093400      END-IF.                                                     10270051
093404                                                                  10280051
093405                                                                  10290051
093406*----------------------------------------------------------------*10300051
093407*  MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE    *10310051
093408*  INTER-APPLICATION COMMAREA.                                   *10320051
093409*----------------------------------------------------------------*10330051
093410 2110-PREPARE-INTER-APPL-COMM.                                    10340051
093420                                                                  10350051
093430     INITIALIZE CE001-INTER-APPL-COMMAREA.                        10360051
093440                                                                  10370051
093450     MOVE ASC-CURR-OPER-UNT-ID-N    TO CE001-CURR-OPER-UNT-ID-N.  10380051
093460     MOVE ASC-CURR-FCLTY-ID-N       TO CE001-CURR-FCLTY-ID-N.     10390051
093470     MOVE ASC-CS-LOCATION           TO CE001-CS-LOCATION.         10400051
093480     MOVE ASC-CS-PRINTER-ID         TO CE001-CS-PRINTER-ID.       10410051
093490     MOVE ASC-PULL-NBR-N            TO CE001-PULL-NBR.            10420051
093500     MOVE ASC-REF-NBR               TO CE001-REF-NBR.             10430051
093600     MOVE ASC-PULL-SELECT-STATUS    TO CE001-PULL-SELECT-STATUS.  10440051
093700     MOVE ASC-PULL-SELECT-TYPE      TO CE001-PULL-SELECT-TYPE.    10450051
093800     MOVE ASC-PULL-SELECT-DATE-FROM TO CE001-PULL-SELECT-DATE-FROM10460051
093900     MOVE ASC-PULL-SELECT-DATE-TO   TO CE001-PULL-SELECT-DATE-TO. 10470051
094000     MOVE ASC-SELECT-LIST-SEQUENCE  TO CE001-SELECT-LIST-SEQUENCE.10480051
094100     MOVE ASC-CURR-PULL-STATUS      TO CE001-CURR-PULL-STATUS.    10490051
094200     MOVE ASC-CURR-PULL-TYPE        TO CE001-CURR-PULL-TYPE.      10500051
094300     MOVE ASC-DEPT-NBR-N            TO CE001-DEPT-NBR.            10510051
094310* CLT 07/02/2010 START WR#38786                                   10520051
094320     MOVE ASC-MAJ-CLASS             TO CE001-MAJ-CLASS.           10530051
094321     MOVE ASC-SUB-CLASS             TO CE001-SUB-CLASS.           10540051
094330* CLT 07/02/2010 END                                              10550051
094400                                                                  10560051
094700*----------------------------------------------------------------*10570051
094800* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS IN*10580051
094900* THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN THE  *10590051
095000* APPLICATION-SPECIFIC COMMAREA, NOT ON THE SCREEN.              *10600051
095100*----------------------------------------------------------------*10610051
095200 2200-MOVE-SCREEN-TO-COMMAREA.                                    10620051
095300                                                                  10630051
095400* CENTRAL STOCK LOCATION                                          10640051
095500     IF  MLOCIDL > ZERO                                           10650051
095600         MOVE MLOCIDI              TO ASC-CS-LOCATION             10660051
095700     ELSE                                                         10670051
095800         MOVE ZEROES               TO ASC-CS-LOCATION             10680051
095900     END-IF.                                                      10690051
096000                                                                  10700051
096100* PRINTER ID                                                      10710051
096200     IF  MPRTIDL > ZERO                                           10720051
096300         MOVE MPRTIDI              TO ASC-CS-PRINTER-ID           10730051
096400     ELSE                                                         10740051
096500         MOVE SPACES               TO ASC-CS-PRINTER-ID           10750051
096600     END-IF.                                                      10760051
096700                                                                  10770051
096800* PULL NUMBER                                                     10780051
096900     IF  MPULLNOL > ZERO                                          10790051
097000         MOVE MPULLNOI             TO ASC-PULL-NBR                10800051
097100     ELSE                                                         10810051
097200         IF  MPULLNOF = DP015-ERASE-EOF                           10820051
097300             MOVE ZEROES           TO ASC-PULL-NBR                10830051
097400         END-IF                                                   10840051
097500     END-IF.                                                      10850051
097600                                                                  10860051
097700* REFERENCE NUMBER                                                10870051
097800     IF  MREFNOL > ZERO                                           10880051
097900         MOVE MREFNOI             TO ASC-REF-NBR                  10890051
098000     ELSE                                                         10900051
098100         IF  MREFNOF = DP015-ERASE-EOF                            10910051
098200             MOVE SPACES          TO ASC-REF-NBR                  10920051
098300         END-IF                                                   10930051
098400     END-IF.                                                      10940051
098500                                                                  10950051
098600* PULL STATUS                                                     10960051
098700     IF  MPULLSTL > ZERO                                          10970051
098800         MOVE MPULLSTI            TO ASC-PULL-SELECT-STATUS       10980051
098900     ELSE                                                         10990051
099000         IF  MPULLSTF = DP015-ERASE-EOF                           11000051
099100             MOVE SPACES          TO ASC-PULL-SELECT-STATUS       11010051
099200         END-IF                                                   11020051
099300     END-IF.                                                      11030051
099400                                                                  11040051
099500* PULL CREATE FROM MM                                             11050051
099600     IF  MFROMMML > ZERO                                          11060051
099700         MOVE MFROMMMI            TO ASC-FROM-MM                  11070051
099800     ELSE                                                         11080051
099900         IF  MFROMMMF = DP015-ERASE-EOF                           11090051
100000             MOVE ZEROES          TO ASC-FROM-MM                  11100051
100100         END-IF                                                   11110051
100200     END-IF.                                                      11120051
100300                                                                  11130051
100400* PULL CREATE FROM DD                                             11140051
100500     IF  MFROMDDL > ZERO                                          11150051
100600         MOVE MFROMDDI            TO ASC-FROM-DD                  11160051
100700     ELSE                                                         11170051
100800         IF  MFROMDDF = DP015-ERASE-EOF                           11180051
100900             MOVE ZEROES          TO ASC-FROM-DD                  11190051
101000         END-IF                                                   11200051
101100     END-IF.                                                      11210051
101200                                                                  11220051
101300* PULL CREATE FROM YY                                             11230051
101400     IF  MFROMYYL > ZERO                                          11240051
101500         MOVE MFROMYYI            TO ASC-FROM-YY                  11250051
101600     ELSE                                                         11260051
101700         IF  MFROMYYF = DP015-ERASE-EOF                           11270051
101800             MOVE ZEROES          TO ASC-FROM-YY                  11280051
101900         END-IF                                                   11290051
102000     END-IF.                                                      11300051
102100                                                                  11310051
102200* PULL CREATE TO MM                                               11320051
102300     IF  MTOMML > ZERO                                            11330051
102400         MOVE MTOMMI              TO ASC-TO-MM                    11340051
102500     ELSE                                                         11350051
102600         IF  MTOMMF = DP015-ERASE-EOF                             11360051
102700             MOVE ZEROES          TO ASC-TO-MM                    11370051
102800         END-IF                                                   11380051
102900     END-IF.                                                      11390051
103000                                                                  11400051
103100* PULL CREATE TO DD                                               11410051
103200     IF  MTODDL > ZERO                                            11420051
103300         MOVE MTODDI              TO ASC-TO-DD                    11430051
103400     ELSE                                                         11440051
103500         IF  MTODDF = DP015-ERASE-EOF                             11450051
103600             MOVE ZEROES          TO ASC-TO-DD                    11460051
103700         END-IF                                                   11470051
103800     END-IF.                                                      11480051
103900                                                                  11490051
104000* PULL CREATE TO YY                                               11500051
104100     IF  MTOYYL > ZERO                                            11510051
104200         MOVE MTOYYI              TO ASC-TO-YY                    11520051
104300     ELSE                                                         11530051
104400         IF  MTOYYF = DP015-ERASE-EOF                             11540051
104500             MOVE ZEROES          TO ASC-TO-YY                    11550051
104600         END-IF                                                   11560051
104700     END-IF.                                                      11570051
104800                                                                  11580051
104900* PULL SOURCE TYPE                                                11590051
105000     IF  MSRCTYPL > ZERO                                          11600051
105100         MOVE MSRCTYPI            TO ASC-PULL-SELECT-TYPE         11610051
105200     ELSE                                                         11620051
105300         IF  MSRCTYPF = DP015-ERASE-EOF                           11630051
105400             MOVE SPACES           TO ASC-PULL-SELECT-TYPE        11640051
105500         END-IF                                                   11650051
105600     END-IF.                                                      11660051
105700                                                                  11670051
105800* LIST SEQUENCE                                                   11680051
105900     IF  MLSTSEQL > ZERO                                          11690051
106000         MOVE MLSTSEQI             TO ASC-SELECT-LIST-SEQUENCE    11700051
106100     ELSE                                                         11710051
106200         IF  MLSTSEQF = DP015-ERASE-EOF                           11720051
106300             MOVE ZEROES           TO ASC-SELECT-LIST-SEQUENCE    11730051
106400         END-IF                                                   11740051
106500     END-IF.                                                      11750051
106600                                                                  11760051
106700* DEPT NUMBER                                                     11770051
106800     IF  MDEPTNOL > ZERO                                          11780051
106900         MOVE MDEPTNOI             TO ASC-DEPT-NBR                11790051
107000     ELSE                                                         11800051
107100         IF  MDEPTNOF = DP015-ERASE-EOF                           11810051
107200             MOVE SPACES           TO ASC-DEPT-NBR                11820051
107300         END-IF                                                   11830051
107400     END-IF.                                                      11840051
107500                                                                  11850051
107600* CLT 07/01/2010 START WR#38786                                   11860051
107700                                                                  11870051
107800* MAJOR CLASS                                                     11880051
107900     IF  MMCLASSL > ZERO                                          11890051
108000         MOVE MMCLASSI             TO ASC-MAJ-CLASS               11900051
108100     ELSE                                                         11910051
108200         IF  MMCLASSF = DP015-ERASE-EOF                           11920051
108300             MOVE SPACES           TO ASC-MAJ-CLASS               11930051
108400         END-IF                                                   11940051
108500     END-IF.                                                      11950051
108600                                                                  11960051
108610* SUB R CLASS                                                     11970051
108620     IF  MSCLASSL > ZERO                                          11980051
108630         MOVE MSCLASSI             TO ASC-SUB-CLASS               11990051
108640     ELSE                                                         12000051
108650         IF  MSCLASSF = DP015-ERASE-EOF                           12010051
108660             MOVE SPACES           TO ASC-SUB-CLASS               12020051
108670         END-IF                                                   12030051
108680     END-IF.                                                      12040051
108690                                                                  12050051
108700* CLT 07/01/2010 END                                              12060051
108800                                                                  12070051
108900*----------------------------------------------------------------*12080051
109000* ENSURE THE DATA IS CORRECT.  NOTE THAT IN A CRITERIA SPECIFI-  *12090051
109100* CATION SCREEN ONLY MINIMAL EDITS ARE DONE.  EDITS RELATED TO   *12100051
109200* A SPECIFIC SCREEN THAT THE USER IS GOING TO (LOCAL-GO) ARE DONE*12110051
109300* IN THE DESTINATION PROGRAM, NOT HERE.                          *12120051
109400*----------------------------------------------------------------*12130051
109500 3000-EDIT-DATA-IN-COMMAREA.                                      12140051
109600                                                                  12150051
109700     PERFORM 3200-RESET-ATTRIBUTES.                               12160051
109800                                                                  12170051
109900*-----------------------------------------------------------------12180051
110000* VERIFY THAT CENTRAL STOCK LOCATION IS NUMERIC                   12190051
110100*-----------------------------------------------------------------12200051
110200     IF  ASC-CS-LOCATION = PC-ALL                                 12210051
110300         CONTINUE                                                 12220051
110400     ELSE                                                         12230051
110500     IF  ASC-CS-LOCATION >  SPACES                                12240051
110600         MOVE ASC-CS-LOCATION          TO DP010I-UNEDITED-FIELD   12250051
110700         MOVE LENGTH OF ASC-CS-LOCATION                           12260051
110800                                       TO DP010I-MAXIMUM-DIGITS   12270051
110900         MOVE ZERO                     TO DP010I-MAXIMUM-DECIMALS 12280051
111000         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  12290051
263455         CALL DP010I-NUMERIC-EDIT-ROUTINE                         12300052
263455              USING DP010I-NUMERIC-EDIT-AREA                      12310052
111200         IF  DP010I-ERROR-DETECTED                                12320051
111300             SET PS-ERROR                                         12330051
111400                 DP020-MSG-FATAL       TO TRUE                    12340051
111500             MOVE PC-TSYMSG-00008      TO DP020-MSG-NUMBER        12350051
111600             MOVE DP015-UNP-ALP-BRT-OFF                           12360051
111700                                       TO MLOCIDA                 12370051
111800             MOVE DP015-RED            TO MLOCIDC                 12380051
111900             MOVE DP015-REVERSE        TO MLOCIDH                 12390051
112000             MOVE -1                   TO MLOCIDL                 12400051
112100             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  12410051
112200         ELSE                                                     12420051
112300             MOVE DP010I-NUMERIC-FIELD TO ASC-CS-LOCATION-N       12430051
112400             MOVE ASC-CS-LOCATION      TO MLOCIDO                 12440051
112500         END-IF                                                   12450051
112600     END-IF                                                       12460051
112700     END-IF.                                                      12470051
112800                                                                  12480051
112900                                                                  12490051
113000*-----------------------------------------------------------------12500051
113100* VERIFY THAT CENTRAL STOCK LOCATION ENTERED IS VALID             12510051
113200*-----------------------------------------------------------------12520051
113300     IF  ASC-CS-LOCATION = PC-ALL                                 12530051
113400         MOVE 'ALL -CS- LOCATIONS       ' TO  MLOCDESO            12540051
113500     ELSE                                                         12550051
113600        IF PS-NO-ERROR                                            12560051
113700           INITIALIZE XL071-COMMAREA-REC                          12570051
113800           MOVE ASC-CS-LOCATION-N TO  XL071-LOCATION-NUMBER       12580051
113900                                                                  12590051
114000           PERFORM 3500-GET-STORE-INFORMATION                     12600051
114100                                                                  12610051
114200           EVALUATE TRUE                                          12620051
114300               WHEN XL071-NO-ERRORS                               12630051
114400                    MOVE XL071-LOC-NM TO MLOCDESO                 12640051
114500                                         ASC-CS-LOCATION-DESC     12650051
114600                                                                  12660051
114700                    IF  XL071-LOC-TYP-CDE  =  PC-CS OR            12670051
114800                       (XL071-LOC-TYP-CDE  =  PC-DS AND           12680051
114900                        XL071-E-BUS-IND    = 'Y')                 12690051
115000                        CONTINUE                                  12700051
115100                    ELSE                                          12710051
115200                        SET PS-ERROR                              12720051
115300                            DP020-MSG-FATAL   TO TRUE             12730051
115400                        MOVE PC-TSYMSG-02219 TO DP020-MSG-NUMBER  12740051
115500                        MOVE DP015-UNP-ALP-BRT-OFF                12750051
115600                                              TO MLOCIDA          12760051
115700                        MOVE DP015-RED        TO MLOCIDC          12770051
115800                        MOVE DP015-REVERSE    TO MLOCIDH          12780051
115900                        MOVE -1               TO MLOCIDL          12790051
116000                        SET DP030-SET-CURSOR-APPL-1 TO TRUE       12800051
116100                    END-IF                                        12810051
116200                                                                  12820051
116300               WHEN OTHER                                         12830051
116400                    CONTINUE                                      12840051
116500                                                                  12850051
116600           END-EVALUATE                                           12860051
116700                                                                  12870051
116800        END-IF                                                    12880051
116900     END-IF.                                                      12890051
117000                                                                  12900051
117100                                                                  12910051
117200*-----------------------------------------------------------------12920051
117300* VALIDATE PRINTER ID                                             12930051
117400*-----------------------------------------------------------------12940051
117500     IF  PS-NO-ERROR                                              12950051
117600         PERFORM 3010-VALIDATE-PRINTER-ID                         12960051
117700     END-IF.                                                      12970051
117800                                                                  12980051
117900                                                                  12990051
118000*-----------------------------------------------------------------13000051
118100* VERIFY THAT PULL NUMBER (IF ENTERED) IS NUMERIC                 13010051
118200*-----------------------------------------------------------------13020051
118300     IF  ASC-PULL-NBR  >  SPACES                                  13030051
118400         MOVE ASC-PULL-NBR             TO DP010I-UNEDITED-FIELD   13040051
118500         MOVE LENGTH OF ASC-PULL-NBR   TO DP010I-MAXIMUM-DIGITS   13050051
118600         MOVE ZERO                     TO DP010I-MAXIMUM-DECIMALS 13060051
118700         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  13070051
263455         CALL DP010I-NUMERIC-EDIT-ROUTINE                         13080052
263455              USING DP010I-NUMERIC-EDIT-AREA                      13090052
118900         IF  DP010I-ERROR-DETECTED                                13100051
119000             SET PS-ERROR                                         13110051
119100                 DP020-MSG-FATAL       TO TRUE                    13120051
119200             MOVE PC-TSYMSG-00008      TO DP020-MSG-NUMBER        13130051
119300             MOVE DP015-UNP-ALP-BRT-OFF                           13140051
119400                                       TO MPULLNOA                13150051
119500             MOVE DP015-RED            TO MPULLNOC                13160051
119600             MOVE DP015-REVERSE        TO MPULLNOH                13170051
119700             MOVE -1                   TO MPULLNOL                13180051
119800             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  13190051
119900         ELSE                                                     13200051
120000             MOVE DP010I-NUMERIC-FIELD                            13210051
120100                                   TO ASC-PULL-NBR-N              13220051
120200                                      MPULLNOO                    13230051
120300         END-IF                                                   13240051
120400     END-IF.                                                      13250051
120500                                                                  13260051
120600*-----------------------------------------------------------------13270051
120700* VERIFY PULL NUMBER (IF ENTERED) IS VALID                        13280051
120800*-----------------------------------------------------------------13290051
120900     IF  ASC-PULL-NBR > ZEROES                                    13300051
121000         MOVE ASC-PULL-NBR-N  TO  DK-PULL-NUMBER                  13310051
121100         IF PS-NO-ERROR                                           13320051
121200             EXEC SQL                                             13330051
121300                 SELECT CNSTK_REQ_PL_NBR                          13340051
121400                       ,CNSTK_LOC_ID                              13350051
121500                       ,SRC_REF_NBR                               13360051
121600                       ,SRC_TYP_CDE                               13370051
121700                       ,STAT_CDE                                  13380051
121800                   INTO :CEPLRQ-CNSTK-REQ-PL-NBR                  13390051
121900                       ,:CEPLRQ-CNSTK-LOC-ID                      13400051
122000                       ,:CEPLRQ-SRC-REF-NBR                       13410051
122100                       ,:CEPLRQ-SRC-TYP-CDE                       13420051
122200                       ,:CEPLRQ-STAT-CDE                          13430051
122300                   FROM TCEPLRQ                                   13440051
122400                  WHERE CNSTK_REQ_PL_NBR  =  :DK-PULL-NUMBER      13450051
122500             END-EXEC                                             13460051
122600                                                                  13470051
122700             EVALUATE TRUE                                        13480051
122800                 WHEN SQLCODE = +0                                13490051
122900                      MOVE  CEPLRQ-STAT-CDE                       13500051
123000                            TO  ASC-CURR-PULL-STATUS              13510051
123100                      MOVE  CEPLRQ-SRC-TYP-CDE                    13520051
123200                            TO  ASC-CURR-PULL-TYPE                13530051
123300                 WHEN SQLCODE = +100                              13540051
123400                     SET PS-ERROR                                 13550051
123500                         DP020-MSG-FATAL   TO TRUE                13560051
123600                     MOVE PC-TSYMSG-02214  TO DP020-MSG-NUMBER    13570051
123700                     MOVE DP015-UNP-ALP-BRT-OFF                   13580051
123800                                           TO MPULLNOA            13590051
123900                     MOVE DP015-RED        TO MPULLNOC            13600051
124000                     MOVE DP015-REVERSE    TO MPULLNOH            13610051
124100                     MOVE -1               TO MPULLNOL            13620051
124200                     SET DP030-SET-CURSOR-APPL-1 TO TRUE          13630051
124300                 WHEN OTHER                                       13640051
124400                      MOVE  ASC-PULL-NBR   TO PV-DISPLAY-PULL-NBR 13650051
124500                      MOVE '3000-EDIT-DATA-IN-COMMAREA'           13660051
124600                                       TO DP013-PARAGRAPH         13670051
124700                      MOVE 'VERIFY PULL NUMBER IN SYSTEM'         13680051
124800                                       TO DP013-MESSAGE-TEXT (1)  13690051
124900                      STRING ' PULL NBR-'  DELIMITED BY SIZE      13700051
125000                              PV-DISPLAY-PULL-NBR                 13710051
125100                                           DELIMITED BY SIZE      13720051
125200                                     INTO DP013-MESSAGE-TEXT (2)  13730051
125300                      MOVE SQLCA   TO DP013-SQLCA                 13740051
125400                      MOVE 'TCEPLRQ ' TO DP013-DB2-TABLE-NAME (1) 13750051
125500                      SET DP013-DB2-ABEND                         13760051
125600                          DP013-XCTL-DISPLAY-RESTART              13770051
125700                                       TO TRUE                    13780051
125800                      PERFORM DP013-0000-PROCESS-ABEND            13790051
125900             END-EVALUATE                                         13800051
126000         END-IF                                                   13810051
126100     END-IF.                                                      13820051
126200                                                                  13830051
126300                                                                  13840051
126400*-----------------------------------------------------------------13850051
126500* VERIFY REFERENCE NUMBER (IF ENTERED) IS VALID                   13860051
126600*-----------------------------------------------------------------13870051
126700     IF  ASC-REF-NBR > SPACES                                     13880051
126800         IF PS-NO-ERROR                                           13890051
126900             EXEC SQL                                             13900051
127000                 SELECT COUNT(*)                                  13910051
127100                   INTO :PV-REF-NBR-COUNT                         13920051
127200                   FROM TCEPLRQ                                   13930051
127300                  WHERE SRC_REF_NBR  =  :ASC-REF-NBR              13940051
127400             END-EXEC                                             13950051
127500                                                                  13960051
127600             EVALUATE TRUE                                        13970051
127700                 WHEN SQLCODE = +0                                13980051
127800                      IF  PV-REF-NBR-COUNT  =  ZEROES             13990051
127900                          SET PS-ERROR                            14000051
128000                          DP020-MSG-FATAL   TO TRUE               14010051
128100                          MOVE PC-TSYMSG-02215                    14020051
128200                                            TO DP020-MSG-NUMBER   14030051
128300                          MOVE DP015-UNP-ALP-BRT-OFF              14040051
128400                                           TO MREFNOA             14050051
128500                          MOVE DP015-RED        TO MREFNOC        14060051
128600                          MOVE DP015-REVERSE    TO MREFNOH        14070051
128700                          MOVE -1               TO MREFNOL        14080051
128800                          SET DP030-SET-CURSOR-APPL-1 TO TRUE     14090051
128900                      END-IF                                      14100051
129000                 WHEN SQLCODE = +100                              14110051
129100                     SET PS-ERROR                                 14120051
129200                         DP020-MSG-FATAL   TO TRUE                14130051
129300                     MOVE PC-TSYMSG-02215  TO DP020-MSG-NUMBER    14140051
129400                     MOVE DP015-UNP-ALP-BRT-OFF                   14150051
129500                                           TO MREFNOA             14160051
129600                     MOVE DP015-RED        TO MREFNOC             14170051
129700                     MOVE DP015-REVERSE    TO MREFNOH             14180051
129800                     MOVE -1               TO MREFNOL             14190051
129900                     SET DP030-SET-CURSOR-APPL-1 TO TRUE          14200051
130000                 WHEN OTHER                                       14210051
130100                      MOVE '3000-EDIT-DATA-IN-COMMAREA'           14220051
130200                                       TO DP013-PARAGRAPH         14230051
130300                      MOVE 'VERIFY REF NUMBER IN SYSTEM'          14240051
130400                                       TO DP013-MESSAGE-TEXT (1)  14250051
130500                      STRING ' REF NBR-'  DELIMITED BY SIZE       14260051
130600                              ASC-REF-NBR DELIMITED BY SIZE       14270051
130700                                     INTO DP013-MESSAGE-TEXT (2)  14280051
130800                      MOVE SQLCA   TO DP013-SQLCA                 14290051
130900                      MOVE 'TCEPLRQ ' TO DP013-DB2-TABLE-NAME (1) 14300051
131000                      SET DP013-DB2-ABEND                         14310051
131100                          DP013-XCTL-DISPLAY-RESTART              14320051
131200                                       TO TRUE                    14330051
131300                      PERFORM DP013-0000-PROCESS-ABEND            14340051
131400             END-EVALUATE                                         14350051
131500         END-IF                                                   14360051
131600     END-IF.                                                      14370051
131700                                                                  14380051
131800                                                                  14390051
131900*-----------------------------------------------------------------14400051
132000* VERIFY PULL NUMBER & REFERENCE NUMBER IF BOTH ENTERED           14410051
132100*-----------------------------------------------------------------14420051
132200     IF  ASC-PULL-NBR > ZEROES  AND                               14430051
132300         ASC-REF-NBR  > SPACES                                    14440051
132400         MOVE ASC-PULL-NBR  TO  DK-PULL-NUMBER                    14450051
132500         IF PS-NO-ERROR                                           14460051
132600             EXEC SQL                                             14470051
132700                 SELECT CNSTK_REQ_PL_NBR                          14480051
132800                       ,SRC_REF_NBR                               14490051
132900                       ,SRC_TYP_CDE                               14500051
133000                       ,STAT_CDE                                  14510051
133100                   INTO :CEPLRQ-CNSTK-REQ-PL-NBR                  14520051
133200                       ,:CEPLRQ-SRC-REF-NBR                       14530051
133300                       ,:CEPLRQ-SRC-TYP-CDE                       14540051
133400                       ,:CEPLRQ-STAT-CDE                          14550051
133500                   FROM TCEPLRQ                                   14560051
133600                  WHERE CNSTK_REQ_PL_NBR  =  :DK-PULL-NUMBER      14570051
133700                    AND SRC_REF_NBR       =  :ASC-REF-NBR         14580051
133800             END-EXEC                                             14590051
133900                                                                  14600051
134000             EVALUATE TRUE                                        14610051
134100                 WHEN SQLCODE = +0                                14620051
134200                      CONTINUE                                    14630051
134300                 WHEN SQLCODE = +100                              14640051
134400                     SET PS-ERROR                                 14650051
134500                         DP020-MSG-FATAL   TO TRUE                14660051
134600                     MOVE PC-TSYMSG-02216  TO DP020-MSG-NUMBER    14670051
134700                     MOVE DP015-UNP-ALP-BRT-OFF                   14680051
134800                                           TO MPULLNOA            14690051
134900                                              MREFNOA             14700051
135000                     MOVE DP015-RED        TO MPULLNOC            14710051
135100                                              MREFNOC             14720051
135200                     MOVE DP015-REVERSE    TO MPULLNOH            14730051
135300                                              MREFNOH             14740051
135400                     MOVE -1               TO MPULLNOL            14750051
135500                     SET DP030-SET-CURSOR-APPL-1 TO TRUE          14760051
135600                 WHEN OTHER                                       14770051
135700                      MOVE  ASC-PULL-NBR   TO PV-DISPLAY-PULL-NBR 14780051
135800                      MOVE '3000-EDIT-DATA-IN-COMMAREA'           14790051
135900                                       TO DP013-PARAGRAPH         14800051
136000                      MOVE 'VERIFY PULL NBR/REF NBR COMBINATION'  14810051
136100                                       TO DP013-MESSAGE-TEXT (1)  14820051
136200                      STRING ' PULL NBR-'  DELIMITED BY SIZE      14830051
136300                              PV-DISPLAY-PULL-NBR                 14840051
136400                                           DELIMITED BY SIZE      14850051
136500                             '  REF NBR-'  DELIMITED BY SIZE      14860051
136600                              ASC-REF-NBR  DELIMITED BY SIZE      14870051
136700                                     INTO DP013-MESSAGE-TEXT (2)  14880051
136800                      MOVE SQLCA   TO DP013-SQLCA                 14890051
136900                      MOVE 'TCEPLRQ ' TO DP013-DB2-TABLE-NAME (1) 14900051
137000                      SET DP013-DB2-ABEND                         14910051
137100                          DP013-XCTL-DISPLAY-RESTART              14920051
137200                                       TO TRUE                    14930051
137300                      PERFORM DP013-0000-PROCESS-ABEND            14940051
137400             END-EVALUATE                                         14950051
137500         END-IF                                                   14960051
137600     END-IF.                                                      14970051
137700                                                                  14980051
137800                                                                  14990051
137900     IF  PS-NO-ERROR                                              15000051
138000         IF  ASC-REF-NBR  > SPACES                                15010051
138100             CONTINUE                                             15020051
138200         ELSE                                                     15030051
138300             IF  CEPLRQ-SRC-REF-NBR  >  SPACES                    15040051
138400                 MOVE  CEPLRQ-SRC-REF-NBR  TO  ASC-REF-NBR        15050051
138500             END-IF                                               15060051
138600         END-IF                                                   15070051
138700         MOVE  CEPLRQ-SRC-TYP-CDE  TO  ASC-CURR-PULL-TYPE         15080051
138800         MOVE  CEPLRQ-STAT-CDE     TO  ASC-CURR-PULL-STATUS       15090051
138900     END-IF.                                                      15100051
139000                                                                  15110051
139100                                                                  15120051
139200                                                                  15130051
139300*-----------------------------------------------------------------15140051
139400* VALIDATE PULL STATUS - IF ENTERED                               15150051
139500*-----------------------------------------------------------------15160051
139600     IF  ASC-PULL-SELECT-STATUS  >  SPACES                        15170051
139700         IF  PS-NO-ERROR                                          15180051
139800             IF  ASC-SELECT-VALID                                 15190051
139900                 CONTINUE                                         15200051
140000             ELSE                                                 15210051
140100                 SET PS-ERROR                                     15220051
140200                 DP020-MSG-FATAL             TO TRUE              15230051
140300                 MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER  15240051
140400                 MOVE DP015-UNP-ALP-BRT-OFF  TO MPULLSTA          15250051
140500                 MOVE DP015-RED              TO MPULLSTC          15260051
140600                 MOVE DP015-REVERSE          TO MPULLSTH          15270051
140700                 MOVE -1                     TO MPULLSTL          15280051
140800                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              15290051
140900             END-IF                                               15300051
141000         END-IF                                                   15310051
141100     END-IF.                                                      15320051
141200                                                                  15330051
141300                                                                  15340051
141400*-----------------------------------------------------------------15350051
141500* VALIDATE PULL SOURCE TYPE - IF ENTERED                          15360051
141600*-----------------------------------------------------------------15370051
141700     IF  ASC-PULL-SELECT-TYPE  >  SPACES                          15380051
141800         IF  PS-NO-ERROR                                          15390051
141900             IF  ASC-SELECT-SRC-VALID                             15400051
142000                 CONTINUE                                         15410051
142100             ELSE                                                 15420051
142200                 SET PS-ERROR                                     15430051
142300                 DP020-MSG-FATAL             TO TRUE              15440051
142400                 MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER  15450051
142500                 MOVE DP015-UNP-ALP-BRT-OFF  TO MSRCTYPA          15460051
142600                 MOVE DP015-RED              TO MSRCTYPC          15470051
142700                 MOVE DP015-REVERSE          TO MSRCTYPH          15480051
142800                 MOVE -1                     TO MSRCTYPL          15490051
142900                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              15500051
143000             END-IF                                               15510051
143100         END-IF                                                   15520051
143200     END-IF.                                                      15530051
143300                                                                  15540051
143400                                                                  15550051
143500*-----------------------------------------------------------------15560051
143600* VALIDATE PULL LIST SEQUENCE - IF ENTERED                        15570051
143700*-----------------------------------------------------------------15580051
143800     IF  ASC-SELECT-LIST-SEQUENCE  >  SPACES                      15590051
143900         IF  PS-NO-ERROR                                          15600051
144000             IF  ASC-LIST-SEQ-VALID                               15610051
144100                 CONTINUE                                         15620051
144200             ELSE                                                 15630051
144300                 SET PS-ERROR                                     15640051
144400                 DP020-MSG-FATAL             TO TRUE              15650051
144500                 MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER  15660051
144600                 MOVE DP015-UNP-ALP-BRT-OFF  TO MLSTSEQA          15670051
144700                 MOVE DP015-RED              TO MLSTSEQC          15680051
144800                 MOVE DP015-REVERSE          TO MLSTSEQH          15690051
144900                 MOVE -1                     TO MLSTSEQL          15700051
145000                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              15710051
145100             END-IF                                               15720051
145200         END-IF                                                   15730051
145300     END-IF.                                                      15740051
145400                                                                  15750051
145500                                                                  15760051
145600*-----------------------------------------------------------------15770051
145700*  VALIDATE CREATE FROM AND TO DATES                              15780051
145800*-----------------------------------------------------------------15790051
145900                                                                  15800051
146000     PERFORM 3030-VALIDATE-FROM-TO.                               15810051
146200                                                                  15820051
146796*-----------------------------------------------------------------15830051
146797* VERIFY THAT DEPT NUMBER (IF ENTERED) IS NUMERIC                 15840051
146798*-----------------------------------------------------------------15850051
146800     MOVE SPACES                       TO MDPTDESO                15860051
146801                                          ASC-DEPT-DESC.          15870051
146802     IF  PS-NO-ERROR                                              15880051
146803       IF  ASC-DEPT-NBR  >  SPACES                                15890051
146810         MOVE ASC-DEPT-NBR             TO DP010I-UNEDITED-FIELD   15900051
146900         MOVE LENGTH OF ASC-DEPT-NBR   TO DP010I-MAXIMUM-DIGITS   15910051
147000         MOVE ZERO                     TO DP010I-MAXIMUM-DECIMALS 15920051
147100         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  15930051
263455         CALL DP010I-NUMERIC-EDIT-ROUTINE                         15940052
263455              USING DP010I-NUMERIC-EDIT-AREA                      15950052
147300         IF  DP010I-ERROR-DETECTED                                15960051
147400             SET PS-ERROR                                         15970051
147500                 DP020-MSG-FATAL       TO TRUE                    15980051
147600             MOVE PC-TSYMSG-00008      TO DP020-MSG-NUMBER        15990051
147700             MOVE DP015-UNP-ALP-BRT-OFF                           16000051
147800                                       TO MDEPTNOA                16010051
147900             MOVE DP015-RED            TO MDEPTNOC                16020051
148000             MOVE DP015-REVERSE        TO MDEPTNOH                16030051
148100             MOVE -1                   TO MDEPTNOL                16040051
148200             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  16050051
148300         ELSE                                                     16060051
148400             MOVE DP010I-NUMERIC-FIELD                            16070051
148500                                   TO ASC-DEPT-NBR-N              16080051
148600                                      MDEPTNOO                    16090051
148700         END-IF                                                   16100051
148800       END-IF                                                     16110051
148900     END-IF.                                                      16120051
149000                                                                  16130051
149501                                                                  16140051
149502* CLT 07/01/2010 START WR#38786                                   16150051
149503*-----------------------------------------------------------------16160051
149504* VERIFY THAT MCL NUMBER (IF ENTERED) IS NUMERIC                  16170051
149505*-----------------------------------------------------------------16180051
149506     IF  PS-NO-ERROR                                              16190051
149507       IF  ASC-MAJ-CLASS  >  SPACES                               16200051
149508         MOVE ASC-MAJ-CLASS           TO DP010I-UNEDITED-FIELD    16210051
149509         MOVE LENGTH OF ASC-MAJ-CLASS TO DP010I-MAXIMUM-DIGITS    16220051
149510         MOVE ZERO                     TO DP010I-MAXIMUM-DECIMALS 16230051
149511         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  16240051
263455         CALL DP010I-NUMERIC-EDIT-ROUTINE                         16250052
263455              USING DP010I-NUMERIC-EDIT-AREA                      16260052
149513         IF  DP010I-ERROR-DETECTED                                16270051
149514             SET PS-ERROR                                         16280051
149515                 DP020-MSG-FATAL       TO TRUE                    16290051
149516             MOVE PC-TSYMSG-00008      TO DP020-MSG-NUMBER        16300051
149517             MOVE DP015-UNP-ALP-BRT-OFF                           16310051
149518                                       TO MMCLASSA                16320051
149519             MOVE DP015-RED            TO MMCLASSC                16330051
149520             MOVE DP015-REVERSE        TO MMCLASSH                16340051
149521             MOVE -1                   TO MMCLASSL                16350051
149522             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  16360051
149523         ELSE                                                     16370051
149524             MOVE DP010I-NUMERIC-FIELD                            16380051
149525                                   TO ASC-MAJ-CLASS-N             16390051
149526                                      MMCLASSO                    16400051
149527         END-IF                                                   16410051
149528       END-IF                                                     16420051
149529     END-IF.                                                      16430051
149530*-----------------------------------------------------------------16440051
149531* VERIFY THAT SUB NUMBER (IF ENTERED) IS NUMERIC                  16450051
149532*-----------------------------------------------------------------16460051
149533     IF  PS-NO-ERROR                                              16470051
149534       IF  ASC-SUB-CLASS  >  SPACES                               16480051
149535         MOVE ASC-SUB-CLASS           TO DP010I-UNEDITED-FIELD    16490051
149536         MOVE LENGTH OF ASC-SUB-CLASS TO DP010I-MAXIMUM-DIGITS    16500051
149537         MOVE ZERO                     TO DP010I-MAXIMUM-DECIMALS 16510051
149538         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  16520051
263455         CALL DP010I-NUMERIC-EDIT-ROUTINE                         16530052
263455              USING DP010I-NUMERIC-EDIT-AREA                      16540052
149540         IF  DP010I-ERROR-DETECTED                                16550051
149541             SET PS-ERROR                                         16560051
149542                 DP020-MSG-FATAL       TO TRUE                    16570051
149543             MOVE PC-TSYMSG-00008      TO DP020-MSG-NUMBER        16580051
149544             MOVE DP015-UNP-ALP-BRT-OFF                           16590051
149545                                       TO MSCLASSA                16600051
149546             MOVE DP015-RED            TO MSCLASSC                16610051
149547             MOVE DP015-REVERSE        TO MSCLASSH                16620051
149548             MOVE -1                   TO MSCLASSL                16630051
149549             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  16640051
149550         ELSE                                                     16650051
149551             MOVE DP010I-NUMERIC-FIELD                            16660051
149552                                   TO ASC-SUB-CLASS-N             16670051
149553                                      MSCLASSO                    16680051
149554         END-IF                                                   16690051
149555       END-IF                                                     16700051
149556     END-IF.                                                      16710051
149557                                                                  16720051
149558     IF  PS-NO-ERROR                                              16730051
149559         IF  ASC-DEPT-NBR > SPACES                                16740051
149560             PERFORM 4100-VALIDATE-DEPT                           16750051
149561         END-IF                                                   16760051
149562     END-IF.                                                      16770051
149563                                                                  16780051
149564*-----------------------------------------------------------------16790051
149565* VERIFY SUB   CLASS - MUST BE ENTERED WITH MAJOR CLASS & DEPT    16800051
149566*-----------------------------------------------------------------16810051
149567     IF  PS-NO-ERROR                                              16820051
149568       IF  ASC-DEPT-NBR   > SPACES  AND                           16830051
149570           ASC-MAJ-CLASS  > SPACES  AND                           16840051
149580           ASC-SUB-CLASS  > SPACES                                16850051
149590           MOVE ASC-DEPT-NBR  TO  DK-DEPT-NUMBER                  16860051
149591                                  DK-DEPT-NUMBER-PACKED           16870051
149592           MOVE ASC-MAJ-CLASS TO  DK-MAJ-CLASS                    16880051
149593                                  DK-MAJ-CLASS-PACKED             16890051
149594           MOVE ASC-SUB-CLASS TO  DK-SUB-CLASS                    16900051
149595                                  DK-SUB-CLASS-PACKED             16910051
149596             EXEC SQL                                             16920051
149597                 SELECT  TKT_TYP_DESC                             16930051
149598                   INTO :XLV00001-TKT-TYP-DESC                    16940051
149599                   FROM  XLV_VND_STYL                             16950051
149600                  WHERE  DEPT_NBR    = :DK-DEPT-NUMBER-PACKED     16960051
149601                    AND  MAJ_CL_NBR  = :DK-MAJ-CLASS-PACKED       16970051
149602                    AND  SUB_CL_NBR  = :DK-SUB-CLASS-PACKED       16980051
149603             END-EXEC                                             16990051
149604                                                                  17000051
149605             EVALUATE TRUE                                        17010051
149606                 WHEN SQLCODE = +0 OR -811                        17020051
149607                      CONTINUE                                    17030051
149608                 WHEN SQLCODE = +100                              17040051
149609                     SET PS-ERROR                                 17050051
149610                         DP020-MSG-FATAL   TO TRUE                17060051
149611                     MOVE DP015-UNP-ALP-BRT-OFF                   17070051
149612                                           TO MMCLASSA            17080051
149613                                              MSCLASSA            17090051
149614                                              MDEPTNOA            17100051
149615                     MOVE DP015-RED        TO MMCLASSC            17110051
149616                                              MSCLASSC            17120051
149617                                              MDEPTNOC            17130051
149618                     MOVE DP015-REVERSE    TO MMCLASSH            17140051
149619                                              MSCLASSH            17150051
149620                                              MDEPTNOH            17160051
149621                     MOVE -1               TO MMCLASSL            17170051
149622                     MOVE '** INVALID DEPT-MCL   ** '             17180051
149623                                           TO MDPTDESO            17190051
149624                                              ASC-DEPT-DESC       17200051
149625                     SET DP030-SET-CURSOR-APPL-1 TO TRUE          17210051
149626                 WHEN OTHER                                       17220051
149627                     SET  PS-ERROR                                17230051
149628                          DP020-MSG-FATAL  TO TRUE                17240051
149629                     MOVE PC-TSYMSG-00032  TO DP020-MSG-NUMBER    17250051
149630                     MOVE DP015-UNP-ALP-BRT-OFF  TO MDEPTNOA      17260051
149631                                                    MMCLASSA      17270051
149632                                                    MSCLASSA      17280051
149633                     MOVE DP015-RED              TO MDEPTNOC      17290051
149634                                                    MMCLASSC      17300051
149635                                                    MSCLASSC      17310051
149636                     MOVE DP015-REVERSE          TO MDEPTNOH      17320051
149637                                                    MMCLASSH      17330051
149638                                                    MSCLASSH      17340051
149639                     MOVE -1                     TO MDEPTNOL      17350051
149640                                                    MMCLASSL      17360051
149641                                                    MSCLASSL      17370051
149642                     SET  DP030-SET-CURSOR-APPL-1 TO TRUE         17380051
149643             END-EVALUATE                                         17390051
149644       END-IF                                                     17400051
149645     END-IF.                                                      17410051
149646                                                                  17420051
149647     IF PS-NO-ERROR                                               17430051
149648         IF ASC-SUB-CLASS     > SPACES     AND                    17440051
149649            ASC-MAJ-CLASS     > SPACES     AND                    17450051
149650           (ASC-DEPT-NBR  NOT > SPACES)                           17460051
149651             MOVE DP015-UNP-ALP-BRT-OFF                           17470051
149652                                   TO MDEPTNOA                    17480051
149653             MOVE DP015-RED        TO MDEPTNOC                    17490051
149654                                      MMCLASSC                    17500051
149655                                      MSCLASSC                    17510051
149656             MOVE DP015-REVERSE    TO MDEPTNOH                    17520051
149657             MOVE -1               TO MDEPTNOL                    17530051
149658             MOVE '** INVALID DEPT-MCL-SCL **'                    17540051
149659                                   TO MDPTDESO                    17550051
149660                                      ASC-DEPT-DESC               17560051
149661             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  17570051
149662             SET PS-ERROR          TO TRUE                        17580051
149663         ELSE                                                     17590051
149664             IF ASC-SUB-CLASS     > SPACES     AND                17600051
149665               (ASC-MAJ-CLASS NOT > SPACES)    AND                17610051
149666                ASC-DEPT-NBR      > SPACES                        17620051
149667                 MOVE DP015-UNP-ALP-BRT-OFF                       17630051
149668                                   TO MMCLASSA                    17640051
149669                 MOVE DP015-RED            TO MMCLASSC            17650051
149670                                              MSCLASSC            17660051
149671                 MOVE DP015-REVERSE        TO MDEPTNOH            17670051
149672                 MOVE -1                   TO MDEPTNOL            17680051
149673                 MOVE '** INVALID DEPT-MCL-SCL **'                17690051
149674                                           TO MDPTDESO            17700051
149675                                              ASC-DEPT-DESC       17710051
149676                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              17720051
149677                 SET PS-ERROR            TO TRUE                  17730051
149678             ELSE                                                 17740051
149679                 IF ASC-SUB-CLASS     > SPACES     AND            17750051
149680                   (ASC-MAJ-CLASS NOT > SPACES)    AND            17760051
149681                   (ASC-DEPT-NBR  NOT > SPACES)                   17770051
149682                     MOVE DP015-UNP-ALP-BRT-OFF                   17780051
149683                                   TO MDEPTNOA                    17790051
149684                     MOVE DP015-RED     TO MDEPTNOC               17800051
149685                                           MMCLASSC               17810051
149686                                           MSCLASSC               17820051
149687                     MOVE DP015-REVERSE TO MDEPTNOH               17830051
149688                     MOVE -1            TO MDEPTNOL               17840051
149689                     MOVE '** INVALID DEPT-MCL-SCL **'            17850051
149690                                        TO MDPTDESO               17860051
149691                                           ASC-DEPT-DESC          17870051
149692                     SET DP030-SET-CURSOR-APPL-1 TO TRUE          17880051
149693                     SET PS-ERROR          TO TRUE                17890051
149694                 END-IF                                           17900051
149695             END-IF                                               17910051
149696         END-IF                                                   17920051
149697     END-IF.                                                      17930051
149698                                                                  17940051
149699*-----------------------------------------------------------------17950051
149700* VERIFY MAJOR CLASS - MUST BE ENTERED WITH DEPT                  17960051
149701*-----------------------------------------------------------------17970051
149702     IF  PS-NO-ERROR                                              17980051
149703       IF  ASC-DEPT-NBR   > SPACES  AND                           17990051
149704           ASC-MAJ-CLASS  > SPACES                                18000051
149705           MOVE ASC-DEPT-NBR  TO  DK-DEPT-NUMBER                  18010051
149706                                  DK-DEPT-NUMBER-PACKED           18020051
149707           MOVE ASC-MAJ-CLASS TO  DK-MAJ-CLASS                    18030051
149708                                  DK-MAJ-CLASS-PACKED             18040051
149709                                                                  18050051
149710             EXEC SQL                                             18060051
149711                 SELECT  TKT_TYP_DESC                             18070051
149712                   INTO :XLV00001-TKT-TYP-DESC                    18080051
149713                   FROM  XLV_VND_STYL                             18090051
149714                  WHERE  DEPT_NBR    = :DK-DEPT-NUMBER-PACKED     18100051
149715                    AND  MAJ_CL_NBR  = :DK-MAJ-CLASS-PACKED       18110051
149716             END-EXEC                                             18120051
149717                                                                  18130051
149718             EVALUATE TRUE                                        18140051
149719                 WHEN SQLCODE = +0 OR -811                        18150051
149720                      CONTINUE                                    18160051
149721                 WHEN SQLCODE = +100                              18170051
149722                     SET PS-ERROR                                 18180051
149723                         DP020-MSG-FATAL   TO TRUE                18190051
149724                     MOVE DP015-UNP-ALP-BRT-OFF                   18200051
149725                                           TO MMCLASSA            18210051
149726                                              MDEPTNOA            18220051
149727                     MOVE DP015-RED        TO MMCLASSC            18230051
149728                                              MDEPTNOC            18240051
149729                     MOVE DP015-REVERSE    TO MMCLASSH            18250051
149730                                              MDEPTNOH            18260051
149731                     MOVE -1               TO MMCLASSL            18270051
149732                     MOVE '** INVALID DEPT-MCL   ** '             18280051
149733                                           TO MDPTDESO            18290051
149734                                              ASC-DEPT-DESC       18300051
149735                     SET DP030-SET-CURSOR-APPL-1 TO TRUE          18310051
149736                 WHEN OTHER                                       18320051
149737                     SET  PS-ERROR                                18330051
149738                          DP020-MSG-FATAL  TO TRUE                18340051
149739                     MOVE PC-TSYMSG-00032  TO DP020-MSG-NUMBER    18350051
149740                     MOVE DP015-UNP-ALP-BRT-OFF  TO MDEPTNOA      18360051
149741                                                    MMCLASSA      18370051
149742                     MOVE DP015-RED              TO MDEPTNOC      18380051
149743                                                    MMCLASSC      18390051
149744                     MOVE DP015-REVERSE          TO MDEPTNOH      18400051
149745                                                    MMCLASSH      18410051
149746                     MOVE -1                     TO MDEPTNOL      18420051
149747                                                    MMCLASSL      18430051
149748                     SET  DP030-SET-CURSOR-APPL-1 TO TRUE         18440051
149749             END-EVALUATE                                         18450051
149750       END-IF                                                     18460051
149751     END-IF.                                                      18470051
149752                                                                  18480051
149753     IF ASC-MAJ-CLASS     > SPACES     AND                        18490051
149754       (ASC-DEPT-NBR  NOT > SPACES)    AND                        18500051
149755        PS-NO-ERROR                                               18510051
149756         MOVE DP015-UNP-ALP-BRT-OFF                               18520051
149757                                   TO MDEPTNOA                    18530051
149758         MOVE DP015-RED            TO MDEPTNOC                    18540051
149759                                      MMCLASSC                    18550051
149760         MOVE DP015-REVERSE        TO MDEPTNOH                    18560051
149761         MOVE -1                   TO MDEPTNOL                    18570051
149762         MOVE '** INVALID DEPT-MCL   ** '                         18580051
149763                                   TO MDPTDESO                    18590051
149764                                      ASC-DEPT-DESC               18600051
149765         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      18610051
149766         SET PS-ERROR          TO TRUE                            18620051
149767     END-IF.                                                      18630051
149768                                                                  18640051
149769* CLT 07/01/2010 END                                              18650051
149770                                                                  18660051
149780********************************************                      18670051
149800* F15 - RESEND          (LOCAL-FUNC-09)    *                      18680051
149900********************************************                      18690051
150000                                                                  18700051
150100     IF DP020-FK-LOCAL-FUNC-09 (DP020-SRC-AID)                    18710051
150200        IF PS-NO-ERROR                                            18720051
150300           PERFORM 3390-VALIDATE-RDM-FACILITY                     18730051
150310           IF PS-VALID-RDM-FACILITY                               18740051
150320              CONTINUE                                            18750051
150330           ELSE                                                   18760051
150340              PERFORM 3391-CHECK-CE-PULL-LOC                      18770051
150400           END-IF                                                 18780051
150410        END-IF                                                    18790051
150500                                                                  18800051
150600        IF PS-VALID-RDM-FACILITY                                  18810051
150700           CONTINUE                                               18820051
150800        ELSE                                                      18830051
150900           SET  PS-ERROR                                          18840051
151000                DP020-MSG-FATAL                                   18850051
151100                DP030-OVERRIDE-GO TO TRUE                         18860051
151200           MOVE PC-TSYMSG-02516   TO DP020-MSG-NUMBER             18870051
151300           MOVE -1                TO MLOCIDL                      18880051
151400           SET  DP030-SET-CURSOR-APPL-1 TO TRUE                   18890051
151500        END-IF                                                    18900051
151600     END-IF.                                                      18910051
151700                                                                  18920051
151800*-----------------------------------------------------------------18930051
151900* VERIFY NECESSARY FIELDS ENTERED FOR "PULL LIST"                 18940051
152000*  F17 - LOCAL-04                                                 18950051
152100*-----------------------------------------------------------------18960051
152200     IF  DP020-FK-LOCAL-FUNC-04(DP020-SRC-AID)                    18970051
152300         IF  PS-NO-ERROR                                          18980051
152400             PERFORM 3300-PULL-LIST-FIELDS                        18990051
152500         END-IF                                                   19000051
152600     END-IF.                                                      19010051
152700                                                                  19020051
152800*-----------------------------------------------------------------19030051
152900* VERIFY NECESSARY FIELDS ENTERED FOR "ITEM LIST"                 19040051
153000*  F22 - LOCAL-06                                                 19050051
153100*-----------------------------------------------------------------19060051
153200     IF  DP020-FK-LOCAL-FUNC-06(DP020-SRC-AID)                    19070051
153300         IF  PS-NO-ERROR                                          19080051
153400             PERFORM 3310-ITEM-LIST-FIELDS                        19090051
153500         END-IF                                                   19100051
153600     END-IF.                                                      19110051
153700                                                                  19120051
153800                                                                  19130051
153900*-----------------------------------------------------------------19140051
154000* VERIFY NECESSARY FIELDS ENTERED FOR "PRINT PULL"                19150051
154100*  F23 - LOCAL-07                                                 19160051
154200*-----------------------------------------------------------------19170051
154300     IF  DP020-FK-LOCAL-FUNC-07(DP020-SRC-AID)                    19180051
154400         IF  PS-NO-ERROR                                          19190051
154500             PERFORM 3320-PRT-PULL-FIELDS                         19200051
154600         END-IF                                                   19210051
154700     END-IF.                                                      19220051
154800                                                                  19230051
154900                                                                  19240051
155000*-----------------------------------------------------------------19250051
155100* VERIFY USER RACF ACCESS TO CREATE PULL                          19260051
155200*  F13 - LOCAL-01                                                 19270051
155300*-----------------------------------------------------------------19280051
155400     IF  DP020-FK-LOCAL-FUNC-01(DP020-SRC-AID)                    19290051
155500                                                                  19300051
155600         MOVE 'CECSPCNF' TO DP008-FUNCTION-NAME                   19310051
155700         PERFORM 2105-RACF-ACCESS                                 19320051
155800         IF  PS-ACCESS-NOT-ALLOWED                                19330051
155900             SET  PS-ERROR                                        19340051
156000                  DP020-MSG-FATAL TO TRUE                         19350051
156100             MOVE PC-TSYMSG-02327 TO DP020-MSG-NUMBER             19360051
156200             MOVE -1              TO MPULLNOL                     19370051
156300             SET  DP030-SET-CURSOR-APPL-1 TO TRUE                 19380051
156400         END-IF                                                   19390051
156500                                                                  19400051
156600     END-IF.                                                      19410051
156700                                                                  19420051
156800*-----------------------------------------------------------------19430051
156900* VERIFY RACF AUTHORITY FOR "UNCANCEL/CANCEL"                     19440051
157000*  F14 - LOCAL-02 (CHECK WHEN DOWNLOADED TO RDM) 12/17/01 BUD     19450051
157100*-----------------------------------------------------------------19460051
157200     IF  DP020-FK-LOCAL-FUNC-02(DP020-SRC-AID)                    19470051
157300                                                                  19480051
157400         EXEC SQL                                                 19490051
157500             SELECT  CNSTK_REQ_PL_NBR                             19500051
157600               INTO :CEPLIT-CNSTK-REQ-PL-NBR                      19510051
157700               FROM  TCEPLIT                                      19520051
157800              WHERE  CNSTK_REQ_PL_NBR  =  :DK-PULL-NUMBER         19530051
157900                AND  DWNLD_RDM_STAT_CDE IN ('X','R')              19540051
158000         END-EXEC                                                 19550051
158100                                                                  19560051
158200         EVALUATE TRUE                                            19570051
158300             WHEN SQLCODE = ZERO                                  19580051
158400             WHEN SQLCODE = -811                                  19590051
158500                                                                  19600051
158600             MOVE 'CECSCNCL' TO DP008-FUNCTION-NAME               19610051
158700             PERFORM 2105-RACF-ACCESS                             19620051
158800             IF  PS-ACCESS-NOT-ALLOWED                            19630051
158900                 SET  PS-ERROR                                    19640051
159000                   DP020-MSG-FATAL TO TRUE                        19650051
159100                 MOVE PC-TSYMSG-02880 TO DP020-MSG-NUMBER         19660051
159200                 MOVE -1              TO MPULLNOL                 19670051
159300                 SET  DP030-SET-CURSOR-APPL-1 TO TRUE             19680051
159400             END-IF                                               19690051
159500                                                                  19700051
159600             WHEN OTHER                                           19710051
159700                 CONTINUE                                         19720051
159800         END-EVALUATE                                             19730051
159900     END-IF.                                                      19740051
160000                                                                  19750051
160100*-----------------------------------------------------------------19760051
160200* VERIFY NECESSARY FIELDS ENTERED FOR "UNCANCEL/CANCEL"           19770051
160300*  F14 - LOCAL-02                                                 19780051
160400*-----------------------------------------------------------------19790051
160500     IF  DP020-FK-LOCAL-FUNC-02(DP020-SRC-AID)                    19800051
160600                                                                  19810051
160700         MOVE 'CECSPCNF' TO DP008-FUNCTION-NAME                   19820051
160800         PERFORM 2105-RACF-ACCESS                                 19830051
160900         IF  PS-ACCESS-NOT-ALLOWED                                19840051
161000             SET  PS-ERROR                                        19850051
161100                  DP020-MSG-FATAL TO TRUE                         19860051
161200             MOVE PC-TSYMSG-02307 TO DP020-MSG-NUMBER             19870051
161300             MOVE -1              TO MPULLNOL                     19880051
161400             SET  DP030-SET-CURSOR-APPL-1 TO TRUE                 19890051
161500         END-IF                                                   19900051
161600                                                                  19910051
161700         IF  PS-NO-ERROR                                          19920051
161800             PERFORM 3340-UN-CANCEL-FIELDS                        19930051
161900         END-IF                                                   19940051
162000     END-IF.                                                      19950051
162100                                                                  19960051
162200                                                                  19970051
162300*-----------------------------------------------------------------19980051
162400* VERIFY NECESSARY FIELDS ENTERED FOR "CONFIRM/UNCONFIRM DISTRO"  19990051
162500*  F24 - LOCAL-05                                                 20000051
162600*-----------------------------------------------------------------20010051
162700     IF  DP020-FK-LOCAL-FUNC-05(DP020-SRC-AID)                    20020051
162800                                                                  20030051
162900         MOVE 'CECSPCNF' TO DP008-FUNCTION-NAME                   20040051
163000         PERFORM 2105-RACF-ACCESS                                 20050051
163100         IF  PS-ACCESS-NOT-ALLOWED                                20060051
163200             SET  PS-ERROR                                        20070051
163300                  DP020-MSG-FATAL TO TRUE                         20080051
163400             MOVE PC-TSYMSG-02308 TO DP020-MSG-NUMBER             20090051
163500             MOVE -1              TO MPULLNOL                     20100051
163600             SET  DP030-SET-CURSOR-APPL-1 TO TRUE                 20110051
163700         END-IF                                                   20120051
163800                                                                  20130051
163900         PERFORM 3005-CHECK-FOR-RDM                               20140051
164000                                                                  20150051
164100         IF  PS-NO-ERROR                                          20160051
164200             PERFORM 3360-UN-CNFM-DISTRO-FIELDS                   20170051
164300         END-IF                                                   20180051
164400     END-IF.                                                      20190051
164500                                                                  20200051
164600                                                                  20210051
164700*----------------------------------------------------------------*20220051
164800* VALIDATE CONFIRM/UNCONFIRM FOR RDM                             *20230051
164900*----------------------------------------------------------------*20240051
165000 3005-CHECK-FOR-RDM.                                              20250051
165100      EXEC SQL                                                    20260051
165200        SELECT  1                                                 20270051
165300          INTO  :DK-DUMMY-FIELD                                   20280051
165400           FROM  TCEPLRQ A, TCEPLST B,                            20290051
165500                 TKRPRPM C                                        20300051
165600           WHERE     A.CNSTK_REQ_PL_NBR = B.CNSTK_REQ_PL_NBR      20310051
165700                 AND B.CNSTK_REQ_PL_NBR = :DK-PULL-NUMBER         20320051
165800                 AND A.CNSTK_LOC_ID = C.LOC_ID                    20330051
165900                 AND B.PL_LNE_NBR = 0                             20340051
166000                 AND B.STAT_CDE = 'NW'                            20350051
166100                 AND C.INTFC_SYS_CDE = 'RDM'                      20360051
166200                 AND C.SYS_PRC_FUNC_CDE = 'RDMCSL'                20370051
166300                 AND C.FUNC_PRC_STAT_CDE = 'AC'                   20380051
166400                 AND DATE(FUNC_BEG_TMST) < DATE(CRE_TMST)         20390051
166500      END-EXEC.                                                   20400051
166600                                                                  20410051
166700      EVALUATE TRUE                                               20420051
166800          WHEN SQLCODE = 0                                        20430051
166900              SET PS-ERROR                                        20440051
167000              DP020-MSG-FATAL   TO TRUE                           20450051
167100              MOVE PC-TSYMSG-02495  TO DP020-MSG-NUMBER           20460051
167200              MOVE DP015-UNP-ALP-BRT-OFF                          20470051
167300                                TO MPULLNOA                       20480051
167400              MOVE DP015-RED        TO MPULLNOC                   20490051
167500              MOVE DP015-REVERSE    TO MPULLNOH                   20500051
167600              MOVE -1               TO MPULLNOL                   20510051
167700              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 20520051
167800      END-EVALUATE.                                               20530051
167900                                                                  20540051
168000*----------------------------------------------------------------*20550051
168100* VALIDATE PRINTER ID                                            *20560051
168200*   PRINTER REQUIRED FOR -                                        20570051
168300*                        - PRINT PULL  - F23 (LOCAL-07)          *20580051
168400*----------------------------------------------------------------*20590051
168500 3010-VALIDATE-PRINTER-ID.                                        20600051
168600                                                                  20610051
168700     IF  DP020-FK-LOCAL-FUNC-07(DP020-SRC-AID)                    20620051
168800         IF  ASC-CS-PRINTER-ID  =  SPACES                         20630051
168900                 SET PS-ERROR                                     20640051
169000                     DP020-MSG-FATAL       TO TRUE                20650051
169100                 MOVE PC-TSYMSG-01563      TO DP020-MSG-NUMBER    20660051
169200                 MOVE DP015-UNP-ALP-BRT-OFF                       20670051
169300                                           TO MPRTIDA             20680051
169400                 MOVE DP015-RED            TO MPRTIDC             20690051
169500                 MOVE DP015-REVERSE        TO MPRTIDH             20700051
169600                 MOVE -1                   TO MPRTIDL             20710051
169700                 SET DP030-SET-CURSOR-APPL-1   TO TRUE            20720051
169800         ELSE                                                     20730051
169900             PERFORM 3020-VALIDATE-PRINTER                        20740051
170000             IF  DP072-PRTR-PRTR-TRK-STAT-CDE  EQUAL 'A'          20750051
170100                 CONTINUE                                         20760051
170200             ELSE                                                 20770051
170300                 SET PS-ERROR                                     20780051
170400                     DP020-MSG-FATAL        TO TRUE               20790051
170500                 MOVE PC-TSYMSG-00746       TO DP020-MSG-NUMBER   20800051
170600                 MOVE DP015-UNP-ALP-BRT-OFF TO MPRTIDA            20810051
170700                MOVE DP015-RED              TO MPRTIDC            20820051
170800                MOVE DP015-REVERSE          TO MPRTIDH            20830051
170900                MOVE -1                     TO MPRTIDL            20840051
171000                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              20850051
171100         END-IF                                                   20860051
171200     END-IF.                                                      20870051
171300                                                                  20880051
171400                                                                  20890051
171500*----------------------------------------------------------------*20900051
171600*   3020-VALIDATE-PRINTER                                        *20910051
171700* CALLS DPKCS060 TO VALIDATE THE PRINTER ID                      *20920051
171800*----------------------------------------------------------------*20930051
171900 3020-VALIDATE-PRINTER.                                           20940051
172000                                                                  20950051
172100     MOVE PC-01                      TO DP072-RPT-PGM-TYP-ID.     20960051
172200     MOVE DP020-LOCATION-NBR         TO DP072-ORIGIN-OPER-UNT-ID. 20970051
172300     MOVE DP020-LOCATION-NBR         TO DP072-OPER-UNT-ID.        20980051
172400     MOVE 1                          TO DP072-ORIGIN-FCLTY-ID     20990051
172500                                        DP072-FCLTY-ID.           21000051
172600     MOVE ASC-CS-PRINTER-ID          TO DP072-PRINTER-ID          21010051
172700     MOVE PC-REPORT-PGM-1            TO DP072-RPT-PGM-NME         21020051
172800     MOVE PC-01                      TO DP072-RPT-PGM-TYP-ID.     21030051
172900     SET DP072-VALIDATE              TO TRUE.                     21040051
173000                                                                  21050051
173100     EXEC CICS                                                    21060051
173200          LINK PROGRAM  (PC-PRTR-VALIDATION-PGM)                  21070051
173300               COMMAREA (DP072-COMM-AREA)                         21080051
173400               RESP     (PV-CICS-RESPONSE)                        21090051
173500     END-EXEC.                                                    21100051
173600                                                                  21110051
173700     EVALUATE TRUE                                                21120051
173800         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 21130051
173900              CONTINUE                                            21140051
174000         WHEN OTHER                                               21150051
174100             SET PS-ERROR                                         21160051
174200                 DP020-MSG-FATAL       TO TRUE                    21170051
174300             MOVE PC-TSYMSG-00746      TO DP020-MSG-NUMBER        21180051
174400             IF  DP072-RPT-PGM-NME = PC-REPORT-PGM-1              21190051
174500                 MOVE DP015-UNP-ALP-BRT-OFF                       21200051
174600                                       TO MPRTIDA                 21210051
174700                 MOVE DP015-RED        TO MPRTIDC                 21220051
174800                 MOVE DP015-REVERSE    TO MPRTIDH                 21230051
174900                 MOVE -1               TO MPRTIDL                 21240051
175000             ELSE                                                 21250051
175100                 MOVE DP015-UNP-ALP-BRT-OFF                       21260051
175200                                       TO MPRTIDA                 21270051
175300                 MOVE DP015-RED        TO MPRTIDC                 21280051
175400                 MOVE DP015-REVERSE    TO MPRTIDH                 21290051
175500                 MOVE -1               TO MPRTIDL                 21300051
175600             END-IF                                               21310051
175700             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  21320051
175800     END-EVALUATE.                                                21330051
175900                                                                  21340051
176000                                                                  21350051
176100*-----------------------------------------------------------------21360051
176200*  VALIDATE CREATE FROM AND TO DATES                              21370051
176300*-----------------------------------------------------------------21380051
176400 3030-VALIDATE-FROM-TO.                                           21390051
176500                                                                  21400051
176600     MOVE  ASC-FROM-MM  TO  PV-FROM-MM.                           21410051
176700     MOVE  ASC-FROM-DD  TO  PV-FROM-DD.                           21420051
176800     MOVE  ASC-FROM-YY  TO  PV-FROM-YY.                           21430051
176900                                                                  21440051
177000     MOVE  ASC-TO-MM    TO  PV-TO-MM.                             21450051
177100     MOVE  ASC-TO-DD    TO  PV-TO-DD.                             21460051
177200     MOVE  ASC-TO-YY    TO  PV-TO-YY.                             21470051
177300                                                                  21480051
177400     IF  PV-TO-DATE-HOLD  >=  PV-FROM-DATE-HOLD                   21490051
177500         CONTINUE                                                 21500051
177600     ELSE                                                         21510051
177700         SET PS-ERROR                                             21520051
177800         DP020-MSG-FATAL             TO TRUE                      21530051
177900         MOVE PC-TSYMSG-02221        TO DP020-MSG-NUMBER          21540051
178000         MOVE DP015-UNP-ALP-BRT-OFF  TO MFROMMMA                  21550051
178100                                        MFROMDDA                  21560051
178200                                        MFROMYYA                  21570051
178300                                        MTOMMA                    21580051
178400                                        MTODDA                    21590051
178500                                        MTOYYA                    21600051
178600         MOVE DP015-RED              TO MFROMMMC                  21610051
178700                                        MFROMDDC                  21620051
178800                                        MFROMYYC                  21630051
178900                                        MTOMMC                    21640051
179000                                        MTODDC                    21650051
179100                                        MTOYYC                    21660051
179200         MOVE DP015-REVERSE          TO MFROMMMH                  21670051
179300                                        MFROMDDH                  21680051
179400                                        MFROMYYH                  21690051
179500                                        MTOMMH                    21700051
179600                                        MTODDH                    21710051
179700                                        MTOYYH                    21720051
179800         MOVE -1                     TO MFROMMML                  21730051
179900         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      21740051
180000     END-IF.                                                      21750051
180100                                                                  21760051
180200     IF  PS-NO-ERROR                                              21770051
180300         INITIALIZE DPG51 DPG52 DPG53                             21780051
180400                    DPG54 DPG55 DPG56                             21790051
180500         SET  DPG51-ACTUAL-CALENDAR-ONLY                          21800051
180600              DPG51-DO-NOT-INCR-DECR-DATE                         21810051
180700                                    TO TRUE                       21820051
180800*            'CCYYMMDD'                                           21830051
180900         SET  DPG52-LK-DTE-ISO                                    21840051
181000                                    TO TRUE                       21850051
181100         MOVE PV-FROM-DATE-HOLD     TO DPG52-LK-DATE-INPUT        21860051
181200         CALL PC-CALENDAR-MODULE USING DPG51 DPG52 DPG53          21870051
181300                                       DPG54 DPG55 DPG56          21880051
181400         IF (DPG54-DATE-INVALID  OR                               21890051
181500             DPG54-SEVERE-ERROR)                                  21900051
181600             SET PS-ERROR                                         21910051
181700                 DP020-MSG-FATAL       TO TRUE                    21920051
181800             MOVE PC-TSYMSG-00009      TO DP020-MSG-NUMBER        21930051
181900             MOVE DP015-UNP-ALP-BRT-OFF                           21940051
182000                                       TO MFROMMMA                21950051
182100                                          MFROMDDA                21960051
182200                                          MFROMYYA                21970051
182300             MOVE DP015-RED            TO MFROMMMC                21980051
182400                                          MFROMDDC                21990051
182500                                          MFROMYYC                22000051
182600             MOVE DP015-REVERSE        TO MFROMMMH                22010051
182700                                          MFROMDDH                22020051
182800                                          MFROMYYH                22030051
182900             MOVE -1                   TO MFROMMML                22040051
183000             SET DP030-SET-CURSOR-APPL-1                          22050051
183100                                       TO TRUE                    22060051
183200         END-IF                                                   22070051
183300                                                                  22080051
183400         INITIALIZE DPG51 DPG52 DPG53                             22090051
183500                    DPG54 DPG55 DPG56                             22100051
183600         SET  DPG51-ACTUAL-CALENDAR-ONLY                          22110051
183700              DPG51-DO-NOT-INCR-DECR-DATE                         22120051
183800                                    TO TRUE                       22130051
183900*            'CCYYMMDD'                                           22140051
184000             SET  DPG52-LK-DTE-ISO                                22150051
184100                                    TO TRUE                       22160051
184200         MOVE PV-TO-DATE-HOLD       TO DPG52-LK-DATE-INPUT        22170051
184300         CALL PC-CALENDAR-MODULE USING DPG51 DPG52 DPG53          22180051
184400                                       DPG54 DPG55 DPG56          22190051
184500         IF (DPG54-DATE-INVALID                                   22200051
184600         OR  DPG54-SEVERE-ERROR)                                  22210051
184700             SET PS-ERROR                                         22220051
184800                 DP020-MSG-FATAL       TO TRUE                    22230051
184900             MOVE PC-TSYMSG-00009      TO DP020-MSG-NUMBER        22240051
185000             MOVE DP015-UNP-ALP-BRT-OFF                           22250051
185100                                       TO MTOMMA                  22260051
185200                                          MTODDA                  22270051
185300                                          MTOYYA                  22280051
185400             MOVE DP015-RED            TO MTOMMC                  22290051
185500                                          MTODDC                  22300051
185600                                          MTOYYC                  22310051
185700             MOVE DP015-REVERSE        TO MTOMMH                  22320051
185800                                          MTODDH                  22330051
185900                                          MTOYYH                  22340051
186000             MOVE -1                   TO MTOMML                  22350051
186100             SET DP030-SET-CURSOR-APPL-1                          22360051
186200                                       TO TRUE                    22370051
186300         END-IF                                                   22380051
186400     END-IF.                                                      22390051
186500                                                                  22400051
186600                                                                  22410051
186700                                                                  22420051
186800                                                                  22430051
186900                                                                  22440051
187000*----------------------------------------------------------------*22450051
187100*  MOVE THE DEFAULT ATTRIBUTES TO ALL OF THE OPEN FIELDS ON THE  *22460051
187200*  MAP.                                                          *22470051
187300*----------------------------------------------------------------*22480051
187400 3200-RESET-ATTRIBUTES.                                           22490051
187500                                                                  22500051
187600     MOVE DP015-ASK-NOR-MDT        TO MLOCDESA                    22510051
187700                                      MDPTDESA.                   22520051
187800                                                                  22530051
187900     MOVE DP015-UNP-ALP-NOR-MDT    TO MLOCIDA                     22540051
188000                                      MPRTIDA                     22550051
188100                                      MREFNOA                     22560051
188200                                      MPULLSTA                    22570051
188300                                      MSRCTYPA                    22580051
188400                                      MLSTSEQA                    22590051
188500                                      MDEPTNOA                    22600051
188501                                      MMCLASSA                    22610051
188510                                      MSCLASSA.                   22620051
188600                                                                  22630051
188700     MOVE DP015-UNP-NUM-NOR-MDT    TO MPULLNOA                    22640051
188800                                      MFROMMMA                    22650051
188900                                      MFROMDDA                    22660051
189000                                      MFROMYYA                    22670051
189100                                      MTOMMA                      22680051
189200                                      MTODDA                      22690051
189300                                      MTOYYA.                     22700051
189400                                                                  22710051
189500     MOVE DP015-GREEN              TO MLOCIDC                     22720051
189600                                      MPRTIDC                     22730051
189700                                      MPULLNOC                    22740051
189800                                      MREFNOC                     22750051
189900                                      MPULLSTC                    22760051
190000                                      MFROMMMC                    22770051
190100                                      MFROMDDC                    22780051
190200                                      MFROMYYC                    22790051
190300                                      MTOMMC                      22800051
190400                                      MTODDC                      22810051
190500                                      MTOYYC                      22820051
190600                                      MSRCTYPC                    22830051
190700                                      MLSTSEQC                    22840051
190800                                      MMCLASSC                    22850051
190810                                      MSCLASSC                    22860051
190820                                      MMCLASSC                    22870051
190830                                      MSCLASSC                    22880051
190840                                      MDEPTNOC.                   22890051
190900                                                                  22900051
191000     MOVE DP015-BLUE               TO MLOCDESC                    22910051
191100                                      MDPTDESC.                   22920051
191200                                                                  22930051
191300     MOVE DP015-UNDERLINE          TO MLOCIDH                     22940051
191400                                      MPRTIDH                     22950051
191500                                      MPULLNOH                    22960051
191600                                      MREFNOH                     22970051
191700                                      MPULLSTH                    22980051
191800                                      MFROMMMH                    22990051
191900                                      MFROMDDH                    23000051
192000                                      MFROMYYH                    23010051
192100                                      MTOMMH                      23020051
192200                                      MTODDH                      23030051
192300                                      MTOYYH                      23040051
192400                                      MSRCTYPH                    23050051
192500                                      MLSTSEQH                    23060051
192600                                      MMCLASSH                    23070051
192610                                      MSCLASSH                    23080051
192620                                      MDEPTNOH.                   23090051
192700                                                                  23100051
192800                                                                  23110051
192900*-----------------------------------------------------------------23120051
193000* VERIFY NECESSARY FIELDS ENTERED FOR "PULL LIST"                 23130051
193100*  F17 - LOCAL-04                                                 23140051
193200*  REQUIRED FIELDS: PULL STATUS                                   23150051
193300*                   PULL SOURCE TYPE                              23160051
193400*                   PULL LIST SEQUENCE                            23170051
193500*-----------------------------------------------------------------23180051
193600 3300-PULL-LIST-FIELDS.                                           23190051
193700                                                                  23200051
193800     IF  ASC-PULL-STATUS-ENTERED                                  23210051
193900         CONTINUE                                                 23220051
194000     ELSE                                                         23230051
194100         SET PS-ERROR                                             23240051
194200             DP020-MSG-FATAL   TO TRUE                            23250051
194300         MOVE PC-TSYMSG-00007  TO DP020-MSG-NUMBER                23260051
194400         MOVE DP015-UNP-ALP-BRT-OFF                               23270051
194500                               TO MPULLSTA                        23280051
194600         MOVE DP015-RED        TO MPULLSTC                        23290051
194700         MOVE DP015-REVERSE    TO MPULLSTH                        23300051
194800         MOVE -1               TO MPULLSTL                        23310051
194900         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      23320051
195000     END-IF                                                       23330051
195100                                                                  23340051
195200     IF  ASC-PULL-SOURCE-ENTERED                                  23350051
195300         CONTINUE                                                 23360051
195400     ELSE                                                         23370051
195500         SET PS-ERROR                                             23380051
195600             DP020-MSG-FATAL   TO TRUE                            23390051
195700         MOVE PC-TSYMSG-00007  TO DP020-MSG-NUMBER                23400051
195800         MOVE DP015-UNP-ALP-BRT-OFF                               23410051
195900                               TO MSRCTYPA                        23420051
196000         MOVE DP015-RED        TO MSRCTYPC                        23430051
196100         MOVE DP015-REVERSE    TO MSRCTYPH                        23440051
196200         MOVE -1               TO MSRCTYPL                        23450051
196300         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      23460051
196400     END-IF.                                                      23470051
196500                                                                  23480051
196600     IF  ASC-LIST-SEQ-ENTERED                                     23490051
196700         CONTINUE                                                 23500051
196800     ELSE                                                         23510051
196900         SET PS-ERROR                                             23520051
197000             DP020-MSG-FATAL   TO TRUE                            23530051
197100         MOVE PC-TSYMSG-00007  TO DP020-MSG-NUMBER                23540051
197200         MOVE DP015-UNP-ALP-BRT-OFF                               23550051
197300                               TO MLSTSEQA                        23560051
197400         MOVE DP015-RED        TO MLSTSEQC                        23570051
197500         MOVE DP015-REVERSE    TO MLSTSEQH                        23580051
197600         MOVE -1               TO MLSTSEQL                        23590051
197700         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      23600051
197800     END-IF.                                                      23610051
197900                                                                  23620051
198000                                                                  23630051
198100*-----------------------------------------------------------------23640051
198200* VERIFY NECESSARY FIELDS ENTERED FOR "ITEM LIST"                 23650051
198300*  F22 - LOCAL-06                                                 23660051
198400*  REQUIRED FIELDS: PULL NUMBER OR REFERENCE NUMBER               23670051
198500*-----------------------------------------------------------------23680051
198600 3310-ITEM-LIST-FIELDS.                                           23690051
198700                                                                  23700051
198800     IF  ASC-PULL-NBR  >  ZEROES OR                               23710051
198900         ASC-REF-NBR   >  SPACES                                  23720051
199000         CONTINUE                                                 23730051
199100     ELSE                                                         23740051
199200         SET PS-ERROR                                             23750051
199300             DP020-MSG-FATAL   TO TRUE                            23760051
199400         MOVE PC-TSYMSG-02220  TO DP020-MSG-NUMBER                23770051
199500         MOVE DP015-UNP-ALP-BRT-OFF                               23780051
199600                               TO MPULLNOA                        23790051
199700                                  MREFNOA                         23800051
199800         MOVE DP015-RED        TO MPULLNOC                        23810051
199900                                  MREFNOC                         23820051
200000         MOVE DP015-REVERSE    TO MPULLNOH                        23830051
200100                                  MREFNOH                         23840051
200200         MOVE -1               TO MPULLNOL                        23850051
200300                                  MREFNOL                         23860051
200400         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      23870051
200500     END-IF.                                                      23880051
200600                                                                  23890051
200700                                                                  23900051
200800*-----------------------------------------------------------------23910051
200900* VERIFY NECESSARY FIELDS ENTERED FOR "PRINT PULL"                23920051
201000*  F23 - LOCAL-07                                                 23930051
201100*  REQUIRED FIELDS: PULL NUMBER OR REFERENCE NUMBER               23940051
201200*-----------------------------------------------------------------23950051
201300 3320-PRT-PULL-FIELDS.                                            23960051
201400                                                                  23970051
201500     IF  ASC-PULL-NBR  >  ZEROES OR                               23980051
201600         ASC-REF-NBR   >  SPACES                                  23990051
201700         CONTINUE                                                 24000051
201800     ELSE                                                         24010051
201900         SET PS-ERROR                                             24020051
202000             DP020-MSG-FATAL   TO TRUE                            24030051
202100         MOVE PC-TSYMSG-02220  TO DP020-MSG-NUMBER                24040051
202200         MOVE DP015-UNP-ALP-BRT-OFF                               24050051
202300                               TO MPULLNOA                        24060051
202400                                  MREFNOA                         24070051
202500         MOVE DP015-RED        TO MPULLNOC                        24080051
202600                                  MREFNOC                         24090051
202700         MOVE DP015-REVERSE    TO MPULLNOH                        24100051
202800                                  MREFNOH                         24110051
202900         MOVE -1               TO MPULLNOL                        24120051
203000                                  MREFNOL                         24130051
203100         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      24140051
203200     END-IF.                                                      24150051
203300                                                                  24160051
203400     IF  PS-NO-ERROR                                              24170051
203500         IF  ASC-PULL-CANCELLED                                   24180051
203600             SET PS-ERROR                                         24190051
203700                 DP020-MSG-FATAL   TO TRUE                        24200051
203800             MOVE PC-TSYMSG-02226  TO DP020-MSG-NUMBER            24210051
203900             MOVE -1               TO MPULLNOL                    24220051
204000             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  24230051
204100         ELSE                                                     24240051
204200         IF  ASC-PULL-DISTRIBUTED  OR                             24250051
204300             ASC-PULL-POSTED                                      24260051
204400             SET PS-ERROR                                         24270051
204500                 DP020-MSG-FATAL   TO TRUE                        24280051
204600             MOVE PC-TSYMSG-02323  TO DP020-MSG-NUMBER            24290051
204700             MOVE -1               TO MPULLNOL                    24300051
204800             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  24310051
204900         END-IF                                                   24320051
205000         END-IF                                                   24330051
205100     END-IF.                                                      24340051
205200                                                                  24350051
205300                                                                  24360051
205400*-----------------------------------------------------------------24370051
205500* VERIFY NECESSARY FIELDS ENTERED FOR "UNCANCEL/CANCEL"           24380051
205600*  F14 - LOCAL-02                                                 24390051
205700*  REQUIRED FIELDS:                                               24400051
205800*-----------------------------------------------------------------24410051
205900 3340-UN-CANCEL-FIELDS.                                           24420051
206000                                                                  24430051
206100     IF  ASC-PULL-NBR  >  ZEROES                                  24440051
206200         CONTINUE                                                 24450051
206300     ELSE                                                         24460051
206400         SET PS-ERROR                                             24470051
206500             DP020-MSG-FATAL   TO TRUE                            24480051
206600         MOVE PC-TSYMSG-00007  TO DP020-MSG-NUMBER                24490051
206700         MOVE DP015-UNP-ALP-BRT-OFF                               24500051
206800                               TO MPULLNOA                        24510051
206900         MOVE DP015-RED        TO MPULLNOC                        24520051
207000         MOVE DP015-REVERSE    TO MPULLNOH                        24530051
207100         MOVE -1               TO MPULLNOL                        24540051
207200         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      24550051
207300     END-IF.                                                      24560051
207400                                                                  24570051
207500     IF  PS-NO-ERROR                                              24580051
207600         EVALUATE TRUE                                            24590051
207700             WHEN  ASC-PULL-DISTRIBUTED                           24600051
207800             WHEN  ASC-PULL-POSTED                                24610051
207900                   SET PS-ERROR                                   24620051
208000                       DP020-MSG-FATAL   TO TRUE                  24630051
208100                   MOVE PC-TSYMSG-02267  TO DP020-MSG-NUMBER      24640051
208200                   MOVE -1               TO MPULLNOL              24650051
208300                   SET DP030-SET-CURSOR-APPL-1 TO TRUE            24660051
208400         END-EVALUATE                                             24670051
208500     END-IF.                                                      24680051
208600                                                                  24690051
208700     IF  PS-NO-ERROR                                              24700051
208800         PERFORM 4000-COUNT-LINES-DIST                            24710051
208900     END-IF.                                                      24720051
209000                                                                  24730051
209100     IF  PS-NO-ERROR                                              24740051
209200         PERFORM 4010-CHECK-RDM-TCEPLMF                           24750051
209300     END-IF.                                                      24760051
209400                                                                  24770051
209500     IF  PS-NO-ERROR                                              24780051
209600         PERFORM 4015-CHECK-RDM-TCEPLAU                           24790051
209700     END-IF.                                                      24800051
209800                                                                  24810051
209900     IF  PS-NO-ERROR                                              24820051
210000         IF  ASC-PULL-CANCELLED                                   24830051
210100                                                                  24840051
210200             IF XL071-E-BUS-IND   = 'Y' AND                       24850051
210300                XL071-LOC-TYP-CDE = 'DS'                          24860051
210400                 SET DP030-OVERRIDE-GO TO TRUE                    24870051
210500                 MOVE PC-TSYMSG-02879                             24880051
210600                                  TO DP020-MSG-NUMBER             24890051
210700                 SET DP020-MSG-WARNING  TO TRUE                   24900051
210800                 SET ASC-CONFIRM-TYPE-NONE TO TRUE                24910051
210900                 SET PS-ERROR              TO TRUE                24920051
211000             ELSE                                                 24930051
211100                 SET  ASC-CONFIRM-UNCNCL-PULL                     24940051
211200                      PS-ERROR                                    24950051
211300                      DP020-MSG-WARNING                           24960051
211400                      PS-CONFIRM-PROCESSING  TO TRUE              24970051
211500                 MOVE PC-TSYMSG-02255        TO DP020-MSG-NUMBER  24980051
211600                 MOVE DP015-RED              TO MPULLNOC          24990051
211700                 MOVE DP015-REVERSE          TO MPULLNOH          25000051
211800                 MOVE -1                     TO MPULLNOL          25010051
211900                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              25020051
212000             END-IF                                               25030051
212100         ELSE                                                     25040051
212200             SET  ASC-CONFIRM-CNCL-PULL                           25050051
212300                  PS-ERROR                                        25060051
212400                  DP020-MSG-WARNING                               25070051
212500                  PS-CONFIRM-PROCESSING  TO TRUE                  25080051
212600             MOVE PC-TSYMSG-02254        TO DP020-MSG-NUMBER      25090051
212700             MOVE DP015-RED              TO MPULLNOC              25100051
212800             MOVE DP015-REVERSE          TO MPULLNOH              25110051
212900             MOVE -1                     TO MPULLNOL              25120051
213000             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  25130051
213100         END-IF                                                   25140051
213200     END-IF.                                                      25150051
213300                                                                  25160051
213400                                                                  25170051
213500*-----------------------------------------------------------------25180051
213600* VERIFY NECESSARY FIELDS ENTERED FOR "CONFIRM/UNCONFIRM DISTRO"  25190051
213700*  F24 - LOCAL-05                                                 25200051
213800*  REQUIRED FIELDS:                                               25210051
213900*-----------------------------------------------------------------25220051
214000 3360-UN-CNFM-DISTRO-FIELDS.                                      25230051
214100                                                                  25240051
214200     IF  ASC-PULL-NBR  >  ZEROES                                  25250051
214300         CONTINUE                                                 25260051
214400     ELSE                                                         25270051
214500         SET PS-ERROR                                             25280051
214600             DP020-MSG-FATAL   TO TRUE                            25290051
214700         MOVE PC-TSYMSG-00007  TO DP020-MSG-NUMBER                25300051
214800         MOVE DP015-UNP-ALP-BRT-OFF                               25310051
214900                               TO MPULLNOA                        25320051
215000         MOVE DP015-RED        TO MPULLNOC                        25330051
215100         MOVE DP015-REVERSE    TO MPULLNOH                        25340051
215200         MOVE -1               TO MPULLNOL                        25350051
215300         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      25360051
215400     END-IF.                                                      25370051
215500                                                                  25380051
215600     IF  PS-NO-ERROR                                              25390051
215700         EVALUATE TRUE                                            25400051
215800             WHEN ASC-PULL-POSTED                                 25410051
215900                   SET  PS-ERROR                                  25420051
216000                        DP020-MSG-FATAL       TO TRUE             25430051
216100                  MOVE PC-TSYMSG-02224        TO DP020-MSG-NUMBER 25440051
216200                  MOVE -1                     TO MPULLNOL         25450051
216300                  SET DP030-SET-CURSOR-APPL-1 TO TRUE             25460051
216400                                                                  25470051
216500             WHEN ASC-PULL-CANCELLED                              25480051
216600                  SET  PS-ERROR                                   25490051
216700                       DP020-MSG-FATAL        TO TRUE             25500051
216800                  MOVE PC-TSYMSG-02225        TO DP020-MSG-NUMBER 25510051
216900                  MOVE -1                     TO MPULLNOL         25520051
217000                  SET DP030-SET-CURSOR-APPL-1 TO TRUE             25530051
217100                                                                  25540051
217200             WHEN ASC-PULL-NEW                                    25550051
217300                  SET  PS-ERROR                                   25560051
217400                       DP020-MSG-FATAL        TO TRUE             25570051
217500                  MOVE PC-TSYMSG-02317        TO DP020-MSG-NUMBER 25580051
217600                  MOVE -1                     TO MPULLNOL         25590051
217700                  SET DP030-SET-CURSOR-APPL-1 TO TRUE             25600051
217800                                                                  25610051
217900         END-EVALUATE                                             25620051
218000     END-IF.                                                      25630051
218100                                                                  25640051
218200     IF  PS-NO-ERROR                                              25650051
218300         EVALUATE TRUE                                            25660051
218400             WHEN ASC-PULL-DISTRIBUTED                            25670051
218500                  SET  ASC-CONFIRM-UNCONF-DIST                    25680051
218600                       PS-ERROR                                   25690051
218700                       DP020-MSG-WARNING                          25700051
218800                       PS-CONFIRM-PROCESSING  TO TRUE             25710051
218900                  MOVE PC-TSYMSG-02259        TO DP020-MSG-NUMBER 25720051
219000                  MOVE DP015-RED              TO MPULLNOC         25730051
219100                  MOVE DP015-REVERSE          TO MPULLNOH         25740051
219200                  MOVE -1                     TO MPULLNOL         25750051
219300                  SET DP030-SET-CURSOR-APPL-1 TO TRUE             25760051
219400                                                                  25770051
219500             WHEN OTHER                                           25780051
219600                  INITIALIZE PV-LINES-NEW                         25790051
219700                  IF  PS-NO-ERROR                                 25800051
219800                      PERFORM 3385-COUNT-NEW-LINES                25810051
219900                  END-IF                                          25820051
220000                                                                  25830051
220100                  INITIALIZE  PV-IN-PROCESS-CNT                   25840051
220200                  IF  PS-NO-ERROR                                 25850051
220300                      PERFORM 3375-CHECK-ALL-LINES                25860051
220400                  END-IF                                          25870051
220500                                                                  25880051
220600                  IF  PS-NO-ERROR                                 25890051
220700                      SET  ASC-CONFIRM-CONF-DIST                  25900051
220800                           PS-ERROR                               25910051
220900                           DP020-MSG-WARNING                      25920051
221000                           PS-CONFIRM-PROCESSING  TO TRUE         25930051
221100                      IF  PV-IN-PROCESS-CNT  >  1                 25940051
221200                         MOVE PC-TSYMSG-02322 TO DP020-MSG-NUMBER 25950051
221300                      ELSE                                        25960051
221400                         MOVE PC-TSYMSG-02258 TO DP020-MSG-NUMBER 25970051
221500                      END-IF                                      25980051
221600                      MOVE DP015-RED              TO MPULLNOC     25990051
221700                      MOVE DP015-REVERSE          TO MPULLNOH     26000051
221800                      MOVE -1                     TO MPULLNOL     26010051
221900                      SET DP030-SET-CURSOR-APPL-1 TO TRUE         26020051
222000                  END-IF                                          26030051
222100         END-EVALUATE                                             26040051
222200     END-IF.                                                      26050051
222300                                                                  26060051
222400                                                                  26070051
222500*-----------------------------------------------------------------26080051
222600* CHECK TO MAKE SURE THAT PULL HAS LINE ITEMS ENTERED AND EACH   *26090051
222700* LINE HAS DISTRIBUTION                                          *26100051
222800*-----------------------------------------------------------------26110051
222900 3375-CHECK-ALL-LINES.                                            26120051
223000                                                                  26130051
223100     MOVE  ASC-PULL-NBR  TO  DK-PULL-NUMBER.                      26140051
223200                                                                  26150051
223300     IF  PS-NO-ERROR                                              26160051
223400         PERFORM 7050-OPEN-CNFM-LNE-CSR                           26170051
223500     END-IF.                                                      26180051
223600                                                                  26190051
223700     IF  PS-NO-ERROR                                              26200051
223800         PERFORM 7055-FETCH-CNFM-LNE-CSR                          26210051
223900     END-IF.                                                      26220051
224000                                                                  26230051
224100     IF  PS-EOF-CNFM-LNE-CSR                                      26240051
224200         SET  PS-ERROR                                            26250051
224300              DP020-MSG-FATAL        TO TRUE                      26260051
224400         MOVE PC-TSYMSG-02287        TO DP020-MSG-NUMBER          26270051
224500         MOVE -1                     TO MPULLNOL                  26280051
224600         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      26290051
224700     END-IF.                                                      26300051
224800                                                                  26310051
224900     IF  PS-NO-ERROR                                              26320051
225000         PERFORM                                                  26330051
225100           UNTIL PS-ERROR                                         26340051
225200              OR PS-EOF-CNFM-LNE-CSR                              26350051
225300                 PERFORM 3380-CHECK-DISTRO                        26360051
225400                 IF  PS-NO-ERROR                                  26370051
225500                     PERFORM 7055-FETCH-CNFM-LNE-CSR              26380051
225600                 END-IF                                           26390051
225700         END-PERFORM                                              26400051
225800     END-IF.                                                      26410051
225900                                                                  26420051
226000     IF  PS-NO-ERROR                                              26430051
226100         PERFORM 7060-CLOSE-CNFM-LNE-CSR                          26440051
226200     END-IF.                                                      26450051
226300                                                                  26460051
226400                                                                  26470051
226500*-----------------------------------------------------------------26480051
226600* CHECK TO MAKE SURE THAT EACH ACTIVE LINE HAS DISTRIBUTION      -26490051
226700*-----------------------------------------------------------------26500051
226800 3380-CHECK-DISTRO.                                               26510051
226900                                                                  26520051
227000     MOVE  CEPLIT-PL-LNE-NBR  TO  DK-LINE-NUMBER.                 26530051
227100     MOVE  ZEROES             TO  PV-CEPLDS-COUNT.                26540051
227200                                                                  26550051
227300     EXEC SQL                                                     26560051
227400         SELECT  COUNT(*)                                         26570051
227500           INTO  :PV-CEPLDS-COUNT                                 26580051
227600           FROM  TCEPLDS                                          26590051
227700          WHERE  CNSTK_REQ_PL_NBR  =  :DK-PULL-NUMBER             26600051
227800            AND  PL_LNE_NBR        =  :DK-LINE-NUMBER             26610051
227900     END-EXEC.                                                    26620051
228000                                                                  26630051
228100     EVALUATE TRUE                                                26640051
228200         WHEN SQLCODE = ZERO                                      26650051
228300         WHEN SQLCODE = +100                                      26660051
228400              CONTINUE                                            26670051
228500                                                                  26680051
228600         WHEN SQLWARN0 NOT = SPACE                                26690051
228700         WHEN SQLCODE NOT = ZERO                                  26700051
228800              SET PS-ERROR     TO TRUE                            26710051
228900              MOVE '3380-CHECK-DISTRO       '                     26720051
229000                               TO DP013-PARAGRAPH                 26730051
229100              MOVE 'COUNT NUMBER DISTRO ROWS FOR LINE  '          26740051
229200                               TO DP013-MESSAGE-TEXT (1)          26750051
229300              MOVE SQLCA       TO DP013-SQLCA                     26760051
229400              MOVE 'TCEPLDS'   TO DP013-DB2-TABLE-NAME (1)        26770051
229500              SET DP013-DB2-ABEND                                 26780051
229600                               TO TRUE                            26790051
229700              PERFORM DP013-0000-PROCESS-ABEND                    26800051
229800     END-EVALUATE.                                                26810051
229900                                                                  26820051
230000     IF  PS-NO-ERROR                                              26830051
230100         IF  PV-CEPLDS-COUNT  >  0                                26840051
230200             CONTINUE                                             26850051
230300         ELSE                                                     26860051
230400             SET  PS-ERROR                                        26870051
230500                  DP020-MSG-FATAL        TO TRUE                  26880051
230600             MOVE PC-TSYMSG-02288        TO DP020-MSG-NUMBER      26890051
230700             MOVE -1                     TO MPULLNOL              26900051
230800             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  26910051
230900        END-IF                                                    26920051
231000     END-IF.                                                      26930051
231100                                                                  26940051
231200                                                                  26950051
231300*-----------------------------------------------------------------26960051
231400* CHECK TO MAKE SURE THAT EACH ACTIVE LINE HAS DISTRIBUTION      -26970051
231500*-----------------------------------------------------------------26980051
231600 3385-COUNT-NEW-LINES.                                            26990051
231700                                                                  27000051
231800     MOVE  ASC-PULL-NBR       TO  DK-PULL-NUMBER.                 27010051
231900     MOVE  ZEROES             TO  PV-LINES-NEW.                   27020051
232000                                                                  27030051
232100     EXEC SQL                                                     27040051
232200         SELECT  COUNT(*)                                         27050051
232300           INTO  :PV-LINES-NEW                                    27060051
232400           FROM  TCEPLIT                                          27070051
232500          WHERE  CNSTK_REQ_PL_NBR  =  :DK-PULL-NUMBER             27080051
232600            AND  STAT_CDE          =  'NW'                        27090051
232700     END-EXEC.                                                    27100051
232800                                                                  27110051
232900     EVALUATE TRUE                                                27120051
233000         WHEN SQLCODE = ZERO                                      27130051
233100              CONTINUE                                            27140051
233200                                                                  27150051
233300         WHEN SQLWARN0 NOT = SPACE                                27160051
233400         WHEN SQLCODE NOT = ZERO                                  27170051
233500              SET PS-ERROR     TO TRUE                            27180051
233600              MOVE '3385-COUNT-NEW-LINES    '                     27190051
233700                               TO DP013-PARAGRAPH                 27200051
233800              MOVE 'COUNT NUMBER -NEW- LINES           '          27210051
233900                               TO DP013-MESSAGE-TEXT (1)          27220051
234000              MOVE SQLCA       TO DP013-SQLCA                     27230051
234100              MOVE 'TCEPLIT'   TO DP013-DB2-TABLE-NAME (1)        27240051
234200              SET DP013-DB2-ABEND                                 27250051
234300                               TO TRUE                            27260051
234400              PERFORM DP013-0000-PROCESS-ABEND                    27270051
234500     END-EVALUATE.                                                27280051
234600                                                                  27290051
234700     IF  PS-NO-ERROR                                              27300051
234800         IF  PV-LINES-NEW  >  0                                   27310051
234900             SET  PS-ERROR                                        27320051
235000                  DP020-MSG-FATAL        TO TRUE                  27330051
235100             MOVE PC-TSYMSG-02354        TO DP020-MSG-NUMBER      27340051
235200             MOVE -1                     TO MPULLNOL              27350051
235300             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  27360051
235400        END-IF                                                    27370051
235500     END-IF.                                                      27380051
235600                                                                  27390051
235700                                                                  27400051
235800*-----------------------------------------------------------------27410051
235900* MAKE SURE THIS CENTRAL STOCK LOCATION IS A VALID RDM LOCATION  -27420051
236000* PRIOR TO XCNTLING TO THE PGM THAT WILL UPDATE TCEPLIT.         -27430051
236100*-----------------------------------------------------------------27440051
236200 3390-VALIDATE-RDM-FACILITY.                                      27450051
236300                                                                  27460051
236400     SET PS-VALID-RDM-FACILITY-NO      TO TRUE.                   27470051
236500                                                                  27480051
236700     EXEC SQL                                                     27490051
236800          SELECT LOC_ID                                           27500051
236900          INTO :KRPRPM-LOC-ID                                     27510051
237000          FROM TKRPRPM B                                          27520051
237100          WHERE B.LOC_ID = :PV-DC-NBR                             27530051
237200            AND B.INTFC_SYS_CDE = 'RDM'                           27540051
237300            AND B.SYS_PRC_FUNC_CDE = 'RDMFAC'                     27550051
237400            AND B.FUNC_PRC_STAT_CDE = 'AC'                        27560051
237500            AND B.FUNC_TXT = 'Y'                                  27570051
237600            AND (CURRENT DATE                                     27580051
237700        BETWEEN DATE(B.FUNC_BEG_TMST) AND                         27590051
237710                DATE(B.FUNC_END_TMST) )                           27600051
237800     END-EXEC.                                                    27610051
237900                                                                  27620051
238000     EVALUATE TRUE                                                27630051
238100         WHEN SQLCODE = +0                                        27640051
238200              SET PS-VALID-RDM-FACILITY     TO TRUE               27650051
238300         WHEN OTHER                                               27660051
238400              SET PS-VALID-RDM-FACILITY-NO  TO TRUE               27670051
238500     END-EVALUATE.                                                27680051
238501                                                                  27690051
238510*-----------------------------------------------------------------27700051
238520* CHECK CENTRAL STOCK PULL LOCATION                               27710051
238540*-----------------------------------------------------------------27720051
238541                                                                  27730051
238550 3391-CHECK-CE-PULL-LOC.                                          27740051
238570                                                                  27750051
238580     SET PS-VALID-RDM-FACILITY-NO      TO TRUE.                   27760051
238581                                                                  27770051
238590     EXEC SQL                                                     27780051
238591          SELECT B.LOC_ID                                         27790051
238592          INTO :KRPRPM-LOC-ID                                     27800051
238593          FROM TCEPLRQ A,                                         27810051
238594               TKRPRPM B                                          27820051
238595          WHERE A.CNSTK_REQ_PL_NBR = :DK-PULL-NUMBER              27830051
238596            AND A.CNSTK_LOC_ID = B.LOC_ID                         27840051
238598            AND B.INTFC_SYS_CDE = 'KHL'                           27850051
238600            AND B.SYS_PRC_FUNC_CDE = 'PTFAC'                      27860051
238601            AND B.FUNC_PRC_STAT_CDE = 'AC'                        27870051
238602            AND B.FUNC_TXT = 'Y'                                  27880051
238603            AND (CURRENT DATE                                     27890051
238604        BETWEEN DATE(B.FUNC_BEG_TMST) AND                         27900051
238605                DATE(B.FUNC_END_TMST))                            27910051
238606     END-EXEC.                                                    27920051
238607                                                                  27930051
238608     EVALUATE TRUE                                                27940051
238609         WHEN SQLCODE = +0                                        27950051
238610              SET PS-VALID-RDM-FACILITY     TO TRUE               27960051
238611         WHEN OTHER                                               27970051
238612              SET PS-VALID-RDM-FACILITY-NO  TO TRUE               27980051
238613     END-EVALUATE.                                                27990051
238620                                                                  28000051
238700****************************************************************  28010051
238800*    THIS PARAGRAPH RETRIEVES THE STORE INFORMATION.           *  28020051
238900*                                                              *  28030051
239000****************************************************************  28040051
239100 3500-GET-STORE-INFORMATION.                                      28050051
239200                                                                  28060051
239300     CALL XL071-LOCATION-MODULE USING                             28070051
239400                                DFHEIBLK                          28080051
239500                                XL071-COMMAREA                    28090051
239600                                XL071-COMMAREA-REC.               28100051
239700                                                                  28110051
239800     EVALUATE TRUE                                                28120051
239900         WHEN XL071-NO-ERRORS                                     28130051
240000              MOVE XL071-ASGMT-DC-NBR TO PV-DC-NBR                28140051
240100                                                                  28150051
240200         WHEN XL071-LOC-NOT-FOUND                                 28160051
240300         WHEN XL071-LOCATION-NUMBER = 0                           28170051
240400              SET PS-ERROR                                        28180051
240500                  DP020-MSG-FATAL       TO TRUE                   28190051
240600              MOVE PC-TSYMSG-02219      TO DP020-MSG-NUMBER       28200051
240700              MOVE DP015-UNP-ALP-BRT-OFF                          28210051
240800                                        TO MLOCIDA                28220051
240900              MOVE DP015-RED            TO MLOCIDC                28230051
241000              MOVE DP015-REVERSE        TO MLOCIDH                28240051
241100              MOVE -1                   TO MLOCIDL                28250051
241200              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 28260051
241300                                                                  28270051
241400         WHEN OTHER                                               28280051
241500              MOVE  ASC-PULL-NBR      TO PV-DISPLAY-PULL-NBR      28290051
241600              MOVE '3500-GET-STORE-INFORMATION'                   28300051
241700                                  TO DP013-PARAGRAPH              28310051
241800              MOVE 'VERIFY LOCATION IS CENTRAL STOCK'             28320051
241900                                  TO DP013-MESSAGE-TEXT (1)       28330051
242000              MOVE XL071-SQLCODE-N TO PV-DISPLAY-SQLCODE          28340051
242100              STRING ' LOCATION - '                               28350051
242200                      XL071-LOCATION-NUMBER                       28360051
242300                     ' PULL NBR - '                               28370051
242400                      PV-DISPLAY-PULL-NBR                         28380051
242500                     ' SQLCODE  - '                               28390051
242600                      PV-DISPLAY-SQLCODE                          28400051
242700                      DELIMITED BY SIZE                           28410051
242800                      INTO DP013-MESSAGE-TEXT (2)                 28420051
242900***           MOVE XL071-SQLCODE-N TO SQLCODE                     28430051
243000              MOVE XL071-SQLCA     TO DP013-SQLCA                 28440051
243100              MOVE XL071-DB2-TABLE TO DP013-DB2-TABLE-NAME (1)    28450051
243200              SET DP013-DB2-ABEND                                 28460051
243300                  DP013-XCTL-DISPLAY-RESTART TO TRUE              28470051
243400              PERFORM DP013-0000-PROCESS-ABEND                    28480051
243500                                                                  28490051
243600     END-EVALUATE.                                                28500051
243700                                                                  28510051
243800                                                                  28520051
243900*-----------------------------------------------------------------28530051
244000* COUNT THE NUMBER OF LINES FOR A GIVEN PULL NUMBER THAT HAVE     28540051
244100* ALREADY BEEN POSTED OR DISTRIBUTED.                             28550051
244200*-----------------------------------------------------------------28560051
244300 4000-COUNT-LINES-DIST.                                           28570051
244400     INITIALIZE  PV-LINES-POSTED-DISTRB.                          28580051
244500     MOVE ASC-PULL-NBR-N  TO  DK-PULL-NUMBER.                     28590051
244600                                                                  28600051
244700     EXEC SQL                                                     28610051
244800          SELECT COUNT(*)                                         28620051
244900            INTO :PV-LINES-POSTED-DISTRB                          28630051
245000            FROM TCEPLIT                                          28640051
245100           WHERE CNSTK_REQ_PL_NBR  =  :DK-PULL-NUMBER             28650051
245200             AND STAT_CDE         IN  ('DS', 'PD')                28660051
245300     END-EXEC.                                                    28670051
245400                                                                  28680051
245500     EVALUATE TRUE                                                28690051
245600         WHEN SQLCODE = +0                                        28700051
245700              IF  PV-LINES-POSTED-DISTRB  >  0                    28710051
245800                  SET  PS-ERROR                                   28720051
245900                       DP020-MSG-FATAL        TO TRUE             28730051
246000                  MOVE PC-TSYMSG-02268        TO DP020-MSG-NUMBER 28740051
246100                  MOVE DP015-UNP-ALP-BRT-OFF  TO MREFNOA          28750051
246200                  MOVE DP015-RED              TO MREFNOC          28760051
246300                  MOVE DP015-REVERSE          TO MREFNOH          28770051
246400                  MOVE -1                     TO MREFNOL          28780051
246500                  SET DP030-SET-CURSOR-APPL-1 TO TRUE             28790051
246600              END-IF                                              28800051
246700                                                                  28810051
246800         WHEN SQLCODE = +100                                      28820051
246900              SET  PS-ERROR                                       28830051
247000                   DP020-MSG-FATAL            TO TRUE             28840051
247100              MOVE PC-TSYMSG-02214            TO DP020-MSG-NUMBER 28850051
247200              MOVE DP015-UNP-ALP-BRT-OFF      TO MREFNOA          28860051
247300              MOVE DP015-RED                  TO MREFNOC          28870051
247400              MOVE DP015-REVERSE              TO MREFNOH          28880051
247500              MOVE -1                         TO MREFNOL          28890051
247600              SET  DP030-SET-CURSOR-APPL-1    TO TRUE             28900051
247700                                                                  28910051
247800         WHEN OTHER                                               28920051
247900              MOVE '4000-COUNT-LINES-DIST'    TO DP013-PARAGRAPH  28930051
248000              MOVE 'COUNT NBR LINES POSTED/DISTRBUTD'             28940051
248100                                       TO DP013-MESSAGE-TEXT (1)  28950051
248200              STRING ' PULL NBR-'    DELIMITED BY SIZE            28960051
248300                      ASC-PULL-NBR-N DELIMITED BY SIZE            28970051
248400                                     INTO DP013-MESSAGE-TEXT (2)  28980051
248500              MOVE SQLCA                      TO DP013-SQLCA      28990051
248600              MOVE 'TCEPLIT '        TO DP013-DB2-TABLE-NAME (1)  29000051
248700              SET  DP013-DB2-ABEND                                29010051
248800                   DP013-XCTL-DISPLAY-RESTART  TO TRUE            29020051
248900              PERFORM DP013-0000-PROCESS-ABEND                    29030051
249000     END-EVALUATE.                                                29040051
249100                                                                  29050051
249200                                                                  29060051
249300*-----------------------------------------------------------------29070051
249400* COUNT NUMBER OF LINES FOR A GIVEN PULL NUMBER THAT ARE BEING    29080051
249500* WORKED IN RDM                                                   29090051
249600*-----------------------------------------------------------------29100051
249700 4010-CHECK-RDM-TCEPLMF.                                          29110051
249800     INITIALIZE  PV-TCEPLMF-COUNT.                                29120051
249900     MOVE ASC-PULL-NBR-N  TO  DK-PULL-NUMBER.                     29130051
250000                                                                  29140051
250100     EXEC SQL                                                     29150051
250200          SELECT COUNT(*)                                         29160051
250300            INTO :PV-TCEPLMF-COUNT                                29170051
250400            FROM TCEPLMF                                          29180051
250500           WHERE CNSTK_REQ_PL_NBR  =  :DK-PULL-NUMBER             29190051
250600     END-EXEC.                                                    29200051
250700                                                                  29210051
250800     EVALUATE TRUE                                                29220051
250900         WHEN SQLCODE = +0                                        29230051
251000              IF  PV-TCEPLMF-COUNT  >  0                          29240051
251100                  SET  PS-ERROR                                   29250051
251200                       DP020-MSG-FATAL        TO TRUE             29260051
251300                  MOVE PC-TSYMSG-02268        TO DP020-MSG-NUMBER 29270051
251400                  MOVE DP015-UNP-ALP-BRT-OFF  TO MREFNOA          29280051
251500                  MOVE DP015-RED              TO MREFNOC          29290051
251600                  MOVE DP015-REVERSE          TO MREFNOH          29300051
251700                  MOVE -1                     TO MREFNOL          29310051
251800                  SET DP030-SET-CURSOR-APPL-1 TO TRUE             29320051
251900              END-IF                                              29330051
252000                                                                  29340051
252100         WHEN SQLCODE = +100                                      29350051
252200              CONTINUE                                            29360051
252300                                                                  29370051
252400         WHEN OTHER                                               29380051
252500              MOVE '4010-CHECK-RDM-TCEPLMF'   TO DP013-PARAGRAPH  29390051
252600              MOVE 'COUNT NBR LINES WORKED BY RDM   '             29400051
252700                                       TO DP013-MESSAGE-TEXT (1)  29410051
252800              STRING ' PULL NBR-'    DELIMITED BY SIZE            29420051
252900                      ASC-PULL-NBR-N DELIMITED BY SIZE            29430051
253000                                     INTO DP013-MESSAGE-TEXT (2)  29440051
253100              MOVE SQLCA                      TO DP013-SQLCA      29450051
253200              MOVE 'TCEPLMF '        TO DP013-DB2-TABLE-NAME (1)  29460051
253300              SET  DP013-DB2-ABEND                                29470051
253400                   DP013-XCTL-DISPLAY-RESTART  TO TRUE            29480051
253500              PERFORM DP013-0000-PROCESS-ABEND                    29490051
253600     END-EVALUATE.                                                29500051
253700                                                                  29510051
253800                                                                  29520051
253900*-----------------------------------------------------------------29530051
254000* COUNT NUMBER OF LINES FOR A GIVEN PULL NUMBER THAT ARE BEING    29540051
254100* WORKED IN RDM                                                   29550051
254200*-----------------------------------------------------------------29560051
254300 4015-CHECK-RDM-TCEPLAU.                                          29570051
254400     INITIALIZE  PV-TCEPLAU-COUNT.                                29580051
254500     MOVE ASC-PULL-NBR-N  TO  DK-PULL-NUMBER.                     29590051
254600                                                                  29600051
254700     EXEC SQL                                                     29610051
254800          SELECT COUNT(*)                                         29620051
254900            INTO :PV-TCEPLAU-COUNT                                29630051
255000            FROM TCEPLAU                                          29640051
255100           WHERE CNSTK_REQ_PL_NBR  =  :DK-PULL-NUMBER             29650051
255200     END-EXEC.                                                    29660051
255300                                                                  29670051
255400     EVALUATE TRUE                                                29680051
255500         WHEN SQLCODE = +0                                        29690051
255600              IF  PV-TCEPLAU-COUNT  >  0                          29700051
255700                  SET  PS-ERROR                                   29710051
255800                       DP020-MSG-FATAL        TO TRUE             29720051
255900                  MOVE PC-TSYMSG-02268        TO DP020-MSG-NUMBER 29730051
256000                  MOVE DP015-UNP-ALP-BRT-OFF  TO MREFNOA          29740051
256100                  MOVE DP015-RED              TO MREFNOC          29750051
256200                  MOVE DP015-REVERSE          TO MREFNOH          29760051
256300                  MOVE -1                     TO MREFNOL          29770051
256400                  SET DP030-SET-CURSOR-APPL-1 TO TRUE             29780051
256500              END-IF                                              29790051
256600                                                                  29800051
256700         WHEN SQLCODE = +100                                      29810051
256800              CONTINUE                                            29820051
256900                                                                  29830051
257000         WHEN OTHER                                               29840051
257100              MOVE '4015-CHECK-RDM-TCEPLAU'   TO DP013-PARAGRAPH  29850051
257200              MOVE 'COUNT NBR LINES WORKED BY RDM   '             29860051
257300                                       TO DP013-MESSAGE-TEXT (1)  29870051
257400              STRING ' PULL NBR-'    DELIMITED BY SIZE            29880051
257500                      ASC-PULL-NBR-N DELIMITED BY SIZE            29890051
257600                                     INTO DP013-MESSAGE-TEXT (2)  29900051
257700              MOVE SQLCA                      TO DP013-SQLCA      29910051
257800              MOVE 'TCEPLAU '        TO DP013-DB2-TABLE-NAME (1)  29920051
257900              SET  DP013-DB2-ABEND                                29930051
258000                   DP013-XCTL-DISPLAY-RESTART  TO TRUE            29940051
258100              PERFORM DP013-0000-PROCESS-ABEND                    29950051
258200     END-EVALUATE.                                                29960051
258300                                                                  29970051
258400                                                                  29980051
258500*-----------------------------------------------------------------29990051
258600* VALIDATE DEPT NUMBER - IF ENTERED                               30000051
258700*-----------------------------------------------------------------30010051
258800 4100-VALIDATE-DEPT.                                              30020051
258900                                                                  30030051
259000* CLT 07/01/2010 START USE DIFFERENT TABLE WR#38786               30040051
259100     MOVE ASC-DEPT-NBR  TO  DK-DEPT-NUMBER                        30050051
259200                            DK-DEPT-NUMBER-PACKED.                30060051
259300     EXEC SQL                                                     30070051
259400          SELECT  DEPT_NM                                         30080051
259500            INTO :XLT00002-DEPT-NM                                30090051
259510            FROM  XLT_DEPT                                        30100051
259520           WHERE  DEPT_NBR    = :DK-DEPT-NUMBER-PACKED            30110051
259530     END-EXEC.                                                    30120051
259540                                                                  30130051
259550     EVALUATE TRUE                                                30140051
259560         WHEN SQLCODE = +0 OR -811                                30150051
259570              CONTINUE                                            30160051
259580                  MOVE XLT00002-DEPT-NM       TO MDPTDESO         30170051
259590                                                 ASC-DEPT-DESC    30180051
259600         WHEN SQLCODE = +100                                      30190051
259700              IF  DP020-FK-LOCAL-FUNC-04(DP020-SRC-AID)           30200051
259800                  SET  PS-ERROR                                   30210051
259900                       DP020-MSG-FATAL        TO TRUE             30220051
260000                  MOVE PC-TSYMSG-00032        TO DP020-MSG-NUMBER 30230051
260100                  MOVE DP015-UNP-ALP-BRT-OFF  TO MDEPTNOA         30240051
260200                  MOVE DP015-RED              TO MDEPTNOC         30250051
260300                  MOVE DP015-REVERSE          TO MDEPTNOH         30260051
260400                  MOVE -1                     TO MDEPTNOL         30270051
260500                  SET  DP030-SET-CURSOR-APPL-1 TO TRUE            30280051
260600              ELSE                                                30290051
260700                  MOVE '** INVALID DEPARTMENT ** '                30300051
260800                                              TO MDPTDESO         30310051
260900                                                 ASC-DEPT-DESC    30320051
261000              END-IF                                              30330051
261100         WHEN OTHER                                               30340051
261200              MOVE '4100-VALIDATE-DEPT '   TO DP013-PARAGRAPH     30350051
261300              MOVE 'VALIDATE DEPARTMENT NUMBER         '          30360051
261400                                        TO DP013-MESSAGE-TEXT(1)  30370051
261500              STRING ' DEPT NBR-'          DELIMITED BY SIZE      30380051
261600                       ASC-DEPT-NBR        DELIMITED BY SIZE      30390051
261700                                      INTO DP013-MESSAGE-TEXT(2)  30400051
261800              MOVE SQLCA                TO DP013-SQLCA            30410051
261900              MOVE 'TMDSEAR'          TO DP013-DB2-TABLE-NAME(1)  30420051
262000* CLT 07/01/2010 END                                              30430051
262100              SET DP013-DB2-ABEND                                 30440051
262200                  DP013-XCTL-DISPLAY-RESTART TO TRUE              30450051
262300              PERFORM DP013-0000-PROCESS-ABEND                    30460051
262400     END-EVALUATE.                                                30470051
262500                                                                  30480051
262600*----------------------------------------------------------------*30490051
262700*  PRINT PULL FUNCTION                                           *30500051
262800*----------------------------------------------------------------*30510051
262900 4600-PROCESS-PRINT-FUNCTION.                                     30520051
263000                                                                  30530051
263100     SET  CE004-CICS-LINK                                         30540051
263200          CE004-FROM-CRIT-SPEC    TO TRUE.                        30550051
263300                                                                  30560051
263400     MOVE ASC-CURR-OPER-UNT-ID-N  TO CE004-CURR-OPER-UNT-ID.      30570051
263500     MOVE PC-FCLTY-ID-0001        TO CE004-CURR-FCLTY-ID.         30580051
263600     MOVE ASC-CS-PRINTER-ID       TO CE004-CS-PRINTER-ID.         30590051
263700     MOVE ASC-PULL-SELECT-STATUS  TO CE004-PULL-SELECT-STATUS.    30600051
263800     MOVE ASC-PULL-SELECT-TYPE    TO CE004-PULL-SELECT-TYPE.      30610051
263900     MOVE ASC-PULL-SELECT-DATE-FROM                               30620051
264000                                  TO CE004-PULL-SELECT-DATE-FROM. 30630051
264100     MOVE ASC-PULL-SELECT-DATE-TO TO CE004-PULL-SELECT-DATE-TO.   30640051
264200     MOVE ASC-SELECT-LIST-SEQUENCE                                30650051
264300                                  TO CE004-SELECT-LIST-SEQUENCE.  30660051
264400     MOVE ASC-PULL-NBR-N          TO CE004-PULL-NBR.              30670051
264500     MOVE ASC-REF-NBR             TO CE004-REF-NBR.               30680051
264600     MOVE ZEROES                  TO CE004-LINE-NBR.              30690051
264700     MOVE ASC-CURR-PULL-STATUS    TO CE004-PULL-STATUS.           30700051
264800     MOVE ASC-CURR-PULL-TYPE      TO CE004-PULL-SOURCE.           30710051
264900     MOVE ASC-CS-LOCATION-N       TO CE004-CS-LOCATION.           30720051
265000     MOVE ZEROES                  TO CE004-NBR-ITEMS.             30730051
265100     MOVE ZEROES                  TO CE004-REQ-PULL-UNITS.        30740051
265200     MOVE ZEROES                  TO CE004-ACT-PULL-UNITS.        30750051
265300     MOVE ZEROES                  TO CE004-DISTRBUTED-UNITS.      30760051
265400     MOVE DP020-USERID            TO CE004-USER-ID.               30770051
265500                                                                  30780051
265600     MOVE LENGTH OF CE004-COMMAREA-REC  TO PV-COMMAREA-LENGTH.    30790051
265700                                                                  30800051
265800     EXEC CICS                                                    30810051
265900         LINK                                                     30820051
266000             PROGRAM   (PC-PRINT-PROGRAM)                         30830051
266100             COMMAREA  (CE004-COMMAREA-REC)                       30840051
266200             RESP      (PV-CICS-RESPONSE)                         30850051
266300     END-EXEC.                                                    30860051
266400                                                                  30870051
266500     EVALUATE TRUE                                                30880051
266600         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 30890051
266700              PERFORM 4640-VALIDATE-PRT-REQ-CALL                  30900051
266800         WHEN OTHER                                               30910051
266900              SET  PS-ERROR                                       30920051
267000                   DP020-MSG-FATAL TO TRUE                        30930051
267100              MOVE PC-TSYMSG-02238 TO DP020-MSG-NUMBER            30940051
267200              MOVE -1              TO MPULLNOL                    30950051
267300              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 30960051
267400     END-EVALUATE.                                                30970051
267500                                                                  30980051
267600                                                                  30990051
267700*----------------------------------------------------------------*31000051
267800* CHECK RETURN CODE FROM LABEL PRINT PROGRAM TO SEE IF SUCCESSFUL*31010051
267900*----------------------------------------------------------------*31020051
268000 4640-VALIDATE-PRT-REQ-CALL.                                      31030051
268100                                                                  31040051
268200     IF  CE004-PRT-SUCCESSFUL                                     31050051
268300         CONTINUE                                                 31060051
268400     ELSE                                                         31070051
268500          SET  PS-ERROR                                           31080051
268600               DP020-MSG-FATAL TO TRUE                            31090051
268700          MOVE PC-TSYMSG-02238 TO DP020-MSG-NUMBER                31100051
268800          MOVE -1              TO MPULLNOL                        31110051
268900          SET DP030-SET-CURSOR-APPL-1 TO TRUE                     31120051
269000     END-IF.                                                      31130051
269100                                                                  31140051
269200                                                                  31150051
269300*----------------------------------------------------------------*31160051
269400*  PRINT PULL FUNCTION - IF ONLY REFERENCE # IS KNOWN            *31170051
269500*----------------------------------------------------------------*31180051
269600 4700-PROCESS-PRINT-FUNCTION.                                     31190051
269700                                                                  31200051
269800     MOVE ASC-REF-NBR             TO DK-REF-NUMBER                31210051
269900     MOVE ZEROES                  TO DK-PULL-NUMBER               31220051
270000                                                                  31230051
270100     EVALUATE TRUE                                                31240051
270200         WHEN  ASC-SELECT-ALL                                     31250051
270300                   SET  PV-STATUS-1-NEW                           31260051
270400                        PV-STATUS-2-NEW                           31270051
270500                        PV-STATUS-3-INPROCESS                     31280051
270600                        PV-STATUS-4-DISTRIBTD                     31290051
270700                        PV-STATUS-5-POSTED     TO  TRUE           31300051
270800         WHEN  ASC-SELECT-CNCLD                                   31310051
270900                   SET  PV-STATUS-1-CANCELLED                     31320051
271000                        PV-STATUS-2-CANCELLED                     31330051
271100                        PV-STATUS-3-CANCELLED                     31340051
271200                        PV-STATUS-4-CANCELLED                     31350051
271300                        PV-STATUS-5-CANCELLED  TO  TRUE           31360051
271400         WHEN  ASC-SELECT-DSTRB                                   31370051
271500                   SET  PV-STATUS-1-DISTRIBTD                     31380051
271600                        PV-STATUS-2-DISTRIBTD                     31390051
271700                        PV-STATUS-3-DISTRIBTD                     31400051
271800                        PV-STATUS-4-DISTRIBTD                     31410051
271900                        PV-STATUS-5-DISTRIBTD  TO  TRUE           31420051
272000         WHEN  ASC-SELECT-INPROC                                  31430051
272100                   SET  PV-STATUS-1-INPROCESS                     31440051
272200                        PV-STATUS-2-INPROCESS                     31450051
272300                        PV-STATUS-3-INPROCESS                     31460051
272400                        PV-STATUS-4-INPROCESS                     31470051
272500                        PV-STATUS-5-INPROCESS  TO  TRUE           31480051
272600         WHEN  ASC-SELECT-NEW                                     31490051
272700                   SET  PV-STATUS-1-NEW                           31500051
272800                        PV-STATUS-2-NEW                           31510051
272900                        PV-STATUS-3-NEW                           31520051
273000                        PV-STATUS-4-NEW                           31530051
273100                        PV-STATUS-5-NEW        TO  TRUE           31540051
273200         WHEN  ASC-SELECT-POSTD                                   31550051
273300                   SET  PV-STATUS-1-POSTED                        31560051
273400                        PV-STATUS-2-POSTED                        31570051
273500                        PV-STATUS-3-POSTED                        31580051
273600                        PV-STATUS-4-POSTED                        31590051
273700                        PV-STATUS-5-POSTED     TO  TRUE           31600051
273800         WHEN  ASC-SELECT-NEW-INPROC                              31610051
273900                   SET  PV-STATUS-1-NEW                           31620051
274000                        PV-STATUS-2-INPROCESS                     31630051
274100                        PV-STATUS-3-INPROCESS                     31640051
274200                        PV-STATUS-4-INPROCESS                     31650051
274300                        PV-STATUS-5-INPROCESS  TO  TRUE           31660051
274400     END-EVALUATE.                                                31670051
274500                                                                  31680051
274600**DJK - 05/04/10 - ADDED FLAG INFORMATION BELOW TO ACCOMODATE     31690051
274700**                 EFC2                                           31700051
274800     EVALUATE TRUE                                                31710051
274900         WHEN  ASC-SELECT-SRC-ALL                                 31720051
275000                   SET  PV-TYPE-1-ADAM                            31730051
275100                        PV-TYPE-2-INFOREM                         31740051
275200                        PV-TYPE-3-MANUAL                          31750051
275300                        PV-TYPE-4-XFER         TO  TRUE           31760051
275400         WHEN  ASC-SELECT-SRC-ADAM                                31770051
275500                   SET  PV-TYPE-1-ADAM                            31780051
275600                        PV-TYPE-2-ADAM                            31790051
275700                        PV-TYPE-3-ADAM                            31800051
275800                        PV-TYPE-4-ADAM         TO  TRUE           31810051
275900         WHEN  ASC-SELECT-SRC-INFOREM                             31820051
276000                   SET  PV-TYPE-1-INFOREM                         31830051
276100                        PV-TYPE-2-INFOREM                         31840051
276200                        PV-TYPE-3-INFOREM                         31850051
276300                        PV-TYPE-4-INFOREM      TO  TRUE           31860051
276400         WHEN  ASC-SELECT-SRC-MANUAL                              31870051
276500                   SET  PV-TYPE-1-MANUAL                          31880051
276600                        PV-TYPE-2-MANUAL                          31890051
276700                        PV-TYPE-3-MANUAL                          31900051
276800                        PV-TYPE-4-MANUAL       TO  TRUE           31910051
276900         WHEN  ASC-SELECT-SRC-XFER                                31920051
277000                   SET  PV-TYPE-1-XFER                            31930051
277100                        PV-TYPE-2-XFER                            31940051
277200                        PV-TYPE-3-XFER                            31950051
277300                        PV-TYPE-4-XFER         TO  TRUE           31960051
277400     END-EVALUATE.                                                31970051
277500                                                                  31980051
277600     IF  PS-NO-ERROR                                              31990051
277700         PERFORM 4710-OPEN-CURSOR                                 32000051
277800     END-IF.                                                      32010051
277900                                                                  32020051
278000     IF  PS-NO-ERROR                                              32030051
278100         PERFORM 4730-FETCH                                       32040051
278200     END-IF.                                                      32050051
278300                                                                  32060051
278400     IF  PS-EOF-PULL-REF-NBR-CSR                                  32070051
278500         CONTINUE                                                 32080051
278600     ELSE                                                         32090051
278700         PERFORM                                                  32100051
278800           UNTIL PS-EOF-PULL-REF-NBR-CSR                          32110051
278900              OR PS-ERROR                                         32120051
279000                 MOVE CEPLRQ-CNSTK-REQ-PL-NBR                     32130051
279100                   TO ASC-PULL-NBR-N                              32140051
279200                      DK-PULL-NUMBER                              32150051
279300                 MOVE CEPLRQ-SRC-TYP-CDE                          32160051
279400                   TO ASC-CURR-PULL-TYPE                          32170051
279500                 MOVE CEPLRQ-STAT-CDE                             32180051
279600                   TO ASC-CURR-PULL-STATUS                        32190051
279700                 IF  PS-NO-ERROR                                  32200051
279800                     PERFORM 4600-PROCESS-PRINT-FUNCTION          32210051
279900                 END-IF                                           32220051
280000                 IF  PS-NO-ERROR                                  32230051
280100                     PERFORM 4710-OPEN-CURSOR                     32240051
280200                 END-IF                                           32250051
280300                 IF  PS-NO-ERROR                                  32260051
280400                     PERFORM 4730-FETCH                           32270051
280500                 END-IF                                           32280051
280600         END-PERFORM                                              32290051
280700     END-IF.                                                      32300051
280800                                                                  32310051
280900     IF  PS-NO-ERROR                                              32320051
281000         MOVE ZEROES TO ASC-PULL-NBR-N                            32330051
281100     END-IF.                                                      32340051
281200                                                                  32350051
281300                                                                  32360051
281400*----------------------------------------------------------------*32370051
281500* OPEN REFERENCE NUMBER PULL CURSOR                              *32380051
281600*----------------------------------------------------------------*32390051
281700 4710-OPEN-CURSOR.                                                32400051
281800                                                                  32410051
281900     EXEC SQL                                                     32420051
282000          OPEN PULL-REF-NBR-CSR                                   32430051
282100     END-EXEC.                                                    32440051
282200                                                                  32450051
282300     EVALUATE TRUE                                                32460051
282400         WHEN SQLCODE = ZERO                                      32470051
282500             CONTINUE                                             32480051
282600                                                                  32490051
282700         WHEN SQLWARN0 NOT = SPACES                               32500051
282800         WHEN SQLCODE < ZERO                                      32510051
282900         WHEN SQLCODE > ZERO                                      32520051
283000              MOVE '4710-OPEN-CURSOR'                             32530051
283100                                   TO DP013-PARAGRAPH             32540051
283200              MOVE 'OPEN PULL REFERENCE CURSOR - '                32550051
283300                                   TO DP013-MESSAGE-TEXT (1)      32560051
283400              MOVE SQLCA           TO DP013-SQLCA                 32570051
283500              MOVE 'TCEPLRQ '      TO DP013-DB2-TABLE-NAME (1)    32580051
283600              SET DP013-DB2-ABEND                                 32590051
283700              DP013-XCTL-DISPLAY-RESTART TO TRUE                  32600051
283800              PERFORM DP013-0000-PROCESS-ABEND                    32610051
283900     END-EVALUATE.                                                32620051
284000                                                                  32630051
284100                                                                  32640051
284200*----------------------------------------------------------------*32650051
284300*    FETCH THE REFERENCE NUMBER PULL CURSOR                      *32660051
284400*----------------------------------------------------------------*32670051
284500 4730-FETCH.                                                      32680051
284600                                                                  32690051
284700     EXEC SQL                                                     32700051
284800          FETCH PULL-REF-NBR-CSR                                  32710051
284900           INTO  :CEPLRQ-CNSTK-REQ-PL-NBR                         32720051
285000               , :CEPLRQ-CNSTK-LOC-ID                             32730051
285100               , :CEPLRQ-SRC-REF-NBR                              32740051
285200               , :CEPLRQ-SRC-TYP-CDE                              32750051
285300               , :CEPLRQ-STAT-CDE                                 32760051
285400      END-EXEC.                                                   32770051
285500                                                                  32780051
285600                                                                  32790051
285700     EVALUATE TRUE                                                32800051
285800         WHEN SQLCODE = ZERO                                      32810051
285900              CONTINUE                                            32820051
286000                                                                  32830051
286100         WHEN SQLCODE = +100                                      32840051
286200              SET PS-EOF-PULL-REF-NBR-CSR TO TRUE                 32850051
286300                                                                  32860051
286400         WHEN SQLWARN0 NOT = SPACE                                32870051
286500         WHEN SQLCODE NOT = ZERO                                  32880051
286600              MOVE '4730-FETCH'                                   32890051
286700                               TO DP013-PARAGRAPH                 32900051
286800              MOVE 'FETCH REFERENCE NUMBER PULL CURSOR'           32910051
286900                               TO DP013-MESSAGE-TEXT (1)          32920051
287000              MOVE SQLCA       TO DP013-SQLCA                     32930051
287100              SET DP013-DB2-ABEND                                 32940051
287200                               TO TRUE                            32950051
287300              PERFORM DP013-0000-PROCESS-ABEND                    32960051
287400     END-EVALUATE.                                                32970051
287500                                                                  32980051
287600*----------------------------------------------------------------*32990051
287700* LINK TO CANCEL/CONFIRMATION MODULE                             *33000051
287800*----------------------------------------------------------------*33010051
287900 5000-LINK-CONFIRM-MODULE.                                        33020051
288000                                                                  33030051
288100     MOVE DP020-USERID              TO  CE005-USER-ID.            33040051
288200     MOVE ASC-CURR-OPER-UNT-ID-N    TO  CE005-CURR-OPER-UNT-ID-N. 33050051
288300     MOVE ASC-CURR-FCLTY-ID-N       TO  CE005-CURR-FCLTY-ID-N.    33060051
288400     MOVE ASC-CS-LOCATION-N         TO  CE005-CS-LOCATION.        33070051
288500     MOVE ASC-CS-PRINTER-ID         TO  CE005-CS-PRINTER-ID.      33080051
288600     MOVE ASC-PULL-NBR-N            TO  CE005-PULL-NBR.           33090051
288700     MOVE ASC-REF-NBR               TO  CE005-REF-NBR.            33100051
288800     MOVE ASC-CURR-PULL-STATUS      TO  CE005-CURR-PULL-STATUS.   33110051
288900                                                                  33120051
289000     MOVE LENGTH OF CE005-INTER-APPL-COMMAREA                     33130051
289100                                    TO  PV-COMMAREA-LENGTH.       33140051
289200                                                                  33150051
289300     EXEC CICS                                                    33160051
289400         LINK                                                     33170051
289500             PROGRAM   (PC-CONFIRM-MODULE)                        33180051
289600             COMMAREA  (CE005-INTER-APPL-COMMAREA)                33190051
289700             RESP      (PV-CICS-RESPONSE)                         33200051
289800     END-EXEC.                                                    33210051
289900                                                                  33220051
290000     EVALUATE TRUE                                                33230051
290100         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 33240051
290200             PERFORM 5003-VALIDATE-CONFIRM-CALL                   33250051
290300         WHEN OTHER                                               33260051
290400              EVALUATE TRUE                                       33270051
290500                  WHEN CE005-RETURN-MSG = 'MQ SERIES ERROR'       33280051
290600                       SET  PS-ERROR                              33290051
290700                            DP020-MSG-FATAL  TO TRUE              33300051
290800                       MOVE PC-TSYMSG-02677  TO DP020-MSG-NUMBER  33310051
290900                  WHEN CE005-CNCL-PULL                            33320051
291000                  WHEN CE005-UNCNCL-PULL                          33330051
291100                       SET  PS-ERROR                              33340051
291200                            DP020-MSG-FATAL  TO TRUE              33350051
291300                       MOVE PC-TSYMSG-02269  TO DP020-MSG-NUMBER  33360051
291400                  WHEN CE005-CNFM-DIST-PULL                       33370051
291500                  WHEN CE005-UNCNFM-DIST-PULL                     33380051
291600                       SET  PS-ERROR                              33390051
291700                            DP020-MSG-FATAL  TO TRUE              33400051
291800                       MOVE PC-TSYMSG-02270  TO DP020-MSG-NUMBER  33410051
291900                  WHEN CE005-CNFM-PULL                            33420051
292000                  WHEN CE005-UNCNFM-PULL                          33430051
292100                       SET  PS-ERROR                              33440051
292200                            DP020-MSG-FATAL  TO TRUE              33450051
292300                       MOVE PC-TSYMSG-02271  TO DP020-MSG-NUMBER  33460051
292400              END-EVALUATE                                        33470051
292500     END-EVALUATE.                                                33480051
292600                                                                  33490051
292700     PERFORM 5010-GET-PULL-STATUS.                                33500051
292800     PERFORM 8000-MOVE-COMMAREA-TO-SCREEN.                        33510051
292900                                                                  33520051
293000                                                                  33530051
293100*----------------------------------------------------------------*33540051
293200* CHECK RETURN CODE FROM CNFM/CNCL PROGRAM TO SEE IF SUCCESSFUL  *33550051
293300*----------------------------------------------------------------*33560051
293400 5003-VALIDATE-CONFIRM-CALL.                                      33570051
293500                                                                  33580051
293600     EVALUATE TRUE                                                33590051
293700         WHEN CE005-FUNC-SUCCESSFUL                               33600051
293800              EVALUATE TRUE                                       33610051
293900                  WHEN CE005-CNCL-PULL                            33620051
294000                  WHEN CE005-UNCNCL-PULL                          33630051
294100                       SET  DP020-MSG-INFORMATIONAL  TO TRUE      33640051
294200                       MOVE PC-TSYMSG-02274  TO DP020-MSG-NUMBER  33650051
294300                  WHEN CE005-CNFM-DIST-PULL                       33660051
294400                  WHEN CE005-UNCNFM-DIST-PULL                     33670051
294500                       SET  DP020-MSG-INFORMATIONAL  TO TRUE      33680051
294600                       MOVE PC-TSYMSG-02275  TO DP020-MSG-NUMBER  33690051
294700                  WHEN CE005-CNFM-PULL                            33700051
294800                  WHEN CE005-UNCNFM-PULL                          33710051
294900                       SET  DP020-MSG-INFORMATIONAL  TO TRUE      33720051
295000                       MOVE PC-TSYMSG-02276  TO DP020-MSG-NUMBER  33730051
295100              END-EVALUATE                                        33740051
295200                                                                  33750051
295300         WHEN OTHER                                               33760051
295400              EVALUATE TRUE                                       33770051
295500                  WHEN CE005-CNCL-PULL                            33780051
295600                  WHEN CE005-UNCNCL-PULL                          33790051
295700                       SET  PS-ERROR                              33800051
295800                            DP020-MSG-FATAL  TO TRUE              33810051
295900                       MOVE PC-TSYMSG-02269  TO DP020-MSG-NUMBER  33820051
296000                  WHEN CE005-CNFM-DIST-PULL                       33830051
296100                  WHEN CE005-UNCNFM-DIST-PULL                     33840051
296200                       SET  PS-ERROR                              33850051
296300                            DP020-MSG-FATAL  TO TRUE              33860051
296400                       MOVE PC-TSYMSG-02270  TO DP020-MSG-NUMBER  33870051
296500                  WHEN CE005-CNFM-PULL                            33880051
296600                  WHEN CE005-UNCNFM-PULL                          33890051
296700                       SET  PS-ERROR                              33900051
296800                            DP020-MSG-FATAL  TO TRUE              33910051
296900                       MOVE PC-TSYMSG-02271  TO DP020-MSG-NUMBER  33920051
297000              END-EVALUATE                                        33930051
297100     END-EVALUATE.                                                33940051
297200                                                                  33950051
297300                                                                  33960051
297400*----------------------------------------------------------------*33970051
297500* GET NEW PULL STATUS AFTER PULL REQUEST HAS BEEN UPDATED        *33980051
297600*----------------------------------------------------------------*33990051
297700 5010-GET-PULL-STATUS.                                            34000051
297800                                                                  34010051
297900     MOVE ASC-PULL-NBR-N  TO  DK-PULL-NUMBER                      34020051
298000                                                                  34030051
298100     EXEC SQL                                                     34040051
298200          SELECT STAT_CDE                                         34050051
298300            INTO :CEPLRQ-STAT-CDE                                 34060051
298400            FROM TCEPLRQ                                          34070051
298500           WHERE CNSTK_REQ_PL_NBR  =  :DK-PULL-NUMBER             34080051
298600     END-EXEC.                                                    34090051
298700                                                                  34100051
298800     EVALUATE TRUE                                                34110051
298900         WHEN SQLCODE = +0                                        34120051
299000              MOVE  CEPLRQ-STAT-CDE  TO  ASC-CURR-PULL-STATUS     34130051
299100                                                                  34140051
299200         WHEN SQLCODE = +100                                      34150051
299300              SET PS-ERROR                                        34160051
299400                  DP020-MSG-FATAL         TO TRUE                 34170051
299500              MOVE PC-TSYMSG-02214        TO DP020-MSG-NUMBER     34180051
299600              MOVE DP015-UNP-ALP-BRT-OFF  TO MPULLNOA             34190051
299700              MOVE DP015-RED              TO MPULLNOC             34200051
299800              MOVE DP015-REVERSE          TO MPULLNOH             34210051
299900              MOVE -1                     TO MPULLNOL             34220051
300000              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 34230051
300100                                                                  34240051
300200         WHEN OTHER                                               34250051
300300              MOVE  ASC-PULL-NBR   TO PV-DISPLAY-PULL-NBR         34260051
300400              MOVE '5010-GET-PULL-STATUS'                         34270051
300500                                       TO DP013-PARAGRAPH         34280051
300600              MOVE 'GET NEW PULL STATUS AFTER UPDATE'             34290051
300700                                       TO DP013-MESSAGE-TEXT (1)  34300051
300800              STRING ' PULL NBR-'         DELIMITED BY SIZE       34310051
300900                     PV-DISPLAY-PULL-NBR  DELIMITED BY SIZE       34320051
301000                                     INTO DP013-MESSAGE-TEXT (2)  34330051
301100              MOVE SQLCA   TO DP013-SQLCA                         34340051
301200              MOVE 'TCEPLRQ ' TO DP013-DB2-TABLE-NAME (1)         34350051
301300              SET DP013-DB2-ABEND                                 34360051
301400                  DP013-XCTL-DISPLAY-RESTART TO TRUE              34370051
301500              PERFORM DP013-0000-PROCESS-ABEND                    34380051
301600                                                                  34390051
301700     END-EVALUATE.                                                34400051
301800                                                                  34410051
301900                                                                  34420051
302000*----------------------------------------------------------------*34430051
302100*  POSITION THE CURSOR AT THE APPROPRIATE FIELD.                 *34440051
302200*  IF THERE IS ANY DATA TO MOVE TO THE SCREEN ON INITIAL, MOVE   *34450051
302300*  IT HERE.                                                      *34460051
302400*----------------------------------------------------------------*34470051
302500 7000-BUILD-INITIAL-PANEL.                                        34480051
302600     SET DP030-SET-CURSOR-APPL-1   TO TRUE                        34490051
302700     MOVE -1                       TO MPULLNOL.                   34500051
302800                                                                  34510051
302900     MOVE SPACE                    TO MPULLSTO                    34520051
303000                                      MDPTDESO                    34530051
303100                                      MSRCTYPO                    34540051
303200                                      MLSTSEQO                    34550051
303300                                      MREFNOO.                    34560051
303400                                                                  34570051
303500     MOVE ZEROES                   TO MPULLNOO                    34580051
303600                                      MMCLASSO                    34590051
303610                                      MSCLASSO                    34600051
303620                                      MDEPTNOO.                   34610051
303700                                                                  34620051
303800     MOVE PC-Z                     TO MPULLSTO.                   34630051
303900     MOVE PC-A                     TO MSRCTYPO.                   34640051
304000     MOVE PC-P                     TO MLSTSEQO.                   34650051
304100                                                                  34660051
304200     MOVE DP020-LOCATION-NBR       TO DK-CURR-OPER-UNT-ID.        34670051
304300     MOVE PC-FCLTY-ID-0001         TO DK-CURR-FCLTY-ID.           34680051
304400     PERFORM 7005-GET-DFLT-CS-LOC-ID.                             34690051
304410     PERFORM 7010-GET-CURRENT-DATE.                               34700051
304500                                                                  34710051
304600     INITIALIZE XL071-COMMAREA-REC.                               34720051
304700     MOVE ASC-CURR-OPER-UNT-ID-N   TO XL071-LOCATION-NUMBER.      34730051
304800     PERFORM 3500-GET-STORE-INFORMATION.                          34740051
304900     EVALUATE TRUE                                                34750051
305000         WHEN XL071-NO-ERRORS                                     34760051
305100              MOVE XL071-LOC-NM TO MLOCDESO                       34770051
305110                                         ASC-CS-LOCATION-DESC     34780051
305120                                                                  34790051
305130              IF  XL071-LOC-TYP-CDE  =  PC-CS OR                  34800051
305140                 (XL071-LOC-TYP-CDE  =  PC-DS AND                 34810051
305150                  XL071-E-BUS-IND    = 'Y')                       34820051
305160                  CONTINUE                                        34830051
305170              ELSE                                                34840051
305180                  SET PS-ERROR                                    34850051
305190                      DP020-MSG-FATAL   TO TRUE                   34860051
305191                  MOVE PC-TSYMSG-02219 TO DP020-MSG-NUMBER        34870051
305192                  MOVE DP015-UNP-ALP-BRT-OFF                      34880051
305193                                        TO MLOCIDA                34890051
305194                  MOVE DP015-RED        TO MLOCIDC                34900051
305195                  MOVE DP015-REVERSE    TO MLOCIDH                34910051
305196                  MOVE -1               TO MLOCIDL                34920051
305197                  SET DP030-SET-CURSOR-APPL-1 TO TRUE             34930051
305198              END-IF                                              34940051
305199                                                                  34950051
305200         WHEN OTHER                                               34960051
305201              CONTINUE                                            34970051
305202                                                                  34980051
305203     END-EVALUATE.                                                34990051
305204                                                                  35000051
305205     MOVE XL071-LOCATION-NUMBER    TO MLOCIDO.                    35010051
305206     MOVE XL071-LOC-NM             TO MLOCDESO.                   35020051
305207                                                                  35030051
305208     MOVE COCNTL-DFLT-CNSTK-PRTR-ID TO  MPRTIDO.                  35040051
305209                                                                  35050051
305210     MOVE PV-CURR-MM               TO MTOMMO.                     35060051
305220     MOVE PV-CURR-DD               TO MTODDO.                     35070051
305230     MOVE PV-CURR-YY               TO MTOYYO.                     35080051
305240                                                                  35090051
305250* CLT 06/30/2010 START WR#38786                                   35100051
305260     MOVE PV-LESS-MM               TO  MFROMMMO.                  35110051
305270     MOVE PV-LESS-DD               TO  MFROMDDO.                  35120051
305280     MOVE PV-LESS-YY               TO  MFROMYYO.                  35130051
305300                                                                  35140051
305469* CLT 06/30/2010 END                                              35150051
305470*----------------------------------------------------------------*35160051
305500*       GET DEFAULT CENTRAL STOCK LOCATION                       *35170051
305600*----------------------------------------------------------------*35180051
305700 7005-GET-DFLT-CS-LOC-ID.                                         35190051
305800                                                                  35200051
305900     INITIALIZE DCLTCOCNTL.                                       35210051
306000                                                                  35220051
306100* CLT 06/30/2010 START WR#38786                                   35230051
306200     EXEC SQL                                                     35240051
306300         SELECT DFLT_CNSTK_LOC_ID                                 35250051
306400              , DFLT_CNSTK_PRTR_ID                                35260051
306700           INTO :COCNTL-DFLT-CNSTK-LOC-ID                         35270051
306800              , :COCNTL-DFLT-CNSTK-PRTR-ID                        35280051
307100           FROM TCOCNTL A                                         35290051
307200          WHERE A.OPER_UNT_ID = :DK-CURR-OPER-UNT-ID              35300051
307300            AND A.FCLTY_ID    = :DK-CURR-FCLTY-ID                 35310051
307400     END-EXEC.                                                    35320051
307600                                                                  35330051
307700     EVALUATE TRUE                                                35340051
307800         WHEN SQLCODE = +0                                        35350051
307900             MOVE COCNTL-DFLT-CNSTK-LOC-ID TO                     35360051
308000                                      DK-OPER-UNT-ID              35370051
308100                                      ASC-CURR-OPER-UNT-ID-N      35380051
308200         WHEN SQLCODE = +100                                      35390051
308300             MOVE DK-CURR-OPER-UNT-ID TO                          35400051
308400                                      DK-OPER-UNT-ID              35410051
308500                                      ASC-CURR-OPER-UNT-ID-N      35420051
308510* CLT 06/30/2010 END                                              35430051
308540         WHEN SQLWARN0 NOT = +0                                   35440051
308550         WHEN SQLCODE < +0                                        35450051
308560         WHEN SQLCODE > +0                                        35460051
308570             SET PS-ERROR    TO TRUE                              35470051
308580             MOVE '7005-GET-DFLT-CS-LOC-ID'                       35480051
308590                             TO DP013-PARAGRAPH                   35490051
308600             MOVE 'UNSUCCESSFUL SELECT ON CONTROL TABLE'          35500051
308700                             TO DP013-MESSAGE-TEXT (1)            35510051
308800             MOVE DK-CURR-OPER-UNT-ID TO PV-CURR-OPER-UNT-ID      35520051
308900             MOVE DK-CURR-FCLTY-ID    TO PV-CURR-FCLTY-ID         35530051
309000             STRING 'LOCATION - '     DELIMITED BY SIZE           35540051
309100                  PV-CURR-OPER-UNT-ID DELIMITED BY SIZE           35550051
309200                    '  FACILITY - '     DELIMITED BY SIZE         35560051
309300                  PV-CURR-FCLTY-ID    DELIMITED BY SIZE           35570051
309400                           INTO DP013-MESSAGE-TEXT (2)            35580051
309500             MOVE SQLCA      TO DP013-SQLCA                       35590051
309600             MOVE 'TCOCNTL ' TO DP013-DB2-TABLE-NAME (1)          35600051
309700             SET DP013-DB2-ABEND                                  35610051
309800                 DP013-XCTL-DISPLAY-RESTART TO TRUE               35620051
309900             PERFORM DP013-0000-PROCESS-ABEND                     35630051
310000     END-EVALUATE.                                                35640051
310100                                                                  35650051
310110* CLT 06/30/2010 START ADD PV-LESS2WK-DATE WR#38786               35660051
310954 7010-GET-CURRENT-DATE.                                           35670051
310955     EXEC SQL                                                     35680051
310958         SELECT CURRENT DATE                                      35690051
310959              , CURRENT DATE - FUNC_QTY DAYS                      35700051
310962           INTO :PV-CURRENT-DATE                                  35710051
310963              , :PV-LESS2WK-DATE                                  35720051
310965           FROM TKRPRPM                                           35730051
310968          WHERE LOC_ID           = 90                             35740051
310969            AND INTFC_SYS_CDE    = 'KHL'                          35750051
310970            AND SYS_PRC_FUNC_CDE = 'CSDAYS'                       35760051
310974     END-EXEC.                                                    35770051
310975                                                                  35780051
310976     EVALUATE TRUE                                                35790051
310977         WHEN SQLCODE NOT = +0                                    35800051
310978              MOVE '9999-09-09' TO PV-CURRENT-DATE                35810051
310979              MOVE '0001-01-01' TO PV-LESS2WK-DATE                35820051
310980     END-EVALUATE.                                                35830051
310981* CLT 06/30/2010 END                                              35840051
310982                                                                  35850051
310983*----------------------------------------------------------------*35860051
310984* OPEN LINE CURSOR FOR CONFIRM DISTRIBUTION FUNCTION             *35870051
310990*----------------------------------------------------------------*35880051
311000 7050-OPEN-CNFM-LNE-CSR.                                          35890051
311100                                                                  35900051
311200      EXEC SQL                                                    35910051
311300           OPEN CNFM-LINE-ITEM-CSR                                35920051
311400      END-EXEC                                                    35930051
311500                                                                  35940051
311600     EVALUATE TRUE                                                35950051
311700         WHEN SQLCODE = ZERO                                      35960051
311800             CONTINUE                                             35970051
311900         WHEN SQLWARN0 NOT = SPACES                               35980051
312000         WHEN SQLCODE < ZERO                                      35990051
312100         WHEN SQLCODE > ZERO                                      36000051
312200              SET PS-ERROR    TO TRUE                             36010051
312300              MOVE '7050-OPEN-CNFM-LNE-CURSOR'                    36020051
312400                              TO DP013-PARAGRAPH                  36030051
312500              MOVE 'OPEN CS CONFIRM LINE CURSOR - '               36040051
312600                              TO DP013-MESSAGE-TEXT (1)           36050051
312700              MOVE 'CURSOR:  CNFM-LINE-ITEM-CSR      '            36060051
312800                              TO DP013-MESSAGE-TEXT (2)           36070051
312900              MOVE SQLCA      TO DP013-SQLCA                      36080051
313000              MOVE 'TCEPLIT ' TO DP013-DB2-TABLE-NAME (1)         36090051
313100              SET DP013-DB2-ABEND                                 36100051
313200                  DP013-XCTL-DISPLAY-RESTART TO TRUE              36110051
313300              PERFORM DP013-0000-PROCESS-ABEND                    36120051
313400     END-EVALUATE.                                                36130051
313500                                                                  36140051
313600                                                                  36150051
313700*----------------------------------------------------------------*36160051
313800* FETCH LINE CURSOR FOR CONFIRM DISTRIBUTION FUNCTION            *36170051
313900*----------------------------------------------------------------*36180051
314000 7055-FETCH-CNFM-LNE-CSR.                                         36190051
314100                                                                  36200051
314200     EXEC SQL                                                     36210051
314300          FETCH CNFM-LINE-ITEM-CSR                                36220051
314400           INTO :CEPLIT-PL-LNE-NBR                                36230051
314500     END-EXEC.                                                    36240051
314600                                                                  36250051
314700     EVALUATE TRUE                                                36260051
314800         WHEN SQLCODE = ZERO                                      36270051
314900              ADD  1  TO  PV-IN-PROCESS-CNT                       36280051
315000                                                                  36290051
315100         WHEN SQLCODE = +100                                      36300051
315200              SET PS-EOF-CNFM-LNE-CSR  TO  TRUE                   36310051
315300                                                                  36320051
315400         WHEN SQLWARN0 NOT = SPACE                                36330051
315500         WHEN SQLCODE NOT = ZERO                                  36340051
315600              SET PS-ERROR     TO TRUE                            36350051
315700              MOVE '7055-FETCH-CNFM-LNE-CSR.'                     36360051
315800                               TO DP013-PARAGRAPH                 36370051
315900              MOVE 'FETCH CS CONFIRM DISTRO LINE CURSOR'          36380051
316000                               TO DP013-MESSAGE-TEXT (1)          36390051
316100              MOVE 'CURSOR:  CNFM-LINE-ITEM-CSR  '                36400051
316200                               TO DP013-MESSAGE-TEXT (2)          36410051
316300              MOVE SQLCA       TO DP013-SQLCA                     36420051
316400              MOVE 'TCEPLIT'   TO DP013-DB2-TABLE-NAME (1)        36430051
316500              SET DP013-DB2-ABEND                                 36440051
316600                               TO TRUE                            36450051
316700              PERFORM DP013-0000-PROCESS-ABEND                    36460051
316800     END-EVALUATE.                                                36470051
316900                                                                  36480051
317000                                                                  36490051
317100*----------------------------------------------------------------*36500051
317200* CLOSE LINE CURSOR FOR CONFIRM DISTRIBUTION FUNCTION            *36510051
317300*----------------------------------------------------------------*36520051
317400 7060-CLOSE-CNFM-LNE-CSR.                                         36530051
317500                                                                  36540051
317600     EXEC SQL                                                     36550051
317700          CLOSE CNFM-LINE-ITEM-CSR                                36560051
317800     END-EXEC                                                     36570051
317900                                                                  36580051
318000     EVALUATE TRUE                                                36590051
318100         WHEN SQLCODE = ZERO                                      36600051
318200             CONTINUE                                             36610051
318300         WHEN SQLWARN0 NOT = SPACES                               36620051
318400         WHEN SQLCODE < ZERO                                      36630051
318500         WHEN SQLCODE > ZERO                                      36640051
318600             MOVE '7060-CLOSE-CNFM-LNE-CSR '                      36650051
318700                               TO DP013-PARAGRAPH                 36660051
318800             MOVE 'CLOSE CS CONFIRM DISTRO LINE CSR'              36670051
318900                               TO DP013-MESSAGE-TEXT (1)          36680051
319000             MOVE 'CURSOR:  CNFM-LINE-ITEM-CSR'                   36690051
319100                               TO DP013-MESSAGE-TEXT (2)          36700051
319200             MOVE SQLCA        TO DP013-SQLCA                     36710051
319300             MOVE 'TCEPLIT '   TO DP013-DB2-TABLE-NAME (1)        36720051
319400             SET DP013-DB2-ABEND                                  36730051
319500                 DP013-XCTL-DISPLAY-RESTART TO TRUE               36740051
319600             PERFORM DP013-0000-PROCESS-ABEND                     36750051
319700     END-EVALUATE.                                                36760051
319800                                                                  36770051
319900                                                                  36780051
320000*----------------------------------------------------------------*36790051
320100*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *36800051
320200*----------------------------------------------------------------*36810051
320300 8000-MOVE-COMMAREA-TO-SCREEN.                                    36820051
320400                                                                  36830051
320500     IF  ASC-CS-LOCATION  =  PC-ALL                               36840051
320600         MOVE 'ALL -CS- LOCATIONS       '                         36850051
320700                                   TO ASC-CS-LOCATION-DESC        36860051
320800     ELSE                                                         36870051
320900         MOVE ASC-CS-LOCATION-N    TO PV-4-DIGIT-STORE            36880051
321000         MOVE PV-4-DIGIT-STORE     TO MLOCIDO                     36890051
321100     END-IF.                                                      36900051
321200     MOVE ASC-CS-LOCATION-DESC     TO MLOCDESO.                   36910051
321300     MOVE ASC-CS-PRINTER-ID        TO MPRTIDO.                    36920051
321400     MOVE ASC-PULL-NBR             TO MPULLNOO.                   36930051
321500     MOVE ASC-REF-NBR              TO MREFNOO.                    36940051
321600     MOVE ASC-PULL-SELECT-STATUS   TO MPULLSTO.                   36950051
321700     MOVE ASC-PULL-SELECT-TYPE     TO MSRCTYPO.                   36960051
321800     MOVE ASC-FROM-MM              TO MFROMMMO.                   36970051
321900     MOVE ASC-FROM-DD              TO MFROMDDO.                   36980051
322000     MOVE ASC-FROM-YY              TO MFROMYYO.                   36990051
322100     MOVE ASC-TO-MM                TO MTOMMO.                     37000051
322200     MOVE ASC-TO-DD                TO MTODDO.                     37010051
322300     MOVE ASC-TO-YY                TO MTOYYO.                     37020051
322400     MOVE ASC-SELECT-LIST-SEQUENCE TO MLSTSEQO.                   37030051
322500     MOVE ASC-DEPT-NBR-N           TO MDEPTNOO.                   37040051
322510     MOVE ASC-MAJ-CLASS            TO MMCLASSO.                   37050051
322520     MOVE ASC-SUB-CLASS            TO MSCLASSO.                   37060051
322600     MOVE ASC-DEPT-DESC            TO MDPTDESO.                   37070051
322700                                                                  37080051
322800     MOVE  SPACES                  TO MPULDESO.                   37090051
322900                                                                  37100051
323000     IF  ASC-PULL-CANCELLED                                       37110051
323100         STRING 'STATUS: '            DELIMITED BY SIZE           37120051
323200         PC-DESC-CANCELLED            DELIMITED BY SIZE           37130051
323300                                 INTO MPULDESO                    37140051
323400     ELSE                                                         37150051
323500     IF  ASC-PULL-DISTRIBUTED                                     37160051
323600         STRING 'STATUS: '            DELIMITED BY SIZE           37170051
323700         PC-DESC-DISTRIBUTED          DELIMITED BY SIZE           37180051
323800                                 INTO MPULDESO                    37190051
323900     ELSE                                                         37200051
324000     IF  ASC-PULL-IN-PROCESS                                      37210051
324100         STRING 'STATUS: '            DELIMITED BY SIZE           37220051
324200         PC-DESC-IN-PROCESS           DELIMITED BY SIZE           37230051
324300                                 INTO MPULDESO                    37240051
324400     ELSE                                                         37250051
324500     IF  ASC-PULL-NEW                                             37260051
324600         STRING 'STATUS: '            DELIMITED BY SIZE           37270051
324700         PC-DESC-NEW                  DELIMITED BY SIZE           37280051
324800                                 INTO MPULDESO                    37290051
324900     ELSE                                                         37300051
325000     IF  ASC-PULL-POSTED                                          37310051
325100         STRING 'STATUS: '            DELIMITED BY SIZE           37320051
325200         PC-DESC-POSTED               DELIMITED BY SIZE           37330051
325300                                 INTO MPULDESO                    37340051
325400     END-IF                                                       37350051
325500     END-IF                                                       37360051
325600     END-IF                                                       37370051
325700     END-IF                                                       37380051
325800     END-IF.                                                      37390051
325900                                                                  37400051
326000                                                                  37410051
326100*----------------------------------------------------------------*37420051
326200*    ABEND PROCESSOR MODULE                                      *37430051
326300*----------------------------------------------------------------*37440051
326400                                                                  37450051
326500     COPY DPPD013.                                                37460051
326600                                                                  37470051
