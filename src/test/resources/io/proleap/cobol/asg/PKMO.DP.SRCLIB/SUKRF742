000010 IDENTIFICATION DIVISION.                                         00001001
000020******************************************************************00002001
000030 PROGRAM-ID.             SUKRF742.                                00003001
000040 AUTHOR.                 R DELAURA.                               00004001
000050 INSTALLATION.           KOHLS.                                   00005001
000060 DATE-WRITTEN.           DEC 2008.                                00006001
000070 DATE-COMPILED.                                                   00007001
000080******************************************************************00008001
000090* THIS PROGRAM ALLOWS AN ASSOCIATE TO DO RELEASE DIRECTIVES ON A  00009001
000100* CARTON BY CARTON BASIS.                                         00010001
000110******************************************************************00011001
000597* 09/26/14    CHERI PARMLEY  CHG0094517     TKID: TKMAF76        *00011177
000598*             CHANGED PO# FROM 7 DIGITS TO 8 DIGITS              *00011276
000110******************************************************************00011376
000120 ENVIRONMENT DIVISION.                                            00012001
000130 DATA DIVISION.                                                   00013001
000140******************************************************************00014001
000150 WORKING-STORAGE SECTION.                                         00015001
000160******************************************************************00016001
000170 01  DK-DB2-KEYS.                                                 00017001
000180     05  DK-BRCDE-NBR            PIC  X(22)          VALUE SPACES.00018019
000190     05  DK-SML-BRCDE1         REDEFINES DK-BRCDE-NBR.            00019020
000200         10  DK-SML-BRCDE1-01-02 PIC  9(02).                      00020020
000210         10  DK-SML-BRCDE1-03-20 PIC  9(18).                      00021020
000220         10  DK-SML-BRCDE1-21-22 PIC  X(02).                      00022020
000230     05  DK-SML-BRCDE2         REDEFINES DK-BRCDE-NBR.            00023020
000240         10  DK-SML-BRCDE2-01-20 PIC  9(20).                      00024022
000250         10  DK-SML-BRCDE2-21-22 PIC  X(02).                      00025020
000260     05  DK-P2L-BRCDE1         REDEFINES DK-BRCDE-NBR.            00026020
000270         10  DK-P2L-BRCDE1-01-01 PIC  9(01).                      00027020
000280         10  DK-P2L-BRCDE1-02-22 PIC  9(21).                      00028020
000290     05  DK-P2L-BRCDE2         REDEFINES DK-BRCDE-NBR.            00029020
000300         10  DK-P2L-BRCDE2-01-22 PIC  9(22).                      00030020
000301     05  DK-PO-NBR               PIC S9(09) COMP     VALUE +0.    00030144
000303     05  DK-OPER-UNT-ID          PIC S9(4)  COMP     VALUE +0.    00030365
000304/                                                                 00030465
000305 01  WS-AUTO-CONVEYOR-PARAMETERS.                                 00030565
000306     05  WS-AUTOCY-DIRECTIVE-MODE      PIC X(01)     VALUE SPACES.00030665
000307         88  ALL-CARTONS-DIRECTIVES-MODE             VALUE 'A'.   00030765
000308         88  EXCEPTION-DIRECTIVES-MODE               VALUE 'E'.   00030865
000309         88  NO-DIRECTIVES-MODE                      VALUE 'N'.   00030965
000310/                                                                 00031065
000311 01  DN-DB2-NULL-INDICATORS.                                      00031169
000313     05  DN-CASI-CDE             PIC S9(04) COMP     VALUE +0.    00031369
000314     05  DN-AUD-FALR-RSN-NM      PIC S9(04) COMP     VALUE +0.    00031469
000315     05  DN-STR-ZN-ID            PIC S9(04) COMP     VALUE +0.    00031569
000316     05  DN-SEASET-YR            PIC S9(04) COMP     VALUE +0.    00031669
000317     05  DN-SEASET-SHRT-NM       PIC S9(04) COMP     VALUE +0.    00031769
000320/                                                                 00032069
000322 01  PC-PROGRAM-CONSTANTS.                                        00032201
000330     05  PC-TRANID               PIC X(04)           VALUE 'S742'.00033004
000340     05  PC-TRANID-HELP          PIC X(04)           VALUE 'Z278'.00034004
000350     05  PC-TRANID-MENU          PIC X(04)           VALUE 'S500'.00035004
000360     05  PC-PROG-NAME            PIC X(08)           VALUE        00036004
000370                                           'SUKRF742'.            00037004
000380     05  PC-PROG-NAME-HELP       PIC X(08)           VALUE        00038004
000390                                           'DPKRF278'.            00039004
000400     05  PC-PROG-NAME-MENU       PIC X(08)           VALUE        00040004
000410                                           'SUKRF500'.            00041004
000411     05  PC-PROG-NAME-DDG        PIC X(08)           VALUE        00041135
000412                                           'SUKUT129'.            00041235
000420     05  PC-MSG001               PIC X(19)           VALUE        00042008
000430                                           'ENTER BARCODE      '. 00043008
000440     05  PC-MSG002               PIC X(19)           VALUE        00044009
000450                                           'INVALID BARCODE    '. 00045009
000460     05  PC-MSG003               PIC X(19)           VALUE        00046020
000470                                           'BARCODE MUST BE > 0'. 00047020
000471     05  PC-MSG004               PIC X(19)           VALUE        00047129
000472                                           'NO DIRECTIVE FOUND '. 00047229
000473     05  PC-MSG005               PIC X(19)           VALUE        00047329
000474                                           'DIRCT ALREADY RLSD '. 00047429
000475     05  PC-MSG006               PIC X(19)           VALUE        00047560
000476                                           'RLF DIRCTVE ISSUED '. 00047660
000477     05  PC-MSG007               PIC X(19)           VALUE        00047765
000478                                           'DC SET-NO DIRCTVES '. 00047865
000479     05  PC-DG-ERROR-PARM        PIC X(19)           VALUE        00047971
000480                                           'PARM ERROR/SUKUT129'. 00048071
000481     05  PC-DG-ERROR-DB2         PIC X(19)           VALUE        00048171
000482                                           'DB2  ERROR/SUKUT129'. 00048271
000483     05  PC-DG-ERROR-MQ          PIC X(19)           VALUE        00048371
000484                                           'MQ   ERROR/SUKUT129'. 00048471
000485     05  PC-DG-ERROR-OTHR        PIC X(19)           VALUE        00048571
000486                                           'OTHR ERROR/SUKUT129'. 00048671
000487/                                                                 00048704
000490 01  PS-PROGRAM-SWITCHES.                                         00049009
000500     05  PS-EDIT-ERROR-SW        PIC X(01)           VALUE ' '.   00050009
000510         88 PS-EDIT-ERROR                            VALUE 'Y'.   00051009
000513     05  PS-DIRECTIVE-SW         PIC X(01)           VALUE ' '.   00051334
000514         88 PS-NO-DIRECTIVE-FOUND                    VALUE 'N'.   00051434
000515         88 PS-DIRECTIVE-RLSED                       VALUE 'R'.   00051534
000520/                                                                 00052009
000530 01  PV-PROGRAM-VARIABLES.                                        00053001
000540     05  PV-MESSAGE-AREA         PIC  X(19)          VALUE SPACES.00054005
000550     05  PV-CICS-RESPONSE        PIC S9(09) COMP SYNC VALUE +0.   00055008
000560     05  PV-CHAR-COUNT           PIC S9(04) COMP SYNC VALUE +0.   00056017
000570     05  PV-CTN                  PIC  X(22)          VALUE SPACES.00057019
000571     05  PV-LOC                  PIC  X(50)          VALUE SPACES.00057128
000580/                                                                 00058006
000671******************************************************************00067134
000672*    DIRECTIVE GENERATOR REQUEST COMMUNICATION AREA               00067234
000673******************************************************************00067334
000674     COPY SUWS090.                                                00067434
000675/                                                                 00067534
000680******************************************************************00068023
000690*  COPY BOOK FOR THE LOGIN INFO SUBROUTINE.                       00069023
000700******************************************************************00070023
000710     COPY DPWS026.                                                00071014
000720/                                                                 00072014
000780******************************************************************00078004
000790* SCREEN ERROR MESSAGES                                           00079004
000800******************************************************************00080004
000810     COPY PCWS034.                                                00081004
000820/                                                                 00082004
000830******************************************************************00083003
000840* HELP SCREEN WORK AREA                                           00084001
000850******************************************************************00085003
000860     COPY PCWS188.                                                00086001
000870/                                                                 00087003
000880******************************************************************00088003
000890* HELP SCREEN COMMAREA                                            00089001
000900******************************************************************00090003
000910     COPY PCWS192.                                                00091001
000920/                                                                 00092003
000930******************************************************************00093002
000940*  MAP LAYOUT                                                     00094002
000950******************************************************************00095002
000960     COPY SUKM742.                                                00096002
000970/                                                                 00097002
000980******************************************************************00098002
000990*  PROGRAM COMMAREA                                               00099002
001000******************************************************************00100002
001010 01  CA-COMMAREA.                                                 00101002
001020     COPY SUWS001.                                                00102002
001030     05  CA-PROGRAM-DATA.                                         00103006
001040         10  CA-MAP-ACARTN       PIC  X(22)          VALUE SPACES.00104007
      *CLP 09/26/2014                                                   00104176
001050         10  CA-MAP-ARCVR        PIC  X(12)          VALUE SPACES.00105076
001051         10  CA-MAP-ARCVR-N    REDEFINES CA-MAP-ARCVR.            00105162
001052             15  CA-MAP-PO       PIC  9(08).                      00105276
001053             15  CA-MAP-DASH     PIC  X(01).                      00105360
001054             15  CA-MAP-PO-LNE   PIC  9(03).                      00105461
001060         10  CA-MAP-ACDEST       PIC  X(05)          VALUE SPACES.00106007
001061         10  CA-MAP-ACDEST-N   REDEFINES CA-MAP-ACDEST            00106162
001070                                 PIC  9(05).                      00107060
001071         10  CA-MAP-ARLSE        PIC  X(20)          VALUE SPACES.00107162
001080         10  CA-MAP-AMSGLN       PIC  X(19)          VALUE SPACES.00108017
001090         10  CA-LOCATION-NBR     PIC S9(04) COMP     VALUE +0.    00109014
001100         10  CA-USERID           PIC  X(08)          VALUE SPACES.00110014
001110/                                                                 00111014
001120******************************************************************00112002
001130*  KOHL'S STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST   00113001
001140******************************************************************00114002
001150     COPY DPWS015.                                                00115001
001160/                                                                 00116002
001170******************************************************************00117002
001180*  KOHL'S STANDARD ATTENTION IDENTIFIER LIST                      00118001
001190******************************************************************00119002
001200     COPY DFHAID.                                                 00120001
001210/                                                                 00121002
001220******************************************************************00122002
001230*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA.               00123001
001240******************************************************************00124002
001250     COPY DPWS013.                                                00125001
001260/                                                                 00126002
001270******************************************************************00127011
001280*  SQL AND COBOL DECLARATIONS FOR SUT_CART_DIRV_TRKG              00128012
001290******************************************************************00129011
001300     EXEC SQL                                                     00130011
001310         INCLUDE SUT00102                                         00131011
001320     END-EXEC.                                                    00132011
001330/                                                                 00133011
001340******************************************************************00134012
001350*  SQL AND COBOL DECLARATIONS FOR WST_INTGRTN_TYP                 00135012
001360******************************************************************00136012
001370     EXEC SQL                                                     00137012
001380          INCLUDE WST00008                                        00138012
001390     END-EXEC.                                                    00139012
001400/                                                                 00140012
001410******************************************************************00141012
001420*  SQL AND COBOL DECLARATIONS FOR WST_ATTR_DEFN                   00142012
001430******************************************************************00143012
001440     EXEC SQL                                                     00144012
001450          INCLUDE WST00009                                        00145012
001460     END-EXEC.                                                    00146012
001470/                                                                 00147012
001480******************************************************************00148012
001490*  SQL AND COBOL DECLARATIONS FOR WST_ATTR_ELEM                   00149012
001500******************************************************************00150012
001510     EXEC SQL                                                     00151012
001520          INCLUDE WST00010                                        00152012
001530     END-EXEC.                                                    00153012
001540/                                                                 00154012
001541******************************************************************00154144
001542*  SQL AND COBOL DECLARATIONS FOR TPURCHS                         00154244
001543******************************************************************00154344
001544     EXEC SQL                                                     00154444
001545          INCLUDE TPURCHS                                         00154544
001546     END-EXEC.                                                    00154644
001547/                                                                 00154744
001549******************************************************************00154965
001550*  DB2 DECLARATION - PARAMETER TABLE                              00155065
001560*      TABLE (TKRPRPM)                                            00156065
001570******************************************************************00157065
001580     EXEC SQL                                                     00158065
001590         INCLUDE TKRPRPM                                          00159065
001600     END-EXEC.                                                    00160065
001900/                                                                 00190065
002090******************************************************************00209001
002100*  DB2 AREA FOR COMMUNICATIONS.                                   00210001
002110******************************************************************00211001
002120     EXEC SQL                                                     00212001
002130         INCLUDE SQLCA                                            00213001
002140     END-EXEC.                                                    00214001
002150/                                                                 00215002
002160 LINKAGE SECTION.                                                 00216001
002170                                                                  00217002
002180 01  DFHCOMMAREA.                                                 00218001
002190     05  FILLER                     OCCURS  1 TO 4072 TIMES       00219002
002200                                    DEPENDING ON EIBCALEN.        00220002
002210         10  FILLER                   PIC X(01).                  00221002
002220/                                                                 00222001
002230 PROCEDURE DIVISION.                                              00223001
002240                                                                  00224005
002250******************************************************************00225001
002260* 0000-PROGRAM-MAINLINE                                          *00226005
002270******************************************************************00227005
002280 0000-PROGRAM-MAINLINE.                                           00228001
002290                                                                  00229001
002300     EVALUATE TRUE                                                00230010
002310*****************************************                         00231009
002320*  DIRECT ENTRY USING S742 NOT ALLOWED  *                         00232009
002330*****************************************                         00233009
002340         WHEN EIBCALEN = ZERO                                     00234008
002350             MOVE PC034-ENTER-THROUGH-MENU-MSG TO PV-MESSAGE-AREA 00235010
002360             PERFORM 8110-RETURN                                  00236008
002370*****************************************                         00237009
002380*  INITIAL ENTRY FROM MENU              *                         00238009
002390*****************************************                         00239009
002400         WHEN EIBTRNID = PC-TRANID-MENU                           00240010
002410             INITIALIZE          CA-COMMAREA                      00241008
002420             MOVE DFHCOMMAREA TO CA-COMMAREA                      00242008
002430             PERFORM 1000-GET-LOGON-INFO                          00243015
002440             MOVE PC-MSG001   TO AMSGLNO                          00244013
002450             PERFORM 8000-SEND-MAP-ERASE                          00245008
002460             PERFORM 8100-RETURN-TRANID                           00246008
002470*****************************************                         00247009
002480*  CONTINUE PROCESSING                  *                         00248009
002490*****************************************                         00249009
002500         WHEN EIBTRNID = PC-TRANID                                00250010
002501             MOVE DFHCOMMAREA TO CA-COMMAREA                      00250153
002510             PERFORM 8020-RECEIVE-MAP                             00251009
002520*****************************************                         00252009
002530*  BACK FROM THE HELP SCREEN            *                         00253009
002540*****************************************                         00254009
002550         WHEN EIBTRNID = PC-TRANID-HELP                           00255010
002560             MOVE DFHCOMMAREA          TO PC192-COMMAREA          00256009
002570             MOVE PC192-HOST-SAVE-AREA TO CA-COMMAREA             00257009
002580             MOVE CA-MAP-ACARTN        TO ACARTNO                 00258009
002590             MOVE CA-MAP-ARCVR         TO ARCVRO                  00259010
002600             MOVE CA-MAP-ACDEST        TO ACDESTO                 00260010
002610             MOVE CA-MAP-ARLSE         TO ARLSEO                  00261010
002620             MOVE CA-MAP-AMSGLN        TO AMSGLNO                 00262017
002630             PERFORM 8000-SEND-MAP-ERASE                          00263017
002640             PERFORM 8100-RETURN-TRANID                           00264009
002650*****************************************                         00265009
002660*  INVALID PROGRAM ENTRY                *                         00266009
002670*****************************************                         00267009
002680         WHEN OTHER                                               00268009
002690             MOVE PC034-ENTER-THROUGH-MENU-MSG TO PV-MESSAGE-AREA 00269010
002700             PERFORM 8110-RETURN                                  00270009
002710     END-EVALUATE.                                                00271010
002720                                                                  00272009
002730     EVALUATE TRUE                                                00273001
002740*****************************************                         00274009
002750*  TRANSFER TO HELP SCREEN              *                         00275009
002760*****************************************                         00276009
002770         WHEN EIBAID = DFHPF1                                     00277009
002780             PERFORM 1200-HELP-SCREEN                             00278009
002790             PERFORM 8220-XCTL-TO-HELP                            00279009
002800*****************************************                         00280009
002810*  RESET SCREEN                         *                         00281009
002820*****************************************                         00282009
002830         WHEN EIBAID = DFHCLEAR                                   00283001
002840             MOVE SPACES    TO ACARTNO                            00284009
002850                               ARCVRO                             00285009
002860                               ACDESTO                            00286009
002870                               ARLSEO                             00287009
002880                               CA-MAP-ACARTN                      00288009
002890                               CA-MAP-ARCVR                       00289009
002900                               CA-MAP-ACDEST                      00290010
002910                               CA-MAP-ARLSE                       00291010
002920                               CA-MAP-AMSGLN                      00292017
002930             MOVE PC-MSG001 TO AMSGLNO                            00293013
002940             PERFORM 8000-SEND-MAP-ERASE                          00294065
002950             PERFORM 8100-RETURN-TRANID                           00295066
002960*****************************************                         00296009
002970*  TRANSFER BACK TO MENU                *                         00297009
002980*****************************************                         00298009
002990         WHEN EIBAID = DFHPF3                                     00299001
003000             SET SU001-INITIALIZE-SCREEN TO TRUE                  00300017
003010             MOVE PC-PROG-NAME           TO SU001-LAST-PROGRAM    00301017
003020             MOVE PC-TRANID              TO SU001-TRAN-ID         00302017
003030             PERFORM 8200-XCTL-TO-MENU                            00303009
003040*****************************************                         00304009
003050*  PROCESS SCREEN INPUT                 *                         00305009
003060*****************************************                         00306009
003070         WHEN EIBAID = DFHENTER                                   00307001
003071             PERFORM 1010-SEL-AUTO-DIRECTIVE                      00307165
003074             IF ( NO-DIRECTIVES-MODE )                            00307465
003075                 MOVE PC-MSG007 TO AMSGLNO                        00307565
003076             ELSE                                                 00307665
003081                 PERFORM 2000-PROCESS-SCREEN-FIELDS               00308165
003090                 IF ( PS-EDIT-ERROR )                             00309065
003100                     CONTINUE                                     00310065
003120                 ELSE                                             00312065
003121                     INITIALIZE DCLSUT00102                       00312165
003130                     PERFORM 3000-CHECK-CARTON-AREA               00313065
003132                     IF ( PS-NO-DIRECTIVE-FOUND ) OR              00313265
003133                        ( PS-DIRECTIVE-RLSED )                    00313365
003134                         CONTINUE                                 00313465
003135                     ELSE                                         00313565
003136                          PERFORM 4000-FORMAT-RLSE-DIRECTIVE      00313665
003137                     END-IF                                       00313765
003138                 END-IF                                           00313865
003139             END-IF                                               00313965
003140*****************************************                         00314009
003150*  INVALID KEY                          *                         00315009
003160*****************************************                         00316009
003170         WHEN OTHER                                               00317001
003180             MOVE PC034-UNRECOGNIZED-PF-KEY-MSG TO AMSGLNO        00318009
003210     END-EVALUATE.                                                00321001
003220                                                                  00322001
003230     PERFORM 8010-SEND-MAP-DATA-ONLY.                             00323019
003240     PERFORM 8100-RETURN-TRANID.                                  00324019
003250                                                                  00325019
003260     GOBACK.                                                      00326001
003270/                                                                 00327005
003280******************************************************************00328014
003290* 1000-GET-LOGON-INFO                                            *00329014
003300******************************************************************00330014
003310 1000-GET-LOGON-INFO.                                             00331014
003320                                                                  00332014
003330     MOVE EIBTRMID  TO  DP026-QUEUE-TERM.                         00333014
003340     MOVE +1        TO  DP026-TS-ITEM.                            00334014
003350                                                                  00335014
003360     EXEC CICS INQUIRE                                            00336014
003370               TRANSACTION  (DP026-LOGON-ROUTINE)                 00337014
003380               REMOTESYSTEM (DP026-SYSID)                         00338014
003390     END-EXEC.                                                    00339014
003400                                                                  00340014
003410     IF ( DP026-SYSID = SPACES )                                  00341014
003420         EXEC CICS READQ TS                                       00342014
003430                   QUEUE  (DP026-QUEUE-NAME)                      00343014
003440                   ITEM   (DP026-TS-ITEM)                         00344014
003450                   INTO   (DP026-SIGN-ON-INFO)                    00345014
003460                   RESP   (DP026-CICS-RESPONSE)                   00346014
003470         END-EXEC                                                 00347014
003480     ELSE                                                         00348014
003490         EXEC CICS READQ TS                                       00349014
003500                   QUEUE  (DP026-QUEUE-NAME)                      00350014
003510                   SYSID  (DP026-SYSID)                           00351014
003520                   ITEM   (DP026-TS-ITEM)                         00352014
003530                   INTO   (DP026-SIGN-ON-INFO)                    00353014
003540                   RESP   (DP026-CICS-RESPONSE)                   00354014
003550         END-EXEC                                                 00355014
003560     END-IF.                                                      00356014
003570                                                                  00357014
003580     EVALUATE TRUE                                                00358014
003590         WHEN DP026-CICS-RESPONSE = DFHRESP (NORMAL)              00359014
003600             MOVE DP026-LOCATION-NBR TO CA-LOCATION-NBR           00360014
003601                                        DK-OPER-UNT-ID            00360165
003610             MOVE DP026-USERID       TO CA-USERID                 00361016
003620             CONTINUE                                             00362014
003630         WHEN OTHER                                               00363014
003640             MOVE PC-PROG-NAME          TO DP013-PROGRAM          00364014
003650             MOVE '1000-GET-LOGON-INFO' TO DP013-PARAGRAPH        00365014
003660             STRING PC-PROG-NAME                                  00366014
003670                    ' - UNABLE TO READ LOGON TSQ'                 00367014
003680                 DELIMITED BY SIZE    INTO DP013-MESSAGE-TEXT (1) 00368014
003690             SET DP013-CICS-ABEND                                 00369014
003700                 DP013-ROLLBACK         TO TRUE                   00370014
003710             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               00371014
003720             MOVE PC034-CICS-FATAL-ERROR-MSG TO AMSGLNO           00372014
003730             MOVE SPACES                     TO ACARTNO           00373014
003740                                                ARCVRO            00374014
003750                                                ACDESTO           00375014
003760                                                ARLSEO            00376014
003770             PERFORM 8010-SEND-MAP-DATA-ONLY                      00377014
003780             PERFORM 8100-RETURN-TRANID                           00378014
003790     END-EVALUATE.                                                00379014
003800/                                                                 00380014
003801******************************************************************00380165
003802* 1010-SEL-AUTO-DIRECTIVE                                        *00380265
003803*     DETERMINE AUTO CONVEYER MODE                               *00380365
003804*     'N' = NO DIRECTIVES                                        *00380465
003805*     'E' = ISSUED FOR EXCEPTIONS                                *00380565
003806*     'A' = ISSUED FOR ALL CARTONS                               *00380665
003807******************************************************************00380765
003808 1010-SEL-AUTO-DIRECTIVE.                                         00380865
003809                                                                  00380965
003810     MOVE CA-LOCATION-NBR TO DK-OPER-UNT-ID.                      00381067
003811                                                                  00381167
003812     EXEC SQL                                                     00381265
003813         SELECT FUNC_TXT                                          00381365
003814           INTO :WS-AUTOCY-DIRECTIVE-MODE                         00381465
003815           FROM TKRPRPM                                           00381565
003816          WHERE INTFC_SYS_CDE        = 'KHL'                      00381665
003817            AND SYS_PRC_FUNC_CDE     = 'ACAUDT'                   00381765
003818            AND FUNC_PRC_STAT_CDE    = 'AC'                       00381865
003819            AND FUNC_BEG_TMST       <=  CURRENT TIMESTAMP         00381965
003820            AND FUNC_END_TMST       >=  CURRENT TIMESTAMP         00382065
003821            AND LOC_ID               =  :DK-OPER-UNT-ID           00382165
003822     END-EXEC                                                     00382265
003823                                                                  00382365
003824     EVALUATE TRUE                                                00382465
003825       WHEN SQLCODE     = ZERO                                    00382565
003826           CONTINUE                                               00382665
003827       WHEN SQLCODE NOT = ZERO                                    00382765
003828             MOVE PC-PROG-NAME              TO DP013-PROGRAM      00382865
003829             MOVE '1010-SEL-AUTO-DIRECTIVE' TO DP013-PARAGRAPH    00382965
003830             STRING PC-PROG-NAME                                  00383065
003831                    ' - UNABLE TO SELECT '                        00383165
003832                 DELIMITED BY SIZE    INTO DP013-MESSAGE-TEXT (1) 00383265
003833             MOVE SQLCA              TO DP013-SQLCA               00383365
003834             MOVE 'TKRPRPM'          TO DP013-DB2-TABLE-NAME (1)  00383465
003835             SET DP013-CICS-ABEND                                 00383565
003836                 DP013-ROLLBACK      TO TRUE                      00383665
003837             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               00383765
003838             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLNO            00383865
003839             MOVE SPACES                    TO ACARTNO            00383965
003840                                               ARCVRO             00384065
003841                                               ACDESTO            00384165
003842                                               ARLSEO             00384265
003843             PERFORM 8010-SEND-MAP-DATA-ONLY                      00384365
003844             PERFORM 8100-RETURN-TRANID                           00384465
003845     END-EVALUATE.                                                00384565
003846******************************************************************00384607
003847* 1200-HELP-SCREEN                                               *00384707
003848******************************************************************00384807
003849 1200-HELP-SCREEN.                                                00384901
003850                                                                  00385007
003860     MOVE PC-PROG-NAME                TO PC192-PROGRAM-NAME.      00386010
003870     COPY PCPD188.                                                00387001
003880     MOVE PC188-DISPLAY-DATE          TO PC192-DISPLAY-DATE.      00388001
003890     MOVE CA-COMMAREA                 TO PC192-HOST-SAVE-AREA.    00389010
003900/                                                                 00390005
003910******************************************************************00391009
003920* 2000-PROCESS-SCREEN-FIELDS                                     *00392009
003930******************************************************************00393009
003940 2000-PROCESS-SCREEN-FIELDS.                                      00394001
003950                                                                  00395001
003960     INSPECT ACARTNI REPLACING ALL LOW-VALUES BY SPACES.          00396019
003970     MOVE ACARTNI TO PV-CTN.                                      00397019
003980     MOVE +0      TO PV-CHAR-COUNT.                               00398019
003990     INSPECT PV-CTN TALLYING PV-CHAR-COUNT FOR CHARACTERS         00399019
004000            BEFORE INITIAL SPACE.                                 00400019
004010                                                                  00401019
004020     EVALUATE TRUE                                                00402019
004030         WHEN PV-CHAR-COUNT = +0                                  00403019
004040             MOVE 'Y'                    TO PS-EDIT-ERROR-SW      00404019
004050             MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNA               00405019
004060             MOVE PC-MSG001              TO AMSGLNO               00406019
004070         WHEN PV-CHAR-COUNT = +18                                 00407021
004080             IF ( PV-CTN(01:18) NUMERIC ) AND                     00408020
004090                ( PV-CTN(01:18) > ZEROS )                         00409020
004100                 MOVE 0             TO DK-SML-BRCDE1-01-02        00410020
004110                 MOVE PV-CTN(01:18) TO DK-SML-BRCDE1-03-20        00411020
004120                 MOVE SPACES        TO DK-SML-BRCDE1-21-22        00412020
004130             ELSE                                                 00413020
004140                 IF ( PV-CTN(01:18) = ZEROS )                     00414020
004150                     MOVE 'Y'                                     00415020
004160                                         TO PS-EDIT-ERROR-SW      00416020
004170                     MOVE DP015-UNP-ALP-BRT-MDT                   00417021
004180                                         TO ACARTNA               00418020
004190                     MOVE PC-MSG003      TO AMSGLNO               00419020
004200                 ELSE                                             00420020
004210                     MOVE 'Y'                                     00421020
004220                                         TO PS-EDIT-ERROR-SW      00422020
004230                     MOVE DP015-UNP-ALP-BRT-MDT                   00423021
004240                                         TO ACARTNA               00424020
004250                     MOVE PC-MSG002      TO AMSGLNO               00425020
004260                 END-IF                                           00426020
004270             END-IF                                               00427020
004280         WHEN PV-CHAR-COUNT = +20                                 00428022
004290             IF ( PV-CTN(01:20) NUMERIC ) AND                     00429022
004300                ( PV-CTN(01:20) > ZEROS )                         00430022
004310                 MOVE PV-CTN(01:20) TO DK-SML-BRCDE2-01-20        00431022
004320                 MOVE SPACES        TO DK-SML-BRCDE1-21-22        00432022
004330             ELSE                                                 00433022
004340                 IF ( PV-CTN(01:20) = ZEROS )                     00434022
004350                     MOVE 'Y'                                     00435022
004360                                         TO PS-EDIT-ERROR-SW      00436022
004370                     MOVE DP015-UNP-ALP-BRT-MDT                   00437022
004380                                         TO ACARTNA               00438022
004390                     MOVE PC-MSG003      TO AMSGLNO               00439022
004400                 ELSE                                             00440022
004410                     MOVE 'Y'                                     00441022
004420                                         TO PS-EDIT-ERROR-SW      00442022
004430                     MOVE DP015-UNP-ALP-BRT-MDT                   00443022
004440                                         TO ACARTNA               00444022
004450                     MOVE PC-MSG002      TO AMSGLNO               00445022
004460                 END-IF                                           00446022
004470             END-IF                                               00447022
004480         WHEN PV-CHAR-COUNT = +21                                 00448022
004490             IF ( PV-CTN(01:21) NUMERIC ) AND                     00449022
004500                ( PV-CTN(01:21) > ZEROS )                         00450022
004510                 MOVE 0             TO DK-P2L-BRCDE1-01-01        00451022
004520                 MOVE PV-CTN(01:21) TO DK-P2L-BRCDE1-02-22        00452022
004530             ELSE                                                 00453022
004540                 IF ( PV-CTN(01:21) = ZEROS )                     00454022
004550                     MOVE 'Y'                                     00455022
004560                                         TO PS-EDIT-ERROR-SW      00456022
004570                     MOVE DP015-UNP-ALP-BRT-MDT                   00457022
004580                                         TO ACARTNA               00458022
004590                     MOVE PC-MSG003      TO AMSGLNO               00459022
004600                 ELSE                                             00460022
004610                     MOVE 'Y'                                     00461022
004620                                         TO PS-EDIT-ERROR-SW      00462022
004630                     MOVE DP015-UNP-ALP-BRT-MDT                   00463022
004640                                         TO ACARTNA               00464022
004650                     MOVE PC-MSG002      TO AMSGLNO               00465022
004660                 END-IF                                           00466022
004670             END-IF                                               00467022
004680         WHEN PV-CHAR-COUNT = +22                                 00468022
004690             IF ( PV-CTN NUMERIC ) AND                            00469022
004700                ( PV-CTN > ZEROS )                                00470022
004710                 MOVE PV-CTN TO DK-P2L-BRCDE2-01-22               00471022
004720             ELSE                                                 00472022
004730                 IF ( PV-CTN = ZEROS )                            00473022
004740                     MOVE 'Y'                                     00474022
004750                                         TO PS-EDIT-ERROR-SW      00475022
004760                     MOVE DP015-UNP-ALP-BRT-MDT                   00476022
004770                                         TO ACARTNA               00477022
004780                     MOVE PC-MSG003      TO AMSGLNO               00478022
004790                 ELSE                                             00479022
004800                     MOVE 'Y'                                     00480022
004810                                         TO PS-EDIT-ERROR-SW      00481022
004820                     MOVE DP015-UNP-ALP-BRT-MDT                   00482022
004830                                         TO ACARTNA               00483022
004840                     MOVE PC-MSG002      TO AMSGLNO               00484022
004850                 END-IF                                           00485022
004860             END-IF                                               00486022
004870         WHEN OTHER                                               00487020
004880             MOVE 'Y'                    TO PS-EDIT-ERROR-SW      00488020
004890             MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNA               00489020
004900             MOVE PC-MSG002              TO AMSGLNO               00490020
004910     END-EVALUATE.                                                00491020
004920/                                                                 00492009
004930******************************************************************00493023
004940* 3000-CHECK-CARTON-AREA                                         *00494049
004950*     CHECK TO SEE IF THE CARTON IS IN AN AREA THAT IS ABLE TO   *00495049
004951*     BE RELEASED.                                               *00495149
004960******************************************************************00496023
004970 3000-CHECK-CARTON-AREA.                                          00497049
004980                                                                  00498023
004990     EXEC SQL                                                     00499049
005000         SELECT                                                   00500049
005001               BRCDE_NBR                                          00500149
005002              ,CRE_TMST                                           00500249
005003              ,OPER_UNT_ID                                        00500349
005004              ,DIRV_RSN_CDE                                       00500449
005005              ,LGCL_LOC_NM                                        00500549
005006              ,AUD_CNTL_NBR                                       00500649
005007              ,SHIPT_UNT_ID                                       00500749
005008              ,AUD_STAT_CDE                                       00500849
005009              ,PO_NBR                                             00500949
005010              ,RCVR_SEQ_NBR                                       00501049
005011              ,PO_LNE_NBR                                         00501149
005012              ,PREPK_ID                                           00501249
005013              ,STR_NBR                                            00501349
005014              ,CRE_PGM_NM                                         00501449
005015              ,ACKNL_SEQ_NBR                                      00501549
005016              ,CASI_CDE                                           00501649
005017              ,CART_STAT_CDE                                      00501749
005018              ,AUD_FALR_RSN_NM                                    00501849
005019              ,STR_ZN_ID                                          00501949
005020              ,SEASET_YR                                          00502049
005021              ,SEASET_SHRT_NM                                     00502149
005022              ,CNVYR_PRC_ACTN_NM                                  00502249
005023              ,CRE_BY_USR_ID                                      00502349
005024         INTO  :SUT00102-BRCDE-NBR                                00502449
005025              ,:SUT00102-CRE-TMST                                 00502549
005026              ,:SUT00102-OPER-UNT-ID                              00502649
005027              ,:SUT00102-DIRV-RSN-CDE                             00502749
005028              ,:SUT00102-LGCL-LOC-NM                              00502849
005029              ,:SUT00102-AUD-CNTL-NBR                             00502949
005030              ,:SUT00102-SHIPT-UNT-ID                             00503049
005031              ,:SUT00102-AUD-STAT-CDE                             00503149
005032              ,:SUT00102-PO-NBR                                   00503249
005033              ,:SUT00102-RCVR-SEQ-NBR                             00503349
005034              ,:SUT00102-PO-LNE-NBR                               00503449
005035              ,:SUT00102-PREPK-ID                                 00503549
005036              ,:SUT00102-STR-NBR                                  00503649
005037              ,:SUT00102-CRE-PGM-NM                               00503749
005038              ,:SUT00102-ACKNL-SEQ-NBR                            00503849
005039              ,:SUT00102-CASI-CDE        :DN-CASI-CDE             00503969
005040              ,:SUT00102-CART-STAT-CDE                            00504069
005041              ,:SUT00102-AUD-FALR-RSN-NM :DN-AUD-FALR-RSN-NM      00504169
005042              ,:SUT00102-STR-ZN-ID       :DN-STR-ZN-ID            00504269
005043              ,:SUT00102-SEASET-YR       :DN-SEASET-YR            00504369
005044              ,:SUT00102-SEASET-SHRT-NM  :DN-SEASET-SHRT-NM       00504469
005045              ,:SUT00102-CNVYR-PRC-ACTN-NM                        00504549
005046              ,:SUT00102-CRE-BY-USR-ID                            00504649
005047           FROM  SUT_CART_DIRV_TRKG  A                            00504749
005048          WHERE  A.BRCDE_NBR      = :DK-BRCDE-NBR                 00504849
005049            AND  A.DIRV_RSN_CDE   <>    'AUQ'                     00504973
005051            AND  A.CRE_TMST       =                               00505173
005052                 ( SELECT MAX (CRE_TMST)                          00505273
005053                   FROM SUT_CART_DIRV_TRKG B                      00505374
005060                   WHERE B.BRCDE_NBR  =  A.BRCDE_NBR              00506049
005070                   )                                              00507049
005080            AND  A.LGCL_LOC_NM  IN                                00508049
005081               (                                                  00508149
005082                SELECT DISTINCT(E.ATTR_ELEM_TXT)                  00508249
005083                  FROM WST_INTGRTN_TYP A                          00508349
005084                     , WST_ATTR_DEFN   B                          00508449
005085                     , WST_ATTR_ELEM   C                          00508549
005086                     , WST_ATTR_ELEM   D                          00508649
005087                     , WST_ATTR_ELEM   E                          00508749
005088                     , WST_ATTR_ELEM   F                          00508849
005089                     , WST_ATTR_ELEM   G                          00508949
005090                     , WST_ATTR_ELEM   H                          00509049
005091                     , WST_ATTR_ELEM   I                          00509149
005092                     , WST_ATTR_ELEM   J                          00509249
005093                     , WST_ATTR_ELEM   K                          00509349
005094                 WHERE A.INTGRTN_TYP_CDE    =  'ACAULGDST'        00509449
005095                   AND A.INTGRTN_TYP_CDE    =  B.INTGRTN_TYP_CDE  00509549
005096                   AND A.INTGRTN_TYP_CDE    =  C.INTGRTN_TYP_CDE  00509649
005097                   AND A.INTGRTN_TYP_CDE    =  D.INTGRTN_TYP_CDE  00509749
005098                   AND A.INTGRTN_TYP_CDE    =  E.INTGRTN_TYP_CDE  00509849
005099                   AND A.INTGRTN_TYP_CDE    =  F.INTGRTN_TYP_CDE  00509949
005100                   AND A.INTGRTN_TYP_CDE    =  G.INTGRTN_TYP_CDE  00510049
005110                   AND A.INTGRTN_TYP_CDE    =  H.INTGRTN_TYP_CDE  00511049
005120                   AND A.INTGRTN_TYP_CDE    =  I.INTGRTN_TYP_CDE  00512049
005130                   AND A.INTGRTN_TYP_CDE    =  J.INTGRTN_TYP_CDE  00513049
005140                   AND A.INTGRTN_TYP_CDE    =  K.INTGRTN_TYP_CDE  00514049
005150                   AND B.ATTR_DEFN_SEQ_NBR  =  1                  00515049
005160                   AND C.ATTR_DEFN_SEQ_NBR  =  1                  00516049
005170                   AND D.ATTR_DEFN_SEQ_NBR  =  2                  00517049
005180                   AND E.ATTR_DEFN_SEQ_NBR  =  3                  00518049
005190                   AND F.ATTR_DEFN_SEQ_NBR  =  4                  00519049
005191                   AND G.ATTR_DEFN_SEQ_NBR  =  5                  00519149
005192                   AND H.ATTR_DEFN_SEQ_NBR  =  6                  00519249
005193                   AND I.ATTR_DEFN_SEQ_NBR  =  7                  00519349
005194                   AND J.ATTR_DEFN_SEQ_NBR  =  8                  00519449
005195                   AND K.ATTR_DEFN_SEQ_NBR  =  9                  00519549
005196                   AND C.ATTR_ELEM_SEQ_NBR  =  D.ATTR_ELEM_SEQ_NBR00519649
005197                   AND C.ATTR_ELEM_SEQ_NBR  =  E.ATTR_ELEM_SEQ_NBR00519749
005198                   AND C.ATTR_ELEM_SEQ_NBR  =  F.ATTR_ELEM_SEQ_NBR00519849
005199                   AND C.ATTR_ELEM_SEQ_NBR  =  G.ATTR_ELEM_SEQ_NBR00519949
005200                   AND C.ATTR_ELEM_SEQ_NBR  =  H.ATTR_ELEM_SEQ_NBR00520049
005210                   AND C.ATTR_ELEM_SEQ_NBR  =  I.ATTR_ELEM_SEQ_NBR00521049
005220                   AND C.ATTR_ELEM_SEQ_NBR  =  J.ATTR_ELEM_SEQ_NBR00522049
005230                   AND C.ATTR_ELEM_SEQ_NBR  =  K.ATTR_ELEM_SEQ_NBR00523049
005240                   AND F.ATTR_ELEM_TXT      =  'Y'                00524049
005250                   AND G.ATTR_ELEM_TMST    <=  CURRENT TIMESTAMP  00525049
005260                   AND H.ATTR_ELEM_TMST    >=  CURRENT TIMESTAMP  00526049
005270                   AND C.ATTR_ELEM_NBR      =  :CA-LOCATION-NBR   00527049
005280                   AND K.ATTR_ELEM_TXT      =  'Y'                00528049
005290               )                                                  00529049
005291     END-EXEC.                                                    00529149
005292                                                                  00529249
005293     EVALUATE TRUE                                                00529349
005294       WHEN SQLCODE = ZEROS                                       00529449
005295           PERFORM 3005-GET-ENT-ID                                00529549
005297       WHEN SQLCODE = +100                                        00529749
005298           PERFORM 3010-CHECK-ALREADY-RLSED                       00529849
005301       WHEN OTHER                                                 00530149
005302             MOVE PC-PROG-NAME             TO DP013-PROGRAM       00530249
005303             MOVE '3000-CHECK-CARTON-AREA' TO DP013-PARAGRAPH     00530349
005304             STRING PC-PROG-NAME                                  00530449
005305                    ' - UNABLE TO SELECT '                        00530549
005306                 DELIMITED BY SIZE    INTO DP013-MESSAGE-TEXT (1) 00530649
005307             MOVE SQLCA              TO DP013-SQLCA               00530749
005308             MOVE 'SUT_CART_DIRV_TRKG' TO DP013-DB2-TABLE-NAME (1)00530849
005309             SET DP013-CICS-ABEND                                 00530949
005310                 DP013-ROLLBACK      TO TRUE                      00531049
005311             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               00531149
005312             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLNO            00531249
005313             MOVE SPACES                    TO ACARTNO            00531349
005314                                               ARCVRO             00531449
005315                                               ACDESTO            00531549
005316                                               ARLSEO             00531649
005317             PERFORM 8010-SEND-MAP-DATA-ONLY                      00531749
005318             PERFORM 8100-RETURN-TRANID                           00531849
005319     END-EVALUATE.                                                00531949
005320/                                                                 00532023
005321******************************************************************00532149
005322* 3005-GET-ENT-ID                                                *00532249
005323******************************************************************00532349
005324 3005-GET-ENT-ID.                                                 00532449
005325                                                                  00532549
005326     MOVE SUT00102-PO-NBR TO DK-PO-NBR.                           00532649
005327                                                                  00532749
005328     EXEC SQL                                                     00532849
005329         SELECT ENT_ID                                            00532949
005330         INTO  :PURCHS-ENT-ID                                     00533049
005331         FROM   TPURCHS    PO1                                    00533149
005332         WHERE  PO1.PO_NBR = :DK-PO-NBR                           00533249
005333           AND  PO1.VER_NBR =                                     00533349
005334                     (                                            00533449
005335                      SELECT MAX(VER_NBR)                         00533549
005336                      FROM   TPURCHS   PO2                        00533649
005337                      WHERE  PO2.PO_NBR  =  PO1.PO_NBR            00533749
005338                     )                                            00533849
005339     END-EXEC.                                                    00533949
005340                                                                  00534049
005341     EVALUATE TRUE                                                00534149
005342       WHEN SQLCODE = ZEROS                                       00534249
005343           CONTINUE                                               00534349
005344       WHEN SQLCODE = +100                                        00534449
005345           MOVE +0 TO PURCHS-ENT-ID                               00534549
005346       WHEN OTHER                                                 00534649
005347             MOVE PC-PROG-NAME      TO DP013-PROGRAM              00534749
005348             MOVE '3005-GET-ENT-ID' TO DP013-PARAGRAPH            00534849
005349             STRING PC-PROG-NAME                                  00534949
005350                    ' - UNABLE TO SELECT '                        00535049
005351                 DELIMITED BY SIZE    INTO DP013-MESSAGE-TEXT (1) 00535149
005352             MOVE SQLCA              TO DP013-SQLCA               00535249
005353             MOVE 'TPURCHS'          TO DP013-DB2-TABLE-NAME (1)  00535349
005354             SET DP013-CICS-ABEND                                 00535449
005355                 DP013-ROLLBACK      TO TRUE                      00535549
005356             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               00535649
005357             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLNO            00535749
005358             MOVE SPACES                    TO ACARTNO            00535849
005359                                               ARCVRO             00535949
005360                                               ACDESTO            00536049
005361                                               ARLSEO             00536149
005362             PERFORM 8010-SEND-MAP-DATA-ONLY                      00536249
005363             PERFORM 8100-RETURN-TRANID                           00536349
005364     END-EVALUATE.                                                00536449
005365/                                                                 00536549
005366******************************************************************00536649
005367*  3010-CHECK-ALREADY-RLSED                                      *00536749
005368*     HAS THE CARTON ALREADY BEEN RELEASED.                      *00536849
005369******************************************************************00536949
005370 3010-CHECK-ALREADY-RLSED.                                        00537049
005371                                                                  00537149
005372     EXEC SQL                                                     00537249
005373         SELECT                                                   00537351
005374               BRCDE_NBR                                          00537451
005375              ,CRE_TMST                                           00537551
005376              ,OPER_UNT_ID                                        00537651
005377              ,DIRV_RSN_CDE                                       00537751
005378              ,LGCL_LOC_NM                                        00537851
005379              ,AUD_CNTL_NBR                                       00537951
005380              ,SHIPT_UNT_ID                                       00538051
005381              ,AUD_STAT_CDE                                       00538151
005382              ,PO_NBR                                             00538251
005383              ,RCVR_SEQ_NBR                                       00538351
005384              ,PO_LNE_NBR                                         00538451
005385              ,PREPK_ID                                           00538551
005386              ,STR_NBR                                            00538651
005387              ,CRE_PGM_NM                                         00538751
005388              ,ACKNL_SEQ_NBR                                      00538851
005389              ,CASI_CDE                                           00538951
005390              ,CART_STAT_CDE                                      00539051
005391              ,AUD_FALR_RSN_NM                                    00539151
005392              ,STR_ZN_ID                                          00539251
005393              ,SEASET_YR                                          00539351
005394              ,SEASET_SHRT_NM                                     00539451
005395              ,CNVYR_PRC_ACTN_NM                                  00539551
005396              ,CRE_BY_USR_ID                                      00539651
005397         INTO  :SUT00102-BRCDE-NBR                                00539751
005398              ,:SUT00102-CRE-TMST                                 00539851
005399              ,:SUT00102-OPER-UNT-ID                              00539951
005400              ,:SUT00102-DIRV-RSN-CDE                             00540051
005401              ,:SUT00102-LGCL-LOC-NM                              00540151
005402              ,:SUT00102-AUD-CNTL-NBR                             00540251
005403              ,:SUT00102-SHIPT-UNT-ID                             00540351
005404              ,:SUT00102-AUD-STAT-CDE                             00540451
005405              ,:SUT00102-PO-NBR                                   00540551
005406              ,:SUT00102-RCVR-SEQ-NBR                             00540651
005407              ,:SUT00102-PO-LNE-NBR                               00540751
005408              ,:SUT00102-PREPK-ID                                 00540851
005409              ,:SUT00102-STR-NBR                                  00540951
005410              ,:SUT00102-CRE-PGM-NM                               00541051
005411              ,:SUT00102-ACKNL-SEQ-NBR                            00541151
005412              ,:SUT00102-CASI-CDE         :DN-CASI-CDE            00541269
005413              ,:SUT00102-CART-STAT-CDE                            00541351
005414              ,:SUT00102-AUD-FALR-RSN-NM  :DN-AUD-FALR-RSN-NM     00541469
005415              ,:SUT00102-STR-ZN-ID        :DN-STR-ZN-ID           00541569
005416              ,:SUT00102-SEASET-YR        :DN-SEASET-YR           00541669
005417              ,:SUT00102-SEASET-SHRT-NM   :DN-SEASET-SHRT-NM      00541769
005418              ,:SUT00102-CNVYR-PRC-ACTN-NM                        00541851
005419              ,:SUT00102-CRE-BY-USR-ID                            00541951
005421           FROM  SUT_CART_DIRV_TRKG  A                            00542150
005422          WHERE  A.BRCDE_NBR      = :DK-BRCDE-NBR                 00542249
005423*           AND  A.CNVYR_PRC_ACTN_NM NOT IN ('DELETE')            00542368
005424            AND  A.CRE_TMST       =                               00542449
005425                   ( SELECT MAX (CRE_TMST)                        00542549
005426                     FROM SUT_CART_DIRV_TRKG B                    00542650
005427                     WHERE B.BRCDE_NBR  =  A.BRCDE_NBR            00542749
005428                     )                                            00542849
005429            AND  A.DIRV_RSN_CDE IN ('RLC','RLO','RLF', 'RFD')     00542975
005430     END-EXEC.                                                    00543049
005431                                                                  00543149
005432     EVALUATE TRUE                                                00543249
005433       WHEN SQLCODE = ZEROS                                       00543349
005434           SET PS-DIRECTIVE-RLSED TO TRUE                         00543449
005435           MOVE PC-MSG005         TO AMSGLNO                      00543549
005436       WHEN SQLCODE = +100                                        00543649
005437           SET PS-NO-DIRECTIVE-FOUND TO TRUE                      00543749
005438           MOVE PC-MSG004            TO AMSGLNO                   00543849
005439       WHEN OTHER                                                 00543949
005440             MOVE PC-PROG-NAME               TO DP013-PROGRAM     00544049
005441             MOVE '3010-CHECK-ALREADY-RLSED' TO DP013-PARAGRAPH   00544149
005442             STRING PC-PROG-NAME                                  00544249
005443                    ' - UNABLE TO SELECT '                        00544349
005444                 DELIMITED BY SIZE    INTO DP013-MESSAGE-TEXT (1) 00544449
005445             MOVE SQLCA              TO DP013-SQLCA               00544549
005446             MOVE 'SUT_CART_DIRV_TRKG' TO DP013-DB2-TABLE-NAME (1)00544649
005447             SET DP013-CICS-ABEND                                 00544749
005448                 DP013-ROLLBACK      TO TRUE                      00544849
005449             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               00544949
005450             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLNO            00545049
005451             MOVE SPACES                    TO ACARTNO            00545149
005452                                               ARCVRO             00545249
005453                                               ACDESTO            00545349
005454                                               ARLSEO             00545449
005455             PERFORM 8010-SEND-MAP-DATA-ONLY                      00545549
005456             PERFORM 8100-RETURN-TRANID                           00545649
005460     END-EVALUATE.                                                00546049
005500/                                                                 00550049
005637******************************************************************00563746
005638* 4000-FORMAT-RLSE-DIRECTIVE                                     *00563849
005639******************************************************************00563946
005640 4000-FORMAT-RLSE-DIRECTIVE.                                      00564049
005641                                                                  00564146
005642     INITIALIZE SU090-DG-REQUEST-COMMAREA.                        00564246
005643                                                                  00564346
005644     MOVE '00'                    TO SU090-RET-CODE.              00564446
005645     MOVE PC-PROG-NAME            TO SU090-CALLING-PGM.           00564546
005646     SET  SU090-ONLINE            TO TRUE.                        00564646
005647     MOVE CA-LOCATION-NBR         TO SU090-OPER-UNT-ID.           00564758
005648                                                                  00564865
005649     IF ( ALL-CARTONS-DIRECTIVES-MODE )                           00564965
005650         SET SU090-ADD-ACTION     TO TRUE                         00565065
005651     ELSE                                                         00565165
005656         SET SU090-DELETE-ACTION  TO TRUE                         00565665
005657     END-IF.                                                      00565765
005658                                                                  00565865
005659     SET SU090-CARTON-DIRECTIVE   TO TRUE.                        00565956
005660     MOVE 'RLF'                   TO SU090-DIRV-RSN-CDE.          00566056
005662                                                                  00566257
005665     EVALUATE TRUE                                                00566557
005666         WHEN SUT00102-SHIPT-UNT-ID > +0                          00566657
005667             MOVE 'S'                   TO SU090-BRCDE-TYP-CDE    00566757
005668             MOVE SUT00102-SHIPT-UNT-ID TO SU090-SML-BRCDE-NBR    00566857
005669             MOVE SPACES                TO SU090-P2L-BRCDE-NBR    00566957
005671         WHEN SUT00102-SHIPT-UNT-ID = +0                          00567163
005672             MOVE 'P'                   TO SU090-BRCDE-TYP-CDE    00567259
005673             MOVE ZEROS                 TO SU090-SML-BRCDE-NBR    00567357
005674             MOVE SUT00102-BRCDE-NBR    TO SU090-P2L-BRCDE-NBR    00567457
005675         WHEN OTHER                                               00567557
005676             MOVE ' '                   TO SU090-BRCDE-TYP-CDE    00567657
005677             MOVE ZEROS                 TO SU090-SML-BRCDE-NBR    00567757
005678             MOVE SPACES                TO SU090-P2L-BRCDE-NBR    00567857
005679     END-EVALUATE.                                                00567957
005680                                                                  00568057
005681     MOVE SUT00102-PO-NBR          TO SU090-PO-NBR.               00568157
005682     MOVE SUT00102-PO-LNE-NBR      TO SU090-PO-LNE-NBR.           00568257
005683     MOVE SUT00102-PREPK-ID        TO SU090-PO-PREPK-ID.          00568357
005684     MOVE SUT00102-RCVR-SEQ-NBR    TO SU090-RCVR-SEQ-NBR.         00568457
005700     MOVE SUT00102-CART-STAT-CDE   TO SU090-CART-STAT-CDE.        00570057
005703     MOVE SUT00102-AUD-CNTL-NBR    TO SU090-AUD-CNTL-NBR          00570357
005704     MOVE SUT00102-AUD-STAT-CDE    TO SU090-AUD-STAT-CDE          00570457
005714     MOVE SUT00102-STR-NBR         TO SU090-STR-NBR.              00571456
005715     MOVE CA-USERID                TO SU090-ASSOC-ID.             00571556
005718*                                                                 00571869
005719* NULLABLE FIELDS                                                 00571969
005720*                                                                 00572069
005727     EVALUATE TRUE                                                00572769
005728         WHEN DN-CASI-CDE = +0                                    00572869
005729             MOVE SUT00102-CASI-CDE                               00572969
005730               TO SU090-CASI-CDE                                  00573069
005731         WHEN DN-AUD-FALR-RSN-NM = +0                             00573169
005732             MOVE SUT00102-AUD-FALR-RSN-NM                        00573269
005733               TO SU090-AUD-FAIL-RSN                              00573369
005740         WHEN DN-STR-ZN-ID = +0                                   00574069
005741             MOVE SUT00102-STR-ZN-ID                              00574169
005742               TO SU090-STR-ZN                                    00574269
005747         WHEN DN-SEASET-YR = +0                                   00574769
005748             MOVE SUT00102-SEASET-YR                              00574869
005749               TO SU090-SEASET-YR                                 00574969
005752         WHEN DN-SEASET-SHRT-NM = +0                              00575269
005753             MOVE SUT00102-SEASET-SHRT-NM                         00575369
005754               TO SU090-SEASET-CDE                                00575469
005755     END-EVALUATE.                                                00575569
005756                                                                  00575669
005757     INSPECT SU090-DG-REQUEST-COMMAREA                            00575772
005758         REPLACING ALL LOW-VALUES BY '?'.                         00575871
005759                                                                  00575971
005760     CALL PC-PROG-NAME-DDG USING DFHEIBLK                         00576071
005761                                 SU090-COMMAREA                   00576171
005762                                 SU090-DG-REQUEST-COMMAREA.       00576271
005763                                                                  00576371
005764     IF ( SU090-SUCCESS )                                         00576471
005765         MOVE PC-MSG006           TO AMSGLNO                      00576571
005766         MOVE SUT00102-PO-NBR     TO CA-MAP-PO                    00576671
005767         MOVE '-'                 TO CA-MAP-DASH                  00576771
005768         MOVE SUT00102-PO-LNE-NBR TO CA-MAP-PO-LNE                00576871
005769         IF ( SU090-BRCDE-TYP-CDE = 'S' )                         00576971
005770             MOVE CA-LOCATION-NBR TO CA-MAP-ACDEST-N              00577071
005771         ELSE                                                     00577171
005772             MOVE 'P2L  '         TO CA-MAP-ACDEST                00577271
005773         END-IF                                                   00577371
005774     ELSE                                                         00577471
005775         MOVE PC-PROG-NAME                 TO DP013-PROGRAM       00577571
005776         MOVE '4000-FORMAT-RLSE-DIRECTIVE' TO DP013-PARAGRAPH     00577671
005777         STRING PC-PROG-NAME                                      00577771
005778                ' - CALL TO PGM SUKUT129 FAILED'                  00577871
005779             DELIMITED BY SIZE    INTO DP013-MESSAGE-TEXT (1)     00577971
005780         STRING 'RET-CODE = '   SU090-RET-CODE                    00578071
005781                ',PGM = '       SU090-ERR-PROGRAM                 00578171
005782                ',PARAGRAPH = ' SU090-ERR-PARAGRAPH               00578271
005783                ',ASSOC = '     SU090-ASSOC-ID                    00578371
005784                ',SML = '       SU090-SML-BRCDE-NBR               00578471
005785                ',P2L = '       SU090-P2L-BRCDE-NBR               00578571
005786             DELIMITED BY SIZE INTO DP013-MESSAGE-TEXT (2)        00578671
005787         MOVE SU090-SQLCA      TO DP013-SQLCA                     00578771
005788         SET DP013-CICS-ABEND                                     00578871
005789             DP013-ROLLBACK      TO TRUE                          00578971
005790         PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG                   00579071
005792         MOVE SPACES                    TO ACARTNO                00579271
005793                                           ARCVRO                 00579371
005794                                           ACDESTO                00579471
005795                                           ARLSEO                 00579571
005796         EVALUATE TRUE                                            00579671
005797             WHEN SU090-PARAMETER-ERROR                           00579771
005798                 MOVE PC-DG-ERROR-PARM TO AMSGLNO                 00579871
005799             WHEN SU090-DB2-ERROR                                 00579971
005800                 MOVE PC-DG-ERROR-DB2  TO AMSGLNO                 00580071
005801             WHEN SU090-MQ-ERROR                                  00580171
005802                 MOVE PC-DG-ERROR-MQ   TO AMSGLNO                 00580271
005803             WHEN SU090-OTHER-ERROR                               00580371
005804                 MOVE PC-DG-ERROR-OTHR TO AMSGLNO                 00580471
005805         END-EVALUATE                                             00580571
005806         PERFORM 8010-SEND-MAP-DATA-ONLY                          00580671
005807         PERFORM 8100-RETURN-TRANID                               00580771
005808     END-IF.                                                      00580871
005809/                                                                 00580971
005810******************************************************************00581071
005811* 8000-SEND-MAP-ERASE                                            *00581171
005812******************************************************************00581271
005813 8000-SEND-MAP-ERASE.                                             00581371
005814                                                                  00581471
005815     MOVE -1 TO ACARTNL.                                          00581571
005816                                                                  00581671
005817     EXEC CICS SEND                                               00581771
005818               MAP    ('SU742A')                                  00581871
005819               MAPSET ('SUKM742')                                 00581971
005820               ERASE                                              00582071
005821               CURSOR                                             00582171
005822               RESP   (PV-CICS-RESPONSE)                          00582271
005823     END-EXEC.                                                    00582371
005824                                                                  00582471
005825     EVALUATE TRUE                                                00582571
005826         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 00582671
005827             CONTINUE                                             00582771
005828         WHEN OTHER                                               00582871
005829             MOVE PC-PROG-NAME          TO DP013-PROGRAM          00582971
005830             MOVE '8000-SEND-MAP-ERASE' TO DP013-PARAGRAPH        00583071
005831             STRING PC-PROG-NAME                                  00583171
005832                    ' - UNABLE TO SEND MAP'                       00583271
005833                 DELIMITED BY SIZE    INTO DP013-MESSAGE-TEXT (1) 00583371
005834             SET DP013-CICS-ABEND                                 00583471
005835                 DP013-ROLLBACK         TO TRUE                   00583571
005836             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               00583671
005837     END-EVALUATE.                                                00583771
005838/                                                                 00583871
005839******************************************************************00583971
005840* 8010-SEND-MAP-DATA-ONLY                                        *00584071
005841******************************************************************00584171
005842 8010-SEND-MAP-DATA-ONLY.                                         00584271
005843                                                                  00584371
005844     MOVE -1 TO ACARTNL.                                          00584471
005845                                                                  00584571
005846     EXEC CICS SEND                                               00584671
005847               MAP    ('SU742A')                                  00584771
005848               MAPSET ('SUKM742')                                 00584871
005849               CURSOR                                             00584971
005850               DATAONLY                                           00585071
005851               RESP   (PV-CICS-RESPONSE)                          00585171
005852     END-EXEC.                                                    00585271
005853                                                                  00585371
005854     EVALUATE TRUE                                                00585471
005855         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 00585571
005856             CONTINUE                                             00585671
005857         WHEN OTHER                                               00585771
005858             MOVE PC-PROG-NAME          TO DP013-PROGRAM          00585871
005859             MOVE '8010-SEND-MAP-DATA-ONLY'                       00585971
005860                                        TO DP013-PARAGRAPH        00586071
005861             STRING PC-PROG-NAME                                  00586171
005862                    ' - UNABLE TO SEND MAP'                       00586271
005863                 DELIMITED BY SIZE    INTO DP013-MESSAGE-TEXT (1) 00586371
005864             SET DP013-CICS-ABEND                                 00586471
005865                 DP013-ROLLBACK         TO TRUE                   00586571
005866             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               00586671
005867     END-EVALUATE.                                                00586771
005868/                                                                 00586871
005869******************************************************************00586971
005870* 8020-RECEIVE-MAP                                               *00587071
005871******************************************************************00587171
005872 8020-RECEIVE-MAP.                                                00587271
005873                                                                  00587371
005874     EXEC CICS RECEIVE                                            00587471
005875               MAP    ('SU742A')                                  00587571
005876               MAPSET ('SUKM742')                                 00587671
005877                RESP   (PV-CICS-RESPONSE)                         00587709
005880     END-EXEC.                                                    00588001
005890                                                                  00589001
005900     EVALUATE TRUE                                                00590001
005910         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 00591001
005920             CONTINUE                                             00592001
005930         WHEN PV-CICS-RESPONSE = DFHRESP (MAPFAIL)                00593001
005940             CONTINUE                                             00594001
005950         WHEN OTHER                                               00595001
005960             MOVE PC-PROG-NAME          TO DP013-PROGRAM          00596014
005970             MOVE '8020-RECEIVE-MAP'    TO DP013-PARAGRAPH        00597014
005980             STRING PC-PROG-NAME                                  00598009
005990                    ' - UNABLE TO RECEIVE MAP'                    00599009
006000                 DELIMITED BY SIZE    INTO DP013-MESSAGE-TEXT (1) 00600009
006010             SET DP013-CICS-ABEND                                 00601014
006020                 DP013-ROLLBACK         TO TRUE                   00602014
006030            PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG                00603001
006040     END-EVALUATE.                                                00604001
006050/                                                                 00605005
006060******************************************************************00606005
006070* 8100-RETURN-TRANID                                             *00607005
006080******************************************************************00608005
006090 8100-RETURN-TRANID.                                              00609001
006100                                                                  00610001
006110     EXEC CICS RETURN                                             00611005
006120               TRANSID  (PC-TRANID)                               00612005
006130               COMMAREA (CA-COMMAREA)                             00613005
006140               LENGTH   (LENGTH OF CA-COMMAREA)                   00614005
006150               RESP     (PV-CICS-RESPONSE)                        00615005
006160     END-EXEC.                                                    00616001
006170                                                                  00617001
006180     EVALUATE TRUE                                                00618001
006190         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 00619001
006200             CONTINUE                                             00620001
006210         WHEN OTHER                                               00621001
006220             MOVE PC-PROG-NAME          TO DP013-PROGRAM          00622014
006230             MOVE '8100-RETURN-TRANIND' TO DP013-PARAGRAPH        00623001
006240             STRING PC-PROG-NAME                                  00624007
006250                    ' - UNABLE TO RETURN TO TRANID'               00625007
006260                 DELIMITED BY SIZE    INTO DP013-MESSAGE-TEXT (1) 00626007
006270             SET DP013-CICS-ABEND       TO TRUE                   00627001
006280             SET DP013-ROLLBACK         TO TRUE                   00628001
006290             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               00629001
006300     END-EVALUATE.                                                00630001
006310/                                                                 00631005
006320******************************************************************00632005
006330* 8110-RETURN                                                    *00633005
006340******************************************************************00634005
006350 8110-RETURN.                                                     00635001
006360                                                                  00636001
006370     EXEC CICS SEND                                               00637005
006380               FROM   (PV-MESSAGE-AREA)                           00638005
006390               LENGTH (LENGTH OF PV-MESSAGE-AREA)                 00639005
006400               ERASE                                              00640005
006410     END-EXEC.                                                    00641001
006420                                                                  00642001
006430     EXEC CICS RETURN                                             00643005
006440     END-EXEC.                                                    00644001
006450/                                                                 00645005
006460******************************************************************00646009
006470* 8200-XCTL-TO-MENU                                              *00647009
006480******************************************************************00648009
006490 8200-XCTL-TO-MENU.                                               00649009
006500                                                                  00650009
006510     EXEC CICS XCTL                                               00651009
006520               PROGRAM   (PC-PROG-NAME-MENU)                      00652009
006530               COMMAREA  (SU001-COMMON-DATA)                      00653009
006540               LENGTH    (LENGTH OF SU001-COMMON-DATA)            00654009
006550               RESP      (PV-CICS-RESPONSE)                       00655009
006560     END-EXEC.                                                    00656009
006570                                                                  00657009
006580     EVALUATE TRUE                                                00658009
006590         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 00659009
006600              CONTINUE                                            00660009
006610         WHEN OTHER                                               00661009
006620             MOVE PC-PROG-NAME        TO DP013-PROGRAM            00662014
006630             MOVE '8200-XCTL-TO-MENU' TO DP013-PARAGRAPH          00663009
006640             STRING PC-PROG-NAME                                  00664009
006650                    ' - UNABLE TO XCTL TO PROGRAM: '              00665009
006660                    PC-PROG-NAME-MENU                             00666009
006670                 DELIMITED BY SIZE    INTO DP013-MESSAGE-TEXT (1) 00667009
006680             SET DP013-CICS-ABEND                                 00668009
006690                 DP013-ROLLBACK              TO TRUE              00669009
006700             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               00670009
006710             MOVE PC034-CICS-FATAL-ERROR-MSG TO AMSGLNO           00671009
006720             MOVE SPACES                     TO ACARTNO           00672009
006730                                                ARCVRO            00673009
006740                                                ACDESTO           00674009
006750                                                ARLSEO            00675009
006760             PERFORM 8010-SEND-MAP-DATA-ONLY                      00676009
006770             PERFORM 8100-RETURN-TRANID                           00677009
006780     END-EVALUATE.                                                00678009
006790/                                                                 00679009
006800******************************************************************00680007
006810* 8220-XCTL-TO-HELP                                              *00681007
006820******************************************************************00682007
006830 8220-XCTL-TO-HELP.                                               00683001
006840                                                                  00684001
006850     EXEC CICS XCTL                                               00685007
006860               PROGRAM   (PC-PROG-NAME-HELP)                      00686009
006870               COMMAREA  (PC192-COMMAREA)                         00687007
006880               LENGTH    (LENGTH OF PC192-COMMAREA)               00688007
006890               RESP      (PV-CICS-RESPONSE)                       00689007
006900     END-EXEC.                                                    00690001
006910                                                                  00691001
006920     EVALUATE TRUE                                                00692001
006930         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 00693001
006940              CONTINUE                                            00694001
006950         WHEN OTHER                                               00695001
006960             MOVE PC-PROG-NAME        TO DP013-PROGRAM            00696014
006970             MOVE '8220-XCTL-TO-HELP' TO DP013-PARAGRAPH          00697001
006980             STRING PC-PROG-NAME                                  00698007
006990                    ' - UNABLE TO XCTL TO PROGRAM: '              00699007
007000                    PC-PROG-NAME-HELP                             00700009
007010                 DELIMITED BY SIZE    INTO DP013-MESSAGE-TEXT (1) 00701007
007020             SET DP013-CICS-ABEND                                 00702001
007030                 DP013-ROLLBACK              TO TRUE              00703007
007040             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               00704001
007050             MOVE PC034-CICS-FATAL-ERROR-MSG TO AMSGLNO           00705007
007060             MOVE SPACES                     TO ACARTNO           00706007
007070                                                ARCVRO            00707007
007080                                                ACDESTO           00708007
007090                                                ARLSEO            00709007
007100             PERFORM 8010-SEND-MAP-DATA-ONLY                      00710007
007110             PERFORM 8100-RETURN-TRANID                           00711001
007120     END-EVALUATE.                                                00712001
007130/                                                                 00713007
007140******************************************************************00714007
007150* 9999-WRITE-MESSAGE-TO-CICS-LOG                                 *00715007
007160******************************************************************00716007
007170 9999-WRITE-MESSAGE-TO-CICS-LOG.                                  00717001
007180                                                                  00718001
007190     MOVE PC-PROG-NAME     TO DP013-PROGRAM.                      00719007
007200     MOVE DFHEIBLK         TO DP013-DFHEIBLK.                     00720007
007210     INITIALIZE DP013-SRC-TASK-NUMBER                             00721001
007220                DP013-STACK.                                      00722001
007230     SET DP013-LINK-RETURN TO TRUE.                               00723007
007240                                                                  00724001
007250     EXEC CICS LINK                                               00725007
007260               PROGRAM   (DP013-NAME)                             00726007
007270               COMMAREA  (DP013-PARAMETERS)                       00727007
007280               LENGTH    (DP013-LENGTH)                           00728007
007290     END-EXEC.                                                    00729001
