000100***************************************************************** 00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300***************************************************************** 00030000
000400                                                                  00040000
000500 PROGRAM-ID.             SUKRP004.                                00050000
000600 AUTHOR.                 LARRY SCHLEICHER - STRATAGEM.            00060000
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070000
000800 DATE-WRITTEN            JUNE, 1996.                              00080000
000900 DATE-COMPILED.                                                   00090000
001000***************************************************************** 00100000
001100***************************************************************** 00110000
001200*                                                               * 00120000
001300*  THIS PROGRAM WILL PRINT THE MISDIRECTS REPORT                * 00130000
001400*  THIS IS PRODUCED FOLLOWING THE CHECK-IN OF A TRAILER         * 00140000
001500*  WHICH HAS HAD THE CARTONS SCANNED USING THE LRT TERMINAL.    * 00150000
001600***************************************************************** 00160000
001700*  CHANGED 08/07/2000 BY LARRY SCHLEICHER                       * 00170000
001800*   WR# 20694 USE THE DEST-OPER-UNT-ID FIELD FROM THE TSULBXF   * 00180000
001900*             TABLE TO FILL IN THE 'STR NBR' FIELD ON THE REPORT* 00190000
002000***************************************************************** 00200000
002010*  CHANGED 10/31/2002 BY ALBERT A VINOD                         * 00210000
002020*   WR# 21361 TSK AND TUPCSKU TABLES WITH XLV VIEWS.            * 00220000
002000***************************************************************** 00221057
002010*  CHANGED 09/30/2014 BY CHERI PARMLEY                          * 00222057
002020*   CHG# 0094517  EXPANDED PO FROM 7 TO 8 DIGITS                * 00223066
002040***************************************************************** 00230000
002100*  CHANGED MM/DD/YY BY XXXXXXXXXXX                              * 00240000
002200*   WR# XXXX XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX * 00250000
002300*                                                               * 00260000
002400***************************************************************** 00270000
002500***************************************************************** 00280000
002600 ENVIRONMENT DIVISION.                                            00290000
002700***************************************************************** 00300000
002800                                                                  00310000
002900 CONFIGURATION SECTION.                                           00320000
003000                                                                  00330000
003100 SOURCE-COMPUTER.        IBM-3090.                                00340000
003200 OBJECT-COMPUTER.        IBM-3090.                                00350000
003300                                                                  00360000
003400 INPUT-OUTPUT SECTION.                                            00370000
003500                                                                  00380000
003600 FILE-CONTROL.                                                    00390000
003700*                                                                 00400000
003800     SELECT EXTRACT-FILE                                          00410000
003900         ASSIGN TO INP01.                                         00420000
004000                                                                  00430000
004100     SELECT SU-CARTON-NOT-RCVD-FILE                               00440000
004200         ASSIGN TO RPT01.                                         00450000
004300*                                                                 00460000
004400***************************************************************** 00470000
004500 DATA DIVISION.                                                   00480000
004600***************************************************************** 00490000
004700*                                                                 00500000
004800 FILE SECTION.                                                    00510000
004900*                                                                 00520000
005000                                                                  00530000
005100 FD  EXTRACT-FILE                                                 00540000
005200     LABEL RECORDS ARE STANDARD                                   00550000
005300     RECORDING MODE IS F                                          00560000
005400     BLOCK CONTAINS 0 RECORDS                                     00570000
005500     RECORD CONTAINS 200 CHARACTERS.                              00580000
005600 01  EXTRACT-RECORD                  PIC X(200).                  00590000
005700                                                                  00600000
005800 FD  SU-CARTON-NOT-RCVD-FILE                                      00610000
005900     RECORDING MODE IS F                                          00620000
006000     BLOCK CONTAINS 0  RECORDS.                                   00630000
006100 01  SU-CARTON-NOT-RCVD-RECORD       PIC  X(132).                 00640000
006200*                                                                 00650000
006300                                                                  00660000
006400 WORKING-STORAGE SECTION.                                         00670000
006500*                                                                 00680000
006600**************************************************************    00690000
006700* FORMAT OF THE CONTROL CARD INFORMATION PASSED INTO THE PGM *    00700000
006800**************************************************************    00710000
006900 01  CC-CONTROL-CARD.                                             00720000
007000     05  CC-PRINTER-ID                PIC  X(08).                 00730000
007100     05  CC-PRTR-CNTL-IND             PIC  X(01).                 00740000
007200     05  CC-TRACK-NBR                 PIC  9(01).                 00750000
007300     05  FILLER                       PIC  X(01).                 00760000
007400     05  CC-CUT-REPORT                PIC  X(01).                 00770000
007500         88 CC-CUT-REPORT-AT-END                   VALUE 'C'.     00780000
007600     05  CC-REQUESTOR-ID              PIC  X(08).                 00790000
007700     05  CC-PRINT-SUKRP002-IND        PIC  X(01).                 00800000
007800         88 CC-PRINT-SUKRP002                      VALUE 'Y'.     00810000
007900     05  CC-PRINT-SUKRP003-IND        PIC  X(01).                 00820000
008000         88 CC-PRINT-SUKRP003                      VALUE 'Y'.     00830000
008100     05  CC-PRINT-SUKRP004-IND        PIC  X(01).                 00840000
008200         88 CC-PRINT-SUKRP004                      VALUE 'Y'.     00850000
008300     05  CC-PRINT-SUKRP005-IND        PIC  X(01).                 00860000
008400         88 CC-PRINT-SUKRP005                      VALUE 'Y'.     00870000
008500     05  CC-PRINT-SUKRP006-IND        PIC  X(01).                 00880000
008600         88 CC-PRINT-SUKRP006                      VALUE 'Y'.     00890000
008700     05  CC-PRINT-SUKRP007-IND        PIC  X(01).                 00900000
008800         88 CC-PRINT-SUKRP007                      VALUE 'Y'.     00910000
008900     05  CC-PRINT-SUKRP008-IND        PIC  X(01).                 00920000
009000         88 CC-PRINT-SUKRP008                      VALUE 'Y'.     00930000
009100*JPL                                                              00940000
009200     05  CC-PRINT-SUKRP023-IND        PIC  X(01).                 00950000
009300         88 CC-PRINT-SUKRP023                      VALUE 'Y'.     00960000
009400     05  FILLER                       PIC  X(01).                 00970000
009500     05  CC-PRINT-ALL-PO-IND          PIC  X(01).                 00980000
009600         88 CC-PRINT-ENTIRE-TRIP                   VALUE 'Y'.     00990000
009700         88 CC-PRINT-SELECTED-PO                   VALUE 'N'.     01000000
009800*                                                                 01010000
009900 01  PROGRAM-SWITCHES.                                            01020000
010000     05  PS-END-OF-CURSOR-SW         PIC  X(01)    VALUE 'N'.     01030000
010100         88  PS-END-OF-CURSOR                      VALUE 'Y'.     01040000
010200     05  PS-END-OF-PO-CURSOR-SW      PIC  X(01)    VALUE 'N'.     01050000
010300         88  PS-END-OF-PO-CURSOR                   VALUE 'Y'.     01060000
010400         88  PS-NOT-END-OF-PO-CURSOR               VALUE 'N'.     01070000
010500     05  PS-END-OF-SHPUNT-CSR-SW     PIC  X(01)    VALUE 'N'.     01080000
010600         88  PS-END-OF-SHPUNT-CSR                  VALUE 'Y'.     01090000
010700         88  PS-NOT-END-OF-SHPUNT-CSR              VALUE 'N'.     01100000
010800     05  PS-END-OF-EXTRACT-SW        PIC  X(01)    VALUE 'N'.     01110000
010900         88  PS-END-OF-EXTRACT                     VALUE 'Y'.     01120000
011000     05  PS-STATUS-FOUND-SW          PIC  X(01)    VALUE 'N'.     01130000
011100         88  PS-STATUS-FOUND                       VALUE 'Y'.     01140000
011200         88  PS-STATUS-NOT-FOUND                   VALUE 'N'.     01150000
011300     05  PS-PRINT-LINE-SW            PIC  X(01)    VALUE 'N'.     01160000
011400         88  PS-PRINT-LINE                         VALUE 'Y'.     01170000
011500         88  PS-SUM-LINE                           VALUE 'N'.     01180000
011600     05  PS-RECORD-TYPE-SW           PIC  X(01)    VALUE 'B'.     01190000
011700         88  PS-ERROR-RECORD                       VALUE 'A'.     01200000
011800         88  PS-DETAIL-RECORD                      VALUE 'B'.     01210000
011900*LMM                                                              01220000
012000 01  DN-DB2-NULL-INDICATORS.                                      01230000
012100     05  DN-VEH-NBR                  PIC S9(04) COMP VALUE +0.    01240000
012200*                                                                 01250000
012300 01  PC-CONSTANTS.                                                01260000
012400     05  PC-1                        PIC S9(03)    VALUE +1       01270000
012500                                                   COMP-3.        01280000
012600     05  PC-2                        PIC S9(03)    VALUE +2       01290000
012700                                                   COMP-3.        01300000
012800     05  PC-3                        PIC S9(03)    VALUE +3       01310000
012900                                                   COMP-3.        01320000
013000     05  PC-7                        PIC S9(01)    VALUE +7.      01330000
013100     05  PC-11                       PIC S9(03)    VALUE +11      01340000
013200                                                   COMP-3.        01350000
013300     05  PC-60                       PIC S9(03)    VALUE +60      01360000
013400                                                   COMP-3.        01370000
013500     05  PC-DASH                     PIC  X(01)    VALUE '-'.     01380000
013600     05  PC-Y                        PIC  X(01)    VALUE 'Y'.     01390000
013700     05  PC-00                       PIC  X(02)    VALUE '00'.    01400000
013800     05  PC-UG                       PIC  X(02)    VALUE 'UG'.    01410000
013900     05  PC-UN                       PIC  X(02)    VALUE 'UN'.    01420000
014000     05  PC-AR                       PIC  X(02)    VALUE 'AR'.    01430000
014100     05  PC-MLT                      PIC  X(04)    VALUE 'MLT '.  01440056
014200     05  PC-A                        PIC  X(01)    VALUE 'A'.     01450000
014300     05  PC-SUKRP004                 PIC  X(08)    VALUE          01460000
014400         'SUKRP004'.                                              01470000
014500     05  PC-REPORT-NBR               PIC  9(01)    VALUE 1.       01480000
014600     05  PC-NO-SKU                   PIC  X(11)    VALUE          01490000
014700         'NO SKU'.                                                01500000
014800*                                                                 01510000
014900 01  PV-MISC-FIELDS.                                              01520000
015000     05  PV-LINE-SUB                 PIC S9(03)    VALUE +0       01530000
015100                                                   COMP-3.        01540000
015200     05  PV-LINE-CNT                 PIC S9(03)    VALUE ZERO     01550000
015300                                                   COMP-3.        01560000
015400     05  PV-PAGE-CNT                 PIC S9(04)    VALUE ZERO     01570000
015500                                                   COMP-3.        01580000
015600     05  PV-STATUS                   PIC  X(02).                  01590000
      *CLP 09/30/14                                                     01591057
015700     05  PV-SAVE-PO-RECEIVER         PIC  X(12).                  01600057
015800     05  PV-SAVE-SHIP-CODE           PIC  9(18).                  01610000
015900     05  PV-SAVE-OPER-FCLTY          PIC  X(08).                  01620000
016000     05  PV-SAVE-SCAN-OPER-FCLTY     PIC  X(08).                  01630000
016100     05  PV-TRIP-ID                  PIC  9(09).                  01640000
016200     05  PV-EXPTED-QTY               PIC  9(05).                  01650000
016300     05  PV-LINE-TOT-QTY             PIC  9(05).                  01660000
016400     05  PV-LINE-NBR                 PIC  9(04)    VALUE 0.       01670000
016500     05  PV-ABEND-CODE               PIC S9(04)    VALUE ZERO     01680000
016600                                                   COMP SYNC.     01690000
016610******************************************************************01700053
016620*   REMOVED PROGRAM VARIABLES PV-SAVE-SKU-DEPT,        WR# 21361 *01710053
016630*   PV-SAVE-SKU-CLASS AND PV-SAVE-SKU-SKU.                       *01720053
016640******************************************************************01730053
017000     05  PV-ABEND-PARAGRAPH          PIC  X(30)    VALUE SPACES.  01740000
017100******************************************************************01750000
017200*   MODIFIED THE GROUP VARAIBLE PV-SKU TO REMOVE       WR# 21361 *01760000
017300*   PV-SKU-SEQ AND ADDED NEW VARIABLE PV-SKU-NBR AND VALUES OF   *01770000
017310*   FILLERS CHANGED TO SPACES.                                   *01780000
017400******************************************************************01790000
017500     05  PV-SKU.                                                  01800000
017600         10  PV-SKU-DEPT             PIC  9(03)    VALUE ZEROS.   01810000
017800         10  FILLER                  PIC  X(01)    VALUE SPACES.  01820000
017900         10  PV-SKU-CLASS            PIC  9(02)    VALUE ZEROS.   01830000
018100         10  FILLER                  PIC  X(01)    VALUE SPACES.  01840000
018300         10  PV-SKU-NBR              PIC  9(08)    VALUE ZEROS.   01850000
018400******************************************************************01860000
018500*  CHANGES MADE FOR WR# 21361 ENDS HERE.                         *01870053
018600******************************************************************01880000
018700     05  PV-PO-RECEIVER.                                          01890000
      *CLP 09/20/14                                                     01891057
018800         10  PV-PO                   PIC  9(08)    VALUE ZERO.    01900057
018900         10  FILLER                  PIC  X(01)    VALUE '-'.     01910000
019000         10  PV-RECEIVER             PIC  9(03)    VALUE ZERO.    01920000
019100     05  PV-STORE-NBR-CHAR           PIC  X(04)    VALUE SPACES.  01930056
019200     05  PV-TODAYS-DATE.                                          01940000
019300         10  PV-TODAYS-DATE-YY       PIC  9(02)    VALUE ZERO.    01950000
019400         10  PV-TODAYS-DATE-MM       PIC  9(02)    VALUE ZERO.    01960000
019500         10  PV-TODAYS-DATE-DD       PIC  9(02)    VALUE ZERO.    01970000
019600     05  PV-TODAYS-TIME.                                          01980000
019700         10  PV-TODAYS-TIME-HH       PIC  9(02)    VALUE ZERO.    01990000
019800         10  PV-TODAYS-TIME-MM       PIC  9(02)    VALUE ZERO.    02000000
019900         10  PV-TODAYS-TIME-SS       PIC  9(02)    VALUE ZERO.    02010000
020000         10  FILLER                  PIC  9(02)    VALUE ZERO.    02020000
020100     05  PV-DB2-DATE.                                             02030000
020200         10  PV-DB2-DATE-CC          PIC  X(02)    VALUE ZERO.    02040000
020300         10  PV-DB2-DATE-YY          PIC  X(02)    VALUE ZERO.    02050000
020400         10  FILLER                  PIC  X(01)    VALUE ZERO.    02060000
020500         10  PV-DB2-DATE-MM          PIC  X(02)    VALUE ZERO.    02070000
020600         10  FILLER                  PIC  X(01)    VALUE ZERO.    02080000
020700         10  PV-DB2-DATE-DD          PIC  X(02)    VALUE ZERO.    02090000
020800     05  PV-SERIAL-SHIP-CODE          PIC  9(18).                 02100000
020900     05  FILLER REDEFINES PV-SERIAL-SHIP-CODE.                    02110000
021000         10  PV-SERIAL-SHIP-CODE-1    PIC  X(01).                 02120000
021100         10  PV-SERIAL-SHIP-CODE-2-8  PIC  X(07).                 02130000
021200         10  PV-SERIAL-SHIP-CODE-9-17 PIC  X(09).                 02140000
021300         10  PV-SERIAL-SHIP-CODE-18   PIC  X(01).                 02150000
021400     05  PV-OUT-SERIAL-SHIP-CODE.                                 02160000
021500         10  FILLER                   PIC  X(05)    VALUE '(00) '.02170000
021600         10  PV-OUT-S-S-C-1           PIC  X(01).                 02180000
021700         10  FILLER                   PIC  X(01) VALUE SPACES.    02190000
021800         10  PV-OUT-S-S-C-2-8         PIC  X(07).                 02200000
021900         10  FILLER                   PIC  X(01) VALUE SPACES.    02210000
022000         10  PV-OUT-S-S-C-9-17        PIC  X(09).                 02220000
022100         10  FILLER                   PIC  X(01) VALUE SPACES.    02230000
022200         10  PV-OUT-S-S-C-18          PIC  X(01).                 02240000
022300     05  PV-OPER-FCLTY.                                           02250000
022400         10  PV-OPER-UNT              PIC  9(04).                 02260000
022500         10  FILLER                   PIC  X(01) VALUE '-'.       02270000
022600         10  PV-FCLTY-ID              PIC  9(03).                 02280000
022700*                                                                 02290000
022800     COPY DPWS024.                                                02300056
022900                                                                  02310000
023000     COPY SURD001.                                                02320056
023100 EJECT                                                            02330000
023200*                                                                 02340000
023300******************************************************************02350000
023400*  WORK FIELDS FOR PRINTING A 132 CHARACTER REPORT.               02360000
023500******************************************************************02370000
023600     COPY DPWS132O.                                               02380056
023700*                                                                 02390000
023800*                                                                 02400000
023900 01  HEADING-LINES.                                               02410000
024000     05  HEADING-LINE-0.                                          02420000
024100         10  FILLER                  PIC  X(50)    VALUE SPACES.  02430000
024200         10  FILLER                  PIC  X(32)    VALUE          02440000
024300             'CHECK-IN COMPLETION - EXCEPTIONS'.                  02450000
024400         10  FILLER                  PIC  X(50)    VALUE SPACES.  02460000
024500*                                                                 02470000
024600     05  HEADING-LINE-1.                                          02480000
024700         10  FILLER                  PIC  X(05)    VALUE SPACES.  02490000
024800         10  FILLER                  PIC  X(40)    VALUE          02500000
024900             '****************************************'.          02510000
025000         10  FILLER                  PIC  X(16)    VALUE SPACES.  02520000
025100         10  FILLER                  PIC  X(10)    VALUE          02530000
025200             'MISDIRECTS'.                                        02540000
025300         10  FILLER                  PIC  X(61)    VALUE SPACES.  02550000
025400*                                                                 02560000
025500     05  HEADING-LINE-1A.                                         02570000
025600         10  FILLER                  PIC  X(05)    VALUE SPACES.  02580000
025700         10  FILLER                  PIC  X(03)    VALUE '*  '.   02590000
025800         10  HL1A-CC-IND-DESC        PIC  X(36)    VALUE SPACES.  02600000
025900         10  FILLER                  PIC  X(01)    VALUE '*'.     02610000
026000         10  FILLER                  PIC  X(87)    VALUE SPACES.  02620000
026100*                                                                 02630000
026200     05  HEADING-LINE-1B.                                         02640000
026300         10  FILLER                  PIC  X(05)    VALUE SPACES.  02650000
026400         10  FILLER                  PIC  X(40)    VALUE          02660000
026500             '****************************************'.          02670000
026600         10  FILLER                  PIC  X(87)    VALUE SPACES.  02680000
026700*                                                                 02690000
026800     05  HEADING-LINE-2.                                          02700000
026900         10  FILLER                  PIC  X(03)    VALUE SPACE.   02710000
027000         10  FILLER                  PIC  X(09)    VALUE          02720000
027100             'CARRIER: '.                                         02730000
027200         10  HL2-SCAC                PIC  X(04)    VALUE SPACES.  02740000
027300         10  FILLER                  PIC  X(03)    VALUE SPACE.   02750000
027400         10  FILLER                  PIC  X(09)    VALUE          02760000
027500             'TRAILER: '.                                         02770000
027600         10  HL2-TRAILER             PIC  X(10)    VALUE SPACES.  02780000
027700         10  FILLER                  PIC  X(04)    VALUE SPACE.   02790000
027800         10  FILLER                  PIC  X(09)    VALUE          02800000
027900             'TRIP ID: '.                                         02810000
028000         10  HL2-TRIP-ID             PIC  X(11)    VALUE SPACES.  02820000
028100         10  FILLER                  PIC  X(14)    VALUE SPACE.   02830000
028200         10  FILLER                  PIC  X(16)    VALUE          02840000
028300             'TRAILER STATUS: '.                                  02850000
028400         10  HL2-TRAILER-STAT        PIC  X(02)    VALUE SPACES.  02860000
028500         10  FILLER                  PIC  X(38)    VALUE SPACES.  02870000
028600*                                                                 02880000
028700     05  HEADING-LINE-3.                                          02890000
028800         10  FILLER                  PIC  X(03)    VALUE SPACES.  02900000
028900         10  FILLER                  PIC  X(16)    VALUE          02910000
029000             'ARRIVAL DATE:   '.                                  02920000
029100         10  HL3-ARRIVAL-DATE.                                    02930000
029200             15  HL3-ARRIVAL-DATE-MM                              02940000
029300                                     PIC  X(02)    VALUE SPACES.  02950000
029400             15  FILLER              PIC  X(01)    VALUE '/'.     02960000
029500             15  HL3-ARRIVAL-DATE-DD                              02970000
029600                                     PIC  X(02)    VALUE SPACES.  02980000
029700             15  FILLER              PIC  X(01)    VALUE '/'.     02990000
029800             15  HL3-ARRIVAL-DATE-CC                              03000000
029900                                     PIC  X(02)    VALUE SPACES.  03010000
030000             15  HL3-ARRIVAL-DATE-YY                              03020000
030100                                     PIC  X(02)    VALUE SPACES.  03030000
030200         10  FILLER                  PIC  X(11)    VALUE SPACES.  03040000
030300         10  FILLER                  PIC  X(23)    VALUE          03050000
030400             'BEGIN UNLOADING DATE:  '.                           03060000
030500         10  HL3-BEG-UNLOAD-DATE.                                 03070000
030600             15  HL3-BEG-UNLOAD-DATE-MM                           03080000
030700                                     PIC  X(02)    VALUE SPACES.  03090000
030800             15  FILLER              PIC  X(01)    VALUE '/'.     03100000
030900             15  HL3-BEG-UNLOAD-DATE-DD                           03110000
031000                                     PIC  X(02)    VALUE SPACES.  03120000
031100             15  FILLER              PIC  X(01)    VALUE '/'.     03130000
031200             15  HL3-BEG-UNLOAD-DATE-CC                           03140000
031300                                     PIC  X(02)    VALUE SPACES.  03150000
031400             15  HL3-BEG-UNLOAD-DATE-YY                           03160000
031500                                     PIC  X(02)    VALUE SPACES.  03170000
031600         10  FILLER                  PIC  X(03)    VALUE SPACES.  03180000
031700         10  FILLER                  PIC  X(15)    VALUE          03190000
031800             'UNLOADED DATE: '.                                   03200000
031900         10  HL3-UNLOADED-DATE.                                   03210000
032000             15  HL3-UNLOADED-DATE-MM                             03220000
032100                                     PIC  X(02)    VALUE SPACES.  03230000
032200             15  FILLER              PIC  X(01)    VALUE '/'.     03240000
032300             15  HL3-UNLOADED-DATE-DD                             03250000
032400                                     PIC  X(02)    VALUE SPACES.  03260000
032500             15  FILLER              PIC  X(01)    VALUE '/'.     03270000
032600             15  HL3-UNLOADED-DATE-CC                             03280000
032700                                     PIC  X(02)    VALUE SPACES.  03290000
032800             15  HL3-UNLOADED-DATE-YY                             03300000
032900                                     PIC  X(02)    VALUE SPACES.  03310000
033000         10  FILLER                  PIC  X(31)    VALUE SPACES.  03320000
033100*                                                                 03330000
033200******************************************************************03340000
033300*  INCREASED THE SIZE OF AFTER THE FILLER VALUE 'LNE'  WR# 21361 *03350000
033400*   TO 22 AND REDUCED THE SIZE OF LAST FILLER TO 19.             *03360053
033500******************************************************************03370000
033600     05  HEADING-LINE-4.                                          03380000
033700         10  FILLER                  PIC  X(48)    VALUE SPACES.  03390000
033800         10  FILLER                  PIC  X(06)    VALUE          03400000
033900             'EXPTED'.                                            03410000
034000         10  FILLER                  PIC  X(04)    VALUE SPACES.  03420000
034100         10  FILLER                  PIC  X(07)    VALUE          03430000
034200             'SCAN AT'.                                           03440000
034300         10  FILLER                  PIC  X(03)    VALUE SPACES.  03450000
034400         10  FILLER                  PIC  X(03)    VALUE          03460000
034500             'STR'.                                               03470000
034600         10  FILLER                  PIC  X(03)    VALUE SPACES.  03480000
034700         10  FILLER                  PIC  X(03)    VALUE          03490000
034800             'LNE'.                                               03500000
035000         10  FILLER                  PIC  X(22)    VALUE SPACES.  03510000
035100         10  FILLER                  PIC  X(05)    VALUE          03520000
035200             'EXPTD'.                                             03530000
035300         10  FILLER                  PIC  X(05)    VALUE SPACES.  03540000
035400         10  FILLER                  PIC  X(04)    VALUE          03550000
035500             'LINE'.                                              03560000
035600         10  FILLER                  PIC  X(19)    VALUE SPACES.  03570053
035700*                                                                 03580000
035800******************************************************************03590000
035900*  ADDED NEW FILLER VALUE 'DPT CL' AND ADJUSTED THE    WR# 21361 *03600000
036000*  FILLERS.                                                      *03610000
036100******************************************************************03620000
036200     05  HEADING-LINE-5.                                          03630000
036300         10  FILLER                  PIC  X(03)    VALUE SPACES.  03640000
036400         10  FILLER                  PIC  X(11)    VALUE          03650000
036500             'PO/RECEIVER'.                                       03660000
036600         10  FILLER                  PIC  X(08)    VALUE SPACES.  03670000
036700         10  FILLER                  PIC  X(16)    VALUE          03680000
036800             'SERIAL SHIP CODE'.                                  03690000
036900         10  FILLER                  PIC  X(09)    VALUE SPACES.  03700000
037000         10  FILLER                  PIC  X(08)    VALUE          03710000
037100             'OPER UNT'.                                          03720000
037200         10  FILLER                  PIC  X(02)    VALUE SPACES.  03730000
037300         10  FILLER                  PIC  X(08)    VALUE          03740000
037400             'OPER UNT'.                                          03750000
037500         10  FILLER                  PIC  X(03)    VALUE SPACES.  03760000
037600         10  FILLER                  PIC  X(03)    VALUE          03770000
037700             'NBR'.                                               03780000
037800         10  FILLER                  PIC  X(03)    VALUE SPACES.  03790000
037900         10  FILLER                  PIC  X(03)    VALUE          03800000
038000             'NBR'.                                               03810000
038200         10  FILLER                  PIC  X(05)    VALUE SPACES.  03820000
038300         10  FILLER                  PIC  X(06)    VALUE          03830000
038400             'DPT CL'.                                            03840000
038500         10  FILLER                  PIC  X(02)    VALUE SPACES.  03850000
038600         10  FILLER                  PIC  X(03)    VALUE          03860000
038700             'SKU'.                                               03870000
038900         10  FILLER                  PIC  X(07)    VALUE SPACES.  03880000
039000         10  FILLER                  PIC  X(03)    VALUE          03890000
039100             'QTY'.                                               03900000
039200         10  FILLER                  PIC  X(04)    VALUE SPACES.  03910000
039300         10  FILLER                  PIC  X(07)    VALUE          03920000
039400             'TOT QTY'.                                           03930000
039600         10  FILLER                  PIC  X(18)    VALUE SPACES.  03940000
039700*                                                                 03950000
039800*                                                                 03960000
039900 01  MISCELLANEOUS-LINES.                                         03970000
040000     05  END-OF-REPORT-LINE.                                      03980000
040100         10  FILLER                  PIC  X(44)    VALUE SPACES.  03990000
040200         10  FILLER                  PIC  X(45)    VALUE          04000000
040300             '*******   E N D   O F   R E P O R T   *******'.     04010000
040400         10  FILLER                  PIC  X(43)    VALUE SPACES.  04020000
040500*                                                                 04030000
040600******************************************************************04040000
040700*  INCREASED THE SIZE OF DL1-SKU TO 15. REDUCED THE    WR# 21361 *04050000
040800*  SIZE OF LAST FILLER TO 15.                                    *04060000
040900******************************************************************04070000
041000 01  DETAIL-LINES.                                                04080000
041100     05  DETAIL-LINE1.                                            04090000
041200         10  FILLER                  PIC  X(03)    VALUE SPACES.  04100000
      *CLP 09/30/14                                                     04101057
041300         10  DL1-PO-RECEIVER         PIC  X(12)    VALUE SPACES.  04110057
041400         10  FILLER                  PIC  X(02)    VALUE SPACES.  04120057
041500         10  DL1-SERIAL-SHIP-CODE    PIC  X(26)    VALUE SPACES.  04130000
041600         10  FILLER                  PIC  X(04)    VALUE SPACES.  04140000
041700         10  DL1-OPER-FCLTY          PIC  X(08)    VALUE SPACES.  04150000
041800         10  FILLER                  PIC  X(02)    VALUE SPACES.  04160000
041900         10  DL1-SCAN-OPER-FCLTY     PIC  X(08)    VALUE SPACES.  04170000
042000         10  FILLER                  PIC  X(03)    VALUE SPACES.  04180000
042100         10  DL1-STORE-NBR           PIC  ZZZZ.                   04190056
042200         10  DL1-STORE-NBR-X REDEFINES                            04200000
042300             DL1-STORE-NBR           PIC  XXXX.                   04210056
042400         10  FILLER                  PIC  X(03)    VALUE SPACES.  04220000
042500         10  DL1-LINE-NBR            PIC  ZZZ9     VALUE ZERO.    04230000
042600         10  FILLER                  PIC  X(04)    VALUE SPACES.  04240000
042800         10  DL1-SKU                 PIC  X(15)    VALUE SPACES.  04250000
042900         10  FILLER                  PIC  X(02)    VALUE SPACES.  04260000
043000         10  DL1-EXPTED-QTY          PIC  ZZZZ9    VALUE ZERO.    04270000
043100         10  FILLER                  PIC  X(05)    VALUE SPACES.  04280000
043200         10  DL1-LINE-TOTAL          PIC  ZZZZZ    VALUE ZERO.    04290000
043400         10  FILLER                  PIC  X(15)    VALUE SPACES.  04300000
043500******************************************************************04310000
043600*  CHANGES MADE FOR WR# 21361 ENDS HERE.                         *04320053
043700******************************************************************04330000
043800                                                                  04340000
043900 01  EL1-ERROR-LINE-1F.                                           04350000
044000     05  FILLER                      PIC  X(02)     VALUE SPACES. 04360000
044100     05  FILLER                      PIC  X(48)     VALUE         04370000
044200         'A PROBLEM WAS ENCOUNTERED DURING THE PROCESS OF '.      04380000
044300     05  FILLER                      PIC  X(49)     VALUE         04390000
044400         'CREATING YOUR REPORTS.  YOUR REQUEST COULD NOT BE'.     04400000
044500     05  FILLER                      PIC  X(33)     VALUE         04410000
044600         ' COMPLETED.                      '.                     04420000
044700                                                                  04430000
044800 01  EL1-ERROR-LINE-1P.                                           04440000
044900     05  FILLER                      PIC  X(02)     VALUE SPACES. 04450000
045000     05  FILLER                      PIC  X(48)     VALUE         04460000
045100         'A PROBLEM WAS ENCOUNTERED DURING THE PROCESS OF '.      04470000
045200     05  FILLER                      PIC  X(49)     VALUE         04480000
045300         'CREATING YOUR REPORTS.  THIS REPORT COULD NOT BE '.     04490000
045400     05  FILLER                      PIC  X(33)     VALUE         04500000
045500         'COMPLETED.                       '.                     04510000
045600                                                                  04520000
045700 01  EL2-ERROR-LINE-2F.                                           04530000
045800     05  FILLER                      PIC  X(02)     VALUE SPACES. 04540000
045900     05  FILLER                      PIC  X(36)     VALUE         04550000
046000         'NONE OF YOUR REPORTS WERE CREATED.  '.                  04560000
046100     05  FILLER                      PIC  X(36)     VALUE         04570000
046200         'PLEASE RE-SUBMIT YOUR REQUEST AGAIN.'.                  04580000
046300     05  FILLER                      PIC  X(58)     VALUE SPACES. 04590000
046400                                                                  04600000
046500 01  EL2-ERROR-LINE-2P.                                           04610000
046600     05  FILLER                      PIC  X(02)     VALUE SPACES. 04620000
046700     05  FILLER                      PIC  X(49)     VALUE         04630000
046800         'PLEASE RE-SUBMIT A REQUEST TO CREATE THIS REPORT '.     04640000
046900     05  FILLER                      PIC  X(41)     VALUE         04650000
047000         '(YOUR OTHER REPORTS SHOULD BE CHECKED TO '.             04660000
047100     05  FILLER                      PIC  X(40)     VALUE         04670000
047200         'DETERMINE IF THEY NEED TO BE CREATED).  '.              04680000
047300                                                                  04690000
047400 01  EL3-ERROR-LINE-3.                                            04700000
047500     05  FILLER                      PIC  X(02)     VALUE SPACES. 04710000
047600     05  FILLER                      PIC  X(50)     VALUE         04720000
047700         'YOUR REQUEST WAS AS FOLLOWS:                      '.    04730000
047800     05  FILLER                      PIC  X(81)     VALUE SPACES. 04740000
047900                                                                  04750000
048000 01  EL4-ERROR-LINE-4.                                            04760000
048100     05  FILLER                      PIC  X(07)     VALUE SPACES. 04770000
048200     05  FILLER                      PIC  X(12)     VALUE         04780000
048300         'REQUESTOR:  '.                                          04790000
048400     05  EL4-REQUESTOR-ID            PIC  X(08)     VALUE SPACES. 04800000
048500     05  FILLER                      PIC  X(10)     VALUE SPACES. 04810000
048600     05  FILLER                      PIC  X(22)     VALUE         04820000
048700         'PRINTER DESTINATION:  '.                                04830000
048800     05  EL4-PRINTER-ID              PIC  X(08)     VALUE SPACES. 04840000
048900     05  FILLER                      PIC  X(65)     VALUE SPACES. 04850000
049000                                                                  04860000
049100 01  EL5-ERROR-LINE-5.                                            04870000
049200     05  FILLER                      PIC  X(07)     VALUE SPACES. 04880000
049300     05  FILLER                      PIC  X(20)     VALUE         04890000
049400         'REQUESTED REPORTS:  '.                                  04900000
049500*JPL                                                              04910000
049600     05  FILLER                      PIC  X(105)    VALUE SPACES. 04920000
049700*JPL 05  FILLER                      PIC  X(08)     VALUE         04930000
049800*JPL     'STATS   '.                                              04940000
049900*JPL 05  FILLER                      PIC  X(18)     VALUE         04950000
050000*JPL     'PO/STR WRKSHEET   '.                                    04960000
050100*JPL 05  FILLER                      PIC  X(17)     VALUE         04970000
050200*JPL     'CRTNS NOT RCVD   '.                                     04980000
050300*JPL 05  FILLER                      PIC  X(14)     VALUE         04990000
050400*JPL     'FREE ASTRAY   '.                                        05000000
050500*JPL 05  FILLER                      PIC  X(12)     VALUE         05010000
050600*JPL     'MISDIRECT   '.                                          05020000
050700*JPL 05  FILLER                      PIC  X(17)     VALUE         05030000
050800*JPL     'DUPLICATE SCAN   '.                                     05040000
050900*JPL 05  FILLER                      PIC  X(14)     VALUE         05050000
051000*JPL     'SCAN NOT FOUND'.                                        05060000
051100*JPL 05  FILLER                      PIC  X(05)     VALUE SPACES. 05070000
051200                                                                  05080000
051300 01  EL5-ERROR-LINE-5B.                                           05090000
051400     05  FILLER                      PIC  X(07)     VALUE SPACES. 05100000
051500     05  FILLER                      PIC  X(04)     VALUE SPACES. 05110000
051600     05  FILLER                      PIC  X(08)     VALUE         05120000
051700         'STATS   '.                                              05130000
051800     05  FILLER                      PIC  X(18)     VALUE         05140000
051900         'PO/STR UNT ADJ    '.                                    05150000
052000     05  FILLER                      PIC  X(17)     VALUE         05160000
052100         'CRTNS NOT RCVD   '.                                     05170000
052200     05  FILLER                      PIC  X(14)     VALUE         05180000
052300         'FREE ASTRAY   '.                                        05190000
052400     05  FILLER                      PIC  X(12)     VALUE         05200000
052500         'MISDIRECT   '.                                          05210000
052600     05  FILLER                      PIC  X(17)     VALUE         05220000
052700         'DUPLICATE SCAN   '.                                     05230000
052800     05  FILLER                      PIC  X(18)     VALUE         05240000
052900         'SCAN NOT FOUND    '.                                    05250000
053000     05  FILLER                      PIC  X(17)     VALUE         05260000
053100         'UNUSED LABELS    '.                                     05270000
053200*JPL                                                              05280000
053300*01  EL6-ERROR-LINE-6.                                            05290000
053400*    05  FILLER                      PIC  X(29)     VALUE SPACES. 05300000
053500*    05  EL6-SUKRP002-IND            PIC  X(01)     VALUE SPACES. 05310000
053600*    05  FILLER                      PIC  X(12)     VALUE SPACES. 05320000
053700*    05  EL6-SUKRP007-IND            PIC  X(01)     VALUE SPACES. 05330000
053800*    05  FILLER                      PIC  X(16)     VALUE SPACES. 05340000
053900*    05  EL6-SUKRP003-IND            PIC  X(01)     VALUE SPACES. 05350000
054000*    05  FILLER                      PIC  X(15)     VALUE SPACES. 05360000
054100*    05  EL6-SUKRP005-IND            PIC  X(01)     VALUE SPACES. 05370000
054200*    05  FILLER                      PIC  X(12)     VALUE SPACES. 05380000
054300*    05  EL6-SUKRP004-IND            PIC  X(01)     VALUE SPACES. 05390000
054400*    05  FILLER                      PIC  X(13)     VALUE SPACES. 05400000
054500*    05  EL6-SUKRP006-IND            PIC  X(01)     VALUE SPACES. 05410000
054600*    05  FILLER                      PIC  X(16)     VALUE SPACES. 05420000
054700*    05  EL6-SUKRP008-IND            PIC  X(01)     VALUE SPACES. 05430000
054800*    05  FILLER                      PIC  X(12)     VALUE SPACES. 05440000
054900                                                                  05450000
055000 01  EL6-ERROR-LINE-6B.                                           05460000
055100     05  FILLER                      PIC  X(13)     VALUE SPACES. 05470000
055200     05  EL6-SUKRP002-IND            PIC  X(01)     VALUE SPACES. 05480000
055300     05  FILLER                      PIC  X(12)     VALUE SPACES. 05490000
055400     05  EL6-SUKRP007-IND            PIC  X(01)     VALUE SPACES. 05500000
055500     05  FILLER                      PIC  X(16)     VALUE SPACES. 05510000
055600     05  EL6-SUKRP003-IND            PIC  X(01)     VALUE SPACES. 05520000
055700     05  FILLER                      PIC  X(15)     VALUE SPACES. 05530000
055800     05  EL6-SUKRP005-IND            PIC  X(01)     VALUE SPACES. 05540000
055900     05  FILLER                      PIC  X(12)     VALUE SPACES. 05550000
056000     05  EL6-SUKRP004-IND            PIC  X(01)     VALUE SPACES. 05560000
056100     05  FILLER                      PIC  X(13)     VALUE SPACES. 05570000
056200     05  EL6-SUKRP006-IND            PIC  X(01)     VALUE SPACES. 05580000
056300     05  FILLER                      PIC  X(16)     VALUE SPACES. 05590000
056400     05  EL6-SUKRP008-IND            PIC  X(01)     VALUE SPACES. 05600000
056500     05  FILLER                      PIC  X(17)     VALUE SPACES. 05610000
056600*JPL                                                              05620000
056700     05  EL6-SUKRP023-IND            PIC  X(01)     VALUE SPACES. 05630000
056800     05  FILLER                      PIC  X(10)     VALUE SPACES. 05640000
056900                                                                  05650000
057000*                                                                 05660000
057100*  COPY BOOK FOR SHIPMENT UNIT/UPC ASSOCIATION                    05670000
057200*                                                                 05680000
057300     EXEC SQL                                                     05690000
057400          INCLUDE TSHUUPC                                         05700000
057500     END-EXEC.                                                    05710000
057600*                                                                 05720000
057700*  COPY BOOK FOR PACKSLIP TABLE                                   05730000
057800*                                                                 05740000
057900     EXEC SQL                                                     05750000
058000          INCLUDE TPKSLIP                                         05760000
058100     END-EXEC.                                                    05770000
058200*                                                                 05780000
058300*  COPY BOOK FOR INBOUND EDI PACKSLIP/VENDOR SHIPMENT UNIT ASSOC T05790000
058400*                                                                 05800000
058500     EXEC SQL                                                     05810000
058600          INCLUDE TINPKSU                                         05820000
058700     END-EXEC.                                                    05830000
058800*                                                                 05840000
058900*  COPY BOOK FOR SHIPMENT UNIT TABLE                              05850000
059000*                                                                 05860000
059100     EXEC SQL                                                     05870000
059200          INCLUDE TSHPUNT                                         05880000
059300     END-EXEC.                                                    05890000
059400*                                                                 05900000
059500*  COPY BOOK FOR SHIPMENT UNIT LOCATION                           05910000
059600*                                                                 05920000
059700     EXEC SQL                                                     05930000
059800          INCLUDE TSHUNLO                                         05940000
059900     END-EXEC.                                                    05950000
060600*                                                                 05960000
060700*  COPY BOOK FOR SHIPMENT TABLE                                   05970000
060800*                                                                 05980000
060900     EXEC SQL                                                     05990000
061000          INCLUDE TSHIPMT                                         06000000
061100     END-EXEC.                                                    06010000
061200******************************************************************06020000
061300*  REMOVED REFERENCES OF TSK AND TUPCSKU TABLE.        WR# 21361 *06030000
061400******************************************************************06040000
062700******************************************************************06050000
062800*  ADDED DCLGEN FOR XLV_UPC.                           WR# 21361 *06060000
062900******************************************************************06070000
063000     EXEC SQL                                                     06080000
063100          INCLUDE XLV00003                                        06090000
063200     END-EXEC.                                                    06100000
063300******************************************************************06110000
063400*  ADDED DCLGEN FOR XLT_SKU.                           WR# 21361 *06120054
063500******************************************************************06130000
063600     EXEC SQL                                                     06140000
063700          INCLUDE XLT00003                                        06150000
063800     END-EXEC.                                                    06160000
063900******************************************************************06170000
064000*  ADDED DCLGEN FOR XLT_VND_STYL.                      WR# 21361 *06180054
064100******************************************************************06190000
064200     EXEC SQL                                                     06200000
064300          INCLUDE XLT00004                                        06210000
064400     END-EXEC.                                                    06220000
064500******************************************************************06230000
064600*  CHANGES MADE FOR WR# 21361 ENDS HERE.                         *06240053
064700******************************************************************06250000
064800*                                                                 06260000
064900*  COPY BOOK FOR THE VEHICLE TRIP TABLE                           06270000
065000*                                                                 06280000
065100     EXEC SQL                                                     06290000
065200          INCLUDE TVHTRIP                                         06300000
065300     END-EXEC.                                                    06310000
065400*                                                                 06320000
065500*  COPY BOOK FOR TRIP STATUS TABLE                                06330000
065600*                                                                 06340000
065700     EXEC SQL                                                     06350000
065800          INCLUDE TTRIPST                                         06360000
065900     END-EXEC.                                                    06370000
066000*                                                                 06380000
066100*  COPY BOOK FOR TRIP STATUS TYPE TABLE                           06390000
066200*                                                                 06400000
066300     EXEC SQL                                                     06410000
066400          INCLUDE TTRSTYP                                         06420000
066500     END-EXEC.                                                    06430000
066600*                                                                 06440000
066700*  COPY BOOK FOR SHIPMENT UNIT BARCODE NUMBER                    T06450000
066800*                                                                 06460000
066900     EXEC SQL                                                     06470000
067000          INCLUDE TSULBXF                                         06480000
067100     END-EXEC.                                                    06490000
067200                                                                  06500000
067300 EJECT                                                            06510000
067400*  DB2 COMMUNICATION AREA                                         06520000
067500*                                                                 06530000
067600     EXEC SQL                                                     06540000
067700         INCLUDE SQLCA                                            06550000
067800     END-EXEC.                                                    06560000
067900 EJECT                                                            06570000
068000*  DB2 COMMUNICATION AREA2                                        06580000
068100*                                                                 06590000
068200     COPY SQLCA2.                                                 06600056
068300 EJECT                                                            06610000
068400                                                                  06620000
068500                                                                  06630000
068600     EXEC SQL                                                     06640000
068700         DECLARE SHPUNT-CSR CURSOR FOR                            06650000
068800         SELECT DISTINCT                                          06660000
068900                A.ORGN_OPER_UNT_ID                                06670000
069000              , A.ORGN_FCLTY_ID                                   06680000
069100              , B.OPER_UNT_ID                                     06690000
069200              , B.FCLTY_ID                                        06700000
069300           FROM TSHPUNT A,                                        06710000
069400                TSHUNLO B                                         06720000
069500          WHERE A.SHIPT_UNT_ID = :SHPUNT-SHIPT-UNT-ID             06730000
069600            AND A.SHIPT_UNT_ID = B.SHIPT_UNT_ID                   06740000
069700            AND B.TRIP_ID      = :SHUNLO-TRIP-ID                  06750000
069800            AND B.SCN_LOC_ID   = 'RECV'                           06760000
069900            AND B.ACTV_CDE     = 'A'                              06770000
070000     END-EXEC.                                                    06780000
070100                                                                  06790000
070200******************************************************************06800000
070300*  MODIFIED CURSOR PO-CSR TO REPLACE TSK AND TUPCSKU   WR# 21361 *06810000
070400*  TABLES WITH XLV VIEWS.                                        *06820000
070500******************************************************************06830000
070600     EXEC SQL                                                     06840000
070700          DECLARE PO-CSR CURSOR FOR                               06850000
070800         SELECT DISTINCT                                          06860000
070900                C.PO_NBR                                          06870000
071000              , C.REC_SEQ_NBR                                     06880000
071100              , B.SHIPT_UNT_ID                                    06890000
071200              , C.STR_DEST_NBR                                    06900000
071300              , C.OPER_UNT_ID                                     06910000
071400              , A.TRN_LNE_NBR                                     06920000
071800              , F.DEPT_NBR                                        06930000
071900              , F.SUB_CL_NBR                                      06940000
072000              , E.SKU_NBR                                         06950000
072100          FROM  TSHUUPC A                                         06960000
072200              , TINPKSU B                                         06970000
072300              , TPKSLIP C                                         06980000
072600              , XLV_UPC D                                         06990000
072700              , XLT_SKU E                                         07000000
072800              , XLT_VND_STYL F                                    07010000
072900          WHERE A.SHIPT_UNT_ID      = :SHPUNT-SHIPT-UNT-ID        07020000
073000            AND B.SHIPT_UNT_ID      = A.SHIPT_UNT_ID              07030000
073100            AND C.PO_NBR            = B.PO_NBR                    07040000
073200            AND C.SEQ_NBR           = B.SEQ_NBR                   07050000
073300            AND C.VER_STAT_CDE      = :PC-A                       07060000
073400            AND A.UPC_NBR           = D.UPC_NBR                   07070000
073600            AND D.INTR_UPC_ID       = E.INTR_UPC_ID               07080000
073700            AND E.STYL_ID           = F.STYL_ID                   07090000
073800       UNION                                                      07100000
073900         SELECT DISTINCT                                          07110000
074000                C.PO_NBR                                          07120000
074100              , C.REC_SEQ_NBR                                     07130000
074200              , B.SHIPT_UNT_ID                                    07140000
074300              , C.STR_DEST_NBR                                    07150000
074400              , C.OPER_UNT_ID                                     07160000
074500              , A.TRN_LNE_NBR                                     07170000
074900              , 000                                               07180000
075000              , 00                                                07190000
075100              , 00000000                                          07200000
075200          FROM  TSHUUPC A                                         07210000
075300              , TINPKSU B                                         07220000
075400              , TPKSLIP C                                         07230000
075500          WHERE A.SHIPT_UNT_ID      = :SHPUNT-SHIPT-UNT-ID        07240000
075600            AND B.SHIPT_UNT_ID      = A.SHIPT_UNT_ID              07250000
075700            AND C.PO_NBR            = B.PO_NBR                    07260000
075800            AND C.SEQ_NBR           = B.SEQ_NBR                   07270000
075900            AND C.VER_STAT_CDE      = :PC-A                       07280000
076000            AND NOT EXISTS                                        07290000
076100                (SELECT *                                         07300000
076400                  FROM  XLV_UPC D                                 07310000
076500                      , XLT_SKU E                                 07320000
076600                  WHERE A.UPC_NBR           = D.UPC_NBR           07330000
076800                    AND D.INTR_UPC_ID       = E.INTR_UPC_ID)      07340000
076900       ORDER BY 4                                                 07350000
077000              , 6                                                 07360000
077100              , 7                                                 07370000
077200              , 8                                                 07380000
077300     END-EXEC.                                                    07390000
077400******************************************************************07400000
077500*  CHANGES MADE FOR WR# 21361 ENDS HERE.                         *07410053
077600******************************************************************07420000
077700*                                                                 07430000
077800 PROCEDURE DIVISION.                                              07440000
077900*                                                                 07450000
078000 0000-MAINLINE-PROCESSING.                                        07460000
078100******************************************************************07470000
078200* THIS PARAGRAPH DRIVES THE PROGRAM.                              07480000
078300* IF CONTROL CARD DOES NOT REQUEST THIS REPORT - END PROGRAM      07490000
078400* IMMEDIATELY - DO NOT EVEN CREATE HEADINGS.                      07500000
078500******************************************************************07510000
078600     ACCEPT CC-CONTROL-CARD FROM SYSIN.                           07520000
078700     DISPLAY 'CONTROL CARD = ' CC-CONTROL-CARD.                   07530000
078800                                                                  07540000
078900     IF CC-PRINT-SUKRP004                                         07550000
079000         PERFORM 0100-INITIALIZATION                              07560000
079100         IF SU001-DETAIL-RECORD                                   07570000
079200             PERFORM 1000-PROCESS-EXTRACT-FILE                    07580000
079300             IF PS-ERROR-RECORD                                   07590000
079400                 PERFORM 7000-WRITE-ERROR-REPORT                  07600000
079500             END-IF                                               07610000
079600         ELSE                                                     07620000
079700             IF CC-PRINT-SUKRP002                                 07630000
079800             OR CC-PRINT-SUKRP003                                 07640000
079900                 CONTINUE                                         07650000
080000             ELSE                                                 07660000
080100                 PERFORM 7000-WRITE-ERROR-REPORT                  07670000
080200             END-IF                                               07680000
080300         END-IF                                                   07690000
080400         CLOSE EXTRACT-FILE                                       07700000
080500               SU-CARTON-NOT-RCVD-FILE                            07710000
080600     END-IF.                                                      07720000
080700                                                                  07730000
080800     GOBACK.                                                      07740000
080900*                                                                 07750000
081000*                                                                 07760000
081100 0100-INITIALIZATION.                                             07770000
081200******************************************************************07780000
081300**  PERFORM THE INITIAL PROCESSING FOR THE PROGRAM.               07790000
081400******************************************************************07800000
081500     ACCEPT PV-TODAYS-DATE                                        07810000
081600       FROM DATE.                                                 07820000
081700*                                                                 07830000
081800     ACCEPT PV-TODAYS-TIME                                        07840000
081900       FROM TIME.                                                 07850000
082000                                                                  07860000
082100     MOVE PC-REPORT-NBR          TO DP132O-REPORT-NUMBER.         07870000
082200     MOVE PV-TODAYS-DATE-MM      TO DP132O-RUN-MONTH.             07880000
082300     MOVE PV-TODAYS-DATE-DD      TO DP132O-RUN-DAY.               07890000
082400     MOVE PV-TODAYS-DATE-YY      TO DP132O-RUN-YEAR.              07900000
082500                                                                  07910000
082600     MOVE PV-TODAYS-TIME-HH      TO DP132O-RUN-HOUR.              07920000
082700     MOVE PV-TODAYS-TIME-MM      TO DP132O-RUN-MINUTE.            07930000
082800     MOVE PC-SUKRP004            TO DP132O-PROGRAM-NAME.          07940000
082900                                                                  07950000
083000******************************************************************07960000
083100**  CHECK PO IND ON CONTROL CARD AND MOVE DESCRIPTION TO HEADER.  07970000
083200******************************************************************07980000
083300     IF CC-PRINT-ENTIRE-TRIP                                      07990000
083400        STRING 'ENTIRE TRIP-REQUESTED BY '                        08000000
083500               CC-REQUESTOR-ID  DELIMITED BY SIZE                 08010000
083600               INTO HL1A-CC-IND-DESC                              08020000
083700     ELSE                                                         08030000
083800        STRING 'SELECTED PO''S REQUESTED BY '                     08040000
083900               CC-REQUESTOR-ID  DELIMITED BY SIZE                 08050000
084000               INTO HL1A-CC-IND-DESC.                             08060000
084100                                                                  08070000
084200     OPEN INPUT  EXTRACT-FILE                                     08080000
084300          OUTPUT SU-CARTON-NOT-RCVD-FILE.                         08090000
084400                                                                  08100000
084500     PERFORM 2200-READ-EXTRACT.                                   08110000
084600                                                                  08120000
084700     MOVE SU001-MANIFEST-NBR     TO PV-TRIP-ID                    08130000
084800                                    VHTRIP-TRIP-ID                08140000
084900                                    SHUNLO-TRIP-ID.               08150000
085000                                                                  08160000
085100     SET PS-DETAIL-RECORD        TO TRUE.                         08170000
085200                                                                  08180000
085300     PERFORM 1100-SELECT-TRAILER.                                 08190000
085400*LMM                                                              08200000
085500     IF DN-VEH-NBR = -1                                           08210000
085600        MOVE SPACES                 TO HL2-TRAILER                08220000
085700     ELSE                                                         08230000
085800        MOVE VHTRIP-OWNER-SCAC-ID   TO HL2-SCAC                   08240000
085900        MOVE PV-TRIP-ID             TO HL2-TRIP-ID                08250000
086000        MOVE VHTRIP-VEH-NBR         TO HL2-TRAILER                08260000
086100        MOVE TRIPST-TRIP-STATUS-CDE TO HL2-TRAILER-STAT           08270000
086200     END-IF.                                                      08280000
086300*                                                                 08290000
086400 1000-PROCESS-EXTRACT-FILE.                                       08300000
086500******************************************************************08310000
086600**  PERFORM THE PROCESSING FOR THE PROGRAM.                       08320000
086700******************************************************************08330000
086800     IF PS-DETAIL-RECORD                                          08340000
086900         MOVE PC-AR    TO PV-STATUS                               08350000
087000         SET PS-STATUS-NOT-FOUND TO TRUE                          08360000
087100         PERFORM 1200-SELECT-STATUS                               08370000
087200     END-IF.                                                      08380000
087300                                                                  08390000
087400     IF PS-DETAIL-RECORD                                          08400000
087500         IF PS-STATUS-FOUND                                       08410000
087600             MOVE TRIPST-STATUS-DTE   TO PV-DB2-DATE              08420000
087700             MOVE PV-DB2-DATE-CC TO HL3-ARRIVAL-DATE-CC           08430000
087800             MOVE PV-DB2-DATE-YY TO HL3-ARRIVAL-DATE-YY           08440000
087900             MOVE PV-DB2-DATE-MM TO HL3-ARRIVAL-DATE-MM           08450000
088000             MOVE PV-DB2-DATE-DD TO HL3-ARRIVAL-DATE-DD           08460000
088100         ELSE                                                     08470000
088200             MOVE PC-00          TO HL3-ARRIVAL-DATE-CC           08480000
088300             MOVE PC-00          TO HL3-ARRIVAL-DATE-YY           08490000
088400             MOVE PC-00          TO HL3-ARRIVAL-DATE-MM           08500000
088500             MOVE PC-00          TO HL3-ARRIVAL-DATE-DD           08510000
088600         END-IF                                                   08520000
088700         MOVE PC-UG    TO PV-STATUS                               08530000
088800         SET PS-STATUS-NOT-FOUND TO TRUE                          08540000
088900         PERFORM 1200-SELECT-STATUS                               08550000
089000     END-IF.                                                      08560000
089100                                                                  08570000
089200     IF PS-DETAIL-RECORD                                          08580000
089300         IF PS-STATUS-FOUND                                       08590000
089400             MOVE TRIPST-STATUS-DTE   TO PV-DB2-DATE              08600000
089500             MOVE PV-DB2-DATE-CC TO HL3-BEG-UNLOAD-DATE-CC        08610000
089600             MOVE PV-DB2-DATE-YY TO HL3-BEG-UNLOAD-DATE-YY        08620000
089700             MOVE PV-DB2-DATE-MM TO HL3-BEG-UNLOAD-DATE-MM        08630000
089800             MOVE PV-DB2-DATE-DD TO HL3-BEG-UNLOAD-DATE-DD        08640000
089900         ELSE                                                     08650000
090000             MOVE PC-00          TO HL3-BEG-UNLOAD-DATE-CC        08660000
090100             MOVE PC-00          TO HL3-BEG-UNLOAD-DATE-YY        08670000
090200             MOVE PC-00          TO HL3-BEG-UNLOAD-DATE-MM        08680000
090300             MOVE PC-00          TO HL3-BEG-UNLOAD-DATE-DD        08690000
090400         END-IF                                                   08700000
090500         MOVE PC-UN    TO PV-STATUS                               08710000
090600         SET PS-STATUS-NOT-FOUND TO TRUE                          08720000
090700         PERFORM 1200-SELECT-STATUS                               08730000
090800     END-IF.                                                      08740000
090900                                                                  08750000
091000     IF PS-DETAIL-RECORD                                          08760000
091100         IF PS-STATUS-FOUND                                       08770000
091200             MOVE TRIPST-STATUS-DTE   TO PV-DB2-DATE              08780000
091300             MOVE PV-DB2-DATE-CC TO HL3-UNLOADED-DATE-CC          08790000
091400             MOVE PV-DB2-DATE-YY TO HL3-UNLOADED-DATE-YY          08800000
091500             MOVE PV-DB2-DATE-MM TO HL3-UNLOADED-DATE-MM          08810000
091600             MOVE PV-DB2-DATE-DD TO HL3-UNLOADED-DATE-DD          08820000
091700         ELSE                                                     08830000
091800             MOVE PC-00          TO HL3-UNLOADED-DATE-CC          08840000
091900             MOVE PC-00          TO HL3-UNLOADED-DATE-YY          08850000
092000             MOVE PC-00          TO HL3-UNLOADED-DATE-MM          08860000
092100             MOVE PC-00          TO HL3-UNLOADED-DATE-DD          08870000
092200         END-IF                                                   08880000
092300         PERFORM 8000-WRITE-REPORT-HEADERS                        08890000
092400         MOVE ZERO               TO SHPUNT-SHIPT-UNT-ID           08900000
092500         PERFORM 2200-READ-EXTRACT                                08910000
092600         PERFORM 2000-PROCESS-SU                                  08920000
092700     END-IF.                                                      08930000
092800                                                                  08940000
092900     IF PS-DETAIL-RECORD                                          08950000
093000         WRITE SU-CARTON-NOT-RCVD-RECORD                          08960000
093100           FROM END-OF-REPORT-LINE                                08970000
093200             AFTER ADVANCING 2 LINES                              08980000
093300     END-IF.                                                      08990000
093400*                                                                 09000000
093500 1100-SELECT-TRAILER.                                             09010000
093600     MOVE '1100-SELECT-TRAILER '                                  09020000
093700                                 TO PV-ABEND-PARAGRAPH.           09030000
093800     EXEC SQL                                                     09040000
093900       SELECT A.OWNER_SCAC_ID                                     09050000
094000             ,A.VEH_NBR                                           09060000
094100             ,B.TRIP_STATUS_CDE                                   09070000
094200       INTO  :VHTRIP-OWNER-SCAC-ID                                09080000
094300            ,:VHTRIP-VEH-NBR :DN-VEH-NBR                          09090000
094400            ,:TRIPST-TRIP-STATUS-CDE                              09100000
094500       FROM   TVHTRIP A                                           09110000
094600             ,TTRIPST B                                           09120000
094700             ,TTRSTYP C                                           09130000
094800       WHERE  A.TRIP_ID          = :VHTRIP-TRIP-ID                09140000
094900         AND  B.TRIP_STATUS_CDE ^= 'DE'                           09150000
095000         AND  C.PRTY_CDE =                                        09160000
095100              (SELECT MAX(E.PRTY_CDE)                             09170000
095200                 FROM TTRIPST D                                   09180000
095300                     ,TTRSTYP E                                   09190000
095400                WHERE D.TRIP_ID         = A.TRIP_ID               09200000
095500                  AND D.TRIP_STATUS_CDE = E.TRIP_STATUS_CDE)      09210000
095600         AND  A.TRIP_ID         = B.TRIP_ID                       09220000
095700         AND  B.TRIP_STATUS_CDE = C.TRIP_STATUS_CDE               09230000
095800     END-EXEC.                                                    09240000
095900                                                                  09250000
096000     EVALUATE TRUE                                                09260000
096100       WHEN SQLCODE = ZEROS                                       09270000
096200         CONTINUE                                                 09280000
096300       WHEN SQLCODE = +100                                        09290000
096400         MOVE SPACES TO VHTRIP-OWNER-SCAC-ID                      09300000
096500                        VHTRIP-VEH-NBR                            09310000
096600                        TRIPST-TRIP-STATUS-CDE                    09320000
096700       WHEN SQLCODE = -904                                        09330000
096800       WHEN SQLCODE = -911                                        09340000
096900       WHEN SQLCODE = -913                                        09350000
097000         SET PS-ERROR-RECORD TO TRUE                              09360000
097100         MOVE SPACES TO VHTRIP-OWNER-SCAC-ID                      09370000
097200                        VHTRIP-VEH-NBR                            09380000
097300                        TRIPST-TRIP-STATUS-CDE                    09390000
097400       WHEN OTHER                                                 09400000
097500         DISPLAY PV-ABEND-PARAGRAPH                               09410000
097600         PERFORM Z999-SQL-ERROR                                   09420000
097700     END-EVALUATE.                                                09430000
097800                                                                  09440000
097900 1200-SELECT-STATUS.                                              09450000
098000     MOVE '1200-SELECT-STATUS  '                                  09460000
098100                                 TO PV-ABEND-PARAGRAPH.           09470000
098200     EXEC SQL                                                     09480000
098300       SELECT STATUS_DTE                                          09490000
098400       INTO  :TRIPST-STATUS-DTE                                   09500000
098500       FROM   TTRIPST                                             09510000
098600       WHERE  TRIP_ID            = :VHTRIP-TRIP-ID                09520000
098700         AND  TRIP_STATUS_CDE    = :PV-STATUS                     09530000
098800     END-EXEC.                                                    09540000
098900                                                                  09550000
099000     EVALUATE TRUE                                                09560000
099100       WHEN SQLCODE = ZEROS                                       09570000
099200         SET PS-STATUS-FOUND TO TRUE                              09580000
099300       WHEN SQLCODE = +100                                        09590000
099400         SET PS-STATUS-NOT-FOUND TO TRUE                          09600000
099500       WHEN SQLCODE = -904                                        09610000
099600       WHEN SQLCODE = -911                                        09620000
099700       WHEN SQLCODE = -913                                        09630000
099800         SET PS-ERROR-RECORD TO TRUE                              09640000
099900       WHEN OTHER                                                 09650000
100000         DISPLAY PV-ABEND-PARAGRAPH                               09660000
100100         PERFORM Z999-SQL-ERROR                                   09670000
100200     END-EVALUATE.                                                09680000
100300                                                                  09690000
100400*                                                                 09700000
100500 2000-PROCESS-SU.                                                 09710000
100600******************************************************************09720000
100700*  THIS IS THE MAIN CONTROLLING PARAGRAPH FOR PROCESSING THE     *09730000
100800*  CARTONS NOT RECEIVED REPORT.                                  *09740000
100900******************************************************************09750000
101000     PERFORM 2100-PROCESS-EXTRACT                                 09760000
101100         UNTIL PS-END-OF-EXTRACT                                  09770000
101200            OR PS-ERROR-RECORD.                                   09780000
101300                                                                  09790000
101400 2100-PROCESS-EXTRACT.                                            09800000
101500     IF SU001-MISDIRECT-IND = PC-Y AND                            09810000
101600         SU001-SHIPT-UNT-ID NOT =  SHPUNT-SHIPT-UNT-ID            09820000
101700         PERFORM 2300-PROCESS-CURSOR                              09830000
101800     END-IF.                                                      09840000
101900                                                                  09850000
102000     IF PS-DETAIL-RECORD                                          09860000
102100         PERFORM 2200-READ-EXTRACT                                09870000
102200     END-IF.                                                      09880000
102300                                                                  09890000
102400 2200-READ-EXTRACT.                                               09900000
102500     READ EXTRACT-FILE INTO SU001-EXTRACT-RECORD                  09910000
102600        AT END                                                    09920000
102700           SET PS-END-OF-EXTRACT TO TRUE.                         09930000
102800                                                                  09940000
102900 2300-PROCESS-CURSOR.                                             09950000
103000     SET PS-NOT-END-OF-PO-CURSOR TO TRUE.                         09960000
103100     SET PS-NOT-END-OF-SHPUNT-CSR TO TRUE.                        09970000
103200     MOVE SU001-SHIPT-UNT-ID TO SHPUNT-SHIPT-UNT-ID.              09980000
103300     PERFORM 2400-OPEN-SHPUNT-CSR.                                09990000
103400                                                                  10000000
103500     IF PS-DETAIL-RECORD                                          10010000
103600         PERFORM 2500-FETCH-SHPUNT-CSR                            10020000
103700     END-IF.                                                      10030000
103800                                                                  10040000
103900     PERFORM 2550-PROCESS-SHPUNT-CSR                              10050000
104000         UNTIL PS-END-OF-SHPUNT-CSR                               10060000
104100            OR PS-ERROR-RECORD.                                   10070000
104200                                                                  10080000
104300     IF PS-DETAIL-RECORD                                          10090000
104400         PERFORM 2570-CLOSE-SHPUNT-CURSOR                         10100000
104500     END-IF.                                                      10110000
104600                                                                  10120000
104700 2400-OPEN-SHPUNT-CSR.                                            10130000
104800     MOVE '2400-OPEN-SHPUNT-CSR  '                                10140000
104900                                 TO PV-ABEND-PARAGRAPH.           10150000
105000     EXEC SQL                                                     10160000
105100         OPEN SHPUNT-CSR                                          10170000
105200     END-EXEC.                                                    10180000
105300     EVALUATE TRUE                                                10190000
105400       WHEN SQLCODE = ZEROS                                       10200000
105500         CONTINUE                                                 10210000
105600       WHEN SQLCODE = -904                                        10220000
105700       WHEN SQLCODE = -911                                        10230000
105800       WHEN SQLCODE = -913                                        10240000
105900         SET PS-ERROR-RECORD TO TRUE                              10250000
106000       WHEN OTHER                                                 10260000
106100         DISPLAY PV-ABEND-PARAGRAPH                               10270000
106200         PERFORM Z999-SQL-ERROR                                   10280000
106300     END-EVALUATE.                                                10290000
106400                                                                  10300000
106500 2500-FETCH-SHPUNT-CSR.                                           10310000
106600     MOVE '2500-FETCH-SHPUNT-CSR'                                 10320000
106700                                 TO PV-ABEND-PARAGRAPH.           10330000
106800                                                                  10340000
106900     EXEC SQL                                                     10350000
107000         FETCH SHPUNT-CSR                                         10360000
107100           INTO :SHPUNT-ORGN-OPER-UNT-ID                          10370000
107200              , :SHPUNT-ORGN-FCLTY-ID                             10380000
107300              , :SHUNLO-OPER-UNT-ID                               10390000
107400              , :SHUNLO-FCLTY-ID                                  10400000
107500     END-EXEC.                                                    10410000
107600                                                                  10420000
107700     EVALUATE TRUE                                                10430000
107800       WHEN SQLCODE = ZEROS                                       10440000
107900         CONTINUE                                                 10450000
108000       WHEN SQLCODE = +100                                        10460000
108100           SET PS-END-OF-SHPUNT-CSR TO TRUE                       10470000
108200       WHEN SQLCODE = -904                                        10480000
108300       WHEN SQLCODE = -911                                        10490000
108400       WHEN SQLCODE = -913                                        10500000
108500         SET PS-ERROR-RECORD TO TRUE                              10510000
108600       WHEN OTHER                                                 10520000
108700         DISPLAY PV-ABEND-PARAGRAPH                               10530000
108800         PERFORM Z999-SQL-ERROR                                   10540000
108900     END-EVALUATE.                                                10550000
109000                                                                  10560000
109100 2550-PROCESS-SHPUNT-CSR.                                         10570000
109200     PERFORM 2600-OPEN-PO-CURSOR.                                 10580000
109300                                                                  10590000
109400     IF PS-DETAIL-RECORD                                          10600000
109500         PERFORM 2700-FETCH-PO                                    10610000
109600     END-IF.                                                      10620000
109700                                                                  10630000
109800     PERFORM 2800-PROCESS-PO                                      10640000
109900         UNTIL PS-END-OF-PO-CURSOR                                10650000
110000            OR PS-ERROR-RECORD.                                   10660000
110100                                                                  10670000
110200     IF PS-DETAIL-RECORD                                          10680000
110300         PERFORM 2900-CLOSE-PO-CURSOR                             10690000
110400     END-IF.                                                      10700000
110500                                                                  10710000
110600     IF PS-DETAIL-RECORD                                          10720000
110700         PERFORM 2500-FETCH-SHPUNT-CSR                            10730000
110800     END-IF.                                                      10740000
110900                                                                  10750000
111000 2570-CLOSE-SHPUNT-CURSOR.                                        10760000
111100     MOVE '2570-CLOSE-SHPUNT-CURSOR   '                           10770000
111200                                 TO PV-ABEND-PARAGRAPH.           10780000
111300     EXEC SQL                                                     10790000
111400         CLOSE SHPUNT-CSR                                         10800000
111500     END-EXEC.                                                    10810000
111600     EVALUATE TRUE                                                10820000
111700       WHEN SQLCODE = ZEROS                                       10830000
111800         CONTINUE                                                 10840000
111900       WHEN SQLCODE = -904                                        10850000
112000       WHEN SQLCODE = -911                                        10860000
112100       WHEN SQLCODE = -913                                        10870000
112200         SET PS-ERROR-RECORD TO TRUE                              10880000
112300       WHEN OTHER                                                 10890000
112400         DISPLAY PV-ABEND-PARAGRAPH                               10900000
112500         PERFORM Z999-SQL-ERROR                                   10910000
112600     END-EVALUATE.                                                10920000
112700                                                                  10930000
112800 2600-OPEN-PO-CURSOR.                                             10940000
112900     MOVE '2600-OPEN-PO-CURSOR   '                                10950000
113000                                 TO PV-ABEND-PARAGRAPH.           10960000
113100     EXEC SQL                                                     10970000
113200         OPEN PO-CSR                                              10980000
113300     END-EXEC.                                                    10990000
113400     EVALUATE TRUE                                                11000000
113500       WHEN SQLCODE = ZEROS                                       11010000
113600         CONTINUE                                                 11020000
113700       WHEN SQLCODE = -904                                        11030000
113800       WHEN SQLCODE = -911                                        11040000
113900       WHEN SQLCODE = -913                                        11050000
114000         SET PS-ERROR-RECORD TO TRUE                              11060000
114100       WHEN OTHER                                                 11070000
114200         DISPLAY PV-ABEND-PARAGRAPH                               11080000
114300         PERFORM Z999-SQL-ERROR                                   11090000
114400     END-EVALUATE.                                                11100000
114500                                                                  11110000
114600 2700-FETCH-PO.                                                   11120000
114700     MOVE '2700-FETCH-PO   '                                      11130000
114800                                 TO PV-ABEND-PARAGRAPH.           11140000
114900                                                                  11150000
115000******************************************************************11160000
115100*  MODIFIED FETCH SQL TO REPLACE TSK VARIABLE WITH     WR# 21361 *11170000
115200*  XLV VIEWS VARIABLES.                                          *11180000
115300******************************************************************11190000
115400     EXEC SQL                                                     11200000
115500         FETCH PO-CSR                                             11210000
115600          INTO  :PKSLIP-PO-NBR                                    11220000
115700              , :PKSLIP-REC-SEQ-NBR                               11230000
115800              , :INPKSU-SHIPT-UNT-ID                              11240000
115900              , :PKSLIP-STR-DEST-NBR                              11250000
116000              , :PKSLIP-OPER-UNT-ID                               11260000
116100              , :SHUUPC-TRN-LNE-NBR                               11270000
116500              , :XLT00004-DEPT-NBR                                11280000
116600              , :XLT00004-SUB-CL-NBR                              11290000
116700              , :XLT00003-SKU-NBR                                 11300000
116800     END-EXEC.                                                    11310000
116900******************************************************************11320000
117000*  CHANGES MADE FOR WR# 21361 ENDS HERE.                         *11330053
117100******************************************************************11340000
117200                                                                  11350000
117300     EVALUATE TRUE                                                11360000
117400       WHEN SQLCODE = ZEROS                                       11370000
117500         CONTINUE                                                 11380000
117600       WHEN SQLCODE = +100                                        11390000
117700           SET PS-END-OF-PO-CURSOR TO TRUE                        11400000
117800       WHEN SQLCODE = -904                                        11410000
117900       WHEN SQLCODE = -911                                        11420000
118000       WHEN SQLCODE = -913                                        11430000
118100         SET PS-ERROR-RECORD TO TRUE                              11440000
118200       WHEN OTHER                                                 11450000
118300         DISPLAY PV-ABEND-PARAGRAPH                               11460000
118400         PERFORM Z999-SQL-ERROR                                   11470000
118500     END-EVALUATE.                                                11480000
118600                                                                  11490000
118700 2710-GET-SHPD-QTY.                                               11500000
118800     MOVE '2710-GET-SHPD-QTY'                                     11510000
118900                                 TO PV-ABEND-PARAGRAPH.           11520000
119000                                                                  11530000
119100     EXEC SQL                                                     11540000
119200         SELECT SUM(SHPD_QTY)                                     11550000
119300         INTO   :SHUUPC-SHPD-QTY                                  11560000
119400         FROM   TSHUUPC                                           11570000
119500         WHERE  SHIPT_UNT_ID       = :SHPUNT-SHIPT-UNT-ID         11580000
119600          AND   TRN_LNE_NBR        = :SHUUPC-TRN-LNE-NBR          11590000
119700     END-EXEC.                                                    11600000
119800                                                                  11610000
119900     EVALUATE TRUE                                                11620000
120000       WHEN SQLCODE = ZEROS                                       11630000
120100           MOVE SHUUPC-SHPD-QTY TO PV-EXPTED-QTY                  11640000
120200       WHEN SQLCODE = +100                                        11650000
120300           MOVE ZEROES TO PV-EXPTED-QTY                           11660000
120400       WHEN SQLCODE = -904                                        11670000
120500       WHEN SQLCODE = -911                                        11680000
120600       WHEN SQLCODE = -913                                        11690000
120700         SET PS-ERROR-RECORD TO TRUE                              11700000
120800       WHEN OTHER                                                 11710000
120900         DISPLAY PV-ABEND-PARAGRAPH                               11720000
121000         PERFORM Z999-SQL-ERROR                                   11730000
121100     END-EVALUATE.                                                11740000
121200                                                                  11750000
121300 2800-PROCESS-PO.                                                 11760000
121400     MOVE PKSLIP-PO-NBR          TO PV-PO.                        11770000
121500     MOVE PKSLIP-REC-SEQ-NBR     TO PV-RECEIVER.                  11780000
121600     MOVE PV-PO-RECEIVER         TO DL1-PO-RECEIVER.              11790000
121700     MOVE INPKSU-SHIPT-UNT-ID    TO PV-SERIAL-SHIP-CODE.          11800000
121800     MOVE PV-SERIAL-SHIP-CODE-1    TO PV-OUT-S-S-C-1.             11810000
121900     MOVE PV-SERIAL-SHIP-CODE-2-8  TO PV-OUT-S-S-C-2-8.           11820000
122000     MOVE PV-SERIAL-SHIP-CODE-9-17 TO PV-OUT-S-S-C-9-17.          11830000
122100     MOVE PV-SERIAL-SHIP-CODE-18   TO PV-OUT-S-S-C-18.            11840000
122200     MOVE PV-OUT-SERIAL-SHIP-CODE TO DL1-SERIAL-SHIP-CODE.        11850000
122300     MOVE SHPUNT-ORGN-OPER-UNT-ID TO PV-OPER-UNT.                 11860000
122400     MOVE SHPUNT-ORGN-FCLTY-ID    TO PV-FCLTY-ID.                 11870000
122500     MOVE PV-OPER-FCLTY           TO DL1-OPER-FCLTY.              11880000
122600     MOVE SHUNLO-OPER-UNT-ID      TO PV-OPER-UNT.                 11890000
122700     MOVE SHUNLO-FCLTY-ID         TO PV-FCLTY-ID.                 11900000
122800     MOVE PV-OPER-FCLTY           TO DL1-SCAN-OPER-FCLTY.         11910000
122900     MOVE SPACES                  TO DL1-STORE-NBR-X.             11920000
123000     PERFORM 3000-SELECT-DEST.                                    11930000
123100     IF SQLCODE = +100                                            11940000
123200         IF PKSLIP-STR-DEST-NBR > ZERO                            11950000
123300             MOVE PKSLIP-STR-DEST-NBR    TO DL1-STORE-NBR         11960000
123400         ELSE                                                     11970000
123500             MOVE PKSLIP-OPER-UNT-ID     TO DL1-STORE-NBR         11980000
123600         END-IF                                                   11990000
123700     ELSE                                                         12000000
123800         IF SQLCODE = -811                                        12010000
123900             MOVE PC-MLT                 TO DL1-STORE-NBR-X       12020000
124000         ELSE                                                     12030000
124100             MOVE SULBXF-DEST-OPER-UNT-ID                         12040000
124200                                         TO DL1-STORE-NBR         12050000
124300         END-IF                                                   12060000
124400     END-IF.                                                      12070000
124500     MOVE SHUUPC-TRN-LNE-NBR     TO DL1-LINE-NBR                  12080000
124600                                    PV-LINE-NBR.                  12090000
124700******************************************************************12100000
124800*  REPLACE TSK VARIABLE WITH XLV VIEWS VARIABLES AND   WR# 21361 *12110000
124900*  REPLACE PV-SKU-SEQ WITH PV-SKU-NBR.                           *12120000
125000******************************************************************12130000
125500     IF XLT00004-DEPT-NBR = ZEROS                                 12140000
125600         MOVE PC-NO-SKU            TO DL1-SKU                     12150000
125700     ELSE                                                         12160000
126100         MOVE XLT00004-DEPT-NBR    TO PV-SKU-DEPT                 12170000
126200         MOVE XLT00004-SUB-CL-NBR  TO PV-SKU-CLASS                12180000
126300         MOVE XLT00003-SKU-NBR     TO PV-SKU-NBR                  12190000
126400         MOVE PV-SKU               TO DL1-SKU                     12200000
126500     END-IF.                                                      12210000
126600******************************************************************12220000
126700*  CHANGES MADE FOR WR# 21361 ENDS HERE.                         *12230053
126800******************************************************************12240000
126900                                                                  12250000
127000     PERFORM 2710-GET-SHPD-QTY.                                   12260000
127100                                                                  12270000
127200     IF PS-DETAIL-RECORD                                          12280000
127300         MOVE PV-EXPTED-QTY      TO DL1-EXPTED-QTY                12290000
127400                                    DL1-LINE-TOTAL                12300000
127500         IF PV-LINE-CNT > PC-60                                   12310000
127600              PERFORM 8000-WRITE-REPORT-HEADERS                   12320000
127700         END-IF                                                   12330000
127800         PERFORM 8400-WRITE-DETAIL-LINES                          12340000
127900         PERFORM 2700-FETCH-PO                                    12350000
128000     END-IF.                                                      12360000
128100                                                                  12370000
128200 2900-CLOSE-PO-CURSOR.                                            12380000
128300     MOVE '2900-CLOSE-PO-CURSOR   '                               12390000
128400                                 TO PV-ABEND-PARAGRAPH.           12400000
128500     EXEC SQL                                                     12410000
128600         CLOSE PO-CSR                                             12420000
128700     END-EXEC.                                                    12430000
128800     EVALUATE TRUE                                                12440000
128900       WHEN SQLCODE = ZEROS                                       12450000
129000         CONTINUE                                                 12460000
129100       WHEN SQLCODE = -904                                        12470000
129200       WHEN SQLCODE = -911                                        12480000
129300       WHEN SQLCODE = -913                                        12490000
129400         SET PS-ERROR-RECORD TO TRUE                              12500000
129500       WHEN OTHER                                                 12510000
129600         DISPLAY PV-ABEND-PARAGRAPH                               12520000
129700         PERFORM Z999-SQL-ERROR                                   12530000
129800     END-EVALUATE.                                                12540000
129900                                                                  12550000
130000 3000-SELECT-DEST.                                                12560000
130100     MOVE '3000-SELECT-DEST    '                                  12570000
130200                                 TO PV-ABEND-PARAGRAPH.           12580000
130300     EXEC SQL                                                     12590000
130400       SELECT DISTINCT                                            12600000
130500              DEST_OPER_UNT_ID                                    12610000
130600       INTO  :SULBXF-DEST-OPER-UNT-ID                             12620000
130700       FROM   TSULBXF                                             12630000
130800       WHERE  SHIPT_UNT_ID       = :INPKSU-SHIPT-UNT-ID           12640000
130900         AND  STAT_CDE           = :PC-A                          12650000
131000     END-EXEC.                                                    12660000
131100                                                                  12670000
131200     EVALUATE TRUE                                                12680000
131300       WHEN SQLCODE = ZEROS                                       12690000
131400       WHEN SQLCODE = +100                                        12700000
131500       WHEN SQLCODE = -811                                        12710000
131600         CONTINUE                                                 12720000
131700       WHEN SQLCODE = -904                                        12730000
131800       WHEN SQLCODE = -911                                        12740000
131900       WHEN SQLCODE = -913                                        12750000
132000         SET PS-ERROR-RECORD TO TRUE                              12760000
132100       WHEN OTHER                                                 12770000
132200         DISPLAY PV-ABEND-PARAGRAPH                               12780000
132300         PERFORM Z999-SQL-ERROR                                   12790000
132400     END-EVALUATE.                                                12800000
132500                                                                  12810000
132600*                                                                 12820000
132700 7000-WRITE-ERROR-REPORT.                                         12830000
132800******************************************************************12840000
132900*  PRINT THE ERROR REPORT WHEN THE EXTRACT FILE HAS AN ERROR REC *12850000
133000******************************************************************12860000
133100     PERFORM 8200-WRITE-TOP-LINE.                                 12870000
133200*                                                                 12880000
133300     WRITE SU-CARTON-NOT-RCVD-RECORD                              12890000
133400       FROM HEADING-LINE-0                                        12900000
133500         AFTER ADVANCING 1 LINE.                                  12910000
133600*                                                                 12920000
133700     WRITE SU-CARTON-NOT-RCVD-RECORD                              12930000
133800       FROM HEADING-LINE-1                                        12940000
133900         AFTER ADVANCING 1 LINE.                                  12950000
134000*                                                                 12960000
134100     WRITE SU-CARTON-NOT-RCVD-RECORD                              12970000
134200       FROM HEADING-LINE-1A                                       12980000
134300         AFTER ADVANCING 1 LINE.                                  12990000
134400*                                                                 13000000
134500     WRITE SU-CARTON-NOT-RCVD-RECORD                              13010000
134600       FROM HEADING-LINE-1B                                       13020000
134700         AFTER ADVANCING 1 LINE.                                  13030000
134800*                                                                 13040000
134900     WRITE SU-CARTON-NOT-RCVD-RECORD                              13050000
135000       FROM HEADING-LINE-2                                        13060000
135100         AFTER ADVANCING 4 LINES.                                 13070000
135200*                                                                 13080000
135300     IF SU001-DETAIL-RECORD                                       13090000
135400         WRITE SU-CARTON-NOT-RCVD-RECORD                          13100000
135500           FROM EL1-ERROR-LINE-1P                                 13110000
135600             AFTER ADVANCING 3 LINES                              13120000
135700                                                                  13130000
135800         WRITE SU-CARTON-NOT-RCVD-RECORD                          13140000
135900           FROM EL2-ERROR-LINE-2P                                 13150000
136000             AFTER ADVANCING 2 LINES                              13160000
136100     ELSE                                                         13170000
136200         WRITE SU-CARTON-NOT-RCVD-RECORD                          13180000
136300           FROM EL1-ERROR-LINE-1F                                 13190000
136400             AFTER ADVANCING 3 LINES                              13200000
136500                                                                  13210000
136600         WRITE SU-CARTON-NOT-RCVD-RECORD                          13220000
136700           FROM EL2-ERROR-LINE-2F                                 13230000
136800             AFTER ADVANCING 2 LINES                              13240000
136900     END-IF.                                                      13250000
137000*                                                                 13260000
137100     WRITE SU-CARTON-NOT-RCVD-RECORD                              13270000
137200       FROM EL3-ERROR-LINE-3                                      13280000
137300         AFTER ADVANCING 2 LINES.                                 13290000
137400*                                                                 13300000
137500     MOVE CC-REQUESTOR-ID TO EL4-REQUESTOR-ID                     13310000
137600     MOVE CC-PRINTER-ID   TO EL4-PRINTER-ID.                      13320000
137700     WRITE SU-CARTON-NOT-RCVD-RECORD                              13330000
137800       FROM EL4-ERROR-LINE-4                                      13340000
137900         AFTER ADVANCING 3 LINES.                                 13350000
138000*                                                                 13360000
138100     WRITE SU-CARTON-NOT-RCVD-RECORD                              13370000
138200       FROM EL5-ERROR-LINE-5                                      13380000
138300         AFTER ADVANCING 2 LINE.                                  13390000
138400*JPL                                                              13400000
138500     WRITE SU-CARTON-NOT-RCVD-RECORD                              13410000
138600       FROM EL5-ERROR-LINE-5B                                     13420000
138700         AFTER ADVANCING 2 LINE.                                  13430000
138800*                                                                 13440000
138900     MOVE CC-PRINT-SUKRP002-IND TO EL6-SUKRP002-IND.              13450000
139000     MOVE CC-PRINT-SUKRP003-IND TO EL6-SUKRP003-IND.              13460000
139100     MOVE CC-PRINT-SUKRP004-IND TO EL6-SUKRP004-IND.              13470000
139200     MOVE CC-PRINT-SUKRP005-IND TO EL6-SUKRP005-IND.              13480000
139300     MOVE CC-PRINT-SUKRP006-IND TO EL6-SUKRP006-IND.              13490000
139400     MOVE CC-PRINT-SUKRP007-IND TO EL6-SUKRP007-IND.              13500000
139500     MOVE CC-PRINT-SUKRP008-IND TO EL6-SUKRP008-IND.              13510000
139600*JPL                                                              13520000
139700     MOVE CC-PRINT-SUKRP023-IND TO EL6-SUKRP023-IND.              13530000
139800                                                                  13540000
139900*JPL WRITE SU-CARTON-NOT-RCVD-RECORD                              13550000
140000*JPL   FROM EL6-ERROR-LINE-6                                      13560000
140100*JPL     AFTER ADVANCING 1 LINE.                                  13570000
140200*JPL                                                              13580000
140300     WRITE SU-CARTON-NOT-RCVD-RECORD                              13590000
140400       FROM EL6-ERROR-LINE-6B                                     13600000
140500         AFTER ADVANCING 1 LINE.                                  13610000
140600*                                                                 13620000
140700     WRITE SU-CARTON-NOT-RCVD-RECORD                              13630000
140800       FROM END-OF-REPORT-LINE                                    13640000
140900         AFTER ADVANCING 6 LINES.                                 13650000
141000*                                                                 13660000
141100 8000-WRITE-REPORT-HEADERS.                                       13670000
141200******************************************************************13680000
141300*  PRINT THE HEADING FOR THE FIRST PAGE OF AN ASN.  SEBSEQUENT   *13690000
141400*  PAGES FOR THE SAME ASN DO NOT REPEAT ALL OF THE HEADING INFO. *13700000
141500******************************************************************13710000
141600     PERFORM 8200-WRITE-TOP-LINE.                                 13720000
141700*                                                                 13730000
141800     WRITE SU-CARTON-NOT-RCVD-RECORD                              13740000
141900       FROM HEADING-LINE-0                                        13750000
142000         AFTER ADVANCING 1 LINE.                                  13760000
142100*                                                                 13770000
142200     WRITE SU-CARTON-NOT-RCVD-RECORD                              13780000
142300       FROM HEADING-LINE-1                                        13790000
142400         AFTER ADVANCING 1 LINE.                                  13800000
142500*                                                                 13810000
142600     WRITE SU-CARTON-NOT-RCVD-RECORD                              13820000
142700       FROM HEADING-LINE-1A                                       13830000
142800         AFTER ADVANCING 1 LINE.                                  13840000
142900*                                                                 13850000
143000     WRITE SU-CARTON-NOT-RCVD-RECORD                              13860000
143100       FROM HEADING-LINE-1B                                       13870000
143200         AFTER ADVANCING 1 LINE.                                  13880000
143300*                                                                 13890000
143400     WRITE SU-CARTON-NOT-RCVD-RECORD                              13900000
143500       FROM HEADING-LINE-2                                        13910000
143600         AFTER ADVANCING 1 LINES.                                 13920000
143700*                                                                 13930000
143800     WRITE SU-CARTON-NOT-RCVD-RECORD                              13940000
143900       FROM HEADING-LINE-3                                        13950000
144000         AFTER ADVANCING 2 LINES.                                 13960000
144100*                                                                 13970000
144200     WRITE SU-CARTON-NOT-RCVD-RECORD                              13980000
144300       FROM HEADING-LINE-4                                        13990000
144400         AFTER ADVANCING 2 LINES.                                 14000000
144500*                                                                 14010000
144600     WRITE SU-CARTON-NOT-RCVD-RECORD                              14020000
144700       FROM HEADING-LINE-5                                        14030000
144800         AFTER ADVANCING 1 LINE.                                  14040000
144900*                                                                 14050000
145000     MOVE PC-11                   TO PV-LINE-CNT.                 14060000
145100*                                                                 14070000
145200*                                                                 14080000
145300 8200-WRITE-TOP-LINE.                                             14090000
145400******************************************************************14100000
145500*     WRITES HEADER LINES 0 AND 1 WHEN MORE THAN ONE PAGE IS     *14110000
145600*     NEEDED FOR AN ASN NUMBER.                                  *14120000
145700******************************************************************14130000
145800     ADD 1                        TO PV-PAGE-CNT.                 14140000
145900*                                                                 14150000
146000     MOVE PV-PAGE-CNT             TO DP132O-PAGE-NUMBER.          14160000
146100*                                                                 14170000
146200     WRITE SU-CARTON-NOT-RCVD-RECORD                              14180000
146300       FROM DP132O-STANDRD-HEADER-132-COLS                        14190000
146400         AFTER ADVANCING PAGE.                                    14200000
146500*                                                                 14210000
146600*                                                                 14220000
146700 8400-WRITE-DETAIL-LINES.                                         14230000
146800******************************************************************14240000
146900*     WRITES THE DETAIL LINE INFORMATION.                        *14250000
147000******************************************************************14260000
147100     IF DL1-PO-RECEIVER = PV-SAVE-PO-RECEIVER                     14270000
147200         MOVE SPACES TO DL1-PO-RECEIVER                           14280000
147300         IF PV-SERIAL-SHIP-CODE = PV-SAVE-SHIP-CODE               14290000
147400             MOVE SPACES TO DL1-SERIAL-SHIP-CODE                  14300000
147500             MOVE ZERO   TO DL1-STORE-NBR                         14310000
147600             MOVE PC-1 TO PV-LINE-SUB                             14320000
147700             IF DL1-OPER-FCLTY = PV-SAVE-OPER-FCLTY AND           14330000
147800                DL1-SCAN-OPER-FCLTY = PV-SAVE-SCAN-OPER-FCLTY     14340000
147900                 MOVE SPACES TO DL1-OPER-FCLTY                    14350000
148000                                DL1-SCAN-OPER-FCLTY               14360000
148100             ELSE                                                 14370000
148200                 MOVE DL1-OPER-FCLTY TO PV-SAVE-OPER-FCLTY        14380000
148300                 MOVE DL1-SCAN-OPER-FCLTY                         14390000
148400                                     TO PV-SAVE-SCAN-OPER-FCLTY   14400000
148500             END-IF                                               14410000
148600         ELSE                                                     14420000
148700             MOVE PC-2 TO PV-LINE-SUB                             14430000
148800             MOVE PV-SERIAL-SHIP-CODE  TO PV-SAVE-SHIP-CODE       14440000
148900         END-IF                                                   14450000
149000     ELSE                                                         14460000
149100         MOVE PC-2 TO PV-LINE-SUB                                 14470000
149200         MOVE DL1-PO-RECEIVER      TO PV-SAVE-PO-RECEIVER         14480000
149300         MOVE PV-SERIAL-SHIP-CODE  TO PV-SAVE-SHIP-CODE           14490000
149400         MOVE DL1-OPER-FCLTY       TO PV-SAVE-OPER-FCLTY          14500000
149500         MOVE DL1-SCAN-OPER-FCLTY  TO PV-SAVE-SCAN-OPER-FCLTY     14510000
149600     END-IF.                                                      14520000
149700     WRITE SU-CARTON-NOT-RCVD-RECORD                              14530000
149800       FROM DETAIL-LINE1                                          14540000
149900         AFTER ADVANCING PV-LINE-SUB LINES.                       14550000
150000*                                                                 14560000
150100     ADD PV-LINE-SUB                 TO PV-LINE-CNT.              14570000
150200*                                                                 14580000
150300*                                                                 14590000
150400******************************************************************14600000
150500*     SQL WARNING OR ERROR PROCESSING                            *14610000
150600*                                                                *14620000
150700******************************************************************14630000
150800                                                                  14640000
150900*                                                                 14650000
151000 Z999-SQL-ERROR.                                                  14660000
151100*---------------                                                  14670000
151200                                                                  14680000
151300     MOVE SQLCODE    TO SQLCODE2.                                 14690000
151400     MOVE SQLERRD(3) TO SQLERRD3.                                 14700000
151500     DISPLAY '** ABEND **       ** = SQLERROR'.                   14710000
151600     DISPLAY '** PROGRAM        ** = SUKRP004'.                   14720000
151700     DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  14730000
151800     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  14740000
151900     DISPLAY '** SQLERRM        ** = ' SQLERRM.                   14750000
152000     DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                  14760000
152100     EXEC SQL                                                     14770000
152200         COMMIT                                                   14780000
152300     END-EXEC.                                                    14790000
152400     MOVE +4013 TO PV-ABEND-CODE.                                 14800000
152500     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         14810000
